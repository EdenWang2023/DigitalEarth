/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.96
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

var CesiumEMExtensions=(()=>{var Loe=Object.create;var gb=Object.defineProperty;var Roe=Object.getOwnPropertyDescriptor;var Ooe=Object.getOwnPropertyNames;var Noe=Object.getPrototypeOf,Boe=Object.prototype.hasOwnProperty;var Gg=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,n)=>(typeof require!="undefined"?require:t)[n]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var mm=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ik=(e,t)=>{for(var n in t)gb(e,n,{get:t[n],enumerable:!0})},ok=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ooe(t))!Boe.call(e,o)&&o!==n&&gb(e,o,{get:()=>t[o],enumerable:!(r=Roe(t,o))||r.enumerable});return e};var Xv=(e,t,n)=>(n=e!=null?Loe(Noe(e)):{},ok(t||!e||!e.__esModule?gb(n,"default",{value:e,enumerable:!0}):n,e)),Foe=e=>ok(gb({},"__esModule",{value:!0}),e);var sk=mm((jv,Kv)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */(function(e){var t=typeof jv=="object"&&jv&&!jv.nodeType&&jv,n=typeof Kv=="object"&&Kv&&!Kv.nodeType&&Kv,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(e=r);var o,a=2147483647,s=36,u=1,l=26,c=38,f=700,h=72,d=128,p="-",_=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=s-u,E=Math.floor,S=String.fromCharCode,A;function D(z){throw new RangeError(w[z])}function P(z,U){for(var Q=z.length,ne=[];Q--;)ne[Q]=U(z[Q]);return ne}function M(z,U){var Q=z.split("@"),ne="";Q.length>1&&(ne=Q[0]+"@",z=Q[1]),z=z.replace(v,".");var se=z.split("."),de=P(se,U).join(".");return ne+de}function b(z){for(var U=[],Q=0,ne=z.length,se,de;Q<ne;)se=z.charCodeAt(Q++),se>=55296&&se<=56319&&Q<ne?(de=z.charCodeAt(Q++),(de&64512)==56320?U.push(((se&1023)<<10)+(de&1023)+65536):(U.push(se),Q--)):U.push(se);return U}function O(z){return P(z,function(U){var Q="";return U>65535&&(U-=65536,Q+=S(U>>>10&1023|55296),U=56320|U&1023),Q+=S(U),Q}).join("")}function m(z){return z-48<10?z-22:z-65<26?z-65:z-97<26?z-97:s}function I(z,U){return z+22+75*(z<26)-((U!=0)<<5)}function L(z,U,Q){var ne=0;for(z=Q?E(z/f):z>>1,z+=E(z/U);z>C*l>>1;ne+=s)z=E(z/C);return E(ne+(C+1)*z/(z+c))}function R(z){var U=[],Q=z.length,ne,se=0,de=d,pe=h,ve,ft,pt,Xt,At,wt,Rr,gi,$i;for(ve=z.lastIndexOf(p),ve<0&&(ve=0),ft=0;ft<ve;++ft)z.charCodeAt(ft)>=128&&D("not-basic"),U.push(z.charCodeAt(ft));for(pt=ve>0?ve+1:0;pt<Q;){for(Xt=se,At=1,wt=s;pt>=Q&&D("invalid-input"),Rr=m(z.charCodeAt(pt++)),(Rr>=s||Rr>E((a-se)/At))&&D("overflow"),se+=Rr*At,gi=wt<=pe?u:wt>=pe+l?l:wt-pe,!(Rr<gi);wt+=s)$i=s-gi,At>E(a/$i)&&D("overflow"),At*=$i;ne=U.length+1,pe=L(se-Xt,ne,Xt==0),E(se/ne)>a-de&&D("overflow"),de+=E(se/ne),se%=ne,U.splice(se++,0,de)}return O(U)}function N(z){var U,Q,ne,se,de,pe,ve,ft,pt,Xt,At,wt=[],Rr,gi,$i,ut;for(z=b(z),Rr=z.length,U=d,Q=0,de=h,pe=0;pe<Rr;++pe)At=z[pe],At<128&&wt.push(S(At));for(ne=se=wt.length,se&&wt.push(p);ne<Rr;){for(ve=a,pe=0;pe<Rr;++pe)At=z[pe],At>=U&&At<ve&&(ve=At);for(gi=ne+1,ve-U>E((a-Q)/gi)&&D("overflow"),Q+=(ve-U)*gi,U=ve,pe=0;pe<Rr;++pe)if(At=z[pe],At<U&&++Q>a&&D("overflow"),At==U){for(ft=Q,pt=s;Xt=pt<=de?u:pt>=de+l?l:pt-de,!(ft<Xt);pt+=s)ut=ft-Xt,$i=s-Xt,wt.push(S(I(Xt+ut%$i,0))),ft=E(ut/$i);wt.push(S(I(ft,0))),de=L(Q,gi,ne==se),Q=0,++ne}++Q,++U}return wt.join("")}function B(z){return M(z,function(U){return _.test(U)?R(U.slice(4).toLowerCase()):U})}function V(z){return M(z,function(U){return y.test(U)?"xn--"+N(U):U})}if(o={version:"1.3.2",ucs2:{decode:b,encode:O},decode:R,encode:N,toASCII:V,toUnicode:B},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return o});else if(t&&n)if(Kv.exports==t)n.exports=o;else for(A in o)o.hasOwnProperty(A)&&(t[A]=o[A]);else e.punycode=o})(jv)});var lk=mm((uk,_b)=>{/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof _b=="object"&&_b.exports?_b.exports=t():typeof define=="function"&&define.amd?define(t):e.IPv6=t(e)})(uk,function(e){"use strict";var t=e&&e.IPv6;function n(o){var a=o.toLowerCase(),s=a.split(":"),u=s.length,l=8;s[0]===""&&s[1]===""&&s[2]===""?(s.shift(),s.shift()):s[0]===""&&s[1]===""?s.shift():s[u-1]===""&&s[u-2]===""&&s.pop(),u=s.length,s[u-1].indexOf(".")!==-1&&(l=7);var c;for(c=0;c<u&&s[c]!=="";c++);if(c<l)for(s.splice(c,1,"0000");s.length<l;)s.splice(c,0,"0000");for(var f,h=0;h<l;h++){f=s[h].split("");for(var d=0;d<3&&(f[0]==="0"&&f.length>1);d++)f.splice(0,1);s[h]=f.join("")}var p=-1,_=0,y=0,v=-1,w=!1;for(h=0;h<l;h++)w?s[h]==="0"?y+=1:(w=!1,y>_&&(p=v,_=y)):s[h]==="0"&&(w=!0,v=h,y=1);y>_&&(p=v,_=y),_>1&&s.splice(p,_,""),u=s.length;var C="";for(s[0]===""&&(C=":"),h=0;h<u&&(C+=s[h],h!==u-1);h++)C+=":";return s[u-1]===""&&(C+=":"),C}function r(){return e.IPv6===this&&(e.IPv6=t),this}return{best:n,noConflict:r}})});var fk=mm((ck,yb)=>{/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof yb=="object"&&yb.exports?yb.exports=t():typeof define=="function"&&define.amd?define(t):e.SecondLevelDomains=t(e)})(ck,function(e){"use strict";var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return!1;var a=r.lastIndexOf(".",o-1);if(a<=0||a>=o-1)return!1;var s=n.list[r.slice(o+1)];return s?s.indexOf(" "+r.slice(a+1,o)+" ")>=0:!1},is:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return!1;var a=r.lastIndexOf(".",o-1);if(a>=0)return!1;var s=n.list[r.slice(o+1)];return s?s.indexOf(" "+r.slice(0,o)+" ")>=0:!1},get:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return null;var a=r.lastIndexOf(".",o-1);if(a<=0||a>=o-1)return null;var s=n.list[r.slice(o+1)];return!s||s.indexOf(" "+r.slice(a+1,o)+" ")<0?null:r.slice(a+1)},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n})});var dk=mm((hk,vb)=>{/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof vb=="object"&&vb.exports?vb.exports=t(sk(),lk(),fk()):typeof define=="function"&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)})(hk,function(e,t,n,r){"use strict";var o=r&&r.URI;function a(I,L){var R=arguments.length>=1,N=arguments.length>=2;if(!(this instanceof a))return R?N?new a(I,L):new a(I):new a;if(I===void 0){if(R)throw new TypeError("undefined is not a valid argument for URI");typeof location<"u"?I=location.href+"":I=""}if(I===null&&R)throw new TypeError("null is not a valid argument for URI");return this.href(I),L!==void 0?this.absoluteTo(L):this}function s(I){return/^[0-9]+$/.test(I)}a.version="1.19.11";var u=a.prototype,l=Object.prototype.hasOwnProperty;function c(I){return I.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function f(I){return I===void 0?"Undefined":String(Object.prototype.toString.call(I)).slice(8,-1)}function h(I){return f(I)==="Array"}function d(I,L){var R={},N,B;if(f(L)==="RegExp")R=null;else if(h(L))for(N=0,B=L.length;N<B;N++)R[L[N]]=!0;else R[L]=!0;for(N=0,B=I.length;N<B;N++){var V=R&&R[I[N]]!==void 0||!R&&L.test(I[N]);V&&(I.splice(N,1),B--,N--)}return I}function p(I,L){var R,N;if(h(L)){for(R=0,N=L.length;R<N;R++)if(!p(I,L[R]))return!1;return!0}var B=f(L);for(R=0,N=I.length;R<N;R++)if(B==="RegExp"){if(typeof I[R]=="string"&&I[R].match(L))return!0}else if(I[R]===L)return!0;return!1}function _(I,L){if(!h(I)||!h(L)||I.length!==L.length)return!1;I.sort(),L.sort();for(var R=0,N=I.length;R<N;R++)if(I[R]!==L[R])return!1;return!0}function y(I){var L=/^\/+|\/+$/g;return I.replace(L,"")}a._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:a.preventInvalidHostname,duplicateQueryParameters:a.duplicateQueryParameters,escapeQuerySpace:a.escapeQuerySpace}},a.preventInvalidHostname=!1,a.duplicateQueryParameters=!1,a.escapeQuerySpace=!0,a.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,a.idn_expression=/[^a-z0-9\._-]/i,a.punycode_expression=/(xn--)/i,a.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,a.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,a.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig,a.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},a.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,a.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},a.hostProtocols=["http","https"],a.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,a.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},a.getDomAttribute=function(I){if(!(!I||!I.nodeName)){var L=I.nodeName.toLowerCase();if(!(L==="input"&&I.type!=="image"))return a.domAttributes[L]}};function v(I){return escape(I)}function w(I){return encodeURIComponent(I).replace(/[!'()*]/g,v).replace(/\*/g,"%2A")}a.encode=w,a.decode=decodeURIComponent,a.iso8859=function(){a.encode=escape,a.decode=unescape},a.unicode=function(){a.encode=w,a.decode=decodeURIComponent},a.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},a.encodeQuery=function(I,L){var R=a.encode(I+"");return L===void 0&&(L=a.escapeQuerySpace),L?R.replace(/%20/g,"+"):R},a.decodeQuery=function(I,L){I+="",L===void 0&&(L=a.escapeQuerySpace);try{return a.decode(L?I.replace(/\+/g,"%20"):I)}catch{return I}};var C={encode:"encode",decode:"decode"},E,S=function(I,L){return function(R){try{return a[L](R+"").replace(a.characters[I][L].expression,function(N){return a.characters[I][L].map[N]})}catch{return R}}};for(E in C)a[E+"PathSegment"]=S("pathname",C[E]),a[E+"UrnPathSegment"]=S("urnpath",C[E]);var A=function(I,L,R){return function(N){var B;R?B=function(Q){return a[L](a[R](Q))}:B=a[L];for(var V=(N+"").split(I),z=0,U=V.length;z<U;z++)V[z]=B(V[z]);return V.join(I)}};a.decodePath=A("/","decodePathSegment"),a.decodeUrnPath=A(":","decodeUrnPathSegment"),a.recodePath=A("/","encodePathSegment","decode"),a.recodeUrnPath=A(":","encodeUrnPathSegment","decode"),a.encodeReserved=S("reserved","encode"),a.parse=function(I,L){var R;return L||(L={preventInvalidHostname:a.preventInvalidHostname}),I=I.replace(a.leading_whitespace_expression,""),I=I.replace(a.ascii_tab_whitespace,""),R=I.indexOf("#"),R>-1&&(L.fragment=I.substring(R+1)||null,I=I.substring(0,R)),R=I.indexOf("?"),R>-1&&(L.query=I.substring(R+1)||null,I=I.substring(0,R)),I=I.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://"),I=I.replace(/^[/\\]{2,}/i,"//"),I.substring(0,2)==="//"?(L.protocol=null,I=I.substring(2),I=a.parseAuthority(I,L)):(R=I.indexOf(":"),R>-1&&(L.protocol=I.substring(0,R)||null,L.protocol&&!L.protocol.match(a.protocol_expression)?L.protocol=void 0:I.substring(R+1,R+3).replace(/\\/g,"/")==="//"?(I=I.substring(R+3),I=a.parseAuthority(I,L)):(I=I.substring(R+1),L.urn=!0))),L.path=I,L},a.parseHost=function(I,L){I||(I=""),I=I.replace(/\\/g,"/");var R=I.indexOf("/"),N,B;if(R===-1&&(R=I.length),I.charAt(0)==="[")N=I.indexOf("]"),L.hostname=I.substring(1,N)||null,L.port=I.substring(N+2,R)||null,L.port==="/"&&(L.port=null);else{var V=I.indexOf(":"),z=I.indexOf("/"),U=I.indexOf(":",V+1);U!==-1&&(z===-1||U<z)?(L.hostname=I.substring(0,R)||null,L.port=null):(B=I.substring(0,R).split(":"),L.hostname=B[0]||null,L.port=B[1]||null)}return L.hostname&&I.substring(R).charAt(0)!=="/"&&(R++,I="/"+I),L.preventInvalidHostname&&a.ensureValidHostname(L.hostname,L.protocol),L.port&&a.ensureValidPort(L.port),I.substring(R)||"/"},a.parseAuthority=function(I,L){return I=a.parseUserinfo(I,L),a.parseHost(I,L)},a.parseUserinfo=function(I,L){var R=I,N=I.indexOf("\\");N!==-1&&(I=I.replace(/\\/g,"/"));var B=I.indexOf("/"),V=I.lastIndexOf("@",B>-1?B:I.length-1),z;return V>-1&&(B===-1||V<B)?(z=I.substring(0,V).split(":"),L.username=z[0]?a.decode(z[0]):null,z.shift(),L.password=z[0]?a.decode(z.join(":")):null,I=R.substring(V+1)):(L.username=null,L.password=null),I},a.parseQuery=function(I,L){if(!I)return{};if(I=I.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!I)return{};for(var R={},N=I.split("&"),B=N.length,V,z,U,Q=0;Q<B;Q++)V=N[Q].split("="),z=a.decodeQuery(V.shift(),L),U=V.length?a.decodeQuery(V.join("="),L):null,z!=="__proto__"&&(l.call(R,z)?((typeof R[z]=="string"||R[z]===null)&&(R[z]=[R[z]]),R[z].push(U)):R[z]=U);return R},a.build=function(I){var L="",R=!1;return I.protocol&&(L+=I.protocol+":"),!I.urn&&(L||I.hostname)&&(L+="//",R=!0),L+=a.buildAuthority(I)||"",typeof I.path=="string"&&(I.path.charAt(0)!=="/"&&R&&(L+="/"),L+=I.path),typeof I.query=="string"&&I.query&&(L+="?"+I.query),typeof I.fragment=="string"&&I.fragment&&(L+="#"+I.fragment),L},a.buildHost=function(I){var L="";if(I.hostname)a.ip6_expression.test(I.hostname)?L+="["+I.hostname+"]":L+=I.hostname;else return"";return I.port&&(L+=":"+I.port),L},a.buildAuthority=function(I){return a.buildUserinfo(I)+a.buildHost(I)},a.buildUserinfo=function(I){var L="";return I.username&&(L+=a.encode(I.username)),I.password&&(L+=":"+a.encode(I.password)),L&&(L+="@"),L},a.buildQuery=function(I,L,R){var N="",B,V,z,U;for(V in I)if(V!=="__proto__"&&l.call(I,V))if(h(I[V]))for(B={},z=0,U=I[V].length;z<U;z++)I[V][z]!==void 0&&B[I[V][z]+""]===void 0&&(N+="&"+a.buildQueryParameter(V,I[V][z],R),L!==!0&&(B[I[V][z]+""]=!0));else I[V]!==void 0&&(N+="&"+a.buildQueryParameter(V,I[V],R));return N.substring(1)},a.buildQueryParameter=function(I,L,R){return a.encodeQuery(I,R)+(L!==null?"="+a.encodeQuery(L,R):"")},a.addQuery=function(I,L,R){if(typeof L=="object")for(var N in L)l.call(L,N)&&a.addQuery(I,N,L[N]);else if(typeof L=="string"){if(I[L]===void 0){I[L]=R;return}else typeof I[L]=="string"&&(I[L]=[I[L]]);h(R)||(R=[R]),I[L]=(I[L]||[]).concat(R)}else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")},a.setQuery=function(I,L,R){if(typeof L=="object")for(var N in L)l.call(L,N)&&a.setQuery(I,N,L[N]);else if(typeof L=="string")I[L]=R===void 0?null:R;else throw new TypeError("URI.setQuery() accepts an object, string as the name parameter")},a.removeQuery=function(I,L,R){var N,B,V;if(h(L))for(N=0,B=L.length;N<B;N++)I[L[N]]=void 0;else if(f(L)==="RegExp")for(V in I)L.test(V)&&(I[V]=void 0);else if(typeof L=="object")for(V in L)l.call(L,V)&&a.removeQuery(I,V,L[V]);else if(typeof L=="string")R!==void 0?f(R)==="RegExp"?!h(I[L])&&R.test(I[L])?I[L]=void 0:I[L]=d(I[L],R):I[L]===String(R)&&(!h(R)||R.length===1)?I[L]=void 0:h(I[L])&&(I[L]=d(I[L],R)):I[L]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")},a.hasQuery=function(I,L,R,N){switch(f(L)){case"String":break;case"RegExp":for(var B in I)if(l.call(I,B)&&L.test(B)&&(R===void 0||a.hasQuery(I,B,R)))return!0;return!1;case"Object":for(var V in L)if(l.call(L,V)&&!a.hasQuery(I,V,L[V]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(f(R)){case"Undefined":return L in I;case"Boolean":var z=Boolean(h(I[L])?I[L].length:I[L]);return R===z;case"Function":return!!R(I[L],L,I);case"Array":if(!h(I[L]))return!1;var U=N?p:_;return U(I[L],R);case"RegExp":return h(I[L])?N?p(I[L],R):!1:Boolean(I[L]&&I[L].match(R));case"Number":R=String(R);case"String":return h(I[L])?N?p(I[L],R):!1:I[L]===R;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},a.joinPaths=function(){for(var I=[],L=[],R=0,N=0;N<arguments.length;N++){var B=new a(arguments[N]);I.push(B);for(var V=B.segment(),z=0;z<V.length;z++)typeof V[z]=="string"&&L.push(V[z]),V[z]&&R++}if(!L.length||!R)return new a("");var U=new a("").segment(L);return(I[0].path()===""||I[0].path().slice(0,1)==="/")&&U.path("/"+U.path()),U.normalize()},a.commonPath=function(I,L){var R=Math.min(I.length,L.length),N;for(N=0;N<R;N++)if(I.charAt(N)!==L.charAt(N)){N--;break}return N<1?I.charAt(0)===L.charAt(0)&&I.charAt(0)==="/"?"/":"":((I.charAt(N)!=="/"||L.charAt(N)!=="/")&&(N=I.substring(0,N).lastIndexOf("/")),I.substring(0,N+1))},a.withinString=function(I,L,R){R||(R={});var N=R.start||a.findUri.start,B=R.end||a.findUri.end,V=R.trim||a.findUri.trim,z=R.parens||a.findUri.parens,U=/[a-z0-9-]=["']?$/i;for(N.lastIndex=0;;){var Q=N.exec(I);if(!Q)break;var ne=Q.index;if(R.ignoreHtml){var se=I.slice(Math.max(ne-3,0),ne);if(se&&U.test(se))continue}for(var de=ne+I.slice(ne).search(B),pe=I.slice(ne,de),ve=-1;;){var ft=z.exec(pe);if(!ft)break;var pt=ft.index+ft[0].length;ve=Math.max(ve,pt)}if(ve>-1?pe=pe.slice(0,ve)+pe.slice(ve).replace(V,""):pe=pe.replace(V,""),!(pe.length<=Q[0].length)&&!(R.ignore&&R.ignore.test(pe))){de=ne+pe.length;var Xt=L(pe,ne,de,I);if(Xt===void 0){N.lastIndex=de;continue}Xt=String(Xt),I=I.slice(0,ne)+Xt+I.slice(de),N.lastIndex=ne+Xt.length}}return N.lastIndex=0,I},a.ensureValidHostname=function(I,L){var R=!!I,N=!!L,B=!1;if(N&&(B=p(a.hostProtocols,L)),B&&!R)throw new TypeError("Hostname cannot be empty, if protocol is "+L);if(I&&I.match(a.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+I+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(I).match(a.invalid_hostname_characters))throw new TypeError('Hostname "'+I+'" contains characters other than [A-Z0-9.-:_]')}},a.ensureValidPort=function(I){if(!!I){var L=Number(I);if(!(s(L)&&L>0&&L<65536))throw new TypeError('Port "'+I+'" is not a valid port')}},a.noConflict=function(I){if(I){var L={URI:this.noConflict()};return r.URITemplate&&typeof r.URITemplate.noConflict=="function"&&(L.URITemplate=r.URITemplate.noConflict()),r.IPv6&&typeof r.IPv6.noConflict=="function"&&(L.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&typeof r.SecondLevelDomains.noConflict=="function"&&(L.SecondLevelDomains=r.SecondLevelDomains.noConflict()),L}else r.URI===this&&(r.URI=o);return this},u.build=function(I){return I===!0?this._deferred_build=!0:(I===void 0||this._deferred_build)&&(this._string=a.build(this._parts),this._deferred_build=!1),this},u.clone=function(){return new a(this)},u.valueOf=u.toString=function(){return this.build(!1)._string};function D(I){return function(L,R){return L===void 0?this._parts[I]||"":(this._parts[I]=L||null,this.build(!R),this)}}function P(I,L){return function(R,N){return R===void 0?this._parts[I]||"":(R!==null&&(R=R+"",R.charAt(0)===L&&(R=R.substring(1))),this._parts[I]=R,this.build(!N),this)}}u.protocol=D("protocol"),u.username=D("username"),u.password=D("password"),u.hostname=D("hostname"),u.port=D("port"),u.query=P("query","?"),u.fragment=P("fragment","#"),u.search=function(I,L){var R=this.query(I,L);return typeof R=="string"&&R.length?"?"+R:R},u.hash=function(I,L){var R=this.fragment(I,L);return typeof R=="string"&&R.length?"#"+R:R},u.pathname=function(I,L){if(I===void 0||I===!0){var R=this._parts.path||(this._parts.hostname?"/":"");return I?(this._parts.urn?a.decodeUrnPath:a.decodePath)(R):R}else return this._parts.urn?this._parts.path=I?a.recodeUrnPath(I):"":this._parts.path=I?a.recodePath(I):"/",this.build(!L),this},u.path=u.pathname,u.href=function(I,L){var R;if(I===void 0)return this.toString();this._string="",this._parts=a._parts();var N=I instanceof a,B=typeof I=="object"&&(I.hostname||I.path||I.pathname);if(I.nodeName){var V=a.getDomAttribute(I);I=I[V]||"",B=!1}if(!N&&B&&I.pathname!==void 0&&(I=I.toString()),typeof I=="string"||I instanceof String)this._parts=a.parse(String(I),this._parts);else if(N||B){var z=N?I._parts:I;for(R in z)R!=="query"&&l.call(this._parts,R)&&(this._parts[R]=z[R]);z.query&&this.query(z.query,!1)}else throw new TypeError("invalid input");return this.build(!L),this},u.is=function(I){var L=!1,R=!1,N=!1,B=!1,V=!1,z=!1,U=!1,Q=!this._parts.urn;switch(this._parts.hostname&&(Q=!1,R=a.ip4_expression.test(this._parts.hostname),N=a.ip6_expression.test(this._parts.hostname),L=R||N,B=!L,V=B&&n&&n.has(this._parts.hostname),z=B&&a.idn_expression.test(this._parts.hostname),U=B&&a.punycode_expression.test(this._parts.hostname)),I.toLowerCase()){case"relative":return Q;case"absolute":return!Q;case"domain":case"name":return B;case"sld":return V;case"ip":return L;case"ip4":case"ipv4":case"inet4":return R;case"ip6":case"ipv6":case"inet6":return N;case"idn":return z;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return U}return null};var M=u.protocol,b=u.port,O=u.hostname;u.protocol=function(I,L){if(I&&(I=I.replace(/:(\/\/)?$/,""),!I.match(a.protocol_expression)))throw new TypeError('Protocol "'+I+`" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]`);return M.call(this,I,L)},u.scheme=u.protocol,u.port=function(I,L){return this._parts.urn?I===void 0?"":this:(I!==void 0&&(I===0&&(I=null),I&&(I+="",I.charAt(0)===":"&&(I=I.substring(1)),a.ensureValidPort(I))),b.call(this,I,L))},u.hostname=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I!==void 0){var R={preventInvalidHostname:this._parts.preventInvalidHostname},N=a.parseHost(I,R);if(N!=="/")throw new TypeError('Hostname "'+I+'" contains characters other than [A-Z0-9.-]');I=R.hostname,this._parts.preventInvalidHostname&&a.ensureValidHostname(I,this._parts.protocol)}return O.call(this,I,L)},u.origin=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0){var R=this.protocol(),N=this.authority();return N?(R?R+"://":"")+this.authority():""}else{var B=a(I);return this.protocol(B.protocol()).authority(B.authority()).build(!L),this}},u.host=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0)return this._parts.hostname?a.buildHost(this._parts):"";var R=a.parseHost(I,this._parts);if(R!=="/")throw new TypeError('Hostname "'+I+'" contains characters other than [A-Z0-9.-]');return this.build(!L),this},u.authority=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0)return this._parts.hostname?a.buildAuthority(this._parts):"";var R=a.parseAuthority(I,this._parts);if(R!=="/")throw new TypeError('Hostname "'+I+'" contains characters other than [A-Z0-9.-]');return this.build(!L),this},u.userinfo=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0){var R=a.buildUserinfo(this._parts);return R&&R.substring(0,R.length-1)}else return I[I.length-1]!=="@"&&(I+="@"),a.parseUserinfo(I,this._parts),this.build(!L),this},u.resource=function(I,L){var R;return I===void 0?this.path()+this.search()+this.hash():(R=a.parse(I),this._parts.path=R.path,this._parts.query=R.query,this._parts.fragment=R.fragment,this.build(!L),this)},u.subdomain=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,R)||""}else{var N=this._parts.hostname.length-this.domain().length,B=this._parts.hostname.substring(0,N),V=new RegExp("^"+c(B));if(I&&I.charAt(I.length-1)!=="."&&(I+="."),I.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");return I&&a.ensureValidHostname(I,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(V,I),this.build(!L),this}},u.domain=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(typeof I=="boolean"&&(L=I,I=void 0),I===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.match(/\./g);if(R&&R.length<2)return this._parts.hostname;var N=this._parts.hostname.length-this.tld(L).length-1;return N=this._parts.hostname.lastIndexOf(".",N-1)+1,this._parts.hostname.substring(N)||""}else{if(!I)throw new TypeError("cannot set domain empty");if(I.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");if(a.ensureValidHostname(I,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=I;else{var B=new RegExp(c(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(B,I)}return this.build(!L),this}},u.tld=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(typeof I=="boolean"&&(L=I,I=void 0),I===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.lastIndexOf("."),N=this._parts.hostname.substring(R+1);return L!==!0&&n&&n.list[N.toLowerCase()]&&n.get(this._parts.hostname)||N}else{var B;if(I)if(I.match(/[^a-zA-Z0-9-]/))if(n&&n.is(I))B=new RegExp(c(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(B,I);else throw new TypeError('TLD "'+I+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");B=new RegExp(c(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(B,I)}else throw new TypeError("cannot set TLD empty");return this.build(!L),this}},u.directory=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0||I===!0){if(!this._parts.path&&!this._parts.hostname)return"";if(this._parts.path==="/")return"/";var R=this._parts.path.length-this.filename().length-1,N=this._parts.path.substring(0,R)||(this._parts.hostname?"/":"");return I?a.decodePath(N):N}else{var B=this._parts.path.length-this.filename().length,V=this._parts.path.substring(0,B),z=new RegExp("^"+c(V));return this.is("relative")||(I||(I="/"),I.charAt(0)!=="/"&&(I="/"+I)),I&&I.charAt(I.length-1)!=="/"&&(I+="/"),I=a.recodePath(I),this._parts.path=this._parts.path.replace(z,I),this.build(!L),this}},u.filename=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(typeof I!="string"){if(!this._parts.path||this._parts.path==="/")return"";var R=this._parts.path.lastIndexOf("/"),N=this._parts.path.substring(R+1);return I?a.decodePathSegment(N):N}else{var B=!1;I.charAt(0)==="/"&&(I=I.substring(1)),I.match(/\.?\//)&&(B=!0);var V=new RegExp(c(this.filename())+"$");return I=a.recodePath(I),this._parts.path=this._parts.path.replace(V,I),B?this.normalizePath(L):this.build(!L),this}},u.suffix=function(I,L){if(this._parts.urn)return I===void 0?"":this;if(I===void 0||I===!0){if(!this._parts.path||this._parts.path==="/")return"";var R=this.filename(),N=R.lastIndexOf("."),B,V;return N===-1?"":(B=R.substring(N+1),V=/^[a-z0-9%]+$/i.test(B)?B:"",I?a.decodePathSegment(V):V)}else{I.charAt(0)==="."&&(I=I.substring(1));var z=this.suffix(),U;if(z)I?U=new RegExp(c(z)+"$"):U=new RegExp(c("."+z)+"$");else{if(!I)return this;this._parts.path+="."+a.recodePath(I)}return U&&(I=a.recodePath(I),this._parts.path=this._parts.path.replace(U,I)),this.build(!L),this}},u.segment=function(I,L,R){var N=this._parts.urn?":":"/",B=this.path(),V=B.substring(0,1)==="/",z=B.split(N);if(I!==void 0&&typeof I!="number"&&(R=L,L=I,I=void 0),I!==void 0&&typeof I!="number")throw new Error('Bad segment "'+I+'", must be 0-based integer');if(V&&z.shift(),I<0&&(I=Math.max(z.length+I,0)),L===void 0)return I===void 0?z:z[I];if(I===null||z[I]===void 0)if(h(L)){z=[];for(var U=0,Q=L.length;U<Q;U++)!L[U].length&&(!z.length||!z[z.length-1].length)||(z.length&&!z[z.length-1].length&&z.pop(),z.push(y(L[U])))}else(L||typeof L=="string")&&(L=y(L),z[z.length-1]===""?z[z.length-1]=L:z.push(L));else L?z[I]=y(L):z.splice(I,1);return V&&z.unshift(""),this.path(z.join(N),R)},u.segmentCoded=function(I,L,R){var N,B,V;if(typeof I!="number"&&(R=L,L=I,I=void 0),L===void 0){if(N=this.segment(I,L,R),!h(N))N=N!==void 0?a.decode(N):void 0;else for(B=0,V=N.length;B<V;B++)N[B]=a.decode(N[B]);return N}if(!h(L))L=typeof L=="string"||L instanceof String?a.encode(L):L;else for(B=0,V=L.length;B<V;B++)L[B]=a.encode(L[B]);return this.segment(I,L,R)};var m=u.query;return u.query=function(I,L){if(I===!0)return a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof I=="function"){var R=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace),N=I.call(this,R);return this._parts.query=a.buildQuery(N||R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!L),this}else return I!==void 0&&typeof I!="string"?(this._parts.query=a.buildQuery(I,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!L),this):m.call(this,I,L)},u.setQuery=function(I,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof I=="string"||I instanceof String)N[I]=L!==void 0?L:null;else if(typeof I=="object")for(var B in I)l.call(I,B)&&(N[B]=I[B]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");return this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof I!="string"&&(R=L),this.build(!R),this},u.addQuery=function(I,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.addQuery(N,I,L===void 0?null:L),this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof I!="string"&&(R=L),this.build(!R),this},u.removeQuery=function(I,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.removeQuery(N,I,L),this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof I!="string"&&(R=L),this.build(!R),this},u.hasQuery=function(I,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.hasQuery(N,I,L,R)},u.setSearch=u.setQuery,u.addSearch=u.addQuery,u.removeSearch=u.removeQuery,u.hasSearch=u.hasQuery,u.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},u.normalizeProtocol=function(I){return typeof this._parts.protocol=="string"&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!I)),this},u.normalizeHostname=function(I){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!I)),this},u.normalizePort=function(I){return typeof this._parts.protocol=="string"&&this._parts.port===a.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!I)),this},u.normalizePath=function(I){var L=this._parts.path;if(!L)return this;if(this._parts.urn)return this._parts.path=a.recodeUrnPath(this._parts.path),this.build(!I),this;if(this._parts.path==="/")return this;L=a.recodePath(L);var R,N="",B,V;for(L.charAt(0)!=="/"&&(R=!0,L="/"+L),(L.slice(-3)==="/.."||L.slice(-2)==="/.")&&(L+="/"),L=L.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),R&&(N=L.substring(1).match(/^(\.\.\/)+/)||"",N&&(N=N[0]));B=L.search(/\/\.\.(\/|$)/),B!==-1;){if(B===0){L=L.substring(3);continue}V=L.substring(0,B).lastIndexOf("/"),V===-1&&(V=B),L=L.substring(0,V)+L.substring(B+3)}return R&&this.is("relative")&&(L=N+L.substring(1)),this._parts.path=L,this.build(!I),this},u.normalizePathname=u.normalizePath,u.normalizeQuery=function(I){return typeof this._parts.query=="string"&&(this._parts.query.length?this.query(a.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!I)),this},u.normalizeFragment=function(I){return this._parts.fragment||(this._parts.fragment=null,this.build(!I)),this},u.normalizeSearch=u.normalizeQuery,u.normalizeHash=u.normalizeFragment,u.iso8859=function(){var I=a.encode,L=a.decode;a.encode=escape,a.decode=decodeURIComponent;try{this.normalize()}finally{a.encode=I,a.decode=L}return this},u.unicode=function(){var I=a.encode,L=a.decode;a.encode=w,a.decode=unescape;try{this.normalize()}finally{a.encode=I,a.decode=L}return this},u.readable=function(){var I=this.clone();I.username("").password("").normalize();var L="";if(I._parts.protocol&&(L+=I._parts.protocol+"://"),I._parts.hostname&&(I.is("punycode")&&e?(L+=e.toUnicode(I._parts.hostname),I._parts.port&&(L+=":"+I._parts.port)):L+=I.host()),I._parts.hostname&&I._parts.path&&I._parts.path.charAt(0)!=="/"&&(L+="/"),L+=I.path(!0),I._parts.query){for(var R="",N=0,B=I._parts.query.split("&"),V=B.length;N<V;N++){var z=(B[N]||"").split("=");R+="&"+a.decodeQuery(z[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),z[1]!==void 0&&(R+="="+a.decodeQuery(z[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}L+="?"+R.substring(1)}return L+=a.decodeQuery(I.hash(),!0),L},u.absoluteTo=function(I){var L=this.clone(),R=["protocol","username","password","hostname","port"],N,B,V;if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(I instanceof a||(I=new a(I)),L._parts.protocol||(L._parts.protocol=I._parts.protocol,this._parts.hostname))return L;for(B=0;V=R[B];B++)L._parts[V]=I._parts[V];return L._parts.path?(L._parts.path.substring(-2)===".."&&(L._parts.path+="/"),L.path().charAt(0)!=="/"&&(N=I.directory(),N=N||(I.path().indexOf("/")===0?"/":""),L._parts.path=(N?N+"/":"")+L._parts.path,L.normalizePath())):(L._parts.path=I._parts.path,L._parts.query||(L._parts.query=I._parts.query)),L.build(),L},u.relativeTo=function(I){var L=this.clone().normalize(),R,N,B,V,z;if(L._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(I=new a(I).normalize(),R=L._parts,N=I._parts,V=L.path(),z=I.path(),V.charAt(0)!=="/")throw new Error("URI is already relative");if(z.charAt(0)!=="/")throw new Error("Cannot calculate a URI relative to another relative URI");if(R.protocol===N.protocol&&(R.protocol=null),R.username!==N.username||R.password!==N.password||R.protocol!==null||R.username!==null||R.password!==null)return L.build();if(R.hostname===N.hostname&&R.port===N.port)R.hostname=null,R.port=null;else return L.build();if(V===z)return R.path="",L.build();if(B=a.commonPath(V,z),!B)return L.build();var U=N.path.substring(B.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return R.path=U+R.path.substring(B.length)||"./",L.build()},u.equals=function(I){var L=this.clone(),R=new a(I),N={},B={},V={},z,U,Q;if(L.normalize(),R.normalize(),L.toString()===R.toString())return!0;if(z=L.query(),U=R.query(),L.query(""),R.query(""),L.toString()!==R.toString()||z.length!==U.length)return!1;N=a.parseQuery(z,this._parts.escapeQuerySpace),B=a.parseQuery(U,this._parts.escapeQuerySpace);for(Q in N)if(l.call(N,Q)){if(h(N[Q])){if(!_(N[Q],B[Q]))return!1}else if(N[Q]!==B[Q])return!1;V[Q]=!0}for(Q in B)if(l.call(B,Q)&&!V[Q])return!1;return!0},u.preventInvalidHostname=function(I){return this._parts.preventInvalidHostname=!!I,this},u.duplicateQueryParameters=function(I){return this._parts.duplicateQueryParameters=!!I,this},u.escapeQuerySpace=function(I){return this._parts.escapeQuerySpace=!!I,this},a})});var Ek=mm((KVe,wk)=>{var gm=function(e){e==null&&(e=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};gm.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};gm.prototype.init_by_array=function(e,t){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>t?this.N:t;o;o--){var a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((a&4294901760)>>>16)*1664525<<16)+(a&65535)*1664525)+e[r]+r,this.mt[n]>>>=0,n++,r++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(o=this.N-1;o;o--){var a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((a&4294901760)>>>16)*1566083941<<16)+(a&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648};gm.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[e&1];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[e&1];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0};gm.prototype.random_int31=function(){return this.random_int()>>>1};gm.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};gm.prototype.random=function(){return this.random_int()*(1/4294967296)};gm.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};gm.prototype.random_long=function(){var e=this.random_int()>>>5,t=this.random_int()>>>6;return(e*67108864+t)*(1/9007199254740992)};wk.exports=gm});var ZK=mm((dCt,KK)=>{"use strict";KK.exports=RTe;var pS=1e20;function RTe(e,t){t||(t={});var n=t.cutoff==null?.25:t.cutoff,r=t.radius==null?8:t.radius,o=t.channel||0,a,s,u,l,c,f,h,d,p,_,y;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");a=t.width,s=t.height,l=e,t.stride?f=t.stride:f=Math.floor(e.length/a/s)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(d=e,h=d.getContext("2d"),a=d.width,s=d.height,p=h.getImageData(0,0,a,s),l=p.data,f=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(d=e.canvas,h=e,a=d.width,s=d.height,p=h.getImageData(0,0,a,s),l=p.data,f=4):window.ImageData&&e instanceof window.ImageData&&(p=e,a=e.width,s=e.height,l=p.data,f=4);if(u=Math.max(a,s),window.Uint8ClampedArray&&l instanceof window.Uint8ClampedArray||window.Uint8Array&&l instanceof window.Uint8Array)for(c=l,l=Array(a*s),_=0,y=Math.floor(c.length/f);_<y;_++)l[_]=c[_*f+o]/255;else if(f!==1)throw Error("Raw data can have only 1 value per pixel");var v=Array(a*s),w=Array(a*s),C=Array(u),E=Array(u),S=Array(u+1),A=Array(u);for(_=0,y=a*s;_<y;_++){var D=l[_];v[_]=D===1?0:D===0?pS:Math.pow(Math.max(0,.5-D),2),w[_]=D===1?pS:D===0?0:Math.pow(Math.max(0,D-.5),2)}XK(v,a,s,C,E,A,S),XK(w,a,s,C,E,A,S);var P=window.Float32Array?new Float32Array(a*s):new Array(a*s);for(_=0,y=a*s;_<y;_++)P[_]=Math.min(Math.max(1-((v[_]-w[_])/r+n),0),1);return P}function XK(e,t,n,r,o,a,s){for(var u=0;u<t;u++){for(var l=0;l<n;l++)r[l]=e[l*t+u];for(jK(r,o,a,s,n),l=0;l<n;l++)e[l*t+u]=o[l]}for(l=0;l<n;l++){for(u=0;u<t;u++)r[u]=e[l*t+u];for(jK(r,o,a,s,t),u=0;u<t;u++)e[l*t+u]=Math.sqrt(o[u])}}function jK(e,t,n,r,o){n[0]=0,r[0]=-pS,r[1]=+pS;for(var a=1,s=0;a<o;a++){for(var u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);u<=r[s];)s--,u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);s++,n[s]=a,r[s]=u,r[s+1]=+pS}for(a=0,s=0;a<o;a++){for(;r[s+1]<a;)s++;t[a]=(a-n[s])*(a-n[s])+e[n[s]]}}});var QK=mm((mCt,aM)=>{function OTe(){var e=0,t=1,n=2,r=3,o=4,a=5,s=6,u=7,l=8,c=9,f=10,h=11,d=12,p=13,_=14,y=15,v=16,w=17,C=0,E=1,S=2,A=3,D=4;function P(m,I){return 55296<=m.charCodeAt(I)&&m.charCodeAt(I)<=56319&&56320<=m.charCodeAt(I+1)&&m.charCodeAt(I+1)<=57343}function M(m,I){I===void 0&&(I=0);var L=m.charCodeAt(I);if(55296<=L&&L<=56319&&I<m.length-1){var R=L,N=m.charCodeAt(I+1);return 56320<=N&&N<=57343?(R-55296)*1024+(N-56320)+65536:R}if(56320<=L&&L<=57343&&I>=1){var R=m.charCodeAt(I-1),N=L;return 55296<=R&&R<=56319?(R-55296)*1024+(N-56320)+65536:N}return L}function b(m,I,L){var R=[m].concat(I).concat([L]),N=R[R.length-2],B=L,V=R.lastIndexOf(_);if(V>1&&R.slice(1,V).every(function(Q){return Q==r})&&[r,p,w].indexOf(m)==-1)return S;var z=R.lastIndexOf(o);if(z>0&&R.slice(1,z).every(function(Q){return Q==o})&&[d,o].indexOf(N)==-1)return R.filter(function(Q){return Q==o}).length%2==1?A:D;if(N==e&&B==t)return C;if(N==n||N==e||N==t)return B==_&&I.every(function(Q){return Q==r})?S:E;if(B==n||B==e||B==t)return E;if(N==s&&(B==s||B==u||B==c||B==f))return C;if((N==c||N==u)&&(B==u||B==l))return C;if((N==f||N==l)&&B==l)return C;if(B==r||B==y)return C;if(B==a)return C;if(N==d)return C;var U=R.indexOf(r)!=-1?R.lastIndexOf(r)-1:R.length-2;return[p,w].indexOf(R[U])!=-1&&R.slice(U+1,-1).every(function(Q){return Q==r})&&B==_||N==y&&[v,w].indexOf(B)!=-1?C:I.indexOf(o)!=-1?S:N==o&&B==o?C:E}this.nextBreak=function(m,I){if(I===void 0&&(I=0),I<0)return 0;if(I>=m.length-1)return m.length;for(var L=O(M(m,I)),R=[],N=I+1;N<m.length;N++)if(!P(m,N-1)){var B=O(M(m,N));if(b(L,R,B))return N;R.push(B)}return m.length},this.splitGraphemes=function(m){for(var I=[],L=0,R;(R=this.nextBreak(m,L))<m.length;)I.push(m.slice(L,R)),L=R;return L<m.length&&I.push(m.slice(L)),I},this.iterateGraphemes=function(m){var I=0,L={next:function(){var R,N;return(N=this.nextBreak(m,I))<m.length?(R=m.slice(I,N),I=N,{value:R,done:!1}):I<m.length?(R=m.slice(I),I=m.length,{value:R,done:!1}):{value:void 0,done:!0}}.bind(this)};return typeof Symbol<"u"&&Symbol.iterator&&(L[Symbol.iterator]=function(){return L}),L},this.countGraphemes=function(m){for(var I=0,L=0,R;(R=this.nextBreak(m,L))<m.length;)L=R,I++;return L<m.length&&I++,I};function O(m){return 1536<=m&&m<=1541||m==1757||m==1807||m==2274||m==3406||m==69821||70082<=m&&m<=70083||m==72250||72326<=m&&m<=72329||m==73030?d:m==13?e:m==10?t:0<=m&&m<=9||11<=m&&m<=12||14<=m&&m<=31||127<=m&&m<=159||m==173||m==1564||m==6158||m==8203||8206<=m&&m<=8207||m==8232||m==8233||8234<=m&&m<=8238||8288<=m&&m<=8292||m==8293||8294<=m&&m<=8303||55296<=m&&m<=57343||m==65279||65520<=m&&m<=65528||65529<=m&&m<=65531||113824<=m&&m<=113827||119155<=m&&m<=119162||m==917504||m==917505||917506<=m&&m<=917535||917632<=m&&m<=917759||918e3<=m&&m<=921599?n:768<=m&&m<=879||1155<=m&&m<=1159||1160<=m&&m<=1161||1425<=m&&m<=1469||m==1471||1473<=m&&m<=1474||1476<=m&&m<=1477||m==1479||1552<=m&&m<=1562||1611<=m&&m<=1631||m==1648||1750<=m&&m<=1756||1759<=m&&m<=1764||1767<=m&&m<=1768||1770<=m&&m<=1773||m==1809||1840<=m&&m<=1866||1958<=m&&m<=1968||2027<=m&&m<=2035||2070<=m&&m<=2073||2075<=m&&m<=2083||2085<=m&&m<=2087||2089<=m&&m<=2093||2137<=m&&m<=2139||2260<=m&&m<=2273||2275<=m&&m<=2306||m==2362||m==2364||2369<=m&&m<=2376||m==2381||2385<=m&&m<=2391||2402<=m&&m<=2403||m==2433||m==2492||m==2494||2497<=m&&m<=2500||m==2509||m==2519||2530<=m&&m<=2531||2561<=m&&m<=2562||m==2620||2625<=m&&m<=2626||2631<=m&&m<=2632||2635<=m&&m<=2637||m==2641||2672<=m&&m<=2673||m==2677||2689<=m&&m<=2690||m==2748||2753<=m&&m<=2757||2759<=m&&m<=2760||m==2765||2786<=m&&m<=2787||2810<=m&&m<=2815||m==2817||m==2876||m==2878||m==2879||2881<=m&&m<=2884||m==2893||m==2902||m==2903||2914<=m&&m<=2915||m==2946||m==3006||m==3008||m==3021||m==3031||m==3072||3134<=m&&m<=3136||3142<=m&&m<=3144||3146<=m&&m<=3149||3157<=m&&m<=3158||3170<=m&&m<=3171||m==3201||m==3260||m==3263||m==3266||m==3270||3276<=m&&m<=3277||3285<=m&&m<=3286||3298<=m&&m<=3299||3328<=m&&m<=3329||3387<=m&&m<=3388||m==3390||3393<=m&&m<=3396||m==3405||m==3415||3426<=m&&m<=3427||m==3530||m==3535||3538<=m&&m<=3540||m==3542||m==3551||m==3633||3636<=m&&m<=3642||3655<=m&&m<=3662||m==3761||3764<=m&&m<=3769||3771<=m&&m<=3772||3784<=m&&m<=3789||3864<=m&&m<=3865||m==3893||m==3895||m==3897||3953<=m&&m<=3966||3968<=m&&m<=3972||3974<=m&&m<=3975||3981<=m&&m<=3991||3993<=m&&m<=4028||m==4038||4141<=m&&m<=4144||4146<=m&&m<=4151||4153<=m&&m<=4154||4157<=m&&m<=4158||4184<=m&&m<=4185||4190<=m&&m<=4192||4209<=m&&m<=4212||m==4226||4229<=m&&m<=4230||m==4237||m==4253||4957<=m&&m<=4959||5906<=m&&m<=5908||5938<=m&&m<=5940||5970<=m&&m<=5971||6002<=m&&m<=6003||6068<=m&&m<=6069||6071<=m&&m<=6077||m==6086||6089<=m&&m<=6099||m==6109||6155<=m&&m<=6157||6277<=m&&m<=6278||m==6313||6432<=m&&m<=6434||6439<=m&&m<=6440||m==6450||6457<=m&&m<=6459||6679<=m&&m<=6680||m==6683||m==6742||6744<=m&&m<=6750||m==6752||m==6754||6757<=m&&m<=6764||6771<=m&&m<=6780||m==6783||6832<=m&&m<=6845||m==6846||6912<=m&&m<=6915||m==6964||6966<=m&&m<=6970||m==6972||m==6978||7019<=m&&m<=7027||7040<=m&&m<=7041||7074<=m&&m<=7077||7080<=m&&m<=7081||7083<=m&&m<=7085||m==7142||7144<=m&&m<=7145||m==7149||7151<=m&&m<=7153||7212<=m&&m<=7219||7222<=m&&m<=7223||7376<=m&&m<=7378||7380<=m&&m<=7392||7394<=m&&m<=7400||m==7405||m==7412||7416<=m&&m<=7417||7616<=m&&m<=7673||7675<=m&&m<=7679||m==8204||8400<=m&&m<=8412||8413<=m&&m<=8416||m==8417||8418<=m&&m<=8420||8421<=m&&m<=8432||11503<=m&&m<=11505||m==11647||11744<=m&&m<=11775||12330<=m&&m<=12333||12334<=m&&m<=12335||12441<=m&&m<=12442||m==42607||42608<=m&&m<=42610||42612<=m&&m<=42621||42654<=m&&m<=42655||42736<=m&&m<=42737||m==43010||m==43014||m==43019||43045<=m&&m<=43046||43204<=m&&m<=43205||43232<=m&&m<=43249||43302<=m&&m<=43309||43335<=m&&m<=43345||43392<=m&&m<=43394||m==43443||43446<=m&&m<=43449||m==43452||m==43493||43561<=m&&m<=43566||43569<=m&&m<=43570||43573<=m&&m<=43574||m==43587||m==43596||m==43644||m==43696||43698<=m&&m<=43700||43703<=m&&m<=43704||43710<=m&&m<=43711||m==43713||43756<=m&&m<=43757||m==43766||m==44005||m==44008||m==44013||m==64286||65024<=m&&m<=65039||65056<=m&&m<=65071||65438<=m&&m<=65439||m==66045||m==66272||66422<=m&&m<=66426||68097<=m&&m<=68099||68101<=m&&m<=68102||68108<=m&&m<=68111||68152<=m&&m<=68154||m==68159||68325<=m&&m<=68326||m==69633||69688<=m&&m<=69702||69759<=m&&m<=69761||69811<=m&&m<=69814||69817<=m&&m<=69818||69888<=m&&m<=69890||69927<=m&&m<=69931||69933<=m&&m<=69940||m==70003||70016<=m&&m<=70017||70070<=m&&m<=70078||70090<=m&&m<=70092||70191<=m&&m<=70193||m==70196||70198<=m&&m<=70199||m==70206||m==70367||70371<=m&&m<=70378||70400<=m&&m<=70401||m==70460||m==70462||m==70464||m==70487||70502<=m&&m<=70508||70512<=m&&m<=70516||70712<=m&&m<=70719||70722<=m&&m<=70724||m==70726||m==70832||70835<=m&&m<=70840||m==70842||m==70845||70847<=m&&m<=70848||70850<=m&&m<=70851||m==71087||71090<=m&&m<=71093||71100<=m&&m<=71101||71103<=m&&m<=71104||71132<=m&&m<=71133||71219<=m&&m<=71226||m==71229||71231<=m&&m<=71232||m==71339||m==71341||71344<=m&&m<=71349||m==71351||71453<=m&&m<=71455||71458<=m&&m<=71461||71463<=m&&m<=71467||72193<=m&&m<=72198||72201<=m&&m<=72202||72243<=m&&m<=72248||72251<=m&&m<=72254||m==72263||72273<=m&&m<=72278||72281<=m&&m<=72283||72330<=m&&m<=72342||72344<=m&&m<=72345||72752<=m&&m<=72758||72760<=m&&m<=72765||m==72767||72850<=m&&m<=72871||72874<=m&&m<=72880||72882<=m&&m<=72883||72885<=m&&m<=72886||73009<=m&&m<=73014||m==73018||73020<=m&&m<=73021||73023<=m&&m<=73029||m==73031||92912<=m&&m<=92916||92976<=m&&m<=92982||94095<=m&&m<=94098||113821<=m&&m<=113822||m==119141||119143<=m&&m<=119145||119150<=m&&m<=119154||119163<=m&&m<=119170||119173<=m&&m<=119179||119210<=m&&m<=119213||119362<=m&&m<=119364||121344<=m&&m<=121398||121403<=m&&m<=121452||m==121461||m==121476||121499<=m&&m<=121503||121505<=m&&m<=121519||122880<=m&&m<=122886||122888<=m&&m<=122904||122907<=m&&m<=122913||122915<=m&&m<=122916||122918<=m&&m<=122922||125136<=m&&m<=125142||125252<=m&&m<=125258||917536<=m&&m<=917631||917760<=m&&m<=917999?r:127462<=m&&m<=127487?o:m==2307||m==2363||2366<=m&&m<=2368||2377<=m&&m<=2380||2382<=m&&m<=2383||2434<=m&&m<=2435||2495<=m&&m<=2496||2503<=m&&m<=2504||2507<=m&&m<=2508||m==2563||2622<=m&&m<=2624||m==2691||2750<=m&&m<=2752||m==2761||2763<=m&&m<=2764||2818<=m&&m<=2819||m==2880||2887<=m&&m<=2888||2891<=m&&m<=2892||m==3007||3009<=m&&m<=3010||3014<=m&&m<=3016||3018<=m&&m<=3020||3073<=m&&m<=3075||3137<=m&&m<=3140||3202<=m&&m<=3203||m==3262||3264<=m&&m<=3265||3267<=m&&m<=3268||3271<=m&&m<=3272||3274<=m&&m<=3275||3330<=m&&m<=3331||3391<=m&&m<=3392||3398<=m&&m<=3400||3402<=m&&m<=3404||3458<=m&&m<=3459||3536<=m&&m<=3537||3544<=m&&m<=3550||3570<=m&&m<=3571||m==3635||m==3763||3902<=m&&m<=3903||m==3967||m==4145||4155<=m&&m<=4156||4182<=m&&m<=4183||m==4228||m==6070||6078<=m&&m<=6085||6087<=m&&m<=6088||6435<=m&&m<=6438||6441<=m&&m<=6443||6448<=m&&m<=6449||6451<=m&&m<=6456||6681<=m&&m<=6682||m==6741||m==6743||6765<=m&&m<=6770||m==6916||m==6965||m==6971||6973<=m&&m<=6977||6979<=m&&m<=6980||m==7042||m==7073||7078<=m&&m<=7079||m==7082||m==7143||7146<=m&&m<=7148||m==7150||7154<=m&&m<=7155||7204<=m&&m<=7211||7220<=m&&m<=7221||m==7393||7410<=m&&m<=7411||m==7415||43043<=m&&m<=43044||m==43047||43136<=m&&m<=43137||43188<=m&&m<=43203||43346<=m&&m<=43347||m==43395||43444<=m&&m<=43445||43450<=m&&m<=43451||43453<=m&&m<=43456||43567<=m&&m<=43568||43571<=m&&m<=43572||m==43597||m==43755||43758<=m&&m<=43759||m==43765||44003<=m&&m<=44004||44006<=m&&m<=44007||44009<=m&&m<=44010||m==44012||m==69632||m==69634||m==69762||69808<=m&&m<=69810||69815<=m&&m<=69816||m==69932||m==70018||70067<=m&&m<=70069||70079<=m&&m<=70080||70188<=m&&m<=70190||70194<=m&&m<=70195||m==70197||70368<=m&&m<=70370||70402<=m&&m<=70403||m==70463||70465<=m&&m<=70468||70471<=m&&m<=70472||70475<=m&&m<=70477||70498<=m&&m<=70499||70709<=m&&m<=70711||70720<=m&&m<=70721||m==70725||70833<=m&&m<=70834||m==70841||70843<=m&&m<=70844||m==70846||m==70849||71088<=m&&m<=71089||71096<=m&&m<=71099||m==71102||71216<=m&&m<=71218||71227<=m&&m<=71228||m==71230||m==71340||71342<=m&&m<=71343||m==71350||71456<=m&&m<=71457||m==71462||72199<=m&&m<=72200||m==72249||72279<=m&&m<=72280||m==72343||m==72751||m==72766||m==72873||m==72881||m==72884||94033<=m&&m<=94078||m==119142||m==119149?a:4352<=m&&m<=4447||43360<=m&&m<=43388?s:4448<=m&&m<=4519||55216<=m&&m<=55238?u:4520<=m&&m<=4607||55243<=m&&m<=55291?l:m==44032||m==44060||m==44088||m==44116||m==44144||m==44172||m==44200||m==44228||m==44256||m==44284||m==44312||m==44340||m==44368||m==44396||m==44424||m==44452||m==44480||m==44508||m==44536||m==44564||m==44592||m==44620||m==44648||m==44676||m==44704||m==44732||m==44760||m==44788||m==44816||m==44844||m==44872||m==44900||m==44928||m==44956||m==44984||m==45012||m==45040||m==45068||m==45096||m==45124||m==45152||m==45180||m==45208||m==45236||m==45264||m==45292||m==45320||m==45348||m==45376||m==45404||m==45432||m==45460||m==45488||m==45516||m==45544||m==45572||m==45600||m==45628||m==45656||m==45684||m==45712||m==45740||m==45768||m==45796||m==45824||m==45852||m==45880||m==45908||m==45936||m==45964||m==45992||m==46020||m==46048||m==46076||m==46104||m==46132||m==46160||m==46188||m==46216||m==46244||m==46272||m==46300||m==46328||m==46356||m==46384||m==46412||m==46440||m==46468||m==46496||m==46524||m==46552||m==46580||m==46608||m==46636||m==46664||m==46692||m==46720||m==46748||m==46776||m==46804||m==46832||m==46860||m==46888||m==46916||m==46944||m==46972||m==47e3||m==47028||m==47056||m==47084||m==47112||m==47140||m==47168||m==47196||m==47224||m==47252||m==47280||m==47308||m==47336||m==47364||m==47392||m==47420||m==47448||m==47476||m==47504||m==47532||m==47560||m==47588||m==47616||m==47644||m==47672||m==47700||m==47728||m==47756||m==47784||m==47812||m==47840||m==47868||m==47896||m==47924||m==47952||m==47980||m==48008||m==48036||m==48064||m==48092||m==48120||m==48148||m==48176||m==48204||m==48232||m==48260||m==48288||m==48316||m==48344||m==48372||m==48400||m==48428||m==48456||m==48484||m==48512||m==48540||m==48568||m==48596||m==48624||m==48652||m==48680||m==48708||m==48736||m==48764||m==48792||m==48820||m==48848||m==48876||m==48904||m==48932||m==48960||m==48988||m==49016||m==49044||m==49072||m==49100||m==49128||m==49156||m==49184||m==49212||m==49240||m==49268||m==49296||m==49324||m==49352||m==49380||m==49408||m==49436||m==49464||m==49492||m==49520||m==49548||m==49576||m==49604||m==49632||m==49660||m==49688||m==49716||m==49744||m==49772||m==49800||m==49828||m==49856||m==49884||m==49912||m==49940||m==49968||m==49996||m==50024||m==50052||m==50080||m==50108||m==50136||m==50164||m==50192||m==50220||m==50248||m==50276||m==50304||m==50332||m==50360||m==50388||m==50416||m==50444||m==50472||m==50500||m==50528||m==50556||m==50584||m==50612||m==50640||m==50668||m==50696||m==50724||m==50752||m==50780||m==50808||m==50836||m==50864||m==50892||m==50920||m==50948||m==50976||m==51004||m==51032||m==51060||m==51088||m==51116||m==51144||m==51172||m==51200||m==51228||m==51256||m==51284||m==51312||m==51340||m==51368||m==51396||m==51424||m==51452||m==51480||m==51508||m==51536||m==51564||m==51592||m==51620||m==51648||m==51676||m==51704||m==51732||m==51760||m==51788||m==51816||m==51844||m==51872||m==51900||m==51928||m==51956||m==51984||m==52012||m==52040||m==52068||m==52096||m==52124||m==52152||m==52180||m==52208||m==52236||m==52264||m==52292||m==52320||m==52348||m==52376||m==52404||m==52432||m==52460||m==52488||m==52516||m==52544||m==52572||m==52600||m==52628||m==52656||m==52684||m==52712||m==52740||m==52768||m==52796||m==52824||m==52852||m==52880||m==52908||m==52936||m==52964||m==52992||m==53020||m==53048||m==53076||m==53104||m==53132||m==53160||m==53188||m==53216||m==53244||m==53272||m==53300||m==53328||m==53356||m==53384||m==53412||m==53440||m==53468||m==53496||m==53524||m==53552||m==53580||m==53608||m==53636||m==53664||m==53692||m==53720||m==53748||m==53776||m==53804||m==53832||m==53860||m==53888||m==53916||m==53944||m==53972||m==54e3||m==54028||m==54056||m==54084||m==54112||m==54140||m==54168||m==54196||m==54224||m==54252||m==54280||m==54308||m==54336||m==54364||m==54392||m==54420||m==54448||m==54476||m==54504||m==54532||m==54560||m==54588||m==54616||m==54644||m==54672||m==54700||m==54728||m==54756||m==54784||m==54812||m==54840||m==54868||m==54896||m==54924||m==54952||m==54980||m==55008||m==55036||m==55064||m==55092||m==55120||m==55148||m==55176?c:44033<=m&&m<=44059||44061<=m&&m<=44087||44089<=m&&m<=44115||44117<=m&&m<=44143||44145<=m&&m<=44171||44173<=m&&m<=44199||44201<=m&&m<=44227||44229<=m&&m<=44255||44257<=m&&m<=44283||44285<=m&&m<=44311||44313<=m&&m<=44339||44341<=m&&m<=44367||44369<=m&&m<=44395||44397<=m&&m<=44423||44425<=m&&m<=44451||44453<=m&&m<=44479||44481<=m&&m<=44507||44509<=m&&m<=44535||44537<=m&&m<=44563||44565<=m&&m<=44591||44593<=m&&m<=44619||44621<=m&&m<=44647||44649<=m&&m<=44675||44677<=m&&m<=44703||44705<=m&&m<=44731||44733<=m&&m<=44759||44761<=m&&m<=44787||44789<=m&&m<=44815||44817<=m&&m<=44843||44845<=m&&m<=44871||44873<=m&&m<=44899||44901<=m&&m<=44927||44929<=m&&m<=44955||44957<=m&&m<=44983||44985<=m&&m<=45011||45013<=m&&m<=45039||45041<=m&&m<=45067||45069<=m&&m<=45095||45097<=m&&m<=45123||45125<=m&&m<=45151||45153<=m&&m<=45179||45181<=m&&m<=45207||45209<=m&&m<=45235||45237<=m&&m<=45263||45265<=m&&m<=45291||45293<=m&&m<=45319||45321<=m&&m<=45347||45349<=m&&m<=45375||45377<=m&&m<=45403||45405<=m&&m<=45431||45433<=m&&m<=45459||45461<=m&&m<=45487||45489<=m&&m<=45515||45517<=m&&m<=45543||45545<=m&&m<=45571||45573<=m&&m<=45599||45601<=m&&m<=45627||45629<=m&&m<=45655||45657<=m&&m<=45683||45685<=m&&m<=45711||45713<=m&&m<=45739||45741<=m&&m<=45767||45769<=m&&m<=45795||45797<=m&&m<=45823||45825<=m&&m<=45851||45853<=m&&m<=45879||45881<=m&&m<=45907||45909<=m&&m<=45935||45937<=m&&m<=45963||45965<=m&&m<=45991||45993<=m&&m<=46019||46021<=m&&m<=46047||46049<=m&&m<=46075||46077<=m&&m<=46103||46105<=m&&m<=46131||46133<=m&&m<=46159||46161<=m&&m<=46187||46189<=m&&m<=46215||46217<=m&&m<=46243||46245<=m&&m<=46271||46273<=m&&m<=46299||46301<=m&&m<=46327||46329<=m&&m<=46355||46357<=m&&m<=46383||46385<=m&&m<=46411||46413<=m&&m<=46439||46441<=m&&m<=46467||46469<=m&&m<=46495||46497<=m&&m<=46523||46525<=m&&m<=46551||46553<=m&&m<=46579||46581<=m&&m<=46607||46609<=m&&m<=46635||46637<=m&&m<=46663||46665<=m&&m<=46691||46693<=m&&m<=46719||46721<=m&&m<=46747||46749<=m&&m<=46775||46777<=m&&m<=46803||46805<=m&&m<=46831||46833<=m&&m<=46859||46861<=m&&m<=46887||46889<=m&&m<=46915||46917<=m&&m<=46943||46945<=m&&m<=46971||46973<=m&&m<=46999||47001<=m&&m<=47027||47029<=m&&m<=47055||47057<=m&&m<=47083||47085<=m&&m<=47111||47113<=m&&m<=47139||47141<=m&&m<=47167||47169<=m&&m<=47195||47197<=m&&m<=47223||47225<=m&&m<=47251||47253<=m&&m<=47279||47281<=m&&m<=47307||47309<=m&&m<=47335||47337<=m&&m<=47363||47365<=m&&m<=47391||47393<=m&&m<=47419||47421<=m&&m<=47447||47449<=m&&m<=47475||47477<=m&&m<=47503||47505<=m&&m<=47531||47533<=m&&m<=47559||47561<=m&&m<=47587||47589<=m&&m<=47615||47617<=m&&m<=47643||47645<=m&&m<=47671||47673<=m&&m<=47699||47701<=m&&m<=47727||47729<=m&&m<=47755||47757<=m&&m<=47783||47785<=m&&m<=47811||47813<=m&&m<=47839||47841<=m&&m<=47867||47869<=m&&m<=47895||47897<=m&&m<=47923||47925<=m&&m<=47951||47953<=m&&m<=47979||47981<=m&&m<=48007||48009<=m&&m<=48035||48037<=m&&m<=48063||48065<=m&&m<=48091||48093<=m&&m<=48119||48121<=m&&m<=48147||48149<=m&&m<=48175||48177<=m&&m<=48203||48205<=m&&m<=48231||48233<=m&&m<=48259||48261<=m&&m<=48287||48289<=m&&m<=48315||48317<=m&&m<=48343||48345<=m&&m<=48371||48373<=m&&m<=48399||48401<=m&&m<=48427||48429<=m&&m<=48455||48457<=m&&m<=48483||48485<=m&&m<=48511||48513<=m&&m<=48539||48541<=m&&m<=48567||48569<=m&&m<=48595||48597<=m&&m<=48623||48625<=m&&m<=48651||48653<=m&&m<=48679||48681<=m&&m<=48707||48709<=m&&m<=48735||48737<=m&&m<=48763||48765<=m&&m<=48791||48793<=m&&m<=48819||48821<=m&&m<=48847||48849<=m&&m<=48875||48877<=m&&m<=48903||48905<=m&&m<=48931||48933<=m&&m<=48959||48961<=m&&m<=48987||48989<=m&&m<=49015||49017<=m&&m<=49043||49045<=m&&m<=49071||49073<=m&&m<=49099||49101<=m&&m<=49127||49129<=m&&m<=49155||49157<=m&&m<=49183||49185<=m&&m<=49211||49213<=m&&m<=49239||49241<=m&&m<=49267||49269<=m&&m<=49295||49297<=m&&m<=49323||49325<=m&&m<=49351||49353<=m&&m<=49379||49381<=m&&m<=49407||49409<=m&&m<=49435||49437<=m&&m<=49463||49465<=m&&m<=49491||49493<=m&&m<=49519||49521<=m&&m<=49547||49549<=m&&m<=49575||49577<=m&&m<=49603||49605<=m&&m<=49631||49633<=m&&m<=49659||49661<=m&&m<=49687||49689<=m&&m<=49715||49717<=m&&m<=49743||49745<=m&&m<=49771||49773<=m&&m<=49799||49801<=m&&m<=49827||49829<=m&&m<=49855||49857<=m&&m<=49883||49885<=m&&m<=49911||49913<=m&&m<=49939||49941<=m&&m<=49967||49969<=m&&m<=49995||49997<=m&&m<=50023||50025<=m&&m<=50051||50053<=m&&m<=50079||50081<=m&&m<=50107||50109<=m&&m<=50135||50137<=m&&m<=50163||50165<=m&&m<=50191||50193<=m&&m<=50219||50221<=m&&m<=50247||50249<=m&&m<=50275||50277<=m&&m<=50303||50305<=m&&m<=50331||50333<=m&&m<=50359||50361<=m&&m<=50387||50389<=m&&m<=50415||50417<=m&&m<=50443||50445<=m&&m<=50471||50473<=m&&m<=50499||50501<=m&&m<=50527||50529<=m&&m<=50555||50557<=m&&m<=50583||50585<=m&&m<=50611||50613<=m&&m<=50639||50641<=m&&m<=50667||50669<=m&&m<=50695||50697<=m&&m<=50723||50725<=m&&m<=50751||50753<=m&&m<=50779||50781<=m&&m<=50807||50809<=m&&m<=50835||50837<=m&&m<=50863||50865<=m&&m<=50891||50893<=m&&m<=50919||50921<=m&&m<=50947||50949<=m&&m<=50975||50977<=m&&m<=51003||51005<=m&&m<=51031||51033<=m&&m<=51059||51061<=m&&m<=51087||51089<=m&&m<=51115||51117<=m&&m<=51143||51145<=m&&m<=51171||51173<=m&&m<=51199||51201<=m&&m<=51227||51229<=m&&m<=51255||51257<=m&&m<=51283||51285<=m&&m<=51311||51313<=m&&m<=51339||51341<=m&&m<=51367||51369<=m&&m<=51395||51397<=m&&m<=51423||51425<=m&&m<=51451||51453<=m&&m<=51479||51481<=m&&m<=51507||51509<=m&&m<=51535||51537<=m&&m<=51563||51565<=m&&m<=51591||51593<=m&&m<=51619||51621<=m&&m<=51647||51649<=m&&m<=51675||51677<=m&&m<=51703||51705<=m&&m<=51731||51733<=m&&m<=51759||51761<=m&&m<=51787||51789<=m&&m<=51815||51817<=m&&m<=51843||51845<=m&&m<=51871||51873<=m&&m<=51899||51901<=m&&m<=51927||51929<=m&&m<=51955||51957<=m&&m<=51983||51985<=m&&m<=52011||52013<=m&&m<=52039||52041<=m&&m<=52067||52069<=m&&m<=52095||52097<=m&&m<=52123||52125<=m&&m<=52151||52153<=m&&m<=52179||52181<=m&&m<=52207||52209<=m&&m<=52235||52237<=m&&m<=52263||52265<=m&&m<=52291||52293<=m&&m<=52319||52321<=m&&m<=52347||52349<=m&&m<=52375||52377<=m&&m<=52403||52405<=m&&m<=52431||52433<=m&&m<=52459||52461<=m&&m<=52487||52489<=m&&m<=52515||52517<=m&&m<=52543||52545<=m&&m<=52571||52573<=m&&m<=52599||52601<=m&&m<=52627||52629<=m&&m<=52655||52657<=m&&m<=52683||52685<=m&&m<=52711||52713<=m&&m<=52739||52741<=m&&m<=52767||52769<=m&&m<=52795||52797<=m&&m<=52823||52825<=m&&m<=52851||52853<=m&&m<=52879||52881<=m&&m<=52907||52909<=m&&m<=52935||52937<=m&&m<=52963||52965<=m&&m<=52991||52993<=m&&m<=53019||53021<=m&&m<=53047||53049<=m&&m<=53075||53077<=m&&m<=53103||53105<=m&&m<=53131||53133<=m&&m<=53159||53161<=m&&m<=53187||53189<=m&&m<=53215||53217<=m&&m<=53243||53245<=m&&m<=53271||53273<=m&&m<=53299||53301<=m&&m<=53327||53329<=m&&m<=53355||53357<=m&&m<=53383||53385<=m&&m<=53411||53413<=m&&m<=53439||53441<=m&&m<=53467||53469<=m&&m<=53495||53497<=m&&m<=53523||53525<=m&&m<=53551||53553<=m&&m<=53579||53581<=m&&m<=53607||53609<=m&&m<=53635||53637<=m&&m<=53663||53665<=m&&m<=53691||53693<=m&&m<=53719||53721<=m&&m<=53747||53749<=m&&m<=53775||53777<=m&&m<=53803||53805<=m&&m<=53831||53833<=m&&m<=53859||53861<=m&&m<=53887||53889<=m&&m<=53915||53917<=m&&m<=53943||53945<=m&&m<=53971||53973<=m&&m<=53999||54001<=m&&m<=54027||54029<=m&&m<=54055||54057<=m&&m<=54083||54085<=m&&m<=54111||54113<=m&&m<=54139||54141<=m&&m<=54167||54169<=m&&m<=54195||54197<=m&&m<=54223||54225<=m&&m<=54251||54253<=m&&m<=54279||54281<=m&&m<=54307||54309<=m&&m<=54335||54337<=m&&m<=54363||54365<=m&&m<=54391||54393<=m&&m<=54419||54421<=m&&m<=54447||54449<=m&&m<=54475||54477<=m&&m<=54503||54505<=m&&m<=54531||54533<=m&&m<=54559||54561<=m&&m<=54587||54589<=m&&m<=54615||54617<=m&&m<=54643||54645<=m&&m<=54671||54673<=m&&m<=54699||54701<=m&&m<=54727||54729<=m&&m<=54755||54757<=m&&m<=54783||54785<=m&&m<=54811||54813<=m&&m<=54839||54841<=m&&m<=54867||54869<=m&&m<=54895||54897<=m&&m<=54923||54925<=m&&m<=54951||54953<=m&&m<=54979||54981<=m&&m<=55007||55009<=m&&m<=55035||55037<=m&&m<=55063||55065<=m&&m<=55091||55093<=m&&m<=55119||55121<=m&&m<=55147||55149<=m&&m<=55175||55177<=m&&m<=55203?f:m==9757||m==9977||9994<=m&&m<=9997||m==127877||127938<=m&&m<=127940||m==127943||127946<=m&&m<=127948||128066<=m&&m<=128067||128070<=m&&m<=128080||m==128110||128112<=m&&m<=128120||m==128124||128129<=m&&m<=128131||128133<=m&&m<=128135||m==128170||128372<=m&&m<=128373||m==128378||m==128400||128405<=m&&m<=128406||128581<=m&&m<=128583||128587<=m&&m<=128591||m==128675||128692<=m&&m<=128694||m==128704||m==128716||129304<=m&&m<=129308||129310<=m&&m<=129311||m==129318||129328<=m&&m<=129337||129341<=m&&m<=129342||129489<=m&&m<=129501?p:127995<=m&&m<=127999?_:m==8205?y:m==9792||m==9794||9877<=m&&m<=9878||m==9992||m==10084||m==127752||m==127806||m==127859||m==127891||m==127908||m==127912||m==127979||m==127981||m==128139||128187<=m&&m<=128188||m==128295||m==128300||m==128488||m==128640||m==128658?v:128102<=m&&m<=128105?w:h}return this}typeof aM<"u"&&aM.exports&&(aM.exports=OTe)});var $Z=mm((NF,BF)=>{/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */(function(e,t){typeof NF=="object"&&typeof BF<"u"?BF.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.DOMPurify=t())})(NF,function(){"use strict";function e(Ke){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Qe){return typeof Qe}:function(Qe){return Qe&&typeof Symbol=="function"&&Qe.constructor===Symbol&&Qe!==Symbol.prototype?"symbol":typeof Qe},e(Ke)}function t(Ke,Qe){return t=Object.setPrototypeOf||function(En,po){return En.__proto__=po,En},t(Ke,Qe)}function n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function r(Ke,Qe,zt){return n()?r=Reflect.construct:r=function(po,Ll,Xh){var Lf=[null];Lf.push.apply(Lf,Ll);var fm=Function.bind.apply(po,Lf),jh=new fm;return Xh&&t(jh,Xh.prototype),jh},r.apply(null,arguments)}function o(Ke){return a(Ke)||s(Ke)||u(Ke)||c()}function a(Ke){if(Array.isArray(Ke))return l(Ke)}function s(Ke){if(typeof Symbol<"u"&&Ke[Symbol.iterator]!=null||Ke["@@iterator"]!=null)return Array.from(Ke)}function u(Ke,Qe){if(!!Ke){if(typeof Ke=="string")return l(Ke,Qe);var zt=Object.prototype.toString.call(Ke).slice(8,-1);if(zt==="Object"&&Ke.constructor&&(zt=Ke.constructor.name),zt==="Map"||zt==="Set")return Array.from(Ke);if(zt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(zt))return l(Ke,Qe)}}function l(Ke,Qe){(Qe==null||Qe>Ke.length)&&(Qe=Ke.length);for(var zt=0,En=new Array(Qe);zt<Qe;zt++)En[zt]=Ke[zt];return En}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=Object.hasOwnProperty,h=Object.setPrototypeOf,d=Object.isFrozen,p=Object.getPrototypeOf,_=Object.getOwnPropertyDescriptor,y=Object.freeze,v=Object.seal,w=Object.create,C=typeof Reflect<"u"&&Reflect,E=C.apply,S=C.construct;E||(E=function(Qe,zt,En){return Qe.apply(zt,En)}),y||(y=function(Qe){return Qe}),v||(v=function(Qe){return Qe}),S||(S=function(Qe,zt){return r(Qe,o(zt))});var A=N(Array.prototype.forEach),D=N(Array.prototype.pop),P=N(Array.prototype.push),M=N(String.prototype.toLowerCase),b=N(String.prototype.match),O=N(String.prototype.replace),m=N(String.prototype.indexOf),I=N(String.prototype.trim),L=N(RegExp.prototype.test),R=B(TypeError);function N(Ke){return function(Qe){for(var zt=arguments.length,En=new Array(zt>1?zt-1:0),po=1;po<zt;po++)En[po-1]=arguments[po];return E(Ke,Qe,En)}}function B(Ke){return function(){for(var Qe=arguments.length,zt=new Array(Qe),En=0;En<Qe;En++)zt[En]=arguments[En];return S(Ke,zt)}}function V(Ke,Qe,zt){zt=zt||M,h&&h(Ke,null);for(var En=Qe.length;En--;){var po=Qe[En];if(typeof po=="string"){var Ll=zt(po);Ll!==po&&(d(Qe)||(Qe[En]=Ll),po=Ll)}Ke[po]=!0}return Ke}function z(Ke){var Qe=w(null),zt;for(zt in Ke)E(f,Ke,[zt])&&(Qe[zt]=Ke[zt]);return Qe}function U(Ke,Qe){for(;Ke!==null;){var zt=_(Ke,Qe);if(zt){if(zt.get)return N(zt.get);if(typeof zt.value=="function")return N(zt.value)}Ke=p(Ke)}function En(po){return console.warn("fallback value for",po),null}return En}var Q=y(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ne=y(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),se=y(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),de=y(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pe=y(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ve=y(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ft=y(["#text"]),pt=y(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Xt=y(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),At=y(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wt=y(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Rr=v(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gi=v(/<%[\w\W]*|[\w\W]*%>/gm),$i=v(/^data-[\-\w.\u00B7-\uFFFF]/),ut=v(/^aria-[\-\w]+$/),ai=v(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),rs=v(/^(?:\w+script|data):/i),fc=v(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Xd=v(/^html$/i),jd=function(){return typeof window>"u"?null:window},ub=function(Qe,zt){if(e(Qe)!=="object"||typeof Qe.createPolicy!="function")return null;var En=null,po="data-tt-policy-suffix";zt.currentScript&&zt.currentScript.hasAttribute(po)&&(En=zt.currentScript.getAttribute(po));var Ll="dompurify"+(En?"#"+En:"");try{return Qe.createPolicy(Ll,{createHTML:function(Lf){return Lf},createScriptURL:function(Lf){return Lf}})}catch{return console.warn("TrustedTypes policy "+Ll+" could not be created."),null}};function zw(){var Ke=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jd(),Qe=function(ue){return zw(ue)};if(Qe.version="2.4.0",Qe.removed=[],!Ke||!Ke.document||Ke.document.nodeType!==9)return Qe.isSupported=!1,Qe;var zt=Ke.document,En=Ke.document,po=Ke.DocumentFragment,Ll=Ke.HTMLTemplateElement,Xh=Ke.Node,Lf=Ke.Element,fm=Ke.NodeFilter,jh=Ke.NamedNodeMap,Fv=jh===void 0?Ke.NamedNodeMap||Ke.MozNamedAttrMap:jh,hm=Ke.HTMLFormElement,lb=Ke.DOMParser,x_=Ke.trustedTypes,hc=Lf.prototype,Kh=U(hc,"cloneNode"),Zh=U(hc,"nextSibling"),Qh=U(hc,"childNodes"),Vw=U(hc,"parentNode");if(typeof Ll=="function"){var zv=En.createElement("template");zv.content&&zv.content.ownerDocument&&(En=zv.content.ownerDocument)}var Rl=ub(x_,zt),Vv=Rl?Rl.createHTML(""):"",dc=En,mo=dc.implementation,Vg=dc.createNodeIterator,w_=dc.createDocumentFragment,cb=dc.getElementsByTagName,kv=zt.importNode,Kd={};try{Kd=z(En).documentMode?En.documentMode:{}}catch{}var Zd={};Qe.isSupported=typeof Vw=="function"&&mo&&typeof mo.createHTMLDocument<"u"&&Kd!==9;var jR=Rr,KR=gi,xoe=$i,woe=ut,Eoe=rs,FV=fc,ZR=ai,js=null,zV=V({},[].concat(o(Q),o(ne),o(se),o(pe),o(ft))),Pu=null,VV=V({},[].concat(o(pt),o(Xt),o(At),o(wt))),is=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),kw=null,QR=null,kV=!0,JR=!0,GV=!1,Gv=!1,E_=!1,$R=!1,eO=!1,Uv=!1,fb=!1,hb=!1,UV=!0,HV=!1,Toe="user-content-",tO=!0,Gw=!1,Hv={},qv=null,qV=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),WV=null,YV=V({},["audio","video","img","source","image","track"]),nO=null,XV=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rO="http://www.w3.org/1998/Math/MathML",iO="http://www.w3.org/2000/svg",kg="http://www.w3.org/1999/xhtml",db=kg,oO=!1,Wv,Soe=["application/xhtml+xml","text/html"],Aoe="text/html",Ks,Yv=null,boe=En.createElement("form"),jV=function(ue){return ue instanceof RegExp||ue instanceof Function},aO=function(ue){Yv&&Yv===ue||((!ue||e(ue)!=="object")&&(ue={}),ue=z(ue),Wv=Soe.indexOf(ue.PARSER_MEDIA_TYPE)===-1?Wv=Aoe:Wv=ue.PARSER_MEDIA_TYPE,Ks=Wv==="application/xhtml+xml"?function(ze){return ze}:M,js="ALLOWED_TAGS"in ue?V({},ue.ALLOWED_TAGS,Ks):zV,Pu="ALLOWED_ATTR"in ue?V({},ue.ALLOWED_ATTR,Ks):VV,nO="ADD_URI_SAFE_ATTR"in ue?V(z(XV),ue.ADD_URI_SAFE_ATTR,Ks):XV,WV="ADD_DATA_URI_TAGS"in ue?V(z(YV),ue.ADD_DATA_URI_TAGS,Ks):YV,qv="FORBID_CONTENTS"in ue?V({},ue.FORBID_CONTENTS,Ks):qV,kw="FORBID_TAGS"in ue?V({},ue.FORBID_TAGS,Ks):{},QR="FORBID_ATTR"in ue?V({},ue.FORBID_ATTR,Ks):{},Hv="USE_PROFILES"in ue?ue.USE_PROFILES:!1,kV=ue.ALLOW_ARIA_ATTR!==!1,JR=ue.ALLOW_DATA_ATTR!==!1,GV=ue.ALLOW_UNKNOWN_PROTOCOLS||!1,Gv=ue.SAFE_FOR_TEMPLATES||!1,E_=ue.WHOLE_DOCUMENT||!1,Uv=ue.RETURN_DOM||!1,fb=ue.RETURN_DOM_FRAGMENT||!1,hb=ue.RETURN_TRUSTED_TYPE||!1,eO=ue.FORCE_BODY||!1,UV=ue.SANITIZE_DOM!==!1,HV=ue.SANITIZE_NAMED_PROPS||!1,tO=ue.KEEP_CONTENT!==!1,Gw=ue.IN_PLACE||!1,ZR=ue.ALLOWED_URI_REGEXP||ZR,db=ue.NAMESPACE||kg,ue.CUSTOM_ELEMENT_HANDLING&&jV(ue.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(is.tagNameCheck=ue.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ue.CUSTOM_ELEMENT_HANDLING&&jV(ue.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(is.attributeNameCheck=ue.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ue.CUSTOM_ELEMENT_HANDLING&&typeof ue.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(is.allowCustomizedBuiltInElements=ue.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Gv&&(JR=!1),fb&&(Uv=!0),Hv&&(js=V({},o(ft)),Pu=[],Hv.html===!0&&(V(js,Q),V(Pu,pt)),Hv.svg===!0&&(V(js,ne),V(Pu,Xt),V(Pu,wt)),Hv.svgFilters===!0&&(V(js,se),V(Pu,Xt),V(Pu,wt)),Hv.mathMl===!0&&(V(js,pe),V(Pu,At),V(Pu,wt))),ue.ADD_TAGS&&(js===zV&&(js=z(js)),V(js,ue.ADD_TAGS,Ks)),ue.ADD_ATTR&&(Pu===VV&&(Pu=z(Pu)),V(Pu,ue.ADD_ATTR,Ks)),ue.ADD_URI_SAFE_ATTR&&V(nO,ue.ADD_URI_SAFE_ATTR,Ks),ue.FORBID_CONTENTS&&(qv===qV&&(qv=z(qv)),V(qv,ue.FORBID_CONTENTS,Ks)),tO&&(js["#text"]=!0),E_&&V(js,["html","head","body"]),js.table&&(V(js,["tbody"]),delete kw.tbody),y&&y(ue),Yv=ue)},KV=V({},["mi","mo","mn","ms","mtext"]),ZV=V({},["foreignobject","desc","title","annotation-xml"]),Ioe=V({},["title","style","font","a","script"]),pb=V({},ne);V(pb,se),V(pb,de);var sO=V({},pe);V(sO,ve);var Doe=function(ue){var ze=Vw(ue);(!ze||!ze.tagName)&&(ze={namespaceURI:kg,tagName:"template"});var ot=M(ue.tagName),Gi=M(ze.tagName);return ue.namespaceURI===iO?ze.namespaceURI===kg?ot==="svg":ze.namespaceURI===rO?ot==="svg"&&(Gi==="annotation-xml"||KV[Gi]):Boolean(pb[ot]):ue.namespaceURI===rO?ze.namespaceURI===kg?ot==="math":ze.namespaceURI===iO?ot==="math"&&ZV[Gi]:Boolean(sO[ot]):ue.namespaceURI===kg?ze.namespaceURI===iO&&!ZV[Gi]||ze.namespaceURI===rO&&!KV[Gi]?!1:!sO[ot]&&(Ioe[ot]||!pb[ot]):!1},dm=function(ue){P(Qe.removed,{element:ue});try{ue.parentNode.removeChild(ue)}catch{try{ue.outerHTML=Vv}catch{ue.remove()}}},uO=function(ue,ze){try{P(Qe.removed,{attribute:ze.getAttributeNode(ue),from:ze})}catch{P(Qe.removed,{attribute:null,from:ze})}if(ze.removeAttribute(ue),ue==="is"&&!Pu[ue])if(Uv||fb)try{dm(ze)}catch{}else try{ze.setAttribute(ue,"")}catch{}},QV=function(ue){var ze,ot;if(eO)ue="<remove></remove>"+ue;else{var Gi=b(ue,/^[\r\n\t ]+/);ot=Gi&&Gi[0]}Wv==="application/xhtml+xml"&&(ue='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ue+"</body></html>");var pc=Rl?Rl.createHTML(ue):ue;if(db===kg)try{ze=new lb().parseFromString(pc,Wv)}catch{}if(!ze||!ze.documentElement){ze=mo.createDocument(db,"template",null);try{ze.documentElement.innerHTML=oO?"":pc}catch{}}var Ju=ze.body||ze.documentElement;return ue&&ot&&Ju.insertBefore(En.createTextNode(ot),Ju.childNodes[0]||null),db===kg?cb.call(ze,E_?"html":"body")[0]:E_?ze.documentElement:Ju},JV=function(ue){return Vg.call(ue.ownerDocument||ue,ue,fm.SHOW_ELEMENT|fm.SHOW_COMMENT|fm.SHOW_TEXT,null,!1)},Poe=function(ue){return ue instanceof hm&&(typeof ue.nodeName!="string"||typeof ue.textContent!="string"||typeof ue.removeChild!="function"||!(ue.attributes instanceof Fv)||typeof ue.removeAttribute!="function"||typeof ue.setAttribute!="function"||typeof ue.namespaceURI!="string"||typeof ue.insertBefore!="function")},Uw=function(ue){return e(Xh)==="object"?ue instanceof Xh:ue&&e(ue)==="object"&&typeof ue.nodeType=="number"&&typeof ue.nodeName=="string"},pm=function(ue,ze,ot){!Zd[ue]||A(Zd[ue],function(Gi){Gi.call(Qe,ze,ot,Yv)})},$V=function(ue){var ze;if(pm("beforeSanitizeElements",ue,null),Poe(ue)||L(/[\u0080-\uFFFF]/,ue.nodeName))return dm(ue),!0;var ot=Ks(ue.nodeName);if(pm("uponSanitizeElement",ue,{tagName:ot,allowedTags:js}),ue.hasChildNodes()&&!Uw(ue.firstElementChild)&&(!Uw(ue.content)||!Uw(ue.content.firstElementChild))&&L(/<[/\w]/g,ue.innerHTML)&&L(/<[/\w]/g,ue.textContent)||ot==="select"&&L(/<template/i,ue.innerHTML))return dm(ue),!0;if(!js[ot]||kw[ot]){if(!kw[ot]&&tk(ot)&&(is.tagNameCheck instanceof RegExp&&L(is.tagNameCheck,ot)||is.tagNameCheck instanceof Function&&is.tagNameCheck(ot)))return!1;if(tO&&!qv[ot]){var Gi=Vw(ue)||ue.parentNode,pc=Qh(ue)||ue.childNodes;if(pc&&Gi)for(var Ju=pc.length,Mu=Ju-1;Mu>=0;--Mu)Gi.insertBefore(Kh(pc[Mu],!0),Zh(ue))}return dm(ue),!0}return ue instanceof Lf&&!Doe(ue)||(ot==="noscript"||ot==="noembed")&&L(/<\/no(script|embed)/i,ue.innerHTML)?(dm(ue),!0):(Gv&&ue.nodeType===3&&(ze=ue.textContent,ze=O(ze,jR," "),ze=O(ze,KR," "),ue.textContent!==ze&&(P(Qe.removed,{element:ue.cloneNode()}),ue.textContent=ze)),pm("afterSanitizeElements",ue,null),!1)},ek=function(ue,ze,ot){if(UV&&(ze==="id"||ze==="name")&&(ot in En||ot in boe))return!1;if(!(JR&&!QR[ze]&&L(xoe,ze))){if(!(kV&&L(woe,ze))){if(!Pu[ze]||QR[ze]){if(!(tk(ue)&&(is.tagNameCheck instanceof RegExp&&L(is.tagNameCheck,ue)||is.tagNameCheck instanceof Function&&is.tagNameCheck(ue))&&(is.attributeNameCheck instanceof RegExp&&L(is.attributeNameCheck,ze)||is.attributeNameCheck instanceof Function&&is.attributeNameCheck(ze))||ze==="is"&&is.allowCustomizedBuiltInElements&&(is.tagNameCheck instanceof RegExp&&L(is.tagNameCheck,ot)||is.tagNameCheck instanceof Function&&is.tagNameCheck(ot))))return!1}else if(!nO[ze]){if(!L(ZR,O(ot,FV,""))){if(!((ze==="src"||ze==="xlink:href"||ze==="href")&&ue!=="script"&&m(ot,"data:")===0&&WV[ue])){if(!(GV&&!L(Eoe,O(ot,FV,"")))){if(ot)return!1}}}}}}return!0},tk=function(ue){return ue.indexOf("-")>0},nk=function(ue){var ze,ot,Gi,pc;pm("beforeSanitizeAttributes",ue,null);var Ju=ue.attributes;if(!!Ju){var Mu={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Pu};for(pc=Ju.length;pc--;){ze=Ju[pc];var mb=ze,$u=mb.name,lO=mb.namespaceURI;if(ot=$u==="value"?ze.value:I(ze.value),Gi=Ks($u),Mu.attrName=Gi,Mu.attrValue=ot,Mu.keepAttr=!0,Mu.forceKeepAttr=void 0,pm("uponSanitizeAttribute",ue,Mu),ot=Mu.attrValue,!Mu.forceKeepAttr&&(uO($u,ue),!!Mu.keepAttr)){if(L(/\/>/i,ot)){uO($u,ue);continue}Gv&&(ot=O(ot,jR," "),ot=O(ot,KR," "));var rk=Ks(ue.nodeName);if(!!ek(rk,Gi,ot)){if(HV&&(Gi==="id"||Gi==="name")&&(uO($u,ue),ot=Toe+ot),Rl&&e(x_)==="object"&&typeof x_.getAttributeType=="function"&&!lO)switch(x_.getAttributeType(rk,Gi)){case"TrustedHTML":ot=Rl.createHTML(ot);break;case"TrustedScriptURL":ot=Rl.createScriptURL(ot);break}try{lO?ue.setAttributeNS(lO,$u,ot):ue.setAttribute($u,ot),D(Qe.removed)}catch{}}}}pm("afterSanitizeAttributes",ue,null)}},Moe=function Nt(ue){var ze,ot=JV(ue);for(pm("beforeSanitizeShadowDOM",ue,null);ze=ot.nextNode();)pm("uponSanitizeShadowNode",ze,null),!$V(ze)&&(ze.content instanceof po&&Nt(ze.content),nk(ze));pm("afterSanitizeShadowDOM",ue,null)};return Qe.sanitize=function(Nt){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze,ot,Gi,pc,Ju;if(oO=!Nt,oO&&(Nt="<!-->"),typeof Nt!="string"&&!Uw(Nt)){if(typeof Nt.toString!="function")throw R("toString is not a function");if(Nt=Nt.toString(),typeof Nt!="string")throw R("dirty is not a string, aborting")}if(!Qe.isSupported){if(e(Ke.toStaticHTML)==="object"||typeof Ke.toStaticHTML=="function"){if(typeof Nt=="string")return Ke.toStaticHTML(Nt);if(Uw(Nt))return Ke.toStaticHTML(Nt.outerHTML)}return Nt}if($R||aO(ue),Qe.removed=[],typeof Nt=="string"&&(Gw=!1),Gw){if(Nt.nodeName){var Mu=Ks(Nt.nodeName);if(!js[Mu]||kw[Mu])throw R("root node is forbidden and cannot be sanitized in-place")}}else if(Nt instanceof Xh)ze=QV("<!---->"),ot=ze.ownerDocument.importNode(Nt,!0),ot.nodeType===1&&ot.nodeName==="BODY"||ot.nodeName==="HTML"?ze=ot:ze.appendChild(ot);else{if(!Uv&&!Gv&&!E_&&Nt.indexOf("<")===-1)return Rl&&hb?Rl.createHTML(Nt):Nt;if(ze=QV(Nt),!ze)return Uv?null:hb?Vv:""}ze&&eO&&dm(ze.firstChild);for(var mb=JV(Gw?Nt:ze);Gi=mb.nextNode();)Gi.nodeType===3&&Gi===pc||$V(Gi)||(Gi.content instanceof po&&Moe(Gi.content),nk(Gi),pc=Gi);if(pc=null,Gw)return Nt;if(Uv){if(fb)for(Ju=w_.call(ze.ownerDocument);ze.firstChild;)Ju.appendChild(ze.firstChild);else Ju=ze;return Pu.shadowroot&&(Ju=kv.call(zt,Ju,!0)),Ju}var $u=E_?ze.outerHTML:ze.innerHTML;return E_&&js["!doctype"]&&ze.ownerDocument&&ze.ownerDocument.doctype&&ze.ownerDocument.doctype.name&&L(Xd,ze.ownerDocument.doctype.name)&&($u="<!DOCTYPE "+ze.ownerDocument.doctype.name+`>
`+$u),Gv&&($u=O($u,jR," "),$u=O($u,KR," ")),Rl&&hb?Rl.createHTML($u):$u},Qe.setConfig=function(Nt){aO(Nt),$R=!0},Qe.clearConfig=function(){Yv=null,$R=!1},Qe.isValidAttribute=function(Nt,ue,ze){Yv||aO({});var ot=Ks(Nt),Gi=Ks(ue);return ek(ot,Gi,ze)},Qe.addHook=function(Nt,ue){typeof ue=="function"&&(Zd[Nt]=Zd[Nt]||[],P(Zd[Nt],ue))},Qe.removeHook=function(Nt){if(Zd[Nt])return D(Zd[Nt])},Qe.removeHooks=function(Nt){Zd[Nt]&&(Zd[Nt]=[])},Qe.removeAllHooks=function(){Zd={}},Qe}var Bv=zw();return Bv})});var aee=mm((nFt,Oz)=>{"use strict";Oz.exports=aL;Oz.exports.default=aL;function aL(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=ree(e,0,o,n,!0),s=[];if(!a||a.next===a.prev)return s;var u,l,c,f,h,d,p;if(r&&(a=$Le(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var _=n;_<o;_+=n)h=e[_],d=e[_+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?32767/p:0}return KS(a,s,n,u,l,p,0),s}function ree(e,t,n,r,o){var a,s;if(o===Rz(e,t,n,r)>0)for(a=t;a<n;a+=r)s=nee(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=nee(a,e[a],e[a+1],s);return s&&sL(s,s.next)&&(QS(s),s=s.next),s}function ev(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(sL(n,n.next)||Aa(n.prev,n,n.next)===0)){if(QS(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function KS(e,t,n,r,o,a,s){if(!!e){!s&&a&&iRe(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?ZLe(e,r,o,a):KLe(e)){t.push(l.i/n|0),t.push(e.i/n|0),t.push(c.i/n|0),QS(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=QLe(ev(e),t,n),KS(e,t,n,r,o,a,2)):s===2&&JLe(e,t,n,r,o,a):KS(ev(e),t,n,r,o,a,1);break}}}}function KLe(e){var t=e.prev,n=e,r=e.next;if(Aa(t,n,r)>=0)return!1;for(var o=t.x,a=n.x,s=r.x,u=t.y,l=n.y,c=r.y,f=o<a?o<s?o:s:a<s?a:s,h=u<l?u<c?u:c:l<c?l:c,d=o>a?o>s?o:s:a>s?a:s,p=u>l?u>c?u:c:l>c?l:c,_=r.next;_!==t;){if(_.x>=f&&_.x<=d&&_.y>=h&&_.y<=p&&h1(o,u,a,l,s,c,_.x,_.y)&&Aa(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function ZLe(e,t,n,r){var o=e.prev,a=e,s=e.next;if(Aa(o,a,s)>=0)return!1;for(var u=o.x,l=a.x,c=s.x,f=o.y,h=a.y,d=s.y,p=u<l?u<c?u:c:l<c?l:c,_=f<h?f<d?f:d:h<d?h:d,y=u>l?u>c?u:c:l>c?l:c,v=f>h?f>d?f:d:h>d?h:d,w=Mz(p,_,t,n,r),C=Mz(y,v,t,n,r),E=e.prevZ,S=e.nextZ;E&&E.z>=w&&S&&S.z<=C;){if(E.x>=p&&E.x<=y&&E.y>=_&&E.y<=v&&E!==o&&E!==s&&h1(u,f,l,h,c,d,E.x,E.y)&&Aa(E.prev,E,E.next)>=0||(E=E.prevZ,S.x>=p&&S.x<=y&&S.y>=_&&S.y<=v&&S!==o&&S!==s&&h1(u,f,l,h,c,d,S.x,S.y)&&Aa(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;E&&E.z>=w;){if(E.x>=p&&E.x<=y&&E.y>=_&&E.y<=v&&E!==o&&E!==s&&h1(u,f,l,h,c,d,E.x,E.y)&&Aa(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;S&&S.z<=C;){if(S.x>=p&&S.x<=y&&S.y>=_&&S.y<=v&&S!==o&&S!==s&&h1(u,f,l,h,c,d,S.x,S.y)&&Aa(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function QLe(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!sL(o,a)&&iee(o,r,r.next,a)&&ZS(o,a)&&ZS(a,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),QS(r),QS(r.next),r=e=a),r=r.next}while(r!==e);return ev(r)}function JLe(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&sRe(s,u)){var l=oee(s,u);s=ev(s,s.next),l=ev(l,l.next),KS(s,t,n,r,o,a,0),KS(l,t,n,r,o,a,0);return}u=u.next}s=s.next}while(s!==e)}function $Le(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=ree(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(aRe(c));for(o.sort(eRe),a=0;a<o.length;a++)n=tRe(o[a],n);return n}function eRe(e,t){return e.x-t.x}function tRe(e,t){var n=nRe(e,t);if(!n)return t;var r=oee(n,e);return ev(r,r.next),ev(n,n.next)}function nRe(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a&&(a=u,s=n.x<n.next.x?n:n.next,u===r))return s}n=n.next}while(n!==t);if(!s)return null;var l=s,c=s.x,f=s.y,h=1/0,d;n=s;do r>=n.x&&n.x>=c&&r!==n.x&&h1(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),ZS(n,e)&&(d<h||d===h&&(n.x>s.x||n.x===s.x&&rRe(s,n)))&&(s=n,h=d)),n=n.next;while(n!==l);return s}function rRe(e,t){return Aa(e.prev,e,t.prev)<0&&Aa(t.next,e,e.next)<0}function iRe(e,t,n,r){var o=e;do o.z===0&&(o.z=Mz(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,oRe(o)}function oRe(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function Mz(e,t,n,r,o){return e=(e-n)*o|0,t=(t-r)*o|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function aRe(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function h1(e,t,n,r,o,a,s,u){return(o-s)*(t-u)>=(e-s)*(a-u)&&(e-s)*(r-u)>=(n-s)*(t-u)&&(n-s)*(a-u)>=(o-s)*(r-u)}function sRe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!uRe(e,t)&&(ZS(e,t)&&ZS(t,e)&&lRe(e,t)&&(Aa(e.prev,e,t.prev)||Aa(e,t.prev,t))||sL(e,t)&&Aa(e.prev,e,e.next)>0&&Aa(t.prev,t,t.next)>0)}function Aa(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function sL(e,t){return e.x===t.x&&e.y===t.y}function iee(e,t,n,r){var o=oL(Aa(e,t,n)),a=oL(Aa(e,t,r)),s=oL(Aa(n,r,e)),u=oL(Aa(n,r,t));return!!(o!==a&&s!==u||o===0&&iL(e,n,t)||a===0&&iL(e,r,t)||s===0&&iL(n,e,r)||u===0&&iL(n,t,r))}function iL(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function oL(e){return e>0?1:e<0?-1:0}function uRe(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&iee(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function ZS(e,t){return Aa(e.prev,e,e.next)<0?Aa(e,t,e.next)>=0&&Aa(e,e.prev,t)>=0:Aa(e,t,e.prev)<0||Aa(e,e.next,t)<0}function lRe(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function oee(e,t){var n=new Lz(e.i,e.x,e.y),r=new Lz(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function nee(e,t,n,r){var o=new Lz(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function QS(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Lz(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}aL.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(Rz(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(Rz(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,_=r[u+2]*n;h+=Math.abs((e[d]-e[_])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[_+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function Rz(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}aL.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}});var $4e={};ik($4e,{EMExtensionsMixin:()=>ak,EV_AirSpace:()=>Hk,EV_AnnulusPrimitive:()=>Pb,EV_Billboard:()=>Ki,EV_BillboardCollection:()=>uE,EV_ColorHandle:()=>j6,EV_CoodTransfrom:()=>Q6,EV_CsDrawHelper:()=>OH,EV_Curve:()=>vI,EV_CustomCylider:()=>NH,EV_CustomizedPARadar:()=>yC,EV_DataOperated:()=>Fr,EV_DatagramManager:()=>zI,EV_DrawConnectionLines:()=>VI,EV_DrawCoordinates:()=>VH,EV_DrawHandler:()=>jW,EV_DrawMilGeometry:()=>DI,EV_DrawPrimitives:()=>CC,EV_DrawType:()=>od,EV_FanRing:()=>mC,EV_Gif:()=>MD,EV_GifCollection:()=>KW,EV_Graphic:()=>$W,EV_GraphicAnalysis:()=>jj,EV_Instanced3DCylinder:()=>QP,EV_Instanced3DSector:()=>Mx,EV_LabelPullWireCollection:()=>JP,EV_LineInstance:()=>EI,EV_LoadMTData:()=>J$,EV_Locking:()=>VM,EV_MTCesium3DTileBatchTable:()=>FS,EV_MTDataTransmission:()=>jie,EV_MTInstanced3DModelContent:()=>Pd,EV_MTLabelConfigurationTable:()=>Eh,EV_MTLightningCollection:()=>NR,EV_MTModel:()=>NS,EV_MTModelInstance:()=>PM,EV_MTModelInstanceCollection:()=>MM,EV_MechanicalRadar:()=>Qg,EV_MilStd2DLinePrimitive:()=>tee,EV_MilStd2DMarkerPrimitive:()=>nL,EV_MilStd2DRenderManager:()=>rL,EV_MilStd3DLinePrimitive:()=>dL,EV_MilStd3DMarkerPrimitive:()=>pL,EV_MilStd3DRenderManager:()=>mL,EV_MilStdActionDeduce:()=>Nee,EV_MilStdAnchorCollection:()=>iv,EV_MilStdDeduceGroup:()=>gL,EV_MilStdDeduceManager:()=>_L,EV_MilStdDrawHelper:()=>Gee,EV_MilStdLayerManager:()=>yL,EV_MilStdLineSymbol:()=>C1,EV_MilStdMarkerSymbol:()=>x1,EV_MilStdSelectionBoxHandle:()=>Uee,EV_MilitaryPlottingService:()=>tL,EV_MovingTarget:()=>mE,EV_MovingTargetAnalysis:()=>Bie,EV_MovingTargetBoundingBoxCollection:()=>NM,EV_MovingTargetFlightControl:()=>Xie,EV_MovingTargetFlightData:()=>Bu,EV_MovingTargetManager:()=>wh,EV_MovingTargetRibbonCollection:()=>_C,EV_MovingTargetSensorManager:()=>FR,EV_MovingTargetTrace:()=>FI,EV_MovingTargetTraceBarCollection:()=>OM,EV_MovingTargetTraceLineCollection:()=>BM,EV_MovingTargetTraceWallCollection:()=>RM,EV_MovingTargetUpdateProperties:()=>zR,EV_MovingTargetVisualizer:()=>FM,EV_MsgType:()=>Re,EV_OlDrawHelper:()=>noe,EV_OlDrawPrimitives:()=>qR,EV_OlMapControl:()=>roe,EV_OlPriManager:()=>WR,EV_PARadarBeam:()=>RR,EV_ParseArrayRadar:()=>pC,EV_ParseCombatPower:()=>Ew,EV_ParseCommand:()=>yoe,EV_ParseEWS:()=>Mw,EV_ParseFlight:()=>Iw,EV_ParseGTspi:()=>ww,EV_ParseHeader:()=>cn,EV_ParseI3NS:()=>yw,EV_ParseI3NS_Deprecated:()=>Tw,EV_ParseIRSTworkMode:()=>Pw,EV_ParseIrsmState:()=>Sw,EV_ParseLargePlane:()=>Nw,EV_ParseParam:()=>Dw,EV_ParseRTKN:()=>Cw,EV_ParseRTSN:()=>vw,EV_ParseRadarTarget:()=>Aw,EV_ParseRadarWM:()=>bw,EV_ParseSDRState:()=>Rw,EV_ParseSafetyAlarm:()=>Ow,EV_ParseStartStop:()=>Lw,EV_ParseStaticTarget:()=>voe,EV_ParseTRAJ:()=>xw,EV_PipeObject:()=>soe,EV_PolylineVolumeGeometry:()=>rv,EV_PolylineVolumeGeometryLibrary:()=>tA,EV_PureColor:()=>coe,EV_Pyramid:()=>foe,EV_RadarJamDirection:()=>Coe,EV_Receive:()=>NI,EV_SatelliteTraceLineCollection:()=>doe,EV_ScreenEventAggregator:()=>PD,EV_ScreenEventType:()=>G_,EV_SeviceAnalysis:()=>poe,EV_Special:()=>LR,EV_TargetRing:()=>TI,EV_TerrainShade:()=>AI,EV_TraceType:()=>Wi,EV_VehicleRadar:()=>Zg,EV_WSGetMessage:()=>goe,EV_WSGetMessageJava:()=>_oe,EV_loadKTX:()=>$P,MT_CzmlDataSource:()=>UM,VERSION:()=>J4e,turf:()=>cw});var Jo={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(Jo,{maximumCombinedTextureImageUnits:{get:function(){return Jo._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return Jo._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return Jo._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return Jo._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return Jo._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return Jo._maximumTextureSize}},maximumVaryingVectors:{get:function(){return Jo._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return Jo._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return Jo._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return Jo._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return Jo._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return Jo._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return Jo._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return Jo._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return Jo._maximumViewportWidth}},maximumViewportHeight:{get:function(){return Jo._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return Jo._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return Jo._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return Jo._maximumColorAttachments}},maximumSamples:{get:function(){return Jo._maximumSamples}},highpFloatSupported:{get:function(){return Jo._highpFloatSupported}},highpIntSupported:{get:function(){return Jo._highpIntSupported}}});var Jt=Jo;function zoe(e,t){Jt._maximumCombinedTextureImageUnits=Cesium.ContextLimits._maximumCombinedTextureImageUnits,Jt._maximumCubeMapSize=Cesium.ContextLimits._maximumCubeMapSize,Jt._maximumFragmentUniformVectors=Cesium.ContextLimits._maximumFragmentUniformVectors,Jt._maximumTextureImageUnits=Cesium.ContextLimits._maximumTextureImageUnits,Jt._maximumRenderbufferSize=Cesium.ContextLimits._maximumRenderbufferSize,Jt._maximumTextureSize=Cesium.ContextLimits._maximumTextureSize,Jt._maximumVertexAttributes=Cesium.ContextLimits._maximumVertexAttributes,Jt._maximumVertexTextureImageUnits=Cesium.ContextLimits._maximumVertexTextureImageUnits,Jt._maximumVertexUniformVectors=Cesium.ContextLimits._maximumVertexUniformVectors,Jt._minimumAliasedLineWidth=Cesium.ContextLimits._minimumAliasedLineWidth,Jt._maximumAliasedLineWidth=Cesium.ContextLimits._maximumAliasedLineWidth,Jt._minimumAliasedPointSize=Cesium.ContextLimits._minimumAliasedPointSize,Jt._maximumAliasedPointSize=Cesium.ContextLimits._maximumAliasedPointSize,Jt._maximumViewportWidth=Cesium.ContextLimits._maximumViewportWidth,Jt._maximumViewportHeight=Cesium.ContextLimits._maximumViewportHeight,Jt._highpFloatSupported=Cesium.ContextLimits._highpFloatSupported,Jt._highpIntSupported=Cesium.ContextLimits._highpIntSupported,Jt._maximumTextureFilterAnisotropy=Cesium.ContextLimits._maximumTextureFilterAnisotropy,Jt._maximumDrawBuffers=Cesium.ContextLimits._maximumDrawBuffers,Jt._maximumColorAttachments=Cesium.ContextLimits._maximumColorAttachments}var ak=zoe;function Voe(e){return e!=null}var g=Voe;function T_(e){this.name="DeveloperError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}g(Object.create)&&(T_.prototype=Object.create(Error.prototype),T_.prototype.constructor=T_);T_.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return g(this.stack)&&(e+=`
${this.stack.toString()}`),e};T_.throwInstantiationError=function(){throw new T_("This function defines an interface and should not be called directly.")};var Le=T_;var eo=Xv(dk(),1);function pk(e,t){return e??t}pk.EMPTY_OBJECT=Object.freeze({});var T=pk;function cO(e,t){let n;return typeof document<"u"&&(n=document),cO._implementation(e,t,n)}cO._implementation=function(e,t,n){if(!g(t)){if(typeof n>"u")return e;t=T(n.baseURI,n.location.href)}let r=new eo.default(e);return r.scheme()!==""?r.toString():r.absoluteTo(t).toString()};var S_=cO;function koe(e){return(e.length===0||e[e.length-1]!=="/")&&(e=`${e}/`),e}var mk=koe;var os={};os.typeOf={};function Goe(e){return`${e} is required, actual value was undefined`}function Zv(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}os.defined=function(e,t){if(!g(t))throw new Le(Goe(e))};os.typeOf.func=function(e,t){if(typeof t!="function")throw new Le(Zv(typeof t,"function",e))};os.typeOf.string=function(e,t){if(typeof t!="string")throw new Le(Zv(typeof t,"string",e))};os.typeOf.number=function(e,t){if(typeof t!="number")throw new Le(Zv(typeof t,"number",e))};os.typeOf.number.lessThan=function(e,t,n){if(os.typeOf.number(e,t),t>=n)throw new Le(`Expected ${e} to be less than ${n}, actual value was ${t}`)};os.typeOf.number.lessThanOrEquals=function(e,t,n){if(os.typeOf.number(e,t),t>n)throw new Le(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)};os.typeOf.number.greaterThan=function(e,t,n){if(os.typeOf.number(e,t),t<=n)throw new Le(`Expected ${e} to be greater than ${n}, actual value was ${t}`)};os.typeOf.number.greaterThanOrEquals=function(e,t,n){if(os.typeOf.number(e,t),t<n)throw new Le(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)};os.typeOf.object=function(e,t){if(typeof t!="object")throw new Le(Zv(typeof t,"object",e))};os.typeOf.bool=function(e,t){if(typeof t!="boolean")throw new Le(Zv(typeof t,"boolean",e))};os.typeOf.bigint=function(e,t){if(typeof t!="bigint")throw new Le(Zv(typeof t,"bigint",e))};os.typeOf.number.equals=function(e,t,n,r){if(os.typeOf.number(e,n),os.typeOf.number(t,r),n!==r)throw new Le(`${e} must be equal to ${t}, the actual values are ${n} and ${r}`)};var Ds=os;function gk(e,t){if(e===null||typeof e!="object")return e;t=T(t,!1);let n=new e.constructor;for(let r in e)if(e.hasOwnProperty(r)){let o=e[r];t&&(o=gk(o,t)),n[r]=o}return n}var Ht=gk;function _k(e,t,n){n=T(n,!1);let r={},o=g(e),a=g(t),s,u,l;if(o)for(s in e)e.hasOwnProperty(s)&&(u=e[s],a&&n&&typeof u=="object"&&t.hasOwnProperty(s)?(l=t[s],typeof l=="object"?r[s]=_k(u,l,n):r[s]=u):r[s]=u);if(a)for(s in t)t.hasOwnProperty(s)&&!r.hasOwnProperty(s)&&(l=t[s],r[s]=l);return r}var ji=_k;function Uoe(){let e,t,n=new Promise(function(r,o){e=r,t=o});return{resolve:e,reject:t,promise:n}}var Bo=Uoe;function Hoe(e,t){let n="",r=e.lastIndexOf("/");return r!==-1&&(n=e.substring(0,r+1)),t&&(e=new eo.default(e),e.query().length!==0&&(n+=`?${e.query()}`),e.fragment().length!==0&&(n+=`#${e.fragment()}`)),n}var yk=Hoe;function qoe(e){let t=new eo.default(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return r!==-1&&(n=n.substr(r+1)),r=n.lastIndexOf("."),r===-1?n="":n=n.substr(r+1),n}var vk=qoe;var Ck={};function Woe(e,t,n){g(t)||(t=e.width),g(n)||(n=e.height);let r=Ck[t];g(r)||(r={},Ck[t]=r);let o=r[n];if(!g(o)){let a=document.createElement("canvas");a.width=t,a.height=n,o=a.getContext("2d"),o.globalCompositeOperation="copy",r[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}var fO=Woe;var Yoe=/^blob:/i;function Xoe(e){return Yoe.test(e)}var Cb=Xoe;var Qd;function joe(e){g(Qd)||(Qd=document.createElement("a")),Qd.href=window.location.href;let t=Qd.host,n=Qd.protocol;return Qd.href=e,Qd.href=Qd.href,n!==Qd.protocol||t!==Qd.host}var xb=joe;var Koe=/^data:/i;function Zoe(e){return Koe.test(e)}var wb=Zoe;function Qoe(e){let t=document.createElement("script");return t.async=!0,t.src=e,new Promise((n,r)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");let o=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,o.removeChild(t),n()},t.onerror=function(a){r(a)},o.appendChild(t)})}var xk=Qoe;var Eb=Xv(Ek(),1);var Ie={};Ie.EPSILON1=.1;Ie.EPSILON2=.01;Ie.EPSILON3=.001;Ie.EPSILON4=1e-4;Ie.EPSILON5=1e-5;Ie.EPSILON6=1e-6;Ie.EPSILON7=1e-7;Ie.EPSILON8=1e-8;Ie.EPSILON9=1e-9;Ie.EPSILON10=1e-10;Ie.EPSILON11=1e-11;Ie.EPSILON12=1e-12;Ie.EPSILON13=1e-13;Ie.EPSILON14=1e-14;Ie.EPSILON15=1e-15;Ie.EPSILON16=1e-16;Ie.EPSILON17=1e-17;Ie.EPSILON18=1e-18;Ie.EPSILON19=1e-19;Ie.EPSILON20=1e-20;Ie.EPSILON21=1e-21;Ie.GRAVITATIONALPARAMETER=3986004418e5;Ie.SOLAR_RADIUS=6955e5;Ie.LUNAR_RADIUS=1737400;Ie.SIXTY_FOUR_KILOBYTES=64*1024;Ie.FOUR_GIGABYTES=4*1024*1024*1024;Ie.sign=T(Math.sign,function(t){return t=+t,t===0||t!==t?t:t>0?1:-1});Ie.signNotZero=function(e){return e<0?-1:1};Ie.toSNorm=function(e,t){return t=T(t,255),Math.round((Ie.clamp(e,-1,1)*.5+.5)*t)};Ie.fromSNorm=function(e,t){return t=T(t,255),Ie.clamp(e,0,t)/t*2-1};Ie.normalize=function(e,t,n){return n=Math.max(n-t,0),n===0?0:Ie.clamp((e-t)/n,0,1)};Ie.sinh=T(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2});Ie.cosh=T(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2});Ie.lerp=function(e,t,n){return(1-n)*e+n*t};Ie.PI=Math.PI;Ie.ONE_OVER_PI=1/Math.PI;Ie.PI_OVER_TWO=Math.PI/2;Ie.PI_OVER_THREE=Math.PI/3;Ie.PI_OVER_FOUR=Math.PI/4;Ie.PI_OVER_SIX=Math.PI/6;Ie.THREE_PI_OVER_TWO=3*Math.PI/2;Ie.TWO_PI=2*Math.PI;Ie.ONE_OVER_TWO_PI=1/(2*Math.PI);Ie.RADIANS_PER_DEGREE=Math.PI/180;Ie.DEGREES_PER_RADIAN=180/Math.PI;Ie.RADIANS_PER_ARCSECOND=Ie.RADIANS_PER_DEGREE/3600;Ie.toRadians=function(e){return e*Ie.RADIANS_PER_DEGREE};Ie.toDegrees=function(e){return e*Ie.DEGREES_PER_RADIAN};Ie.convertLongitudeRange=function(e){let t=Ie.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n};Ie.clampToLatitudeRange=function(e){return Ie.clamp(e,-1*Ie.PI_OVER_TWO,Ie.PI_OVER_TWO)};Ie.negativePiToPi=function(e){return e>=-Ie.PI&&e<=Ie.PI?e:Ie.zeroToTwoPi(e+Ie.PI)-Ie.PI};Ie.zeroToTwoPi=function(e){if(e>=0&&e<=Ie.TWO_PI)return e;let t=Ie.mod(e,Ie.TWO_PI);return Math.abs(t)<Ie.EPSILON14&&Math.abs(e)>Ie.EPSILON14?Ie.TWO_PI:t};Ie.mod=function(e,t){return Ie.sign(e)===Ie.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t};Ie.equalsEpsilon=function(e,t,n,r){n=T(n,0),r=T(r,n);let o=Math.abs(e-t);return o<=r||o<=n*Math.max(Math.abs(e),Math.abs(t))};Ie.lessThan=function(e,t,n){return e-t<-n};Ie.lessThanOrEquals=function(e,t,n){return e-t<n};Ie.greaterThan=function(e,t,n){return e-t>n};Ie.greaterThanOrEquals=function(e,t,n){return e-t>-n};var Tb=[1];Ie.factorial=function(e){let t=Tb.length;if(e>=t){let n=Tb[t-1];for(let r=t;r<=e;r++){let o=n*r;Tb.push(o),n=o}}return Tb[e]};Ie.incrementWrap=function(e,t,n){return n=T(n,0),++e,e>t&&(e=n),e};Ie.isPowerOfTwo=function(e){return e!==0&&(e&e-1)===0};Ie.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e,e};Ie.previousPowerOfTwo=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e|=e>>32,e=(e>>>0)-(e>>>1),e};Ie.clamp=function(e,t,n){return e<t?t:e>n?n:e};var Tk=new Eb.default;Ie.setRandomNumberSeed=function(e){Tk=new Eb.default(e)};Ie.nextRandomNumber=function(){return Tk.random()};Ie.randomBetween=function(e,t){return Ie.nextRandomNumber()*(t-e)+e};Ie.acosClamped=function(e){return Math.acos(Ie.clamp(e,-1,1))};Ie.asinClamped=function(e){return Math.asin(Ie.clamp(e,-1,1))};Ie.chordLength=function(e,t){return 2*t*Math.sin(e*.5)};Ie.logBase=function(e,t){return Math.log(e)/Math.log(t)};Ie.cbrt=T(Math.cbrt,function(t){let n=Math.pow(Math.abs(t),.3333333333333333);return t<0?-n:n});Ie.log2=T(Math.log2,function(t){return Math.log(t)*Math.LOG2E});Ie.fog=function(e,t){let n=e*t;return 1-Math.exp(-(n*n))};Ie.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)};Ie.fastApproximateAtan2=function(e,t){let n,r=Math.abs(e);n=Math.abs(t);let o=Math.max(r,n);n=Math.min(r,n);let a=n/o;return r=Ie.fastApproximateAtan(a),r=Math.abs(t)>Math.abs(e)?Ie.PI_OVER_TWO-r:r,r=e<0?Ie.PI-r:r,r=t<0?-r:r,r};var F=Ie;function Joe(e){let t="";for(let n in e)if(e.hasOwnProperty(n)){let r=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(r))for(let a=0,s=r.length;a<s;++a)t+=`${o+encodeURIComponent(r[a])}&`;else t+=`${o+encodeURIComponent(r)}&`}return t=t.slice(0,-1),t}var Sk=Joe;function $oe(e){let t={};if(e==="")return t;let n=e.replace(/\+/g,"%20").split(/[&;]/);for(let r=0,o=n.length;r<o;++r){let a=n[r].split("="),s=decodeURIComponent(a[0]),u=a[1];g(u)?u=decodeURIComponent(u):u="";let l=t[s];typeof l=="string"?t[s]=[l,u]:Array.isArray(l)?l.push(u):t[s]=u}return t}var Ak=$oe;var eae={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},$o=Object.freeze(eae);var tae={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},bk=Object.freeze(tae);function Sb(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.throttleByServer,!1),n=T(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=T(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=T(e.type,bk.OTHER),this.serverKey=void 0,this.state=$o.UNISSUED,this.deferred=void 0,this.cancelled=!1}Sb.prototype.cancel=function(){this.cancelled=!0};Sb.prototype.clone=function(e){return g(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new Sb(this)};var Ik=Sb;function nae(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let r=0;r<n.length;++r){let o=n[r],a=o.indexOf(": ");if(a>0){let s=o.substring(0,a),u=o.substring(a+2);t[s]=u}}return t}var Dk=nae;function Pk(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,typeof this.responseHeaders=="string"&&(this.responseHeaders=Dk(this.responseHeaders))}Pk.prototype.toString=function(){let e="Request has failed.";return g(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e};var Hw=Pk;function qw(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}Object.defineProperties(qw.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});qw.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);let n=this;return function(){n.removeEventListener(e,t)}};qw.prototype.removeEventListener=function(e,t){let n=this._listeners,r=this._scopes,o=-1;for(let a=0;a<n.length;a++)if(n[a]===e&&r[a]===t){o=a;break}return o!==-1?(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,r[o]=void 0):(n.splice(o,1),r.splice(o,1)),!0):!1};function rae(e,t){return t-e}qw.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let e,t=this._listeners,n=this._scopes,r=t.length;for(e=0;e<r;e++){let a=t[e];g(a)&&t[e].apply(n[e],arguments)}let o=this._toRemove;if(r=o.length,r>0){for(o.sort(rae),e=0;e<r;e++){let a=o[e];t.splice(a,1),n.splice(a,1)}o.length=0}this._insideRaiseEvent=!1};var xe=qw;function A_(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}Object.defineProperties(A_.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){let t=this._length;if(e<t){let n=this._array;for(let r=e;r<t;++r)n[r]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}});function hO(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}A_.prototype.reserve=function(e){e=T(e,this._length),this._array.length=e};A_.prototype.heapify=function(e){e=T(e,0);let t=this._length,n=this._comparator,r=this._array,o=-1,a=!0;for(;a;){let s=2*(e+1),u=s-1;u<t&&n(r[u],r[e])<0?o=u:o=e,s<t&&n(r[s],r[o])<0&&(o=s),o!==e?(hO(r,o,e),e=o):a=!1}};A_.prototype.resort=function(){let e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)};A_.prototype.insert=function(e){let t=this._array,n=this._comparator,r=this._maximumLength,o=this._length++;for(o<t.length?t[o]=e:t.push(e);o!==0;){let s=Math.floor((o-1)/2);if(n(t[o],t[s])<0)hO(t,o,s),o=s;else break}let a;return g(r)&&this._length>r&&(a=t[r],this._length=r),a};A_.prototype.pop=function(e){if(e=T(e,0),this._length===0)return;let t=this._array,n=t[e];return hO(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};var Mk=A_;function iae(e,t){return e.priority-t.priority}var _i={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},Qv=20,el=new Mk({comparator:iae});el.maximumLength=Qv;el.reserve(Qv);var Jd=[],_m={},oae=typeof document<"u"?new eo.default(document.location.href):new eo.default,Ab=new xe;function bo(){}bo.maximumRequests=50;bo.maximumRequestsPerServer=6;bo.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18};bo.throttleRequests=!0;bo.debugShowStatistics=!1;bo.requestCompletedEvent=Ab;Object.defineProperties(bo,{statistics:{get:function(){return _i}},priorityHeapLength:{get:function(){return Qv},set:function(e){if(e<Qv)for(;el.length>e;){let t=el.pop();b_(t)}Qv=e,el.maximumLength=e,el.reserve(e)}}});function Lk(e){g(e.priorityFunction)&&(e.priority=e.priorityFunction())}bo.serverHasOpenSlots=function(e,t){t=T(t,1);let n=T(bo.requestsByServer[e],bo.maximumRequestsPerServer);return _m[e]+t<=n};bo.heapHasOpenSlots=function(e){return el.length+e<=Qv};function Rk(e){return e.state===$o.UNISSUED&&(e.state=$o.ISSUED,e.deferred=Bo()),e.deferred.promise}function aae(e){return function(t){if(e.state===$o.CANCELLED)return;let n=e.deferred;--_i.numberOfActiveRequests,--_m[e.serverKey],Ab.raiseEvent(),e.state=$o.RECEIVED,e.deferred=void 0,n.resolve(t)}}function sae(e){return function(t){e.state!==$o.CANCELLED&&(++_i.numberOfFailedRequests,--_i.numberOfActiveRequests,--_m[e.serverKey],Ab.raiseEvent(t),e.state=$o.FAILED,e.deferred.reject(t))}}function Ok(e){let t=Rk(e);return e.state=$o.ACTIVE,Jd.push(e),++_i.numberOfActiveRequests,++_i.numberOfActiveRequestsEver,++_m[e.serverKey],e.requestFunction().then(aae(e)).catch(sae(e)),t}function b_(e){let t=e.state===$o.ACTIVE;if(e.state=$o.CANCELLED,++_i.numberOfCancelledRequests,g(e.deferred)){let n=e.deferred;e.deferred=void 0,n.reject()}t&&(--_i.numberOfActiveRequests,--_m[e.serverKey],++_i.numberOfCancelledActiveRequests),g(e.cancelFunction)&&e.cancelFunction()}bo.update=function(){let e,t,n=0,r=Jd.length;for(e=0;e<r;++e){if(t=Jd[e],t.cancelled&&b_(t),t.state!==$o.ACTIVE){++n;continue}n>0&&(Jd[e-n]=t)}Jd.length-=n;let o=el.internalArray,a=el.length;for(e=0;e<a;++e)Lk(o[e]);el.resort();let s=Math.max(bo.maximumRequests-Jd.length,0),u=0;for(;u<s&&el.length>0;){if(t=el.pop(),t.cancelled){b_(t);continue}if(t.throttleByServer&&!bo.serverHasOpenSlots(t.serverKey)){b_(t);continue}Ok(t),++u}uae()};bo.getServerKey=function(e){let t=new eo.default(e);t.scheme()===""&&(t=new eo.default(e).absoluteTo(oae),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${t.scheme()==="https"?"443":"80"}`);let r=_m[n];return g(r)||(_m[n]=0),n};bo.request=function(e){if(wb(e.url)||Cb(e.url))return Ab.raiseEvent(),e.state=$o.RECEIVED,e.requestFunction();if(++_i.numberOfAttemptedRequests,g(e.serverKey)||(e.serverKey=bo.getServerKey(e.url)),bo.throttleRequests&&e.throttleByServer&&!bo.serverHasOpenSlots(e.serverKey))return;if(!bo.throttleRequests||!e.throttle)return Ok(e);if(Jd.length>=bo.maximumRequests)return;Lk(e);let t=el.insert(e);if(g(t)){if(t===e)return;b_(t)}return Rk(e)};function uae(){!bo.debugShowStatistics||(_i.numberOfActiveRequests===0&&_i.lastNumberOfActiveRequests>0&&(_i.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${_i.numberOfAttemptedRequests}`),_i.numberOfAttemptedRequests=0),_i.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${_i.numberOfCancelledRequests}`),_i.numberOfCancelledRequests=0),_i.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${_i.numberOfCancelledActiveRequests}`),_i.numberOfCancelledActiveRequests=0),_i.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${_i.numberOfFailedRequests}`),_i.numberOfFailedRequests=0)),_i.lastNumberOfActiveRequests=_i.numberOfActiveRequests)}bo.clearForSpecs=function(){for(;el.length>0;){let t=el.pop();b_(t)}let e=Jd.length;for(let t=0;t<e;++t)b_(Jd[t]);Jd.length=0,_m={},_i.numberOfAttemptedRequests=0,_i.numberOfActiveRequests=0,_i.numberOfCancelledRequests=0,_i.numberOfCancelledActiveRequests=0,_i.numberOfFailedRequests=0,_i.numberOfActiveRequestsEver=0,_i.lastNumberOfActiveRequests=0};bo.numberOfActiveRequestsByServer=function(e){return _m[e]};bo.requestHeap=el;var bb=bo;function Ww(e){this.name="RuntimeError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}g(Object.create)&&(Ww.prototype=Object.create(Error.prototype),Ww.prototype.constructor=Ww);Ww.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return g(this.stack)&&(e+=`
${this.stack.toString()}`),e};var at=Ww;var Yw={},Jv={};Yw.add=function(e,t){let n=`${e.toLowerCase()}:${t}`;g(Jv[n])||(Jv[n]=!0)};Yw.remove=function(e,t){let n=`${e.toLowerCase()}:${t}`;g(Jv[n])&&delete Jv[n]};function lae(e){let t=new eo.default(e);t.normalize();let n=t.authority();if(n.length!==0){if(t.authority(n),n.indexOf("@")!==-1&&(n=n.split("@")[1]),n.indexOf(":")===-1){let r=t.scheme();if(r.length===0&&(r=window.location.protocol,r=r.substring(0,r.length-1)),r==="http")n+=":80";else if(r==="https")n+=":443";else return}return n}}Yw.contains=function(e){let t=lae(e);return!!(g(t)&&g(Jv[t]))};Yw.clear=function(){Jv={}};var dO=Yw;var Fk=function(){try{let e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob",e.responseType==="blob"}catch{return!1}}();function cae(e){return typeof e=="string"&&(e.indexOf("earthview")!==-1||e.indexOf("EV_WebService")!==-1)}function mO(e,t,n,r){let o=e.query(),a;if(cae(e.path())&&(a=I_(Ve._evServerQueryParam,a,!1)),!g(o)||o.length===0)return t._queryParameters=I_(t._queryParameters,a,!1);if(o.indexOf("=")===-1){let s={};s[o]=void 0,a=s}else{let s=Ak(o);a=I_(s,a,!1)}n?t._queryParameters=I_(a,t._queryParameters,r):t._queryParameters=a,e.search("")}function fae(e,t){let n=t._queryParameters,r=Object.keys(n);r.length===1&&!g(n[r[0]])?e.search(r[0]):e.search(Sk(n))}function $d(e,t){return g(e)?g(e.clone)?e.clone():Ht(e):t}function gO(e){if(e.state===$o.ISSUED||e.state===$o.ACTIVE)throw new at("The Resource is already being fetched.");e.state=$o.UNISSUED,e.deferred=void 0}function I_(e,t,n){if(!n)return ji(e,t);let r=Ht(e,!0);for(let o in t)if(t.hasOwnProperty(o)){let a=r[o],s=t[o];g(a)?(Array.isArray(a)||(a=r[o]=[a]),r[o]=a.concat(s)):r[o]=Array.isArray(s)?s.slice():s}return r}function Ve(e){e=T(e,T.EMPTY_OBJECT),typeof e=="string"&&(e={url:e}),this._url=void 0,this._templateValues=$d(e.templateValues,{}),this._queryParameters=$d(e.queryParameters,{}),this.headers=$d(e.headers,{}),this.request=T(e.request,new Ik),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=T(e.retryAttempts,0),this._retryCount=0;let t=new eo.default(e.url);mO(t,this,!0,!0),t.fragment(""),this._url=t.toString()}Ve.createIfNeeded=function(e){return e instanceof Ve?e.getDerivedResource({request:e.request}):typeof e!="string"?e:new Ve({url:e})};var $v;Ve.supportsImageBitmapOptions=function(){if(g($v))return $v;if(typeof createImageBitmap!="function")return $v=Promise.resolve(!1),$v;let e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC";return $v=Ve.fetchBlob({url:e}).then(function(t){let n={imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"};return Promise.all([createImageBitmap(t,n),createImageBitmap(t)])}).then(function(t){let n=fO(t[0]),r=fO(t[1]);return n[1]!==r[1]}).catch(function(){return!1}),$v};Object.defineProperties(Ve,{isBlobSupported:{get:function(){return Fk}}});Object.defineProperties(Ve.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){let t=new eo.default(e);mO(t,this,!1),t.fragment(""),this._url=t.toString()}},extension:{get:function(){return vk(this._url)}},isDataUri:{get:function(){return wb(this._url)}},isBlobUri:{get:function(){return Cb(this._url)}},isCrossOriginUrl:{get:function(){return xb(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}});Ve.prototype.toString=function(){return this.getUrlComponent(!0,!0)};Ve.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=new eo.default(this._url);e&&fae(n,this);let r=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),o=this._templateValues;return r=r.replace(/{(.*?)}/g,function(a,s){let u=o[s];return g(u)?encodeURIComponent(u):a}),t&&g(this.proxy)&&(r=this.proxy.getURL(r)),r};Ve.prototype.setQueryParameters=function(e,t){t?this._queryParameters=I_(this._queryParameters,e,!1):this._queryParameters=I_(e,this._queryParameters,!1)};Ve.prototype.appendQueryParameters=function(e){this._queryParameters=I_(e,this._queryParameters,!0)};Ve.prototype.setTemplateValues=function(e,t){t?this._templateValues=ji(this._templateValues,e):this._templateValues=ji(e,this._templateValues)};Ve.prototype.getDerivedResource=function(e){let t=this.clone();if(t._retryCount=0,g(e.url)){let n=new eo.default(e.url),r=T(e.preserveQueryParameters,!1);mO(n,t,!0,r),n.fragment(""),n.scheme()!==""?t._url=n.toString():t._url=n.absoluteTo(new eo.default(S_(this._url))).toString()}return g(e.queryParameters)&&(t._queryParameters=ji(e.queryParameters,t._queryParameters)),g(e.templateValues)&&(t._templateValues=ji(e.templateValues,t.templateValues)),g(e.headers)&&(t.headers=ji(e.headers,t.headers)),g(e.proxy)&&(t.proxy=e.proxy),g(e.request)&&(t.request=e.request),g(e.retryCallback)&&(t.retryCallback=e.retryCallback),g(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t};Ve.prototype.retryOnError=function(e){let t=this.retryCallback;if(typeof t!="function"||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let n=this;return Promise.resolve(t(this,e)).then(function(r){return++n._retryCount,r})};Ve.prototype.clone=function(e){return g(e)||(e=new Ve({url:this._url})),e._url=this._url,e._queryParameters=Ht(this._queryParameters),e._templateValues=Ht(this._templateValues),e.headers=Ht(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e};Ve.prototype.getBaseUri=function(e){return yk(this.getUrlComponent(e),e)};Ve.prototype.appendForwardSlash=function(){this._url=mk(this._url)};Ve.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})};Ve.fetchArrayBuffer=function(e){return new Ve(e).fetchArrayBuffer()};Ve.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})};Ve.fetchBlob=function(e){return new Ve(e).fetchBlob()};Ve.prototype.fetchImage=function(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.preferImageBitmap,!1),n=T(e.preferBlob,!1),r=T(e.flipY,!1),o=T(e.skipColorSpaceConversion,!1);if(gO(this.request),!Fk||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return pO({resource:this,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:t});let a=this.fetchBlob();if(!g(a))return;let s,u,l,c;return Ve.supportsImageBitmapOptions().then(function(f){return s=f,u=s&&t,a}).then(function(f){if(!g(f))return;if(c=f,u)return Ve.createImageBitmapFromBlob(f,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});let h=window.URL.createObjectURL(f);return l=new Ve({url:h}),pO({resource:l,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:!1})}).then(function(f){if(!!g(f))return f.blob=c,u||window.URL.revokeObjectURL(l.url),f}).catch(function(f){return g(l)&&window.URL.revokeObjectURL(l.url),f.blob=c,Promise.reject(f)})};function pO(e){let t=e.resource,n=e.flipY,r=e.skipColorSpaceConversion,o=e.preferImageBitmap,a=t.request;a.url=t.url,a.requestFunction=function(){let u=!1;!t.isDataUri&&!t.isBlobUri&&(u=t.isCrossOriginUrl);let l=Bo();return Ve._Implementations.createImage(a,u,l,n,r,o),l.promise};let s=bb.request(a);if(!!g(s))return s.catch(function(u){return a.state!==$o.FAILED?Promise.reject(u):t.retryOnError(u).then(function(l){return l?(a.state=$o.UNISSUED,a.deferred=void 0,pO({resource:t,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:o})):Promise.reject(u)})})}Ve.fetchImage=function(e){return new Ve(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})};Ve.prototype.fetchText=function(){return this.fetch({responseType:"text"})};Ve.fetchText=function(e){return new Ve(e).fetchText()};Ve.prototype.fetchJson=function(){let e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(!!g(e))return e.then(function(t){if(!!g(t))return JSON.parse(t)})};Ve.fetchJson=function(e){return new Ve(e).fetchJson()};Ve.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})};Ve.fetchXML=function(e){return new Ve(e).fetchXML()};Ve.prototype.fetchJsonp=function(e){e=T(e,"callback"),gO(this.request);let t;do t=`loadJsonp${F.nextRandomNumber().toString().substring(2,8)}`;while(g(window[t]));return zk(this,e,t)};function zk(e,t,n){let r={};r[t]=n,e.setQueryParameters(r);let o=e.request;o.url=e.url,o.requestFunction=function(){let s=Bo();return window[n]=function(u){s.resolve(u);try{delete window[n]}catch{window[n]=void 0}},Ve._Implementations.loadAndExecuteScript(e.url,n,s),s.promise};let a=bb.request(o);if(!!g(a))return a.catch(function(s){return o.state!==$o.FAILED?Promise.reject(s):e.retryOnError(s).then(function(u){return u?(o.state=$o.UNISSUED,o.deferred=void 0,zk(e,t,n)):Promise.reject(s)})})}Ve.fetchJsonp=function(e){return new Ve(e).fetchJsonp(e.callbackParameterName)};Ve.prototype._makeRequest=function(e){let t=this;gO(t.request);let n=t.request;n.url=t.url,n.requestFunction=function(){let o=e.responseType,a=ji(e.headers,t.headers),s=e.overrideMimeType,u=e.method,l=e.data,c=Bo(),f=Ve._Implementations.loadWithXhr(t.url,o,u,l,a,c,s);return g(f)&&g(f.abort)&&(n.cancelFunction=function(){f.abort()}),c.promise};let r=bb.request(n);if(!!g(r))return r.then(function(o){return n.cancelFunction=void 0,o}).catch(function(o){return n.cancelFunction=void 0,n.state!==$o.FAILED?Promise.reject(o):t.retryOnError(o).then(function(a){return a?(n.state=$o.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(o)})})};var hae=/^data:(.*?)(;base64)?,(.*)$/;function Ib(e,t){let n=decodeURIComponent(t);return e?atob(n):n}function Nk(e,t){let n=Ib(e,t),r=new ArrayBuffer(n.length),o=new Uint8Array(r);for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return r}function dae(e,t){t=T(t,"");let n=e[1],r=!!e[2],o=e[3],a,s;switch(t){case"":case"text":return Ib(r,o);case"arraybuffer":return Nk(r,o);case"blob":return a=Nk(r,o),new Blob([a],{type:n});case"document":return s=new DOMParser,s.parseFromString(Ib(r,o),n);case"json":return JSON.parse(Ib(r,o));default:}}Ve.prototype.fetch=function(e){return e=$d(e,{}),e.method="GET",this._makeRequest(e)};Ve.fetch=function(e){return new Ve(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.delete=function(e){return e=$d(e,{}),e.method="DELETE",this._makeRequest(e)};Ve.delete=function(e){return new Ve(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})};Ve.prototype.head=function(e){return e=$d(e,{}),e.method="HEAD",this._makeRequest(e)};Ve.head=function(e){return new Ve(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.options=function(e){return e=$d(e,{}),e.method="OPTIONS",this._makeRequest(e)};Ve.options=function(e){return new Ve(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.post=function(e,t){return Ds.defined("data",e),t=$d(t,{}),t.method="POST",t.data=e,this._makeRequest(t)};Ve.post=function(e){return new Ve(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.put=function(e,t){return Ds.defined("data",e),t=$d(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)};Ve.put=function(e){return new Ve(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.patch=function(e,t){return Ds.defined("data",e),t=$d(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)};Ve.patch=function(e){return new Ve(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve._Implementations={};Ve._Implementations.loadImageElement=function(e,t,n){let r=new Image;r.onload=function(){r.naturalWidth===0&&r.naturalHeight===0&&r.width===0&&r.height===0&&(r.width=300,r.height=150),n.resolve(r)},r.onerror=function(o){n.reject(o)},t&&(dO.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e};Ve._Implementations.createImage=function(e,t,n,r,o,a){let s=e.url;Ve.supportsImageBitmapOptions().then(function(u){if(!(u&&a)){Ve._Implementations.loadImageElement(s,t,n);return}let l="blob",c="GET",f=Bo(),h=Ve._Implementations.loadWithXhr(s,l,c,void 0,void 0,f,void 0,void 0,void 0);return g(h)&&g(h.abort)&&(e.cancelFunction=function(){h.abort()}),f.promise.then(function(d){if(!g(d)){n.reject(new at(`Successfully retrieved ${s} but it contained no content.`));return}return Ve.createImageBitmapFromBlob(d,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o})}).then(function(d){n.resolve(d)})}).catch(function(u){n.reject(u)})};Ve.createImageBitmapFromBlob=function(e,t){return Ds.defined("options",t),Ds.typeOf.bool("options.flipY",t.flipY),Ds.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),Ds.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};function Bk(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function pae(e,t,n,r,o,a,s){let u=Gg("url").parse(e),l=u.protocol==="https:"?Gg("https"):Gg("http"),c=Gg("zlib"),f={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:n,headers:o};l.request(f).on("response",function(h){if(h.statusCode<200||h.statusCode>=300){a.reject(new Hw(h.statusCode,h,h.headers));return}let d=[];h.on("data",function(p){d.push(p)}),h.on("end",function(){let p=Buffer.concat(d);h.headers["content-encoding"]==="gzip"?c.gunzip(p,function(_,y){_?a.reject(new at("Error decompressing response.")):a.resolve(Bk(y,t))}):a.resolve(Bk(p,t))})}).on("error",function(h){a.reject(new Hw)}).end()}var mae=typeof XMLHttpRequest>"u";Ve._Implementations.loadWithXhr=function(e,t,n,r,o,a,s){let u=hae.exec(e);if(u!==null){a.resolve(dae(u,t));return}if(mae){pae(e,t,n,r,o,a,s);return}let l=new XMLHttpRequest;if(dO.contains(e)&&(l.withCredentials=!0),l.open(n,e,!0),g(s)&&g(l.overrideMimeType)&&l.overrideMimeType(s),g(o))for(let f in o)o.hasOwnProperty(f)&&l.setRequestHeader(f,o[f]);g(t)&&(l.responseType=t);let c=!1;return typeof e=="string"&&(c=e.indexOf("file://")===0||typeof window<"u"&&window.location.origin==="file://"),l.onload=function(){if((l.status<200||l.status>=300)&&!(c&&l.status===0)){a.reject(new Hw(l.status,l.response,l.getAllResponseHeaders()));return}let f=l.response,h=l.responseType;if(n==="HEAD"||n==="OPTIONS"){let p=l.getAllResponseHeaders().trim().split(/[\r\n]+/),_={};p.forEach(function(y){let v=y.split(": "),w=v.shift();_[w]=v.join(": ")}),a.resolve(_);return}if(l.status===204)a.resolve();else if(g(f)&&(!g(t)||h===t))a.resolve(f);else if(t==="json"&&typeof f=="string")try{a.resolve(JSON.parse(f))}catch(d){a.reject(d)}else(h===""||h==="document")&&g(l.responseXML)&&l.responseXML.hasChildNodes()?a.resolve(l.responseXML):(h===""||h==="text")&&g(l.responseText)?a.resolve(l.responseText):a.reject(new at("Invalid XMLHttpRequest response type."))},l.onerror=function(f){a.reject(new Hw)},l.send(r),l};Ve._Implementations.loadAndExecuteScript=function(e,t,n){return xk(e,t).catch(function(r){n.reject(r)})};Ve._DefaultImplementations={};Ve._DefaultImplementations.createImage=Ve._Implementations.createImage;Ve._DefaultImplementations.loadWithXhr=Ve._Implementations.loadWithXhr;Ve._DefaultImplementations.loadAndExecuteScript=Ve._Implementations.loadAndExecuteScript;Ve.DEFAULT=Object.freeze(new Ve({url:typeof document>"u"?"":document.location.href.split("?")[0]}));var vt=Ve;var Vk=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;function gae(){let e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){let r=e[t].getAttribute("src"),o=Vk.exec(r);if(o!==null)return o[1]}}var eC;function kk(e){return typeof document>"u"?e:(g(eC)||(eC=document.createElement("a")),eC.href=e,eC.href=eC.href,eC.href)}var D_;function Gk(){if(g(D_))return D_;let e;return typeof CESIUM_BASE_URL<"u"?e=CESIUM_BASE_URL:typeof define=="object"&&g(define.amd)&&!define.amd.toUrlUndefined&&g(Gg.toUrl)?e=S_("..",P_("Core/buildModuleUrl.js")):e=gae(),D_=new vt({url:kk(e)}),D_.appendForwardSlash(),D_}function _ae(e){return kk(Gg.toUrl(`../${e}`))}function Uk(e){return Gk().getDerivedResource({url:e}).url}var Db;function P_(e){return g(Db)||(typeof define=="object"&&g(define.amd)&&!define.amd.toUrlUndefined&&g(Gg.toUrl)?Db=_ae:Db=Uk),Db(e)}P_._cesiumScriptRegex=Vk;P_._buildModuleUrlFromBaseUrl=Uk;P_._clearBaseResource=function(){D_=void 0};P_.setBaseUrl=function(e){D_=vt.DEFAULT.getDerivedResource({url:e})};P_.getCesiumBaseUrl=Gk;var La=P_;function Rf(e){this.airport=new Cesium.AssociativeArray,this.airspace=[],this.bigAirSpace=[],this.viewer=e.viewer}Rf.prototype.addAirSpace=function(e){let t=this,n=e.name,r=Cesium.defaultValue(new Cesium.Color(e.r,e.g,e.b),new Cesium.Color(1,1,1)),o=e.coor,a=e.id,s=t.viewer.entities.add({id:a,corridor:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(o),outline:!0,width:1,outlineColor:r,material:r,extrudedHeight:300,extrudedHeightReference:Cesium.HeightReference.RELATIVE_TO_GROUND}}),u=[],l=new Cesium.BoundingRectangle;for(let f=0;f<o.length;f=f+3){let h=new Cesium.Cartesian2(o[f],o[f+1]);u.push(h)}Cesium.BoundingRectangle.fromPoints(u,l);let c=new Cesium.Cartesian2(l.x+l.width/2,l.y+l.height/2);s.center=c,t.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(c.x,c.y),label:new Cesium.LabelGraphics({text:n,translucencyByDistance:new Cesium.NearFarScalar(1500,1,9e6,0),scaleByDistance:new Cesium.NearFarScalar(1500,3,9e5,0),disableDepthTestDistance:Number.POSITIVE_INFINITY}),id:a+"_001"}),s.labelID=a+"_001",t.airspace.push(s)};Rf.prototype.removeAirSpaceById=function(e){let t=this,n=t.viewer.entities.getById(e);if(n!=null){let r=t.viewer.entities.getById(n.labelID);n.show=!1,r.show=!1,t.viewer.entities.remove(n),t.viewer.entities.remove(r),t.airspace=t.airspace.filter(function(o){return o.id!=e})}};Rf.prototype.removeAirSpaceByName=function(e){};Rf.prototype.removeAll=function(){let e=this;e.airspace.forEach(function(t){let n=e.viewer.entities.getById(t.labelID);e.viewer.entities.remove(n),e.viewer.entities.remove(t)})};Rf.prototype.updateAirSpace=function(e){let t=this,n=t.viewer.entities.getById(e.id);if(n!=null){if(e.type=="label"){let r=t.viewer.entities.getById(n.labelID);r.label.text=e.name}}else if(e.type=="position")n.corridor.positions=e.position;else if(e==null||e.type==null)return"\u4F20\u5165\u53C2\u6570\u4E0D\u6B63\u786E"};Rf.prototype.getAirSpaceById=function(e){return this.viewer.entities.getById(e)};Rf.prototype.addBigAirSpace=function(e){let t=this,n=new Cesium.Color(e.color.r,e.color.g,e.color.b);for(let r=0;r<e.coor.length-4;r=r+2)e.coor[r]==e.coor[r+2]&&e.coor[r+1]==e.coor[r+3]&&(r+=2),t.viewer.entities.add({corridor:{positions:Cesium.Cartesian3.fromDegreesArray([e.coor[r],e.coor[r+1],e.coor[r+2],e.coor[r+3]]),outline:!0,width:1,outlineColor:n,material:n,extrudedHeight:10,extrudedHeightReference:Cesium.HeightReference.RELATIVE_TO_GROUND},name:e.name,id:"wall"+r});t.bigAirSpace.push({name:e.name,count:e.coor.length/3})};Rf.prototype.removeBigAirSpaceByName=function(e){for(let t=0;t<this.viewer.entities._values.length;t++){let n=this.viewer.entities._values[t];n.name==e&&(this.viewer.entities.remove(n),t--)}this.bigAirSpace=[]};Rf.prototype.addAirport=function(e){let t=parseFloat(e.lon),n=parseFloat(e.lat),r=parseFloat(e.alt),o=e.name,a=e.angle,s=Cesium.defaultValue(e.icon,"Assets/EMExtensions/PolitTraningApp/images/Airport.png"),u=e.id;this.airport.set(u,e);let l=this,c=l.viewer.scene,f=.1;if(Cesium.defined(l.primitive))return;let h=new Cesium.GeometryInstance({geometry:new Cesium.EllipseGeometry({center:Cesium.Cartesian3.fromDegrees(t,n),semiMinorAxis:f,semiMajorAxis:f,height:r,stRotation:Cesium.Math.toRadians(a),vertexFormat:Cesium.VertexFormat.POSITION_AND_ST})}),d=new Cesium.Primitive({geometryInstances:h,appearance:new Cesium.MaterialAppearance({material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:La("Assets/EMExtensions/PolitTraningApp/images/Airport.png")}}}),flat:!0})});d.id=u,c.primitives.add(d),l.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t,n,r),label:{text:o,pixelOffset:new Cesium.Cartesian2(32,-5),fillColor:Cesium.Color.ORANGE,scale:.75},id:u+"001"});let p=l.airport.get(u);p.labelID=u+"001";let _=Cesium.Cartesian3.fromDegrees(t,n,r),y=Cesium.Matrix4.clone(d.modelMatrix);function v(A){let D=Cesium.Matrix4.fromArray(y),P=Cesium.Matrix4.getMatrix3(D,new Cesium.Matrix3),M=Cesium.Matrix3.inverse(P,new Cesium.Matrix3),b=Cesium.Matrix4.getTranslation(D,new Cesium.Cartesian3),O=Cesium.Transforms.eastNorthUpToFixedFrame(_),m=Cesium.Matrix4.getMatrix3(O,new Cesium.Matrix3),I=Cesium.Matrix4.getTranslation(O,new Cesium.Cartesian3),L=Cesium.Cartesian3.subtract(b,I,new Cesium.Cartesian3);L=Cesium.Matrix4.fromTranslation(L,new Cesium.Matrix4);let R=Cesium.Matrix3.multiply(M,m,new Cesium.Matrix3);R=Cesium.Matrix3.inverse(R,new Cesium.Matrix3),R=Cesium.Matrix4.fromRotationTranslation(R);let N=Cesium.Matrix4.fromRotationTranslation(A);Cesium.Matrix4.multiply(O,N,O),Cesium.Matrix4.multiply(O,R,O),Cesium.Matrix4.multiply(O,L,O),d.modelMatrix=O}let w=new Cesium.BoundingSphere;function C(A,D){return w.center=_,w.radius=D,A.camera.getPixelSize(w,A.context.drawingBufferWidth,A.context.drawingBufferHeight)}let E=1,S=l.viewer.scene.preRender.addEventListener(function(){let A=c._frameState,D=A.context,P=Math.max(D.drawingBufferWidth,D.drawingBufferHeight),M=C(A,f),b=1/M;Math.min(b*(2*f),P)<32&&(E=32*M/(2*f));let m=Cesium.Matrix3.fromScale(new Cesium.Cartesian3(E,E,E));v(m)})};Rf.prototype.removeAirport=function(e){let t=this;for(let r=0;r<t.viewer.scene.primitives.length;++r){let o=t.viewer.scene.primitives.get(r);if(o.id!=null&&o.id===e){t.viewer.scene.primitives.remove(o);break}}let n=t.viewer.entities.getById(e+"001");t.viewer.entities.remove(n),t.airport.set(e,"")};Rf.prototype.getAirPort=function(e){let t=this,n=t.viewer.scene.primitives.length;for(let r=0;r<n;++r){let o=t.viewer.scene.primitives.get(r);if(o.id===e)return o}};var Hk=Rf;function Xw(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.startYaw=Cesium.defaultValue(e.startYaw,0),this.endYaw=Cesium.defaultValue(e.endYaw,360),this.innerRadius=Cesium.defaultValue(e.innerRadius,5300),this._innerRadius=void 0,this.outerRadius=Cesium.defaultValue(e.outerRadius,15200),this._outerRadius=void 0,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._attributeLocations=void 0,this._allCommands=[],this.instance=Cesium.defaultValue(e.instance,void 0),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({depthTest:!0})}),this._scene.primitives.add(this)}Xw.prototype.update=function(e){this._allCommands.length=0;var t=e.context,n=this;this.outerRadius instanceof Cesium.CallbackProperty?this._outerRadius=this.outerRadius.getValue(e.time):this._outerRadius=this.outerRadius,this.innerRadius instanceof Cesium.CallbackProperty?this._innerRadius=this.innerRadius.getValue(e.time):this._innerRadius=this.innerRadius,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix);var r=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,r,this._modelMatrix),this._fillCommand.uniformMap={v_colour:function(){return n.fillColor}};var o=this.createFillMesh();this._fillVA=qk(this,t,o),this._outlineCommand.uniformMap={v_colour:function(){return n.lineColor}};var a=this.createOutlineMesh();this._outlineVA=qk(this,t,a),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Wk(),fragmentShaderSource:Yk()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Wk(),fragmentShaderSource:Yk()})),this._fillCommand.vertexArray=this._fillVA,this._outlineCommand.vertexArray=this._outlineVA,this.renderStyle!=2&&this._allCommands.push(this._fillCommand),this.renderStyle!=1&&this._allCommands.push(this._outlineCommand);var s=e.commandList,u=e.passes,l=this._allCommands;if(this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,u.render&&this._show)for(var c=0,f=l.length;c<f;c++){var h=l[c];s.push(h)}};Xw.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._scene.primitives._guid])}};function qk(e,t,n){var r=yae(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function yae(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}Xw.prototype.createFillMesh=function(){for(var e=10,t=(this.endYaw-this.startYaw)/e,n=(this.endYaw-this.startYaw)/e,r=new Float64Array((n+1)*(t+1)*3),o=(n+1)*(t+1)*6,a=this._outerRadius,s=this._innerRadius,u=0,l=0,c=Cesium.IndexDatatype.createTypedArray((n+1)*(t+1),o),f=0;f<=n;f+=1)for(var h=f*10,d=[],p=Xk(h,d,s,a),_=0;_<p.positions.length;_++)r[u++]=p.positions[_].x,r[u++]=p.positions[_].y,r[u++]=p.positions[_].z;for(var y=0;y<n;y++)for(var v=0;v<t;v++)c[l++]=y*37+v,c[l++]=y*37+v+37,c[l++]=y*37+v+1,c[l++]=y*37+v+1,c[l++]=y*37+v+37,c[l++]=y*37+v+38;return{position:r,indices:c}};Xw.prototype.createOutlineMesh=function(){for(var e=10,t=(this.endYaw-this.startYaw)/e,n=(this.endYaw-this.startYaw)/e,r=new Float64Array((n+1)*(t+1)*3),o=(n+1)*(t+1)*6,a=this._outerRadius,s=this._innerRadius,u=0,l=0,c=Cesium.IndexDatatype.createTypedArray((n+1)*(t+1),o),f=0;f<=n;f+=1)for(var h=f*10,d=[],p=Xk(h,d,s,a),_=0;_<p.positions.length;_++)r[u++]=p.positions[_].x,r[u++]=p.positions[_].y,r[u++]=p.positions[_].z;for(var y=0;y<n+1;y++)for(var v=0;v<t;v++)c[l++]=y*37+v,c[l++]=y*37+v+1,y<(n+1)*(t+1)/(n+1)-1&&(c[l++]=y*(n+1)+v,c[l++]=y*(n+1)+v+37);return{position:r,indices:c}};function Xk(e,t,n,r){for(var o=new Cesium.Cartesian3(-r,0,0),a=[],s=0;s<=360;s+=10){var u=new Cesium.Cartesian3,l=Cesium.Math.toRadians(s);u.x=n*Math.cos(l)+o.x,u.y=n*Math.sin(l)+o.y,u.z=o.z,a.push(u)}var c=new Cesium.Quaternion;c=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,-Cesium.Math.toRadians(e),new Cesium.Quaternion);for(var f=Cesium.Matrix3.fromQuaternion(c,new Cesium.Matrix3),h=0;h<a.length;h++){var d=Cesium.Matrix3.multiplyByVector(f,a[h],new Cesium.Cartesian3);t.push(d)}return{positions:t}}function Wk(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Yk(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var Pb=Xw;function qe(e,t){this.x=T(e,0),this.y=T(t,0)}qe.fromElements=function(e,t,n){return g(n)?(n.x=e,n.y=t,n):new qe(e,t)};qe.clone=function(e,t){if(!!g(e))return g(t)?(t.x=e.x,t.y=e.y,t):new qe(e.x,e.y)};qe.fromCartesian3=qe.clone;qe.fromCartesian4=qe.clone;qe.packedLength=2;qe.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n]=e.y,t};qe.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new qe),n.x=e[t++],n.y=e[t],n};qe.packArray=function(e,t){let n=e.length,r=n*2;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)qe.pack(e[o],t,o*2);return t};qe.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/2:t=new Array(n/2);for(let r=0;r<n;r+=2){let o=r/2;t[o]=qe.unpack(e,r,t[o])}return t};qe.fromArray=qe.unpack;qe.maximumComponent=function(e){return Math.max(e.x,e.y)};qe.minimumComponent=function(e){return Math.min(e.x,e.y)};qe.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n};qe.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n};qe.clamp=function(e,t,n,r){let o=F.clamp(e.x,t.x,n.x),a=F.clamp(e.y,t.y,n.y);return r.x=o,r.y=a,r};qe.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y};qe.magnitude=function(e){return Math.sqrt(qe.magnitudeSquared(e))};var Mb=new qe;qe.distance=function(e,t){return qe.subtract(e,t,Mb),qe.magnitude(Mb)};qe.distanceSquared=function(e,t){return qe.subtract(e,t,Mb),qe.magnitudeSquared(Mb)};qe.normalize=function(e,t){let n=qe.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t};qe.dot=function(e,t){return e.x*t.x+e.y*t.y};qe.cross=function(e,t){return e.x*t.y-e.y*t.x};qe.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n};qe.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n};qe.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n};qe.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n};qe.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n};qe.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n};qe.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t};qe.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var jk=new qe;qe.lerp=function(e,t,n,r){return qe.multiplyByScalar(t,n,jk),r=qe.multiplyByScalar(e,1-n,r),qe.add(jk,r,r)};var Kk=new qe,Zk=new qe;qe.angleBetween=function(e,t){return qe.normalize(e,Kk),qe.normalize(t,Zk),F.acosClamped(qe.dot(Kk,Zk))};var vae=new qe;qe.mostOrthogonalAxis=function(e,t){let n=qe.normalize(e,vae);return qe.abs(n,n),n.x<=n.y?t=qe.clone(qe.UNIT_X,t):t=qe.clone(qe.UNIT_Y,t),t};qe.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y};qe.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]};qe.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)};qe.ZERO=Object.freeze(new qe(0,0));qe.ONE=Object.freeze(new qe(1,1));qe.UNIT_X=Object.freeze(new qe(1,0));qe.UNIT_Y=Object.freeze(new qe(0,1));qe.prototype.clone=function(e){return qe.clone(this,e)};qe.prototype.equals=function(e){return qe.equals(this,e)};qe.prototype.equalsEpsilon=function(e,t,n){return qe.equalsEpsilon(this,e,t,n)};qe.prototype.toString=function(){return`(${this.x}, ${this.y})`};var X=qe;function Te(e,t,n){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0)}Te.fromSpherical=function(e,t){g(t)||(t=new Te);let n=e.clock,r=e.cone,o=T(e.magnitude,1),a=o*Math.sin(r);return t.x=a*Math.cos(n),t.y=a*Math.sin(n),t.z=o*Math.cos(r),t};Te.fromElements=function(e,t,n,r){return g(r)?(r.x=e,r.y=t,r.z=n,r):new Te(e,t,n)};Te.clone=function(e,t){if(!!g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new Te(e.x,e.y,e.z)};Te.fromCartesian4=Te.clone;Te.packedLength=3;Te.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t};Te.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Te),n.x=e[t++],n.y=e[t++],n.z=e[t],n};Te.packArray=function(e,t){let n=e.length,r=n*3;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Te.pack(e[o],t,o*3);return t};Te.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/3:t=new Array(n/3);for(let r=0;r<n;r+=3){let o=r/3;t[o]=Te.unpack(e,r,t[o])}return t};Te.fromArray=Te.unpack;Te.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)};Te.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)};Te.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n};Te.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n};Te.clamp=function(e,t,n,r){let o=F.clamp(e.x,t.x,n.x),a=F.clamp(e.y,t.y,n.y),s=F.clamp(e.z,t.z,n.z);return r.x=o,r.y=a,r.z=s,r};Te.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z};Te.magnitude=function(e){return Math.sqrt(Te.magnitudeSquared(e))};var Rb=new Te;Te.distance=function(e,t){return Te.subtract(e,t,Rb),Te.magnitude(Rb)};Te.distanceSquared=function(e,t){return Te.subtract(e,t,Rb),Te.magnitudeSquared(Rb)};Te.normalize=function(e,t){let n=Te.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t};Te.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z};Te.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n};Te.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n};Te.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n};Te.subtract=function(e,t,n){return g(n)||(n=new Te),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n};Te.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n};Te.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n};Te.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t};Te.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var Qk=new Te;Te.lerp=function(e,t,n,r){return Te.multiplyByScalar(t,n,Qk),r=Te.multiplyByScalar(e,1-n,r),Te.add(Qk,r,r)};var Lb=new Te,_O=new Te;Te.angleBetween=function(e,t){Te.normalize(e,Lb),Te.normalize(t,_O);let n=Te.dot(Lb,_O),r=Te.magnitude(Te.cross(Lb,_O,Lb));return Math.atan2(r,n)};var Cae=new Te;Te.mostOrthogonalAxis=function(e,t){let n=Te.normalize(e,Cae);return Te.abs(n,n),n.x<=n.y?n.x<=n.z?t=Te.clone(Te.UNIT_X,t):t=Te.clone(Te.UNIT_Z,t):n.y<=n.z?t=Te.clone(Te.UNIT_Y,t):t=Te.clone(Te.UNIT_Z,t),t};Te.projectVector=function(e,t,n){let r=Te.dot(e,t)/Te.dot(t,t);return Te.multiplyByScalar(t,r,n)};Te.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};Te.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]};Te.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)&&F.equalsEpsilon(e.z,t.z,n,r)};Te.cross=function(e,t,n){let r=e.x,o=e.y,a=e.z,s=t.x,u=t.y,l=t.z,c=o*l-a*u,f=a*s-r*l,h=r*u-o*s;return n.x=c,n.y=f,n.z=h,n};Te.midpoint=function(e,t,n){return n.x=(e.x+t.x)*.5,n.y=(e.y+t.y)*.5,n.z=(e.z+t.z)*.5,n};Te.fromDegrees=function(e,t,n,r,o){return e=F.toRadians(e),t=F.toRadians(t),Te.fromRadians(e,t,n,r,o)};var Of=new Te,tC=new Te;Te.wgs84RadiiSquared=new Te(6378137*6378137,6378137*6378137,6356752314245179e-9*6356752314245179e-9);Te.fromRadians=function(e,t,n,r,o){n=T(n,0);let a=g(r)?r.radiiSquared:this.wgs84RadiiSquared,s=Math.cos(t);Of.x=s*Math.cos(e),Of.y=s*Math.sin(e),Of.z=Math.sin(t),Of=Te.normalize(Of,Of),Te.multiplyComponents(a,Of,tC);let u=Math.sqrt(Te.dot(Of,tC));return tC=Te.divideByScalar(tC,u,tC),Of=Te.multiplyByScalar(Of,n,Of),g(o)||(o=new Te),Te.add(tC,Of,o)};Te.fromDegreesArray=function(e,t,n){let r=e.length;g(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){let a=e[o],s=e[o+1],u=o/2;n[u]=Te.fromDegrees(a,s,0,t,n[u])}return n};Te.fromRadiansArray=function(e,t,n){let r=e.length;g(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){let a=e[o],s=e[o+1],u=o/2;n[u]=Te.fromRadians(a,s,0,t,n[u])}return n};Te.fromDegreesArrayHeights=function(e,t,n){let r=e.length;g(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){let a=e[o],s=e[o+1],u=e[o+2],l=o/3;n[l]=Te.fromDegrees(a,s,u,t,n[l])}return n};Te.fromRadiansArrayHeights=function(e,t,n){let r=e.length;g(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){let a=e[o],s=e[o+1],u=e[o+2],l=o/3;n[l]=Te.fromRadians(a,s,u,t,n[l])}return n};Te.ZERO=Object.freeze(new Te(0,0,0));Te.ONE=Object.freeze(new Te(1,1,1));Te.UNIT_X=Object.freeze(new Te(1,0,0));Te.UNIT_Y=Object.freeze(new Te(0,1,0));Te.UNIT_Z=Object.freeze(new Te(0,0,1));Te.prototype.clone=function(e){return Te.clone(this,e)};Te.prototype.equals=function(e){return Te.equals(this,e)};Te.prototype.equalsEpsilon=function(e,t,n){return Te.equalsEpsilon(this,e,t,n)};Te.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var x=Te;var xae=new x,wae=new x;function Eae(e,t,n,r,o){let a=e.x,s=e.y,u=e.z,l=t.x,c=t.y,f=t.z,h=a*a*l*l,d=s*s*c*c,p=u*u*f*f,_=h+d+p,y=Math.sqrt(1/_),v=x.multiplyByScalar(e,y,xae);if(_<r)return isFinite(y)?x.clone(v,o):void 0;let w=n.x,C=n.y,E=n.z,S=wae;S.x=v.x*w*2,S.y=v.y*C*2,S.z=v.z*E*2;let A=(1-y)*x.magnitude(e)/(.5*x.magnitude(S)),D=0,P,M,b,O,m,I,L,R,N,B,V;do{A-=D,b=1/(1+A*w),O=1/(1+A*C),m=1/(1+A*E),I=b*b,L=O*O,R=m*m,N=I*b,B=L*O,V=R*m,P=h*I+d*L+p*R-1,M=h*N*w+d*B*C+p*V*E;let z=-2*M;D=P/z}while(Math.abs(P)>F.EPSILON12);return g(o)?(o.x=a*b,o.y=s*O,o.z=u*m,o):new x(a*b,s*O,u*m)}var Ob=Eae;function pa(e,t,n){this.longitude=T(e,0),this.latitude=T(t,0),this.height=T(n,0)}pa.fromRadians=function(e,t,n,r){return n=T(n,0),g(r)?(r.longitude=e,r.latitude=t,r.height=n,r):new pa(e,t,n)};pa.fromDegrees=function(e,t,n,r){return e=F.toRadians(e),t=F.toRadians(t),pa.fromRadians(e,t,n,r)};var Tae=new x,Sae=new x,Aae=new x;pa.wgs84OneOverRadii=new x(1/6378137,1/6378137,1/6356752314245179e-9);pa.wgs84OneOverRadiiSquared=new x(1/(6378137*6378137),1/(6378137*6378137),1/(6356752314245179e-9*6356752314245179e-9));var bae=F.EPSILON1;pa.fromCartesian=function(e,t,n){let r=g(t)?t.oneOverRadii:this.wgs84OneOverRadii,o=g(t)?t.oneOverRadiiSquared:this.wgs84OneOverRadiiSquared,a=g(t)?t._centerToleranceSquared:bae,s=Ob(e,r,o,a,Sae);if(!g(s))return;let u=x.multiplyComponents(s,o,Tae);u=x.normalize(u,u);let l=x.subtract(e,s,Aae),c=Math.atan2(u.y,u.x),f=Math.asin(u.z),h=F.sign(x.dot(l,e))*x.magnitude(l);return g(n)?(n.longitude=c,n.latitude=f,n.height=h,n):new pa(c,f,h)};pa.toCartesian=function(e,t,n){return x.fromRadians(e.longitude,e.latitude,e.height,t,n)};pa.clone=function(e,t){if(!!g(e))return g(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new pa(e.longitude,e.latitude,e.height)};pa.equals=function(e,t){return e===t||g(e)&&g(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};pa.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n};pa.ZERO=Object.freeze(new pa(0,0,0));pa.prototype.clone=function(e){return pa.clone(this,e)};pa.prototype.equals=function(e){return pa.equals(this,e)};pa.prototype.equalsEpsilon=function(e,t){return pa.equalsEpsilon(this,e,t)};pa.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var le=pa;function $k(e,t,n,r){t=T(t,0),n=T(n,0),r=T(r,0),e._radii=new x(t,n,r),e._radiiSquared=new x(t*t,n*n,r*r),e._radiiToTheFourth=new x(t*t*t*t,n*n*n*n,r*r*r*r),e._oneOverRadii=new x(t===0?0:1/t,n===0?0:1/n,r===0?0:1/r),e._oneOverRadiiSquared=new x(t===0?0:1/(t*t),n===0?0:1/(n*n),r===0?0:1/(r*r)),e._minimumRadius=Math.min(t,n,r),e._maximumRadius=Math.max(t,n,r),e._centerToleranceSquared=F.EPSILON1,e._radiiSquared.z!==0&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function yi(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,$k(this,e,t,n)}Object.defineProperties(yi.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});yi.clone=function(e,t){if(!g(e))return;let n=e._radii;return g(t)?(x.clone(n,t._radii),x.clone(e._radiiSquared,t._radiiSquared),x.clone(e._radiiToTheFourth,t._radiiToTheFourth),x.clone(e._oneOverRadii,t._oneOverRadii),x.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new yi(n.x,n.y,n.z)};yi.fromCartesian3=function(e,t){return g(t)||(t=new yi),g(e)&&$k(t,e.x,e.y,e.z),t};yi.WGS84=Object.freeze(new yi(6378137,6378137,6356752314245179e-9));yi.UNIT_SPHERE=Object.freeze(new yi(1,1,1));yi.MOON=Object.freeze(new yi(F.LUNAR_RADIUS,F.LUNAR_RADIUS,F.LUNAR_RADIUS));yi.prototype.clone=function(e){return yi.clone(this,e)};yi.packedLength=x.packedLength;yi.pack=function(e,t,n){return n=T(n,0),x.pack(e._radii,t,n),t};yi.unpack=function(e,t,n){t=T(t,0);let r=x.unpack(e,t);return yi.fromCartesian3(r,n)};yi.prototype.geocentricSurfaceNormal=x.normalize;yi.prototype.geodeticSurfaceNormalCartographic=function(e,t){let n=e.longitude,r=e.latitude,o=Math.cos(r),a=o*Math.cos(n),s=o*Math.sin(n),u=Math.sin(r);return g(t)||(t=new x),t.x=a,t.y=s,t.z=u,x.normalize(t,t)};yi.prototype.geodeticSurfaceNormal=function(e,t){if(!x.equalsEpsilon(e,x.ZERO,F.EPSILON14))return g(t)||(t=new x),t=x.multiplyComponents(e,this._oneOverRadiiSquared,t),x.normalize(t,t)};var Iae=new x,Dae=new x;yi.prototype.cartographicToCartesian=function(e,t){let n=Iae,r=Dae;this.geodeticSurfaceNormalCartographic(e,n),x.multiplyComponents(this._radiiSquared,n,r);let o=Math.sqrt(x.dot(n,r));return x.divideByScalar(r,o,r),x.multiplyByScalar(n,e.height,n),g(t)||(t=new x),x.add(r,n,t)};yi.prototype.cartographicArrayToCartesianArray=function(e,t){let n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};var Pae=new x,Mae=new x,Lae=new x;yi.prototype.cartesianToCartographic=function(e,t){let n=this.scaleToGeodeticSurface(e,Mae);if(!g(n))return;let r=this.geodeticSurfaceNormal(n,Pae),o=x.subtract(e,n,Lae),a=Math.atan2(r.y,r.x),s=Math.asin(r.z),u=F.sign(x.dot(o,e))*x.magnitude(o);return g(t)?(t.longitude=a,t.latitude=s,t.height=u,t):new le(a,s,u)};yi.prototype.cartesianArrayToCartographicArray=function(e,t){let n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t};yi.prototype.scaleToGeodeticSurface=function(e,t){return Ob(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};yi.prototype.scaleToGeocentricSurface=function(e,t){g(t)||(t=new x);let n=e.x,r=e.y,o=e.z,a=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*a.x+r*r*a.y+o*o*a.z);return x.multiplyByScalar(e,s,t)};yi.prototype.transformPositionToScaledSpace=function(e,t){return g(t)||(t=new x),x.multiplyComponents(e,this._oneOverRadii,t)};yi.prototype.transformPositionFromScaledSpace=function(e,t){return g(t)||(t=new x),x.multiplyComponents(e,this._radii,t)};yi.prototype.equals=function(e){return this===e||g(e)&&x.equals(this._radii,e._radii)};yi.prototype.toString=function(){return this._radii.toString()};yi.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){t=T(t,0);let r=this._squaredXOverSquaredZ;if(g(n)||(n=new x),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-t))return n};var Rae=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],Oae=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function Jk(e,t,n){let r=.5*(t+e),o=.5*(t-e),a=0;for(let s=0;s<5;s++){let u=o*Rae[s];a+=Oae[s]*(n(r+u)+n(r-u))}return a*=o,a}yi.prototype.surfaceArea=function(e){let t=e.west,n=e.east,r=e.south,o=e.north;for(;n<t;)n+=F.TWO_PI;let a=this._radiiSquared,s=a.x,u=a.y,l=a.z,c=s*u;return Jk(r,o,function(f){let h=Math.cos(f),d=Math.sin(f);return Math.cos(f)*Jk(t,n,function(p){let _=Math.cos(p),y=Math.sin(p);return Math.sqrt(c*d*d+l*(u*_*_+s*y*y)*h*h)})})};var Ge=yi;function Nb(e){this._ellipsoid=T(e,Ge.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(Nb.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});Nb.prototype.project=function(e,t){let n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,a=e.height;return g(t)?(t.x=r,t.y=o,t.z=a,t):new x(r,o,a)};Nb.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,r=e.x*n,o=e.y*n,a=e.z;return g(t)?(t.longitude=r,t.latitude=o,t.height=a,t):new le(r,o,a)};var mc=Nb;var Nae={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},vi=Object.freeze(Nae);function nn(e,t,n,r){this.west=T(e,0),this.south=T(t,0),this.east=T(n,0),this.north=T(r,0)}Object.defineProperties(nn.prototype,{width:{get:function(){return nn.computeWidth(this)}},height:{get:function(){return nn.computeHeight(this)}}});nn.packedLength=4;nn.pack=function(e,t,n){return n=T(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t};nn.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new nn),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n};nn.computeWidth=function(e){let t=e.east,n=e.west;return t<n&&(t+=F.TWO_PI),t-n};nn.computeHeight=function(e){return e.north-e.south};nn.fromDegrees=function(e,t,n,r,o){return e=F.toRadians(T(e,0)),t=F.toRadians(T(t,0)),n=F.toRadians(T(n,0)),r=F.toRadians(T(r,0)),g(o)?(o.west=e,o.south=t,o.east=n,o.north=r,o):new nn(e,t,n,r)};nn.fromRadians=function(e,t,n,r,o){return g(o)?(o.west=T(e,0),o.south=T(t,0),o.east=T(n,0),o.north=T(r,0),o):new nn(e,t,n,r)};nn.fromCartographicArray=function(e,t){let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let l=0,c=e.length;l<c;l++){let f=e[l];n=Math.min(n,f.longitude),r=Math.max(r,f.longitude),s=Math.min(s,f.latitude),u=Math.max(u,f.latitude);let h=f.longitude>=0?f.longitude:f.longitude+F.TWO_PI;o=Math.min(o,h),a=Math.max(a,h)}return r-n>a-o&&(n=o,r=a,r>F.PI&&(r=r-F.TWO_PI),n>F.PI&&(n=n-F.TWO_PI)),g(t)?(t.west=n,t.south=s,t.east=r,t.north=u,t):new nn(n,s,r,u)};nn.fromCartesianArray=function(e,t,n){t=T(t,Ge.WGS84);let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,s=-Number.MAX_VALUE,u=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(let c=0,f=e.length;c<f;c++){let h=t.cartesianToCartographic(e[c]);r=Math.min(r,h.longitude),o=Math.max(o,h.longitude),u=Math.min(u,h.latitude),l=Math.max(l,h.latitude);let d=h.longitude>=0?h.longitude:h.longitude+F.TWO_PI;a=Math.min(a,d),s=Math.max(s,d)}return o-r>s-a&&(r=a,o=s,o>F.PI&&(o=o-F.TWO_PI),r>F.PI&&(r=r-F.TWO_PI)),g(n)?(n.west=r,n.south=u,n.east=o,n.north=l,n):new nn(r,u,o,l)};nn.clone=function(e,t){if(!!g(e))return g(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new nn(e.west,e.south,e.east,e.north)};nn.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n};nn.prototype.clone=function(e){return nn.clone(this,e)};nn.prototype.equals=function(e){return nn.equals(this,e)};nn.equals=function(e,t){return e===t||g(e)&&g(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};nn.prototype.equalsEpsilon=function(e,t){return nn.equalsEpsilon(this,e,t)};nn.validate=function(e){};nn.southwest=function(e,t){return g(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new le(e.west,e.south)};nn.northwest=function(e,t){return g(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new le(e.west,e.north)};nn.northeast=function(e,t){return g(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new le(e.east,e.north)};nn.southeast=function(e,t){return g(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new le(e.east,e.south)};nn.center=function(e,t){let n=e.east,r=e.west;n<r&&(n+=F.TWO_PI);let o=F.negativePiToPi((r+n)*.5),a=(e.south+e.north)*.5;return g(t)?(t.longitude=o,t.latitude=a,t.height=0,t):new le(o,a)};nn.intersection=function(e,t,n){let r=e.east,o=e.west,a=t.east,s=t.west;r<o&&a>0?r+=F.TWO_PI:a<s&&r>0&&(a+=F.TWO_PI),r<o&&s<0?s+=F.TWO_PI:a<s&&o<0&&(o+=F.TWO_PI);let u=F.negativePiToPi(Math.max(o,s)),l=F.negativePiToPi(Math.min(r,a));if((e.west<e.east||t.west<t.east)&&l<=u)return;let c=Math.max(e.south,t.south),f=Math.min(e.north,t.north);if(!(c>=f))return g(n)?(n.west=u,n.south=c,n.east=l,n.north=f,n):new nn(u,c,l,f)};nn.simpleIntersection=function(e,t,n){let r=Math.max(e.west,t.west),o=Math.max(e.south,t.south),a=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||r>=a))return g(n)?(n.west=r,n.south=o,n.east=a,n.north=s,n):new nn(r,o,a,s)};nn.union=function(e,t,n){g(n)||(n=new nn);let r=e.east,o=e.west,a=t.east,s=t.west;r<o&&a>0?r+=F.TWO_PI:a<s&&r>0&&(a+=F.TWO_PI),r<o&&s<0?s+=F.TWO_PI:a<s&&o<0&&(o+=F.TWO_PI);let u=F.negativePiToPi(Math.min(o,s)),l=F.negativePiToPi(Math.max(r,a));return n.west=u,n.south=Math.min(e.south,t.south),n.east=l,n.north=Math.max(e.north,t.north),n};nn.expand=function(e,t,n){return g(n)||(n=new nn),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n};nn.contains=function(e,t){let n=t.longitude,r=t.latitude,o=e.west,a=e.east;return a<o&&(a+=F.TWO_PI,n<0&&(n+=F.TWO_PI)),(n>o||F.equalsEpsilon(n,o,F.EPSILON14))&&(n<a||F.equalsEpsilon(n,a,F.EPSILON14))&&r>=e.south&&r<=e.north};var Bae=new le;nn.subsample=function(e,t,n,r){t=T(t,Ge.WGS84),n=T(n,0),g(r)||(r=[]);let o=0,a=e.north,s=e.south,u=e.east,l=e.west,c=Bae;c.height=n,c.longitude=l,c.latitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=l,r[o]=t.cartographicToCartesian(c,r[o]),o++,a<0?c.latitude=a:s>0?c.latitude=s:c.latitude=0;for(let f=1;f<8;++f)c.longitude=-Math.PI+f*F.PI_OVER_TWO,nn.contains(e,c)&&(r[o]=t.cartographicToCartesian(c,r[o]),o++);return c.latitude===0&&(c.longitude=l,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++),r.length=o,r};nn.subsection=function(e,t,n,r,o,a){if(g(a)||(a=new nn),e.west<=e.east){let u=e.east-e.west;a.west=e.west+t*u,a.east=e.west+r*u}else{let u=F.TWO_PI+e.east-e.west;a.west=F.negativePiToPi(e.west+t*u),a.east=F.negativePiToPi(e.west+r*u)}let s=e.north-e.south;return a.south=e.south+n*s,a.north=e.south+o*s,t===1&&(a.west=e.east),r===1&&(a.east=e.east),n===1&&(a.south=e.north),o===1&&(a.north=e.north),a};nn.MAX_VALUE=Object.freeze(new nn(-Math.PI,-F.PI_OVER_TWO,Math.PI,F.PI_OVER_TWO));var hn=nn;function ma(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.width=T(n,0),this.height=T(r,0)}ma.packedLength=4;ma.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.width,t[n]=e.height,t};ma.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new ma),n.x=e[t++],n.y=e[t++],n.width=e[t++],n.height=e[t],n};ma.fromPoints=function(e,t){if(g(t)||(t=new ma),!g(e)||e.length===0)return t.x=0,t.y=0,t.width=0,t.height=0,t;let n=e.length,r=e[0].x,o=e[0].y,a=e[0].x,s=e[0].y;for(let u=1;u<n;u++){let l=e[u],c=l.x,f=l.y;r=Math.min(c,r),a=Math.max(c,a),o=Math.min(f,o),s=Math.max(f,s)}return t.x=r,t.y=o,t.width=a-r,t.height=s-o,t};var Fae=new mc,zae=new le,Vae=new le;ma.fromRectangle=function(e,t,n){if(g(n)||(n=new ma),!g(e))return n.x=0,n.y=0,n.width=0,n.height=0,n;t=T(t,Fae);let r=t.project(hn.southwest(e,zae)),o=t.project(hn.northeast(e,Vae));return X.subtract(o,r,o),n.x=r.x,n.y=r.y,n.width=o.x,n.height=o.y,n};ma.clone=function(e,t){if(!!g(e))return g(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new ma(e.x,e.y,e.width,e.height)};ma.union=function(e,t,n){g(n)||(n=new ma);let r=Math.min(e.x,t.x),o=Math.min(e.y,t.y),a=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=r,n.y=o,n.width=a-r,n.height=s-o,n};ma.expand=function(e,t,n){n=ma.clone(e,n);let r=t.x-n.x,o=t.y-n.y;return r>n.width?n.width=r:r<0&&(n.width-=r,n.x=t.x),o>n.height?n.height=o:o<0&&(n.height-=o,n.y=t.y),n};ma.intersect=function(e,t){let n=e.x,r=e.y,o=t.x,a=t.y;return n>o+t.width||n+e.width<o||r+e.height<a||r>a+t.height?vi.OUTSIDE:vi.INTERSECTING};ma.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};ma.prototype.clone=function(e){return ma.clone(this,e)};ma.prototype.intersect=function(e){return ma.intersect(this,e)};ma.prototype.equals=function(e){return ma.equals(this,e)};var rn=ma;function Oe(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0),this.w=T(r,0)}Oe.fromElements=function(e,t,n,r,o){return g(o)?(o.x=e,o.y=t,o.z=n,o.w=r,o):new Oe(e,t,n,r)};Oe.fromColor=function(e,t){return g(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new Oe(e.red,e.green,e.blue,e.alpha)};Oe.clone=function(e,t){if(!!g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new Oe(e.x,e.y,e.z,e.w)};Oe.packedLength=4;Oe.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};Oe.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Oe),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n};Oe.packArray=function(e,t){let n=e.length,r=n*4;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Oe.pack(e[o],t,o*4);return t};Oe.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){let o=r/4;t[o]=Oe.unpack(e,r,t[o])}return t};Oe.fromArray=Oe.unpack;Oe.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)};Oe.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)};Oe.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n};Oe.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n};Oe.clamp=function(e,t,n,r){let o=F.clamp(e.x,t.x,n.x),a=F.clamp(e.y,t.y,n.y),s=F.clamp(e.z,t.z,n.z),u=F.clamp(e.w,t.w,n.w);return r.x=o,r.y=a,r.z=s,r.w=u,r};Oe.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};Oe.magnitude=function(e){return Math.sqrt(Oe.magnitudeSquared(e))};var Bb=new Oe;Oe.distance=function(e,t){return Oe.subtract(e,t,Bb),Oe.magnitude(Bb)};Oe.distanceSquared=function(e,t){return Oe.subtract(e,t,Bb),Oe.magnitudeSquared(Bb)};Oe.normalize=function(e,t){let n=Oe.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t};Oe.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};Oe.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n};Oe.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n};Oe.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};Oe.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};Oe.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};Oe.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};Oe.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};Oe.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var e5=new Oe;Oe.lerp=function(e,t,n,r){return Oe.multiplyByScalar(t,n,e5),r=Oe.multiplyByScalar(e,1-n,r),Oe.add(e5,r,r)};var kae=new Oe;Oe.mostOrthogonalAxis=function(e,t){let n=Oe.normalize(e,kae);return Oe.abs(n,n),n.x<=n.y?n.x<=n.z?n.x<=n.w?t=Oe.clone(Oe.UNIT_X,t):t=Oe.clone(Oe.UNIT_W,t):n.z<=n.w?t=Oe.clone(Oe.UNIT_Z,t):t=Oe.clone(Oe.UNIT_W,t):n.y<=n.z?n.y<=n.w?t=Oe.clone(Oe.UNIT_Y,t):t=Oe.clone(Oe.UNIT_W,t):n.z<=n.w?t=Oe.clone(Oe.UNIT_Z,t):t=Oe.clone(Oe.UNIT_W,t),t};Oe.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};Oe.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]};Oe.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)&&F.equalsEpsilon(e.z,t.z,n,r)&&F.equalsEpsilon(e.w,t.w,n,r)};Oe.ZERO=Object.freeze(new Oe(0,0,0,0));Oe.ONE=Object.freeze(new Oe(1,1,1,1));Oe.UNIT_X=Object.freeze(new Oe(1,0,0,0));Oe.UNIT_Y=Object.freeze(new Oe(0,1,0,0));Oe.UNIT_Z=Object.freeze(new Oe(0,0,1,0));Oe.UNIT_W=Object.freeze(new Oe(0,0,0,1));Oe.prototype.clone=function(e){return Oe.clone(this,e)};Oe.prototype.equals=function(e){return Oe.equals(this,e)};Oe.prototype.equalsEpsilon=function(e,t,n){return Oe.equalsEpsilon(this,e,t,n)};Oe.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var yO=new Float32Array(1),tl=new Uint8Array(yO.buffer),Gae=new Uint32Array([287454020]),Uae=new Uint8Array(Gae.buffer),t5=Uae[0]===68;Oe.packFloat=function(e,t){return g(t)||(t=new Oe),yO[0]=e,t5?(t.x=tl[0],t.y=tl[1],t.z=tl[2],t.w=tl[3]):(t.x=tl[3],t.y=tl[2],t.z=tl[1],t.w=tl[0]),t};Oe.unpackFloat=function(e){return t5?(tl[0]=e.x,tl[1]=e.y,tl[2]=e.z,tl[3]=e.w):(tl[0]=e.w,tl[1]=e.z,tl[2]=e.y,tl[3]=e.x),yO[0]};var Se=Oe;var Ug,ga={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},gc={};Object.defineProperties(gc,{element:{get:function(){if(!!gc.supportsFullscreen())return document[ga.fullscreenElement]}},changeEventName:{get:function(){if(!!gc.supportsFullscreen())return ga.fullscreenchange}},errorEventName:{get:function(){if(!!gc.supportsFullscreen())return ga.fullscreenerror}},enabled:{get:function(){if(!!gc.supportsFullscreen())return document[ga.fullscreenEnabled]}},fullscreen:{get:function(){if(!!gc.supportsFullscreen())return gc.element!==null}}});gc.supportsFullscreen=function(){if(g(Ug))return Ug;Ug=!1;let e=document.body;if(typeof e.requestFullscreen=="function")return ga.requestFullscreen="requestFullscreen",ga.exitFullscreen="exitFullscreen",ga.fullscreenEnabled="fullscreenEnabled",ga.fullscreenElement="fullscreenElement",ga.fullscreenchange="fullscreenchange",ga.fullscreenerror="fullscreenerror",Ug=!0,Ug;let t=["webkit","moz","o","ms","khtml"],n;for(let r=0,o=t.length;r<o;++r){let a=t[r];n=`${a}RequestFullscreen`,typeof e[n]=="function"?(ga.requestFullscreen=n,Ug=!0):(n=`${a}RequestFullScreen`,typeof e[n]=="function"&&(ga.requestFullscreen=n,Ug=!0)),n=`${a}ExitFullscreen`,typeof document[n]=="function"?ga.exitFullscreen=n:(n=`${a}CancelFullScreen`,typeof document[n]=="function"&&(ga.exitFullscreen=n)),n=`${a}FullscreenEnabled`,document[n]!==void 0?ga.fullscreenEnabled=n:(n=`${a}FullScreenEnabled`,document[n]!==void 0&&(ga.fullscreenEnabled=n)),n=`${a}FullscreenElement`,document[n]!==void 0?ga.fullscreenElement=n:(n=`${a}FullScreenElement`,document[n]!==void 0&&(ga.fullscreenElement=n)),n=`${a}fullscreenchange`,document[`on${n}`]!==void 0&&(a==="ms"&&(n="MSFullscreenChange"),ga.fullscreenchange=n),n=`${a}fullscreenerror`,document[`on${n}`]!==void 0&&(a==="ms"&&(n="MSFullscreenError"),ga.fullscreenerror=n)}return Ug};gc.requestFullscreen=function(e,t){!gc.supportsFullscreen()||e[ga.requestFullscreen]({vrDisplay:t})};gc.exitFullscreen=function(){!gc.supportsFullscreen()||document[ga.exitFullscreen]()};gc._names=ga;var n5=gc;var nl;typeof navigator<"u"?nl=navigator:nl={};function M_(e){let t=e.split(".");for(let n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}var Fb,r5;function TO(){if(!g(Fb)&&(Fb=!1,!Hb())){let e=/ Chrome\/([\.0-9]+)/.exec(nl.userAgent);e!==null&&(Fb=!0,r5=M_(e[1]))}return Fb}function Hae(){return TO()&&r5}var zb,i5;function o5(){if(!g(zb)&&(zb=!1,!TO()&&!Hb()&&/ Safari\/[\.0-9]+/.test(nl.userAgent))){let e=/ Version\/([\.0-9]+)/.exec(nl.userAgent);e!==null&&(zb=!0,i5=M_(e[1]))}return zb}function qae(){return o5()&&i5}var Vb,wO;function a5(){if(!g(Vb)){Vb=!1;let e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(nl.userAgent);e!==null&&(Vb=!0,wO=M_(e[1]),wO.isNightly=!!e[2])}return Vb}function Wae(){return a5()&&wO}var jw,EO;function s5(){if(!g(jw)){jw=!1;let e;nl.appName==="Microsoft Internet Explorer"?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(nl.userAgent),e!==null&&(jw=!0,EO=M_(e[1]))):nl.appName==="Netscape"&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(nl.userAgent),e!==null&&(jw=!0,EO=M_(e[1])))}return jw}function Yae(){return s5()&&EO}var kb,u5;function Hb(){if(!g(kb)){kb=!1;let e=/ Edg\/([\.0-9]+)/.exec(nl.userAgent);e!==null&&(kb=!0,u5=M_(e[1]))}return kb}function Xae(){return Hb()&&u5}var Gb,l5;function SO(){if(!g(Gb)){Gb=!1;let e=/Firefox\/([\.0-9]+)/.exec(nl.userAgent);e!==null&&(Gb=!0,l5=M_(e[1]))}return Gb}var vO;function jae(){return g(vO)||(vO=/Windows/i.test(nl.appVersion)),vO}var CO;function Kae(){return g(CO)||(CO=navigator.platform==="iPhone"||navigator.platform==="iPod"||navigator.platform==="iPad"),CO}function Zae(){return SO()&&l5}var xO;function Qae(){return g(xO)||(xO=!SO()&&typeof PointerEvent<"u"&&(!g(nl.pointerEnabled)||nl.pointerEnabled)),xO}var c5,Ub;function f5(){if(!g(Ub)){let e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let t=e.style.imageRendering;Ub=g(t)&&t!=="",Ub&&(c5=t)}return Ub}function Jae(){return f5()?c5:void 0}function Ol(){return Ol._result}Ol._promise=void 0;Ol._result=void 0;Ol.initialize=function(){return g(Ol._promise)||(Ol._promise=new Promise(e=>{let t=new Image;t.onload=function(){Ol._result=t.width>0&&t.height>0,e(Ol._result)},t.onerror=function(){Ol._result=!1,e(Ol._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),Ol._promise};Object.defineProperties(Ol,{initialized:{get:function(){return g(Ol._result)}}});var nC=[];typeof ArrayBuffer<"u"&&(nC.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray<"u"&&nC.push(Uint8ClampedArray),typeof Uint8ClampedArray<"u"&&nC.push(Uint8ClampedArray),typeof BigInt64Array<"u"&&nC.push(BigInt64Array),typeof BigUint64Array<"u"&&nC.push(BigUint64Array));var ep={isChrome:TO,chromeVersion:Hae,isSafari:o5,safariVersion:qae,isWebkit:a5,webkitVersion:Wae,isInternetExplorer:s5,internetExplorerVersion:Yae,isEdge:Hb,edgeVersion:Xae,isFirefox:SO,firefoxVersion:Zae,isWindows:jae,isIPadOrIOS:Kae,hardwareConcurrency:T(nl.hardwareConcurrency,3),supportsPointerEvents:Qae,supportsImageRenderingPixelated:f5,supportsWebP:Ol,imageRenderingValue:Jae,typedArrayTypes:nC};ep.supportsBasis=function(e){return ep.supportsWebAssembly()&&e.context.supportsBasis};ep.supportsFullscreen=function(){return n5.supportsFullscreen()};ep.supportsTypedArrays=function(){return typeof ArrayBuffer<"u"};ep.supportsBigInt64Array=function(){return typeof BigInt64Array<"u"};ep.supportsBigUint64Array=function(){return typeof BigUint64Array<"u"};ep.supportsBigInt=function(){return typeof BigInt<"u"};ep.supportsWebWorkers=function(){return typeof Worker<"u"};ep.supportsWebAssembly=function(){return typeof WebAssembly<"u"};var ea=ep;function AO(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n*6<1?e+(t-e)*6*n:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}function Y(e,t,n,r){this.red=T(e,1),this.green=T(t,1),this.blue=T(n,1),this.alpha=T(r,1)}Y.fromCartesian4=function(e,t){return g(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new Y(e.x,e.y,e.z,e.w)};Y.fromBytes=function(e,t,n,r,o){return e=Y.byteToFloat(T(e,255)),t=Y.byteToFloat(T(t,255)),n=Y.byteToFloat(T(n,255)),r=Y.byteToFloat(T(r,255)),g(o)?(o.red=e,o.green=t,o.blue=n,o.alpha=r,o):new Y(e,t,n,r)};Y.fromAlpha=function(e,t,n){return g(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=t,n):new Y(e.red,e.green,e.blue,t)};var bO,IO,ym;ea.supportsTypedArrays()&&(bO=new ArrayBuffer(4),IO=new Uint32Array(bO),ym=new Uint8Array(bO));Y.fromRgba=function(e,t){return IO[0]=e,Y.fromBytes(ym[0],ym[1],ym[2],ym[3],t)};Y.fromHsl=function(e,t,n,r,o){e=T(e,0)%1,t=T(t,0),n=T(n,0),r=T(r,1);let a=n,s=n,u=n;if(t!==0){let l;n<.5?l=n*(1+t):l=n+t-n*t;let c=2*n-l;a=AO(c,l,e+1/3),s=AO(c,l,e),u=AO(c,l,e-1/3)}return g(o)?(o.red=a,o.green=s,o.blue=u,o.alpha=r,o):new Y(a,s,u,r)};Y.fromRandom=function(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.red;if(!g(n)){let s=T(e.minimumRed,0),u=T(e.maximumRed,1);n=s+F.nextRandomNumber()*(u-s)}let r=e.green;if(!g(r)){let s=T(e.minimumGreen,0),u=T(e.maximumGreen,1);r=s+F.nextRandomNumber()*(u-s)}let o=e.blue;if(!g(o)){let s=T(e.minimumBlue,0),u=T(e.maximumBlue,1);o=s+F.nextRandomNumber()*(u-s)}let a=e.alpha;if(!g(a)){let s=T(e.minimumAlpha,0),u=T(e.maximumAlpha,1);a=s+F.nextRandomNumber()*(u-s)}return g(t)?(t.red=n,t.green=r,t.blue=o,t.alpha=a,t):new Y(n,r,o,a)};var $ae=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,ese=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,tse=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,nse=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;Y.fromCssColorString=function(e,t){g(t)||(t=new Y),e=e.replace(/\s/g,"");let n=Y[e.toUpperCase()];if(g(n))return Y.clone(n,t),t;let r=$ae.exec(e);return r!==null?(t.red=parseInt(r[1],16)/15,t.green=parseInt(r[2],16)/15,t.blue=parseInt(r[3],16)/15,t.alpha=parseInt(T(r[4],"f"),16)/15,t):(r=ese.exec(e),r!==null?(t.red=parseInt(r[1],16)/255,t.green=parseInt(r[2],16)/255,t.blue=parseInt(r[3],16)/255,t.alpha=parseInt(T(r[4],"ff"),16)/255,t):(r=tse.exec(e),r!==null?(t.red=parseFloat(r[1])/(r[1].substr(-1)==="%"?100:255),t.green=parseFloat(r[2])/(r[2].substr(-1)==="%"?100:255),t.blue=parseFloat(r[3])/(r[3].substr(-1)==="%"?100:255),t.alpha=parseFloat(T(r[4],"1.0")),t):(r=nse.exec(e),r!==null?Y.fromHsl(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,parseFloat(T(r[4],"1.0")),t):(t=void 0,t))))};Y.packedLength=4;Y.pack=function(e,t,n){return n=T(n,0),t[n++]=e.red,t[n++]=e.green,t[n++]=e.blue,t[n]=e.alpha,t};Y.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Y),n.red=e[t++],n.green=e[t++],n.blue=e[t++],n.alpha=e[t],n};Y.byteToFloat=function(e){return e/255};Y.floatToByte=function(e){return e===1?255:e*256|0};Y.clone=function(e,t){if(!!g(e))return g(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new Y(e.red,e.green,e.blue,e.alpha)};Y.equals=function(e,t){return e===t||g(e)&&g(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha};Y.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]};Y.prototype.clone=function(e){return Y.clone(this,e)};Y.prototype.equals=function(e){return Y.equals(this,e)};Y.prototype.equalsEpsilon=function(e,t){return this===e||g(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t};Y.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`};Y.prototype.toCssColorString=function(){let e=Y.floatToByte(this.red),t=Y.floatToByte(this.green),n=Y.floatToByte(this.blue);return this.alpha===1?`rgb(${e},${t},${n})`:`rgba(${e},${t},${n},${this.alpha})`};Y.prototype.toCssHexString=function(){let e=Y.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=Y.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let n=Y.floatToByte(this.blue).toString(16);if(n.length<2&&(n=`0${n}`),this.alpha<1){let r=Y.floatToByte(this.alpha).toString(16);return r.length<2&&(r=`0${r}`),`#${e}${t}${n}${r}`}return`#${e}${t}${n}`};Y.prototype.toBytes=function(e){let t=Y.floatToByte(this.red),n=Y.floatToByte(this.green),r=Y.floatToByte(this.blue),o=Y.floatToByte(this.alpha);return g(e)?(e[0]=t,e[1]=n,e[2]=r,e[3]=o,e):[t,n,r,o]};Y.prototype.toRgba=function(){return ym[0]=Y.floatToByte(this.red),ym[1]=Y.floatToByte(this.green),ym[2]=Y.floatToByte(this.blue),ym[3]=Y.floatToByte(this.alpha),IO[0]};Y.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t};Y.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t};Y.prototype.withAlpha=function(e,t){return Y.fromAlpha(this,e,t)};Y.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n};Y.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n};Y.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n};Y.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n};Y.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n};Y.lerp=function(e,t,n,r){return r.red=F.lerp(e.red,t.red,n),r.green=F.lerp(e.green,t.green,n),r.blue=F.lerp(e.blue,t.blue,n),r.alpha=F.lerp(e.alpha,t.alpha,n),r};Y.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n};Y.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n};Y.ALICEBLUE=Object.freeze(Y.fromCssColorString("#F0F8FF"));Y.ANTIQUEWHITE=Object.freeze(Y.fromCssColorString("#FAEBD7"));Y.AQUA=Object.freeze(Y.fromCssColorString("#00FFFF"));Y.AQUAMARINE=Object.freeze(Y.fromCssColorString("#7FFFD4"));Y.AZURE=Object.freeze(Y.fromCssColorString("#F0FFFF"));Y.BEIGE=Object.freeze(Y.fromCssColorString("#F5F5DC"));Y.BISQUE=Object.freeze(Y.fromCssColorString("#FFE4C4"));Y.BLACK=Object.freeze(Y.fromCssColorString("#000000"));Y.BLANCHEDALMOND=Object.freeze(Y.fromCssColorString("#FFEBCD"));Y.BLUE=Object.freeze(Y.fromCssColorString("#0000FF"));Y.BLUEVIOLET=Object.freeze(Y.fromCssColorString("#8A2BE2"));Y.BROWN=Object.freeze(Y.fromCssColorString("#A52A2A"));Y.BURLYWOOD=Object.freeze(Y.fromCssColorString("#DEB887"));Y.CADETBLUE=Object.freeze(Y.fromCssColorString("#5F9EA0"));Y.CHARTREUSE=Object.freeze(Y.fromCssColorString("#7FFF00"));Y.CHOCOLATE=Object.freeze(Y.fromCssColorString("#D2691E"));Y.CORAL=Object.freeze(Y.fromCssColorString("#FF7F50"));Y.CORNFLOWERBLUE=Object.freeze(Y.fromCssColorString("#6495ED"));Y.CORNSILK=Object.freeze(Y.fromCssColorString("#FFF8DC"));Y.CRIMSON=Object.freeze(Y.fromCssColorString("#DC143C"));Y.CYAN=Object.freeze(Y.fromCssColorString("#00FFFF"));Y.DARKBLUE=Object.freeze(Y.fromCssColorString("#00008B"));Y.DARKCYAN=Object.freeze(Y.fromCssColorString("#008B8B"));Y.DARKGOLDENROD=Object.freeze(Y.fromCssColorString("#B8860B"));Y.DARKGRAY=Object.freeze(Y.fromCssColorString("#A9A9A9"));Y.DARKGREEN=Object.freeze(Y.fromCssColorString("#006400"));Y.DARKGREY=Y.DARKGRAY;Y.DARKKHAKI=Object.freeze(Y.fromCssColorString("#BDB76B"));Y.DARKMAGENTA=Object.freeze(Y.fromCssColorString("#8B008B"));Y.DARKOLIVEGREEN=Object.freeze(Y.fromCssColorString("#556B2F"));Y.DARKORANGE=Object.freeze(Y.fromCssColorString("#FF8C00"));Y.DARKORCHID=Object.freeze(Y.fromCssColorString("#9932CC"));Y.DARKRED=Object.freeze(Y.fromCssColorString("#8B0000"));Y.DARKSALMON=Object.freeze(Y.fromCssColorString("#E9967A"));Y.DARKSEAGREEN=Object.freeze(Y.fromCssColorString("#8FBC8F"));Y.DARKSLATEBLUE=Object.freeze(Y.fromCssColorString("#483D8B"));Y.DARKSLATEGRAY=Object.freeze(Y.fromCssColorString("#2F4F4F"));Y.DARKSLATEGREY=Y.DARKSLATEGRAY;Y.DARKTURQUOISE=Object.freeze(Y.fromCssColorString("#00CED1"));Y.DARKVIOLET=Object.freeze(Y.fromCssColorString("#9400D3"));Y.DEEPPINK=Object.freeze(Y.fromCssColorString("#FF1493"));Y.DEEPSKYBLUE=Object.freeze(Y.fromCssColorString("#00BFFF"));Y.DIMGRAY=Object.freeze(Y.fromCssColorString("#696969"));Y.DIMGREY=Y.DIMGRAY;Y.DODGERBLUE=Object.freeze(Y.fromCssColorString("#1E90FF"));Y.FIREBRICK=Object.freeze(Y.fromCssColorString("#B22222"));Y.FLORALWHITE=Object.freeze(Y.fromCssColorString("#FFFAF0"));Y.FORESTGREEN=Object.freeze(Y.fromCssColorString("#228B22"));Y.FUCHSIA=Object.freeze(Y.fromCssColorString("#FF00FF"));Y.GAINSBORO=Object.freeze(Y.fromCssColorString("#DCDCDC"));Y.GHOSTWHITE=Object.freeze(Y.fromCssColorString("#F8F8FF"));Y.GOLD=Object.freeze(Y.fromCssColorString("#FFD700"));Y.GOLDENROD=Object.freeze(Y.fromCssColorString("#DAA520"));Y.GRAY=Object.freeze(Y.fromCssColorString("#808080"));Y.GREEN=Object.freeze(Y.fromCssColorString("#008000"));Y.GREENYELLOW=Object.freeze(Y.fromCssColorString("#ADFF2F"));Y.GREY=Y.GRAY;Y.HONEYDEW=Object.freeze(Y.fromCssColorString("#F0FFF0"));Y.HOTPINK=Object.freeze(Y.fromCssColorString("#FF69B4"));Y.INDIANRED=Object.freeze(Y.fromCssColorString("#CD5C5C"));Y.INDIGO=Object.freeze(Y.fromCssColorString("#4B0082"));Y.IVORY=Object.freeze(Y.fromCssColorString("#FFFFF0"));Y.KHAKI=Object.freeze(Y.fromCssColorString("#F0E68C"));Y.LAVENDER=Object.freeze(Y.fromCssColorString("#E6E6FA"));Y.LAVENDAR_BLUSH=Object.freeze(Y.fromCssColorString("#FFF0F5"));Y.LAWNGREEN=Object.freeze(Y.fromCssColorString("#7CFC00"));Y.LEMONCHIFFON=Object.freeze(Y.fromCssColorString("#FFFACD"));Y.LIGHTBLUE=Object.freeze(Y.fromCssColorString("#ADD8E6"));Y.LIGHTCORAL=Object.freeze(Y.fromCssColorString("#F08080"));Y.LIGHTCYAN=Object.freeze(Y.fromCssColorString("#E0FFFF"));Y.LIGHTGOLDENRODYELLOW=Object.freeze(Y.fromCssColorString("#FAFAD2"));Y.LIGHTGRAY=Object.freeze(Y.fromCssColorString("#D3D3D3"));Y.LIGHTGREEN=Object.freeze(Y.fromCssColorString("#90EE90"));Y.LIGHTGREY=Y.LIGHTGRAY;Y.LIGHTPINK=Object.freeze(Y.fromCssColorString("#FFB6C1"));Y.LIGHTSEAGREEN=Object.freeze(Y.fromCssColorString("#20B2AA"));Y.LIGHTSKYBLUE=Object.freeze(Y.fromCssColorString("#87CEFA"));Y.LIGHTSLATEGRAY=Object.freeze(Y.fromCssColorString("#778899"));Y.LIGHTSLATEGREY=Y.LIGHTSLATEGRAY;Y.LIGHTSTEELBLUE=Object.freeze(Y.fromCssColorString("#B0C4DE"));Y.LIGHTYELLOW=Object.freeze(Y.fromCssColorString("#FFFFE0"));Y.LIME=Object.freeze(Y.fromCssColorString("#00FF00"));Y.LIMEGREEN=Object.freeze(Y.fromCssColorString("#32CD32"));Y.LINEN=Object.freeze(Y.fromCssColorString("#FAF0E6"));Y.MAGENTA=Object.freeze(Y.fromCssColorString("#FF00FF"));Y.MAROON=Object.freeze(Y.fromCssColorString("#800000"));Y.MEDIUMAQUAMARINE=Object.freeze(Y.fromCssColorString("#66CDAA"));Y.MEDIUMBLUE=Object.freeze(Y.fromCssColorString("#0000CD"));Y.MEDIUMORCHID=Object.freeze(Y.fromCssColorString("#BA55D3"));Y.MEDIUMPURPLE=Object.freeze(Y.fromCssColorString("#9370DB"));Y.MEDIUMSEAGREEN=Object.freeze(Y.fromCssColorString("#3CB371"));Y.MEDIUMSLATEBLUE=Object.freeze(Y.fromCssColorString("#7B68EE"));Y.MEDIUMSPRINGGREEN=Object.freeze(Y.fromCssColorString("#00FA9A"));Y.MEDIUMTURQUOISE=Object.freeze(Y.fromCssColorString("#48D1CC"));Y.MEDIUMVIOLETRED=Object.freeze(Y.fromCssColorString("#C71585"));Y.MIDNIGHTBLUE=Object.freeze(Y.fromCssColorString("#191970"));Y.MINTCREAM=Object.freeze(Y.fromCssColorString("#F5FFFA"));Y.MISTYROSE=Object.freeze(Y.fromCssColorString("#FFE4E1"));Y.MOCCASIN=Object.freeze(Y.fromCssColorString("#FFE4B5"));Y.NAVAJOWHITE=Object.freeze(Y.fromCssColorString("#FFDEAD"));Y.NAVY=Object.freeze(Y.fromCssColorString("#000080"));Y.OLDLACE=Object.freeze(Y.fromCssColorString("#FDF5E6"));Y.OLIVE=Object.freeze(Y.fromCssColorString("#808000"));Y.OLIVEDRAB=Object.freeze(Y.fromCssColorString("#6B8E23"));Y.ORANGE=Object.freeze(Y.fromCssColorString("#FFA500"));Y.ORANGERED=Object.freeze(Y.fromCssColorString("#FF4500"));Y.ORCHID=Object.freeze(Y.fromCssColorString("#DA70D6"));Y.PALEGOLDENROD=Object.freeze(Y.fromCssColorString("#EEE8AA"));Y.PALEGREEN=Object.freeze(Y.fromCssColorString("#98FB98"));Y.PALETURQUOISE=Object.freeze(Y.fromCssColorString("#AFEEEE"));Y.PALEVIOLETRED=Object.freeze(Y.fromCssColorString("#DB7093"));Y.PAPAYAWHIP=Object.freeze(Y.fromCssColorString("#FFEFD5"));Y.PEACHPUFF=Object.freeze(Y.fromCssColorString("#FFDAB9"));Y.PERU=Object.freeze(Y.fromCssColorString("#CD853F"));Y.PINK=Object.freeze(Y.fromCssColorString("#FFC0CB"));Y.PLUM=Object.freeze(Y.fromCssColorString("#DDA0DD"));Y.POWDERBLUE=Object.freeze(Y.fromCssColorString("#B0E0E6"));Y.PURPLE=Object.freeze(Y.fromCssColorString("#800080"));Y.RED=Object.freeze(Y.fromCssColorString("#FF0000"));Y.ROSYBROWN=Object.freeze(Y.fromCssColorString("#BC8F8F"));Y.ROYALBLUE=Object.freeze(Y.fromCssColorString("#4169E1"));Y.SADDLEBROWN=Object.freeze(Y.fromCssColorString("#8B4513"));Y.SALMON=Object.freeze(Y.fromCssColorString("#FA8072"));Y.SANDYBROWN=Object.freeze(Y.fromCssColorString("#F4A460"));Y.SEAGREEN=Object.freeze(Y.fromCssColorString("#2E8B57"));Y.SEASHELL=Object.freeze(Y.fromCssColorString("#FFF5EE"));Y.SIENNA=Object.freeze(Y.fromCssColorString("#A0522D"));Y.SILVER=Object.freeze(Y.fromCssColorString("#C0C0C0"));Y.SKYBLUE=Object.freeze(Y.fromCssColorString("#87CEEB"));Y.SLATEBLUE=Object.freeze(Y.fromCssColorString("#6A5ACD"));Y.SLATEGRAY=Object.freeze(Y.fromCssColorString("#708090"));Y.SLATEGREY=Y.SLATEGRAY;Y.SNOW=Object.freeze(Y.fromCssColorString("#FFFAFA"));Y.SPRINGGREEN=Object.freeze(Y.fromCssColorString("#00FF7F"));Y.STEELBLUE=Object.freeze(Y.fromCssColorString("#4682B4"));Y.TAN=Object.freeze(Y.fromCssColorString("#D2B48C"));Y.TEAL=Object.freeze(Y.fromCssColorString("#008080"));Y.THISTLE=Object.freeze(Y.fromCssColorString("#D8BFD8"));Y.TOMATO=Object.freeze(Y.fromCssColorString("#FF6347"));Y.TURQUOISE=Object.freeze(Y.fromCssColorString("#40E0D0"));Y.VIOLET=Object.freeze(Y.fromCssColorString("#EE82EE"));Y.WHEAT=Object.freeze(Y.fromCssColorString("#F5DEB3"));Y.WHITE=Object.freeze(Y.fromCssColorString("#FFFFFF"));Y.WHITESMOKE=Object.freeze(Y.fromCssColorString("#F5F5F5"));Y.YELLOW=Object.freeze(Y.fromCssColorString("#FFFF00"));Y.YELLOWGREEN=Object.freeze(Y.fromCssColorString("#9ACD32"));Y.TRANSPARENT=Object.freeze(new Y(0,0,0,0));var K=Y;function rse(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var Ci=rse;function Hc(e,t){e=T(e,0),this._near=e,t=T(t,Number.MAX_VALUE),this._far=t}Object.defineProperties(Hc.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}});Hc.packedLength=2;Hc.pack=function(e,t,n){return n=T(n,0),t[n++]=e.near,t[n]=e.far,t};Hc.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Hc),n.near=e[t++],n.far=e[t],n};Hc.equals=function(e,t){return e===t||g(e)&&g(t)&&e.near===t.near&&e.far===t.far};Hc.clone=function(e,t){if(!!g(e))return g(t)||(t=new Hc),t.near=e.near,t.far=e.far,t};Hc.prototype.clone=function(e){return Hc.clone(this,e)};Hc.prototype.equals=function(e){return Hc.equals(this,e)};var yn=Hc;function Ae(e,t,n,r,o,a,s,u,l){this[0]=T(e,0),this[1]=T(r,0),this[2]=T(s,0),this[3]=T(t,0),this[4]=T(o,0),this[5]=T(u,0),this[6]=T(n,0),this[7]=T(a,0),this[8]=T(l,0)}Ae.packedLength=9;Ae.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t};Ae.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Ae),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n};Ae.packArray=function(e,t){let n=e.length,r=n*9;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Ae.pack(e[o],t,o*9);return t};Ae.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/9:t=new Array(n/9);for(let r=0;r<n;r+=9){let o=r/9;t[o]=Ae.unpack(e,r,t[o])}return t};Ae.clone=function(e,t){if(!!g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new Ae(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])};Ae.fromArray=Ae.unpack;Ae.fromColumnMajorArray=function(e,t){return Ae.clone(e,t)};Ae.fromRowMajorArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new Ae(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};Ae.fromQuaternion=function(e,t){let n=e.x*e.x,r=e.x*e.y,o=e.x*e.z,a=e.x*e.w,s=e.y*e.y,u=e.y*e.z,l=e.y*e.w,c=e.z*e.z,f=e.z*e.w,h=e.w*e.w,d=n-s-c+h,p=2*(r-f),_=2*(o+l),y=2*(r+f),v=-n+s-c+h,w=2*(u-a),C=2*(o-l),E=2*(u+a),S=-n-s+c+h;return g(t)?(t[0]=d,t[1]=y,t[2]=C,t[3]=p,t[4]=v,t[5]=E,t[6]=_,t[7]=w,t[8]=S,t):new Ae(d,p,_,y,v,w,C,E,S)};Ae.fromHeadingPitchRoll=function(e,t){let n=Math.cos(-e.pitch),r=Math.cos(-e.heading),o=Math.cos(e.roll),a=Math.sin(-e.pitch),s=Math.sin(-e.heading),u=Math.sin(e.roll),l=n*r,c=-o*s+u*a*r,f=u*s+o*a*r,h=n*s,d=o*r+u*a*s,p=-u*r+o*a*s,_=-a,y=u*n,v=o*n;return g(t)?(t[0]=l,t[1]=h,t[2]=_,t[3]=c,t[4]=d,t[5]=y,t[6]=f,t[7]=p,t[8]=v,t):new Ae(l,c,f,h,d,p,_,y,v)};Ae.fromScale=function(e,t){return g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new Ae(e.x,0,0,0,e.y,0,0,0,e.z)};Ae.fromUniformScale=function(e,t){return g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new Ae(e,0,0,0,e,0,0,0,e)};Ae.fromCrossProduct=function(e,t){return g(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new Ae(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)};Ae.fromRotationX=function(e,t){let n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=r,t[6]=0,t[7]=-r,t[8]=n,t):new Ae(1,0,0,0,n,-r,0,r,n)};Ae.fromRotationY=function(e,t){let n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=1,t[5]=0,t[6]=r,t[7]=0,t[8]=n,t):new Ae(n,0,r,0,1,0,-r,0,n)};Ae.fromRotationZ=function(e,t){let n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Ae(n,-r,0,r,n,0,0,0,1)};Ae.toArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]};Ae.getElementIndex=function(e,t){return e*3+t};Ae.getColumn=function(e,t,n){let r=t*3,o=e[r],a=e[r+1],s=e[r+2];return n.x=o,n.y=a,n.z=s,n};Ae.setColumn=function(e,t,n,r){r=Ae.clone(e,r);let o=t*3;return r[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r};Ae.getRow=function(e,t,n){let r=e[t],o=e[t+3],a=e[t+6];return n.x=r,n.y=o,n.z=a,n};Ae.setRow=function(e,t,n,r){return r=Ae.clone(e,r),r[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};var ise=new x;Ae.setScale=function(e,t,n){let r=Ae.getScale(e,ise),o=t.x/r.x,a=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*a,n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var ose=new x;Ae.setUniformScale=function(e,t,n){let r=Ae.getScale(e,ose),o=t/r.x,a=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*a,n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var DO=new x;Ae.getScale=function(e,t){return t.x=x.magnitude(x.fromElements(e[0],e[1],e[2],DO)),t.y=x.magnitude(x.fromElements(e[3],e[4],e[5],DO)),t.z=x.magnitude(x.fromElements(e[6],e[7],e[8],DO)),t};var h5=new x;Ae.getMaximumScale=function(e){return Ae.getScale(e,h5),x.maximumComponent(h5)};var ase=new x;Ae.setRotation=function(e,t,n){let r=Ae.getScale(e,ase);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=t[3]*r.y,n[4]=t[4]*r.y,n[5]=t[5]*r.y,n[6]=t[6]*r.z,n[7]=t[7]*r.z,n[8]=t[8]*r.z,n};var sse=new x;Ae.getRotation=function(e,t){let n=Ae.getScale(e,sse);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t};Ae.multiply=function(e,t,n){let r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],a=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],u=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],l=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],f=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],h=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=o,n[2]=a,n[3]=s,n[4]=u,n[5]=l,n[6]=c,n[7]=f,n[8]=h,n};Ae.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n};Ae.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n};Ae.multiplyByVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[3]*o+e[6]*a,u=e[1]*r+e[4]*o+e[7]*a,l=e[2]*r+e[5]*o+e[8]*a;return n.x=s,n.y=u,n.z=l,n};Ae.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};Ae.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n};Ae.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};Ae.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t};Ae.transpose=function(e,t){let n=e[0],r=e[3],o=e[6],a=e[1],s=e[4],u=e[7],l=e[2],c=e[5],f=e[8];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=f,t};function use(e){let t=0;for(let n=0;n<9;++n){let r=e[n];t+=r*r}return Math.sqrt(t)}var PO=[1,0,0],MO=[2,2,1];function lse(e){let t=0;for(let n=0;n<3;++n){let r=e[Ae.getElementIndex(MO[n],PO[n])];t+=2*r*r}return Math.sqrt(t)}function cse(e,t){let n=F.EPSILON15,r=0,o=1;for(let c=0;c<3;++c){let f=Math.abs(e[Ae.getElementIndex(MO[c],PO[c])]);f>r&&(o=c,r=f)}let a=1,s=0,u=PO[o],l=MO[o];if(Math.abs(e[Ae.getElementIndex(l,u)])>n){let c=e[Ae.getElementIndex(l,l)],f=e[Ae.getElementIndex(u,u)],h=e[Ae.getElementIndex(l,u)],d=(c-f)/2/h,p;d<0?p=-1/(-d+Math.sqrt(1+d*d)):p=1/(d+Math.sqrt(1+d*d)),a=1/Math.sqrt(1+p*p),s=p*a}return t=Ae.clone(Ae.IDENTITY,t),t[Ae.getElementIndex(u,u)]=t[Ae.getElementIndex(l,l)]=a,t[Ae.getElementIndex(l,u)]=s,t[Ae.getElementIndex(u,l)]=-s,t}var qb=new Ae,d5=new Ae;Ae.computeEigenDecomposition=function(e,t){let n=F.EPSILON20,r=10,o=0,a=0;g(t)||(t={});let s=t.unitary=Ae.clone(Ae.IDENTITY,t.unitary),u=t.diagonal=Ae.clone(e,t.diagonal),l=n*use(u);for(;a<r&&lse(u)>l;)cse(u,qb),Ae.transpose(qb,d5),Ae.multiply(u,qb,u),Ae.multiply(d5,u,u),Ae.multiply(s,qb,s),++o>2&&(++a,o=0);return t};Ae.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t};Ae.determinant=function(e){let t=e[0],n=e[3],r=e[6],o=e[1],a=e[4],s=e[7],u=e[2],l=e[5],c=e[8];return t*(a*c-l*s)+o*(l*r-n*c)+u*(n*s-a*r)};Ae.inverse=function(e,t){let n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=Ae.determinant(e);t[0]=s*f-c*u,t[1]=c*o-r*f,t[2]=r*u-s*o,t[3]=l*u-a*f,t[4]=n*f-l*o,t[5]=a*o-n*u,t[6]=a*c-l*s,t[7]=l*r-n*c,t[8]=n*s-a*r;let d=1/h;return Ae.multiplyByScalar(t,d,t)};var fse=new Ae;Ae.inverseTranspose=function(e,t){return Ae.inverse(Ae.transpose(e,fse),t)};Ae.equals=function(e,t){return e===t||g(e)&&g(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};Ae.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n};Ae.IDENTITY=Object.freeze(new Ae(1,0,0,0,1,0,0,0,1));Ae.ZERO=Object.freeze(new Ae(0,0,0,0,0,0,0,0,0));Ae.COLUMN0ROW0=0;Ae.COLUMN0ROW1=1;Ae.COLUMN0ROW2=2;Ae.COLUMN1ROW0=3;Ae.COLUMN1ROW1=4;Ae.COLUMN1ROW2=5;Ae.COLUMN2ROW0=6;Ae.COLUMN2ROW1=7;Ae.COLUMN2ROW2=8;Object.defineProperties(Ae.prototype,{length:{get:function(){return Ae.packedLength}}});Ae.prototype.clone=function(e){return Ae.clone(this,e)};Ae.prototype.equals=function(e){return Ae.equals(this,e)};Ae.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]};Ae.prototype.equalsEpsilon=function(e,t){return Ae.equalsEpsilon(this,e,t)};Ae.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})
(${this[1]}, ${this[4]}, ${this[7]})
(${this[2]}, ${this[5]}, ${this[8]})`};var te=Ae;function we(e,t,n,r,o,a,s,u,l,c,f,h,d,p,_,y){this[0]=T(e,0),this[1]=T(o,0),this[2]=T(l,0),this[3]=T(d,0),this[4]=T(t,0),this[5]=T(a,0),this[6]=T(c,0),this[7]=T(p,0),this[8]=T(n,0),this[9]=T(s,0),this[10]=T(f,0),this[11]=T(_,0),this[12]=T(r,0),this[13]=T(u,0),this[14]=T(h,0),this[15]=T(y,0)}we.packedLength=16;we.computeReflection=function(e,t,n,r,o){return g(o)||(o=new we),o[0]=1-2*e*e,o[1]=-2*e*t,o[2]=-2*e*n,o[3]=0,o[4]=-2*t*e,o[5]=1-2*t*t,o[6]=-2*t*n,o[7]=0,o[8]=-2*n*e,o[9]=-2*n*t,o[10]=1-2*n*n,o[11]=0,o[12]=-2*r*e,o[13]=-2*r*t,o[14]=-2*r*n,o[15]=1,o};we.computeObliquePerspective=function(e,t,n){let r=we.inverse(n,new we),o=we.inverseTranspose(t,new we),a=we.multiplyByVector(o,e,new Se),s=new Se(p5(a.x),p5(a.y),1,1),u=we.multiplyByVector(r,s,new Se),l=2/Se.dot(a,u),c=[a.x*l,a.y*l,a.z*l+1,a.w*l];return new we(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],c[0],c[1],c[2],c[3],n[3],n[7],n[11],n[15])};function p5(e){return e>0?1:e<0?-1:0}we.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t};we.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new we),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n};we.packArray=function(e,t){let n=e.length,r=n*16;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)we.pack(e[o],t,o*16);return t};we.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/16:t=new Array(n/16);for(let r=0;r<n;r+=16){let o=r/16;t[o]=we.unpack(e,r,t[o])}return t};we.clone=function(e,t){if(!!g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new we(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])};we.fromArray=we.unpack;we.fromColumnMajorArray=function(e,t){return we.clone(e,t)};we.fromRowMajorArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new we(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])};we.fromRotationTranslation=function(e,t,n){return t=T(t,x.ZERO),g(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new we(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)};we.fromTranslationQuaternionRotationScale=function(e,t,n,r){g(r)||(r=new we);let o=n.x,a=n.y,s=n.z,u=t.x*t.x,l=t.x*t.y,c=t.x*t.z,f=t.x*t.w,h=t.y*t.y,d=t.y*t.z,p=t.y*t.w,_=t.z*t.z,y=t.z*t.w,v=t.w*t.w,w=u-h-_+v,C=2*(l-y),E=2*(c+p),S=2*(l+y),A=-u+h-_+v,D=2*(d-f),P=2*(c-p),M=2*(d+f),b=-u-h+_+v;return r[0]=w*o,r[1]=S*o,r[2]=P*o,r[3]=0,r[4]=C*a,r[5]=A*a,r[6]=M*a,r[7]=0,r[8]=E*s,r[9]=D*s,r[10]=b*s,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r};we.fromTranslationRotationScale=function(e,t){return we.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};we.fromTranslation=function(e,t){return we.fromRotationTranslation(te.IDENTITY,e,t)};we.fromScale=function(e,t){return g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new we(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)};we.fromUniformScale=function(e,t){return g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new we(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};we.fromRotation=function(e,t){return g(t)||(t=new we),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var rC=new x,iC=new x,Kw=new x;we.fromCamera=function(e,t){let n=e.position,r=e.direction,o=e.up;x.normalize(r,rC),x.normalize(x.cross(rC,o,iC),iC),x.normalize(x.cross(iC,rC,Kw),Kw);let a=iC.x,s=iC.y,u=iC.z,l=rC.x,c=rC.y,f=rC.z,h=Kw.x,d=Kw.y,p=Kw.z,_=n.x,y=n.y,v=n.z,w=a*-_+s*-y+u*-v,C=h*-_+d*-y+p*-v,E=l*_+c*y+f*v;return g(t)?(t[0]=a,t[1]=h,t[2]=-l,t[3]=0,t[4]=s,t[5]=d,t[6]=-c,t[7]=0,t[8]=u,t[9]=p,t[10]=-f,t[11]=0,t[12]=w,t[13]=C,t[14]=E,t[15]=1,t):new we(a,s,u,w,h,d,p,C,-l,-c,-f,E,0,0,0,1)};we.computePerspectiveFieldOfView=function(e,t,n,r,o){let a=Math.tan(e*.5),s=1/a,u=s/t,l=(r+n)/(n-r),c=2*r*n/(n-r);return o[0]=u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=l,o[11]=-1,o[12]=0,o[13]=0,o[14]=c,o[15]=0,o};we.computeOrthographicOffCenter=function(e,t,n,r,o,a,s){let u=1/(t-e),l=1/(r-n),c=1/(a-o),f=-(t+e)*u,h=-(r+n)*l,d=-(a+o)*c;return u*=2,l*=2,c*=-2,s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=c,s[11]=0,s[12]=f,s[13]=h,s[14]=d,s[15]=1,s};we.computePerspectiveOffCenter=function(e,t,n,r,o,a,s){let u=2*o/(t-e),l=2*o/(r-n),c=(t+e)/(t-e),f=(r+n)/(r-n),h=-(a+o)/(a-o),d=-1,p=-2*a*o/(a-o);return s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=l,s[6]=0,s[7]=0,s[8]=c,s[9]=f,s[10]=h,s[11]=d,s[12]=0,s[13]=0,s[14]=p,s[15]=0,s};we.computeInfinitePerspectiveOffCenter=function(e,t,n,r,o,a){let s=2*o/(t-e),u=2*o/(r-n),l=(t+e)/(t-e),c=(r+n)/(r-n),f=-1,h=-1,d=-2*o;return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=l,a[9]=c,a[10]=f,a[11]=h,a[12]=0,a[13]=0,a[14]=d,a[15]=0,a};we.computeViewportTransformation=function(e,t,n,r){g(r)||(r=new we),e=T(e,T.EMPTY_OBJECT);let o=T(e.x,0),a=T(e.y,0),s=T(e.width,0),u=T(e.height,0);t=T(t,0),n=T(n,1);let l=s*.5,c=u*.5,f=(n-t)*.5,h=l,d=c,p=f,_=o+l,y=a+c,v=t+f,w=1;return r[0]=h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=d,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=p,r[11]=0,r[12]=_,r[13]=y,r[14]=v,r[15]=w,r};we.computeView=function(e,t,n,r,o){return o[0]=r.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-x.dot(r,e),o[13]=-x.dot(n,e),o[14]=x.dot(t,e),o[15]=1,o};we.toArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]};we.getElementIndex=function(e,t){return e*4+t};we.getColumn=function(e,t,n){let r=t*4,o=e[r],a=e[r+1],s=e[r+2],u=e[r+3];return n.x=o,n.y=a,n.z=s,n.w=u,n};we.setColumn=function(e,t,n,r){r=we.clone(e,r);let o=t*4;return r[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r};we.getRow=function(e,t,n){let r=e[t],o=e[t+4],a=e[t+8],s=e[t+12];return n.x=r,n.y=o,n.z=a,n.w=s,n};we.setRow=function(e,t,n,r){return r=we.clone(e,r),r[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r};we.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};var hse=new x;we.setScale=function(e,t,n){let r=we.getScale(e,hse),o=t.x/r.x,a=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*a,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var dse=new x;we.setUniformScale=function(e,t,n){let r=we.getScale(e,dse),o=t/r.x,a=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*a,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var LO=new x;we.getScale=function(e,t){return t.x=x.magnitude(x.fromElements(e[0],e[1],e[2],LO)),t.y=x.magnitude(x.fromElements(e[4],e[5],e[6],LO)),t.z=x.magnitude(x.fromElements(e[8],e[9],e[10],LO)),t};var m5=new x;we.getMaximumScale=function(e){return we.getScale(e,m5),x.maximumComponent(m5)};var pse=new x;we.setRotation=function(e,t,n){let r=we.getScale(e,pse);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=e[3],n[4]=t[3]*r.y,n[5]=t[4]*r.y,n[6]=t[5]*r.y,n[7]=e[7],n[8]=t[6]*r.z,n[9]=t[7]*r.z,n[10]=t[8]*r.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var mse=new x;we.getRotation=function(e,t){let n=we.getScale(e,mse);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t};we.multiply=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[3],u=e[4],l=e[5],c=e[6],f=e[7],h=e[8],d=e[9],p=e[10],_=e[11],y=e[12],v=e[13],w=e[14],C=e[15],E=t[0],S=t[1],A=t[2],D=t[3],P=t[4],M=t[5],b=t[6],O=t[7],m=t[8],I=t[9],L=t[10],R=t[11],N=t[12],B=t[13],V=t[14],z=t[15],U=r*E+u*S+h*A+y*D,Q=o*E+l*S+d*A+v*D,ne=a*E+c*S+p*A+w*D,se=s*E+f*S+_*A+C*D,de=r*P+u*M+h*b+y*O,pe=o*P+l*M+d*b+v*O,ve=a*P+c*M+p*b+w*O,ft=s*P+f*M+_*b+C*O,pt=r*m+u*I+h*L+y*R,Xt=o*m+l*I+d*L+v*R,At=a*m+c*I+p*L+w*R,wt=s*m+f*I+_*L+C*R,Rr=r*N+u*B+h*V+y*z,gi=o*N+l*B+d*V+v*z,$i=a*N+c*B+p*V+w*z,ut=s*N+f*B+_*V+C*z;return n[0]=U,n[1]=Q,n[2]=ne,n[3]=se,n[4]=de,n[5]=pe,n[6]=ve,n[7]=ft,n[8]=pt,n[9]=Xt,n[10]=At,n[11]=wt,n[12]=Rr,n[13]=gi,n[14]=$i,n[15]=ut,n};we.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n};we.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n};we.multiplyTransformation=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],f=e[9],h=e[10],d=e[12],p=e[13],_=e[14],y=t[0],v=t[1],w=t[2],C=t[4],E=t[5],S=t[6],A=t[8],D=t[9],P=t[10],M=t[12],b=t[13],O=t[14],m=r*y+s*v+c*w,I=o*y+u*v+f*w,L=a*y+l*v+h*w,R=r*C+s*E+c*S,N=o*C+u*E+f*S,B=a*C+l*E+h*S,V=r*A+s*D+c*P,z=o*A+u*D+f*P,U=a*A+l*D+h*P,Q=r*M+s*b+c*O+d,ne=o*M+u*b+f*O+p,se=a*M+l*b+h*O+_;return n[0]=m,n[1]=I,n[2]=L,n[3]=0,n[4]=R,n[5]=N,n[6]=B,n[7]=0,n[8]=V,n[9]=z,n[10]=U,n[11]=0,n[12]=Q,n[13]=ne,n[14]=se,n[15]=1,n};we.multiplyByMatrix3=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],f=e[9],h=e[10],d=t[0],p=t[1],_=t[2],y=t[3],v=t[4],w=t[5],C=t[6],E=t[7],S=t[8],A=r*d+s*p+c*_,D=o*d+u*p+f*_,P=a*d+l*p+h*_,M=r*y+s*v+c*w,b=o*y+u*v+f*w,O=a*y+l*v+h*w,m=r*C+s*E+c*S,I=o*C+u*E+f*S,L=a*C+l*E+h*S;return n[0]=A,n[1]=D,n[2]=P,n[3]=0,n[4]=M,n[5]=b,n[6]=O,n[7]=0,n[8]=m,n[9]=I,n[10]=L,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};we.multiplyByTranslation=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=r*e[0]+o*e[4]+a*e[8]+e[12],u=r*e[1]+o*e[5]+a*e[9]+e[13],l=r*e[2]+o*e[6]+a*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=u,n[14]=l,n[15]=e[15],n};we.multiplyByScale=function(e,t,n){let r=t.x,o=t.y,a=t.z;return r===1&&o===1&&a===1?we.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=a*e[8],n[9]=a*e[9],n[10]=a*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)};we.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};we.multiplyByVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=t.w,u=e[0]*r+e[4]*o+e[8]*a+e[12]*s,l=e[1]*r+e[5]*o+e[9]*a+e[13]*s,c=e[2]*r+e[6]*o+e[10]*a+e[14]*s,f=e[3]*r+e[7]*o+e[11]*a+e[15]*s;return n.x=u,n.y=l,n.z=c,n.w=f,n};we.multiplyByPointAsVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[4]*o+e[8]*a,u=e[1]*r+e[5]*o+e[9]*a,l=e[2]*r+e[6]*o+e[10]*a;return n.x=s,n.y=u,n.z=l,n};we.multiplyByPoint=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[4]*o+e[8]*a+e[12],u=e[1]*r+e[5]*o+e[9]*a+e[13],l=e[2]*r+e[6]*o+e[10]*a+e[14];return n.x=s,n.y=u,n.z=l,n};we.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n};we.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t};we.transpose=function(e,t){let n=e[1],r=e[2],o=e[3],a=e[6],s=e[7],u=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=s,t[14]=u,t[15]=e[15],t};we.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t};we.equals=function(e,t){return e===t||g(e)&&g(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};we.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n};we.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t};we.getMatrix3=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var gse=new te,_se=new te,yse=new Se,vse=new Se(0,0,0,1);we.inverse=function(e,t){let n=e[0],r=e[4],o=e[8],a=e[12],s=e[1],u=e[5],l=e[9],c=e[13],f=e[2],h=e[6],d=e[10],p=e[14],_=e[3],y=e[7],v=e[11],w=e[15],C=d*w,E=p*v,S=h*w,A=p*y,D=h*v,P=d*y,M=f*w,b=p*_,O=f*v,m=d*_,I=f*y,L=h*_,R=C*u+A*l+D*c-(E*u+S*l+P*c),N=E*s+M*l+m*c-(C*s+b*l+O*c),B=S*s+b*u+I*c-(A*s+M*u+L*c),V=P*s+O*u+L*l-(D*s+m*u+I*l),z=E*r+S*o+P*a-(C*r+A*o+D*a),U=C*n+b*o+O*a-(E*n+M*o+m*a),Q=A*n+M*r+L*a-(S*n+b*r+I*a),ne=D*n+m*r+I*o-(P*n+O*r+L*o);C=o*c,E=a*l,S=r*c,A=a*u,D=r*l,P=o*u,M=n*c,b=a*s,O=n*l,m=o*s,I=n*u,L=r*s;let se=C*y+A*v+D*w-(E*y+S*v+P*w),de=E*_+M*v+m*w-(C*_+b*v+O*w),pe=S*_+b*y+I*w-(A*_+M*y+L*w),ve=P*_+O*y+L*v-(D*_+m*y+I*v),ft=S*d+P*p+E*h-(D*p+C*h+A*d),pt=O*p+C*f+b*d-(M*d+m*p+E*f),Xt=M*h+L*p+A*f-(I*p+S*f+b*h),At=I*d+D*f+m*h-(O*h+L*d+P*f),wt=n*R+r*N+o*B+a*V;if(Math.abs(wt)<F.EPSILON21){if(te.equalsEpsilon(we.getMatrix3(e,gse),_se,F.EPSILON7)&&Se.equals(we.getRow(e,3,yse),vse))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new at("matrix is not invertible because its determinate is zero.")}return wt=1/wt,t[0]=R*wt,t[1]=N*wt,t[2]=B*wt,t[3]=V*wt,t[4]=z*wt,t[5]=U*wt,t[6]=Q*wt,t[7]=ne*wt,t[8]=se*wt,t[9]=de*wt,t[10]=pe*wt,t[11]=ve*wt,t[12]=ft*wt,t[13]=pt*wt,t[14]=Xt*wt,t[15]=At*wt,t};we.inverseTransformation=function(e,t){let n=e[0],r=e[1],o=e[2],a=e[4],s=e[5],u=e[6],l=e[8],c=e[9],f=e[10],h=e[12],d=e[13],p=e[14],_=-n*h-r*d-o*p,y=-a*h-s*d-u*p,v=-l*h-c*d-f*p;return t[0]=n,t[1]=a,t[2]=l,t[3]=0,t[4]=r,t[5]=s,t[6]=c,t[7]=0,t[8]=o,t[9]=u,t[10]=f,t[11]=0,t[12]=_,t[13]=y,t[14]=v,t[15]=1,t};var Cse=new we;we.inverseTranspose=function(e,t){return we.inverse(we.transpose(e,Cse),t)};we.IDENTITY=Object.freeze(new we(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));we.ZERO=Object.freeze(new we(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));we.COLUMN0ROW0=0;we.COLUMN0ROW1=1;we.COLUMN0ROW2=2;we.COLUMN0ROW3=3;we.COLUMN1ROW0=4;we.COLUMN1ROW1=5;we.COLUMN1ROW2=6;we.COLUMN1ROW3=7;we.COLUMN2ROW0=8;we.COLUMN2ROW1=9;we.COLUMN2ROW2=10;we.COLUMN2ROW3=11;we.COLUMN3ROW0=12;we.COLUMN3ROW1=13;we.COLUMN3ROW2=14;we.COLUMN3ROW3=15;Object.defineProperties(we.prototype,{length:{get:function(){return we.packedLength}}});we.prototype.clone=function(e){return we.clone(this,e)};we.prototype.equals=function(e){return we.equals(this,e)};we.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]};we.prototype.equalsEpsilon=function(e,t){return we.equalsEpsilon(this,e,t)};we.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})
(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})
(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})
(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var G=we;function Nf(e,t,n,r){this.near=T(e,0),this.nearValue=T(t,0),this.far=T(n,1),this.farValue=T(r,0)}Nf.clone=function(e,t){if(!!g(e))return g(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new Nf(e.near,e.nearValue,e.far,e.farValue)};Nf.packedLength=4;Nf.pack=function(e,t,n){return n=T(n,0),t[n++]=e.near,t[n++]=e.nearValue,t[n++]=e.far,t[n]=e.farValue,t};Nf.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Nf),n.near=e[t++],n.nearValue=e[t++],n.far=e[t++],n.farValue=e[t],n};Nf.equals=function(e,t){return e===t||g(e)&&g(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue};Nf.prototype.clone=function(e){return Nf.clone(this,e)};Nf.prototype.equals=function(e){return Nf.equals(this,e)};var bt=Nf;var xse={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2},Lt=Object.freeze(xse);var wse={CENTER:0,LEFT:1,RIGHT:-1},go=Object.freeze(wse);var Wb={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};Wb.getMorphTime=function(e){return e===Wb.SCENE3D?1:e===Wb.MORPHING?void 0:0};var Ne=Object.freeze(Wb);function Ps(e,t){this.normal=x.clone(e),this.distance=t}Ps.fromPointNormal=function(e,t,n){let r=-x.dot(t,e);return g(n)?(x.clone(t,n.normal),n.distance=r,n):new Ps(t,r)};var Ese=new x;Ps.fromCartesian4=function(e,t){let n=x.fromCartesian4(e,Ese),r=e.w;return g(t)?(x.clone(n,t.normal),t.distance=r,t):new Ps(n,r)};Ps.getPointDistance=function(e,t){return x.dot(e.normal,t)+e.distance};var Tse=new x;Ps.projectPointOntoPlane=function(e,t,n){g(n)||(n=new x);let r=Ps.getPointDistance(e,t),o=x.multiplyByScalar(e.normal,r,Tse);return x.subtract(t,o,n)};var Sse=new G,Ase=new Se,bse=new x;Ps.transform=function(e,t,n){let r=e.normal,o=e.distance,a=G.inverseTranspose(t,Sse),s=Se.fromElements(r.x,r.y,r.z,o,Ase);s=G.multiplyByVector(a,s,s);let u=x.fromCartesian4(s,bse);return s=Se.divideByScalar(s,x.magnitude(u),s),Ps.fromCartesian4(s,n)};Ps.clone=function(e,t){return g(t)?(x.clone(e.normal,t.normal),t.distance=e.distance,t):new Ps(e.normal,e.distance)};Ps.equals=function(e,t){return e.distance===t.distance&&x.equals(e.normal,t.normal)};Ps.ORIGIN_XY_PLANE=Object.freeze(new Ps(x.UNIT_Z,0));Ps.ORIGIN_YZ_PLANE=Object.freeze(new Ps(x.UNIT_X,0));Ps.ORIGIN_ZX_PLANE=Object.freeze(new Ps(x.UNIT_Y,0));var si=Ps;function Bf(e){this.planes=T(e,[])}var Zw=[new x,new x,new x];x.clone(x.UNIT_X,Zw[0]);x.clone(x.UNIT_Y,Zw[1]);x.clone(x.UNIT_Z,Zw[2]);var Hg=new x,Ise=new x,g5=new si(new x(1,0,0),0);Bf.fromBoundingSphere=function(e,t){g(t)||(t=new Bf);let n=Zw.length,r=t.planes;r.length=2*n;let o=e.center,a=e.radius,s=0;for(let u=0;u<n;++u){let l=Zw[u],c=r[s],f=r[s+1];g(c)||(c=r[s]=new Se),g(f)||(f=r[s+1]=new Se),x.multiplyByScalar(l,-a,Hg),x.add(o,Hg,Hg),c.x=l.x,c.y=l.y,c.z=l.z,c.w=-x.dot(l,Hg),x.multiplyByScalar(l,a,Hg),x.add(o,Hg,Hg),f.x=-l.x,f.y=-l.y,f.z=-l.z,f.w=-x.dot(x.negate(l,Ise),Hg),s+=2}return t};Bf.prototype.computeVisibility=function(e){let t=this.planes,n=!1;for(let r=0,o=t.length;r<o;++r){let a=e.intersectPlane(si.fromCartesian4(t[r],g5));if(a===vi.OUTSIDE)return vi.OUTSIDE;a===vi.INTERSECTING&&(n=!0)}return n?vi.INTERSECTING:vi.INSIDE};Bf.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===Bf.MASK_OUTSIDE||t===Bf.MASK_INSIDE)return t;let n=Bf.MASK_INSIDE,r=this.planes;for(let o=0,a=r.length;o<a;++o){let s=o<31?1<<o:0;if(o<31&&(t&s)===0)continue;let u=e.intersectPlane(si.fromCartesian4(r[o],g5));if(u===vi.OUTSIDE)return Bf.MASK_OUTSIDE;u===vi.INTERSECTING&&(n|=s)}return n};Bf.MASK_OUTSIDE=4294967295;Bf.MASK_INSIDE=0;Bf.MASK_INDETERMINATE=2147483647;var _5=Bf;function tp(e){e=T(e,T.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=T(e.near,1),this._near=this.near,this.far=T(e.far,5e8),this._far=this.far,this._cullingVolume=new _5,this._orthographicMatrix=new G}function y5(e){(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far)&&(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=G.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}Object.defineProperties(tp.prototype,{projectionMatrix:{get:function(){return y5(this),this._orthographicMatrix}}});var Dse=new x,Pse=new x,Mse=new x,RO=new x;tp.prototype.computeCullingVolume=function(e,t,n){let r=this._cullingVolume.planes,o=this.top,a=this.bottom,s=this.right,u=this.left,l=this.near,c=this.far,f=x.cross(t,n,Dse);x.normalize(f,f);let h=Pse;x.multiplyByScalar(t,l,h),x.add(e,h,h);let d=Mse;x.multiplyByScalar(f,u,d),x.add(h,d,d);let p=r[0];return g(p)||(p=r[0]=new Se),p.x=f.x,p.y=f.y,p.z=f.z,p.w=-x.dot(f,d),x.multiplyByScalar(f,s,d),x.add(h,d,d),p=r[1],g(p)||(p=r[1]=new Se),p.x=-f.x,p.y=-f.y,p.z=-f.z,p.w=-x.dot(x.negate(f,RO),d),x.multiplyByScalar(n,a,d),x.add(h,d,d),p=r[2],g(p)||(p=r[2]=new Se),p.x=n.x,p.y=n.y,p.z=n.z,p.w=-x.dot(n,d),x.multiplyByScalar(n,o,d),x.add(h,d,d),p=r[3],g(p)||(p=r[3]=new Se),p.x=-n.x,p.y=-n.y,p.z=-n.z,p.w=-x.dot(x.negate(n,RO),d),p=r[4],g(p)||(p=r[4]=new Se),p.x=t.x,p.y=t.y,p.z=t.z,p.w=-x.dot(t,h),x.multiplyByScalar(t,c,d),x.add(e,d,d),p=r[5],g(p)||(p=r[5]=new Se),p.x=-t.x,p.y=-t.y,p.z=-t.z,p.w=-x.dot(x.negate(t,RO),d),this._cullingVolume};tp.prototype.getPixelDimensions=function(e,t,n,r,o){y5(this);let a=this.right-this.left,s=this.top-this.bottom,u=r*a/e,l=r*s/t;return o.x=u,o.y=l,o};tp.prototype.clone=function(e){return g(e)||(e=new tp),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};tp.prototype.equals=function(e){return g(e)&&e instanceof tp&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};tp.prototype.equalsEpsilon=function(e,t,n){return e===this||g(e)&&e instanceof tp&&F.equalsEpsilon(this.right,e.right,t,n)&&F.equalsEpsilon(this.left,e.left,t,n)&&F.equalsEpsilon(this.top,e.top,t,n)&&F.equalsEpsilon(this.bottom,e.bottom,t,n)&&F.equalsEpsilon(this.near,e.near,t,n)&&F.equalsEpsilon(this.far,e.far,t,n)};var Yb=tp;function _c(e){e=T(e,T.EMPTY_OBJECT),this._offCenterFrustum=new Yb,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=T(e.near,1),this._near=this.near,this.far=T(e.far,5e8),this._far=this.far}_c.packedLength=4;_c.pack=function(e,t,n){return n=T(n,0),t[n++]=e.width,t[n++]=e.aspectRatio,t[n++]=e.near,t[n]=e.far,t};_c.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new _c),n.width=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t],n};function L_(e){let t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;let n=1/e.aspectRatio;t.right=e.width*.5,t.left=-t.right,t.top=n*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Object.defineProperties(_c.prototype,{projectionMatrix:{get:function(){return L_(this),this._offCenterFrustum.projectionMatrix}}});_c.prototype.computeCullingVolume=function(e,t,n){return L_(this),this._offCenterFrustum.computeCullingVolume(e,t,n)};_c.prototype.getPixelDimensions=function(e,t,n,r,o){return L_(this),this._offCenterFrustum.getPixelDimensions(e,t,n,r,o)};_c.prototype.clone=function(e){return g(e)||(e=new _c),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};_c.prototype.equals=function(e){return!g(e)||!(e instanceof _c)?!1:(L_(this),L_(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};_c.prototype.equalsEpsilon=function(e,t,n){return!g(e)||!(e instanceof _c)?!1:(L_(this),L_(e),F.equalsEpsilon(this.width,e.width,t,n)&&F.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))};var v5=_c;function Lse(e,t,n){let r=0,o=e.length-1,a,s;for(;r<=o;){if(a=~~((r+o)/2),s=n(e[a],t),s<0){r=a+1;continue}if(s>0){o=a-1;continue}return a}return~(o+1)}var Lu=Lse;function Rse(e,t,n,r,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=o}var Qw=Rse;function Ose(e,t,n,r,o,a,s,u){this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=o,this.second=a,this.millisecond=s,this.isLeapSecond=u}var oC=Ose;function Nse(e){return e%4===0&&e%100!==0||e%400===0}var aC=Nse;function Bse(e,t){this.julianDate=e,this.offset=t}var Li=Bse;var Fse={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:24000005e-1},_o=Object.freeze(Fse);var zse={UTC:0,TAI:1},vn=Object.freeze(zse);var x5=new oC,OO=[31,28,31,30,31,30,31,31,30,31,30,31],NO=29;function BO(e,t){return ke.compare(e.julianDate,t.julianDate)}var sC=new Li;function jb(e){sC.julianDate=e;let t=ke.leapSeconds,n=Lu(t,sC,BO);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let r=t[n].offset;n>0&&ke.secondsDifference(t[n].julianDate,e)>r&&(n--,r=t[n].offset),ke.addSeconds(e,r,e)}function C5(e,t){sC.julianDate=e;let n=ke.leapSeconds,r=Lu(n,sC,BO);if(r<0&&(r=~r),r===0)return ke.addSeconds(e,-n[0].offset,t);if(r>=n.length)return ke.addSeconds(e,-n[r-1].offset,t);let o=ke.secondsDifference(n[r].julianDate,e);if(o===0)return ke.addSeconds(e,-n[r].offset,t);if(!(o<=1))return ke.addSeconds(e,-n[--r].offset,t)}function qg(e,t,n){let r=t/_o.SECONDS_PER_DAY|0;return e+=r,t-=_o.SECONDS_PER_DAY*r,t<0&&(e--,t+=_o.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function FO(e,t,n,r,o,a,s){let u=(t-14)/12|0,l=e+4800+u,c=(1461*l/4|0)+(367*(t-2-12*u)/12|0)-(3*((l+100)/100|0)/4|0)+n-32075;r=r-12,r<0&&(r+=24);let f=a+(r*_o.SECONDS_PER_HOUR+o*_o.SECONDS_PER_MINUTE+s*_o.SECONDS_PER_MILLISECOND);return f>=43200&&(c-=1),[c,f]}var Vse=/^(\d{4})$/,kse=/^(\d{4})-(\d{2})$/,Gse=/^(\d{4})-?(\d{3})$/,Use=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Hse=/^(\d{4})-?(\d{2})-?(\d{2})$/,zO=/([Z+\-])?(\d{2})?:?(\d{2})?$/,qse=/^(\d{2})(\.\d+)?/.source+zO.source,Wse=/^(\d{2}):?(\d{2})(\.\d+)?/.source+zO.source,Yse=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+zO.source;function ke(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=T(e,0),t=T(t,0),n=T(n,vn.UTC);let r=e|0;t=t+(e-r)*_o.SECONDS_PER_DAY,qg(r,t,this),n===vn.UTC&&jb(this)}ke.fromGregorianDate=function(e,t){let n=FO(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return g(t)?(qg(n[0],n[1],t),jb(t),t):new ke(n[0],n[1],vn.UTC)};ke.fromDate=function(e,t){let n=FO(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return g(t)?(qg(n[0],n[1],t),jb(t),t):new ke(n[0],n[1],vn.UTC)};ke.fromIso8601=function(e,t){e=e.replace(",",".");let n=e.split("T"),r,o=1,a=1,s=0,u=0,l=0,c=0,f=n[0],h=n[1],d,p;if(n=f.match(Hse),n!==null)r=+n[1],o=+n[2],a=+n[3];else if(n=f.match(kse),n!==null)r=+n[1],o=+n[2];else if(n=f.match(Vse),n!==null)r=+n[1];else{let w;if(n=f.match(Gse),n!==null)r=+n[1],w=+n[2],p=aC(r);else if(n=f.match(Use),n!==null){r=+n[1];let C=+n[2],E=+n[3]||0,S=new Date(Date.UTC(r,0,4));w=C*7+E-S.getUTCDay()-3}d=new Date(Date.UTC(r,0,1)),d.setUTCDate(w),o=d.getUTCMonth()+1,a=d.getUTCDate()}p=aC(r);let _;if(g(h)){n=h.match(Yse),n!==null?(s=+n[1],u=+n[2],l=+n[3],c=+(n[4]||0)*1e3,_=5):(n=h.match(Wse),n!==null?(s=+n[1],u=+n[2],l=+(n[3]||0)*60,_=4):(n=h.match(qse),n!==null&&(s=+n[1],u=+(n[2]||0)*60,_=3)));let w=n[_],C=+n[_+1],E=+(n[_+2]||0);switch(w){case"+":s=s-C,u=u-E;break;case"-":s=s+C,u=u+E;break;case"Z":break;default:u=u+new Date(Date.UTC(r,o-1,a,s,u)).getTimezoneOffset();break}}let y=l===60;for(y&&l--;u>=60;)u-=60,s++;for(;s>=24;)s-=24,a++;for(d=p&&o===2?NO:OO[o-1];a>d;)a-=d,o++,o>12&&(o-=12,r++),d=p&&o===2?NO:OO[o-1];for(;u<0;)u+=60,s--;for(;s<0;)s+=24,a--;for(;a<1;)o--,o<1&&(o+=12,r--),d=p&&o===2?NO:OO[o-1],a+=d;let v=FO(r,o,a,s,u,l,c);return g(t)?(qg(v[0],v[1],t),jb(t)):t=new ke(v[0],v[1],vn.UTC),y&&ke.addSeconds(t,1,t),t};ke.now=function(e){return ke.fromDate(new Date,e)};var Xb=new ke(0,0,vn.TAI);ke.toGregorianDate=function(e,t){let n=!1,r=C5(e,Xb);g(r)||(ke.addSeconds(e,-1,Xb),r=C5(Xb,Xb),n=!0);let o=r.dayNumber,a=r.secondsOfDay;a>=43200&&(o+=1);let s=o+68569|0,u=4*s/146097|0;s=s-((146097*u+3)/4|0)|0;let l=4e3*(s+1)/1461001|0;s=s-(1461*l/4|0)+31|0;let c=80*s/2447|0,f=s-(2447*c/80|0)|0;s=c/11|0;let h=c+2-12*s|0,d=100*(u-49)+l+s|0,p=a/_o.SECONDS_PER_HOUR|0,_=a-p*_o.SECONDS_PER_HOUR,y=_/_o.SECONDS_PER_MINUTE|0;_=_-y*_o.SECONDS_PER_MINUTE;let v=_|0,w=(_-v)/_o.SECONDS_PER_MILLISECOND;return p+=12,p>23&&(p-=24),n&&(v+=1),g(t)?(t.year=d,t.month=h,t.day=f,t.hour=p,t.minute=y,t.second=v,t.millisecond=w,t.isLeapSecond=n,t):new oC(d,h,f,p,y,v,w,n)};ke.toDate=function(e){let t=ke.toGregorianDate(e,x5),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))};ke.toIso8601=function(e,t){let n=ke.toGregorianDate(e,x5),r=n.year,o=n.month,a=n.day,s=n.hour,u=n.minute,l=n.second,c=n.millisecond;r===1e4&&o===1&&a===1&&s===0&&u===0&&l===0&&c===0&&(r=9999,o=12,a=31,s=24);let f;return!g(t)&&c!==0?(f=(c*.01).toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${f}Z`):!g(t)||t===0?`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}Z`:(f=(c*.01).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${f}Z`)};ke.clone=function(e,t){if(!!g(e))return g(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new ke(e.dayNumber,e.secondsOfDay,vn.TAI)};ke.compare=function(e,t){let n=e.dayNumber-t.dayNumber;return n!==0?n:e.secondsOfDay-t.secondsOfDay};ke.equals=function(e,t){return e===t||g(e)&&g(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};ke.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(ke.secondsDifference(e,t))<=n};ke.totalDays=function(e){return e.dayNumber+e.secondsOfDay/_o.SECONDS_PER_DAY};ke.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*_o.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)};ke.daysDifference=function(e,t){let n=e.dayNumber-t.dayNumber,r=(e.secondsOfDay-t.secondsOfDay)/_o.SECONDS_PER_DAY;return n+r};ke.computeTaiMinusUtc=function(e){sC.julianDate=e;let t=ke.leapSeconds,n=Lu(t,sC,BO);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset};ke.addSeconds=function(e,t,n){return qg(e.dayNumber,e.secondsOfDay+t,n)};ke.addMinutes=function(e,t,n){let r=e.secondsOfDay+t*_o.SECONDS_PER_MINUTE;return qg(e.dayNumber,r,n)};ke.addHours=function(e,t,n){let r=e.secondsOfDay+t*_o.SECONDS_PER_HOUR;return qg(e.dayNumber,r,n)};ke.addDays=function(e,t,n){let r=e.dayNumber+t;return qg(r,e.secondsOfDay,n)};ke.lessThan=function(e,t){return ke.compare(e,t)<0};ke.lessThanOrEquals=function(e,t){return ke.compare(e,t)<=0};ke.greaterThan=function(e,t){return ke.compare(e,t)>0};ke.greaterThanOrEquals=function(e,t){return ke.compare(e,t)>=0};ke.prototype.clone=function(e){return ke.clone(this,e)};ke.prototype.equals=function(e){return ke.equals(this,e)};ke.prototype.equalsEpsilon=function(e,t){return ke.equalsEpsilon(this,e,t)};ke.prototype.toString=function(){return ke.toIso8601(this)};ke.leapSeconds=[new Li(new ke(2441317,43210,vn.TAI),10),new Li(new ke(2441499,43211,vn.TAI),11),new Li(new ke(2441683,43212,vn.TAI),12),new Li(new ke(2442048,43213,vn.TAI),13),new Li(new ke(2442413,43214,vn.TAI),14),new Li(new ke(2442778,43215,vn.TAI),15),new Li(new ke(2443144,43216,vn.TAI),16),new Li(new ke(2443509,43217,vn.TAI),17),new Li(new ke(2443874,43218,vn.TAI),18),new Li(new ke(2444239,43219,vn.TAI),19),new Li(new ke(2444786,43220,vn.TAI),20),new Li(new ke(2445151,43221,vn.TAI),21),new Li(new ke(2445516,43222,vn.TAI),22),new Li(new ke(2446247,43223,vn.TAI),23),new Li(new ke(2447161,43224,vn.TAI),24),new Li(new ke(2447892,43225,vn.TAI),25),new Li(new ke(2448257,43226,vn.TAI),26),new Li(new ke(2448804,43227,vn.TAI),27),new Li(new ke(2449169,43228,vn.TAI),28),new Li(new ke(2449534,43229,vn.TAI),29),new Li(new ke(2450083,43230,vn.TAI),30),new Li(new ke(2450630,43231,vn.TAI),31),new Li(new ke(2451179,43232,vn.TAI),32),new Li(new ke(2453736,43233,vn.TAI),33),new Li(new ke(2454832,43234,vn.TAI),34),new Li(new ke(2456109,43235,vn.TAI),35),new Li(new ke(2457204,43236,vn.TAI),36),new Li(new ke(2457754,43237,vn.TAI),37)];var ce=ke;function Kb(e){if(e=T(e,T.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=T(e.addNewLeapSeconds,!0),g(e.data))VO(this,e.data);else if(g(e.url)){let t=vt.createIfNeeded(e.url),n=this;this._downloadPromise=t.fetchJson().then(function(r){VO(n,r)}).catch(function(){n._dataError=`An error occurred while retrieving the EOP data from the URL ${t.url}.`})}else VO(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}Kb.NONE=Object.freeze({getPromiseToLoad:function(){return Promise.resolve()},compute:function(e,t){return g(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Qw(0,0,0,0,0),t}});Kb.prototype.getPromiseToLoad=function(){return Promise.resolve(this._downloadPromise)};Kb.prototype.compute=function(e,t){if(!g(this._samples)){if(g(this._dataError))throw new at(this._dataError);return}if(g(t)||(t=new Qw(0,0,0,0,0)),this._samples.length===0)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;let n=this._dates,r=this._lastIndex,o=0,a=0;if(g(r)){let u=n[r],l=n[r+1],c=ce.lessThanOrEquals(u,e),f=!g(l),h=f||ce.greaterThanOrEquals(l,e);if(c&&h)return o=r,!f&&l.equals(e)&&++o,a=o+1,E5(this,n,this._samples,e,o,a,t),t}let s=Lu(n,e,ce.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,o=s,a=s):(a=~s,o=a-1,o<0&&(o=0)),this._lastIndex=o,E5(this,n,this._samples,e,o,a,t),t};function Xse(e,t){return ce.compare(e.julianDate,t)}function VO(e,t){if(!g(t.columnNames)){e._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!g(t.samples)){e._dataError="Error in loaded EOP data: The samples property is required.";return}let n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),a=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||o<0||a<0||s<0||u<0||l<0){e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}let c=e._samples=t.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=a,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=l,e._columnCount=t.columnNames.length,e._lastIndex=void 0;let h,d=e._addNewLeapSeconds;for(let p=0,_=c.length;p<_;p+=e._columnCount){let y=c[p+n],v=c[p+l],w=y+_o.MODIFIED_JULIAN_DATE_DIFFERENCE,C=new ce(w,v,vn.TAI);if(f.push(C),d){if(v!==h&&g(h)){let E=ce.leapSeconds,S=Lu(E,C,Xse);if(S<0){let A=new Li(C,v);E.splice(~S,0,A)}}h=v}}}function w5(e,t,n,r,o){let a=n*r;o.xPoleWander=t[a+e._xPoleWanderRadiansColumn],o.yPoleWander=t[a+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function Jw(e,t,n){return t+e*(n-t)}function E5(e,t,n,r,o,a,s){let u=e._columnCount;if(a>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;let l=t[o],c=t[a];if(l.equals(c)||r.equals(l))return w5(e,n,o,u,s),s;if(r.equals(c))return w5(e,n,a,u,s),s;let f=ce.secondsDifference(r,l)/ce.secondsDifference(c,l),h=o*u,d=a*u,p=n[h+e._ut1MinusUtcSecondsColumn],_=n[d+e._ut1MinusUtcSecondsColumn],y=_-p;if(y>.5||y<-.5){let v=n[h+e._taiMinusUtcSecondsColumn],w=n[d+e._taiMinusUtcSecondsColumn];v!==w&&(c.equals(r)?p=_:_-=w-v)}return s.xPoleWander=Jw(f,n[h+e._xPoleWanderRadiansColumn],n[d+e._xPoleWanderRadiansColumn]),s.yPoleWander=Jw(f,n[h+e._yPoleWanderRadiansColumn],n[d+e._yPoleWanderRadiansColumn]),s.xPoleOffset=Jw(f,n[h+e._xCelestialPoleOffsetRadiansColumn],n[d+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=Jw(f,n[h+e._yCelestialPoleOffsetRadiansColumn],n[d+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=Jw(f,p,_),s}var T5=Kb;function rl(e,t,n){this.heading=T(e,0),this.pitch=T(t,0),this.roll=T(n,0)}rl.fromQuaternion=function(e,t){g(t)||(t=new rl);let n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),a=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,a),t.roll=Math.atan2(o,r),t.pitch=-F.asinClamped(n),t};rl.fromDegrees=function(e,t,n,r){return g(r)||(r=new rl),r.heading=e*F.RADIANS_PER_DEGREE,r.pitch=t*F.RADIANS_PER_DEGREE,r.roll=n*F.RADIANS_PER_DEGREE,r};rl.clone=function(e,t){if(!!g(e))return g(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new rl(e.heading,e.pitch,e.roll)};rl.equals=function(e,t){return e===t||g(e)&&g(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll};rl.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.heading,t.heading,n,r)&&F.equalsEpsilon(e.pitch,t.pitch,n,r)&&F.equalsEpsilon(e.roll,t.roll,n,r)};rl.prototype.clone=function(e){return rl.clone(this,e)};rl.prototype.equals=function(e){return rl.equals(this,e)};rl.prototype.equalsEpsilon=function(e,t,n){return rl.equalsEpsilon(this,e,t,n)};rl.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var qc=rl;function jse(e,t,n){this.x=e,this.y=t,this.s=n}var Zb=jse;function UO(e){e=T(e,T.EMPTY_OBJECT),this._xysFileUrlTemplate=vt.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=T(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=T(e.sampleZeroJulianEphemerisDate,24423965e-1),this._sampleZeroDateTT=new ce(this._sampleZeroJulianEphemerisDate,0,vn.TAI),this._stepSizeDays=T(e.stepSizeDays,1),this._samplesPerXysFile=T(e.samplesPerXysFile,1e3),this._totalSamples=T(e.totalSamples,27426),this._samples=new Array(this._totalSamples*3),this._chunkDownloadsInProgress=[];let t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let a=0;a<=t;++a){n[a]=o,r[a]=a*this._stepSizeDays;for(let s=0;s<=t;++s)s!==a&&(n[a]*=a-s);n[a]=1/n[a]}this._work=new Array(t+1),this._coef=new Array(t+1)}var Kse=new ce(0,0,vn.TAI);function kO(e,t,n){let r=Kse;return r.dayNumber=t,r.secondsOfDay=n,ce.daysDifference(r,e._sampleZeroDateTT)}UO.prototype.preload=function(e,t,n,r){let o=kO(this,e,t),a=kO(this,n,r),s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let u=a/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);let l=s/this._samplesPerXysFile|0,c=u/this._samplesPerXysFile|0,f=[];for(let h=l;h<=c;++h)f.push(GO(this,h));return Promise.all(f)};UO.prototype.computeXysRadians=function(e,t,n){let r=kO(this,e,t);if(r<0)return;let o=r/this._stepSizeDays|0;if(o>=this._totalSamples)return;let a=this._interpolationOrder,s=o-(a/2|0);s<0&&(s=0);let u=s+a;u>=this._totalSamples&&(u=this._totalSamples-1,s=u-a,s<0&&(s=0));let l=!1,c=this._samples;if(g(c[s*3])||(GO(this,s/this._samplesPerXysFile|0),l=!0),g(c[u*3])||(GO(this,u/this._samplesPerXysFile|0),l=!0),l)return;g(n)?(n.x=0,n.y=0,n.s=0):n=new Zb(0,0,0);let f=r-s*this._stepSizeDays,h=this._work,d=this._denominators,p=this._coef,_=this._xTable,y,v;for(y=0;y<=a;++y)h[y]=f-_[y];for(y=0;y<=a;++y){for(p[y]=1,v=0;v<=a;++v)v!==y&&(p[y]*=h[v]);p[y]*=d[y];let w=(s+y)*3;n.x+=p[y]*c[w++],n.y+=p[y]*c[w++],n.s+=p[y]*c[w]}return n};function GO(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n,r=e._xysFileUrlTemplate;g(r)?n=r.getDerivedResource({templateValues:{0:t}}):n=new vt({url:La(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});let o=n.fetchJson().then(function(a){e._chunkDownloadsInProgress[t]=!1;let s=e._samples,u=a.samples,l=t*e._samplesPerXysFile*3;for(let c=0,f=u.length;c<f;++c)s[l+c]=u[c]});return e._chunkDownloadsInProgress[t]=o,o}var S5=UO;function be(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0),this.w=T(r,0)}var $w=new x;be.fromAxisAngle=function(e,t,n){let r=t/2,o=Math.sin(r);$w=x.normalize(e,$w);let a=$w.x*o,s=$w.y*o,u=$w.z*o,l=Math.cos(r);return g(n)?(n.x=a,n.y=s,n.z=u,n.w=l,n):new be(a,s,u,l)};var Zse=[1,2,0],Qse=new Array(3);be.fromRotationMatrix=function(e,t){let n,r,o,a,s,u=e[te.COLUMN0ROW0],l=e[te.COLUMN1ROW1],c=e[te.COLUMN2ROW2],f=u+l+c;if(f>0)n=Math.sqrt(f+1),s=.5*n,n=.5/n,r=(e[te.COLUMN1ROW2]-e[te.COLUMN2ROW1])*n,o=(e[te.COLUMN2ROW0]-e[te.COLUMN0ROW2])*n,a=(e[te.COLUMN0ROW1]-e[te.COLUMN1ROW0])*n;else{let h=Zse,d=0;l>u&&(d=1),c>u&&c>l&&(d=2);let p=h[d],_=h[p];n=Math.sqrt(e[te.getElementIndex(d,d)]-e[te.getElementIndex(p,p)]-e[te.getElementIndex(_,_)]+1);let y=Qse;y[d]=.5*n,n=.5/n,s=(e[te.getElementIndex(_,p)]-e[te.getElementIndex(p,_)])*n,y[p]=(e[te.getElementIndex(p,d)]+e[te.getElementIndex(d,p)])*n,y[_]=(e[te.getElementIndex(_,d)]+e[te.getElementIndex(d,_)])*n,r=-y[0],o=-y[1],a=-y[2]}return g(t)?(t.x=r,t.y=o,t.z=a,t.w=s,t):new be(r,o,a,s)};var A5=new be,b5=new be,HO=new be,I5=new be;be.fromHeadingPitchRoll=function(e,t){return I5=be.fromAxisAngle(x.UNIT_X,e.roll,A5),HO=be.fromAxisAngle(x.UNIT_Y,-e.pitch,t),t=be.multiply(HO,I5,HO),b5=be.fromAxisAngle(x.UNIT_Z,-e.heading,A5),be.multiply(b5,t,t)};var Qb=new x,qO=new x,Jh=new be,D5=new be,Jb=new be;be.packedLength=4;be.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};be.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new be),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n};be.packedInterpolationLength=3;be.convertPackedArrayForInterpolation=function(e,t,n,r){be.unpack(e,n*4,Jb),be.conjugate(Jb,Jb);for(let o=0,a=n-t+1;o<a;o++){let s=o*3;be.unpack(e,(t+o)*4,Jh),be.multiply(Jh,Jb,Jh),Jh.w<0&&be.negate(Jh,Jh),be.computeAxis(Jh,Qb);let u=be.computeAngle(Jh);g(r)||(r=[]),r[s]=Qb.x*u,r[s+1]=Qb.y*u,r[s+2]=Qb.z*u}};be.unpackInterpolationResult=function(e,t,n,r,o){g(o)||(o=new be),x.fromArray(e,0,qO);let a=x.magnitude(qO);return be.unpack(t,r*4,D5),a===0?be.clone(be.IDENTITY,Jh):be.fromAxisAngle(qO,a,Jh),be.multiply(Jh,D5,o)};be.clone=function(e,t){if(!!g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new be(e.x,e.y,e.z,e.w)};be.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t};be.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};be.magnitude=function(e){return Math.sqrt(be.magnitudeSquared(e))};be.normalize=function(e,t){let n=1/be.magnitude(e),r=e.x*n,o=e.y*n,a=e.z*n,s=e.w*n;return t.x=r,t.y=o,t.z=a,t.w=s,t};be.inverse=function(e,t){let n=be.magnitudeSquared(e);return t=be.conjugate(e,t),be.multiplyByScalar(t,1/n,t)};be.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};be.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};be.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};be.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};be.multiply=function(e,t,n){let r=e.x,o=e.y,a=e.z,s=e.w,u=t.x,l=t.y,c=t.z,f=t.w,h=s*u+r*f+o*c-a*l,d=s*l-r*c+o*f+a*u,p=s*c+r*l-o*u+a*f,_=s*f-r*u-o*l-a*c;return n.x=h,n.y=d,n.z=p,n.w=_,n};be.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};be.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};be.computeAxis=function(e,t){let n=e.w;if(Math.abs(n-1)<F.EPSILON6)return t.x=t.y=t.z=0,t;let r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t};be.computeAngle=function(e){return Math.abs(e.w-1)<F.EPSILON6?0:2*Math.acos(e.w)};var WO=new be;be.lerp=function(e,t,n,r){return WO=be.multiplyByScalar(t,n,WO),r=be.multiplyByScalar(e,1-n,r),be.add(WO,r,r)};var P5=new be,YO=new be,XO=new be;be.slerp=function(e,t,n,r){let o=be.dot(e,t),a=t;if(o<0&&(o=-o,a=P5=be.negate(t,P5)),1-o<F.EPSILON6)return be.lerp(e,a,n,r);let s=Math.acos(o);return YO=be.multiplyByScalar(e,Math.sin((1-n)*s),YO),XO=be.multiplyByScalar(a,Math.sin(n*s),XO),r=be.add(YO,XO,r),be.multiplyByScalar(r,1/Math.sin(s),r)};be.log=function(e,t){let n=F.acosClamped(e.w),r=0;return n!==0&&(r=n/Math.sin(n)),x.multiplyByScalar(e,r,t)};be.exp=function(e,t){let n=x.magnitude(e),r=0;return n!==0&&(r=Math.sin(n)/n),t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t.w=Math.cos(n),t};var Jse=new x,$se=new x,eE=new be,uC=new be;be.computeInnerQuadrangle=function(e,t,n,r){let o=be.conjugate(t,eE);be.multiply(o,n,uC);let a=be.log(uC,Jse);be.multiply(o,e,uC);let s=be.log(uC,$se);return x.add(a,s,a),x.multiplyByScalar(a,.25,a),x.negate(a,a),be.exp(a,eE),be.multiply(t,eE,r)};be.squad=function(e,t,n,r,o,a){let s=be.slerp(e,t,o,eE),u=be.slerp(n,r,o,uC);return be.slerp(s,u,2*o*(1-o),a)};var eue=new be,M5=1.9011074535173003,$b=ea.supportsTypedArrays()?new Float32Array(8):[],eI=ea.supportsTypedArrays()?new Float32Array(8):[],vm=ea.supportsTypedArrays()?new Float32Array(8):[],Cm=ea.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){let t=e+1,n=2*t+1;$b[e]=1/(t*n),eI[e]=t/n}$b[7]=M5/(8*17);eI[7]=M5*8/17;be.fastSlerp=function(e,t,n,r){let o=be.dot(e,t),a;o>=0?a=1:(a=-1,o=-o);let s=o-1,u=1-n,l=n*n,c=u*u;for(let p=7;p>=0;--p)vm[p]=($b[p]*l-eI[p])*s,Cm[p]=($b[p]*c-eI[p])*s;let f=a*n*(1+vm[0]*(1+vm[1]*(1+vm[2]*(1+vm[3]*(1+vm[4]*(1+vm[5]*(1+vm[6]*(1+vm[7])))))))),h=u*(1+Cm[0]*(1+Cm[1]*(1+Cm[2]*(1+Cm[3]*(1+Cm[4]*(1+Cm[5]*(1+Cm[6]*(1+Cm[7])))))))),d=be.multiplyByScalar(e,h,eue);return be.multiplyByScalar(t,f,r),be.add(d,r,r)};be.fastSquad=function(e,t,n,r,o,a){let s=be.fastSlerp(e,t,o,eE),u=be.fastSlerp(n,r,o,uC);return be.fastSlerp(s,u,2*o*(1-o),a)};be.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};be.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n};be.ZERO=Object.freeze(new be(0,0,0,0));be.IDENTITY=Object.freeze(new be(0,0,0,1));be.prototype.clone=function(e){return be.clone(this,e)};be.prototype.equals=function(e){return be.equals(this,e)};be.prototype.equalsEpsilon=function(e,t){return be.equalsEpsilon(this,e,t)};be.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var je=be;var ei={},jO={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},lC={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},KO={},yc={east:new x,north:new x,up:new x,west:new x,south:new x,down:new x},Wg=new x,Yg=new x,Xg=new x;ei.localFrameToFixedFrameGenerator=function(e,t){if(!jO.hasOwnProperty(e)||!jO[e].hasOwnProperty(t))throw new Le("firstAxis and secondAxis must be east, north, up, west, south or down.");let n=jO[e][t],r,o=e+t;return g(KO[o])?r=KO[o]:(r=function(a,s,u){if(g(u)||(u=new G),x.equalsEpsilon(a,x.ZERO,F.EPSILON14))x.unpack(lC[e],0,Wg),x.unpack(lC[t],0,Yg),x.unpack(lC[n],0,Xg);else if(F.equalsEpsilon(a.x,0,F.EPSILON14)&&F.equalsEpsilon(a.y,0,F.EPSILON14)){let l=F.sign(a.z);x.unpack(lC[e],0,Wg),e!=="east"&&e!=="west"&&x.multiplyByScalar(Wg,l,Wg),x.unpack(lC[t],0,Yg),t!=="east"&&t!=="west"&&x.multiplyByScalar(Yg,l,Yg),x.unpack(lC[n],0,Xg),n!=="east"&&n!=="west"&&x.multiplyByScalar(Xg,l,Xg)}else{s=T(s,Ge.WGS84),s.geodeticSurfaceNormal(a,yc.up);let l=yc.up,c=yc.east;c.x=-a.y,c.y=a.x,c.z=0,x.normalize(c,yc.east),x.cross(l,c,yc.north),x.multiplyByScalar(yc.up,-1,yc.down),x.multiplyByScalar(yc.east,-1,yc.west),x.multiplyByScalar(yc.north,-1,yc.south),Wg=yc[e],Yg=yc[t],Xg=yc[n]}return u[0]=Wg.x,u[1]=Wg.y,u[2]=Wg.z,u[3]=0,u[4]=Yg.x,u[5]=Yg.y,u[6]=Yg.z,u[7]=0,u[8]=Xg.x,u[9]=Xg.y,u[10]=Xg.z,u[11]=0,u[12]=a.x,u[13]=a.y,u[14]=a.z,u[15]=1,u},KO[o]=r),r};ei.eastNorthUpToFixedFrame=ei.localFrameToFixedFrameGenerator("east","north");ei.northEastDownToFixedFrame=ei.localFrameToFixedFrameGenerator("north","east");ei.northUpEastToFixedFrame=ei.localFrameToFixedFrameGenerator("north","up");ei.northWestUpToFixedFrame=ei.localFrameToFixedFrameGenerator("north","west");var tue=new je,nue=new x(1,1,1),rue=new G;ei.headingPitchRollToFixedFrame=function(e,t,n,r,o){r=T(r,ei.eastNorthUpToFixedFrame);let a=je.fromHeadingPitchRoll(t,tue),s=G.fromTranslationQuaternionRotationScale(x.ZERO,a,nue,rue);return o=r(e,n,o),G.multiply(o,s,o)};var iue=new G,oue=new te;ei.headingPitchRollQuaternion=function(e,t,n,r,o){let a=ei.headingPitchRollToFixedFrame(e,t,n,r,iue),s=G.getMatrix3(a,oue);return je.fromRotationMatrix(s,o)};var aue=new x(1,1,1),sue=new x,L5=new G,uue=new G,lue=new te,cue=new je;ei.fixedFrameToHeadingPitchRoll=function(e,t,n,r){t=T(t,Ge.WGS84),n=T(n,ei.eastNorthUpToFixedFrame),g(r)||(r=new qc);let o=G.getTranslation(e,sue);if(x.equals(o,x.ZERO))return r.heading=0,r.pitch=0,r.roll=0,r;let a=G.inverseTransformation(n(o,t,L5),L5),s=G.setScale(e,aue,uue);s=G.setTranslation(s,x.ZERO,s),a=G.multiply(a,s,a);let u=je.fromRotationMatrix(G.getMatrix3(a,lue),cue);return u=je.normalize(u,u),qc.fromQuaternion(u,r)};var fue=6*3600+41*60+50.54841,hue=8640184812866e-6,due=.093104,pue=-62e-7,mue=11772758384668e-32,gue=72921158553e-15,_ue=F.TWO_PI/86400,tI=new ce;ei.computeTemeToPseudoFixedMatrix=function(e,t){tI=ce.addSeconds(e,-ce.computeTaiMinusUtc(e),tI);let n=tI.dayNumber,r=tI.secondsOfDay,o,a=n-2451545;r>=43200?o=(a+.5)/_o.DAYS_PER_JULIAN_CENTURY:o=(a-.5)/_o.DAYS_PER_JULIAN_CENTURY;let u=(fue+o*(hue+o*(due+o*pue)))*_ue%F.TWO_PI,l=gue+mue*(n-24515455e-1),c=(r+_o.SECONDS_PER_DAY*.5)%_o.SECONDS_PER_DAY,f=u+l*c,h=Math.cos(f),d=Math.sin(f);return g(t)?(t[0]=h,t[1]=-d,t[2]=0,t[3]=d,t[4]=h,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new te(h,d,0,-d,h,0,0,0,1)};ei.iau2006XysData=new S5;ei.earthOrientationParameters=T5.NONE;var JO=32.184,yue=2451545;ei.preloadIcrfFixed=function(e){let t=e.start.dayNumber,n=e.start.secondsOfDay+JO,r=e.stop.dayNumber,o=e.stop.secondsOfDay+JO,a=ei.iau2006XysData.preload(t,n,r,o),s=ei.earthOrientationParameters.getPromiseToLoad();return Promise.all([a,s])};ei.computeIcrfToFixedMatrix=function(e,t){g(t)||(t=new te);let n=ei.computeFixedToIcrfMatrix(e,t);if(!!g(n))return te.transpose(n,t)};var vue=new Zb(0,0,0),Cue=new Qw(0,0,0,0,0,0),ZO=new te,QO=new te;ei.computeFixedToIcrfMatrix=function(e,t){g(t)||(t=new te);let n=ei.earthOrientationParameters.compute(e,Cue);if(!g(n))return;let r=e.dayNumber,o=e.secondsOfDay+JO,a=ei.iau2006XysData.computeXysRadians(r,o,vue);if(!g(a))return;let s=a.x+n.xPoleOffset,u=a.y+n.yPoleOffset,l=1/(1+Math.sqrt(1-s*s-u*u)),c=ZO;c[0]=1-l*s*s,c[3]=-l*s*u,c[6]=s,c[1]=-l*s*u,c[4]=1-l*u*u,c[7]=u,c[2]=-s,c[5]=-u,c[8]=1-l*(s*s+u*u);let f=te.fromRotationZ(-a.s,QO),h=te.multiply(c,f,ZO),d=e.dayNumber,p=e.secondsOfDay-ce.computeTaiMinusUtc(e)+n.ut1MinusUtc,_=d-2451545,y=p/_o.SECONDS_PER_DAY,v=.779057273264+y+.00273781191135448*(_+y);v=v%1*F.TWO_PI;let w=te.fromRotationZ(v,QO),C=te.multiply(h,w,ZO),E=Math.cos(n.xPoleWander),S=Math.cos(n.yPoleWander),A=Math.sin(n.xPoleWander),D=Math.sin(n.yPoleWander),P=r-yue+o/_o.SECONDS_PER_DAY;P/=36525;let M=-47e-6*P*F.RADIANS_PER_DEGREE/3600,b=Math.cos(M),O=Math.sin(M),m=QO;return m[0]=E*b,m[1]=E*O,m[2]=A,m[3]=-S*O+D*A*b,m[4]=S*b+D*A*O,m[5]=-D*E,m[6]=-D*O-S*A*b,m[7]=D*b-S*A*O,m[8]=S*E,te.multiply(C,m,t)};var xue=new Se;ei.pointToWindowCoordinates=function(e,t,n,r){return r=ei.pointToGLWindowCoordinates(e,t,n,r),r.y=2*t[5]-r.y,r};ei.pointToGLWindowCoordinates=function(e,t,n,r){g(r)||(r=new X);let o=xue;return G.multiplyByVector(e,Se.fromElements(n.x,n.y,n.z,1,o),o),Se.multiplyByScalar(o,1/o.w,o),G.multiplyByVector(t,o,o),X.fromCartesian4(o,r)};var wue=new x,Eue=new x,Tue=new x;ei.rotationMatrixFromPositionVelocity=function(e,t,n,r){let o=T(n,Ge.WGS84).geodeticSurfaceNormal(e,wue),a=x.cross(t,o,Eue);x.equalsEpsilon(a,x.ZERO,F.EPSILON6)&&(a=x.clone(x.UNIT_X,a));let s=x.cross(a,t,Tue);return x.normalize(s,s),x.cross(t,s,a),x.negate(a,a),x.normalize(a,a),g(r)||(r=new te),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=a.x,r[4]=a.y,r[5]=a.z,r[6]=s.x,r[7]=s.y,r[8]=s.z,r};var R5=new G(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),O5=new le,N5=new x,Sue=new x,Aue=new te,$O=new G,B5=new G;ei.basisTo2D=function(e,t,n){let r=G.getTranslation(t,Sue),o=e.ellipsoid,a=o.cartesianToCartographic(r,O5),s=e.project(a,N5);x.fromElements(s.z,s.x,s.y,s);let u=ei.eastNorthUpToFixedFrame(r,o,$O),l=G.inverseTransformation(u,B5),c=G.getMatrix3(t,Aue),f=G.multiplyByMatrix3(l,c,n);return G.multiply(R5,f,n),G.setTranslation(n,s,n),n};ei.wgs84To2DModelMatrix=function(e,t,n){let r=e.ellipsoid,o=ei.eastNorthUpToFixedFrame(t,r,$O),a=G.inverseTransformation(o,B5),s=r.cartesianToCartographic(t,O5),u=e.project(s,N5);x.fromElements(u.z,u.x,u.y,u);let l=G.fromTranslation(u,$O);return G.multiply(R5,a,n),G.multiply(l,n,n),n};var Cn=ei;var Ru={},bue=new Se(0,0,0,1),il=new Se,Iue=new rn,eN=new X,tN=new X;Ru.wgs84ToWindowCoordinates=function(e,t,n){return Ru.wgs84WithEyeOffsetToWindowCoordinates(e,t,x.ZERO,n)};var F5=new Se,z5=new x;function tE(e,t,n,r){let o=n.viewMatrix,a=G.multiplyByVector(o,Se.fromElements(e.x,e.y,e.z,1,F5),F5),s=x.multiplyComponents(t,x.normalize(a,z5),z5);return a.x+=t.x+s.x,a.y+=t.y+s.y,a.z+=s.z,G.multiplyByVector(n.frustum.projectionMatrix,a,r)}var Due=new le(Math.PI,F.PI_OVER_TWO),Pue=new x,Mue=new x;Ru.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,n,r){let o=e.frameState,a=Ru.computeActualWgs84Position(o,t,bue);if(!g(a))return;let s=e.canvas,u=Iue;u.x=0,u.y=0,u.width=s.clientWidth,u.height=s.clientHeight;let l=e.camera,c=!1;if(o.mode===Ne.SCENE2D){let f=e.mapProjection,h=Due,d=f.project(h,Pue),p=x.clone(l.position,Mue),_=l.frustum.clone(),y=G.computeViewportTransformation(u,0,1,new G),v=l.frustum.projectionMatrix,w=l.positionWC.y,C=x.fromElements(F.sign(w)*d.x-w,0,-l.positionWC.x),E=Cn.pointToGLWindowCoordinates(v,y,C);if(w===0||E.x<=0||E.x>=s.clientWidth)c=!0;else{if(E.x>s.clientWidth*.5){u.width=E.x,l.frustum.right=d.x-w,il=tE(a,n,l,il),Ru.clipToGLWindowCoordinates(u,il,eN),u.x+=E.x,l.position.x=-l.position.x;let S=l.frustum.right;l.frustum.right=-l.frustum.left,l.frustum.left=-S,il=tE(a,n,l,il),Ru.clipToGLWindowCoordinates(u,il,tN)}else{u.x+=E.x,u.width-=E.x,l.frustum.left=-d.x-w,il=tE(a,n,l,il),Ru.clipToGLWindowCoordinates(u,il,eN),u.x=u.x-u.width,l.position.x=-l.position.x;let S=l.frustum.left;l.frustum.left=-l.frustum.right,l.frustum.right=-S,il=tE(a,n,l,il),Ru.clipToGLWindowCoordinates(u,il,tN)}x.clone(p,l.position),l.frustum=_.clone(),r=X.clone(eN,r),(r.x<0||r.x>s.clientWidth)&&(r.x=tN.x)}}if(o.mode!==Ne.SCENE2D||c){if(il=tE(a,n,l,il),il.z<0&&!(l.frustum instanceof v5)&&!(l.frustum instanceof Yb))return;r=Ru.clipToGLWindowCoordinates(u,il,r)}return r.y=s.clientHeight-r.y,r};Ru.wgs84ToDrawingBufferCoordinates=function(e,t,n){if(n=Ru.wgs84ToWindowCoordinates(e,t,n),!!g(n))return Ru.transformWindowToDrawingBuffer(e,n,n)};var xm=new x,Lue=new le;Ru.computeActualWgs84Position=function(e,t,n){let r=e.mode;if(r===Ne.SCENE3D)return x.clone(t,n);let o=e.mapProjection,a=o.ellipsoid.cartesianToCartographic(t,Lue);if(!g(a))return;if(o.project(a,xm),r===Ne.COLUMBUS_VIEW)return x.fromElements(xm.z,xm.x,xm.y,n);if(r===Ne.SCENE2D)return x.fromElements(0,xm.x,xm.y,n);let s=e.morphTime;return x.fromElements(F.lerp(xm.z,t.x,s),F.lerp(xm.x,t.y,s),F.lerp(xm.y,t.z,s),n)};var V5=new x,k5=new x,G5=new G;Ru.clipToGLWindowCoordinates=function(e,t,n){return x.divideByScalar(t,t.w,V5),G.computeViewportTransformation(e,0,1,G5),G.multiplyByPoint(G5,V5,k5),X.fromCartesian3(k5,n)};Ru.transformWindowToDrawingBuffer=function(e,t,n){let r=e.canvas,o=e.drawingBufferWidth/r.clientWidth,a=e.drawingBufferHeight/r.clientHeight;return X.fromElements(t.x*o,t.y*a,n)};var Rue=new Se,U5=new Se;Ru.drawingBufferToWgs84Coordinates=function(e,t,n,r){let a=e.context.uniformState,s=a.currentFrustum,u=s.x,l=s.y;if(e.frameState.useLogDepth){let p=n*a.log2FarDepthFromNearPlusOne,_=Math.pow(2,p)-1;n=l*(1-u/(_+u))/(l-u)}let c=e.view.passState.viewport,f=Se.clone(Se.UNIT_W,Rue);f.x=(t.x-c.x)/c.width*2-1,f.y=(t.y-c.y)/c.height*2-1,f.z=n*2-1,f.w=1;let h,d=e.camera.frustum;if(!g(d.fovy))g(d._offCenterFrustum)&&(d=d._offCenterFrustum),h=U5,h.x=(f.x*(d.right-d.left)+d.left+d.right)*.5,h.y=(f.y*(d.top-d.bottom)+d.bottom+d.top)*.5,h.z=(f.z*(u-l)-u-l)*.5,h.w=1,h=G.multiplyByVector(a.inverseView,h,h);else{h=G.multiplyByVector(a.inverseViewProjection,f,U5);let p=1/h.w;x.multiplyByScalar(h,p,h)}return x.fromCartesian4(h,r)};var Ff=Ru;var Oue={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1},ln=Object.freeze(Oue);function bn(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;g(n)&&(n=bt.clone(n)),g(r)&&(r=bt.clone(r)),g(o)&&(o=bt.clone(o)),g(a)&&(a=yn.clone(a)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._translate=new X(0,0),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._heightReference=T(e.heightReference,Lt.NONE),this._verticalOrigin=T(e.verticalOrigin,ln.CENTER),this._horizontalOrigin=T(e.horizontalOrigin,go.CENTER),this._scale=T(e.scale,1),this._color=K.clone(T(e.color,K.WHITE)),this._rotation=T(e.rotation,0),this._alignedAxis=x.clone(T(e.alignedAxis,x.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=o,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._sizeInMeters=T(e.sizeInMeters,!1),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=T(e.collection,t),this._pickId=void 0,this._pickPrimitive=T(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;let s=e.image,u=e.imageId;g(s)&&(g(u)||(typeof s=="string"?u=s:g(s.src)?u=s.src:u=Ci()),this._imageId=u,this._image=s),g(e.imageSubRegion)&&(this._imageId=u,this._imageSubRegion=e.imageSubRegion),g(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=Ne.SCENE3D,this._clusterShow=!0,this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,0),this._animation=T(e.animation,!1),this._updateClamping()}var H5=bn.SHOW_INDEX=0,rI=bn.POSITION_INDEX=1,j5=bn.PIXEL_OFFSET_INDEX=2,Nue=bn.EYE_OFFSET_INDEX=3,Bue=bn.HORIZONTAL_ORIGIN_INDEX=4,Fue=bn.VERTICAL_ORIGIN_INDEX=5,zue=bn.SCALE_INDEX=6,iI=bn.IMAGE_INDEX_INDEX=7,q5=bn.COLOR_INDEX=8,Vue=bn.ROTATION_INDEX=9,kue=bn.ALIGNED_AXIS_INDEX=10,Gue=bn.SCALE_BY_DISTANCE_INDEX=11,Uue=bn.TRANSLUCENCY_BY_DISTANCE_INDEX=12,Hue=bn.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,que=bn.DISTANCE_DISPLAY_CONDITION=14,Wue=bn.DISABLE_DEPTH_DISTANCE=15;bn.TEXTURE_COORDINATE_BOUNDS=16;var W5=bn.SDF_INDEX=17;bn.NUMBER_OF_PROPERTIES=18;function yo(e,t){let n=e._billboardCollection;g(n)&&(n._updateBillboard(e,t),e._dirty=!0)}Object.defineProperties(bn.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,yo(this,H5))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),this._updateClamping(),yo(this,rI))}},heightReference:{get:function(){return this._heightReference},set:function(e){let t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),yo(this,rI))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;X.equals(t,e)||(X.clone(e,t),yo(this,j5))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;bt.equals(t,e)||(this._scaleByDistance=bt.clone(e,t),yo(this,Gue))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;bt.equals(t,e)||(this._translucencyByDistance=bt.clone(e,t),yo(this,Uue))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;bt.equals(t,e)||(this._pixelOffsetScaleByDistance=bt.clone(e,t),yo(this,Hue))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;x.equals(t,e)||(x.clone(e,t),yo(this,Nue))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,yo(this,Bue))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,yo(this,Fue))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,yo(this,zue))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),yo(this,q5))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,yo(this,Vue))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;x.equals(t,e)||(x.clone(e,t),yo(this,kue))}},width:{get:function(){return T(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,yo(this,iI))}},height:{get:function(){return T(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,yo(this,iI))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,yo(this,q5))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){yn.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=yn.clone(e,this._distanceDisplayCondition),yo(this,que))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,yo(this,Wue))}},id:{get:function(){return this._id},set:function(e){this._id=e,g(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,g(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){g(e)?typeof e=="string"?this.setImage(e,e):e instanceof vt?this.setImage(e.url,e):g(e.src)?this.setImage(e.src,e):this.setImage(Ci(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,yo(this,iI))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition),yo(this,rI)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,yo(this,H5))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),yo(this,W5))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,yo(this,W5))}},animation:{get:function(){return this._animation},set:function(e){this._animation!==e&&(this._animation=e)}}});bn.prototype.getPickId=function(e){return g(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};bn.prototype._updateClamping=function(){bn._updateClamping(this._billboardCollection,this)};var nE=new le,Y5=new x;bn._updateClamping=function(e,t){let n=e._scene;if(!g(n)||!g(n.globe))return;let r=n.globe,o=r.ellipsoid,a=r._surface,s=n.frameState.mode,u=s!==t._mode;if(t._mode=s,(t._heightReference===Lt.NONE||u)&&g(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===Lt.NONE||!g(t._position))return;let l=o.cartesianToCartographic(t._position);if(!g(l)){t._actualClampedPosition=void 0;return}g(t._removeCallbackFunc)&&t._removeCallbackFunc();function c(h){if(t._heightReference===Lt.RELATIVE_TO_GROUND)if(t._mode===Ne.SCENE3D){let d=o.cartesianToCartographic(h,nE);d.height+=l.height,o.cartographicToCartesian(d,h)}else h.x+=l.height;t._clampedPosition=x.clone(h,t._clampedPosition)}t._removeCallbackFunc=a.updateHeight(l,c),le.clone(l,nE);let f=r.getHeight(l);g(f)&&(nE.height=f),o.cartographicToCartesian(nE,Y5),c(Y5)};bn.prototype._loadImage=function(){let e=this._billboardCollection._textureAtlas,t=this._imageId,n=this._image,r=this._imageSubRegion,o,a=this;function s(u){if(a._imageId!==t||a._image!==n||!rn.equals(a._imageSubRegion,r))return;let l=e.textureCoordinates[u];a._imageWidth=e.texture.width*l.width,a._imageHeight=e.texture.height*l.height,a._imageIndex=u,a._ready=!0,a._imageIndexPromise=void 0,yo(a,iI)}if(g(n)){let u=e.getImageIndex(t);if(g(u)){s(u);return}o=e.addImage(t,n)}g(r)&&(o=e.addSubRegion(t,r)),this._imageIndexPromise=o,g(o)&&o.then(s).catch(function(u){console.error(`Error loading image for billboard: ${u}`),a._imageIndexPromise=void 0})};bn.prototype._updateImage=function(){this._billboardCollection._textureAtlas.updateImage(this._imageIndex,this._image)};bn.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,g(this._billboardCollection._textureAtlas)&&this._loadImage())};bn.prototype.setImageSubRegion=function(e,t){this._imageId===e&&rn.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=rn.clone(t),g(this._billboardCollection._textureAtlas)&&this._loadImage())};bn.prototype._setTranslate=function(e){let t=this._translate;X.equals(t,e)||(X.clone(e,t),yo(this,j5))};bn.prototype._getActualPosition=function(){return g(this._clampedPosition)?this._clampedPosition:this._actualPosition};bn.prototype._setActualPosition=function(e){g(this._clampedPosition)||x.clone(e,this._actualPosition),yo(this,rI)};var X5=new Se;bn._computeActualPosition=function(e,t,n,r){return g(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===Ne.SCENE3D?t:(G.multiplyByPoint(r,t,X5),Ff.computeActualWgs84Position(n,X5))};var K5=new x;bn._computeScreenSpacePosition=function(e,t,n,r,o,a){let s=G.multiplyByPoint(e,t,K5),u=Ff.wgs84WithEyeOffsetToWindowCoordinates(o,s,n,a);if(!!g(u))return X.add(u,r,u),u};var nI=new X(0,0);bn.prototype.computeScreenSpacePosition=function(e,t){let n=this._billboardCollection;g(t)||(t=new X),X.clone(this._pixelOffset,nI),X.add(nI,this._translate,nI);let r=n.modelMatrix,o=this._position;if(g(this._clampedPosition)&&(o=this._clampedPosition,e.mode!==Ne.SCENE3D)){let s=e.mapProjection,u=s.ellipsoid,l=s.unproject(o,nE);o=u.cartographicToCartesian(l,K5),r=G.IDENTITY}return bn._computeScreenSpacePosition(r,o,this._eyeOffset,nI,e,t)};bn.getScreenSpaceBoundingBox=function(e,t,n){let r=e.width,o=e.height,a=e.scale;r*=a,o*=a;let s=t.x;e.horizontalOrigin===go.RIGHT?s-=r:e.horizontalOrigin===go.CENTER&&(s-=r*.5);let u=t.y;return e.verticalOrigin===ln.BOTTOM||e.verticalOrigin===ln.BASELINE?u-=o:e.verticalOrigin===ln.CENTER&&(u-=o*.5),g(n)||(n=new rn),n.x=s,n.y=u,n.width=r,n.height=o,n};bn.prototype.equals=function(e){return this===e||g(e)&&this._id===e._id&&x.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&rn.equals(this._imageSubRegion,e._imageSubRegion)&&K.equals(this._color,e._color)&&X.equals(this._pixelOffset,e._pixelOffset)&&X.equals(this._translate,e._translate)&&x.equals(this._eyeOffset,e._eyeOffset)&&bt.equals(this._scaleByDistance,e._scaleByDistance)&&bt.equals(this._translucencyByDistance,e._translucencyByDistance)&&bt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&yn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};bn.prototype._destroy=function(){g(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),g(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var Ki=bn;var Yue={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},k=Object.freeze(Yue);var Bt={BYTE:k.BYTE,UNSIGNED_BYTE:k.UNSIGNED_BYTE,SHORT:k.SHORT,UNSIGNED_SHORT:k.UNSIGNED_SHORT,INT:k.INT,UNSIGNED_INT:k.UNSIGNED_INT,FLOAT:k.FLOAT,DOUBLE:k.DOUBLE};Bt.getSizeInBytes=function(e){switch(e){case Bt.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Bt.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Bt.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Bt.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Bt.INT:return Int32Array.BYTES_PER_ELEMENT;case Bt.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Bt.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Bt.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}};Bt.fromTypedArray=function(e){if(e instanceof Int8Array)return Bt.BYTE;if(e instanceof Uint8Array)return Bt.UNSIGNED_BYTE;if(e instanceof Int16Array)return Bt.SHORT;if(e instanceof Uint16Array)return Bt.UNSIGNED_SHORT;if(e instanceof Int32Array)return Bt.INT;if(e instanceof Uint32Array)return Bt.UNSIGNED_INT;if(e instanceof Float32Array)return Bt.FLOAT;if(e instanceof Float64Array)return Bt.DOUBLE};Bt.validate=function(e){return g(e)&&(e===Bt.BYTE||e===Bt.UNSIGNED_BYTE||e===Bt.SHORT||e===Bt.UNSIGNED_SHORT||e===Bt.INT||e===Bt.UNSIGNED_INT||e===Bt.FLOAT||e===Bt.DOUBLE)};Bt.createTypedArray=function(e,t){switch(e){case Bt.BYTE:return new Int8Array(t);case Bt.UNSIGNED_BYTE:return new Uint8Array(t);case Bt.SHORT:return new Int16Array(t);case Bt.UNSIGNED_SHORT:return new Uint16Array(t);case Bt.INT:return new Int32Array(t);case Bt.UNSIGNED_INT:return new Uint32Array(t);case Bt.FLOAT:return new Float32Array(t);case Bt.DOUBLE:return new Float64Array(t)}};Bt.createArrayBufferView=function(e,t,n,r){switch(n=T(n,0),r=T(r,(t.byteLength-n)/Bt.getSizeInBytes(e)),e){case Bt.BYTE:return new Int8Array(t,n,r);case Bt.UNSIGNED_BYTE:return new Uint8Array(t,n,r);case Bt.SHORT:return new Int16Array(t,n,r);case Bt.UNSIGNED_SHORT:return new Uint16Array(t,n,r);case Bt.INT:return new Int32Array(t,n,r);case Bt.UNSIGNED_INT:return new Uint32Array(t,n,r);case Bt.FLOAT:return new Float32Array(t,n,r);case Bt.DOUBLE:return new Float64Array(t,n,r)}};Bt.fromName=function(e){switch(e){case"BYTE":return Bt.BYTE;case"UNSIGNED_BYTE":return Bt.UNSIGNED_BYTE;case"SHORT":return Bt.SHORT;case"UNSIGNED_SHORT":return Bt.UNSIGNED_SHORT;case"INT":return Bt.INT;case"UNSIGNED_INT":return Bt.UNSIGNED_INT;case"FLOAT":return Bt.FLOAT;case"DOUBLE":return Bt.DOUBLE}};var ie=Object.freeze(Bt);function tt(e,t,n,r){this[0]=T(e,0),this[1]=T(n,0),this[2]=T(t,0),this[3]=T(r,0)}tt.packedLength=4;tt.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t};tt.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new tt),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n};tt.packArray=function(e,t){let n=e.length,r=n*4;g(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)tt.pack(e[o],t,o*4);return t};tt.unpackArray=function(e,t){let n=e.length;g(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){let o=r/4;t[o]=tt.unpack(e,r,t[o])}return t};tt.clone=function(e,t){if(!!g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new tt(e[0],e[2],e[1],e[3])};tt.fromArray=tt.unpack;tt.fromColumnMajorArray=function(e,t){return tt.clone(e,t)};tt.fromRowMajorArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new tt(e[0],e[1],e[2],e[3])};tt.fromScale=function(e,t){return g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new tt(e.x,0,0,e.y)};tt.fromUniformScale=function(e,t){return g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new tt(e,0,0,e)};tt.fromRotation=function(e,t){let n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t):new tt(n,-r,r,n)};tt.toArray=function(e,t){return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]};tt.getElementIndex=function(e,t){return e*2+t};tt.getColumn=function(e,t,n){let r=t*2,o=e[r],a=e[r+1];return n.x=o,n.y=a,n};tt.setColumn=function(e,t,n,r){r=tt.clone(e,r);let o=t*2;return r[o]=n.x,r[o+1]=n.y,r};tt.getRow=function(e,t,n){let r=e[t],o=e[t+2];return n.x=r,n.y=o,n};tt.setRow=function(e,t,n,r){return r=tt.clone(e,r),r[t]=n.x,r[t+2]=n.y,r};var Xue=new X;tt.setScale=function(e,t,n){let r=tt.getScale(e,Xue),o=t.x/r.x,a=t.y/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*a,n[3]=e[3]*a,n};var jue=new X;tt.setUniformScale=function(e,t,n){let r=tt.getScale(e,jue),o=t/r.x,a=t/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*a,n[3]=e[3]*a,n};var Z5=new X;tt.getScale=function(e,t){return t.x=X.magnitude(X.fromElements(e[0],e[1],Z5)),t.y=X.magnitude(X.fromElements(e[2],e[3],Z5)),t};var Q5=new X;tt.getMaximumScale=function(e){return tt.getScale(e,Q5),X.maximumComponent(Q5)};var Kue=new X;tt.setRotation=function(e,t,n){let r=tt.getScale(e,Kue);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.y,n[3]=t[3]*r.y,n};var Zue=new X;tt.getRotation=function(e,t){let n=tt.getScale(e,Zue);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t};tt.multiply=function(e,t,n){let r=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],a=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=a,n[2]=o,n[3]=s,n};tt.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n};tt.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n};tt.multiplyByVector=function(e,t,n){let r=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=o,n};tt.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};tt.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n};tt.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};tt.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t};tt.transpose=function(e,t){let n=e[0],r=e[2],o=e[1],a=e[3];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t};tt.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t};tt.equals=function(e,t){return e===t||g(e)&&g(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};tt.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]};tt.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n};tt.IDENTITY=Object.freeze(new tt(1,0,0,1));tt.ZERO=Object.freeze(new tt(0,0,0,0));tt.COLUMN0ROW0=0;tt.COLUMN0ROW1=1;tt.COLUMN1ROW0=2;tt.COLUMN1ROW1=3;Object.defineProperties(tt.prototype,{length:{get:function(){return tt.packedLength}}});tt.prototype.clone=function(e){return tt.clone(this,e)};tt.prototype.equals=function(e){return tt.equals(this,e)};tt.prototype.equalsEpsilon=function(e,t){return tt.equalsEpsilon(this,e,t)};tt.prototype.toString=function(){return`(${this[0]}, ${this[2]})
(${this[1]}, ${this[3]})`};var Ra=tt;var xi={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};xi.getMathType=function(e){switch(e){case xi.SCALAR:return Number;case xi.VEC2:return X;case xi.VEC3:return x;case xi.VEC4:return Se;case xi.MAT2:return Ra;case xi.MAT3:return te;case xi.MAT4:return G}};xi.getNumberOfComponents=function(e){switch(e){case xi.SCALAR:return 1;case xi.VEC2:return 2;case xi.VEC3:return 3;case xi.VEC4:case xi.MAT2:return 4;case xi.MAT3:return 9;case xi.MAT4:return 16}};xi.getAttributeLocationCount=function(e){switch(e){case xi.SCALAR:case xi.VEC2:case xi.VEC3:case xi.VEC4:return 1;case xi.MAT2:return 2;case xi.MAT3:return 3;case xi.MAT4:return 4}};xi.getGlslType=function(e){switch(e){case xi.SCALAR:return"float";case xi.VEC2:return"vec2";case xi.VEC3:return"vec3";case xi.VEC4:return"vec4";case xi.MAT2:return"mat2";case xi.MAT3:return"mat3";case xi.MAT4:return"mat4"}};var Wc=Object.freeze(xi);var J5=1/256,$5=256,Zi={};Zi.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let r=n.x,o=n.y;n.x=(1-Math.abs(o))*F.signNotZero(r),n.y=(1-Math.abs(r))*F.signNotZero(o)}return n.x=F.toSNorm(n.x,t),n.y=F.toSNorm(n.y,t),n};Zi.octEncode=function(e,t){return Zi.octEncodeInRange(e,255,t)};var rE=new X,e8=new Uint8Array(1);function oI(e){return e8[0]=e,e8[0]}Zi.octEncodeToCartesian4=function(e,t){return Zi.octEncodeInRange(e,65535,rE),t.x=oI(rE.x*J5),t.y=oI(rE.x),t.z=oI(rE.y*J5),t.w=oI(rE.y),t};Zi.octDecodeInRange=function(e,t,n,r){if(r.x=F.fromSNorm(e,n),r.y=F.fromSNorm(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){let o=r.x;r.x=(1-Math.abs(r.y))*F.signNotZero(o),r.y=(1-Math.abs(o))*F.signNotZero(r.y)}return x.normalize(r,r)};Zi.octDecode=function(e,t,n){return Zi.octDecodeInRange(e,t,255,n)};Zi.octDecodeFromCartesian4=function(e,t){let n=e.x,r=e.y,o=e.z,a=e.w,s=n*$5+r,u=o*$5+a;return Zi.octDecodeInRange(s,u,65535,t)};Zi.octPackFloat=function(e){return 256*e.x+e.y};var rN=new X;Zi.octEncodeFloat=function(e){return Zi.octEncode(e,rN),Zi.octPackFloat(rN)};Zi.octDecodeFloat=function(e,t){let n=e/256,r=Math.floor(n),o=(n-r)*256;return Zi.octDecode(r,o,t)};Zi.octPack=function(e,t,n,r){let o=Zi.octEncodeFloat(e),a=Zi.octEncodeFloat(t),s=Zi.octEncode(n,rN);return r.x=65536*s.x+o,r.y=65536*s.y+a,r};Zi.octUnpack=function(e,t,n,r){let o=e.x/65536,a=Math.floor(o),s=(o-a)*65536;o=e.y/65536;let u=Math.floor(o),l=(o-u)*65536;Zi.octDecodeFloat(s,t),Zi.octDecodeFloat(l,n),Zi.octDecode(a,u,r)};Zi.compressTextureCoordinates=function(e){let t=e.x*4095|0,n=e.y*4095|0;return 4096*t+n};Zi.decompressTextureCoordinates=function(e,t){let n=e/4096,r=Math.floor(n);return t.x=r/4095,t.y=(e-r*4096)/4095,t};function nN(e){return e>>1^-(e&1)}Zi.zigZagDeltaDecode=function(e,t,n){let r=e.length,o=0,a=0,s=0;for(let u=0;u<r;++u)o+=nN(e[u]),a+=nN(t[u]),e[u]=o,t[u]=a,g(n)&&(s+=nN(n[u]),n[u]=s)};Zi.dequantize=function(e,t,n,r){let o=Wc.getNumberOfComponents(n),a;switch(t){case ie.BYTE:a=127;break;case ie.UNSIGNED_BYTE:a=255;break;case ie.SHORT:a=32767;break;case ie.UNSIGNED_SHORT:a=65535;break;case ie.INT:a=2147483647;break;case ie.UNSIGNED_INT:a=4294967295;break}let s=new Float32Array(r*o);for(let u=0;u<r;u++)for(let l=0;l<o;l++){let c=u*o+l;s[c]=Math.max(e[c]/a,-1)}return s};Zi.decodeRGB565=function(e,t){let n=e.length;g(t)||(t=new Float32Array(n*3));let r=(1<<5)-1,o=(1<<6)-1,a=1/31,s=1/63;for(let u=0;u<n;u++){let l=e[u],c=l>>11,f=l>>5&o,h=l&r,d=3*u;t[d]=c*a,t[d+1]=f*s,t[d+2]=h*a}return t};var _a=Zi;function Que(e,t){this.start=T(e,0),this.stop=T(t,0)}var np=Que;function Ct(e,t){this.center=x.clone(T(e,x.ZERO)),this.radius=T(t,0)}var aN=new x,sN=new x,uN=new x,lN=new x,cN=new x,fN=new x,hN=new x,Zs=new x,dN=new x,pN=new x,mN=new x,gN=new x,Jue=4/3*F.PI;Ct.fromPoints=function(e,t){if(g(t)||(t=new Ct),!g(e)||e.length===0)return t.center=x.clone(x.ZERO,t.center),t.radius=0,t;let n=x.clone(e[0],hN),r=x.clone(n,aN),o=x.clone(n,sN),a=x.clone(n,uN),s=x.clone(n,lN),u=x.clone(n,cN),l=x.clone(n,fN),c=e.length,f;for(f=1;f<c;f++){x.clone(e[f],n);let M=n.x,b=n.y,O=n.z;M<r.x&&x.clone(n,r),M>s.x&&x.clone(n,s),b<o.y&&x.clone(n,o),b>u.y&&x.clone(n,u),O<a.z&&x.clone(n,a),O>l.z&&x.clone(n,l)}let h=x.magnitudeSquared(x.subtract(s,r,Zs)),d=x.magnitudeSquared(x.subtract(u,o,Zs)),p=x.magnitudeSquared(x.subtract(l,a,Zs)),_=r,y=s,v=h;d>v&&(v=d,_=o,y=u),p>v&&(v=p,_=a,y=l);let w=dN;w.x=(_.x+y.x)*.5,w.y=(_.y+y.y)*.5,w.z=(_.z+y.z)*.5;let C=x.magnitudeSquared(x.subtract(y,w,Zs)),E=Math.sqrt(C),S=pN;S.x=r.x,S.y=o.y,S.z=a.z;let A=mN;A.x=s.x,A.y=u.y,A.z=l.z;let D=x.midpoint(S,A,gN),P=0;for(f=0;f<c;f++){x.clone(e[f],n);let M=x.magnitude(x.subtract(n,D,Zs));M>P&&(P=M);let b=x.magnitudeSquared(x.subtract(n,w,Zs));if(b>C){let O=Math.sqrt(b);E=(E+O)*.5,C=E*E;let m=O-E;w.x=(E*w.x+m*n.x)/O,w.y=(E*w.y+m*n.y)/O,w.z=(E*w.z+m*n.z)/O}}return E<P?(x.clone(w,t.center),t.radius=E):(x.clone(D,t.center),t.radius=P),t};var $ue=new mc,ele=new x,tle=new x,iN=new le,oN=new le;Ct.fromRectangle2D=function(e,t,n){return Ct.fromRectangleWithHeights2D(e,t,0,0,n)};Ct.fromRectangleWithHeights2D=function(e,t,n,r,o){if(g(o)||(o=new Ct),!g(e))return o.center=x.clone(x.ZERO,o.center),o.radius=0,o;t=T(t,$ue),hn.southwest(e,iN),iN.height=n,hn.northeast(e,oN),oN.height=r;let a=t.project(iN,ele),s=t.project(oN,tle),u=s.x-a.x,l=s.y-a.y,c=s.z-a.z;o.radius=Math.sqrt(u*u+l*l+c*c)*.5;let f=o.center;return f.x=a.x+u*.5,f.y=a.y+l*.5,f.z=a.z+c*.5,o};var nle=[];Ct.fromRectangle3D=function(e,t,n,r){if(t=T(t,Ge.WGS84),n=T(n,0),g(r)||(r=new Ct),!g(e))return r.center=x.clone(x.ZERO,r.center),r.radius=0,r;let o=hn.subsample(e,t,n,nle);return Ct.fromPoints(o,r)};Ct.fromVertices=function(e,t,n,r){if(g(r)||(r=new Ct),!g(e)||e.length===0)return r.center=x.clone(x.ZERO,r.center),r.radius=0,r;t=T(t,x.ZERO),n=T(n,3);let o=hN;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;let a=x.clone(o,aN),s=x.clone(o,sN),u=x.clone(o,uN),l=x.clone(o,lN),c=x.clone(o,cN),f=x.clone(o,fN),h=e.length,d;for(d=0;d<h;d+=n){let O=e[d]+t.x,m=e[d+1]+t.y,I=e[d+2]+t.z;o.x=O,o.y=m,o.z=I,O<a.x&&x.clone(o,a),O>l.x&&x.clone(o,l),m<s.y&&x.clone(o,s),m>c.y&&x.clone(o,c),I<u.z&&x.clone(o,u),I>f.z&&x.clone(o,f)}let p=x.magnitudeSquared(x.subtract(l,a,Zs)),_=x.magnitudeSquared(x.subtract(c,s,Zs)),y=x.magnitudeSquared(x.subtract(f,u,Zs)),v=a,w=l,C=p;_>C&&(C=_,v=s,w=c),y>C&&(C=y,v=u,w=f);let E=dN;E.x=(v.x+w.x)*.5,E.y=(v.y+w.y)*.5,E.z=(v.z+w.z)*.5;let S=x.magnitudeSquared(x.subtract(w,E,Zs)),A=Math.sqrt(S),D=pN;D.x=a.x,D.y=s.y,D.z=u.z;let P=mN;P.x=l.x,P.y=c.y,P.z=f.z;let M=x.midpoint(D,P,gN),b=0;for(d=0;d<h;d+=n){o.x=e[d]+t.x,o.y=e[d+1]+t.y,o.z=e[d+2]+t.z;let O=x.magnitude(x.subtract(o,M,Zs));O>b&&(b=O);let m=x.magnitudeSquared(x.subtract(o,E,Zs));if(m>S){let I=Math.sqrt(m);A=(A+I)*.5,S=A*A;let L=I-A;E.x=(A*E.x+L*o.x)/I,E.y=(A*E.y+L*o.y)/I,E.z=(A*E.z+L*o.z)/I}}return A<b?(x.clone(E,r.center),r.radius=A):(x.clone(M,r.center),r.radius=b),r};Ct.fromEncodedCartesianVertices=function(e,t,n){if(g(n)||(n=new Ct),!g(e)||!g(t)||e.length!==t.length||e.length===0)return n.center=x.clone(x.ZERO,n.center),n.radius=0,n;let r=hN;r.x=e[0]+t[0],r.y=e[1]+t[1],r.z=e[2]+t[2];let o=x.clone(r,aN),a=x.clone(r,sN),s=x.clone(r,uN),u=x.clone(r,lN),l=x.clone(r,cN),c=x.clone(r,fN),f=e.length,h;for(h=0;h<f;h+=3){let b=e[h]+t[h],O=e[h+1]+t[h+1],m=e[h+2]+t[h+2];r.x=b,r.y=O,r.z=m,b<o.x&&x.clone(r,o),b>u.x&&x.clone(r,u),O<a.y&&x.clone(r,a),O>l.y&&x.clone(r,l),m<s.z&&x.clone(r,s),m>c.z&&x.clone(r,c)}let d=x.magnitudeSquared(x.subtract(u,o,Zs)),p=x.magnitudeSquared(x.subtract(l,a,Zs)),_=x.magnitudeSquared(x.subtract(c,s,Zs)),y=o,v=u,w=d;p>w&&(w=p,y=a,v=l),_>w&&(w=_,y=s,v=c);let C=dN;C.x=(y.x+v.x)*.5,C.y=(y.y+v.y)*.5,C.z=(y.z+v.z)*.5;let E=x.magnitudeSquared(x.subtract(v,C,Zs)),S=Math.sqrt(E),A=pN;A.x=o.x,A.y=a.y,A.z=s.z;let D=mN;D.x=u.x,D.y=l.y,D.z=c.z;let P=x.midpoint(A,D,gN),M=0;for(h=0;h<f;h+=3){r.x=e[h]+t[h],r.y=e[h+1]+t[h+1],r.z=e[h+2]+t[h+2];let b=x.magnitude(x.subtract(r,P,Zs));b>M&&(M=b);let O=x.magnitudeSquared(x.subtract(r,C,Zs));if(O>E){let m=Math.sqrt(O);S=(S+m)*.5,E=S*S;let I=m-S;C.x=(S*C.x+I*r.x)/m,C.y=(S*C.y+I*r.y)/m,C.z=(S*C.z+I*r.z)/m}}return S<M?(x.clone(C,n.center),n.radius=S):(x.clone(P,n.center),n.radius=M),n};Ct.fromCornerPoints=function(e,t,n){g(n)||(n=new Ct);let r=x.midpoint(e,t,n.center);return n.radius=x.distance(r,t),n};Ct.fromEllipsoid=function(e,t){return g(t)||(t=new Ct),x.clone(x.ZERO,t.center),t.radius=e.maximumRadius,t};var rle=new x;Ct.fromBoundingSpheres=function(e,t){if(g(t)||(t=new Ct),!g(e)||e.length===0)return t.center=x.clone(x.ZERO,t.center),t.radius=0,t;let n=e.length;if(n===1)return Ct.clone(e[0],t);if(n===2)return Ct.union(e[0],e[1],t);let r=[],o;for(o=0;o<n;o++)r.push(e[o].center);t=Ct.fromPoints(r,t);let a=t.center,s=t.radius;for(o=0;o<n;o++){let u=e[o];s=Math.max(s,x.distance(a,u.center,rle)+u.radius)}return t.radius=s,t};var ile=new x,ole=new x,ale=new x;Ct.fromOrientedBoundingBox=function(e,t){g(t)||(t=new Ct);let n=e.halfAxes,r=te.getColumn(n,0,ile),o=te.getColumn(n,1,ole),a=te.getColumn(n,2,ale);return x.add(r,o,r),x.add(r,a,r),t.center=x.clone(e.center,t.center),t.radius=x.magnitude(r),t};var sle=new x,ule=new x;Ct.fromTransformation=function(e,t){g(t)||(t=new Ct);let n=G.getTranslation(e,sle),r=G.getScale(e,ule),o=.5*x.magnitude(r);return t.center=x.clone(n,t.center),t.radius=o,t};Ct.clone=function(e,t){if(!!g(e))return g(t)?(t.center=x.clone(e.center,t.center),t.radius=e.radius,t):new Ct(e.center,e.radius)};Ct.packedLength=4;Ct.pack=function(e,t,n){n=T(n,0);let r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t};Ct.unpack=function(e,t,n){t=T(t,0),g(n)||(n=new Ct);let r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};var lle=new x,cle=new x;Ct.union=function(e,t,n){g(n)||(n=new Ct);let r=e.center,o=e.radius,a=t.center,s=t.radius,u=x.subtract(a,r,lle),l=x.magnitude(u);if(o>=l+s)return e.clone(n),n;if(s>=l+o)return t.clone(n),n;let c=(o+l+s)*.5,f=x.multiplyByScalar(u,(-o+c)/l,cle);return x.add(f,r,f),x.clone(f,n.center),n.radius=c,n};var fle=new x;Ct.expand=function(e,t,n){n=Ct.clone(e,n);let r=x.magnitude(x.subtract(t,n.center,fle));return r>n.radius&&(n.radius=r),n};Ct.intersectPlane=function(e,t){let n=e.center,r=e.radius,o=t.normal,a=x.dot(o,n)+t.distance;return a<-r?vi.OUTSIDE:a<r?vi.INTERSECTING:vi.INSIDE};Ct.transform=function(e,t,n){return g(n)||(n=new Ct),n.center=G.multiplyByPoint(t,e.center,n.center),n.radius=G.getMaximumScale(t)*e.radius,n};var hle=new x;Ct.distanceSquaredTo=function(e,t){let n=x.subtract(e.center,t,hle),r=x.magnitude(n)-e.radius;return r<=0?0:r*r};Ct.transformWithoutScale=function(e,t,n){return g(n)||(n=new Ct),n.center=G.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var dle=new x;Ct.computePlaneDistances=function(e,t,n,r){g(r)||(r=new np);let o=x.subtract(e.center,t,dle),a=x.dot(n,o);return r.start=a-e.radius,r.stop=a+e.radius,r};var t8=new x,ple=new x,mle=new x,gle=new x,_le=new x,yle=new le,n8=new Array(8);for(let e=0;e<8;++e)n8[e]=new x;var vle=new mc;Ct.projectTo2D=function(e,t,n){t=T(t,vle);let r=t.ellipsoid,o=e.center,a=e.radius,s;x.equals(o,x.ZERO)?s=x.clone(x.UNIT_X,t8):s=r.geodeticSurfaceNormal(o,t8);let u=x.cross(x.UNIT_Z,s,ple);x.normalize(u,u);let l=x.cross(s,u,mle);x.normalize(l,l),x.multiplyByScalar(s,a,s),x.multiplyByScalar(l,a,l),x.multiplyByScalar(u,a,u);let c=x.negate(l,_le),f=x.negate(u,gle),h=n8,d=h[0];x.add(s,l,d),x.add(d,u,d),d=h[1],x.add(s,l,d),x.add(d,f,d),d=h[2],x.add(s,c,d),x.add(d,f,d),d=h[3],x.add(s,c,d),x.add(d,u,d),x.negate(s,s),d=h[4],x.add(s,l,d),x.add(d,u,d),d=h[5],x.add(s,l,d),x.add(d,f,d),d=h[6],x.add(s,c,d),x.add(d,f,d),d=h[7],x.add(s,c,d),x.add(d,u,d);let p=h.length;for(let w=0;w<p;++w){let C=h[w];x.add(o,C,C);let E=r.cartesianToCartographic(C,yle);t.project(E,C)}n=Ct.fromPoints(h,n),o=n.center;let _=o.x,y=o.y,v=o.z;return o.x=v,o.y=_,o.z=y,n};Ct.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)};Ct.equals=function(e,t){return e===t||g(e)&&g(t)&&x.equals(e.center,t.center)&&e.radius===t.radius};Ct.prototype.intersectPlane=function(e){return Ct.intersectPlane(this,e)};Ct.prototype.distanceSquaredTo=function(e){return Ct.distanceSquaredTo(this,e)};Ct.prototype.computePlaneDistances=function(e,t,n){return Ct.computePlaneDistances(this,e,t,n)};Ct.prototype.isOccluded=function(e){return Ct.isOccluded(this,e)};Ct.prototype.equals=function(e){return Ct.equals(this,e)};Ct.prototype.clone=function(e){return Ct.clone(this,e)};Ct.prototype.volume=function(){let e=this.radius;return Jue*e*e*e};var Ee=Ct;function Cle(){return!0}function xle(e,t){t=T(t,"This object was destroyed, i.e., destroy() was called.");function n(){}for(let r in e)typeof e[r]=="function"&&(e[r]=n);e.isDestroyed=Cle}var st=xle;function rp(){this.high=x.clone(x.ZERO),this.low=x.clone(x.ZERO)}rp.encode=function(e,t){g(t)||(t={high:0,low:0});let n;return e>=0?(n=Math.floor(e/65536)*65536,t.high=n,t.low=e-n):(n=Math.floor(-e/65536)*65536,t.high=-n,t.low=e+n),t};var wm={high:0,low:0};rp.fromCartesian=function(e,t){g(t)||(t=new rp);let n=t.high,r=t.low;return rp.encode(e.x,wm),n.x=wm.high,r.x=wm.low,rp.encode(e.y,wm),n.y=wm.high,r.y=wm.low,rp.encode(e.z,wm),n.z=wm.high,r.z=wm.low,t};var _N=new rp;rp.writeElements=function(e,t,n){rp.fromCartesian(e,_N);let r=_N.high,o=_N.low;t[n]=r.x,t[n+1]=r.y,t[n+2]=r.z,t[n+3]=o.x,t[n+4]=o.y,t[n+5]=o.z};var ti=rp;var Ms={UNSIGNED_BYTE:k.UNSIGNED_BYTE,UNSIGNED_SHORT:k.UNSIGNED_SHORT,UNSIGNED_INT:k.UNSIGNED_INT};Ms.getSizeInBytes=function(e){switch(e){case Ms.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Ms.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Ms.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}};Ms.fromSizeInBytes=function(e){switch(e){case 2:return Ms.UNSIGNED_SHORT;case 4:return Ms.UNSIGNED_INT;case 1:return Ms.UNSIGNED_BYTE}};Ms.validate=function(e){return g(e)&&(e===Ms.UNSIGNED_BYTE||e===Ms.UNSIGNED_SHORT||e===Ms.UNSIGNED_INT)};Ms.createTypedArray=function(e,t){return e>=F.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)};Ms.createTypedArrayFromArrayBuffer=function(e,t,n,r){return e>=F.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,r):new Uint16Array(t,n,r)};Ms.fromTypedArray=function(e){if(e instanceof Uint8Array)return Ms.UNSIGNED_BYTE;if(e instanceof Uint16Array)return Ms.UNSIGNED_SHORT;if(e instanceof Uint32Array)return Ms.UNSIGNED_INT};var Or=Object.freeze(Ms);var aI={STREAM_DRAW:k.STREAM_DRAW,STATIC_DRAW:k.STATIC_DRAW,DYNAMIC_DRAW:k.DYNAMIC_DRAW,validate:function(e){return e===aI.STREAM_DRAW||e===aI.STATIC_DRAW||e===aI.DYNAMIC_DRAW}},We=Object.freeze(aI);function zf(e){e=T(e,T.EMPTY_OBJECT);let t=e.context._gl,n=e.bufferTarget,r=e.typedArray,o=e.sizeInBytes,a=e.usage,s=g(r);s&&(o=r.byteLength);let u=t.createBuffer();t.bindBuffer(n,u),t.bufferData(n,s?r:o,a),t.bindBuffer(n,null),this._id=Ci(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=a,this._buffer=u,this.vertexArrayDestroyable=!0}zf.createVertexBuffer=function(e){return new zf({context:e.context,bufferTarget:k.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};zf.createIndexBuffer=function(e){let t=e.context,n=e.indexDatatype,r=Or.getSizeInBytes(n),o=new zf({context:t,bufferTarget:k.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),a=o.sizeInBytes/r;return Object.defineProperties(o,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return r}},numberOfIndices:{get:function(){return a}}}),o};Object.defineProperties(zf.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});zf.prototype._getBuffer=function(){return this._buffer};zf.prototype.copyFromArrayView=function(e,t){t=T(t,0);let n=this._gl,r=this._bufferTarget;n.bindBuffer(r,this._buffer),n.bufferSubData(r,t,e),n.bindBuffer(r,null)};zf.prototype.copyFromBuffer=function(e,t,n,r){let o=k.COPY_READ_BUFFER,a=k.COPY_WRITE_BUFFER,s=this._gl;s.bindBuffer(a,this._buffer),s.bindBuffer(o,e._buffer),s.copyBufferSubData(o,a,t,n,r),s.bindBuffer(a,null),s.bindBuffer(o,null)};zf.prototype.getBufferData=function(e,t,n,r){t=T(t,0),n=T(n,0);let o=this._gl,a=k.COPY_READ_BUFFER;o.bindBuffer(a,this._buffer),o.getBufferSubData(a,t,e,n,r),o.bindBuffer(a,null)};zf.prototype.isDestroyed=function(){return!1};zf.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),st(this)};var Ui=zf;var Ou={POINTS:k.POINTS,LINES:k.LINES,LINE_LOOP:k.LINE_LOOP,LINE_STRIP:k.LINE_STRIP,TRIANGLES:k.TRIANGLES,TRIANGLE_STRIP:k.TRIANGLE_STRIP,TRIANGLE_FAN:k.TRIANGLE_FAN};Ou.isLines=function(e){return e===Ou.LINES||e===Ou.LINE_LOOP||e===Ou.LINE_STRIP};Ou.isTriangles=function(e){return e===Ou.TRIANGLES||e===Ou.TRIANGLE_STRIP||e===Ou.TRIANGLE_FAN};Ou.validate=function(e){return e===Ou.POINTS||e===Ou.LINES||e===Ou.LINE_LOOP||e===Ou.LINE_STRIP||e===Ou.TRIANGLES||e===Ou.TRIANGLE_STRIP||e===Ou.TRIANGLE_FAN};var sn=Object.freeze(Ou);var ta={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function iE(e){e=T(e,T.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._modelMatrix=e.modelMatrix,this._primitiveType=T(e.primitiveType,sn.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=T(e.offset,0),this._instanceCount=T(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._owner=e.owner,this._debugOverlappingFrustums=0,this._pickId=e.pickId,this._flags=0,this.cull=T(e.cull,!0),this.occlude=T(e.occlude,!0),this.executeInClosestFrustum=T(e.executeInClosestFrustum,!1),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.castShadows=T(e.castShadows,!1),this.receiveShadows=T(e.receiveShadows,!1),this.pickOnly=T(e.pickOnly,!1),this.depthForTranslucentClassification=T(e.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function al(e,t){return(e._flags&t)===t}function jg(e,t,n){n?e._flags|=t:e._flags&=~t}Object.defineProperties(iE.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return al(this,ta.CULL)},set:function(e){al(this,ta.CULL)!==e&&(jg(this,ta.CULL,e),this.dirty=!0)}},occlude:{get:function(){return al(this,ta.OCCLUDE)},set:function(e){al(this,ta.OCCLUDE)!==e&&(jg(this,ta.OCCLUDE,e),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return al(this,ta.CAST_SHADOWS)},set:function(e){al(this,ta.CAST_SHADOWS)!==e&&(jg(this,ta.CAST_SHADOWS,e),this.dirty=!0)}},receiveShadows:{get:function(){return al(this,ta.RECEIVE_SHADOWS)},set:function(e){al(this,ta.RECEIVE_SHADOWS)!==e&&(jg(this,ta.RECEIVE_SHADOWS,e),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return al(this,ta.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(e){al(this,ta.EXECUTE_IN_CLOSEST_FRUSTUM)!==e&&(jg(this,ta.EXECUTE_IN_CLOSEST_FRUSTUM,e),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return al(this,ta.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(e){al(this,ta.DEBUG_SHOW_BOUNDING_VOLUME)!==e&&(jg(this,ta.DEBUG_SHOW_BOUNDING_VOLUME,e),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickOnly:{get:function(){return al(this,ta.PICK_ONLY)},set:function(e){al(this,ta.PICK_ONLY)!==e&&(jg(this,ta.PICK_ONLY,e),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return al(this,ta.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(e){al(this,ta.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==e&&(jg(this,ta.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,e),this.dirty=!0)}}});iE.shallowClone=function(e,t){if(!!g(e))return g(t)||(t=new iE),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._owner=e._owner,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._pickId=e._pickId,t._flags=e._flags,t.dirty=!0,t.lastDirtyTime=0,t};iE.prototype.execute=function(e,t){e.draw(this,t)};var $t=iE;var wle={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,NUMBER_OF_PASSES:10},en=Object.freeze(wle);var sI={CLOCKWISE:k.CW,COUNTER_CLOCKWISE:k.CCW};sI.validate=function(e){return e===sI.CLOCKWISE||e===sI.COUNTER_CLOCKWISE};var Em=Object.freeze(sI);function op(e){let t=T(e,T.EMPTY_OBJECT),n=T(t.cull,T.EMPTY_OBJECT),r=T(t.polygonOffset,T.EMPTY_OBJECT),o=T(t.scissorTest,T.EMPTY_OBJECT),a=T(o.rectangle,T.EMPTY_OBJECT),s=T(t.depthRange,T.EMPTY_OBJECT),u=T(t.depthTest,T.EMPTY_OBJECT),l=T(t.colorMask,T.EMPTY_OBJECT),c=T(t.blending,T.EMPTY_OBJECT),f=T(c.color,T.EMPTY_OBJECT),h=T(t.stencilTest,T.EMPTY_OBJECT),d=T(h.frontOperation,T.EMPTY_OBJECT),p=T(h.backOperation,T.EMPTY_OBJECT),_=T(t.sampleCoverage,T.EMPTY_OBJECT),y=t.viewport;this.frontFace=T(t.frontFace,Em.COUNTER_CLOCKWISE),this.cull={enabled:T(n.enabled,!1),face:T(n.face,k.BACK)},this.lineWidth=T(t.lineWidth,1),this.polygonOffset={enabled:T(r.enabled,!1),factor:T(r.factor,0),units:T(r.units,0)},this.scissorTest={enabled:T(o.enabled,!1),rectangle:rn.clone(a)},this.depthRange={near:T(s.near,0),far:T(s.far,1)},this.depthTest={enabled:T(u.enabled,!1),func:T(u.func,k.LESS)},this.colorMask={red:T(l.red,!0),green:T(l.green,!0),blue:T(l.blue,!0),alpha:T(l.alpha,!0)},this.depthMask=T(t.depthMask,!0),this.stencilMask=T(t.stencilMask,-1),this.blending={enabled:T(c.enabled,!1),color:new K(T(f.red,0),T(f.green,0),T(f.blue,0),T(f.alpha,0)),equationRgb:T(c.equationRgb,k.FUNC_ADD),equationAlpha:T(c.equationAlpha,k.FUNC_ADD),functionSourceRgb:T(c.functionSourceRgb,k.ONE),functionSourceAlpha:T(c.functionSourceAlpha,k.ONE),functionDestinationRgb:T(c.functionDestinationRgb,k.ZERO),functionDestinationAlpha:T(c.functionDestinationAlpha,k.ZERO)},this.stencilTest={enabled:T(h.enabled,!1),frontFunction:T(h.frontFunction,k.ALWAYS),backFunction:T(h.backFunction,k.ALWAYS),reference:T(h.reference,0),mask:T(h.mask,-1),frontOperation:{fail:T(d.fail,k.KEEP),zFail:T(d.zFail,k.KEEP),zPass:T(d.zPass,k.KEEP)},backOperation:{fail:T(p.fail,k.KEEP),zFail:T(p.zFail,k.KEEP),zPass:T(p.zPass,k.KEEP)}},this.sampleCoverage={enabled:T(_.enabled,!1),value:T(_.value,1),invert:T(_.invert,!1)},this.viewport=g(y)?new rn(y.x,y.y,y.width,y.height):void 0,this.id=0,this._applyFunctions=[]}var Ele=0,ip={};op.fromCache=function(e){let t=JSON.stringify(e),n=ip[t];if(g(n))return++n.referenceCount,n.state;let r=new op(e),o=JSON.stringify(r);return n=ip[o],g(n)||(r.id=Ele++,n={referenceCount:0,state:r},ip[o]=n),++n.referenceCount,ip[t]={referenceCount:1,state:n.state},n.state};op.removeFromCache=function(e){let t=new op(e),n=JSON.stringify(t),r=ip[n],o=JSON.stringify(e),a=ip[o];g(a)&&(--a.referenceCount,a.referenceCount===0&&(delete ip[o],g(r)&&--r.referenceCount)),g(r)&&r.referenceCount===0&&delete ip[n]};op.getCache=function(){return ip};op.clearCache=function(){ip={}};function R_(e,t,n){n?e.enable(t):e.disable(t)}function r8(e,t){e.frontFace(t.frontFace)}function i8(e,t){let n=t.cull,r=n.enabled;R_(e,e.CULL_FACE,r),r&&e.cullFace(n.face)}function o8(e,t){e.lineWidth(t.lineWidth)}function a8(e,t){let n=t.polygonOffset,r=n.enabled;R_(e,e.POLYGON_OFFSET_FILL,r),r&&e.polygonOffset(n.factor,n.units)}function s8(e,t,n){let r=t.scissorTest,o=g(n.scissorTest)?n.scissorTest.enabled:r.enabled;if(R_(e,e.SCISSOR_TEST,o),o){let a=g(n.scissorTest)?n.scissorTest.rectangle:r.rectangle;e.scissor(a.x,a.y,a.width,a.height)}}function u8(e,t){let n=t.depthRange;e.depthRange(n.near,n.far)}function l8(e,t){let n=t.depthTest,r=n.enabled;R_(e,e.DEPTH_TEST,r),r&&e.depthFunc(n.func)}function c8(e,t){let n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function f8(e,t){e.depthMask(t.depthMask)}function h8(e,t){e.stencilMask(t.stencilMask)}function Tle(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function d8(e,t,n){let r=t.blending,o=g(n.blendingEnabled)?n.blendingEnabled:r.enabled;R_(e,e.BLEND,o),o&&(Tle(e,r.color),e.blendEquationSeparate(r.equationRgb,r.equationAlpha),e.blendFuncSeparate(r.functionSourceRgb,r.functionDestinationRgb,r.functionSourceAlpha,r.functionDestinationAlpha))}function p8(e,t){let n=t.stencilTest,r=n.enabled;if(R_(e,e.STENCIL_TEST,r),r){let o=n.frontFunction,a=n.backFunction,s=n.reference,u=n.mask;e.stencilFunc(o,s,u),e.stencilFuncSeparate(e.BACK,a,s,u),e.stencilFuncSeparate(e.FRONT,o,s,u);let l=n.frontOperation,c=l.fail,f=l.zFail,h=l.zPass;e.stencilOpSeparate(e.FRONT,c,f,h);let d=n.backOperation,p=d.fail,_=d.zFail,y=d.zPass;e.stencilOpSeparate(e.BACK,p,_,y)}}function m8(e,t){let n=t.sampleCoverage,r=n.enabled;R_(e,e.SAMPLE_COVERAGE,r),r&&e.sampleCoverage(n.value,n.invert)}var Sle=new rn;function g8(e,t,n){let r=T(t.viewport,n.viewport);g(r)||(r=Sle,r.width=n.context.drawingBufferWidth,r.height=n.context.drawingBufferHeight),n.context.uniformState.viewport=r,e.viewport(r.x,r.y,r.width,r.height)}op.apply=function(e,t,n){r8(e,t),i8(e,t),o8(e,t),a8(e,t),u8(e,t),l8(e,t),c8(e,t),f8(e,t),h8(e,t),p8(e,t),m8(e,t),s8(e,t,n),d8(e,t,n),g8(e,t,n)};function Ale(e,t){let n=[];return e.frontFace!==t.frontFace&&n.push(r8),(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face)&&n.push(i8),e.lineWidth!==t.lineWidth&&n.push(o8),(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units)&&n.push(a8),(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far)&&n.push(u8),(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func)&&n.push(l8),(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha)&&n.push(c8),e.depthMask!==t.depthMask&&n.push(f8),e.stencilMask!==t.stencilMask&&n.push(h8),(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass)&&n.push(p8),(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert)&&n.push(m8),n}op.partialApply=function(e,t,n,r,o,a){if(t!==n){let f=n._applyFunctions[t.id];g(f)||(f=Ale(t,n),n._applyFunctions[t.id]=f);let h=f.length;for(let d=0;d<h;++d)f[d](e,n)}let s=g(r.scissorTest)?r.scissorTest:t.scissorTest,u=g(o.scissorTest)?o.scissorTest:n.scissorTest;(s!==u||a)&&s8(e,n,o);let l=g(r.blendingEnabled)?r.blendingEnabled:t.blending.enabled,c=g(o.blendingEnabled)?o.blendingEnabled:n.blending.enabled;(l!==c||c&&t.blending!==n.blending)&&d8(e,n,o),(t!==n||r!==o||r.context!==o.context)&&g8(e,n,o)};op.getState=function(e){return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:rn.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:K.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:g(e.viewport)?rn.clone(e.viewport):void 0}};var fn=op;var ble=new x;function Ze(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var Qs={};Qs[k.FLOAT]="float";Qs[k.FLOAT_VEC2]="vec2";Qs[k.FLOAT_VEC3]="vec3";Qs[k.FLOAT_VEC4]="vec4";Qs[k.INT]="int";Qs[k.INT_VEC2]="ivec2";Qs[k.INT_VEC3]="ivec3";Qs[k.INT_VEC4]="ivec4";Qs[k.BOOL]="bool";Qs[k.BOOL_VEC2]="bvec2";Qs[k.BOOL_VEC3]="bvec3";Qs[k.BOOL_VEC4]="bvec4";Qs[k.FLOAT_MAT2]="mat2";Qs[k.FLOAT_MAT3]="mat3";Qs[k.FLOAT_MAT4]="mat4";Qs[k.SAMPLER_2D]="sampler2D";Qs[k.SAMPLER_CUBE]="samplerCube";Ze.prototype.getDeclaration=function(e){let t=`uniform ${Qs[this._datatype]} ${e}`,n=this._size;return n===1?t+=";":t+=`[${n.toString()}];`,t};var Ile={czm_viewport:new Ze({size:1,datatype:k.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new Ze({size:1,datatype:k.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new Ze({size:1,datatype:k.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.eyeHeight}}),czm_eyeHeight2D:new Ze({size:1,datatype:k.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new Ze({size:1,datatype:k.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new Ze({size:1,datatype:k.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new Ze({size:1,datatype:k.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_farDepthFromNearPlusOne:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_lightDirectionEC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.lightDirectionEC}}),czm_lightDirectionWC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.lightDirectionWC}}),czm_lightColor:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.lightColor}}),czm_lightColorHdr:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return G.getTranslation(e.inverseView,ble)}}),czm_frameNumber:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new Ze({size:1,datatype:k.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new Ze({size:1,datatype:k.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new Ze({size:1,datatype:k.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new Ze({size:1,datatype:k.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new Ze({size:1,datatype:k.FLOAT_VEC2,getValue:function(e){return e.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new Ze({size:9,datatype:k.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new Ze({size:1,datatype:k.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_pixelRatio:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.pixelRatio}}),czm_fogDensity:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.fogDensity}}),czm_splitPosition:new Ze({size:1,datatype:k.FLOAT_VEC2,getValue:function(e){return e.splitPosition}}),czm_geometricToleranceOverMeter:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new Ze({size:1,datatype:k.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new Ze({size:1,datatype:k.FLOAT,getValue:function(e){return e.gamma}}),czm_ellipsoidRadii:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new Ze({size:1,datatype:k.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.oneOverRadii}})},cC=Ile;function Dle(e,t,n,r){switch(t.type){case e.FLOAT:return new _8(e,t,n,r);case e.FLOAT_VEC2:return new y8(e,t,n,r);case e.FLOAT_VEC3:return new v8(e,t,n,r);case e.FLOAT_VEC4:return new C8(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new yN(e,t,n,r);case e.INT:case e.BOOL:return new x8(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new w8(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new E8(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new T8(e,t,n,r);case e.FLOAT_MAT2:return new S8(e,t,n,r);case e.FLOAT_MAT3:return new A8(e,t,n,r);case e.FLOAT_MAT4:return new b8(e,t,n,r);default:throw new at(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function _8(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}_8.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))};function y8(e,t,n,r){this.name=n,this.value=void 0,this._value=new X,this._gl=e,this._location=r}y8.prototype.set=function(){let e=this.value;X.equals(e,this._value)||(X.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))};function v8(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}v8.prototype.set=function(){let e=this.value;g(e.red)?K.equals(e,this._value)||(this._value=K.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):g(e.x)&&(x.equals(e,this._value)||(this._value=x.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))};function C8(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}C8.prototype.set=function(){let e=this.value;g(e.red)?K.equals(e,this._value)||(this._value=K.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):g(e.x)&&(Se.equals(e,this._value)||(this._value=Se.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))};function yN(e,t,n,r){this.name=n,this.value=void 0,this._gl=e,this._location=r,this.textureUnitIndex=void 0}yN.prototype.set=function(){let e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);let t=this.value;e.bindTexture(t._target,t._texture)};yN.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1};function x8(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}x8.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))};function w8(e,t,n,r){this.name=n,this.value=void 0,this._value=new X,this._gl=e,this._location=r}w8.prototype.set=function(){let e=this.value;X.equals(e,this._value)||(X.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))};function E8(e,t,n,r){this.name=n,this.value=void 0,this._value=new x,this._gl=e,this._location=r}E8.prototype.set=function(){let e=this.value;x.equals(e,this._value)||(x.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))};function T8(e,t,n,r){this.name=n,this.value=void 0,this._value=new Se,this._gl=e,this._location=r}T8.prototype.set=function(){let e=this.value;Se.equals(e,this._value)||(Se.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var Ple=new Float32Array(4);function S8(e,t,n,r){this.name=n,this.value=void 0,this._value=new Ra,this._gl=e,this._location=r}S8.prototype.set=function(){if(!Ra.equalsArray(this.value,this._value,0)){Ra.clone(this.value,this._value);let e=Ra.toArray(this.value,Ple);this._gl.uniformMatrix2fv(this._location,!1,e)}};var Mle=new Float32Array(9);function A8(e,t,n,r){this.name=n,this.value=void 0,this._value=new te,this._gl=e,this._location=r}A8.prototype.set=function(){if(!te.equalsArray(this.value,this._value,0)){te.clone(this.value,this._value);let e=te.toArray(this.value,Mle);this._gl.uniformMatrix3fv(this._location,!1,e)}};var Lle=new Float32Array(16);function b8(e,t,n,r){this.name=n,this.value=void 0,this._value=new G,this._gl=e,this._location=r}b8.prototype.set=function(){if(!G.equalsArray(this.value,this._value,0)){G.clone(this.value,this._value);let e=G.toArray(this.value,Lle);this._gl.uniformMatrix4fv(this._location,!1,e)}};var I8=Dle;function Rle(e,t,n,r){switch(t.type){case e.FLOAT:return new D8(e,t,n,r);case e.FLOAT_VEC2:return new P8(e,t,n,r);case e.FLOAT_VEC3:return new M8(e,t,n,r);case e.FLOAT_VEC4:return new L8(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new vN(e,t,n,r);case e.INT:case e.BOOL:return new R8(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new O8(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new N8(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new B8(e,t,n,r);case e.FLOAT_MAT2:return new F8(e,t,n,r);case e.FLOAT_MAT3:return new z8(e,t,n,r);case e.FLOAT_MAT4:return new V8(e,t,n,r);default:throw new at(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function D8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._location=r[0]}D8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1;for(let o=0;o<t;++o){let a=e[o];a!==n[o]&&(n[o]=a,r=!0)}r&&this._gl.uniform1fv(this._location,n)};function P8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*2),this._gl=e,this._location=r[0]}P8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];X.equalsArray(s,n,o)||(X.pack(s,n,o),r=!0),o+=2}r&&this._gl.uniform2fv(this._location,n)};function M8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*3),this._gl=e,this._location=r[0]}M8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];g(s.red)?(s.red!==n[o]||s.green!==n[o+1]||s.blue!==n[o+2])&&(n[o]=s.red,n[o+1]=s.green,n[o+2]=s.blue,r=!0):g(s.x)&&(x.equalsArray(s,n,o)||(x.pack(s,n,o),r=!0)),o+=3}r&&this._gl.uniform3fv(this._location,n)};function L8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=r[0]}L8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];g(s.red)?K.equalsArray(s,n,o)||(K.pack(s,n,o),r=!0):g(s.x)&&(Se.equalsArray(s,n,o)||(Se.pack(s,n,o),r=!0)),o+=4}r&&this._gl.uniform4fv(this._location,n)};function vN(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._locations=r,this.textureUnitIndex=void 0}vN.prototype.set=function(){let e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,r=n.length;for(let o=0;o<r;++o){let a=n[o];e.activeTexture(t+o),e.bindTexture(a._target,a._texture)}};vN.prototype._setSampler=function(e){this.textureUnitIndex=e;let t=this._locations,n=t.length;for(let r=0;r<n;++r){let o=e+r;this._gl.uniform1i(t[r],o)}return e+n};function R8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o),this._gl=e,this._location=r[0]}R8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1;for(let o=0;o<t;++o){let a=e[o];a!==n[o]&&(n[o]=a,r=!0)}r&&this._gl.uniform1iv(this._location,n)};function O8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*2),this._gl=e,this._location=r[0]}O8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];X.equalsArray(s,n,o)||(X.pack(s,n,o),r=!0),o+=2}r&&this._gl.uniform2iv(this._location,n)};function N8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*3),this._gl=e,this._location=r[0]}N8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];x.equalsArray(s,n,o)||(x.pack(s,n,o),r=!0),o+=3}r&&this._gl.uniform3iv(this._location,n)};function B8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*4),this._gl=e,this._location=r[0]}B8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];Se.equalsArray(s,n,o)||(Se.pack(s,n,o),r=!0),o+=4}r&&this._gl.uniform4iv(this._location,n)};function F8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=r[0]}F8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];Ra.equalsArray(s,n,o)||(Ra.pack(s,n,o),r=!0),o+=4}r&&this._gl.uniformMatrix2fv(this._location,!1,n)};function z8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*9),this._gl=e,this._location=r[0]}z8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];te.equalsArray(s,n,o)||(te.pack(s,n,o),r=!0),o+=9}r&&this._gl.uniformMatrix3fv(this._location,!1,n)};function V8(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*16),this._gl=e,this._location=r[0]}V8.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];G.equalsArray(s,n,o)||(G.pack(s,n,o),r=!0),o+=16}r&&this._gl.uniformMatrix4fv(this._location,!1,n)};var k8=Rle;var Ole=0;function Tm(e){let t=e.vertexShaderText,n=e.fragmentShaderText;typeof spector<"u"&&(t=t.replace(/^#line/gm,"//#line"),n=n.replace(/^#line/gm,"//#line"));let r=Nle(t,n);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=r.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=r.fragmentShaderText,this.id=Ole++}Tm.fromCache=function(e){return e=T(e,T.EMPTY_OBJECT),e.context.shaderCache.getShaderProgram(e)};Tm.replaceCache=function(e){return e=T(e,T.EMPTY_OBJECT),e.context.shaderCache.replaceShaderProgram(e)};Object.defineProperties(Tm.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return uI(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return uI(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return uI(this),this._uniformsByName}}});function G8(e){let t=[],n=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(g(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o].trim(),s=a.slice(a.lastIndexOf(" ")+1);t.push(s)}}return t}function Nle(e,t){let n={};if(!Jt.highpFloatSupported||!Jt.highpIntSupported){let r,o,a,s,u=G8(e),l=G8(t),c=u.length,f=l.length;for(r=0;r<c;r++)for(o=0;o<f;o++)if(u[r]===l[o]){a=u[r],s=`czm_mediump_${a}`;let h=new RegExp(`${a}\\b`,"g");t=t.replace(h,s),n[s]=a}}return{fragmentShaderText:t,duplicateUniformNames:n}}var Vf="[Cesium WebGL] ";function Ble(e,t){let n=t._vertexShaderText,r=t._fragmentShaderText,o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,n),e.compileShader(o);let a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,r),e.compileShader(a);let s=e.createProgram();e.attachShader(s,o),e.attachShader(s,a),e.deleteShader(o),e.deleteShader(a);let u=t._attributeLocations;if(g(u))for(let f in u)u.hasOwnProperty(f)&&e.bindAttribLocation(s,u[f],f);e.linkProgram(s);let l;if(!e.getProgramParameter(s,e.LINK_STATUS)){let f=t._debugShaders;if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(l=e.getShaderInfoLog(a),console.error(`${Vf}Fragment shader compile log: ${l}`),g(f)){let h=f.getTranslatedShaderSource(a);console.error(h!==""?`${Vf}Translated fragment shader source:
${h}`:`${Vf}Fragment shader translation failed.`)}throw e.deleteProgram(s),new at(`Fragment shader failed to compile.  Compile log: ${l}`)}if(!e.getShaderParameter(o,e.COMPILE_STATUS)){if(l=e.getShaderInfoLog(o),console.error(`${Vf}Vertex shader compile log: ${l}`),g(f)){let h=f.getTranslatedShaderSource(o);console.error(h!==""?`${Vf}Translated vertex shader source:
${h}`:`${Vf}Vertex shader translation failed.`)}throw e.deleteProgram(s),new at(`Vertex shader failed to compile.  Compile log: ${l}`)}throw l=e.getProgramInfoLog(s),console.error(`${Vf}Shader program link log: ${l}`),g(f)&&(console.error(`${Vf}Translated vertex shader source:
${f.getTranslatedShaderSource(o)}`),console.error(`${Vf}Translated fragment shader source:
${f.getTranslatedShaderSource(a)}`)),e.deleteProgram(s),new at(`Program failed to link.  Link log: ${l}`)}let c=t._logShaderCompilation;return c&&(l=e.getShaderInfoLog(o),g(l)&&l.length>0&&console.log(`${Vf}Vertex shader compile log: ${l}`)),c&&(l=e.getShaderInfoLog(a),g(l)&&l.length>0&&console.log(`${Vf}Fragment shader compile log: ${l}`)),c&&(l=e.getProgramInfoLog(s),g(l)&&l.length>0&&console.log(`${Vf}Shader program link log: ${l}`)),s}function Fle(e,t,n){let r={};for(let o=0;o<n;++o){let a=e.getActiveAttrib(t,o),s=e.getAttribLocation(t,a.name);r[a.name]={name:a.name,type:a.type,index:s}}return r}function zle(e,t){let n={},r=[],o=[],a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<a;++s){let u=e.getActiveUniform(t,s),l="[0]",c=u.name.indexOf(l,u.name.length-l.length)!==-1?u.name.slice(0,u.name.length-3):u.name;if(c.indexOf("gl_")!==0)if(u.name.indexOf("[")<0){let f=e.getUniformLocation(t,c);if(f!==null){let h=I8(e,u,c,f);n[c]=h,r.push(h),h._setSampler&&o.push(h)}}else{let f,h,d,p,_=c.indexOf("[");if(_>=0){if(f=n[c.slice(0,_)],!g(f))continue;h=f._locations,h.length<=1&&(d=f.value,p=e.getUniformLocation(t,c),p!==null&&(h.push(p),d.push(e.getUniform(t,p))))}else{h=[];for(let y=0;y<u.size;++y)p=e.getUniformLocation(t,`${c}[${y}]`),p!==null&&h.push(p);f=k8(e,u,c,h),n[c]=f,r.push(f),f._setSampler&&o.push(f)}}}return{uniformsByName:n,uniforms:r,samplerUniforms:o}}function Vle(e,t){let n=[],r=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=o,u=e._duplicateUniformNames[s];g(u)&&(a.name=u,s=u);let l=cC[s];g(l)?n.push({uniform:a,automaticUniform:l}):r.push(a)}return{automaticUniforms:n,manualUniforms:r}}function kle(e,t,n){e.useProgram(t);let r=0,o=n.length;for(let a=0;a<o;++a)r=n[a]._setSampler(r);return e.useProgram(null),r}function uI(e){g(e._program)||U8(e)}function U8(e){let t=e._program,n=e._gl,r=Ble(n,e,e._debugShaders),o=n.getProgramParameter(r,n.ACTIVE_ATTRIBUTES),a=zle(n,r),s=Vle(e,a.uniformsByName);e._program=r,e._numberOfVertexAttributes=o,e._vertexAttributes=Fle(n,r,o),e._uniformsByName=a.uniformsByName,e._uniforms=a.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=kle(n,r,a.samplerUniforms),t&&e._gl.deleteProgram(t),typeof spector<"u"&&(e._program.__SPECTOR_rebuildProgram=function(u,l,c,f){let h=e._vertexShaderText,d=e._fragmentShaderText,p=/ ! = /g;e._vertexShaderText=u.replace(p," != "),e._fragmentShaderText=l.replace(p," != ");try{U8(e),c(e._program)}catch(_){e._vertexShaderText=h,e._fragmentShaderText=d;let v=/(?:Compile|Link) error: ([^]*)/.exec(_.message);f(v?v[1]:_.message)}})}Tm.prototype._bind=function(){uI(this),this._gl.useProgram(this._program)};Tm.prototype._setUniforms=function(e,t,n){let r,o;if(g(e)){let u=this._manualUniforms;for(r=u.length,o=0;o<r;++o){let l=u[o];l.value=e[l.name]()}}let a=this._automaticUniforms;for(r=a.length,o=0;o<r;++o){let u=a[o];u.uniform.value=u.automaticUniform.getValue(t)}let s=this._uniforms;for(r=s.length,o=0;o<r;++o)s[o].set();if(n){let u=this._gl,l=this._program;u.validateProgram(l)}};Tm.prototype.isDestroyed=function(){return!1};Tm.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)};Tm.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),st(this)};var wi=Tm;function Gle(e,t){let n=/#define OUTPUT_DECLARATION/,r=e.split(`
`);if(/#version 300 es/g.test(e))return e;let o=-1,a,s;for(a=0;a<r.length;++a)if(s=r[a],n.test(s)){o=a;break}if(o===-1)throw new Le("Could not find a #define OUTPUT_DECLARATION!");let u=[];for(a=0;a<10;a++){let y=`gl_FragData\\[${a}\\]`,v=`czm_out${a}`;new RegExp(y,"g").test(e)&&(H8(v,u),ap(y,v,r),r.splice(o,0,`layout(location = ${a}) out vec4 ${v};`),o+=1)}let l="czm_fragColor";Hle("gl_FragColor",r)&&(H8(l,u),ap("gl_FragColor",l,r),r.splice(o,0,"layout(location = 0) out vec4 czm_fragColor;"),o+=1);let c=Wle(u,r),f={};for(a=0;a<r.length;a++){s=r[a];for(let y in c)c.hasOwnProperty(y)&&new RegExp(`(layout)[^]+(out)[^]+(${y})[^]+`,"g").test(s)&&(f[s]=y)}for(let y in f)if(f.hasOwnProperty(y)){let v=f[y],w=r.indexOf(y),C=c[v],E=C.length;for(let S=0;S<E;S++)r.splice(w,0,C[S]);w+=E+1;for(let S=E-1;S>=0;S--)r.splice(w,0,`#endif //${C[S]}`)}let h="WEBGL_2",d=`#define ${h}`,p="#version 300 es",_=!1;for(a=0;a<r.length;a++)if(/#version/.test(r[a])){r[a]=p,_=!0;break}return _||r.splice(0,0,p),r.splice(1,0,d),CN("EXT_draw_buffers",h,r),CN("EXT_frag_depth",h,r),CN("OES_standard_derivatives",h,r),ap("texture2D","texture",r),ap("texture3D","texture",r),ap("textureCube","texture",r),ap("gl_FragDepthEXT","gl_FragDepth",r),t?ap("varying","in",r):(ap("attribute","in",r),ap("varying","out",r)),qle(r)}function ap(e,t,n){let r=`(^|[^\\w])(${e})($|[^\\w])`,o=new RegExp(r,"g"),a=n.length;for(let s=0;s<a;++s){let u=n[s];n[s]=u.replace(o,`$1${t}$3`)}}function Ule(e,t,n){let r=n.length;for(let o=0;o<r;++o){let a=n[o];n[o]=a.replace(e,t)}}function Hle(e,t){let n=`(^|[^\\w])(${e})($|[^\\w])`,r=new RegExp(n,"g"),o=t.length;for(let a=0;a<o;++a){let s=t[a];if(r.test(s))return!0}return!1}function qle(e){let t="",n=e.length;for(let r=0;r<n;++r)t+=`${e[r]}
`;return t}function H8(e,t){t.indexOf(e)===-1&&t.push(e)}function Wle(e,t){let n={},r=e.length,o=[];for(let a=0;a<t.length;++a){let s=t[a],u=/(#ifdef|#if)/g.test(s),l=/#else/g.test(s),c=/#endif/g.test(s);if(u)o.push(s);else if(l){let h=o[o.length-1].replace("ifdef","ifndef");/if/g.test(h)&&(h=h.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),o.pop(),o.push(h)}else if(c)o.pop();else if(!/layout/g.test(s))for(let f=0;f<r;++f){let h=e[f];s.indexOf(h)!==-1&&(g(n[h])?n[h]=n[h].filter(function(d){return o.indexOf(d)>=0}):n[h]=o.slice())}}return n}function CN(e,t,n){let r=`#extension\\s+GL_${e}\\s+:\\s+[a-zA-Z0-9]+\\s*$`;Ule(new RegExp(r,"g"),"",n),ap(`GL_${e}`,t,n)}var q8=Gle;var W8=`const float czm_degreesPerRadian = 57.29577951308232;
`;var Y8=`const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);
`;var X8=`const float czm_epsilon1 = 0.1;
`;var j8=`const float czm_epsilon2 = 0.01;
`;var K8=`const float czm_epsilon3 = 0.001;
`;var Z8=`const float czm_epsilon4 = 0.0001;
`;var Q8=`const float czm_epsilon5 = 0.00001;
`;var J8=`const float czm_epsilon6 = 0.000001;
`;var $8=`const float czm_epsilon7 = 0.0000001;
`;var eG=`const float czm_infinity = 5906376272000.0;
`;var tG=`const float czm_oneOverPi = 0.3183098861837907;
`;var nG=`const float czm_oneOverTwoPi = 0.15915494309189535;
`;var rG=`const float czm_passCesium3DTile = 4.0;
`;var iG=`const float czm_passCesium3DTileClassification = 5.0;
`;var oG=`const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;
`;var aG=`const float czm_passClassification = 7.0;
`;var sG=`const float czm_passCompute = 1.0;
`;var uG=`const float czm_passEnvironment = 0.0;
`;var lG=`const float czm_passGlobe = 2.0;
`;var cG=`const float czm_passOpaque = 7.0;
`;var fG=`const float czm_passOverlay = 9.0;
`;var hG=`const float czm_passTerrainClassification = 3.0;
`;var dG=`const float czm_passTranslucent = 8.0;
`;var pG=`const float czm_pi = 3.141592653589793;
`;var mG=`const float czm_piOverFour = 0.7853981633974483;
`;var gG=`const float czm_piOverSix = 0.5235987755982988;
`;var _G=`const float czm_piOverThree = 1.0471975511965976;
`;var yG=`const float czm_piOverTwo = 1.5707963267948966;
`;var vG=`const float czm_radiansPerDegree = 0.017453292519943295;
`;var CG=`const float czm_sceneMode2D = 2.0;
`;var xG=`const float czm_sceneMode3D = 3.0;
`;var wG=`const float czm_sceneModeColumbusView = 1.0;
`;var EG=`const float czm_sceneModeMorphing = 0.0;
`;var TG=`const float czm_solarRadius = 695500000.0;
`;var SG=`const float czm_threePiOver2 = 4.71238898038469;
`;var AG=`const float czm_twoPi = 6.283185307179586;
`;var bG=`const float czm_webMercatorMaxLatitude = 1.4844222297453324;
`;var IG=`struct czm_depthRangeStruct
{
float near;
float far;
};
`;var DG=`struct czm_material
{
vec3 diffuse;
float specular;
float shininess;
vec3 normal;
vec3 emission;
float alpha;
};
`;var PG=`struct czm_materialInput
{
float s;
vec2 st;
vec3 str;
vec3 normalEC;
mat3 tangentToEyeMatrix;
vec3 positionToEyeEC;
float height;
float slope;
float aspect;
};
`;var MG=`struct czm_modelMaterial {
vec3 diffuse;
float alpha;
vec3 specular;
float roughness;
vec3 normalEC;
float occlusion;
vec3 emissive;
};
`;var LG=`struct czm_modelVertexOutput {
vec3 positionMC;
float pointSize;
};
`;var RG=`struct czm_pbrParameters
{
vec3 diffuseColor;
float roughness;
vec3 f0;
};
`;var OG=`struct czm_ray
{
vec3 origin;
vec3 direction;
};
`;var NG=`struct czm_raySegment
{
float start;
float stop;
};
const czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);
const czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);
`;var BG=`struct czm_shadowParameters
{
#ifdef USE_CUBE_MAP_SHADOW
vec3 texCoords;
#else
vec2 texCoords;
#endif
float depthBias;
float depth;
float nDotL;
vec2 texelStepSize;
float normalShadingSmooth;
float darkness;
};
`;var FG=`vec3 czm_acesTonemapping(vec3 color) {
float g = 0.985;
float a = 0.065;
float b = 0.0001;
float c = 0.433;
float d = 0.238;
color = (color * (color + a) - b) / (color * (g * color + c) + d);
color = clamp(color, 0.0, 1.0);
return color;
}
`;var zG=`float czm_alphaWeight(float a)
{
float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));
}
`;var VG=`vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)
{
float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);
float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);
val1 = val1 * (1.0 - val2);
val1 = val1 * val1 * (3.0 - (2.0 * val1));
val1 = pow(val1, 0.5);
vec4 midColor = (color1 + color2) * 0.5;
return mix(midColor, currentColor, val1);
}
vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)
{
return czm_antialias(color1, color2, currentColor, dist, 0.1);
}
`;var kG=`vec2 czm_approximateSphericalCoordinates(vec3 normal) {
float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);
float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);
return vec2(latitudeApproximation, longitudeApproximation);
}
`;var GG=`bool czm_backFacing()
{
return gl_FrontFacing == false;
}
`;var UG=`float czm_branchFreeTernary(bool comparison, float a, float b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
`;var HG=`vec4 czm_cascadeColor(vec4 weights)
{
return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +
vec4(0.0, 1.0, 0.0, 1.0) * weights.y +
vec4(0.0, 0.0, 1.0, 1.0) * weights.z +
vec4(1.0, 0.0, 1.0, 1.0) * weights.w;
}
`;var qG=`uniform vec4 shadowMap_cascadeDistances;
float czm_cascadeDistance(vec4 weights)
{
return dot(shadowMap_cascadeDistances, weights);
}
`;var WG=`uniform mat4 shadowMap_cascadeMatrices[4];
mat4 czm_cascadeMatrix(vec4 weights)
{
return shadowMap_cascadeMatrices[0] * weights.x +
shadowMap_cascadeMatrices[1] * weights.y +
shadowMap_cascadeMatrices[2] * weights.z +
shadowMap_cascadeMatrices[3] * weights.w;
}
`;var YG=`uniform vec4 shadowMap_cascadeSplits[2];
vec4 czm_cascadeWeights(float depthEye)
{
vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));
vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);
return near * far;
}
`;var XG=`vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)
{
vec3 p = mix(position2D.xyz, position3D.xyz, time);
return vec4(p, 1.0);
}
`;var jG=`vec4 czm_computePosition();
`;var KG=`vec2 cordic(float angle)
{
vec2 vector = vec2(6.0725293500888267e-1, 0.0);
float sense = (angle < 0.0) ? -1.0 : 1.0;
mat2 rotation = mat2(1.0, sense, -sense, 1.0);
vector = rotation * vector;
angle -= sense * 7.8539816339744828e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
float factor = sense * 5.0e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.6364760900080609e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.5e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4497866312686414e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.25e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2435499454676144e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.25e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.2418809995957350e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.125e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.1239833430268277e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.5625e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5623728620476831e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.8125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.8123410601011111e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.90625e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.9062301319669718e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.953125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9531225164788188e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.765625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.7656218955931946e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.8828125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.8828121119489829e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.44140625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4414062014936177e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.220703125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2207031189367021e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.103515625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.1035156174208773e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.0517578125e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.0517578115526096e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.52587890625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5258789061315762e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.62939453125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.6293945311019700e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.814697265625e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.8146972656064961e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.9073486328125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9073486328101870e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.5367431640625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.5367431640596084e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.76837158203125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.7683715820308884e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.384185791015625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.3841857910155797e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.1920928955078125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
return vector;
}
vec2 czm_cosineAndSine(float angle)
{
if (angle < -czm_piOverTwo || angle > czm_piOverTwo)
{
if (angle < 0.0)
{
return -cordic(angle + czm_pi);
}
else
{
return -cordic(angle - czm_pi);
}
}
else
{
return cordic(angle);
}
}
`;var ZG=`vec2 czm_decompressTextureCoordinates(float encoded)
{
float temp = encoded / 4096.0;
float xZeroTo4095 = floor(temp);
float stx = xZeroTo4095 / 4095.0;
float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;
return vec2(stx, sty);
}
`;var QG=`czm_pbrParameters czm_defaultPbrMaterial()
{
czm_pbrParameters results;
results.diffuseColor = vec3(1.0);
results.roughness = 1.0;
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
results.f0 = REFLECTANCE_DIELECTRIC;
return results;
}
`;var JG=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
vec4 czm_depthClamp(vec4 coords)
{
#ifndef LOG_DEPTH
#ifdef GL_EXT_frag_depth
v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;
coords.z = 0.0;
#else
coords.z = min(coords.z, coords.w);
#endif
#endif
return coords;
}
`;var $G=`mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)
{
vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));
vec3 tangentEC = normalize(czm_normal3D * tangentMC);
vec3 bitangentEC = normalize(cross(normalEC, tangentEC));
return mat3(
tangentEC.x,   tangentEC.y,   tangentEC.z,
bitangentEC.x, bitangentEC.y, bitangentEC.z,
normalEC.x,    normalEC.y,    normalEC.z);
}
`;var eU=`bool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)
{
vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;
return (dot(scaled, scaled) <= 1.0);
}
`;var tU=`vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)
{
return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);
}
`;var nU=`bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec4(epsilon)));
}
bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec3(epsilon)));
}
bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec2(epsilon)));
}
bool czm_equalsEpsilon(float left, float right, float epsilon) {
return (abs(left - right) <= epsilon);
}
`;var rU=`vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)
{
vec4 p = positionEC;
vec4 zEyeOffset = normalize(p) * eyeOffset.z;
p.xy += eyeOffset.xy + zEyeOffset.xy;
p.z += zEyeOffset.z;
return p;
}
`;var iU=`vec4 czm_eyeToWindowCoordinates(vec4 positionEC)
{
vec4 q = czm_projection * positionEC;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var oU=`float czm_fastApproximateAtan(float x) {
return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);
}
float czm_fastApproximateAtan(float x, float y) {
float t = abs(x);
float opposite = abs(y);
float adjacent = max(t, opposite);
opposite = min(t, opposite);
t = czm_fastApproximateAtan(opposite / adjacent);
t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);
t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);
t = czm_branchFreeTernary(y < 0.0, -t, t);
return t;
}
`;var aU=`vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-(scalar * scalar));
return mix(color, fogColor, fog);
}
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));
return mix(color, fogColor, fog);
}
`;var sU=`vec3 czm_gammaCorrect(vec3 color) {
#ifdef HDR
color = pow(color, vec3(czm_gamma));
#endif
return color;
}
vec4 czm_gammaCorrect(vec4 color) {
#ifdef HDR
color.rgb = pow(color.rgb, vec3(czm_gamma));
#endif
return color;
}
`;var uU=`vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)
{
return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);
}
`;var lU=`czm_material czm_getDefaultMaterial(czm_materialInput materialInput)
{
czm_material material;
material.diffuse = vec3(0.0);
material.specular = 0.0;
material.shininess = 1.0;
material.normal = materialInput.normalEC;
material.emission = vec3(0.0);
material.alpha = 1.0;
return material;
}
`;var cU=`float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)
{
return max(dot(lightDirectionEC, normalEC), 0.0);
}
`;var fU=`float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)
{
vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);
float specular = max(dot(toReflectedLight, toEyeEC), 0.0);
return pow(specular, max(shininess, czm_epsilon2));
}
`;var hU=`vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)
{
float cosAngle = cos(angleInRadians);
float sinAngle = sin(angleInRadians);
vec2 s0 = vec2(1.0/17.0, 0.0);
vec2 s1 = vec2(-1.0/29.0, 0.0);
vec2 s2 = vec2(1.0/101.0, 1.0/59.0);
vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);
s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));
s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));
s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));
s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));
vec2 uv0 = (uv/103.0) + (time * s0);
vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);
vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);
vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);
uv0 = fract(uv0);
uv1 = fract(uv1);
uv2 = fract(uv2);
uv3 = fract(uv3);
vec4 noise = (texture2D(normalMap, uv0)) +
(texture2D(normalMap, uv1)) +
(texture2D(normalMap, uv2)) +
(texture2D(normalMap, uv3));
return ((noise / 4.0) - 0.5) * 2.0;
}
`;var dU=`const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 czm_HSBToRGB(vec3 hsb)
{
vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);
return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);
}
`;var pU=`vec3 hueToRGB(float hue)
{
float r = abs(hue * 6.0 - 3.0) - 1.0;
float g = 2.0 - abs(hue * 6.0 - 2.0);
float b = 2.0 - abs(hue * 6.0 - 4.0);
return clamp(vec3(r, g, b), 0.0, 1.0);
}
vec3 czm_HSLToRGB(vec3 hsl)
{
vec3 rgb = hueToRGB(hsl.x);
float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;
return (rgb - 0.5) * c + hsl.z;
}
`;var mU=`vec3 czm_hue(vec3 rgb, float adjustment)
{
const mat3 toYIQ = mat3(0.299,     0.587,     0.114,
0.595716, -0.274453, -0.321263,
0.211456, -0.522591,  0.311135);
const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,
1.0, -0.2721, -0.6474,
1.0, -1.107,   1.7046);
vec3 yiq = toYIQ * rgb;
float hue = atan(yiq.z, yiq.y) + adjustment;
float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);
vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));
return toRGB * color;
}
`;var gU=`vec3 czm_inverseGamma(vec3 color) {
return pow(color, vec3(1.0 / czm_gamma));
}
`;var _U=`bool czm_isEmpty(czm_raySegment interval)
{
return (interval.stop < 0.0);
}
`;var yU=`bool czm_isFull(czm_raySegment interval)
{
return (interval.start == 0.0 && interval.stop == czm_infinity);
}
`;var vU=`float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)
{
float sinLatitude = sin(latitude);
float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));
return (mercatorY - southMercatorY) * oneOverMercatorHeight;
}
`;var CU=`vec3 czm_linearToSrgb(vec3 linearIn)
{
return pow(linearIn, vec3(1.0/2.2));
}
vec4 czm_linearToSrgb(vec4 linearIn)
{
vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));
return vec4(srgbOut, linearIn.a);
}
`;var xU=`float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {
return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);
}
`;var wU=`float czm_luminance(vec3 rgb)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
return dot(rgb, W);
}
`;var EU=`float czm_metersPerPixel(vec4 positionEC, float pixelRatio)
{
float width = czm_viewport.z;
float height = czm_viewport.w;
float pixelWidth;
float pixelHeight;
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)
{
float frustumWidth = right - left;
float frustumHeight = top - bottom;
pixelWidth = frustumWidth / width;
pixelHeight = frustumHeight / height;
}
else
{
float distanceToPixel = -positionEC.z;
float inverseNear = 1.0 / czm_currentFrustum.x;
float tanTheta = top * inverseNear;
pixelHeight = 2.0 * distanceToPixel * tanTheta / height;
tanTheta = right * inverseNear;
pixelWidth = 2.0 * distanceToPixel * tanTheta / width;
}
return max(pixelWidth, pixelHeight) * pixelRatio;
}
float czm_metersPerPixel(vec4 positionEC)
{
return czm_metersPerPixel(positionEC, czm_pixelRatio);
}
`;var TU=`vec4 czm_modelToWindowCoordinates(vec4 position)
{
vec4 q = czm_modelViewProjection * position;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var SU=`vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 target = left * right;
float leftLuminance = dot(left, W);
float rightLuminance = dot(right, W);
float targetLuminance = dot(target, W);
return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;
}
`;var AU=`float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)
{
float valueAtMin = nearFarScalar.y;
float valueAtMax = nearFarScalar.w;
float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;
float farDistanceSq = nearFarScalar.z * nearFarScalar.z;
float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);
t = pow(clamp(t, 0.0, 1.0), 0.2);
return mix(valueAtMin, valueAtMax, t);
}
`;var bU=`vec3 czm_octDecode(vec2 encoded, float range)
{
if (encoded.x == 0.0 && encoded.y == 0.0) {
return vec3(0.0, 0.0, 0.0);
}
encoded = encoded / range * 2.0 - 1.0;
vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));
if (v.z < 0.0)
{
v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);
}
return normalize(v);
}
vec3 czm_octDecode(vec2 encoded)
{
return czm_octDecode(encoded, 255.0);
}
vec3 czm_octDecode(float encoded)
{
float temp = encoded / 256.0;
float x = floor(temp);
float y = (temp - x) * 256.0;
return czm_octDecode(vec2(x, y));
}
void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)
{
float temp = encoded.x / 65536.0;
float x = floor(temp);
float encodedFloat1 = (temp - x) * 65536.0;
temp = encoded.y / 65536.0;
float y = floor(temp);
float encodedFloat2 = (temp - y) * 65536.0;
vector1 = czm_octDecode(encodedFloat1);
vector2 = czm_octDecode(encodedFloat2);
vector3 = czm_octDecode(vec2(x, y));
}
`;var IU=`vec4 czm_packDepth(float depth)
{
vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;
enc = fract(enc);
enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
return enc;
}
`;var DU=`vec3 lambertianDiffuse(vec3 diffuseColor)
{
return diffuseColor / czm_pi;
}
vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)
{
return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}
float smithVisibilityG1(float NdotV, float roughness)
{
float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
return NdotV / (NdotV * (1.0 - k) + k);
}
float smithVisibilityGGX(float roughness, float NdotL, float NdotV)
{
return (
smithVisibilityG1(NdotL, roughness) *
smithVisibilityG1(NdotV, roughness)
);
}
float GGX(float roughness, float NdotH)
{
float roughnessSquared = roughness * roughness;
float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
return roughnessSquared / (czm_pi * f * f);
}
vec3 czm_pbrLighting(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
)
{
vec3 v = -normalize(positionEC);
vec3 l = normalize(lightDirectionEC);
vec3 h = normalize(v + l);
vec3 n = normalEC;
float NdotL = clamp(dot(n, l), 0.001, 1.0);
float NdotV = abs(dot(n, v)) + 0.001;
float NdotH = clamp(dot(n, h), 0.0, 1.0);
float LdotH = clamp(dot(l, h), 0.0, 1.0);
float VdotH = clamp(dot(v, h), 0.0, 1.0);
vec3 f0 = pbrParameters.f0;
float reflectance = max(max(f0.r, f0.g), f0.b);
vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
vec3 F = fresnelSchlick2(f0, f90, VdotH);
float alpha = pbrParameters.roughness;
float G = smithVisibilityGGX(alpha, NdotL, NdotV);
float D = GGX(alpha, NdotH);
vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
vec3 diffuseColor = pbrParameters.diffuseColor;
vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
return (diffuseContribution + specularContribution) * NdotL * lightColorHdr;
}
`;var PU=`czm_pbrParameters czm_pbrMetallicRoughnessMaterial(
vec3 baseColor,
float metallic,
float roughness
)
{
czm_pbrParameters results;
roughness = clamp(roughness, 0.0, 1.0);
results.roughness = roughness * roughness;
metallic = clamp(metallic, 0.0, 1.0);
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
vec3 f0 = mix(REFLECTANCE_DIELECTRIC, baseColor, metallic);
results.f0 = f0;
results.diffuseColor = baseColor * (1.0 - f0) * (1.0 - metallic);
return results;
}
`;var MU=`czm_pbrParameters czm_pbrSpecularGlossinessMaterial(
vec3 diffuse,
vec3 specular,
float glossiness
)
{
czm_pbrParameters results;
float roughness = 1.0 - glossiness;
results.roughness = roughness * roughness;
results.diffuseColor = diffuse * (1.0 - max(max(specular.r, specular.g), specular.b));
results.f0 = specular;
return results;
}
`;var LU=`float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)
{
return czm_getLambertDiffuse(lightDirectionEC, material.normal);
}
float czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)
{
return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);
}
vec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);
}
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_phong(vec3 toEye, czm_material material)
{
return czm_phong(toEye, material,czm_lightDirectionEC);
}
vec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 ambient = vec3(0.0);
vec3 color = ambient + material.emission;
color += material.diffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
`;var RU=`float czm_planeDistance(vec4 plane, vec3 point) {
return (dot(plane.xyz, point) + plane.w);
}
float czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {
return (dot(planeNormal, point) + planeDistance);
}
`;var OU=`vec3 czm_pointAlongRay(czm_ray ray, float time)
{
return ray.origin + (time * ray.direction);
}
`;var NU=`czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)
{
vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;
vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;
q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;
float q2 = dot(q, q);
float qw = dot(q, w);
if (q2 > 1.0)
{
if (qw >= 0.0)
{
return czm_emptyRaySegment;
}
else
{
float qw2 = qw * qw;
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
if (qw2 < product)
{
return czm_emptyRaySegment;
}
else if (qw2 > product)
{
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
float root0 = temp / w2;
float root1 = difference / temp;
if (root0 < root1)
{
czm_raySegment i = czm_raySegment(root0, root1);
return i;
}
else
{
czm_raySegment i = czm_raySegment(root1, root0);
return i;
}
}
else
{
float root = sqrt(difference / w2);
czm_raySegment i = czm_raySegment(root, root);
return i;
}
}
}
else if (q2 < 1.0)
{
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
czm_raySegment i = czm_raySegment(0.0, temp / w2);
return i;
}
else
{
if (qw < 0.0)
{
float w2 = dot(w, w);
czm_raySegment i = czm_raySegment(0.0, -qw / w2);
return i;
}
else
{
return czm_emptyRaySegment;
}
}
}
`;var BU=`czm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)
{
vec3 o = ray.origin;
vec3 d = ray.direction;
vec3 oc = o - center;
float a = dot(d, d);
float b = 2.0 * dot(d, oc);
float c = dot(oc, oc) - (radius * radius);
float det = (b * b) - (4.0 * a * c);
if (det < 0.0) {
return czm_emptyRaySegment;
}
float sqrtDet = sqrt(det);
float t0 = (-b - sqrtDet) / (2.0 * a);
float t1 = (-b + sqrtDet) / (2.0 * a);
czm_raySegment result = czm_raySegment(t0, t1);
return result;
}
`;var FU=`float czm_readDepth(sampler2D depthTexture, vec2 texCoords)
{
return czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);
}
`;var zU=`float czm_readNonPerspective(float value, float oneOverW) {
return value * oneOverW;
}
vec2 czm_readNonPerspective(vec2 value, float oneOverW) {
return value * oneOverW;
}
vec3 czm_readNonPerspective(vec3 value, float oneOverW) {
return value * oneOverW;
}
vec4 czm_readNonPerspective(vec4 value, float oneOverW) {
return value * oneOverW;
}
`;var VU=`float czm_reverseLogDepth(float logZ)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
return far * (1.0 - near / (depthFromNear + near)) / (far - near);
#endif
return logZ;
}
`;var kU=`const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec3 czm_RGBToHSB(vec3 rgb)
{
vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));
vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));
float d = q.x - min(q.w, q.y);
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);
}
`;var GU=`vec3 RGBtoHCV(vec3 rgb)
{
vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);
vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);
float c = q.x - min(q.w, q.y);
float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);
return vec3(h, c, q.x);
}
vec3 czm_RGBToHSL(vec3 rgb)
{
vec3 hcv = RGBtoHCV(rgb);
float l = hcv.z - hcv.y * 0.5;
float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);
return vec3(hcv.x, s, l);
}
`;var UU=`vec3 czm_RGBToXYZ(vec3 rgb)
{
const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,
0.3576, 0.7152, 0.1192,
0.1805, 0.0722, 0.9505);
vec3 xyz = RGB2XYZ * rgb;
vec3 Yxy;
Yxy.r = xyz.g;
float temp = dot(vec3(1.0), xyz);
Yxy.gb = xyz.rg / temp;
return Yxy;
}
`;var HU=`void czm_rollerShutter(vec2 coord,vec4 region)
{
vec2 st = coord / czm_viewport.zw;
if(st.x < region.x || st.x > region.z){
discard;
}
if(st.y < region.y || st.y > region.w){
discard;
}
}
`;var qU=`float czm_round(float value) {
return floor(value + 0.5);
}
vec2 czm_round(vec2 value) {
return floor(value + 0.5);
}
vec3 czm_round(vec3 value) {
return floor(value + 0.5);
}
vec4 czm_round(vec4 value) {
return floor(value + 0.5);
}
`;var WU=`vec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)
{
direction /= dot(vec3(1.0), abs(direction));
vec2 rev = abs(direction.zx) - vec2(1.0);
vec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,
direction.z < 0.0 ? rev.y : -rev.y);
vec2 uv = direction.y < 0.0 ? neg : direction.xz;
vec2 coord = 0.5 * uv + vec2(0.5);
vec2 pixel = 1.0 / textureSize;
if (lod > 0.0)
{
float scale = 1.0 / pow(2.0, lod);
float offset = ((textureSize.y + 1.0) / textureSize.x);
coord.x *= offset;
coord *= scale;
coord.x += offset + pixel.x;
coord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;
}
else
{
coord.x *= (textureSize.y / textureSize.x);
}
#ifndef OES_texture_float_linear
vec3 color1 = texture2D(projectedMap, coord + vec2(0.0, pixel.y)).rgb;
vec3 color2 = texture2D(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;
vec3 color3 = texture2D(projectedMap, coord + pixel).rgb;
vec3 color4 = texture2D(projectedMap, coord).rgb;
vec2 texturePosition = coord * textureSize;
float fu = fract(texturePosition.x);
float fv = fract(texturePosition.y);
vec3 average1 = mix(color4, color2, fu);
vec3 average2 = mix(color1, color3, fu);
vec3 color = mix(average1, average2, fv);
#else
vec3 color = texture2D(projectedMap, coord).rgb;
#endif
return color;
}
vec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {
float currentLod = floor(lod + 0.5);
float nextLod = min(currentLod + 1.0, maxLod);
vec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);
vec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);
return mix(colorNextLod, colorCurrentLod, nextLod - lod);
}
`;var YU=`vec3 czm_saturation(vec3 rgb, float adjustment)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 intensity = vec3(dot(rgb, W));
return mix(intensity, rgb, adjustment);
}
`;var XU=`float czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)
{
return czm_unpackDepth(textureCube(shadowMap, d));
}
float czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)
{
#ifdef USE_SHADOW_DEPTH_TEXTURE
return texture2D(shadowMap, uv).r;
#else
return czm_unpackDepth(texture2D(shadowMap, uv));
#endif
}
float czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
float czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
`;var jU=`float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)
{
#ifdef USE_NORMAL_SHADING
#ifdef USE_NORMAL_SHADING_SMOOTH
float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);
#else
float strength = step(0.0, nDotL);
#endif
visibility *= strength;
#endif
visibility = max(visibility, darkness);
return visibility;
}
#ifdef USE_CUBE_MAP_SHADOW
float czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec3 uvw = shadowParameters.texCoords;
depth -= depthBias;
float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#else
float czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec2 uv = shadowParameters.texCoords;
depth -= depthBias;
#ifdef USE_SOFT_SHADOWS
vec2 texelStepSize = shadowParameters.texelStepSize;
float radius = 1.0;
float dx0 = -texelStepSize.x * radius;
float dy0 = -texelStepSize.y * radius;
float dx1 = texelStepSize.x * radius;
float dy1 = texelStepSize.y * radius;
float visibility = (
czm_shadowDepthCompare(shadowMap, uv, depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)
) * (1.0 / 9.0);
#else
float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);
#endif
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#endif
`;var KU=`float czm_signNotZero(float value)
{
return value >= 0.0 ? 1.0 : -1.0;
}
vec2 czm_signNotZero(vec2 value)
{
return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));
}
vec3 czm_signNotZero(vec3 value)
{
return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));
}
vec4 czm_signNotZero(vec4 value)
{
return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));
}
`;var ZU=`vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])
{
vec3 L00 = coefficients[0];
vec3 L1_1 = coefficients[1];
vec3 L10 = coefficients[2];
vec3 L11 = coefficients[3];
vec3 L2_2 = coefficients[4];
vec3 L2_1 = coefficients[5];
vec3 L20 = coefficients[6];
vec3 L21 = coefficients[7];
vec3 L22 = coefficients[8];
float x = normal.x;
float y = normal.y;
float z = normal.z;
return
L00
+ L1_1 * y
+ L10 * z
+ L11 * x
+ L2_2 * (y * x)
+ L2_1 * (y * z)
+ L20 * (3.0 * z * z - 1.0)
+ L21 * (z * x)
+ L22 * (x * x - y * y);
}
`;var QU=`vec3 czm_srgbToLinear(vec3 srgbIn)
{
return pow(srgbIn, vec3(2.2));
}
vec4 czm_srgbToLinear(vec4 srgbIn)
{
vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
return vec4(linearOut, srgbIn.a);
}
`;var JU=`mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)
{
vec3 normal = normalize(normalEC);
vec3 tangent = normalize(tangentEC);
vec3 bitangent = normalize(bitangentEC);
return mat3(tangent.x  , tangent.y  , tangent.z,
bitangent.x, bitangent.y, bitangent.z,
normal.x   , normal.y   , normal.z);
}
`;var $U=`vec4 czm_transformPlane(vec4 plane, mat4 transform) {
vec4 transformedPlane = transform * plane;
float normalMagnitude = length(transformedPlane.xyz);
return transformedPlane / normalMagnitude;
}
`;var e6=`vec4 czm_transformPlaneOld(vec4 clippingPlane, mat4 transform) {
vec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);
vec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;
vec4 transformedPlane;
transformedPlane.xyz = transformedDirection;
transformedPlane.w = -dot(transformedDirection, transformedPosition);
return transformedPlane;
}
`;var t6=`vec4 czm_translateRelativeToEye(vec3 high, vec3 low)
{
vec3 highDifference = high - czm_encodedCameraPositionMCHigh;
vec3 lowDifference = low - czm_encodedCameraPositionMCLow;
return vec4(highDifference + lowDifference, 1.0);
}
`;var n6=`vec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);
}
diffuse = clamp(diffuse, 0.0, 1.0);
float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_translucentPhong(vec3 toEye, czm_material material)
{
return czm_translucentPhong(toEye, material, czm_lightDirectionEC);
}
`;var r6=`mat2 czm_transpose(mat2 matrix)
{
return mat2(
matrix[0][0], matrix[1][0],
matrix[0][1], matrix[1][1]);
}
mat3 czm_transpose(mat3 matrix)
{
return mat3(
matrix[0][0], matrix[1][0], matrix[2][0],
matrix[0][1], matrix[1][1], matrix[2][1],
matrix[0][2], matrix[1][2], matrix[2][2]);
}
mat4 czm_transpose(mat4 matrix)
{
return mat4(
matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],
matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],
matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],
matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);
}
`;var i6=`float czm_unpackDepth(vec4 packedDepth)
{
return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));
}
`;var o6=`float czm_unpackFloat(vec4 packedFloat)
{
packedFloat = floor(packedFloat * 255.0 + 0.5);
float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;
float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;
if (exponent == -127.0)
{
return 0.0;
}
float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);
float result = sign * exp2(exponent - 23.0) * mantissa;
return result;
}
`;var a6=`int czm_unpackUint(float packedValue) {
float rounded = czm_round(packedValue * 255.0);
return int(rounded);
}
int czm_unpackUint(vec2 packedValue) {
vec2 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec2(1.0, 256.0)));
}
int czm_unpackUint(vec3 packedValue) {
vec3 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));
}
int czm_unpackUint(vec4 packedValue) {
vec4 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));
}
`;var s6=`float czm_valueTransform(float offset, float scale, float value) {
return scale * value + offset;
}
vec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {
return scale * value + offset;
}
vec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {
return scale * value + offset;
}
vec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {
return scale * value + offset;
}
mat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {
return matrixCompMult(scale, value) + offset;
}
mat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {
return matrixCompMult(scale, value) + offset;
}
mat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {
return matrixCompMult(scale, value) + offset;
}
`;var u6=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef SHADOW_MAP
varying vec3 v_logPositionEC;
#endif
#endif
vec4 czm_updatePositionDepth(vec4 coords) {
#if defined(LOG_DEPTH)
#ifdef SHADOW_MAP
vec3 logPositionEC = (czm_inverseProjection * coords).xyz;
v_logPositionEC = logPositionEC;
#endif
coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;
#endif
return coords;
}
void czm_vertexLogDepth()
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;
gl_Position = czm_updatePositionDepth(gl_Position);
#endif
}
void czm_vertexLogDepth(vec4 clipCoords)
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;
czm_updatePositionDepth(clipCoords);
#endif
}
`;var l6=`vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)
{
float x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;
float y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;
float z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
vec4 q = vec4(x, y, z, 1.0);
q /= fragmentCoordinate.w;
if (!(czm_inverseProjection == mat4(0.0)))
{
q = czm_inverseProjection * q;
}
else
{
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
q.x = (q.x * (right - left) + left + right) * 0.5;
q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
q.z = (q.z * (near - far) - near - far) * 0.5;
q.w = 1.0;
}
return q;
}
vec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
float depthFromCamera = depthFromNear + near;
vec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
eyeCoordinate.w = 1.0 / depthFromCamera;
return eyeCoordinate;
#else
vec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
#endif
return eyeCoordinate;
}
`;var c6=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
void czm_writeDepthClamp()
{
#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
gl_FragDepthEXT = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);
#endif
}
`;var f6=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef POLYGON_OFFSET
uniform vec2 u_polygonOffset;
#endif
#endif
void czm_writeLogDepth(float depth)
{
#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH)
if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {
discard;
}
#ifdef POLYGON_OFFSET
float factor = u_polygonOffset[0];
float units = u_polygonOffset[1];
#ifdef GL_OES_standard_derivatives
float x = dFdx(depth);
float y = dFdy(depth);
float m = sqrt(x * x + y * y);
depth += m * factor;
#endif
#endif
gl_FragDepthEXT = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;
#ifdef POLYGON_OFFSET
gl_FragDepthEXT += czm_epsilon7 * units;
#endif
#endif
}
void czm_writeLogDepth() {
#ifdef LOG_DEPTH
czm_writeLogDepth(v_depthFromNearPlusOne);
#endif
}
`;var h6=`float czm_writeNonPerspective(float value, float w) {
return value * w;
}
vec2 czm_writeNonPerspective(vec2 value, float w) {
return value * w;
}
vec3 czm_writeNonPerspective(vec3 value, float w) {
return value * w;
}
vec4 czm_writeNonPerspective(vec4 value, float w) {
return value * w;
}
`;var d6=`vec3 czm_XYZToRGB(vec3 Yxy)
{
const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,
-1.5371,  1.8760, -0.2040,
-0.4985,  0.0416,  1.0572);
vec3 xyz;
xyz.r = Yxy.r * Yxy.g / Yxy.b;
xyz.g = Yxy.r;
xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;
return XYZ2RGB * xyz;
}
`;var lI={czm_degreesPerRadian:W8,czm_depthRange:Y8,czm_epsilon1:X8,czm_epsilon2:j8,czm_epsilon3:K8,czm_epsilon4:Z8,czm_epsilon5:Q8,czm_epsilon6:J8,czm_epsilon7:$8,czm_infinity:eG,czm_oneOverPi:tG,czm_oneOverTwoPi:nG,czm_passCesium3DTile:rG,czm_passCesium3DTileClassification:iG,czm_passCesium3DTileClassificationIgnoreShow:oG,czm_passClassification:aG,czm_passCompute:sG,czm_passEnvironment:uG,czm_passGlobe:lG,czm_passOpaque:cG,czm_passOverlay:fG,czm_passTerrainClassification:hG,czm_passTranslucent:dG,czm_pi:pG,czm_piOverFour:mG,czm_piOverSix:gG,czm_piOverThree:_G,czm_piOverTwo:yG,czm_radiansPerDegree:vG,czm_sceneMode2D:CG,czm_sceneMode3D:xG,czm_sceneModeColumbusView:wG,czm_sceneModeMorphing:EG,czm_solarRadius:TG,czm_threePiOver2:SG,czm_twoPi:AG,czm_webMercatorMaxLatitude:bG,czm_depthRangeStruct:IG,czm_material:DG,czm_materialInput:PG,czm_modelMaterial:MG,czm_modelVertexOutput:LG,czm_pbrParameters:RG,czm_ray:OG,czm_raySegment:NG,czm_shadowParameters:BG,czm_acesTonemapping:FG,czm_alphaWeight:zG,czm_antialias:VG,czm_approximateSphericalCoordinates:kG,czm_backFacing:GG,czm_branchFreeTernary:UG,czm_cascadeColor:HG,czm_cascadeDistance:qG,czm_cascadeMatrix:WG,czm_cascadeWeights:YG,czm_columbusViewMorph:XG,czm_computePosition:jG,czm_cosineAndSine:KG,czm_decompressTextureCoordinates:ZG,czm_defaultPbrMaterial:QG,czm_depthClamp:JG,czm_eastNorthUpToEyeCoordinates:$G,czm_ellipsoidContainsPoint:eU,czm_ellipsoidWgs84TextureCoordinates:tU,czm_equalsEpsilon:nU,czm_eyeOffset:rU,czm_eyeToWindowCoordinates:iU,czm_fastApproximateAtan:oU,czm_fog:aU,czm_gammaCorrect:sU,czm_geodeticSurfaceNormal:uU,czm_getDefaultMaterial:lU,czm_getLambertDiffuse:cU,czm_getSpecular:fU,czm_getWaterNoise:hU,czm_HSBToRGB:dU,czm_HSLToRGB:pU,czm_hue:mU,czm_inverseGamma:gU,czm_isEmpty:_U,czm_isFull:yU,czm_latitudeToWebMercatorFraction:vU,czm_linearToSrgb:CU,czm_lineDistance:xU,czm_luminance:wU,czm_metersPerPixel:EU,czm_modelToWindowCoordinates:TU,czm_multiplyWithColorBalance:SU,czm_nearFarScalar:AU,czm_octDecode:bU,czm_packDepth:IU,czm_pbrLighting:DU,czm_pbrMetallicRoughnessMaterial:PU,czm_pbrSpecularGlossinessMaterial:MU,czm_phong:LU,czm_planeDistance:RU,czm_pointAlongRay:OU,czm_rayEllipsoidIntersectionInterval:NU,czm_raySphereIntersectionInterval:BU,czm_readDepth:FU,czm_readNonPerspective:zU,czm_reverseLogDepth:VU,czm_RGBToHSB:kU,czm_RGBToHSL:GU,czm_RGBToXYZ:UU,czm_rollerShutter:HU,czm_round:qU,czm_sampleOctahedralProjection:WU,czm_saturation:YU,czm_shadowDepthCompare:XU,czm_shadowVisibility:jU,czm_signNotZero:KU,czm_sphericalHarmonics:ZU,czm_srgbToLinear:QU,czm_tangentToEyeSpaceMatrix:JU,czm_transformPlane:$U,czm_transformPlaneOld:e6,czm_translateRelativeToEye:t6,czm_translucentPhong:n6,czm_transpose:r6,czm_unpackDepth:i6,czm_unpackFloat:o6,czm_unpackUint:a6,czm_valueTransform:s6,czm_vertexLogDepth:u6,czm_windowToEyeCoordinates:l6,czm_writeDepthClamp:c6,czm_writeLogDepth:f6,czm_writeNonPerspective:h6,czm_XYZToRGB:d6};function p6(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(t){let n=t.match(/\n/gm).length,r="";for(let o=0;o<n;++o)r+=`
`;return r})}function m6(e,t,n){let r;for(let o=0;o<n.length;++o)n[o].name===e&&(r=n[o]);return g(r)||(t=p6(t),r={name:e,glslSource:t,dependsOn:[],requiredBy:[],evaluated:!1},n.push(r)),r}function g6(e,t){if(e.evaluated)return;e.evaluated=!0;let n=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);g(n)&&n!==null&&(n=n.filter(function(r,o){return n.indexOf(r)===o}),n.forEach(function(r){if(r!==e.name&&Js._czmBuiltinsAndUniforms.hasOwnProperty(r)){let o=m6(r,Js._czmBuiltinsAndUniforms[r],t);e.dependsOn.push(o),o.requiredBy.push(e),g6(o,t)}}))}function Yle(e){let t=[],n=[];for(;e.length>0;){let o=e.pop();n.push(o),o.requiredBy.length===0&&t.push(o)}for(;t.length>0;){let o=t.shift();e.push(o);for(let a=0;a<o.dependsOn.length;++a){let s=o.dependsOn[a],u=s.requiredBy.indexOf(o);s.requiredBy.splice(u,1),s.requiredBy.length===0&&t.push(s)}}let r=[];for(let o=0;o<n.length;++o)n[o].requiredBy.length!==0&&r.push(n[o])}function Xle(e){let t=[],n=m6("main",e,t);g6(n,t),Yle(t);let r="";for(let o=t.length-1;o>=0;--o)r=`${r+t[o].glslSource}
`;return r.replace(n.glslSource,"")}function _6(e,t,n){let r,o,a="",s=e.sources;if(g(s))for(r=0,o=s.length;r<o;++r)a+=`
#line 0
${s[r]}`;a=p6(a);let u;a=a.replace(/#version\s+(.*?)\n/gm,function(p,_){return u=_,`
`});let l=[];a=a.replace(/#extension.*\n/gm,function(p){return l.push(p),`
`}),a=a.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let c=e.pickColorQualifier;g(c)&&(a=Js.createPickFragmentShaderSource(a,c));let f="";g(u)&&(f=`#version ${u}
`);let h=l.length;for(r=0;r<h;r++)f+=l[r];t&&(f+=`#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    precision highp int;
#else
    precision mediump float;
    precision mediump int;
    #define highp mediump
#endif

`);let d=e.defines;if(g(d))for(r=0,o=d.length;r<o;++r){let p=d[r];p.length!==0&&(f+=`#define ${p}
`)}return n.webgl2&&(f+=`#define OUTPUT_DECLARATION

`),n.textureFloatLinear&&(f+=`#define OES_texture_float_linear

`),n.floatingPointTexture&&(f+=`#define OES_texture_float

`),e.includeBuiltIns&&(f+=Xle(a)),f+=`
#line 0
`,f+=a,n.webgl2&&(f=q8(f,t,!0)),f}function Js(e){e=T(e,T.EMPTY_OBJECT);let t=e.pickColorQualifier;this.defines=g(e.defines)?e.defines.slice(0):[],this.sources=g(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=T(e.includeBuiltIns,!0)}Js.prototype.clone=function(){return new Js({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};Js.replaceMain=function(e,t){return t=`void ${t}()`,e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};Js.prototype.createCombinedVertexShader=function(e){return _6(this,!1,e)};Js.prototype.createCombinedFragmentShader=function(e){return _6(this,!0,e)};Js._czmBuiltinsAndUniforms={};for(let e in lI)lI.hasOwnProperty(e)&&(Js._czmBuiltinsAndUniforms[e]=lI[e]);for(let e in cC)if(cC.hasOwnProperty(e)){let t=cC[e];typeof t.getDeclaration=="function"&&(Js._czmBuiltinsAndUniforms[e]=t.getDeclaration(e))}Js.createPickVertexShaderSource=function(e){return`${Js.replaceMain(e,"czm_old_main")}
attribute vec4 pickColor; 
varying vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    czm_pickColor = pickColor; 
}`};Js.createPickFragmentShaderSource=function(e,t){let n=Js.replaceMain(e,"czm_old_main"),r=`${t} vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    if (gl_FragColor.a == 0.0) { 
       discard; 
    } 
    gl_FragColor = czm_pickColor; 
}`;return`${n}
${r}`};function jle(e,t){let n=e.defines,r=n.length;for(let o=0;o<r;++o)if(n[o]===t)return!0;return!1}function y6(e,t){let n=e.sources,r=n.length;for(let o=0;o<r;++o)if(n[o].indexOf(t)!==-1)return!0;return!1}function v6(e,t){let n=t.length;for(let r=0;r<n;++r){let o=t[r];if(y6(e,o))return o}}var Kle=["v_normalEC","v_normal"];Js.findNormalVarying=function(e){return y6(e,"#ifdef HAS_NORMALS")?jle(e,"HAS_NORMALS")?"v_normalEC":void 0:v6(e,Kle)};var Zle=["v_positionEC"];Js.findPositionVarying=function(e){return v6(e,Zle)};var Et=Js;var Qle={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},O_=Object.freeze(Qle);function xN(e){e=T(e,T.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=T(e.primitiveType,sn.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=T(e.geometryType,O_.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}xN.computeNumberOfVertices=function(e){let t=-1;for(let n in e.attributes)if(e.attributes.hasOwnProperty(n)&&g(e.attributes[n])&&g(e.attributes[n].values)){let r=e.attributes[n];t=r.values.length/r.componentsPerAttribute}return t};var Jle=new le,$le=new x,C6=new G,ece=[new le,new le,new le],tce=[new X,new X,new X],nce=[new X,new X,new X],rce=new x,ice=new je,oce=new G,ace=new Ra;xN._textureCoordinateRotationPoints=function(e,t,n,r){let o,a=hn.center(r,Jle),s=le.toCartesian(a,n,$le),u=Cn.eastNorthUpToFixedFrame(s,n,C6),l=G.inverse(u,C6),c=tce,f=ece;f[0].longitude=r.west,f[0].latitude=r.south,f[1].longitude=r.west,f[1].latitude=r.north,f[2].longitude=r.east,f[2].latitude=r.south;let h=rce;for(o=0;o<3;o++)le.toCartesian(f[o],n,h),h=G.multiplyByPointAsVector(l,h,h),c[o].x=h.x,c[o].y=h.y;let d=je.fromAxisAngle(x.UNIT_Z,-t,ice),p=te.fromQuaternion(d,oce),_=e.length,y=Number.POSITIVE_INFINITY,v=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY,C=Number.NEGATIVE_INFINITY;for(o=0;o<_;o++)h=G.multiplyByPointAsVector(l,e[o],h),h=te.multiplyByVector(p,h,h),y=Math.min(y,h.x),v=Math.min(v,h.y),w=Math.max(w,h.x),C=Math.max(C,h.y);let E=Ra.fromRotation(t,ace),S=nce;S[0].x=y,S[0].y=v,S[1].x=y,S[1].y=C,S[2].x=w,S[2].y=v;let A=c[0],D=c[2].x-A.x,P=c[1].y-A.y;for(o=0;o<3;o++){let I=S[o];Ra.multiplyByVector(E,I,I),I.x=(I.x-A.x)/D,I.y=(I.y-A.y)/P}let M=S[0],b=S[1],O=S[2],m=new Array(6);return X.pack(M,m),X.pack(b,m,2),X.pack(O,m,4),m};var Ei=xN;function sce(e,t,n,r){let o=g(t.vertexBuffer),a=g(t.value),s=t.value?t.value.length:t.componentsPerAttribute,u={index:T(t.index,n),enabled:T(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:a?t.value.slice(0):void 0,componentsPerAttribute:s,componentDatatype:T(t.componentDatatype,ie.FLOAT),normalize:T(t.normalize,!1),offsetInBytes:T(t.offsetInBytes,0),strideInBytes:T(t.strideInBytes,0),instanceDivisor:T(t.instanceDivisor,0)};if(o)u.vertexAttrib=function(l){let c=this.index;l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),l.vertexAttribPointer(c,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),l.enableVertexAttribArray(c),this.instanceDivisor>0&&(r.glVertexAttribDivisor(c,this.instanceDivisor),r._vertexAttribDivisors[c]=this.instanceDivisor,r._previousDrawInstanced=!0)},u.disableVertexAttribArray=function(l){l.disableVertexAttribArray(this.index),this.instanceDivisor>0&&r.glVertexAttribDivisor(n,0)};else{switch(u.componentsPerAttribute){case 1:u.vertexAttrib=function(l){l.vertexAttrib1fv(this.index,this.value)};break;case 2:u.vertexAttrib=function(l){l.vertexAttrib2fv(this.index,this.value)};break;case 3:u.vertexAttrib=function(l){l.vertexAttrib3fv(this.index,this.value)};break;case 4:u.vertexAttrib=function(l){l.vertexAttrib4fv(this.index,this.value)};break}u.disableVertexAttribArray=function(l){}}e.push(u)}function w6(e,t,n){for(let r=0;r<t.length;++r){let o=t[r];o.enabled&&o.vertexAttrib(e)}g(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function Sm(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=t._gl,r=e.attributes,o=e.indexBuffer,a,s=[],u=1,l=!1,c=!1,f=r.length;for(a=0;a<f;++a)sce(s,r[a],a,t);for(f=s.length,a=0;a<f;++a){let d=s[a];if(g(d.vertexBuffer)&&d.instanceDivisor===0){let p=d.strideInBytes||d.componentsPerAttribute*ie.getSizeInBytes(d.componentDatatype);u=d.vertexBuffer.sizeInBytes/p;break}}for(a=0;a<f;++a)s[a].instanceDivisor>0&&(l=!0),g(s[a].value)&&(c=!0);let h;t.vertexArrayObject&&(h=t.glCreateVertexArray(),t.glBindVertexArray(h),w6(n,s,o),t.glBindVertexArray(null)),this._numberOfVertices=u,this._hasInstancedAttributes=l,this._hasConstantAttributes=c,this._context=t,this._gl=n,this._vao=h,this._attributes=s,this._indexBuffer=o}function x6(e){return e.values.length/e.componentsPerAttribute}function uce(e){return ie.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function lce(e){let t,n,r,o=[];for(n in e)e.hasOwnProperty(n)&&g(e[n])&&g(e[n].values)&&(o.push(n),e[n].componentDatatype===ie.DOUBLE&&(e[n].componentDatatype=ie.FLOAT,e[n].values=ie.createTypedArray(ie.FLOAT,e[n].values)));let a,s=o.length;if(s>0)for(a=x6(e[o[0]]),t=1;t<s;++t){let c=x6(e[o[t]]);if(c!==a)throw new at(`Each attribute list must have the same number of vertices.  Attribute ${o[t]} has a different number of vertices (${c.toString()}) than attribute ${o[0]} (${a.toString()}).`)}o.sort(function(c,f){return ie.getSizeInBytes(e[f].componentDatatype)-ie.getSizeInBytes(e[c].componentDatatype)});let u=0,l={};for(t=0;t<s;++t)n=o[t],r=e[n],l[n]=u,u+=uce(r);if(u>0){let c=ie.getSizeInBytes(e[o[0]].componentDatatype),f=u%c;f!==0&&(u+=c-f);let h=a*u,d=new ArrayBuffer(h),p={};for(t=0;t<s;++t){n=o[t];let _=ie.getSizeInBytes(e[n].componentDatatype);p[n]={pointer:ie.createTypedArray(e[n].componentDatatype,d),index:l[n]/_,strideInComponentType:u/_}}for(t=0;t<a;++t)for(let _=0;_<s;++_){n=o[_],r=e[n];let y=r.values,v=p[n],w=v.pointer,C=r.componentsPerAttribute;for(let E=0;E<C;++E)w[v.index+E]=y[t*C+E];v.index+=v.strideInComponentType}return{buffer:d,offsetsInBytes:l,vertexSizeInBytes:u}}}Sm.fromGeometry=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=T(e.geometry,T.EMPTY_OBJECT),r=T(e.bufferUsage,We.DYNAMIC_DRAW),o=T(e.attributeLocations,T.EMPTY_OBJECT),a=T(e.interleave,!1),s=e.vertexArrayAttributes,u,l,c,f=g(s)?s:[],h=n.attributes;if(a){let _=lce(h);if(g(_)){c=Ui.createVertexBuffer({context:t,typedArray:_.buffer,usage:r});let y=_.offsetsInBytes,v=_.vertexSizeInBytes;for(u in h)h.hasOwnProperty(u)&&g(h[u])&&(l=h[u],g(l.values)?f.push({index:o[u],vertexBuffer:c,componentDatatype:l.componentDatatype,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize,offsetInBytes:y[u],strideInBytes:v}):f.push({index:o[u],value:l.value,componentDatatype:l.componentDatatype,normalize:l.normalize}))}}else for(u in h)if(h.hasOwnProperty(u)&&g(h[u])){l=h[u];let _=l.componentDatatype;_===ie.DOUBLE&&(_=ie.FLOAT),c=void 0,g(l.values)&&(c=Ui.createVertexBuffer({context:t,typedArray:ie.createTypedArray(_,l.values),usage:r})),f.push({index:o[u],vertexBuffer:c,value:l.value,componentDatatype:_,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize})}let d,p=n.indices;return g(p)&&(Ei.computeNumberOfVertices(n)>=F.SIXTY_FOUR_KILOBYTES&&t.elementIndexUint?d=Ui.createIndexBuffer({context:t,typedArray:new Uint32Array(p),usage:r,indexDatatype:Or.UNSIGNED_INT}):d=Ui.createIndexBuffer({context:t,typedArray:new Uint16Array(p),usage:r,indexDatatype:Or.UNSIGNED_SHORT})),new Sm({context:t,attributes:f,indexBuffer:d})};Object.defineProperties(Sm.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});Sm.prototype.getAttribute=function(e){return this._attributes[e]};function cce(e){let t=e._context,n=e._hasInstancedAttributes;if(!n&&!t._previousDrawInstanced)return;t._previousDrawInstanced=n;let r=t._vertexAttribDivisors,o=e._attributes,a=Jt.maximumVertexAttributes,s;if(n){let u=o.length;for(s=0;s<u;++s){let l=o[s];if(l.enabled){let c=l.instanceDivisor,f=l.index;c!==r[f]&&(t.glVertexAttribDivisor(f,c),r[f]=c)}}}else for(s=0;s<a;++s)r[s]>0&&(t.glVertexAttribDivisor(s,0),r[s]=0)}function fce(e,t){let n=e._attributes,r=n.length;for(let o=0;o<r;++o){let a=n[o];a.enabled&&g(a.value)&&a.vertexAttrib(t)}}Sm.prototype._bind=function(){g(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&cce(this),this._hasConstantAttributes&&fce(this,this._gl)):w6(this._gl,this._attributes,this._indexBuffer)};Sm.prototype._unBind=function(){if(g(this._vao))this._context.glBindVertexArray(null);else{let e=this._attributes,t=this._gl;for(let n=0;n<e.length;++n){let r=e[n];r.enabled&&r.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}};Sm.prototype.isDestroyed=function(){return!1};Sm.prototype.destroy=function(){let e=this._attributes;for(let n=0;n<e.length;++n){let r=e[n].vertexBuffer;g(r)&&!r.isDestroyed()&&r.vertexArrayDestroyable&&r.destroy()}let t=this._indexBuffer;return g(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),g(this._vao)&&this._context.glDeleteVertexArray(this._vao),st(this)};var $h=Sm;function Ls(e,t,n,r){let o=Ls._verifyAttributes(t);n=T(n,0);let a=[],s={},u,l,c=o.length;for(let h=0;h<c;++h){let d=o[h];if(d.vertexBuffer){a.push(d);continue}l=d.usage,u=s[l],g(u)||(u=s[l]=[]),u.push(d)}function f(h,d){return ie.getSizeInBytes(d.componentDatatype)-ie.getSizeInBytes(h.componentDatatype)}this._allBuffers=[];for(l in s)if(s.hasOwnProperty(l)){u=s[l],u.sort(f);let h=Ls._vertexSizeInBytes(u),d=u[0].usage,p={vertexSizeInBytes:h,vertexBuffer:void 0,usage:d,needsCommit:!1,arrayBuffer:void 0,arrayViews:Ls._createArrayViews(u,h)};this._allBuffers.push(p)}this._size=0,this._instanced=T(r,!1),this._precreated=a,this._context=e,this.writers=void 0,this.va=void 0,this.resize(n)}Ls._verifyAttributes=function(e){let t=[];for(let r=0;r<e.length;++r){let o=e[r],a={index:T(o.index,r),enabled:T(o.enabled,!0),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:T(o.componentDatatype,ie.FLOAT),normalize:T(o.normalize,!1),vertexBuffer:o.vertexBuffer,usage:T(o.usage,We.STATIC_DRAW)};t.push(a)}let n=new Array(t.length);for(let r=0;r<t.length;++r){let a=t[r].index;n[a]=!0}return t};Ls._vertexSizeInBytes=function(e){let t=0,n=e.length;for(let s=0;s<n;++s){let u=e[s];t+=u.componentsPerAttribute*ie.getSizeInBytes(u.componentDatatype)}let r=n>0?ie.getSizeInBytes(e[0].componentDatatype):0,o=r>0?t%r:0;return t+=o===0?0:r-o,t};Ls._createArrayViews=function(e,t){let n=[],r=0,o=e.length;for(let a=0;a<o;++a){let s=e[a],u=s.componentDatatype;n.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:u,normalize:s.normalize,offsetInBytes:r,vertexSizeInComponentType:t/ie.getSizeInBytes(u),view:void 0}),r+=s.componentsPerAttribute*ie.getSizeInBytes(u)}return n};Ls.prototype.resize=function(e){this._size=e;let t=this._allBuffers;this.writers=[];for(let n=0,r=t.length;n<r;++n){let o=t[n];Ls._resize(o,this._size),Ls._appendWriters(this.writers,o)}wN(this)};Ls._resize=function(e,t){if(e.vertexSizeInBytes>0){let n=new ArrayBuffer(t*e.vertexSizeInBytes);if(g(e.arrayBuffer)){let a=new Uint8Array(n),s=new Uint8Array(e.arrayBuffer),u=s.length;for(let l=0;l<u;++l)a[l]=s[l]}let r=e.arrayViews,o=r.length;for(let a=0;a<o;++a){let s=r[a];s.view=ie.createArrayBufferView(s.componentDatatype,n,s.offsetInBytes)}e.arrayBuffer=n}};var hce=[function(e,t,n){return function(r,o){t[r*n]=o,e.needsCommit=!0}},function(e,t,n){return function(r,o,a){let s=r*n;t[s]=o,t[s+1]=a,e.needsCommit=!0}},function(e,t,n){return function(r,o,a,s){let u=r*n;t[u]=o,t[u+1]=a,t[u+2]=s,e.needsCommit=!0}},function(e,t,n){return function(r,o,a,s,u){let l=r*n;t[l]=o,t[l+1]=a,t[l+2]=s,t[l+3]=u,e.needsCommit=!0}}];Ls._appendWriters=function(e,t){let n=t.arrayViews,r=n.length;for(let o=0;o<r;++o){let a=n[o];e[a.index]=hce[a.componentsPerAttribute-1](t,a.view,a.vertexSizeInComponentType)}};Ls.prototype.commit=function(e){let t=!1,n=this._allBuffers,r,o,a;for(o=0,a=n.length;o<a;++o)r=n[o],t=dce(this,r)||t;if(t||!g(this.va)){wN(this);let s=this.va=[],u=F.SIXTY_FOUR_KILOBYTES-4,l=g(e)&&!this._instanced?Math.ceil(this._size/u):1;for(let c=0;c<l;++c){let f=[];for(o=0,a=n.length;o<a;++o){r=n[o];let h=c*(r.vertexSizeInBytes*u);Ls._appendAttributes(f,r,h,this._instanced)}f=f.concat(this._precreated),s.push({va:new $h({context:this._context,attributes:f,indexBuffer:e}),indicesCount:1.5*(c!==l-1?u:this._size%u)})}}};function dce(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;let n=t.vertexBuffer,r=e._size*t.vertexSizeInBytes,o=g(n);if(!o||n.sizeInBytes<r)return o&&n.destroy(),t.vertexBuffer=Ui.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}Ls._appendAttributes=function(e,t,n,r){let o=t.arrayViews,a=o.length;for(let s=0;s<a;++s){let u=o[s];e.push({index:u.index,enabled:u.enabled,componentsPerAttribute:u.componentsPerAttribute,componentDatatype:u.componentDatatype,normalize:u.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:n+u.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:r?1:0})}};Ls.prototype.subCommit=function(e,t){let n=this._allBuffers;for(let r=0,o=n.length;r<o;++r)pce(n[r],e,t)};function pce(e,t,n){if(e.needsCommit&&e.vertexSizeInBytes>0){let r=e.vertexSizeInBytes*t,o=e.vertexSizeInBytes*n;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,r,o),r)}}Ls.prototype.endSubCommits=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t)e[t].needsCommit=!1};function wN(e){let t=e.va;if(!g(t))return;let n=t.length;for(let r=0;r<n;++r)t[r].va.destroy();e.va=void 0}Ls.prototype.isDestroyed=function(){return!1};Ls.prototype.destroy=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t){let r=e[t];r.vertexBuffer=r.vertexBuffer&&r.vertexBuffer.destroy()}return wN(this),st(this)};var fC=Ls;var cI=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform sampler2D u_atlas;
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_textureCoordinates;
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
float getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)
{
vec2 lookupVector = imageSize * (depthLookupST - adjustedST);
lookupVector = v_rotationMatrix * lookupVector;
vec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y));
vec2 translation = v_originTextureCoordinateAndTranslate.zw;
if (applyTranslate)
{
translation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));
}
vec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st));
if (logDepthOrDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
#ifdef SDF
float getDistance(vec2 position)
{
return texture2D(u_atlas, position).r;
}
vec4 getSDFColor(vec2 position, float outlineWidth, vec4 outlineColor, float smoothing)
{
float distance = getDistance(position);
if (outlineWidth > 0.0)
{
float outlineEdge = clamp(SDF_EDGE - outlineWidth, 0.0, SDF_EDGE);
float outlineFactor = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
vec4 sdfColor = mix(outlineColor, v_color, outlineFactor);
float alpha = smoothstep(outlineEdge - smoothing, outlineEdge + smoothing, distance);
return vec4(sdfColor.rgb, sdfColor.a * alpha);
}
else
{
float alpha = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
return vec4(v_color.rgb, v_color.a * alpha);
}
}
#endif
void main()
{
vec4 color = texture2D(u_atlas, v_textureCoordinates);
#ifdef SDF
float outlineWidth = v_outlineWidth;
vec4 outlineColor = v_outlineColor;
float distance = getDistance(v_textureCoordinates);
#ifdef GL_OES_standard_derivatives
float smoothing = fwidth(distance);
vec2 sampleOffset = 0.354 * vec2(dFdx(v_textureCoordinates) + dFdy(v_textureCoordinates));
vec4 center = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
vec4 color1 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color2 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color3 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color4 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
color = (center + color1 + color2 + color3 + color4)/5.0;
#else
float smoothing = 1.0/32.0;
color = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
#endif
color = czm_gammaCorrect(color);
#else
color = czm_gammaCorrect(color);
color *= czm_gammaCorrect(v_color);
#endif
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
#ifdef VECTOR_TILE
color *= u_highlightColor;
#endif
gl_FragColor = color;
#ifdef LOG_DEPTH
czm_writeLogDepth();
#endif
#ifdef FRAGMENT_DEPTH_CHECK
float temp = v_compressed.y;
temp = temp * SHIFT_RIGHT1;
float temp2 = (temp - floor(temp)) * SHIFT_LEFT1;
bool enableDepthTest = temp2 != 0.0;
bool applyTranslate = floor(temp) != 0.0;
if (enableDepthTest) {
temp = v_compressed.z;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
temp = v_compressed.w;
temp = temp * SHIFT_RIGHT12;
vec2 imageSize;
imageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;
imageSize.x = floor(temp);
vec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;
adjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);
float epsilonEyeDepth = v_compressed.x + czm_epsilon1;
float globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);
if (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)
{
float globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)
{
float globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)
{
discard;
}
}
}
}
#endif
}
`;var fI=`#ifdef INSTANCED
attribute vec2 direction;
#endif
attribute vec4 positionHighAndScale;
attribute vec4 positionLowAndRotation;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 compressedAttribute2;
attribute vec4 eyeOffset;
attribute vec4 scaleByDistance;
attribute vec4 pixelOffsetScaleByDistance;
attribute vec4 compressedAttribute3;
attribute vec2 sdf;
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
attribute vec4 textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef VECTOR_TILE
attribute float a_batchId;
#endif
varying vec2 v_textureCoordinates;
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
#endif
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
const float UPPER_BOUND = 32768.0;
const float SHIFT_LEFT16 = 65536.0;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_LEFT7 = 128.0;
const float SHIFT_LEFT5 = 32.0;
const float SHIFT_LEFT3 = 8.0;
const float SHIFT_LEFT2 = 4.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
const float SHIFT_RIGHT7 = 1.0 / 128.0;
const float SHIFT_RIGHT5 = 1.0 / 32.0;
const float SHIFT_RIGHT3 = 1.0 / 8.0;
const float SHIFT_RIGHT2 = 1.0 / 4.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
{
vec2 halfSize = imageSize * scale * 0.5;
halfSize *= ((direction * 2.0) - 1.0);
vec2 originTranslate = origin * abs(halfSize);
#if defined(ROTATION) || defined(ALIGNED_AXIS)
if (validAlignedAxis || rotation != 0.0)
{
float angle = rotation;
if (validAlignedAxis)
{
vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);
angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
(projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
}
float cosTheta = cos(angle);
float sinTheta = sin(angle);
rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
halfSize = rotationMatrix * halfSize;
}
else
{
rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
}
#endif
mpp = czm_metersPerPixel(positionEC);
positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
positionEC.xy += (translate + pixelOffset) * mpp;
return positionEC;
}
#ifdef VERTEX_DEPTH_CHECK
float getGlobeDepth(vec4 positionEC)
{
vec4 posWC = czm_eyeToWindowCoordinates(positionEC);
float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));
if (globeDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(posWC.xy, globeDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
void main()
{
vec3 positionHigh = positionHighAndScale.xyz;
vec3 positionLow = positionLowAndRotation.xyz;
float scale = positionHighAndScale.w;
#if defined(ROTATION) || defined(ALIGNED_AXIS)
float rotation = positionLowAndRotation.w;
#else
float rotation = 0.0;
#endif
float compressed = compressedAttribute0.x;
vec2 pixelOffset;
pixelOffset.x = floor(compressed * SHIFT_RIGHT7);
compressed -= pixelOffset.x * SHIFT_LEFT7;
pixelOffset.x -= UPPER_BOUND;
vec2 origin;
origin.x = floor(compressed * SHIFT_RIGHT5);
compressed -= origin.x * SHIFT_LEFT5;
origin.y = floor(compressed * SHIFT_RIGHT3);
compressed -= origin.y * SHIFT_LEFT3;
#ifdef FRAGMENT_DEPTH_CHECK
vec2 depthOrigin = origin.xy;
#endif
origin -= vec2(1.0);
float show = floor(compressed * SHIFT_RIGHT2);
compressed -= show * SHIFT_LEFT2;
#ifdef INSTANCED
vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);
vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);
vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;
#else
vec2 direction;
direction.x = floor(compressed * SHIFT_RIGHT1);
direction.y = compressed - direction.x * SHIFT_LEFT1;
vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);
#endif
float temp = compressedAttribute0.y  * SHIFT_RIGHT8;
pixelOffset.y = -(floor(temp) - UPPER_BOUND);
vec2 translate;
translate.y = (temp - floor(temp)) * SHIFT_LEFT16;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
translate.x = floor(temp) - UPPER_BOUND;
translate.y += (temp - floor(temp)) * SHIFT_LEFT8;
translate.y -= UPPER_BOUND;
temp = compressedAttribute1.x * SHIFT_RIGHT8;
float temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);
vec2 imageSize = vec2(floor(temp), temp2);
#ifdef FRAGMENT_DEPTH_CHECK
float labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));
float applyTranslate = 0.0;
if (labelHorizontalOrigin != 0.0)
{
applyTranslate = 1.0;
labelHorizontalOrigin -= 2.0;
depthOrigin.x = labelHorizontalOrigin + 1.0;
}
depthOrigin = vec2(1.0) - (depthOrigin * 0.5);
#endif
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
temp = compressedAttribute3.w;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
#endif
#ifdef ALIGNED_AXIS
vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));
temp = compressedAttribute2.z * SHIFT_RIGHT5;
bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;
#else
vec3 alignedAxis = vec3(0.0);
bool validAlignedAxis = false;
#endif
vec4 pickColor;
vec4 color;
temp = compressedAttribute2.y;
temp = temp * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute2.x;
temp = temp * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute2.z * SHIFT_RIGHT8;
bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)
float eyeDepth = positionEC.z;
#endif
positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);
positionEC.xyz *= show;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);
scale *= distanceScale;
translate *= distanceScale;
if (scale == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef EYE_DISTANCE_PIXEL_OFFSET
float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);
pixelOffset *= pixelOffsetScale;
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = compressedAttribute3.x;
float farSq = compressedAttribute3.y;
if (lengthSq < nearSq || lengthSq > farSq)
{
positionEC.xyz = vec3(0.0);
}
#endif
mat2 rotationMatrix;
float mpp;
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = compressedAttribute3.z;
#endif
#ifdef VERTEX_DEPTH_CHECK
if (lengthSq < disableDepthTestDistance) {
float depthsilon = 10.0;
vec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;
vec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth1 = getGlobeDepth(pEC1);
if (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)
{
vec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth2 = getGlobeDepth(pEC2);
if (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)
{
vec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth3 = getGlobeDepth(pEC3);
if (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)
{
positionEC.xyz = vec3(0.0);
}
}
}
}
#endif
positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
gl_Position = czm_projection * positionEC;
v_textureCoordinates = textureCoordinates;
#ifdef LOG_DEPTH
czm_vertexLogDepth();
#endif
#ifdef DISABLE_DEPTH_DISTANCE
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = 1.0;
#endif
}
}
#endif
#ifdef FRAGMENT_DEPTH_CHECK
if (sizeInMeters) {
translate /= mpp;
dimensions /= mpp;
imageSize /= mpp;
}
#if defined(ROTATION) || defined(ALIGNED_AXIS)
v_rotationMatrix = rotationMatrix;
#else
v_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
#endif
float enableDepthCheck = 0.0;
if (lengthSq < disableDepthTestDistance)
{
enableDepthCheck = 1.0;
}
float dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));
float dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));
float iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));
float ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));
v_compressed.x = eyeDepth;
v_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;
v_compressed.z = dw * SHIFT_LEFT12 + dh;
v_compressed.w = iw * SHIFT_LEFT12 + ih;
v_originTextureCoordinateAndTranslate.xy = depthOrigin;
v_originTextureCoordinateAndTranslate.zw = translate;
v_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef SDF
vec4 outlineColor;
float outlineWidth;
temp = sdf.x;
temp = temp * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = sdf.y;
temp = temp * SHIFT_RIGHT8;
float temp3 = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineWidth = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.a = floor(temp);
outlineColor /= 255.0;
v_outlineWidth = outlineWidth / 255.0;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency;
#endif
v_pickColor = pickColor;
v_color = color;
v_color.a *= translucency;
}
`;var mce={ADD:k.FUNC_ADD,SUBTRACT:k.FUNC_SUBTRACT,REVERSE_SUBTRACT:k.FUNC_REVERSE_SUBTRACT,MIN:k.MIN,MAX:k.MAX},N_=Object.freeze(mce);var gce={ZERO:k.ZERO,ONE:k.ONE,SOURCE_COLOR:k.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:k.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:k.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:k.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:k.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:k.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:k.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:k.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:k.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:k.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:k.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:k.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:k.SRC_ALPHA_SATURATE},Yc=Object.freeze(gce);var _ce={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:N_.ADD,equationAlpha:N_.ADD,functionSourceRgb:Yc.SOURCE_ALPHA,functionSourceAlpha:Yc.ONE,functionDestinationRgb:Yc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Yc.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:N_.ADD,equationAlpha:N_.ADD,functionSourceRgb:Yc.ONE,functionSourceAlpha:Yc.ONE,functionDestinationRgb:Yc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Yc.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:N_.ADD,equationAlpha:N_.ADD,functionSourceRgb:Yc.SOURCE_ALPHA,functionSourceAlpha:Yc.ONE,functionDestinationRgb:Yc.ONE,functionDestinationAlpha:Yc.ONE})},ka=Object.freeze(_ce);var yce={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2},Nr=Object.freeze(yce);var vce={FONT_SIZE:48,PADDING:10,RADIUS:8,CUTOFF:.25},Rs=Object.freeze(vce);var Br={UNSIGNED_BYTE:k.UNSIGNED_BYTE,UNSIGNED_SHORT:k.UNSIGNED_SHORT,UNSIGNED_INT:k.UNSIGNED_INT,FLOAT:k.FLOAT,HALF_FLOAT:k.HALF_FLOAT_OES,UNSIGNED_INT_24_8:k.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:k.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:k.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:k.UNSIGNED_SHORT_5_6_5};Br.toWebGLConstant=function(e,t){switch(e){case Br.UNSIGNED_BYTE:return k.UNSIGNED_BYTE;case Br.UNSIGNED_SHORT:return k.UNSIGNED_SHORT;case Br.UNSIGNED_INT:return k.UNSIGNED_INT;case Br.FLOAT:return k.FLOAT;case Br.HALF_FLOAT:return t.webgl2?k.HALF_FLOAT:k.HALF_FLOAT_OES;case Br.UNSIGNED_INT_24_8:return k.UNSIGNED_INT_24_8;case Br.UNSIGNED_SHORT_4_4_4_4:return k.UNSIGNED_SHORT_4_4_4_4;case Br.UNSIGNED_SHORT_5_5_5_1:return k.UNSIGNED_SHORT_5_5_5_1;case Br.UNSIGNED_SHORT_5_6_5:return Br.UNSIGNED_SHORT_5_6_5}};Br.isPacked=function(e){return e===Br.UNSIGNED_INT_24_8||e===Br.UNSIGNED_SHORT_4_4_4_4||e===Br.UNSIGNED_SHORT_5_5_5_1||e===Br.UNSIGNED_SHORT_5_6_5};Br.sizeInBytes=function(e){switch(e){case Br.UNSIGNED_BYTE:return 1;case Br.UNSIGNED_SHORT:case Br.UNSIGNED_SHORT_4_4_4_4:case Br.UNSIGNED_SHORT_5_5_5_1:case Br.UNSIGNED_SHORT_5_6_5:case Br.HALF_FLOAT:return 2;case Br.UNSIGNED_INT:case Br.FLOAT:case Br.UNSIGNED_INT_24_8:return 4}};Br.validate=function(e){return e===Br.UNSIGNED_BYTE||e===Br.UNSIGNED_SHORT||e===Br.UNSIGNED_INT||e===Br.FLOAT||e===Br.HALF_FLOAT||e===Br.UNSIGNED_INT_24_8||e===Br.UNSIGNED_SHORT_4_4_4_4||e===Br.UNSIGNED_SHORT_5_5_5_1||e===Br.UNSIGNED_SHORT_5_6_5};var xt=Object.freeze(Br);var De={DEPTH_COMPONENT:k.DEPTH_COMPONENT,DEPTH_STENCIL:k.DEPTH_STENCIL,ALPHA:k.ALPHA,RGB:k.RGB,RGBA:k.RGBA,LUMINANCE:k.LUMINANCE,LUMINANCE_ALPHA:k.LUMINANCE_ALPHA,RGB_DXT1:k.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:k.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:k.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:k.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:k.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:k.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:k.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:k.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:k.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:k.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:k.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:k.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:k.COMPRESSED_RGBA_BPTC_UNORM};De.componentsLength=function(e){switch(e){case De.RGB:return 3;case De.RGBA:return 4;case De.LUMINANCE_ALPHA:return 2;case De.ALPHA:case De.LUMINANCE:return 1;default:return 1}};De.validate=function(e){return e===De.DEPTH_COMPONENT||e===De.DEPTH_STENCIL||e===De.ALPHA||e===De.RGB||e===De.RGBA||e===De.LUMINANCE||e===De.LUMINANCE_ALPHA||e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5||e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1||e===De.RGBA_ASTC||e===De.RGB_ETC1||e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC||e===De.RGBA_BC7};De.isColorFormat=function(e){return e===De.ALPHA||e===De.RGB||e===De.RGBA||e===De.LUMINANCE||e===De.LUMINANCE_ALPHA};De.isDepthFormat=function(e){return e===De.DEPTH_COMPONENT||e===De.DEPTH_STENCIL};De.isCompressedFormat=function(e){return e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5||e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1||e===De.RGBA_ASTC||e===De.RGB_ETC1||e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC||e===De.RGBA_BC7};De.isDXTFormat=function(e){return e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5};De.isPVRTCFormat=function(e){return e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1};De.isASTCFormat=function(e){return e===De.RGBA_ASTC};De.isETC1Format=function(e){return e===De.RGB_ETC1};De.isETC2Format=function(e){return e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC};De.isBC7Format=function(e){return e===De.RGBA_BC7};De.compressedTextureSizeInBytes=function(e,t,n){switch(e){case De.RGB_DXT1:case De.RGBA_DXT1:case De.RGB_ETC1:case De.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case De.RGBA_DXT3:case De.RGBA_DXT5:case De.RGBA_ASTC:case De.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case De.RGB_PVRTC_4BPPV1:case De.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case De.RGB_PVRTC_2BPPV1:case De.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);case De.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(n/4)*16;default:return 0}};De.textureSizeInBytes=function(e,t,n,r){let o=De.componentsLength(e);return xt.isPacked(t)&&(o=1),o*xt.sizeInBytes(t)*n*r};De.alignmentInBytes=function(e,t,n){let r=De.textureSizeInBytes(e,t,n,1)%4;return r===0?4:r===2?2:1};De.createTypedArray=function(e,t,n,r){let o,a=xt.sizeInBytes(t);a===Uint8Array.BYTES_PER_ELEMENT?o=Uint8Array:a===Uint16Array.BYTES_PER_ELEMENT?o=Uint16Array:a===Float32Array.BYTES_PER_ELEMENT&&t===xt.FLOAT?o=Float32Array:o=Uint32Array;let s=De.componentsLength(e)*n*r;return new o(s)};De.flipY=function(e,t,n,r,o){if(o===1)return e;let a=De.createTypedArray(t,n,r,o),s=De.componentsLength(t),u=r*s;for(let l=0;l<o;++l){let c=l*r*s,f=(o-l-1)*r*s;for(let h=0;h<u;++h)a[f+h]=e[c+h]}return a};De.toInternalFormat=function(e,t,n){if(!n.webgl2)return e;if(e===De.DEPTH_STENCIL)return k.DEPTH24_STENCIL8;if(e===De.DEPTH_COMPONENT){if(t===xt.UNSIGNED_SHORT)return k.DEPTH_COMPONENT16;if(t===xt.UNSIGNED_INT)return k.DEPTH_COMPONENT24}if(t===xt.FLOAT)switch(e){case De.RGBA:return k.RGBA32F;case De.RGB:return k.RGB32F;case De.RG:return k.RG32F;case De.R:return k.R32F}if(t===xt.HALF_FLOAT)switch(e){case De.RGBA:return k.RGBA16F;case De.RGB:return k.RGB16F;case De.RG:return k.RG16F;case De.R:return k.R16F}return e};var qt=Object.freeze(De);function EN(e,t,n){let r=e._gl;r.framebufferTexture2D(r.FRAMEBUFFER,t,n._target,n._texture,0)}function hI(e,t,n){let r=e._gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n._getRenderbuffer())}function ed(e){e=T(e,T.EMPTY_OBJECT);let n=e.context._gl,r=Jt.maximumColorAttachments;this._gl=n,this._framebuffer=n.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=T(e.destroyAttachments,!0);let o=g(e.depthTexture)||g(e.depthRenderbuffer),a=g(e.depthStencilTexture)||g(e.depthStencilRenderbuffer);this._bind();let s,u,l,c,f;if(g(e.colorTextures)){let h=e.colorTextures;for(c=this._colorTextures.length=this._activeColorAttachments.length=h.length,l=0;l<c;++l)s=h[l],f=this._gl.COLOR_ATTACHMENT0+l,EN(this,f,s),this._activeColorAttachments[l]=f,this._colorTextures[l]=s}if(g(e.colorRenderbuffers)){let h=e.colorRenderbuffers;for(c=this._colorRenderbuffers.length=this._activeColorAttachments.length=h.length,l=0;l<c;++l)u=h[l],f=this._gl.COLOR_ATTACHMENT0+l,hI(this,f,u),this._activeColorAttachments[l]=f,this._colorRenderbuffers[l]=u}g(e.depthTexture)&&(s=e.depthTexture,EN(this,this._gl.DEPTH_ATTACHMENT,s),this._depthTexture=s),g(e.depthRenderbuffer)&&(u=e.depthRenderbuffer,hI(this,this._gl.DEPTH_ATTACHMENT,u),this._depthRenderbuffer=u),g(e.stencilRenderbuffer)&&(u=e.stencilRenderbuffer,hI(this,this._gl.STENCIL_ATTACHMENT,u),this._stencilRenderbuffer=u),g(e.depthStencilTexture)&&(s=e.depthStencilTexture,EN(this,this._gl.DEPTH_STENCIL_ATTACHMENT,s),this._depthStencilTexture=s),g(e.depthStencilRenderbuffer)&&(u=e.depthStencilRenderbuffer,hI(this,this._gl.DEPTH_STENCIL_ATTACHMENT,u),this._depthStencilRenderbuffer=u),this._unBind()}Object.defineProperties(ed.prototype,{status:{get:function(){this._bind();let e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});ed.prototype._bind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)};ed.prototype._unBind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)};ed.prototype.bindDraw=function(){let e=this._gl;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._framebuffer)};ed.prototype.bindRead=function(){let e=this._gl;e.bindFramebuffer(e.READ_FRAMEBUFFER,this._framebuffer)};ed.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};ed.prototype.getColorTexture=function(e){return this._colorTextures[e]};ed.prototype.getColorRenderbuffer=function(e){return this._colorRenderbuffers[e]};ed.prototype.isDestroyed=function(){return!1};ed.prototype.destroy=function(){if(this.destroyAttachments){let e=0,t=this._colorTextures,n=t.length;for(;e<n;++e){let o=t[e];g(o)&&o.destroy()}let r=this._colorRenderbuffers;for(n=r.length,e=0;e<n;++e){let o=r[e];g(o)&&o.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),st(this)};var E6=ed;var dI={DONT_CARE:k.DONT_CARE,FASTEST:k.FASTEST,NICEST:k.NICEST,validate:function(e){return e===dI.DONT_CARE||e===dI.FASTEST||e===dI.NICEST}},pI=Object.freeze(dI);var mI={NEAREST:k.NEAREST,LINEAR:k.LINEAR};mI.validate=function(e){return e===mI.NEAREST||e===mI.LINEAR};var kf=Object.freeze(mI);var Kg={NEAREST:k.NEAREST,LINEAR:k.LINEAR,NEAREST_MIPMAP_NEAREST:k.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:k.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:k.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:k.LINEAR_MIPMAP_LINEAR};Kg.validate=function(e){return e===Kg.NEAREST||e===Kg.LINEAR||e===Kg.NEAREST_MIPMAP_NEAREST||e===Kg.LINEAR_MIPMAP_NEAREST||e===Kg.NEAREST_MIPMAP_LINEAR||e===Kg.LINEAR_MIPMAP_LINEAR};var In=Object.freeze(Kg);var gI={CLAMP_TO_EDGE:k.CLAMP_TO_EDGE,REPEAT:k.REPEAT,MIRRORED_REPEAT:k.MIRRORED_REPEAT,validate:function(e){return e===gI.CLAMP_TO_EDGE||e===gI.REPEAT||e===gI.MIRRORED_REPEAT}},Nl=Object.freeze(gI);function oE(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.wrapS,Nl.CLAMP_TO_EDGE),n=T(e.wrapT,Nl.CLAMP_TO_EDGE),r=T(e.minificationFilter,In.LINEAR),o=T(e.magnificationFilter,kf.LINEAR),a=g(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=t,this._wrapT=n,this._minificationFilter=r,this._magnificationFilter=o,this._maximumAnisotropy=a}Object.defineProperties(oE.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});oE.equals=function(e,t){return e===t||g(e)&&g(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy};oE.NEAREST=Object.freeze(new oE({wrapS:Nl.CLAMP_TO_EDGE,wrapT:Nl.CLAMP_TO_EDGE,minificationFilter:In.NEAREST,magnificationFilter:kf.NEAREST}));var Oa=oE;function td(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=e.width,r=e.height,o=e.source;g(o)&&(g(n)||(n=T(o.videoWidth,o.width)),g(r)||(r=T(o.videoHeight,o.height)));let a=T(e.pixelFormat,qt.RGBA),s=T(e.pixelDatatype,xt.UNSIGNED_BYTE),u=qt.toInternalFormat(a,s,t),l=qt.isCompressedFormat(u),c=e.preMultiplyAlpha||a===qt.RGB||a===qt.LUMINANCE,f=T(e.flipY,!0),h=T(e.skipColorSpaceConversion,!1),d=!0,p=t._gl,_=p.TEXTURE_2D,y=p.createTexture();p.activeTexture(p.TEXTURE0),p.bindTexture(_,y);let v=4;if(g(o)&&g(o.arrayBufferView)&&!l&&(v=qt.alignmentInBytes(a,s,n)),p.pixelStorei(p.UNPACK_ALIGNMENT,v),h?p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE):p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.BROWSER_DEFAULT_WEBGL),g(o))if(g(o.arrayBufferView)){p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1);let C=o.arrayBufferView,E,S,A;if(l){if(p.compressedTexImage2D(_,0,u,n,r,0,C),g(o.mipLevels))for(S=n,A=r,E=0;E<o.mipLevels.length;++E)S=Math.floor(S/2)|0,S<1&&(S=1),A=Math.floor(A/2)|0,A<1&&(A=1),p.compressedTexImage2D(_,E+1,u,S,A,0,o.mipLevels[E])}else if(f&&(C=qt.flipY(C,a,s,n,r)),p.texImage2D(_,0,u,n,r,0,a,xt.toWebGLConstant(s,t),C),g(o.mipLevels))for(S=n,A=r,E=0;E<o.mipLevels.length;++E)S=Math.floor(S/2)|0,S<1&&(S=1),A=Math.floor(A/2)|0,A<1&&(A=1),p.texImage2D(_,E+1,u,S,A,0,a,xt.toWebGLConstant(s,t),o.mipLevels[E])}else g(o.framebuffer)?(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._bind(),p.copyTexImage2D(_,0,u,o.xOffset,o.yOffset,n,r,0),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._unBind()):(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,f),p.texImage2D(_,0,u,a,xt.toWebGLConstant(s,t),o));else p.texImage2D(_,0,u,n,r,0,a,xt.toWebGLConstant(s,t),null),d=!1;p.bindTexture(_,null);let w;l?w=qt.compressedTextureSizeInBytes(a,n,r):w=qt.textureSizeInBytes(a,s,n,r),this._id=Ci(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=_,this._texture=y,this._internalFormat=u,this._pixelFormat=a,this._pixelDatatype=s,this._width=n,this._height=r,this._dimensions=new X(n,r),this._hasMipmap=!1,this._sizeInBytes=w,this._preMultiplyAlpha=c,this._flipY=f,this._initialized=d,this._sampler=void 0,this.sampler=g(e.sampler)?e.sampler:new Oa}td.create=function(e){return new td(e)};td.fromFramebuffer=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=t._gl,r=T(e.pixelFormat,qt.RGB),o=T(e.framebufferXOffset,0),a=T(e.framebufferYOffset,0),s=T(e.width,n.drawingBufferWidth),u=T(e.height,n.drawingBufferHeight),l=e.framebuffer;return new td({context:t,width:s,height:u,pixelFormat:r,source:{framebuffer:g(l)?l:t.defaultFramebuffer,xOffset:o,yOffset:a,width:s,height:u}})};Object.defineProperties(td.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,n=e.magnificationFilter,r=this._context,o=this._pixelFormat,a=this._pixelDatatype,s=t===In.NEAREST_MIPMAP_NEAREST||t===In.NEAREST_MIPMAP_LINEAR||t===In.LINEAR_MIPMAP_NEAREST||t===In.LINEAR_MIPMAP_LINEAR;(a===xt.FLOAT&&!r.textureFloatLinear||a===xt.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(t=s?In.NEAREST_MIPMAP_NEAREST:In.NEAREST,n=kf.NEAREST),r.webgl2&&qt.isDepthFormat(o)&&(t=In.NEAREST,n=kf.NEAREST);let u=r._gl,l=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(l,this._texture),u.texParameteri(l,u.TEXTURE_MIN_FILTER,t),u.texParameteri(l,u.TEXTURE_MAG_FILTER,n),u.texParameteri(l,u.TEXTURE_WRAP_S,e.wrapS),u.texParameteri(l,u.TEXTURE_WRAP_T,e.wrapT),g(this._textureFilterAnisotropic)&&u.texParameteri(l,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),u.bindTexture(l,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});td.prototype.copyFrom=function(e){let t=T(e.xOffset,0),n=T(e.yOffset,0),r=e.source,o=this._context,a=o._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture);let u=r.width,l=r.height,c=r.arrayBufferView,f=this._width,h=this._height,d=this._internalFormat,p=this._pixelFormat,_=this._pixelDatatype,y=this._preMultiplyAlpha,v=this._flipY,w=T(e.skipColorSpaceConversion,!1),C=4;g(c)&&(C=qt.alignmentInBytes(p,_,u)),a.pixelStorei(a.UNPACK_ALIGNMENT,C),w?a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE):a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);let E=!1;if(!this._initialized){if(t===0&&n===0&&u===f&&l===h)g(c)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),v&&(c=qt.flipY(c,p,_,f,h)),a.texImage2D(s,0,d,f,h,0,p,xt.toWebGLConstant(_,o),c)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,v),a.texImage2D(s,0,d,p,xt.toWebGLConstant(_,o),r)),E=!0;else{a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);let S=qt.createTypedArray(p,_,f,h);a.texImage2D(s,0,d,f,h,0,p,xt.toWebGLConstant(_,o),S)}this._initialized=!0}E||(g(c)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),v&&(c=qt.flipY(c,p,_,u,l)),a.texSubImage2D(s,0,t,n,u,l,p,xt.toWebGLConstant(_,o),c)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,v),a.texSubImage2D(s,0,t,n,p,xt.toWebGLConstant(_,o),r))),a.bindTexture(s,null)};td.prototype.copyFromFramebuffer=function(e,t,n,r,o,a){e=T(e,0),t=T(t,0),n=T(n,0),r=T(r,0),o=T(o,this._width),a=T(a,this._height);let s=this._context._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(u,0,e,t,n,r,o,a),s.bindTexture(u,null),this._initialized=!0};td.prototype.generateMipmap=function(e){e=T(e,pI.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};td.prototype.isDestroyed=function(){return!1};td.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),st(this)};var na=td;function Am(e,t,n,r,o){this.bottomLeft=T(e,X.ZERO),this.topRight=T(t,X.ZERO),this.childNode1=n,this.childNode2=r,this.imageIndex=o}var Cce=new X(16,16);function bm(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.borderWidthInPixels,1),n=T(e.initialSize,Cce);this._context=e.context,this._pixelFormat=T(e.pixelFormat,qt.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=Ci(),this._idHash={},this._indexHash={},this._initialSize=n,this._root=void 0}Object.defineProperties(bm.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return g(this._texture)||(this._texture=new na({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function xce(e,t){let n=e._context,r=e.numberOfImages,o=2,a=e._borderWidthInPixels;if(r>0){let s=e._texture.width,u=e._texture.height,l=o*(s+t.width+a),c=o*(u+t.height+a),f=s/l,h=u/c,d=new Am(new X(s+a,a),new X(l,u)),p=new Am(new X,new X(l,u),e._root,d),_=new Am(new X(a,u+a),new X(l,c)),y=new Am(new X,new X(l,c),p,_);for(let C=0;C<e._textureCoordinates.length;C++){let E=e._textureCoordinates[C];g(E)&&(E.x*=f,E.y*=h,E.width*=f,E.height*=h)}let v=new na({context:e._context,width:l,height:c,pixelFormat:e._pixelFormat}),w=new E6({context:n,colorTextures:[e._texture],destroyAttachments:!1});w._bind(),v.copyFromFramebuffer(0,0,0,0,l,c),w._unBind(),w.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=v,e._root=y}else{let s=o*(t.width+2*a),u=o*(t.height+2*a);s<e._initialSize.x&&(s=e._initialSize.x),u<e._initialSize.y&&(u=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new na({context:e._context,width:s,height:u,pixelFormat:e._pixelFormat}),e._root=new Am(new X(a,a),new X(s,u))}}function _I(e,t,n){if(!!g(t)){if(!g(t.childNode1)&&!g(t.childNode2)){if(g(t.imageIndex))return;let r=t.topRight.x-t.bottomLeft.x,o=t.topRight.y-t.bottomLeft.y,a=r-n.width,s=o-n.height;if(a<0||s<0)return;if(a===0&&s===0)return t;if(a>s){t.childNode1=new Am(new X(t.bottomLeft.x,t.bottomLeft.y),new X(t.bottomLeft.x+n.width,t.topRight.y));let u=t.bottomLeft.x+n.width+e._borderWidthInPixels;u<t.topRight.x&&(t.childNode2=new Am(new X(u,t.bottomLeft.y),new X(t.topRight.x,t.topRight.y)))}else{t.childNode1=new Am(new X(t.bottomLeft.x,t.bottomLeft.y),new X(t.topRight.x,t.bottomLeft.y+n.height));let u=t.bottomLeft.y+n.height+e._borderWidthInPixels;u<t.topRight.y&&(t.childNode2=new Am(new X(t.bottomLeft.x,u),new X(t.topRight.x,t.topRight.y)))}return _I(e,t.childNode1,n)}return _I(e,t.childNode1,n)||_I(e,t.childNode2,n)}}function T6(e,t,n){let r=_I(e,e._root,t);if(g(r)){r.imageIndex=n;let o=e._texture.width,a=e._texture.height,s=r.topRight.x-r.bottomLeft.x,u=r.topRight.y-r.bottomLeft.y,l=r.bottomLeft.x/o,c=r.bottomLeft.y/a,f=s/o,h=u/a;e._textureCoordinates[n]=new rn(l,c,f,h),e._texture.copyFrom({source:t,xOffset:r.bottomLeft.x,yOffset:r.bottomLeft.y})}else xce(e,t),T6(e,t,n);e._guid=Ci()}function S6(e,t){if(!g(e)||e.isDestroyed())return-1;let n=e.numberOfImages;return T6(e,t,n),n}bm.prototype.getImageIndex=function(e){return this._indexHash[e]};bm.prototype.addImageSync=function(e,t){let n=this._indexHash[e];return g(n)||(n=S6(this,t),this._idHash[e]=Promise.resolve(n),this._indexHash[e]=n),n};bm.prototype.addImage=function(e,t){let n=this._idHash[e];if(g(n))return n;typeof t=="function"?t=t(e):(typeof t=="string"||t instanceof vt)&&(t=vt.createIfNeeded(t).fetchImage());let r=this;return n=Promise.resolve(t).then(function(o){let a=S6(r,o);return r._indexHash[e]=a,a}),this._idHash[e]=n,n};bm.prototype.updateImage=function(e,t){let n=this._textureCoordinates[e],r=this._texture,o=Math.round(n.x*r.width),a=Math.round(n.y*r.height);r.copyFrom({source:t,xOffset:o,yOffset:a})};bm.prototype.addSubRegion=function(e,t){let n=this._idHash[e];if(!g(n))throw new at(`image with id "${e}" not found in the atlas.`);let r=this;return Promise.resolve(n).then(function(o){if(o===-1)return-1;let a=r._texture.width,s=r._texture.height,u=r.numberOfImages,l=r._textureCoordinates[o],c=l.x+t.x/a,f=l.y+t.y/s,h=t.width/a,d=t.height/s;return r._textureCoordinates.push(new rn(c,f,h,d)),r._guid=Ci(),u})};bm.prototype.isDestroyed=function(){return!1};bm.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),st(this)};var B_=bm;var wce=Ki.SHOW_INDEX,sE=Ki.POSITION_INDEX,A6=Ki.PIXEL_OFFSET_INDEX,b6=Ki.EYE_OFFSET_INDEX,Ece=Ki.HORIZONTAL_ORIGIN_INDEX,Tce=Ki.VERTICAL_ORIGIN_INDEX,Sce=Ki.SCALE_INDEX,aE=Ki.IMAGE_INDEX_INDEX,I6=Ki.COLOR_INDEX,Ace=Ki.ROTATION_INDEX,bce=Ki.ALIGNED_AXIS_INDEX,D6=Ki.SCALE_BY_DISTANCE_INDEX,P6=Ki.TRANSLUCENCY_BY_DISTANCE_INDEX,M6=Ki.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,L6=Ki.DISTANCE_DISPLAY_CONDITION,Ice=Ki.DISABLE_DEPTH_DISTANCE,Dce=Ki.TEXTURE_COORDINATE_BOUNDS,R6=Ki.SDF_INDEX,PN=Ki.NUMBER_OF_PROPERTIES,Qi,Pce={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},Mce={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function Xc(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(PN),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._modelMatrix=G.clone(G.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=T(e.debugShowTextureAtlas,!1),this.blendOption=T(e.blendOption,Nr.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW],this._highlightColor=K.clone(K.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let n=this._scene;g(n)&&g(n.terrainProviderChanged)&&(this._removeCallbackFunc=n.terrainProviderChanged.addEventListener(function(){let r=this._billboards,o=r.length;for(let a=0;a<o;++a)g(r[a])&&r[a]._updateClamping()},this))}Object.defineProperties(Xc.prototype,{length:{get:function(){return MN(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function O6(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}Xc.prototype.add=function(e){let t=new Ki(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t};Xc.prototype.remove=function(e){return this.contains(e)?(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};Xc.prototype.resize=function(e){return this.removeAll(),this._billboards=e,this._billboardsRemoved=!0,this._createVertexArray=!0,!0};Xc.prototype.removeAll=function(){O6(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function MN(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],n=e._billboards,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];g(s)&&(s._index=a++,t.push(s))}e._billboards=t}}Xc.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]};Xc.prototype.contains=function(e){return g(e)&&e._billboardCollection===this};Xc.prototype.get=function(e){return MN(this),this._billboards[e]};var TN;function Lce(e){let n=e.cache.billboardCollection_indexBufferBatched;if(g(n))return n;let r=16384*6-6,o=new Uint16Array(r);for(let a=0,s=0;a<r;a+=6,s+=4)o[a]=s,o[a+1]=s+1,o[a+2]=s+2,o[a+3]=s+0,o[a+4]=s+2,o[a+5]=s+3;return n=Ui.createIndexBuffer({context:e,typedArray:o,usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=n,n}function Rce(e){let t=e.cache.billboardCollection_indexBufferInstanced;return g(t)||(t=Ui.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function Oce(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return g(t)||(t=Ui.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:We.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}Xc.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<PN;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function Nce(e,t,n,r,o,a){let s=[{index:Qi.positionHighAndScale,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[sE]},{index:Qi.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[sE]},{index:Qi.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[A6]},{index:Qi.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[P6]},{index:Qi.compressedAttribute2,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[I6]},{index:Qi.eyeOffset,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[b6]},{index:Qi.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[D6]},{index:Qi.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[M6]},{index:Qi.compressedAttribute3,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[L6]},{index:Qi.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Dce]}];r&&s.push({index:Qi.direction,componentsPerAttribute:2,componentDatatype:ie.FLOAT,vertexBuffer:Oce(e)}),g(o)&&s.push({index:Qi.a_batchId,componentsPerAttribute:1,componentDatatype:ie.FLOAT,bufferUsage:We.STATIC_DRAW}),a&&s.push({index:Qi.sdf,componentsPerAttribute:2,componentDatatype:ie.FLOAT,usage:n[R6]});let u=r?t:4*t;return new fC(e,s,u,r)}var SN=new ti;function N6(e,t,n,r,o){let a,s=r[Qi.positionHighAndScale],u=r[Qi.positionLowAndRotation],l=o._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),ti.fromCartesian(l,SN);let c=o.scale,f=o.rotation;f!==0&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,c);let h=SN.high,d=SN.low;e._instanced?(a=o._index,s(a,h.x,h.y,h.z,c),u(a,d.x,d.y,d.z,f)):(a=o._index*4,s(a+0,h.x,h.y,h.z,c),s(a+1,h.x,h.y,h.z,c),s(a+2,h.x,h.y,h.z,c),s(a+3,h.x,h.y,h.z,c),u(a+0,d.x,d.y,d.z,f),u(a+1,d.x,d.y,d.z,f),u(a+2,d.x,d.y,d.z,f),u(a+3,d.x,d.y,d.z,f))}var Uf=new X,Gf=32768,hC=65536,AN=4096,sp=256,Bce=128,Fce=32,zce=8,B6=4,Vce=1/256,F6=0,z6=2,V6=3,k6=1;function G6(e,t,n,r,o){let a,s=r[Qi.compressedAttribute0],u=o.pixelOffset,l=u.x,c=u.y,f=o._translate,h=f.x,d=f.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+h),Math.abs(-c+d));let p=o.horizontalOrigin,_=o._verticalOrigin,y=o.show&&o.clusterShow;o.color.alpha===0&&(y=!1),_===ln.BASELINE&&(_=ln.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===go.CENTER,e._allVerticalCenter=e._allVerticalCenter&&_===ln.CENTER;let v=0,w=0,C=0,E=0,S=o._imageIndex;if(S!==-1){let V=n[S];v=V.x,w=V.y,C=V.width,E=V.height}let A=v+C,D=w+E,P=Math.floor(F.clamp(l,-Gf,Gf)+Gf)*Bce;P+=(p+1)*Fce,P+=(_+1)*zce,P+=(y?1:0)*B6;let M=Math.floor(F.clamp(c,-Gf,Gf)+Gf)*sp,b=Math.floor(F.clamp(h,-Gf,Gf)+Gf)*sp,O=(F.clamp(d,-Gf,Gf)+Gf)*Vce,m=Math.floor(O),I=Math.floor((O-m)*sp);M+=m,b+=I,Uf.x=v,Uf.y=w;let L=_a.compressTextureCoordinates(Uf);Uf.x=A;let R=_a.compressTextureCoordinates(Uf);Uf.y=D;let N=_a.compressTextureCoordinates(Uf);Uf.x=v;let B=_a.compressTextureCoordinates(Uf);e._instanced?(a=o._index,s(a,P,M,b,L)):(a=o._index*4,s(a+0,P+F6,M,b,L),s(a+1,P+z6,M,b,R),s(a+2,P+V6,M,b,N),s(a+3,P+k6,M,b,B))}function U6(e,t,n,r,o){let a,s=r[Qi.compressedAttribute1],u=o.alignedAxis;x.equals(u,x.ZERO)||(e._shaderAlignedAxis=!0);let l=0,c=1,f=1,h=1,d=o.translucencyByDistance;g(d)&&(l=d.near,c=d.nearValue,f=d.far,h=d.farValue,(c!==1||h!==1)&&(e._shaderTranslucencyByDistance=!0));let p=0,_=o._imageIndex;_!==-1&&(p=n[_].width);let y=e._textureAtlas.texture.width,v=Math.round(T(o.width,y*p));e._maxSize=Math.max(e._maxSize,v);let w=F.clamp(v,0,hC),C=0;Math.abs(x.magnitudeSquared(u)-1)<F.EPSILON6&&(C=_a.octEncodeFloat(u)),c=F.clamp(c,0,1),c=c===1?255:c*255|0,w=w*sp+c,h=F.clamp(h,0,1),h=h===1?255:h*255|0,C=C*sp+h,e._instanced?(a=o._index,s(a,w,C,l,f)):(a=o._index*4,s(a+0,w,C,l,f),s(a+1,w,C,l,f),s(a+2,w,C,l,f),s(a+3,w,C,l,f))}function IN(e,t,n,r,o){let a,s=r[Qi.compressedAttribute2],u=o.color,l=g(e._batchTable)?K.WHITE:o.getPickId(t.context).color,c=o.sizeInMeters?1:0,f=Math.abs(x.magnitudeSquared(o.alignedAxis)-1)<F.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&c===1;let h=0,d=o._imageIndex;d!==-1&&(h=n[d].height);let p=e._textureAtlas.texture.dimensions,_=Math.round(T(o.height,p.y*h));e._maxSize=Math.max(e._maxSize,_);let y=T(o._labelHorizontalOrigin,-2);y+=2;let v=_*B6+y,w=K.floatToByte(u.red),C=K.floatToByte(u.green),E=K.floatToByte(u.blue),S=w*hC+C*sp+E;w=K.floatToByte(l.red),C=K.floatToByte(l.green),E=K.floatToByte(l.blue);let A=w*hC+C*sp+E,D=K.floatToByte(u.alpha)*hC+K.floatToByte(l.alpha)*sp;D+=c*2+f,e._instanced?(a=o._index,s(a,S,A,D,v)):(a=o._index*4,s(a+0,S,A,D,v),s(a+1,S,A,D,v),s(a+2,S,A,D,v),s(a+3,S,A,D,v))}function DN(e,t,n,r,o){let a,s=r[Qi.eyeOffset],u=o.eyeOffset,l=u.z;if(o._heightReference!==Lt.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(u.x),Math.abs(u.y),Math.abs(l)),e._instanced){let c=0,f=0,h=o._imageIndex;if(h!==-1){let p=n[h];c=p.width,f=p.height}Uf.x=c,Uf.y=f;let d=_a.compressTextureCoordinates(Uf);a=o._index,s(a,u.x,u.y,l,d)}else a=o._index*4,s(a+0,u.x,u.y,l,0),s(a+1,u.x,u.y,l,0),s(a+2,u.x,u.y,l,0),s(a+3,u.x,u.y,l,0)}function H6(e,t,n,r,o){let a,s=r[Qi.scaleByDistance],u=0,l=1,c=1,f=1,h=o.scaleByDistance;g(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function q6(e,t,n,r,o){let a,s=r[Qi.pixelOffsetScaleByDistance],u=0,l=1,c=1,f=1,h=o.pixelOffsetScaleByDistance;g(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function W6(e,t,n,r,o){let a,s=r[Qi.compressedAttribute3],u=0,l=Number.MAX_VALUE,c=o.distanceDisplayCondition;g(c)&&(u=c.near,l=c.far,u*=u,l*=l,e._shaderDistanceDisplayCondition=!0);let f=o.disableDepthTestDistance,h=o.heightReference===Lt.CLAMP_TO_GROUND&&t.context.depthTexture;g(f)||(f=h?5e3:0),f*=f,(h||f>0)&&(e._shaderDisableDepthDistance=!0,f===Number.POSITIVE_INFINITY&&(f=-1));let d,p;if(g(o._labelDimensions))p=o._labelDimensions.x,d=o._labelDimensions.y;else{let w=0,C=0,E=o._imageIndex;if(E!==-1){let A=n[E];w=A.height,C=A.width}d=Math.round(T(o.height,e._textureAtlas.texture.dimensions.y*w));let S=e._textureAtlas.texture.width;p=Math.round(T(o.width,S*C))}let _=Math.floor(F.clamp(p,0,AN)),y=Math.floor(F.clamp(d,0,AN)),v=_*AN+y;e._instanced?(a=o._index,s(a,u,l,f,v)):(a=o._index*4,s(a+0,u,l,f,v),s(a+1,u,l,f,v),s(a+2,u,l,f,v),s(a+3,u,l,f,v))}function Y6(e,t,n,r,o){if(o.heightReference===Lt.CLAMP_TO_GROUND){let _=e._scene,y=t.context,v=t.globeTranslucencyState.translucent,w=g(_.globe)&&_.globe.depthTestAgainstTerrain;e._shaderClampToGround=y.depthTexture&&!v&&w}let a,s=r[Qi.textureCoordinateBoundsOrLabelTranslate];if(Jt.maximumVertexTextureImageUnits>0){let _=0,y=0;g(o._labelTranslate)&&(_=o._labelTranslate.x,y=o._labelTranslate.y),e._instanced?(a=o._index,s(a,_,y,0,0)):(a=o._index*4,s(a+0,_,y,0,0),s(a+1,_,y,0,0),s(a+2,_,y,0,0),s(a+3,_,y,0,0));return}let u=0,l=0,c=0,f=0,h=o._imageIndex;if(h!==-1){let _=n[h];u=_.x,l=_.y,c=_.width,f=_.height}let d=u+c,p=l+f;e._instanced?(a=o._index,s(a,u,l,d,p)):(a=o._index*4,s(a+0,u,l,d,p),s(a+1,u,l,d,p),s(a+2,u,l,d,p),s(a+3,u,l,d,p))}function kce(e,t,n,r,o){if(!g(e._batchTable))return;let a=r[Qi.a_batchId],s=o._batchIndex,u;e._instanced?(u=o._index,a(u,s)):(u=o._index*4,a(u+0,s),a(u+1,s),a(u+2,s),a(u+3,s))}function X6(e,t,n,r,o){if(!e._sdf)return;let a,s=r[Qi.sdf],u=o.outlineColor,l=o.outlineWidth,c=K.floatToByte(u.red),f=K.floatToByte(u.green),h=K.floatToByte(u.blue),d=c*hC+f*sp+h,p=l/Rs.RADIUS,_=K.floatToByte(u.alpha)*hC+K.floatToByte(p)*sp;e._instanced?(a=o._index,s(a,d,_)):(a=o._index*4,s(a+0,d+F6,_),s(a+1,d+z6,_),s(a+2,d+V6,_),s(a+3,d+k6,_))}function Gce(e,t,n,r,o){N6(e,t,n,r,o),G6(e,t,n,r,o),U6(e,t,n,r,o),IN(e,t,n,r,o),DN(e,t,n,r,o),H6(e,t,n,r,o),q6(e,t,n,r,o),W6(e,t,n,r,o),Y6(e,t,n,r,o),kce(e,t,n,r,o),X6(e,t,n,r,o)}function bN(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=Ki._computeActualPosition(c,f,r,o);g(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function Uce(e,t){let n=t.mode,r=e._billboards,o=e._billboardsToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!G.equals(a,e.modelMatrix)?(e._mode=n,G.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&bN(e,r,r.length,t,a,!0)):n===Ne.MORPHING?bN(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&bN(e,o,e._billboardsToUpdateIndex,t,a,!1)}function Hce(e,t,n){let r=1;(!e._allSizedInMeters||e._maxPixelOffset!==0)&&(r=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let o=r*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(o*=.5);let a=r*e._maxPixelOffset+e._maxEyeOffset;n.radius+=o+a}function qce(e,t){let n=`uniform sampler2D billboard_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); 
} 
`,r=t.createViewportQuadCommand(n,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return r.pass=en.OVERLAY,r}var Wce=[];Xc.prototype.update=function(e){if(MN(this),!this.show)return;let t=this._billboards,n=t.length,r=e.context;this._instanced=r.instancedArrays,Qi=this._instanced?Mce:Pce,TN=this._instanced?Rce:Lce;let o=this._textureAtlas;if(g(o))for(let M=0;M<n;++M){let b=t[M];b.animation&&b.ready&&b._updateImage()}else{o=this._textureAtlas=new B_({context:r});for(let M=0;M<n;++M)t[M]._loadImage()}let a=o.textureCoordinates;if(a.length===0)return;Uce(this,e),t=this._billboards,n=t.length;let s=this._billboardsToUpdate,u=this._billboardsToUpdateIndex,l=this._propertiesChanged,c=o.guid,f=this._createVertexArray||this._textureAtlasGUID!==c;this._textureAtlasGUID=c;let h,d=e.passes,p=d.pick;if(f||!p&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let M=0;M<PN;++M)l[M]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=Nce(r,n,this._buffersUsage,this._instanced,this._batchTable,this._sdf),h=this._vaf.writers;for(let M=0;M<n;++M){let b=this._billboards[M];b._dirty=!1,Gce(this,e,a,h,b)}this._vaf.commit(TN(r))}this._billboardsToUpdateIndex=0}else if(u>0){let M=Wce;M.length=0,(l[sE]||l[Ace]||l[Sce])&&M.push(N6),(l[aE]||l[A6]||l[Ece]||l[Tce]||l[wce])&&(M.push(G6),this._instanced&&M.push(DN)),(l[aE]||l[bce]||l[P6])&&(M.push(U6),M.push(IN)),(l[aE]||l[I6])&&M.push(IN),l[b6]&&M.push(DN),l[D6]&&M.push(H6),l[M6]&&M.push(q6),(l[L6]||l[Ice]||l[aE]||l[sE])&&M.push(W6),(l[aE]||l[sE])&&M.push(Y6),l[R6]&&M.push(X6);let b=M.length;if(h=this._vaf.writers,u/n>.1){for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let I=0;I<b;++I)M[I](this,e,a,h,m)}this._vaf.commit(TN(r))}else{for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let I=0;I<b;++I)M[I](this,e,a,h,m);this._instanced?this._vaf.subCommit(m._index,1):this._vaf.subCommit(m._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(u>n*1.5&&(s.length=n),!g(this._vaf)||!g(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let _,y=G.IDENTITY;e.mode===Ne.SCENE3D?(y=this.modelMatrix,_=Ee.clone(this._baseVolumeWC,this._boundingVolume)):_=Ee.clone(this._baseVolume2D,this._boundingVolume),Hce(this,e,_);let v=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,v){this._blendOption===Nr.OPAQUE||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=fn.fromCache({depthTest:{enabled:!0,func:k.LESS},depthMask:!0}):this._rsOpaque=void 0;let M=this._blendOption===Nr.TRANSLUCENT;this._blendOption===Nr.TRANSLUCENT||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=fn.fromCache({depthTest:{enabled:!0,func:M?k.LEQUAL:k.LESS},depthMask:M,blending:ka.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let w,C,E,S,A,D=Jt.maximumVertexTextureImageUnits>0;if(v||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){w=fI,C=cI,A=[],g(this._batchTable)&&(A.push("VECTOR_TILE"),w=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(w),C=this._batchTable.getFragmentShaderCallback(!1,void 0)(C)),E=new Et({defines:A,sources:[w]}),this._instanced&&E.defines.push("INSTANCED"),this._shaderRotation&&E.defines.push("ROTATION"),this._shaderAlignedAxis&&E.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&E.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&E.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&E.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&E.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&E.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK"));let M=1-Rs.CUTOFF;this._sdf&&E.defines.push("SDF");let b=g(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT&&(S=new Et({defines:["OPAQUE",b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=wi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Qi}),S=new Et({defines:["TRANSLUCENT",b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=wi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Qi})),this._blendOption===Nr.OPAQUE&&(S=new Et({defines:[b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=wi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Qi})),this._blendOption===Nr.TRANSLUCENT&&(S=new Et({defines:[b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=wi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Qi})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let P=e.commandList;if(d.render||d.pick){let M=this._colorCommands,b=this._blendOption===Nr.OPAQUE,O=this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT,m=this._vaf.va,I=m.length,L=this._uniforms,R;g(this._batchTable)?(L=this._batchTable.getUniformMapCallback()(L),R=this._batchTable.getPickId()):R="v_pickColor",M.length=I;let N=O?I*2:I;for(let B=0;B<N;++B){let V=M[B];g(V)||(V=M[B]=new $t);let z=b||O&&B%2===0;V.pass=z||!O?en.OPAQUE:en.TRANSLUCENT,V.owner=this;let U=O?Math.floor(B/2):B;V.boundingVolume=_,V.modelMatrix=y,V.count=m[U].indicesCount,V.shaderProgram=z?this._sp:this._spTranslucent,V.uniformMap=L,V.vertexArray=m[U].va,V.renderState=z?this._rsOpaque:this._rsTranslucent,V.debugShowBoundingVolume=this.debugShowBoundingVolume,V.pickId=R,this._instanced&&(V.count=6,V.instanceCount=n),P.push(V)}this.debugShowTextureAtlas&&(g(this.debugCommand)||(this.debugCommand=qce(this,e.context)),P.push(this.debugCommand))}};Xc.prototype.isDestroyed=function(){return!1};Xc.prototype.destroy=function(){return g(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),O6(this._billboards),st(this)};var uE=Xc;var LN={};LN.toInt=function(e){if(!e)return;let t=e.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),n=parseInt((t[3]||1)*255),r=parseInt(t[0]),o=parseInt(t[1]),a=parseInt(t[2]);return(r<<24|o<<16|a<<8|n)>>>0};LN.fromInt=function(e){if(!e)return;let t=[];return t[0]=(e&4278190080)>>>24,t[1]=(e&16711680)>>>16,t[2]=(e&65280)>>>8,t[3]=e&255>>>0,`rgba(${t[0]},${t[1]},${t[2]},${t[3]/255})`};var j6=LN;function RN(){}RN.prototype.cgcs2000ToWgs84=function(e,t,n){let o=298.257222101,a=K6(6378137,o,t,e,n);o=298.257223563;let s=Z6(6378137,o,a[0],a[1],a[2]);return new Cesium.Cartographic(s[0],s[1],s[2])};RN.prototype.wgs84ToCgcs2000=function(e,t,n){let o=298.257223563,a=K6(6378137,o,t,e,n);o=298.257222101;let s=Z6(6378137,o,a[0],a[1],a[2]);return new Cesium.Cartographic(s[0],s[1],s[2])};function K6(e,t,n,r,o){let a=0,s=0,u=0,l=n,c=r,f=0;t!=0&&(f=1/t);let h=2*f-f*f,d=e/Math.sqrt(1-h*Math.sin(l)*Math.sin(l));return a=(d+o)*Math.cos(l)*Math.cos(c),s=(d+o)*Math.cos(l)*Math.sin(c),u=((1-h)*d+o)*Math.sin(l),[a,s,u]}function Z6(e,t,n,r,o){let a=0,s=0,u=0,l=0;t!=0&&(l=1/t);let c=2*l-l*l,f=0,h=e,d=0,p=20,_=0;do{let y=(o+c*h*Math.sin(f))/Math.sqrt(n*n+r*r);if(f=Math.atan(y),h=e/Math.sqrt(1-c*Math.sin(f)*Math.sin(f)),d=f-a,a=f,++_,_>p)return!1}while(Math.abs(d)>1e-9);return h=e/Math.sqrt(1-c*Math.sin(a)*Math.sin(a)),s=Math.atan(r/n),r>0&&s<0&&(s+=Cesium.Math.PI),r<0&&s>0&&(s-=Cesium.Math.PI),u=n/(Math.cos(s)*Math.cos(a))-h,[s,a,u]}var Q6=RN;function yI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.startYaw=Cesium.defaultValue(e.startYaw,-90),this.endYaw=Cesium.defaultValue(e.endYaw,100),this.radius=Cesium.defaultValue(e.radius,530),this._radius=void 0,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this._attributeLocations=void 0,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}yI.prototype.update=function(e){var t=e.context,n=this;this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this._modelMatrix,this._boundingSphere),this._command.boundingVolume=this._boundingSphere,this._command.uniformMap={v_colour:function(){return n.fillColor}};var r=this.createMesh();this._VA=Yce(this,t,r),Cesium.defined(this._command.shaderProgram)||(this._command.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:jce(),fragmentShaderSource:Kce()})),this._command.vertexArray=this._VA;var o=e.commandList,a=e.passes;a.render&&o.push(this._command)};yI.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function Yce(e,t,n){var r=Xce(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Xce(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}yI.prototype.createMesh=function(){var e=this.endYaw-this.startYaw;e=e*2;for(var t=new Float64Array(e*3),n=e,r=this._radius,o=0,a=0,s=Cesium.IndexDatatype.createTypedArray(e,n),u=1;u<e-1;u++)t[o++]=r*Math.sin((this.startYaw+u)*Math.PI/180),t[o++]=r*Math.cos((this.startYaw+u)*Math.PI/180),t[o++]=0;for(var l=0;l<e-1;l++)s[a++]=l,s[a++]=l+1;return{position:t,indices:s}};function jce(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Kce(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var vI=yI;var up={position:0,normal:1};function CI(e){var t=this;if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._position=e.position,this.position=this._position,this.positionChange=!1,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showDomeSurfaces=Cesium.defaultValue(e.showDomeSurfaces,!0),this.slice=Cesium.defaultValue(e.slice,32),this.modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._computedModelMatrix=new Cesium.Matrix4,this._computedScanPlaneModelMatrix=new Cesium.Matrix4,this.radius=Cesium.defaultValue(e.radius,Number.POSITIVE_INFINITY),this._radius=void 0,this.xHalfAngle=Cesium.Math.toRadians(90),this._xHalfAngle=void 0,this.yHalfAngle=Cesium.Math.toRadians(90),this._yHalfAngle=void 0,this.lineColor=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,.5)),this.showLateralSurfaces=Cesium.defaultValue(e.showLateralSurfaces,!1),this.material=Cesium.defaultValue(e.material,new Cesium.Material({fabric:{type:"Color",uniforms:{color:this.lineColor}}})),this._material=void 0,this._translucent=void 0,this.stackPartitions=Cesium.defaultValue(e.stackPartitions,32),this.slicePartitions=Cesium.defaultValue(e.slicePartitions,32),this.showIntersection=Cesium.defaultValue(e.showIntersection,!1),this.intersectionColor=Cesium.defaultValue(e.intersectionColor,Cesium.Color.WHITE),this.intersectionWidth=Cesium.defaultValue(e.intersectionWidth,5),this.showThroughEllipsoid=Cesium.defaultValue(e.showThroughEllipsoid,!0),this._showThroughEllipsoid=void 0,this.showScanPlane=Cesium.defaultValue(e.showScanPlane,!0),this.scanPlaneColor=Cesium.defaultValue(e.scanPlaneColor,Cesium.Color.WHITE),this.scanPlaneRate=Cesium.defaultValue(e.scanPlaneRate,100),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._timeDiff=0,this._boundingSphere=new Cesium.BoundingSphere,this._boundingSphereWC=new Cesium.BoundingSphere,this._sectorFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return t.xHalfAngle},u_yHalfAngle:function(){return t.yHalfAngle},u_radius:function(){return t._radius},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return t._scanePlaneXHalfAngle},u_yHalfAngle:function(){return t._scanePlaneYHalfAngle},u_radius:function(){return t._radius},u_color:function(){return t.scanPlaneColor},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scene.primitives.add(this)}Object.defineProperties(CI.prototype,{position:{get:function(){return this._position},set:function(e){e instanceof x&&(this.positionChange=!0,this._position=e)}}});CI.prototype.update=function(e){var t=e.mode,n=this.viewer.scene.frameState.time;if(this.show instanceof Array?Zce(this,n):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){var r=!1,o=!1,a=!1,s=this.xHalfAngle,u=this.yHalfAngle;if(s<0||u<0)throw new Cesium.DeveloperError("halfAngle must be greater than or equal to zero.");if(!(s==0||u==0)){(this._xHalfAngle!==s||this._yHalfAngle!==u)&&(this._xHalfAngle=s,this._yHalfAngle=u,r=!0),this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius;var l=this._radius;if(l<0)throw new Cesium.DeveloperError("this.radius must be greater than or equal to zero.");this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),(!Cesium.defined(this.modelMatrix)||this.positionChange)&&(this.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position)),Cesium.Matrix4.multiplyByUniformScale(this.modelMatrix,this._radius,this._computedModelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this.modelMatrix,this._boundingSphereWC);var c=this.showThroughEllipsoid;this._showThroughEllipsoid!==this.showThroughEllipsoid&&(this._showThroughEllipsoid=c,o=!0);var f=this.material;this._material!==f&&(this._material=f,o=!0,a=!0);var h=!0;if(this._translucent!==h&&(this._translucent=h,o=!0),this.showScanPlane){this._timeDiff>1&&(this._timeDiff=0),this._timeDiff+=1/(this.scanPlaneRate*10);var d=this._timeDiff,p;p=4*s*d-s;var _=Math.tan(u),y=Math.cos(p),v=Math.atan(y*_);this._scanePlaneXHalfAngle=p,this._scanePlaneYHalfAngle=v,Cesium.Matrix3.fromRotationZ(this._scanePlaneXHalfAngle,lE),Cesium.Matrix4.multiplyByMatrix3(this.modelMatrix,lE,this._computedScanPlaneModelMatrix),Cesium.Matrix4.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this._radius,this._computedScanPlaneModelMatrix)}r&&sfe(this,e),o&&ffe(this,c,h),a&&cfe(this,e,f),(o||a)&&hfe(this,h);var w=e.commandList,C=e.passes,E=this._colorCommands;if(C.render)for(var S=0,A=E.length;S<A;S++){var D=E[S];w.push(D)}}}};CI.prototype.destroy=function(){if(this._scene.primitives.contains(this)){var e=this._scene.primitives._primitives.indexOf(this);e!==-1&&(this._scene.primitives._primitives.splice(e,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function Zce(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=Qce(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0;return}}else e._show=!1}function Qce(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}var lE=new te,QJe=new te,J6=new x;function Jce(e,t,n){for(var r=e.slice,o=Math.cos(n),a=Math.tan(n),s=Math.cos(t),u=Math.tan(t),l=Math.atan(s*a),c=Math.atan(o*u),f=[],h=0;h<r;h++){var d=2*l*h/(r-1)-l;f.push(new Cesium.Cartesian3(0,Math.sin(d),Math.cos(d)))}for(var p=[],h=0;h<r;h++){var d=2*c*h/(r-1)-c;p.push(new Cesium.Cartesian3(Math.sin(d),0,Math.cos(d)))}return{zoy:f,zox:p}}function $ce(e,t,n){for(var r=e.slice,o=[],a=Math.cos(t),s=Math.tan(n),u=Math.atan(a*s),l=0;l<r/2;l++){var c=2*u*l/(r-1)-u;o.push(new Cesium.Cartesian3(Math.sin(c),0,Math.cos(c)))}return o}function efe(e,t){var n=e.xHalfAngle,r=e.yHalfAngle,o=t.zoy,a=t.zox,s=[],u=Cesium.Matrix3.fromRotationY(n,lE);s.push(o.map(function(l){return Cesium.Matrix3.multiplyByVector(u,l,new Cesium.Cartesian3)}));var u=Cesium.Matrix3.fromRotationX(-r,lE),u=Cesium.Matrix3.fromRotationY(-n,lE);return s.push(o.map(function(l){return Cesium.Matrix3.multiplyByVector(u,l,new Cesium.Cartesian3)}).reverse()),s}function tfe(e,t){for(var n=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(2*3*3*n),o=0,a=0,s=t.length;a<s;a++)for(var u=t[a],l=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(u[0],u[u.length-1],J6),J6),c=0,n=u.length-1;c<n;c++)r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z,r[o++]=u[c].x,r[o++]=u[c].y,r[o++]=u[c].z,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z,r[o++]=u[c+1].x,r[o++]=u[c+1].y,r[o++]=u[c+1].z,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z;var f=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),h=2*3*Float32Array.BYTES_PER_ELEMENT,d=[{index:up.position,vertexBuffer:f,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:h},{index:up.normal,vertexBuffer:f,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:h}];return new Cesium.VertexArray({context:e,attributes:d})}function nfe(e,t){for(var n=t.length,r=new Float32Array(3*3*n),o=0,a=0,s=t.length;a<s;a++){var u=t[a];r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=u[0].x,r[o++]=u[0].y,r[o++]=u[0].z}var l=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),c=3*Float32Array.BYTES_PER_ELEMENT,f=[{index:up.position,vertexBuffer:l,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:c}];return new Cesium.VertexArray({context:e,attributes:f})}function rfe(e,t){for(var n=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(3*3*n),o=0,a=0,s=t.length;a<s;a++)for(var u=t[a],l=0,n=u.length-1;l<n;l++)r[o++]=u[l].x,r[o++]=u[l].y,r[o++]=u[l].z,r[o++]=u[l+1].x,r[o++]=u[l+1].y,r[o++]=u[l+1].z;var c=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),f=3*Float32Array.BYTES_PER_ELEMENT,h=[{index:up.position,vertexBuffer:c,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:f}];return new Cesium.VertexArray({context:e,attributes:h})}function ife(e){var t=Cesium.EllipsoidGeometry.createGeometry(new Cesium.EllipsoidGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,stackPartitions:32,slicePartitions:32})),n=Cesium.VertexArray.fromGeometry({context:e,geometry:t,attributeLocations:up,bufferUsage:Cesium.BufferUsage.STATIC_DRAW,interleave:!1});return n}function ofe(e,t,n){var r=Cesium.EllipsoidOutlineGeometry.createGeometry(new Cesium.EllipsoidOutlineGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,stackPartitions:t,slicePartitions:n})),o=Cesium.VertexArray.fromGeometry({context:e,geometry:r,attributeLocations:up,bufferUsage:Cesium.BufferUsage.STATIC_DRAW,interleave:!1});return o}function afe(e,t){for(var n=t.length-1,r=new Float32Array(3*3*n),o=0,a=0;a<n;a++)r[o++]=t[a].x,r[o++]=t[a].y,r[o++]=t[a].z,r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=t[a+1].x,r[o++]=t[a+1].y,r[o++]=t[a+1].z;var s=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),u=3*Float32Array.BYTES_PER_ELEMENT,l=[{index:up.position,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:u}];return new Cesium.VertexArray({context:e,attributes:l})}function sfe(e,t){var n=t.context,r=Jce(e,e.xHalfAngle,e.yHalfAngle),o=efe(e,r);if(e.showLateralSurfaces&&(e._sectorVA=tfe(n,o)),e.showSectorLines&&(e._sectorLineVA=nfe(n,o)),e.showSectorSegmentLines&&(e._sectorSegmentLineVA=rfe(n,o)),e._domeVA=ife(n),e._domeLineVA=ofe(n,e.stackPartitions,e.slicePartitions),e.showScanPlane){var a=$ce(e,0,Cesium.Math.PI_OVER_TWO);e._scanPlaneVA=afe(n,a)}}function ufe(e,t,n){var r=t.context,o=eH(),a=new Cesium.ShaderSource({sources:[ON(),n.shaderSource,$6()]});e._sp=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:up});var s=new Cesium.ShaderSource({sources:[ON(),n.shaderSource,$6()],pickColorQualifier:"uniform"});e._pickSP=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._pickSP,vertexShaderSource:o,fragmentShaderSource:s,attributeLocations:up})}function lfe(e,t,n){var r=t.context,o=eH(),a=new Cesium.ShaderSource({sources:[ON(),n.shaderSource,dfe()]});e._scanePlaneSP=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._scanePlaneSP,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:up})}function cfe(e,t,n){ufe(e,t,n),e.showScanPlane&&lfe(e,t,n)}function ffe(e,t,n){n?(e._frontFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!0,face:Cesium.CullFace.BACK}}),e._backFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!0,face:Cesium.CullFace.FRONT}}),e._pickRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND})):(e._frontFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!0}),e._pickRS=Cesium.RenderState.fromCache({depthTest:{enabled:!0},depthMask:!0}))}function dC(e,t,n,r,o,a,s,u,l,c,f,h){c&&n&&(n.vertexArray=s,n.renderState=o,n.shaderProgram=a,n.uniformMap=Cesium.combine(u,e._material._uniforms),n.uniformMap.u_normalDirection=function(){return-1},n.pass=f,n.modelMatrix=l,e._colorCommands.push(n)),t.vertexArray=s,t.renderState=r,t.shaderProgram=a,t.uniformMap=Cesium.combine(u,e._material._uniforms),h&&(t.uniformMap.u_type=function(){return 1}),t.pass=f,t.modelMatrix=l,e._colorCommands.push(t)}function hfe(e,t){e._colorCommands.length=0;var n=Cesium.Pass.TRANSLUCENT;e.showLateralSurfaces&&dC(e,e._sectorFrontCommand,e._sectorBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorVA,e._uniforms,e._computedModelMatrix,t,n),e.showSectorLines&&dC(e,e._sectorLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showSectorSegmentLines&&dC(e,e._sectorSegmentLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorSegmentLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showDomeSurfaces&&dC(e,e._domeFrontCommand,e._domeBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._domeVA,e._uniforms,e._computedModelMatrix,t,n),dC(e,e._domeLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._domeLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showScanPlane&&dC(e,e._scanPlaneFrontCommand,e._scanPlaneBackCommand,e._frontFaceRS,e._backFaceRS,e._scanePlaneSP,e._scanPlaneVA,e._scanUniforms,e._computedScanPlaneModelMatrix,t,n)}function eH(){return`attribute vec4 position;
    attribute vec3 normal;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    void main()
    {
    gl_Position = czm_modelViewProjection * position;
    v_position = vec3(position);
    v_positionWC = (czm_model * position).xyz;
    v_positionEC = (czm_modelView * position).xyz;
    v_normalEC = czm_normal * normal;
    }
    `}function $6(){return`#ifdef GL_OES_standard_derivatives
    #extension GL_OES_standard_derivatives : enable
    #endif
    uniform bool u_showIntersection;
    uniform bool u_showThroughEllipsoid;
    uniform float u_radius;
    uniform float u_xHalfAngle;
    uniform float u_yHalfAngle;
    uniform float u_normalDirection;
    uniform float u_type;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    vec4 getColor(float sensorRadius, vec3 pointEC)
    {
    czm_materialInput materialInput;
    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;
    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);
    materialInput.str = pointMC / sensorRadius;
    vec3 positionToEyeEC = -v_positionEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    vec3 normalEC = normalize(v_normalEC);
    materialInput.normalEC = u_normalDirection * normalEC;
    czm_material material = czm_getMaterial(materialInput);
    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);
    }
    bool isOnBoundary(float value, float epsilon)
    {
    float width = getIntersectionWidth();
    float tolerance = width * epsilon;
    #ifdef GL_OES_standard_derivatives
    float delta = max(abs(dFdx(value)), abs(dFdy(value)));
    float pixels = width * delta;
    float temp = abs(value);
    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);
    #else
    return abs(value) < tolerance;
    #endif
    }
    vec4 shade(bool isOnBoundary)
    {
    if (u_showIntersection && isOnBoundary)
    {
    return getIntersectionColor();
    }
    if(u_type == 1.0){
    return getLineColor();
    }
    return getColor(u_radius, v_positionEC);
    }
    void main()
    {
    vec3 sensorVertexWC = czm_model[3].xyz;
    vec3 sensorVertexEC = czm_modelView[3].xyz;
    float positionX = v_position.x;
    float positionY = v_position.y;
    float positionZ = v_position.z;
    vec3 zDir = vec3(0.0, 0.0, 1.0);
    vec3 lineX = vec3(positionX, 0 ,positionZ);
    vec3 lineY = vec3(0, positionY, positionZ);
    float resX = dot(normalize(lineX), zDir);
    if(resX < cos(u_xHalfAngle)-0.00001){
    discard;
    }
    float resY = dot(normalize(lineY), zDir);
    if(resY < cos(u_yHalfAngle)-0.00001){
    discard;
    }
    bool isOnEllipsoid = false;
    gl_FragColor = shade(isOnEllipsoid);
    }
    `}function ON(){return`uniform vec4 u_intersectionColor;
    uniform float u_intersectionWidth;
    uniform vec4 u_lineColor;
    bool inSensorShadow(vec3 coneVertexWC, vec3 pointWC)
    {
    vec3 D = czm_ellipsoidInverseRadii;
    vec3 q = D * coneVertexWC;
    float qMagnitudeSquared = dot(q, q);
    float test = qMagnitudeSquared - 1.0;
    vec3 temp = D * pointWC - q;
    float d = dot(temp, q);
    return (d < -test) && (d / length(temp) < -sqrt(test));
    }
    vec4 getLineColor()
    {
    return u_lineColor;
    }
    vec4 getIntersectionColor()
    {
    return u_intersectionColor;
    }
    float getIntersectionWidth()
    {
    return u_intersectionWidth;
    }
    vec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)
    {
    float t = pointMC.z / sensorRadius;
    float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);
    s = s - floor(s);
    return vec2(s, t);
    }
    `}function dfe(){return`#ifdef GL_OES_standard_derivatives
    #extension GL_OES_standard_derivatives : enable
    #endif
    uniform bool u_showIntersection;
    uniform bool u_showThroughEllipsoid;
    uniform float u_radius;
    uniform float u_xHalfAngle;
    uniform float u_yHalfAngle;
    uniform float u_normalDirection;
    uniform vec4 u_color;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    vec4 getColor(float sensorRadius, vec3 pointEC)
    {
    czm_materialInput materialInput;
    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;
    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);
    materialInput.str = pointMC / sensorRadius;
    vec3 positionToEyeEC = -v_positionEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    vec3 normalEC = normalize(v_normalEC);
    materialInput.normalEC = u_normalDirection * normalEC;
    czm_material material = czm_getMaterial(materialInput);
    material.diffuse = u_color.rgb;
    material.alpha = u_color.a;
    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);
    }
    bool isOnBoundary(float value, float epsilon)
    {
    float width = getIntersectionWidth();
    float tolerance = width * epsilon;
    #ifdef GL_OES_standard_derivatives
    float delta = max(abs(dFdx(value)), abs(dFdy(value)));
    float pixels = width * delta;
    float temp = abs(value);
    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);
    #else
    return abs(value) < tolerance;
    #endif
    }
    vec4 shade(bool isOnBoundary)
    {
    if (u_showIntersection && isOnBoundary)
    {
    return getIntersectionColor();
    }
    return getColor(u_radius, v_positionEC);
    }
    void main()
    {
    vec3 sensorVertexWC = czm_model[3].xyz;
    vec3 sensorVertexEC = czm_modelView[3].xyz;
    float positionX = v_position.x;
    float positionY = v_position.y;
    float positionZ = v_position.z;
    vec3 zDir = vec3(0.0, 0.0, 1.0);
    vec3 lineX = vec3(positionX, 0 ,positionZ);
    vec3 lineY = vec3(0, positionY, positionZ);
    bool isOnEllipsoid =true;
    gl_FragColor = shade(isOnEllipsoid);
    }
    `}var Zg=CI;function xI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this.id=e.id,this._scene=this._viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showSurfaces=Cesium.defaultValue(e.showSurfaces,!0),this.showLines=Cesium.defaultValue(e.showLines,!0),this._colorCommands=[],this._startYaw=Cesium.defaultValue(e.startYaw,0),this._yawSpan=Cesium.defaultValue(e.yawSpan,120),this._yawCount=Cesium.defaultValue(e.yawCount,10),this._startPitch=Cesium.defaultValue(e.startPitch,0),this._pitchSpan=Cesium.defaultValue(e.pitchSpan,50),this._pitchCount=Cesium.defaultValue(e.pitchCount,10),this.m_bClosed=Cesium.defaultValue(e.m_bClosed,!0),this.direction=Cesium.defaultValue(e.direction,0),this._center=new Cesium.Cartesian3,this.radius=Cesium.defaultValue(e.radius,30),this._radius=void 0,this.color=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,0,1)),this._position=void 0,this.position=e.position,this.endPos=Cesium.defaultValue(e.endPos,new Cesium.Cartesian3(0,0,0)),this.modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this.bottomRadius=Cesium.defaultValue(e.bottomRadius,2e3),this.orientation=e.orientation,this._orientation=void 0,this.waveDirection=Cesium.defaultValue(e.waveDirection,"WD_Horizontal"),this.wavePath=Cesium.defaultValue(e.wavePath,"right_Bottom"),this.angularRate=Cesium.defaultValue(e.angularRate,30),this.u_isTexture=Cesium.defaultValue(e.u_isTexture,0),this._texture=void 0,this._imageFilePath=Cesium.defaultValue(e.imageFilePath,Cesium.buildModuleUrl("Assets/EMExtensions/geometry3d.jpg")),this.imageFilePath=void 0,this.ms=Cesium.defaultValue(e.ms,.1),this.wavePoints=[],this.time=new Date().getTime(),this.index=0,this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1,cull:{enabled:!1,face:Cesium.CullFace.BACK}})}),this._sectorVA=void 0,this.showScan=Cesium.defaultValue(e.showScan,!1),this._showScan=void 0,this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}xI.prototype.addRadarWave=function(){var e=this;this.radarWave=this._viewer.entities.add({orientation:new Cesium.CallbackProperty(function(){var t=pfe(e._position,e.endPos);return t.pitch+=Cesium.Math.PI_OVER_TWO,t.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(e._position,t)},!1),position:new Cesium.CallbackProperty(function(){var t=Cesium.Cartesian3.subtract(e._position,e.endPos,new Cesium.Cartesian3),n=Cesium.Cartesian3.divideByScalar(t,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(n,e.endPos,new Cesium.Cartesian3)},!1),cylinder:{length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(e._position,e.endPos)},!1),topRadius:0,bottomRadius:this.bottomRadius,showBottom:!1,showTop:!1,changeStCoordinate:!1,material:Cesium.Color.RED}}),e.wavePoints=mfe(this)};function pfe(e,t){var n=Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),l=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(l,new Cesium.Cartesian3),a=Math.atan2(o.y,o.x)-Cesium.Math.PI_OVER_TWO,s=Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(a),u=Cesium.Transforms.eastNorthUpToFixedFrame(e),l=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),c=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(u,u),l,l);Cesium.Cartesian3.normalize(c,c);var f=Cesium.Math.PI_OVER_TWO-Cesium.Math.acosClamped(c.z),h=new Cesium.HeadingPitchRoll(s,f,0);return h}function mfe(e){var t=[],n=e._startYaw,r=e._startPitch,o=(e._yawSpan-n)/e._yawCount,a=(e._pitchSpan-r)/e._pitchCount,s=Cesium.Transforms.eastNorthUpToFixedFrame(e._position);if(e.waveDirection=="WD_Horizontal")switch(e.wavePath){case"right_Top":for(var u=e._pitchSpan;u>=r;u-=a)for(var l=n;l<=e._yawSpan;l+=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"right_Bottom":for(var u=r;u<=e._pitchSpan;u+=a)for(var l=n;l<=e._yawSpan;l+=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"left_Top":for(var u=e._pitchSpan;u>=r;u-=a)for(var l=e._yawSpan;l>=n;l-=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"left_Bottom":for(var u=r;u<=e._pitchSpan;u+=a)for(var l=e._yawSpan;l>=n;l-=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}}else if(e.waveDirection=="WD_Vertical")for(var u=n;u<=e._yawSpan;u+=o)for(var l=e._pitchSpan;l>=r;l-=a){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(l*Math.PI/180)*Math.sin(Cesium.Math.toRadians(u)),e.radius*Math.cos(l*Math.PI/180)*Math.cos(Cesium.Math.toRadians(u)),e.radius*Math.sin(Cesium.Math.toRadians(l))),new Cesium.Cartesian3);t.push(c)}else if(e.waveDirection=="WD_Random")for(var u=n;u<e._yawSpan;u+=o)for(var f=Math.floor(Math.random()*(e._yawSpan-n+1))+n,l=e._pitchSpan;l>r;l-=a){var h=Math.floor(Math.random()*(e._pitchSpan-r+1))+r,c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(h*Math.PI/180)*Math.sin(Cesium.Math.toRadians(f)),e.radius*Math.cos(l*Math.PI/180)*Math.cos(Cesium.Math.toRadians(f)),e.radius*Math.sin(Cesium.Math.toRadians(h))),new Cesium.Cartesian3);t.push(c)}return t}xI.prototype.update=function(e){var t=this;this._colorCommands.length=0;var n=e.mode,r=e.context,o=this._viewer.scene.frameState.time;if(this.show instanceof Array?gfe(this,o):this._show!=this.show&&(this._show=this.show),!this._show||n!==Cesium.SceneMode.SCENE3D)return;if(this.position instanceof Cesium.SampledPositionProperty?this._position=this.position.getValue(o):this._position!=this.position&&(this._position=this.position),this.showScan&&this._showScan!=this.showScan&&(this._showScan=this.showScan,this.addRadarWave()),this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),this.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this.modelMatrix,this._radius,this.modelMatrix),Cesium.defined(this._orientation)){var a=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(this.direction+this._yawSpan/2),0,0),new Cesium.Matrix3),Cesium.Cartesian3.ZERO,new Cesium.Matrix4);this.modelMatrix=Cesium.Matrix4.multiply(this.modelMatrix,a,new Cesium.Matrix4)}if(this.imageFilePath!=this._imageFilePath){this.imageFilePath=this._imageFilePath;var s=this.imageFilePath,u={flipY:!0,preferImageBitmap:!0};Cesium.Resource.createIfNeeded(s).fetchImage(u).then(l).catch(c)}function l(w){t._texture=new Cesium.Texture({context:r,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_BYTE,source:w,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})}),t._fillCommand.uniformMap={u_isTexture:function(){return t.u_isTexture},u_texture:function(){return t._texture}}}function c(w){console.error(w.message)}Cesium.BoundingSphere.transform(this._boundingSphere,this.modelMatrix,this._boundingSphere),yfe(this,e);var f=new Date().getTime();if(f-this.time>=500&&(this.time=f,Cesium.defined(this.radarWave)&&(this.index>=this.wavePoints.length&&(this.index=0),this.endPos=this.wavePoints[this.index++])),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:r,vertexShaderSource:wfe(),fragmentShaderSource:Efe()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:r,vertexShaderSource:Tfe(),fragmentShaderSource:Sfe()})),this.showSurfaces&&Cesium.defined(this._texture)&&(nH(this._fillVA,this.modelMatrix,this._boundingSphere,this._fillCommand),this._colorCommands.push(this._fillCommand)),this.showLines&&Cesium.defined(this._outlineVA)&&(nH(this._outlineVA,this.modelMatrix,this._boundingSphere,this._outlineCommand),this._colorCommands.push(this._outlineCommand)),!!Cesium.defined(this._texture)){var h=e.commandList,d=e.passes,p=this._colorCommands;if(d.render)for(var _=0,y=p.length;_<y;_++){var v=p[_];h.push(v)}}};xI.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return this.radarWave&&this._viewer.entities.contains(this.radarWave)&&this._viewer.entities.remove(this.radarWave),Cesium.destroyObject(this)};function gfe(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=_fe(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.orientation)&&(e._orientation=e.orientation.getValue(t));return}}else e._show=!1,e._orientation=void 0}function _fe(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function yfe(e,t){var n=t.context;if(e.showSurfaces){var r=vfe(e);e._fillVA=tH(e,n,r,!0)}if(e.showLines){var o=Cfe(e);e._outlineVA=tH(e,n,o,!1)}}function vfe(e){var t=e._yawCount,n=e._pitchCount,r=0,o=e.color,a=e._startYaw,s=e._yawSpan,u=(e._yawSpan-a)/t,l=e._startPitch,c=e._pitchSpan,f=(e._pitchSpan-l)/n,h=0,d=0,p=(t+1)*(n+1);p++;var _=n*t*6;e.m_bClosed&&((l!=-90||c!=90)&&(_+=(t-1)*6),(a!=0||s!=360)&&(_+=(n+1)*6));for(var y=Cesium.IndexDatatype.createTypedArray(p,_),v=new Float64Array(p*3),w=new Uint8Array(p*4),C=new Float32Array(p*2),E=0,S=0,A=0,D=l;D<c+f;D+=f){var P=D>c?c:D;d++,h=0;for(var M=a;M<s+u;M+=u){h++;var b=M>s?s:M,O=Math.cos(Cesium.Math.toRadians(P))*Math.sin(Cesium.Math.toRadians(b)),m=Math.cos(Cesium.Math.toRadians(b))*Math.cos(Cesium.Math.toRadians(P)),I=Math.sin(Cesium.Math.toRadians(P));v[E++]=O+r,v[E++]=m,v[E++]=I;var L=1-(M-a)/(s-a),R=1-(D-l)/(c-l);C[A++]=L,C[A++]=R,w[S++]=Cesium.Color.floatToByte(o.red),w[S++]=Cesium.Color.floatToByte(o.green),w[S++]=Cesium.Color.floatToByte(o.blue),w[S++]=Cesium.Color.floatToByte(o.alpha)}}v[E++]=r,v[E++]=0,v[E++]=0,w[S++]=Cesium.Color.floatToByte(o.red),w[S++]=Cesium.Color.floatToByte(o.green),w[S++]=Cesium.Color.floatToByte(o.blue),w[S++]=Cesium.Color.floatToByte(o.alpha);for(var N=0,D=0;D<d;D++)for(var M=0;M<h;M++)D+1<d&&M+1<h&&(y[N++]=D*h+M,y[N++]=(D+1)*h+M,y[N++]=(D+1)*h+M+1,y[N++]=D*h+M,y[N++]=(D+1)*h+M+1,y[N++]=D*h+M+1);if(e.m_bClosed){var B=d*h;if(l!=-90||c!=90)for(var D=0;D<h-1;D++)y[N++]=B,y[N++]=D,y[N++]=D+1,y[N++]=B,y[N++]=(d-1)*h+D+1,y[N++]=(d-1)*h+D;if(a!=0||s!=360)for(var M=0;M<d+1;M++)y[N++]=B,y[N++]=M*h,y[N++]=(M+1)*h,y[N++]=B,y[N++]=(M+1)*h+h-1,y[N++]=M*h+h-1}return{position:v,color:w,stPosition:C,indices:y}}function Cfe(e){var t=e._yawCount,n=e._pitchCount,r=0,o=e.lineColor,a=1,s=e._startYaw,u=e._yawSpan,l=(e._yawSpan-s)/t,c=e._startPitch,f=e._pitchSpan,h=(e._pitchSpan-c)/n,d=0,p=0,_=(t+1)*(n+1);_++;for(var y=new Float64Array(_*3),v=new Uint8Array(_*4),w=0,C=0,E=c;E<f+h;E+=h){var S=E>f?f:E;p++,d=0;for(var A=s;A<u+l;A+=l){d++;var D=A>u?u:A,P=Math.cos(Cesium.Math.toRadians(S))*Math.sin(Cesium.Math.toRadians(D)),M=Math.cos(Cesium.Math.toRadians(D))*Math.cos(Cesium.Math.toRadians(S)),b=Math.sin(Cesium.Math.toRadians(S));y[w++]=P+r,y[w++]=M,y[w++]=b,v[C++]=Cesium.Color.floatToByte(o.red),v[C++]=Cesium.Color.floatToByte(o.green),v[C++]=Cesium.Color.floatToByte(o.blue),v[C++]=Cesium.Color.floatToByte(o.alpha)}}y[w++]=r,y[w++]=0,y[w++]=0,v[C++]=Cesium.Color.floatToByte(o.red),v[C++]=Cesium.Color.floatToByte(o.green),v[C++]=Cesium.Color.floatToByte(o.blue),v[C++]=Cesium.Color.floatToByte(o.alpha);var O=0,m=(p-1)*d*2+p*(d-1)*2;e.m_bClosed&&(s!=0||u!=360)&&(c!=-90||f!=90)&&(m+=9);for(var I=Cesium.IndexDatatype.createTypedArray(_,m),E=0;E<p;E++)for(var A=0;A<d;A++)E+1<p&&(I[O++]=E*d+A,I[O++]=(E+1)*d+A),A+1<d&&(I[O++]=E*d+A,I[O++]=E*d+A+1);if(e.m_bClosed&&(s!=0||u!=360)&&(c!=-90||f!=90)){var L=p*d;I[O++]=L,I[O++]=0,I[O++]=L,I[O++]=d-1,I[O++]=L,I[O++]=(p-1)*d,I[O++]=L,I[O++]=L-1}return{position:y,color:v,indices:I}}function tH(e,t,n,r){var o=xfe(e),a=Cesium.Buffer.createVertexBuffer({context:t,typedArray:o,usage:Cesium.BufferUsage.STATIC_DRAW}),s=12,u=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),l={czm_modelMatrixRow0:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:u*4,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:u*8,strideInBytes:u*s,instanceDivisor:1}},c=0,f=[];return f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),r&&f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float32Array(n.stPosition.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),l.czm_modelMatrixRow0.index=c++,f.push(l.czm_modelMatrixRow0),l.czm_modelMatrixRow1.index=c++,f.push(l.czm_modelMatrixRow1),l.czm_modelMatrixRow2.index=c++,f.push(l.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:f,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function xfe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r));var a=[],s=e.modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function nH(e,t,n,r){r.vertexArray=e,r.modelMatrix=t,r._boundingVolume=n}function wfe(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec2 st;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
 varying vec2 v_texCoord;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    v_texCoord = st;
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Efe(){var e=`uniform sampler2D u_texture;
uniform float u_isTexture;
varying vec4  v_colour;
varying vec2 v_texCoord;
void main()
{
if(u_isTexture<0.5){  gl_FragColor = v_colour;
}else{
   gl_FragColor = texture2D(u_texture, v_texCoord);
}
}
`;return e}function Tfe(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model*  vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Sfe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var pC=xI;function cE(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.startYaw=Cesium.defaultValue(e.startYaw,0),this.endYaw=Cesium.defaultValue(e.endYaw,360),this.minorRadius=Cesium.defaultValue(e.minorRadius,5300),this._minorRadius=void 0,this.longRadius=Cesium.defaultValue(e.longRadius,15200),this._longRadius=void 0,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this.longRadius),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._attributeLocations=void 0,this._allCommands=[],this.instance=Cesium.defaultValue(e.instance,void 0),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({depthTest:!0})}),this._scene.primitives.add(this)}cE.prototype.update=function(e){this._allCommands.length=0;var t=e.context,n=this;this.longRadius instanceof Cesium.CallbackProperty?this._longRadius=this.longRadius.getValue(e.time):this._longRadius=this.longRadius,this.minorRadius instanceof Cesium.CallbackProperty?this._minorRadius=this.minorRadius.getValue(e.time):this._minorRadius=this.minorRadius,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this._modelMatrix,this._boundingSphere),this._fillCommand.uniformMap={v_colour:function(){return n.fillColor}};var r=this.createFillMesh();this._fillVA=rH(this,t,r),this._outlineCommand.uniformMap={v_colour:function(){return n.lineColor}};var o=this.createOutlineMesh();this._outlineVA=rH(this,t,o),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:iH(),fragmentShaderSource:oH()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:iH(),fragmentShaderSource:oH()})),this._fillCommand.vertexArray=this._fillVA,this._outlineCommand.vertexArray=this._outlineVA,this.renderStyle!=2&&this._allCommands.push(this._fillCommand),this.renderStyle!=1&&this._allCommands.push(this._outlineCommand);var a=e.commandList,s=e.passes,u=this._allCommands;if(this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,s.render&&this._show)for(var l=0,c=u.length;l<c;l++){var f=u[l];a.push(f)}};cE.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function rH(e,t,n){var r=Afe(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Afe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}cE.prototype.createFillMesh=function(){var e=1;if(this.renderStyle==1)var t=this.endYaw-this.startYaw;else{e=15,this.endYaw-this.startYaw<=15&&(e=1);var t=(this.endYaw-this.startYaw)/e+1}t=t*3;for(var n=new Float64Array(t*3),r=t*2,o=this._longRadius,a=this._minorRadius,s=0,u=0,l=Cesium.IndexDatatype.createTypedArray(t,r),c=this.startYaw;c<=this.endYaw;c+=e)n[s++]=a*Math.sin(c*Math.PI/180),n[s++]=a*Math.cos(c*Math.PI/180),n[s++]=0,n[s++]=o*Math.sin(c*Math.PI/180),n[s++]=o*Math.cos(c*Math.PI/180),n[s++]=0;for(var f=0;f<t-1;f++)l[u++]=f,l[u++]=f+1,l[u++]=f+2;return{position:n,indices:l}};cE.prototype.createOutlineMesh=function(){var e=1;if(this.renderStyle==1)var t=this.endYaw-this.startYaw;else{e=15,this.endYaw-this.startYaw<=15&&(e=1);var t=(this.endYaw-this.startYaw)/e+1}t=t*2;for(var n=new Float64Array(t*3),r=t*4,o=this._longRadius,a=this._minorRadius,s=0,u=0,l=Cesium.IndexDatatype.createTypedArray(t,r),c=0,f=this.startYaw;f<this.endYaw+e;f+=e)n[s++]=a*Math.sin(f*Math.PI/180),n[s++]=a*Math.cos(f*Math.PI/180),n[s++]=0,n[s++]=o*Math.sin(f*Math.PI/180),n[s++]=o*Math.cos(f*Math.PI/180),n[s++]=0;for(var h=0;h<t;h+=2)l[u++]=h,l[u++]=h+1,l[u++]=h,h!=t-2&&(l[u++]=h+2,l[u++]=h+1,l[u++]=h+2,l[u++]=h+1,l[u++]=h+3);return{position:n,indices:l}};function iH(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function oH(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var mC=cE;function wI(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.instances))throw new Cesium.DeveloperError("\u53C2\u6570options.instance\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.instances=e.instances,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.viewer=e.viewer,this._scene=this.viewer.scene,this._radius=Cesium.defaultValue(e.radius,10),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._center=new Cesium.Cartesian3,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}wI.prototype.update=function(e){var t=e.context,n=this,r=this._command;this._command.uniformMap={v_colour:function(){return n.lineColor}},Cesium.defined(r.shaderProgram)||(r.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Dfe(),fragmentShaderSource:Pfe()}));var o=this.createLineMesh();if(this.instances.length>0&&(r.vertexArray=bfe(this,t,o),r.instanceCount=this.instances.length,r.cull=!0,r._boundingVolume=this.boundingSphere),this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,Cesium.defined(r.vertexArray)&&this._show){var a=e.commandList;a.push(r)}};wI.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function bfe(e,t,n){var r=Ife(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Ife(e){var t=e.instances,n=t.length,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix,c=Cesium.Matrix4.clone(l,new Cesium.Matrix4);c[12]-=r.x,c[13]-=r.y,c[14]-=r.z,s.push(new Cesium.Cartesian3(c[12],c[13],c[14]));var f=u*o;a[f+0]=c[0],a[f+1]=c[4],a[f+2]=c[8],a[f+3]=c[12],a[f+4]=c[1],a[f+5]=c[5],a[f+6]=c[9],a[f+7]=c[13],a[f+8]=c[2],a[f+9]=c[6],a[f+10]=c[10],a[f+11]=c[14]}return e.boundingSphere=Cesium.BoundingSphere.fromPoints(s),a}wI.prototype.createLineMesh=function(){var e=2,t=new Float64Array(e*3),n=e,r=this.radius,o=0,a=Cesium.IndexDatatype.createTypedArray(e,2);return t[o++]=0,t[o++]=this._radius,t[o++]=0,t[o++]=0,t[o++]=-this._radius,t[o++]=0,a[0]=0,a[1]=1,{position:t,indices:a}};function Dfe(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Pfe(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var EI=wI;function hE(e){if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this.id=e.id,this.ringArr=[],this.entityArr=[],this.circleCenter=e.position,console.log(this.circleCenter),this._position=this.circleCenter,this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this.circleCenter),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),this.show=Cesium.defaultValue(e.show,!0),this._showLines=Cesium.defaultValue(e._showLines,!0),this._rowNumber=Cesium.defaultValue(e.rowNumber,3),this._columnNumber=Cesium.defaultValue(e.columnNumber,6),this.lineShow=Cesium.defaultValue(e.lineShow,!0),this._innerRadius=Cesium.defaultValue(e.innerRadius,4e3),this._innerColor=Cesium.defaultValue(e.innerColor,new Cesium.Color(1,1,0,1)),this.ringRadius=Cesium.defaultValue(e.ringRadius,[4e3,7500,1e4]),this.ringColor=Cesium.defaultValue(e.ringColor,[new Cesium.Color(1,1,0,.5),new Cesium.Color(1,0,0,.5),new Cesium.Color(0,0,1,.5)]),this._labels=this._viewer.scene.primitives.add(new Cesium.LabelCollection),this.distanceDisplayCondition=Cesium.defaultValue(e.distanceDisplayCondition,new Cesium.DistanceDisplayCondition(0,5e5));var t=this;this.createRing(),this.createLabels();var n=this.setInstance();this.line=new EI({viewer:this._viewer,radius:this.ringRadius[this.ringRadius.length-1],instances:n,show:new Cesium.CallbackProperty(function(){return t.show},!1)})}hE.prototype.setInstance=function(){for(var e=[],t=180/this._columnNumber,n=0,r=0;r<this._columnNumber;r++){var o=n*Cesium.Math.PI/180,a=Cesium.Matrix3.fromRotationZ(o,new Cesium.Matrix3),s=Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,a,new Cesium.Matrix4);e.push({modelMatrix:s}),n+=t}return e};hE.prototype.createRing=function(){var e=this._rowNumber,t=this,n=fE(this.circleCenter).height<=0?2:fE(this.circleCenter).height;if(console.log(n),e>0){var r=this._viewer.entities.add({position:this.circleCenter,ellipse:{semiMinorAxis:this._innerRadius,semiMajorAxis:this._innerRadius,material:this._innerColor,height:n}});if(this.entityArr.push(r),this._rowNumber==this.ringRadius.length&&this._rowNumber==this.ringColor.length)for(var o=0;o<this._rowNumber-1;o++){var a=new mC({viewer:this._viewer,show:new Cesium.CallbackProperty(function(){return t.show},!1),minorRadius:this.ringRadius[o],longRadius:this.ringRadius[o+1],fillColor:this.ringColor[o+1],lineColor:this.ringColor[o+1],lon:fE(this.circleCenter).lon,lat:fE(this.circleCenter).lat,height:fE(this.circleCenter).height,renderStyle:1});this.ringArr.push(a)}else throw new DeveloperError("\u5706\u73AF\u6570\u91CF\u4E0E\u53C2\u6570\u4E0D\u5339\u914D\u3002")}};hE.prototype.createLabels=function(){for(var e=this,t=360/(2*this._columnNumber),n=0,r=0;r<this._columnNumber*2;r++){var o=n*Cesium.Math.PI/180,a=new Cesium.Cartesian3((this.ringRadius[this.ringRadius.length-1]+1e3)*Math.sin(o),(this.ringRadius[this.ringRadius.length-1]+1e3)*Math.cos(o),0),s=Cesium.Matrix4.multiplyByPoint(this._modelMatrix,a,new Cesium.Cartesian3),u=this._viewer.entities.add({position:s,label:{text:n+"\xB0",font:"20px \u5B8B\u4F53",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,10),disableDepthTestDistance:Number.POSITIVE_INFINITY,outlineColor:Cesium.Color.RED,style:Cesium.LabelStyle.FILL_AND_OUTLINE,distanceDisplayCondition:e.distanceDisplayCondition,fillColor:Cesium.Color.RED,show:new Cesium.CallbackProperty(function(){return e.show},!1)}});this.entityArr.push(u),n+=t}for(var r=0;r<this._rowNumber;r++){var l=new Cesium.Cartesian3(0,this.ringRadius[r],0),c=Cesium.Matrix4.multiplyByPoint(this._modelMatrix,l,new Cesium.Cartesian3),f=this._viewer.entities.add({position:c,label:{text:Mfe(this.ringRadius[r]),font:"20px \u5B8B\u4F53",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,10),disableDepthTestDistance:Number.POSITIVE_INFINITY,outlineColor:Cesium.Color.RED,style:Cesium.LabelStyle.FILL_AND_OUTLINE,distanceDisplayCondition:e.distanceDisplayCondition,fillColor:Cesium.Color.RED,show:new Cesium.CallbackProperty(function(){return e.show},!1)}});this.entityArr.push(f)}};hE.prototype.destroy=function(){if(this.line&&this.line.destroy(),this.ringArr.length!=0)for(var e=0;e<this.ringArr.length;e++)this.ringArr[e].destroy();if(this.entityArr.length!=0)for(var e=0;e<this.entityArr.length;e++)this._viewer.entities.remove(this.entityArr[e])};function Mfe(e){return e>=1e3?(e/=1e3,e.toFixed(0)+"km"):e.toFixed(0)+"m"}function fE(e){var t=new Cesium.Cartographic.fromCartesian(e,Cesium.Ellipsoid.WGS84),n=Cesium.Math.toDegrees(t.longitude),r=Cesium.Math.toDegrees(t.latitude),o=t.height;return{lon:n,lat:r,height:o}}var TI=hE;function aH(){if(!g(Nu._canTransferArrayBuffer)){let e=new Worker(uH("Workers/transferTypedArrayTest.js"));e.postMessage=T(e.webkitPostMessage,e.postMessage);let t=99,n=new Int8Array([t]);try{e.postMessage({array:n},[n.buffer])}catch{return Nu._canTransferArrayBuffer=!1,Nu._canTransferArrayBuffer}let r=Bo();e.onmessage=function(o){let a=o.data.array,s=g(a)&&a[0]===t;r.resolve(s),e.terminate(),Nu._canTransferArrayBuffer=s},Nu._canTransferArrayBuffer=r.promise}return Nu._canTransferArrayBuffer}var BN=new xe;function sH(e,t){--e._activeTasks;let n=t.id;if(!g(n))return;let r=e._deferreds,o=r[n];if(g(t.error)){let a=t.error;a.name==="RuntimeError"?(a=new at(t.error.message),a.stack=t.error.stack):a.name==="DeveloperError"&&(a=new Le(t.error.message),a.stack=t.error.stack),BN.raiseEvent(a),o.reject(a)}else BN.raiseEvent(),o.resolve(t.result);delete r[n]}function uH(e){let t=La(e);if(xb(t)){let n=`importScripts("${t}");`,r;try{r=new Blob([n],{type:"application/javascript"})}catch{let s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,u=new s;u.append(n),r=u.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(r)}return t}var NN;function Lfe(){return g(NN)||(NN=uH("Workers/cesiumWorkerBootstrapper.js")),NN}function lH(e){let t=new Worker(Lfe());t.postMessage=T(t.webkitPostMessage,t.postMessage);let n={loaderConfig:{paths:{Workers:La("Workers")},baseUrl:La.getCesiumBaseUrl().url},workerModule:e._workerPath};return t.postMessage(n),t.onmessage=function(r){sH(e,r.data)},t}function Rfe(e,t){let n={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!ea.supportsWebAssembly()){if(!g(t.fallbackModulePath))throw new at(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return n.modulePath=La(t.fallbackModulePath),Promise.resolve(n)}return n.modulePath=La(t.modulePath),n.wasmBinaryFile=La(t.wasmBinaryFile),vt.fetchArrayBuffer({url:n.wasmBinaryFile}).then(function(r){return n.wasmBinary=r,n})}function Nu(e,t){let n=new eo.default(e);this._workerPath=n.scheme().length!==0&&n.fragment().length===0?e:Nu._workerModulePrefix+e,this._maximumActiveTasks=T(t,Number.POSITIVE_INFINITY),this._activeTasks=0,this._deferreds={},this._nextID=0}var Ofe=[];Nu.prototype.scheduleTask=function(e,t){if(g(this._worker)||(this._worker=lH(this)),this._activeTasks>=this._maximumActiveTasks)return;++this._activeTasks;let n=this;return Promise.resolve(aH()).then(function(r){g(t)?r||(t.length=0):t=Ofe;let o=n._nextID++,a=Bo();return n._deferreds[o]=a,n._worker.postMessage({id:o,parameters:e,canTransferArrayBuffer:r},t),a.promise})};Nu.prototype.initWebAssemblyModule=function(e){g(this._worker)||(this._worker=lH(this));let t=Bo(),n=this,r=this._worker;return Rfe(this,e).then(function(o){return Promise.resolve(aH()).then(function(a){let s,u=o.wasmBinary;g(u)&&a&&(s=[u]),r.onmessage=function(l){r.onmessage=function(c){sH(n,c.data)},t.resolve(l.data)},r.postMessage({webAssemblyConfig:o},s)})}),t.promise};Nu.prototype.isDestroyed=function(){return!1};Nu.prototype.destroy=function(){return g(this._worker)&&this._worker.terminate(),st(this)};Nu.taskCompletedEvent=BN;Nu._defaultWorkerModulePrefix="Workers/";Nu._workerModulePrefix=Nu._defaultWorkerModulePrefix;Nu._canTransferArrayBuffer=void 0;var jc=Nu;function gC(e){this.vertexData=void 0,this.blUpdateVAO=!1,this.allInvisible=!0,this.backColor=new Cesium.Color(30/255,100/255,50/255,.5);var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1}),uniformMap:{u_backColor:function(){return t.backColor}}})}Object.defineProperties(gC.prototype,{});var Nfe=new jc("createRibbonVertices",1);function Bfe(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec3 normal; 
attribute vec4 color; 
varying vec4  v_colour;
uniform vec4 u_backColor; 
void main()
{
   v_colour = vec4(color.r, color.g, color.b, color.a); 
   vec4 position;
   if(czm_morphTime == 1.0){
       position = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
   }else if(czm_morphTime == 0.0){
       position = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
   }else{
       position = czm_columbusViewMorph(
       czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
       czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
       czm_morphTime);
    }
   vec4 positionEC = czm_modelViewRelativeToEye * position;
   vec4 positionWC = czm_inverseView * positionEC;
   if(dot(normalize(normal), normalize(czm_viewerPositionWC-positionWC.xyz)) < 0.0){
     v_colour = u_backColor; 
   }
   gl_Position = czm_projection * positionEC;
   #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
   #endif
}
`;return e}function Ffe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}gC.prototype.recreateVertexArrays=function(e){this.allInvisible=!0;var t=e.length;if(e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)Cesium.defined(e[r])&&e[r].ribbonVisible&&e[r].trackPoints.length>1&&(n.push({color:e[r].ribbonColor,scale:e[r].ribbonScale,trackPoints:e[r].trackPoints,forwardOffset:e[r].forwardOffset,upOffset:e[r].upOffset}),this.allInvisible=!1);if(n.length>0){var o=Nfe.scheduleTask({ribbons:n});if(!Cesium.defined(o)){n=[];return}var a=this;o.then(function(s){a.vertexData=s,a.blUpdateVAO=!0})}}};gC.prototype.update=function(e){var t=e.context,n=this._command;if(!!Cesium.defined(this.vertexData)){if(this.allInvisible&&Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO){Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy();var r=0,o=[];o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.position3DHighBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.position3DLowBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.normalBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(this.vertexData.colorBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:o,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.vertexData.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.vertexData.position3DHighBuffer.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=new Cesium.BoundingSphere(this.vertexData.boundingSphere.center,this.vertexData.boundingSphere.radius),Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Bfe(),fragmentShaderSource:Ffe()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var a=e.commandList;a.push(n)}this.blUpdateVAO=!1}};gC.prototype.isDestroyed=function(){return!1};gC.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var _C=gC;function FN(e){this.viewer=e.viewer,this.mHorizontalnum=e.mHorizontalnum,this.sectionPoints=e.sectionPoints,this.mpVerticalVector=[],this.mpSplitLineVector=[],this.mpScaleVectorList=[],this.maxAngle=0,this.mOnlyTerrain=!0,this.workName="calculateShadeAnalysist",this._maxTaskConcurrency=T(5,e._maxTaskConcurrency),this.radius=e.radius,this.taskNum=T(e.taskNum,8),this.modelMatrix=e.modelMatrix,this.radarPosition=e.radarPosition}FN.prototype.shadeAnalysistCalculateOnlyTerrain=function(e,t){let n=this.radarPosition,r=1,o=new x,a=this.mHorizontalnum,s=e.length/a;for(let u=0;u<a;u++){qfe(this,u,e);let l=this.mpVerticalVector.length;for(let c=0;c<l;c++){let f=this.mpVerticalVector[c].mPitchAngle,h={};h.verticalAngle=f,h.powerScale=1,this.mpScaleVectorList.push(h)}r-2>l&&(r=r/5),o=this.mpVerticalVector[r].mPitchPoint,kfe(this,n,o,t),Gfe(this,u*s,t,this.mpSplitLineVector,this.mpVerticalVector,n,o)}};FN.prototype.shadeAnalysistCalculateOnlyTerrainByThread=function(e,t){let n=this.mHorizontalnum,r=this,o=this.viewer.scene.globe._surface._tileProvider.tilingScheme.ellipsoid,a=zfe(this),s=[];for(let u=0;u<this.taskNum;u++){let l=new jc(this.workName,this._maxTaskConcurrency);s.push(l),this.promise=l.scheduleTask({taskNum:this.taskNum,count:n,index:u,ellipsoid:o,tileMesh:a,sectionPoints:this.sectionPoints,modelMatrix:this.modelMatrix,vertexVector:e,splitNum:t,radarPosition:this.radarPosition}),l._worker.onmessage=function(c){let f=c.data;if(g(f.index)&&g(f.mpScaleVectorList)){let h=f.index;s[h].destroy();let d=f.mpScaleVectorList,p=d.length;if(h===r.taskNum-1){let _=p-r.sectionPoints.length;for(let y=0;y<p;y++)r.mpScaleVectorList[h*_+y]=d[y]}else for(let _=0;_<p;_++)r.mpScaleVectorList[h*p+_]=d[_]}}}};function zfe(e){let t=e.radarPosition,n=e.radius,r=le.fromCartesian(t),o=Cn.eastNorthUpToFixedFrame(t),a=new x(n*Math.cos(0),n*Math.sin(0),0);G.multiplyByPoint(o,a,a);let s=le.fromCartesian(a),u,l,c,f;l=c=s.longitude,u=f=s.latitude;for(let _=0;_<360;_++){let y=new x(n*Math.cos(_),n*Math.sin(_),0);G.multiplyByPoint(o,y,y);let v=le.fromCartesian(y),w=v.longitude,C=v.latitude;f>C&&(f=C),u<C&&(u=C),l>w&&(l=w),c<w&&(c=w)}let h=new hn(l,f,c,u),d=e.viewer.scene.globe._surface._levelZeroTiles;return Vfe(d,r,h)}function Vfe(e,t,n){let r=[];if(!g(e))return;let o,a,s=e.length;for(a=0;a<s&&(o=e[a],!hn.contains(o.rectangle,t));++a);let u=F_(o._southwestChild,n)?SI(o,n):void 0,l=F_(o._southeastChild,n)?SI(o,n):void 0,c=F_(o._northwestChild,n)?SI(o,n):void 0,f=F_(o._northeastChild,n)?SI(o,n):void 0;return g(u)&&(r=r.concat(u)),g(l)&&(r=r.concat(l)),g(c)&&(r=r.concat(c)),g(f)&&(r=r.concat(f)),r}function SI(e,t){let n=[],r=[];for(;g(e);)e=F_(e._southwestChild,t)||F_(e._southeastChild,t)||F_(e._northwestChild,t)||e._northeastChild,g(e)&&g(e.data)&&g(e.data.renderedMesh)&&r.push(e);for(let o=0;o<r.length;o++){let a=r[o];if(!g(a)||!g(a.data)||!g(a.data.renderedMesh))return;n.push(a.data.mesh)}return n}function F_(e,t){return g(e)&&hn.simpleIntersection(e.rectangle,t)?e:void 0}function kfe(e,t,n,r){e.mpSplitLineVector=[];let o=[];e.maxAngle=-90;let a=le.fromCartesian(t),s=le.fromCartesian(n),u=Math.toDegrees(a.longitude),l=Math.toDegrees(a.latitude),c=Math.toDegrees(s.longitude),f=Math.toDegrees(s.latitude),h=e.viewer.scene.globe.getHeight(a),d=new x.fromDegrees(u,l,h);o=cH(e,r,u,l,c,f,!0),e.mpSplitLineVector=[{mPitchAngle:-90,mPitchPoint:o[0]}];let p=x.normalize(new x(-d.x,-d.y,-d.z));for(let _=0;_<r;_++){let y=x.subtract(o[r-_],d);if(y.x!==0&&y.y!==0&&y.z!==0){let v=x.normalize(y),w=x.dot(p,v),C=Math.toDegrees(Math.acos(w))-90;C>e.maxAngle&&(e.mpSplitLineVector.push({mPitchAngle:C,mPitchPoint:o[r-_]}),e.maxAngle=C)}}}function Gfe(e,t,n,r,o,a,s){let u=o.length;for(let l=0;l<u-1;l++){let c=x.normalize(new x(-a.x,-a.y,-a.z)),f=x.subtract(o[l+1].mPitchPoint,a);if(f.x!==0&&f.y!==0&&f.z!==0){let h=x.normalize(f),d=Math.toDegrees(Math.acos(x.dot(c,h)))-90,p=o[l+1].mPitchPoint;if(!(d>=e.maxAngle)){let _=-100,y=-1,v=-1,w=500,C=r.length;for(let E=0;E<C-1;E++)if(r[E].mPitchAngle>=d?r[E].mPitchAngle<w&&(w=r[E].mPitchAngle,v=E):r[E].mPitchAngle>_&&(_=r[E].mPitchAngle,y=E),v!==-1&&y!==-1){let S=x.subtract(p,a),A=r[v].mPitchPoint,D=r[y].mPitchPoint,P=Hfe(e,n,A,D,d,h),M=0,b=1e8,O=0;for(let N=0;N<P.length;N++){let B=P[N],V=le.fromCartesian(B.vector).height,z=Math.abs(B.linePTHeight-V);z<b&&(b=z,O=N)}let m=P[O],I=le.fromCartesian(m.vector);I.height=m.linePTHeight;let L=le.toCartesian(I);M=x.distance(L,e.radarPosition);let R=M/x.magnitude(S);R>1&&(R=1),R<0&&(R=1e-5),e.mpScaleVectorList[t+u-l-2].powerScale=R,e.mpScaleVectorList[t+u-l-2].verticalAngle=d}}}}}function cH(e,t,n,r,o,a,s){let u=[],l=Ufe(r,n,a,o),c=Math.sin(l),f=Math.cos(Math.toRadians(r)),h=Math.cos(Math.toRadians(a));for(let d=0;d<=t;d++){let p=d/t,_=Math.sin((1-p)*l)/c,y=Math.sin(p*l)/c,v=_*f*Math.cos(Math.toRadians(n))+y*h*Math.cos(Math.toRadians(o)),w=_*f*Math.sin(Math.toRadians(n))+y*h*Math.sin(Math.toRadians(o)),C=_*Math.sin(Math.toRadians(r))+y*Math.sin(Math.toRadians(a)),E=Math.toDegrees(Math.atan2(C,Math.sqrt(v*v+w*w))),S=Math.toDegrees(Math.atan2(w,v)),A=0;s&&(A=e.viewer.scene.globe.getHeight(new le(Math.toRadians(S),Math.toRadians(E)))),u.push(new x.fromDegrees(S,E,A))}return u}function Ufe(e,t,n,r){let o=Math.toRadians(r,t),a=Math.toRadians(n,e),s=Math.sin(a*.5),u=Math.sin(o*.5),l=s*s+Math.cos(Math.toRadians(e))*Math.cos(Math.toRadians(n))*u*u;return 2*Math.asin(Math.min(1,Math.sqrt(l)))}function Hfe(e,t,n,r,o,a){let s=[],u=le.fromCartesian(n),l=le.fromCartesian(r),c=Math.toDegrees(u.longitude),f=Math.toDegrees(u.latitude),h=Math.toDegrees(l.longitude),d=Math.toDegrees(l.latitude),p=cH(e,t,c,f,h,d,!0);for(let _=0;_<p.length;_++){let y={},w=x.distance(p[_],e.radarPosition)/Math.cos(Math.toRadians(o)),C=x.add(e.radarPosition,x.multiplyByScalar(a,w,new x)),E=le.fromCartesian(C);y.linePTHeight=E.height,y.vector=p[_],s.push(y)}return s}function qfe(e,t,n){e.mpVerticalVector=[];let r=n.length/e.mHorizontalnum,o=t*r;for(let a=0;a<r;a++){let s=n[o+r-1-a];s=G.multiplyByVector(e.modelMatrix,new Se(s.x,s.y,s.z,1),new x),e.sectionPoints[a].mPitchPoint=x.fromCartesian4(s),e.mpVerticalVector.push(e.sectionPoints[a])}}var AI=FN;function bI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this._id=e.id,this.id=e.id,this._scene=this._viewer.scene,this.instances=e.instances,this.scanInstances=this.instances,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showScan=Cesium.defaultValue(e.showScan,!0),this._position=Cesium.defaultValue(e.position,new Cesium.Cartesian3(100,20,1e3)),this._colorCommands=[],this._startYaw=Cesium.defaultValue(e.startYaw,0),this._endYaw=Cesium.defaultValue(e.endYaw,360),this._angularRate=Cesium.defaultValue(e.angularRate,50),this.curAngle=Cesium.defaultValue(e.curAngle,0),this.deltaAngle=Cesium.defaultValue(e.deltaAngle,15),this._center=new Cesium.Cartesian3,this.radius=Cesium.defaultValue(e.radius,300),this.isDepthTest=Cesium.defaultValue(e.isDepthTest,!1),this._radius=void 0,this.envelopeColor=Cesium.defaultValue(e.envelopeColor,new Cesium.Color(1,.5,.1,.5)),this.scanColor=Cesium.defaultValue(e.sectorColor,new Cesium.Color(1,1,1,.28)),this._geoCenter=e.geoCenter,this.powerData=Cesium.defaultValue(e.powerData,[]),this.scanInArr=[0,143,142,0,1,143,142,285,284,142,143,285,1,144,143,1,2,144,143,286,285,143,144,286,2,145,144,2,3,145,144,287,286,144,145,287,3,146,145,3,4,146,145,288,287,145,146,288,4,147,146,4,5,147,146,289,288,146,147,289,5,148,147,5,6,148,147,290,289,147,148,290,6,149,148,6,7,149,148,291,290,148,149,291,7,150,149,7,8,150,149,292,291,149,150,292,8,151,150,8,9,151,150,293,292,150,151,293,9,152,151,9,10,152,151,294,293,151,152,294,10,153,152,10,11,153,152,295,294,152,153,295,11,154,153,11,12,154,153,296,295,153,154,296,12,155,154,12,13,155,154,297,296,154,155,297,13,156,155,13,14,156,155,298,297,155,156,298,14,157,156,14,15,157,156,299,298,156,157,299,15,158,157,15,16,158,157,300,299,157,158,300,16,159,158,16,17,159,158,301,300,158,159,301,17,160,159,17,18,160,159,302,301,159,160,302,18,161,160,18,19,161,160,303,302,160,161,303,19,162,161,19,20,162,161,304,303,161,162,304,20,163,162,20,21,163,162,305,304,162,163,305,21,164,163,21,22,164,163,306,305,163,164,306,22,165,164,22,23,165,164,307,306,164,165,307,23,166,165,23,24,166,165,308,307,165,166,308,24,167,166,24,25,167,166,309,308,166,167,309,25,168,167,25,26,168,167,310,309,167,168,310,26,169,168,26,27,169,168,311,310,168,169,311,27,170,169,27,28,170,169,312,311,169,170,312,28,171,170,28,29,171,170,313,312,170,171,313,29,172,171,29,30,172,171,314,313,171,172,314,30,173,172,30,31,173,172,315,314,172,173,315,31,174,173,31,32,174,173,316,315,173,174,316,32,175,174,32,33,175,174,317,316,174,175,317,33,176,175,33,34,176,175,318,317,175,176,318,34,177,176,34,35,177,176,319,318,176,177,319,35,178,177,35,36,178,177,320,319,177,178,320,36,179,178,36,37,179,178,321,320,178,179,321,37,180,179,37,38,180,179,322,321,179,180,322,38,181,180,38,39,181,180,323,322,180,181,323,39,182,181,39,40,182,181,324,323,181,182,324,40,183,182,40,41,183,182,325,324,182,183,325,41,184,183,41,42,184,183,326,325,183,184,326,42,185,184,42,43,185,184,327,326,184,185,327,43,186,185,43,44,186,185,328,327,185,186,328,44,187,186,44,45,187,186,329,328,186,187,329,45,188,187,45,46,188,187,330,329,187,188,330,46,189,188,46,47,189,188,331,330,188,189,331,47,190,189,47,48,190,189,332,331,189,190,332,48,191,190,48,49,191,190,333,332,190,191,333,49,192,191,49,50,192,191,334,333,191,192,334,50,193,192,50,51,193,192,335,334,192,193,335,51,194,193,51,52,194,193,336,335,193,194,336,52,195,194,52,53,195,194,337,336,194,195,337,53,196,195,53,54,196,195,338,337,195,196,338,54,197,196,54,55,197,196,339,338,196,197,339,55,198,197,55,56,198,197,340,339,197,198,340,56,199,198,56,57,199,198,341,340,198,199,341,57,200,199,57,58,200,199,342,341,199,200,342,58,201,200,58,59,201,200,343,342,200,201,343,59,202,201,59,60,202,201,344,343,201,202,344,60,203,202,60,61,203,202,345,344,202,203,345,61,204,203,61,62,204,203,346,345,203,204,346,62,205,204,62,63,205,204,347,346,204,205,347,63,206,205,63,64,206,205,348,347,205,206,348,64,207,206,64,65,207,206,349,348,206,207,349,65,208,207,65,66,208,207,350,349,207,208,350,66,209,208,66,67,209,208,351,350,208,209,351,67,210,209,67,68,210,209,352,351,209,210,352,68,211,210,68,69,211,210,353,352,210,211,353,69,212,211,69,70,212,211,354,353,211,212,354,70,213,212,70,71,213,212,355,354,212,213,355,71,214,213,71,72,214,213,356,355,213,214,356,72,215,214,72,73,215,214,357,356,214,215,357,73,216,215,73,74,216,215,358,357,215,216,358,74,217,216,74,75,217,216,359,358,216,217,359,75,218,217,75,76,218,217,360,359,217,218,360,76,219,218,76,77,219,218,361,360,218,219,361,77,220,219,77,78,220,219,362,361,219,220,362,78,221,220,78,79,221,220,363,362,220,221,363,79,222,221,79,80,222,221,364,363,221,222,364,80,223,222,80,81,223,222,365,364,222,223,365,81,224,223,81,82,224,223,366,365,223,224,366,82,225,224,82,83,225,224,367,366,224,225,367,83,226,225,83,84,226,225,368,367,225,226,368,84,227,226,84,85,227,226,369,368,226,227,369,85,228,227,85,86,228,227,370,369,227,228,370,86,229,228,86,87,229,228,371,370,228,229,371,87,230,229,87,88,230,229,372,371,229,230,372,88,231,230,88,89,231,230,373,372,230,231,373,89,232,231,89,90,232,231,374,373,231,232,374,90,233,232,90,91,233,232,375,374,232,233,375,91,234,233,91,92,234,233,376,375,233,234,376,92,235,234,92,93,235,234,377,376,234,235,377,93,236,235,93,94,236,235,378,377,235,236,378,94,237,236,94,95,237,236,379,378,236,237,379,95,238,237,95,96,238,237,380,379,237,238,380,96,239,238,96,97,239,238,381,380,238,239,381,97,240,239,97,98,240,239,382,381,239,240,382,98,241,240,98,99,241,240,383,382,240,241,383,99,242,241,99,100,242,241,384,383,241,242,384,100,243,242,100,101,243,242,385,384,242,243,385,101,244,243,101,102,244,243,386,385,243,244,386,102,245,244,102,103,245,244,387,386,244,245,387,103,246,245,103,104,246,245,388,387,245,246,388,104,247,246,104,105,247,246,389,388,246,247,389,105,248,247,105,106,248,247,390,389,247,248,390,106,249,248,106,107,249,248,391,390,248,249,391,107,250,249,107,108,250,249,392,391,249,250,392,108,251,250,108,109,251,250,393,392,250,251,393,109,252,251,109,110,252,251,394,393,251,252,394,110,253,252,110,111,253,252,395,394,252,253,395,111,254,253,111,112,254,253,396,395,253,254,396,112,255,254,112,113,255,254,397,396,254,255,397,113,256,255,113,114,256,255,398,397,255,256,398,114,257,256,114,115,257,256,399,398,256,257,399,115,258,257,115,116,258,257,400,399,257,258,400,116,259,258,116,117,259,258,401,400,258,259,401,117,260,259,117,118,260,259,402,401,259,260,402,118,261,260,118,119,261,260,403,402,260,261,403,119,262,261,119,120,262,261,404,403,261,262,404,120,263,262,120,121,263,262,405,404,262,263,405,121,264,263,121,122,264,263,406,405,263,264,406,122,265,264,122,123,265,264,407,406,264,265,407,123,266,265,123,124,266,265,408,407,265,266,408,124,267,266,124,125,267,266,409,408,266,267,409,125,268,267,125,126,268,267,410,409,267,268,410,126,269,268,126,127,269,268,411,410,268,269,411,127,270,269,127,128,270,269,412,411,269,270,412,128,271,270,128,129,271,270,413,412,270,271,413,129,272,271,129,130,272,271,414,413,271,272,414,130,273,272,130,131,273,272,415,414,272,273,415,131,274,273,131,132,274,273,416,415,273,274,416,132,275,274,132,133,275,274,417,416,274,275,417,133,276,275,133,134,276,275,418,417,275,276,418,134,277,276,134,135,277,276,419,418,276,277,419,135,278,277,135,136,278,277,420,419,277,278,420,136,279,278,136,137,279,278,421,420,278,279,421,137,280,279,137,138,280,279,422,421,279,280,422,138,281,280,138,139,281,280,423,422,280,281,423,139,282,281,139,140,282,281,424,423,281,282,424,140,283,282,140,141,283,282,425,424,282,283,425,0,2,1,0,3,2,0,4,3,0,5,4,0,6,5,0,7,6,0,8,7,0,9,8,0,10,9,0,11,10,0,12,11,0,13,12,0,14,13,0,15,14,0,16,15,0,17,16,0,18,17,0,19,18,0,20,19,0,21,20,0,22,21,0,23,22,0,24,23,0,25,24,0,26,25,0,27,26,0,28,27,0,29,28,0,30,29,0,31,30,0,32,31,0,33,32,0,34,33,0,35,34,0,36,35,0,37,36,0,38,37,0,39,38,0,40,39,0,41,40,0,42,41,0,43,42,0,44,43,0,45,44,0,46,45,0,47,46,0,48,47,0,49,48,0,50,49,0,51,50,0,52,51,0,53,52,0,54,53,0,55,54,0,56,55,0,57,56,0,58,57,0,59,58,0,60,59,0,61,60,0,62,61,0,63,62,0,64,63,0,65,64,0,66,65,0,67,66,0,68,67,0,69,68,0,70,69,0,71,70,0,72,71,0,73,72,0,74,73,0,75,74,0,76,75,0,77,76,0,78,77,0,79,78,0,80,79,0,81,80,0,82,81,0,83,82,0,84,83,0,85,84,0,86,85,0,87,86,0,88,87,0,89,88,0,90,89,0,91,90,0,92,91,0,93,92,0,94,93,0,95,94,0,96,95,0,97,96,0,98,97,0,99,98,0,100,99,0,101,100,0,102,101,0,103,102,0,104,103,0,105,104,0,106,105,0,107,106,0,108,107,0,109,108,0,110,109,0,111,110,0,112,111,0,113,112,0,114,113,0,115,114,0,116,115,0,117,116,0,118,117,0,119,118,0,120,119,0,121,120,0,122,121,0,123,122,0,124,123,0,125,124,0,126,125,0,127,126,0,128,127,0,129,128,0,130,129,0,131,130,0,132,131,0,133,132,0,134,133,0,135,134,0,136,135,0,137,136,0,138,137,0,139,138,0,140,139,0,141,140,284,285,286,284,286,287,284,287,288,284,288,289,284,289,290,284,290,291,284,291,292,284,292,293,284,293,294,284,294,295,284,295,296,284,296,297,284,297,298,284,298,299,284,299,300,284,300,301,284,301,302,284,302,303,284,303,304,284,304,305,284,305,306,284,306,307,284,307,308,284,308,309,284,309,310,284,310,311,284,311,312,284,312,313,284,313,314,284,314,315,284,315,316,284,316,317,284,317,318,284,318,319,284,319,320,284,320,321,284,321,322,284,322,323,284,323,324,284,324,325,284,325,326,284,326,327,284,327,328,284,328,329,284,329,330,284,330,331,284,331,332,284,332,333,284,333,334,284,334,335,284,335,336,284,336,337,284,337,338,284,338,339,284,339,340,284,340,341,284,341,342,284,342,343,284,343,344,284,344,345,284,345,346,284,346,347,284,347,348,284,348,349,284,349,350,284,350,351,284,351,352,284,352,353,284,353,354,284,354,355,284,355,356,284,356,357,284,357,358,284,358,359,284,359,360,284,360,361,284,361,362,284,362,363,284,363,364,284,364,365,284,365,366,284,366,367,284,367,368,284,368,369,284,369,370,284,370,371,284,371,372,284,372,373,284,373,374,284,374,375,284,375,376,284,376,377,284,377,378,284,378,379,284,379,380,284,380,381,284,381,382,284,382,383,284,383,384,284,384,385,284,385,386,284,386,387,284,387,388,284,388,389,284,389,390,284,390,391,284,391,392,284,392,393,284,393,394,284,394,395,284,395,396,284,396,397,284,397,398,284,398,399,284,399,400,284,400,401,284,401,402,284,402,403,284,403,404,284,404,405,284,405,406,284,406,407,284,407,408,284,408,409,284,409,410,284,410,411,284,411,412,284,412,413,284,413,414,284,414,415,284,415,416,284,416,417,284,417,418,284,418,419,284,419,420,284,420,421,284,421,422,284,422,423,284,423,424,284,424,425],this.sectionPoints=[],this.vertexPositions=[],this.points=[],this.mpTerrainShade=void 0,this.scanSpeed=Cesium.defaultValue(e.scanSpeed,1500),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._scanModelMatrix=Cesium.defaultValue(e.scanModelMatrix,new Cesium.Matrix4),this.updateRotator=!1,this.changeScan=!1,this._time=new Date().getTime(),this.shadeType=Cesium.defaultValue(e.shadeType,1),this.tsSectionPoint=[{mPitchAngle:0,mPitchPoint:new Cesium.Cartesian3(0,0,0)}],this.maxPowerDistance=0,this.mHorizontalnum=parseInt(360/this.deltaAngle)+1,this.scanIndex=0,this.startTerrainShade=Cesium.defaultValue(e.startTerrainShade,!0),this.updateShade=Cesium.defaultValue(e.updateShade,!1),this.terrainShadeProgress=0,this.filePath=Cesium.defaultValue(e.filePath,Cesium.buildModuleUrl("Assets/EMExtensions/powerData.txt")),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._scanCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._fillVA=void 0,this._outlineVA=void 0,this._scanVA=void 0;var t=new Cesium.Resource({url:this.filePath}),n=this;t.fetchText().then(function(r){for(var o=r.split(`\r
`),a=0;a<o.length-1;a++){var s=o[a].indexOf("=");n.powerData.push({x:o[a].substring(0,s),y:o[a].substring(s+1)})}Wfe(n)}),this._scene.primitives.add(this)}function Wfe(e){e.points=Yfe(e);for(var t=0;t<e.points.length;++t)e.sectionPoints.push(new Cesium.Cartesian3(0,e.points[t].y,e.points[t].x));e.updateRotator=!0}function Yfe(e){var t=[];t.push(new Cesium.Cartesian2(0,0));for(var n=e.powerData.length-1;n>=0;--n){var r=e.powerData[n].y;r>e.maxPowerDistance&&(e.maxPowerDistance=r);var o=Cesium.Math.toRadians(e.powerData[n].x);if(t.push(new Cesium.Cartesian2(r*Math.cos(o),r*Math.sin(o))),e.startTerrainShade){var a={};a.mPitchAngle=Number(e.powerData[n].x),a.mPitchPoint=new Cesium.Cartesian3(0,r*Math.sin(o)*1e3,r*Math.cos(o)*1e3),e.tsSectionPoint.push(a)}}return t.push(new Cesium.Cartesian2(0,0)),e.tsSectionPoint.push({mPitchAngle:0,mPitchPoint:new Cesium.Cartesian3(0,0,0)}),t}bI.prototype.update=function(e){this._colorCommands.length=0;var t=e.mode,n=e.context,r=this._viewer.scene.frameState.time;if(this.show instanceof Array?Xfe(this,r):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){if(this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,!Cesium.defined(this._modelMatrix)){this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,this._radius,this._modelMatrix);var o=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,o,this._modelMatrix),this._scanModelMatrix=this._modelMatrix}if(this.showScan){var a=new Date().getTime();if(a-this._time>this.scanSpeed){if(!this.changeScan)this.instances?this.curAngle+=1:this.curAngle+=this.deltaAngle,this.curAngle=this.curAngle>360?this.curAngle-360:this.curAngle,this.updateScan=!0;else{this.points=[];var s=this.vertexPositions.length/this.mHorizontalnum;this.curAngle+=this.deltaAngle,this.curAngle>=this._endYaw&&(this.curAngle=0,this.scanIndex=0),this.scanIndex=this.mHorizontalnum-1-parseInt(this.curAngle/this.deltaAngle);for(var u=this.vertexPositions.slice(this.scanIndex*s,(this.scanIndex+1)*s),l=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(this.curAngle)),c=Cesium.Matrix3.fromQuaternion(l,new Cesium.Matrix3),f=0;f<u.length;f++){var h=Cesium.Matrix3.multiplyByVector(Cesium.Matrix3.inverse(c,new Cesium.Matrix3),u[f],new Cesium.Cartesian3);this.points.push(h)}}the(this,new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(this.curAngle),0,0),new Cesium.Cartesian3(10,1,1)),this._time=a}}Kfe(this,e),this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:kN(),fragmentShaderSource:GN()}),this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:kN(),fragmentShaderSource:GN()}),this._scanCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:kN(),fragmentShaderSource:GN()}),this.show&&Cesium.defined(this._fillVA)&&VN(this,this._fillVA,this._modelMatrix,this._fillCommand),this.show&&Cesium.defined(this._outlineVA)&&VN(this,this._outlineVA,this._modelMatrix,this._outlineCommand),this.updateScan&&Cesium.defined(this._scanVA)&&VN(this,this._scanVA,this._scanModelMatrix,this._scanCommand);var d=e.commandList,p=e.passes,_=this._colorCommands;if(p.render)for(var f=0,y=_.length;f<y;f++){var v=_[f];d.push(v)}}};bI.prototype.destroy=function(){if(this._scene.primitives.contains(this)){var e=this._scene.primitives._primitives.indexOf(this);e!==-1&&(this._scene.primitives._primitives.splice(e,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return Cesium.destroyObject(this)};bI.prototype.calTerrainShade=function(e){if(Cesium.defined(this.mpTerrainShade))throw new Error("\u5730\u5F62\u906E\u853D\u5DF2\u5F00\u542F");var t=this.maxPowerDistance*this._radius;switch(this.mpTerrainShade=new AI({viewer:this._viewer,sectionPoints:this.tsSectionPoint,mHorizontalnum:this.mHorizontalnum,radarPosition:this._position,modelMatrix:this._modelMatrix,radius:t}),this.shadeType){case 0:this.mpTerrainShade.shadeAnalysistCalculateOnlyTerrain(this.vertexPositions,e);for(var n=0;n<this.vertexPositions.length;n++){var r=this.mpTerrainShade.mpScaleVectorList[n].powerScale;r!=1&&(this.vertexPositions[n]=Cesium.Cartesian3.multiplyByScalar(this.vertexPositions[n],r,new Cesium.Cartesian3))}this.updateShade=!0,this.changeScan=!0;break;case 1:this.mpTerrainShade.shadeAnalysistCalculateOnlyTerrainByThread(this.vertexPositions,e);var o=this,a=0,s=setInterval(function(){o.terrainShadeProgress<99&&o.terrainShadeProgress++,a++;var u=o.mpTerrainShade.mpScaleVectorList,l=(u.length-o.tsSectionPoint.length)/8;if(l>0&&Cesium.defined(u[0])&&Cesium.defined(u[l])&&Cesium.defined(u[l*2])&&Cesium.defined(u[l*3])&&Cesium.defined(u[l*4])&&Cesium.defined(u[l*5])&&Cesium.defined(u[l*6])&&Cesium.defined(u[l*7])&&Cesium.defined(u[0].powerScale)&&Cesium.defined(u[l].powerScale)&&Cesium.defined(u[l*2].powerScale)&&Cesium.defined(u[l*3].powerScale)&&Cesium.defined(u[l*4].powerScale)&&Cesium.defined(u[l*5].powerScale)&&Cesium.defined(u[l*6].powerScale)&&Cesium.defined(u[l*7].powerScale)){clearInterval(s),o.terrainShadeProgress=100;for(var c=0;c<o.vertexPositions.length;c++){var f=u[c].powerScale;f!=1&&(o.vertexPositions[c]=Cesium.Cartesian3.multiplyByScalar(o.vertexPositions[c],f,new Cesium.Cartesian3))}o.updateShade=!0,o.changeScan=!0}},1e3);break;case 2:this.mpTerrainShade.shadeAnalysistCalculateOnlyNearAngle(this.vertexPositions,e,shadeDataList);break;case 3:this.mpTerrainShade.shadeAnalysistCalculateWithTerrainNearAngle(this.vertexPositions,e,shadeDataList);break}};function Xfe(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=jfe(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show);return}}else e._show=!1,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show)}function jfe(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function Kfe(e,t){var n=t.context;if(e.show&&(e.updateRotator||e.updateShade)){e.updateRotator=!1;var r=Zfe(e,e.sectionPoints);e._fillVA=zN(e,n,e._modelMatrix,e.instances,r);var o=Qfe(e,e.sectionPoints);e._outlineVA=zN(e,n,e._modelMatrix,e.instances,o)}if(e.showScan&&e.updateScan&&(e.points.length!=0||e.updateShade)){var a=Jfe(e,e.points);e._scanVA=zN(e,n,e._scanModelMatrix,e.scanInstances,a)}e.updateShade&&(e.updateShade=!1)}function Zfe(e,t){if(!(t.length<=1)){var n=new Cesium.Color(e.envelopeColor.red,e.envelopeColor.green,e.envelopeColor.blue,.2),r=e._startYaw,o=e._endYaw,a=e.deltaAngle,s=(o-r)/a+1,u=s*t.length,l=(s-1)*t.length*6,c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=0,p=0,_=0,y=0;if(e.updateShade){if(e.vertexPositions.length==0)return;y=e.vertexPositions.length/t.length}else for(var v=r;v<o+a;v+=a){y++;for(var w=v>o?o:v,C=0;C<t.length;C++){var E=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.fromQuaternion(E,new Cesium.Matrix3),A=Cesium.Matrix3.multiplyByVector(S,t[C],new Cesium.Cartesian3);e.vertexPositions.push(A)}}for(var D=0;D<e.vertexPositions.length;D++){var P=e.vertexPositions[D];f[d++]=P.x,f[d++]=P.y,f[d++]=P.z,h[p++]=Cesium.Color.floatToByte(n.red),h[p++]=Cesium.Color.floatToByte(n.green),h[p++]=Cesium.Color.floatToByte(n.blue),h[p++]=Cesium.Color.floatToByte(n.alpha)}for(var M=0;M<y;++M)for(var b=0;b<t.length-1;++b)M<y-1&&(c[_++]=M*t.length+b,c[_++]=(M+1)*t.length+b+1,c[_++]=M*t.length+b+1,c[_++]=M*t.length+b,c[_++]=(M+1)*t.length+b,c[_++]=(M+1)*t.length+b+1);return{position:f,color:h,indices:c}}}function Qfe(e,t){if(!(t.length<=1)){var n=e.envelopeColor,r=e._startYaw,o=e._endYaw,a=e.deltaAngle,s=(o-r)/a+1,u=s*t.length,l=u*4,c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=0,p=0,_=0,y=0;if(e.updateShade){if(e.vertexPositions.length==0)return;y=e.vertexPositions.length/t.length}else for(var v=r;v<o+a;v+=a){y++;for(var w=v>o?o:v,C=0;C<t.length;C++)var E=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.fromQuaternion(E,new Cesium.Matrix3),A=Cesium.Matrix3.multiplyByVector(S,t[C],new Cesium.Cartesian3)}for(var D=0;D<e.vertexPositions.length;D++){var P=e.vertexPositions[D];f[d++]=P.x,f[d++]=P.y,f[d++]=P.z,h[p++]=Cesium.Color.floatToByte(n.red),h[p++]=Cesium.Color.floatToByte(n.green),h[p++]=Cesium.Color.floatToByte(n.blue),h[p++]=Cesium.Color.floatToByte(n.alpha)}for(var M=0,b=0;b<y;++b)for(var O=0;O<t.length-1;++O)(b!=y-1||o-r!=360)&&(M++,c[_++]=b*t.length+O,c[_++]=b*t.length+O+1),b<y-1&&(M++,c[_++]=b*t.length+O,c[_++]=(b+1)*t.length+O);return{position:f,color:h,indices:c}}}function Jfe(e,t){for(var n=e.scanColor,r=t.length,o=r*3,a=new Float64Array(r*3),s=new Uint8Array(r*4),u=new Uint32Array(e.scanInArr),l=0,c=0,f=0;f<t.length;++f)e.changeScan?(a[l++]=0,a[l++]=t[f].y,a[l++]=t[f].z):(a[l++]=0,a[l++]=t[f].y,a[l++]=t[f].x),s[c++]=Cesium.Color.floatToByte(n.red),s[c++]=Cesium.Color.floatToByte(n.green),s[c++]=Cesium.Color.floatToByte(n.blue),s[c++]=Cesium.Color.floatToByte(n.alpha);return{position:a,color:s,indices:u}}function zN(e,t,n,r,o){if(r)var a=ehe(e,r);else var a=$fe(e,n);var s=Cesium.Buffer.createVertexBuffer({context:t,typedArray:a,usage:Cesium.BufferUsage.STATIC_DRAW}),u=12,l=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),c={czm_modelMatrixRow0:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:l*u,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:l*4,strideInBytes:l*u,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:l*8,strideInBytes:l*u,instanceDivisor:1}},f=0,h=[];return h.push({index:f++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(o.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),h.push({index:f++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(o.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),c.czm_modelMatrixRow0.index=f++,h.push(c.czm_modelMatrixRow0),c.czm_modelMatrixRow1.index=f++,h.push(c.czm_modelMatrixRow1),c.czm_modelMatrixRow2.index=f++,h.push(c.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:h,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(o.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function $fe(e,t){var n=new Cesium.Matrix4,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(o));var s=[],u=Cesium.Matrix4.clone(t,n);return u[12]-=r.x,u[13]-=r.y,u[14]-=r.z,s.push(new Cesium.Cartesian3(u[12],u[13],u[14])),a[0]=u[0],a[1]=u[4],a[2]=u[8],a[3]=u[12],a[4]=u[1],a[5]=u[5],a[6]=u[9],a[7]=u[13],a[8]=u[2],a[9]=u[6],a[10]=u[10],a[11]=u[14],a}function ehe(e,t){var n=t.length,r=new Cesium.Matrix4,o=e._center,a=12,s=e._vertexBufferTypedArray;Cesium.defined(s)||(s=new Float32Array(n*a));for(var u=[],l=0;l<n;++l){var c=Cesium.Matrix4.clone(t[l],r);c[12]-=o.x,c[13]-=o.y,c[14]-=o.z,u.push(new Cesium.Cartesian3(c[12],c[13],c[14]));var f=l*a;s[f+0]=c[0],s[f+1]=c[4],s[f+2]=c[8],s[f+3]=c[12],s[f+4]=c[1],s[f+5]=c[5],s[f+6]=c[9],s[f+7]=c[13],s[f+8]=c[2],s[f+9]=c[6],s[f+10]=c[10],s[f+11]=c[14]}return s}function VN(e,t,n,r){e.instances?(r.vertexArray=t,r.instanceCount=e.instances.length):(r.vertexArray=t,r.modelMatrix=n),e._colorCommands.push(r)}function the(e,t,n){var r=e.scanInstances;if(r)for(var o=0;o<r.length;o++){var a=Cesium.Matrix3.fromRotationY(t.heading,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(r[o],a,r[o])}else{e._scanModelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e._position),Cesium.Matrix4.multiplyByUniformScale(e._scanModelMatrix,e._radius,e._scanModelMatrix);var s=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(e._scanModelMatrix,s,e._scanModelMatrix);var a=Cesium.Matrix3.fromRotationY(t.heading,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(e._scanModelMatrix,a,e._scanModelMatrix);var u=Cesium.Matrix4.fromScale(n);e._scanModelMatrix=Cesium.Matrix4.multiply(e._scanModelMatrix,u,e._scanModelMatrix)}}function kN(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function GN(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var Qg=bI;function II(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this._id=e.id,this.id=e.id,this._scene=this._viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._center=new Cesium.Cartesian3,this.position=e.position,this._position=void 0,this.outRadius=Cesium.defaultValue(e.outRadius,4e4),this.inRadius=Cesium.defaultValue(e.inRadius,1e4),this._colorCommands=[],this.color=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,.3)),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),this.yawRange=Cesium.defaultValue(e.yawRange,new Cesium.Cartesian2(0,360)),this.pitchRange=Cesium.defaultValue(e.pitchRange,new Cesium.Cartesian2(-90,90)),this.circleDensity=Cesium.defaultValue(e.circleDensity,36),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this.topRadius=Cesium.defaultValue(e.topRadius,3e3),this.angularRate=Cesium.defaultValue(e.angularRate,50),this.waveDirection=Cesium.defaultValue(e.waveDirection,"WD_Horizontal"),this.wavePath=Cesium.defaultValue(e.wavePath,"WP_Z"),this.ms=Cesium.defaultValue(e.ms,100),this.wavePoints=[],this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._sectorVA=void 0,this.showScan=Cesium.defaultValue(e.showScan,!1),this._showScan=void 0,this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}II.prototype.addRadarWave=function(){var e=Cesium.Cartographic.fromCartesian(this._position,Cesium.Ellipsoid.WGS84);e.height+=this.outRadius/2;var t=Cesium.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,Cesium.Ellipsoid.WGS84);this.radarWave=this._viewer.entities.add({position:t,show:this._show,cylinder:{length:this.outRadius,topRadius:this.topRadius,bottomRadius:0,showBottom:!1,showTop:!1,changeStCoordinate:!1,material:this.color}})};II.prototype.update=function(e){this._colorCommands.length=0;var t=e.mode,n=e.context,r=this._viewer.scene.frameState.time;if(this.show instanceof Array?nhe(this,r):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){this.position instanceof Cesium.ConstantPositionProperty?this._position=this.position.getValue(e.time):this._position=this.position,this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix);var o=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,o,this._modelMatrix),this.showScan&&this._showScan!=this.showScan&&(this._showScan=this.showScan,this.addRadarWave()),ihe(this,e),this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:dH(),fragmentShaderSource:pH()}),this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:dH(),fragmentShaderSource:pH()}),this.renderStyle!=2&&Cesium.defined(this._fillVA)&&hH(this,this._fillVA,this._modelMatrix,this._boundingSphere,this._fillCommand),this.renderStyle!=1&&Cesium.defined(this._outlineVA)&&hH(this,this._outlineVA,this._modelMatrix,this._boundingSphere,this._outlineCommand);var a=e.commandList,s=e.passes,u=this._colorCommands;if(s.render)for(var l=0,c=u.length;l<c;l++){var f=u[l];a.push(f)}}};II.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return this.radarWave&&this._viewer.entities.contains(this.radarWave)&&this._viewer.entities.remove(this.radarWave),Cesium.destroyObject(this)};function nhe(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=rhe(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show);return}}else e._show=!1,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show)}function rhe(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function ihe(e,t){var n=t.context;if(e.renderStyle!=2&&!Cesium.defined(e._fillVA)){var r=ohe(e);e._fillVA=fH(e,n,r)}if(e.renderStyle!=1&&!Cesium.defined(e._outlineVA)){var o=ahe(e);e._outlineVA=fH(e,n,o)}}function ohe(e){var t=mH(e);if(!(t.length<=1)){var y=0,n=0,r=e.yawRange.y-e.yawRange.x,o=e.pitchRange.y-e.pitchRange.x,a=360/e.circleDensity,s=(r/a+1)*t.length,u=(r/a+1)*(t.length-1)*6;r<360&&(s+=(o/a+1)*4,u+=o/a*12);for(var l=Cesium.IndexDatatype.createTypedArray(s,u),c=new Float64Array(s*3),f=new Uint8Array(s*4),h=e.color,d=0,p=0,_=0,y=0,v=n;v<r+a;v+=a){y++;for(var w=v>r?r:v,C=0;C<t.length;C++){var E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.multiplyByVector(E,t[C],new Cesium.Cartesian3);c[d++]=S.x,c[d++]=S.y,c[d++]=S.z,f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha)}}for(var v=0;v<y;++v)for(var C=0;C<t.length-1;++C)v<y-1&&(l[_++]=v*t.length+C,l[_++]=(v+1)*t.length+C+1,l[_++]=v*t.length+C+1,l[_++]=v*t.length+C,l[_++]=(v+1)*t.length+C,l[_++]=(v+1)*t.length+C+1);if(r<360){for(var A=d/3,D=0,P=e.pitchRange.x;P<e.pitchRange.y+a;P+=a){D++;var M=P>e.pitchRange.y?e.pitchRange.y:P,b=Jg(e.inRadius,n,M),O=Jg(e.inRadius,r,M),m=Jg(e.outRadius,n,M),I=Jg(e.outRadius,r,M),E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-r));b=Cesium.Matrix3.multiplyByVector(E,b,new Cesium.Cartesian3),O=Cesium.Matrix3.multiplyByVector(E,O,new Cesium.Cartesian3),m=Cesium.Matrix3.multiplyByVector(E,m,new Cesium.Cartesian3),I=Cesium.Matrix3.multiplyByVector(E,I,new Cesium.Cartesian3),c[d++]=b.x,c[d++]=b.y,c[d++]=b.z,c[d++]=O.x,c[d++]=O.y,c[d++]=O.z,c[d++]=m.x,c[d++]=m.y,c[d++]=m.z,c[d++]=I.x,c[d++]=I.y,c[d++]=I.z,f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha)}for(var v=0;v<D-1;++v)l[_++]=A+v*4+0,l[_++]=A+(v+1)*4+0,l[_++]=A+v*4+2,l[_++]=A+v*4+2,l[_++]=A+(v+1)*4+0,l[_++]=A+(v+1)*4+2,l[_++]=A+v*4+1,l[_++]=A+v*4+3,l[_++]=A+(v+1)*4+1,l[_++]=A+v*4+3,l[_++]=A+(v+1)*4+3,l[_++]=A+(v+1)*4+1}return{position:c,color:f,indices:l}}}function ahe(e){var t=mH(e);if(!(t.length<=1)){var n=0,r=0,o=e.yawRange.y-e.yawRange.x,a=e.pitchRange.y-e.pitchRange.x,s=360/e.circleDensity,u=(o/s+1)*t.length,l=(o/s+1)*(t.length-1)*4;o<360&&(u+=a/s*4,l+=(a/s-1)*4);for(var c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=e.lineColor,p=0,_=0,y=0,v=r;v<o+s;v+=s){n++;for(var w=v>o?o:v,C=0;C<t.length;C++){var E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.multiplyByVector(E,t[C],new Cesium.Cartesian3);f[p++]=S.x,f[p++]=S.y,f[p++]=S.z,h[_++]=Cesium.Color.floatToByte(d.red),h[_++]=Cesium.Color.floatToByte(d.green),h[_++]=Cesium.Color.floatToByte(d.blue),h[_++]=Cesium.Color.floatToByte(d.alpha)}}for(var v=0;v<n;++v)for(var C=0;C<t.length-1;++C)(v!=n-1||o-r!=360)&&(c[y++]=v*t.length+C,c[y++]=v*t.length+C+1),v<n-1&&(c[y++]=v*t.length+C,c[y++]=(v+1)*t.length+C);if(o<360){for(var A=p/3,D=0,P=e.pitchRange.x;P<e.pitchRange.y+s;P+=s){D++;var M=P>e.pitchRange.y?e.pitchRange.y:P,b=Jg(e.inRadius,0,M),O=Jg(e.inRadius,o,M),m=Jg(e.outRadius,0,M),I=Jg(e.outRadius,o,M);b=Cesium.Matrix3.multiplyByVector(E,b,new Cesium.Cartesian3),O=Cesium.Matrix3.multiplyByVector(E,O,new Cesium.Cartesian3),m=Cesium.Matrix3.multiplyByVector(E,m,new Cesium.Cartesian3),I=Cesium.Matrix3.multiplyByVector(E,I,new Cesium.Cartesian3),f[p++]=b.x,f[p++]=b.y,f[p++]=b.z,f[p++]=O.x,f[p++]=O.y,f[p++]=O.z,f[p++]=m.x,f[p++]=m.y,f[p++]=m.z,f[p++]=I.x,f[p++]=I.y,f[p++]=I.z,h[_++]=Cesium.Color.floatToByte(d.red),h[_++]=Cesium.Color.floatToByte(d.green),h[_++]=Cesium.Color.floatToByte(d.blue),h[_++]=Cesium.Color.floatToByte(d.alpha),h[_++]=Cesium.Color.floatToByte(d.red),h[_++]=Cesium.Color.floatToByte(d.green),h[_++]=Cesium.Color.floatToByte(d.blue),h[_++]=Cesium.Color.floatToByte(d.alpha),h[_++]=Cesium.Color.floatToByte(d.red),h[_++]=Cesium.Color.floatToByte(d.green),h[_++]=Cesium.Color.floatToByte(d.blue),h[_++]=Cesium.Color.floatToByte(d.alpha),h[_++]=Cesium.Color.floatToByte(d.red),h[_++]=Cesium.Color.floatToByte(d.green),h[_++]=Cesium.Color.floatToByte(d.blue),h[_++]=Cesium.Color.floatToByte(d.alpha)}for(var v=0;v<D-1;++v)c[y++]=A+v*4+0,c[y++]=A+v*4+2,c[y++]=A+v*4+1,c[y++]=A+v*4+3}return{position:f,color:h,indices:c}}}function mH(e){for(var t=[],n=[],r=360/e.circleDensity,o=e.pitchRange.x;o<e.pitchRange.y+r;o+=r){var a=o>e.pitchRange.y?e.pitchRange.y:o,s=e.inRadius*Math.cos(Cesium.Math.toRadians(a))*Math.sin(Cesium.Math.toRadians(0)),u=e.inRadius*Math.sin(Cesium.Math.toRadians(a)),l=e.inRadius*Math.cos(Cesium.Math.toRadians(a))*Math.cos(Cesium.Math.toRadians(0)),c=e.outRadius*Math.cos(Cesium.Math.toRadians(a))*Math.sin(Cesium.Math.toRadians(0)),f=e.outRadius*Math.sin(Cesium.Math.toRadians(a)),h=e.outRadius*Math.cos(Cesium.Math.toRadians(a))*Math.cos(Cesium.Math.toRadians(0));t.push(new Cesium.Cartesian3(s,u,l)),n.push(new Cesium.Cartesian3(c,f,h))}for(var o=n.length-1;o>=0;--o)t.push(n[o]);return t.length>0&&t.push(t[0]),t}function Jg(e,t,n){var r=e*Math.cos(Cesium.Math.toRadians(n))*Math.sin(Cesium.Math.toRadians(t)),o=e*Math.sin(Cesium.Math.toRadians(n)),a=e*Math.cos(Cesium.Math.toRadians(n))*Math.cos(Cesium.Math.toRadians(t));return new Cesium.Cartesian3(r,o,a)}function fH(e,t,n){var r=she(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function she(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r));var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function hH(e,t,n,r,o){o.vertexArray=t,o.modelMatrix=n,o._boundingVolume=r,e._colorCommands.push(o)}function dH(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function pH(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var yC=II;function UN(e,t){this.viewer=e,this.GeometryArr=[],this.callback=t}UN.prototype={constructor:UN,drawClampToGroundLine:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,polyline:{positions:e.positions,width:e.lineWidth,material:e.material,clampToGround:!0}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawPolygon:function(e){var t=this,n=t.viewer.entities.add({id:e.id,polygon:{hierarchy:e.hierarchy,material:Cesium.Color.RED,outline:e.outline,outlineColor:e.outlineColor,arcType:Cesium.ArcType.RHUMB,height:e.height}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawEllipse:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,ellipse:{semiMinorAxis:e.semiMinorAxis,semiMajorAxis:e.semiMajorAxis,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,material:e.material,isCompareAxis:e.isCompareAxis,height:e.height}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawPoint:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,point:{pixelSize:e.point.pixelSize,Color:e.color,outlineColor:e.outlineColor,disableDepthTestDistance:Number.POSITIVE_INFINITY}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCurve:function(e){var t=this,n=new vI({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,radius:e.radius});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCuboid:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,rectangle:{coordinates:e.coordinates,extrudedHeight:e.extrudedHeight,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,stRotation:e.stRotation,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCylinder:function(e){var t=this,n=this.viewer.entities.add({id:e.id,orientation:e.orientation,position:e.position,startPosition:e.startPosition,endPosition:e.endPosition,cylinder:{length:e.length,topRadius:e.topRadius,bottomRadius:e.bottomRadius,material:Cesium.Color.RED.withAlpha(.4),outline:e.outline,outlineColor:e.outlineColor,color:e.color,slices:e.slices,showBottom:e.showBottom,showTop:e.showTop}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawEllipsoid:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,ellipsoid:{radii:e.radii,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,slicePartitions:e.slicePartitions,stackPartitions:e.stackPartitions,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCommonBox:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,box:{dimensions:e.dimensions,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,height:1,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawVehicleRadar:function(e){var t=this,n=new Zg({viewer:t.viewer,id:e.id,position:e.position,radius:e.radius,color:e.color,showScanPlane:e.showScanPlane,scanPlaneColor:e.scanPlaneColor,scanPlaneRate:e.scanPlaneRate});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawFlightBillboard:function(e){var t=new Date,n=new Date(t.getTime()+1e5),r=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(t),currentTime:Cesium.JulianDate.fromDate(t),stopTime:Cesium.JulianDate.fromDate(n),clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,clockRange:Cesium.ClockRange.CLAMPED}),o=new CesiumEMExtensions.EV_DatagramManager({viewer}),a=new CesiumEMExtensions.EV_MovingTargetManager({viewer,ev_dataMgr:o,trainingClock:r});setTimeout(function(){r.shouldAnimate=!0,console.log(r.currentTime),r.tick(),o.receiveData.raiseEvent(o.receiveMTFlightDatas,CesiumEMExtensions.EV_DataOperated.ADD)},1e3)},drawFlightRibbon:function(e){},drawParseArrayRadar:function(e){var t=this,n=new pC({viewer:t.viewer,id:e.id,position:e.position,radius:e.radius});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawMechanicalRadar:function(e){var t=this,n=new Qg({viewer,id:e.id,position:e.position,showScan:e.showScan});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCustomizedPARadar:function(e){var t=this,n=new yC({viewer,position:e.position,pitchRange:new Cesium.Cartesian2(0,40),lineColor:e.lineColor,color:e.color,id:e.id});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawFanRing:function(e){var t=this,n=new mC({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,longRadius:e.longRadius,minorRadius:e.minorRadius,fillColor:e.fillColor,lineColor:e.lineColor,renderStyle:e.renderStyle});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawAnnulus:function(e){var t=this,n=new Pb({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,outerRadius:e.outerRadius,innerRadius:e.innerRadius,fillColor:e.fillColor,lineColor:e.lineColor,renderStyle:e.renderStyle});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawTargetRing:function(e){var t=this,n=new TI({viewer:t.viewer,id:e.id,position:e.position});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCommunicationLink:function(e){var t=this,n=this.viewer.entities.add({id:e.id,orientation:e.orientation,position:e.position,cylinder:{length:e.length,topRadius:e.topRadius,bottomRadius:e.bottomRadius,slices:e.slices,showBottom:e.showBottom,showTop:e.showTop,changeStCoordinate:e.changeStCoordinate,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},computeCircle:function(e){for(var t=[],n=0;n<360;n++){var r=Cesium.Math.toRadians(n);t.push(new Cesium.Cartesian2(e*Math.cos(r),e*Math.sin(r)))}return t},drawPolylineVolume:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,polylineVolume:{positions:e.positions,shape:e.shape,material:e.material,outline:e.outline,outlineColor:e.outlineColor}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawBoxVolume:function(e){var t=this,n=t.viewer.entities.add({id:e.id,polylineVolume:{positions:e.positions,shape:e.shape,cornerType:e.cornerType,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCorridor:function(e){var t=this,n=t.viewer.entities.add({id:e.id,corridor:{positions:e.positions,width:e.width,height:e.height,extrudedHeight:e.extrudedHeight,cornerType:e.cornerType,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawLine:function(e){var t=this,n=t.viewer.entities.add({id:e.in_id,polyline:{positions:e.in_positions,width:e.in_width,material:e.in_color}});t.windageLine.push(n)},getOneEntity:function(e){var t=this;return t.viewer.entities.getById(e)},removeOneEntity:function(e){var t=this,n=t.GeometryArr.find(function(o){return o.id==e});if(e.indexOf("\u98D8\u5E26")>-1){this.removeRibbon();return}n instanceof Cesium.Entity?t.viewer.entities.remove(n):n.remove();var r=t.GeometryArr.indexOf(e);r>-1&&(t.GeometryArr.splice(r,1),console.log("json",t.GeometryArr))},removeAllEntity:function(){for(var e=this,t=0;t<e.GeometryArr.length;t++)e.GeometryArr[t]instanceof Cesium.Entity?e.viewer.entities.remove(e.GeometryArr[t]):e.GeometryArr[t]instanceof _C?e.viewer.scene.primitives.remove(e.GeometryArr[t]):e.GeometryArr[t].remove();e.GeometryArr=[]}};var DI=UN;function ni(e){this._viewer=e.viewer,this.callback=e.callback,this._draw=new DI(this._viewer,this.callback),this.index=0,this._points=this._viewer.scene.primitives.add(new Cesium.PointPrimitiveCollection),this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._stop=!1}ni.prototype.exportLayerData=function(e){var t=[];if(e.length>0)for(var n=0;n<e.length;n++){var r=this._draw.GeometryArr.find(function(s){return s.id==e[n].label});r&&t.push(r)}var o={SITSYMBOLFILE:{LayerGroup:[]}},a=this};ni.prototype.drawLine=function(e){var t=this,n=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),r=Cesium.defaultValue(e.lineWidth,3),o=e.positions;window.positionsL=o;var a=o[0],s=e.id,u=this._viewer.entities.getById(s);if(!u){t._draw.drawClampToGroundLine({id:s,position:a,positions:new Cesium.CallbackProperty(function(){return o},!1),lineWidth:r,material:n,clampToGround:!0});var u=this._viewer.entities.getById(s)}return u.geometryType="LineString",u};ni.prototype.getLineAttr=function(e){PI="line";var t=!0,n=!1,r=!1,o=this,a=[];Fo=function(u){if(o._stop&&(Kr(u),Na=!1),t&&(a.push(u),a.length==1))return a.push(new Cesium.Cartesian3(u.x+1,u.y+1,u.z)),n=!0,a},as=function(u){if(o._stop&&(Kr(u),Na=!1),n)return a[a.length-1]=u,a},Kr=function(u){if(!r){t=!1,n=!1,r=!0;var l=MI(a);return a=[],l}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u6298\u7EBF_"+o.index;u==="rightClick"&&o.index++,e(u,l,c)}};ni.prototype.drawPolygon=function(e){var t=this,n=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),o=Cesium.defaultValue(e.outline,!1),a=Cesium.defaultValue(e.height,void 0),s=e.positions,u=s[0],l=e.id,c=this._viewer.entities.getById(l);if(!c){t._draw.drawPolygon({id:l,position:u,hierarchy:new Cesium.CallbackProperty(function(){return{positions:s}},!1),material:n,outline:o,outlineColor:r,height:e.height});var c=this._viewer.entities.getById(l)}return c.geometryType="Polygon",c};ni.prototype.getPolygonAttr=function(e){PI="polygon";var t=this,n=!0,r=!1,o=!1,a=[];Fo=function(u){if(t._stop&&(Kr(u),Na=!1),n)return a.push(u),r=!0,a},as=function(u){if(t._stop&&(Kr(u),Na=!1),r)return a.length==1?a.push(u):a[a.length-1]=u,a},Kr=function(u){if(!o)return n=!1,r=!1,o=!0,a=[],a},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u591A\u8FB9\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ni.prototype.drawRectangle=function(e){var t=this,n=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),o=Cesium.defaultValue(e.outline,2),a=e.positions,s=e.height,u=e.id,l=this._viewer.entities.getById(u);if(!l){t._draw.drawPolygon({id:u,hierarchy:new Cesium.CallbackProperty(function(){var f=[a[0],Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[0]).longitude),Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[1]).latitude)),a[1],Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[1]).longitude),Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[0]).latitude))];return{positions:f}},!1),material:n,outline:o,outlineColor:r,height:s});var l=this._viewer.entities.getById(u)}return l.geometryType="Rectangle",l};ni.prototype.getRectangleAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];Fo=function(u){if(t._stop&&(Kr(u),Na=!1),n){if(n=!1,r=!0,a.length===0){var l=new Cesium.Cartesian3(u.x+100,u.y+100,u.z);a[0]=u,a[1]=l}else if(a.length===2)return}},as=function(u){if(t._stop&&(Kr(u),Na=!1),r)return a[1]=u,a},Kr=function(u){if(!o){var l=MI(a);return a=[],n=!1,r=!1,o=!0,l}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u77E9\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ni.prototype.drawCircle=function(e){var t=this,n=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),o=e.positions,a=Cesium.defaultValue(e.outline,!1),s=e.height,u=o[0],l=e.id,c=this._viewer.entities.getById(l);if(!c){t._draw.drawEllipse({id:l,position:new Cesium.CallbackProperty(function(){return o[0]},!1),semiMinorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),semiMajorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),material:n,isCompareAxis:!1,outline:a,outlineColor:r,outlineWidth:1,height:s});var c=this._viewer.entities.getById(l)}return c.geometryType="Circle",c};ni.prototype.getCircleAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=this._points,s=1,u=[];Fo=function(c){if(t._stop&&(Kr(c),Na=!1),n){if(u.push(c),u.length==1){var f={x:u[0].x+10,y:u[0].y+10,z:u[0].z};u.push(f),f=void 0}var h=Cesium.Cartographic.fromCartesian(u[0]);h.height=0;var d=Cesium.Cartographic.fromCartesian(u[1]);return h.height=0,u[2]=Cesium.Cartesian3.distance(u[0],u[1]),n=!1,r=!0,u}},as=function(c){if(t._stop&&(Kr(c),Na=!1),r){u[1]=c;var f=Cesium.Cartographic.fromCartesian(u[0]);f.height=0;var h=Cesium.Cartographic.fromCartesian(u[1]);return f.height=0,console.log(hhe(f,h)),u[2]=Cesium.Cartesian3.distance(u[0],u[1]),console.log(u[2]),u}},Kr=function(c){if(!o){s=Cesium.Cartesian3.distance(u[0],c),n=!1,r=!1,o=!0;var f=MI(u);return u=[],f}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,l);function l(c,f){var h="\u5706\u5F62_"+t.index;c==="rightClick"&&t.index++,e(c,f,h)}};ni.prototype.drawEllipse=function(e){var t=this,n=e.positions,r=n[0],o=e.id,a=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),s=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),u=this._viewer.entities.getById(o);if(!u){t._draw.drawEllipse({id:o,position:new Cesium.CallbackProperty(function(){return n[0]},!1),semiMinorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(n[0],n[1])},!1),semiMajorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(n[0],n[2])},!1),isCompareAxis:!1,material:a,outline:!0,outlineColor:s,outlineWidth:1});var u=this._viewer.entities.getById(o)}return u.geometryType="Ellipse",u};ni.prototype.getEllipseAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];a[3]=100,a[4]=100,Fo=function(u){if(t._stop&&(Kr(u),Na=!1),n)return o=!1,a[0]?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1]),r=!1,n=!1):(a[0]=u,a[1]=new Cesium.Cartesian3(u.x,u.y+1e3,u.z),a[2]=new Cesium.Cartesian3(u.x+1e3,u.y,u.z),r=!0),a},as=function(u){return t._stop&&(Kr(u),Na=!1),r?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1])):o||(a[2]=u,a[4]=Cesium.Cartesian3.distance(a[0],a[2])),a},Kr=function(u){if(!o)return r?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1])):(a[2]=u,a[4]=Cesium.Cartesian3.distance(a[0],a[2])),a=[],n=!1,r=!1,o=!0,a},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u692D\u5706_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ni.prototype.drawCurve=function(e){var t=this,n=!0,r=!1,o=[],a=10;Fo=function(s){if(n){o.push(s);var u=WN(s),l=t._draw.drawCurve({id:"\u5F27_"+t.index++,lon:u.lon,lat:u.lat,height:u.height,radius:new Cesium.CallbackProperty(function(){return a},!1)});n=!1,r=!0}},as=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s))},Kr=function(s){a=Cesium.Cartesian3.distance(o[0],s),r=!1},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawSectorPlane=function(e){var t=this,n=Cesium.defaultValue(e.yawAngle,30),r=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),o=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),a=Cesium.defaultValue(e.outline,!1),s=e.positions,u=e.id,l=this._viewer.entities.getById(u);return l||(t._draw.drawPolygon({id:u,hierarchy:new Cesium.CallbackProperty(function(){n=s[3];var c=HN(s[0],s[1]),f=Cesium.Cartesian3.distance(s[0],s[1]),h=uhe(s[0],c,f,s[3]);return{positions:h}},!1),outline:a,outlineColor:o,material:r}),l=this._viewer.entities.getById(u)),l.geometryType="SectorPlane",l};ni.prototype.getSectorPlaneAttr=function(e){PI="SectorPlane";var t=this,n=!0,r=!1,o=!1,a=[];Fo=function(u){if(t._stop&&(Kr(u),Na=!1),n)return a.push(u),r=!0,a[1]=new Cesium.Cartesian3(u.x+10,u.y+10,u.z),a[2]=Cesium.Cartesian3.distance(a[0],a[1]),a[3]=30,a},as=function(u){if(t._stop&&(Kr(u),Na=!1),r)return a.length==1?a.push(u):(a[1]=u,a[2]=Cesium.Cartesian3.distance(a[0],a[1])),a},Kr=function(u){if(!o)return n=!1,r=!1,o=!0,a=[],a},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u6247\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ni.prototype.drawSectorPlaneByThreePoint=function(e){var t=this,n=e.positions,r=e.id,o=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),a=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),s=Cesium.defaultValue(e.outline,!1),u=this._viewer.entities.getById(r);return u||(t._draw.drawPolygon({id:r,hierarchy:new Cesium.CallbackProperty(function(){var l=HN(n[0],n[1]);if(u)var c=Cesium.defaultValue(u.index,1);var f=Cesium.Cartesian3.distance(n[0],n[c]),h=HN(n[0],n[2]),d=lhe(n[0],l,h,f);return{positions:d}},!1),outline:s,color:o,outlineColor:a}),u=this._viewer.entities.getById(r)),u.geometryType="SectorPlaneByThreePoint",u};ni.prototype.getSectorPlaneByThreePointAttr=function(e){PI="SectorPlaneByThreePoint";var t=this,n=!0,r=0,o=!1,a=!1,s=[];Fo=function(l){if(t._stop&&(Kr(l),Na=!1),n)return o=!0,r==0?(s.push(l),s[1]=new Cesium.Cartesian3(l.x+10,l.y+10,l.y),s[2]=new Cesium.Cartesian3(s[1].x+10,s[1].y+10,l.y),s[3]=Cesium.Cartesian3.distance(s[0],s[1])):r==1&&(s[1]=l),r++,s},as=function(l){if(t._stop&&(Kr(l),Na=!1),o)return r==1?(s[1]=l,s[3]=Cesium.Cartesian3.distance(s[0],s[1])):r==2&&(s[2]=l),s},Kr=function(l){if(r==2)return a?void 0:(n=!1,o=!1,a=!0,s=[],s)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,u);function u(l,c){var f="\u6247\u5F622_"+t.index;l==="rightClick"&&t.index++,e(l,c,f)}};function HN(e,t){var n=new Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),o=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Matrix4),a=Cesium.Cartesian3.normalize(o,new Cesium.Cartesian3),s=Math.atan2(a.y,a.x)-Cesium.Math.PI_OVER_TWO;return s=Cesium.Math.toDegrees(Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(s)),s}function uhe(e,t,n,r){for(var o=[e],a=r/10,s=-r;s<r;s+=a)o.push(_H(e,-(t+s),n));return o}function lhe(e,t,n,r){for(var o=[e],a=t;a<n;a+=1)o.push(_H(e,-(t+a),r));return o}function _H(e,t,n){var r=new Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t||0)),a=Cesium.Matrix4.fromRotationTranslation(o);Cesium.Matrix4.multiply(r,a,r);var s=new Cesium.Matrix4.multiplyByPoint(r,new Cesium.Cartesian3(0,n,0),new Cesium.Cartesian3);return s}ni.prototype.drawPoint=function(e){var t=this,n=e.positions,r=n[0],o=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),a=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),s=Cesium.defaultValue(e.pixelSize,10),u=e.id,l=this._viewer.entities.getById(u);return l||(t._draw.drawPoint({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),point:{pixelSize:new Cesium.CallbackProperty(function(){return n[1]},!1),color:o,outlineColor:a}}),l=this._viewer.entities.getById(u)),l.geometryType="Point",l};ni.prototype.getPointAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];Fo=function(u){if(t._stop&&(Kr(u),Na=!1),n)return a[0]=u,a[1]=10,o=!1,r=!0,a},as=function(u){if(t._stop&&(Kr(u),Na=!1),r)return a[0]=u,a},Kr=function(u){if(!o)return a[0]=u,a=[],n=!1,r=!1,o=!0,a},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u70B9_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ni.prototype.drawCylinder=function(e){var t=this,n=!0,r=!1,o=[],a=1e4,s=Cesium.defaultValue(e.topRadius,5e3),u=Cesium.defaultValue(e.bottomRadius,5e3),l=Cesium.defaultValue(e.outline,!0),c=Cesium.defaultValue(e.showBottom,!1),f=Cesium.defaultValue(e.showTop,!1),h=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),d=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:1})),p=Cesium.defaultValue(e.slice,void 0),_=Cesium.defaultValue(e.id,"\u5706\u9525_");Fo=function(y){if(n){o.push(y),o.push(new Cesium.Cartesian3(y.x+100,y.y+100,y.z));var v=t._draw.drawCylinder({id:_+t.index++,orientation:new Cesium.CallbackProperty(function(){var w=yH(o[0],o[1]);return w.pitch+=Cesium.Math.PI_OVER_TWO,w.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(o[1],w)},!1),startPosition:o[0],endPosition:new Cesium.CallbackProperty(function(){return o[1]},!1),position:new Cesium.CallbackProperty(function(){var w=Cesium.Cartesian3.subtract(o[0],o[1],new Cesium.Cartesian3),C=Cesium.Cartesian3.divideByScalar(w,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(C,o[1],new Cesium.Cartesian3)},!1),length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),topRadius:s,bottomRadius:u,outline:l,outlineColor:h,slices:p,color:d,showBottom:c,showTop:f});n=!1,r=!0}},as=function(y){r&&(o[1]=y)},Kr=function(y){if(r){var v=Cesium.Cartographic.fromCartesian(y,Cesium.Ellipsoid.WGS84);v.height+=u,y=Cesium.Cartesian3.fromRadians(v.longitude,v.latitude,v.height,Cesium.Ellipsoid.WGS84),o[1]=y,r=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};function yH(e,t){var n=Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),l=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(l,new Cesium.Cartesian3),a=Math.atan2(o.y,o.x)-Cesium.Math.PI_OVER_TWO,s=Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(a),u=Cesium.Transforms.eastNorthUpToFixedFrame(e),l=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),c=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(u,u),l,l);Cesium.Cartesian3.normalize(c,c);var f=Cesium.Math.PI_OVER_TWO-Cesium.Math.acosClamped(c.z),h=new Cesium.HeadingPitchRoll(s,f,0);return h}ni.prototype.drawHalfsphere=function(e){this.drawVehicleRadar({showScanPlane:!1,id:"\u7403\u9762_"})};ni.prototype.drawEllipsoid=function(e){var t=this,n=!0,r=!1,o=[],a=10,s,u=Cesium.defaultValue(e.isBall,!0),l=Cesium.defaultValue(e.outline,!0),c=Cesium.defaultValue(e.outlineWidth,5),f=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:.5})),h=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),d=Cesium.defaultValue(e.radii,new Cesium.Cartesian3(4500,4500,4500)),p=Cesium.defaultValue(e.slicePartitions,24),_=Cesium.defaultValue(e.stackPartitions,24),y=u?"\u7403\u4F53_":"\u692D\u7403\u4F53_";Fo=function(v){if(console.log(v),n){var w=Cesium.Cartographic.fromCartesian(v,Cesium.Ellipsoid.WGS84);w.height+=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84),o.push(v);var C=t._draw.drawEllipsoid({id:y+t.index++,position:new Cesium.CallbackProperty(function(){return s},!1),radii:new Cesium.CallbackProperty(function(){return d},!1),outline:l,outlineColor:h,outlineWidth:c,slicePartitions:p,stackPartitions:_,material:f});n=!1,r=!0}},as=function(v){if(r){a=Cesium.Cartesian3.distance(o[0],v),d.x=a,d.y=a,u?d.z=a:d.z=a/1.25;var w=Cesium.Cartographic.fromCartesian(o[0],Cesium.Ellipsoid.WGS84);w.height=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84)}},Kr=function(v){if(r){a=Cesium.Cartesian3.distance(o[0],v),d.x=a,d.y=a,u?d.z=a:d.z=a/1.25;var w=Cesium.Cartographic.fromCartesian(o[0],Cesium.Ellipsoid.WGS84);w.height=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84),r=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawCuboid=function(e){var t=this,n=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(0,1,0,1)),o=Cesium.defaultValue(e.outline,!0),a=Cesium.defaultValue(e.outlineWidth,2),s=!0,u=!1,l=100,c=[];Fo=function(f){if(s){c.push(f);var h=t._draw.drawCommonBox({id:"\u957F\u65B9\u4F53_"+t.index++,position:f,dimensions:new Cesium.CallbackProperty(function(){return new Cesium.Cartesian3(l,l/2,l/2)},!1),outline:o,outlineColor:r,outlineWidth:a,material:n});s=!1,u=!0}},as=function(f){l=Cesium.Cartesian3.distance(c[0],f)},Kr=function(f){u&&(c[1]=f,l=Cesium.Cartesian3.distance(c[0],f),u=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawVehicleRadar=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,.8)),s=Cesium.defaultValue(e.scanColor,new Cesium.Color(1,1,1,.5)),u=Cesium.defaultValue(e.scanRate,100),l=Cesium.defaultValue(e.showScanPlane,!0),c=Cesium.defaultValue(e.id,"\u8F66\u8F7D\u96F7\u8FBE_"),f=1e3;Fo=function(h){if(n){o.push(h);var d=t._draw.drawVehicleRadar({id:c+t.index++,position:h,radius:new Cesium.CallbackProperty(function(){return f},!1),color:a,showScanPlane:l,scanPlaneColor:s,scanPlaneRate:u});n=!1,r=!0}},as=function(h){r&&(f=Cesium.Cartesian3.distance(o[0],h))},Kr=function(h){r&&(f=Cesium.Cartesian3.distance(o[0],h),r=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawParseArrayRadar=function(e){var t=this,n=!0,r=!1,o=[],a=30;Fo=function(s){if(n){o.push(s);var u=t._draw.drawParseArrayRadar({id:"\u76F8\u63A7\u72B6\u96F7\u8FBE_"+t.index++,position:s,radius:new Cesium.CallbackProperty(function(){return a},!1)});n=!1,r=!0}},as=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s))},Kr=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s),r=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawCustomizedPARadar=function(e){var t=this,n=!0,r=[];Fo=function(o){if(n){r.push(o);var a=t._draw.drawCustomizedPARadar({id:"\u5B9A\u5236\u76F8\u63A7\u72B6\u96F7\u8FBE_"+t.index++,position:o,lineColor:new Cesium.Color(.5,1,1,.6),color:new Cesium.Color(.5,1,1,.1)});n=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ni.prototype.drawMechanicalRadar=function(e){var t=this,n=!0,r=[];Fo=function(o){if(n){r.push(o);var a=t._draw.drawMechanicalRadar({id:"\u673A\u68B0\u96F7\u8FBE_"+t.index++,position:o,showScan:!0});n=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ni.prototype.drawFlightBillboard=function(e){var t=this,n=!0,r=[];Fo=function(o){if(n){r.push(o);var a=t._draw.drawFlightBillboard({id:"\u98DE\u673A\u6807\u724C_"+t.index++,position:o});n=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ni.prototype.drawFlightRibbon=function(e){var t=this,n=!0,r=[];Fo=function(o){if(n){r.push(o);var a=t._draw.drawFlightRibbon({id:"\u98DE\u673A\u98D8\u5E26_"+t.index++,position:o});n=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ni.prototype.drawFanRing=function(e){var t=this,n=!0,r=!1,o=!0,a=[],s=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,.5)),u=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,1,.5)),l=Cesium.defaultValue(e.renderStyle,0),c=1e3;Fo=function(f){if(n){a.push(f);var h=WN(f);console.log(h);var d=t._draw.drawFanRing({id:"\u6247\u73AF\u5F62_"+t.index++,lon:h.lon,lat:h.lat,height:h.height,longRadius:new Cesium.CallbackProperty(function(){return c},!1),minorRadius:new Cesium.CallbackProperty(function(){return c*2/3},!1),fillColor:s,lineColor:u,renderStyle:l});n=!1,r=!0}},as=function(f){r&&(c=Cesium.Cartesian3.distance(a[0],f))},Kr=function(f){!o||(c=Cesium.Cartesian3.distance(a[0],f),n=!1,r=!1,o=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawAnnulus=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,1,.5)),s=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,1,.5)),u=Cesium.defaultValue(e.renderStyle,0),l=1e3;Fo=function(c){if(n){o.push(c);var f=WN(c),h=t._draw.drawAnnulus({id:"\u73AF\u9762\u4F53_"+t.index++,lon:f.lon,lat:f.lat,height:f.height,outerRadius:new Cesium.CallbackProperty(function(){return l},!1),innerRadius:new Cesium.CallbackProperty(function(){return l*3/5},!1),fillColor:a,lineColor:s,renderStyle:u});n=!1,r=!0}},as=function(c){r&&(l=Cesium.Cartesian3.distance(o[0],c))},Kr=function(c){r&&(l=Cesium.Cartesian3.distance(o[0],c),r=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawTargetRing=function(e){var t=this,n=!0,r=[];Fo=function(o){if(n){r.push(o);var a=t._draw.drawTargetRing({id:"\u9776\u5FC3_"+t.index++,position:o});n=!1}},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ni.prototype.drawCommunicationLink=function(e){var t=this,n=!0,r=!1,o=[];Fo=function(a){if(n){o.push(a),o.push(new Cesium.Cartesian3(a.x+1e3,a.y+1e3,a.z));var s=t._draw.drawCommunicationLink({id:"\u901A\u4FE1\u94FE\u8DEF_"+t.index++,orientation:new Cesium.CallbackProperty(function(){var u=yH(o[0],o[1]);return u.pitch+=Cesium.Math.PI_OVER_TWO,u.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(o[1],u)},!1),position:new Cesium.CallbackProperty(function(){var u=Cesium.Cartesian3.subtract(o[0],o[1],new Cesium.Cartesian3),l=Cesium.Cartesian3.divideByScalar(u,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(l,o[1],new Cesium.Cartesian3)},!1),length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),topRadius:0,bottomRadius:3e3,showBottom:!1,changeStCoordinate:!0,material:new Cesium.PolylineTrailLinkMaterialProperty({color:Cesium.Color.WHITE,duration:1e4,trailImage:Cesium.buildModuleUrl("Assets/EMExtensions/downwavetexture.png")})});n=!1,r=!0}},as=function(a){r&&(o[1]=a)},Kr=function(a){r&&(o[1]=a,r=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.drawPolylineVolume=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.outline,!0),s=Cesium.defaultValue(e.radius,300),u=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),l=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:0}));Fo=function(c){if(n){o.push(c);var f=t._draw.drawPolylineVolume({id:"\u7BA1\u9053"+t.index++,position:c,positions:new Cesium.CallbackProperty(function(){return o},!1),shape:fhe(s),material:l,outline:a,outlineColor:u});n=!1,r=!0}},as=function(c){r&&(o.length==1?o.push(c):o[o.length-1]=c)},Kr=function(c){r&&(r=!1)},ya(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ni.prototype.clear=function(){this._draw.removeAllEntity(),this._stop=!0};var vH,qN,Na=!1,Fo,Kr,as,vC=[],PI=void 0;function ya(e,t,n,r,o){e.stopDraw=!1,Na=!1,vH=n,qN=r,t.setInputAction(function(a){var s=gH(e,a,Cesium.ScreenSpaceEventType.LEFT_CLICK);s&&o&&o("leftClick",s)},Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction(function(a){var s=che(e,a);s&&o&&o("mouseMove",s)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(function(a){var s=gH(e,a,Cesium.ScreenSpaceEventType.RIGHT_CLICK);s&&o&&o("rightClick",s)},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}function gH(e,t,n){if(!e.stopDraw){if(n===qN&&Na){var r=e._viewer.camera.getPickRay(t.position),o=e._viewer.scene.globe.pick(r,e._viewer.scene);if(Cesium.defined(o)&&Cesium.defined(Kr))return vC=Kr(o),Na=!1,vC}else if(n===vH){var r=e._viewer.camera.getPickRay(t.position),o=e._viewer.scene.globe.pick(r,e._viewer.scene);if(Cesium.defined(o)&&(Na=!0,Cesium.defined(qN)||(Na=!1),Cesium.defined(Fo)))return vC=Fo(o),vC}}}function che(e,t){if(Na){var n=Cesium.EV_ScreenMethod.globePick(e._viewer.scene,t.endPosition);if(Cesium.defined(n)&&Cesium.defined(as))return vC=as(n),vC}}function WN(e){var t=new Cesium.Cartographic.fromCartesian(e,Cesium.Ellipsoid.WGS84),n=Cesium.Math.toDegrees(t.longitude),r=Cesium.Math.toDegrees(t.latitude),o=t.height;return{lon:n,lat:r,height:o}}function fhe(e){for(var t=[],n=0;n<360;n+=10){var r=Cesium.Math.toRadians(n);t.push(new Cesium.Cartesian2(e*Math.cos(r),e*Math.sin(r)))}return t}function MI(e){var t=e.constructor===Array?[]:{};if(typeof e!="object")return e;for(var n in e)typeof e[n]=="object"?t[n]=MI(e[n]):t[n]=e[n];return t}function hhe(e,t){var n=new Cesium.EllipsoidGeodesic;n.setEndPoints(e,t);var r=n.surfaceDistance;return r}var CC=ni;function z_(){this._array=[],this._hash={}}Object.defineProperties(z_.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});z_.prototype.contains=function(e){return g(this._hash[e])};z_.prototype.set=function(e,t){let n=this._hash[e];t!==n&&(this.remove(e),this._hash[e]=t,this._array.push(t))};z_.prototype.get=function(e){return this._hash[e]};z_.prototype.remove=function(e){let t=this._hash[e],n=g(t);if(n){let r=this._array;r.splice(r.indexOf(t),1),delete this._hash[e]}return n};z_.prototype.removeAll=function(){let e=this._array;e.length>0&&(this._hash={},e.length=0)};var Ga=z_;var YN;typeof performance<"u"&&typeof performance.now=="function"&&isFinite(performance.now())?YN=function(){return performance.now()}:YN=function(){return Date.now()};var xC=YN;var dhe={SHIFT:0,CTRL:1,ALT:2},LI=Object.freeze(dhe);var phe={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19},_n=Object.freeze(phe);function $g(e,t,n){let r=e._element;if(r===document)return n.x=t.clientX,n.y=t.clientY,n;let o=r.getBoundingClientRect();return n.x=t.clientX-o.left,n.y=t.clientY-o.top,n}function JN(e,t){let n=e;return g(t)&&(n+=`+${t}`),n}function V_(e){if(e.shiftKey)return LI.SHIFT;if(e.ctrlKey)return LI.CTRL;if(e.altKey)return LI.ALT}var ss={LEFT:0,MIDDLE:1,RIGHT:2};function Kc(e,t,n,r){function o(a){r(e,a)}ea.isInternetExplorer()?n.addEventListener(t,o,!1):n.addEventListener(t,o,{capture:!1,passive:!1}),e._removalFunctions.push(function(){n.removeEventListener(t,o,!1)})}function mhe(e){let t=e._element,n=g(t.disableRootEvents)?t:document;ea.supportsPointerEvents()?(Kc(e,"pointerdown",t,xhe),Kc(e,"pointerup",t,DH),Kc(e,"pointermove",t,whe),Kc(e,"pointercancel",t,DH)):(Kc(e,"mousedown",t,PH),Kc(e,"mouseup",n,MH),Kc(e,"mousemove",n,LH),Kc(e,"touchstart",t,vhe),Kc(e,"touchend",n,TH),Kc(e,"touchmove",n,Che),Kc(e,"touchcancel",n,TH)),Kc(e,"dblclick",t,_he);let r;"onwheel"in t?r="wheel":document.onmousewheel!==void 0?r="mousewheel":r="DOMMouseScroll",Kc(e,r,t,yhe)}function ghe(e){let t=e._removalFunctions;for(let n=0;n<t.length;++n)t[n]()}var CH={position:new X};function $N(e){e._lastSeenTouchEvent=xC()}function e2(e){return xC()-e._lastSeenTouchEvent>nd.mouseEmulationIgnoreMilliseconds}function QN(e,t,n){let r=e.x-t.x,o=e.y-t.y;return Math.sqrt(r*r+o*o)<n}function PH(e,t){if(!e2(e))return;let n=t.button;e._buttonDown[n]=!0;let r;if(n===ss.LEFT)r=_n.LEFT_DOWN;else if(n===ss.MIDDLE)r=_n.MIDDLE_DOWN;else if(n===ss.RIGHT)r=_n.RIGHT_DOWN;else return;let o=$g(e,t,e._primaryPosition);X.clone(o,e._primaryStartPosition),X.clone(o,e._primaryPreviousPosition);let a=V_(t),s=e.getInputAction(r,a);g(s)&&(X.clone(o,CH.position),s(CH),t.preventDefault())}var xH={position:new X},wH={position:new X};function XN(e,t,n,r){let o=V_(r),a=e.getInputAction(t,o),s=e.getInputAction(n,o);if(g(a)||g(s)){let u=$g(e,r,e._primaryPosition);if(g(a)&&(X.clone(u,xH.position),a(xH)),g(s)){let l=e._primaryStartPosition;QN(l,u,e._clickPixelTolerance)&&(X.clone(u,wH.position),s(wH))}}}function MH(e,t){if(!e2(e))return;let n=t.button;if(!(n!==ss.LEFT&&n!==ss.MIDDLE&&n!==ss.RIGHT)){if(e._buttonDown[ss.LEFT]&&(XN(e,_n.LEFT_UP,_n.LEFT_CLICK,t),e._buttonDown[ss.LEFT]=!1),e._buttonDown[ss.MIDDLE]){let r=document.getElementById("focalPointCanvas");r&&document.body.removeChild(r),XN(e,_n.MIDDLE_UP,_n.MIDDLE_CLICK,t),e._buttonDown[ss.MIDDLE]=!1}if(e._buttonDown[ss.RIGHT]){let r=document.getElementById("focalPointCanvas");r&&document.body.removeChild(r),XN(e,_n.RIGHT_UP,_n.RIGHT_CLICK,t),e._buttonDown[ss.RIGHT]=!1}}}var jN={startPosition:new X,endPosition:new X};function LH(e,t){if(!e2(e))return;let n=V_(t),r=$g(e,t,e._primaryPosition),o=e._primaryPreviousPosition,a=e.getInputAction(_n.MOUSE_MOVE,n);g(a)&&(X.clone(o,jN.startPosition),X.clone(r,jN.endPosition),a(jN)),X.clone(r,o),(e._buttonDown[ss.LEFT]||e._buttonDown[ss.MIDDLE]||e._buttonDown[ss.RIGHT])&&t.preventDefault()}var EH={position:new X};function _he(e,t){let n=t.button,r;if(n===ss.LEFT)r=_n.LEFT_DOUBLE_CLICK;else return;let o=V_(t),a=e.getInputAction(r,o);g(a)&&($g(e,t,EH.position),a(EH))}function yhe(e,t){let n;if(g(t.deltaY)){let a=t.deltaMode;a===t.DOM_DELTA_PIXEL?n=-t.deltaY:a===t.DOM_DELTA_LINE?n=-t.deltaY*40:n=-t.deltaY*120}else t.detail>0?n=t.detail*-120:n=t.wheelDelta;if(!g(n))return;let r=V_(t),o=e.getInputAction(_n.WHEEL,r);g(o)&&(o(n),t.preventDefault())}function vhe(e,t){$N(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r)a=n[r],s=a.identifier,u.set(s,$g(e,a,new X));RI(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,l.set(s,X.clone(u.get(s)))}function TH(e,t){$N(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r)a=n[r],s=a.identifier,u.remove(s);RI(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,l.remove(s)}var SH={position:new X},KN={position1:new X,position2:new X},AH={position:new X},bH={position:new X},IH={position:new X};function RI(e,t){let n=V_(t),r=e._positions,o=r.length,a,s,u=e._isPinching;if(o!==1&&e._buttonDown[ss.LEFT]){if(e._buttonDown[ss.LEFT]=!1,g(e._touchHoldTimer)&&(clearTimeout(e._touchHoldTimer),e._touchHoldTimer=void 0),a=e.getInputAction(_n.LEFT_UP,n),g(a)&&(X.clone(e._primaryPosition,AH.position),a(AH)),o===0&&!e._isTouchHolding&&(s=e.getInputAction(_n.LEFT_CLICK,n),g(s))){let l=e._primaryStartPosition,c=e._previousPositions.values[0];QN(l,c,e._clickPixelTolerance)&&(X.clone(e._primaryPosition,bH.position),s(bH))}e._isTouchHolding=!1}if(o===0&&u&&(e._isPinching=!1,a=e.getInputAction(_n.PINCH_END,n),g(a)&&a()),o===1&&!u){let l=r.values[0];X.clone(l,e._primaryPosition),X.clone(l,e._primaryStartPosition),X.clone(l,e._primaryPreviousPosition),e._buttonDown[ss.LEFT]=!0,a=e.getInputAction(_n.LEFT_DOWN,n),g(a)&&(X.clone(l,SH.position),a(SH)),e._touchHoldTimer=setTimeout(function(){if(!e.isDestroyed()&&(e._touchHoldTimer=void 0,e._isTouchHolding=!0,s=e.getInputAction(_n.RIGHT_CLICK,n),g(s))){let c=e._primaryStartPosition,f=e._previousPositions.values[0];QN(c,f,e._holdPixelTolerance)&&(X.clone(e._primaryPosition,IH.position),s(IH))}},nd.touchHoldDelayMilliseconds),t.preventDefault()}o===2&&!u&&(e._isPinching=!0,a=e.getInputAction(_n.PINCH_START,n),g(a)&&(X.clone(r.values[0],KN.position1),X.clone(r.values[1],KN.position2),a(KN),t.preventDefault()))}function Che(e,t){$N(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r){a=n[r],s=a.identifier;let c=u.get(s);g(c)&&$g(e,a,c)}RH(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,X.clone(u.get(s),l.get(s))}var ZN={startPosition:new X,endPosition:new X},dE={distance:{startPosition:new X,endPosition:new X},angleAndHeight:{startPosition:new X,endPosition:new X}};function RH(e,t){let n=V_(t),r=e._positions,o=e._previousPositions,a=r.length,s;if(a===1&&e._buttonDown[ss.LEFT]){let u=r.values[0];X.clone(u,e._primaryPosition);let l=e._primaryPreviousPosition;s=e.getInputAction(_n.MOUSE_MOVE,n),g(s)&&(X.clone(l,ZN.startPosition),X.clone(u,ZN.endPosition),s(ZN)),X.clone(u,l),t.preventDefault()}else if(a===2&&e._isPinching&&(s=e.getInputAction(_n.PINCH_MOVE,n),g(s))){let u=r.values[0],l=r.values[1],c=o.values[0],f=o.values[1],h=l.x-u.x,d=l.y-u.y,p=Math.sqrt(h*h+d*d)*.25,_=f.x-c.x,y=f.y-c.y,v=Math.sqrt(_*_+y*y)*.25,w=(l.y+u.y)*.125,C=(f.y+c.y)*.125,E=Math.atan2(d,h),S=Math.atan2(y,_);X.fromElements(0,v,dE.distance.startPosition),X.fromElements(0,p,dE.distance.endPosition),X.fromElements(S,C,dE.angleAndHeight.startPosition),X.fromElements(E,w,dE.angleAndHeight.endPosition),s(dE)}}function xhe(e,t){if(t.target.setPointerCapture(t.pointerId),t.pointerType==="touch"){let n=e._positions,r=t.pointerId;n.set(r,$g(e,t,new X)),RI(e,t),e._previousPositions.set(r,X.clone(n.get(r)))}else PH(e,t)}function DH(e,t){if(t.pointerType==="touch"){let n=e._positions,r=t.pointerId;n.remove(r),RI(e,t),e._previousPositions.remove(r)}else MH(e,t)}function whe(e,t){if(t.pointerType==="touch"){let n=e._positions,r=t.pointerId,o=n.get(r);if(!g(o))return;$g(e,t,o),RH(e,t);let a=e._previousPositions;X.clone(n.get(r),a.get(r))}else LH(e,t)}function nd(e){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._isTouchHolding=!1,this._lastSeenTouchEvent=-nd.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new X,this._primaryPosition=new X,this._primaryPreviousPosition=new X,this._positions=new Ga,this._previousPositions=new Ga,this._removalFunctions=[],this._touchHoldTimer=void 0,this._clickPixelTolerance=5,this._holdPixelTolerance=25,this._element=T(e,document),mhe(this)}nd.prototype.setInputAction=function(e,t,n){let r=JN(t,n);this._inputEvents[r]=e};nd.prototype.getInputAction=function(e,t){let n=JN(e,t);return this._inputEvents[n]};nd.prototype.removeInputAction=function(e,t){let n=JN(e,t);delete this._inputEvents[n]};nd.prototype.isDestroyed=function(){return!1};nd.prototype.destroy=function(){return ghe(this),st(this)};nd.mouseEmulationIgnoreMilliseconds=800;nd.touchHoldDelayMilliseconds=1500;var e0=nd;function Im(e){this.viewer=e.viewer,this.callback=e.callback,this.drawPrimitive=new CC({viewer:this.viewer,callback:this.callback}),this.callbackFuncs={drawing:void 0,drawEnd:void 0},this.isDrawingFlag=!1,this.editingEntity=void 0,this.nextEditEntity=void 0,this._primitives=this.viewer.scene.primitives,this.enableEditMode=!0,this.startEdit()}Im.prototype.startDraw=function(e){this.isDrawingFlag=!0,this.drawPrimitive._stop=!1;let t=this;switch(e){case"LineString":this.drawPrimitive.getLineAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Polygon":this.drawPrimitive.getPolygonAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Square":this.drawPrimitive.getRectangleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Rectangle":this.drawPrimitive.getRectangleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"FanRing":this.drawPrimitive.prototype.getFanRingAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Ellipse":this.drawPrimitive.getEllipseAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Circle":this.drawPrimitive.getCircleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"SectorPlane":this.drawPrimitive.getSectorPlaneAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Point":this.drawPrimitive.getPointAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"SectorPlaneByThreePoint":this.drawPrimitive.getSectorPlaneByThreePointAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;default:break}function n(r,o,a){a||console.error("EV_CsDrawHelper click draw 'entites' id undifined"),!t.callbackFuncs.drawing||t.callbackFuncs.drawing}};Im.prototype.endDraw=function(){};Im.prototype.drawByPositions=function(e){let t=e.geometryType,n=e.callbackType,r=e.positions3D,o=e.id,a=[];r.forEach(function(u,l,c){l%3===0&&(a[Math.floor(l/3)]=[]),a[Math.floor(l/3)].push(u)});let s;switch(t){case"LineString":s=this.drawPrimitive.drawLine({positions:r,id:o});break;case"Polygon":s=this.drawPrimitive.drawPolygon({positions:r,id:o});break;case"Rectangle":s=this.drawPrimitive.drawRectangle({positions:r,id:o});break;case"Circle":s=this.drawPrimitive.drawCircle({positions:r,id:o});break;case"Ellipse":s=this.drawPrimitive.drawEllipse({positions:r,id:o});break;case"SectorPlane":s=this.drawPrimitive.drawSectorPlane({positions:r,id:o});break;case"Point":s=this.drawPrimitive.drawPoint({positions:r,id:o});break;case"SectorPlaneByThreePoint":s=this.drawPrimitive.drawSectorPlaneByThreePoint({positions:r,id:o});break;default:break}s.positions3D||(s.positions3D=r),n==="rightClick"&&(Ehe(this,s),r&&this.callbackFuncs.drawEnd&&typeof this.callbackFuncs.drawEnd=="function"&&this.callbackFuncs.drawEnd(s))};Im.prototype.startEdit=function(){this.handler=new e0(this.viewer.scene.canvas);let e=this;this.handler.setInputAction(function(t){e.handlerCallBcak("leftClick",t.position)},_n.LEFT_CLICK),this.handler.setInputAction(function(t){e.handlerCallBcak("leftDown",t.position)},_n.LEFT_DOWN),this.handler.setInputAction(function(t){e.handlerCallBcak("rightClick",t.position)},_n.RIGHT_CLICK)};Im.prototype.endEdit=function(){this.handler&&(this.handler.destroy(),delete this.handler)};Im.prototype.handlerCallBcak=function(e,t){let n=this.viewer.scene.drillPick(t);!this.isDrawingFlag&&n.length>0?n.forEach(function(r){Object.keys(r).forEach(function(a){r[a]&&r[a][e]&&r[a][e](t)})}):!this.isDrawingFlag&&n.length===0&&this.setEditMode(this.editingEntity,!1)};Im.prototype.setEditMode=function(e,t,n){};Im.prototype.clear=function(){this.drawPrimitive.clear()};function Ehe(e,t){e.isDrawingFlag=!1;function n(r){e.nextEditEntity&&e.nextEditEntity.id===r.id||(e.nextEditEntity=r,e.setEditMode(e.editingEntity,!1),e.editingEntity=e.nextEditEntity)}t&&The(t,"leftClick",function(){!e.enableEditMode||(n(t),e.setEditMode(t,!0,!0))})}function The(e,t,n){e[t]=n}var OH=Im;function pE(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=Cesium.defaultValue(e.id,Cesium.createGuid()),this._scene=this.viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._topRadius=Cesium.defaultValue(e.topRadius,0),this._bottomRadius=Cesium.defaultValue(e.bottomRadius,0),this._length=Cesium.defaultValue(e.length,1e3),this._slices=Cesium.defaultValue(e.slices,128),this._position=e.position,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.geometry=void 0,this.changeMt=!1,this.changeGeometry=!1,this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}pE.prototype.update=function(e){var t=e.mode;if(!(!this.show||t!==Cesium.SceneMode.SCENE3D)){var n=e.context,r=this;this._command.uniformMap={v_colour:function(){return r.fillColor}},this._modelMatrix||(this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position)),(!this.geometry||this.changeGeometry)&&(this.geometry=this.createGeometry(this._length,this._topRadius,this._bottomRadius,this._slices,!0)),(!this._VA||this.changeMt)&&(this._VA=She(this,n,this.geometry)),Cesium.defined(this._command.shaderProgram)||(this._command.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:bhe(),fragmentShaderSource:Ihe()})),this._command.vertexArray=this._VA;var o=e.commandList,a=e.passes;a.render&&o.push(this._command)}};pE.prototype.change=function(e,t){e&&(this.changeMt=!0,this._modelMatrix=e),t&&(this.changeGeometry=!0,this._length=t)};pE.prototype.createGeometry=function(e,t,n,r,o){var a=0,s=-e;if(!(e<=0||t<0||n<0||t===0&&n===0)){var E=0,u=0,l=r+r,c=r+l,f=l+l,h=o?(l+r)*3:r*3,d=o?l*3:0,p=o?2*l:l,_=new Float64Array(p*3);for(A=0;A<r;A++){let D=A/r*Cesium.Math.TWO_PI,P=Math.cos(D),M=Math.sin(D),b=P*n,O=M*n;var y=P*t,v=M*t;_[u+h]=b,_[u+h+1]=O,_[u+h+2]=s,_[u+d]=y,_[u+d+1]=v,_[u+d+2]=a,u+=3,o&&(_[E++]=b,_[E++]=O,_[E++]=s,_[E++]=y,_[E++]=v,_[E++]=a)}for(var w=12*r-12,C=Cesium.IndexDatatype.createTypedArray(f,w),E=0,S=0,A=0;A<r-1;A++)C[E++]=S,C[E++]=S+2,C[E++]=S+3,C[E++]=S,C[E++]=S+3,C[E++]=S+1,S+=2;if(C[E++]=l-2,C[E++]=0,C[E++]=1,C[E++]=l-2,C[E++]=1,C[E++]=l-1,this._showBottom)for(A=1;A<r-1;A++)C[E++]=l+A+1,C[E++]=l+A,C[E++]=l;if(this._showTop==!0)for(A=1;A<r-1;A++)C[E++]=c,C[E++]=c+A,C[E++]=c+A+1;return{position:_,indices:C}}};pE.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function She(e,t,n){var r=Ahe(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Ahe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function bhe(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Ihe(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var NH=pE;function OI(e,t){}OI.GetData=function(e,t,n){var r=[],o=t.split("/");if(e.toUpperCase()==="XML")var a=new Cesium.Resource.fetchXML({url:t}).then(function(s){if(s){for(var u=0;u<s.children.length;u++)if(s.children[u].attributes.length===0&&s.children[u].children.length!==0)for(var l=0;l<s.children[u].children.length;l++){var c=s.children[u].children[l].attributes;if(c.length!==0&&s.children[u].children[l].children.length===0){var f={type:s.children[u].children[l].attributes[0].nodeValue,scale:s.children[u].children[l].attributes[1].nodeValue,name:s.children[u].children[l].attributes[2].nodeValue,path:o[0]+"/"+o[1]+"/gltf/"+s.children[u].children[l].attributes[2].nodeValue+".gltf",desc:s.children[u].children[l].attributes[3].nodeValue};r.push(f)}}n&&n(r)}else return})};OI.GetDataByJson=function(e,t,n){var r="",o=t.split("/");if(e.toUpperCase()==="XML")var a=new Cesium.Resource.fetchXML({url:t}).then(function(s){if(s)r=BH(s.children,r,o),n&&n(r);else return})};OI.GetXMLToObject=function(e,t){var n=[],r=[];for(var o in e)r.push(o),n.push(e[o]);for(var a=[],o=0;o<n.length;o++)var s=n[o],u=r[o],l=new Cesium.Resource.fetchXML({url:s,queryParameters:{name:u}}).then(function(f){var h=f.URL.indexOf("=")+1,d=f.URL.slice(h,f.URL.length),p={name:d,InfoJson:Dhe(f)};a.push(p),a.length===n.length&&t&&t(a)}).catch(function(){throw new Cesium.DeveloperError("\u8BF7\u6C42\u6570\u636E\u5931\u8D25")})};function Dhe(e){var t=t||{};n();function n(){t.escapeMode===void 0&&(t.escapeMode=!0),t.attributePrefix=t.attributePrefix||"_",t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",t.enableToStringFunc===void 0&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],t.skipEmptyTextNodesForObj===void 0&&(t.skipEmptyTextNodesForObj=!0),t.stripWhitespaces===void 0&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],t.useDoubleQuotes===void 0&&(t.useDoubleQuotes=!1),t.xmlElementsFilter=t.xmlElementsFilter||[],t.jsonPropertiesFilter=t.jsonPropertiesFilter||[],t.keepCData===void 0&&(t.keepCData=!1)}var r={ELEMENT_NODE:1,ATTR_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function o(b){var O=b.localName;return O==null&&(O=b.baseName),(O==null||O=="")&&(O=b.nodeName),O}function a(b){return b.prefix}function s(b){return typeof b=="string"?b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):b}function u(b,O,m,I){for(var L=0;L<b.length;L++){var R=b[L];if(typeof R=="string"){if(R==I)break}else if(R instanceof RegExp){if(R.test(I))break}else if(typeof R=="function"&&R(O,m,I))break}return L!=b.length}function l(b,O,m){switch(t.arrayAccessForm){case"property":b[O]instanceof Array?b[O+"_asArray"]=b[O]:b[O+"_asArray"]=[b[O]];break}!(b[O]instanceof Array)&&t.arrayAccessFormPaths.length>0&&u(t.arrayAccessFormPaths,b,O,m)&&(b[O]=[b[O]])}function c(b){var O=b.split(/[-T:+Z]/g),m=new Date(O[0],O[1]-1,O[2]),I=O[5].split(".");if(m.setHours(O[3],O[4],I[0]),I.length>1&&m.setMilliseconds(I[1]),O[6]&&O[7]){var L=O[6]*60+Number(O[7]),R=/\d\d-\d\d:\d\d$/.test(b)?"-":"+";L=0+(R=="-"?-1*L:L),m.setMinutes(m.getMinutes()-L-m.getTimezoneOffset())}else b.indexOf("Z",b.length-1)!==-1&&(m=new Date(Date.UTC(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds())));return m}function f(b,O,m){if(t.datetimeAccessFormPaths.length>0){var I=m.split(".#")[0];return u(t.datetimeAccessFormPaths,b,O,I)?c(b):b}else return b}function h(b,O,m,I){return O==r.ELEMENT_NODE&&t.xmlElementsFilter.length>0?u(t.xmlElementsFilter,b,m,I):!0}function d(b,O){if(b.nodeType==r.DOCUMENT_NODE){for(var m=new Object,I=b.childNodes,L=0;L<I.length;L++){var R=I.item(L);if(R.nodeType==r.ELEMENT_NODE){var N=o(R);m[N]=d(R,N)}}return m}else if(b.nodeType==r.ELEMENT_NODE){var m=new Object;m.__cnt=0;for(var I=b.childNodes,L=0;L<I.length;L++){var R=I.item(L),N=o(R);if(R.nodeType!=r.COMMENT_NODE){var B=O+"."+N;h(m,R.nodeType,N,B)&&(m.__cnt++,m[N]==null?(m[N]=d(R,B),l(m,N,B)):(m[N]!=null&&(m[N]instanceof Array||(m[N]=[m[N]],l(m,N,B))),m[N][m[N].length]=d(R,B)))}}for(var V=0;V<b.attributes.length;V++){var z=b.attributes.item(V);m.__cnt++;var U=z.name;z.name==="model"||z.name==="name"||z.name==="modelname"?(m[t.attributePrefix+"path"]="./data/gltf/"+z.value+".gltf",U="modelname",m[t.attributePrefix+U]=z.value):z.name==="scale"?(U="modelscale",m[t.attributePrefix+U]=z.value):z.name==="icon"&&z.value!==""?m[t.attributePrefix+U]="./data/images/"+z.value:m[t.attributePrefix+U]=z.value}var Q=a(b);return Q!=null&&Q!=""&&(m.__cnt++,m.__prefix=Q),m["#text"]!=null&&(m.__text=m["#text"],m.__text instanceof Array&&(m.__text=m.__text.join(`
`)),t.stripWhitespaces&&(m.__text=m.__text.trim()),delete m["#text"],t.arrayAccessForm=="property"&&delete m["#text_asArray"],m.__text=f(m.__text,N,O+"."+N)),m["#cdata-section"]!=null&&(m.__cdata=m["#cdata-section"],delete m["#cdata-section"],t.arrayAccessForm=="property"&&delete m["#cdata-section_asArray"]),m.__cnt==0&&t.emptyNodeForm=="text"?m="":m.__cnt==1&&m.__text!=null?m=m.__text:m.__cnt==1&&m.__cdata!=null&&!t.keepCData?m=m.__cdata:m.__cnt>1&&m.__text!=null&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&m.__text==""||m.__text.trim()=="")&&delete m.__text,delete m.__cnt,t.enableToStringFunc&&(m.__text!=null||m.__cdata!=null)&&(m.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),m}else if(b.nodeType==r.TEXT_NODE||b.nodeType==r.CDATA_SECTION_NODE)return b.nodeValue}function p(b,O,m,I){var L="<"+(b!=null&&b.__prefix!=null?b.__prefix+":":"")+O;if(m!=null)for(var R=0;R<m.length;R++){var N=m[R],B=b[N];t.escapeMode&&(B=s(B)),L+=" "+N.substr(t.attributePrefix.length)+"=",t.useDoubleQuotes?L+='"'+B+'"':L+="'"+B+"'"}return I?L+="/>":L+=">",L}function _(b,O){return"</"+(b.__prefix!=null?b.__prefix+":":"")+O+">"}function y(b,O){return b.indexOf(O,b.length-O.length)!==-1}function v(b,O){return!!(t.arrayAccessForm=="property"&&y(O.toString(),"_asArray")||O.toString().indexOf(t.attributePrefix)==0||O.toString().indexOf("__")==0||b[O]instanceof Function)}function w(b){var O=0;if(b instanceof Object)for(var m in b)v(b,m)||O++;return O}function C(b,O,m){return t.jsonPropertiesFilter.length==0||m==""||u(t.jsonPropertiesFilter,b,O,m)}function E(b){var O=[];if(b instanceof Object)for(var m in b)m.toString().indexOf("__")==-1&&m.toString().indexOf(t.attributePrefix)==0&&O.push(m);return O}function S(b){var O="";return b.__cdata!=null&&(O+="<![CDATA["+b.__cdata+"]]>"),b.__text!=null&&(t.escapeMode?O+=s(b.__text):O+=b.__text),O}function A(b){var O="";return b instanceof Object?O+=S(b):b!=null&&(t.escapeMode?O+=s(b):O+=b),O}function D(b,O){return b===""?O:b+"."+O}function P(b,O,m,I){var L="";if(b.length==0)L+=p(b,O,m,!0);else for(var R=0;R<b.length;R++)L+=p(b[R],O,E(b[R]),!1),L+=M(b[R],D(I,O)),L+=_(b[R],O);return L}function M(b,O){var m="",I=w(b);if(I>0){for(var L in b)if(!(v(b,L)||O!=""&&!C(b,L,D(O,L)))){var R=b[L],N=E(R);if(R==null||R==null)m+=p(R,L,N,!0);else if(R instanceof Object)if(R instanceof Array)m+=P(R,L,N,O);else if(R instanceof Date)m+=p(R,L,N,!1),m+=R.toISOString(),m+=_(R,L);else{var B=w(R);B>0||R.__text!=null||R.__cdata!=null?(m+=p(R,L,N,!1),m+=M(R,D(O,L)),m+=_(R,L)):m+=p(R,L,N,!0)}else m+=p(R,L,N,!1),m+=A(R),m+=_(R,L)}}return m+=A(b),m}return d(e)}function BH(e,t,n){for(var r=0;r<e.length;r++){var o=e[r];if(o.attributes.length!==0)t=Phe(o,t,n);else if(o.children!==void 0)return t+='"children":[{',BH(o.children,t,n)}return t}function Phe(e,t,n){for(var r='"'+n[0]+"/"+n[1]+"/gltf/",o=0;o<e.attributes.length;o++)t+='"'+e.attributes[o].nodeName+'":"'+e.attributes[o].nodeValue+'",',e.attributes[o].nodeName==="name"&&(r+=e.attributes[o].nodeValue+'.gltf"');return t+='"path":'+r,t+="},{",t}var NI=OI;var Mhe={NET_MSG_MIN:-1,NET_MSG_FIGHTER:0,NET_MSG_COMMAND:1,NET_MSG_TSPI:2,NET_MSG_RDR_STATE:3,NET_MSG_EWS_STA:4,NET_MSG_TARGET:6,NET_MSG_IRST:9,NET_MSG_IRMSL_STATE:12,NET_MSG_GTSPI:20,NET_MSG_RAD_STATE:21,NET_MSG_STATICTARGET:22,NET_MSG_COMBATPOWER:23,NET_MSG_RTSN:30,NET_MSG_RTKN:31,NET_MSG_WPN_TRAJ:32,NET_MSG_LARGE_PLANE:35,NET_MSG_SAFETYALARM:40},Re=Object.freeze(Mhe);function t2(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.mtType=Cesium.defaultValue(e.mtType,Re.NET_MSG_MIN),this.name=e.name,this.uId=e.uId,this.show=Cesium.defaultValue(e.show,!0),this.modelType=e.modelType,this.nRedOrBlue=e.nRedOrBlue,this.realTime=e.realTime,this.fLon=e.fLon,this.fLat=e.fLat,this.fAlt=e.fAlt,this.position=e.position,this.headingPitchRoll=e.headingPitchRoll,this.scale=Cesium.defaultValue(e.scale,1),this.modelUri=e.modelUri,this.boundingBoxVisible=Cesium.defaultValue(e.boundingBoxVisible,!1),this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{}),this.modelIconUri=e.modelIconUri,this.modelIconColor=Cesium.defaultValue(e.modelIconColor,Cesium.Color.RED),this.modelIconScale=Cesium.defaultValue(e.modelIconScale,1),this.modelIconRotation=Cesium.defaultValue(e.modelIconRotation,0),this.modelIconDisplayDistance=Cesium.defaultValue(e.modelIconDisplayDistance,new Cesium.DistanceDisplayCondition(6e4,9e4)),this.modelLabelType=void 0,this.modelLabelVisible=Cesium.defaultValue(e.modelLabelVisible,!0),this.modelLabelPixelOffset=Cesium.defaultValue(e.modelLabelPixelOffset,new Cesium.Cartesian2(50,25)),this.modelLabelPullWireColor=Cesium.defaultValue(e.modelLabelPullWireColor,Cesium.Color.RED),this.modelLabelTextColor=Cesium.defaultValue(e.modelLabelTextColor,Cesium.Color.RED),this.sectorRadarVisible=Cesium.defaultValue(e.sectorRadarVisible,!1),this.sectorRadarColor=Cesium.defaultValue(e.sectorRadarColor,new Cesium.Color(.38,.64,.64,.6)),this.trace=Cesium.defaultValue(e.trace,void 0)}t2.clone=function(e,t){if(!!Cesium.defined(e))return Cesium.defined(t)||(t=new t2(e)),t.name=e.name,t.uId=e.uId,t.show=e.show,t.modelType=e.modelType,t.realTime=e.realTime,t.fLon=e.fLon,t.fLat=e.fLat,t.fAlt=e.fAlt,t.position=e.position,t.headingPitchRoll=Cesium.HeadingPitchRoll.clone(e.headingPitchRoll),t.scale=Cesium.defaultValue(t.scale,1),t.modelUri=e.modelUri,t.modelIconUri=e.modelIconUri,t.modelIconColor=Cesium.Color.clone(e.iconColor),t.modelIconDisplayDistance=Cesium.DistanceDisplayCondition.clone(e.modelIconDisplayDistance),t.ribbonVisible=e.ribbonVisible,t.ribbonColor=Cesium.Color.clone(e.ribbonColor),t.modelLabelVisible=e.modelLabelVisible,t.modelLabelPullWireColor=e.modelLabelPullWireColor,t.modelLabelType=e.modelLabelType,t.nRedOrBlue=e.nRedOrBlue,t.modelLabelPixelOffset=e.modelLabelPixelOffset,t.modelColor=e.modelColor,t.modelColorBlendMode=e.modelColorBlendMode,t.modelLabelTextColor=e.modelLabelTextColor,t.sectorRadarVisible=e.sectorRadarVisible,t.sectorRadarColor=e.sectorRadarColor,t};var mE=t2;function rd(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.wcPosition=e.wcPosition,this.headingPitchRoll=e.headingPitchRoll,this.timeMsec=e.timeMsec}function BI(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._traceTimeDuration=Cesium.defaultValue(e.traceTimeDuration,0),this._ribbonVisible=Cesium.defaultValue(e.ribbonVisible,!1),this.ribbonColor=Cesium.defaultValue(e.ribbonColor,new Cesium.Color(1,0,0,1)),this._wallVisible=Cesium.defaultValue(e.wallVisible,!1),this.wallColor=Cesium.defaultValue(e.wallColor,new Cesium.Color(1,0,0,1)),this._barVisible=Cesium.defaultValue(e.barVisible,!1),this.barColor=Cesium.defaultValue(e.barColor,new Cesium.Color(1,0,0,1)),this._barTimeInterval=Cesium.defaultValue(e.barTimeInterval,8),this._barDistanceInterval=Cesium.defaultValue(e.barDistanceInterval,0),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),this._lineVisible=Cesium.defaultValue(e.lineVisible,!1),this.ribbonScale=1,this.trackPoints=[],this.barPoints=[],this._forwardOffset=Cesium.defaultValue(e.forwardOffset,0),this._upOffset=Cesium.defaultValue(e.upOffset,0)}Object.defineProperties(BI.prototype,{traceTimeDuration:{get:function(){return this._traceTimeDuration},set:function(e){this._traceTimeDuration=e}},barTimeInterval:{get:function(){return this._barTimeInterval},set:function(e){this.barPoints=[],this._barDistanceInterval=0,this._barTimeInterval=e}},barDistanceInterval:{get:function(){return this._barDistanceInterval},set:function(e){this.barPoints=[],this._barTimeInterval=0,this._barDistanceInterval=e}},ribbonVisible:{get:function(){return this._ribbonVisible},set:function(e){this._ribbonVisible=e}},wallVisible:{get:function(){return this._wallVisible},set:function(e){this._wallVisible=e}},barVisible:{get:function(){return this._barVisible},set:function(e){this._barVisible=e}},forwardOffset:{get:function(){return this._forwardOffset},set:function(e){this._forwardOffset=e}},upOffset:{get:function(){return this._upOffset},set:function(e){this._upOffset=e}},lineVisible:{get:function(){return this._lineVisible},set:function(e){this._lineVisible=e}}});BI.prototype.add=function(e,t,n,r){if(this.ribbonScale=r,!(this.trackPoints.length>0&&n===this.trackPoints[this.trackPoints.length-1].timeMsec)){for(;this.trackPoints.length>0&&n-this.trackPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.trackPoints.shift();if(this.trackPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this._barVisible){if(this._barTimeInterval>0)if(this.barPoints.length>0){for(;this.barPoints.length>0&&n-this.barPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.barPoints.shift();this.barPoints.length-2>=0&&n-this.barPoints[this.barPoints.length-2].timeMsec>this._barTimeInterval*1e3?this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})):this.barPoints.length==0||this.barPoints.length==1?this.barPoints[this.barPoints.length]=new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n}):this.barPoints[this.barPoints.length-1]=new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})}else this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n}));else if(this._barDistanceInterval>0)if(this.barPoints.length>0){for(;this.barPoints.length>0&&n-this.barPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.barPoints.shift();this.barPoints.length-2>=0&&Cesium.Cartesian3.distance(e,this.barPoints[this.barPoints.length-2].wcPosition)>=this._barDistanceInterval?this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})):this.barPoints.length==0||this.barPoints.length==1?this.barPoints[this.barPoints.length]=new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n}):this.barPoints[this.barPoints.length-1]=new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})}else this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this.barPoints.push(new rd({wcPosition:e,headingPitchRoll:t,timeMsec:n}))}}};BI.prototype.clearAll=function(){this.trackPoints=[],this.barPoints=[]};var FI=BI;function k_(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.realTime=e.realTime,this.fLon=e.fLon,this.fLat=e.fLat,this.fAlt=e.fAlt,this.position=e.position,this.nRedOrBlue=Cesium.defaultValue(e.nRedOrBlue,0),Cesium.defined(e.headingPitchRoll)?this.headingPitchRoll=Cesium.HeadingPitchRoll.clone(e.headingPitchRoll):this.headingPitchRoll=new Cesium.HeadingPitchRoll,this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{})}function gE(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.mtType=Cesium.defaultValue(e.mtType,Re.NET_MSG_MIN),this.name=Cesium.defaultValue(e.name,""),this.uId=Cesium.defaultValue(e.uId,void 0),this.show=Cesium.defaultValue(e.show,!0),this.checked=Cesium.defaultValue(e.checked,!1),this.modelType=Cesium.defaultValue(e.modelType,0),this.timeAttitudeCollection=[],this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{}),this.curTimeAttitude=Cesium.defaultValue(e.curTimeAttitude,new k_),this.disappearedTimeAttitude=Cesium.defaultValue(e.disappearedTimeAttitude,new k_),this.scale=Cesium.defaultValue(e.scale,1),this.modelUri=Cesium.defaultValue(e.modelUri,void 0),this.boundingBoxVisible=Cesium.defaultValue(e.boundingBoxVisible,!1),this.modelIconUri=Cesium.defaultValue(e.modelIconUri,void 0),this.modelIconColor=Cesium.defaultValue(e.modelIconColor,new Cesium.Color(1,0,0,1)),this.modelIconScale=Cesium.defaultValue(e.modelIconScale,1),this.modelIconRotation=Cesium.defaultValue(e.modelIconRotation,0),this.modelIconDisplayDistance=Cesium.defaultValue(e.modelIconDisplayDistance,new Cesium.DistanceDisplayCondition(6e4,9e4)),this.modelLabelType=void 0,this.modelLabelVisible=Cesium.defaultValue(e.modelLabelVisible,!0),this.modelLabelPixelOffset=Cesium.defaultValue(e.modelLabelPixelOffset,new Cesium.Cartesian2(50,25)),this.modelLabelPullWireColor=Cesium.defaultValue(e.modelLabelPullWireColor,new Cesium.Color(1,0,0,1)),this.modelLabelTextColor=Cesium.defaultValue(e.modelLabelTextColor,new Cesium.Color(1,0,0,1)),this.sectorRadarVisible=Cesium.defaultValue(e.sectorRadarVisible,!1),this.sectorRadarColor=Cesium.defaultValue(e.sectorRadarColor,new Cesium.Color(.38,.64,.64,.6)),this.trace=new FI({ribbonVisible:Cesium.defined(e.trace)?e.trace.ribbonVisible:Cesium.defaultValue(e.ribbonVisible,!1),ribbonColor:Cesium.defined(e.trace)?e.trace.ribbonColor:Cesium.defaultValue(e.ribbonColor,new Cesium.Color(1,0,0,1)),wallVisible:Cesium.defined(e.trace)?e.trace.wallVisible:Cesium.defaultValue(e.wallVisible,!1),wallColor:Cesium.defined(e.trace)?e.trace.wallColor:Cesium.defaultValue(e.wallColor,new Cesium.Color(1,0,0,1)),forwardOffset:Cesium.defined(e.trace)?e.trace.forwardOffset:Cesium.defaultValue(e.forwardOffset,0),upOffset:Cesium.defined(e.trace)?e.trace.upOffset:Cesium.defaultValue(e.upOffset,5),traceTimeDuration:Cesium.defined(e.trace)?e.trace.traceTimeDuration:Cesium.defaultValue(e.traceTimeDuration,0),barVisible:Cesium.defined(e.trace)?e.trace.barVisible:Cesium.defaultValue(e.barVisible,!1),barColor:Cesium.defined(e.trace)?e.trace.barColor:Cesium.defaultValue(e.barColor,new Cesium.Color(1,0,0,1)),lineVisible:Cesium.defined(e.trace)?e.trace.lineVisible:Cesium.defaultValue(e.lineVisible,!1),lineColor:Cesium.defined(e.trace)?e.trace.lineColor:Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),barTimeInterval:Cesium.defined(e.trace)?e.trace.barTimeInterval:Cesium.defaultValue(e.barTimeInterval,0)})}gE.prototype.addTimeAttitude=function(e){this.timeAttitudeCollection.push(new k_(e))};gE.prototype.getMovingTargetStateByTime=function(e,t,n){Cesium.Check.typeOf.number("time",e);var r=Cesium.defined(t)?t:!1,o=Cesium.defined(n)?n:!1,a=void 0;if(this.timeAttitudeCollection.length>0){if(!r&&e>=this.timeAttitudeCollection[this.timeAttitudeCollection.length-1].realTime){if(this.disappearedTimeAttitude=this.timeAttitudeCollection[this.timeAttitudeCollection.length-1],o)return this.curTimeAttitude=this.disappearedTimeAttitude,this.timeAttitudeCollection.splice(0,this.timeAttitudeCollection.length-1),a=new mE(this),a.realTime=this.disappearedTimeAttitude.realTime,a.fLon=this.disappearedTimeAttitude.fLon,a.fLat=this.disappearedTimeAttitude.fLat,a.fAlt=this.disappearedTimeAttitude.fAlt,a.position=this.disappearedTimeAttitude.position,a.headingPitchRoll=this.disappearedTimeAttitude.headingPitchRoll,a.nRedOrBlue=this.disappearedTimeAttitude.nRedOrBlue,a.specialAttributes=this.disappearedTimeAttitude.specialAttributes,a;this.curTimeAttitude=new k_,this.timeAttitudeCollection.splice(0,this.timeAttitudeCollection.length);return}for(var s=this.timeAttitudeCollection[0],u=s,l=1;l<this.timeAttitudeCollection.length;l++){if(u=this.timeAttitudeCollection[l],e>=s.realTime&&e<=u.realTime){var c=Lhe(s,u,e);Cesium.defined(c)&&(a=new mE(this),a.realTime=c.realTime,a.fLon=c.fLon,a.fLat=c.fLat,a.fAlt=c.fAlt,a.position=c.position,a.headingPitchRoll=c.headingPitchRoll,a.nRedOrBlue=c.nRedOrBlue,a.specialAttributes=c.specialAttributes,this.curTimeAttitude=c,!r&&this.timeAttitudeCollection.length>2&&l-2>0&&this.timeAttitudeCollection.splice(0,l-2));break}s=this.timeAttitudeCollection[l]}}else Cesium.defined(this.disappearedTimeAttitude.position)&&(this.disappearedTimeAttitude=new k_),Cesium.defined(this.curTimeAttitude.position)&&(this.curTimeAttitude=new k_);return a};gE.cloneTimeAttitude=function(e){return new k_(e)};function Lhe(e,t,n){if(!(!Cesium.defined(e)||!Cesium.defined(t))){var r=e.realTime,o=t.realTime,a=o*1-r;if(!(a<=0)){var s=n*1-e.realTime;if(!(s<=0||s>a)){var u=gE.cloneTimeAttitude(e),l=e.position,c=t.position,f=s/a,h=Cesium.Cartesian3.lerp(l,c,f,new Cesium.Cartesian3);u.position=h,u.realTime=n;var d=e.headingPitchRoll.roll,p=e.headingPitchRoll.pitch,_=e.headingPitchRoll.heading,y=t.headingPitchRoll.roll,v=t.headingPitchRoll.pitch,w=t.headingPitchRoll.heading,C=Math.abs(y-d),E=Math.abs(w-_),S=v-p;E=E>Math.PI?Math.PI*2-E:E,C=C>Math.PI?Math.PI*2-C:C;var A=FH(_,w),D=FH(d,y);return u.headingPitchRoll.heading=_+E*f*A,u.headingPitchRoll.pitch=p+(v-p)*f,u.headingPitchRoll.roll=d+C*f*D,u}}}}var Set=new x,Aet=new x,bet=new x;function FH(e,t){var n=new Cesium.Cartesian3(Math.sin(e),Math.cos(e),0),r=new Cesium.Cartesian3(Math.sin(t),Math.cos(t),0),o=Cesium.Cartesian3.cross(n,r,new Cesium.Cartesian3);return o.z>0?-1:1}var Bu=gE;var Rhe={ADD:0,REPLACE:1},Fr=Object.freeze(Rhe);function lp(e){if(this._loaderTaskProcessor=e.worker,this._xmlUrl=e.xmlUrl,!Cesium.defined(e.xmlUrl))throw new Cesium.DeveloperError("xmlUrl undefined!");this.trainingClock=e.trainingClock,this.datSource=e.datSource,this._promise=void 0,this.timeId=void 0,this.dataOperated=Fr.ADD,this.trajOperated=Fr.ADD,this.cachePlaneData=[],this.receiveDatas=[],this.receiveMTDatas=[],this.receiveMTFlightDatas=new Cesium.AssociativeArray,this.receiveTrajFlightDatas=new Cesium.AssociativeArray,this.receiveGtspiFlightDatas=new Cesium.AssociativeArray,this.receiveData=new Cesium.Event,this.stopReceiveData=new Cesium.Event,this.parseflight=new Cesium.AssociativeArray,this.initial_parseflight=new Cesium.AssociativeArray,this.idchFlyUser=new Cesium.AssociativeArray,this.idchFlyName=new Cesium.AssociativeArray,this.sendRadarMV=!1,this.redPlane=0,this.bluePlane=0,this.idchUnderName=new Cesium.AssociativeArray,this.idchUnderList=new Cesium.AssociativeArray,this.idchUnderInfo=new Cesium.AssociativeArray,this.idchUnderRaderList=new Cesium.AssociativeArray,this.rtknData=[],this.addEventArr=[],this.addRtkn=new Cesium.Event,this.addEventList=[],this.addAllRtkn=[],this.addIrsm=new Cesium.Event,this.addShowEvent=new Cesium.Event,this.irsmData=[],this.irsmIndex=0,this.redOrBlue=new Cesium.AssociativeArray,this.trajData=new Cesium.AssociativeArray,this.trajSendData=new Cesium.AssociativeArray,this.trajDataSid=new Cesium.AssociativeArray,this.radarTargetMap=new Cesium.AssociativeArray,this.radarTarget=new Cesium.AssociativeArray,this.radarEvent=new Cesium.Event,this.radarmvArr=[],this.ewsIndex=new Cesium.AssociativeArray,this.ewsData=new Cesium.AssociativeArray,this.gtspiData=[],this.gtspiArr=new Cesium.AssociativeArray,this.gtspiArrFine=new Cesium.AssociativeArray,this.sdrState=new Cesium.AssociativeArray,this.sdrIndex=new Cesium.AssociativeArray,this.sdrStateEvent=new Cesium.Event,this.missileXml=new Cesium.AssociativeArray,this.sendArr=new Cesium.AssociativeArray,this.planeXml=new Cesium.AssociativeArray,this.statictargetXml=new Cesium.AssociativeArray,this.largePlaneXml=new Cesium.AssociativeArray,this.gtspiXml=new Cesium.AssociativeArray,this.i3wpntypeXml=new Cesium.AssociativeArray,this.randomColor=new Cesium.AssociativeArray;var t=this;this.cacheTime=void 0,this.index=new Cesium.AssociativeArray,this.radarIndex=new Cesium.AssociativeArray,this.gtspiIndex=0,this.trajIndex=new Cesium.AssociativeArray,this.combatpower=new Cesium.AssociativeArray,NI.GetXMLToObject(this._xmlUrl,function(n){Nhe(t,n)}),this.clickNum=0,this.speed=1,this.StartWork(),this.planeResued=new Cesium.AssociativeArray,this.radarTime=new Cesium.AssociativeArray,this.radarWM=new Cesium.Event,this.addReaction=new Cesium.Event,this.flightState=new Cesium.Event,this.addPlane=new Cesium.Event,this.ewsEvent=new Cesium.Event}lp.prototype.addReceiveDataListener=function(e,t){switch(e){case Re.NET_MSG_TSPI:return this.receiveData.addEventListener(t);case Re.NET_MSG_FIGHTER:return this.flightState.addEventListener(t);case Re.NET_MSG_GTSPI:return this.receiveData.addEventListener(t);case Re.NET_MSG_RTKN:return this.addRtkn.addEventListener(t);case Re.NET_MSG_TARGET:return this.radarEvent.addEventListener(t);case Re.NET_MSG_RDR_STATE:return this.radarWM.addEventListener(t);case Re.NET_MSG_EWS_STA:return this.ewsEvent.addEventListener(t);case Re.NET_MSG_IRMSL_STATE:return this.addIrsm.addEventListener(t);case Re.NET_MSG_RAD_STATE:return this.sdrStateEvent.addEventListener(t);case"addShowEvent":return this.addShowEvent.addEventListener(t);case Re.NET_MSG_COMBATPOWER:return this.combatpower.addEventListener(t)}};lp.prototype.removeReceiveDataListener=function(e){return this.receiveData.removeEventListener(e)};lp.prototype.StartWork=function(){var e=this;this._promise=this._loaderTaskProcessor.scheduleTask({datSource:e.datSource}),this.onMessage()};lp.prototype.onMessage=function(){var e=this;if(Cesium.defined(e._promise))e._loaderTaskProcessor._worker.onmessage=function(t){var n=t.data;if(!Cesium.defined(n.id)&&n.length!=0&&typeof n[0]!="string")switch(e.cacheTime=n[n.length-1].header.datTime,n[0].header.msgType){case Re.NET_MSG_TSPI:for(var r=0;r<n.length;r++){var o=e.sendArr.get(n[r].header.sID),a=e.index.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.sendArr.set(n[r].header.sID,s)}if(a||e.index.set(n[r].header.sID,0),e.randomColor.contains(n[r].header.sID)||(e.randomColor.set(n[r].header.sID,Ohe()),n[r].chFlyUser?(e.idchFlyUser.set(n[r].header.sID,n[r].chFlyUser),e.idchFlyName.set(n[r].header.sID,n[r].chFlyUser+""+n[r].chFighterName)):(e.idchFlyUser.set(n[r].header.sID,n[r].header.sID),e.idchFlyName.set(n[r].header.sID,n[r].header.sID))),e.redOrBlue.contains(n[r].header.sID)){var u=e.redOrBlue.get(n[r].header.sID),l=u.length;u[l-1].nRedOrBlue!=n[r].nRedOrBlue&&u.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"fly"})}else{var s=[];s.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"fly"}),e.redOrBlue.set(n[r].header.sID,s)}}break;case Re.NET_MSG_FIGHTER:e.flightState.raiseEvent(n);for(var r=0;r<n.length;r++){var o=e.parseflight.get(n[r].header.sID),c=e.initial_parseflight.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.parseflight.set(n[r].header.sID,s)}c||e.initial_parseflight.set(n[r].header.sID,n[r])}break;case Re.NET_MSG_RTKN:for(var f=0;f<n.length;f++)if(e.idchFlyUser.contains(n[f].nTgtID))if(e.planeResued.contains(n[f].nTgtID))e.planeResued.get(n[f].nTgtID).push(n[f]);else{var h=[];h.push(n[f]),e.planeResued.set(n[f].nTgtID,h)}e.rtknData=e.rtknData.concat(n),e.addAllRtkn=e.addAllRtkn.concat(n),e.addEventArr=e.addEventArr.concat(n);break;case Re.NET_MSG_RTSN:e.addAllRtkn=e.addAllRtkn.concat(n),e.addEventArr=e.addEventArr.concat(n);break;case Re.NET_MSG_WPN_TRAJ:n.forEach(function(S){if(e.trajData.contains(S.header.sID))e.trajData.get(S.header.sID).push(S);else{var A=[];A.push(S),e.trajData.set(S.header.sID,A)}if(e.trajSendData.contains(S.weaponID))S.captureState!=0&&e.trajSendData.get(S.weaponID).length!=2&&e.trajSendData.get(S.weaponID)[0].captureState==0&&e.trajSendData.get(S.weaponID).push(S),e.trajDataSid.get(S.header.sID+"_"+S.weaponID).push(S);else{var D=[];D.push(S),e.trajSendData.set(S.weaponID,D),e.trajDataSid.set(S.header.sID+"_"+S.weaponID,D)}e.trajIndex.contains(S.header.sID)||e.trajIndex.set(S.header.sID,0)});break;case Re.NET_MSG_GTSPI:e.gtspiData=e.gtspiData.concat(n);for(var f=0;f<n.length;f++)e.idchUnderName.set(n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType),e.idchUnderList.set(n[f].header.sID,n[f].header.sID),e.idchUnderInfo.set(n[f].header.sID,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType),n[f].equipmentType==2&&e.idchUnderRaderList.set(n[f].header.sID,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType);for(var r=0;r<n.length;r++){var o=e.gtspiArr.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.gtspiArr.set(n[r].header.sID,s)}var d=e.gtspiArrFine.get(n[r].header.sID+"_"+n[r].equipmentID+"_"+n[r].equipmentType);if(d)d.push(n[r]);else{var s=[];s.push(n[r]),e.gtspiArrFine.set(n[r].header.sID+"_"+n[r].equipmentID+"_"+n[r].equipmentType,s)}}break;case Re.NET_MSG_IRMSL_STATE:n.forEach(function(S){e.irsmData.push(S)});break;case Re.NET_MSG_TARGET:n.forEach(function(S,A,D){if(e.radarTargetMap.contains(S.header.sID))e.radarTargetMap.get(S.header.sID).push(S);else{var P=[];P.push(S),e.radarTargetMap.set(S.header.sID,P)}if(e.radarIndex.contains(S.header.sID)||e.radarIndex.set(S.header.sID,0),e.radarTarget.contains(S.header.sID))e.radarTarget.get(S.header.sID).push(S);else{var P=[];P.push(S),e.radarTarget.set(S.header.sID,P)}});for(var p in e.radarTargetMap._hash){var _=e.radarTargetMap.get(p);if(Cesium.defined(_[0])){for(var y=_[0].header.datTime,v=0;v<_.length;v++){var w=_[v].header.datTime,C=e.radarTime.get(_[v].header.sID);if((_[v].tgtInfo[0].tgtSensor==0||_[v].tgtInfo[0].tgtSensor==2)&&_[v].tgtInfo[0].tgtAzimuth!=0&&_[v].tgtInfo[0].tgtAzimuth<70&&_[v].tgtInfo[0].tgtAzimuth>-70){if(e.radarTime.contains(_[v].header.sID)){if(v==0)continue;Cesium.defined(C[C.length-1].endTime)?C.push({startTime:new Date(_[v].header.datTime)}):w-y>2e3&&(C[C.length-1].endTime=new Date(_[v-1].header.datTime))}else{var s=[];s[0]={},s[0].startTime=_[v].header.datTime,e.radarTime.set(_[v].header.sID,s)}y=w}else Cesium.defined(C)&&!Cesium.defined(C[C.length-1].endTime)&&(C[C.length-1].endTime=new Date(_[v-1].header.datTime))}_.splice(0,_.length-1)}}break;case Re.NET_MSG_RDR_STATE:e.radarmvArr=e.radarmvArr.concat(n),e.radarWM.raiseEvent(e.radarmvArr);break;case Re.NET_MSG_EWS_STA:n.forEach(function(S){if(e.ewsData.contains(S.header.sID))e.ewsData.get(S.header.sID).push(S);else{var A=[];A.push(S),e.ewsData.set(S.header.sID,A)}e.ewsIndex.contains(S.header.sID)||e.ewsIndex.set(S.header.sID,0)});break;case Re.NET_MSG_RAD_STATE:n.forEach(function(S){if(e.sdrState.contains(S.header.sID))e.sdrState.get(S.header.sID).push(S);else{var A=[];A.push(S),e.sdrState.set(S.header.sID,A)}e.sdrIndex.contains(S.header.sID)||e.sdrIndex.set(S.header.sID,0)});case Re.NET_MSG_COMBATPOWER:n.forEach(function(S){if(e.combatpower.contains(S.header.sID))e.combatpower.get(S.header.sID).push(S);else{var A=[];A.push(S),e.combatpower.set(S.header.sID,A)}});for(var r=0;r<n.length;r++)if(e.redOrBlue.contains(n[r].header.sID)){var u=e.redOrBlue.get(n[r].header.sID),l=u.length,E=n[r].nRedOrBlue;E!==0&&E!=1&&(E=2),u[l-1].nRedOrBlue!=E&&u.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"car"})}else{var s=[],E=n[r].nRedOrBlue;E!==0&&E!==1&&(E=2),s.push({time:n[r].header.datTime,nRedOrBlue:E,type:"car"}),e.redOrBlue.set(n[r].header.sID,s)}break}};else return!1};lp.prototype.startSend=function(){var e=this;this.timeId=setInterval(function(){e.trainingClock.tick();var t=Cesium.JulianDate.toDate(e.trainingClock.currentTime);t=t.getTime(),e.speed=Number(e.speed);var n=[];for(var r in e.sendArr._hash){var o=e.index.get(r);if(o<e.sendArr._hash[r].length)o+parseInt(e.speed*50)>=e.sendArr._hash[r].length?n=n.concat(e.sendArr._hash[r].slice(o,e.sendArr._hash[r].length)):n=n.concat(e.sendArr._hash[r].slice(o,o+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.index.set(r,o+parseInt(e.speed*50)):n=n.concat(e.sendArr._hash[r].slice(o-400,o+parseInt(e.speed*400)));else continue}if(e.sendTspi(n,e.dataOperated),e.trajData._array.length!=0){var a=[];for(var r in e.trajData._hash){var s=e.trajIndex.get(r);s<e.trajData._hash[r].length&&(s+parseInt(e.speed*100)>e.trajData._hash[r].length?a=a.concat(e.trajData._hash[r].slice(s,e.trajData._hash[r].length)):a=a.concat(e.trajData._hash[r].slice(s,s+parseInt(e.speed*100))),e.trainingClock.shouldAnimate?e.trajIndex.set(r,s+parseInt(e.speed*100)):a=a.concat(e.trajData._hash[r].slice(s-200,s+parseInt(e.speed*200))))}e.sendTraj(a,e.trajOperated)}if(e.gtspiData.length!=0){if(e.gtspiIndex+parseInt(e.speed*50)>=e.gtspiData.length){var u=e.gtspiData.slice(e.gtspiIndex,e.gtspiData.length);e.trainingClock.shouldAnimate&&(e.gtspiIndex=parseInt(e.gtspiData.length))}else{var u=e.gtspiData.slice(e.gtspiIndex,e.gtspiIndex+parseInt(e.speed*50));e.trainingClock.shouldAnimate&&(e.gtspiIndex+=parseInt(e.speed*50))}u.length!=0&&e.sendGtspi(u,e.dataOperated)}if(e.irsmData.length!=0){var l=e.irsmData.slice(e.irsmIndex,e.irsmIndex+parseInt(e.speed*500));e.trainingClock.shouldAnimate&&(e.irsmIndex+=parseInt(e.speed*500)),l.length!=0&&e.addIrsm.raiseEvent(l)}if(e.rtknData.length!=0&&e.addRtkn.raiseEvent(e.rtknData.splice(0,e.rtknData.length)),e.addEventArr.length!=0&&e.addShowEvent.raiseEvent(e.addEventArr.splice(0,e.addEventArr.length)),e.radarTarget._array.length!=0){var c=[];for(var r in e.radarTarget._hash){var f=e.radarIndex.get(r);f<e.radarTarget._hash[r].length&&(f+parseInt(e.speed*50)>e.radarTarget._hash[r].length?c=c.concat(e.radarTarget._hash[r].slice(f,e.radarTarget._hash[r].length)):c=c.concat(e.radarTarget._hash[r].slice(f,f+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.radarIndex.set(r,f+parseInt(e.speed*50)):c=c.concat(e.radarTarget._hash[r].slice(f-200,f+parseInt(e.speed*200))))}c.length!=0&&(c=c.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.radarEvent.raiseEvent(c))}if(e.ewsData._array.length!=0){var h=[];for(var r in e.ewsData._hash){var d=e.ewsIndex.get(r);d<e.ewsData._hash[r].length&&(d+parseInt(e.speed*50)>e.ewsData._hash[r].length?h=h.concat(e.ewsData._hash[r].slice(d,e.ewsData._hash[r].length)):h=h.concat(e.ewsData._hash[r].slice(d,d+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.ewsIndex.set(r,d+parseInt(e.speed*50)):h=h.concat(e.ewsData._hash[r].slice(d-100,d+parseInt(e.speed*100))))}h.length!=0&&(h=h.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.ewsEvent.raiseEvent(h))}if(e.sdrState._array.length!=0){var p=[];for(var r in e.sdrState._hash){var _=e.sdrIndex.get(r);_<e.sdrState._hash[r].length&&(_+parseInt(e.speed*20)>e.sdrState._hash[r].length?p=p.concat(e.sdrState._hash[r].slice(_,e.sdrState._hash[r].length)):p=p.concat(e.sdrState._hash[r].slice(_,_+parseInt(e.speed*20))),e.trainingClock.shouldAnimate?e.sdrIndex.set(r,_+parseInt(e.speed*20)):p=p.concat(e.sdrState._hash[r].slice(_,f+parseInt(e.speed*10))))}p.length!=0&&(p=p.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.sdrStateEvent.raiseEvent(p))}e.sendRadarMV&&(e.radarWM.raiseEvent(e.radarmvArr),e.sendRadarMV=!1)},1e3)};lp.prototype.sendTspi=function(e,t){var n=this,r=1,o=e;o=o.sort(function(f,h){return f.header.datTime-h.header.datTime});for(var a=0;a<o.length;a+=r){var s=o[a].header.sID,u=n.receiveMTFlightDatas.get(s);if(Cesium.defined(u))u.addTimeAttitude({realTime:o[a].header.datTime,fLon:o[a].fLon,fLat:o[a].fLat,fAlt:o[a].fAlt,position:o[a].position,nRedOrBlue:o[a].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(o[a].fHeading,o[a].fPitch,o[a].fRoll),specialAttributes:{decoyDrop:o[a].decoyDrop,enginePower:o[a].enginePower,trainPro:o[a].trainPro,height:o[a].height,vel_east:o[a].vel_east,vel_north:o[a].vel_north,vel_up:o[a].vel_up,fHeading:o[a].fHeading,fPitch:o[a].fPitch,fRoll:o[a].fRoll}});else{if(Cesium.defined(n.planeXml.get(o[a].header.planeType)))var l=n.planeXml.get(o[a].header.planeType)._path;else continue;var c=new Bu({uId:o[a].header.sID,mtType:Re.NET_MSG_TSPI,name:o[a].chFlyUser,modelType:o[a].header.planeType,modelUri:l,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(n.planeXml.get(o[a].header.planeType)._modelscale),forwardOffset:-15,upOffset:2,traceTimeDuration:20});c.addTimeAttitude({realTime:o[a].header.datTime,fLon:o[a].fLon,fLat:o[a].fLat,fAlt:o[a].fAlt,position:o[a].position,nRedOrBlue:o[a].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(o[a].fHeading,o[a].fPitch,o[a].fRoll),specialAttributes:{decoyDrop:o[a].decoyDrop,enginePower:o[a].enginePower,trainPro:o[a].trainPro,height:o[a].height,vel_east:o[a].vel_east,vel_north:o[a].vel_north,vel_up:o[a].vel_up,fHeading:o[a].fHeading,fPitch:o[a].fPitch,fRoll:o[a].fRoll}}),n.receiveMTFlightDatas.set(c.uId,c),n.addAllRtkn.push(o[a])}}n.receiveData.raiseEvent(n.receiveMTFlightDatas,t),n.dataOperated=Fr.ADD,n.receiveMTFlightDatas._array.forEach(function(f){f.timeAttitudeCollection=[]})};lp.prototype.sendTraj=function(e,t){for(var n=this,r=e.sort(function(h,d){return h.header.datTime-d.header.datTime}),o=0;o<r.length;o++){var a=r[o].header.sID+"_"+r[o].weaponID,s=n.redOrBlue.get(r[o].header.sID);if(!!Cesium.defined(s)){if(s.length==1)r[o].nRedOrBlue=s[0].nRedOrBlue;else for(var u=1;u<s.length;u++)r[o].header.datTime>=s[u].time&&(r[o].nRedOrBlue=s[u].nRedOrBlue);var l=n.receiveTrajFlightDatas.get(a);if(Cesium.defined(l))l.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].mslLongitude,fLat:r[o].mslLatitude,fAlt:r[o].mslAltitude,position:r[o].position,nRedOrBlue:r[o].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].mslCourse,r[o].mslPitch,0),specialAttributes:{weaponID:r[o].weaponID,vel:parseFloat(r[o].vel)*3.6,mslDistance:r[o].mslDistance,targetID:r[o].targetID,weaponType:r[o].weaponType,mslAltitude:r[o].mslAltitude}});else{if(Cesium.defined(n.missileXml.get(r[o].weaponType)))var c=n.missileXml.get(r[o].weaponType)._path;else continue;var f=new Bu({uId:a,mtType:Re.NET_MSG_WPN_TRAJ,name:n.missileXml.get(r[o].weaponType)._modelName,modelType:r[o].weaponType,modelUri:c,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(n.missileXml.get(r[o].weaponType)._modelscale),forwardOffset:-15,upOffset:2,traceTimeDuration:20,specialAttributes:{targetID:r[o].targetID}});f.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].mslLongitude,fLat:r[o].mslLatitude,fAlt:r[o].mslAltitude,position:r[o].position,nRedOrBlue:r[o].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].mslCourse,r[o].mslPitch,0),specialAttributes:{weaponID:r[o].weaponID,vel:parseFloat(r[o].vel)*3.6,mslDistance:r[o].mslDistance,targetID:r[o].targetID,weaponType:r[o].weaponType,mslAltitude:r[o].mslAltitude}}),n.receiveTrajFlightDatas.set(f.uId,f)}}}n.receiveData.raiseEvent(n.receiveTrajFlightDatas,t),n.trajOperated=Fr.ADD,n.receiveTrajFlightDatas._array.forEach(function(h){h.timeAttitudeCollection=[]})};lp.prototype.sendGtspi=function(e,t){for(var n=this,r=e,o=0;o<r.length;o++){var a=r[o].header.sID+"_"+r[o].equipmentID+"_"+r[o].equipmentType,s=Bhe(n.combatpower,r[o]),u=n.receiveGtspiFlightDatas.get(a);if(Cesium.defined(u))u.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].gTspiLon,fLat:r[o].gTspiLat,fAlt:r[o].gTspiAlt,position:r[o].position,nRedOrBlue:s,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].northAngle,0,0),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}});else{if(Cesium.defined(n.gtspiXml.get(r[o].campType)))var l=n.gtspiXml.get(r[o].campType).srdtype,c=l.find(function(d){return d._id==r[o].equipmentType}),f=c._path;else continue;var h=new Bu({uId:a,mtType:Re.NET_MSG_GTSPI,name:c._desc,modelType:r[o].equipmentType,modelUri:f,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(c._modelscale),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}});h.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].gTspiLon,fLat:r[o].gTspiLat,fAlt:r[o].gTspiAlt,position:r[o].position,nRedOrBlue:s,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].northAngle,0,0),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}}),n.receiveGtspiFlightDatas.set(h.uId,h)}}n.receiveData.raiseEvent(n.receiveGtspiFlightDatas,t),n.dataOperated=Fr.ADD,n.receiveGtspiFlightDatas._array.forEach(function(d){d.timeAttitudeCollection=[]})};lp.prototype.splitTwo=function(e,t,n){var r=0,o=t.length-1;if(n==null)for(;r<=o;){var a=Math.ceil((o+r)/2);if(t[a+1]!=null){if(t[a].header.datTime<=e&&t[a+1].header.datTime>e)return t[a+1];if(t[a].header.datTime<e)r=a;else if(t[a].header.datTime>e)o=a;else return-1}else return t[a];if(o==1)return t[0]}else if(n!=null)for(;r<=o;){var a=Math.ceil((o+r)/2);if(t[a+1]!=null){if(t[a].header.datTime<=e&&t[a+1].header.datTime>e)return a;if(t[a].header.datTime<e)r=a;else if(t[a].header.datTime>e)o=a;else return-1}else return a;if(o==1)return a-1}};function Ohe(){var e=Math.floor(Math.random()*256),t=Math.floor(Math.random()*256),n=Math.floor(Math.random()*256);return"rgb("+e+","+t+","+n+")"}function Nhe(e,t){for(var n=0;n<t.length;n++){var r=t[n].name;if(r=="planemissile"){for(var o=t[n].InfoJson.root.missile.model,a=t[n].InfoJson.root.plane.model,s=0;s<o.length;s++)e.missileXml.set(o[s]._type,o[s]);for(var u=0;u<a.length;u++)e.planeXml.set(a[u]._type,a[u])}else if(r=="gtspi")for(var l=t[n].InfoJson.root.gtspi,c=0;c<l.length;c++)e.gtspiXml.set(l[c]._id,l[c]);else if(r=="statictarget")for(var f=t[n].InfoJson.root.statictgt,h=0;h<f.length;h++)e.statictargetXml.set(f[h]._id,f[h]);else if(r=="largeplane")for(var d=t[n].InfoJson.root.model,p=0;p<d.length;p++)e.largePlaneXml.set(d[p]._type,d[p]);else if(r=="i3wpntype")for(var _=t[n].InfoJson.root.missileType.model,y=0;y<_.length;y++)e.i3wpntypeXml.set(_[y]._type,_[y])}}function Bhe(e,t){for(var n=e.get(t.header.sID),r=t.header.realTime,o="",a=0;a<n.length;a++)a==0?o=n[0].nRedOrBlue:a<n.length-1&&n[a].header.datTime<=r&&n[a].header.datTime>r&&(o=n[a].nRedOrBlue);return o!==0&&o!==1&&(o=2),o}var zI=lp;function t0(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new xe,this.setValue(e)}Object.defineProperties(t0.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}});t0.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value};t0.prototype.setValue=function(e){let t=this._value;if(t!==e){let n=g(e),r=n&&typeof e.clone=="function",o=n&&typeof e.equals=="function";(!o||!e.equals(t))&&(this._hasClone=r,this._hasEquals=o,this._value=r?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}};t0.prototype.equals=function(e){return this===e||e instanceof t0&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))};t0.prototype.valueOf=function(){return this._value};t0.prototype.toString=function(){return String(this._value)};var cp=t0;function Fhe(e,t,n,r,o){return{configurable:r,get:function(){return this[t]},set:function(a){let s=this[t],u=this[n];g(u)&&(u(),this[n]=void 0),a!==void 0&&(!g(a)||!g(a.getValue))&&g(o)&&(a=o(a)),s!==a&&(this[t]=a,this._definitionChanged.raiseEvent(this,e,a,s)),g(a)&&g(a.definitionChanged)&&(this[n]=a.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,e,a,a)},this))}}}function zhe(e){return new cp(e)}function Vhe(e,t,n){return Fhe(e,`_${e.toString()}`,`_${e.toString()}Subscription`,T(t,!1),T(n,zhe))}var Z=Vhe;function id(){Le.throwInstantiationError()}Object.defineProperties(id.prototype,{isConstant:{get:Le.throwInstantiationError},definitionChanged:{get:Le.throwInstantiationError}});id.prototype.getValue=Le.throwInstantiationError;id.prototype.equals=Le.throwInstantiationError;id.equals=function(e,t){return e===t||g(e)&&e.equals(t)};id.arrayEquals=function(e,t){if(e===t)return!0;if(!g(e)||!g(t)||e.length!==t.length)return!1;let n=e.length;for(let r=0;r<n;r++)if(!id.equals(e[r],t[r]))return!1;return!0};id.isConstant=function(e){return!g(e)||e.isConstant};id.getValueOrUndefined=function(e,t,n){return g(e)?e.getValue(t,n):void 0};id.getValueOrDefault=function(e,t,n,r){return g(e)?T(e.getValue(t,r),n):n};id.getValueOrClonedDefault=function(e,t,n,r){let o;return g(e)&&(o=e.getValue(t,r)),g(o)||(o=n.clone(o)),o};var _e=id;var khe=K.WHITE,Ghe=K.BLACK,Uhe=1;function wC(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(wC.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)&&_e.isConstant(this._outlineColor)&&_e.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth")});wC.prototype.getType=function(e){return"PolylineOutline"};wC.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,khe,t.color),t.outlineColor=_e.getValueOrClonedDefault(this._outlineColor,e,Ghe,t.outlineColor),t.outlineWidth=_e.getValueOrDefault(this._outlineWidth,e,Uhe),t};wC.prototype.equals=function(e){return this===e||e instanceof wC&&_e.equals(this._color,e._color)&&_e.equals(this._outlineColor,e._outlineColor)&&_e.equals(this._outlineWidth,e._outlineWidth)};var _E=wC;function n2(e,t){this.viewer=e,this.options=t,this.mtMgr=t.mtMgr,this.entityid=[]}n2.prototype.Point_Connection=function(e,t,n,r,o){let a=this;a.viewer.entities.add({polyline:{positions:e,width:1,material:new _E({color:K.YELLOW,outlineWidth:1,outlineColor:K.YELLOW})},id:t}),a.viewer.entities.add({position:n,label:{text:r,font:"15px sans-serif",name:t},id:`${t}pop`}),a.entityid.push({lineID:t,textID:`${t}pop`,type:o})};n2.prototype.RemoveLine=function(e){let t=this;for(let r=0;r<e.length;r++)n(e[r]),n(`${e[r]}pop`),t.entityid=t.entityid.filter(function(o){return o.lineID!==e[r]});function n(r){let o=t.viewer.entities.getById(r);t.viewer.entities.remove(o)}};var VI=n2;function vc(e){this._ellipsoid=T(e,Ge.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(vc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});vc.mercatorAngleToGeodeticLatitude=function(e){return F.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};vc.geodeticLatitudeToMercatorAngle=function(e){e>vc.MaximumLatitude?e=vc.MaximumLatitude:e<-vc.MaximumLatitude&&(e=-vc.MaximumLatitude);let t=Math.sin(e);return .5*Math.log((1+t)/(1-t))};vc.MaximumLatitude=vc.mercatorAngleToGeodeticLatitude(Math.PI);vc.prototype.project=function(e,t){let n=this._semimajorAxis,r=e.longitude*n,o=vc.geodeticLatitudeToMercatorAngle(e.latitude)*n,a=e.height;return g(t)?(t.x=r,t.y=o,t.z=a,t):new x(r,o,a)};vc.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,r=e.x*n,o=vc.mercatorAngleToGeodeticLatitude(e.y*n),a=e.z;return g(t)?(t.longitude=r,t.latitude=o,t.height=a,t):new le(r,o,a)};var EC=vc;function TC(e){if(e=T(e,T.EMPTY_OBJECT),!g(e.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.KiloGridHandler=void 0,this._viewer=e.viewer,this.coordinatesEntities=[],this.gridLines=[],this.kiloGridlabels=[]}Object.defineProperties(TC.prototype,{});TC.prototype.drawCoordinates=function(e,t,n,r,o){this.removeCoordinates(),this._viewer.scene.globe.depthTestAgainstTerrain=!1,this._viewer.scene.enableDepthPlane=!0;let a=T(e,20),s=T(t,10),u=T(n,!0),l=T(r,!0),c=T(o,K.WHITE),f=this._viewer.entities;for(let d=-180;d<=180;d+=a){let p="";d===0&&(p="0"),p+=d===0?"":`${d}\xB0`,d===-180&&(p=""),this.coordinatesEntities.push(f.add({position:x.fromDegrees(d,0),polyline:{positions:x.fromDegreesArray([d,-90,d,0,d,90]),width:1,clampToGround:!1,material:c},label:{show:u,text:p,verticalOrigin:ln.TOP,font:"14px sans-serif",fillColor:c}}))}let h=[];for(let d=-180;d<=180;d+=.5)h.push(d);for(let d=-80;d<=80;d+=s){let p="";p+=`${d}\xB0`,d===0&&(p="");let _=h.map(function(y){return[y,d].join(",")}).join(",").split(",").map(y=>Number(y));this.coordinatesEntities.push(f.add({position:x.fromDegrees(0,d),polyline:{positions:x.fromDegreesArray(_),clampToGround:!1,width:1,material:c},label:{show:l,text:p,font:"14px sans-serif",fillColor:K.WHITE}}))}};TC.prototype.removeCoordinates=function(){let e=this;this.coordinatesEntities.forEach(t=>{e._viewer.entities.remove(t)}),this.coordinatesEntities=[]};TC.prototype.drawKilometerGrid=function(e,t,n,r,o,a,s,u,l,c,f){this.removeKilometerGrid(),this._viewer.scene.globe.depthTestAgainstTerrain=!1,this._viewer.scene.enableDepthPlane=!0;let h=this;this.gridLines=[],this.kiloGridlabels=[];let d=T(e,120),p=T(t,120),_=T(n,0),y=T(r,0),v=T(a,100),w=T(s,100),C=1,E=1,S=T(u,new K(1,0,0,1)),A=T(l,new K(0,0,1,1));c=T(c,new K(0,1,0,1));let D=le.fromDegrees(d,p),P=new EC,M=P.project(D),b=P.unproject(new x(M.x+v*1e3,M.y+w*1e3,M.z));if(o===0){for(let O=0;O<=v;O++){let m=M.x+O*C*1e3,I=[];for(let L=0;L<=w;L++){let R=M.y+L*1e3,N=P.unproject(new x(m,R,M.z));I.push(N.longitude),I.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(I),width:1,clampToGround:!1,material:S}}))}for(let O=0;O<=w;O++){let m=M.y+O*E*1e3,I=[];for(let L=0;L<=v;L++){let R=M.x+L*1e3,N=P.unproject(new x(R,m,M.z));I.push(N.longitude),I.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(I),width:1,clampToGround:!1,material:S}}))}}else if(o===1){let O=v*3;C=C/3;for(let I=0;I<=O;I++){let L=M.x+I*C*1e3,R=[];for(let B=0;B<=w;B++){let V=M.y+B*1e3,z=P.unproject(new x(L,V,M.z));R.push(z.longitude),R.push(z.latitude)}let N=S;I%3!==0&&(N=A),this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(R),width:1,clampToGround:!1,material:N}}))}let m=v*3;E=E/3;for(let I=0;I<=m;I++){let L=M.y+I*E*1e3,R=[];for(let B=0;B<=v;B++){let V=M.x+B*1e3,z=P.unproject(new x(V,L,M.z));R.push(z.longitude),R.push(z.latitude)}let N=S;I%3!==0&&(N=A),this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(R),width:1,clampToGround:!1,material:N}}))}for(let I=0;I<O;I++){let L=M.x+(I+.5)*C*1e3;for(let R=0;R<m;R++){let N=M.y+(R+.5)*E*1e3,B=P.unproject(new x(L,N,M.z)),V=I%3,z=R%3,U=zH(V,z);this.kiloGridlabels.push(this._viewer.entities.add({position:le.toCartesian(B),label:{show:!0,text:U,verticalOrigin:ln.TOP,font:"14px sans-serif",fillColor:c,distanceDisplayCondition:new yn(0,3e4)}}))}}}else if(o===2){for(let O=0;O<=v;O++){let m=M.x+O*C*1e3,I=[];for(let L=0;L<=w;L++){let R=M.y+L*1e3,N=P.unproject(new x(m,R,M.z));I.push(N.longitude),I.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(I),width:1,clampToGround:!1,material:S}}))}for(let O=0;O<=w;O++){let m=M.y+O*E*1e3,I=[];for(let L=0;L<=v;L++){let R=M.x+L*1e3,N=P.unproject(new x(R,m,M.z));I.push(N.longitude),I.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(I),width:1,clampToGround:!1,material:S}}))}}this.KiloGridHandler||(this.KiloGridHandler=new e0(this._viewer.canvas,!0),this.KiloGridHandler.setInputAction(function(O){if(h._viewer.scene.pickPositionSupported){let I=h._viewer.scene.camera.getPickRay(O.endPosition),L=h._viewer.scene.globe.pick(I,h._viewer.scene);if(!L)return;let R=le.fromCartesian(L);if(D.longitude<=R.longitude&&D.latitude<R.latitude&&b.longitude>=R.longitude&&b.latitude>=R.latitude){let N=(b.longitude-D.longitude)/v,B=(b.latitude-D.latitude)/w,V=(R.longitude-D.longitude)/N,z=(R.latitude-D.latitude)/B;if(o===0){if(f){let U=`${Math.floor(V+_)},${Math.floor(z+y)}`;f(U)}}else if(o===1){let U=V-Math.floor(V)<=.3333333333333333?0:V-Math.floor(V)>=.6666666666666666?2:1,Q=z-Math.floor(z)<=1/3?0:z-Math.floor(z)>=2/3?2:1,ne=zH(U,Q);if(f){let se=`${Math.floor(V+_)},${Math.floor(z+y)}(${ne})`;f(se)}}else if(o===2){let U=Math.floor(V)*N+D.longitude,Q=Math.floor(z)*B+D.latitude,ne=P.project(new le(U,Q)),se=P.project(R);if(f){let de=`${String(Math.floor(V+_))+String((se.x-ne.x).toFixed(2))},${String(Math.floor(z+y))}${String((se.y-ne.y).toFixed(2))}`;f(de)}}}}},_n.MOUSE_MOVE))};TC.prototype.removeKilometerGrid=function(){this.KiloGridHandler&&(this.KiloGridHandler.destroy(),this.KiloGridHandler=void 0);let e=this;this.gridLines.forEach(t=>{e._viewer.entities.remove(t)}),this.gridLines=[],this.kiloGridlabels.forEach(t=>{e._viewer.entities.remove(t)}),this.kiloGridlabels=[]};function zH(e,t){let n="1";return e===0&&t===2?n="1":e===1&&t===2?n="2":e===2&&t===2?n="3":e===2&&t===1?n="4":e===2&&t===0?n="5":e===1&&t===0?n="6":e===0&&t===0?n="7":e===0&&t===1?n="8":e===1&&t===1&&(n="9"),n}var VH=TC;var Hhe={POLYGON:0,POLYLINE:1,POINT:2,DASHLINE:3,OUTLINE:4,ARROELINE:5,GLOWLINE:6,WAKELINE:7,GRID:8,STRIPE:9,MEASURELINE:10,CIRCLE:11},od=Object.freeze(Hhe);var qhe={LEFT_RIGHT_CLICK:0,LEFT_DOUBLE_CLICK:1},G_=Object.freeze(qhe);function n0(e){e=T(e,T.EMPTY_OBJECT),this._ellipsoid=T(e.ellipsoid,Ge.WGS84),this._rectangle=T(e.rectangle,hn.MAX_VALUE),this._projection=new mc(this._ellipsoid),this._numberOfLevelZeroTilesX=T(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=T(e.numberOfLevelZeroTilesY,1)}Object.defineProperties(n0.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});n0.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};n0.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};n0.prototype.rectangleToNativeRectangle=function(e,t){let n=F.toDegrees(e.west),r=F.toDegrees(e.south),o=F.toDegrees(e.east),a=F.toDegrees(e.north);return g(t)?(t.west=n,t.south=r,t.east=o,t.north=a,t):new hn(n,r,o,a)};n0.prototype.tileXYToNativeRectangle=function(e,t,n,r){let o=this.tileXYToRectangle(e,t,n,r);return o.west=F.toDegrees(o.west),o.south=F.toDegrees(o.south),o.east=F.toDegrees(o.east),o.north=F.toDegrees(o.north),o};n0.prototype.tileXYToRectangle=function(e,t,n,r){let o=this._rectangle,a=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),u=o.width/a,l=e*u+o.west,c=(e+1)*u+o.west,f=o.height/s,h=o.north-t*f,d=o.north-(t+1)*f;return g(r)||(r=new hn(l,d,c,h)),r.west=l,r.south=d,r.east=c,r.north=h,r};n0.prototype.positionToTileXY=function(e,t,n){let r=this._rectangle;if(!hn.contains(r,e))return;let o=this.getNumberOfXTilesAtLevel(t),a=this.getNumberOfYTilesAtLevel(t),s=r.width/o,u=r.height/a,l=e.longitude;r.east<r.west&&(l+=F.TWO_PI);let c=(l-r.west)/s|0;c>=o&&(c=o-1);let f=(r.north-e.latitude)/u|0;return f>=a&&(f=a-1),g(n)?(n.x=c,n.y=f,n):new X(c,f)};var kI=n0;var kH=new x,GH=new x,UH=new le,r2=new x,Whe=new x,HH=new Ee,Yhe=new kI,yE=[new le,new le,new le,new le],vE=new X,Ba={};Ba.initialize=function(){let e=Ba._initPromise;return g(e)||(e=vt.fetchJson(La("Assets/approximateTerrainHeights.json")).then(function(t){Ba._terrainHeights=t}),Ba._initPromise=e),e};Ba.getMinimumMaximumHeights=function(e,t){t=T(t,Ge.WGS84);let n=qH(e),r=Ba._defaultMinTerrainHeight,o=Ba._defaultMaxTerrainHeight;if(g(n)){let a=`${n.level}-${n.x}-${n.y}`,s=Ba._terrainHeights[a];g(s)&&(r=s[0],o=s[1]),t.cartographicToCartesian(hn.northeast(e,UH),kH),t.cartographicToCartesian(hn.southwest(e,UH),GH),x.midpoint(GH,kH,r2);let u=t.scaleToGeodeticSurface(r2,Whe);if(g(u)){let l=x.distance(r2,u);r=Math.min(r,-l)}else r=Ba._defaultMinTerrainHeight}return r=Math.max(Ba._defaultMinTerrainHeight,r),{minimumTerrainHeight:r,maximumTerrainHeight:o}};Ba.getBoundingSphere=function(e,t){t=T(t,Ge.WGS84);let n=qH(e),r=Ba._defaultMaxTerrainHeight;if(g(n)){let a=`${n.level}-${n.x}-${n.y}`,s=Ba._terrainHeights[a];g(s)&&(r=s[1])}let o=Ee.fromRectangle3D(e,t,0);return Ee.fromRectangle3D(e,t,r,HH),Ee.union(o,HH,o)};function qH(e){le.fromRadians(e.east,e.north,0,yE[0]),le.fromRadians(e.west,e.north,0,yE[1]),le.fromRadians(e.east,e.south,0,yE[2]),le.fromRadians(e.west,e.south,0,yE[3]);let t=0,n=0,r=0,o=0,a=Ba._terrainHeightsMaxLevel,s;for(s=0;s<=a;++s){let u=!1;for(let l=0;l<4;++l){let c=yE[l];if(Yhe.positionToTileXY(c,s,vE),l===0)r=vE.x,o=vE.y;else if(r!==vE.x||o!==vE.y){u=!0;break}}if(u)break;t=r,n=o}if(s!==0)return{x:t,y:n,level:s>a?a:s-1}}Ba._terrainHeightsMaxLevel=6;Ba._defaultMaxTerrainHeight=9e3;Ba._defaultMinTerrainHeight=-1e5;Ba._terrainHeights=void 0;Ba._initPromise=void 0;Object.defineProperties(Ba,{initialized:{get:function(){return g(Ba._terrainHeights)}}});var Zc=Ba;function Xhe(e){e=T(e,T.EMPTY_OBJECT),this.geometry=e.geometry,this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=T(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var U_=Xhe;function jhe(e){e=T(e,T.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=T(e.normalize,!1),this.value=e.value}var Qc=jhe;var Khe={NONE:0,GEODESIC:1,RHUMB:2},Fa=Object.freeze(Khe);var WH=F.EPSILON10;function Zhe(e,t,n,r){if(!g(e))return;n=T(n,!1);let o=g(r),a=e.length;if(a<2)return e;let s,u=e[0],l,c,f=0,h=-1;for(s=1;s<a;++s)l=e[s],t(u,l,WH)?(g(c)||(c=e.slice(0,s),f=s-1,h=0),o&&r.push(s)):(g(c)&&(c.push(l),f=s,o&&(h=r.length)),u=l);return n&&t(e[0],e[a-1],WH)&&(o&&(g(c)?r.splice(h,0,f):r.push(a-1)),g(c)?c.length-=1:c=e.slice(0,-1)),g(c)?c:e}var SC=Zhe;function Qhe(e){let t=e._uSquared,n=e._ellipsoid.maximumRadius,r=e._ellipsoid.minimumRadius,o=(n-r)/n,a=Math.cos(e._startHeading),s=Math.sin(e._startHeading),u=(1-o)*Math.tan(e._start.latitude),l=1/Math.sqrt(1+u*u),c=l*u,f=Math.atan2(u,a),h=l*s,d=h*h,p=1-d,_=Math.sqrt(p),y=t/4,v=y*y,w=v*y,C=v*v,E=1+y-3*v/4+5*w/4-175*C/64,S=1-y+15*v/8-35*w/8,A=1-3*y+35*v/4,D=1-5*y,P=E*f-S*Math.sin(2*f)*y/2-A*Math.sin(4*f)*v/16-D*Math.sin(6*f)*w/48-Math.sin(8*f)*5*C/512,M=e._constants;M.a=n,M.b=r,M.f=o,M.cosineHeading=a,M.sineHeading=s,M.tanU=u,M.cosineU=l,M.sineU=c,M.sigma=f,M.sineAlpha=h,M.sineSquaredAlpha=d,M.cosineSquaredAlpha=p,M.cosineAlpha=_,M.u2Over4=y,M.u4Over16=v,M.u6Over64=w,M.u8Over256=C,M.a0=E,M.a1=S,M.a2=A,M.a3=D,M.distanceRatio=P}function Jhe(e,t){return e*t*(4+e*(4-3*t))/16}function YH(e,t,n,r,o,a,s){let u=Jhe(e,n);return(1-u)*e*t*(r+u*o*(s+u*a*(2*s*s-1)))}function $he(e,t,n,r,o,a,s){let u=(t-n)/t,l=a-r,c=Math.atan((1-u)*Math.tan(o)),f=Math.atan((1-u)*Math.tan(s)),h=Math.cos(c),d=Math.sin(c),p=Math.cos(f),_=Math.sin(f),y=h*p,v=h*_,w=d*_,C=d*p,E=l,S=F.TWO_PI,A=Math.cos(E),D=Math.sin(E),P,M,b,O,m;do{A=Math.cos(E),D=Math.sin(E);let Q=v-C*A;b=Math.sqrt(p*p*D*D+Q*Q),M=w+y*A,P=Math.atan2(b,M);let ne;b===0?(ne=0,O=1):(ne=y*D/b,O=1-ne*ne),S=E,m=M-2*w/O,isFinite(m)||(m=0),E=l+YH(u,ne,O,P,b,M,m)}while(Math.abs(E-S)>F.EPSILON12);let I=O*(t*t-n*n)/(n*n),L=1+I*(4096+I*(I*(320-175*I)-768))/16384,R=I*(256+I*(I*(74-47*I)-128))/1024,N=m*m,B=R*b*(m+R*(M*(2*N-1)-R*m*(4*b*b-3)*(4*N-3)/6)/4),V=n*L*(P-B),z=Math.atan2(p*D,v-C*A),U=Math.atan2(h*D,v*A-C);e._distance=V,e._startHeading=z,e._endHeading=U,e._uSquared=I}var ede=new x,i2=new x;function XH(e,t,n,r){let o=x.normalize(r.cartographicToCartesian(t,i2),ede),a=x.normalize(r.cartographicToCartesian(n,i2),i2);$he(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude),e._start=le.clone(t,e._start),e._end=le.clone(n,e._end),e._start.height=0,e._end.height=0,Qhe(e)}function CE(e,t,n){let r=T(n,Ge.WGS84);this._ellipsoid=r,this._start=new le,this._end=new le,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,g(e)&&g(t)&&XH(this,e,t,r)}Object.defineProperties(CE.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}});CE.prototype.setEndPoints=function(e,t){XH(this,e,t,this._ellipsoid)};CE.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)};CE.prototype.interpolateUsingSurfaceDistance=function(e,t){let n=this._constants,r=n.distanceRatio+e/n.b,o=Math.cos(2*r),a=Math.cos(4*r),s=Math.cos(6*r),u=Math.sin(2*r),l=Math.sin(4*r),c=Math.sin(6*r),f=Math.sin(8*r),h=r*r,d=r*h,p=n.u8Over256,_=n.u2Over4,y=n.u6Over64,v=n.u4Over16,w=2*d*p*o/3+r*(1-_+7*v/4-15*y/4+579*p/64-(v-15*y/4+187*p/16)*o-(5*y/4-115*p/16)*a-29*p*s/16)+(_/2-v+71*y/32-85*p/16)*u+(5*v/16-5*y/4+383*p/96)*l-h*((y-11*p/2)*u+5*p*l/2)+(29*y/96-29*p/16)*c+539*p*f/1536,C=Math.asin(Math.sin(w)*n.cosineAlpha),E=Math.atan(n.a/n.b*Math.tan(C));w=w-n.sigma;let S=Math.cos(2*n.sigma+w),A=Math.sin(w),D=Math.cos(w),P=n.cosineU*D,M=n.sineU*A,O=Math.atan2(A*n.sineHeading,P-M*n.cosineHeading)-YH(n.f,n.sineAlpha,n.cosineSquaredAlpha,w,A,D,S);return g(t)?(t.longitude=this._start.longitude+O,t.latitude=E,t.height=0,t):new le(this._start.longitude+O,E,0)};var r0=CE;function a2(e,t,n){if(e===0)return t*n;let r=e*e,o=r*r,a=o*r,s=a*r,u=s*r,l=u*r,c=n,f=Math.sin(2*c),h=Math.sin(4*c),d=Math.sin(6*c),p=Math.sin(8*c),_=Math.sin(10*c),y=Math.sin(12*c);return t*((1-r/4-3*o/64-5*a/256-175*s/16384-441*u/65536-4851*l/1048576)*c-(3*r/8+3*o/32+45*a/1024+105*s/4096+2205*u/131072+6237*l/524288)*f+(15*o/256+45*a/1024+525*s/16384+1575*u/65536+155925*l/8388608)*h-(35*a/3072+175*s/12288+3675*u/262144+13475*l/1048576)*d+(315*s/131072+2205*u/524288+43659*l/8388608)*p-(693*u/1310720+6237*l/5242880)*_+1001*l/8388608*y)}function tde(e,t,n){let r=e/n;if(t===0)return r;let o=r*r,a=o*r,s=a*r,u=t,l=u*u,c=l*l,f=c*l,h=f*l,d=h*l,p=d*l,_=Math.sin(2*r),y=Math.cos(2*r),v=Math.sin(4*r),w=Math.cos(4*r),C=Math.sin(6*r),E=Math.cos(6*r),S=Math.sin(8*r),A=Math.cos(8*r),D=Math.sin(10*r),P=Math.cos(10*r),M=Math.sin(12*r);return r+r*l/4+7*r*c/64+15*r*f/256+579*r*h/16384+1515*r*d/65536+16837*r*p/1048576+(3*r*c/16+45*r*f/256-r*(32*o-561)*h/4096-r*(232*o-1677)*d/16384+r*(399985-90560*o+512*s)*p/5242880)*y+(21*r*f/256+483*r*h/4096-r*(224*o-1969)*d/16384-r*(33152*o-112599)*p/1048576)*w+(151*r*h/4096+4681*r*d/65536+1479*r*p/16384-453*a*p/32768)*E+(1097*r*d/65536+42783*r*p/1048576)*A+8011*r*p/1048576*P+(3*l/8+3*c/16+213*f/2048-3*o*f/64+255*h/4096-33*o*h/512+20861*d/524288-33*o*d/512+s*d/1024+28273*p/1048576-471*o*p/8192+9*s*p/4096)*_+(21*c/256+21*f/256+533*h/8192-21*o*h/512+197*d/4096-315*o*d/4096+584039*p/16777216-12517*o*p/131072+7*s*p/2048)*v+(151*f/6144+151*h/4096+5019*d/131072-453*o*d/16384+26965*p/786432-8607*o*p/131072)*C+(1097*h/131072+1097*d/65536+225797*p/10485760-1097*o*p/65536)*S+(8011*d/2621440+8011*p/1048576)*D+293393*p/251658240*M}function AC(e,t){if(e===0)return Math.log(Math.tan(.5*(F.PI_OVER_TWO+t)));let n=e*Math.sin(t);return Math.log(Math.tan(.5*(F.PI_OVER_TWO+t)))-e/2*Math.log((1+n)/(1-n))}function nde(e,t,n,r,o){let a=AC(e._ellipticity,n),s=AC(e._ellipticity,o);return Math.atan2(F.negativePiToPi(r-t),s-a)}function rde(e,t,n,r,o,a,s){let u=e._heading,l=a-r,c=0;if(F.equalsEpsilon(Math.abs(u),F.PI_OVER_TWO,F.EPSILON8))if(t===n)c=t*Math.cos(o)*F.negativePiToPi(l);else{let f=Math.sin(o);c=t*Math.cos(o)*F.negativePiToPi(l)/Math.sqrt(1-e._ellipticitySquared*f*f)}else{let f=a2(e._ellipticity,t,o);c=(a2(e._ellipticity,t,s)-f)/Math.cos(u)}return Math.abs(c)}var ide=new x,o2=new x;function jH(e,t,n,r){let o=x.normalize(r.cartographicToCartesian(t,o2),ide),a=x.normalize(r.cartographicToCartesian(n,o2),o2),s=r.maximumRadius,u=r.minimumRadius,l=s*s,c=u*u;e._ellipticitySquared=(l-c)/l,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=le.clone(t,e._start),e._start.height=0,e._end=le.clone(n,e._end),e._end.height=0,e._heading=nde(e,t.longitude,t.latitude,n.longitude,n.latitude),e._distance=rde(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude)}function KH(e,t,n,r,o,a){if(n===0)return le.clone(e,a);let s=o*o,u,l,c;if(Math.abs(F.PI_OVER_TWO-Math.abs(t))>F.EPSILON8){let f=a2(o,r,e.latitude),h=n*Math.cos(t),d=f+h;l=tde(d,o,r);let p=AC(o,e.latitude),_=AC(o,l);c=Math.tan(t)*(_-p),u=F.negativePiToPi(e.longitude+c)}else{l=e.latitude;let f;if(o===0)f=r*Math.cos(e.latitude);else{let h=Math.sin(e.latitude);f=r*Math.cos(e.latitude)/Math.sqrt(1-s*h*h)}c=n/f,t>0?u=F.negativePiToPi(e.longitude+c):u=F.negativePiToPi(e.longitude-c)}return g(a)?(a.longitude=u,a.latitude=l,a.height=0,a):new le(u,l,0)}function Dm(e,t,n){let r=T(n,Ge.WGS84);this._ellipsoid=r,this._start=new le,this._end=new le,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,g(e)&&g(t)&&jH(this,e,t,r)}Object.defineProperties(Dm.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return this._heading}}});Dm.fromStartHeadingDistance=function(e,t,n,r,o){let a=T(r,Ge.WGS84),s=a.maximumRadius,u=a.minimumRadius,l=s*s,c=u*u,f=Math.sqrt((l-c)/l);t=F.negativePiToPi(t);let h=KH(e,t,n,a.maximumRadius,f);return!g(o)||g(r)&&!r.equals(o.ellipsoid)?new Dm(e,h,a):(o.setEndPoints(e,h),o)};Dm.prototype.setEndPoints=function(e,t){jH(this,e,t,this._ellipsoid)};Dm.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)};Dm.prototype.interpolateUsingSurfaceDistance=function(e,t){return KH(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)};Dm.prototype.findIntersectionWithLongitude=function(e,t){let n=this._ellipticity,r=this._heading,o=Math.abs(r),a=this._start;if(e=F.negativePiToPi(e),F.equalsEpsilon(Math.abs(e),Math.PI,F.EPSILON14)&&(e=F.sign(a.longitude)*Math.PI),g(t)||(t=new le),Math.abs(F.PI_OVER_TWO-o)<=F.EPSILON8)return t.longitude=e,t.latitude=a.latitude,t.height=0,t;if(F.equalsEpsilon(Math.abs(F.PI_OVER_TWO-o),F.PI_OVER_TWO,F.EPSILON8))return F.equalsEpsilon(e,a.longitude,F.EPSILON12)?void 0:(t.longitude=e,t.latitude=F.PI_OVER_TWO*F.sign(F.PI_OVER_TWO-r),t.height=0,t);let s=a.latitude,u=n*Math.sin(s),l=Math.tan(.5*(F.PI_OVER_TWO+s))*Math.exp((e-a.longitude)/Math.tan(r)),c=(1+u)/(1-u),f=a.latitude,h;do{h=f;let d=n*Math.sin(h),p=(1+d)/(1-d);f=2*Math.atan(l*Math.pow(p/c,n/2))-F.PI_OVER_TWO}while(!F.equalsEpsilon(f,h,F.EPSILON12));return t.longitude=e,t.latitude=f,t.height=0,t};Dm.prototype.findIntersectionWithLatitude=function(e,t){let n=this._ellipticity,r=this._heading,o=this._start;if(F.equalsEpsilon(Math.abs(r),F.PI_OVER_TWO,F.EPSILON8))return;let a=AC(n,o.latitude),s=AC(n,e),u=Math.tan(r)*(s-a),l=F.negativePiToPi(o.longitude+u);return g(t)?(t.longitude=l,t.latitude=e,t.height=0,t):new le(l,e,0)};var fp=Dm;function ode(e){e=T(e,T.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=T(e.normalize,!1),this.values=e.values}var Ti=ode;var s2={};s2.computeDiscriminant=function(e,t,n){return t*t-4*e*n};function ZH(e,t,n){let r=e+t;return F.sign(e)!==F.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}s2.computeRealRoots=function(e,t,n){let r;if(e===0)return t===0?[]:[-n/t];if(t===0){if(n===0)return[0,0];let l=Math.abs(n),c=Math.abs(e);if(l<c&&l/c<F.EPSILON14)return[0,0];if(l>c&&c/l<F.EPSILON14)return[];if(r=-n/e,r<0)return[];let f=Math.sqrt(r);return[-f,f]}else if(n===0)return r=-t/e,r<0?[r,0]:[0,r];let o=t*t,a=4*e*n,s=ZH(o,-a,F.EPSILON14);if(s<0)return[];let u=-.5*ZH(t,F.sign(t)*Math.sqrt(s),F.EPSILON14);return t>0?[u/e,n/u]:[n/u,u/e]};var Hf=s2;var l2={};l2.computeDiscriminant=function(e,t,n,r){let o=e*e,a=t*t,s=n*n,u=r*r;return 18*e*t*n*r+a*s-27*o*u-4*(e*s*n+a*t*r)};function u2(e,t,n,r){let o=e,a=t/3,s=n/3,u=r,l=o*s,c=a*u,f=a*a,h=s*s,d=o*s-f,p=o*u-a*s,_=a*u-h,y=4*d*_-p*p,v,w;if(y<0){let ne,se,de;f*c>=l*h?(ne=o,se=d,de=-2*a*d+o*p):(ne=u,se=_,de=-u*p+2*s*_);let ve=-(de<0?-1:1)*Math.abs(ne)*Math.sqrt(-y);w=-de+ve;let ft=w/2,pt=ft<0?-Math.pow(-ft,1/3):Math.pow(ft,1/3),Xt=w===ve?-pt:-se/pt;return v=se<=0?pt+Xt:-de/(pt*pt+Xt*Xt+se),f*c>=l*h?[(v-a)/o]:[-u/(v+s)]}let C=d,E=-2*a*d+o*p,S=_,A=-u*p+2*s*_,D=Math.sqrt(y),P=Math.sqrt(3)/2,M=Math.abs(Math.atan2(o*D,-E)/3);v=2*Math.sqrt(-C);let b=Math.cos(M);w=v*b;let O=v*(-b/2-P*Math.sin(M)),m=w+O>2*a?w-a:O-a,I=o,L=m/I;M=Math.abs(Math.atan2(u*D,-A)/3),v=2*Math.sqrt(-S),b=Math.cos(M),w=v*b,O=v*(-b/2-P*Math.sin(M));let R=-u,N=w+O<2*s?w+s:O+s,B=R/N,V=I*N,z=-m*N-I*R,U=m*R,Q=(s*z-a*U)/(-a*z+s*V);return L<=Q?L<=B?Q<=B?[L,Q,B]:[L,B,Q]:[B,L,Q]:L<=B?[Q,L,B]:Q<=B?[Q,B,L]:[B,Q,L]}l2.computeRealRoots=function(e,t,n,r){let o,a;if(e===0)return Hf.computeRealRoots(t,n,r);if(t===0){if(n===0){if(r===0)return[0,0,0];a=-r/e;let s=a<0?-Math.pow(-a,1/3):Math.pow(a,1/3);return[s,s,s]}else if(r===0)return o=Hf.computeRealRoots(e,0,n),o.Length===0?[0]:[o[0],0,o[1]];return u2(e,0,n,r)}else{if(n===0)return r===0?(a=-t/e,a<0?[a,0,0]:[0,0,a]):u2(e,t,0,r);if(r===0)return o=Hf.computeRealRoots(e,t,n),o.length===0?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]}return u2(e,t,n,r)};var GI=l2;var c2={};c2.computeDiscriminant=function(e,t,n,r,o){let a=e*e,s=a*e,u=t*t,l=u*t,c=n*n,f=c*n,h=r*r,d=h*r,p=o*o,_=p*o;return u*c*h-4*l*d-4*e*f*h+18*e*t*n*d-27*a*h*h+256*s*_+o*(18*l*n*r-4*u*f+16*e*c*c-80*e*t*c*r-6*e*u*h+144*a*n*h)+p*(144*e*u*n-27*u*u-128*a*c-192*a*t*r)};function ad(e,t,n,r){let o=e*e,a=t-3*o/8,s=n-t*e/2+o*e/8,u=r-n*e/4+t*o/16-3*o*o/256,l=GI.computeRealRoots(1,2*a,a*a-4*u,-s*s);if(l.length>0){let c=-e/4,f=l[l.length-1];if(Math.abs(f)<F.EPSILON14){let h=Hf.computeRealRoots(1,a,u);if(h.length===2){let d=h[0],p=h[1],_;if(d>=0&&p>=0){let y=Math.sqrt(d),v=Math.sqrt(p);return[c-v,c-y,c+y,c+v]}else{if(d>=0&&p<0)return _=Math.sqrt(d),[c-_,c+_];if(d<0&&p>=0)return _=Math.sqrt(p),[c-_,c+_]}}return[]}else if(f>0){let h=Math.sqrt(f),d=(a+f-s/h)/2,p=(a+f+s/h)/2,_=Hf.computeRealRoots(1,h,d),y=Hf.computeRealRoots(1,-h,p);return _.length!==0?(_[0]+=c,_[1]+=c,y.length!==0?(y[0]+=c,y[1]+=c,_[1]<=y[0]?[_[0],_[1],y[0],y[1]]:y[1]<=_[0]?[y[0],y[1],_[0],_[1]]:_[0]>=y[0]&&_[1]<=y[1]?[y[0],_[0],_[1],y[1]]:y[0]>=_[0]&&y[1]<=_[1]?[_[0],y[0],y[1],_[1]]:_[0]>y[0]&&_[0]<y[1]?[y[0],_[0],y[1],_[1]]:[_[0],y[0],_[1],y[1]]):_):y.length!==0?(y[0]+=c,y[1]+=c,y):[]}}return[]}function xE(e,t,n,r){let o=n*n,a=t*t,s=e*e,u=-2*t,l=n*e+a-4*r,c=s*r-n*t*e+o,f=GI.computeRealRoots(1,u,l,c);if(f.length>0){let h=f[0],d=t-h,p=d*d,_=e/2,y=d/2,v=p-4*r,w=p+4*Math.abs(r),C=s-4*h,E=s+4*Math.abs(h),S,A;if(h<0||v*E<C*w){let I=Math.sqrt(C);S=I/2,A=I===0?0:(e*y-n)/I}else{let I=Math.sqrt(v);S=I===0?0:(e*y-n)/I,A=I/2}let D,P;_===0&&S===0?(D=0,P=0):F.sign(_)===F.sign(S)?(D=_+S,P=h/D):(P=_-S,D=h/P);let M,b;y===0&&A===0?(M=0,b=0):F.sign(y)===F.sign(A)?(M=y+A,b=r/M):(b=y-A,M=r/b);let O=Hf.computeRealRoots(1,D,M),m=Hf.computeRealRoots(1,P,b);if(O.length!==0)return m.length!==0?O[1]<=m[0]?[O[0],O[1],m[0],m[1]]:m[1]<=O[0]?[m[0],m[1],O[0],O[1]]:O[0]>=m[0]&&O[1]<=m[1]?[m[0],O[0],O[1],m[1]]:m[0]>=O[0]&&m[1]<=O[1]?[O[0],m[0],m[1],O[1]]:O[0]>m[0]&&O[0]<m[1]?[m[0],O[0],m[1],O[1]]:[O[0],m[0],O[1],m[1]]:O;if(m.length!==0)return m}return[]}c2.computeRealRoots=function(e,t,n,r,o){if(Math.abs(e)<F.EPSILON15)return GI.computeRealRoots(t,n,r,o);let a=t/e,s=n/e,u=r/e,l=o/e,c=a<0?1:0;switch(c+=s<0?c+1:c,c+=u<0?c+1:c,c+=l<0?c+1:c,c){case 0:return ad(a,s,u,l);case 1:return xE(a,s,u,l);case 2:return xE(a,s,u,l);case 3:return ad(a,s,u,l);case 4:return ad(a,s,u,l);case 5:return xE(a,s,u,l);case 6:return ad(a,s,u,l);case 7:return ad(a,s,u,l);case 8:return xE(a,s,u,l);case 9:return ad(a,s,u,l);case 10:return ad(a,s,u,l);case 11:return xE(a,s,u,l);case 12:return ad(a,s,u,l);case 13:return ad(a,s,u,l);case 14:return ad(a,s,u,l);case 15:return ad(a,s,u,l);default:return}};var QH=c2;function UI(e,t){t=x.clone(T(t,x.ZERO)),x.equals(t,x.ZERO)||x.normalize(t,t),this.origin=x.clone(T(e,x.ZERO)),this.direction=t}UI.clone=function(e,t){if(!!g(e))return g(t)?(t.origin=x.clone(e.origin),t.direction=x.clone(e.direction),t):new UI(e.origin,e.direction)};UI.getPoint=function(e,t,n){return g(n)||(n=new x),n=x.multiplyByScalar(e.direction,t,n),x.add(e.origin,n,n)};var H_=UI;var zo={};zo.rayPlane=function(e,t,n){g(n)||(n=new x);let r=e.origin,o=e.direction,a=t.normal,s=x.dot(a,o);if(Math.abs(s)<F.EPSILON15)return;let u=(-t.distance-x.dot(a,r))/s;if(!(u<0))return n=x.multiplyByScalar(o,u,n),x.add(r,n,n)};var ade=new x,sde=new x,oq=new x,JH=new x,$H=new x;zo.rayTriangleParametric=function(e,t,n,r,o){o=T(o,!1);let a=e.origin,s=e.direction,u=x.subtract(n,t,ade),l=x.subtract(r,t,sde),c=x.cross(s,l,oq),f=x.dot(u,c),h,d,p,_,y;if(o){if(f<F.EPSILON6||(h=x.subtract(a,t,JH),p=x.dot(h,c),p<0||p>f)||(d=x.cross(h,u,$H),_=x.dot(s,d),_<0||p+_>f))return;y=x.dot(l,d)/f}else{if(Math.abs(f)<F.EPSILON6)return;let v=1/f;if(h=x.subtract(a,t,JH),p=x.dot(h,c)*v,p<0||p>1||(d=x.cross(h,u,$H),_=x.dot(s,d)*v,_<0||p+_>1))return;y=x.dot(l,d)*v}return y};zo.rayTriangle=function(e,t,n,r,o,a){let s=zo.rayTriangleParametric(e,t,n,r,o);if(!(!g(s)||s<0))return g(a)||(a=new x),x.multiplyByScalar(e.direction,s,a),x.add(e.origin,a,a)};var ude=new H_;zo.lineSegmentTriangle=function(e,t,n,r,o,a,s){let u=ude;x.clone(e,u.origin),x.subtract(t,e,u.direction),x.normalize(u.direction,u.direction);let l=zo.rayTriangleParametric(u,n,r,o,a);if(!(!g(l)||l<0||l>x.distance(e,t)))return g(s)||(s=new x),x.multiplyByScalar(u.direction,l,s),x.add(u.origin,s,s)};function lde(e,t,n,r){let o=t*t-4*e*n;if(o<0)return;if(o>0){let s=1/(2*e),u=Math.sqrt(o),l=(-t+u)*s,c=(-t-u)*s;return l<c?(r.root0=l,r.root1=c):(r.root0=c,r.root1=l),r}let a=-t/(2*e);if(a!==0)return r.root0=r.root1=a,r}var cde={root0:0,root1:0};function aq(e,t,n){g(n)||(n=new np);let r=e.origin,o=e.direction,a=t.center,s=t.radius*t.radius,u=x.subtract(r,a,oq),l=x.dot(o,o),c=2*x.dot(o,u),f=x.magnitudeSquared(u)-s,h=lde(l,c,f,cde);if(!!g(h))return n.start=h.root0,n.stop=h.root1,n}zo.raySphere=function(e,t,n){if(n=aq(e,t,n),!(!g(n)||n.stop<0))return n.start=Math.max(n.start,0),n};var fde=new H_;zo.lineSegmentSphere=function(e,t,n,r){let o=fde;x.clone(e,o.origin);let a=x.subtract(t,e,o.direction),s=x.magnitude(a);if(x.normalize(a,a),r=aq(o,n,r),!(!g(r)||r.stop<0||r.start>s))return r.start=Math.max(r.start,0),r.stop=Math.min(r.stop,s),r};var hde=new x,dde=new x;zo.rayEllipsoid=function(e,t){let n=t.oneOverRadii,r=x.multiplyComponents(n,e.origin,hde),o=x.multiplyComponents(n,e.direction,dde),a=x.magnitudeSquared(r),s=x.dot(r,o),u,l,c,f,h;if(a>1){if(s>=0)return;let d=s*s;if(u=a-1,l=x.magnitudeSquared(o),c=l*u,d<c)return;if(d>c){f=s*s-c,h=-s+Math.sqrt(f);let _=h/l,y=u/h;return _<y?new np(_,y):{start:y,stop:_}}let p=Math.sqrt(u/l);return new np(p,p)}else if(a<1)return u=a-1,l=x.magnitudeSquared(o),c=l*u,f=s*s-c,h=-s+Math.sqrt(f),new np(0,h/l);if(s<0)return l=x.magnitudeSquared(o),new np(0,-s/l)};function q_(e,t,n){let r=e+t;return F.sign(e)!==F.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}function pde(e,t,n,r,o){let a=r*r,s=o*o,u=(e[te.COLUMN1ROW1]-e[te.COLUMN2ROW2])*s,l=o*(r*q_(e[te.COLUMN1ROW0],e[te.COLUMN0ROW1],F.EPSILON15)+t.y),c=e[te.COLUMN0ROW0]*a+e[te.COLUMN2ROW2]*s+r*t.x+n,f=s*q_(e[te.COLUMN2ROW1],e[te.COLUMN1ROW2],F.EPSILON15),h=o*(r*q_(e[te.COLUMN2ROW0],e[te.COLUMN0ROW2])+t.z),d,p=[];if(h===0&&f===0){if(d=Hf.computeRealRoots(u,l,c),d.length===0)return p;let M=d[0],b=Math.sqrt(Math.max(1-M*M,0));if(p.push(new x(r,o*M,o*-b)),p.push(new x(r,o*M,o*b)),d.length===2){let O=d[1],m=Math.sqrt(Math.max(1-O*O,0));p.push(new x(r,o*O,o*-m)),p.push(new x(r,o*O,o*m))}return p}let _=h*h,y=f*f,v=u*u,w=h*f,C=v+y,E=2*(l*u+w),S=2*c*u+l*l-y+_,A=2*(c*l-w),D=c*c-_;if(C===0&&E===0&&S===0&&A===0)return p;d=QH.computeRealRoots(C,E,S,A,D);let P=d.length;if(P===0)return p;for(let M=0;M<P;++M){let b=d[M],O=b*b,m=Math.max(1-O,0),I=Math.sqrt(m),L;F.sign(u)===F.sign(c)?L=q_(u*O+c,l*b,F.EPSILON12):F.sign(c)===F.sign(l*b)?L=q_(u*O,l*b+c,F.EPSILON12):L=q_(u*O+l*b,c,F.EPSILON12);let R=q_(f*b,h,F.EPSILON15),N=L*R;N<0?p.push(new x(r,o*b,o*I)):N>0?p.push(new x(r,o*b,o*-I)):I!==0?(p.push(new x(r,o*b,o*-I)),p.push(new x(r,o*b,o*I)),++M):p.push(new x(r,o*b,o*I))}return p}var f2=new x,eq=new x,tq=new x,HI=new x,mde=new x,gde=new te,_de=new te,yde=new te,vde=new te,Cde=new te,nq=new te,rq=new te,iq=new x,xde=new x,wde=new le;zo.grazingAltitudeLocation=function(e,t){let n=e.origin,r=e.direction;if(!x.equals(n,x.ZERO)){let D=t.geodeticSurfaceNormal(n,f2);if(x.dot(r,D)>=0)return n}let o=g(this.rayEllipsoid(e,t)),a=t.transformPositionToScaledSpace(r,f2),s=x.normalize(a,a),u=x.mostOrthogonalAxis(a,HI),l=x.normalize(x.cross(u,s,eq),eq),c=x.normalize(x.cross(s,l,tq),tq),f=gde;f[0]=s.x,f[1]=s.y,f[2]=s.z,f[3]=l.x,f[4]=l.y,f[5]=l.z,f[6]=c.x,f[7]=c.y,f[8]=c.z;let h=te.transpose(f,_de),d=te.fromScale(t.radii,yde),p=te.fromScale(t.oneOverRadii,vde),_=Cde;_[0]=0,_[1]=-r.z,_[2]=r.y,_[3]=r.z,_[4]=0,_[5]=-r.x,_[6]=-r.y,_[7]=r.x,_[8]=0;let y=te.multiply(te.multiply(h,p,nq),_,nq),v=te.multiply(te.multiply(y,d,rq),f,rq),w=te.multiplyByVector(y,n,mde),C=pde(v,x.negate(w,f2),0,0,1),E,S,A=C.length;if(A>0){let D=x.clone(x.ZERO,xde),P=Number.NEGATIVE_INFINITY;for(let b=0;b<A;++b){E=te.multiplyByVector(d,te.multiplyByVector(f,C[b],iq),iq);let O=x.normalize(x.subtract(E,n,HI),HI),m=x.dot(O,r);m>P&&(P=m,D=x.clone(E,D))}let M=t.cartesianToCartographic(D,wde);return P=F.clamp(P,0,1),S=x.magnitude(x.subtract(D,n,HI))*Math.sqrt(1-P*P),S=o?-S:S,M.height=S,t.cartographicToCartesian(M,new x)}};var Ede=new x;zo.lineSegmentPlane=function(e,t,n,r){g(r)||(r=new x);let o=x.subtract(t,e,Ede),a=n.normal,s=x.dot(a,o);if(Math.abs(s)<F.EPSILON6)return;let u=x.dot(a,e),l=-(n.distance+u)/s;if(!(l<0||l>1))return x.multiplyByScalar(o,l,r),x.add(e,r,r),r};zo.trianglePlaneIntersection=function(e,t,n,r){let o=r.normal,a=r.distance,s=x.dot(o,e)+a<0,u=x.dot(o,t)+a<0,l=x.dot(o,n)+a<0,c=0;c+=s?1:0,c+=u?1:0,c+=l?1:0;let f,h;if((c===1||c===2)&&(f=new x,h=new x),c===1){if(s)return zo.lineSegmentPlane(e,t,r,f),zo.lineSegmentPlane(e,n,r,h),{positions:[e,t,n,f,h],indices:[0,3,4,1,2,4,1,4,3]};if(u)return zo.lineSegmentPlane(t,n,r,f),zo.lineSegmentPlane(t,e,r,h),{positions:[e,t,n,f,h],indices:[1,3,4,2,0,4,2,4,3]};if(l)return zo.lineSegmentPlane(n,e,r,f),zo.lineSegmentPlane(n,t,r,h),{positions:[e,t,n,f,h],indices:[2,3,4,0,1,4,0,4,3]}}else if(c===2)if(s)if(u){if(!l)return zo.lineSegmentPlane(e,n,r,f),zo.lineSegmentPlane(t,n,r,h),{positions:[e,t,n,f,h],indices:[0,1,4,0,4,3,2,3,4]}}else return zo.lineSegmentPlane(n,t,r,f),zo.lineSegmentPlane(e,t,r,h),{positions:[e,t,n,f,h],indices:[2,0,4,2,4,3,1,3,4]};else return zo.lineSegmentPlane(t,e,r,f),zo.lineSegmentPlane(n,e,r,h),{positions:[e,t,n,f,h],indices:[1,2,4,1,4,3,0,3,4]}};var Jc=zo;var v2=[mc,EC],Tde=v2.length,Aq=Math.cos(F.toRadians(30)),sq=Math.cos(F.toRadians(150)),bq=0,Iq=1e3;function o0(e){e=T(e,T.EMPTY_OBJECT);let t=e.positions;this.width=T(e.width,1),this._positions=t,this.granularity=T(e.granularity,9999),this.loop=T(e.loop,!1),this.arcType=T(e.arcType,Fa.GEODESIC),this._ellipsoid=Ge.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(o0.prototype,{packedLength:{get:function(){return 1+this._positions.length*3+1+1+1+Ge.packedLength+1+1}}});o0.setProjectionAndEllipsoid=function(e,t){let n=0;for(let r=0;r<Tde;r++)if(t instanceof v2[r]){n=r;break}e._projectionIndex=n,e._ellipsoid=t.ellipsoid};var Sde=new x,uq=new x,lq=new x;function y2(e,t,n,r,o){let a=Bl(r,e,0,Sde),s=Bl(r,e,n,uq),u=Bl(r,t,0,lq),l=Pm(s,a,uq),c=Pm(u,a,lq);return x.cross(c,l,o),x.normalize(o,o)}var Ade=new le,bde=new x,Ide=new x,Dde=new x;function h2(e,t,n,r,o,a,s,u,l,c,f){if(o===0)return;let h;a===Fa.GEODESIC?h=new r0(e,t,s):a===Fa.RHUMB&&(h=new fp(e,t,s));let d=h.surfaceDistance;if(d<o)return;let p=y2(e,t,r,s,Dde),_=Math.ceil(d/o),y=d/_,v=y,w=_-1,C=u.length;for(let E=0;E<w;E++){let S=h.interpolateUsingSurfaceDistance(v,Ade),A=Bl(s,S,n,bde),D=Bl(s,S,r,Ide);x.pack(p,u,C),x.pack(A,l,C),x.pack(D,c,C),f.push(S.latitude),f.push(S.longitude),C+=3,v+=y}}var d2=new le;function Bl(e,t,n,r){return le.clone(t,d2),d2.height=n,le.toCartesian(d2,e,r)}o0.pack=function(e,t,n){let r=T(n,0),o=e._positions,a=o.length;t[r++]=a;for(let s=0;s<a;++s){let u=o[s];x.pack(u,t,r),r+=3}return t[r++]=e.granularity,t[r++]=e.loop?1:0,t[r++]=e.arcType,Ge.pack(e._ellipsoid,t,r),r+=Ge.packedLength,t[r++]=e._projectionIndex,t[r++]=e._scene3DOnly?1:0,t};o0.unpack=function(e,t,n){let r=T(t,0),o=e[r++],a=new Array(o);for(let d=0;d<o;d++)a[d]=x.unpack(e,r),r+=3;let s=e[r++],u=e[r++]===1,l=e[r++],c=Ge.unpack(e,r);r+=Ge.packedLength;let f=e[r++],h=e[r++]===1;return g(n)||(n=new o0({positions:a})),n._positions=a,n.granularity=s,n.loop=u,n.arcType=l,n._ellipsoid=c,n._projectionIndex=f,n._scene3DOnly=h,n};function Pm(e,t,n){return x.subtract(e,t,n),x.normalize(n,n),n}function cq(e,t,n,r){return r=Pm(e,t,r),r=x.cross(r,n,r),r=x.normalize(r,r),r=x.cross(n,r,r),r}var Pde=new x,Mde=new x,Lde=new x,Dq=new x,Rde=0,Ode=-1;function p2(e,t,n,r,o){let a=Pm(n,t,Dq),s=cq(e,t,a,Pde),u=cq(r,t,a,Mde);if(F.equalsEpsilon(x.dot(s,u),Ode,F.EPSILON5))return o=x.cross(a,s,o),o=x.normalize(o,o),o;o=x.add(u,s,o),o=x.normalize(o,o);let l=x.cross(a,o,Lde);return x.dot(u,l)<Rde&&(o=x.negate(o,o)),o}var XI=si.fromPointNormal(x.ZERO,x.UNIT_Y),Nde=new x,Bde=new x,Fde=new x,zde=new x,Vde=new x,qI=new x,WI=new le,fq=new le,hq=new le;o0.createGeometry=function(e){let t=!e._scene3DOnly,n=e.loop,r=e._ellipsoid,o=e.granularity,a=e.arcType,s=new v2[e._projectionIndex](r),u=bq,l=Iq,c,f,h=e._positions,d=h.length;d===2&&(n=!1);let p,_,y,v,w=new fp(void 0,void 0,r),C,E,S,A=[h[0]];for(f=0;f<d-1;f++)p=h[f],_=h[f+1],C=Jc.lineSegmentPlane(p,_,XI,qI),g(C)&&!x.equalsEpsilon(C,p,F.EPSILON7)&&!x.equalsEpsilon(C,_,F.EPSILON7)&&(e.arcType===Fa.GEODESIC?A.push(x.clone(C)):e.arcType===Fa.RHUMB&&(S=r.cartesianToCartographic(C,WI).longitude,y=r.cartesianToCartographic(p,WI),v=r.cartesianToCartographic(_,fq),w.setEndPoints(y,v),E=w.findIntersectionWithLongitude(S,hq),C=r.cartographicToCartesian(E,qI),g(C)&&!x.equalsEpsilon(C,p,F.EPSILON7)&&!x.equalsEpsilon(C,_,F.EPSILON7)&&A.push(x.clone(C)))),A.push(_);n&&(p=h[d-1],_=h[0],C=Jc.lineSegmentPlane(p,_,XI,qI),g(C)&&!x.equalsEpsilon(C,p,F.EPSILON7)&&!x.equalsEpsilon(C,_,F.EPSILON7)&&(e.arcType===Fa.GEODESIC?A.push(x.clone(C)):e.arcType===Fa.RHUMB&&(S=r.cartesianToCartographic(C,WI).longitude,y=r.cartesianToCartographic(p,WI),v=r.cartesianToCartographic(_,fq),w.setEndPoints(y,v),E=w.findIntersectionWithLongitude(S,hq),C=r.cartographicToCartesian(E,qI),g(C)&&!x.equalsEpsilon(C,p,F.EPSILON7)&&!x.equalsEpsilon(C,_,F.EPSILON7)&&A.push(x.clone(C)))));let D=A.length,P=new Array(D);for(f=0;f<D;f++){let se=le.fromCartesian(A[f],r);se.height=0,P[f]=se}if(P=SC(P,le.equalsEpsilon),D=P.length,D<2)return;let M=[],b=[],O=[],m=[],I=Nde,L=Bde,R=Fde,N=zde,B=Vde,V=P[0],z=P[1],U=P[D-1];for(I=Bl(r,U,u,I),N=Bl(r,z,u,N),L=Bl(r,V,u,L),R=Bl(r,V,l,R),n?B=p2(I,L,R,N,B):B=y2(V,z,l,r,B),x.pack(B,b,0),x.pack(L,O,0),x.pack(R,m,0),M.push(V.latitude),M.push(V.longitude),h2(V,z,u,l,o,a,r,b,O,m,M),f=1;f<D-1;++f){I=x.clone(L,I),L=x.clone(N,L);let se=P[f];Bl(r,se,l,R),Bl(r,P[f+1],u,N),p2(I,L,R,N,B),c=b.length,x.pack(B,b,c),x.pack(L,O,c),x.pack(R,m,c),M.push(se.latitude),M.push(se.longitude),h2(P[f],P[f+1],u,l,o,a,r,b,O,m,M)}let Q=P[D-1],ne=P[D-2];if(L=Bl(r,Q,u,L),R=Bl(r,Q,l,R),n){let se=P[0];I=Bl(r,ne,u,I),N=Bl(r,se,u,N),B=p2(I,L,R,N,B)}else B=y2(ne,Q,l,r,B);if(c=b.length,x.pack(B,b,c),x.pack(L,O,c),x.pack(R,m,c),M.push(Q.latitude),M.push(Q.longitude),n){for(h2(Q,V,u,l,o,a,r,b,O,m,M),c=b.length,f=0;f<3;++f)b[c+f]=b[f],O[c+f]=O[f],m[c+f]=m[f];M.push(V.latitude),M.push(V.longitude)}return fpe(n,s,O,m,b,M,t)};var kde=new x,Gde=new te,Ude=new je;function dq(e,t,n,r){let o=Pm(n,t,kde),a=x.dot(o,e);if(a>Aq||a<sq){let s=Pm(r,n,Dq),u=a<sq?F.PI_OVER_TWO:-F.PI_OVER_TWO,l=je.fromAxisAngle(s,u,Ude),c=te.fromQuaternion(l,Gde);return te.multiplyByVector(c,e,e),!0}return!1}var pq=new le,Hde=new x,mq=new x;function wE(e,t,n,r,o){let a=le.toCartesian(t,e._ellipsoid,Hde),s=x.add(a,n,mq),u=!1,l=e._ellipsoid,c=l.cartesianToCartographic(s,pq);Math.abs(t.longitude-c.longitude)>F.PI_OVER_TWO&&(u=!0,s=x.subtract(a,n,mq),c=l.cartesianToCartographic(s,pq)),c.height=0;let f=e.project(c,o);return o=x.subtract(f,r,o),o.z=0,o=x.normalize(o,o),u&&x.negate(o,o),o}var qde=new x,gq=new x;function _q(e,t,n,r,o,a){let s=x.subtract(t,e,qde);x.normalize(s,s);let u=n-bq,l=x.multiplyByScalar(s,u,gq);x.add(e,l,o);let c=r-Iq;l=x.multiplyByScalar(s,c,gq),x.add(t,l,a)}var Wde=new x;function YI(e,t){let n=si.getPointDistance(XI,e),r=si.getPointDistance(XI,t),o=Wde;F.equalsEpsilon(n,0,F.EPSILON2)?(o=Pm(t,e,o),x.multiplyByScalar(o,F.EPSILON2,o),x.add(e,o,e)):F.equalsEpsilon(r,0,F.EPSILON2)&&(o=Pm(e,t,o),x.multiplyByScalar(o,F.EPSILON2,o),x.add(t,o,t))}function Yde(e,t){let n=Math.abs(e.longitude),r=Math.abs(t.longitude);if(F.equalsEpsilon(n,F.PI,F.EPSILON11)){let o=F.sign(t.longitude);return e.longitude=o*(n-F.EPSILON11),1}else if(F.equalsEpsilon(r,F.PI,F.EPSILON11)){let o=F.sign(e.longitude);return t.longitude=o*(r-F.EPSILON11),2}return 0}var Pq=new le,Mq=new le,yq=new x,m2=new x,vq=new x,Cq=new x,Xde=new x,xq=new x,jde=[Pq,Mq],Kde=new hn,Zde=new x,Qde=new x,Jde=new x,$de=new x,epe=new x,tpe=new x,g2=new x,_2=new x,npe=new x,rpe=new x,ipe=new x,wq=new x,ope=new x,ape=new x,spe=new ti,upe=new ti,Eq=new x,lpe=new x,Tq=new x,cpe=[new Ee,new Ee],Lq=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Sq=Lq.length;function fpe(e,t,n,r,o,a,s){let u,l,c=t._ellipsoid,f=n.length/3-1,h=f*8,d=h*4,p=f*36,_=h>65535?new Uint32Array(p):new Uint16Array(p),y=new Float64Array(h*3),v=new Float32Array(d),w=new Float32Array(d),C=new Float32Array(d),E=new Float32Array(d),S=new Float32Array(d),A,D,P,M;s&&(A=new Float32Array(d),D=new Float32Array(d),P=new Float32Array(d),M=new Float32Array(h*2));let b=a.length/2,O=0,m=Pq;m.height=0;let I=Mq;I.height=0;let L=yq,R=m2;if(s)for(l=0,u=1;u<b;u++)m.latitude=a[l],m.longitude=a[l+1],I.latitude=a[l+2],I.longitude=a[l+3],L=t.project(m,L),R=t.project(I,R),O+=x.distance(L,R),l+=2;let N=r.length/3;R=x.unpack(r,0,R);let B=0;for(l=3,u=1;u<N;u++)L=x.clone(R,L),R=x.unpack(r,l,R),B+=x.distance(L,R),l+=3;let V;l=3;let z=0,U=0,Q=0,ne=0,se=!1,de=x.unpack(n,0,Cq),pe=x.unpack(r,0,m2),ve=x.unpack(o,0,xq);if(e){let $i=x.unpack(n,n.length-6,vq);dq(ve,$i,de,pe)&&(ve=x.negate(ve,ve))}let ft=0,pt=0,Xt=0;for(u=0;u<f;u++){let $i=x.clone(de,vq),ut=x.clone(pe,yq),ai=x.clone(ve,Xde);se&&(ai=x.negate(ai,ai)),de=x.unpack(n,l,Cq),pe=x.unpack(r,l,m2),ve=x.unpack(o,l,xq),se=dq(ve,$i,de,pe),m.latitude=a[z],m.longitude=a[z+1],I.latitude=a[z+2],I.longitude=a[z+3];let rs,fc,Xd,jd;if(s){let mo=Yde(m,I);rs=t.project(m,epe),fc=t.project(I,tpe);let Vg=Pm(fc,rs,Eq);Vg.y=Math.abs(Vg.y),Xd=g2,jd=_2,mo===0||x.dot(Vg,x.UNIT_Y)>Aq?(Xd=wE(t,m,ai,rs,g2),jd=wE(t,I,ve,fc,_2)):mo===1?(jd=wE(t,I,ve,fc,_2),Xd.x=0,Xd.y=F.sign(m.longitude-Math.abs(I.longitude)),Xd.z=0):(Xd=wE(t,m,ai,rs,g2),jd.x=0,jd.y=F.sign(m.longitude-I.longitude),jd.z=0)}let ub=x.distance(ut,pe),zw=ti.fromCartesian($i,spe),Bv=x.subtract(de,$i,npe),Ke=x.normalize(Bv,wq),Qe=x.subtract(ut,$i,rpe);Qe=x.normalize(Qe,Qe);let zt=x.cross(Ke,Qe,wq);zt=x.normalize(zt,zt);let En=x.cross(Qe,ai,ope);En=x.normalize(En,En);let po=x.subtract(pe,de,ipe);po=x.normalize(po,po);let Ll=x.cross(ve,po,ape);Ll=x.normalize(Ll,Ll);let Xh=ub/B,Lf=ft/B,fm=0,jh,Fv,hm,lb=0,x_=0;if(s){fm=x.distance(rs,fc),jh=ti.fromCartesian(rs,upe),Fv=x.subtract(fc,rs,Eq),hm=x.normalize(Fv,lpe);let mo=hm.x;hm.x=hm.y,hm.y=-mo,lb=fm/O,x_=pt/O}for(V=0;V<8;V++){let mo=ne+V*4,Vg=U+V*2,w_=mo+3,cb=V<4?1:-1,kv=V===2||V===3||V===6||V===7?1:-1;x.pack(zw.high,v,mo),v[w_]=Bv.x,x.pack(zw.low,w,mo),w[w_]=Bv.y,x.pack(En,C,mo),C[w_]=Bv.z,x.pack(Ll,E,mo),E[w_]=Xh*cb,x.pack(zt,S,mo);let Kd=Lf*kv;Kd===0&&kv<0&&(Kd=9),S[w_]=Kd,s&&(A[mo]=jh.high.x,A[mo+1]=jh.high.y,A[mo+2]=jh.low.x,A[mo+3]=jh.low.y,P[mo]=-Xd.y,P[mo+1]=Xd.x,P[mo+2]=jd.y,P[mo+3]=-jd.x,D[mo]=Fv.x,D[mo+1]=Fv.y,D[mo+2]=hm.x,D[mo+3]=hm.y,M[Vg]=lb*cb,Kd=x_*kv,Kd===0&&kv<0&&(Kd=9),M[Vg+1]=Kd)}let hc=Jde,Kh=$de,Zh=Zde,Qh=Qde,Vw=hn.fromCartographicArray(jde,Kde),zv=Zc.getMinimumMaximumHeights(Vw,c),Rl=zv.minimumTerrainHeight,Vv=zv.maximumTerrainHeight;Xt+=Rl,Xt+=Vv,_q($i,ut,Rl,Vv,hc,Zh),_q(de,pe,Rl,Vv,Kh,Qh);let dc=x.multiplyByScalar(zt,F.EPSILON5,Tq);x.add(hc,dc,hc),x.add(Kh,dc,Kh),x.add(Zh,dc,Zh),x.add(Qh,dc,Qh),YI(hc,Kh),YI(Zh,Qh),x.pack(hc,y,Q),x.pack(Kh,y,Q+3),x.pack(Qh,y,Q+6),x.pack(Zh,y,Q+9),dc=x.multiplyByScalar(zt,-2*F.EPSILON5,Tq),x.add(hc,dc,hc),x.add(Kh,dc,Kh),x.add(Zh,dc,Zh),x.add(Qh,dc,Qh),YI(hc,Kh),YI(Zh,Qh),x.pack(hc,y,Q+12),x.pack(Kh,y,Q+15),x.pack(Qh,y,Q+18),x.pack(Zh,y,Q+21),z+=2,l+=3,U+=16,Q+=24,ne+=32,ft+=ub,pt+=fm}l=0;let At=0;for(u=0;u<f;u++){for(V=0;V<Sq;V++)_[l+V]=Lq[V]+At;At+=8,l+=Sq}let wt=cpe;Ee.fromVertices(n,x.ZERO,3,wt[0]),Ee.fromVertices(r,x.ZERO,3,wt[1]);let Rr=Ee.fromBoundingSpheres(wt);Rr.radius+=Xt/(f*2);let gi={position:new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,normalize:!1,values:y}),startHiAndForwardOffsetX:i0(v),startLoAndForwardOffsetY:i0(w),startNormalAndForwardOffsetZ:i0(C),endNormalAndTextureCoordinateNormalizationX:i0(E),rightNormalAndTextureCoordinateNormalizationY:i0(S)};return s&&(gi.startHiLo2D=i0(A),gi.offsetAndRight2D=i0(D),gi.startEndNormals2D=i0(P),gi.texcoordNormalization2D=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,normalize:!1,values:M})),new Ei({attributes:gi,indices:_,boundingSphere:Rr})}function i0(e){return new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}o0._projectNormal=wE;var Rq=o0;var Oq=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main(void)
{
float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));
vec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);
if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
eyeCoordinate /= eyeCoordinate.w;
float halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);
float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);
float distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);
float distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);
if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec3 alignedPlaneNormal;
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);
s = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;
float t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, t);
materialInput.str = vec3(s, t, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
gl_FragColor.rgb *= gl_FragColor.a;
czm_writeDepthClamp();
}
`;var Nq=`varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
float rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {
return (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);
}
void main(void)
{
vec4 eyeCoordinate = gl_FragCoord;
eyeCoordinate /= eyeCoordinate.w;
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);
float distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);
distanceFromStart = max(0.0, distanceFromStart);
distanceFromEnd = max(0.0, distanceFromEnd);
float s = distanceFromStart / (distanceFromStart + distanceFromEnd);
s = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, v_texcoordT);
materialInput.str = vec3(s, v_texcoordT, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
}
`;var Bq=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
attribute float batchId;
varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
void main()
{
v_batchId = batchId;
vec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));
vec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);
vec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
vec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
vec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec4 startPlane2D;
vec4 startPlane3D;
startPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlane2D.w = -dot(startPlane2D.xyz, posEc2D);
startPlane3D.w = -dot(startPlane3D.xyz, posEc3D);
vec4 rightPlane2D;
vec4 rightPlane3D;
rightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
rightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
rightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);
rightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);
posRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);
posRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);
posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));
vec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));
vec4 endPlane2D;
vec4 endPlane3D;
endPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlane2D.w = -dot(endPlane2D.xyz, posEc2D);
endPlane3D.w = -dot(endPlane3D.xyz, posEc3D);
v_forwardDirectionEC = normalize(endEC - startEC);
vec2 cleanTexcoordNormalization2D;
cleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);
cleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));
vec2 cleanTexcoordNormalization3D;
cleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
cleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;
cleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));
v_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#else // PER_INSTANCE_COLOR
v_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);
v_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);
#endif // PER_INSTANCE_COLOR
#ifdef WIDTH_VARYING
float width = czm_batchTable_width(batchId);
float halfWidth = width * 0.5;
v_width = width;
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#else
float halfWidth = 0.5 * czm_batchTable_width(batchId);
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#endif
vec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);
float absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);
vec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
vec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));
geodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc3D.xyz += geodeticSurfaceNormal;
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
positionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;
vec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);
absStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));
absEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));
planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);
upOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));
normalEC = normalize(cross(planeDirection, upOrDown));
geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));
geodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc2D.xyz += geodeticSurfaceNormal;
normalEC *= sign(texcoordNormalization2D.x);
#ifndef PER_INSTANCE_COLOR
v_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);
#endif
positionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;
gl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var Fq=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
#ifndef COLUMBUS_VIEW_2D
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
#else
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
#endif
attribute float batchId;
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main()
{
#ifdef COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;
vec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);
vec3 ecEnd = forwardDirectionEC + ecStart;
forwardDirectionEC = normalize(forwardDirectionEC);
v_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
vec4 startPlaneEC;
startPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);
v_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;
#else // COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;
vec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);
vec3 ecEnd = ecStart + offset;
vec3 forwardDirectionEC = normalize(offset);
vec4 startPlaneEC;
startPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
v_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
v_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;
#endif // COLUMBUS_VIEW_2D
v_endEcAndStartEcX.xyz = ecEnd;
v_endEcAndStartEcX.w = ecStart.x;
v_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif // PER_INSTANCE_COLOR
vec4 positionRelativeToEye = czm_computePosition();
vec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;
float absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);
vec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
upOrDown = cross(forwardDirectionEC, normalEC);
upOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;
upOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;
upOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;
positionEC.xyz += upOrDown;
v_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));
float width = czm_batchTable_width(batchId);
#ifdef WIDTH_VARYING
v_width = width;
#endif
v_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;
v_startPlaneNormalEcAndHalfWidth.w = width * 0.5;
v_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;
v_endPlaneNormalEcAndBatchId.w = batchId;
width = width * max(0.0, czm_metersPerPixel(positionEC));
width = width / dot(normalEC, v_rightPlaneEC.xyz);
#ifdef COLUMBUS_VIEW_2D
normalEC *= sign(texcoordNormalization2D.x);
#else
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
#endif
positionEC.xyz += width * normalEC;
gl_Position = czm_depthClamp(czm_projection * positionEC);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var zq={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2};zq.NUMBER_OF_CLASSIFICATION_TYPES=3;var Ua=Object.freeze(zq);var hpe={FRONT:k.FRONT,BACK:k.BACK,FRONT_AND_BACK:k.FRONT_AND_BACK},sd=Object.freeze(hpe);function Ha(e){e=T(e,T.EMPTY_OBJECT),this.position=T(e.position,!1),this.normal=T(e.normal,!1),this.st=T(e.st,!1),this.bitangent=T(e.bitangent,!1),this.tangent=T(e.tangent,!1),this.color=T(e.color,!1)}Ha.POSITION_ONLY=Object.freeze(new Ha({position:!0}));Ha.POSITION_AND_NORMAL=Object.freeze(new Ha({position:!0,normal:!0}));Ha.POSITION_NORMAL_AND_ST=Object.freeze(new Ha({position:!0,normal:!0,st:!0}));Ha.POSITION_AND_ST=Object.freeze(new Ha({position:!0,st:!0}));Ha.POSITION_AND_COLOR=Object.freeze(new Ha({position:!0,color:!0}));Ha.ALL=Object.freeze(new Ha({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0}));Ha.DEFAULT=Ha.POSITION_NORMAL_AND_ST;Ha.packedLength=6;Ha.pack=function(e,t,n){return n=T(n,0),t[n++]=e.position?1:0,t[n++]=e.normal?1:0,t[n++]=e.st?1:0,t[n++]=e.tangent?1:0,t[n++]=e.bitangent?1:0,t[n]=e.color?1:0,t};Ha.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Ha),n.position=e[t++]===1,n.normal=e[t++]===1,n.st=e[t++]===1,n.tangent=e[t++]===1,n.bitangent=e[t++]===1,n.color=e[t]===1,n};Ha.clone=function(e,t){if(!!g(e))return g(t)||(t=new Ha),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var vo=Ha;var jI=`varying vec4 v_color;
void main()
{
gl_FragColor = czm_gammaCorrect(v_color);
}
`;var Vq=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_color = color;
}
`;var KI=`void clipLineSegmentToNearPlane(
vec3 p0,
vec3 p1,
out vec4 positionWC,
out bool clipped,
out bool culledByNearPlane,
out vec4 clippedPositionEC)
{
culledByNearPlane = false;
clipped = false;
vec3 p0ToP1 = p1 - p0;
float magnitude = length(p0ToP1);
vec3 direction = normalize(p0ToP1);
float endPoint0Distance =  czm_currentFrustum.x + p0.z;
float denominator = -direction.z;
if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)
{
culledByNearPlane = true;
}
else if (endPoint0Distance > 0.0)
{
float t = endPoint0Distance / denominator;
if (t < 0.0 || t > magnitude)
{
culledByNearPlane = true;
}
else
{
p0 = p0 + t * direction;
p0.z = min(p0.z, -czm_currentFrustum.x);
clipped = true;
}
}
clippedPositionEC = vec4(p0, 1.0);
positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);
}
vec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)
{
#ifdef POLYLINE_DASH
vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);
vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);
vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);
vec2 lineDir;
if (usePrevious) {
lineDir = normalize(positionWindow.xy - previousWindow.xy);
}
else {
lineDir = normalize(nextWindow.xy - positionWindow.xy);
}
angle = atan(lineDir.x, lineDir.y) - 1.570796327;
angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;
#endif
vec4 clippedPrevWC, clippedPrevEC;
bool prevSegmentClipped, prevSegmentCulled;
clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);
vec4 clippedNextWC, clippedNextEC;
bool nextSegmentClipped, nextSegmentCulled;
clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);
bool segmentClipped, segmentCulled;
vec4 clippedPositionWC, clippedPositionEC;
clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);
if (segmentCulled)
{
return vec4(0.0, 0.0, 0.0, 1.0);
}
vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);
vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);
if (prevSegmentCulled)
{
directionToPrevWC = -directionToNextWC;
}
else if (nextSegmentCulled)
{
directionToNextWC = -directionToPrevWC;
}
vec2 thisSegmentForwardWC, otherSegmentForwardWC;
if (usePrevious)
{
thisSegmentForwardWC = -directionToPrevWC;
otherSegmentForwardWC = directionToNextWC;
}
else
{
thisSegmentForwardWC = directionToNextWC;
otherSegmentForwardWC =  -directionToPrevWC;
}
vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);
vec2 leftWC = thisSegmentLeftWC;
float expandWidth = width * 0.5;
if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))
{
vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);
vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;
float leftSumLength = length(leftSumWC);
leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);
vec2 u = -thisSegmentForwardWC;
vec2 v = leftWC;
float sinAngle = abs(u.x * v.y - u.y * v.x);
expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);
}
vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;
return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;
}
vec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)
{
vec4 positionEC = czm_modelViewRelativeToEye * position;
vec4 prevEC = czm_modelViewRelativeToEye * previous;
vec4 nextEC = czm_modelViewRelativeToEye * next;
return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);
}
`;function bC(e){e=T(e,T.EMPTY_OBJECT),this.material=e.material,this.translucent=T(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=T(e.closed,!1)}Object.defineProperties(bC.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});bC.prototype.getFragmentShaderSource=function(){let e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),g(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join(`
`)};bC.prototype.isTranslucent=function(){return g(this.material)&&this.material.isTranslucent()||!g(this.material)&&this.translucent};bC.prototype.getRenderState=function(){let e=this.isTranslucent(),t=Ht(this.renderState,!1);return e?(t.depthMask=!1,t.blending=ka.ALPHA_BLEND):t.depthMask=!0,t};bC.getDefaultRenderState=function(e,t,n){let r={depthTest:{enabled:!0}};return e&&(r.depthMask=!1,r.blending=ka.ALPHA_BLEND),t&&(r.cull={enabled:!0,face:sd.BACK}),g(n)&&(r=ji(n,r,!0)),r};var Fl=bC;var C2=`${KI}
${Vq}`,dpe=jI;ea.isInternetExplorer()||(C2=`#define CLIP_POLYLINE 
${C2}`);function W_(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=!1,r=W_.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,C2),this._fragmentShaderSource=T(e.fragmentShaderSource,dpe),this._renderState=Fl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}Object.defineProperties(W_.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});W_.VERTEX_FORMAT=vo.POSITION_ONLY;W_.prototype.getFragmentShaderSource=Fl.prototype.getFragmentShaderSource;W_.prototype.isTranslucent=Fl.prototype.isTranslucent;W_.prototype.getRenderState=Fl.prototype.getRenderState;var x2=W_;var kq=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec2 st;
attribute float batchId;
varying float v_width;
varying vec2 v_st;
varying float v_polylineAngle;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_width = width;
v_st.s = st.s;
v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);
v_polylineAngle = angle;
}
`;var Gq=`#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_st;
void main()
{
czm_materialInput materialInput;
vec2 st = v_st;
st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);
materialInput.s = st.s;
materialInput.st = st;
materialInput.str = vec3(st, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#ifdef VECTOR_TILE
gl_FragColor *= u_highlightColor;
#endif
czm_writeLogDepth();
}
`;function IC(e,t,n,r,o){this._format=e,this._datatype=t,this._width=n,this._height=r,this._buffer=o}Object.defineProperties(IC.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}});IC.clone=function(e){if(!!g(e))return new IC(e._format,e._datatype,e._width,e._height,e._buffer)};IC.prototype.clone=function(){return IC.clone(this)};var ZI=IC;function Mm(){}Mm._transcodeTaskProcessor=new jc("transcodeKTX2",Number.POSITIVE_INFINITY);Mm._readyPromise=void 0;function ppe(){let e=Mm._transcodeTaskProcessor.initWebAssemblyModule({modulePath:"ThirdParty/Workers/basis_transcoder.js",wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then(function(){return Mm._transcodeTaskProcessor});Mm._readyPromise=e}Mm.transcode=function(e,t){return g(Mm._readyPromise)||ppe(),Mm._readyPromise.then(function(n){let r;if(e instanceof ArrayBuffer){let o=new Uint8Array(e);return r={supportedTargetFormats:t,ktx2Buffer:o},n.scheduleTask(r,[e])}return r={supportedTargetFormats:t,ktx2Buffer:e},n.scheduleTask(r,[e.buffer])}).then(function(n){let r=n.length,o=Object.keys(n[0]),a=o.length,s;for(s=0;s<r;s++){let u=n[s];for(let l=0;l<a;l++){let c=u[o[l]];u[o[l]]=new ZI(c.internalFormat,c.datatype,c.width,c.height,c.levelBuffer)}}if(a===1){for(s=0;s<r;++s)n[s]=n[s][o[0]];r===1&&(n=n[0])}return n}).catch(function(n){throw n})};var Uq=Mm;var Hq;qq.setKTX2SupportedFormats=function(e,t,n,r,o,a){Hq={s3tc:e,pvrtc:t,astc:n,etc:r,etc1:o,bc7:a}};function qq(e){let t;return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?t=Promise.resolve(e):t=vt.createIfNeeded(e).fetchArrayBuffer(),t.then(function(n){return Uq.transcode(n,Hq)})}var Lm=qq;function QI(e,t,n,r,o,a,s,u,l,c,f){this._context=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelDatatype=s,this._internalFormat=o,this._pixelFormat=a,this._size=u,this._preMultiplyAlpha=l,this._flipY=c,this._initialized=f}Object.defineProperties(QI.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});QI.prototype.copyFrom=function(e){let t=T(e.xOffset,0),n=T(e.yOffset,0),r=e.source,o=this._context._gl,a=this._textureTarget,s=this._targetFace;o.activeTexture(o.TEXTURE0),o.bindTexture(a,this._texture);let u=r.width,l=r.height,c=r.arrayBufferView,f=this._size,h=this._pixelFormat,d=this._internalFormat,p=this._pixelDatatype,_=this._preMultiplyAlpha,y=this._flipY,v=T(e.skipColorSpaceConversion,!1),w=4;g(c)&&(w=qt.alignmentInBytes(h,p,u)),o.pixelStorei(o.UNPACK_ALIGNMENT,w),v?o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE):o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.BROWSER_DEFAULT_WEBGL);let C=!1;if(!this._initialized){if(t===0&&n===0&&u===f&&l===f)g(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),y&&(c=qt.flipY(c,h,p,f,f)),o.texImage2D(s,0,d,f,f,0,h,xt.toWebGLConstant(p,this._context),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,y),o.texImage2D(s,0,d,h,xt.toWebGLConstant(p,this._context),r)),C=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);let E=qt.createTypedArray(h,p,f,f);o.texImage2D(s,0,d,f,f,0,h,xt.toWebGLConstant(p,this._context),E)}this._initialized=!0}C||(g(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),y&&(c=qt.flipY(c,h,p,u,l)),o.texSubImage2D(s,0,t,n,u,l,h,xt.toWebGLConstant(p,this._context),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,y),o.texSubImage2D(s,0,t,n,h,xt.toWebGLConstant(p,this._context),r))),o.bindTexture(a,null)};QI.prototype.copyFromFramebuffer=function(e,t,n,r,o,a){e=T(e,0),t=T(t,0),n=T(n,0),r=T(r,0),o=T(o,this._size),a=T(a,this._size);let s=this._context._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(this._targetFace,0,e,t,n,r,o,a),s.bindTexture(u,null),this._initialized=!0};var Y_=QI;function EE(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=e.source,r,o;if(g(n)){let C=[n.positiveX,n.negativeX,n.positiveY,n.negativeY,n.positiveZ,n.negativeZ];r=C[0].width,o=C[0].height}else r=e.width,o=e.height;let a=r,s=T(e.pixelDatatype,xt.UNSIGNED_BYTE),u=T(e.pixelFormat,qt.RGBA),l=qt.toInternalFormat(u,s,t),c=qt.textureSizeInBytes(u,s,a,a)*6,f=e.preMultiplyAlpha||u===qt.RGB||u===qt.LUMINANCE,h=T(e.flipY,!0),d=T(e.skipColorSpaceConversion,!1),p=t._gl,_=p.TEXTURE_CUBE_MAP,y=p.createTexture();p.activeTexture(p.TEXTURE0),p.bindTexture(_,y);function v(C,E,S,A,D){let P=E.arrayBufferView;g(P)||(P=E.bufferView);let M=4;g(P)&&(M=qt.alignmentInBytes(u,s,r)),p.pixelStorei(p.UNPACK_ALIGNMENT,M),D?p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE):p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.BROWSER_DEFAULT_WEBGL),g(P)?(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1),A&&(P=qt.flipY(P,u,s,a,a)),p.texImage2D(C,0,l,a,a,0,u,xt.toWebGLConstant(s,t),P)):(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,S),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,A),p.texImage2D(C,0,l,u,xt.toWebGLConstant(s,t),E))}g(n)?(v(p.TEXTURE_CUBE_MAP_POSITIVE_X,n.positiveX,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_X,n.negativeX,f,h,d),v(p.TEXTURE_CUBE_MAP_POSITIVE_Y,n.positiveY,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,n.negativeY,f,h,d),v(p.TEXTURE_CUBE_MAP_POSITIVE_Z,n.positiveZ,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,n.negativeZ,f,h,d)):(p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_X,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l,a,a,0,u,xt.toWebGLConstant(s,t),null)),p.bindTexture(_,null),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=_,this._texture=y,this._pixelFormat=u,this._pixelDatatype=s,this._size=a,this._hasMipmap=!1,this._sizeInBytes=c,this._preMultiplyAlpha=f,this._flipY=h,this._sampler=void 0;let w=g(n);this._positiveX=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_POSITIVE_X,l,u,s,a,f,h,w),this._negativeX=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_NEGATIVE_X,l,u,s,a,f,h,w),this._positiveY=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_POSITIVE_Y,l,u,s,a,f,h,w),this._negativeY=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,u,s,a,f,h,w),this._positiveZ=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_POSITIVE_Z,l,u,s,a,f,h,w),this._negativeZ=new Y_(t,y,_,p.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,u,s,a,f,h,w),this.sampler=g(e.sampler)?e.sampler:new Oa}Object.defineProperties(EE.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,n=e.magnificationFilter,r=t===In.NEAREST_MIPMAP_NEAREST||t===In.NEAREST_MIPMAP_LINEAR||t===In.LINEAR_MIPMAP_NEAREST||t===In.LINEAR_MIPMAP_LINEAR,o=this._context,a=this._pixelDatatype;(a===xt.FLOAT&&!o.textureFloatLinear||a===xt.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(t=r?In.NEAREST_MIPMAP_NEAREST:In.NEAREST,n=kf.NEAREST);let s=o._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.texParameteri(u,s.TEXTURE_MIN_FILTER,t),s.texParameteri(u,s.TEXTURE_MAG_FILTER,n),s.texParameteri(u,s.TEXTURE_WRAP_S,e.wrapS),s.texParameteri(u,s.TEXTURE_WRAP_T,e.wrapT),g(this._textureFilterAnisotropic)&&s.texParameteri(u,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),s.bindTexture(u,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});EE.prototype.generateMipmap=function(e){e=T(e,pI.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};EE.prototype.isDestroyed=function(){return!1};EE.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=st(this._positiveX),this._negativeX=st(this._negativeX),this._positiveY=st(this._positiveY),this._negativeY=st(this._negativeY),this._positiveZ=st(this._positiveZ),this._negativeZ=st(this._negativeZ),st(this)};var TE=EE;var Wq=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var Yq=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec2 centerPixel = fract(repeat * st);
float centerBump = texture2D(image, centerPixel).channel;
float imageWidth = float(imageDimensions.x);
vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));
float rightBump = texture2D(image, rightPixel).channel;
float imageHeight = float(imageDimensions.y);
vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));
float topBump = texture2D(image, leftPixel).channel;
vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
material.diffuse = vec3(0.01);
return material;
}
`;var Xq=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);
float scaledWidth = fract(repeat.s * st.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(repeat.t * st.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value = min(scaledWidth, scaledHeight);
vec4 currentColor = mix(lightColor, darkColor, b);
vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var jq=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));
vec4 color = mix(lightColor, darkColor, b);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var Kq=`uniform sampler2D heights;
uniform sampler2D colors;
float getHeight(int idx, float invTexSize)
{
vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);
#ifdef OES_texture_float
return texture2D(heights, uv).x;
#else
return czm_unpackFloat(texture2D(heights, uv));
#endif
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float height = materialInput.height;
float invTexSize = 1.0 / float(heightsDimensions.x);
float minHeight = getHeight(0, invTexSize);
float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);
if (height < minHeight || height > maxHeight) {
material.diffuse = vec3(0.0);
material.alpha = 0.0;
return material;
}
int idxBelow = 0;
int idxAbove = heightsDimensions.x;
float heightBelow = minHeight;
float heightAbove = maxHeight;
const int maxIterations = 16;
for (int i = 0; i < maxIterations; i++) {
if (idxBelow >= idxAbove - 1) {
break;
}
int idxMid = (idxBelow + idxAbove) / 2;
float heightTex = getHeight(idxMid, invTexSize);
if (height > heightTex) {
idxBelow = idxMid;
heightBelow = heightTex;
} else {
idxAbove = idxMid;
heightAbove = heightTex;
}
}
float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);
vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);
vec4 color = texture2D(colors, colorUv);
if (color.a > 0.0)
{
color.rgb /= color.a;
}
color.rgb = czm_gammaCorrect(color.rgb);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var Zq=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float spacing;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float distanceToContour = mod(materialInput.height, spacing);
#ifdef GL_OES_standard_derivatives
float dxc = abs(dFdx(materialInput.height));
float dyc = abs(dFdy(materialInput.height));
float dF = max(dxc, dyc) * czm_pixelRatio * width;
float alpha = (distanceToContour < dF) ? 1.0 : 0.0;
#else
float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;
#endif
vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var Qq=`uniform sampler2D image;
uniform float minimumHeight;
uniform float maximumHeight;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);
vec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var Jq=`uniform vec4 fadeInColor;
uniform vec4 fadeOutColor;
uniform float maximumDistance;
uniform bool repeat;
uniform vec2 fadeDirection;
uniform vec2 time;
float getTime(float t, float coord)
{
float scalar = 1.0 / maximumDistance;
float q  = distance(t, coord) * scalar;
if (repeat)
{
float r = distance(t, coord + 1.0) * scalar;
float s = distance(t, coord - 1.0) * scalar;
q = min(min(r, s), q);
}
return clamp(q, 0.0, 1.0);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float s = getTime(time.x, st.s) * fadeDirection.s;
float t = getTime(time.y, st.t) * fadeDirection.t;
float u = length(vec2(s, t));
vec4 color = mix(fadeInColor, fadeOutColor, u);
color = czm_gammaCorrect(color);
material.emission = color.rgb;
material.alpha = color.a;
return material;
}
`;var $q=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float cellAlpha;
uniform vec2 lineCount;
uniform vec2 lineThickness;
uniform vec2 lineOffset;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value;
#ifdef GL_OES_standard_derivatives
const float fuzz = 1.2;
vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;
vec2 dx = abs(dFdx(st));
vec2 dy = abs(dFdy(st));
vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;
value = min(
smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),
smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));
#else
const float fuzz = 0.05;
vec2 range = 0.5 - (lineThickness * 0.05);
value = min(
1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),
1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));
#endif
float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));
float sRim = smoothstep(0.8, 1.0, dRim);
value *= (1.0 - sRim);
vec4 halfColor;
halfColor.rgb = color.rgb * 0.5;
halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));
halfColor = czm_gammaCorrect(halfColor);
material.diffuse = halfColor.rgb;
material.emission = halfColor.rgb;
material.alpha = halfColor.a;
return material;
}
`;var e9=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 textureValue = texture2D(image, fract(repeat * materialInput.st));
vec3 normalTangentSpace = textureValue.channels;
normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;
normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);
normalTangentSpace = normalize(normalTangentSpace);
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
return material;
}
`;var t9=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
float getPointOnLine(vec2 p0, vec2 p1, float x)
{
float slope = (p0.y - p1.y) / (p0.x - p1.x);
return slope * (x - p0.x) + p0.y;
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
#ifdef GL_OES_standard_derivatives
float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;
#else
float base = 0.975;
#endif
vec2 center = vec2(1.0, 0.5);
float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);
float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);
float halfWidth = 0.15;
float s = step(0.5 - halfWidth, st.t);
s *= 1.0 - step(0.5 + halfWidth, st.t);
s *= 1.0 - step(base, st.s);
float t = step(base, materialInput.st.s);
t *= 1.0 - step(ptOnUpperLine, st.t);
t *= step(ptOnLowerLine, st.t);
float dist;
if (st.s < base)
{
float d1 = abs(st.t - (0.5 - halfWidth));
float d2 = abs(st.t - (0.5 + halfWidth));
dist = min(d1, d2);
}
else
{
float d1 = czm_infinity;
if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)
{
d1 = abs(st.s - base);
}
float d2 = abs(st.t - ptOnUpperLine);
float d3 = abs(st.t - ptOnLowerLine);
dist = min(min(d1, d2), d3);
}
vec4 outsideColor = vec4(0.0);
vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));
vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var n9=`uniform vec4 color;
uniform vec4 gapColor;
uniform float dashLength;
uniform float dashPattern;
varying float v_polylineAngle;
const float maskLength = 16.0;
mat2 rotate(float rad) {
float c = cos(rad);
float s = sin(rad);
return mat2(
c, s,
-s, c
);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;
float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));
float maskIndex = floor(dashPosition * maskLength);
float maskTest = floor(dashPattern / pow(2.0, maskIndex));
vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;
if (fragColor.a < 0.005) {
discard;
}
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var r9=`uniform vec4 color;
uniform float glowPower;
uniform float taperPower;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);
if (taperPower <= 0.99999) {
glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));
}
vec4 fragColor;
fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);
fragColor.a = clamp(0.0, 1.0, glow) * color.a;
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var i9=`uniform vec4 color;
uniform vec4 outlineColor;
uniform float outlineWidth;
varying float v_width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;
float b = step(0.5 - halfInteriorWidth, st.t);
b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);
float d1 = abs(st.t - (0.5 - halfInteriorWidth));
float d2 = abs(st.t - (0.5 + halfInteriorWidth));
float dist = min(d1, d2);
vec4 currentColor = mix(outlineColor, color, b);
vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var o9=`uniform vec4 color;
uniform vec4 rimColor;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));
float s = smoothstep(1.0 - width, 1.0, d);
vec4 outColor = czm_gammaCorrect(color);
vec4 outRimColor = czm_gammaCorrect(rimColor);
material.diffuse = outColor.rgb;
material.emission = outRimColor.rgb * s;
material.alpha = mix(outColor.a, outRimColor.a, s);
return material;
}
`;var a9=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var s9=`uniform vec4 evenColor;
uniform vec4 oddColor;
uniform float offset;
uniform float repeat;
uniform bool horizontal;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));
float value = fract((coord - offset) * (repeat * 0.5));
float dist = min(value, min(abs(value - 0.5), 1.0 - value));
vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));
vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var u9=`uniform sampler2D specularMap;
uniform sampler2D normalMap;
uniform vec4 baseWaterColor;
uniform vec4 blendColor;
uniform float frequency;
uniform float animationSpeed;
uniform float amplitude;
uniform float specularIntensity;
uniform float fadeFactor;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float time = czm_frameNumber * animationSpeed;
float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);
float specularMapValue = texture2D(specularMap, materialInput.st).r;
vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);
vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));
normalTangentSpace.xy /= fade;
normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);
normalTangentSpace = normalize(normalTangentSpace);
float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);
material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;
material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);
material.diffuse += (0.1 * tsPerturbationRatio);
material.diffuse = material.diffuse;
material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);
material.specular = specularIntensity;
material.shininess = 10.0;
return material;
}
`;function Ce(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=T(e.minificationFilter,In.LINEAR),this._magnificationFilter=T(e.magnificationFilter,kf.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,mpe(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),g(Ce._uniformList[this.type])||(Ce._uniformList[this.type]=Object.keys(this._uniforms))}Ce._uniformList={};Ce.fromType=function(e,t){let n=new Ce({fabric:{type:e}});if(g(t))for(let r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n};Ce.prototype.isTranslucent=function(){if(g(this.translucent))return typeof this.translucent=="function"?this.translucent():this.translucent;let e=!0,t=this._translucentFunctions,n=t.length;for(let r=0;r<n;++r){let o=t[r];if(typeof o=="function"?e=e&&o():e=e&&o,!e)break}return e};Ce.prototype.update=function(e){this._defaultTexture=e.defaultTexture;let t,n,r=this._loadedImages,o=r.length;for(t=0;t<o;++t){let l=r[t];n=l.id;let c=l.image,f;Array.isArray(c)&&(f=c.slice(1,c.length).map(function(y){return y.bufferView}),c=c[0]);let h=new Oa({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter}),d;g(c.internalFormat)?d=new na({context:e,pixelFormat:c.internalFormat,width:c.width,height:c.height,source:{arrayBufferView:c.bufferView,mipLevels:f},sampler:h}):d=new na({context:e,source:c,sampler:h});let p=this._textures[n];g(p)&&p!==this._defaultTexture&&p.destroy(),this._textures[n]=d;let _=`${n}Dimensions`;if(this.uniforms.hasOwnProperty(_)){let y=this.uniforms[_];y.x=d._width,y.y=d._height}}r.length=0;let a=this._loadedCubeMaps;for(o=a.length,t=0;t<o;++t){let l=a[t];n=l.id;let c=l.images,f=new TE({context:e,source:{positiveX:c[0],negativeX:c[1],positiveY:c[2],negativeY:c[3],positiveZ:c[4],negativeZ:c[5]},sampler:new Oa({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[n]=f}a.length=0;let s=this._updateFunctions;for(o=s.length,t=0;t<o;++t)s[t](this,e);let u=this.materials;for(let l in u)u.hasOwnProperty(l)&&u[l].update(e)};Ce.prototype.isDestroyed=function(){return!1};Ce.prototype.destroy=function(){let e=this._textures;for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];r!==this._defaultTexture&&r.destroy()}let t=this.materials;for(let n in t)t.hasOwnProperty(n)&&t[n].destroy();return st(this)};function mpe(e,t){e=T(e,T.EMPTY_OBJECT),t._strict=T(e.strict,!1),t._count=T(e.count,0),t._template=Ht(T(e.fabric,T.EMPTY_OBJECT)),t._template.uniforms=Ht(T(t._template.uniforms,T.EMPTY_OBJECT)),t._template.materials=Ht(T(t._template.materials,T.EMPTY_OBJECT)),t.type=g(t._template.type)?t._template.type:Ci(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];let n,r=Ce._materialCache.getMaterial(t.type);if(g(r)){let a=Ht(r.fabric,!0);t._template=ji(t._template,a,!0),n=r.translucent}vpe(t),g(r)||Ce._materialCache.addMaterial(t.type,t),xpe(t),Spe(t),bpe(t);let o=t._translucentFunctions.length===0?!0:void 0;if(n=T(n,o),n=T(e.translucent,n),g(n))if(typeof n=="function"){let a=function(){return n(t)};t._translucentFunctions.push(a)}else t._translucentFunctions.push(n)}function w2(e,t,n,r){if(g(e)){for(let o in e)if(e.hasOwnProperty(o)){let a=t.indexOf(o)!==-1;(r&&!a||!r&&a)&&n(o,t)}}}function l9(e,t){}function gpe(e,t){}var _pe=["type","materials","uniforms","components","source"],ype=["diffuse","specular","shininess","normal","emission","alpha"];function vpe(e){let t=e._template,n=t.uniforms,r=t.materials,o=t.components;w2(t,_pe,l9,!0),w2(o,ype,l9,!0);let a=[];for(let s in r)r.hasOwnProperty(s)&&a.push(s);w2(n,a,gpe,!1)}function Cpe(e,t){let n=t._template.materials;for(let r in n)if(n.hasOwnProperty(r)&&e.indexOf(r)>-1)return!0;return!1}function xpe(e){let t=e._template.components,n=e._template.source;if(g(n))e.shaderSource+=`${n}
`;else{if(e.shaderSource+=`czm_material czm_getMaterial(czm_materialInput materialInput)
{
`,e.shaderSource+=`czm_material material = czm_getDefaultMaterial(materialInput);
`,g(t)){let r=Object.keys(e._template.materials).length>0;for(let o in t)if(t.hasOwnProperty(o))if(o==="diffuse"||o==="emission"){let s=r&&Cpe(t[o],e)?t[o]:`czm_gammaCorrect(${t[o]})`;e.shaderSource+=`material.${o} = ${s}; 
`}else o==="alpha"?e.shaderSource+=`material.alpha = ${t.alpha}; 
`:e.shaderSource+=`material.${o} = ${t[o]};
`}e.shaderSource+=`return material;
}
`}}var c9={mat2:Ra,mat3:te,mat4:G},wpe=/\.ktx2$/i;function Epe(e){let t;return function(n,r){let o=n.uniforms,a=o[e],s=t!==a,u=!g(a)||a===Ce.DefaultImageId;t=a;let l=n._textures[e],c,f;if(a instanceof HTMLVideoElement){if(a.readyState>=2){if(s&&g(l)&&(l!==r.defaultTexture&&l.destroy(),l=void 0),!g(l)||l===r.defaultTexture){let d=new Oa({minificationFilter:n._minificationFilter,magnificationFilter:n._magnificationFilter});l=new na({context:r,source:a,sampler:d}),n._textures[e]=l;return}l.copyFrom({source:a})}else g(l)||(n._textures[e]=r.defaultTexture);return}if(a instanceof na&&a!==l){n._texturePaths[e]=void 0;let d=n._textures[e];g(d)&&d!==n._defaultTexture&&d.destroy(),n._textures[e]=a,c=`${e}Dimensions`,o.hasOwnProperty(c)&&(f=o[c],f.x=a._width,f.y=a._height);return}if(s&&g(l)&&u&&(l!==n._defaultTexture&&l.destroy(),l=void 0),g(l)||(n._texturePaths[e]=void 0,l=n._textures[e]=n._defaultTexture,c=`${e}Dimensions`,o.hasOwnProperty(c)&&(f=o[c],f.x=l._width,f.y=l._height)),u)return;let h=a instanceof vt;if(!g(n._texturePaths[e])||h&&a.url!==n._texturePaths[e].url||!h&&a!==n._texturePaths[e]){if(typeof a=="string"||h){let d=h?a:vt.createIfNeeded(a),p;wpe.test(d.url)?p=Lm(d.url):p=d.fetchImage(),Promise.resolve(p).then(function(_){n._loadedImages.push({id:e,image:_})}).catch(function(){g(l)&&l!==n._defaultTexture&&l.destroy(),n._textures[e]=n._defaultTexture})}else(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:a});n._texturePaths[e]=a}}}function Tpe(e){return function(t,n){let r=t.uniforms[e];if(r instanceof TE){let a=t._textures[e];a!==t._defaultTexture&&a.destroy(),t._texturePaths[e]=void 0,t._textures[e]=r;return}if(g(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),r===Ce.DefaultCubeMapId)return;let o=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(o!==t._texturePaths[e]){let a=[vt.createIfNeeded(r.positiveX).fetchImage(),vt.createIfNeeded(r.negativeX).fetchImage(),vt.createIfNeeded(r.positiveY).fetchImage(),vt.createIfNeeded(r.negativeY).fetchImage(),vt.createIfNeeded(r.positiveZ).fetchImage(),vt.createIfNeeded(r.negativeZ).fetchImage()];Promise.all(a).then(function(s){t._loadedCubeMaps.push({id:e,images:s})}),t._texturePaths[e]=o}}}function Spe(e){let t=e._template.uniforms;for(let n in t)t.hasOwnProperty(n)&&f9(e,n)}function f9(e,t){let n=e._strict,r=e._template.uniforms,o=r[t],a=Ape(o),s;if(a==="channels")s=SE(e,t,o,!1);else{if(a==="sampler2D"){let c=`${t}Dimensions`;Ipe(e,c)>0&&(r[c]={type:"ivec3",x:1,y:1},f9(e,c))}if(!new RegExp(`uniform\\s+${a}\\s+${t}\\s*;`).test(e.shaderSource)){let c=`uniform ${a} ${t};`;e.shaderSource=c+e.shaderSource}let l=`${t}_${e._count++}`;if(s=SE(e,t,l),e.uniforms[t]=o,a==="sampler2D")e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(Epe(t));else if(a==="samplerCube")e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(Tpe(t));else if(a.indexOf("mat")!==-1){let c=new c9[a];e._uniforms[l]=function(){return c9[a].fromColumnMajorArray(e.uniforms[t],c)}}else e._uniforms[l]=function(){return e.uniforms[t]}}}function Ape(e){let t=e.type;if(!g(t)){let n=typeof e;if(n==="number")t="float";else if(n==="boolean")t="bool";else if(n==="string"||e instanceof vt||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)/^([rgba]){1,4}$/i.test(e)?t="channels":e===Ce.DefaultCubeMapId?t="samplerCube":t="sampler2D";else if(n==="object")if(Array.isArray(e))(e.length===4||e.length===9||e.length===16)&&(t=`mat${Math.sqrt(e.length)}`);else{let r=0;for(let o in e)e.hasOwnProperty(o)&&(r+=1);r>=2&&r<=4?t=`vec${r}`:r===6&&(t="samplerCube")}}return t}function bpe(e){let t=e._strict,n=e._template.materials;for(let r in n)if(n.hasOwnProperty(r)){let o=new Ce({strict:t,fabric:n[r],count:e._count});e._count=o._count,e._uniforms=ji(e._uniforms,o._uniforms,!0),e.materials[r]=o,e._translucentFunctions=e._translucentFunctions.concat(o._translucentFunctions);let a="czm_getMaterial",s=`${a}_${e._count++}`;SE(o,a,s),e.shaderSource=o.shaderSource+e.shaderSource;let u=`${s}(materialInput)`,l=SE(e,r,u)}}function SE(e,t,n,r){r=T(r,!0);let o=0,a="([\\w])?",s=`([\\w${r?".":""}])?`,u=new RegExp(s+t+a,"g");return e.shaderSource=e.shaderSource.replace(u,function(l,c,f){return c||f?l:(o+=1,n)}),o}function Ipe(e,t,n){return SE(e,t,t,n)}Ce._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}};Ce.DefaultImageId="czm_defaultImage";Ce.DefaultCubeMapId="czm_defaultCubeMap";Ce.ColorType="Color";Ce._materialCache.addMaterial(Ce.ColorType,{fabric:{type:Ce.ColorType,uniforms:{color:new K(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});Ce.ImageType="Image";Ce._materialCache.addMaterial(Ce.ImageType,{fabric:{type:Ce.ImageType,uniforms:{image:Ce.DefaultImageId,repeat:new X(1,1),color:new K(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});Ce.DiffuseMapType="DiffuseMap";Ce._materialCache.addMaterial(Ce.DiffuseMapType,{fabric:{type:Ce.DiffuseMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",repeat:new X(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});Ce.AlphaMapType="AlphaMap";Ce._materialCache.addMaterial(Ce.AlphaMapType,{fabric:{type:Ce.AlphaMapType,uniforms:{image:Ce.DefaultImageId,channel:"a",repeat:new X(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0});Ce.SpecularMapType="SpecularMap";Ce._materialCache.addMaterial(Ce.SpecularMapType,{fabric:{type:Ce.SpecularMapType,uniforms:{image:Ce.DefaultImageId,channel:"r",repeat:new X(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1});Ce.EmissionMapType="EmissionMap";Ce._materialCache.addMaterial(Ce.EmissionMapType,{fabric:{type:Ce.EmissionMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",repeat:new X(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});Ce.BumpMapType="BumpMap";Ce._materialCache.addMaterial(Ce.BumpMapType,{fabric:{type:Ce.BumpMapType,uniforms:{image:Ce.DefaultImageId,channel:"r",strength:.8,repeat:new X(1,1)},source:Yq},translucent:!1});Ce.NormalMapType="NormalMap";Ce._materialCache.addMaterial(Ce.NormalMapType,{fabric:{type:Ce.NormalMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",strength:.8,repeat:new X(1,1)},source:e9},translucent:!1});Ce.GridType="Grid";Ce._materialCache.addMaterial(Ce.GridType,{fabric:{type:Ce.GridType,uniforms:{color:new K(0,1,0,1),cellAlpha:.1,lineCount:new X(8,8),lineThickness:new X(1,1),lineOffset:new X(0,0)},source:$q},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}});Ce.StripeType="Stripe";Ce._materialCache.addMaterial(Ce.StripeType,{fabric:{type:Ce.StripeType,uniforms:{horizontal:!0,evenColor:new K(1,1,1,.5),oddColor:new K(0,0,1,.5),offset:0,repeat:5},source:s9},translucent:function(e){let t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}});Ce.CheckerboardType="Checkerboard";Ce._materialCache.addMaterial(Ce.CheckerboardType,{fabric:{type:Ce.CheckerboardType,uniforms:{lightColor:new K(1,1,1,.5),darkColor:new K(0,0,0,.5),repeat:new X(5,5)},source:Xq},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});Ce.DotType="Dot";Ce._materialCache.addMaterial(Ce.DotType,{fabric:{type:Ce.DotType,uniforms:{lightColor:new K(1,1,0,.75),darkColor:new K(0,1,1,.75),repeat:new X(5,5)},source:jq},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});Ce.WaterType="Water";Ce._materialCache.addMaterial(Ce.WaterType,{fabric:{type:Ce.WaterType,uniforms:{baseWaterColor:new K(.2,.3,.6,1),blendColor:new K(0,1,.699,1),specularMap:Ce.DefaultImageId,normalMap:Ce.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:u9},translucent:function(e){let t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}});Ce.RimLightingType="RimLighting";Ce._materialCache.addMaterial(Ce.RimLightingType,{fabric:{type:Ce.RimLightingType,uniforms:{color:new K(1,0,0,.7),rimColor:new K(1,1,1,.4),width:.3},source:o9},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}});Ce.FadeType="Fade";Ce._materialCache.addMaterial(Ce.FadeType,{fabric:{type:Ce.FadeType,uniforms:{fadeInColor:new K(1,0,0,1),fadeOutColor:new K(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new X(.5,.5)},source:Jq},translucent:function(e){let t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}});Ce.PolylineArrowType="PolylineArrow";Ce._materialCache.addMaterial(Ce.PolylineArrowType,{fabric:{type:Ce.PolylineArrowType,uniforms:{color:new K(1,1,1,1)},source:t9},translucent:!0});Ce.PolylineDashType="PolylineDash";Ce._materialCache.addMaterial(Ce.PolylineDashType,{fabric:{type:Ce.PolylineDashType,uniforms:{color:new K(1,0,1,1),gapColor:new K(0,0,0,0),dashLength:16,dashPattern:255},source:n9},translucent:!0});Ce.PolylineGlowType="PolylineGlow";Ce._materialCache.addMaterial(Ce.PolylineGlowType,{fabric:{type:Ce.PolylineGlowType,uniforms:{color:new K(0,.5,1,1),glowPower:.25,taperPower:1},source:r9},translucent:!0});Ce.PolylineOutlineType="PolylineOutline";Ce._materialCache.addMaterial(Ce.PolylineOutlineType,{fabric:{type:Ce.PolylineOutlineType,uniforms:{color:new K(1,1,1,1),outlineColor:new K(1,0,0,1),outlineWidth:1},source:i9},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}});Ce.ElevationContourType="ElevationContour";Ce._materialCache.addMaterial(Ce.ElevationContourType,{fabric:{type:Ce.ElevationContourType,uniforms:{spacing:100,color:new K(1,0,0,1),width:1},source:Zq},translucent:!1});Ce.ElevationRampType="ElevationRamp";Ce._materialCache.addMaterial(Ce.ElevationRampType,{fabric:{type:Ce.ElevationRampType,uniforms:{image:Ce.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:Qq},translucent:!1});Ce.SlopeRampMaterialType="SlopeRamp";Ce._materialCache.addMaterial(Ce.SlopeRampMaterialType,{fabric:{type:Ce.SlopeRampMaterialType,uniforms:{image:Ce.DefaultImageId},source:a9},translucent:!1});Ce.AspectRampMaterialType="AspectRamp";Ce._materialCache.addMaterial(Ce.AspectRampMaterialType,{fabric:{type:Ce.AspectRampMaterialType,uniforms:{image:Ce.DefaultImageId},source:Wq},translucent:!1});Ce.ElevationBandType="ElevationBand";Ce._materialCache.addMaterial(Ce.ElevationBandType,{fabric:{type:Ce.ElevationBandType,uniforms:{heights:Ce.DefaultImageId,colors:Ce.DefaultImageId},source:Kq},translucent:!0});var AE=Ce;var E2=`${KI}
${kq}`,Dpe=Gq;ea.isInternetExplorer()||(E2=`#define CLIP_POLYLINE 
${E2}`);function X_(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=!1,r=X_.VERTEX_FORMAT;this.material=g(e.material)?e.material:AE.fromType(AE.ColorType),this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,E2),this._fragmentShaderSource=T(e.fragmentShaderSource,Dpe),this._renderState=Fl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}Object.defineProperties(X_.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&(e=`#define POLYLINE_DASH
${e}`),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});X_.VERTEX_FORMAT=vo.POSITION_AND_ST;X_.prototype.getFragmentShaderSource=Fl.prototype.getFragmentShaderSource;X_.prototype.isTranslucent=Fl.prototype.isTranslucent;X_.prototype.getRenderState=Fl.prototype.getRenderState;var h9=X_;function Ppe(e){e=T(e,T.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}var a0=Ppe;var Mpe={NONE:0,TOP:1,ALL:2},T2=Object.freeze(Mpe);function Lpe(e,t){let n=[],r=e.length,o=0;for(;o<r;){let a=Math.ceil((r-o)/t--);n.push(e.slice(o,o+a)),o+=a}return n}var d9=Lpe;function Rm(e,t,n){if(this._attributes=t,this._numberOfInstances=n,t.length===0)return;let r=Rpe(t),o=e.floatingPointTexture,a=r===xt.FLOAT&&!o,s=Ope(t,a),u=Npe(s,t,a),l=Math.floor(Jt.maximumTextureSize/u),c=Math.min(n,l),f=u*c,h=Math.ceil(n/c),d=1/f,p=d*.5,_=1/h,y=_*.5;this._textureDimensions=new X(f,h),this._textureStep=new Se(d,p,_,y),this._pixelDatatype=a?xt.UNSIGNED_BYTE:r,this._packFloats=a,this._offsets=s,this._stride=u,this._texture=void 0;let v=4*f*h;this._batchValues=r===xt.FLOAT&&!a?new Float32Array(v):new Uint8Array(v),this._batchValuesDirty=!1}Object.defineProperties(Rm.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function Rpe(e){let t=!1,n=e.length;for(let r=0;r<n;++r)if(e[r].componentDatatype!==ie.UNSIGNED_BYTE){t=!0;break}return t?xt.FLOAT:xt.UNSIGNED_BYTE}function m9(e,t){let n=e[t].componentsPerAttribute;return n===2?X:n===3?x:n===4?Se:Number}function Ope(e,t){let n=new Array(e.length),r=0,o=e.length;for(let a=0;a<o;++a){let u=e[a].componentDatatype;n[a]=r,u!==ie.UNSIGNED_BYTE&&t?r+=4:++r}return n}function Npe(e,t,n){let r=e.length,o=e[r-1];return t[r-1].componentDatatype!==ie.UNSIGNED_BYTE&&n?o+4:o+1}var bE=new Se;function Bpe(e,t,n){let r=Se.unpack(e,t,bE),o=Se.unpackFloat(r);r=Se.unpack(e,t+4,bE);let a=Se.unpackFloat(r);r=Se.unpack(e,t+8,bE);let s=Se.unpackFloat(r);r=Se.unpack(e,t+12,bE);let u=Se.unpackFloat(r);return Se.fromElements(o,a,s,u,n)}function Fpe(e,t,n){let r=Se.packFloat(e.x,bE);Se.pack(r,t,n),r=Se.packFloat(e.y,r),Se.pack(r,t,n+4),r=Se.packFloat(e.z,r),Se.pack(r,t,n+8),r=Se.packFloat(e.w,r),Se.pack(r,t,n+12)}var p9=new Se;Rm.prototype.getBatchedAttribute=function(e,t,n){let r=this._attributes,o=this._offsets[t],a=this._stride,s=4*a*e+4*o,u;this._packFloats&&r[t].componentDatatype!==xt.UNSIGNED_BYTE?u=Bpe(this._batchValues,s,p9):u=Se.unpack(this._batchValues,s,p9);let l=m9(r,t);return g(l.fromCartesian4)?l.fromCartesian4(u,n):g(l.clone)?l.clone(u,n):u.x};var zpe=[void 0,void 0,new X,new x,new Se],Vpe=new Se;Rm.prototype.setBatchedAttribute=function(e,t,n){let r=this._attributes,o=zpe[r[t].componentsPerAttribute],a=this.getBatchedAttribute(e,t,o),s=m9(this._attributes,t);if(g(s.equals)?s.equals(a,n):a===n)return;let l=Vpe;l.x=g(n.x)?n.x:n,l.y=g(n.y)?n.y:0,l.z=g(n.z)?n.z:0,l.w=g(n.w)?n.w:0;let c=this._offsets[t],f=this._stride,h=4*f*e+4*c;this._packFloats&&r[t].componentDatatype!==xt.UNSIGNED_BYTE?Fpe(l,this._batchValues,h):Se.pack(l,this._batchValues,h),this._batchValuesDirty=!0};function kpe(e,t){let n=e._textureDimensions;e._texture=new na({context:t,pixelFormat:qt.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:Oa.NEAREST,flipY:!1})}function Gpe(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}Rm.prototype.update=function(e){g(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,g(this._texture)||kpe(this,e.context),Gpe(this))};Rm.prototype.getUniformMapCallback=function(){let e=this;return function(t){return e._attributes.length===0?t:ji(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}};function Upe(e){let t=e._stride;return e._textureDimensions.y===1?`uniform vec4 batchTextureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float numberOfAttributes = float(${t}); 
    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); 
} 
`:`uniform vec4 batchTextureStep; 
uniform vec2 batchTextureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float stepY = batchTextureStep.z; 
    float centerY = batchTextureStep.w; 
    float numberOfAttributes = float(${t}); 
    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); 
    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}function Hpe(e){return e===1?"float":`vec${e}`}function qpe(e){return e===1?".x":e===2?".xy":e===3?".xyz":""}function Wpe(e,t){let r=e._attributes[t],o=r.componentsPerAttribute,a=r.functionName,s=Hpe(o),u=qpe(o),l=e._offsets[t],c=`${s} ${a}(float batchId) 
{ 
    vec2 st = computeSt(batchId); 
    st.x += batchTextureStep.x * float(${l}); 
`;return e._packFloats&&r.componentDatatype!==xt.UNSIGNED_BYTE?c+=`vec4 textureValue; 
textureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); 
textureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); 
textureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); 
textureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); 
`:c+=`    vec4 textureValue = texture2D(batchTexture, st); 
`,c+=`    ${s} value = textureValue${u}; 
`,e._pixelDatatype===xt.UNSIGNED_BYTE&&r.componentDatatype===ie.UNSIGNED_BYTE&&!r.normalize?c+=`value *= 255.0; 
`:e._pixelDatatype===xt.FLOAT&&r.componentDatatype===ie.UNSIGNED_BYTE&&r.normalize&&(c+=`value /= 255.0; 
`),c+=`    return value; 
} 
`,c}Rm.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(e.length===0)return function(r){return r};let t=`uniform highp sampler2D batchTexture; 
`;t+=`${Upe(this)}
`;let n=e.length;for(let r=0;r<n;++r)t+=Wpe(this,r);return function(r){let o=r.indexOf("void main"),a=r.substring(0,o),s=r.substring(o);return`${a}
${t}
${s}`}};Rm.prototype.isDestroyed=function(){return!1};Rm.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),st(this)};var g9=Rm;var Ype={NEVER:k.NEVER,LESS:k.LESS,EQUAL:k.EQUAL,LESS_OR_EQUAL:k.LEQUAL,GREATER:k.GREATER,NOT_EQUAL:k.NOTEQUAL,GREATER_OR_EQUAL:k.GEQUAL,ALWAYS:k.ALWAYS},s0=Object.freeze(Ype);var _9=new x,y9=new x,v9=new x;function Xpe(e,t,n,r,o){g(o)||(o=new x);let a,s,u,l,c,f,h,d;if(g(t.z)){if(x.equalsEpsilon(e,t,F.EPSILON14))return x.clone(x.UNIT_X,o);if(x.equalsEpsilon(e,n,F.EPSILON14))return x.clone(x.UNIT_Y,o);if(x.equalsEpsilon(e,r,F.EPSILON14))return x.clone(x.UNIT_Z,o);a=x.subtract(n,t,_9),s=x.subtract(r,t,y9),u=x.subtract(e,t,v9),l=x.dot(a,a),c=x.dot(a,s),f=x.dot(a,u),h=x.dot(s,s),d=x.dot(s,u)}else{if(X.equalsEpsilon(e,t,F.EPSILON14))return x.clone(x.UNIT_X,o);if(X.equalsEpsilon(e,n,F.EPSILON14))return x.clone(x.UNIT_Y,o);if(X.equalsEpsilon(e,r,F.EPSILON14))return x.clone(x.UNIT_Z,o);a=X.subtract(n,t,_9),s=X.subtract(r,t,y9),u=X.subtract(e,t,v9),l=X.dot(a,a),c=X.dot(a,s),f=X.dot(a,u),h=X.dot(s,s),d=X.dot(s,u)}o.y=h*f-c*d,o.z=l*d-c*f;let p=l*h-c*c;if(p!==0)return o.y/=p,o.z/=p,o.x=1-o.y-o.z,o}var C9=Xpe;var S2={};S2.calculateACMR=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,r=T(e.cacheSize,24),o=t.length;if(!g(n)){n=0;let u=0,l=t[u];for(;u<o;)l>n&&(n=l),++u,l=t[u]}let a=[];for(let u=0;u<n+1;u++)a[u]=0;let s=r+1;for(let u=0;u<o;++u)s-a[t[u]]>r&&(a[t[u]]=s,++s);return(s-r+1)/(o/3)};S2.tipsify=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,r=T(e.cacheSize,24),o;function a(m,I,L,R){for(;I.length>=1;){let N=I[I.length-1];if(I.splice(I.length-1,1),m[N].numLiveTriangles>0)return N}for(;o<R;){if(m[o].numLiveTriangles>0)return++o,o-1;++o}return-1}function s(m,I,L,R,N,B,V){let z=-1,U,Q=-1,ne=0;for(;ne<L.length;){let se=L[ne];R[se].numLiveTriangles&&(U=0,N-R[se].timeStamp+2*R[se].numLiveTriangles<=I&&(U=N-R[se].timeStamp),(U>Q||Q===-1)&&(Q=U,z=se)),++ne}return z===-1?a(R,B,m,V):z}let u=t.length,l=0,c=0,f=t[c],h=u;if(g(n))l=n+1;else{for(;c<h;)f>l&&(l=f),++c,f=t[c];if(l===-1)return 0;++l}let d=[],p;for(p=0;p<l;p++)d[p]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};c=0;let _=0;for(;c<h;)d[t[c]].vertexTriangles.push(_),++d[t[c]].numLiveTriangles,d[t[c+1]].vertexTriangles.push(_),++d[t[c+1]].numLiveTriangles,d[t[c+2]].vertexTriangles.push(_),++d[t[c+2]].numLiveTriangles,++_,c+=3;let y=0,v=r+1;o=1;let w=[],C=[],E,S,A=0,D=[],P=u/3,M=[];for(p=0;p<P;p++)M[p]=!1;let b,O;for(;y!==-1;){w=[],S=d[y],O=S.vertexTriangles.length;for(let m=0;m<O;++m)if(_=S.vertexTriangles[m],!M[_]){M[_]=!0,c=_+_+_;for(let I=0;I<3;++I)b=t[c],w.push(b),C.push(b),D[A]=b,++A,E=d[b],--E.numLiveTriangles,v-E.timeStamp>r&&(E.timeStamp=v,++v),++c}y=s(t,r,w,d,v,C,l)}return D};var x9=S2;var zl={};function iD(e,t,n,r,o){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=o,e[t++]=o,e[t]=n}function jpe(e){let t=e.length,n=t/3*6,r=Or.createTypedArray(t,n),o=0;for(let a=0;a<t;a+=3,o+=6)iD(r,o,e[a],e[a+1],e[a+2]);return r}function Kpe(e){let t=e.length;if(t>=3){let n=(t-2)*6,r=Or.createTypedArray(t,n);iD(r,0,e[0],e[1],e[2]);let o=6;for(let a=3;a<t;++a,o+=6)iD(r,o,e[a-1],e[a],e[a-2]);return r}return new Uint16Array}function Zpe(e){if(e.length>0){let t=e.length-1,n=(t-1)*6,r=Or.createTypedArray(t,n),o=e[0],a=0;for(let s=1;s<t;++s,a+=6)iD(r,a,o,e[s],e[s+1]);return r}return new Uint16Array}zl.toWireframe=function(e){let t=e.indices;if(g(t)){switch(e.primitiveType){case sn.TRIANGLES:e.indices=jpe(t);break;case sn.TRIANGLE_STRIP:e.indices=Kpe(t);break;case sn.TRIANGLE_FAN:e.indices=Zpe(t);break}e.primitiveType=sn.LINES}return e};zl.createLineSegmentsForVectors=function(e,t,n){t=T(t,"normal"),n=T(n,1e4);let r=e.attributes.position.values,o=e.attributes[t].values,a=r.length,s=new Float64Array(2*a),u=0;for(let f=0;f<a;f+=3)s[u++]=r[f],s[u++]=r[f+1],s[u++]=r[f+2],s[u++]=r[f]+o[f]*n,s[u++]=r[f+1]+o[f+1]*n,s[u++]=r[f+2]+o[f+2]*n;let l,c=e.boundingSphere;return g(c)&&(l=new Ee(c.center,c.radius+n)),new Ei({attributes:{position:new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:sn.LINES,boundingSphere:l})};zl.createAttributeLocations=function(e){let t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,r={},o=0,a,s=t.length;for(a=0;a<s;++a){let u=t[a];g(n[u])&&(r[u]=o++)}for(let u in n)n.hasOwnProperty(u)&&!g(r[u])&&(r[u]=o++);return r};zl.reorderForPreVertexCache=function(e){let t=Ei.computeNumberOfVertices(e),n=e.indices;if(g(n)){let r=new Int32Array(t);for(let d=0;d<t;d++)r[d]=-1;let o=n,a=o.length,s=Or.createTypedArray(t,a),u=0,l=0,c=0,f;for(;u<a;)f=r[o[u]],f!==-1?s[l]=f:(f=o[u],r[f]=c,s[l]=c,++c),++u,++l;e.indices=s;let h=e.attributes;for(let d in h)if(h.hasOwnProperty(d)&&g(h[d])&&g(h[d].values)){let p=h[d],_=p.values,y=0,v=p.componentsPerAttribute,w=ie.createTypedArray(p.componentDatatype,c*v);for(;y<t;){let C=r[y];if(C!==-1)for(let E=0;E<v;E++)w[v*C+E]=_[v*y+E];++y}p.values=w}}return e};zl.reorderForPostVertexCache=function(e,t){let n=e.indices;if(e.primitiveType===sn.TRIANGLES&&g(n)){let r=n.length,o=0;for(let a=0;a<r;a++)n[a]>o&&(o=n[a]);e.indices=x9.tipsify({indices:n,maximumIndex:o,cacheSize:t})}return e};function w9(e){let t={};for(let n in e)if(e.hasOwnProperty(n)&&g(e[n])&&g(e[n].values)){let r=e[n];t[n]=new Ti({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function Qpe(e,t,n){for(let r in t)if(t.hasOwnProperty(r)&&g(t[r])&&g(t[r].values)){let o=t[r];for(let a=0;a<o.componentsPerAttribute;++a)e[r].values.push(o.values[n*o.componentsPerAttribute+a])}}zl.fitToUnsignedShortIndices=function(e){let t=[],n=Ei.computeNumberOfVertices(e);if(g(e.indices)&&n>=F.SIXTY_FOUR_KILOBYTES){let r=[],o=[],a=0,s=w9(e.attributes),u=e.indices,l=u.length,c;e.primitiveType===sn.TRIANGLES?c=3:e.primitiveType===sn.LINES?c=2:e.primitiveType===sn.POINTS&&(c=1);for(let f=0;f<l;f+=c){for(let h=0;h<c;++h){let d=u[f+h],p=r[d];g(p)||(p=a++,r[d]=p,Qpe(s,e.attributes,d)),o.push(p)}a+c>=F.SIXTY_FOUR_KILOBYTES&&(t.push(new Ei({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),r=[],o=[],a=0,s=w9(e.attributes))}o.length!==0&&t.push(new Ei({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var E9=new x,Jpe=new le;zl.projectTo2D=function(e,t,n,r,o){let a=e.attributes[t];o=g(o)?o:new mc;let s=o.ellipsoid,u=a.values,l=new Float64Array(u.length),c=0;for(let f=0;f<u.length;f+=3){let h=x.fromArray(u,f,E9),d=s.cartesianToCartographic(h,Jpe),p=o.project(d,E9);l[c++]=p.x,l[c++]=p.y,l[c++]=p.z}return e.attributes[n]=a,e.attributes[r]=new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:l}),delete e.attributes[t],e};var A2={high:0,low:0};zl.encodeAttribute=function(e,t,n,r){let o=e.attributes[t],a=o.values,s=a.length,u=new Float32Array(s),l=new Float32Array(s);for(let f=0;f<s;++f)ti.encode(a[f],A2),u[f]=A2.high,l[f]=A2.low;let c=o.componentsPerAttribute;return e.attributes[n]=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:c,values:u}),e.attributes[r]=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:c,values:l}),delete e.attributes[t],e};var ld=new x;function b2(e,t){if(g(t)){let n=t.values,r=n.length;for(let o=0;o<r;o+=3)x.unpack(n,o,ld),G.multiplyByPoint(e,ld,ld),x.pack(ld,n,o)}}function I2(e,t){if(g(t)){let n=t.values,r=n.length;for(let o=0;o<r;o+=3)x.unpack(n,o,ld),te.multiplyByVector(e,ld,ld),ld=x.normalize(ld,ld),x.pack(ld,n,o)}}var JI=new G,$I=new te;zl.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(G.equals(t,G.IDENTITY))return e;let n=e.geometry.attributes;b2(t,n.position),b2(t,n.prevPosition),b2(t,n.nextPosition),(g(n.normal)||g(n.tangent)||g(n.bitangent))&&(G.inverse(t,JI),G.transpose(JI,JI),G.getMatrix3(JI,$I),I2($I,n.normal),I2($I,n.tangent),I2($I,n.bitangent));let r=e.geometry.boundingSphere;return g(r)&&(e.geometry.boundingSphere=Ee.transform(r,t,r)),e.modelMatrix=G.clone(G.IDENTITY),e};function $pe(e,t){let n=e.length,r={},o=e[0][t].attributes,a;for(a in o)if(o.hasOwnProperty(a)&&g(o[a])&&g(o[a].values)){let s=o[a],u=s.values.length,l=!0;for(let c=1;c<n;++c){let f=e[c][t].attributes[a];if(!g(f)||s.componentDatatype!==f.componentDatatype||s.componentsPerAttribute!==f.componentsPerAttribute||s.normalize!==f.normalize){l=!1;break}u+=f.values.length}l&&(r[a]=new Ti({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:ie.createTypedArray(s.componentDatatype,u)}))}return r}var eme=new x;function D2(e,t){let n=e.length,r,o,a,s,u=e[0].modelMatrix,l=g(e[0][t].indices),c=e[0][t].primitiveType,f=$pe(e,t),h,d,p;for(r in f)if(f.hasOwnProperty(r))for(h=f[r].values,s=0,o=0;o<n;++o)for(d=e[o][t].attributes[r].values,p=d.length,a=0;a<p;++a)h[s++]=d[a];let _;if(l){let C=0;for(o=0;o<n;++o)C+=e[o][t].indices.length;let E=Ei.computeNumberOfVertices(new Ei({attributes:f,primitiveType:sn.POINTS})),S=Or.createTypedArray(E,C),A=0,D=0;for(o=0;o<n;++o){let P=e[o][t].indices,M=P.length;for(s=0;s<M;++s)S[A++]=D+P[s];D+=Ei.computeNumberOfVertices(e[o][t])}_=S}let y=new x,v=0,w;for(o=0;o<n;++o){if(w=e[o][t].boundingSphere,!g(w)){y=void 0;break}x.add(w.center,y,y)}if(g(y))for(x.divideByScalar(y,n,y),o=0;o<n;++o){w=e[o][t].boundingSphere;let C=x.magnitude(x.subtract(w.center,y,eme))+w.radius;C>v&&(v=C)}return new Ei({attributes:f,indices:_,primitiveType:c,boundingSphere:g(y)?new Ee(y,v):void 0})}zl.combineInstances=function(e){let t=[],n=[],r=e.length;for(let a=0;a<r;++a){let s=e[a];g(s.geometry)?t.push(s):g(s.westHemisphereGeometry)&&g(s.eastHemisphereGeometry)&&n.push(s)}let o=[];return t.length>0&&o.push(D2(t,"geometry")),n.length>0&&(o.push(D2(n,"westHemisphereGeometry")),o.push(D2(n,"eastHemisphereGeometry"))),o};var qf=new x,IE=new x,DC=new x,PC=new x;zl.computeNormal=function(e){let t=e.indices,n=e.attributes,r=n.position.values,o=n.position.values.length/3,a=t.length,s=new Array(o),u=new Array(a/3),l=new Array(a),c;for(c=0;c<o;c++)s[c]={indexOffset:0,count:0,currentCount:0};let f=0;for(c=0;c<a;c+=3){let _=t[c],y=t[c+1],v=t[c+2],w=_*3,C=y*3,E=v*3;IE.x=r[w],IE.y=r[w+1],IE.z=r[w+2],DC.x=r[C],DC.y=r[C+1],DC.z=r[C+2],PC.x=r[E],PC.y=r[E+1],PC.z=r[E+2],s[_].count++,s[y].count++,s[v].count++,x.subtract(DC,IE,DC),x.subtract(PC,IE,PC),u[f]=x.cross(DC,PC,new x),f++}let h=0;for(c=0;c<o;c++)s[c].indexOffset+=h,h+=s[c].count;f=0;let d;for(c=0;c<a;c+=3){d=s[t[c]];let _=d.indexOffset+d.currentCount;l[_]=f,d.currentCount++,d=s[t[c+1]],_=d.indexOffset+d.currentCount,l[_]=f,d.currentCount++,d=s[t[c+2]],_=d.indexOffset+d.currentCount,l[_]=f,d.currentCount++,f++}let p=new Float32Array(o*3);for(c=0;c<o;c++){let _=c*3;if(d=s[c],x.clone(x.ZERO,qf),d.count>0){for(f=0;f<d.count;f++)x.add(qf,u[l[d.indexOffset+f]],qf);x.equalsEpsilon(x.ZERO,qf,F.EPSILON10)&&x.clone(u[l[d.indexOffset]],qf)}x.equalsEpsilon(x.ZERO,qf,F.EPSILON10)&&(qf.z=1),x.normalize(qf,qf),p[_]=qf.x,p[_+1]=qf.y,p[_+2]=qf.z}return e.attributes.normal=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:p}),e};var tme=new x,T9=new x,nme=new x;zl.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,r=e.attributes.position.values,o=e.attributes.normal.values,a=e.attributes.st.values,s=e.attributes.position.values.length/3,u=n.length,l=new Array(s*3),c;for(c=0;c<l.length;c++)l[c]=0;let f,h,d;for(c=0;c<u;c+=3){let y=n[c],v=n[c+1],w=n[c+2];f=y*3,h=v*3,d=w*3;let C=y*2,E=v*2,S=w*2,A=r[f],D=r[f+1],P=r[f+2],M=a[C],b=a[C+1],O=a[E+1]-b,m=a[S+1]-b,I=1/((a[E]-M)*m-(a[S]-M)*O),L=(m*(r[h]-A)-O*(r[d]-A))*I,R=(m*(r[h+1]-D)-O*(r[d+1]-D))*I,N=(m*(r[h+2]-P)-O*(r[d+2]-P))*I;l[f]+=L,l[f+1]+=R,l[f+2]+=N,l[h]+=L,l[h+1]+=R,l[h+2]+=N,l[d]+=L,l[d+1]+=R,l[d+2]+=N}let p=new Float32Array(s*3),_=new Float32Array(s*3);for(c=0;c<s;c++){f=c*3,h=f+1,d=f+2;let y=x.fromArray(o,f,tme),v=x.fromArray(l,f,nme),w=x.dot(y,v);x.multiplyByScalar(y,w,T9),x.normalize(x.subtract(v,T9,v),v),p[f]=v.x,p[h]=v.y,p[d]=v.z,x.normalize(x.cross(y,v,v),v),_[f]=v.x,_[h]=v.y,_[d]=v.z}return e.attributes.tangent=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:p}),e.attributes.bitangent=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:_}),e};var DE=new X,ud=new x,S9=new x,A9=new x,eD=new X;zl.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,r;if(g(t)){let D=t.values;r=D.length/3;let P=new Float32Array(r*2),M=0;for(n=0;n<r;++n){if(x.fromArray(D,n*3,ud),x.equals(ud,x.ZERO)){M+=2;continue}eD=_a.octEncodeInRange(ud,65535,eD),P[M++]=eD.x,P[M++]=eD.y}return e.attributes.compressedAttributes=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:P}),delete e.attributes.extrudeDirection,e}let o=e.attributes.normal,a=e.attributes.st,s=g(o),u=g(a);if(!s&&!u)return e;let l=e.attributes.tangent,c=e.attributes.bitangent,f=g(l),h=g(c),d,p,_,y;s&&(d=o.values),u&&(p=a.values),f&&(_=l.values),h&&(y=c.values),r=(s?d.length:p.length)/(s?3:2);let C=r,E=u&&s?2:1;E+=f||h?1:0,C*=E;let S=new Float32Array(C),A=0;for(n=0;n<r;++n){u&&(X.fromArray(p,n*2,DE),S[A++]=_a.compressTextureCoordinates(DE));let D=n*3;s&&g(_)&&g(y)?(x.fromArray(d,D,ud),x.fromArray(_,D,S9),x.fromArray(y,D,A9),_a.octPack(ud,S9,A9,DE),S[A++]=DE.x,S[A++]=DE.y):(s&&(x.fromArray(d,D,ud),S[A++]=_a.octEncodeFloat(ud)),f&&(x.fromArray(_,D,ud),S[A++]=_a.octEncodeFloat(ud)),h&&(x.fromArray(y,D,ud),S[A++]=_a.octEncodeFloat(ud)))}return e.attributes.compressedAttributes=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:E,values:S}),s&&delete e.attributes.normal,u&&delete e.attributes.st,h&&delete e.attributes.bitangent,f&&delete e.attributes.tangent,e};function rme(e){if(g(e.indices))return e;let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}function ime(e){let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let r=3;for(let o=3;o<t;++o)n[r++]=o-1,n[r++]=0,n[r++]=o;return e.indices=n,e.primitiveType=sn.TRIANGLES,e}function ome(e){let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let r=6;for(let o=3;o<t-1;o+=2)n[r++]=o,n[r++]=o-1,n[r++]=o+1,o+2<t&&(n[r++]=o,n[r++]=o+1,n[r++]=o+2);return e.indices=n,e.primitiveType=sn.TRIANGLES,e}function ame(e){if(g(e.indices))return e;let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}function sme(e){let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return e.indices=n,e.primitiveType=sn.LINES,e}function ume(e){let t=Ei.computeNumberOfVertices(e),n=Or.createTypedArray(t,t*2);n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=sn.LINES,e}function lme(e){switch(e.primitiveType){case sn.TRIANGLE_FAN:return ime(e);case sn.TRIANGLE_STRIP:return ome(e);case sn.TRIANGLES:return rme(e);case sn.LINE_STRIP:return sme(e);case sn.LINE_LOOP:return ume(e);case sn.LINES:return ame(e)}return e}function u0(e,t){Math.abs(e.y)<F.EPSILON6&&(t?e.y=-F.EPSILON6:e.y=F.EPSILON6)}function cme(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){u0(e,e.y<0),u0(t,t.y<0),u0(n,n.y<0);return}let r=Math.abs(e.y),o=Math.abs(t.y),a=Math.abs(n.y),s;r>o?r>a?s=F.sign(e.y):s=F.sign(n.y):o>a?s=F.sign(t.y):s=F.sign(n.y);let u=s<0;u0(e,u),u0(t,u),u0(n,u)}var b9=new x;function Wf(e,t,n,r){x.add(e,x.multiplyByScalar(x.subtract(t,e,b9),e.y/(e.y-t.y),b9),n),x.clone(n,r),u0(n,!0),u0(r,!1)}var j_=new x,K_=new x,Z_=new x,Q_=new x,P2={positions:new Array(7),indices:new Array(3*3)};function fme(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;cme(e,t,n);let r=e.y<0,o=t.y<0,a=n.y<0,s=0;s+=r?1:0,s+=o?1:0,s+=a?1:0;let u=P2.indices;s===1?(u[1]=3,u[2]=4,u[5]=6,u[7]=6,u[8]=5,r?(Wf(e,t,j_,Z_),Wf(e,n,K_,Q_),u[0]=0,u[3]=1,u[4]=2,u[6]=1):o?(Wf(t,n,j_,Z_),Wf(t,e,K_,Q_),u[0]=1,u[3]=2,u[4]=0,u[6]=2):a&&(Wf(n,e,j_,Z_),Wf(n,t,K_,Q_),u[0]=2,u[3]=0,u[4]=1,u[6]=0)):s===2&&(u[2]=4,u[4]=4,u[5]=3,u[7]=5,u[8]=6,r?o?a||(Wf(n,e,j_,Z_),Wf(n,t,K_,Q_),u[0]=0,u[1]=1,u[3]=0,u[6]=2):(Wf(t,n,j_,Z_),Wf(t,e,K_,Q_),u[0]=2,u[1]=0,u[3]=2,u[6]=1):(Wf(e,t,j_,Z_),Wf(e,n,K_,Q_),u[0]=1,u[1]=2,u[3]=1,u[6]=0));let l=P2.positions;return l[0]=e,l[1]=t,l[2]=n,l.length=3,(s===1||s===2)&&(l[3]=j_,l[4]=K_,l[5]=Z_,l[6]=Q_,l.length=7),P2}function I9(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let o in n)if(n.hasOwnProperty(o)&&g(n[o])&&g(n[o].values)){let a=n[o];a.values=ie.createTypedArray(a.componentDatatype,a.values)}let r=Ei.computeNumberOfVertices(e);return e.indices=Or.createTypedArray(r,e.indices),t&&(e.boundingSphere=Ee.fromVertices(n.position.values)),e}function LC(e){let t=e.attributes,n={};for(let r in t)if(t.hasOwnProperty(r)&&g(t[r])&&g(t[r].values)){let o=t[r];n[r]=new Ti({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return new Ei({attributes:n,indices:[],primitiveType:e.primitiveType})}function O2(e,t,n){let r=g(e.geometry.boundingSphere);t=I9(t,r),n=I9(n,r),g(n)&&!g(t)?e.geometry=n:!g(n)&&g(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function N2(e,t){let n=new e,r=new e,o=new e;return function(a,s,u,l,c,f,h,d){let p=e.fromArray(c,a*t,n),_=e.fromArray(c,s*t,r),y=e.fromArray(c,u*t,o);e.multiplyByScalar(p,l.x,p),e.multiplyByScalar(_,l.y,_),e.multiplyByScalar(y,l.z,y);let v=e.add(p,_,p);e.add(v,y,v),d&&e.normalize(v,v),e.pack(v,f,h*t)}}var hme=N2(Se,4),rD=N2(x,3),O9=N2(X,2),dme=function(e,t,n,r,o,a,s){let u=o[e]*r.x,l=o[t]*r.y,c=o[n]*r.z;a[s]=u+l+c>F.EPSILON6?1:0},PE=new x,M2=new x,L2=new x,pme=new x;function tD(e,t,n,r,o,a,s,u,l,c,f,h,d,p,_,y){if(!g(a)&&!g(s)&&!g(u)&&!g(l)&&!g(c)&&p===0)return;let v=x.fromArray(o,e*3,PE),w=x.fromArray(o,t*3,M2),C=x.fromArray(o,n*3,L2),E=C9(r,v,w,C,pme);if(!!g(E)){if(g(a)&&rD(e,t,n,E,a,h.normal.values,y,!0),g(c)){let S=x.fromArray(c,e*3,PE),A=x.fromArray(c,t*3,M2),D=x.fromArray(c,n*3,L2);x.multiplyByScalar(S,E.x,S),x.multiplyByScalar(A,E.y,A),x.multiplyByScalar(D,E.z,D);let P;!x.equals(S,x.ZERO)||!x.equals(A,x.ZERO)||!x.equals(D,x.ZERO)?(P=x.add(S,A,S),x.add(P,D,P),x.normalize(P,P)):(P=PE,P.x=0,P.y=0,P.z=0),x.pack(P,h.extrudeDirection.values,y*3)}if(g(f)&&dme(e,t,n,E,f,h.applyOffset.values,y),g(s)&&rD(e,t,n,E,s,h.tangent.values,y,!0),g(u)&&rD(e,t,n,E,u,h.bitangent.values,y,!0),g(l)&&O9(e,t,n,E,l,h.st.values,y),p>0)for(let S=0;S<p;S++){let A=d[S];mme(e,t,n,E,y,_[A],h[A])}}}function mme(e,t,n,r,o,a,s){let u=a.componentsPerAttribute,l=a.values,c=s.values;switch(u){case 4:hme(e,t,n,r,l,c,o,!1);break;case 3:rD(e,t,n,r,l,c,o,!1);break;case 2:O9(e,t,n,r,l,c,o,!1);break;default:c[o]=l[e]*r.x+l[t]*r.y+l[n]*r.z}}function hp(e,t,n,r,o,a){let s=e.position.values.length/3;if(o!==-1){let u=r[o],l=n[u];return l===-1?(n[u]=s,e.position.values.push(a.x,a.y,a.z),t.push(s),s):(t.push(l),l)}return e.position.values.push(a.x,a.y,a.z),t.push(s),s}var gme={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function D9(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=g(n.normal)?n.normal.values:void 0,a=g(n.bitangent)?n.bitangent.values:void 0,s=g(n.tangent)?n.tangent.values:void 0,u=g(n.st)?n.st.values:void 0,l=g(n.extrudeDirection)?n.extrudeDirection.values:void 0,c=g(n.applyOffset)?n.applyOffset.values:void 0,f=t.indices,h=[];for(let P in n)n.hasOwnProperty(P)&&!gme[P]&&g(n[P])&&h.push(P);let d=h.length,p=LC(t),_=LC(t),y,v,w,C,E,S=[];S.length=r.length/3;let A=[];for(A.length=r.length/3,E=0;E<S.length;++E)S[E]=-1,A[E]=-1;let D=f.length;for(E=0;E<D;E+=3){let P=f[E],M=f[E+1],b=f[E+2],O=x.fromArray(r,P*3),m=x.fromArray(r,M*3),I=x.fromArray(r,b*3),L=fme(O,m,I);if(g(L)&&L.positions.length>3){let R=L.positions,N=L.indices,B=N.length;for(let V=0;V<B;++V){let z=N[V],U=R[z];U.y<0?(y=_.attributes,v=_.indices,w=S):(y=p.attributes,v=p.indices,w=A),C=hp(y,v,w,f,z<3?E+z:-1,U),tD(P,M,b,U,r,o,s,a,u,l,c,y,h,d,n,C)}}else g(L)&&(O=L.positions[0],m=L.positions[1],I=L.positions[2]),O.y<0?(y=_.attributes,v=_.indices,w=S):(y=p.attributes,v=p.indices,w=A),C=hp(y,v,w,f,E,O),tD(P,M,b,O,r,o,s,a,u,l,c,y,h,d,n,C),C=hp(y,v,w,f,E+1,m),tD(P,M,b,m,r,o,s,a,u,l,c,y,h,d,n,C),C=hp(y,v,w,f,E+2,I),tD(P,M,b,I,r,o,s,a,u,l,c,y,h,d,n,C)}O2(e,_,p)}var N9=si.fromPointNormal(x.ZERO,x.UNIT_Y),_me=new x,yme=new x;function MC(e,t,n,r,o,a,s){if(!g(s))return;let u=x.fromArray(r,e*3,PE);x.equalsEpsilon(u,n,F.EPSILON10)?a.applyOffset.values[o]=s[e]:a.applyOffset.values[o]=s[t]}function P9(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=g(n.applyOffset)?n.applyOffset.values:void 0,a=t.indices,s=LC(t),u=LC(t),l,c=a.length,f=[];f.length=r.length/3;let h=[];for(h.length=r.length/3,l=0;l<f.length;++l)f[l]=-1,h[l]=-1;for(l=0;l<c;l+=2){let d=a[l],p=a[l+1],_=x.fromArray(r,d*3,PE),y=x.fromArray(r,p*3,M2),v;Math.abs(_.y)<F.EPSILON6&&(_.y<0?_.y=-F.EPSILON6:_.y=F.EPSILON6),Math.abs(y.y)<F.EPSILON6&&(y.y<0?y.y=-F.EPSILON6:y.y=F.EPSILON6);let w=s.attributes,C=s.indices,E=h,S=u.attributes,A=u.indices,D=f,P=Jc.lineSegmentPlane(_,y,N9,L2);if(g(P)){let M=x.multiplyByScalar(x.UNIT_Y,5*F.EPSILON9,_me);_.y<0&&(x.negate(M,M),w=u.attributes,C=u.indices,E=f,S=s.attributes,A=s.indices,D=h);let b=x.add(P,M,yme);v=hp(w,C,E,a,l,_),MC(d,p,_,r,v,w,o),v=hp(w,C,E,a,-1,b),MC(d,p,b,r,v,w,o),x.negate(M,M),x.add(P,M,b),v=hp(S,A,D,a,-1,b),MC(d,p,b,r,v,S,o),v=hp(S,A,D,a,l+1,y),MC(d,p,y,r,v,S,o)}else{let M,b,O;_.y<0?(M=u.attributes,b=u.indices,O=f):(M=s.attributes,b=s.indices,O=h),v=hp(M,b,O,a,l,_),MC(d,p,_,r,v,M,o),v=hp(M,b,O,a,l+1,y),MC(d,p,y,r,v,M,o)}}O2(e,u,s)}var M9=new X,vme=new X,B9=new x,F9=new x,R2=new x,Cme=new x,xme=new x,wme=new x,L9=new Se;function R9(e){let t=e.attributes,n=t.position.values,r=t.prevPosition.values,o=t.nextPosition.values,a=n.length;for(let s=0;s<a;s+=3){let u=x.unpack(n,s,B9);if(u.x>0)continue;let l=x.unpack(r,s,F9);(u.y<0&&l.y>0||u.y>0&&l.y<0)&&(s-3>0?(r[s]=n[s-3],r[s+1]=n[s-2],r[s+2]=n[s-1]):x.pack(u,r,s));let c=x.unpack(o,s,R2);(u.y<0&&c.y>0||u.y>0&&c.y<0)&&(s+3<a?(o[s]=n[s+3],o[s+1]=n[s+4],o[s+2]=n[s+5]):x.pack(u,o,s))}}var Eme=5*F.EPSILON9,nD=F.EPSILON6;function Tme(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=n.prevPosition.values,a=n.nextPosition.values,s=n.expandAndWidth.values,u=g(n.st)?n.st.values:void 0,l=g(n.color)?n.color.values:void 0,c=LC(t),f=LC(t),h,d,p,_=!1,y=r.length/3;for(h=0;h<y;h+=4){let v=h,w=h+2,C=x.fromArray(r,v*3,B9),E=x.fromArray(r,w*3,F9);if(Math.abs(C.y)<nD)for(C.y=nD*(E.y<0?-1:1),r[h*3+1]=C.y,r[(h+1)*3+1]=C.y,d=v*3;d<v*3+4*3;d+=3)o[d]=r[h*3],o[d+1]=r[h*3+1],o[d+2]=r[h*3+2];if(Math.abs(E.y)<nD)for(E.y=nD*(C.y<0?-1:1),r[(h+2)*3+1]=E.y,r[(h+3)*3+1]=E.y,d=v*3;d<v*3+4*3;d+=3)a[d]=r[(h+2)*3],a[d+1]=r[(h+2)*3+1],a[d+2]=r[(h+2)*3+2];let S=c.attributes,A=c.indices,D=f.attributes,P=f.indices,M=Jc.lineSegmentPlane(C,E,N9,Cme);if(g(M)){_=!0;let b=x.multiplyByScalar(x.UNIT_Y,Eme,xme);C.y<0&&(x.negate(b,b),S=f.attributes,A=f.indices,D=c.attributes,P=c.indices);let O=x.add(M,b,wme);S.position.values.push(C.x,C.y,C.z,C.x,C.y,C.z),S.position.values.push(O.x,O.y,O.z),S.position.values.push(O.x,O.y,O.z),S.prevPosition.values.push(o[v*3],o[v*3+1],o[v*3+2]),S.prevPosition.values.push(o[v*3+3],o[v*3+4],o[v*3+5]),S.prevPosition.values.push(C.x,C.y,C.z,C.x,C.y,C.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),x.negate(b,b),x.add(M,b,O),D.position.values.push(O.x,O.y,O.z),D.position.values.push(O.x,O.y,O.z),D.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.nextPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.nextPosition.values.push(a[w*3],a[w*3+1],a[w*3+2]),D.nextPosition.values.push(a[w*3+3],a[w*3+4],a[w*3+5]);let m=X.fromArray(s,v*2,M9),I=Math.abs(m.y);S.expandAndWidth.values.push(-1,I,1,I),S.expandAndWidth.values.push(-1,-I,1,-I),D.expandAndWidth.values.push(-1,I,1,I),D.expandAndWidth.values.push(-1,-I,1,-I);let L=x.magnitudeSquared(x.subtract(M,C,R2));if(L/=x.magnitudeSquared(x.subtract(E,C,R2)),g(l)){let R=Se.fromArray(l,v*4,L9),N=Se.fromArray(l,w*4,L9),B=F.lerp(R.x,N.x,L),V=F.lerp(R.y,N.y,L),z=F.lerp(R.z,N.z,L),U=F.lerp(R.w,N.w,L);for(d=v*4;d<v*4+2*4;++d)S.color.values.push(l[d]);for(S.color.values.push(B,V,z,U),S.color.values.push(B,V,z,U),D.color.values.push(B,V,z,U),D.color.values.push(B,V,z,U),d=w*4;d<w*4+2*4;++d)D.color.values.push(l[d])}if(g(u)){let R=X.fromArray(u,v*2,M9),N=X.fromArray(u,(h+3)*2,vme),B=F.lerp(R.x,N.x,L);for(d=v*2;d<v*2+2*2;++d)S.st.values.push(u[d]);for(S.st.values.push(B,R.y),S.st.values.push(B,N.y),D.st.values.push(B,R.y),D.st.values.push(B,N.y),d=w*2;d<w*2+2*2;++d)D.st.values.push(u[d])}p=S.position.values.length/3-4,A.push(p,p+2,p+1),A.push(p+1,p+2,p+3),p=D.position.values.length/3-4,P.push(p,p+2,p+1),P.push(p+1,p+2,p+3)}else{let b,O;for(C.y<0?(b=f.attributes,O=f.indices):(b=c.attributes,O=c.indices),b.position.values.push(C.x,C.y,C.z),b.position.values.push(C.x,C.y,C.z),b.position.values.push(E.x,E.y,E.z),b.position.values.push(E.x,E.y,E.z),d=h*3;d<h*3+4*3;++d)b.prevPosition.values.push(o[d]),b.nextPosition.values.push(a[d]);for(d=h*2;d<h*2+4*2;++d)b.expandAndWidth.values.push(s[d]),g(u)&&b.st.values.push(u[d]);if(g(l))for(d=h*4;d<h*4+4*4;++d)b.color.values.push(l[d]);p=b.position.values.length/3-4,O.push(p,p+2,p+1),O.push(p+1,p+2,p+3)}}_&&(R9(f),R9(c)),O2(e,f,c)}zl.splitLongitude=function(e){let t=e.geometry,n=t.boundingSphere;if(g(n)&&(n.center.x-n.radius>0||Ee.intersectPlane(n,si.ORIGIN_ZX_PLANE)!==vi.INTERSECTING))return e;if(t.geometryType!==O_.NONE)switch(t.geometryType){case O_.POLYLINES:Tme(e);break;case O_.TRIANGLES:D9(e);break;case O_.LINES:P9(e);break}else lme(t),t.primitiveType===sn.TRIANGLES?D9(e):t.primitiveType===sn.LINES&&P9(e);return e};var va=zl;function ME(e,t,n){e=T(e,0),t=T(t,0),n=T(n,0),this.value=new Float32Array([e,t,n])}Object.defineProperties(ME.prototype,{componentDatatype:{get:function(){return ie.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}});ME.fromCartesian3=function(e){return new ME(e.x,e.y,e.z)};ME.toValue=function(e,t){return g(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var z9=ME;function Sme(e,t,n){let r=!n,o=e.length,a;if(!r&&o>1){let s=e[0].modelMatrix;for(a=1;a<o;++a)if(!G.equals(s,e[a].modelMatrix)){r=!0;break}}if(r)for(a=0;a<o;++a)g(e[a].geometry)&&va.transformToWorldCoordinates(e[a]);else G.multiplyTransformation(t,e[0].modelMatrix,t)}function B2(e,t){let n=e.attributes,r=n.position,o=r.values.length/r.componentsPerAttribute;n.batchId=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:1,values:new Float32Array(o)});let a=n.batchId.values;for(let s=0;s<o;++s)a[s]=t}function Ame(e){let t=e.length;for(let n=0;n<t;++n){let r=e[n];g(r.geometry)?B2(r.geometry,n):g(r.westHemisphereGeometry)&&g(r.eastHemisphereGeometry)&&(B2(r.westHemisphereGeometry,n),B2(r.eastHemisphereGeometry,n))}}function bme(e){let t=e.instances,n=e.projection,r=e.elementIndexUintSupported,o=e.scene3DOnly,a=e.vertexCacheOptimize,s=e.compressVertices,u=e.modelMatrix,l,c,f,h=t.length;for(l=0;l<h;++l)if(g(t[l].geometry)){f=t[l].geometry.primitiveType;break}if(Sme(t,u,o),!o)for(l=0;l<h;++l)g(t[l].geometry)&&va.splitLongitude(t[l]);if(Ame(t),a)for(l=0;l<h;++l){let p=t[l];g(p.geometry)?(va.reorderForPostVertexCache(p.geometry),va.reorderForPreVertexCache(p.geometry)):g(p.westHemisphereGeometry)&&g(p.eastHemisphereGeometry)&&(va.reorderForPostVertexCache(p.westHemisphereGeometry),va.reorderForPreVertexCache(p.westHemisphereGeometry),va.reorderForPostVertexCache(p.eastHemisphereGeometry),va.reorderForPreVertexCache(p.eastHemisphereGeometry))}let d=va.combineInstances(t);for(h=d.length,l=0;l<h;++l){c=d[l];let p=c.attributes;if(o)for(let _ in p)p.hasOwnProperty(_)&&p[_].componentDatatype===ie.DOUBLE&&va.encodeAttribute(c,_,`${_}3DHigh`,`${_}3DLow`);else for(let _ in p)if(p.hasOwnProperty(_)&&p[_].componentDatatype===ie.DOUBLE){let y=`${_}3D`,v=`${_}2D`;va.projectTo2D(c,_,y,v,n),g(c.boundingSphere)&&_==="position"&&(c.boundingSphereCV=Ee.fromVertices(c.attributes.position2D.values)),va.encodeAttribute(c,y,`${y}High`,`${y}Low`),va.encodeAttribute(c,v,`${v}High`,`${v}Low`)}s&&va.compressVertices(c)}if(!r){let p=[];for(h=d.length,l=0;l<h;++l)c=d[l],p=p.concat(va.fitToUnsignedShortIndices(c));d=p}return d}function F2(e,t,n,r){let o,a,s,u=r.length-1;if(u>=0){let c=r[u];o=c.offset+c.count,s=c.index,a=n[s].indices.length}else o=0,s=0,a=n[s].indices.length;let l=e.length;for(let c=0;c<l;++c){let h=e[c][t];if(!g(h))continue;let d=h.indices.length;o+d>a&&(o=0,a=n[++s].indices.length),r.push({index:s,offset:o,count:d}),o+=d}}function Ime(e,t){let n=[];return F2(e,"geometry",t,n),F2(e,"westHemisphereGeometry",t,n),F2(e,"eastHemisphereGeometry",t,n),n}var Om={};Om.combineGeometry=function(e){let t,n,r=e.instances,o=r.length,a,s,u=!1;o>0&&(t=bme(e),t.length>0&&(n=va.createAttributeLocations(t[0]),e.createPickOffsets&&(a=Ime(r,t))),g(r[0].attributes)&&g(r[0].attributes.offset)&&(s=new Array(o),u=!0));let l=new Array(o),c=new Array(o);for(let f=0;f<o;++f){let h=r[f],d=h.geometry;g(d)&&(l[f]=d.boundingSphere,c[f]=d.boundingSphereCV,u&&(s[f]=h.geometry.offsetAttribute));let p=h.eastHemisphereGeometry,_=h.westHemisphereGeometry;g(p)&&g(_)&&(g(p.boundingSphere)&&g(_.boundingSphere)&&(l[f]=Ee.union(p.boundingSphere,_.boundingSphere)),g(p.boundingSphereCV)&&g(_.boundingSphereCV)&&(c[f]=Ee.union(p.boundingSphereCV,_.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:a,offsetInstanceExtend:s,boundingSpheres:l,boundingSpheresCV:c}};function Dme(e,t){let n=e.attributes;for(let r in n)if(n.hasOwnProperty(r)){let o=n[r];g(o)&&g(o.values)&&t.push(o.values.buffer)}g(e.indices)&&t.push(e.indices.buffer)}function Pme(e,t){let n=e.length;for(let r=0;r<n;++r)Dme(e[r],t)}function Mme(e){let t=1,n=e.length;for(let r=0;r<n;r++){let o=e[r];if(++t,!g(o))continue;let a=o.attributes;t+=7+2*Ee.packedLength+(g(o.indices)?o.indices.length:0);for(let s in a)if(a.hasOwnProperty(s)&&g(a[s])){let u=a[s];t+=5+u.values.length}}return t}Om.packCreateGeometryResults=function(e,t){let n=new Float64Array(Mme(e)),r=[],o={},a=e.length,s=0;n[s++]=a;for(let u=0;u<a;u++){let l=e[u],c=g(l);if(n[s++]=c?1:0,!c)continue;n[s++]=l.primitiveType,n[s++]=l.geometryType,n[s++]=T(l.offsetAttribute,-1);let f=g(l.boundingSphere)?1:0;n[s++]=f,f&&Ee.pack(l.boundingSphere,n,s),s+=Ee.packedLength;let h=g(l.boundingSphereCV)?1:0;n[s++]=h,h&&Ee.pack(l.boundingSphereCV,n,s),s+=Ee.packedLength;let d=l.attributes,p=[];for(let y in d)d.hasOwnProperty(y)&&g(d[y])&&(p.push(y),g(o[y])||(o[y]=r.length,r.push(y)));n[s++]=p.length;for(let y=0;y<p.length;y++){let v=p[y],w=d[v];n[s++]=o[v],n[s++]=w.componentDatatype,n[s++]=w.componentsPerAttribute,n[s++]=w.normalize?1:0,n[s++]=w.values.length,n.set(w.values,s),s+=w.values.length}let _=g(l.indices)?l.indices.length:0;n[s++]=_,_>0&&(n.set(l.indices,s),s+=_)}return t.push(n.buffer),{stringTable:r,packedData:n}};Om.unpackCreateGeometryResults=function(e){let t=e.stringTable,n=e.packedData,r,o=new Array(n[0]),a=0,s=1;for(;s<n.length;){if(!(n[s++]===1)){o[a++]=void 0;continue}let l=n[s++],c=n[s++],f=n[s++];f===-1&&(f=void 0);let h,d;n[s++]===1&&(h=Ee.unpack(n,s)),s+=Ee.packedLength,n[s++]===1&&(d=Ee.unpack(n,s)),s+=Ee.packedLength;let y,v,w,C=new a0,E=n[s++];for(r=0;r<E;r++){let A=t[n[s++]],D=n[s++];w=n[s++];let P=n[s++]!==0;y=n[s++],v=ie.createTypedArray(D,y);for(let M=0;M<y;M++)v[M]=n[s++];C[A]=new Ti({componentDatatype:D,componentsPerAttribute:w,normalize:P,values:v})}let S;if(y=n[s++],y>0){let A=v.length/w;for(S=Or.createTypedArray(A,y),r=0;r<y;r++)S[r]=n[s++]}o[a++]=new Ei({primitiveType:l,geometryType:c,boundingSphere:h,boundingSphereCV:d,indices:S,attributes:C,offsetAttribute:f})}return o};function Lme(e,t){let n=e.length,r=new Float64Array(1+n*19),o=0;r[o++]=n;for(let a=0;a<n;a++){let s=e[a];if(G.pack(s.modelMatrix,r,o),o+=G.packedLength,g(s.attributes)&&g(s.attributes.offset)){let u=s.attributes.offset.value;r[o]=u[0],r[o+1]=u[1],r[o+2]=u[2]}o+=3}return t.push(r.buffer),r}function Rme(e){let t=e,n=new Array(t[0]),r=0,o=1;for(;o<t.length;){let a=G.unpack(t,o),s;o+=G.packedLength,g(t[o])&&(s={offset:new z9(t[o],t[o+1],t[o+2])}),o+=3,n[r++]={modelMatrix:a,attributes:s}}return n}Om.packCombineGeometryParameters=function(e,t){let n=e.createGeometryResults,r=n.length;for(let o=0;o<r;o++)t.push(n[o].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:Lme(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof mc,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};Om.unpackCombineGeometryParameters=function(e){let t=Rme(e.packedInstances),n=e.createGeometryResults,r=n.length,o=0;for(let u=0;u<r;u++){let l=Om.unpackCreateGeometryResults(n[u]),c=l.length;for(let f=0;f<c;f++){let h=l[f],d=t[o];d.geometry=h,++o}}let a=Ge.clone(e.ellipsoid),s=e.isGeographic?new mc(a):new EC(a);return{instances:t,ellipsoid:a,projection:s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:G.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function V9(e){let t=e.length,n=1+(Ee.packedLength+1)*t,r=new Float32Array(n),o=0;r[o++]=t;for(let a=0;a<t;++a){let s=e[a];g(s)?(r[o++]=1,Ee.pack(e[a],r,o)):r[o++]=0,o+=Ee.packedLength}return r}function k9(e){let t=new Array(e[0]),n=0,r=1;for(;r<e.length;)e[r++]===1&&(t[n]=Ee.unpack(e,r)),++n,r+=Ee.packedLength;return t}Om.packCombineGeometryResults=function(e,t){g(e.geometries)&&Pme(e.geometries,t);let n=V9(e.boundingSpheres),r=V9(e.boundingSpheresCV);return t.push(n.buffer,r.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:r}};Om.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:k9(e.boundingSpheres),boundingSpheresCV:k9(e.boundingSpheresCV)}};var oD=Om;var Ome={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},qa=Object.freeze(Ome);var $c={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};$c.NUMBER_OF_SHADOW_MODES=4;$c.castShadows=function(e){return e===$c.ENABLED||e===$c.CAST_ONLY};$c.receiveShadows=function(e){return e===$c.ENABLED||e===$c.RECEIVE_ONLY};$c.fromCastReceive=function(e,t){return e&&t?$c.ENABLED:e?$c.CAST_ONLY:t?$c.RECEIVE_ONLY:$c.DISABLED};var io=Object.freeze($c);function ra(e){e=T(e,T.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._modelMatrix=new G,this.show=T(e.show,!0),this._vertexCacheOptimize=T(e.vertexCacheOptimize,!1),this._interleave=T(e.interleave,!1),this._releaseGeometryInstances=T(e.releaseGeometryInstances,!0),this._allowPicking=T(e.allowPicking,!0),this._asynchronous=T(e.asynchronous,!0),this._compressVertices=T(e.compressVertices,!0),this.cull=T(e.cull,!0),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=T(e.shadows,io.DISABLED),this._translucent=void 0,this._state=qa.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1;let t=this;this._readyPromise=new Promise((n,r)=>{t._completeLoad=(o,a,s)=>{this._error=s,this._state=a,o.afterRender.push(function(){t._ready=t._state===qa.COMPLETE||t._state===qa.FAILED,g(s)?r(s):n(t)})}}),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(ra.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},pickIds:{get:function(){return this._pickIds}}});function Nme(e){let t=e.length,n=[],r=e[0].attributes,o;for(o in r)if(r.hasOwnProperty(o)&&g(r[o])){let a=r[o],s=!0;for(let u=1;u<t;++u){let l=e[u].attributes[o];if(!g(l)||a.componentDatatype!==l.componentDatatype||a.componentsPerAttribute!==l.componentsPerAttribute||a.normalize!==l.normalize){s=!1;break}}s&&n.push(o)}return n}var Bme=new X,Fme=new x,K9=new Se;function Z9(e){let t=e.length;if(t===1)return e[0];if(t===2)return X.unpack(e,0,Bme);if(t===3)return x.unpack(e,0,Fme);if(t===4)return Se.unpack(e,0,K9)}function zme(e,t){let n=e.geometryInstances,r=Array.isArray(n)?n:[n],o=r.length;if(o===0)return;let a=Nme(r),s=a.length,u=[],l={},c={},f,d=r[0].attributes,p,_,y;for(p=0;p<s;++p)_=a[p],y=d[_],l[_]=p,u.push({functionName:`czm_batchTable_${_}`,componentDatatype:y.componentDatatype,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize});a.indexOf("distanceDisplayCondition")!==-1&&(u.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:ie.FLOAT,componentsPerAttribute:1}),c.center3DHigh=u.length-5,c.center3DLow=u.length-4,c.center2DHigh=u.length-3,c.center2DLow=u.length-2,c.radius=u.length-1),a.indexOf("offset")!==-1&&(u.push({functionName:"czm_batchTable_offset2D",componentDatatype:ie.FLOAT,componentsPerAttribute:3}),f=u.length-1),u.push({functionName:"czm_batchTable_pickColor",componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let v=u.length,w=new g9(t,u,o);for(p=0;p<o;++p){let C=r[p];d=C.attributes;for(let P=0;P<s;++P){_=a[P],y=d[_];let M=Z9(y.value),b=l[_];w.setBatchedAttribute(p,b,M)}let E={primitive:T(C.pickPrimitive,e)};g(C.id)&&(E.id=C.id);let S=t.createPickId(E);e._pickIds.push(S);let A=S.color,D=K9;D.x=K.floatToByte(A.red),D.y=K.floatToByte(A.green),D.z=K.floatToByte(A.blue),D.w=K.floatToByte(A.alpha),w.setBatchedAttribute(p,v-1,D)}e._batchTable=w,e._batchTableAttributeIndices=l,e._batchTableBoundingSphereAttributeIndices=c,e._batchTableOffsetAttribute2DIndex=f}function Vme(e){let t;return Array.isArray(e.values)?t=e.values.slice(0):t=new e.values.constructor(e.values),new Ti({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function kme(e){let t=e.attributes,n=new a0;for(let o in t)t.hasOwnProperty(o)&&g(t[o])&&(n[o]=Vme(t[o]));let r;if(g(e.indices)){let o=e.indices;Array.isArray(o)?r=o.slice(0):r=new o.constructor(o)}return new Ei({attributes:n,indices:r,primitiveType:e.primitiveType,boundingSphere:Ee.clone(e.boundingSphere)})}function Gme(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:G.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var Ume=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;ra._modifyShaderPosition=function(e,t,n){let r,o="",a="",s="";for(;(r=Ume.exec(t))!==null;){let u=r[1],l=`vec4 czm_compute${u[0].toUpperCase()}${u.substr(1)}()`;l!=="vec4 czm_computePosition()"&&(o+=`${l};
`),g(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),o+=`uniform mat4 u_modifiedModelView;
`,a+=`attribute vec4 position;
`,s+=`${l}
{
    return u_modifiedModelView * position;
}

`,t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?s+=`${l}
{
    return czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow);
}

`:(a+=`attribute vec3 ${u}2DHigh;
attribute vec3 ${u}2DLow;
`,s+=`${l}
{
    vec4 p;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(${u}2DHigh.zxy, ${u}2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(${u}2DHigh.zxy, ${u}2DLow.zxy),
                czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow),
                czm_morphTime);
    }
    return p;
}

`)}return[o,a,t,s].join(`
`)};ra._appendShowToShader=function(e,t){return g(e._batchTableAttributeIndices.show)?`${Et.replaceMain(t,"czm_non_show_main")}
void main() 
{ 
    czm_non_show_main(); 
    gl_Position *= czm_batchTable_show(batchId); 
}`:t};ra._updateColorAttribute=function(e,t,n){if(!g(e._batchTableAttributeIndices.color)&&!g(e._batchTableAttributeIndices.depthFailColor)||t.search(/attribute\s+vec4\s+color;/g)===-1)return t;let r=t;return r=r.replace(/attribute\s+vec4\s+color;/g,""),n?r=r.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):r=r.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),r};function G9(e){return`${Et.replaceMain(e,"czm_non_pick_main")}
varying vec4 v_pickColor; 
void main() 
{ 
    czm_non_pick_main(); 
    v_pickColor = czm_batchTable_pickColor(batchId); 
}`}function U9(e){return`varying vec4 v_pickColor;
${e}`}ra._updatePickColorAttribute=function(e){let t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t};ra._appendOffsetToShader=function(e,t){if(!g(e._batchTableAttributeIndices.offset))return t;let n=`attribute float batchId;
`;n+="attribute float applyOffset;";let r=t.replace(/attribute\s+float\s+batchId;/g,n),o=`vec4 $1 = czm_computePosition();
`;return o+=`    if (czm_sceneMode == czm_sceneMode3D)
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",o+=`    }
`,o+=`    else
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",o+=`    }
`,r=r.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,o),r};ra._appendDistanceDisplayConditionToShader=function(e,t,n){if(!g(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let r=Et.replaceMain(t,"czm_non_distanceDisplayCondition_main"),o=`void main() 
{ 
    czm_non_distanceDisplayCondition_main(); 
    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);
    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);
    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);
    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);
`;return n?o+=`    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
`:o+=`    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);
    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);
    vec4 centerRTE;
    if (czm_morphTime == 1.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);
    }
    else
    {
        centerRTE = czm_columbusViewMorph(
                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),
                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),
                czm_morphTime);
    }
`,o+=`    float radiusSq = boundingSphereRadius * boundingSphereRadius; 
    float distanceSq; 
    if (czm_sceneMode == czm_sceneMode2D) 
    { 
        distanceSq = czm_eyeHeight2D.y - radiusSq; 
    } 
    else 
    { 
        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; 
    } 
    distanceSq = max(distanceSq, 0.0); 
    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; 
    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; 
    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; 
    gl_Position *= show; 
}`,`${r}
${o}`};function H9(e,t){if(!e.compressVertices)return t;let n=t.search(/attribute\s+vec3\s+normal;/g)!==-1,r=t.search(/attribute\s+vec2\s+st;/g)!==-1;if(!n&&!r)return t;let o=t.search(/attribute\s+vec3\s+tangent;/g)!==-1,a=t.search(/attribute\s+vec3\s+bitangent;/g)!==-1,s=r&&n?2:1;s+=o||a?1:0;let u=s>1?`vec${s}`:"float",l="compressedAttributes",c=`attribute ${u} ${l};`,f="",h="";r&&(f+=`vec2 st;
`,h+=`    st = czm_decompressTextureCoordinates(${s>1?`${l}.x`:l});
`),n&&o&&a?(f+=`vec3 normal;
vec3 tangent;
vec3 bitangent;
`,h+=`    czm_octDecode(${l}.${r?"yz":"xy"}, normal, tangent, bitangent);
`):(n&&(f+=`vec3 normal;
`,h+=`    normal = czm_octDecode(${l}${s>1?`.${r?"y":"x"}`:""});
`),o&&(f+=`vec3 tangent;
`,h+=`    tangent = czm_octDecode(${l}.${r&&n?"z":"y"});
`),a&&(f+=`vec3 bitangent;
`,h+=`    bitangent = czm_octDecode(${l}.${r&&n?"z":"y"});
`));let d=t;d=d.replace(/attribute\s+vec3\s+normal;/g,""),d=d.replace(/attribute\s+vec2\s+st;/g,""),d=d.replace(/attribute\s+vec3\s+tangent;/g,""),d=d.replace(/attribute\s+vec3\s+bitangent;/g,""),d=Et.replaceMain(d,"czm_non_compressed_main");let p=`void main() 
{ 
${h}    czm_non_compressed_main(); 
}`;return[c,f,d,p].join(`
`)}function Hme(e){let t=Et.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
    gl_Position = czm_depthClamp(gl_Position);}
`,t}function qme(e){let t=Et.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
#if defined(GL_EXT_frag_depth)
    #if defined(LOG_DEPTH)
        czm_writeLogDepth();
    #else
        czm_writeDepthClamp();
    #endif
#endif
}
`,t=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
${t}`,t}function q9(e,t){let n=e.vertexAttributes}function Wme(e,t){return function(){return e[t]}}var z2=Math.max(ea.hardwareConcurrency-1,1),aD,Yme=new jc("combineGeometry");function Xme(e,t){let n,r,o,a,s=e._instanceIds;if(e._state===qa.READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let u=e._numberOfInstances=n.length,l=[],c=[];for(o=0;o<u;++o)r=n[o].geometry,s.push(n[o].id),c.push({moduleName:r._workerName,geometry:r});if(!g(aD))for(aD=new Array(z2),o=0;o<z2;o++)aD[o]=new jc("createGeometry");let f;for(c=d9(c,z2),o=0;o<c.length;o++){let h=0,d=c[o],p=d.length;for(a=0;a<p;++a)f=d[a],r=f.geometry,g(r.constructor.pack)&&(f.offset=h,h+=T(r.constructor.packedLength,r.packedLength));let _;if(h>0){let y=new Float64Array(h);for(_=[y.buffer],a=0;a<p;++a)f=d[a],r=f.geometry,g(r.constructor.pack)&&(r.constructor.pack(r,y,f.offset),f.geometry=y)}l.push(aD[o].scheduleTask({subTasks:c[o]},_))}e._state=qa.CREATING,Promise.all(l).then(function(h){e._createGeometryResults=h,e._state=qa.CREATED}).catch(function(h){RE(e,t,qa.FAILED,h)})}else if(e._state===qa.CREATED){let u=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let l=t.scene3DOnly,c=t.mapProjection,f=Yme.scheduleTask(oD.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:c.ellipsoid,projection:c,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:l,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},u),u);e._createGeometryResults=void 0,e._state=qa.COMBINING,Promise.resolve(f).then(function(h){let d=oD.unpackCombineGeometryResults(h);e._geometries=d.geometries,e._attributeLocations=d.attributeLocations,e.modelMatrix=G.clone(d.modelMatrix,e.modelMatrix),e._pickOffsets=d.pickOffsets,e._offsetInstanceExtend=d.offsetInstanceExtend,e._instanceBoundingSpheres=d.boundingSpheres,e._instanceBoundingSpheresCV=d.boundingSpheresCV,g(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=qa.COMBINED):RE(e,t,qa.FAILED,void 0)}).catch(function(h){RE(e,t,qa.FAILED,h)})}}function jme(e,t){let n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],r=e._numberOfInstances=n.length,o=new Array(r),a=e._instanceIds,s,u,l=0;for(u=0;u<r;u++){s=n[u];let d=s.geometry,p;g(d.attributes)&&g(d.primitiveType)?p=kme(d):p=d.constructor.createGeometry(d),o[l++]=Gme(s,p),a.push(s.id)}o.length=l;let c=t.scene3DOnly,f=t.mapProjection,h=oD.combineGeometry({instances:o,ellipsoid:f.ellipsoid,projection:f,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:c,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=h.geometries,e._attributeLocations=h.attributeLocations,e.modelMatrix=G.clone(h.modelMatrix,e.modelMatrix),e._pickOffsets=h.pickOffsets,e._offsetInstanceExtend=h.offsetInstanceExtend,e._instanceBoundingSpheres=h.boundingSpheres,e._instanceBoundingSpheresCV=h.boundingSpheresCV,g(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=qa.COMBINED):RE(e,t,qa.FAILED,void 0)}function Kme(e,t){let n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!g(n)){e._recomputeBoundingSpheres=!1;return}let r,o=e._offsetInstanceExtend,a=e._instanceBoundingSpheres,s=a.length,u=e._tempBoundingSpheres;if(!g(u)){for(u=new Array(s),r=0;r<s;r++)u[r]=new Ee;e._tempBoundingSpheres=u}for(r=0;r<s;++r){let y=u[r],v=e._batchTable.getBatchedAttribute(r,n,new x);y=a[r].clone(y),eW(y,v,o[r])}let l=[],c=[],f=[];for(r=0;r<s;++r){let y=u[r];y.center.x-y.radius>0||Ee.intersectPlane(y,si.ORIGIN_ZX_PLANE)!==vi.INTERSECTING?l.push(y):(c.push(y),f.push(y))}let h=l[0],d=f[0],p=c[0];for(r=1;r<l.length;r++)h=Ee.union(h,l[r]);for(r=1;r<f.length;r++)d=Ee.union(d,f[r]);for(r=1;r<c.length;r++)p=Ee.union(p,c[r]);let _=[];for(g(h)&&_.push(h),g(d)&&_.push(d),g(p)&&_.push(p),r=0;r<_.length;r++){let y=_[r].clone(e._boundingSpheres[r]);e._boundingSpheres[r]=y,e._boundingSphereCV[r]=Ee.projectTo2D(y,t.mapProjection,e._boundingSphereCV[r])}ra._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}var W9=new ti,Q9=new le,J9=new x,$9=new Ee;function Zme(e,t){if(!g(e._batchTableAttributeIndices.distanceDisplayCondition)||e._batchTableBoundingSpheresUpdated)return;let r=e._batchTableBoundingSphereAttributeIndices,o=r.center3DHigh,a=r.center3DLow,s=r.center2DHigh,u=r.center2DLow,l=r.radius,c=t.mapProjection,f=c.ellipsoid,h=e._batchTable,d=e._instanceBoundingSpheres,p=d.length;for(let _=0;_<p;++_){let y=d[_];if(!g(y))continue;let v=e.modelMatrix;g(v)&&(y=Ee.transform(y,v,$9));let w=y.center,C=y.radius,E=ti.fromCartesian(w,W9);if(h.setBatchedAttribute(_,o,E.high),h.setBatchedAttribute(_,a,E.low),!t.scene3DOnly){let S=f.cartesianToCartographic(w,Q9),A=c.project(S,J9);E=ti.fromCartesian(A,W9),h.setBatchedAttribute(_,s,E.high),h.setBatchedAttribute(_,u,E.low)}h.setBatchedAttribute(_,l,C)}e._batchTableBoundingSpheresUpdated=!0}var V2=new x,Qme=new x;function Y9(e,t){if(!g(e._batchTableAttributeIndices.offset)||e._batchTableOffsetsUpdated||t.scene3DOnly)return;let r=e._batchTableOffsetAttribute2DIndex,o=t.mapProjection,a=o.ellipsoid,s=e._batchTable,u=e._instanceBoundingSpheres,l=u.length;for(let c=0;c<l;++c){let f=u[c];if(!g(f))continue;let h=s.getBatchedAttribute(c,e._batchTableAttributeIndices.offset);if(x.equals(h,x.ZERO)){s.setBatchedAttribute(c,r,x.ZERO);continue}let d=e.modelMatrix;g(d)&&(f=Ee.transform(f,d,$9));let p=f.center;p=a.scaleToGeodeticSurface(p,Qme);let _=a.cartesianToCartographic(p,Q9),y=o.project(_,J9),v=x.add(h,p,V2);_=a.cartesianToCartographic(v,_);let w=o.project(_,V2),C=x.subtract(w,y,V2),E=C.x;C.x=C.z,C.z=C.y,C.y=E,s.setBatchedAttribute(c,r,C)}e._batchTableOffsetsUpdated=!0}function Jme(e,t){let n=e._attributeLocations,r=e._geometries,o=t.scene3DOnly,a=t.context,s=[],u=r.length;for(let l=0;l<u;++l){let c=r[l];if(s.push($h.fromGeometry({context:a,geometry:c,attributeLocations:n,bufferUsage:We.STATIC_DRAW,interleave:e._interleave})),g(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,c);else if(e._boundingSpheres.push(Ee.clone(c.boundingSphere)),e._boundingSphereWC.push(new Ee),!o){let f=c.boundingSphereCV.center,h=f.x,d=f.y,p=f.z;f.x=p,f.y=h,f.z=d,e._boundingSphereCV.push(Ee.clone(c.boundingSphereCV)),e._boundingSphere2D.push(new Ee),e._boundingSphereMorph.push(new Ee)}}e._va=s,e._primitiveType=r[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,RE(e,t,qa.COMPLETE,void 0)}function $me(e,t,n,r){let o=n.getRenderState(),a;r?(a=Ht(o,!1),a.cull={enabled:!0,face:sd.BACK},e._frontFaceRS=fn.fromCache(a),a.cull.face=sd.FRONT,e._backFaceRS=fn.fromCache(a)):(e._frontFaceRS=fn.fromCache(o),e._backFaceRS=e._frontFaceRS),a=Ht(o,!1),g(e._depthFailAppearance)&&(a.depthTest.enabled=!1),g(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),a=Ht(o,!1),a.depthTest.func=s0.GREATER,r?(a.cull={enabled:!0,face:sd.BACK},e._frontFaceDepthFailRS=fn.fromCache(a),a.cull.face=sd.FRONT,e._backFaceDepthFailRS=fn.fromCache(a)):(e._frontFaceDepthFailRS=fn.fromCache(a),e._backFaceDepthFailRS=e._frontFaceRS))}function ege(e,t,n){let r=t.context,o=e._attributeLocations,a=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);a=ra._appendOffsetToShader(e,a),a=ra._appendShowToShader(e,a),a=ra._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=G9(a),a=ra._updateColorAttribute(e,a,!1),a=H9(e,a),a=ra._modifyShaderPosition(e,a,t.scene3DOnly);let s=n.getFragmentShaderSource();s=U9(s),e._sp=wi.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:o}),q9(e._sp,o),g(e._depthFailAppearance)&&(a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),a=ra._appendShowToShader(e,a),a=ra._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=G9(a),a=ra._updateColorAttribute(e,a,!0),a=H9(e,a),a=ra._modifyShaderPosition(e,a,t.scene3DOnly),a=Hme(a),s=e._depthFailAppearance.getFragmentShaderSource(),s=U9(s),s=qme(s),e._spDepthFail=wi.replaceCache({context:r,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:o}),q9(e._spDepthFail,o))}var LE=new G,X9=new x;function j9(e,t,n,r){let o=g(n)?n._uniforms:void 0,a={},s=t.uniforms;if(g(s))for(let l in s)s.hasOwnProperty(l)&&(a[l]=Wme(s,l));let u=ji(a,o);return u=e._batchTable.getUniformMapCallback()(u),g(e.rtcCenter)&&(u.u_modifiedModelView=function(){let l=r.context.uniformState.view;return G.multiply(l,e._modelMatrix,LE),G.multiplyByPoint(LE,e.rtcCenter,X9),G.setTranslation(LE,X9,LE),LE}),u}function tge(e,t,n,r,o,a,s,u){let l=j9(e,t,n,u),c;g(e._depthFailAppearance)&&(c=j9(e,e._depthFailAppearance,e._depthFailAppearance.material,u));let f=r?en.TRANSLUCENT:en.OPAQUE,h=o?2:1;h*=g(e._depthFailAppearance)?2:1,a.length=e._va.length*h;let d=a.length,p=0;for(let _=0;_<d;++_){let y;o&&(y=a[_],g(y)||(y=a[_]=new $t({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._backFaceRS,y.shaderProgram=e._sp,y.uniformMap=l,y.pass=f,++_),y=a[_],g(y)||(y=a[_]=new $t({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._frontFaceRS,y.shaderProgram=e._sp,y.uniformMap=l,y.pass=f,g(e._depthFailAppearance)&&(o&&(++_,y=a[_],g(y)||(y=a[_]=new $t({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._backFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=c,y.pass=f),++_,y=a[_],g(y)||(y=a[_]=new $t({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._frontFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=c,y.pass=f),++p}}ra._updateBoundingVolumes=function(e,t,n,r){let o,a,s;if(r||!G.equals(n,e._modelMatrix))for(G.clone(n,e._modelMatrix),a=e._boundingSpheres.length,o=0;o<a;++o)s=e._boundingSpheres[o],g(s)&&(e._boundingSphereWC[o]=Ee.transform(s,n,e._boundingSphereWC[o]),t.scene3DOnly||(e._boundingSphere2D[o]=Ee.clone(e._boundingSphereCV[o],e._boundingSphere2D[o]),e._boundingSphere2D[o].center.x=0,e._boundingSphereMorph[o]=Ee.union(e._boundingSphereWC[o],e._boundingSphereCV[o])));let u=e.appearance.pixelSize;if(g(u))for(a=e._boundingSpheres.length,o=0;o<a;++o){s=e._boundingSpheres[o];let l=e._boundingSphereWC[o],f=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*u;l.radius=s.radius+f}};function nge(e,t,n,r,o,a,s,u){ra._updateBoundingVolumes(e,t,o);let l;t.mode===Ne.SCENE3D?l=e._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?l=e._boundingSphereCV:t.mode===Ne.SCENE2D&&g(e._boundingSphere2D)?l=e._boundingSphere2D:g(e._boundingSphereMorph)&&(l=e._boundingSphereMorph);let c=t.commandList,f=t.passes;if(f.render||f.pick){let h=e.allowPicking,d=io.castShadows(e.shadows),p=io.receiveShadows(e.shadows),_=n.length,y=u?2:1;y*=g(e._depthFailAppearance)?2:1;for(let v=0;v<_;++v){let w=Math.floor(v/y),C=n[v];C.modelMatrix=o,C.boundingVolume=l[w],C.cull=a,C.debugShowBoundingVolume=s,C.castShadows=d,C.receiveShadows=p,h?C.pickId="v_pickColor":C.pickId=void 0,c.push(C)}}}ra.prototype.update=function(e){if(!g(this.geometryInstances)&&this._va.length===0||g(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&this.geometryInstances.length===0||!g(this.appearance)||e.mode!==Ne.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(g(this._error))throw this._error;if(this._state===qa.FAILED)return;let t=e.context;if(g(this._batchTable)||zme(this,t),this._batchTable.attributes.length>0){if(Jt.maximumVertexTextureImageUnits===0)throw new at("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==qa.COMPLETE&&this._state!==qa.COMBINED&&(this.asynchronous?Xme(this,e):jme(this,e)),this._state===qa.COMBINED&&(Zme(this,e),Y9(this,e),Jme(this,e)),!this.show||this._state!==qa.COMPLETE)return;this._batchTableOffsetsUpdated||Y9(this,e),this._recomputeBoundingSpheres&&Kme(this,e);let n=this.appearance,r=n.material,o=!1,a=!1;this._appearance!==n?(this._appearance=n,this._material=r,o=!0,a=!0):this._material!==r&&(this._material=r,a=!0);let s=this.depthFailAppearance,u=g(s)?s.material:void 0;this._depthFailAppearance!==s?(this._depthFailAppearance=s,this._depthFailMaterial=u,o=!0,a=!0):this._depthFailMaterial!==u&&(this._depthFailMaterial=u,a=!0);let l=this._appearance.isTranslucent();this._translucent!==l&&(this._translucent=l,o=!0),g(this._material)&&this._material.update(t);let c=n.closed&&l;o&&T(this._createRenderStatesFunction,$me)(this,t,n,c),a&&T(this._createShaderProgramFunction,ege)(this,e,n),(o||a)&&T(this._createCommandsFunction,tge)(this,n,r,l,c,this._colorCommands,this._pickCommands,e),T(this._updateAndQueueCommandsFunction,nge)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,c)};var rge=new Ee,ige=new Ee;function eW(e,t,n){if(n===T2.TOP){let r=Ee.clone(e,rge),o=Ee.clone(e,ige);o.center=x.add(o.center,t,o.center),e=Ee.union(r,o,e)}else n===T2.ALL&&(e.center=x.add(e.center,t,e.center));return e}function oge(e,t,n){return function(){let r=e.getBatchedAttribute(t,n),o=e.attributes[n],a=o.componentsPerAttribute,s=ie.createTypedArray(o.componentDatatype,a);return g(r.constructor.pack)?r.constructor.pack(r,s,0):s[0]=r,s}}function age(e,t,n,r,o){return function(a){let s=Z9(a);e.setBatchedAttribute(t,n,s),o==="offset"&&(r._recomputeBoundingSpheres=!0,r._batchTableOffsetsUpdated=!1)}}var sge=new x;function uge(e,t,n){t.boundingSphere={get:function(){let r=e._instanceBoundingSpheres[n];if(g(r)){r=r.clone();let o=e.modelMatrix,a=t.offset;g(a)&&eW(r,x.fromArray(a.get(),0,sge),e._offsetInstanceExtend[n]),g(o)&&(r=Ee.transform(r,o))}return r}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function lge(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}ra.prototype.getGeometryInstanceAttributes=function(e){let t=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,o=r.length;for(let c=0;c<o;++c){let f=(n+c)%o;if(e===r[f]){t=f;break}}if(t===-1)return;let a=this._perInstanceAttributeCache[t];if(g(a))return a;let s=this._batchTable,u=this._batchTableAttributeIndices;a={};let l={};for(let c in u)if(u.hasOwnProperty(c)){let f=u[c];l[c]={get:oge(s,t,f),set:age(s,t,f,this,c)}}return uge(this,l,t),lge(this,l,t),Object.defineProperties(a,l),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=a,a};ra.prototype.isDestroyed=function(){return!1};ra.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;let r=this._pickIds;for(e=r.length,t=0;t<e;++t)r[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,st(this)};function RE(e,t,n,r){e._completeLoad(t,n,r)}var $s=ra;var cge={NEVER:k.NEVER,LESS:k.LESS,EQUAL:k.EQUAL,LESS_OR_EQUAL:k.LEQUAL,GREATER:k.GREATER,NOT_EQUAL:k.NOTEQUAL,GREATER_OR_EQUAL:k.GEQUAL,ALWAYS:k.ALWAYS},sl=Object.freeze(cge);var fge={ZERO:k.ZERO,KEEP:k.KEEP,REPLACE:k.REPLACE,INCREMENT:k.INCR,DECREMENT:k.DECR,INVERT:k.INVERT,INCREMENT_WRAP:k.INCR_WRAP,DECREMENT_WRAP:k.DECR_WRAP},Zr=Object.freeze(fge);var sD={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15};sD.setCesium3DTileBit=function(){return{enabled:!0,frontFunction:sl.ALWAYS,frontOperation:{fail:Zr.KEEP,zFail:Zr.KEEP,zPass:Zr.REPLACE},backFunction:sl.ALWAYS,backOperation:{fail:Zr.KEEP,zFail:Zr.KEEP,zPass:Zr.REPLACE},reference:sD.CESIUM_3D_TILE_MASK,mask:sD.CESIUM_3D_TILE_MASK}};var oo=Object.freeze(sD);function Nm(e){e=T(e,T.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;let t=e.appearance;g(t)||(t=new h9),this.appearance=t,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,Ua.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1;let n=this;this._readyPromise=new Promise((r,o)=>{n._completeLoad=()=>{this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let a=this._error;g(a)?o(a):r(this)}}),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=tW(!1),this._renderState3DTiles=tW(!0),this._renderStateMorph=fn.fromCache({cull:{enabled:!0,face:sd.FRONT},depthTest:{enabled:!0},blending:ka.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1})}Object.defineProperties(Nm.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}});Nm.initializeTerrainHeights=function(){return Zc.initialize()};function hge(e,t,n){let r=t.context,o=e._primitive,a=o._attributeLocations,s=o._batchTable.getVertexShaderCallback()(Fq);s=$s._appendShowToShader(o,s),s=$s._appendDistanceDisplayConditionToShader(o,s),s=$s._modifyShaderPosition(e,s,t.scene3DOnly);let u=o._batchTable.getVertexShaderCallback()(Bq);u=$s._appendShowToShader(o,u),u=$s._appendDistanceDisplayConditionToShader(o,u),u=$s._modifyShaderPosition(e,u,t.scene3DOnly);let l=o._batchTable.getVertexShaderCallback()(Oq),c=[`GLOBE_MINIMUM_ALTITUDE ${t.mapProjection.ellipsoid.minimumRadius.toFixed(1)}`],f="",h="";g(n.material)?(h=g(n.material)?n.material.shaderSource:"",h.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&c.push("ANGLE_VARYING"),h.search(/varying\s+float\s+v_width;/g)!==-1&&c.push("WIDTH_VARYING")):f="PER_INSTANCE_COLOR",c.push(f);let d=e.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",f]:[f],p=new Et({defines:c,sources:[s]}),_=new Et({defines:d,sources:[h,l]});e._sp=wi.replaceCache({context:r,shaderProgram:o._sp,vertexShaderSource:p,fragmentShaderSource:_,attributeLocations:a});let y=r.shaderCache.getDerivedShaderProgram(e._sp,"2dColor");if(!g(y)){let w=new Et({defines:c.concat(["COLUMBUS_VIEW_2D"]),sources:[s]});y=r.shaderCache.createDerivedShaderProgram(e._sp,"2dColor",{context:r,shaderProgram:e._sp2D,vertexShaderSource:w,fragmentShaderSource:_,attributeLocations:a})}e._sp2D=y;let v=r.shaderCache.getDerivedShaderProgram(e._sp,"MorphColor");if(!g(v)){let w=new Et({defines:c.concat([`MAX_TERRAIN_HEIGHT ${Zc._defaultMaxTerrainHeight.toFixed(1)}`]),sources:[u]});l=o._batchTable.getVertexShaderCallback()(Nq);let C=new Et({defines:d,sources:[h,l]});v=r.shaderCache.createDerivedShaderProgram(e._sp,"MorphColor",{context:r,shaderProgram:e._spMorph,vertexShaderSource:w,fragmentShaderSource:C,attributeLocations:a})}e._spMorph=v}function tW(e){return fn.fromCache({cull:{enabled:!0},blending:ka.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:sl.EQUAL,frontOperation:{fail:Zr.KEEP,zFail:Zr.KEEP,zPass:Zr.KEEP},backFunction:sl.EQUAL,backOperation:{fail:Zr.KEEP,zFail:Zr.KEEP,zPass:Zr.KEEP},reference:oo.CESIUM_3D_TILE_MASK,mask:oo.CESIUM_3D_TILE_MASK}})}function dge(e,t,n,r,o,a){let s=e._primitive,u=s._va.length;o.length=u,a.length=u;let c=t instanceof x2?{}:n._uniforms,f=s._batchTable.getUniformMapCallback()(c);for(let h=0;h<u;h++){let d=s._va[h],p=o[h];g(p)||(p=o[h]=new $t({owner:e,primitiveType:s._primitiveType})),p.vertexArray=d,p.renderState=e._renderState,p.shaderProgram=e._sp,p.uniformMap=f,p.pass=en.TERRAIN_CLASSIFICATION,p.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";let _=$t.shallowClone(p,p.derivedCommands.tileset);_.renderState=e._renderState3DTiles,_.pass=en.CESIUM_3D_TILE_CLASSIFICATION,p.derivedCommands.tileset=_;let y=$t.shallowClone(p,p.derivedCommands.color2D);y.shaderProgram=e._sp2D,p.derivedCommands.color2D=y;let v=$t.shallowClone(_,_.derivedCommands.color2D);v.shaderProgram=e._sp2D,_.derivedCommands.color2D=v;let w=$t.shallowClone(p,p.derivedCommands.colorMorph);w.renderState=e._renderStateMorph,w.shaderProgram=e._spMorph,w.pickId="czm_batchTable_pickColor(v_batchId)",p.derivedCommands.colorMorph=w}}function nW(e,t,n,r,o,a,s){n.mode===Ne.MORPHING?t=t.derivedCommands.colorMorph:n.mode!==Ne.SCENE3D&&(t=t.derivedCommands.color2D),t.modelMatrix=r,t.boundingVolume=a,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function pge(e,t,n,r,o,a,s){let u=e._primitive;$s._updateBoundingVolumes(u,t,o);let l;t.mode===Ne.SCENE3D?l=u._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?l=u._boundingSphereCV:t.mode===Ne.SCENE2D&&g(u._boundingSphere2D)?l=u._boundingSphere2D:g(u._boundingSphereMorph)&&(l=u._boundingSphereMorph);let c=t.mode===Ne.MORPHING,f=e.classificationType,h=f!==Ua.CESIUM_3D_TILE,d=f!==Ua.TERRAIN&&!c,p,_=t.passes;if(_.render||_.pick&&u.allowPicking){let y=n.length;for(let v=0;v<y;++v){let w=l[v];h&&(p=n[v],nW(e,p,t,o,a,w,s)),d&&(p=n[v].derivedCommands.tileset,nW(e,p,t,o,a,w,s))}}}Nm.prototype.update=function(e){if(!g(this._primitive)&&!g(this.geometryInstances))return;if(!Zc.initialized){Nm.initializeTerrainHeights();return}let t,n=this,r=this._primitiveOptions;if(!g(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length,s=new Array(a),u;for(t=0;t<a;++t)if(u=o[t].attributes,!g(u)||!g(u.color)){this._hasPerInstanceColors=!1;break}for(t=0;t<a;++t){let l=o[t];u={};let c=l.attributes;for(let f in c)c.hasOwnProperty(f)&&(u[f]=c[f]);g(u.width)||(u.width=new Qc({componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:1,value:[l.geometry.width]})),l.geometry._scene3DOnly=e.scene3DOnly,Rq.setProjectionAndEllipsoid(l.geometry,e.mapProjection),s[t]=new U_({geometry:l.geometry,attributes:u,id:l.id,pickPrimitive:n})}r.geometryInstances=s,r.appearance=this.appearance,r._createShaderProgramFunction=function(l,c,f){hge(n,c,f)},r._createCommandsFunction=function(l,c,f,h,d,p,_){dge(n,c,f,h,p,_)},r._updateAndQueueCommandsFunction=function(l,c,f,h,d,p,_,y){pge(n,c,f,h,d,p,_)},this._primitive=new $s(r),this._primitive.readyPromise.then(this._completeLoad)}if(this.appearance instanceof x2&&!this._hasPerInstanceColors)throw new Le("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)};Nm.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};Nm.isSupported=function(e){return e.frameState.context.depthTexture};Nm.prototype.isDestroyed=function(){return!1};Nm.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,st(this)};var rW=Nm;function Vl(e,t,n){this.minimum=x.clone(T(e,x.ZERO)),this.maximum=x.clone(T(t,x.ZERO)),g(n)?n=x.clone(n):n=x.midpoint(this.minimum,this.maximum,new x),this.center=n}Vl.fromCorners=function(e,t,n){return g(n)||(n=new Vl),n.minimum=x.clone(e,n.minimum),n.maximum=x.clone(t,n.maximum),n.center=x.midpoint(e,t,n.center),n};Vl.fromPoints=function(e,t){if(g(t)||(t=new Vl),!g(e)||e.length===0)return t.minimum=x.clone(x.ZERO,t.minimum),t.maximum=x.clone(x.ZERO,t.maximum),t.center=x.clone(x.ZERO,t.center),t;let n=e[0].x,r=e[0].y,o=e[0].z,a=e[0].x,s=e[0].y,u=e[0].z,l=e.length;for(let h=1;h<l;h++){let d=e[h],p=d.x,_=d.y,y=d.z;n=Math.min(p,n),a=Math.max(p,a),r=Math.min(_,r),s=Math.max(_,s),o=Math.min(y,o),u=Math.max(y,u)}let c=t.minimum;c.x=n,c.y=r,c.z=o;let f=t.maximum;return f.x=a,f.y=s,f.z=u,t.center=x.midpoint(c,f,t.center),t};Vl.clone=function(e,t){if(!!g(e))return g(t)?(t.minimum=x.clone(e.minimum,t.minimum),t.maximum=x.clone(e.maximum,t.maximum),t.center=x.clone(e.center,t.center),t):new Vl(e.minimum,e.maximum,e.center)};Vl.equals=function(e,t){return e===t||g(e)&&g(t)&&x.equals(e.center,t.center)&&x.equals(e.minimum,t.minimum)&&x.equals(e.maximum,t.maximum)};var uD=new x;Vl.intersectPlane=function(e,t){uD=x.subtract(e.maximum,e.minimum,uD);let n=x.multiplyByScalar(uD,.5,uD),r=t.normal,o=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),a=x.dot(e.center,r)+t.distance;return a-o>0?vi.INSIDE:a+o<0?vi.OUTSIDE:vi.INTERSECTING};Vl.prototype.clone=function(e){return Vl.clone(this,e)};Vl.prototype.intersectPlane=function(e){return Vl.intersectPlane(this,e)};Vl.prototype.equals=function(e){return Vl.equals(this,e)};var k2=Vl;var G2=new Se;function dp(e,t){t=T(t,Ge.WGS84),e=t.scaleToGeodeticSurface(e);let n=Cn.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=x.fromCartesian4(G.getColumn(n,0,G2)),this._yAxis=x.fromCartesian4(G.getColumn(n,1,G2));let r=x.fromCartesian4(G.getColumn(n,2,G2));this._plane=si.fromPointNormal(e,r)}Object.defineProperties(dp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var mge=new k2;dp.fromPoints=function(e,t){let n=k2.fromPoints(e,mge);return new dp(n.center,t)};var iW=new H_,lD=new x;dp.prototype.projectPointOntoPlane=function(e,t){let n=iW;n.origin=e,x.normalize(e,n.direction);let r=Jc.rayPlane(n,this._plane,lD);if(g(r)||(x.negate(n.direction,n.direction),r=Jc.rayPlane(n,this._plane,lD)),g(r)){let o=x.subtract(r,this._origin,r),a=x.dot(this._xAxis,o),s=x.dot(this._yAxis,o);return g(t)?(t.x=a,t.y=s,t):new X(a,s)}};dp.prototype.projectPointsOntoPlane=function(e,t){g(t)||(t=[]);let n=0,r=e.length;for(let o=0;o<r;o++){let a=this.projectPointOntoPlane(e[o],t[n]);g(a)&&(t[n]=a,n++)}return t.length=n,t};dp.prototype.projectPointToNearestOnPlane=function(e,t){g(t)||(t=new X);let n=iW;n.origin=e,x.clone(this._plane.normal,n.direction);let r=Jc.rayPlane(n,this._plane,lD);g(r)||(x.negate(n.direction,n.direction),r=Jc.rayPlane(n,this._plane,lD));let o=x.subtract(r,this._origin,r),a=x.dot(this._xAxis,o),s=x.dot(this._yAxis,o);return t.x=a,t.y=s,t};dp.prototype.projectPointsToNearestOnPlane=function(e,t){g(t)||(t=[]);let n=e.length;t.length=n;for(let r=0;r<n;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};var gge=new x;dp.prototype.projectPointOntoEllipsoid=function(e,t){g(t)||(t=new x);let n=this._ellipsoid,r=this._origin,o=this._xAxis,a=this._yAxis,s=gge;return x.multiplyByScalar(o,e.x,s),t=x.add(r,s,t),x.multiplyByScalar(a,e.y,s),x.add(t,s,t),n.scaleToGeocentricSurface(t,t),t};dp.prototype.projectPointsOntoEllipsoid=function(e,t){let n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.projectPointOntoEllipsoid(e[r],t[r]);return t};var l0=dp;function Qr(e,t){this.center=x.clone(T(e,x.ZERO)),this.halfAxes=te.clone(T(t,te.ZERO))}Qr.packedLength=x.packedLength+te.packedLength;Qr.pack=function(e,t,n){return n=T(n,0),x.pack(e.center,t,n),te.pack(e.halfAxes,t,n+x.packedLength),t};Qr.unpack=function(e,t,n){return t=T(t,0),g(n)||(n=new Qr),x.unpack(e,t,n.center),te.unpack(e,t+x.packedLength,n.halfAxes),n};var _ge=new x,yge=new x,vge=new x,Cge=new x,xge=new x,wge=new x,Ege=new te,Tge={unitary:new te,diagonal:new te};Qr.fromPoints=function(e,t){if(g(t)||(t=new Qr),!g(e)||e.length===0)return t.halfAxes=te.ZERO,t.center=x.ZERO,t;let n,r=e.length,o=x.clone(e[0],_ge);for(n=1;n<r;n++)x.add(o,e[n],o);let a=1/r;x.multiplyByScalar(o,a,o);let s=0,u=0,l=0,c=0,f=0,h=0,d;for(n=0;n<r;n++)d=x.subtract(e[n],o,yge),s+=d.x*d.x,u+=d.x*d.y,l+=d.x*d.z,c+=d.y*d.y,f+=d.y*d.z,h+=d.z*d.z;s*=a,u*=a,l*=a,c*=a,f*=a,h*=a;let p=Ege;p[0]=s,p[1]=u,p[2]=l,p[3]=u,p[4]=c,p[5]=f,p[6]=l,p[7]=f,p[8]=h;let _=te.computeEigenDecomposition(p,Tge),y=te.clone(_.unitary,t.halfAxes),v=te.getColumn(y,0,Cge),w=te.getColumn(y,1,xge),C=te.getColumn(y,2,wge),E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,A=-Number.MAX_VALUE,D=Number.MAX_VALUE,P=Number.MAX_VALUE,M=Number.MAX_VALUE;for(n=0;n<r;n++)d=e[n],E=Math.max(x.dot(v,d),E),S=Math.max(x.dot(w,d),S),A=Math.max(x.dot(C,d),A),D=Math.min(x.dot(v,d),D),P=Math.min(x.dot(w,d),P),M=Math.min(x.dot(C,d),M);v=x.multiplyByScalar(v,.5*(D+E),v),w=x.multiplyByScalar(w,.5*(P+S),w),C=x.multiplyByScalar(C,.5*(M+A),C);let b=x.add(v,w,t.center);x.add(b,C,b);let O=vge;return O.x=E-D,O.y=S-P,O.z=A-M,x.multiplyByScalar(O,.5,O),te.multiplyByScale(t.halfAxes,O,t.halfAxes),t};var cW=new x,Sge=new x;function oW(e,t,n,r,o,a,s,u,l,c,f){g(f)||(f=new Qr);let h=f.halfAxes;te.setColumn(h,0,t,h),te.setColumn(h,1,n,h),te.setColumn(h,2,r,h);let d=cW;d.x=(o+a)/2,d.y=(s+u)/2,d.z=(l+c)/2;let p=Sge;p.x=(a-o)/2,p.y=(u-s)/2,p.z=(c-l)/2;let _=f.center;return d=te.multiplyByVector(h,d,d),x.add(e,d,_),te.multiplyByScale(h,p,h),f}var aW=new le,Age=new x,bge=new le,Ige=new le,Dge=new le,Pge=new le,Mge=new le,Lge=new x,sW=new x,Rge=new x,uW=new x,Oge=new x,Nge=new X,Bge=new X,Fge=new X,zge=new X,Vge=new X,kge=new x,Gge=new x,Uge=new x,Hge=new x,qge=new X,Wge=new x,Yge=new x,Xge=new x,jge=new si(x.UNIT_X,0);Qr.fromRectangle=function(e,t,n,r,o){t=T(t,0),n=T(n,0),r=T(r,Ge.WGS84);let a,s,u,l,c,f,h;if(e.width<=F.PI){let P=hn.center(e,aW),M=r.cartographicToCartesian(P,Age),b=new l0(M,r);h=b.plane;let O=P.longitude,m=e.south<0&&e.north>0?0:P.latitude,I=le.fromRadians(O,e.north,n,bge),L=le.fromRadians(e.west,e.north,n,Ige),R=le.fromRadians(e.west,m,n,Dge),N=le.fromRadians(e.west,e.south,n,Pge),B=le.fromRadians(O,e.south,n,Mge),V=r.cartographicToCartesian(I,Lge),z=r.cartographicToCartesian(L,sW),U=r.cartographicToCartesian(R,Rge),Q=r.cartographicToCartesian(N,uW),ne=r.cartographicToCartesian(B,Oge),se=b.projectPointToNearestOnPlane(V,Nge),de=b.projectPointToNearestOnPlane(z,Bge),pe=b.projectPointToNearestOnPlane(U,Fge),ve=b.projectPointToNearestOnPlane(Q,zge),ft=b.projectPointToNearestOnPlane(ne,Vge);return a=Math.min(de.x,pe.x,ve.x),s=-a,l=Math.max(de.y,se.y),u=Math.min(ve.y,ft.y),L.height=N.height=t,z=r.cartographicToCartesian(L,sW),Q=r.cartographicToCartesian(N,uW),c=Math.min(si.getPointDistance(h,z),si.getPointDistance(h,Q)),f=n,oW(b.origin,b.xAxis,b.yAxis,b.zAxis,a,s,u,l,c,f,o)}let d=e.south>0,p=e.north<0,_=d?e.south:p?e.north:0,y=hn.center(e,aW).longitude,v=x.fromRadians(y,_,n,r,kge);v.z=0;let C=Math.abs(v.x)<F.EPSILON10&&Math.abs(v.y)<F.EPSILON10?x.UNIT_X:x.normalize(v,Gge),E=x.UNIT_Z,S=x.cross(C,E,Uge);h=si.fromPointNormal(v,C,jge);let A=x.fromRadians(y+F.PI_OVER_TWO,_,n,r,Hge);s=x.dot(si.projectPointOntoPlane(h,A,qge),S),a=-s,l=x.fromRadians(0,e.north,p?t:n,r,Wge).z,u=x.fromRadians(0,e.south,d?t:n,r,Yge).z;let D=x.fromRadians(e.east,_,n,r,Xge);return c=si.getPointDistance(h,D),f=0,oW(v,S,E,C,a,s,u,l,c,f,o)};Qr.fromTransformation=function(e,t){return g(t)||(t=new Qr),t.center=G.getTranslation(e,t.center),t.halfAxes=G.getMatrix3(e,t.halfAxes),t.halfAxes=te.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t};Qr.clone=function(e,t){if(!!g(e))return g(t)?(x.clone(e.center,t.center),te.clone(e.halfAxes,t.halfAxes),t):new Qr(e.center,e.halfAxes)};Qr.intersectPlane=function(e,t){let n=e.center,r=t.normal,o=e.halfAxes,a=r.x,s=r.y,u=r.z,l=Math.abs(a*o[te.COLUMN0ROW0]+s*o[te.COLUMN0ROW1]+u*o[te.COLUMN0ROW2])+Math.abs(a*o[te.COLUMN1ROW0]+s*o[te.COLUMN1ROW1]+u*o[te.COLUMN1ROW2])+Math.abs(a*o[te.COLUMN2ROW0]+s*o[te.COLUMN2ROW1]+u*o[te.COLUMN2ROW2]),c=x.dot(r,n)+t.distance;return c<=-l?vi.OUTSIDE:c>=l?vi.INSIDE:vi.INTERSECTING};var fW=new x,hW=new x,dW=new x,Kge=new x,lW=new x,Zge=new x;Qr.distanceSquaredTo=function(e,t){let n=x.subtract(t,e.center,cW),r=e.halfAxes,o=te.getColumn(r,0,fW),a=te.getColumn(r,1,hW),s=te.getColumn(r,2,dW),u=x.magnitude(o),l=x.magnitude(a),c=x.magnitude(s),f=!0,h=!0,d=!0;u>0?x.divideByScalar(o,u,o):f=!1,l>0?x.divideByScalar(a,l,a):h=!1,c>0?x.divideByScalar(s,c,s):d=!1;let p=!f+!h+!d,_,y,v;if(p===1){let S=o;_=a,y=s,h?d||(S=s,y=o):(S=a,_=o),v=x.cross(_,y,lW),S===o?o=v:S===a?a=v:S===s&&(s=v)}else if(p===2){_=o,h?_=a:d&&(_=s);let S=x.UNIT_Y;S.equalsEpsilon(_,F.EPSILON3)&&(S=x.UNIT_X),y=x.cross(_,S,Kge),x.normalize(y,y),v=x.cross(_,y,lW),x.normalize(v,v),_===o?(a=y,s=v):_===a?(s=y,o=v):_===s&&(o=y,a=v)}else p===3&&(o=x.UNIT_X,a=x.UNIT_Y,s=x.UNIT_Z);let w=Zge;w.x=x.dot(n,o),w.y=x.dot(n,a),w.z=x.dot(n,s);let C=0,E;return w.x<-u?(E=w.x+u,C+=E*E):w.x>u&&(E=w.x-u,C+=E*E),w.y<-l?(E=w.y+l,C+=E*E):w.y>l&&(E=w.y-l,C+=E*E),w.z<-c?(E=w.z+c,C+=E*E):w.z>c&&(E=w.z-c,C+=E*E),C};var Qge=new x,Jge=new x;Qr.computePlaneDistances=function(e,t,n,r){g(r)||(r=new np);let o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=e.center,u=e.halfAxes,l=te.getColumn(u,0,fW),c=te.getColumn(u,1,hW),f=te.getColumn(u,2,dW),h=x.add(l,c,Qge);x.add(h,f,h),x.add(h,s,h);let d=x.subtract(h,t,Jge),p=x.dot(n,d);return o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.add(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.subtract(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.subtract(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.add(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.add(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.subtract(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.subtract(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),r.start=o,r.stop=a,r};var $ge=new x,e0e=new x,t0e=new x;Qr.computeCorners=function(e,t){g(t)||(t=[new x,new x,new x,new x,new x,new x,new x,new x]);let n=e.center,r=e.halfAxes,o=te.getColumn(r,0,$ge),a=te.getColumn(r,1,e0e),s=te.getColumn(r,2,t0e);return x.clone(n,t[0]),x.subtract(t[0],o,t[0]),x.subtract(t[0],a,t[0]),x.subtract(t[0],s,t[0]),x.clone(n,t[1]),x.subtract(t[1],o,t[1]),x.subtract(t[1],a,t[1]),x.add(t[1],s,t[1]),x.clone(n,t[2]),x.subtract(t[2],o,t[2]),x.add(t[2],a,t[2]),x.subtract(t[2],s,t[2]),x.clone(n,t[3]),x.subtract(t[3],o,t[3]),x.add(t[3],a,t[3]),x.add(t[3],s,t[3]),x.clone(n,t[4]),x.add(t[4],o,t[4]),x.subtract(t[4],a,t[4]),x.subtract(t[4],s,t[4]),x.clone(n,t[5]),x.add(t[5],o,t[5]),x.subtract(t[5],a,t[5]),x.add(t[5],s,t[5]),x.clone(n,t[6]),x.add(t[6],o,t[6]),x.add(t[6],a,t[6]),x.subtract(t[6],s,t[6]),x.clone(n,t[7]),x.add(t[7],o,t[7]),x.add(t[7],a,t[7]),x.add(t[7],s,t[7]),t};var n0e=new te;Qr.computeTransformation=function(e,t){g(t)||(t=new G);let n=e.center,r=te.multiplyByUniformScale(e.halfAxes,2,n0e);return G.fromRotationTranslation(r,n,t)};var r0e=new Ee;Qr.isOccluded=function(e,t){let n=Ee.fromOrientedBoundingBox(e,r0e);return!t.isBoundingSphereVisible(n)};Qr.prototype.intersectPlane=function(e){return Qr.intersectPlane(this,e)};Qr.prototype.distanceSquaredTo=function(e){return Qr.distanceSquaredTo(this,e)};Qr.prototype.computePlaneDistances=function(e,t,n){return Qr.computePlaneDistances(this,e,t,n)};Qr.prototype.computeCorners=function(e){return Qr.computeCorners(this,e)};Qr.prototype.computeTransformation=function(e){return Qr.computeTransformation(this,e)};Qr.prototype.isOccluded=function(e){return Qr.isOccluded(this,e)};Qr.equals=function(e,t){return e===t||g(e)&&g(t)&&x.equals(e.center,t.center)&&te.equals(e.halfAxes,t.halfAxes)};Qr.prototype.clone=function(e){return Qr.clone(this,e)};Qr.prototype.equals=function(e){return Qr.equals(this,e)};var pW=Qr;var cD={};cD.getHeight=function(e,t,n){return(e-n)*t+n};var i0e=new x;cD.getPosition=function(e,t,n,r,o){let a=t.cartesianToCartographic(e,i0e),s=cD.getHeight(a.height,n,r);return x.fromRadians(a.longitude,a.latitude,s,t,o)};var U2=cD;function RC(e,t,n,r){e=T(e,1),t=T(t,1),n=T(n,1),r=T(r,1),this.value=new Uint8Array([K.floatToByte(e),K.floatToByte(t),K.floatToByte(n),K.floatToByte(r)])}Object.defineProperties(RC.prototype,{componentDatatype:{get:function(){return ie.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}});RC.fromColor=function(e){return new RC(e.red,e.green,e.blue,e.alpha)};RC.toValue=function(e,t){return g(t)?e.toBytes(t):new Uint8Array(e.toBytes())};RC.equals=function(e,t){return e===t||g(e)&&g(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var mW=RC;var gW=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute float batchId;
#ifdef EXTRUDED_GEOMETRY
attribute vec3 extrudeDirection;
uniform float u_globeMinimumAltitude;
#endif // EXTRUDED_GEOMETRY
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif // PER_INSTANCE_COLOR
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
void main()
{
vec4 position = czm_computePosition();
#ifdef EXTRUDED_GEOMETRY
float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));
delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;
position = position + vec4(extrudeDirection * delta, 0.0);
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
v_sphericalExtents = czm_batchTable_sphericalExtents(batchId);
v_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);
#else // SPHERICAL
#ifdef COLUMBUS_VIEW_2D
vec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);
vec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);
vec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));
bool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;
planes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);
planes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);
idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;
idlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));
planes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);
planes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;
vec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;
vec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;
#else // COLUMBUS_VIEW_2D
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;
vec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;
vec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;
#endif // COLUMBUS_VIEW_2D
vec3 eastWard = southEastCorner - southWestCorner;
float eastExtent = length(eastWard);
eastWard /= eastExtent;
vec3 northWard = northWestCorner - southWestCorner;
float northExtent = length(northWard);
northWard /= northExtent;
v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));
v_southPlane = vec4(northWard, -dot(northWard, southWestCorner));
v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);
#endif // SPHERICAL
vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);
vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);
v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);
v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);
v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif
gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position);
}
`;var _W=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
void main(void)
{
#ifdef VECTOR_TILE
gl_FragColor = czm_gammaCorrect(u_highlightColor);
#else
gl_FragColor = vec4(1.0);
#endif
czm_writeDepthClamp();
}
`;var yW=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
vec4 color = czm_gammaCorrect(v_color);
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
}
`;var vW=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec4 color;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var CW=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function Bm(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=T(e.closed,!1),r=T(e.flat,!1),o=r?CW:vW,a=r?jI:yW,s=r?Bm.FLAT_VERTEX_FORMAT:Bm.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,o),this._fragmentShaderSource=T(e.fragmentShaderSource,a),this._renderState=Fl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=s,this._flat=r,this._faceForward=T(e.faceForward,!n)}Object.defineProperties(Bm.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});Bm.VERTEX_FORMAT=vo.POSITION_AND_NORMAL;Bm.FLAT_VERTEX_FORMAT=vo.POSITION_ONLY;Bm.prototype.getFragmentShaderSource=Fl.prototype.getFragmentShaderSource;Bm.prototype.isTranslucent=Fl.prototype.isTranslucent;Bm.prototype.getRenderState=Fl.prototype.getRenderState;var Fm=Bm;var H2=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
#ifdef NORMAL_EC
vec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {
vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);
return eyeCoordinate.xyz / eyeCoordinate.w;
}
vec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {
vec2 glFragCoordXY = gl_FragCoord.xy;
float upOrRightLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));
float downOrLeftLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));
bvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);
float useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);
float useDownOrLeft = float(useUpOrRight == 0.0);
vec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);
vec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);
return (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;
}
#endif // NORMAL_EC
void main(void)
{
#ifdef REQUIRES_EC
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
#endif
#ifdef REQUIRES_WC
vec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;
vec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;
#endif
#ifdef TEXTURE_COORDINATES
vec2 uv;
#ifdef SPHERICAL
vec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);
sphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;
sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);
uv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;
uv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;
#else // SPHERICAL
uv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;
uv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;
#endif // SPHERICAL
#endif // TEXTURE_COORDINATES
#ifdef PICK
#ifdef CULL_FRAGMENTS
if (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0 || logDepthOrDepth != 0.0) {
gl_FragColor.a = 1.0;
czm_writeDepthClamp();
}
#else // CULL_FRAGMENTS
gl_FragColor.a = 1.0;
#endif // CULL_FRAGMENTS
#else // PICK
#ifdef CULL_FRAGMENTS
if (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y || logDepthOrDepth == 0.0) {
discard;
}
#endif
#ifdef NORMAL_EC
vec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));
vec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));
vec3 normalEC = normalize(cross(leftRight, downUp));
#endif
#ifdef PER_INSTANCE_COLOR
vec4 color = czm_gammaCorrect(v_color);
#ifdef FLAT
gl_FragColor = color;
#else // FLAT
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#else // PER_INSTANCE_COLOR
czm_materialInput materialInput;
#ifdef USES_NORMAL_EC
materialInput.normalEC = normalEC;
#endif
#ifdef USES_POSITION_TO_EYE_EC
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
#endif
#ifdef USES_TANGENT_TO_EYE
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);
#endif
#ifdef USES_ST
materialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;
materialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;
#endif
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else // FLAT
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#endif // PER_INSTANCE_COLOR
czm_writeDepthClamp();
#endif // PICK
}
`;function Yf(e,t,n){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};let r=new q2;r.requiresTextureCoordinates=e,r.requiresEC=!n.flat;let o=new q2;if(o.requiresTextureCoordinates=e,n instanceof Fm)r.requiresNormalEC=!n.flat;else{let a=`${n.material.shaderSource}
${n.fragmentShaderSource}`;r.normalEC=a.indexOf("materialInput.normalEC")!==-1||a.indexOf("czm_getDefaultMaterial")!==-1,r.positionToEyeEC=a.indexOf("materialInput.positionToEyeEC")!==-1,r.tangentToEyeMatrix=a.indexOf("materialInput.tangentToEyeMatrix")!==-1,r.st=a.indexOf("materialInput.st")!==-1}this._colorShaderDependencies=r,this._pickShaderDependencies=o,this._appearance=n,this._extentsCulling=e,this._planarExtents=t}Yf.prototype.createFragmentShader=function(e){let t=this._appearance,n=this._colorShaderDependencies,r=[];!e&&!this._planarExtents&&r.push("SPHERICAL"),n.requiresEC&&r.push("REQUIRES_EC"),n.requiresWC&&r.push("REQUIRES_WC"),n.requiresTextureCoordinates&&r.push("TEXTURE_COORDINATES"),this._extentsCulling&&r.push("CULL_FRAGMENTS"),n.requiresNormalEC&&r.push("NORMAL_EC"),t instanceof Fm&&r.push("PER_INSTANCE_COLOR"),n.normalEC&&r.push("USES_NORMAL_EC"),n.positionToEyeEC&&r.push("USES_POSITION_TO_EYE_EC"),n.tangentToEyeMatrix&&r.push("USES_TANGENT_TO_EYE"),n.st&&r.push("USES_ST"),t.flat&&r.push("FLAT");let o="";return t instanceof Fm||(o=t.material.shaderSource),new Et({defines:r,sources:[o,H2]})};Yf.prototype.createPickFragmentShader=function(e){let t=this._pickShaderDependencies,n=["PICK"];return!e&&!this._planarExtents&&n.push("SPHERICAL"),t.requiresEC&&n.push("REQUIRES_EC"),t.requiresWC&&n.push("REQUIRES_WC"),t.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),new Et({defines:n,sources:[H2],pickColorQualifier:"varying"})};Yf.prototype.createVertexShader=function(e,t,n,r){return IW(this._colorShaderDependencies,this._planarExtents,n,e,t,this._appearance,r,this._projectionExtentDefines)};Yf.prototype.createPickVertexShader=function(e,t,n,r){return IW(this._pickShaderDependencies,this._planarExtents,n,e,t,void 0,r,this._projectionExtentDefines)};var xW=new x,wW=new le,EW={high:0,low:0};function IW(e,t,n,r,o,a,s,u){let l=r.slice();if(u.eastMostYhighDefine===""){let c=wW;c.longitude=F.PI,c.latitude=0,c.height=0;let f=s.project(c,xW),h=ti.encode(f.x,EW);u.eastMostYhighDefine=`EAST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,u.eastMostYlowDefine=`EAST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`;let d=wW;d.longitude=-F.PI,d.latitude=0,d.height=0;let p=s.project(d,xW);h=ti.encode(p.x,EW),u.westMostYhighDefine=`WEST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,u.westMostYlowDefine=`WEST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`}return n&&(l.push(u.eastMostYhighDefine),l.push(u.eastMostYlowDefine),l.push(u.westMostYhighDefine),l.push(u.westMostYlowDefine)),g(a)&&a instanceof Fm&&l.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(l.push("TEXTURE_COORDINATES"),t||n||l.push("SPHERICAL"),n&&l.push("COLUMBUS_VIEW_2D")),new Et({defines:l,sources:[o]})}function q2(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}Object.defineProperties(q2.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});function TW(e,t,n){return Math.abs((t.y-e.y)*n.x-(t.x-e.x)*n.y+t.x*e.y-t.y*e.x)/X.distance(t,e)}var o0e=[new X,new X,new X,new X];function DW(e,t){let n=o0e,r=X.unpack(t,0,n[0]),o=X.unpack(t,2,n[1]),a=X.unpack(t,4,n[2]);e.uMaxVmax=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o.x,o.y,a.x,a.y]});let s=1/TW(r,o,a),u=1/TW(r,a,o);e.uvMinAndExtents=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,s,u]})}var PW=new le,MW=new x,a0e=new x,s0e=new x,fD={high:0,low:0};function LW(e,t,n){let r=PW;r.height=0,r.longitude=e.west,r.latitude=e.south;let o=t.project(r,MW);r.latitude=e.north;let a=t.project(r,a0e);r.longitude=e.east,r.latitude=e.south;let s=t.project(r,s0e),u=[0,0,0,0],l=[0,0,0,0],c=ti.encode(o.x,fD);u[0]=c.high,l[0]=c.low,c=ti.encode(o.y,fD),u[1]=c.high,l[1]=c.low,c=ti.encode(a.y,fD),u[2]=c.high,l[2]=c.low,c=ti.encode(s.x,fD),u[3]=c.high,l[3]=c.low,n.planes2D_HIGH=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:u}),n.planes2D_LOW=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:l})}var u0e=new G,l0e=new G,SW=new x,c0e=new le,f0e=[new le,new le,new le,new le,new le,new le,new le,new le];function h0e(e,t,n,r,o,a){let s=hn.center(e,c0e);s.height=n;let u=le.toCartesian(s,t,SW),l=Cn.eastNorthUpToFixedFrame(u,t,u0e),c=G.inverse(l,l0e),f=e.west,h=e.east,d=e.north,p=e.south,_=f0e;_[0].latitude=p,_[0].longitude=f,_[1].latitude=d,_[1].longitude=f,_[2].latitude=d,_[2].longitude=h,_[3].latitude=p,_[3].longitude=h;let y=(f+h)*.5,v=(d+p)*.5;_[4].latitude=p,_[4].longitude=y,_[5].latitude=d,_[5].longitude=y,_[6].latitude=v,_[6].longitude=f,_[7].latitude=v,_[7].longitude=h;let w=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,E=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY;for(let M=0;M<8;M++){_[M].height=n;let b=le.toCartesian(_[M],t,SW);G.multiplyByPoint(c,b,b),b.z=0,w=Math.min(w,b.x),C=Math.max(C,b.x),E=Math.min(E,b.y),S=Math.max(S,b.y)}let A=r;A.x=w,A.y=E,A.z=0,G.multiplyByPoint(l,A,A);let D=o;D.x=C,D.y=E,D.z=0,G.multiplyByPoint(l,D,D),x.subtract(D,A,o);let P=a;P.x=w,P.y=S,P.z=0,G.multiplyByPoint(l,P,P),x.subtract(P,A,a)}var d0e=new x,p0e=new x,m0e=new ti;Yf.getPlanarTextureCoordinateAttributes=function(e,t,n,r,o){let a=MW,s=d0e,u=p0e;h0e(e,n,T(o,0),a,s,u);let l={};DW(l,t);let c=ti.fromCartesian(a,m0e);return l.southWest_HIGH=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(c.high,[0,0,0])}),l.southWest_LOW=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(c.low,[0,0,0])}),l.eastward=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(s,[0,0,0])}),l.northward=new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(u,[0,0,0])}),LW(e,r,l),l};var g0e=new x;function AW(e,t,n,r){let o=PW;o.latitude=e,o.longitude=t,o.height=0;let a=le.toCartesian(o,n,g0e),s=Math.sqrt(a.x*a.x+a.y*a.y),u=F.fastApproximateAtan2(s,a.z),l=F.fastApproximateAtan2(a.x,a.y);return r.x=u,r.y=l,r}var bW=new X;Yf.getSphericalExtentGeometryInstanceAttributes=function(e,t,n,r){let o=AW(e.south,e.west,n,bW),a=o.x,s=o.y,u=AW(e.north,e.east,n,bW),l=u.x,c=u.y,f=0;s>c&&(f=F.PI-s,s=-F.PI,c+=f),a-=F.EPSILON5,s-=F.EPSILON5,l+=F.EPSILON5,c+=F.EPSILON5;let h=1/(c-s),d=1/(l-a),p={sphericalExtents:new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[a,s,d,h]}),longitudeRotation:new Qc({componentDatatype:ie.FLOAT,componentsPerAttribute:1,normalize:!1,value:[f]})};return DW(p,t),LW(e,r,p),p};Yf.hasAttributesForTextureCoordinatePlanes=function(e){return g(e.southWest_HIGH)&&g(e.southWest_LOW)&&g(e.northward)&&g(e.eastward)&&g(e.planes2D_HIGH)&&g(e.planes2D_LOW)&&g(e.uMaxVmax)&&g(e.uvMinAndExtents)};Yf.hasAttributesForSphericalExtents=function(e){return g(e.sphericalExtents)&&g(e.longitudeRotation)&&g(e.planes2D_HIGH)&&g(e.planes2D_LOW)&&g(e.uMaxVmax)&&g(e.uvMinAndExtents)};function _0e(e){return Math.max(e.width,e.height)>Yf.MAX_WIDTH_FOR_PLANAR_EXTENTS}Yf.shouldUseSphericalCoordinates=function(e){return _0e(e)};Yf.MAX_WIDTH_FOR_PLANAR_EXTENTS=F.toRadians(1);var c0=Yf;function J_(e){e=T(e,T.EMPTY_OBJECT);let t=e.geometryInstances;this.geometryInstances=t,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,Ua.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=T(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1;let n=this;this._readyPromise=new Promise((r,o)=>{n._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let a=this._error;g(a)?o(a):r(this)}}),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:T(e.vertexCacheOptimize,!1),interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:T(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}Object.defineProperties(J_.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}});J_.isSupported=function(e){return e.context.stencilBuffer};function OC(e,t){let n=t?sl.EQUAL:sl.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:n,frontOperation:{fail:Zr.KEEP,zFail:Zr.DECREMENT_WRAP,zPass:Zr.KEEP},backFunction:n,backOperation:{fail:Zr.KEEP,zFail:Zr.INCREMENT_WRAP,zPass:Zr.KEEP},reference:oo.CESIUM_3D_TILE_MASK,mask:oo.CESIUM_3D_TILE_MASK},stencilMask:oo.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:s0.LESS_OR_EQUAL},depthMask:!1}}function Y2(e){return{stencilTest:{enabled:e,frontFunction:sl.NOT_EQUAL,frontOperation:{fail:Zr.ZERO,zFail:Zr.ZERO,zPass:Zr.ZERO},backFunction:sl.NOT_EQUAL,backOperation:{fail:Zr.ZERO,zFail:Zr.ZERO,zPass:Zr.ZERO},reference:0,mask:oo.CLASSIFICATION_MASK},stencilMask:oo.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ka.PRE_MULTIPLIED_ALPHA_BLEND}}var y0e={stencilTest:{enabled:!0,frontFunction:sl.NOT_EQUAL,frontOperation:{fail:Zr.ZERO,zFail:Zr.ZERO,zPass:Zr.ZERO},backFunction:sl.NOT_EQUAL,backOperation:{fail:Zr.ZERO,zFail:Zr.ZERO,zPass:Zr.ZERO},reference:0,mask:oo.CLASSIFICATION_MASK},stencilMask:oo.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function v0e(e,t,n,r){if(g(e._rsStencilDepthPass))return;let o=!e.debugShowShadowVolume;e._rsStencilDepthPass=fn.fromCache(OC(o,!1)),e._rsStencilDepthPass3DTiles=fn.fromCache(OC(o,!0)),e._rsColorPass=fn.fromCache(Y2(o,!1)),e._rsPickPass=fn.fromCache(y0e)}function C0e(e,t){if(!e.compressVertices)return t;if(t.search(/attribute\s+vec3\s+extrudeDirection;/g)!==-1){let n="compressedAttributes",r=`attribute vec2 ${n};`,o=`vec3 extrudeDirection;
`,a=`    extrudeDirection = czm_octDecode(${n}, 65535.0);
`,s=t;s=s.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),s=Et.replaceMain(s,"czm_non_compressed_main");let u=`void main() 
{ 
${a}    czm_non_compressed_main(); 
}`;return[r,o,s,u].join(`
`)}}function x0e(e,t){let n=t.context,r=e._primitive,o=gW;o=e._primitive._batchTable.getVertexShaderCallback()(o),o=$s._appendDistanceDisplayConditionToShader(r,o),o=$s._modifyShaderPosition(e,o,t.scene3DOnly),o=$s._updateColorAttribute(r,o);let a=e._hasPlanarExtentsAttributes,s=a||e._hasSphericalExtentsAttribute;e._extruded&&(o=C0e(r,o));let u=e._extruded?"EXTRUDED_GEOMETRY":"",l=new Et({defines:[u],sources:[o]}),c=new Et({sources:[_W]}),f=e._primitive._attributeLocations,h=new c0(s,a,e.appearance);if(e._spStencil=wi.replaceCache({context:n,shaderProgram:e._spStencil,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f}),e._primitive.allowPicking){let _=Et.createPickVertexShaderSource(o);_=$s._appendShowToShader(r,_),_=$s._updatePickColorAttribute(_);let y=h.createPickFragmentShader(!1),v=h.createPickVertexShader([u],_,!1,t.mapProjection);if(e._spPick=wi.replaceCache({context:n,shaderProgram:e._spPick,vertexShaderSource:v,fragmentShaderSource:y,attributeLocations:f}),s){let w=n.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!g(w)){let C=h.createPickFragmentShader(!0),E=h.createPickVertexShader([u],_,!0,t.mapProjection);w=n.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:E,fragmentShaderSource:C,attributeLocations:f})}e._spPick2D=w}}else e._spPick=wi.fromCache({context:n,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f});o=$s._appendShowToShader(r,o),l=new Et({defines:[u],sources:[o]}),e._sp=wi.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f});let d=h.createFragmentShader(!1),p=h.createVertexShader([u],o,!1,t.mapProjection);if(e._spColor=wi.replaceCache({context:n,shaderProgram:e._spColor,vertexShaderSource:p,fragmentShaderSource:d,attributeLocations:f}),s){let _=n.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!g(_)){let y=h.createFragmentShader(!0),v=h.createVertexShader([u],o,!0,t.mapProjection);_=n.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:v,fragmentShaderSource:y,attributeLocations:f})}e._spColor2D=_}}function w0e(e,t){let n=e._primitive,r=n._va.length*2;t.length=r;let o,a,s,u=0,l=n._batchTable.getUniformMapCallback()(e._uniformMap),c=e._needs2DShader;for(o=0;o<r;o+=2){let p=n._va[u++];a=t[o],g(a)||(a=t[o]=new $t({owner:e,primitiveType:n._primitiveType})),a.vertexArray=p,a.renderState=e._rsStencilDepthPass,a.shaderProgram=e._sp,a.uniformMap=l,a.pass=en.TERRAIN_CLASSIFICATION,s=$t.shallowClone(a,a.derivedCommands.tileset),s.renderState=e._rsStencilDepthPass3DTiles,s.pass=en.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=s,a=t[o+1],g(a)||(a=t[o+1]=new $t({owner:e,primitiveType:n._primitiveType})),a.vertexArray=p,a.renderState=e._rsColorPass,a.shaderProgram=e._spColor,a.pass=en.TERRAIN_CLASSIFICATION;let y=e.appearance.material;if(g(y)&&(l=ji(l,y._uniforms)),a.uniformMap=l,s=$t.shallowClone(a,a.derivedCommands.tileset),s.pass=en.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=s,c){let v=$t.shallowClone(a,a.derivedCommands.appearance2D);v.shaderProgram=e._spColor2D,a.derivedCommands.appearance2D=v,v=$t.shallowClone(s,s.derivedCommands.appearance2D),v.shaderProgram=e._spColor2D,s.derivedCommands.appearance2D=v}}let f=e._commandsIgnoreShow,h=e._spStencil,d=0;r=f.length=r/2;for(let p=0;p<r;++p){let _=f[p]=$t.shallowClone(t[d],f[p]);_.shaderProgram=h,_.pass=en.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,d+=2}}function E0e(e,t){let n=e._usePickOffsets,r=e._primitive,o=r._va.length*2,a,s=0,u;n&&(a=r._pickOffsets,o=a.length*2),t.length=o;let l,c,f,h=0,d=r._batchTable.getUniformMapCallback()(e._uniformMap),p=e._needs2DShader;for(l=0;l<o;l+=2){let _=r._va[h++];if(n&&(u=a[s++],_=r._va[u.index]),c=t[l],g(c)||(c=t[l]=new $t({owner:e,primitiveType:r._primitiveType,pickOnly:!0})),c.vertexArray=_,c.renderState=e._rsStencilDepthPass,c.shaderProgram=e._sp,c.uniformMap=d,c.pass=en.TERRAIN_CLASSIFICATION,n&&(c.offset=u.offset,c.count=u.count),f=$t.shallowClone(c,c.derivedCommands.tileset),f.renderState=e._rsStencilDepthPass3DTiles,f.pass=en.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=f,c=t[l+1],g(c)||(c=t[l+1]=new $t({owner:e,primitiveType:r._primitiveType,pickOnly:!0})),c.vertexArray=_,c.renderState=e._rsPickPass,c.shaderProgram=e._spPick,c.uniformMap=d,c.pass=en.TERRAIN_CLASSIFICATION,n&&(c.offset=u.offset,c.count=u.count),f=$t.shallowClone(c,c.derivedCommands.tileset),f.pass=en.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=f,p){let y=$t.shallowClone(c,c.derivedCommands.pick2D);y.shaderProgram=e._spPick2D,c.derivedCommands.pick2D=y,y=$t.shallowClone(f,f.derivedCommands.pick2D),y.shaderProgram=e._spPick2D,f.derivedCommands.pick2D=y}}}function T0e(e,t,n,r,o,a,s){w0e(e,a),E0e(e,s)}function RW(e,t){return Math.floor(e%t/2)}function W2(e,t,n,r,o,a){e.modelMatrix=n,e.boundingVolume=o,e.cull=r,e.debugShowBoundingVolume=a,t.commandList.push(e)}function OW(e,t,n,r,o){e.modelMatrix=n,e.boundingVolume=o,e.cull=r,t.commandList.push(e)}function S0e(e,t,n,r,o,a,s,u){let l=e._primitive;$s._updateBoundingVolumes(l,t,o);let c;t.mode===Ne.SCENE3D?c=l._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?c=l._boundingSphereCV:t.mode===Ne.SCENE2D&&g(l._boundingSphere2D)?c=l._boundingSphere2D:g(l._boundingSphereMorph)&&(c=l._boundingSphereMorph);let f=e.classificationType,h=f!==Ua.CESIUM_3D_TILE,d=f!==Ua.TERRAIN,p=t.passes,_,y,v;if(p.render){let w=n.length;for(_=0;_<w;++_)y=c[RW(_,w)],h&&(v=n[_],W2(v,t,o,a,y,s)),d&&(v=n[_].derivedCommands.tileset,W2(v,t,o,a,y,s));if(t.invertClassification){let C=e._commandsIgnoreShow,E=C.length;for(_=0;_<E;++_)y=c[_],v=C[_],W2(v,t,o,a,y,s)}}if(p.pick){let w=r.length,C=l._pickOffsets;for(_=0;_<w;++_){let E=C[RW(_,w)];y=c[E.index],h&&(v=r[_],OW(v,t,o,a,y)),d&&(v=r[_].derivedCommands.tileset,OW(v,t,o,a,y))}}}J_.prototype.update=function(e){if(!g(this._primitive)&&!g(this.geometryInstances))return;let t=this.appearance;g(t)&&g(t.material)&&t.material.update(e.context);let n=this,r=this._primitiveOptions;if(!g(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length,s,u,l,c=!1,f=!0,h,d=!1,p=!1;for(a>0&&(l=o[0].attributes,d=c0.hasAttributesForSphericalExtents(l),p=c0.hasAttributesForTextureCoordinatePlanes(l),h=l.color),s=0;s<a;s++){u=o[s];let y=u.attributes.color;g(y)&&(c=!0),f=f&&g(y)&&mW.equals(h,y)}if(!f&&!d&&!p)throw new Le("All GeometryInstances must have the same color attribute except via GroundPrimitives");c&&!g(t)&&(t=new Fm({flat:!0}),this.appearance=t),this._usePickOffsets=!d&&!p,this._hasSphericalExtentsAttribute=d,this._hasPlanarExtentsAttributes=p,this._hasPerColorAttribute=c;let _=new Array(a);for(s=0;s<a;++s)u=o[s],_[s]=new U_({geometry:u.geometry,attributes:u.attributes,modelMatrix:u.modelMatrix,id:u.id,pickPrimitive:T(this._pickPrimitive,n)});r.appearance=t,r.geometryInstances=_,g(this._createBoundingVolumeFunction)&&(r._createBoundingVolumeFunction=function(y,v){n._createBoundingVolumeFunction(y,v)}),r._createRenderStatesFunction=function(y,v,w,C){v0e(n,v)},r._createShaderProgramFunction=function(y,v,w){x0e(n,v)},r._createCommandsFunction=function(y,v,w,C,E,S,A){T0e(n,void 0,void 0,!0,!1,S,A)},g(this._updateAndQueueCommandsFunction)?r._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){n._updateAndQueueCommandsFunction(y,v,w,C,E,S,A,D)}:r._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){S0e(n,v,w,C,E,S,A,D)},this._primitive=new $s(r)}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=fn.fromCache(OC(!1,!1)),this._rsStencilDepthPass3DTiles=fn.fromCache(OC(!1,!0)),this._rsColorPass=fn.fromCache(Y2(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=fn.fromCache(OC(!0,!1)),this._rsStencilDepthPass3DTiles=fn.fromCache(OC(!0,!0)),this._rsColorPass=fn.fromCache(Y2(!0))),this._primitive.appearance!==t&&(this._primitive.appearance=t),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{g(this._primitive)&&this._primitive.ready&&this._completeLoad()})};J_.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};J_.prototype.isDestroyed=function(){return!1};J_.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,st(this)};var X2=J_;var A0e={u_globeMinimumAltitude:function(){return 55e3}};function Cc(e){e=T(e,T.EMPTY_OBJECT);let t=e.appearance,n=e.geometryInstances;if(!g(t)&&g(n)){let a=Array.isArray(n)?n:[n],s=a.length;for(let u=0;u<s;u++){let l=a[u].attributes;if(g(l)&&g(l.color)){t=new Fm({flat:!0});break}}}this.appearance=t,this.geometryInstances=e.geometryInstances,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,Ua.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1;let r=this;this._readyPromise=new Promise((a,s)=>{r._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let u=this._error;g(u)?s(u):a(this)}}),this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=Zc._defaultMaxTerrainHeight,this._minTerrainHeight=Zc._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;let o=this;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:T(e.vertexCacheOptimize,!1),interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:T(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:o,_extruded:!0,_uniformMap:A0e}}Object.defineProperties(Cc.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});Cc.isSupported=X2.isSupported;function NW(e){return function(t,n){let r=n.maximumRadius,o=r/Math.cos(t*.5)-r;return e._maxHeight+o}}function BW(e){return function(t,n){return e._minHeight}}var b0e=new x,I0e=new x,D0e=new x,P0e=new le,M0e=new hn;function hD(e,t){let n=e.mapProjection.ellipsoid;if(!g(t.attributes)||!g(t.attributes.position3DHigh))return g(t.rectangle)?t.rectangle:void 0;let r=t.attributes.position3DHigh.values,o=t.attributes.position3DLow.values,a=r.length,s=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let h=0;h<a;h+=3){let d=x.unpack(r,h,b0e),p=x.unpack(o,h,I0e),_=x.add(d,p,D0e),y=n.cartesianToCartographic(_,P0e),v=y.latitude,w=y.longitude;s=Math.min(s,v),u=Math.min(u,w),l=Math.max(l,v),c=Math.max(c,w)}let f=M0e;return f.north=l,f.south=s,f.east=c,f.west=u,f}function L0e(e,t,n){let r=Zc.getMinimumMaximumHeights(t,n);e._minTerrainHeight=r.minimumTerrainHeight,e._maxTerrainHeight=r.maximumTerrainHeight}function R0e(e,t,n){let r=t.mapProjection.ellipsoid,o=hD(t,n),a=pW.fromRectangle(o,e._minHeight,e._maxHeight,r);if(e._boundingVolumes.push(a),!t.scene3DOnly){let s=t.mapProjection,u=Ee.fromRectangleWithHeights2D(o,s,e._maxHeight,e._minHeight);x.fromElements(u.center.z,u.center.x,u.center.y,u.center),e._boundingVolumes2D.push(u)}}function j2(e,t){return Math.floor(e%t/2)}function K2(e,t,n,r,o,a,s){let u=e._primitive;n.mode!==Ne.SCENE3D&&t.shaderProgram===u._spColor&&u._needs2DShader&&(t=t.derivedCommands.appearance2D),t.owner=e,t.modelMatrix=r,t.boundingVolume=a,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function FW(e,t,n,r,o,a){let s=e._primitive;n.mode!==Ne.SCENE3D&&t.shaderProgram===s._spPick&&s._needs2DShader&&(t=t.derivedCommands.pick2D),t.owner=e,t.modelMatrix=r,t.boundingVolume=a,t.cull=o,n.commandList.push(t)}function O0e(e,t,n,r,o,a,s,u){let l;t.mode===Ne.SCENE3D?l=e._boundingVolumes:l=e._boundingVolumes2D;let c=e.classificationType,f=c!==Ua.CESIUM_3D_TILE,h=c!==Ua.TERRAIN,d=t.passes,p=e._primitive,_,y,v;if(d.render){let w=n.length;for(_=0;_<w;++_)y=l[j2(_,w)],f&&(v=n[_],K2(e,v,t,o,a,y,s)),h&&(v=n[_].derivedCommands.tileset,K2(e,v,t,o,a,y,s));if(t.invertClassification){let C=p._commandsIgnoreShow,E=C.length;for(_=0;_<E;++_)y=l[_],v=C[_],K2(e,v,t,o,a,y,s)}}if(d.pick){let w=r.length,C;for(e._useFragmentCulling||(C=p._primitive._pickOffsets),_=0;_<w;++_){if(y=l[j2(_,w)],!e._useFragmentCulling){let E=C[j2(_,w)];y=l[E.index]}f&&(v=r[_],FW(e,v,t,o,a,y)),h&&(v=r[_].derivedCommands.tileset,FW(e,v,t,o,a,y))}}}Cc.initializeTerrainHeights=function(){return Zc.initialize()};Cc.prototype.update=function(e){if(!g(this._primitive)&&!g(this.geometryInstances))return;if(!Zc.initialized){Cc.initializeTerrainHeights();return}let t=this,n=this._classificationPrimitiveOptions;if(!g(this._primitive)){let r=e.mapProjection.ellipsoid,o,a,s,u=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=u.length,c=new Array(l),f,h;for(f=0;f<l;++f){o=u[f],a=o.geometry;let y=hD(e,a);g(h)?g(y)&&hn.union(h,y,h):h=hn.clone(y);let v=o.id;if(g(v)&&g(y)){let w=Zc.getBoundingSphere(y,r);this._boundingSpheresKeys.push(v),this._boundingSpheres.push(w)}s=a.constructor,!g(s)||g(s.createShadowVolume)}L0e(this,h,r);let d=e.terrainExaggeration,p=e.terrainExaggerationRelativeHeight;this._minHeight=U2.getHeight(this._minTerrainHeight,d,p),this._maxHeight=U2.getHeight(this._maxTerrainHeight,d,p);let _=Cc._supportsMaterials(e.context);if(this._useFragmentCulling=_,_){let y,v=!0;for(f=0;f<l;++f)if(o=u[f],a=o.geometry,h=hD(e,a),c0.shouldUseSphericalCoordinates(h)){v=!1;break}for(f=0;f<l;++f){o=u[f],a=o.geometry,s=a.constructor;let w=hD(e,a),C=a.textureCoordinateRotationPoints;v?y=c0.getPlanarTextureCoordinateAttributes(w,C,r,e.mapProjection,this._maxHeight):y=c0.getSphericalExtentGeometryInstanceAttributes(w,C,r,e.mapProjection);let E=o.attributes;for(let S in E)E.hasOwnProperty(S)&&(y[S]=E[S]);c[f]=new U_({geometry:s.createShadowVolume(a,BW(this),NW(this)),attributes:y,id:o.id})}}else for(f=0;f<l;++f)o=u[f],a=o.geometry,s=a.constructor,c[f]=new U_({geometry:s.createShadowVolume(a,BW(this),NW(this)),attributes:o.attributes,id:o.id});n.geometryInstances=c,n.appearance=this.appearance,n._createBoundingVolumeFunction=function(y,v){R0e(t,y,v)},n._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){O0e(t,v,w,C,E,S,A,D)},this._primitive=new X2(n)}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{g(this._primitive)&&this._primitive.ready&&this._completeLoad()})};Cc.prototype.getBoundingSphere=function(e){let t=this._boundingSpheresKeys.indexOf(e);if(t!==-1)return this._boundingSpheres[t]};Cc.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};Cc.prototype.isDestroyed=function(){return!1};Cc.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),st(this)};Cc._supportsMaterials=function(e){return e.depthTexture};Cc.supportsMaterials=function(e){return Cc._supportsMaterials(e.frameState.context)};var zW=Cc;function OE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._image=void 0,this._imageSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(OE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),image:Z("image"),scale:Z("scale"),pixelOffset:Z("pixelOffset"),eyeOffset:Z("eyeOffset"),horizontalOrigin:Z("horizontalOrigin"),verticalOrigin:Z("verticalOrigin"),heightReference:Z("heightReference"),color:Z("color"),rotation:Z("rotation"),alignedAxis:Z("alignedAxis"),sizeInMeters:Z("sizeInMeters"),width:Z("width"),height:Z("height"),scaleByDistance:Z("scaleByDistance"),translucencyByDistance:Z("translucencyByDistance"),pixelOffsetScaleByDistance:Z("pixelOffsetScaleByDistance"),imageSubRegion:Z("imageSubRegion"),distanceDisplayCondition:Z("distanceDisplayCondition"),disableDepthTestDistance:Z("disableDepthTestDistance")});OE.prototype.clone=function(e){return g(e)?(e.show=this._show,e.image=this._image,e.scale=this._scale,e.pixelOffset=this._pixelOffset,e.eyeOffset=this._eyeOffset,e.horizontalOrigin=this._horizontalOrigin,e.verticalOrigin=this._verticalOrigin,e.heightReference=this._heightReference,e.color=this._color,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.sizeInMeters=this._sizeInMeters,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.imageSubRegion=this._imageSubRegion,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e.animation=this.animation,e):new OE(this)};OE.prototype.merge=function(e){this.show=T(this._show,e.show),this.image=T(this._image,e.image),this.scale=T(this._scale,e.scale),this.pixelOffset=T(this._pixelOffset,e.pixelOffset),this.eyeOffset=T(this._eyeOffset,e.eyeOffset),this.horizontalOrigin=T(this._horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=T(this._verticalOrigin,e.verticalOrigin),this.heightReference=T(this._heightReference,e.heightReference),this.color=T(this._color,e.color),this.rotation=T(this._rotation,e.rotation),this.alignedAxis=T(this._alignedAxis,e.alignedAxis),this.sizeInMeters=T(this._sizeInMeters,e.sizeInMeters),this.width=T(this._width,e.width),this.height=T(this._height,e.height),this.scaleByDistance=T(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=T(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=T(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.imageSubRegion=T(this._imageSubRegion,e.imageSubRegion),this.distanceDisplayCondition=T(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this._disableDepthTestDistance,e.disableDepthTestDistance),this.animation=T(this.animation,e.animation)};var dD=OE;function NC(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(NC.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color")});NC.prototype.getType=function(e){return"Color"};NC.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t};NC.prototype.equals=function(e){return this===e||e instanceof NC&&_e.equals(this._color,e._color)};var NE=NC;var N0e=new X(1,1),B0e=!1,F0e=K.WHITE;function BC(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}Object.defineProperties(BC.prototype,{isConstant:{get:function(){return _e.isConstant(this._image)&&_e.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:Z("image"),repeat:Z("repeat"),color:Z("color"),transparent:Z("transparent")});BC.prototype.getType=function(e){return"Image"};BC.prototype.getValue=function(e,t){return g(t)||(t={}),t.image=_e.getValueOrUndefined(this._image,e),t.repeat=_e.getValueOrClonedDefault(this._repeat,e,N0e,t.repeat),t.color=_e.getValueOrClonedDefault(this._color,e,F0e,t.color),_e.getValueOrDefault(this._transparent,e,B0e)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t};BC.prototype.equals=function(e){return this===e||e instanceof BC&&_e.equals(this._image,e._image)&&_e.equals(this._repeat,e._repeat)&&_e.equals(this._color,e._color)&&_e.equals(this._transparent,e._transparent)};var BE=BC;function z0e(e){if(e instanceof K)return new NE(e);if(typeof e=="string"||e instanceof vt||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){let t=new BE;return t.image=e,t}}function V0e(e,t){return Z(e,t,z0e)}var Vo=V0e;function FE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(FE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),dimensions:Z("dimensions"),heightReference:Z("heightReference"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});FE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.dimensions=this.dimensions,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new FE(this)};FE.prototype.merge=function(e){this.show=T(this.show,e.show),this.dimensions=T(this.dimensions,e.dimensions),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var pD=FE;var k0e={FIXED:0,INERTIAL:1},za=Object.freeze(k0e);function FC(){Le.throwInstantiationError()}Object.defineProperties(FC.prototype,{isConstant:{get:Le.throwInstantiationError},definitionChanged:{get:Le.throwInstantiationError},referenceFrame:{get:Le.throwInstantiationError}});FC.prototype.getValue=Le.throwInstantiationError;FC.prototype.getValueInReferenceFrame=Le.throwInstantiationError;FC.prototype.equals=Le.throwInstantiationError;var Z2=new te;FC.convertToReferenceFrame=function(e,t,n,r,o){if(!g(t))return t;if(g(o)||(o=new x),n===r)return x.clone(t,o);let a=Cn.computeIcrfToFixedMatrix(e,Z2);if(g(a)||(a=Cn.computeTemeToPseudoFixedMatrix(e,Z2)),n===za.INERTIAL)return te.multiplyByVector(a,t,o);if(n===za.FIXED)return te.multiplyByVector(te.transpose(a,Z2),t,o)};var zC=FC;function $_(e,t){this._definitionChanged=new xe,this._value=x.clone(e),this._referenceFrame=T(t,za.FIXED)}Object.defineProperties($_.prototype,{isConstant:{get:function(){return!g(this._value)||this._referenceFrame===za.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});$_.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,za.FIXED,t)};$_.prototype.setValue=function(e,t){let n=!1;x.equals(this._value,e)||(n=!0,this._value=x.clone(e)),g(t)&&this._referenceFrame!==t&&(n=!0,this._referenceFrame=t),n&&this._definitionChanged.raiseEvent(this)};$_.prototype.getValueInReferenceFrame=function(e,t,n){return zC.convertToReferenceFrame(e,this._value,this._referenceFrame,t,n)};$_.prototype.equals=function(e){return this===e||e instanceof $_&&x.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame};var VC=$_;function zE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(zE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),positions:Z("positions"),width:Z("width"),height:Z("height"),heightReference:Z("heightReference"),extrudedHeight:Z("extrudedHeight"),extrudedHeightReference:Z("extrudedHeightReference"),cornerType:Z("cornerType"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition"),classificationType:Z("classificationType"),zIndex:Z("zIndex")});zE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new zE(this)};zE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.width=T(this.width,e.width),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.cornerType=T(this.cornerType,e.cornerType),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var mD=zE;function G0e(e){return e}function U0e(e,t){return Z(e,t,G0e)}var cd=U0e;function VE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(VE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),length:Z("length"),topRadius:Z("topRadius"),bottomRadius:Z("bottomRadius"),heightReference:Z("heightReference"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),numberOfVerticalLines:Z("numberOfVerticalLines"),slices:Z("slices"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});VE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.length=this.length,e.topRadius=this.topRadius,e.bottomRadius=this.bottomRadius,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new VE(this)};VE.prototype.merge=function(e){this.show=T(this.show,e.show),this.length=T(this.length,e.length),this.topRadius=T(this.topRadius,e.topRadius),this.bottomRadius=T(this.bottomRadius,e.bottomRadius),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=T(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=T(this.slices,e.slices),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var gD=VE;function kE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(kE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),semiMajorAxis:Z("semiMajorAxis"),semiMinorAxis:Z("semiMinorAxis"),height:Z("height"),heightReference:Z("heightReference"),extrudedHeight:Z("extrudedHeight"),extrudedHeightReference:Z("extrudedHeightReference"),rotation:Z("rotation"),stRotation:Z("stRotation"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),numberOfVerticalLines:Z("numberOfVerticalLines"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition"),classificationType:Z("classificationType"),zIndex:Z("zIndex")});kE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new kE(this)};kE.prototype.merge=function(e){this.show=T(this.show,e.show),this.semiMajorAxis=T(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=T(this.semiMinorAxis,e.semiMinorAxis),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=T(this.rotation,e.rotation),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=T(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var _D=kE;function GE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._innerRadii=void 0,this._innerRadiiSubscription=void 0,this._minimumClock=void 0,this._minimumClockSubscription=void 0,this._maximumClock=void 0,this._maximumClockSubscription=void 0,this._minimumCone=void 0,this._minimumConeSubscription=void 0,this._maximumCone=void 0,this._maximumConeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(GE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),radii:Z("radii"),innerRadii:Z("innerRadii"),minimumClock:Z("minimumClock"),maximumClock:Z("maximumClock"),minimumCone:Z("minimumCone"),maximumCone:Z("maximumCone"),heightReference:Z("heightReference"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),stackPartitions:Z("stackPartitions"),slicePartitions:Z("slicePartitions"),subdivisions:Z("subdivisions"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});GE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.radii=this.radii,e.innerRadii=this.innerRadii,e.minimumClock=this.minimumClock,e.maximumClock=this.maximumClock,e.minimumCone=this.minimumCone,e.maximumCone=this.maximumCone,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new GE(this)};GE.prototype.merge=function(e){this.show=T(this.show,e.show),this.radii=T(this.radii,e.radii),this.innerRadii=T(this.innerRadii,e.innerRadii),this.minimumClock=T(this.minimumClock,e.minimumClock),this.maximumClock=T(this.maximumClock,e.maximumClock),this.minimumCone=T(this.minimumCone,e.minimumCone),this.maximumCone=T(this.maximumCone,e.maximumCone),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.stackPartitions=T(this.stackPartitions,e.stackPartitions),this.slicePartitions=T(this.slicePartitions,e.slicePartitions),this.subdivisions=T(this.subdivisions,e.subdivisions),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var yD=GE;function UE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(UE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),text:Z("text"),font:Z("font"),style:Z("style"),scale:Z("scale"),showBackground:Z("showBackground"),backgroundColor:Z("backgroundColor"),backgroundPadding:Z("backgroundPadding"),pixelOffset:Z("pixelOffset"),eyeOffset:Z("eyeOffset"),horizontalOrigin:Z("horizontalOrigin"),verticalOrigin:Z("verticalOrigin"),heightReference:Z("heightReference"),fillColor:Z("fillColor"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),translucencyByDistance:Z("translucencyByDistance"),pixelOffsetScaleByDistance:Z("pixelOffsetScaleByDistance"),scaleByDistance:Z("scaleByDistance"),distanceDisplayCondition:Z("distanceDisplayCondition"),disableDepthTestDistance:Z("disableDepthTestDistance")});UE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.text=this.text,e.font=this.font,e.style=this.style,e.scale=this.scale,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.pixelOffset=this.pixelOffset,e.eyeOffset=this.eyeOffset,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.heightReference=this.heightReference,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new UE(this)};UE.prototype.merge=function(e){this.show=T(this.show,e.show),this.text=T(this.text,e.text),this.font=T(this.font,e.font),this.style=T(this.style,e.style),this.scale=T(this.scale,e.scale),this.showBackground=T(this.showBackground,e.showBackground),this.backgroundColor=T(this.backgroundColor,e.backgroundColor),this.backgroundPadding=T(this.backgroundPadding,e.backgroundPadding),this.pixelOffset=T(this.pixelOffset,e.pixelOffset),this.eyeOffset=T(this.eyeOffset,e.eyeOffset),this.horizontalOrigin=T(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=T(this.verticalOrigin,e.verticalOrigin),this.heightReference=T(this.heightReference,e.heightReference),this.fillColor=T(this.fillColor,e.fillColor),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.translucencyByDistance=T(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=T(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=T(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this.disableDepthTestDistance,e.disableDepthTestDistance)};var vD=UE;var H0e=new x(1,1,1),q0e=x.ZERO,W0e=je.IDENTITY;function VW(e,t,n){this.translation=x.clone(T(e,q0e)),this.rotation=je.clone(T(t,W0e)),this.scale=x.clone(T(n,H0e))}VW.prototype.equals=function(e){return this===e||g(e)&&x.equals(this.translation,e.translation)&&je.equals(this.rotation,e.rotation)&&x.equals(this.scale,e.scale)};var Q2=VW;var J2=new Q2;function HE(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale}Object.defineProperties(HE.prototype,{isConstant:{get:function(){return _e.isConstant(this._translation)&&_e.isConstant(this._rotation)&&_e.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:Z("translation"),rotation:Z("rotation"),scale:Z("scale")});HE.prototype.getValue=function(e,t){return g(t)||(t=new Q2),t.translation=_e.getValueOrClonedDefault(this._translation,e,J2.translation,t.translation),t.rotation=_e.getValueOrClonedDefault(this._rotation,e,J2.rotation,t.rotation),t.scale=_e.getValueOrClonedDefault(this._scale,e,J2.scale,t.scale),t};HE.prototype.equals=function(e){return this===e||e instanceof HE&&_e.equals(this._translation,e._translation)&&_e.equals(this._rotation,e._rotation)&&_e.equals(this._scale,e._scale)};var CD=HE;function zm(e,t){this._propertyNames=[],this._definitionChanged=new xe,g(e)&&this.merge(e,t)}Object.defineProperties(zm.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){let e=this._propertyNames;for(let t=0,n=e.length;t<n;t++)if(!_e.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});zm.prototype.hasProperty=function(e){return this._propertyNames.indexOf(e)!==-1};function Y0e(e){return new cp(e)}zm.prototype.addProperty=function(e,t,n){this._propertyNames.push(e),Object.defineProperty(this,e,Z(e,!0,T(n,Y0e))),g(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)};zm.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e],this._definitionChanged.raiseEvent(this)};zm.prototype.getValue=function(e,t){g(t)||(t={});let n=this._propertyNames;for(let r=0,o=n.length;r<o;r++){let a=n[r];t[a]=_e.getValueOrUndefined(this[a],e,t[a])}return t};zm.prototype.merge=function(e,t){let n=this._propertyNames,r=g(e._propertyNames)?e._propertyNames:Object.keys(e);for(let o=0,a=r.length;o<a;o++){let s=r[o],u=this[s],l=e[s];u===void 0&&n.indexOf(s)===-1&&this.addProperty(s,void 0,t),l!==void 0&&(u!==void 0?g(u)&&g(u.merge)&&u.merge(l):g(l)&&g(l.merge)&&g(l.clone)?this[s]=l.clone():this[s]=l)}};function X0e(e,t){let n=e._propertyNames,r=t._propertyNames,o=n.length;if(o!==r.length)return!1;for(let a=0;a<o;++a){let s=n[a];if(r.indexOf(s)===-1||!_e.equals(e[s],t[s]))return!1}return!0}zm.prototype.equals=function(e){return this===e||e instanceof zm&&X0e(this,e)};var fd=zm;function kW(e){return new CD(e)}function j0e(e){return new fd(e,kW)}function K0e(e){return new fd(e)}function qE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._clampAnimations=void 0,this._clampAnimationsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._articulations=void 0,this._articulationsSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(qE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),uri:Z("uri"),scale:Z("scale"),minimumPixelSize:Z("minimumPixelSize"),maximumScale:Z("maximumScale"),incrementallyLoadTextures:Z("incrementallyLoadTextures"),runAnimations:Z("runAnimations"),clampAnimations:Z("clampAnimations"),shadows:Z("shadows"),heightReference:Z("heightReference"),silhouetteColor:Z("silhouetteColor"),silhouetteSize:Z("silhouetteSize"),color:Z("color"),colorBlendMode:Z("colorBlendMode"),colorBlendAmount:Z("colorBlendAmount"),imageBasedLightingFactor:Z("imageBasedLightingFactor"),lightColor:Z("lightColor"),distanceDisplayCondition:Z("distanceDisplayCondition"),nodeTransformations:Z("nodeTransformations",void 0,j0e),articulations:Z("articulations",void 0,K0e),clippingPlanes:Z("clippingPlanes")});qE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.uri=this.uri,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.heightReference=this._heightReference,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.imageBasedLightingFactor=this.imageBasedLightingFactor,e.lightColor=this.lightColor,e.distanceDisplayCondition=this.distanceDisplayCondition,e.nodeTransformations=this.nodeTransformations,e.articulations=this.articulations,e.clippingPlanes=this.clippingPlanes,e):new qE(this)};qE.prototype.merge=function(e){this.show=T(this.show,e.show),this.uri=T(this.uri,e.uri),this.scale=T(this.scale,e.scale),this.minimumPixelSize=T(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=T(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=T(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.runAnimations=T(this.runAnimations,e.runAnimations),this.clampAnimations=T(this.clampAnimations,e.clampAnimations),this.shadows=T(this.shadows,e.shadows),this.heightReference=T(this.heightReference,e.heightReference),this.silhouetteColor=T(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=T(this.silhouetteSize,e.silhouetteSize),this.color=T(this.color,e.color),this.colorBlendMode=T(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=T(this.colorBlendAmount,e.colorBlendAmount),this.imageBasedLightingFactor=T(this.imageBasedLightingFactor,e.imageBasedLightingFactor),this.lightColor=T(this.lightColor,e.lightColor),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.clippingPlanes=T(this.clippingPlanes,e.clippingPlanes);let t=e.nodeTransformations;if(g(t)){let r=this.nodeTransformations;g(r)?r.merge(t):this.nodeTransformations=new fd(t,kW)}let n=e.articulations;if(g(n)){let r=this.articulations;g(r)?r.merge(n):this.articulations=new fd(n)}};var xD=qE;function WE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._maximumScreenSpaceError=void 0,this._maximumScreenSpaceErrorSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(WE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),uri:Z("uri"),maximumScreenSpaceError:Z("maximumScreenSpaceError")});WE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.uri=this.uri,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e):new WE(this)};WE.prototype.merge=function(e){this.show=T(this.show,e.show),this.uri=T(this.uri,e.uri),this.maximumScreenSpaceError=T(this.maximumScreenSpaceError,e.maximumScreenSpaceError)};var wD=WE;function YE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(YE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),leadTime:Z("leadTime"),trailTime:Z("trailTime"),width:Z("width"),resolution:Z("resolution"),material:Vo("material"),distanceDisplayCondition:Z("distanceDisplayCondition")});YE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.width=this.width,e.resolution=this.resolution,e.material=this.material,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new YE(this)};YE.prototype.merge=function(e){this.show=T(this.show,e.show),this.leadTime=T(this.leadTime,e.leadTime),this.trailTime=T(this.trailTime,e.trailTime),this.width=T(this.width,e.width),this.resolution=T(this.resolution,e.resolution),this.material=T(this.material,e.material),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var ED=YE;function XE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(XE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),plane:Z("plane"),dimensions:Z("dimensions"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});XE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.plane=this.plane,e.dimensions=this.dimensions,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new XE(this)};XE.prototype.merge=function(e){this.show=T(this.show,e.show),this.plane=T(this.plane,e.plane),this.dimensions=T(this.dimensions,e.dimensions),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var GW=XE;function jE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(jE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),pixelSize:Z("pixelSize"),heightReference:Z("heightReference"),color:Z("color"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),scaleByDistance:Z("scaleByDistance"),translucencyByDistance:Z("translucencyByDistance"),distanceDisplayCondition:Z("distanceDisplayCondition"),disableDepthTestDistance:Z("disableDepthTestDistance")});jE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.pixelSize=this.pixelSize,e.heightReference=this.heightReference,e.color=this.color,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new jE(this)};jE.prototype.merge=function(e){this.show=T(this.show,e.show),this.pixelSize=T(this.pixelSize,e.pixelSize),this.heightReference=T(this.heightReference,e.heightReference),this.color=T(this.color,e.color),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.scaleByDistance=T(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=T(this._translucencyByDistance,e.translucencyByDistance),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this.disableDepthTestDistance,e.disableDepthTestDistance)};var TD=jE;function Z0e(e,t){this.positions=g(e)?e:[],this.holes=g(t)?t:[]}var ey=Z0e;function Q0e(e){return Array.isArray(e)&&(e=new ey(e)),new cp(e)}function KE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._textureCoordinates=void 0,this._textureCoordinatesSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(KE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),hierarchy:Z("hierarchy",void 0,Q0e),height:Z("height"),heightReference:Z("heightReference"),extrudedHeight:Z("extrudedHeight"),extrudedHeightReference:Z("extrudedHeightReference"),stRotation:Z("stRotation"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),perPositionHeight:Z("perPositionHeight"),closeTop:Z("closeTop"),closeBottom:Z("closeBottom"),arcType:Z("arcType"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition"),classificationType:Z("classificationType"),zIndex:Z("zIndex"),textureCoordinates:Z("textureCoordinates")});KE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.hierarchy=this.hierarchy,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.arcType=this.arcType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e.textureCoordinates=this.textureCoordinates,e):new KE(this)};KE.prototype.merge=function(e){this.show=T(this.show,e.show),this.hierarchy=T(this.hierarchy,e.hierarchy),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.perPositionHeight=T(this.perPositionHeight,e.perPositionHeight),this.closeTop=T(this.closeTop,e.closeTop),this.closeBottom=T(this.closeBottom,e.closeBottom),this.arcType=T(this.arcType,e.arcType),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex),this.textureCoordinates=T(this.textureCoordinates,e.textureCoordinates)};var SD=KE;function ZE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(ZE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),positions:Z("positions"),width:Z("width"),granularity:Z("granularity"),material:Vo("material"),depthFailMaterial:Vo("depthFailMaterial"),arcType:Z("arcType"),clampToGround:Z("clampToGround"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition"),classificationType:Z("classificationType"),zIndex:Z("zIndex")});ZE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.granularity=this.granularity,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.arcType=this.arcType,e.clampToGround=this.clampToGround,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new ZE(this)};ZE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.width=T(this.width,e.width),this.granularity=T(this.granularity,e.granularity),this.material=T(this.material,e.material),this.depthFailMaterial=T(this.depthFailMaterial,e.depthFailMaterial),this.arcType=T(this.arcType,e.arcType),this.clampToGround=T(this.clampToGround,e.clampToGround),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var AD=ZE;function QE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(QE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),positions:Z("positions"),shape:Z("shape"),cornerType:Z("cornerType"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});QE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.positions=this.positions,e.shape=this.shape,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new QE(this)};QE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.shape=T(this.shape,e.shape),this.cornerType=T(this.cornerType,e.cornerType),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var UW=QE;function JE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(JE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),coordinates:Z("coordinates"),height:Z("height"),heightReference:Z("heightReference"),extrudedHeight:Z("extrudedHeight"),extrudedHeightReference:Z("extrudedHeightReference"),rotation:Z("rotation"),stRotation:Z("stRotation"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition"),classificationType:Z("classificationType"),zIndex:Z("zIndex")});JE.prototype.clone=function(e){return g(e)?(e.show=this.show,e.coordinates=this.coordinates,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new JE(this)};JE.prototype.merge=function(e){this.show=T(this.show,e.show),this.coordinates=T(this.coordinates,e.coordinates),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=T(this.rotation,e.rotation),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var bD=JE;function $E(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties($E.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Z("show"),positions:Z("positions"),minimumHeights:Z("minimumHeights"),maximumHeights:Z("maximumHeights"),granularity:Z("granularity"),fill:Z("fill"),material:Vo("material"),outline:Z("outline"),outlineColor:Z("outlineColor"),outlineWidth:Z("outlineWidth"),shadows:Z("shadows"),distanceDisplayCondition:Z("distanceDisplayCondition")});$E.prototype.clone=function(e){return g(e)?(e.show=this.show,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new $E(this)};$E.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.minimumHeights=T(this.minimumHeights,e.minimumHeights),this.maximumHeights=T(this.maximumHeights,e.maximumHeights),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var ID=$E;var J0e=new le;function $0e(e){return new VC(e)}function e_e(e){return Z(e,void 0,$0e)}function eu(e,t){return Z(e,void 0,function(n){return n instanceof t?n:new t(n)})}function pp(e){e=T(e,T.EMPTY_OBJECT);let t=e.id;g(t)||(t=Ci()),this._availability=void 0,this._id=t,this._definitionChanged=new xe,this._name=e.name,this._show=T(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function $2(e,t,n){let r=t.length;for(let o=0;o<r;o++){let a=t[o],s=a._show;(!n&&s)!==(n&&s)&&$2(a,a._children,n)}e._definitionChanged.raiseEvent(e,"isShowing",n,!n)}Object.defineProperties(pp.prototype,{availability:cd("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:cd("name"),show:{get:function(){return this._show},set:function(e){if(e===this._show)return;let t=this.isShowing;this._show=e;let n=this.isShowing;t!==n&&$2(this,this._children,n),this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!g(this.entityCollection)||this.entityCollection.show)&&(!g(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){let t=this._parent;if(t===e)return;let n=this.isShowing;if(g(t)){let o=t._children.indexOf(this);t._children.splice(o,1)}this._parent=e,g(e)&&e._children.push(this);let r=this.isShowing;n!==r&&$2(this,this._children,r),this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:eu("billboard",dD),box:eu("box",pD),corridor:eu("corridor",mD),cylinder:eu("cylinder",gD),description:Z("description"),ellipse:eu("ellipse",_D),ellipsoid:eu("ellipsoid",yD),label:eu("label",vD),model:eu("model",xD),tileset:eu("tileset",wD),orientation:Z("orientation"),path:eu("path",ED),plane:eu("plane",GW),point:eu("point",TD),polygon:eu("polygon",SD),polyline:eu("polyline",AD),polylineVolume:eu("polylineVolume",UW),properties:eu("properties",fd),position:e_e("position"),rectangle:eu("rectangle",bD),viewFrom:Z("viewFrom"),wall:eu("wall",ID)});pp.prototype.isAvailable=function(e){let t=this._availability;return!g(t)||t.contains(e)};pp.prototype.addProperty=function(e){this._propertyNames.push(e),Object.defineProperty(this,e,cd(e,!0))};pp.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e]};pp.prototype.merge=function(e){this.name=T(this.name,e.name),this.availability=T(this.availability,e.availability);let t=this._propertyNames,n=g(e._propertyNames)?e._propertyNames:Object.keys(e),r=n.length;for(let o=0;o<r;o++){let a=n[o];if(a==="parent"||a==="name"||a==="availability")continue;let s=this[a],u=e[a];!g(s)&&t.indexOf(a)===-1&&this.addProperty(a),g(u)&&(g(s)?g(s.merge)&&s.merge(u):g(u.merge)&&g(u.clone)?this[a]=u.clone():this[a]=u)}};var HW=new te,qW=new x,WW=new je;pp.prototype.computeModelMatrix=function(e,t){let n=_e.getValueOrUndefined(this._position,e,qW);if(!g(n))return;let r=_e.getValueOrUndefined(this._orientation,e,WW);return g(r)?t=G.fromRotationTranslation(te.fromQuaternion(r,HW),n,t):t=Cn.eastNorthUpToFixedFrame(n,void 0,t),t};pp.prototype.computeModelMatrixForHeightReference=function(e,t,n,r,o){let a=_e.getValueOrDefault(t,e,Lt.NONE),s=_e.getValueOrUndefined(this._position,e,qW);if(a===Lt.NONE||!g(s)||x.equalsEpsilon(s,x.ZERO,F.EPSILON8))return this.computeModelMatrix(e,o);let u=r.cartesianToCartographic(s,J0e);a===Lt.CLAMP_TO_GROUND?u.height=n:u.height+=n,s=r.cartographicToCartesian(u,s);let l=_e.getValueOrUndefined(this._orientation,e,WW);return g(l)?o=G.fromRotationTranslation(te.fromQuaternion(l,HW),s,o):o=Cn.eastNorthUpToFixedFrame(s,void 0,o),o};pp.supportsMaterialsforEntitiesOnTerrain=function(e){return zW.supportsMaterials(e)};pp.supportsPolylinesOnTerrain=function(e){return rW.isSupported(e)};var us=pp;var YW={};function eT(e,t){g(YW[e])||(YW[e]=!0,console.warn(T(t,e)))}eT.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";eT.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored";eT.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored";eT.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var f0=eT;function t_e(e,t){f0(e,t)}var ul=t_e;function ef(e,t){this._content=e,this._batchId=t,this._color=void 0}Object.defineProperties(ef.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return g(this._color)||(this._color=new K),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},polylinePositions:{get:function(){if(!!g(this._content.getPolylinePositions))return this._content.getPolylinePositions(this._batchId)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},featureId:{get:function(){return this._batchId}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}});ef.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)};ef.prototype.getPropertyNames=function(e){return ul("Cesium3DTileFeature.getPropertyNames","Cesium3DTileFeature.getPropertyNames was deprecated in CesiumJS 1.95 and will be removed in 1.98. Use Cesium3DTileFeature.getPropertyIds instead"),this._content.batchTable.getPropertyIds(this._batchId,e)};ef.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)};ef.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)};ef.getPropertyInherited=function(e,t,n){let r=e.batchTable;if(g(r)){if(r.hasPropertyBySemantic(t,n))return r.getPropertyBySemantic(t,n);if(r.hasProperty(t,n))return r.getProperty(t,n)}let o=e.metadata;if(g(o)){if(o.hasPropertyBySemantic(n))return o.getPropertyBySemantic(n);if(o.hasProperty(n))return o.getProperty(n)}let a=e.tile,s=a.metadata;if(g(s)){if(s.hasPropertyBySemantic(n))return s.getPropertyBySemantic(n);if(s.hasProperty(n))return s.getProperty(n)}let u;if(g(a.implicitSubtree)&&(u=a.implicitSubtree.metadata),g(u)){if(u.hasPropertyBySemantic(n))return u.getPropertyBySemantic(n);if(u.hasProperty(n))return u.getProperty(n)}let l=g(e.group)?e.group.metadata:void 0;if(g(l)){if(l.hasPropertyBySemantic(n))return l.getPropertyBySemantic(n);if(l.hasProperty(n))return l.getProperty(n)}let c=e.tileset.metadata;if(g(c)){if(c.hasPropertyBySemantic(n))return c.getPropertyBySemantic(n);if(c.hasProperty(n))return c.getProperty(n)}};ef.prototype.getPropertyInherited=function(e){return ef.getPropertyInherited(this._content,this._batchId,e)};ef.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0};ef.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)};ef.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)};ef.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var XW=ef;var h0=[];function d0(e){this._handler=new e0(e.canvas,!0),this._viewer=e,this._state={mouseMove:!1}}d0.prototype.setListener=function(e,t,n){h0.length>0&&this.removeListener(),typeof t!="function"&&(n=t,t=void 0),n_e(this,e,t,n)};d0.prototype.moveListener=function(e){if(!g(e))return;Ds.typeOf.func("moveListener",e),h0.push(_n.MOUSE_MOVE);let t=this._handler,n=this._viewer.scene,r=this._state;t.setInputAction(function(o){if(r.mouseMove)return;let a=DD(n,o);e(a)},_n.MOUSE_MOVE)};d0.prototype.removeMoveListener=function(){this._handler.removeInputAction(_n.MOUSE_MOVE)};d0.prototype.removeListener=function(){for(;h0.length!==0;){let e=h0.pop();this._handler.removeInputAction(e)}};d0.prototype.setInputAction=function(e,t,n){this._handler.setInputAction(e,t,n)};d0.prototype.removeInputAction=function(e,t){this._handler.removeInputAction(e,t)};d0.prototype.destroy=function(){this._handler.destroy()};function n_e(e,t,n,r){r===G_.LEFT_RIGHT_CLICK?r_e(e,t,n):r===G_.LEFT_DOUBLE_CLICK&&i_e(e,t,n)}function r_e(e,t,n){let r=e._handler;h0.push(_n.LEFT_UP),h0.push(_n.RIGHT_CLICK),r.setInputAction(function(o){if(g(t)){let a=DD(e._viewer.scene,o);t(Ht(a))}},_n.LEFT_UP),r.setInputAction(function(o){if(g(n)){let a=DD(e._viewer.scene,o);n(Ht(a))}},_n.RIGHT_CLICK)}function i_e(e,t,n){let r=e._handler;h0.push(_n.LEFT_CLICK),h0.push(_n.LEFT_DOUBLE_CLICK);let o=!0,a,s=Date.now();r.setInputAction(function(l){let c=Date.now(),f=c-s;if(s=c,!(f<500&&!o)){if(f<500&&o){a!==void 0&&(a=a()),a=e._viewer.scene._preUpdate.addEventListener(function(){u(l),a=a()});return}o=!0,u(l)}},_n.LEFT_CLICK),r.setInputAction(function(l){a!==void 0&&(a=a()),o=!1,u(l)},_n.LEFT_DOUBLE_CLICK);function u(l){let c=DD(e._viewer.scene,l);o?g(t)&&t(c):g(n)&&n(c)}}function o_e(e,t){let n={},r=e.pick(t);if(!!g(r))return r instanceof XW?(n.type="tilt",n.value=r):r.id instanceof us?(n.type="entity",n.value=r.id):(n.type="primitive",n.pick=r.primitive),Ht(n)}function DD(e,t){let n={};return n.event=Ht(t),n.pick=o_e(e,g(t.position)?t.position:t.endPosition),n.cartesian3=a_e(e,g(t.position)?t.position:t.endPosition),Ht(n)}function a_e(e,t){let n=e.camera,r;e.pickPositionSupported&&(r=e.pickPositionWorldCoordinates(t));let o=n.getPickRay(t),a=e.globe.pick(o,e),s=g(r)?x.distance(n._positionWC,r):Number.POSITIVE_INFINITY,u=g(a)?x.distance(n._positionWC,a):Number.POSITIVE_INFINITY;return s<u&&e.mode!==Ne.SCENE2D?r:a}var PD=d0;function kC(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new xe,this.setCallback(e,t)}Object.defineProperties(kC.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});kC.prototype.getValue=function(e,t){return this._callback(e,t)};kC.prototype.setCallback=function(e,t){let n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)};kC.prototype.equals=function(e){return this===e||e instanceof kC&&this._callback===e._callback&&this._isConstant===e._isConstant};var tu=kC;var ty=[];function p0(e){this._viewer=e,this._aggregator=new PD(e),this._type=void 0,this._stop=!1,this._options=void 0,this._callback=void 0,this._isDestroyed=!1}Object.defineProperties(p0.prototype,{stop:{set:function(e){Ds.typeOf.bool("stop",e),this._stop=e},get:function(){return this._stop}},type:{get:function(){return this._type}},callback:{get:function(){return this._callback},set:function(e){Ds.typeOf.func("callback",e),this._callback=e}}});p0.prototype.draw=function(e,t,n,r){Ds.typeOf.object("option",e),Ds.typeOf.func("finish",t),Ds.typeOf.number("type",n),r=T(r,!1),this._options=e,this._callback=t,this._type=n,this._stop=!1,s_e(this,e,r)};p0.prototype.destroy=function(){this.clear(),this._aggregator.destroy(),st(this),this._isDestroyed=!0};p0.prototype.remove=function(){this.clear(),this._stop=!0,this._aggregator.removeListener()};p0.prototype.isDestroyed=function(){return this._isDestroyed};p0.prototype.clear=function(){for(let e=0;e<ty.length;e++)this._viewer.entities.remove(ty[e]);ty.length=0};p0.prototype.clearEntity=function(e){for(let t=0;t<ty.length;t++)e===ty[t].name&&(this._viewer.entities.remove(ty[t]),t--)};function s_e(e,t,n){let r=e._aggregator,o=e._viewer,a=[],s,u=!1;r.setListener(function(l){if(g(l.cartesian3)){if(e._stop)return;if(a.length===0){if(e._type===od.POLYGON){if(l.cartesian3.z!==null){let c=[];a=c,a.push(l.cartesian3),t.hierarchy=new tu(function(){let f=c.length;return f>2&&c[f-2].equals(c[f-1])&&c.splice(f-1,1),new ey(c)},!1),s=new us({polygon:t}),r._state.mouseMove=!1}}else if(e._type===od.POLYLINE){let c=[];a=c,a.push(l.cartesian3),t.positions=new tu(function(){let f=c[c.length-1]instanceof Array,h=c[c.length-1][0];return f&&(c.splice(c.length-1,1),c.push(h)),c},!1),t.name!==void 0?s=new us({polyline:t,name:t.name}):s=new us({polyline:t}),r._state.mouseMove=!1}else if(e._type===od.POINT)s=new us({position:l.cartesian3,point:t}),e._callback(s);else if(e._type===od.MEASURELINE){let c=[];a=c,a.push(l.cartesian3),t.positions=new tu(function(){let f=c[c.length-1]instanceof Array,h=c[c.length-1][0];return f&&(c.splice(c.length-1,1),c.push(h)),c},!1),s=new us({polyline:t}),r._state.mouseMove=!1}else if(e._type===od.CIRCLE&&l.cartesian3.z!==null){let c=[];a=c,a.push(l.cartesian3),t.semiMinorAxis=new tu(function(){if(c.length>=2)return x.distance(c[0],c[1])},!1),t.semiMajorAxis=new tu(function(){if(c.length>=2)return x.distance(c[0],c[1])},!1),t.name!==void 0?s=new us({position:l.cartesian3,ellipse:t}):s=new us({position:l.cartesian3,ellipse:t}),r._state.mouseMove=!1}ty.push(o.entities.add(s))}e._type!==od.CIRCLE&&(u=!0)}},function(){e._type!==od.POINT&&(e._stop||(n&&(e._stop=!0),g(s.positions)||(s.positions=a),a=[],e._callback(s)))},G_.LEFT_RIGHT_CLICK),r.moveListener(function(l){let c=a.length;if(c===0){r._state.mouseMove=!0;return}if(g(l.cartesian3)){let f=l.cartesian3;c===1?a.push(f):c>1&&(u?e._type===od.MEASURELINE?a.push([f]):a.push(f):a[c-1]=f),u=!1}})}var jW=p0;function ny(e){this._url=u_e(e.url),this._width=e.width,this._height=e.height,this._id=Ci(),this._canvas=new OffscreenCanvas(this._width||160,this._height||90),this._canvasContext2D=this._canvas.getContext("2d"),this._frames=[],this._preUpdate=new Cesium.Event,this._postUpdate=new Cesium.Event,this._ready=!1,this._readyPromise=Bo(),this._nextFrameIndex=0,this._lastFrameTime=null,this._fullData=!1,this._play=!0,this._loopPlayState=!0,this._stopPlayCallbackFunc=void 0,e.fps&&(this._delay=1e3/e.fps,this._useCustomFPS=!0),this._load()}Object.defineProperties(ny.prototype,{url:{set:function(e){this._url=e},get:function(){return this._url}},canvas:{get:function(){return this._canvas}},context2D:{get:function(){return this._canvasContext2D}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},id:{get:function(){return this._id}},width:{get:function(){return this._canvas.width}},height:{get:function(){return this._canvas.height}},fps:{get:function(){let e=1e3/this._delay;return Math.round(e)},set:function(e){if(typeof e!="number"||e<=0)throw new Le("fps\u9700\u8981\u662F\u6B63\u6574\u6570");this._delay=1e3/e}}});ny.prototype._load=function(){let e=this,t=new Worker(La("Workers/parseGif.js"));t.onmessage=function(n){let r=n.data;if(r.finish)e._fullData=!0,t=null;else{let o=r.data;e._frames.push({data:o,delay:r.delay}),e._ready||(e._useCustomFPS||(e._delay=r.delay),g(e._width)||(e._canvas.width=e._width=o.width),g(e._height)||(e._canvas.height=e._height=o.height),e._ready=!0,e._readyPromise.resolve(!0))}},t.postMessage({url:this._url,width:e._width,height:e._height})};ny.prototype.playOnce=function(e){this._loopPlayState=!1,this._stopPlayCallbackFunc=e,this._play=!0,this._updateImageData(0)};ny.prototype.update=function(){if(!!this._ready&&!!this._play)if(!this._lastFrameTime)this._updateImageData(0);else{let e=performance.now()-this._lastFrameTime,t=this._lastFrameIndex,n=t,r=this._frames.length;if(this._useCustomFPS){if(n+=Math.floor(e/this._delay),n>=r&&(this._fullData?n%=r:n=r-1,!this._loopPlayState&&this._stopPlayCallbackFunc)){this._stopPlayCallbackFunc(),this._play=!1;return}}else{let o=this._frames[t].delay;for(;e>o;){if(n===this._frames.length-1){if(!this._loopPlayState&&this._stopPlayCallbackFunc){this._stopPlayCallbackFunc(),this._play=!1;return}if(this._fullData)n=0;else{n=r-1;break}}else++n;e-=o,o=this._frames[n].delay}}n!==t&&this._updateImageData(n)}};ny.prototype._updateImageData=function(e){this._preUpdate.raiseEvent();let t=this._frames[e].data;this._canvasContext2D.clearRect(0,0,this._canvasContext2D.canvas.width,this._canvasContext2D.canvas.height),this._canvasContext2D.putImageData(t,0,0),this._lastFrameIndex=e,this._lastFrameTime=performance.now(),this._postUpdate.raiseEvent()};function u_e(e){if(/^http[s]{0,1}:\/\//.test(e))return e;let t=location.href,n=t.lastIndexOf("/");t=t.substring(0,n),/^\.\//.test(e)&&(e=e.substring(2));let r=/^\.\.\//;for(;r.test(e);)n=t.lastIndexOf("/"),t=t.substring(0,n),e=e.substring(3);return t.concat("/").concat(e)}ny.prototype.destroy=function(){this._canvasContext2D=null,this._canvas=null,this._frames=null,this._preUpdate=null,this._postUpdate=null,this._readyPromise=null};var MD=ny;function Vm(e){if(!(e instanceof Cesium.Viewer))throw new Le("viewer is not a instance of Viewer.");this._viewer=e,this.gifs=new Ga,e.clock.onTick.addEventListener(this.update,this)}Object.defineProperties(Vm.prototype,{length:{get:function(){return this.gif.length}},values:{get:function(){return this.gif.values}}});Vm.prototype.add=function(e){let t;if(e instanceof Cesium.EV_Gif)t=e;else if(typeof e=="object")t=new MD(e);else throw new Le("options is not a object");return t&&this.gifs.set(t._id,t),t};Vm.prototype.contains=function(e){return this.gifs.contains(e)};Vm.prototype.get=function(e){return this.gifs.get(e)};Vm.prototype.remove=function(e){return this.gifs.remove(e.id)};Vm.prototype.removeAll=function(){this.gifs.removeAll()};Vm.prototype.update=function(){let e=this.gifs.values;for(let t=0,n=e.length;t<n;++t)e[t].update()};Vm.prototype.destroy=function(){this._viewer.clock.onTick.removeEventListener(this.update,this),this._viewer=null,this.gifs=null};var KW=Vm;var oy,g0=!1,Si=!1,j,un=0,$,ry=!1,Dn={},Ft,ui,m0=!1,Wa=!1,iy=!0,ND=!1;function ye(e){this.gemotryList=new Cesium.AssociativeArray,this.billboardCollection=new Cesium.BillboardCollection,this.index=0,this.viewer=e,this.viewer.scene.primitives.add(this.billboardCollection),this.viewer.scene.globe.depthTestAgainstTerrain=!1,this.viewer.scene.enableDepthPlane=!0,this.leftClickStartEdit=new Cesium.Event}ye.prototype.drawPolygon=function(e,t){let n=this;Ri(n),n.index++,e.name=`\u591A\u8FB9\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polygon",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=tT(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1);let r=j.polygon.hierarchy.getValue();Ft=rT(e,n.viewer,r),setTimeout(()=>{Ft.show=e.outline.show},10),n.gemotryList.get(e.id).push(Ft),j.callbackFunc=t};ye.prototype.drawCircle=function(e,t){let n=this;return Ri(n),e.geometryType="circle",n.index++,e.name=`\u5706\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=tT(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1),Ft=rT(e,n.viewer),setTimeout(()=>{Ft.show=e.outline.show},10),n.gemotryList.get(e.id).push(Ft),j.callbackFunc=t,e.id};ye.prototype.drawEllipse=function(e,t){let n=this;return Ri(n),n.index++,e.name=`\u692D\u5706${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="ellipse",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=tT(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1),Ft=rT(e,n.viewer),setTimeout(()=>{Ft.show=e.outline.show},10),n.gemotryList.get(e.id).push(Ft),j.callbackFunc=t,e.id};ye.prototype.drawRectangle=function(e,t){let n=this;return Ri(n),n.index++,e.name=`\u77E9\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="rectangle",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=tT(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.show=Cesium.defaultValue(e.outline.show,!1),e.outline.width=Cesium.defaultValue(e.outline.width,1),Ft=rT(e,n.viewer),setTimeout(()=>{Ft.show=e.outline.show},10),n.gemotryList.get(e.id).push(Ft),j.callbackFunc=t,e.id};ye.prototype.drawPolyline=function(e,t){let n=this;return Ri(n),Si=!0,n.index++,e.name=`\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=iT(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ye.prototype.drawPoint=function(e,t){let n=this;return Ri(n),n.index++,e.name=`\u70B9${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="point",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=l_e(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ye.prototype.drawSector=function(e,t){let n=this;return Ri(n),n.index++,e.name=`\u6247\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="sector",e.attr!=null&&(e.attr.height=Cesium.defaultValue(e.attr.height,1e3)),e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=tT(e,n.viewer),Si=!0,n.gemotryList.set(e.id,[j]),Ft=rT(e,n.viewer),e.extrudedHeight&&(e.outline.show=!1),setTimeout(()=>{Ft.show=e.outline.show},10),n.gemotryList.get(e.id).push(Ft),j.callbackFunc=t,e.id};ye.prototype.drawArrowLine=function(e,t){let n=this;Ri(n),Si=!0,n.index++,e.name=`\u5355\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowLine_single"),j=iT(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=h_e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ye.prototype.drawArrowCurve=function(e,t){let n=this;Ri(n),Si=!0,n.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),e.lineStyle="curve",j=iT(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=g_e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ye.prototype.drawArrowTriangle=function(e,t){let n=this;Ri(n),Si=!0,n.index++,e.name=`\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),j=iT(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=d_e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ye.prototype.drawArrowCurveTriangle=function(e,t){let n=this;Ri(n),Si=!0,n.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),e.lineStyle="curve",j=iT(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=y_e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ye.prototype.drawCurve=function(e,t){let n=this;return Ri(n),Si=!0,n.index++,e.name="\u5706\u5F27"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="curve",j=C_e(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ye.prototype.drawCurveByAttr=function(e,t){let n=this;Ri(n),e.geometryType="curve",n.index++;let r=hd(e.geometryType,n.index);e.name=r;let o=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=o;let a=Io(e);return j=f_e(e,n.viewer,a),n.gemotryList.set(o,[j]),Si=!1,o};ye.prototype.drawBezierWall=function(e,t){let n=this;return e.geometryType="bezierWall",e.name="\u8D1D\u585E\u5C14\u66F2\u7EBF\u4F53"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),Ri(n),Si=!0,n.index++,j=FD(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ye.prototype.drawCurveWall=function(e,t){let n=this;return e.geometryType="curveWall",e.name="\u5706\u5F27\u4F53"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),Ri(n),Si=!0,n.index++,j=FD(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ye.prototype.drawCurveWallByAttr=function(e){let t=this;Ri(t),e.geometryType="curveWall",t.index++,e.name="\u5706\u5F27\u4F53"+t.index;let n=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=n;let r=Io(e);return e.byAttr=!0,j=FD(e,t.viewer,r),t.gemotryList.set(n,[j]),Si=!1,n};ye.prototype.drawBezierWallByAttr=function(e){let t=this;Ri(t),e.geometryType="bezierWall",t.index++,e.name="\u8D1D\u585E\u5C14\u66F2\u7EBF\u4F53"+t.index;let n=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=n;let r=Io(e);return e.byAttr=!0,j=FD(e,t.viewer,r),t.gemotryList.set(n,[j]),Si=!1,n};ye.prototype.drawMultipleArrowLine=function(e,t){let n=this;return Ri(n),Si=!0,n.index++,e.name="\u591A\u7BAD\u5934"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="multipleArrowLine",j=x_e(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ye.prototype.drawMultipleArrowLineByAttr=function(e,t){let n=this;return Ri(n),n.index++,e.name="\u591A\u7BAD\u5934"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.positions=Cesium.defaultValue(e.positions,[]),e.geometryType="multipleArrowLine",j=w_e(e,n.viewer,e.positions),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,Si=!1,e.id};ye.prototype.startEdit=function(e){iy=!1,oy==null&&(oy=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas)),e!=null&&this.leftClickStartEdit._listeners.length==0&&this.leftClickStartEdit.addEventListener(e),QW(oy,this.viewer,this)};ye.prototype.stopEdit=function(e){let t=this;iy=!0,t.billboardCollection.removeAll(),$=void 0,ry=!1,Dn={},m0=!1,e!=null&&t.leftClickStartEdit._listeners.length!=0&&t.leftClickStartEdit.removeEventListener(e)};ye.prototype.startDraw=function(){Ri(this)};ye.prototype.stopDraw=function(){};ye.prototype.remove=function(e){let t=this;if(t.gemotryList.get(e)){let n=t.gemotryList.get(e)[0];t.viewer.entities.remove(n),t.gemotryList.get(e)[1]!=null&&t.viewer.entities.remove(t.gemotryList.get(e)[1]),t.gemotryList.get(e)[2]!=null&&t.viewer.entities.remove(t.gemotryList.get(e)[2]),t.gemotryList.remove(n.id)}t.billboardCollection.removeAll()};ye.prototype.setShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e).forEach(o=>{o.show=t})};ye.prototype.removeAll=function(){let e=this;for(let t in e.gemotryList._hash)e.gemotryList._hash[t][0].outline!=null&&e.gemotryList._hash[t][0].outline.show&&e.viewer.entities.remove(e.gemotryList._hash[t][1]),e.viewer.entities.remove(e.gemotryList._hash[t][0]);e.gemotryList.removeAll(),e.billboardCollection.removeAll(),Ri(e)};ye.prototype.LoadAnddrawGeomerty=function(e){};ye.prototype.exportGeometry=function(e){};ye.prototype.destroy=function(){return oy=void 0,g0=void 0,Si=void 0,j=void 0,un=void 0,$=void 0,ry=void 0,Dn=void 0,Ft=void 0,ui=void 0,m0=void 0,Wa=void 0,iy=void 0,ND=void 0,this.index=void 0,this.gemotryList.removeAll(),this.gemotryList=void 0,this.billboardCollection.removeAll(),this.billboardCollection=void 0,this.viewer=void 0,st(this)};ye.prototype.drawSectorByAttr=function(e){let t=this;Ri(t),e.geometryType="sector",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=nT(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&!e.extrudedHeight&&(Ft=gp(e,t.viewer,o),t.gemotryList.get(r).push(Ft)),Si=!1,r};ye.prototype.setSectorFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&(n.gemotryList.get(e)[0].polygon.material=t)};ye.prototype.getSectorFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].polygon.material};ye.prototype.setShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e).forEach(o=>{o.show=t})};ye.prototype.setSectorRadius=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e)[0];r.attr.radius=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,startAngle:r.attr.startAngle,endAngle:r.attr.endAngle,height:r.attr.height},geometryType:"sector"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getSectorRadius=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].attr.radius};ye.prototype.setSectorPosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e)[0];r.anhor=t;let o={positions:t,attr:{radius:r.attr.radius,startAngle:r.attr.startAngle,endAngle:r.attr.endAngle,height:r.attr.height},geometryType:"sector"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getSectorPosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].nodelist[0]};ye.prototype.setSectorOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ye.prototype.getSectorOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ye.prototype.setSectorAngle=function(e,t,n){let r=this;if(r.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(r.gemotryList.get(e)!=null&&r.gemotryList.get(e)[0].geometryType=="sector"){let o=r.gemotryList.get(e)[0];o.attr.startAngle=t,o.attr.endAngle=n;let a={positions:o.nodelist[0],attr:{radius:o.attr.radius,startAngle:o.attr.startAngle,endAngle:o.attr.endAngle,height:o.attr.height},geometryType:"sector"},s=Io(a);for(let u=0;u<s.length;u++)o.nodelist[u]=s[u];if(o.anhor=s[0],o.entityChange.nodelistChange=!0,r.gemotryList.get(e)[1]!=null){for(let u=0;u<s.length;u++){let l=tn(s[u],a.attr.height);o.nodelist[u]=l,r.gemotryList.get(e)[1].nodelist[u]=l,r.billboardCollection._billboards[0]!=null&&r.billboardCollection._billboards[0].id.split("_")[r.billboardCollection._billboards[0].id.split("_").length-1]==e&&(r.billboardCollection._billboards[u].position=l)}r.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getSectorAngle=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"){let n=t.gemotryList.get(e)[0].attr.startAngle,r=t.gemotryList.get(e)[0].attr.endAngle;return{startAngle:n,endAngle:r}}};ye.prototype.setSectorOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ye.prototype.getSectorOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ye.prototype.setSectorOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e);if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ui=r[1]:Ft=r[1];else{let o=gp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Ft=void 0,ui=void 0}};ye.prototype.getSectorOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return n[1].show};ye.prototype.setSectorAttr=function(e,t){let n=this,r=n.gemotryList.get(e);if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let o=Cesium.defaultValue(t.material,n.getSectorFillMaterial(e));n.setSectorFillMaterial(e,o);let a=Cesium.defaultValue(t.anhor,n.getSectorPosition(e));n.setSectorPosition(e,a);let s=Cesium.defaultValue(t.outline.show,n.getSectorOutlineShow(e));n.setSectorOutlineShow(e,s);let u=Cesium.defaultValue(t.outline.width,n.getSectorOutlineWidth(e));n.setSectorOutlineWidth(e,u);let l=Cesium.defaultValue(t.outline.material,n.getSectorOutlineMaterial(e));n.setSectorOutlineMaterial(e,l);let c=Cesium.defaultValue(t.attr.radius,n.getSectorRadius(e));n.setSectorRadius(e,c);let f=Cesium.defaultValue({startAngle:t.attr.startAngle,endAngle:t.attr.endAngle},n.getSectorAngle(e));n.setSectorAngle(e,f.startAngle,f.endAngle)}};ye.prototype.getSectorAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{material:t.getSectorFillMaterial(e),outline:{show:t.getSectorOutlineShow(e),material:t.getSectorOutlineMaterial(e),width:t.getSectorOutlineWidth(e)},attr:{height:n[0].attr.height,radius:t.getSectorRadius(e),startAngle:t.getSectorAngle(e).startAngle,endAngle:t.getSectorAngle(e).endAngle},anhor:t.getSectorPosition(e),id:e,name:n[0].name}};ye.prototype.drawCircleByAttr=function(e){let t=this;Ri(t),e.geometryType="circle",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=nT(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Ft=gp(e,t.viewer,o),t.gemotryList.get(r).push(Ft)),Si=!1,r};ye.prototype.setCircleFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&(n.gemotryList.get(e)[0].polygon.material=t)};ye.prototype.getCircleFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].polygon.material};ye.prototype.setCircleRadius=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="circle"){let r=n.gemotryList.get(e)[0];r.attr.radius=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,height:r.attr.height},geometryType:"circle"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getCircleRadius=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].attr.radius};ye.prototype.setCirclePosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="circle"){let r=n.gemotryList.get(e)[0];r.nodelist[0]=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,height:r.attr.height},geometryType:"circle"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.entityChange.nodelistChange=!0,r.anhor=a[0],n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getCirclePosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].nodelist[0]};ye.prototype.setCircleOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ye.prototype.getCircleOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ye.prototype.setCircleOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ye.prototype.getCircleOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ye.prototype.setCircleOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ui=r[1]:Ft=r[1];else{let o=gp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Ft=void 0,ui=void 0};ye.prototype.getCircleOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ye.prototype.setCircleIntervalDegrees=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&n.gemotryList.get(e)[0].Interval_degrees!=null&&(n.gemotryList.get(e)[0].Interval_degrees.value=t,n.gemotryList.get(e)[0].entityChange.nodelistChange=!0,n.gemotryList.get(e)[1].Interval_degrees.value=t,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0)};ye.prototype.getCircleIntervalDegrees=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null&&t.gemotryList.get(e)[0].Interval_degrees!=null)return t.gemotryList.get(e)[0].Interval_degrees.value==null?12:t.gemotryList.get(e)[0].Interval_degrees.value};ye.prototype.getCircleAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{anhor:t.getCirclePosition(e),attr:{height:n[0].attr.height,radius:t.getCircleRadius(e),Interval_degrees:t.getCircleIntervalDegrees(e)},outline:{show:t.getCircleOutlineShow(e),width:t.getCircleOutlineWidth(e),material:t.getCircleOutlineMaterial(e)},material:t.getCircleFillMaterial(e),id:e,name:n[0].name}};ye.prototype.setCircleAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let r=Cesium.defaultValue(t.anhor,n.getCirclePosition(e));n.setCirclePosition(e,r);let o=Cesium.defaultValue(t.outline.material,n.getCircleOutlineMaterial(e));n.setCircleOutlineMaterial(e,o);let a=Cesium.defaultValue(t.outline.show,n.getCircleOutlineShow(e));n.setCircleOutlineShow(e,a);let s=Cesium.defaultValue(t.outline.width,n.getCircleOutlineWidth(e));n.setCircleOutlineWidth(e,s);let u=Cesium.defaultValue(t.material,n.getCircleFillMaterial(e));n.setCircleFillMaterial(e,u);let l=Cesium.defaultValue(t.attr.radius,n.getCircleRadius(e));n.setCircleRadius(e,l);let c=Cesium.defaultValue(t.Interval_degrees,n.getCircleIntervalDegrees(e));n.setCircleIntervalDegrees(e,c)}};ye.prototype.drawEllipseByAttr=function(e){let t=this;Ri(t),e.geometryType="ellipse",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=nT(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Ft=gp(e,t.viewer,o),t.gemotryList.get(r).push(Ft)),Si=!1,r};ye.prototype.setEllipseFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&(n.gemotryList.get(e)[0].polygon.material=t)};ye.prototype.getEllipseFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].polygon.material};ye.prototype.setEllipseMinoraxis=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.attr.minoraxis=t;let o={positions:r.nodelist[0],attr:{minoraxis:r.attr.minoraxis,majoraxis:r.attr.majoraxis,height:r.attr.height},geometryType:"ellipse"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getEllipseMinoraxis=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&this.gemotryList.get(e)[0].geometryType=="ellipse")return this.gemotryList.get(e)[0].attr.minoraxis};ye.prototype.setEllipseMajoraxis=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.attr.majoraxis=t;let o={positions:r.nodelist[0],attr:{minoraxis:r.attr.minoraxis,majoraxis:r.attr.majoraxis,height:r.attr.height},geometryType:"ellipse"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getEllipseMajoraxis=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].attr.majoraxis};ye.prototype.setEllipsePosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.nodelist[0]=t;let o={positions:r.nodelist[0],attr:{majoraxis:r.attr.majoraxis,minoraxis:r.attr.minoraxis,height:r.attr.height},geometryType:"ellipse"},a=Io(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=tn(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getEllipsePosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].nodelist[0]};ye.prototype.setEllipseOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ye.prototype.getEllipseOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ye.prototype.setEllipseOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ye.prototype.getEllipseOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ye.prototype.setEllipseOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ui=r[1]:Ft=r[1];else{let o=gp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Ft=void 0,ui=void 0};ye.prototype.getEllipseOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ye.prototype.setEllipseIntervalDegrees=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&n.gemotryList.get(e)[0].Interval_degrees!=null&&(n.gemotryList.get(e)[0].Interval_degrees.value=t,n.gemotryList.get(e)[0].entityChange.nodelistChange=!0,n.gemotryList.get(e)[1].Interval_degrees.value=t,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0)};ye.prototype.getEllipseIntervalDegrees=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null&&t.gemotryList.get(e)[0].Interval_degrees!=null)return t.gemotryList.get(e)[0].Interval_degrees.value==null?12:t.gemotryList.get(e)[0].Interval_degrees.value};ye.prototype.setEllipseAttr=function(e,t){let n=this,r=n.gemotryList.get(e);if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let o=Cesium.defaultValue(t.anhor,n.getEllipsePosition(e));n.setEllipsePosition(e,o);let a=Cesium.defaultValue(t.outline.material,n.getEllipseOutlineMaterial(e));n.setEllipseOutlineMaterial(e,a);let s=Cesium.defaultValue(t.outline.show,n.getEllipseOutlineShow(e));n.setEllipseOutlineShow(e,s);let u=Cesium.defaultValue(t.outline.width,n.getEllipseOutlineWidth(e));n.setEllipseOutlineWidth(e,u);let l=Cesium.defaultValue(t.material,n.getEllipseFillMaterial(e));n.setEllipseFillMaterial(e,l);let c=Cesium.defaultValue(t.attr.majoraxis,n.getEllipseMajoraxis(e));n.setEllipseMajoraxis(e,c);let f=Cesium.defaultValue(t.attr.minoraxis,n.getEllipseMinoraxis(e));n.setEllipseMinoraxis(e,f);let h=Cesium.defaultValue(t.Interval_degrees,n.getEllipseIntervalDegrees(e));n.setEllipseIntervalDegrees(e,h)}};ye.prototype.getEllipseAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{anhor:t.getEllipsePosition(e),attr:{height:n[0].attr.height,majoraxis:t.getEllipseMajoraxis(e),minoraxis:t.getEllipseMinoraxis(e),Interval_degrees:t.getEllipseIntervalDegrees(e)},outline:{show:t.getEllipseOutlineShow(e),width:t.getEllipseOutlineWidth(e),material:t.getEllipseOutlineMaterial(e)},material:t.getEllipseFillMaterial(e),id:e,name:n[0].name}};ye.prototype.drawRectangleByAttr=function(e){let t=this;Ri(t),e.geometryType="rectangle",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=nT(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Ft=gp(e,t.viewer,o),t.gemotryList.get(r).push(Ft)),Si=!1,r};ye.prototype.setRectangleFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&(n.gemotryList.get(e)[0].polygon.material=t)};ye.prototype.getRectangleFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle")return t.gemotryList.get(e)[0].polygon.material};ye.prototype.setRectanglePoint=function(e,t,n){let r=this;if(r.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(r.gemotryList.get(e)!=null&&r.gemotryList.get(e)[0]!=null&&r.gemotryList.get(e)[0].geometryType=="rectangle"){let o=r.gemotryList.get(e)[0];o.attr.endPoint=n,o.attr.startPoint=t;let a={attr:{height:o.attr.height,startPoint:o.attr.startPoint,endPoint:o.attr.endPoint},geometryType:"rectangle"},s=Io(a);for(let l=0;l<s.length;l++)o.nodelist[l]=s[l];o.entityChange.nodelistChange=!0;let u=ay(o.nodelist);if(o.anhor=u,r.gemotryList.get(e)[1]!=null){for(let l=0;l<s.length;l++){let c=tn(s[l],a.attr.height);o.nodelist[l]=c,r.gemotryList.get(e)[1].nodelist[l]=c,r.billboardCollection._billboards[0]!=null&&r.billboardCollection._billboards[0].id.split("_")[r.billboardCollection._billboards[0].id.split("_").length-1]==e&&(r.billboardCollection._billboards[l+1].position=c)}r.billboardCollection._billboards[0]!=null&&(r.billboardCollection._billboards[0].position=u),r.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getRectanglePoint=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"){let n=t.gemotryList.get(e)[0].nodelist[0];return{endPoint:t.gemotryList.get(e)[0].nodelist[1],startPoint:n}}};ye.prototype.setRectangleOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&n.gemotryList.get(e)[1]!=null)return n.gemotryList.get(e)[1].polyline.material=t,t};ye.prototype.getRectangleOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ye.prototype.setRectangleOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ye.prototype.getRectangleOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ye.prototype.setRectangleOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!==void 0)if(t)if(j!=null?j.outline.show=!0:$!==void 0&&($.outline.show=!0),r[0].outline.show=!0,r.length===2)r[1].show=!0,$!==void 0?ui=r[1]:Ft=r[1];else{let o=gp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[1].show=!1,Ft=void 0};ye.prototype.getRectangleOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ye.prototype.setRectangleAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&(n.setRectanglePoint(e,t.attr.startPoint,t.attr.endPoint),n.setRectangleOutlineShow(e,t.outline.show),n.setRectangleFillMaterial(e,t.material),n.setRectangleOutlineWidth(e,t.outline.width),n.setRectangleOutlineMaterial(e,t.outline.material))};ye.prototype.getRectangleAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let n=t.gemotryList.get(e);if(n!=null)return{attr:{height:n[0].attr.height,startPoint:t.getRectanglePoint(e).startPoint,endPoint:t.getRectanglePoint(e).endPoint},material:t.getRectangleFillMaterial(e),outline:{show:t.getRectangleOutlineShow(e),width:t.getRectangleOutlineWidth(e),material:t.getRectangleOutlineMaterial(e)},id:e,name:n[0].name}};ye.prototype.drawPolygonByAttr=function(e){let t=this;Ri(t),e.geometryType="polygon",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=nT(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Ft=gp(e,t.viewer,o),t.gemotryList.get(r).push(Ft)),Si=!1,r};ye.prototype.setPolygonFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&(n.gemotryList.get(e)[0].polygon.material=t)};ye.prototype.getPolygonFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon")return t.gemotryList.get(e)[0].polygon.material};ye.prototype.setPolygonPositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height},positions:t,geometryType:"polygon"},a=Io(o);if(r.nodelist.length<=a)for(let u=0;u<a.length;u++)r.nodelist[u]=a[u];else{let u=r.nodelist.length,l=a.length,c=u-l;r.nodelist.length=r.nodelist.length-c;for(let f=0;f<r.nodelist.length;f++)r.nodelist[f]=a[f]}r.entityChange.nodelistChange=!0;let s=ay(r.nodelist);if(r.anhor=s,n.gemotryList.get(e)[1]!=null){let u=n.gemotryList.get(e)[1].nodelist.length,l=a.length,c=u-l;c>=0&&(n.gemotryList.get(e)[1].nodelist.length=n.gemotryList.get(e)[1].nodelist.length-c);for(let f=0;f<a.length;f++){let h=tn(a[f],o.attr.height);r.nodelist[f]=h,n.gemotryList.get(e)[1].nodelist[f]=h,n.billboardCollection._billboards[0]!=null&&(n.billboardCollection._billboards[0].position=s,n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f+1].position=h))}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ye.prototype.getPolygonPositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon")return this.gemotryList.get(e)[0].nodelist};ye.prototype.setPolygonOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&n.gemotryList.get(e)[1]!=null)return n.gemotryList.get(e)[1].polyline.material=t,t};ye.prototype.getPolygonOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ye.prototype.setPolygonOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ye.prototype.getPolygonOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width._value};ye.prototype.setPolygonOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null?j.outline.show=!0:$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ui=r[1]:Ft=r[1],r[1].entityChange.nodelistChange=!0;else{let o=gp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null?j.outline.show=!1:$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Ft=void 0,ui=void 0};ye.prototype.getPolygonOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ye.prototype.getPolygonAttr=function(e){let t={},n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)return t.material=n.getPolygonFillMaterial(e),t.positions=n.getPolygonPositions(e),t.outline={material:n.getPolygonOutlineMaterial(e),width:n.getPolygonOutlineWidth(e),show:n.getPolygonOutlineShow(e)},t.attr={height:r[0].attr.height},t.id=e,t};ye.prototype.setPolygonAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null){let o=Cesium.defaultValue(t.outline.show,n.getPolygonOutlineShow(e));n.setPolygonOutlineShow(e,o);let a=Cesium.defaultValue(t.material,n.getPolygonFillMaterial(e));n.setPolygonFillMaterial(e,a);let s=Cesium.defaultValue(t.outline.width,n.getPolygonOutlineWidth(e));n.setPolygonOutlineWidth(e,s);let u=Cesium.defaultValue(t.outline.material,n.getPolygonOutlineMaterial(e));n.setPolygonOutlineMaterial(e,u);let l=Cesium.defaultValue(t.positions,n.getPolygonPositions(e));n.setPolygonPositions(e,l)}};ye.prototype.drawPolylineByAttr=function(e){let t=this;Ri(t),e.geometryType="polyline",t.index++;let n=hd(e.geometryType,t.index);e.name=n,e.attr.clampToGround=Cesium.defaultValue(e.attr.clampToGround,!1);let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);return j=oT(e,t.viewer,o),t.gemotryList.set(r,[j]),Si=!1,r};ye.prototype.drawArrowLineByAttr=function(e){let t=this;Ri(t),e.geometryType="polyline",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowLine_single"),j=oT(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=m_e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),Si=!1,r};ye.prototype.drawArrowTriangleByAttr=function(e){let t=this;Ri(t),e.geometryType="polyline",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),j=oT(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=p_e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),Si=!1,r};ye.prototype.drawArrowCurveByAttr=function(e){let t=this;Ri(t),e.geometryType="polyline",t.index++;let n=hd(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=Io(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),e.lineStyle="curve",j=oT(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=__e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),Si=!1,r};ye.prototype.drawArrowCurveTriangleByAttr=function(e){let t=this;Ri(t),t.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${t.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),e.lineStyle="curve";let n=Io(e);j=oT(e,t.viewer,n),t.gemotryList.set(e.id,[j]);let r=v_e(e,t.viewer,n);return r.length==1?t.gemotryList.get(e.id).push(r[0]):(t.gemotryList.get(e.id).push(r[0]),t.gemotryList.get(e.id).push(r[1])),Si=!1,e.id};ye.prototype.setPolylineFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.material=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline!=null?n.gemotryList.get(e)[1].polyline.material=t:n.gemotryList.get(e)[1].polygon.material=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline!=null?(n.gemotryList.get(e)[1].polyline.material=t,n.gemotryList.get(e)[2].polyline.material=t):(n.gemotryList.get(e)[1].polygon.material=t,n.gemotryList.get(e)[2].polygon.material=t))))};ye.prototype.getPolylineFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.material};ye.prototype.setPolylinePositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height},positions:t,geometryType:"polyline"},a=Io(o),s=r.nodelist.length,u=a.length,l=s-u;l>=0&&(r.nodelist.length=r.nodelist.length-l);for(let f=0;f<a.length;f++)r.nodelist[f]=a[f];r.entityChange.nodelistChange=!0;let c=ay(r.nodelist);r.anhor=c;for(let f=0;f<a.length;f++){let h=tn(a[f],o.attr.height);r.nodelist[f]=h,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?(n.gemotryList.get(e)[1].nodelist[f]=h,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0):n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].nodelist[f]=h,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0,n.gemotryList.get(e)[2].nodelist[f]=h,n.gemotryList.get(e)[2].entityChange.nodelistChange=!0)),n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f].position=h)}}};ye.prototype.getPolylinePositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return this.gemotryList.get(e)[0].nodelist};ye.prototype.setPolylineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.width=t,n.gemotryList.get(e)[0].triangleType!=null&&n.gemotryList.get(e)[1].polyline!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.width=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.width=t,n.gemotryList.get(e)[2].polyline.width=t)))};ye.prototype.getPolylineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.width};ye.prototype.getPolylineAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return{attr:{width:t.gemotryList.get(e)[0].attr.width,height:t.gemotryList.get(e)[0].attr.height,clampToGround:t.gemotryList.get(e)[0].attr.clampToGround},material:t.gemotryList.get(e)[0].polyline.material,positions:t.gemotryList.get(e)[0].nodelist,anhor:t.gemotryList.get(e)[0].anhor,id:e}};ye.prototype.setPolylineAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.width=Cesium.defaultValue(t.attr.width,n.gemotryList.get(e)[0].attr.width),n.gemotryList.get(e)[0].attr.height=Cesium.defaultValue(t.attr.height,n.gemotryList.get(e)[0].attr.height),n.gemotryList.get(e)[0].nodelist=Cesium.defaultValue(t.positions,n.gemotryList.get(e)[0].nodelist),n.gemotryList.get(e)[0].polyline.material=Cesium.defaultValue(t.material,n.gemotryList.get(e)[0].polyline.material),n.gemotryList.get(e)[0].polyline.clampToGround=Cesium.defaultValue(t.attr.clampToGround,n.gemotryList.get(e)[0].polyline.clampToGround))};ye.prototype.setPolylineClampToGround=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(clampToGround=Cesium.defaultValue(clampToGround,!1),n.gemotryList.get(e)[0].polyline.ClampToGround=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.ClampToGround=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.ClampToGround=t,n.gemotryList.get(e)[2].polyline.ClampToGround=t)))};ye.prototype.drawPointByAttr=function(e){let t=this;Ri(t),e.geometryType="point",t.index++;let n=hd(e.geometryType,t.index);e.name=n,e.id=Cesium.defaultValue(e.id,Cesium.createGuid());let r=e.id,o=Io(e);return j=c_e(e,t.viewer,[o]),t.gemotryList.set(r,[j]),Si=!1,r};ye.prototype.setPointColor=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="point"&&(t==null&&(t=Cesium.Color.WHITE),n.gemotryList.get(e)[0].attr.color=t,n.gemotryList.get(e)[0].point.color=t)};ye.prototype.getPointColor=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return t.gemotryList.get(e)[0].point.color};ye.prototype.setPointPixelSize=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="point"&&(t==null&&(t=10),n.gemotryList.get(e)[0].attr.pixelSize=t,n.gemotryList.get(e)[0].point.pixelSize=t)};ye.prototype.getPointPixelSize=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return t.gemotryList.get(e)[0].point.pixelSize};ye.prototype.setPointPositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="point"){let r=n.gemotryList.get(e)[0];t=tn(t,r.attr.height);let o=[t];r.nodelist[0]=o[0],r.entityChange.nodelistChange=!0,r.anhor=o[0];for(let a=0;a<o.length;a++){let s=tn(o[a],r.attr.height);r.nodelist[a]=s,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[a].position=s)}}};ye.prototype.getPointPositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return this.gemotryList.get(e)[0].nodelist};ye.prototype.setPointAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let r=Cesium.defaultValue(t.attr.pixelSize,n.getPointPixelSize(e));n.setPointPixelSize(e,r);let o=Cesium.defaultValue(t.attr.color,n.getPointColor(e));n.setPointColor(e,o);let a=Cesium.defaultValue(t.anhor,n.getPointPositions(e));n.setPointPositions(e,a)}};ye.prototype.getPointAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{id:e,name:geometryList[0].name,attr:{pixelSize:t.getPointPixelSize(e),color:t.getPointColor(e),height:t.gemotryList.get(e)[0].attr.height},anhor:t.getPointPositions(e)}};ye.prototype.setMultipleArrowLineFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.material=t)};ye.prototype.getMultipleArrowLineFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return t.gemotryList.get(e)[0].polyline.material};ye.prototype.setMultipleArrowLinePositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height,width:r.attr.width,clampToGround:r.attr.clampToGround},positions:t,geometryType:"multipleArrowLine"},a=Io(o),s=r.nodelist.length,u=a.length,l=s-u;l>=0&&(r.nodelist.length=r.nodelist.length-l);for(let f=0;f<a.length;f++)r.nodelist[f]=a[f];r.entityChange.nodelistChange=!0;let c=ay(r.nodelist);r.anhor=c;for(let f=0;f<a.length;f++){let h=tn(a[f],o.attr.height);r.nodelist[f]=h,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f].position=h)}}};ye.prototype.getMultipleArrowLinePositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return this.gemotryList.get(e)[0].nodelist};ye.prototype.setMultipleArrowLineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.width=t,n.gemotryList.get(e)[0].attr.width=t)};ye.prototype.getMultipleArrowLineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.width};ye.prototype.getMultipleArrowLineAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return{attr:{width:t.gemotryList.get(e)[0].attr.width,height:t.gemotryList.get(e)[0].attr.height,clampToGround:t.gemotryList.get(e)[0].attr.clampToGround},material:t.gemotryList.get(e)[0].polyline.material,positions:t.gemotryList.get(e)[0].nodelist,anhor:t.gemotryList.get(e)[0].anhor,id:e}};ye.prototype.setMultipleArrowLineAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="MultipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.width=Cesium.defaultValue(t.attr.width,n.gemotryList.get(e)[0].attr.width),n.gemotryList.get(e)[0].attr.width=n.gemotryList.get(e)[0].polyline.width,n.gemotryList.get(e)[0].attr.height=Cesium.defaultValue(t.attr.height,n.gemotryList.get(e)[0].attr.height),n.gemotryList.get(e)[0].nodelist=Cesium.defaultValue(t.positions,n.gemotryList.get(e)[0].nodelist),n.gemotryList.get(e)[0].polyline.material=Cesium.defaultValue(t.material,n.gemotryList.get(e)[0].polyline.material),n.gemotryList.get(e)[0].polyline.clampToGround=Cesium.defaultValue(t.attr.clampToGround,n.gemotryList.get(e)[0].polyline.clampToGround))};ye.prototype.setPolylineClampToGround=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(clampToGround=Cesium.defaultValue(clampToGround,!1),n.gemotryList.get(e)[0].polyline.ClampToGround=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.ClampToGround=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.ClampToGround=t,n.gemotryList.get(e)[2].polyline.ClampToGround=t)))};function tT(e,t){let n=[],r=[],o=e.id,a={nodelistChange:!1},s=Cesium.defaultValue(e.geometryType,"polygon"),u=Cesium.defaultValue(e.material,new Cesium.Color(1,1,1,1)),l=1e3;e.attr!=null&&e.attr.height!=null&&(l=e.attr.height);let c={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(c.value=e.attr.Interval_degrees);let f;(e.geometryType=="circle"||e.geometryType=="ellipse")&&(f=e.geometryType);let h=t.entities.add({id:o,polygon:{arcType:Cesium.ArcType.RHUMB,material:u,hierarchy:new Cesium.CallbackProperty(function(){let d=[];return a.nodelistChange?(d=Ai(n,s,e.attr.height,f,c),r=d,a.nodelistChange=!1):d=r,{positions:d}},!1),extrudedHeight:e.extrudedHeight},name:e.name,geometryType:s,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:l},outline:e.outline,entityChange:a,Interval_degrees:c});return e.attr.clampToGround||(h.polygon.height=e.attr.height,h.polygon.perPositionHeight=Cesium.defaultValue(e.attr.clampToGround,!1)),h}function nT(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(e.geometryType,"polygon"),s=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),u=1e3;e.attr!=null&&e.attr.height!=null&&(u=e.attr.height);let l={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(l.value=e.attr.Interval_degrees);let c;(e.geometryType=="circle"||e.geometryType=="ellipse")&&(c=e.geometryType);let f=t.entities.add({id:e.id,polygon:{arcType:Cesium.ArcType.RHUMB,material:s,hierarchy:new Cesium.CallbackProperty(function(){let h=[];return o.nodelistChange?(h=Ai(n,a,u,c,l),r=h,o.nodelistChange=!1):h=r,{positions:h}},!1),extrudedHeight:e.extrudedHeight},geometryType:a,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:Cesium.defaultValue(e.attr,{height:Cesium.defaultValue(e.height,1e3)}),name:e.name,outline:e.outline,entityChange:o,Interval_degrees:l});return e.attr.clampToGround==null&&!e.attr.clampToGround&&(f.polygon.height=e.attr.height,f.polygon.perPositionHeight=Cesium.defaultValue(e.attr.clampToGround,!1)),f}function l_e(e,t){let n=[],r={nodelistChange:!0},o=Cesium.defaultValue(e.attr,{height:1e3,pixelSize:3,color:new Cesium.Color(1,1,1,1)}),a=Cesium.defaultValue(e.attr.color,new Cesium.Color(1,1,1,1)),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.attr.pixelSize,10);o.height=s,o.pixelSize=u;let l=t.entities.add({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),nodelist:n,point:{pixelSize:o.pixelSize,color:a,disableDepthTestDistance:Number.POSITIVE_INFINITY},name:e.name,attr:o,geometryType:"point",entityChange:r});return g0=!0,Wa=!0,l}function c_e(e,t,n){let r={nodelistChange:!0},o=Cesium.defaultValue(e.attr.color,new Cesium.Color(1,1,1,1)),a=Cesium.defaultValue(e.attr,{height:1e3,pixelSize:10,color:o}),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.attr.pixelSize,10);a.height=s,a.pixelSize=u;let l=t.entities.add({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),nodelist:n,point:{pixelSize:a.pixelSize,color:o,disableDepthTestDistance:Number.POSITIVE_INFINITY},name:e.name,attr:a,geometryType:"point",entityChange:r});return g0=!0,Wa=!0,l}function rT(e,t){let n=[],r={nodelistChange:!1},o=[],a=`${e.id}_outline`,s=Cesium.defaultValue(`${e.geometryType}_outline`,"polygon_outline"),u=1e3;e.attr!=null&&e.attr.height!=null&&(u=e.attr.height);let l=Cesium.defaultValue(e.outline.width,10),c=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,0,0,1)),f={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(f.value=e.attr.Interval_degrees);let h;return(e.geometryType=="circle"||e.geometryType=="ellipse")&&(h=e.geometryType),t.entities.add({id:a,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return r.nodelistChange?(p=Ai(o,s,u,h,f),n=p,r.nodelistChange=!1):p=n,p},!1),arcType:Cesium.ArcType.RHUMB,clampToGround:Cesium.defaultValue(e.attr.clampToGround,!1),width:l,material:c},geometryType:s,height:u,nodelist:o,entityChange:r,Interval_degrees:f})}function gp(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(`${e.geometryType}_outline`,"polygon_outline"),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.outline.width,10),l=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,0,0,1)),c=[];for(let p=0;p<n.length;p++){let _=tn(n[p],s);c.push(_)}e.geometryType=="polygon"&&c.push(c[0]);let f={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(f.value=e.attr.Interval_degrees);let h;return(e.geometryType=="circle"||e.geometryType=="ellipse")&&(h=e.geometryType),t.entities.add({id:`${e.id}_outline`,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return o.nodelistChange?(p=Ai(c,a,s,h,f),r=p,o.nodelistChange=!1):p=r,p},!1),arcType:Cesium.ArcType.RHUMB,width:u,material:l},name:e.name,nodelist:c,geometryType:a,height:s,entityChange:o,Interval_degrees:f})}function iT(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s,u=Cesium.defaultValue(e.geometryType,"polyline"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1);e.lineStyle=="curve"&&(s="curve");let d={width:c,height:f,clampToGround:h},p=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let _=[];return a.nodelistChange?(_=Ai(n,u,d.height,s),o=_,a.nodelistChange=!1):_=o,_},!1),material:l,width:d.width,clampToGround:h},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:d,midNodeList:r,entityChange:a});return e.triangleType!=null&&(p.triangleType=e.triangleType),p}function oT(e,t,n){let r=[],o=[],a=Cesium.defaultValue(e.geometryType,"polyline"),s={nodelistChange:!0},u=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let l=Cesium.defaultValue(e.attr.width,5),c=Cesium.defaultValue(e.attr.height,1e3),f=Cesium.defaultValue(e.attr.clampToGround,!1),h={height:c,width:l,clampToGround:f},d;e.lineStyle=="curve"&&(d="curve");let p=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let _=[];return s.nodelistChange?(_=Ai(n,a,h.height,d),o=_,s.nodelistChange=!1):_=o,_},!1),material:u,width:h.width,clampToGround:f},name:e.name,geometryType:a,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:h,midNodeList:r,entityChange:s});return e.triangleType!=null&&(p.triangleType=e.triangleType),p}function f_e(e,t,n){let r=[],o=Cesium.defaultValue(e.geometryType,"curve"),a={nodelistChange:!0},s=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let u=Cesium.defaultValue(e.attr.width,5),l=Cesium.defaultValue(e.attr.height,1e3),c=Cesium.defaultValue(e.attr.clampToGround,!1),f=Cesium.defaultValue(e.attr.radius,5e3),h={height:l,width:u,clampToGround:c,radius:f};return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return a.nodelistChange?(p=r3(n,h.height,f),r=p,a.nodelistChange=!1):p=r,p},!1),material:s,width:h.width,clampToGround:c},name:e.name,geometryType:o,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:h,entityChange:a})}function h_e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowLine_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowLine_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y)}return _}function d_e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowTriangle_single"){let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y),y=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,e.attr.height),a=v,u.nodelistChange=!1):v=a,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:u}),e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y)}return _}function p_e(e,t,n){let r=[],o=[],a={nodelistChange:!0},s={nodelistChange:!0},u=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1),d={width:c,height:f,clampToGround:h},p=[];if(e.triangleType!="arrowTriangle_single"){let _=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ai(n,"arrowTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_),_=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return s.nodelistChange?(y=Ai(n,u,e.attr.height),o=y,s.nodelistChange=!1):y=o,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:s}),e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_)}else{let _=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ai(n,"arrowTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_)}return p}function m_e(e,t,n){let r=[],o=[],a=[],s={nodelistChange:!0},u={nodelistChange:!0},l=Cesium.defaultValue(e.triangleType,"arrowLine_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowLine_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y)}return _}function g_e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowCurve_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y)}return _}function __e(e,t,n){let r=[],o=[],a=[],s={nodelistChange:!0},u={nodelistChange:!0},l=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowCurve_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});_.push(y)}return _}function y_e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},_=[];if(e.triangleType!="arrowCurveTriangle_single"){let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurveTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y),y=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ai(n,l,e.attr.height),a=v,u.nodelistChange=!1):v=a,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:u}),e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ai(n,"arrowCurveTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),_.push(y)}return _}function v_e(e,t,n){let r=[],o=[],a={nodelistChange:!0},s={nodelistChange:!0},u=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1),d={width:c,height:f,clampToGround:h},p=[];if(e.triangleType!="arrowCurveTriangle_single"){let _=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ai(n,"arrowCurveTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_),_=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return s.nodelistChange?(y=Ai(n,u,e.attr.height),o=y,s.nodelistChange=!1):y=o,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:s}),e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_)}else{let _=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ai(n,"arrowCurveTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(_.polygon.height=e.attr.height),p.push(_)}return p}function C_e(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s=Cesium.defaultValue(e.attr,{});s.height=Cesium.defaultValue(s.height,1e3),s.radius=Cesium.defaultValue(s.radius,1e3),s.clampToGround=Cesium.defaultValue(s.clampToGround,!1),s.width=Cesium.defaultValue(s.width,5);let u=Cesium.defaultValue(e.geometryType,"curve"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),c=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let f=[];return a.nodelistChange?(f=r3(n,s.height,s.radius),o=f,a.nodelistChange=!1):f=o,f},!1),material:l,width:s.width,clampToGround:s.clampToGround},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:s,midNodeList:r,entityChange:a});return e.triangleType!=null&&(c.triangleType=e.triangleType),c}function FD(e,t,n){let r=Cesium.defaultValue(n,[]),o=[],a=Cesium.defaultValue(e.byAttr,!1),s=[],u={nodelistChange:!1},l=Cesium.defaultValue(e.attr,{});l.height=Cesium.defaultValue(l.height,1e3),l.radius=Cesium.defaultValue(l.radius,5e3);let c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),f=Cesium.defaultValue(e.geometryType,"bezierWall");if(a&&(u.nodelistChange=!0,f=="bezierWall"))for(let d=0;d<r.length;d++){let p=Cesium.Cartographic.fromCartesian(r[d]);p.height+=l.height,r[d]=Cesium.Cartographic.toCartesian(p)}return t.entities.add({id:e.id,wall:{positions:new Cesium.CallbackProperty(function(){let d=[];return u.nodelistChange?(f=="bezierWall"?d=mp(r):d=r3(r,l.height,l.radius),s=d,u.nodelistChange=!1):d=s,d},!1),material:c},name:e.name,show:!0,geometryType:f,nodelist:r,attr:l,midNodeList:o,entityChange:u})}function x_e(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s=Cesium.defaultValue(e.attr,{});s.height=Cesium.defaultValue(s.height,1e3),s.clampToGround=Cesium.defaultValue(s.clampToGround,!1),s.width=Cesium.defaultValue(s.width,5);let u=Cesium.defaultValue(e.geometryType,"multipleArrowLine"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let f=[];return a.nodelistChange?(f=JW(n,s.height),o=f,a.nodelistChange=!1):f=o,f},!1),material:l,width:s.width,clampToGround:s.clampToGround},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:s,midNodeList:r,entityChange:a})}function w_e(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(e.attr,{});a.height=Cesium.defaultValue(a.height,1e3),a.clampToGround=Cesium.defaultValue(a.clampToGround,!1),a.width=Cesium.defaultValue(a.width,5);let s=Cesium.defaultValue(e.geometryType,"multipleArrowLine"),u=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let c=[];return o.nodelistChange?(c=JW(n,a.height),r=c,o.nodelistChange=!1):c=r,c},!1),material:u,width:a.width,clampToGround:a.clampToGround},name:e.name,show:!0,geometryType:s,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:a,entityChange:o})}function QW(e,t,n){let r=n;e.setInputAction(function(o){let a=t.camera.pickEllipsoid(o.position,t.scene.globe.ellipsoid);if(a!=null&&Si&&!ND){switch(a=tn(a,j.attr.height),j.geometryType){case"polygon":j.nodelist.push(a),j.outline.show&&Ft.nodelist.push(a),un>=1&&(Wa=!0),un++;break;case"circle":!Wa&&un<1&&(j.nodelist.push(a),j.anhor=a,j.outline.show&&Ft.nodelist.push(a),Wa=!0,un++);break;case"ellipse":!Wa&&un<2&&(un==0?(j.nodelist.push(a),j.anhor=a,j.outline.show&&Ft.nodelist.push(a)):(j.nodelist.push(a),j.outline.show&&Ft.nodelist.push(a),Wa=!0),un++);break;case"rectangle":!Wa&&un<1&&(j.nodelist.push(a),j.outline.show&&Ft.nodelist.push(a),Wa=!0,un++);break;case"polyline":j.nodelist.push(a),Wa=!0,un++;break;case"sector":if(!Wa&&un<2){if(un==0)j.nodelist.push(a),j.anhor=a,j.outline.show&&Ft.nodelist.push(a);else{let s=t.entities.getById("\u6247\u5F62_temp01");t.entities.remove(s),j.nodelist.push(a),Wa=!0}un++}break;case"curve":!Wa&&un<1&&(j.nodelist.push(a),j.anhor=a,Wa=!0,un++);break;case"multipleArrowLine":j.nodelist.push(a),Wa=!0,un++;break;case"bezierWall":j.nodelist.push(a),Wa=!0,un++;break;case"curveWall":!Wa&&un<1&&(j.nodelist.push(a),j.anhor=a,Wa=!0,un++);break;default:break}j.entityChange.nodelistChange=!0,j.outline!=null&&j.outline.show&&(Ft.entityChange.nodelistChange=!0),g0=!0}else if(!Si&&!iy){let s=t.scene.pick(o.position);s==null?(r.billboardCollection!=null&&r.billboardCollection.removeAll(),m0=!1,ry=!1,$!=null&&$.geometryType=="point"&&($.show=!0),$=void 0):s.id instanceof Cesium.Entity&&s.id.id.split("_")[1]!="outline"&&(m0=!0,r.billboardCollection!=null&&r.billboardCollection.removeAll(),r.billboardCollection=S_e(s.id,r.billboardCollection),$=s.id,r.gemotryList.get(s.id.id)[1]!=null&&(ui=r.gemotryList.get(s.id.id)[1],$.outline.show=r.gemotryList.get(s.id.id)[1].show),r.leftClickStartEdit&&r.leftClickStartEdit.raiseEvent({id:$.id,type:$.geometryType}))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.setInputAction(function(o){if(!iy&&m0){let a=t.scene.pick(o.position);if(a!=null&&!(a.id instanceof Cesium.Entity)){let s=a.id.split("_");Dn.index=parseInt(s[0]),Dn.type=s[1],Dn.entityid=s[2],Dn.id=a.id,ry=!0,t.scene.screenSpaceCameraController.enableTranslate=!1,t.scene.screenSpaceCameraController.enableRotate=!1}}},Cesium.ScreenSpaceEventType.LEFT_DOWN),e.setInputAction(function(o){let a=t.camera.pickEllipsoid(o.endPosition,t.scene.globe.ellipsoid);if(!ND&&g0&&a!=null&&Si){a=tn(a,j.attr.height);let s;switch(j.geometryType){case"polygon":j.nodelist[un]=a,j.outline.show&&(Ft.nodelist[un]=a);break;case"circle":if(un==1){j.nodelist[un]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]);s=Cesium.Cartographic.fromCartesian(j.nodelist[1]);let c=u.project(l),f=u.project(s),h=Cesium.Cartesian3.distance(f,c);j.attr.radius=h,j.outline.show&&(Ft.nodelist[un]=a)}break;case"ellipse":if(j.nodelist[un]=a,un==1){j.attr.minoraxis=Cesium.Cartesian3.distance(j.nodelist[0],j.nodelist[1]),a=LD(j.nodelist[0],j.nodelist[1],"minoraxis"),j.nodelist[un]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]);s=Cesium.Cartographic.fromCartesian(j.nodelist[1]);let c=u.project(l),f=u.project(s),h=Cesium.Cartesian3.distance(f,c);j.attr.minoraxis=h,j.attr.majoraxis=h}else if(un==2){j.attr.majoraxis=Cesium.Cartesian3.distance(j.nodelist[0],j.nodelist[2]),a=LD(j.nodelist[0],j.nodelist[2],"majoraxis"),j.nodelist[un]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]),f=Cesium.Cartographic.fromCartesian(j.nodelist[2]),h=u.project(l),d=u.project(f),p=u.project(c),_=Cesium.Cartesian3.distance(d,h),y=Cesium.Cartesian3.distance(p,h);j.attr.minoraxis=y,j.attr.majoraxis=_}j.outline.show&&(Ft.nodelist[un]=a);break;case"rectangle":if(un==1){j.nodelist[un]=a;let u=Cesium.Cartesian3.midpoint(j.nodelist[0],j.nodelist[1],new Cesium.Cartesian3);j.anhor=u;let l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]);j.attr.startPoint=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,j.attr.height),j.attr.endPoint=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,j.attr.height),j.attr.height=j.attr.height,j.outline.show&&(Ft.nodelist[un]=a)}break;case"polyline":if(j.nodelist[un]=a,j.triangleType!=null){if(j.triangleType=="arrowLine_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowLine_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowTriangle_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowTriangle_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurve_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurve_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurveTriangle_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurveTriangle_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}}break;case"point":j.nodelist[0]=a;break;case"sector":if(un==1){j.nodelist[un]=a,j.outline.show&&(Ft.nodelist[un]=a);let u=t.entities.getById("\u6247\u5F62_temp01");u==null?t.entities.add({id:"\u6247\u5F62_temp01",position:a,point:{pixelSize:20,color:Cesium.Color.WHITE,disableDepthTestDistance:Number.POSITIVE_INFINITY}}):u.position=a}else if(un==2){j.nodelist[2]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]);s=Cesium.Cartographic.fromCartesian(j.nodelist[2]);let f=u.project(l),h=u.project(c),d=u.project(s),p=Cesium.Cartesian3.distance(h,f),_=_0(h,f),y=_0(d,f);y<0&&(y+=360),_<0&&(_+=360),y<_&&(y+=360);let v=new Cesium.Cartesian3(p*Math.cos(Cesium.Math.toRadians(Math.trunc(y)))+f.x,p*Math.sin(Cesium.Math.toRadians(Math.trunc(y)))+f.y,j.attr.height);s=u.unproject(v),a=Cesium.Cartesian3.fromRadians(s.longitude,s.latitude,s.height),j.nodelist[2]=a,j.outline.show&&(Ft.nodelist[un]=a)}break;case"curve":un==1&&(j.nodelist[un]=a);break;case"multipleArrowLine":j.nodelist[un]=a;break;case"bezierWall":j.nodelist[un]=a;break;case"curveWall":un==1&&(j.nodelist[un]=a);break;default:break}j.entityChange.nodelistChange=!0,j.outline!=null&&j.outline.show&&(Ft.entityChange.nodelistChange=!0)}else if(!iy&&!Si&&ry&&a!=null&&!isNaN(a.x)&&m0&&Dn.id!=null){if(a=tn(a,$.attr.height),$.geometryType!="point")if(Dn.type!="anhor"){if($.geometryType=="polygon"||$.geometryType=="polyline"||$.geometryType=="rectangle"){Dn.index==1?($.nodelist[0]=a,$.triangleType=="arrowLine_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_single"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_single"||$.triangleType=="arrowCurve_single"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowCurve_double"||$.triangleType=="arrowCurveTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowCurveTriangle_single"&&(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0)):($.nodelist[Dn.index-1]=a,$.triangleType=="arrowTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_single"?(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_double"?(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_single"||$.triangleType=="arrowCurve_single"?(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowCurve_double"||$.triangleType=="arrowCurveTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowCurveTriangle_single"&&(r.gemotryList.get($.id)[1].nodelist[Dn.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0));let s=Ai($.nodelist,$.geometryType),u=Cesium.BoundingSphere.fromPoints(s);r.gemotryList.get(Dn.entityid)[0].anhor=u.center,r.billboardCollection.get(Dn.index).position=a,e3(r.billboardCollection._billboards,$.geometryType,u.center)}else{if($.nodelist[Dn.index-1]=a,r.billboardCollection.get(Dn.index-1).position=a,$.geometryType=="sector"){let s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian($.nodelist[0]),l=s.project(u),c=Cesium.Cartographic.fromCartesian(a),f=s.project(c),h=Cesium.Cartesian3.distance(l,f);if(Dn.index-1==2){let d=Cesium.Cartographic.fromCartesian($.nodelist[1]),p=s.project(d),_=RD(p,l,h,$.attr.height),y=s.unproject(_);$.nodelist[1]=Cesium.Cartographic.toCartesian(y),r.billboardCollection.get(1).position=$.nodelist[1]}else if(Dn.index-1==1){let d=Cesium.Cartographic.fromCartesian($.nodelist[2]),p=s.project(d),_=RD(p,l,h,$.attr.height),y=s.unproject(_);$.nodelist[2]=Cesium.Cartographic.toCartesian(y),r.billboardCollection.get(2).position=$.nodelist[2]}}$.attr=ZW($.nodelist,$.geometryType,$.attr),$.anhor=$.nodelist[0]}if($.outline!=null&&$.outline.show!=null&&$.outline.show){let s=tn(a,ui.height);if($.geometryType=="sector")if(Cesium.Cartesian3.equals($.anhor,$.nodelist[0])){let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(ui.nodelist[0]),c=u.project(l),f=Cesium.Cartographic.fromCartesian(a),h=u.project(f),d=Cesium.Cartesian3.distance(c,h);if(Dn.index-1==2){let p=Cesium.Cartographic.fromCartesian(ui.nodelist[1]),_=u.project(p),y=RD(_,c,d,ui.height),v=u.unproject(y);ui.nodelist[1]=Cesium.Cartographic.toCartesian(v),ui.nodelist[2]=$.nodelist[2]}else if(Dn.index-1==1){let p=Cesium.Cartographic.fromCartesian(ui.nodelist[2]),_=u.project(p),y=RD(_,c,d,ui.height),v=u.unproject(y);ui.nodelist[2]=Cesium.Cartographic.toCartesian(v),ui.nodelist[1]=$.nodelist[1]}}else Dn.index=="0"&&(ui.nodelist[ui.nodelist.length-1]=s),ui.nodelist[Dn.index]=s;else Cesium.Cartesian3.equals($.anhor,$.nodelist[0])?ui.nodelist[Dn.index-1]=s:Dn.index=="1"&&ui.nodelist.length>2?$.geometryType=="polygon"?ui.nodelist[Dn.index-1]=s:ui.nodelist[ui.nodelist.length-1]=s:ui.nodelist[Dn.index-1]=s}}else{if(e3(r.billboardCollection._billboards,$.geometryType,a),$.outline!=null&&$.outline.show?t3($.nodelist,$.anhor,a,r.billboardCollection._billboards,ui.nodelist,ui.height):t3($.nodelist,$.anhor,a,r.billboardCollection._billboards,"",$.attr.height),$.geometryType=="rectangle")$.attr.startPoint=tn($.nodelist[0],$.attr.height),$.attr.endPoint=tn($.nodelist[1],$.attr.height);else if($.geometryType=="polyline"){if($.triangleType=="arrowLine_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowLine_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowTriangle_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowTriangle_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurve_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurve_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurveTriangle_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurveTriangle_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}}$.anhor=a}else a=tn(a,$.attr.height),e3(r.billboardCollection._billboards,$.geometryType,a),$.nodelist[0]=a,$.anhor=a;$.entityChange.nodelistChange=!0,$.outline!=null&&$.outline.show&&(ui.entityChange.nodelistChange=!0)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(function(o){if(!iy&&m0&&$!=null&&Dn.id!=null){if($.geometryType=="ellipse"){let a=parseInt(Dn.id.split("_")[0])-1;$.nodelist[1]=LD($.nodelist[0],$.nodelist[1],"minoraxis"),$.nodelist[2]=LD($.nodelist[0],$.nodelist[2],"majoraxis"),r.billboardCollection.get(a).position=$.nodelist[a]}else if($.geometryType=="point")$.show=!0,r.billboardCollection.get(0).show=!1;else if($.geometryType=="rectangle"){let a=Cesium.Cartographic.fromCartesian($.nodelist[0]),s=Cesium.Cartographic.fromCartesian($.nodelist[1]),u=Cesium.Cartesian3.fromRadians(s.longitude,a.latitude,$.height);$.attr.width=Cesium.Cartesian3.distance($.nodelist[0],u),$.attr.length=Cesium.Cartesian3.distance($.nodelist[1],u)}else $.geometryType=="circle"&&($.attr.radius=T_e($.nodelist[0],$.nodelist[1]));ry=!1,t.scene.screenSpaceCameraController.enableTranslate=!0,t.scene.screenSpaceCameraController.enableRotate=!0,r.leftClickStartEdit&&r.leftClickStartEdit.raiseEvent({id:$.id,type:$.geometryType})}},Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction(function(o){if(!ND&&Wa&&g0){let a={},s,u;switch(j.geometryType){case"polygon":u=Ai(j.nodelist,j.geometryType),s=Cesium.BoundingSphere.fromPoints(u),j.anhor=s.center,a={id:j.id,attr:{height:j.attr.height},material:j.polygon.material,positions:u,anhor:j.anhor,outline:j.outline,name:j.name},j.outline.show&&Ft.nodelist.push(Ft.nodelist[0]);break;case"circle":a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"ellipse":a={id:j.id,attr:{height:j.attr.height,majoraxis:j.attr.majoraxis,minoraxis:j.attr.minoraxis},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"rectangle":a={id:j.id,attr:{height:j.attr.height,startPoint:j.attr.startPoint,endPoint:j.attr.endPoint},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"polyline":u=Ai(j.nodelist,j.geometryType),s=Cesium.BoundingSphere.fromPoints(u),j.anhor=s.center,a={id:j.id,attr:{height:j.attr.height,width:j.attr.width,clampToGround:j.attr.clampToGround},material:j.polyline.material,positions:u,anhor:j.anhor,name:j.name};break;case"point":j.anhor=j.nodelist[0],a={id:j.id,attr:{height:j.attr.height,pixelSize:j.attr.pixelSize,color:j.point.color},anhor:j.anhor,name:j.name};break;case"sector":j.attr=ZW(j.nodelist,j.geometryType,j.attr),a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius,startAngle:j.attr.startAngle,endAngle:j.attr.endAngle},material:j.polygon.material,nodelist:j.nodelist,anhor:j.anhor,outline:j.outline,name:j.name};break;case"curve":a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius},material:j.polyline.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};break;case"multipleArrowLine":a={id:j.id,attr:{height:j.attr.height,width:j.attr.height},material:j.polyline.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};break;case"curveWall":a={id:j.id,attr:{radius:j.attr.radius},material:j.wall.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};case"bezierWall":a={id:j.id,material:j.wall.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};default:break}g0=!1,un=0,Si=!1,j.callbackFunc(a),j=void 0,Ft=void 0}},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}function Ai(e,t,n,r,o){let a=[],s=[],u=[];switch(t){case"polygon":a=e;break;case"polygon_outline":if(e.length!=0){for(let l=0;l<e.length;l++){let c=Cesium.Cartographic.fromCartesian(e[l]),f=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,n);a.push(f)}a.push(a[0])}break;case"circle":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,d);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}}break;case"circle_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}}break;case"ellipse":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%o!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=c.project(f),d=Cesium.Cartographic.fromCartesian(e[1]),p=c.project(d),_=Cesium.Cartographic.fromCartesian(e[2]),y=c.project(_),v=Cesium.Cartesian3.distance(p,h),w=Cesium.Cartesian3.distance(y,h),C=Cesium.defaultValue(o.value,12);for(let E=0;E<360;E=E+C){let S=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(E))+h.x,w*Math.sin(Cesium.Math.toRadians(E))+h.y,n),A=c.unproject(S);a.push(Cesium.Cartographic.toCartesian(A))}if(360%C!=0){let E=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(360))+h.x,w*Math.sin(Cesium.Math.toRadians(360))+h.y,n),S=c.unproject(E);a.push(Cesium.Cartographic.toCartesian(S))}}}break;case"ellipse_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}else if(e.length==3){let c=Cesium.Cartographic.fromCartesian(e[0]),f=l.project(c),h=Cesium.Cartographic.fromCartesian(e[1]),d=l.project(h),p=Cesium.Cartographic.fromCartesian(e[2]),_=l.project(p),y=Cesium.Cartesian3.distance(d,f),v=Cesium.Cartesian3.distance(_,f),w=Cesium.defaultValue(o.value,12);for(let C=0;C<360;C=C+w){let E=new Cesium.Cartesian3(y*Math.cos(Cesium.Math.toRadians(C))+f.x,v*Math.sin(Cesium.Math.toRadians(C))+f.y,n),S=l.unproject(E);a.push(Cesium.Cartographic.toCartesian(S))}if(360%o!=0){let C=new Cesium.Cartesian3(y*Math.cos(Cesium.Math.toRadians(360))+f.x,v*Math.sin(Cesium.Math.toRadians(360))+f.y,n),E=l.unproject(C);a.push(Cesium.Cartographic.toCartesian(E))}a.push(a[0])}}break;case"rectangle":if(e.length==2){let l=Cesium.Cartographic.fromCartesian(e[0]),c=Cesium.Cartographic.fromCartesian(e[1]),f=Cesium.Cartesian3.fromRadians(c.longitude,l.latitude,n),h=Cesium.Cartesian3.fromRadians(l.longitude,c.latitude,n);a=[e[0],f,e[1],h]}break;case"rectangle_outline":{if(e.length==2){let l=Cesium.Cartographic.fromCartesian(e[0]),c=Cesium.Cartographic.fromCartesian(e[1]),f=Cesium.Cartesian3.fromRadians(c.longitude,l.latitude,n),h=Cesium.Cartesian3.fromRadians(l.longitude,c.latitude,n);l=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,n),c=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,n),a=[l,f,c,h]}a.push(a[0])}break;case"polyline":if(r!=null){for(let c=0;c<e.length;c++){let f=tn(e[c],n);u.push(f)}let l=mp(u);for(let c=0;c<l.length;c++){let f=tn(l[c],n);a.push(f)}}else for(let l=0;l<e.length;l++){let c=tn(e[l],n);a.push(c)}break;case"sector":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let f=0;f<e.length;f++){let h=Cesium.Cartographic.fromCartesian(e[f]);s[f]=l.project(h,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]);for(let f=0;f<360;f+=12){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(f))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(f))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=Cesium.Cartographic.fromCartesian(e[1]),d=Cesium.Cartographic.fromCartesian(e[2]),p=c.project(f),_=c.project(h),y=c.project(d),v=Cesium.Cartesian3.distance(_,p),w=_0(_,p),C=_0(y,p);C<0&&(C+=360),w<0&&(w+=360),C<w&&(C+=360);for(let A=w;A<C;A=A+1){let D=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(A))+p.x,v*Math.sin(Cesium.Math.toRadians(A))+p.y,n),P=c.unproject(D);a.push(Cesium.Cartographic.toCartesian(P))}let E=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(C))+p.x,v*Math.sin(Cesium.Math.toRadians(C))+p.y,n),S=c.unproject(E);a.push(Cesium.Cartographic.toCartesian(S)),a.push(e[0])}}break;case"sector_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let f=0;f<e.length;f++){let h=Cesium.Cartographic.fromCartesian(e[f]);s[f]=l.project(h,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]);for(let f=0;f<360;f+=12){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(f))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(f))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=Cesium.Cartographic.fromCartesian(e[1]),d=Cesium.Cartographic.fromCartesian(e[2]),p=c.project(f),_=c.project(h),y=c.project(d),v=Cesium.Cartesian3.distance(_,p),w=_0(_,p),C=_0(y,p);C<0&&(C+=360),w<0&&(w+=360),C<w&&(C+=360);let E=tn(e[0],n);a.push(E);for(let D=w;D<C;D=D+1){let P=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(D))+p.x,v*Math.sin(Cesium.Math.toRadians(D))+p.y,n),M=c.unproject(P);a.push(Cesium.Cartographic.toCartesian(M))}let S=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(C))+p.x,v*Math.sin(Cesium.Math.toRadians(C))+p.y,n),A=c.unproject(S);a.push(Cesium.Cartographic.toCartesian(A)),a.push(E)}}break;case"arrowLine_single":if(e.length>=2){for(let l=0;l<e.length;l++){let c=tn(e[l],n);u.push(c)}a=OD(u[u.length-2],u[u.length-1])}break;case"arrowLine_double":if(e.length>=2){for(let l=0;l<e.length;l++){let c=tn(e[l],n);u.push(c)}a=OD(u[1],u[0])}break;case"arrowTriangle_single":if(e.length>=2){for(let l=0;l<e.length;l++){let c=tn(e[l],n);u.push(c)}a=OD(u[u.length-2],u[u.length-1],"triangle")}break;case"arrowTriangle_double":if(e.length>=2){for(let l=0;l<e.length;l++){let c=tn(e[l],n);u.push(c)}a=OD(u[1],u[0],"triangle")}break;case"arrowCurve_single":if(e.length>2){for(let f=0;f<e.length;f++){let h=tn(e[f],n);u.push(h)}let l=mp(u),c=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=GC(l[l.length-2],l[l.length-1],c)}break;case"arrowCurve_double":if(e.length>2){for(let f=0;f<e.length;f++){let h=tn(e[f],n);u.push(h)}let l=mp(u),c=Cesium.Cartesian3.distance(u[1],u[0]);a=GC(l[1],l[0],c)}break;case"arrowCurveTriangle_single":if(e.length>2){for(let f=0;f<e.length;f++){let h=tn(e[f],n);u.push(h)}let l=mp(u),c=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=GC(l[l.length-2],l[l.length-1],c,"triangle")}else{for(let c=0;c<e.length;c++){let f=tn(e[c],n);u.push(f)}let l=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=GC(u[u.length-2],u[u.length-1],l,"triangle")}break;case"arrowCurveTriangle_double":if(e.length>2){for(let f=0;f<e.length;f++){let h=tn(e[f],n);u.push(h)}let l=mp(u),c=Cesium.Cartesian3.distance(u[1],u[0]);a=GC(l[1],l[0],c,"triangle")}else{for(let c=0;c<e.length;c++){let f=tn(e[c],n);u.push(f)}let l=Cesium.Cartesian3.distance(u[1],u[0]);a=GC(u[1],u[0],l,"triangle")}break;default:break}return a}function r3(e,t,n){let r=[];if(e.length==2){let o=new Cesium.WebMercatorProjection,a=Cesium.Cartographic.fromCartesian(e[0]),s=Cesium.Cartographic.fromCartesian(e[1]),u=o.project(a),l=o.project(s),c=new Cesium.Cartesian3(u.x+n,u.y,u.z),f=_0(u,c),h=_0(l,c);h<0&&(h+=360),h<f&&(h+=360);for(let d=f;d<h;d=d+1){let p=new Cesium.Cartesian3(n*Math.cos(Cesium.Math.toRadians(d))+c.x,n*Math.sin(Cesium.Math.toRadians(d))+c.y,t),_=o.unproject(p);r.push(Cesium.Cartographic.toCartesian(_))}}return r}function JW(e,t){let n=[];for(let r=0;r<e.length;r++)e[r]=tn(e[r],t);if(e.length>2){let r=[];for(let o=0;o<e.length-2;o=o+2){let a=Cesium.Cartesian3.midpoint(e[o],e[o+2],new Cesium.Cartesian3);r=r.concat(E_e([e[o],e[o+1],e[o+2]],a))}(e.length-3)%2==1&&r.push(e[e.length-1]),n=r}else n=e;return n}function E_e(e,t){let n={headHeightFactor:.18,headWidthFactor:.3,neckHeightFactor:.85,neckWidthFactor:.15,tailWidthFactor:.1,headTailFactor:.8,swallowTailFactor:1},r=n.headHeightFactor,o=n.headTailFactor,a=n.headWidthFactor,s=n.neckWidthFactor,u=n.neckHeightFactor,l=Cesium.Cartesian3.distance(t,e[1]),c=l*r,f=e[1];l=Cesium.Cartesian3.distance(t,e[1]);let h=Cesium.Cartesian3.distance(e[0],e[2]);c>h*o&&(c=h*o);let d=c*a,p=c*s;c=c>l?l:c;let _=c*u,y=BD(t,e[1]),v=y-90,w=nu(e[1],v,c),C=nu(e[1],v,_),E=nu(w,v-90,d),S=nu(w,v+90,d),A=nu(C,v-90,p),D=nu(C,v+90,p),P=[],M=Cesium.Cartesian3.midpoint(e[1],t,new Cesium.Cartesian3),b=BD(e[0],e[2]),O=0;if(O=y-b,y-b<0&&(O=y-b+360),O>=0&&O<180){let m=mp([e[0],M,A],100),I=mp([D,M,e[2]],100);P=m.concat([A,E,e[1],S,D]),P=P.concat(I)}else{let m=mp([e[0],M,D],100),I=mp([A,M,e[2]],100);P=m.concat([D,S,e[1],E,A]),P=P.concat(I)}return P}function ZW(e,t,n){let r={},o=[];switch(t){case"sector":if(e.length==2){for(let d=0;d<e.length;d++){let p=Cesium.Cartographic.fromCartesian(e[d]),_=new Cesium.Cartesian3(F.toDegrees(p.longitude),F.toDegrees(p.latitude),p.height);o.push(_)}let f=Math.abs(Math.sqrt(Math.pow(o[0].x-o[1].x,2)+Math.pow(o[0].y-o[1].y,2)));for(let d=0;d<360;d=d+12){let p=new Cesium.Cartesian3(f*Math.cos(Cesium.Math.toRadians(d))+o[0].x,f*Math.sin(Cesium.Math.toRadians(d))+o[0].y,height),_=Cesium.Cartesian3.fromDegrees(p.x,p.y,p.z);positions.push(_)}let h=n3(e[1],e[0]);r.startAngle=h,r.endAngle=h,r.height=j.attr.height}else if(e.length==3){for(let p=0;p<e.length;p++){let _=Cesium.Cartographic.fromCartesian(e[p]),y=new Cesium.Cartesian3(F.toDegrees(_.longitude),F.toDegrees(_.latitude),_.height);o.push(y)}let f=Math.abs(Math.sqrt(Math.pow(o[0].x-o[1].x,2)+Math.pow(o[0].y-o[1].y,2))),h=n3(e[1],e[0]),d=n3(e[2],e[0]);r.startAngle=h,r.endAngle=d,r.height=n.height}let a=new Cesium.WebMercatorProjection,s=Cesium.Cartographic.fromCartesian(e[0]),u=a.project(s,new Cesium.Cartesian3);u.height=r.height;let l=Cesium.Cartographic.fromCartesian(e[1]),c=a.project(l,new Cesium.Cartesian3);c.height=r.height,r.radius=Cesium.Cartesian3.distance(u,c);break;case"ellipse":{let f=new Cesium.WebMercatorProjection;r.height=n.height;let h=Cesium.Cartographic.fromCartesian(e[0]),d=f.project(h),p=Cesium.Cartographic.fromCartesian(e[1]),_=f.project(p),y=Cesium.Cartographic.fromCartesian(e[2]),v=f.project(y),w=Cesium.Cartesian3.distance(_,d);r.minoraxis=w;let C=Cesium.Cartesian3.distance(v,d);r.majoraxis=C}break;case"circle":{let f=new Cesium.WebMercatorProjection;for(let d=0;d<e.length;d++){let p=Cesium.Cartographic.fromCartesian(e[d]);o[d]=f.project(p,new Cesium.Cartesian3)}let h=Cesium.Cartesian3.distance(o[0],o[1]);r.height=n.height,r.radius=h}break;case"rectangle":r.height=n.height,r.startPoint=e[0],r.endPoint=e[1];break;case"polygon":debugger;break;default:break}return r}function e3(e,t,n){for(let r=0;r<e.length;r++)e[r].id.split("_")[1]=="anhor"&&(e[r].position=n)}function t3(e,t,n,r,o,a){let s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian(t),l=s.project(u,new Cesium.Cartesian3),c=Cesium.Cartographic.fromCartesian(n),f=s.project(c,new Cesium.Cartesian3),h=l.x-f.x,d=l.y-f.y,p=[];for(let y=0;y<e.length;y++){let v=Cesium.Cartographic.fromCartesian(e[y]);if(p[y]=s.project(v),p[y].x-=h,p[y].y-=d,p[y].z=a,Cesium.Cartesian3.equals(e[y],t))e[y]=n;else{let w=s.unproject(p[y],new Cesium.Cartographic);e[y]=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,a)}}let _=[];for(let y=0;y<r.length;y++)if(r[y].id.split("_")[1]!="anhor"){let v=Cesium.Cartographic.fromCartesian(r[y].position);_[y]=s.project(v),_[y].x-=h,_[y].y-=d,_[y].z=a;let w=s.unproject(_[y],w);r[y].position=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,a)}if(o!=null)for(let y=0;y<o.length;y++)if(e[y]==null){let v=tn(o[0],a);o[y]=v}else{let v=tn(e[y],a);o[y]=v}}function tn(e,t){let n=Cesium.Cartographic.fromCartesian(e);return Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,t)}function LD(e,t,n){let r=new Cesium.Cartesian3,o=Cesium.Cartographic.fromCartesian(e),a=new Cesium.WebMercatorProjection,s=a.project(o),u=Cesium.Cartographic.fromCartesian(t),l=a.project(u),c=[];if(n=="minoraxis"||n==null){let f=Cesium.Cartesian3.distance(s,l),h=new Cesium.Cartesian3(s.x+f*Math.cos(Cesium.Math.toRadians(0)),s.y+f*Math.sin(Cesium.Math.toRadians(0)),s.z);c[0]=a.unproject(h,new Cesium.Cartographic),r=Cesium.Cartesian3.fromRadians(c[0].longitude,c[0].latitude,c[0].height)}else{let f=Cesium.Cartesian3.distance(s,l),h=new Cesium.Cartesian3(s.x+f*Math.cos(Cesium.Math.toRadians(90)),s.y+f*Math.sin(Cesium.Math.toRadians(90)),s.z);c[0]=a.unproject(h,c[0]),r=Cesium.Cartesian3.fromRadians(c[0].longitude,c[0].latitude,c[0].height)}return r}function T_e(e,t){let n=Cesium.Cartographic.fromCartesian(e),r=new Cesium.WebMercatorProjection,o=r.project(n,new Cesium.Cartesian3),a=Cesium.Cartographic.fromCartesian(t),s=r.project(a,new Cesium.Cartesian3);return Cesium.Cartesian3.distance(o,s)}function n3(e,t){let n=Cesium.Cartographic.fromCartesian(e),r=Cesium.Cartographic.fromCartesian(t),o=F.toDegrees(n.longitude)-F.toDegrees(r.longitude),a=F.toDegrees(n.latitude)-F.toDegrees(r.latitude),s=Math.atan2(a,o);return F.zeroToTwoPi(s),s=F.toDegrees(s),s}function _0(e,t){let n=e.x-t.x,r=e.y-t.y,o=Math.atan2(r,n);return F.zeroToTwoPi(o),o=F.toDegrees(o),o}function RD(e,t,n,r){let o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),u=t.x+Math.cos(s)*n,l=t.y+Math.sin(s)*n;return new Cesium.Cartesian3(u,l,r)}function hd(e,t){let n="";switch(e){case"sector":n=`\u6247\u5F62${t}`;break;case"polygon":n=`\u591A\u8FB9\u5F62${t}`;break;case"circle":n=`\u5706\u5F62${t}`;break;case"ellipse":n=`\u692D\u5706${t}`;break;case"rectangle":n=`\u77E9\u5F62${t}`;break;case"polyline":n=`\u7EBF${t}`;break;case"point":n=`\u70B9${t}`;break;case"curve":n="\u5706\u5F27"+t;break;default:break}return n}function S_e(e,t){let n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sKHAksBNXfIvIAAADGSURBVBjTlZC9DsFgFIafWsQgDE0vwGBjNVjNdYl1BYYmbkDim0yMEotFooNEW+Wjr6GfpCQG73J+nmc5B/6I924kNYEh0APawAXYAxvP827URUlTSZGkg6S7q5HbN+vySNJM0lOfebr9CKABUBRFH5i851oawMTxCuZ53gGCH3cFjldymqYZcPohnxyv5CzLdsASKL/EElg6XsnW2rUxZgHMgSPwcHVujFlYa9cff47juJUkyRgYAF3gDGx931+FYXjl37wANeOE+Ghv1/sAAAAASUVORK5CYII=",r=e.nodelist,o,a;switch(e.geometryType){case"sector":for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"polygon":o=ay(r),a=tn(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"circle":for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"ellipse":for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"rectangle":o=ay(r),a=tn(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"polyline":o=ay(r),a=tn(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"point":a=tn(r[0],e.attr.height),r[0]=a,t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${i+1}_anhor_${e.id}`}),e.anhor=a,e.show=!1;break;case"multipleArrowLine":for(let s=0;s<r.length;s++){let u=tn(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:s+1+"_node_"+e.id})}break;default:break}return t}function ay(e){return new Cesium.BoundingSphere.fromPoints(e).center}function Io(e){var t=[];switch(e.geometryType){case"sector":{let n=e.attr.radius,r=e.attr.startAngle,o=e.attr.endAngle,a=e.positions,s=Cesium.Cartographic.fromCartesian(a),u=new Cesium.WebMercatorProjection,l=u.project(s,new Cesium.Cartesian3);r>o&&(o+=360),t=[a];let c=new Cesium.Cartesian3;c.x=l.x+n*Math.cos(F.toRadians(r)),c.y=l.y+n*Math.sin(F.toRadians(r)),c.z=l.z;let f=u.unproject(c,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(f.longitude,f.latitude,f.height));let h=new Cesium.Cartesian3;h.x=l.x+n*Math.cos(F.toRadians(o)),h.y=l.y+n*Math.sin(F.toRadians(o)),h.z=l.z;let d=u.unproject(h,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,d.height))}break;case"circle":{let n=e.attr.radius,r=e.positions,o=e.attr.height,a=new Cesium.WebMercatorProjection,s=Cesium.Cartographic.fromCartesian(r),u=a.project(s,new Cesium.Cartesian3);t.push(r);let l=new Cesium.Cartesian3;l.x=u.x+Math.cos(Cesium.Math.toRadians(0))*n,l.y=u.y+Math.sin(Cesium.Math.toRadians(0))*n,l.z=u.z;let c=a.unproject(l,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,o))}break;case"ellipse":{let n=e.attr.minoraxis,r=e.attr.majoraxis,o=e.positions,a=e.attr.height,s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian(o),l=s.project(u,new Cesium.Cartesian3);t.push(o);let c=new Cesium.Cartesian3;c.x=l.x+Math.cos(Cesium.Math.toRadians(0))*n,c.y=l.y+Math.sin(Cesium.Math.toRadians(0))*r,c.z=l.z;let f=s.unproject(c,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(f.longitude,f.latitude,a));let h=new Cesium.Cartesian3;h.x=l.x+Math.cos(Cesium.Math.toRadians(90))*n,h.y=l.y+Math.sin(Cesium.Math.toRadians(90))*r,h.z=l.z;let d=s.unproject(h,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,a))}break;case"rectangle":t=[e.attr.startPoint,e.attr.endPoint];break;case"polygon":t=e.positions;break;case"polyline":t=e.positions;break;case"point":t=e.positions;break;case"curve":t=e.positions;break;case"curveWall":t=e.positions;break;case"bezierWall":t=e.positions;break;case"multipleArrowLine":t=e.positions;break;default:break}return t}function BD(e,t){let n=Cesium.Transforms.eastNorthUpToFixedFrame(t),r=Cesium.Matrix4.inverse(n,new Cesium.Matrix4),o=Cesium.Matrix4.multiplyByPoint(r,t,new Cesium.Cartesian3),a=Cesium.Matrix4.multiplyByPoint(r,e,new Cesium.Cartesian3),u=Math.atan2(a.y-o.y,a.x-o.x)*(180/Math.PI);return u<0&&(u=u+360),u}function nu(e,t,n){let r=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t||0)),a=Cesium.Matrix4.fromRotationTranslation(o);return Cesium.Matrix4.multiply(r,a,r),Cesium.Matrix4.multiplyByPoint(r,new Cesium.Cartesian3(0,n,0),new Cesium.Cartesian3)}function OD(e,t,n){let r=BD(e,t),o=r+30-90,a=r-30-90,s=[],u=Cesium.Cartesian3.distance(e,t)/10;if(n=="triangle"){let l=nu(t,r+90,u/10),c=nu(l,o,u),f=nu(l,a,u);s=[c,l,f]}else{let l=nu(t,r+90,0),c=nu(l,o,u),f=nu(l,a,u);s=[c,l,f]}return s}function mp(e,t){t=Cesium.defaultValue(t,100);let n=e.length,r=[];if(n>2){let o=[],a=[],s=[];for(let u=0;u<n;u++)a.push(e.length-u-1),s.push(u),o.push(A_e(u,n));for(let u=0;u<t;u++){let l=u/t,c=new Cesium.Cartesian3,f=new Cesium.Cartesian3;for(let h=0;h<n;h++){let d=o[h]*Math.pow(1-l,a[h])*Math.pow(l,s[h]);Cesium.Cartesian3.multiplyByScalar(e[h],d,c),Cesium.Cartesian3.add(f,c,f)}r.push(f)}r.push(e[e.length-1])}else r=e;return r}function A_e(e,t){let n=1,r=1;for(let a=1;a<e+1;a++)r=r*a,n=(t-a)*n;return n/r}function GC(e,t,n,r){let o=BD(e,t),a=o+30-90,s=[],u=o-30-90;if(n=n/10,r=="triangle"){let l=nu(t,o+90,n/10),c=nu(l,a,n),f=nu(l,u,n);s=[c,l,f]}else{let l=nu(t,o+90,0),c=nu(l,a,n),f=nu(l,u,n);s=[c,l,f]}return s}function Ri(e){let t=e;Si&&(j!=null&&(t.gemotryList.remove(j.id),t.viewer.entities.remove(j),j.outline!=null&&j.outline.show&&Ft!=null&&t.viewer.entities.remove(Ft),t.index--),g0=!1,j=void 0,Ft=void 0,ui=void 0),m0=!1,un=0,ry=!1,Dn={},Si=!0,Wa=!1,t.billboardCollection.removeAll(),oy==null&&(oy=new Cesium.ScreenSpaceEventHandler(t.viewer.scene.canvas)),QW(oy,t.viewer,t)}var $W=ye;var ls=63710088e-1,EP={meters:ls,metres:ls,millimeters:ls*1e3,millimetres:ls*1e3,centimeters:ls*100,centimetres:ls*100,kilometers:ls/1e3,kilometres:ls/1e3,miles:ls/1609.344,nauticalmiles:ls/1852,inches:ls*39.37,yards:ls/1.0936,feet:ls*3.28084,radians:1,degrees:ls/111325},zY={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:1/1e3,kilometres:1/1e3,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/ls,degrees:1/111325},rP={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function aa(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.bbox,o=n.id;if(e===void 0)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");r&&Ex(r),o&&SP(o);var a={type:"Feature"};return o&&(a.id=o),r&&(a.bbox=r),a.properties=t||{},a.geometry=e,a}function VY(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.bbox;if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");r&&Ex(r);var o;switch(e){case"Point":o=kr(t).geometry;break;case"LineString":o=Ni(t).geometry;break;case"Polygon":o=Pn(t).geometry;break;case"MultiPoint":o=TP(t).geometry;break;case"MultiLineString":o=N0(t).geometry;break;case"MultiPolygon":o=wx(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(o.bbox=r),o}function kr(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ci(e[0])||!ci(e[1]))throw new Error("coordinates must contain numbers");return aa({type:"Point",coordinates:e},t,n)}function kY(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Vt(e.map(function(r){return kr(r,t)}),n)}function Pn(e,t,n){if(!e)throw new Error("coordinates is required");for(var r=0;r<e.length;r++){var o=e[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(r===0&&a===0&&!ci(o[0][0])||!ci(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return aa({type:"Polygon",coordinates:e},t,n)}function GY(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Vt(e.map(function(r){return Pn(r,t)}),n)}function Ni(e,t,n){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!ci(e[0][1])||!ci(e[0][1]))throw new Error("coordinates must contain numbers");return aa({type:"LineString",coordinates:e},t,n)}function UY(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Vt(e.map(function(r){return Ni(r,t)}),n)}function Vt(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");n&&Ex(n),r&&SP(r);var o={type:"FeatureCollection"};return r&&(o.id=r),n&&(o.bbox=n),o.features=e,o}function N0(e,t,n){if(!e)throw new Error("coordinates is required");return aa({type:"MultiLineString",coordinates:e},t,n)}function TP(e,t,n){if(!e)throw new Error("coordinates is required");return aa({type:"MultiPoint",coordinates:e},t,n)}function wx(e,t,n){if(!e)throw new Error("coordinates is required");return aa({type:"MultiPolygon",coordinates:e},t,n)}function q3(e,t,n){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return aa({type:"GeometryCollection",geometries:e},t,n)}function HY(e,t){if(e==null||isNaN(e))throw new Error("num is required");if(t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function JC(e,t){if(e==null)throw new Error("radians is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=EP[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e*n}function fy(e,t){if(e==null)throw new Error("distance is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=EP[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e/n}function iP(e,t){return T0(fy(e,t))}function v0(e){if(e==null)throw new Error("bearing is required");var t=e%360;return t<0&&(t+=360),t}function T0(e){if(e==null)throw new Error("radians is required");var t=e%(2*Math.PI);return t*180/Math.PI}function Ya(e){if(e==null)throw new Error("degrees is required");var t=e%360;return t*Math.PI/180}function hy(e,t,n){if(e==null)throw new Error("length is required");if(!(e>=0))throw new Error("length must be a positive number");return JC(fy(e,t),n||"kilometers")}function qY(e,t,n){if(e==null)throw new Error("area is required");if(!(e>=0))throw new Error("area must be a positive number");var r=rP[t||"meters"];if(!r)throw new Error("invalid original units");var o=rP[n||"kilometers"];if(!o)throw new Error("invalid final units");return e/r*o}function ci(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function gt(e){return!!e&&e.constructor===Object}function Ex(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!ci(t))throw new Error("bbox must only contain numbers")})}function SP(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function b_e(){throw new Error("method has been renamed to `radiansToDegrees`")}function I_e(){throw new Error("method has been renamed to `degreesToRadians`")}function D_e(){throw new Error("method has been renamed to `lengthToDegrees`")}function P_e(){throw new Error("method has been renamed to `lengthToRadians`")}function M_e(){throw new Error("method has been renamed to `radiansToLength`")}function L_e(){throw new Error("method has been renamed to `bearingToAzimuth`")}function R_e(){throw new Error("method has been renamed to `convertLength`")}var O_e=Object.freeze({earthRadius:ls,factors:EP,unitsFactors:zY,areaFactors:rP,feature:aa,geometry:VY,point:kr,points:kY,polygon:Pn,polygons:GY,lineString:Ni,lineStrings:UY,featureCollection:Vt,multiLineString:N0,multiPoint:TP,multiPolygon:wx,geometryCollection:q3,round:HY,radiansToLength:JC,lengthToRadians:fy,lengthToDegrees:iP,bearingToAzimuth:v0,radiansToDegrees:T0,degreesToRadians:Ya,convertLength:hy,convertArea:qY,isNumber:ci,isObject:gt,validateBBox:Ex,validateId:SP,radians2degrees:b_e,degrees2radians:I_e,distanceToDegrees:D_e,distanceToRadians:P_e,radiansToDistance:M_e,bearingToAngle:L_e,convertDistance:R_e});function Xa(e,t,n){if(e!==null)for(var r,o,a,s,u,l,c,f=0,h=0,d,p=e.type,_=p==="FeatureCollection",y=p==="Feature",v=_?e.features.length:1,w=0;w<v;w++){c=_?e.features[w].geometry:y?e.geometry:e,d=c?c.type==="GeometryCollection":!1,u=d?c.geometries.length:1;for(var C=0;C<u;C++){var E=0,S=0;if(s=d?c.geometries[C]:c,s!==null){l=s.coordinates;var A=s.type;switch(f=n&&(A==="Polygon"||A==="MultiPolygon")?1:0,A){case null:break;case"Point":t(l,h,w,E,S),h++,E++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++)t(l[r],h,w,E,S),h++,A==="MultiPoint"&&E++;A==="LineString"&&E++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-f;o++)t(l[r][o],h,w,E,S),h++;A==="MultiLineString"&&E++,A==="Polygon"&&S++}A==="Polygon"&&E++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(A==="MultiPolygon"&&(S=0),o=0;o<l[r].length;o++){for(a=0;a<l[r][o].length-f;a++)t(l[r][o][a],h,w,E,S),h++;S++}E++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)Xa(s.geometries[r],t,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function AP(e,t,n,r){var o=n;return Xa(e,function(a,s,u,l,c){s===0&&n===void 0?o=a:o=t(o,a,s,u,l,c)},r),o}function W3(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length;n++)t(e.features[n].properties,n);break;case"Feature":t(e.properties,0);break}}function WY(e,t,n){var r=n;return W3(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function fi(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)t(e.features[n],n)}function Y3(e,t,n){var r=n;return fi(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function Ep(e){var t=[];return Xa(e,function(n){t.push(n)}),t}function ch(e,t){var n,r,o,a,s,u,l,c,f,h,d=0,p=e.type==="FeatureCollection",_=e.type==="Feature",y=p?e.features.length:1;for(n=0;n<y;n++){for(u=p?e.features[n].geometry:_?e.geometry:e,c=p?e.features[n].properties:_?e.properties:{},f=p?e.features[n].bbox:_?e.bbox:void 0,h=p?e.features[n].id:_?e.id:void 0,l=u?u.type==="GeometryCollection":!1,s=l?u.geometries.length:1,o=0;o<s;o++){if(a=l?u.geometries[o]:u,a===null){t(null,d,c,f,h);continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{t(a,d,c,f,h);break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)t(a.geometries[r],d,c,f,h);break}default:throw new Error("Unknown Geometry Type")}}d++}}function X3(e,t,n){var r=n;return ch(e,function(o,a,s,u,l){a===0&&n===void 0?r=o:r=t(r,o,a,s,u,l)}),r}function Ho(e,t){ch(e,function(n,r,o,a,s){var u=n===null?null:n.type;switch(u){case null:case"Point":case"LineString":case"Polygon":t(aa(n,o,{bbox:a,id:s}),r,0);return}var l;switch(u){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}n.coordinates.forEach(function(c,f){var h={type:l,coordinates:c};t(aa(h,o),r,f)})})}function YY(e,t,n){var r=n;return Ho(e,function(o,a,s){a===0&&s===0&&n===void 0?r=o:r=t(r,o,a,s)}),r}function km(e,t){Ho(e,function(n,r,o){var a=0;if(!!n.geometry){var s=n.geometry.type;s==="Point"||s==="MultiPoint"||AP(n,function(u,l,c,f,h,d){var p=Ni([u,l],n.properties);return t(p,r,o,d,a),a++,l})}})}function j3(e,t,n){var r=n,o=!1;return km(e,function(a,s,u,l,c){o===!1&&n===void 0?r=a:r=t(r,a,s,u,l,c),o=!0}),r}function K3(e,t){if(!e)throw new Error("geojson is required");Ho(e,function(n,r,o){if(n.geometry!==null){var a=n.geometry.type,s=n.geometry.coordinates;switch(a){case"LineString":t(n,r,o,0,0);break;case"Polygon":for(var u=0;u<s.length;u++)t(Ni(s[u],n.properties),r,o,u);break}}})}function Z3(e,t,n){var r=n;return K3(e,function(o,a,s,u){a===0&&n===void 0?r=o:r=t(r,o,a,s,u)}),r}var N_e=Object.freeze({coordEach:Xa,coordReduce:AP,propEach:W3,propReduce:WY,featureEach:fi,featureReduce:Y3,coordAll:Ep,geomEach:ch,geomReduce:X3,flattenEach:Ho,flattenReduce:YY,segmentEach:km,segmentReduce:j3,lineEach:K3,lineReduce:Z3});function wa(e){var t=[1/0,1/0,-1/0,-1/0];return Xa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function so(e){if(!e)throw new Error("obj is required");var t=Tt(e);if(t.length>1&&ci(t[0])&&ci(t[1]))return t;throw new Error("Coordinate is not a valid Point")}function Tt(e){if(!e)throw new Error("obj is required");var t;if(e.length?t=e:e.coordinates?t=e.coordinates:e.geometry&&e.geometry.coordinates&&(t=e.geometry.coordinates),t)return bP(t),t;throw new Error("No valid coordinates")}function bP(e){if(e.length>1&&ci(e[0])&&ci(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return bP(e[0]);throw new Error("coordinates must only contain numbers")}function XY(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function xT(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function Sd(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<e.features.length;r++){var o=e.features[r];if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+o.geometry.type)}}function Hl(e){if(!e)throw new Error("geojson is required");if(e.geometry!==void 0)return e.geometry;if(e.coordinates||e.geometries)return e;throw new Error("geojson must be a valid Feature or Geometry Object")}function jY(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function Bi(e,t){if(!e)throw new Error((t||"geojson")+" is required");if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error((t||"geojson")+" is invalid")}var B_e=Object.freeze({getCoord:so,getCoords:Tt,containsNumber:bP,geojsonType:XY,featureOf:xT,collectionOf:Sd,getGeom:Hl,getGeomType:jY,getType:Bi});/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var e7={successCallback:null,verbose:!1},zD={};function F_e(e,t,n){n=n||{};for(var r=Object.keys(e7),o=0;o<r.length;o++){var a=r[o],s=n[a];s=typeof s<"u"&&s!==null?s:e7[a],zD[a]=s}zD.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var u=k_e(z_e(e,t));return typeof zD.successCallback=="function"&&zD.successCallback(u),u}function Oi(e,t,n){return(e-t)/(n-t)}function z_e(e,t){for(var n=e.length-1,r=e[0].length-1,o={rows:n,cols:r,cells:[]},a=0;a<n;++a){o.cells[a]=[];for(var s=0;s<r;++s){var u=0,l=e[a+1][s],c=e[a+1][s+1],f=e[a][s+1],h=e[a][s];if(!(isNaN(l)||isNaN(c)||isNaN(f)||isNaN(h))){u|=l>=t?8:0,u|=c>=t?4:0,u|=f>=t?2:0,u|=h>=t?1:0;var d=!1;if(u===5||u===10){var p=(l+c+f+h)/4;u===5&&p<t?(u=10,d=!0):u===10&&p<t&&(u=5,d=!0)}if(u!==0&&u!==15){var _,y,v,w;_=y=v=w=.5,u===1?(v=1-Oi(t,l,h),y=1-Oi(t,f,h)):u===2?(y=Oi(t,h,f),w=1-Oi(t,c,f)):u===3?(v=1-Oi(t,l,h),w=1-Oi(t,c,f)):u===4?(_=Oi(t,l,c),w=Oi(t,f,c)):u===5?(_=Oi(t,l,c),w=Oi(t,f,c),y=1-Oi(t,f,h),v=1-Oi(t,l,h)):u===6?(y=Oi(t,h,f),_=Oi(t,l,c)):u===7?(v=1-Oi(t,l,h),_=Oi(t,l,c)):u===8?(v=Oi(t,h,l),_=1-Oi(t,c,l)):u===9?(y=1-Oi(t,f,h),_=1-Oi(t,c,l)):u===10?(_=1-Oi(t,c,l),w=1-Oi(t,c,f),y=Oi(t,h,f),v=Oi(t,h,l)):u===11?(_=1-Oi(t,c,l),w=1-Oi(t,c,f)):u===12?(v=Oi(t,h,l),w=Oi(t,f,c)):u===13?(y=1-Oi(t,f,h),w=Oi(t,f,c)):u===14?(v=Oi(t,h,l),y=Oi(t,h,f)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+u),o.cells[a][s]={cval:u,flipped:d,top:_,right:w,bottom:y,left:v}}}}}return o}function V_e(e){return e.cval===5||e.cval===10}function KY(e){return e.cval===0||e.cval===15}function t7(e){!KY(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function i3(e,t){if(t==="top")return[e.top,1];if(t==="bottom")return[e.bottom,0];if(t==="right")return[1,e.right];if(t==="left")return[0,e.left]}function k_e(e){var t=[],n=0,r=e.rows,o=e.cols,a=1e-7;return e.cells.forEach(function(s,u){s.forEach(function(l,c){if(typeof l<"u"&&!V_e(l)&&!KY(l)){var f=G_e(e.cells,u,c),h=!1;if(f.info==="mergeable"){for(var d=f.path[f.path.length-1][0],p=f.path[f.path.length-1][1],_=n-1;_>=0;_--)if(Math.abs(t[_][0][0]-d)<=a&&Math.abs(t[_][0][1]-p)<=a){for(var y=f.path.length-2;y>=0;--y)t[_].unshift(f.path[y]);h=!0;break}}h||(t[n++]=f.path)}})}),t}function G_e(e,t,n){var r=e.length,o=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],s=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u,l,c=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],f=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],_,h=e[t][n],d=e[t][n],p=d.cval,_=c[p],y=i3(d,_);o.push([n+y[0],t+y[1]]),_=f[p],y=i3(d,_),o.push([n+y[0],t+y[1]]),t7(d);for(var v=n+a[p],w=t+s[p],C=p;v>=0&&w>=0&&w<r&&(v!=n||w!=t)&&(d=e[w][v],!(typeof d>"u"));){if(p=d.cval,p===0||p===15)return{path:o,info:"mergeable"};_=f[p],u=a[p],l=s[p],(p===5||p===10)&&(p===5?d.flipped?s[C]===-1?(_="left",u=-1,l=0):(_="right",u=1,l=0):a[C]===-1&&(_="bottom",u=0,l=-1):p===10&&(d.flipped?a[C]===-1?(_="top",u=0,l=1):(_="bottom",u=0,l=-1):s[C]===1&&(_="left",u=-1,l=0))),y=i3(d,_),o.push([v+y[0],w+y[1]]),t7(d),v+=u,w+=l,C=p}return{path:o,info:"closed"}}function U_e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;Sd(e,"Point","input must contain Points");for(var a=H_e(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function H_e(e,t){var n={};fi(e,function(a){var s=Tt(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return Tt(l)[0]-Tt(c)[0]});return u}),o=r.sort(function(a,s){return t?Tt(a[0])[1]-Tt(s[0])[1]:Tt(s[0])[1]-Tt(a[0])[1]});return o}function q_e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(Sd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!gt(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(a))throw new Error("breaksProperties must be an Array");var s=U_e(e,{zProperty:r,flip:!0}),u=W_e(s,t,r,o,a),l=Y_e(u,s,e);return Vt(l)}function W_e(e,t,n,r,o){for(var a=[],s=1;s<t.length;s++){var u=+t[s],l=Object.assign({},r,o[s]);l[n]=u;var c=N0(F_e(e,u),l);a.push(c)}return a}function Y_e(e,t,n){var r=wa(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){Xa(p,d)}),e}var X_e=ZY;function ZY(e,t,n,r,o){for(n=n||0,r=r||e.length-1,o=o||j_e;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));ZY(e,t,f,h,o)}var d=e[t],p=n,_=r;for(aT(e,n,t),o(e[r],d)>0&&aT(e,n,r);p<_;){for(aT(e,p,_),p++,_--;o(e[p],d)<0;)p++;for(;o(e[_],d)>0;)_--}o(e[n],d)===0?aT(e,n,_):(_++,aT(e,_,r)),_<=t&&(n=_+1),t<=_&&(r=_-1)}}function aT(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function j_e(e,t){return e<t?-1:e>t?1:0}var $C=oP;function oP(e,t){if(!(this instanceof oP))return new oP(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}oP.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!kD(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,kD(e,l)&&(t.leaf?n.push(u):a3(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!kD(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,kD(e,u)){if(t.leaf||a3(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=qC([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=K_e(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&a3(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:n7,compareMinY:r7,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=qC(e.slice(t,n+1)),UC(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=qC([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(i7(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),i7(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return UC(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=o3(s),c=Z_e(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),dT(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=qC(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,UC(n,this.toBBox),UC(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=qC([e,t]),this.data.height=e.height+1,this.data.leaf=!1,UC(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=hT(e,0,r,this.toBBox),a=hT(e,r,n,this.toBBox),s=Q_e(o,a),u=o3(o)+o3(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:n7,o=e.leaf?this.compareMinY:r7,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=hT(e,0,t,o),s=hT(e,n-t,n,o),u=VD(a)+VD(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],dT(a,e.leaf?o(c):c),u+=VD(a);for(l=n-t-1;l>=t;l--)c=e.children[l],dT(s,e.leaf?o(c):c),u+=VD(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)dT(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():UC(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function K_e(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function UC(e,t){hT(e,0,e.children.length,t,e)}function hT(e,t,n,r,o){o||(o=qC(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],dT(o,e.leaf?r(s):s);return o}function dT(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function n7(e,t){return e.minX-t.minX}function r7(e,t){return e.minY-t.minY}function o3(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function VD(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Z_e(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Q_e(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function a3(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function kD(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function qC(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function i7(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,X_e(e,s,t,n,o),a.push(t,s,s,n))}function tg(e,t){return t={exports:{}},e(t,t.exports),t.exports}var JD=J_e,o7=+(Math.pow(2,27)+1);function J_e(e,t,n){var r=e*t,o=o7*e,a=o-e,s=o-a,u=e-s,l=o7*t,c=l-t,f=l-c,h=t-f,d=r-s*f,p=d-u*f,_=p-s*h,y=u*h-_;return n?(n[0]=y,n[1]=r,n):[y,r]}var $_e=tye;function eye(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function tye(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return eye(e[0],t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=t[l],p=c(d),_,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=t[l],p=c(d))),u<n&&h<p||l>=r?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=t[l],p=c(d)));for(var v=_+y,w=v-_,C=y-w,E=C,S=v,A,D,P,M,b;u<n&&l<r;)h<p?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=t[l],p=c(d))),y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A;for(;u<n;)_=f,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)_=d,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,l+=1,l<r&&(d=t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var nye=rye;function rye(e,t,n){var r=e+t,o=r-e,a=r-o,s=t-o,u=e-a;return n?(n[0]=u+s,n[1]=r,n):[u+s,r]}var iye=oye;function oye(e,t){var n=e.length;if(n===1){var r=JD(e[0],t);return r[0]?r:[r[1]]}var o=new Array(2*n),a=[.1,.1],s=[.1,.1],u=0;JD(e[0],t,a),a[0]&&(o[u++]=a[0]);for(var l=1;l<n;++l){JD(e[l],t,s);var c=a[1];nye(c,s[0],a),a[0]&&(o[u++]=a[0]);var f=s[1],h=a[1],d=f+h,p=d-f,_=h-p;a[1]=d,_&&(o[u++]=_)}return a[1]&&(o[u++]=a[1]),u===0&&(o[u++]=0),o.length=u,o}var aye=uye;function sye(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function uye(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return sye(e[0],-t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=-t[l],p=c(d),_,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=-t[l],p=c(d))),u<n&&h<p||l>=r?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=-t[l],p=c(d)));for(var v=_+y,w=v-_,C=y-w,E=C,S=v,A,D,P,M,b;u<n&&l<r;)h<p?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=-t[l],p=c(d))),y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A;for(;u<n;)_=f,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)_=d,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,l+=1,l<r&&(d=-t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var QY=tg(function(e){var t=5,n=11102230246251565e-32,r=(3+16*n)*n,o=(7+56*n)*n;function a(v,w){for(var C=new Array(v.length-1),E=1;E<v.length;++E)for(var S=C[E-1]=new Array(v.length-1),A=0,D=0;A<v.length;++A)A!==w&&(S[D++]=v[E][A]);return C}function s(v){for(var w=new Array(v),C=0;C<v;++C){w[C]=new Array(v);for(var E=0;E<v;++E)w[C][E]=["m",E,"[",v-C-1,"]"].join("")}return w}function u(v){return v&1?"-":""}function l(v){if(v.length===1)return v[0];if(v.length===2)return["sum(",v[0],",",v[1],")"].join("");var w=v.length>>1;return["sum(",l(v.slice(0,w)),",",l(v.slice(w)),")"].join("")}function c(v){if(v.length===2)return[["sum(prod(",v[0][0],",",v[1][1],"),prod(-",v[0][1],",",v[1][0],"))"].join("")];for(var w=[],C=0;C<v.length;++C)w.push(["scale(",l(c(a(v,C))),",",u(C),v[0][C],")"].join(""));return w}function f(v){for(var w=[],C=[],E=s(v),S=[],A=0;A<v;++A)(A&1)===0?w.push.apply(w,c(a(E,A))):C.push.apply(C,c(a(E,A))),S.push("m"+A);var D=l(w),P=l(C),M="orientation"+v+"Exact",b=["function ",M,"(",S.join(),"){var p=",D,",n=",P,",d=sub(p,n);return d[d.length-1];};return ",M].join(""),O=new Function("sum","prod","scale","sub",b);return O($_e,JD,iye,aye)}var h=f(3),d=f(4),p=[function(){return 0},function(){return 0},function(w,C){return C[0]-w[0]},function(w,C,E){var S=(w[1]-E[1])*(C[0]-E[0]),A=(w[0]-E[0])*(C[1]-E[1]),D=S-A,P;if(S>0){if(A<=0)return D;P=S+A}else if(S<0){if(A>=0)return D;P=-(S+A)}else return D;var M=r*P;return D>=M||D<=-M?D:h(w,C,E)},function(w,C,E,S){var A=w[0]-S[0],D=C[0]-S[0],P=E[0]-S[0],M=w[1]-S[1],b=C[1]-S[1],O=E[1]-S[1],m=w[2]-S[2],I=C[2]-S[2],L=E[2]-S[2],R=D*O,N=P*b,B=P*M,V=A*O,z=A*b,U=D*M,Q=m*(R-N)+I*(B-V)+L*(z-U),ne=(Math.abs(R)+Math.abs(N))*Math.abs(m)+(Math.abs(B)+Math.abs(V))*Math.abs(I)+(Math.abs(z)+Math.abs(U))*Math.abs(L),se=o*ne;return Q>se||-Q>se?Q:d(w,C,E,S)}];function _(v){var w=p[v.length];return w||(w=p[v.length]=f(v.length)),w.apply(void 0,v)}function y(){for(;p.length<=t;)p.push(f(p.length));for(var v=[],w=["slow"],C=0;C<=t;++C)v.push("a"+C),w.push("o"+C);for(var E=["function getOrientation(",v.join(),"){switch(arguments.length){case 0:case 1:return 0;"],C=2;C<=t;++C)E.push("case ",C,":return o",C,"(",v.slice(0,C).join(),");");E.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),w.push(E.join(""));var S=Function.apply(void 0,w);e.exports=S.apply(void 0,[_].concat(p));for(var C=0;C<=t;++C)e.exports[C]=p[C]}y()}),lye=cye,a7=QY[3];function cye(e){var t=e.length;if(t<3){for(var c=new Array(t),n=0;n<t;++n)c[n]=n;return t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:c}for(var r=new Array(t),n=0;n<t;++n)r[n]=n;r.sort(function(p,_){var y=e[p][0]-e[_][0];return y||e[p][1]-e[_][1]});for(var o=[r[0],r[1]],a=[r[0],r[1]],n=2;n<t;++n){for(var s=r[n],u=e[s],l=o.length;l>1&&a7(e[o[l-2]],e[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(s),l=a.length;l>1&&a7(e[a[l-2]],e[a[l-1]],u)>=0;)l-=1,a.pop();a.push(s)}for(var c=new Array(a.length+o.length-2),f=0,n=0,h=o.length;n<h;++n)c[f++]=o[n];for(var d=a.length-2;d>0;--d)c[f++]=a[d];return c}var JY=wT,fye=wT;function wT(e,t){if(!(this instanceof wT))return new wT(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||hye,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function hye(e,t){return e<t?-1:e>t?1:0}wT.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var o=e-1>>1,a=t[o];if(n(r,a)>=0)break;t[e]=a,e=o}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,o=t[e];e<r;){var a=(e<<1)+1,s=a+1,u=t[a];if(s<this.length&&n(t[s],u)<0&&(a=s,u=t[s]),n(u,o)>=0)break;t[e]=u,e=a}t[e]=o}};JY.default=fye;var dye=function(e,t){for(var n=e[0],r=e[1],o=!1,a=0,s=t.length-1;a<t.length;s=a++){var u=t[a][0],l=t[a][1],c=t[s][0],f=t[s][1],h=l>r!=f>r&&n<(c-u)*(r-l)/(f-l)+u;h&&(o=!o)}return o},GD=QY[3],$Y=eX,pye=eX;function eX(e,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;for(var r=vye(e),o=$C(16,["[0]","[1]","[0]","[1]"]).load(e),a=[],s=0,u;s<r.length;s++){var l=r[s];o.remove(l),u=l7(l,u),a.push(u)}var c=$C(16);for(s=0;s<a.length;s++)c.insert(s3(a[s]));for(var f=t*t,h=n*n;a.length;){var d=a.shift(),p=d.p,_=d.next.p,y=u3(p,_);if(!(y<h)){var v=y/f;l=mye(o,d.prev.p,p,_,d.next.next.p,v,c),l&&Math.min(u3(l,p),u3(l,_))<=v&&(a.push(d),a.push(l7(l,d)),o.remove(l),c.remove(d),c.insert(s3(d)),c.insert(s3(d.next)))}}d=u;var w=[];do w.push(d.p),d=d.next;while(d!==u);return w.push(d.p),w}function mye(e,t,n,r,o,a,s){for(var u=new JY(null,gye),l=e.data;l;){for(var c=0;c<l.children.length;c++){var f=l.children[c],h=l.leaf?l3(f,n,r):_ye(n,r,f);h>a||u.push({node:f,dist:h})}for(;u.length&&!u.peek().node.children;){var d=u.pop(),p=d.node,_=l3(p,t,n),y=l3(p,r,o);if(d.dist<_&&d.dist<y&&u7(n,p,s)&&u7(r,p,s))return p}l=u.pop(),l&&(l=l.node)}return null}function gye(e,t){return e.dist-t.dist}function _ye(e,t,n){if(s7(e,n)||s7(t,n))return 0;var r=UD(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var o=UD(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(o===0)return 0;var a=UD(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var s=UD(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return s===0?0:Math.min(r,o,a,s)}function s7(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function u7(e,t,n){for(var r=Math.min(e[0],t[0]),o=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),s=Math.max(e[1],t[1]),u=n.search({minX:r,minY:o,maxX:a,maxY:s}),l=0;l<u.length;l++)if(yye(u[l].p,u[l].next.p,e,t))return!1;return!0}function yye(e,t,n,r){return e!==r&&t!==n&&GD(e,t,n)>0!=GD(e,t,r)>0&&GD(n,r,e)>0!=GD(n,r,t)>0}function s3(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function vye(e){for(var t=e[0],n=e[0],r=e[0],o=e[0],a=0;a<e.length;a++){var s=e[a];s[0]<t[0]&&(t=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>o[1]&&(o=s)}var u=[t,n,r,o],l=u.slice();for(a=0;a<e.length;a++)dye(e[a],u)||l.push(e[a]);var c=lye(l),f=[];for(a=0;a<c.length;a++)f.push(l[c[a]]);return f}function l7(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function u3(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function l3(e,t,n){var r=t[0],o=t[1],a=n[0]-r,s=n[1]-o;if(a!==0||s!==0){var u=((e[0]-r)*a+(e[1]-o)*s)/(a*a+s*s);u>1?(r=n[0],o=n[1]):u>0&&(r+=a*u,o+=s*u)}return a=e[0]-r,s=e[1]-o,a*a+s*s}function UD(e,t,n,r,o,a,s,u){var l=n-e,c=r-t,f=s-o,h=u-a,d=e-o,p=t-a,_=l*l+c*c,y=l*f+c*h,v=f*f+h*h,w=l*d+c*p,C=f*d+h*p,E=_*v-y*y,S,A,D,P,M=E,b=E;E===0?(A=0,M=1,P=C,b=v):(A=y*C-v*w,P=_*C-y*w,A<0?(A=0,P=C,b=v):A>M&&(A=M,P=C+y,b=v)),P<0?(P=0,-w<0?A=0:-w>_?A=M:(A=-w,M=_)):P>b&&(P=b,-w+y<0?A=0:-w+y>_?A=M:(A=-w+y,M=_)),S=A===0?0:A/M,D=P===0?0:P/b;var O=(1-S)*e+S*n,m=(1-S)*t+S*r,I=(1-D)*o+D*s,L=(1-D)*a+D*u,R=I-O,N=L-m;return R*R+N*N}$Y.default=pye;function tX(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.concavity||1/0,r=[];if(Xa(e,function(a){r.push([a[0],a[1]])}),!r.length)return null;var o=$Y(r,n);return o.length>3?Pn([o]):null}function Co(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=so(e),a=Tt(t),s=t.geometry?t.geometry.type:t.type,u=t.bbox;if(u&&Cye(o,u)===!1)return!1;s==="Polygon"&&(a=[a]);for(var l=0,c=!1;l<a.length&&!c;l++)if(c7(o,a[l][0],r)){for(var f=!1,h=1;h<a[l].length&&!f;)c7(o,a[l][h],!r)&&(f=!0),h++;f||(c=!0)}return c}function c7(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],u=t[o][1],l=t[a][0],c=t[a][1],f=e[1]*(s-l)+u*(l-e[0])+c*(e[0]-s)===0&&(s-e[0])*(l-e[0])<=0&&(u-e[1])*(c-e[1])<=0;if(f)return!n;var h=u>e[1]!=c>e[1]&&e[0]<(l-s)*(e[1]-u)/(c-u)+s;h&&(r=!r)}return r}function Cye(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function T3(e,t){var n=[];return ch(t,function(r){fi(e,function(o){Co(o,r)&&n.push(o)})}),Vt(n)}function nX(e,t){if(e.type!=="FeatureCollection")throw new Error("points must be a FeatureCollection");var n=!1;return Vt(Eye(e.features.map(function(r){var o={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1]};return t?o.z=r.properties[t]:r.geometry.coordinates.length===3&&(n=!0,o.z=r.geometry.coordinates[2]),o})).map(function(r){var o=[r.a.x,r.a.y],a=[r.b.x,r.b.y],s=[r.c.x,r.c.y],u={};return n?(o.push(r.a.z),a.push(r.b.z),s.push(r.c.z)):u={a:r.a.z,b:r.b.z,c:r.c.z},Pn([[o,a,s,o]],u)}))}function f7(e,t,n){this.a=e,this.b=t,this.c=n;var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,u=r*(e.x+t.x)+o*(e.y+t.y),l=a*(e.x+n.x)+s*(e.y+n.y),c=2*(r*(n.y-t.y)-o*(n.x-t.x)),f,h;this.x=(s*u-o*l)/c,this.y=(r*l-a*u)/c,f=this.x-e.x,h=this.y-e.y,this.r=f*f+h*h}function xye(e,t){return t.x-e.x}function wye(e){var t=e.length,n,r,o,a,s;e:for(;t;)for(r=e[--t],n=e[--t],o=t;o;)if(s=e[--o],a=e[--o],n===a&&r===s||n===s&&r===a){e.splice(t,2),e.splice(o,2),t-=2;continue e}}function Eye(e){if(e.length<3)return[];e.sort(xye);for(var t=e.length-1,n=e[t].x,r=e[0].x,o=e[t].y,a=o,s=1e-12,u,l,c,f,h,d;t--;)e[t].y<o&&(o=e[t].y),e[t].y>a&&(a=e[t].y);var p=r-n,_=a-o,y=p>_?p:_,v=(r+n)*.5,w=(a+o)*.5,C=[new f7({x:v-20*y,y:w-y,__sentinel:!0},{x:v,y:w+20*y,__sentinel:!0},{x:v+20*y,y:w-y,__sentinel:!0})],E=[],S=[],A;for(t=e.length;t--;){for(S.length=0,A=C.length;A--;){if(p=e[t].x-C[A].x,p>0&&p*p>C[A].r){E.push(C[A]),C.splice(A,1);continue}_=e[t].y-C[A].y,!(p*p+_*_>C[A].r)&&(S.push(C[A].a,C[A].b,C[A].b,C[A].c,C[A].c,C[A].a),C.splice(A,1))}for(wye(S),A=S.length;A;)l=S[--A],u=S[--A],c=e[t],f=l.x-u.x,h=l.y-u.y,d=2*(f*(c.y-l.y)-h*(c.x-l.x)),Math.abs(d)>s&&C.push(new f7(u,l,c))}for(Array.prototype.push.apply(E,C),t=E.length;t--;)(E[t].a.__sentinel||E[t].b.__sentinel||E[t].c.__sentinel)&&E.splice(t,1);return E}function li(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=so(e),a=so(t),s=Ya(a[1]-o[1]),u=Ya(a[0]-o[0]),l=Ya(o[1]),c=Ya(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return JC(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r)}function lu(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return rX(e);case"FeatureCollection":return Tye(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Q3(e);default:throw new Error("unknown GeoJSON type")}}function rX(e){var t={type:"Feature"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}}),t.properties=iX(e.properties),t.geometry=Q3(e.geometry),t}function iX(e){var t={};return e&&Object.keys(e).forEach(function(n){var r=e[n];typeof r=="object"?r===null?t[n]=null:r.length?t[n]=r.map(function(o){return o}):t[n]=iX(r):t[n]=r}),t}function Tye(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}}),t.features=e.features.map(function(n){return rX(n)}),t}function Q3(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(function(n){return Q3(n)}),t):(t.coordinates=oX(e.coordinates),t)}function oX(e){return typeof e[0]!="object"?e.slice():e.map(function(t){return oX(t)})}var Sye=function(e){return e},Aye=function(e){if(e==null)return Sye;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f);for(h[0]=(t+=u[0])*r+a,h[1]=(n+=u[1])*o+s;c<f;)h[c]=u[c],++c;return h}},bye=function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n};function aX(e,t){var n=Aye(e.transform),r=e.arcs;function o(f,h){h.length&&h.pop();for(var d=r[f<0?~f:f],p=0,_=d.length;p<_;++p)h.push(n(d[p],p));f<0&&bye(h,_)}function a(f){return n(f)}function s(f){for(var h=[],d=0,p=f.length;d<p;++d)o(f[d],h);return h.length<2&&h.push(h[0]),h}function u(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function l(f){return f.map(u)}function c(f){var h=f.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":d=a(f.coordinates);break;case"MultiPoint":d=f.coordinates.map(a);break;case"LineString":d=s(f.arcs);break;case"MultiLineString":d=f.arcs.map(s);break;case"Polygon":d=l(f.arcs);break;case"MultiPolygon":d=f.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(t)}var Iye=function(e,t){var n={},r={},o={},a=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=t[++s],t[s]=c,t[f]=d)}),t.forEach(function(c){var f=u(c),h=f[0],d=f[1],p,_;if(p=o[h])if(delete o[p.end],p.push(c),p.end=d,_=r[d]){delete r[_.start];var y=_===p?p:p.concat(_);r[y.start=p.start]=o[y.end=_.end]=y}else r[p.start]=o[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(c),p.start=h,_=o[h]){delete o[_.end];var v=_===p?p:_.concat(p);r[v.start=_.start]=o[v.end=p.end]=v}else r[p.start]=o[p.end]=p;else p=[c],r[p.start=h]=o[p.end=d]=p});function u(c){var f=e.arcs[c<0?~c:c],h=f[0],d;return e.transform?(d=[0,0],f.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=f[f.length-1],c<0?[d,h]:[h,d]}function l(c,f){for(var h in c){var d=c[h];delete f[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),a.push(d)}}return l(o,r),l(r,o),t.forEach(function(c){n[c<0?~c:c]||a.push([c])}),a};function Dye(e){for(var t=-1,n=e.length,r,o=e[n-1],a=0;++t<n;)r=o,o=e[t],a+=r[0]*o[1]-r[1]*o[0];return Math.abs(a)}var Pye=function(e){return aX(e,Mye.apply(this,arguments))};function Mye(e,t){var n={},r=[],o=[];t.forEach(a);function a(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(a);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(c){c.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),r.push(l)}function u(l){return Dye(aX(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return r.forEach(function(l){if(!l._){var c=[],f=[l];for(l._=1,o.push(c);l=f.pop();)c.push(l),l.forEach(function(h){h.forEach(function(d){n[d<0?~d:d].forEach(function(p){p._||(p._=1,f.push(p))})})})}}),r.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:o.map(function(l){var c=[],f;if(l.forEach(function(y){y.forEach(function(v){v.forEach(function(w){n[w<0?~w:w].length<2&&c.push(w)})})}),c=Iye(e,c),(f=c.length)>1)for(var h=1,d=u(c[0]),p,_;h<f;++h)(p=u(c[h]))>d&&(_=c[0],c[0]=c[h],c[h]=_,d=p);return c})}}var Lye=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;function a(h){h!=null&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},Point:function(h){u(h.coordinates)},MultiPoint:function(h){h.coordinates.forEach(u)},LineString:function(h){l(h.arcs)},MultiLineString:function(h){h.arcs.forEach(l)},Polygon:function(h){h.arcs.forEach(l)},MultiPolygon:function(h){h.arcs.forEach(c)}};function u(h){var d=h[0],p=h[1];d<t&&(t=d),d>r&&(r=d),p<n&&(n=p),p>o&&(o=p)}function l(h){h.forEach(u)}function c(h){h.forEach(l)}for(var f in e)a(e[f]);return r>=t&&o>=n?[t,n,r,o]:void 0},Rye=function(e,t,n,r,o){arguments.length===3&&(r=Array,o=null);for(var a=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,u=0;u<e;++u)a[u]=o;function l(h){for(var d=t(h)&s,p=a[d],_=0;p!=o;){if(n(p,h))return!0;if(++_>=e)throw new Error("full hashset");p=a[d=d+1&s]}return a[d]=h,!0}function c(h){for(var d=t(h)&s,p=a[d],_=0;p!=o;){if(n(p,h))return!0;if(++_>=e)break;p=a[d=d+1&s]}return!1}function f(){for(var h=[],d=0,p=a.length;d<p;++d){var _=a[d];_!=o&&h.push(_)}return h}return{add:l,has:c,values:f}},J3=function(e,t,n,r,o,a){arguments.length===3&&(r=a=Array,o=null);for(var s=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new a(e),l=e-1,c=0;c<e;++c)s[c]=o;function f(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v]=y;if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=_,u[v]=y,y}function h(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v];if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=_,u[v]=y,y}function d(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v];if(++C>=e)break;w=s[v=v+1&l]}return y}function p(){for(var _=[],y=0,v=s.length;y<v;++y){var w=s[y];w!=o&&_.push(w)}return _}return{set:f,maybeSet:h,get:d,keys:p}},uy=function(e,t){return e[0]===t[0]&&e[1]===t[1]},sX=new ArrayBuffer(16),h7=new Float64Array(sX),HD=new Uint32Array(sX),S3=function(e){h7[0]=e[0],h7[1]=e[1];var t=HD[0]^HD[1];return t=t<<5^t>>7^HD[2]^HD[3],t&2147483647},Oye=function(e){var t=e.coordinates,n=e.lines,r=e.rings,o=D(),a=new Int32Array(t.length),s=new Int32Array(t.length),u=new Int32Array(t.length),l=new Int8Array(t.length),c=0,f,h,d,p,_;for(f=0,h=t.length;f<h;++f)a[f]=s[f]=u[f]=-1;for(f=0,h=n.length;f<h;++f){var y=n[f],v=y[0],w=y[1];for(p=o[v],_=o[++v],++c,l[p]=1;++v<=w;)A(f,d=p,p=_,_=o[v]);++c,l[_]=1}for(f=0,h=t.length;f<h;++f)a[f]=-1;for(f=0,h=r.length;f<h;++f){var C=r[f],E=C[0]+1,S=C[1];for(d=o[S-1],p=o[E-1],_=o[E],A(f,d,p,_);++E<=S;)A(f,d=p,p=_,_=o[E])}function A(m,I,L,R){if(a[L]!==m){a[L]=m;var N=s[L];if(N>=0){var B=u[L];(N!==I||B!==R)&&(N!==R||B!==I)&&(++c,l[L]=1)}else s[L]=I,u[L]=R}}function D(){for(var m=J3(t.length*1.4,P,M,Int32Array,-1,Int32Array),I=new Int32Array(t.length),L=0,R=t.length;L<R;++L)I[L]=m.maybeSet(L,L);return I}function P(m){return S3(t[m])}function M(m,I){return uy(t[m],t[I])}a=s=u=null;var b=Rye(c*1.4,S3,uy),O;for(f=0,h=t.length;f<h;++f)l[O=o[f]]&&b.add(t[O]);return b},Nye=function(e){var t=Oye(e),n=e.coordinates,r=e.lines,o=e.rings,a,s,u;for(s=0,u=r.length;s<u;++s)for(var l=r[s],c=l[0],f=l[1];++c<f;)t.has(n[c])&&(a={0:c,1:l[1]},l[1]=c,l=l.next=a);for(s=0,u=o.length;s<u;++s)for(var h=o[s],d=h[0],p=d,_=h[1],y=t.has(n[d]);++p<_;)t.has(n[p])&&(y?(a={0:p,1:h[1]},h[1]=p,h=h.next=a):(Bye(n,d,_,_-p),n[_]=n[d],y=!0,p=d));return e};function Bye(e,t,n,r){c3(e,t,n),c3(e,t,t+r),c3(e,t+r,n)}function c3(e,t,n){for(var r=t+(n---t>>1),o;t<r;++t,--n)o=e[t],e[t]=e[n],e[n]=o}var Fye=function(e){var t=e.coordinates,n=e.lines,r,o=e.rings,a,s=n.length+o.length,u,l;for(delete e.lines,delete e.rings,u=0,l=n.length;u<l;++u)for(r=n[u];r=r.next;)++s;for(u=0,l=o.length;u<l;++u)for(a=o[u];a=a.next;)++s;var c=J3(s*2*1.4,S3,uy),f=e.arcs=[];for(u=0,l=n.length;u<l;++u){r=n[u];do h(r);while(r=r.next)}for(u=0,l=o.length;u<l;++u)if(a=o[u],a.next)do h(a);while(a=a.next);else d(a);function h(C){var E,S,A,D,P,M,b,O;if(A=c.get(E=t[C[0]])){for(b=0,O=A.length;b<O;++b)if(D=A[b],p(D,C)){C[0]=D[0],C[1]=D[1];return}}if(P=c.get(S=t[C[1]])){for(b=0,O=P.length;b<O;++b)if(M=P[b],_(M,C)){C[1]=M[0],C[0]=M[1];return}}A?A.push(C):c.set(E,[C]),P?P.push(C):c.set(S,[C]),f.push(C)}function d(C){var E,S,A,D,P;if(S=c.get(E=t[C[0]]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}if(S=c.get(E=t[C[0]+w(C)]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}S?S.push(C):c.set(E,[C]),f.push(C)}function p(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,++A)if(!uy(t[S],t[A]))return!1;return!0}function _(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,--P)if(!uy(t[S],t[P]))return!1;return!0}function y(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var b=w(C),O=w(E),m=0;m<M;++m)if(!uy(t[S+(m+b)%M],t[A+(m+O)%M]))return!1;return!0}function v(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var b=w(C),O=M-w(E),m=0;m<M;++m)if(!uy(t[S+(m+b)%M],t[P-(m+O)%M]))return!1;return!0}function w(C){for(var E=C[0],S=C[1],A=E,D=A,P=t[A];++A<S;){var M=t[A];(M[0]<P[0]||M[0]===P[0]&&M[1]<P[1])&&(D=A,P=M)}return D-E}return e},zye=function(e){for(var t=-1,n=e.length;++t<n;){for(var r=e[t],o=0,a=1,s=r.length,u=r[0],l=u[0],c=u[1],f,h;++o<s;)u=r[o],f=u[0],h=u[1],(f!==l||h!==c)&&(r[a++]=[f-l,h-c],l=f,c=h);a===1&&(r[a++]=[0,0]),r.length=a}return e},Vye=function(e){var t=-1,n=[],r=[],o=[];function a(h){h&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},LineString:function(h){h.arcs=u(h.arcs)},MultiLineString:function(h){h.arcs=h.arcs.map(u)},Polygon:function(h){h.arcs=h.arcs.map(l)},MultiPolygon:function(h){h.arcs=h.arcs.map(c)}};function u(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var _={0:t-p+1,1:t};return n.push(_),_}function l(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var _={0:t-p+1,1:t};return r.push(_),_}function c(h){return h.map(l)}for(var f in e)a(e[f]);return{type:"Topology",coordinates:o,lines:n,rings:r,objects:e}},kye=function(e){var t={},n;for(n in e)t[n]=Gye(e[n]);return t};function Gye(e){return e==null?{type:null}:(e.type==="FeatureCollection"?Uye:e.type==="Feature"?uX:$3)(e)}function Uye(e){var t={type:"GeometryCollection",geometries:e.features.map(uX)};return e.bbox!=null&&(t.bbox=e.bbox),t}function uX(e){var t=$3(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function $3(e){if(e==null)return{type:null};var t=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map($3)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(t.bbox=e.bbox),t}var Hye=function(e,t,n){var r=t[0],o=t[1],a=t[2],s=t[3],u=a-r?(n-1)/(a-r):1,l=s-o?(n-1)/(s-o):1;function c(w){return[Math.round((w[0]-r)*u),Math.round((w[1]-o)*l)]}function f(w,C){for(var E=-1,S=0,A=w.length,D=new Array(A),P,M,b,O,m;++E<A;)P=w[E],O=Math.round((P[0]-r)*u),m=Math.round((P[1]-o)*l),(O!==M||m!==b)&&(D[S++]=[M=O,b=m]);for(D.length=S;S<C;)S=D.push([D[0][0],D[0][1]]);return D}function h(w){return f(w,2)}function d(w){return f(w,4)}function p(w){return w.map(d)}function _(w){w!=null&&y.hasOwnProperty(w.type)&&y[w.type](w)}var y={GeometryCollection:function(w){w.geometries.forEach(_)},Point:function(w){w.coordinates=c(w.coordinates)},MultiPoint:function(w){w.coordinates=w.coordinates.map(c)},LineString:function(w){w.arcs=h(w.arcs)},MultiLineString:function(w){w.arcs=w.arcs.map(h)},Polygon:function(w){w.arcs=p(w.arcs)},MultiPolygon:function(w){w.arcs=w.arcs.map(p)}};for(var v in e)_(e[v]);return{scale:[1/u,1/l],translate:[r,o]}},qye=function(e,t){var n=Lye(e=kye(e)),r=t>0&&n&&Hye(e,n,t),o=Fye(Nye(Vye(e))),a=o.coordinates,s=J3(o.arcs.length*1.4,Wye,Yye);e=o.objects,o.bbox=n,o.arcs=o.arcs.map(function(d,p){return s.set(d,p),a.slice(d[0],d[1]+1)}),delete o.coordinates,a=null;function u(d){d&&l.hasOwnProperty(d.type)&&l[d.type](d)}var l={GeometryCollection:function(d){d.geometries.forEach(u)},LineString:function(d){d.arcs=c(d.arcs)},MultiLineString:function(d){d.arcs=d.arcs.map(c)},Polygon:function(d){d.arcs=d.arcs.map(c)},MultiPolygon:function(d){d.arcs=d.arcs.map(f)}};function c(d){var p=[];do{var _=s.get(d);p.push(d[0]<d[1]?_:~_)}while(d=d.next);return p}function f(d){return d.map(c)}for(var h in e)u(e[h]);return r&&(o.transform=r,o.arcs=zye(o.arcs)),o};function Wye(e){var t=e[0],n=e[1],r;return n<t&&(r=t,t=n,n=r),t+31*n}function Yye(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s;return r<n&&(s=n,n=r,r=s),a<o&&(s=o,o=a,a=s),n===o&&r===a}function Xye(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Bi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=lu(e));var r=[],o=Z3(e,function(a,s){var u=jye(a,s);return u||(r.push(a),s)});return o&&r.push(o),r.length?r.length===1?r[0]:N0(r.map(function(a){return a.coordinates})):null}function qD(e){return e[0].toString()+","+e[1].toString()}function jye(e,t){var n=e.geometry.coordinates,r=t.geometry.coordinates,o=qD(n[0]),a=qD(n[n.length-1]),s=qD(r[0]),u=qD(r[r.length-1]),l;if(o===u)l=r.concat(n.slice(1));else if(s===a)l=n.concat(r.slice(1));else if(o===s)l=n.slice(1).reverse().concat(r);else if(a===u)l=n.concat(r.reverse().slice(1));else return null;return Ni(l)}function Kye(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Bi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=lu(e));var r=[];Ho(e,function(a){r.push(a.geometry)});var o=qye({geoms:q3(r).geometry});return Pye(o,o.objects.geoms.geometries)}function Zye(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Bi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=lu(e));var r=Qye(e);if(!r)throw new Error("geojson must be homogenous");switch(r){case"LineString":return Xye(e,t);case"Polygon":return Kye(e,t);default:throw new Error(r+" is not supported")}}function Qye(e){var t={};Ho(e,function(r){t[r.geometry.type]=!0});var n=Object.keys(t);return n.length===1?n[0]:null}function Jye(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");if(!e)throw new Error("points is required");var n=t.maxEdge||1/0;if(!ci(n))throw new Error("maxEdge is invalid");var r=$ye(e),o=nX(r);if(o.features=o.features.filter(function(s){var u=s.geometry.coordinates[0][0],l=s.geometry.coordinates[0][1],c=s.geometry.coordinates[0][2],f=li(u,l,t),h=li(l,c,t),d=li(u,c,t);return f<=n&&h<=n&&d<=n}),o.features.length<1)return null;var a=Zye(o,t);return a.coordinates.length===1&&(a.coordinates=a.coordinates[0],a.type="Polygon"),aa(a)}function $ye(e){var t=[],n={};return fi(e,function(r){if(!!r.geometry){var o=r.geometry.coordinates.join("-");n.hasOwnProperty(o)||(t.push(r),n[o]=!0)}}),Vt(t)}function eve(e,t,n,r){var o=$C(6),a=t.features.map(function(s){return{minX:s.geometry.coordinates[0],minY:s.geometry.coordinates[1],maxX:s.geometry.coordinates[0],maxY:s.geometry.coordinates[1],property:s.properties[n]}});return o.load(a),e.features.forEach(function(s){s.properties||(s.properties={});var u=wa(s),l=o.search({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}),c=[];l.forEach(function(f){Co([f.minX,f.minY],s)&&c.push(f.property)}),s.properties[r]=c}),e}function tve(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(!e)throw new Error("geojson is required");return(n===!1||n===void 0)&&(e=lu(e)),Xa(e,function(r){var o=r[0],a=r[1];r[0]=a,r[1]=o}),e}function Wm(e,t){var n=typeof t=="object"?t.mutate:t;if(!e)throw new Error("geojson is required");var r=Bi(e),o=[];switch(r){case"LineString":o=f3(e);break;case"MultiLineString":case"Polygon":Tt(e).forEach(function(s){o.push(f3(s))});break;case"MultiPolygon":Tt(e).forEach(function(s){var u=[];s.forEach(function(l){u.push(f3(l))}),o.push(u)});break;case"Point":return e;case"MultiPoint":var a={};Tt(e).forEach(function(s){var u=s.join("-");a.hasOwnProperty(u)||(o.push(s),a[u]=!0)});break;default:throw new Error(r+" geometry not supported")}return e.coordinates?n===!0?(e.coordinates=o,e):{type:r,coordinates:o}:n===!0?(e.geometry.coordinates=o,e):aa({type:r,coordinates:o},e.properties,e.bbox,e.id)}function f3(e){var t=Tt(e);if(t.length===2&&!nve(t[0],t[1]))return t;var n,r,o,a=[],s=t.length-1;a.push(t[0]);for(var u=1;u<s;u++)n=t[u-1],r=t[u],o=t[u+1],rve(n,o,r)||a.push(r);return a.push(o),a}function nve(e,t){return e[0]===t[0]&&e[1]===t[1]}function rve(e,t,n){var r=n[0],o=n[1],a=e[0],s=e[1],u=t[0],l=t[1],c=r-a,f=o-s,h=u-a,d=l-s,p=c*d-f*h;return p!==0?!1:Math.abs(h)>=Math.abs(d)?h>0?a<=r&&r<=u:u<=r&&r<=a:d>0?s<=o&&o<=l:l<=o&&o<=s}function ive(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function ove(e,t,n){var r=t.x,o=t.y,a=n.x-r,s=n.y-o;if(a!==0||s!==0){var u=((e.x-r)*a+(e.y-o)*s)/(a*a+s*s);u>1?(r=n.x,o=n.y):u>0&&(r+=a*u,o+=s*u)}return a=e.x-r,s=e.y-o,a*a+s*s}function ave(e,t){for(var n=e[0],r=[n],o,a=1,s=e.length;a<s;a++)o=e[a],ive(o,n)>t&&(r.push(o),n=o);return n!==o&&r.push(o),r}function A3(e,t,n,r,o){for(var a=r,s,u=t+1;u<n;u++){var l=ove(e[u],e[t],e[n]);l>a&&(s=u,a=l)}a>r&&(s-t>1&&A3(e,t,s,r,o),o.push(e[s]),n-s>1&&A3(e,s,n,r,o))}function sve(e,t){var n=e.length-1,r=[e[0]];return A3(e,0,n,t,r),r.push(e[n]),r}function b3(e,t,n){if(e.length<=2)return e;var r=t!==void 0?t*t:1;return e=n?e:ave(e,r),e=sve(e,r),e}function uve(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.tolerance!==void 0?t.tolerance:1,r=t.highQuality||!1,o=t.mutate||!1;if(!e)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return o!==!0&&(e=lu(e)),ch(e,function(a){lve(a,n,r)}),e}function lve(e,t,n){var r=e.type;if(r==="Point"||r==="MultiPoint")return e;Wm(e,!0);var o=e.coordinates;switch(r){case"LineString":e.coordinates=d7(o,t,n);break;case"MultiLineString":e.coordinates=o.map(function(a){return d7(a,t,n)});break;case"Polygon":e.coordinates=p7(o,t,n);break;case"MultiPolygon":e.coordinates=o.map(function(a){return p7(a,t,n)})}return e}function d7(e,t,n){return b3(e.map(function(r){return{x:r[0],y:r[1],z:r[2]}}),t,n).map(function(r){return r.z?[r.x,r.y,r.z]:[r.x,r.y]})}function p7(e,t,n){return e.map(function(r){var o=r.map(function(s){return{x:s[0],y:s[1]}});if(o.length<4)throw new Error("invalid polygon");for(var a=b3(o,t,n).map(function(s){return[s.x,s.y]});!cve(a);)t-=t*.01,a=b3(o,t,n).map(function(s){return[s.x,s.y]});return(a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),a})}function cve(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var IP=function(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],r=this.points[t+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var n=this.centers[t],r=this.centers[t+1],o=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,a=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,s=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+s)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};IP.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var o=this.pos(r),a=Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)+(o.z-n.z)*(o.z-n.z));a>e&&(t.push(r),n=o)}return t};IP.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}};IP.prototype.pos=function(e){function t(s,u,l,c,f){var h=function(_){var y=_*_,v=y*_;return[v,3*y*(1-_),3*_*(1-_)*(1-_),(1-_)*(1-_)*(1-_)]},d=h(s),p={x:f.x*d[0]+c.x*d[1]+l.x*d[2]+u.x*d[3],y:f.y*d[0]+c.y*d[1]+l.y*d[2]+u.y*d[3],z:f.z*d[0]+c.z*d[1]+l.z*d[2]+u.z*d[3]};return p}var n=e-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);var r=n/this.duration;if(r>=1)return this.points[this.length-1];var o=Math.floor((this.points.length-1)*r),a=(this.length-1)*r-o;return t(a,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])};function m7(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.resolution||1e4,r=t.sharpness||.85;if(!e)throw new Error("line is required");if(!ci(n))throw new Error("resolution must be an number");if(!ci(r))throw new Error("sharpness must be an number");for(var o=[],a=new IP({points:Hl(e).coordinates.map(function(l){return{x:l[0],y:l[1]}}),duration:n,sharpness:r}),s=0;s<a.duration;s+=10){var u=a.pos(s);Math.floor(s/100)%2===0&&o.push([u.x,u.y])}return Ni(o,e.properties)}function fve(e,t,n,r){return e=lu(e),t=lu(t),fi(e,function(o){o.properties||(o.properties={}),fi(t,function(a){o.properties[r]===void 0&&Co(o,a)&&(o.properties[r]=a.properties[n])})}),e}function hve(e,t){if(!e)throw new Error("featurecollection is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var n=Vt(dve(e.features,t));return n}function dve(e,t){for(var n=e.slice(0),r=e.length,o=r-t,a,s;r-- >o;)s=Math.floor((r+1)*Math.random()),a=n[s],n[s]=n[r],n[r]=a;return n.slice(o)}function eB(e){Ex(e);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]),o=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[t,n],s=[t,o],u=[r,o],l=[r,n];return Pn([[a,l,u,s,a]])}function lX(e){return eB(wa(e))}function cX(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=li(e.slice(0,2),[r,n]),s=li(e.slice(0,2),[t,o]);if(a>=s){var u=(n+o)/2;return[t,u-(r-t)/2,r,u+(r-t)/2]}else{var l=(t+r)/2;return[l-(o-n)/2,n,l+(o-n)/2,o]}}function Tp(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.properties,s=so(e),u=Ya(s[0]),l=Ya(s[1]),c=Ya(n),f=fy(t,o),h=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(c)),d=u+Math.atan2(Math.sin(c)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(h)),p=T0(d),_=T0(h);return kr([p,_],a)}function tB(e,t,n){n=n||{};var r=n.steps||64,o=n.properties;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be a number");r=r||64,o=o||e.properties||{};for(var a=[],s=0;s<r;s++)a.push(Tp(e,t,s*-360/r,n).geometry.coordinates);return a.push(a[0]),Pn([a],o)}function xp(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.final;if(r===!0)return pve(e,t);var o=so(e),a=so(t),s=Ya(o[0]),u=Ya(a[0]),l=Ya(o[1]),c=Ya(a[1]),f=Math.sin(u-s)*Math.cos(c),h=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-s);return T0(Math.atan2(f,h))}function pve(e,t){var n=xp(t,e);return n=(n+180)%360,n}function mve(e,t){var n=li(e,t),r=xp(e,t),o=Tp(e,n/2,r);return o}function DP(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties;if(!e)throw new Error("geojson is required");var r=wa(e),o=(r[0]+r[2])/2,a=(r[1]+r[3])/2;return kr([o,a],n)}function dy(e,t){var n=0,r=0,o=0;return Xa(e,function(a){n+=a[0],r+=a[1],o++},!0),kr([n/o,r/o],t)}function fX(e,t){switch(Bi(e)){case"Point":return e;case"Polygon":var n=[];Xa(e,function(S){n.push(S)});var r=dy(e,t),o=r.geometry.coordinates,a=0,s=0,u=0,l,c,f,h,d,p,_,y,v=n.map(function(S){return[S[0]-o[0],S[1]-o[1]]});for(l=0;l<n.length-1;l++)c=v[l],h=c[0],p=c[1],f=v[l+1],d=f[0],_=f[1],y=h*_-d*p,u+=y,a+=(h+d)*y,s+=(p+_)*y;if(u===0)return r;var w=u*.5,C=1/(6*w);return kr([o[0]+C*a,o[1]+C*s],t);default:var E=tX(e);return E?fX(E,t):dy(e,t)}}function gve(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(t).reduce(function(o,a){return o[a.replace("Multi","")]=a,o},{});function r(o,a,s){s?t[a].coordinates=t[a].coordinates.concat(o.geometry.coordinates):t[a].coordinates.push(o.geometry.coordinates),t[a].properties.push(o.properties)}return fi(e,function(o){!o.geometry||(t[o.geometry.type]?r(o,o.geometry.type,!0):n[o.geometry.type]&&r(o,n[o.geometry.type],!1))}),Vt(Object.keys(t).filter(function(o){return t[o].coordinates.length}).sort().map(function(o){var a={type:o,coordinates:t[o].coordinates},s={collectedProperties:t[o].properties};return aa(a,s)}))}function nB(e){var t=[];return e.type==="FeatureCollection"?fi(e,function(n){Xa(n,function(r){t.push(kr(r,n.properties))})}):Xa(e,function(n){t.push(kr(n,e.properties))}),Vt(t)}var hX=PP,_ve=PP;function PP(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=dX(e,0,o,n,!0),s=[];if(!a)return s;var u,l,c,f,h,d,p;if(r&&(a=wve(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var _=n;_<o;_+=n)h=e[_],d=e[_+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?1/p:0}return TT(a,s,n,u,l,p),s}function dX(e,t,n,r,o){var a,s;if(o===P3(e,t,n,r)>0)for(a=t;a<n;a+=r)s=g7(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=g7(a,e[a],e[a+1],s);return s&&ly(s,s.next)&&(AT(s),s=s.next),s}function ET(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(ly(n,n.next)||Gl(n.prev,n,n.next)===0)){if(AT(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function TT(e,t,n,r,o,a,s){if(!!e){!s&&a&&Ave(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?vve(e,r,o,a):yve(e)){t.push(l.i/n),t.push(e.i/n),t.push(c.i/n),AT(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=Cve(e,t,n),TT(e,t,n,r,o,a,2)):s===2&&xve(e,t,n,r,o,a):TT(ET(e),t,n,r,o,a,1);break}}}}function yve(e){var t=e.prev,n=e,r=e.next;if(Gl(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(aP(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&Gl(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function vve(e,t,n,r){var o=e.prev,a=e,s=e.next;if(Gl(o,a,s)>=0)return!1;for(var u=o.x<a.x?o.x<s.x?o.x:s.x:a.x<s.x?a.x:s.x,l=o.y<a.y?o.y<s.y?o.y:s.y:a.y<s.y?a.y:s.y,c=o.x>a.x?o.x>s.x?o.x:s.x:a.x>s.x?a.x:s.x,f=o.y>a.y?o.y>s.y?o.y:s.y:a.y>s.y?a.y:s.y,h=I3(u,l,t,n,r),d=I3(c,f,t,n,r),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&aP(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Gl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&aP(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Gl(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function Cve(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!ly(o,a)&&pX(o,r,r.next,a)&&ST(o,a)&&ST(a,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(a.i/n),AT(r),AT(r.next),r=e=a),r=r.next}while(r!==e);return r}function xve(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&Dve(s,u)){var l=mX(s,u);s=ET(s,s.next),l=ET(l,l.next),TT(s,t,n,r,o,a),TT(l,t,n,r,o,a);return}u=u.next}s=s.next}while(s!==e)}function wve(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=dX(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(Ive(c));for(o.sort(Eve),a=0;a<o.length;a++)Tve(o[a],n),n=ET(n,n.next);return n}function Eve(e,t){return e.x-t.x}function Tve(e,t){if(t=Sve(e,t),t){var n=mX(t,e);ET(n,n.next)}}function Sve(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a){if(a=u,u===r){if(o===n.y)return n;if(o===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(r===a)return s.prev;var l=s,c=s.x,f=s.y,h=1/0,d;for(n=s.next;n!==l;)r>=n.x&&n.x>=c&&r!==n.x&&aP(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),(d<h||d===h&&n.x>s.x)&&ST(n,e)&&(s=n,h=d)),n=n.next;return s}function Ave(e,t,n,r){var o=e;do o.z===null&&(o.z=I3(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,bve(o)}function bve(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function I3(e,t,n,r,o){return e=32767*(e-n)*o,t=32767*(t-r)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Ive(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function aP(e,t,n,r,o,a,s,u){return(o-s)*(t-u)-(e-s)*(a-u)>=0&&(e-s)*(r-u)-(n-s)*(t-u)>=0&&(n-s)*(a-u)-(o-s)*(r-u)>=0}function Dve(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Pve(e,t)&&ST(e,t)&&ST(t,e)&&Mve(e,t)}function Gl(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function ly(e,t){return e.x===t.x&&e.y===t.y}function pX(e,t,n,r){return ly(e,t)&&ly(n,r)||ly(e,r)&&ly(n,t)?!0:Gl(e,t,n)>0!=Gl(e,t,r)>0&&Gl(n,r,e)>0!=Gl(n,r,t)>0}function Pve(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&pX(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function ST(e,t){return Gl(e.prev,e,e.next)<0?Gl(e,t,e.next)>=0&&Gl(e,e.prev,t)>=0:Gl(e,t,e.prev)<0||Gl(e,e.next,t)<0}function Mve(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function mX(e,t){var n=new D3(e.i,e.x,e.y),r=new D3(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function g7(e,t,n,r){var o=new D3(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function AT(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function D3(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}PP.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(P3(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(P3(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,_=r[u+2]*n;h+=Math.abs((e[d]-e[_])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[_+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function P3(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}PP.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};hX.default=_ve;function Lve(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?t.features=_7(e.geometry.coordinates):e.geometry.coordinates.forEach(function(n){t.features=t.features.concat(_7(n))}),t}function _7(e){var t=Rve(e),n=2,r=hX(t.vertices,t.holes,n),o=[],a=[];r.forEach(function(l,c){var f=r[c];a.push([t.vertices[f*n],t.vertices[f*n+1]])});for(var s=0;s<a.length;s+=3){var u=a.slice(s,s+3);u.push(a[s]),o.push(Pn([u]))}return o}function Rve(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}function M3(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var n,r=1/0;return fi(t,function(o,a){var s=li(e,o);s<r&&(n=lu(o),n.properties.featureIndex=a,n.properties.distanceToPoint=s,r=s)}),n}function Ove(e,t,n,r,o){gX(e,t,n||0,r||e.length-1,o||Nve)}function gX(e,t,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));gX(e,t,f,h,o)}var d=e[t],p=n,_=r;for(sT(e,n,t),o(e[r],d)>0&&sT(e,n,r);p<_;){for(sT(e,p,_),p++,_--;o(e[p],d)<0;)p++;for(;o(e[_],d)>0;)_--}o(e[n],d)===0?sT(e,n,_):(_++,sT(e,_,r)),_<=t&&(n=_+1),t<=_&&(r=_-1)}}function sT(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Nve(e,t){return e<t?-1:e>t?1:0}function tf(e,t){if(!(this instanceof tf))return new tf(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}tf.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!YD(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,YD(e,l)&&(t.leaf?n.push(u):d3(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!YD(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,YD(e,u)){if(t.leaf||d3(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=WC([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=Bve(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&d3(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:y7,compareMinY:v7,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=WC(e.slice(t,n+1)),HC(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=WC([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(C7(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),C7(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return HC(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=h3(s),c=Fve(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),mT(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=WC(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,HC(n,this.toBBox),HC(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=WC([e,t]),this.data.height=e.height+1,this.data.leaf=!1,HC(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=pT(e,0,r,this.toBBox),a=pT(e,r,n,this.toBBox),s=zve(o,a),u=h3(o)+h3(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:y7,o=e.leaf?this.compareMinY:v7,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=pT(e,0,t,o),s=pT(e,n-t,n,o),u=WD(a)+WD(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],mT(a,e.leaf?o(c):c),u+=WD(a);for(l=n-t-1;l>=t;l--)c=e.children[l],mT(s,e.leaf?o(c):c),u+=WD(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)mT(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():HC(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function Bve(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function HC(e,t){pT(e,0,e.children.length,t,e)}function pT(e,t,n,r,o){o||(o=WC(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],mT(o,e.leaf?r(s):s);return o}function mT(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function y7(e,t){return e.minX-t.minX}function v7(e,t){return e.minY-t.minY}function h3(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function WD(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Fve(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function zve(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function d3(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function YD(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function WC(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C7(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,Ove(e,s,t,n,o),a.push(t,s,s,n))}function jT(e){var t=tf(e);return t.insert=function(n){if(Array.isArray(n)){var r=n;n=p3(r),n.bbox=r}else n.bbox=n.bbox?n.bbox:m3(n);return tf.prototype.insert.call(this,n)},t.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(o){var a=p3(o);a.bbox=o,r.push(a)}):fi(n,function(o){o.bbox=o.bbox?o.bbox:m3(o),r.push(o)}),tf.prototype.load.call(this,r)},t.remove=function(n){if(Array.isArray(n)){var r=n;n=p3(r),n.bbox=r}return tf.prototype.remove.call(this,n)},t.clear=function(){return tf.prototype.clear.call(this)},t.search=function(n){var r=tf.prototype.search.call(this,this.toBBox(n));return{type:"FeatureCollection",features:r}},t.collides=function(n){return tf.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=tf.prototype.all.call(this);return{type:"FeatureCollection",features:n}},t.toJSON=function(){return tf.prototype.toJSON.call(this)},t.fromJSON=function(n){return tf.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var r;return n.bbox?r=n.bbox:Array.isArray(n)&&n.length===4?r=n:r=m3(n),{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},t}function p3(e){var t=[e[0],e[1]],n=[e[0],e[3]],r=[e[2],e[3]],o=[e[2],e[1]],a=[[t,o,r,n,t]];return{type:"Feature",bbox:e,properties:{},geometry:{type:"Polygon",coordinates:a}}}function m3(e){var t=[1/0,1/0,-1/0,-1/0];return Xa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function py(e){if(!e)throw new Error("geojson is required");var t=[];return Ho(e,function(n){Vve(n,t)}),Vt(t)}function Vve(e,t){var n=[],r=e.geometry;switch(r.type){case"Polygon":n=Tt(r);break;case"LineString":n=[Tt(r)]}n.forEach(function(o){var a=kve(o,e.properties);a.forEach(function(s){s.id=t.length,t.push(s)})})}function kve(e,t){var n=[];return e.reduce(function(r,o){var a=Ni([r,o],t);return a.bbox=Gve(r,o),n.push(a),o}),n}function Gve(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s=n<o?n:o,u=r<a?r:a,l=n>o?n:o,c=r>a?r:a;return[s,u,l,c]}function ng(e,t){var n={},r=[];if(e.type==="LineString"&&(e=aa(e)),t.type==="LineString"&&(t=aa(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var o=x7(e,t);return o&&r.push(o),Vt(r)}var a=jT();return a.load(py(t)),fi(py(e),function(s){fi(a.search(s),function(u){var l=x7(s,u);if(l){var c=Tt(l).join(",");n[c]||(n[c]=!0,r.push(l))}})}),Vt(r)}function x7(e,t){var n=Tt(e),r=Tt(t);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],u=n[1][1],l=r[0][0],c=r[0][1],f=r[1][0],h=r[1][1],d=(h-c)*(s-o)-(f-l)*(u-a),p=(f-l)*(a-c)-(h-c)*(o-l),_=(s-o)*(a-c)-(u-a)*(o-l);if(d===0)return p===0&&_===0,null;var y=p/d,v=_/d;if(y>=0&&y<=1&&v>=0&&v<=1){var w=o+y*(s-o),C=a+y*(u-a);return kr([w,C])}return null}function Gm(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=e.geometry?e.geometry.type:e.type;if(r!=="LineString"&&r!=="MultiLineString")throw new Error("lines must be LineString or MultiLineString");var o=kr([1/0,1/0],{dist:1/0}),a=0;return Ho(e,function(s){for(var u=Tt(s),l=0;l<u.length-1;l++){var c=kr(u[l]);c.properties.dist=li(t,c,n);var f=kr(u[l+1]);f.properties.dist=li(t,f,n);var h=li(c,f,n),d=Math.max(c.properties.dist,f.properties.dist),p=xp(c,f),_=Tp(t,d,p+90,n),y=Tp(t,d,p-90,n),v=ng(Ni([_.geometry.coordinates,y.geometry.coordinates]),Ni([c.geometry.coordinates,f.geometry.coordinates])),w=null;v.features.length>0&&(w=v.features[0],w.properties.dist=li(t,w,n),w.properties.location=a+li(c,w,n)),c.properties.dist<o.properties.dist&&(o=c,o.properties.index=l,o.properties.location=a),f.properties.dist<o.properties.dist&&(o=f,o.properties.index=l+1,o.properties.location=a+h),w&&w.properties.dist<o.properties.dist&&(o=w,o.properties.index=l),a+=h}}),o}function C0(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.final;if(!e)throw new Error("start point is required");if(!t)throw new Error("end point is required");var o;r?o=w7(so(t),so(e)):o=w7(so(e),so(t));var a=o>180?-(360-o):o;return a}function w7(e,t){var n=Ya(e[1]),r=Ya(t[1]),o=Ya(t[0]-e[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),s=Math.atan2(o,a);return(T0(s)+360)%360}function MP(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("from point is required");if(!t)throw new Error("to point is required");var o=so(e),a=so(t);a[0]+=a[0]-o[0]>180?-360:o[0]-a[0]>180?360:0;var s=Uve(o,a),u=hy(s,"meters",r);return u}function Uve(e,t,n){n=n===void 0?ls:Number(n);var r=n,o=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-o,u=Math.abs(t[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var l=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(l)>1e-11?s/l:Math.cos(o),f=Math.sqrt(s*s+c*c*u*u),h=f*r;return h}function x0(e,t){return _X(e,"mercator",t)}function LP(e,t){return _X(e,"wgs84",t)}function _X(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&ci(e[0])?e=t==="mercator"?E7(e):T7(e):(r!==!0&&(e=lu(e)),Xa(e,function(o){var a=t==="mercator"?E7(o):T7(o);o[0]=a[0],o[1]=a[1]})),e}function E7(e){var t=Math.PI/180,n=6378137,r=20037508342789244e-9,o=Math.abs(e[0])<=180?e[0]:e[0]-Hve(e[0])*360,a=[n*o*t,n*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return a[0]>r&&(a[0]=r),a[0]<-r&&(a[0]=-r),a[1]>r&&(a[1]=r),a[1]<-r&&(a[1]=-r),a}function T7(e){var t=180/Math.PI,n=6378137;return[e[0]*t/n,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/n)))*t]}function Hve(e){return e<0?-1:e>0?1:0}var qve=Object.freeze({toMercator:x0,toWgs84:LP});function yX(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");if(!e)throw new Error("pt is required");if(Array.isArray(e)?e=kr(e):e.type==="Point"?e=aa(e):xT(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=Ni(t):t.type==="LineString"?t=aa(t):xT(t,"LineString","line");var r=1/0,o=e.geometry.coordinates;return km(t,function(a){var s=a.geometry.coordinates[0],u=a.geometry.coordinates[1],l=Wve(o,s,u,n);r>l&&(r=l)}),r}function Wve(e,t,n,r){var o=r.mercator,a=o!==!0?li(t,e,r):S7(t,e,r),s=v0(o!==!0?xp(t,e):C0(t,e)),u=v0(o!==!0?xp(t,n):C0(t,n)),l=Math.abs(s-u);if(l>90)return a;var c=(u+180)%360,f=v0(o!==!0?xp(n,e):C0(n,e)),h=Math.abs(f-c);return h>180&&(h=Math.abs(h-360)),h>90?o!==!0?li(e,n,r):S7(e,n,r):o!==!0?a*Math.sin(Ya(l)):Yve(t,n,e,r)}function Yve(e,t,n,r){var o=0;(Math.abs(e[0])>=180||Math.abs(t[0])>=180||Math.abs(n[0])>=180)&&(o=e[0]>0||t[0]>0||n[0]>0?-180:180);var a=kr(n),s=x0([e[0]+o,e[1]]),u=x0([t[0]+o,t[1]]),l=x0([n[0]+o,n[1]]),c=LP(Xve(s,u,l));o!==0&&(c[0]-=o);var f=MP(a,c,r);return f}function Xve(e,t,n){var r=e[0],o=e[1],a=t[0],s=t[1],u=n[0],l=n[1],c=a-r,f=s-o,h=c*c+f*f,d=((u-r)*c+(l-o)*f)/h,p=r+d*c,_=o+d*f;return[p,_]}function S7(e,t,n){var r=n.units,o=0;Math.abs(e[0])>=180&&(o=e[0]>0?-180:180),Math.abs(t[0])>=180&&(o=t[0]>0?-180:180);var a=x0([e[0]+o,e[1]]),s=x0([t[0]+o,t[1]]),u=function(f){return f*f},l=u(a[0]-s[0])+u(a[1]-s[1]),c=Math.sqrt(l);return hy(c,"meters",r)}function jve(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=n.properties||{};if(!e)throw new Error("points is required");if(e=Kve(e),!e.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(Bi(t)!=="LineString")throw new Error("line must be a LineString");var a=1/0,s=null;return fi(e,function(u){var l=yX(u,t,{units:r});l<a&&(a=l,s=u)}),s&&(s.properties=Object.assign({dist:a},s.properties,o)),s}function Kve(e){var t=[],n=e.geometry?e.geometry.type:e.type;switch(n){case"GeometryCollection":return ch(e,function(r){r.type==="Point"&&t.push({type:"Feature",properties:{},geometry:r})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(r){return r.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}function Zve(e,t){var n=so(e),r=Hl(t),o=r.coordinates,a=o[0];if(a.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var s=t.properties||{},u=s.a,l=s.b,c=s.c,f=n[0],h=n[1],d=a[0][0],p=a[0][1],_=u!==void 0?u:a[0][2],y=a[1][0],v=a[1][1],w=l!==void 0?l:a[1][2],C=a[2][0],E=a[2][1],S=c!==void 0?c:a[2][2],A=(S*(f-d)*(h-v)+_*(f-y)*(h-E)+w*(f-C)*(h-p)-w*(f-d)*(h-E)-S*(f-y)*(h-p)-_*(f-C)*(h-v))/((f-d)*(h-v)+(f-y)*(h-E)+(f-C)*(h-p)-(f-d)*(h-E)-(f-y)*(h-p)-(f-C)*(h-v));return A}function Qve(e){var t,n,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?n=e.geometry:n=e,n.type==="LineString")t=[n.coordinates];else if(n.type==="MultiLineString")t=n.coordinates;else if(n.type==="MultiPolygon")t=[].concat.apply([],n.coordinates);else if(n.type==="Polygon")t=n.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(o){t.forEach(function(a){for(var s=0;s<o.length-1;s++)for(var u=s;u<a.length-1;u++)if(!(o===a&&(Math.abs(s-u)===1||s===0&&u===o.length-2&&o[s][0]===o[o.length-1][0]&&o[s][1]===o[o.length-1][1]))){var l=Jve(o[s][0],o[s][1],o[s+1][0],o[s+1][1],a[u][0],a[u][1],a[u+1][0],a[u+1][1]);l&&r.features.push(kr([l[0],l[1]]))}})}),r}function Jve(e,t,n,r,o,a,s,u){var l,c,f,h,d,p={x:null,y:null,onLine1:!1,onLine2:!1};return l=(u-a)*(n-e)-(s-o)*(r-t),l===0?p.x!==null&&p.y!==null?p:!1:(c=t-a,f=e-o,h=(s-o)*c-(u-a)*f,d=(n-e)*c-(r-t)*f,c=h/l,f=d/l,p.x=e+c*(n-e),p.y=t+c*(r-t),c>=0&&c<=1&&(p.onLine1=!0),f>=0&&f<=1&&(p.onLine2=!0),p.onLine1&&p.onLine2?[p.x,p.y]:!1)}function A7(e){for(var t=$ve(e),n=DP(t),r=!1,o=0;!r&&o<t.features.length;){var a=t.features[o].geometry,s,u,l,c,f,h,d,p=!1;if(a.type==="Point")n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if(a.type==="MultiPoint"){var _=!1;for(d=0;!_&&d<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[d][0]&&n.geometry.coordinates[1]===a.coordinates[d][1]&&(r=!0,_=!0),d++}else if(a.type==="LineString")for(d=0;!p&&d<a.coordinates.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=a.coordinates[d][0],c=a.coordinates[d][1],f=a.coordinates[d+1][0],h=a.coordinates[d+1][1],b7(s,u,l,c,f,h)&&(p=!0,r=!0),d++;else if(a.type==="MultiLineString")for(var y=0;y<a.coordinates.length;){p=!1,d=0;for(var v=a.coordinates[y];!p&&d<v.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=v[d][0],c=v[d][1],f=v[d+1][0],h=v[d+1][1],b7(s,u,l,c,f,h)&&(p=!0,r=!0),d++;y++}else(a.type==="Polygon"||a.type==="MultiPolygon")&&Co(n,a)&&(r=!0);o++}if(r)return n;var w=Vt([]);for(o=0;o<t.features.length;o++)w.features=w.features.concat(nB(t.features[o]).features);return kr(M3(n,w).geometry.coordinates)}function $ve(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?Vt([aa(e)]):Vt([e]):e}function b7(e,t,n,r,o,a){var s=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r)),l=Math.sqrt((o-e)*(o-e)+(a-t)*(a-t));return s===u+l}function bT(e){return X3(e,function(t,n){return t+vX(n)},0)}var I7=6378137;function vX(e){var t=0,n;switch(e.type){case"Polygon":return D7(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=D7(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=vX(e.geometries[n]);return t}}function D7(e){var t=0;if(e&&e.length>0){t+=Math.abs(P7(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(P7(e[n]))}return t}function P7(e){var t,n,r,o,a,s,u,l=0,c=e.length;if(c>2){for(u=0;u<c;u++)u===c-2?(o=c-2,a=c-1,s=0):u===c-1?(o=c-1,a=0,s=1):(o=u,a=u+1,s=u+2),t=e[o],n=e[a],r=e[s],l+=(g3(r[0])-g3(t[0]))*Math.sin(g3(n[1]));l=l*I7*I7/2}return l}function g3(e){return e*Math.PI/180}function eCe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r;if(e.type==="Feature")r=e.geometry.coordinates;else if(e.type==="LineString")r=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");if(!ci(t))throw new Error("distance must be a number");for(var o=0,a=0;a<r.length&&!(t>=o&&a===r.length-1);a++)if(o>=t){var s=t-o;if(s){var u=xp(r[a],r[a-1])-180,l=Tp(r[a],s,u,n);return l}else return kr(r[a])}else o+=li(r[a],r[a+1],n);return kr(r[r.length-1])}function L3(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");if(!e)throw new Error("geojson is required");return j3(e,function(n,r){var o=r.geometry.coordinates;return n+li(o[0],o[1],t)},0)}function tCe(e,t,n){var r=Tt(n);if(Bi(n)!=="LineString")throw new Error("line must be a LineString");var o=Gm(n,e),a=Gm(n,t),s;o.properties.index<=a.properties.index?s=[o,a]:s=[a,o];for(var u=[s[0].geometry.coordinates],l=s[0].properties.index+1;l<s[1].properties.index+1;l++)u.push(r[l]);return u.push(s[1].geometry.coordinates),Ni(u,n.properties)}function CX(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o,a=[];if(e.type==="Feature")o=e.geometry.coordinates;else if(e.type==="LineString")o=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=0,u,l,c,f=0;f<o.length&&!(t>=s&&f===o.length-1);f++){if(s>t&&a.length===0){if(u=t-s,!u)return a.push(o[f]),Ni(a);l=xp(o[f],o[f-1])-180,c=Tp(o[f],u,l,r),a.push(c.geometry.coordinates)}if(s>=n)return u=n-s,u?(l=xp(o[f],o[f-1])-180,c=Tp(o[f],u,l,r),a.push(c.geometry.coordinates),Ni(a)):(a.push(o[f]),Ni(a));if(s>=t&&a.push(o[f]),f===o.length-1)return Ni(a);s+=li(o[f],o[f+1],r)}return Ni(o[o.length-1])}function xc(e,t,n){n=n||{};var r=n.ignoreEndVertices;if(!gt(n))throw new Error("invalid options");if(!e)throw new Error("pt is required");if(!t)throw new Error("line is required");for(var o=so(e),a=Tt(t),s=0;s<a.length-1;s++){var u=!1;if(r&&(s===0&&(u="start"),s===a.length-2&&(u="end"),s===0&&s+1===a.length-1&&(u="both")),nCe(a[s],a[s+1],o,u))return!0}return!1}function nCe(e,t,n,r){var o=n[0],a=n[1],s=e[0],u=e[1],l=t[0],c=t[1],f=n[0]-s,h=n[1]-u,d=l-s,p=c-u,_=f*p-h*d;if(_!==0)return!1;if(r){if(r==="start")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<=l:l<=o&&o<s:p>0?u<a&&a<=c:c<=a&&a<u;if(r==="end")return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<l:l<o&&o<=s:p>0?u<=a&&a<c:c<a&&a<=u;if(r==="both")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<l:l<o&&o<s:p>0?u<a&&a<c:c<a&&a<u}else return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<=l:l<=o&&o<=s:p>0?u<=a&&a<=c:c<=a&&a<=u}function xX(e,t){var n=Bi(e),r=Bi(t),o=Hl(e),a=Hl(t);switch(n){case"Point":switch(r){case"MultiPoint":return rCe(o,a);case"LineString":return xc(o,a,{ignoreEndVertices:!0});case"Polygon":return Co(o,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"MultiPoint":return iCe(o,a);case"LineString":return oCe(o,a);case"Polygon":return aCe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"LineString":return sCe(o,a);case"Polygon":return uCe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Polygon":return lCe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function rCe(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(EX(t.coordinates[n],e.coordinates)){r=!0;break}return r}function iCe(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,o=0;o<t.coordinates.length;o++)EX(e.coordinates[n],t.coordinates[o])&&(r=!0);if(!r)return!1}return!0}function oCe(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!xc(e.coordinates[r],t))return!1;n||(n=xc(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}function aCe(e,t){for(var n=!0,r=!1,o=0;o<e.coordinates.length;o++){var a=Co(e.coordinates[1],t);if(!a){n=!1;break}r||(a=Co(e.coordinates[1],t,{ignoreBoundary:!0}))}return n&&a}function sCe(e,t){for(var n=0;n<e.coordinates.length;n++)if(!xc(e.coordinates[n],t))return!1;return!0}function uCe(e,t){var n=wa(t),r=wa(e);if(!wX(n,r))return!1;for(var o=!1,a=0;a<e.coordinates.length-1;a++){if(!Co(e.coordinates[a],t))return!1;if(o||(o=Co(e.coordinates[a],t,{ignoreBoundary:!0})),!o){var s=cCe(e.coordinates[a],e.coordinates[a+1]);o=Co(s,t,{ignoreBoundary:!0})}}return o}function lCe(e,t){var n=wa(e),r=wa(t);if(!wX(r,n))return!1;for(var o=0;o<e.coordinates[0].length;o++)if(!Co(e.coordinates[0][o],t))return!1;return!0}function wX(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function EX(e,t){return e[0]===t[0]&&e[1]===t[1]}function cCe(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function TX(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.mask,o=n.properties,a=[];if(t==null)throw new Error("cellSide is required");if(!ci(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(r&&["Polygon","MultiPolygon"].indexOf(Bi(r))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/li([s,u],[l,u],n),h=f*(l-s),d=t/li([s,u],[s,c],n),p=d*(c-u),_=l-s,y=c-u,v=Math.floor(_/h),w=Math.floor(y/p),C=(_-v*h)/2,E=(y-w*p)/2,S=s+C;S<=l;){for(var A=u+E;A<=c;){var D=kr([S,A],o);r?xX(D,r)&&a.push(D):a.push(D),A+=p}S+=h}return Vt(a)}function YC(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.precision,r=t.coordinates,o=t.mutate;if(n=n==null||isNaN(n)?6:n,r=r==null||isNaN(r)?3:r,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(o===!1||o===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,n);return Xa(e,function(s){fCe(s,a,r)}),e}function fCe(e,t,n){e.length>n&&e.splice(n,e.length);for(var r=0;r<e.length;r++)e[r]=Math.round(e[r]*t)/t;return e}function hCe(e){if(!e)throw new Error("geojson is required");var t=[];return Ho(e,function(n){t.push(n)}),Vt(t)}function dCe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=n.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var a=[];return Ho(e,function(s){o&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),pCe(s,t,r,function(u){a.push(u)})}),Vt(a)}function pCe(e,t,n,r){var o=L3(e,{units:n});if(o<=t)return r(e);var a=o/t;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var u=CX(e,t*s,t*(s+1),{units:n});r(u,s)}}var mCe=function(e,t,n){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");n===void 0&&(n=1);var r=e.geometry.coordinates,o=[],a={};if(n){for(var s=[],u=0;u<r.length;u++)for(var l=0;l<r[u].length-1;l++)s.push(v(u,l));var c=$C();c.load(s)}for(var f=0;f<r.length;f++)for(var h=0;h<r[f].length-1;h++)if(n){var d=c.search(v(f,h));d.forEach(function(w){var C=w.ring,E=w.edge;y(f,h,C,E)})}else for(var p=0;p<r.length;p++)for(var _=0;_<r[p].length-1;_++)y(f,h,p,_);return t||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function y(w,C,E,S){var A=r[w][C],D=r[w][C+1],P=r[E][S],M=r[E][S+1],b=gCe(A,D,P,M);if(b!==null){var O,m;if(D[0]!==A[0]?O=(b[0]-A[0])/(D[0]-A[0]):O=(b[1]-A[1])/(D[1]-A[1]),M[0]!==P[0]?m=(b[0]-P[0])/(M[0]-P[0]):m=(b[1]-P[1])/(M[1]-P[1]),!(O>=1||O<=0||m>=1||m<=0)){var I=b,L=!a[I];L&&(a[I]=!0),t?o.push(t(b,w,C,A,D,O,E,S,P,M,m,L)):o.push(b)}}}function v(w,C){var E=r[w][C],S=r[w][C+1],A,D,P,M;return E[0]<S[0]?(A=E[0],D=S[0]):(A=S[0],D=E[0]),E[1]<S[1]?(P=E[1],M=S[1]):(P=S[1],M=E[1]),{minX:A,minY:P,maxX:D,maxY:M,ring:w,edge:C}}};function gCe(e,t,n,r){if(gT(e,n)||gT(e,r)||gT(t,n)||gT(r,n))return null;var o=e[0],a=e[1],s=t[0],u=t[1],l=n[0],c=n[1],f=r[0],h=r[1],d=(o-s)*(c-h)-(a-u)*(l-f);if(d===0)return null;var p=((o*u-a*s)*(l-f)-(o-s)*(l*h-c*f))/d,_=((o*u-a*s)*(c-h)-(a-u)*(l*h-c*f))/d;return[p,_]}function gT(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!gT(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}var _Ce=function(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,n=[],C=0;C<t;C++){var r=e.geometry.coordinates[C];_T(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!vCe(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,a=mCe(e,function(pe,ve,ft,pt,Xt,At,wt,Rr,gi,$i,ut,ai){return[pe,ve,ft,pt,Xt,At,wt,Rr,gi,$i,ut,ai]}),s=a.length;if(s==0){for(var P=[],C=0;C<t;C++)P.push(Pn([e.geometry.coordinates[C]],{parent:-1,winding:yCe(e.geometry.coordinates[C])}));var U=Vt(P);return Q(),ne(),U}for(var u=[],l=[],C=0;C<t;C++){u.push([]);for(var c=0;c<e.geometry.coordinates[C].length-1;c++)u[C].push([new M7(e.geometry.coordinates[C][(c+1).modulo(e.geometry.coordinates[C].length-1)],1,[C,c],[C,(c+1).modulo(e.geometry.coordinates[C].length-1)],void 0)]),l.push(new L7(e.geometry.coordinates[C][c],[C,(c-1).modulo(e.geometry.coordinates[C].length-1)],[C,c],void 0,void 0,!1,!0))}for(var C=0;C<s;C++)u[a[C][1]][a[C][2]].push(new M7(a[C][0],a[C][5],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0)),a[C][11]&&l.push(new L7(a[C][0],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0,void 0,!0,!0));for(var f=l.length,C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)u[C][c].sort(function(ve,ft){return ve.param<ft.param?-1:1});for(var h=[],C=0;C<f;C++)h.push({minX:l[C].coord[0],minY:l[C].coord[1],maxX:l[C].coord[0],maxY:l[C].coord[1],index:C});var d=$C();d.load(h);for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var _;p==u[C][c].length-1?_=u[C][(c+1).modulo(e.geometry.coordinates[C].length-1)][0].coord:_=u[C][c][p+1].coord;var y=d.search({minX:_[0],minY:_[1],maxX:_[0],maxY:_[1]})[0];u[C][c][p].nxtIsectAlongEdgeIn=y.index}for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var _=u[C][c][p].coord,y=d.search({minX:_[0],minY:_[1],maxX:_[0],maxY:_[1]})[0],v=y.index;v<o?l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn:_T(l[v].ringAndEdge1,u[C][c][p].ringAndEdgeIn)?l[v].nxtIsectAlongRingAndEdge1=u[C][c][p].nxtIsectAlongEdgeIn:l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn}for(var w=[],C=0,c=0;c<t;c++){for(var E=C,p=0;p<e.geometry.coordinates[c].length-1;p++)l[C].coord[0]<l[E].coord[0]&&(E=C),C++;for(var S=l[E].nxtIsectAlongRingAndEdge2,p=0;p<l.length;p++)if(l[p].nxtIsectAlongRingAndEdge1==E||l[p].nxtIsectAlongRingAndEdge2==E){var A=p;break}var D=$D([l[A].coord,l[E].coord,l[S].coord],!0)?1:-1;w.push({isect:E,parent:-1,winding:D})}w.sort(function(de,pe){return l[de.isect].coord>l[pe.isect].coord?-1:1});for(var P=[];w.length>0;){var M=w.pop(),b=M.isect,O=M.parent,m=M.winding,I=P.length,L=[l[b].coord],R=b;if(l[b].ringAndEdge1Walkable)var N=l[b].ringAndEdge1,B=l[b].nxtIsectAlongRingAndEdge1;else var N=l[b].ringAndEdge2,B=l[b].nxtIsectAlongRingAndEdge2;for(;!_T(l[b].coord,l[B].coord);){L.push(l[B].coord);for(var V=void 0,C=0;C<w.length;C++)if(w[C].isect==B){V=C;break}if(V!=null&&w.splice(V,1),_T(N,l[B].ringAndEdge1)){if(N=l[B].ringAndEdge2,l[B].ringAndEdge2Walkable=!1,l[B].ringAndEdge1Walkable){var z={isect:B};$D([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge2].coord],m==1)?(z.parent=O,z.winding=-m):(z.parent=I,z.winding=m),w.push(z)}R=B,B=l[B].nxtIsectAlongRingAndEdge2}else{if(N=l[B].ringAndEdge1,l[B].ringAndEdge1Walkable=!1,l[B].ringAndEdge2Walkable){var z={isect:B};$D([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge1].coord],m==1)?(z.parent=O,z.winding=-m):(z.parent=I,z.winding=m),w.push(z)}R=B,B=l[B].nxtIsectAlongRingAndEdge1}}L.push(l[B].coord),P.push(Pn([L],{index:I,parent:O,winding:m,netWinding:void 0}))}var U=Vt(P);Q(),ne();function Q(){for(var de=[],pe=0;pe<U.features.length;pe++)U.features[pe].properties.parent==-1&&de.push(pe);if(de.length>1)for(var pe=0;pe<de.length;pe++){for(var ve=-1,ft=1/0,pt=0;pt<U.features.length;pt++)de[pe]!=pt&&Co(U.features[de[pe]].geometry.coordinates[0][0],U.features[pt],{ignoreBoundary:!0})&&bT(U.features[pt])<ft&&(ve=pt);U.features[de[pe]].properties.parent=ve}}function ne(){for(var de=0;de<U.features.length;de++)if(U.features[de].properties.parent==-1){var pe=U.features[de].properties.winding;U.features[de].properties.netWinding=pe,se(de,pe)}}function se(de,pe){for(var ve=0;ve<U.features.length;ve++)if(U.features[ve].properties.parent==de){var ft=pe+U.features[ve].properties.winding;U.features[ve].properties.netWinding=ft,se(ve,ft)}}return U},M7=function(e,t,n,r,o){this.coord=e,this.param=t,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=o},L7=function(e,t,n,r,o,a,s){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=a,this.ringAndEdge2Walkable=s};function $D(e,t){if(typeof t>"u"&&(t=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var n=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return n>=0==t}function yCe(e){for(var t=0,n=0;n<e.length-1;n++)e[n][0]<e[t][0]&&(t=n);if($D([e[(t-1).modulo(e.length-1)],e[t],e[(t+1).modulo(e.length-1)]],!0))var r=1;else var r=-1;return r}function _T(e,t){if(!e||!t||e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!_T(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}Number.prototype.modulo=function(e){return(this%e+e)%e};function vCe(e){for(var t={},n=1,r=0,o=e.length;r<o;++r){if(t.hasOwnProperty(e[r])){n=0;break}t[e[r]]=1}return n}function CCe(e){var t=[];return Ho(e,function(n){n.geometry.type==="Polygon"&&fi(_Ce(n),function(r){t.push(Pn(r.geometry.coordinates,n.properties))})}),Vt(t)}var R7=Math.PI/180,O7=180/Math.PI,IT=function(e,t){this.lon=e,this.lat=t,this.x=R7*e,this.y=R7*t};IT.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};IT.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new IT(t,e)};var SX=function(){this.coords=[],this.length=0};SX.prototype.move_to=function(e){this.length++,this.coords.push(e)};var rB=function(e){this.properties=e||{},this.geometries=[]};rB.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};rB.prototype.wkt=function(){for(var e="",t="LINESTRING(",n=function(a){t+=a[0]+" "+a[1]+","},r=0;r<this.geometries.length;r++){if(this.geometries[r].coords.length===0)return"LINESTRING(empty)";var o=this.geometries[r].coords;o.forEach(n),e+=t.substring(0,t.length-1)+")"}return e};var iB=function(e,t,n){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new IT(e.x,e.y),this.end=new IT(t.x,t.y),this.properties=n||{};var r=this.start.x-this.end.x,o=this.start.y-this.end.y,a=Math.pow(Math.sin(o/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};iB.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),n=Math.sin(e*this.g)/Math.sin(this.g),r=t*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=t*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=t*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=O7*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(o,2))),u=O7*Math.atan2(o,r);return[u,s]};iB.prototype.Arc=function(e,t){var n=[];if(!e||e<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(e-1),o=0;o<e;++o){var a=r*o,s=this.interpolate(a);n.push(s)}for(var u=!1,l=0,c=t&&t.offset?t.offset:10,f=180-c,h=-180+c,d=360-c,p=1;p<n.length;++p){var _=n[p-1][0],y=n[p][0],v=Math.abs(y-_);v>d&&(y>f&&_<h||_>f&&y<h)?u=!0:v>l&&(l=v)}var w=[];if(u&&l<c){var C=[];w.push(C);for(var E=0;E<n.length;++E){var S=parseFloat(n[E][0]);if(E>0&&Math.abs(S-n[E-1][0])>d){var A=parseFloat(n[E-1][0]),D=parseFloat(n[E-1][1]),P=parseFloat(n[E][0]),M=parseFloat(n[E][1]);if(A>-180&&A<h&&P===180&&E+1<n.length&&n[E-1][0]>-180&&n[E-1][0]<h){C.push([-180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}else if(A>f&&A<180&&P===-180&&E+1<n.length&&n[E-1][0]>f&&n[E-1][0]<180){C.push([180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}if(A<h&&P>f){var b=A;A=P,P=b;var O=D;D=M,M=O}if(A>f&&P<h&&(P+=360),A<=180&&P>=180&&A<P){var m=(180-A)/(P-A),I=m*M+(1-m)*D;C.push([n[E-1][0]>f?180:-180,I]),C=[],C.push([n[E-1][0]>f?-180:180,I]),w.push(C)}else C=[],w.push(C);C.push([S,n[E][1]])}else C.push([n[E][0],n[E][1]])}}else{var L=[];w.push(L);for(var R=0;R<n.length;++R)L.push([n[R][0],n[R][1]])}for(var N=new rB(this.properties),B=0;B<w.length;++B){var V=new SX;N.geometries.push(V);for(var z=w[B],U=0;U<z.length;++U)V.move_to(z[U])}return N};function xCe(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.properties,o=n.npoints,a=n.offset;e=so(e),t=so(t),r=r||{},o=o||100,a=a||10;var s=new iB({x:e[0],y:e[1]},{x:t[0],y:t[1]},r),u=s.Arc(o,{offset:a});return u.json()}function wCe(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=Bi(e),r=Bi(t);if(n!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var o=YC(t,{precision:7});switch(r){case"Point":return R3(e,o);case"MultiPoint":return N7(e,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return N7(e,ng(e,o))}}function N7(e,t){var n=[],r=jT();return Ho(t,function(o){if(n.forEach(function(u,l){u.id=l}),!n.length)n=R3(e,o).features,n.forEach(function(u){u.bbox||(u.bbox=cX(wa(u)))}),r.load(Vt(n));else{var a=r.search(o);if(a.features.length){var s=AX(o,a);n=n.filter(function(u){return u.id!==s.id}),r.remove(s),fi(R3(s,o),function(u){n.push(u),r.insert(u)})}}}),Vt(n)}function R3(e,t){var n=[],r=Tt(e)[0],o=Tt(e)[e.geometry.coordinates.length-1];if(_3(r,so(t))||_3(o,so(t)))return Vt([e]);var a=jT(),s=py(e);a.load(s);var u=a.search(t);if(!u.features.length)return Vt([e]);var l=AX(t,u),c=[r],f=Y3(s,function(h,d,p){var _=Tt(d)[1],y=so(t);return p===l.id?(h.push(y),n.push(Ni(h)),_3(y,_)?[y]:[y,_]):(h.push(_),h)},c);return f.length>1&&n.push(Ni(f)),Vt(n)}function AX(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,r=1/0;return fi(t,function(o){var a=Gm(o,e),s=a.properties.dist;s<r&&(n=o,r=s)}),n}function _3(e,t){return e[0]===t[0]&&e[1]===t[1]}function bX(e,t,n,r,o){if(o=o||{},!gt(o))throw new Error("options is invalid");var a=o.steps,s=o.units;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(typeof o!="object")throw new Error("options must be an object");a=a||64;var u=B7(n),l=B7(r),c=e.properties;if(u===l)return Ni(tB(e,t,o).geometry.coordinates[0],c);for(var f=u,h=u<l?l:l+360,d=f,p=[],_=0;d<h;)p.push(Tp(e,t,d,s).geometry.coordinates),_++,d=f+_*360/a;return d>h&&p.push(Tp(e,t,h,s).geometry.coordinates),Ni(p,c)}function B7(e){var t=e%360;return t<0&&(t+=360),t}function sP(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=Bi(e),o=Tt(e);if(n=n||e.properties||{},!o.length)throw new Error("polygon must contain coordinates");switch(r){case"Polygon":return F7(o,n);case"MultiPolygon":var a=[];return o.forEach(function(s){a.push(F7(s,n))}),Vt(a);default:throw new Error("geom "+r+" not supported")}}function F7(e,t){return e.length>1?N0(e,t):Ni(e[0],t)}function z7(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=t.autoComplete,o=t.orderCoords;if(!e)throw new Error("lines is required");r=r!==void 0?r:!0,o=o!==void 0?o:!0;var a=Bi(e);switch(a){case"FeatureCollection":case"GeometryCollection":var s=[],u=e.features?e.features:e.geometries;return u.forEach(function(l){s.push(Tt(V7(l,{},r,o)))}),wx(s,n)}return V7(e,n,r,o)}function V7(e,t,n,r){t=t||e.properties||{};var o=Tt(e),a=Bi(e);if(!o.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(o=k7(o)),Pn([o],t);case"MultiLineString":var s=[],u=0;return o.forEach(function(l){if(n&&(l=k7(l)),r){var c=ECe(wa(Ni(l)));c>u?(s.unshift(l),u=c):s.push(l)}else s.push(l)}),Pn(s,t);default:throw new Error("geometry type "+a+" is not supported")}}function k7(e){var t=e[0],n=t[0],r=t[1],o=e[e.length-1],a=o[0],s=o[1];return(n!==a||r!==s)&&e.push(t),e}function ECe(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.abs(t-r)*Math.abs(n-o)}var IX=uP;uP.polyline=uP;uP.polygon=TCe;function uP(e,t,n){var r=e.length,o=XC(e[0],t),a=[],s,u,l,c,f;for(n||(n=[]),s=1;s<r;s++){for(u=e[s-1],l=e[s],c=f=XC(l,t);;)if(o|c){if(o&c)break;o?(u=O3(u,l,o,t),o=XC(u,t)):(l=O3(u,l,c,t),c=XC(l,t))}else{a.push(u),c!==f?(a.push(l),s<r-1&&(n.push(a),a=[])):s===r-1&&a.push(l);break}o=f}return a.length&&n.push(a),n}function TCe(e,t){var n,r,o,a,s,u,l;for(r=1;r<=8;r*=2){for(n=[],o=e[e.length-1],a=!(XC(o,t)&r),s=0;s<e.length;s++)u=e[s],l=!(XC(u,t)&r),l!==a&&n.push(O3(o,u,r,t)),l&&n.push(u),o=u,a=l;if(e=n,!e.length)break}return n}function O3(e,t,n,r){return n&8?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:n&4?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:n&2?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:n&1?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function XC(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function SCe(e,t){var n=ACe(e),r=Tt(e),o=e.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return n==="LineString"&&(r=[r]),r.forEach(function(s){IX(s,t,a)}),a.length===1?Ni(a[0],o):N0(a,o);case"Polygon":return Pn(G7(r,t),o);case"MultiPolygon":return wx(r.map(function(s){return G7(s,t)}),o);default:throw new Error("geometry "+n+" not supported")}}function G7(e,t){for(var n=[],r=0;r<e.length;r++){var o=IX.polygon(e[r],t);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&n.push(o))}return n}function ACe(e){return e.geometry?e.geometry.type:e.type}var U7=Array.prototype.slice;function H7(e){return Object.prototype.toString.call(e)==="[object Arguments]"}function cy(e,t,n){return n||(n={}),e===t?!0:e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||typeof e!="object"&&typeof t!="object"?(n.strict,e===t):bCe(e,t,n)}function q7(e){return e==null}function W7(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function bCe(e,t,n){var r,o;if(q7(e)||q7(t)||e.prototype!==t.prototype)return!1;if(H7(e))return H7(t)?(e=U7.call(e),t=U7.call(t),cy(e,t,n)):!1;if(W7(e)){if(!W7(t)||e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}try{var a=Object.keys(e),s=Object.keys(t)}catch{return!1}if(a.length!==s.length)return!1;for(a.sort(),s.sort(),r=a.length-1;r>=0;r--)if(a[r]!==s[r])return!1;for(r=a.length-1;r>=0;r--)if(o=a[r],!cy(e[o],t[o],n))return!1;return typeof e==typeof t}function DX(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.tolerance||0,o=[],a=jT();a.load(py(e));var s;return km(t,function(u){var l=!1;fi(a.search(u),function(c){if(l===!1){var f=Tt(u).sort(),h=Tt(c).sort();cy(f,h)||(r===0?xc(f[0],c)&&xc(f[1],c):Gm(c,f[0]).properties.dist<=r&&Gm(c,f[1]).properties.dist<=r)?(l=!0,s?s=y3(s,u):s=u):(r===0?xc(h[0],u)&&xc(h[1],u):Gm(u,h[0]).properties.dist<=r&&Gm(u,h[1]).properties.dist<=r)&&(s?s=y3(s,c):s=c)}}),l===!1&&s&&(o.push(s),s=void 0)}),s&&o.push(s),Vt(o)}function y3(e,t){var n=Tt(t),r=Tt(e),o=r[0],a=r[r.length-1],s=e.geometry.coordinates;return cy(n[0],o)?s.unshift(n[1]):cy(n[0],a)?s.push(n[1]):cy(n[1],o)?s.unshift(n[0]):cy(n[1],a)&&s.push(n[0]),e}function ICe(e,t,n,r,o){if(o=o||{},!gt(o))throw new Error("options is invalid");if(!e)throw new Error("center is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof o!="object")throw new Error("options must be an object");if(Y7(n)===Y7(r))return tB(e,t,o);var a=Tt(e),s=bX(e,t,n,r,o),u=[[a]];return Xa(s,function(l){u[0].push(l)}),u[0].push(a),Pn(u)}function Y7(e){var t=e%360;return t<0&&(t+=360),t}function ex(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.properties;if(!e)throw new Error("origin is required");if(t==null)throw new Error("distance is required");if(n==null)throw new Error("bearing is required");if(!(t>=0))throw new Error("distance must be greater than 0");var s=hy(t,o,"meters"),u=so(e),l=DCe(u,s,n);return l[0]+=l[0]-u[0]>180?-360:u[0]-l[0]>180?360:0,kr(l,a)}function DCe(e,t,n,r){r=r===void 0?ls:Number(r);var o=t/r,a=e[0]*Math.PI/180,s=Ya(e[1]),u=Ya(n),l=o*Math.cos(u),c=s+l;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var f=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(f)>1e-11?l/f:Math.cos(s),d=o*Math.sin(u)/h,p=a+d;return[(p*180/Math.PI+540)%360-180,c*180/Math.PI]}function PCe(e,t){var n=Tt(e),r=Tt(t),o,a,s,u,l=Bi(t);switch(l){case"Polygon":o=r[0][0],a=r[0][0],u=DT(r[0][0],r[0][r[0].length-1],n);var c=X7(r[0],n,u,s,o,a);o=c[0],a=c[1];break;case"MultiPolygon":o=r[0][0][0],a=r[0][0][0],u=DT(r[0][0][0],r[0][0][r[0][0].length-1],n),r.forEach(function(f){var h=X7(f[0],n,u,s,o,a);o=h[0],a=h[1]});break}return Vt([kr(o),kr(a)])}function X7(e,t,n,r,o,a){for(var s=0;s<e.length;s++){var u=e[s],l=e[s+1];s===e.length-1&&(l=e[0]),r=DT(u,l,t),n<=0&&r>0?LCe(t,u,o)||(o=u):n>0&&r<=0&&(MCe(t,u,a)||(a=u)),n=r}return[o,a]}function MCe(e,t,n){return DT(e,t,n)>0}function LCe(e,t,n){return DT(e,t,n)<0}function DT(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function lP(e){if(!e)throw new Error("line is required");var t=e.geometry?e.geometry.type:e.type;if(!Array.isArray(e)&&t!=="LineString")throw new Error("geometry must be a LineString");for(var n=Tt(e),r=0,o=1,a,s;o<n.length;)a=s||n[0],s=n[o],r+=(s[0]-a[0])*(s[1]+a[1]),o++;return r>0}function RCe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.reverse||!1,r=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(e=lu(e));var o=[];switch(e.type){case"GeometryCollection":return ch(e,function(a){eP(a,n)}),e;case"FeatureCollection":return fi(e,function(a){fi(eP(a,n),function(s){o.push(s)})}),Vt(o)}return eP(e,n)}function eP(e,t){var n=e.type==="Feature"?e.geometry.type:e.type;switch(n){case"GeometryCollection":return ch(e,function(r){eP(r,t)}),e;case"LineString":return j7(Tt(e),t),e;case"Polygon":return K7(Tt(e),t),e;case"MultiLineString":return Tt(e).forEach(function(r){j7(r,t)}),e;case"MultiPolygon":return Tt(e).forEach(function(r){K7(r,t)}),e;case"Point":case"MultiPoint":return e}}function j7(e,t){lP(e)===t&&e.reverse()}function K7(e,t){lP(e[0])!==t&&e[0].reverse();for(var n=1;n<e.length;n++)lP(e[n])===t&&e[n].reverse()}function OCe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;Sd(e,"Point","input must contain Points");for(var a=NCe(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function NCe(e,t){var n={};fi(e,function(a){var s=Tt(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return Tt(l)[0]-Tt(c)[0]});return u}),o=r.sort(function(a,s){return t?Tt(a[0])[1]-Tt(s[0])[1]:Tt(s[0])[1]-Tt(a[0])[1]});return o}/*!
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var Z7={successCallback:null,verbose:!1,polygons:!1},sy={};function BCe(e,t,n,r){r=r||{};for(var o=Object.keys(Z7),a=0;a<o.length;a++){var s=o[a],u=r[s];u=typeof u<"u"&&u!==null?u:Z7[s],sy[s]=u}sy.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n)+"]");var l=mxe(e,t,n),c;return sy.polygons?(sy.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),c=xxe(l)):(sy.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),c=gxe(l)),typeof sy.successCallback=="function"&&sy.successCallback(c),c}var zu=64,Qf=16,Ns=4,ru=1,Mn=[],Ln=[],Rn=[],On=[],Nn=[],Bn=[],Fn=[],zn=[],Vn=[],kn=[],Gn=[],Un=[],Hn=[],qn=[],Wn=[],Yn=[],Xn=[],jn=[],Kn=[],Zn=[],Qn=[],Jn=[],$n=[],er=[];Fn[85]=kn[85]=-1;zn[85]=Gn[85]=0;Vn[85]=Un[85]=1;Kn[85]=Jn[85]=1;Zn[85]=$n[85]=0;Qn[85]=er[85]=1;Mn[85]=On[85]=0;Ln[85]=Nn[85]=-1;Rn[85]=Wn[85]=0;Yn[85]=Hn[85]=0;Xn[85]=qn[85]=1;Bn[85]=jn[85]=1;Jn[1]=Jn[169]=0;$n[1]=$n[169]=-1;er[1]=er[169]=0;Hn[1]=Hn[169]=-1;qn[1]=qn[169]=0;Wn[1]=Wn[169]=0;kn[4]=kn[166]=0;Gn[4]=Gn[166]=-1;Un[4]=Un[166]=1;Yn[4]=Yn[166]=1;Xn[4]=Xn[166]=0;jn[4]=jn[166]=0;Fn[16]=Fn[154]=0;zn[16]=zn[154]=1;Vn[16]=Vn[154]=1;On[16]=On[154]=1;Nn[16]=Nn[154]=0;Bn[16]=Bn[154]=1;Kn[64]=Kn[106]=0;Zn[64]=Zn[106]=1;Qn[64]=Qn[106]=0;Mn[64]=Mn[106]=-1;Ln[64]=Ln[106]=0;Rn[64]=Rn[106]=1;Kn[2]=Kn[168]=0;Zn[2]=Zn[168]=-1;Qn[2]=Qn[168]=1;Jn[2]=Jn[168]=0;$n[2]=$n[168]=-1;er[2]=er[168]=0;Hn[2]=Hn[168]=-1;qn[2]=qn[168]=0;Wn[2]=Wn[168]=0;Yn[2]=Yn[168]=-1;Xn[2]=Xn[168]=0;jn[2]=jn[168]=1;Fn[8]=Fn[162]=0;zn[8]=zn[162]=-1;Vn[8]=Vn[162]=0;kn[8]=kn[162]=0;Gn[8]=Gn[162]=-1;Un[8]=Un[162]=1;Hn[8]=Hn[162]=1;qn[8]=qn[162]=0;Wn[8]=Wn[162]=1;Yn[8]=Yn[162]=1;Xn[8]=Xn[162]=0;jn[8]=jn[162]=0;Fn[32]=Fn[138]=0;zn[32]=zn[138]=1;Vn[32]=Vn[138]=1;kn[32]=kn[138]=0;Gn[32]=Gn[138]=1;Un[32]=Un[138]=0;Mn[32]=Mn[138]=1;Ln[32]=Ln[138]=0;Rn[32]=Rn[138]=0;On[32]=On[138]=1;Nn[32]=Nn[138]=0;Bn[32]=Bn[138]=1;Jn[128]=Jn[42]=0;$n[128]=$n[42]=1;er[128]=er[42]=1;Kn[128]=Kn[42]=0;Zn[128]=Zn[42]=1;Qn[128]=Qn[42]=0;Mn[128]=Mn[42]=-1;Ln[128]=Ln[42]=0;Rn[128]=Rn[42]=1;On[128]=On[42]=-1;Nn[128]=Nn[42]=0;Bn[128]=Bn[42]=0;kn[5]=kn[165]=-1;Gn[5]=Gn[165]=0;Un[5]=Un[165]=0;Jn[5]=Jn[165]=1;$n[5]=$n[165]=0;er[5]=er[165]=0;Yn[20]=Yn[150]=0;Xn[20]=Xn[150]=1;jn[20]=jn[150]=1;On[20]=On[150]=0;Nn[20]=Nn[150]=-1;Bn[20]=Bn[150]=1;Fn[80]=Fn[90]=-1;zn[80]=zn[90]=0;Vn[80]=Vn[90]=1;Kn[80]=Kn[90]=1;Zn[80]=Zn[90]=0;Qn[80]=Qn[90]=1;Hn[65]=Hn[105]=0;qn[65]=qn[105]=1;Wn[65]=Wn[105]=0;Mn[65]=Mn[105]=0;Ln[65]=Ln[105]=-1;Rn[65]=Rn[105]=0;Fn[160]=Fn[10]=-1;zn[160]=zn[10]=0;Vn[160]=Vn[10]=1;kn[160]=kn[10]=-1;Gn[160]=Gn[10]=0;Un[160]=Un[10]=0;Jn[160]=Jn[10]=1;$n[160]=$n[10]=0;er[160]=er[10]=0;Kn[160]=Kn[10]=1;Zn[160]=Zn[10]=0;Qn[160]=Qn[10]=1;Yn[130]=Yn[40]=0;Xn[130]=Xn[40]=1;jn[130]=jn[40]=1;Hn[130]=Hn[40]=0;qn[130]=qn[40]=1;Wn[130]=Wn[40]=0;Mn[130]=Mn[40]=0;Ln[130]=Ln[40]=-1;Rn[130]=Rn[40]=0;On[130]=On[40]=0;Nn[130]=Nn[40]=-1;Bn[130]=Bn[40]=1;kn[37]=kn[133]=0;Gn[37]=Gn[133]=1;Un[37]=Un[133]=1;Jn[37]=Jn[133]=0;$n[37]=$n[133]=1;er[37]=er[133]=0;Mn[37]=Mn[133]=-1;Ln[37]=Ln[133]=0;Rn[37]=Rn[133]=0;On[37]=On[133]=1;Nn[37]=Nn[133]=0;Bn[37]=Bn[133]=0;Yn[148]=Yn[22]=-1;Xn[148]=Xn[22]=0;jn[148]=jn[22]=0;Jn[148]=Jn[22]=0;$n[148]=$n[22]=-1;er[148]=er[22]=1;Kn[148]=Kn[22]=0;Zn[148]=Zn[22]=1;Qn[148]=Qn[22]=1;On[148]=On[22]=-1;Nn[148]=Nn[22]=0;Bn[148]=Bn[22]=1;Fn[82]=Fn[88]=0;zn[82]=zn[88]=-1;Vn[82]=Vn[88]=1;Yn[82]=Yn[88]=1;Xn[82]=Xn[88]=0;jn[82]=jn[88]=1;Hn[82]=Hn[88]=-1;qn[82]=qn[88]=0;Wn[82]=Wn[88]=1;Kn[82]=Kn[88]=0;Zn[82]=Zn[88]=-1;Qn[82]=Qn[88]=0;Fn[73]=Fn[97]=0;zn[73]=zn[97]=1;Vn[73]=Vn[97]=0;kn[73]=kn[97]=0;Gn[73]=Gn[97]=-1;Un[73]=Un[97]=0;Hn[73]=Hn[97]=1;qn[73]=qn[97]=0;Wn[73]=Wn[97]=0;Mn[73]=Mn[97]=1;Ln[73]=Ln[97]=0;Rn[73]=Rn[97]=1;Fn[145]=Fn[25]=0;zn[145]=zn[25]=-1;Vn[145]=Vn[25]=0;Hn[145]=Hn[25]=1;qn[145]=qn[25]=0;Wn[145]=Wn[25]=1;Jn[145]=Jn[25]=0;$n[145]=$n[25]=1;er[145]=er[25]=1;On[145]=On[25]=-1;Nn[145]=Nn[25]=0;Bn[145]=Bn[25]=0;kn[70]=kn[100]=0;Gn[70]=Gn[100]=1;Un[70]=Un[100]=0;Yn[70]=Yn[100]=-1;Xn[70]=Xn[100]=0;jn[70]=jn[100]=1;Kn[70]=Kn[100]=0;Zn[70]=Zn[100]=-1;Qn[70]=Qn[100]=1;Mn[70]=Mn[100]=1;Ln[70]=Ln[100]=0;Rn[70]=Rn[100]=0;kn[101]=kn[69]=0;Gn[101]=Gn[69]=1;Un[101]=Un[69]=0;Mn[101]=Mn[69]=1;Ln[101]=Ln[69]=0;Rn[101]=Rn[69]=0;Jn[149]=Jn[21]=0;$n[149]=$n[21]=1;er[149]=er[21]=1;On[149]=On[21]=-1;Nn[149]=Nn[21]=0;Bn[149]=Bn[21]=0;Yn[86]=Yn[84]=-1;Xn[86]=Xn[84]=0;jn[86]=jn[84]=1;Kn[86]=Kn[84]=0;Zn[86]=Zn[84]=-1;Qn[86]=Qn[84]=1;Fn[89]=Fn[81]=0;zn[89]=zn[81]=-1;Vn[89]=Vn[81]=0;Hn[89]=Hn[81]=1;qn[89]=qn[81]=0;Wn[89]=Wn[81]=1;Fn[96]=Fn[74]=0;zn[96]=zn[74]=1;Vn[96]=Vn[74]=0;kn[96]=kn[74]=-1;Gn[96]=Gn[74]=0;Un[96]=Un[74]=1;Kn[96]=Kn[74]=1;Zn[96]=Zn[74]=0;Qn[96]=Qn[74]=0;Mn[96]=Mn[74]=1;Ln[96]=Ln[74]=0;Rn[96]=Rn[74]=1;Fn[24]=Fn[146]=0;zn[24]=zn[146]=-1;Vn[24]=Vn[146]=1;Yn[24]=Yn[146]=1;Xn[24]=Xn[146]=0;jn[24]=jn[146]=1;Hn[24]=Hn[146]=0;qn[24]=qn[146]=1;Wn[24]=Wn[146]=1;On[24]=On[146]=0;Nn[24]=Nn[146]=-1;Bn[24]=Bn[146]=0;kn[6]=kn[164]=-1;Gn[6]=Gn[164]=0;Un[6]=Un[164]=1;Yn[6]=Yn[164]=-1;Xn[6]=Xn[164]=0;jn[6]=jn[164]=0;Jn[6]=Jn[164]=0;$n[6]=$n[164]=-1;er[6]=er[164]=1;Kn[6]=Kn[164]=1;Zn[6]=Zn[164]=0;Qn[6]=Qn[164]=0;Hn[129]=Hn[41]=0;qn[129]=qn[41]=1;Wn[129]=Wn[41]=1;Jn[129]=Jn[41]=0;$n[129]=$n[41]=1;er[129]=er[41]=0;Mn[129]=Mn[41]=-1;Ln[129]=Ln[41]=0;Rn[129]=Rn[41]=0;On[129]=On[41]=0;Nn[129]=Nn[41]=-1;Bn[129]=Bn[41]=0;Yn[66]=Yn[104]=0;Xn[66]=Xn[104]=1;jn[66]=jn[104]=0;Hn[66]=Hn[104]=-1;qn[66]=qn[104]=0;Wn[66]=Wn[104]=1;Kn[66]=Kn[104]=0;Zn[66]=Zn[104]=-1;Qn[66]=Qn[104]=0;Mn[66]=Mn[104]=0;Ln[66]=Ln[104]=-1;Rn[66]=Rn[104]=1;Fn[144]=Fn[26]=-1;zn[144]=zn[26]=0;Vn[144]=Vn[26]=0;Jn[144]=Jn[26]=1;$n[144]=$n[26]=0;er[144]=er[26]=1;Kn[144]=Kn[26]=0;Zn[144]=Zn[26]=1;Qn[144]=Qn[26]=1;On[144]=On[26]=-1;Nn[144]=Nn[26]=0;Bn[144]=Bn[26]=1;kn[36]=kn[134]=0;Gn[36]=Gn[134]=1;Un[36]=Un[134]=1;Yn[36]=Yn[134]=0;Xn[36]=Xn[134]=1;jn[36]=jn[134]=0;Mn[36]=Mn[134]=0;Ln[36]=Ln[134]=-1;Rn[36]=Rn[134]=1;On[36]=On[134]=1;Nn[36]=Nn[134]=0;Bn[36]=Bn[134]=0;Fn[9]=Fn[161]=-1;zn[9]=zn[161]=0;Vn[9]=Vn[161]=0;kn[9]=kn[161]=0;Gn[9]=Gn[161]=-1;Un[9]=Un[161]=0;Hn[9]=Hn[161]=1;qn[9]=qn[161]=0;Wn[9]=Wn[161]=0;Jn[9]=Jn[161]=1;$n[9]=$n[161]=0;er[9]=er[161]=1;Fn[136]=0;zn[136]=1;Vn[136]=1;kn[136]=0;Gn[136]=1;Un[136]=0;Yn[136]=-1;Xn[136]=0;jn[136]=1;Hn[136]=-1;qn[136]=0;Wn[136]=0;Jn[136]=0;$n[136]=-1;er[136]=0;Kn[136]=0;Zn[136]=-1;Qn[136]=1;Mn[136]=1;Ln[136]=0;Rn[136]=0;On[136]=1;Nn[136]=0;Bn[136]=1;Fn[34]=0;zn[34]=-1;Vn[34]=0;kn[34]=0;Gn[34]=-1;Un[34]=1;Yn[34]=1;Xn[34]=0;jn[34]=0;Hn[34]=1;qn[34]=0;Wn[34]=1;Jn[34]=0;$n[34]=1;er[34]=1;Kn[34]=0;Zn[34]=1;Qn[34]=0;Mn[34]=-1;Ln[34]=0;Rn[34]=1;On[34]=-1;Nn[34]=0;Bn[34]=0;Fn[35]=0;zn[35]=1;Vn[35]=1;kn[35]=0;Gn[35]=-1;Un[35]=1;Yn[35]=1;Xn[35]=0;jn[35]=0;Hn[35]=-1;qn[35]=0;Wn[35]=0;Jn[35]=0;$n[35]=-1;er[35]=0;Kn[35]=0;Zn[35]=1;Qn[35]=0;Mn[35]=-1;Ln[35]=0;Rn[35]=1;On[35]=1;Nn[35]=0;Bn[35]=1;Fn[153]=0;zn[153]=1;Vn[153]=1;Hn[153]=-1;qn[153]=0;Wn[153]=0;Jn[153]=0;$n[153]=-1;er[153]=0;On[153]=1;Nn[153]=0;Bn[153]=1;kn[102]=0;Gn[102]=-1;Un[102]=1;Yn[102]=1;Xn[102]=0;jn[102]=0;Kn[102]=0;Zn[102]=1;Qn[102]=0;Mn[102]=-1;Ln[102]=0;Rn[102]=1;Fn[155]=0;zn[155]=-1;Vn[155]=0;Hn[155]=1;qn[155]=0;Wn[155]=1;Jn[155]=0;$n[155]=1;er[155]=1;On[155]=-1;Nn[155]=0;Bn[155]=0;kn[103]=0;Gn[103]=1;Un[103]=0;Yn[103]=-1;Xn[103]=0;jn[103]=1;Kn[103]=0;Zn[103]=-1;Qn[103]=1;Mn[103]=1;Ln[103]=0;Rn[103]=0;Fn[152]=0;zn[152]=1;Vn[152]=1;Yn[152]=-1;Xn[152]=0;jn[152]=1;Hn[152]=-1;qn[152]=0;Wn[152]=0;Jn[152]=0;$n[152]=-1;er[152]=0;Kn[152]=0;Zn[152]=-1;Qn[152]=1;On[152]=1;Nn[152]=0;Bn[152]=1;Fn[156]=0;zn[156]=-1;Vn[156]=1;Yn[156]=1;Xn[156]=0;jn[156]=1;Hn[156]=-1;qn[156]=0;Wn[156]=0;Jn[156]=0;$n[156]=-1;er[156]=0;Kn[156]=0;Zn[156]=1;Qn[156]=1;On[156]=-1;Nn[156]=0;Bn[156]=1;Fn[137]=0;zn[137]=1;Vn[137]=1;kn[137]=0;Gn[137]=1;Un[137]=0;Hn[137]=-1;qn[137]=0;Wn[137]=0;Jn[137]=0;$n[137]=-1;er[137]=0;Mn[137]=1;Ln[137]=0;Rn[137]=0;On[137]=1;Nn[137]=0;Bn[137]=1;Fn[139]=0;zn[139]=1;Vn[139]=1;kn[139]=0;Gn[139]=-1;Un[139]=0;Hn[139]=1;qn[139]=0;Wn[139]=0;Jn[139]=0;$n[139]=1;er[139]=0;Mn[139]=-1;Ln[139]=0;Rn[139]=0;On[139]=1;Nn[139]=0;Bn[139]=1;Fn[98]=0;zn[98]=-1;Vn[98]=0;kn[98]=0;Gn[98]=-1;Un[98]=1;Yn[98]=1;Xn[98]=0;jn[98]=0;Hn[98]=1;qn[98]=0;Wn[98]=1;Kn[98]=0;Zn[98]=1;Qn[98]=0;Mn[98]=-1;Ln[98]=0;Rn[98]=1;Fn[99]=0;zn[99]=1;Vn[99]=0;kn[99]=0;Gn[99]=-1;Un[99]=1;Yn[99]=1;Xn[99]=0;jn[99]=0;Hn[99]=-1;qn[99]=0;Wn[99]=1;Kn[99]=0;Zn[99]=-1;Qn[99]=0;Mn[99]=1;Ln[99]=0;Rn[99]=1;kn[38]=0;Gn[38]=-1;Un[38]=1;Yn[38]=1;Xn[38]=0;jn[38]=0;Jn[38]=0;$n[38]=1;er[38]=1;Kn[38]=0;Zn[38]=1;Qn[38]=0;Mn[38]=-1;Ln[38]=0;Rn[38]=1;On[38]=-1;Nn[38]=0;Bn[38]=0;kn[39]=0;Gn[39]=1;Un[39]=1;Yn[39]=-1;Xn[39]=0;jn[39]=0;Jn[39]=0;$n[39]=-1;er[39]=1;Kn[39]=0;Zn[39]=1;Qn[39]=0;Mn[39]=-1;Ln[39]=0;Rn[39]=1;On[39]=1;Nn[39]=0;Bn[39]=0;var oB=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},aB=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},sB=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},uB=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},lB=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},cB=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},fB=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},hB=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},FCe=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},zCe=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},VCe=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},kCe=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},GCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},UCe=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},HCe=function(){return[[0,0],[0,1],[1,1],[1,0]]},qCe=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},WCe=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},YCe=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},XCe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},jCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},KCe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},ZCe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},QCe=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},JCe=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},$Ce=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},exe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},txe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},nxe=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},rxe=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},ixe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},oxe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},axe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},sxe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},uxe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},lxe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},cxe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},fxe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},hxe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},dxe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},pxe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},nt=[],Je=[],It=[],mt=[],Wt=[],Gt=[],tr=[],Pr=[];mt[1]=Wt[1]=18;mt[169]=Wt[169]=18;It[4]=Je[4]=12;It[166]=Je[166]=12;nt[16]=Pr[16]=4;nt[154]=Pr[154]=4;Gt[64]=tr[64]=22;Gt[106]=tr[106]=22;It[2]=Gt[2]=17;mt[2]=Wt[2]=18;It[168]=Gt[168]=17;mt[168]=Wt[168]=18;nt[8]=mt[8]=9;Je[8]=It[8]=12;nt[162]=mt[162]=9;Je[162]=It[162]=12;nt[32]=Pr[32]=4;Je[32]=tr[32]=1;nt[138]=Pr[138]=4;Je[138]=tr[138]=1;Wt[128]=Pr[128]=21;Gt[128]=tr[128]=22;Wt[42]=Pr[42]=21;Gt[42]=tr[42]=22;Je[5]=Wt[5]=14;Je[165]=Wt[165]=14;It[20]=Pr[20]=6;It[150]=Pr[150]=6;nt[80]=Gt[80]=11;nt[90]=Gt[90]=11;mt[65]=tr[65]=3;mt[105]=tr[105]=3;nt[160]=Gt[160]=11;Je[160]=Wt[160]=14;nt[10]=Gt[10]=11;Je[10]=Wt[10]=14;It[130]=Pr[130]=6;mt[130]=tr[130]=3;It[40]=Pr[40]=6;mt[40]=tr[40]=3;Je[101]=tr[101]=1;Je[69]=tr[69]=1;Wt[149]=Pr[149]=21;Wt[21]=Pr[21]=21;It[86]=Gt[86]=17;It[84]=Gt[84]=17;nt[89]=mt[89]=9;nt[81]=mt[81]=9;nt[96]=tr[96]=0;Je[96]=Gt[96]=15;nt[74]=tr[74]=0;Je[74]=Gt[74]=15;nt[24]=It[24]=8;mt[24]=Pr[24]=7;nt[146]=It[146]=8;mt[146]=Pr[146]=7;Je[6]=Gt[6]=15;It[6]=Wt[6]=16;Je[164]=Gt[164]=15;It[164]=Wt[164]=16;mt[129]=Pr[129]=7;Wt[129]=tr[129]=20;mt[41]=Pr[41]=7;Wt[41]=tr[41]=20;It[66]=tr[66]=2;mt[66]=Gt[66]=19;It[104]=tr[104]=2;mt[104]=Gt[104]=19;nt[144]=Wt[144]=10;Gt[144]=Pr[144]=23;nt[26]=Wt[26]=10;Gt[26]=Pr[26]=23;Je[36]=Pr[36]=5;It[36]=tr[36]=2;Je[134]=Pr[134]=5;It[134]=tr[134]=2;nt[9]=Wt[9]=10;Je[9]=mt[9]=13;nt[161]=Wt[161]=10;Je[161]=mt[161]=13;Je[37]=Pr[37]=5;Wt[37]=tr[37]=20;Je[133]=Pr[133]=5;Wt[133]=tr[133]=20;It[148]=Wt[148]=16;Gt[148]=Pr[148]=23;It[22]=Wt[22]=16;Gt[22]=Pr[22]=23;nt[82]=It[82]=8;mt[82]=Gt[82]=19;nt[88]=It[88]=8;mt[88]=Gt[88]=19;nt[73]=tr[73]=0;Je[73]=mt[73]=13;nt[97]=tr[97]=0;Je[97]=mt[97]=13;nt[145]=mt[145]=9;Wt[145]=Pr[145]=21;nt[25]=mt[25]=9;Wt[25]=Pr[25]=21;Je[70]=tr[70]=1;It[70]=Gt[70]=17;Je[100]=tr[100]=1;It[100]=Gt[100]=17;nt[34]=mt[34]=9;Je[34]=It[34]=12;Wt[34]=Pr[34]=21;Gt[34]=tr[34]=22;nt[136]=Pr[136]=4;Je[136]=tr[136]=1;It[136]=Gt[136]=17;mt[136]=Wt[136]=18;nt[35]=Pr[35]=4;Je[35]=It[35]=12;mt[35]=Wt[35]=18;Gt[35]=tr[35]=22;nt[153]=Pr[153]=4;mt[153]=Wt[153]=18;Je[102]=It[102]=12;Gt[102]=tr[102]=22;nt[155]=mt[155]=9;Wt[155]=Pr[155]=23;Je[103]=tr[103]=1;It[103]=Gt[103]=17;nt[152]=Pr[152]=4;It[152]=Gt[152]=17;mt[152]=Wt[152]=18;nt[156]=It[156]=8;mt[156]=Wt[156]=18;Gt[156]=Pr[156]=23;nt[137]=Pr[137]=4;Je[137]=tr[137]=1;mt[137]=Wt[137]=18;nt[139]=Pr[139]=4;Je[139]=mt[139]=13;Wt[139]=tr[139]=20;nt[98]=mt[98]=9;Je[98]=It[98]=12;Gt[98]=tr[98]=22;nt[99]=tr[99]=0;Je[99]=It[99]=12;mt[99]=Gt[99]=19;Je[38]=It[38]=12;Wt[38]=Pr[38]=21;Gt[38]=tr[38]=22;Je[39]=Pr[39]=5;It[39]=Wt[39]=16;Gt[39]=tr[39]=22;var Ye=[];Ye[1]=Ye[169]=oB;Ye[4]=Ye[166]=aB;Ye[16]=Ye[154]=sB;Ye[64]=Ye[106]=uB;Ye[168]=Ye[2]=lB;Ye[162]=Ye[8]=cB;Ye[138]=Ye[32]=fB;Ye[42]=Ye[128]=hB;Ye[5]=Ye[165]=FCe;Ye[20]=Ye[150]=zCe;Ye[80]=Ye[90]=VCe;Ye[65]=Ye[105]=kCe;Ye[160]=Ye[10]=GCe;Ye[130]=Ye[40]=UCe;Ye[85]=HCe;Ye[101]=Ye[69]=qCe;Ye[149]=Ye[21]=WCe;Ye[86]=Ye[84]=YCe;Ye[89]=Ye[81]=XCe;Ye[96]=Ye[74]=jCe;Ye[24]=Ye[146]=KCe;Ye[6]=Ye[164]=ZCe;Ye[129]=Ye[41]=QCe;Ye[66]=Ye[104]=JCe;Ye[144]=Ye[26]=$Ce;Ye[36]=Ye[134]=exe;Ye[9]=Ye[161]=txe;Ye[37]=Ye[133]=nxe;Ye[148]=Ye[22]=rxe;Ye[82]=Ye[88]=ixe;Ye[73]=Ye[97]=oxe;Ye[145]=Ye[25]=axe;Ye[70]=Ye[100]=sxe;Ye[34]=function(e){return[hB(e),cB(e)]};Ye[35]=uxe;Ye[136]=function(e){return[fB(e),lB(e)]};Ye[153]=function(e){return[sB(e),oB(e)]};Ye[102]=function(e){return[aB(e),uB(e)]};Ye[155]=lxe;Ye[103]=cxe;Ye[152]=function(e){return[sB(e),lB(e)]};Ye[156]=fxe;Ye[137]=function(e){return[fB(e),oB(e)]};Ye[139]=hxe;Ye[98]=function(e){return[cB(e),uB(e)]};Ye[99]=dxe;Ye[38]=function(e){return[aB(e),hB(e)]};Ye[39]=pxe;function H(e,t,n){return(e-t)/(n-t)}function v3(e){return e.constructor.toString().indexOf("Array")>-1}function mxe(e,t,n){for(var r=e.length-1,o=e[0].length-1,a={rows:r,cols:o,cells:[]},s=t+Math.abs(n),u=0;u<r;++u){a.cells[u]=[];for(var l=0;l<o;++l){var c=0,f=e[u+1][l],h=e[u+1][l+1],d=e[u][l+1],p=e[u][l];if(!(isNaN(f)||isNaN(h)||isNaN(d)||isNaN(p))){c|=f<t?0:f>s?128:64,c|=h<t?0:h>s?32:16,c|=d<t?0:d>s?8:4,c|=p<t?0:p>s?2:1;var _=+c,y=0;if(c===17||c===18||c===33||c===34||c===38||c===68||c===72||c===98||c===102||c===132||c===136||c===137||c===152||c===153){var v=(f+h+d+p)/4;y=v>s?2:v<t?0:1,c===34?y===1?c=35:y===0&&(c=136):c===136?y===1?(c=35,y=4):y===0&&(c=34):c===17?y===1?(c=155,y=4):y===0&&(c=153):c===68?y===1?(c=103,y=4):y===0&&(c=102):c===153?y===1&&(c=155):c===102?y===1&&(c=103):c===152?y<2&&(c=156,y=1):c===137?y<2&&(c=139,y=1):c===98?y<2&&(c=99,y=1):c===38?y<2&&(c=39,y=1):c===18?y>0?(c=156,y=4):c=152:c===33?y>0?(c=139,y=4):c=137:c===72?y>0?(c=99,y=4):c=98:c===132&&(y>0?(c=39,y=4):c=38)}if(c!=0&&c!=170){var w,C,E,S,A,D,P,M;w=C=E=S=A=D=P=M=.5;var b=[];c===1?(E=1-H(t,d,p),M=1-H(t,f,p),b.push(mt[c])):c===169?(E=H(s,p,d),M=H(s,p,f),b.push(mt[c])):c===4?(D=1-H(t,h,d),S=H(t,p,d),b.push(Je[c])):c===166?(D=H(s,d,h),S=1-H(s,d,p),b.push(Je[c])):c===16?(A=H(t,d,h),C=H(t,f,h),b.push(nt[c])):c===154?(A=1-H(s,h,d),C=1-H(s,h,f),b.push(nt[c])):c===64?(P=H(t,p,f),w=1-H(t,h,f),b.push(Gt[c])):c===106?(P=1-H(s,f,p),w=H(s,f,h),b.push(Gt[c])):c===168?(S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),b.push(It[c]),b.push(mt[c])):c===2?(S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),b.push(It[c]),b.push(mt[c])):c===162?(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),b.push(It[c]),b.push(mt[c])):c===8?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),b.push(nt[c]),b.push(Je[c])):c===138?(A=1-H(t,h,d),D=1-H(s,h,d),w=1-H(s,h,f),C=1-H(t,h,f),b.push(nt[c]),b.push(Je[c])):c===32?(A=H(s,d,h),D=H(t,d,h),w=H(t,f,h),C=H(s,f,h),b.push(nt[c]),b.push(Je[c])):c===42?(M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),b.push(Wt[c]),b.push(Gt[c])):c===128&&(M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),b.push(Wt[c]),b.push(Gt[c])),c===5?(D=1-H(t,h,d),M=1-H(t,f,p),b.push(Je[c])):c===165?(D=H(s,d,h),M=H(s,p,f),b.push(Je[c])):c===20?(S=H(t,p,d),C=H(t,f,h),b.push(It[c])):c===150?(S=1-H(s,d,p),C=1-H(s,h,f),b.push(It[c])):c===80?(A=H(t,d,h),P=H(t,p,f),b.push(nt[c])):c===90?(A=1-H(s,h,d),P=1-H(s,f,p),b.push(nt[c])):c===65?(E=1-H(t,d,p),w=1-H(t,h,f),b.push(mt[c])):c===105?(E=H(s,p,d),w=H(s,f,h),b.push(mt[c])):c===160?(A=H(s,d,h),D=H(t,d,h),M=H(t,p,f),P=H(s,p,f),b.push(nt[c]),b.push(Je[c])):c===10?(A=1-H(t,h,d),D=1-H(s,h,d),M=1-H(s,f,p),P=1-H(t,f,p),b.push(nt[c]),b.push(Je[c])):c===130?(S=1-H(t,d,p),E=1-H(s,d,p),w=1-H(s,h,f),C=1-H(t,h,f),b.push(It[c]),b.push(mt[c])):c===40?(S=H(s,p,d),E=H(t,p,d),w=H(t,f,h),C=H(s,f,h),b.push(It[c]),b.push(mt[c])):c===101?(D=H(s,d,h),w=H(s,f,h),b.push(Je[c])):c===69?(D=1-H(t,h,d),w=1-H(t,h,f),b.push(Je[c])):c===149?(M=H(s,p,f),C=1-H(s,h,f),b.push(Wt[c])):c===21?(M=1-H(t,f,p),C=H(t,f,h),b.push(Wt[c])):c===86?(S=1-H(s,d,p),P=1-H(s,f,p),b.push(It[c])):c===84?(S=H(t,p,d),P=H(t,p,f),b.push(It[c])):c===89?(A=1-H(s,h,d),E=H(s,p,d),b.push(mt[c])):c===81?(A=H(t,d,h),E=1-H(t,d,p),b.push(mt[c])):c===96?(A=H(s,d,h),D=H(t,d,h),P=H(t,p,f),w=H(s,f,h),b.push(nt[c]),b.push(Je[c])):c===74?(A=1-H(t,h,d),D=1-H(s,h,d),P=1-H(s,f,p),w=1-H(t,h,f),b.push(nt[c]),b.push(Je[c])):c===24?(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),C=H(t,f,h),b.push(nt[c]),b.push(mt[c])):c===146?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),C=1-H(s,h,f),b.push(nt[c]),b.push(mt[c])):c===6?(D=1-H(t,h,d),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),b.push(Je[c]),b.push(It[c])):c===164?(D=H(s,d,h),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),b.push(Je[c]),b.push(It[c])):c===129?(E=1-H(t,d,p),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),b.push(mt[c]),b.push(Wt[c])):c===41?(E=H(s,p,d),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),b.push(mt[c]),b.push(Wt[c])):c===66?(S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=1-H(t,h,f),b.push(It[c]),b.push(mt[c])):c===104?(S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=H(s,f,h),b.push(mt[c]),b.push(tr[c])):c===144?(A=H(t,d,h),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f),b.push(nt[c]),b.push(Gt[c])):c===26?(A=1-H(s,h,d),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h),b.push(nt[c]),b.push(Gt[c])):c===36?(D=H(s,d,h),S=H(t,p,d),w=H(t,f,h),C=H(s,f,h),b.push(Je[c]),b.push(It[c])):c===134?(D=1-H(t,h,d),S=1-H(s,d,p),w=1-H(s,h,f),C=1-H(t,h,f),b.push(Je[c]),b.push(It[c])):c===9?(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=1-H(t,f,p),b.push(nt[c]),b.push(Je[c])):c===161?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=H(s,p,f),b.push(nt[c]),b.push(Je[c])):c===37?(D=H(s,d,h),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),b.push(Je[c]),b.push(Wt[c])):c===133?(D=1-H(t,h,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),b.push(Je[c]),b.push(Wt[c])):c===148?(S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f),b.push(It[c]),b.push(Gt[c])):c===22?(S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h),b.push(It[c]),b.push(Gt[c])):c===82?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),b.push(nt[c]),b.push(mt[c])):c===88?(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),b.push(nt[c]),b.push(mt[c])):c===73?(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),w=1-H(t,h,f),b.push(nt[c]),b.push(Je[c])):c===97?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),w=H(s,f,h),b.push(nt[c]),b.push(Je[c])):c===145?(A=H(t,d,h),E=1-H(t,d,p),M=H(s,p,f),C=1-H(s,h,f),b.push(nt[c]),b.push(Wt[c])):c===25?(A=1-H(s,h,d),E=H(s,p,d),M=1-H(t,f,p),C=H(t,f,h),b.push(nt[c]),b.push(Wt[c])):c===70?(D=1-H(t,h,d),S=1-H(s,d,p),P=1-H(s,f,p),w=1-H(t,h,f),b.push(Je[c]),b.push(It[c])):c===100?(D=H(s,d,h),S=H(t,p,d),P=H(t,p,f),w=H(s,f,h),b.push(Je[c]),b.push(It[c])):c===34?(y===0?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),b.push(nt[c]),b.push(Je[c]),b.push(Wt[c]),b.push(Gt[c])):c===35?(y===4?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),b.push(nt[c]),b.push(Je[c]),b.push(mt[c]),b.push(Gt[c])):c===136?(y===0?(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),b.push(nt[c]),b.push(Je[c]),b.push(Wt[c]),b.push(Gt[c])):c===153?(y===0?(A=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),C=1-H(s,h,f)),b.push(nt[c]),b.push(mt[c])):c===102?(y===0?(D=1-H(t,h,d),S=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),b.push(Je[c]),b.push(Gt[c])):c===155?(y===4?(A=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),C=1-H(s,h,f)),b.push(nt[c]),b.push(Wt[c])):c===103?(y===4?(D=1-H(t,h,d),S=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),b.push(Je[c]),b.push(It[c])):c===152?(y===0?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f)),b.push(nt[c]),b.push(It[c]),b.push(mt[c])):c===156?(y===4?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f)),b.push(nt[c]),b.push(mt[c]),b.push(Gt[c])):c===137?(y===0?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),b.push(nt[c]),b.push(Je[c]),b.push(mt[c])):c===139?(y===4?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),b.push(nt[c]),b.push(Je[c]),b.push(Wt[c])):c===98?(y===0?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),b.push(nt[c]),b.push(Je[c]),b.push(Gt[c])):c===99?(y===4?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),b.push(nt[c]),b.push(Je[c]),b.push(mt[c])):c===38?(y===0?(D=1-H(t,h,d),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),b.push(Je[c]),b.push(Wt[c]),b.push(Gt[c])):c===39?(y===4?(D=1-H(t,h,d),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),b.push(Je[c]),b.push(It[c]),b.push(Gt[c])):c===85&&(A=1,D=0,S=1,E=0,M=0,P=1,w=0,C=1),(w<0||w>1||C<0||C>1||A<0||A>1||S<0||S>1||M<0||M>1||P<0||P>1)&&console.log("MarchingSquaresJS-isoBands: "+c+" "+_+" "+f+","+h+","+d+","+p+" "+y+" "+w+" "+C+" "+A+" "+D+" "+S+" "+E+" "+M+" "+P),a.cells[u][l]={cval:c,cval_real:_,flipped:y,topleft:w,topright:C,righttop:A,rightbottom:D,bottomright:S,bottomleft:E,leftbottom:M,lefttop:P,edges:b}}}}}return a}function gxe(e){for(var t=[],n=e.rows,r=e.cols,o=[],a=0;a<n;a++)for(var s=0;s<r;s++)if(typeof e.cells[a][s]<"u"&&e.cells[a][s].edges.length>0){var u=e.cells[a][s],l=vxe(u),c=null,f=s,h=a;l!==null&&o.push([l.p[0]+f,l.p[1]+h]);do{if(c=Cxe(e.cells[h][f],l.x,l.y,l.o),c!==null)o.push([c.p[0]+f,c.p[1]+h]),f+=c.x,h+=c.y,l=c;else break;if(h<0||h>=n||f<0||f>=r||typeof e.cells[h][f]>"u"){f-=c.x,h-=c.y;var d=_xe(e,f,h,c.x,c.y,c.o);if(d!==null)d.path.forEach(function(p){o.push(p)}),f=d.i,h=d.j,l=d;else break}}while(typeof e.cells[h][f]<"u"&&e.cells[h][f].edges.length>0);t.push(o),o=[],e.cells[a][s].edges.length>0&&s--}return t}function _xe(e,t,n,r,o,a){for(var s=e.cells[n][t],u=s.cval_real,l=t+r,c=n+o,f=[],h=!1;!h;){if(typeof e.cells[c]>"u"||typeof e.cells[c][l]>"u")if(c-=o,l-=r,s=e.cells[c][l],u=s.cval_real,o===-1)if(a===0)if(u&ru)f.push([l,c]),r=-1,o=0,a=0;else if(u&Ns)f.push([l+1,c]),r=1,o=0,a=0;else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&ru)f.push([l,c]),r=-1,o=0,a=0;else if(u&Ns){f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else{f.push([l+s.bottomleft,c]),r=0,o=1,a=0,h=!0;break}else if(o===1)if(a===0)if(u&Qf)f.push([l+1,c+1]),r=1,o=0,a=1;else if(u&zu){f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else{f.push([l+s.topright,c+1]),r=0,o=-1,a=1,h=!0;break}else u&Qf?(f.push([l+1,c+1]),r=1,o=0,a=1):(f.push([l+1,c+1]),r=1,o=0,a=1);else if(r===-1)if(a===0)if(u&zu)f.push([l,c+1]),r=0,o=1,a=0;else if(u&ru){f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{f.push([l,c+s.lefttop]),r=1,o=0,a=1,h=!0;break}else if(u&zu)f.push([l,c+1]),r=0,o=1,a=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(r===1)if(a===0)if(u&Ns)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else if(u&Ns)f.push([l+1,c]),r=0,o=-1,a=1;else if(u&Qf){f.push([l+1,c+s.righttop]),r=-1,o=0,a=1;break}else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(s=e.cells[c][l],u=s.cval_real,r===-1)if(a===0)if(typeof e.cells[c-1]<"u"&&typeof e.cells[c-1][l]<"u")r=0,o=-1,a=1;else if(u&ru)f.push([l,c]);else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&zu)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+c);break}else if(r===1)if(a===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof e.cells[c+1]<"u"&&typeof e.cells[c+1][l]<"u")r=0,o=1,a=0;else if(u&Qf)f.push([l+1,c+1]),r=1,o=0,a=1;else{f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else if(o===-1)if(a===1)if(typeof e.cells[c][l+1]<"u")r=1,o=0,a=1;else if(u&Ns)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.righttop]),r=-1,o=0,a=1,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(o===1)if(a===0)if(typeof e.cells[c][l-1]<"u")r=-1,o=0,a=0;else if(u&zu)f.push([l,c+1]),r=0,o=1,a=0;else{f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(l+=r,c+=o,l===t&&c===n)break}return{path:f,i:l,j:c,x:r,y:o,o:a}}function yxe(e,t){delete e.edges[t];for(var n=t+1;n<e.edges.length;n++)e.edges[n-1]=e.edges[n];e.edges.pop()}function vxe(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],n=e.cval_real;switch(t){case 0:return n&Qf?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return n&Ns?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return n&Ns?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return n&ru?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return n&Qf?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return n&Ns?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return n&Ns?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return n&ru?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return n&Ns?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return n&ru?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return n&ru?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return n&zu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return n&Ns?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return n&ru?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return n&ru?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return n&zu?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return n&Ns?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return n&zu?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return n&ru?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return n&zu?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return n&zu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return n&Qf?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return n&zu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return n&Qf?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e);break}}return null}function Cxe(e,t,n,r){var o,a,s,u,l=e.cval,c;switch(t){case-1:switch(r){case 0:o=Je[l],s=kn[l],u=Gn[l],c=Un[l];break;default:o=nt[l],s=Fn[l],u=zn[l],c=Vn[l];break}break;case 1:switch(r){case 0:o=Wt[l],s=Jn[l],u=$n[l],c=er[l];break;default:o=Gt[l],s=Kn[l],u=Zn[l],c=Qn[l];break}break;default:switch(n){case-1:switch(r){case 0:o=tr[l],s=Mn[l],u=Ln[l],c=Rn[l];break;default:o=Pr[l],s=On[l],u=Nn[l],c=Bn[l];break}break;case 1:switch(r){case 0:o=mt[l],s=Hn[l],u=qn[l],c=Wn[l];break;default:o=It[l],s=Yn[l],u=Xn[l],c=jn[l];break}break;default:break}break}if(a=e.edges.indexOf(o),typeof e.edges[a]<"u")yxe(e,a);else return null;switch(l=e.cval_real,o){case 0:l&Qf?(t=e.topleft,n=1):(t=1,n=e.righttop);break;case 1:l&Ns?(t=1,n=e.rightbottom):(t=e.topleft,n=1);break;case 2:l&Ns?(t=e.topleft,n=1):(t=e.bottomright,n=0);break;case 3:l&ru?(t=e.bottomleft,n=0):(t=e.topleft,n=1);break;case 4:l&Qf?(t=e.topright,n=1):(t=1,n=e.righttop);break;case 5:l&Ns?(t=1,n=e.rightbottom):(t=e.topright,n=1);break;case 6:l&Ns?(t=e.topright,n=1):(t=e.bottomright,n=0);break;case 7:l&ru?(t=e.bottomleft,n=0):(t=e.topright,n=1);break;case 8:l&Ns?(t=1,n=e.righttop):(t=e.bottomright,n=0);break;case 9:l&ru?(t=e.bottomleft,n=0):(t=1,n=e.righttop);break;case 10:l&ru?(t=1,n=e.righttop):(t=0,n=e.leftbottom);break;case 11:l&zu?(t=0,n=e.lefttop):(t=1,n=e.righttop);break;case 12:l&Ns?(t=1,n=e.rightbottom):(t=e.bottomright,n=0);break;case 13:l&ru?(t=e.bottomleft,n=0):(t=1,n=e.rightbottom);break;case 14:l&ru?(t=1,n=e.rightbottom):(t=0,n=e.leftbottom);break;case 15:l&zu?(t=0,n=e.lefttop):(t=1,n=e.rightbottom);break;case 16:l&Ns?(t=0,n=e.leftbottom):(t=e.bottomright,n=0);break;case 17:l&zu?(t=0,n=e.lefttop):(t=e.bottomright,n=0);break;case 18:l&ru?(t=e.bottomleft,n=0):(t=0,n=e.leftbottom);break;case 19:l&zu?(t=0,n=e.lefttop):(t=e.bottomleft,n=0);break;case 20:l&zu?(t=0,n=e.leftbottom):(t=e.topleft,n=1);break;case 21:l&Qf?(t=e.topright,n=1):(t=0,n=e.leftbottom);break;case 22:l&zu?(t=0,n=e.lefttop):(t=e.topleft,n=1);break;case 23:l&Qf?(t=e.topright,n=1):(t=0,n=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return(typeof t>"u"||typeof n>"u"||typeof s>"u"||typeof u>"u"||typeof c>"u")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+n+" "+s+" "+u+" "+c)),{p:[t,n],x:s,y:u,o:c}}function xxe(e){var t=[],n=0;return e.cells.forEach(function(r,o){r.forEach(function(a,s){if(typeof a<"u"){var u=Ye[a.cval](a);typeof u=="object"&&v3(u)?typeof u[0]=="object"&&v3(u[0])?typeof u[0][0]=="object"&&v3(u[0][0])?u.forEach(function(l){l.forEach(function(c){c[0]+=s,c[1]+=o}),t[n++]=l}):(u.forEach(function(l){l[0]+=s,l[1]+=o}),t[n++]=u):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}function wxe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(Sd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!gt(o))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=OCe(e,{zProperty:r,flip:!0}),u=Exe(s,t,r);u=Txe(u,s,e);var l=u.map(function(c,f){if(a[f]&&!gt(a[f]))throw new Error("Each mappedProperty is required to be an Object");var h=Object.assign({},o,a[f]);h[r]=c[r];var d=wx(c.groupedRings,h);return d});return Vt(l)}function Exe(e,t,n){for(var r=[],o=1;o<t.length;o++){var a=+t[o-1],s=+t[o],u=BCe(e,a,s-a),l=Sxe(u),c=Axe(l),f={};f.groupedRings=c,f[n]=a+"-"+s,r.push(f)}return r}function Txe(e,t,n){var r=wa(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){p.groupedRings.forEach(function(_){_.forEach(function(y){y.forEach(d)})})}),e}function Sxe(e){var t=[],n=[];e.forEach(function(o){var a=bT(Pn([o]));n.push(a),t.push({ring:o,area:a})}),n.sort(function(o,a){return a-o});var r=[];return n.forEach(function(o){for(var a=0;a<t.length;a++)if(t[a].area===o){r.push(t[a].ring),t.splice(a,1);break}}),r}function Axe(e){for(var t=e.map(function(l){return{lrCoordinates:l,grouped:!1}}),n=[];!Ixe(t);)for(var r=0;r<t.length;r++)if(!t[r].grouped){var o=[];o.push(t[r].lrCoordinates),t[r].grouped=!0;for(var a=Pn([t[r].lrCoordinates]),s=r+1;s<t.length;s++)if(!t[s].grouped){var u=Pn([t[s].lrCoordinates]);bxe(u,a)&&(o.push(t[s].lrCoordinates),t[s].grouped=!0)}n.push(o)}return n}function bxe(e,t){for(var n=nB(e),r=0;r<n.features.length;r++)if(!Co(n.features[r],t))return!1;return!0}function Ixe(e){for(var t=0;t<e.length;t++)if(e[t].grouped===!1)return!1;return!0}function PX(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.pivot,o=n.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");return t===0||(r||(r=dy(e)),(o===!1||o===void 0)&&(e=lu(e)),Xa(e,function(a){var s=C0(r,a),u=s+t,l=MP(r,a),c=Tt(ex(r,l,u));a[0]=c[0],a[1]=c[1]})),e}function MX(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!e)throw new Error("geojson required");if(typeof t!="number"||t===0)throw new Error("invalid factor");var a=Array.isArray(r)||typeof r=="object";return o!==!0&&(e=lu(e)),e.type==="FeatureCollection"&&!a?(fi(e,function(s,u){e.features[u]=Q7(s,t,r)}),e):Q7(e,t,r)}function Q7(e,t,n){var r=Bi(e)==="Point";return n=Dxe(e,n),t===1||r||Xa(e,function(o){var a=MP(n,o),s=C0(n,o),u=a*t,l=Tt(ex(n,u,s));o[0]=l[0],o[1]=l[1],o.length===3&&(o[2]*=t)}),e}function Dxe(e,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return so(t);var n=e.bbox?e.bbox:wa(e),r=n[0],o=n[1],a=n[2],s=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return kr([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return kr([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return kr([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return kr([a,s]);case"center":return DP(e);case void 0:case null:case"centroid":return dy(e);default:throw new Error("invalid origin")}}function Pxe(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.zTranslation,s=r.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(a&&typeof a!="number"&&isNaN(a))throw new Error("zTranslation is not a number");if(a=a!==void 0?a:0,t===0&&a===0)return e;if(n==null||isNaN(n))throw new Error("direction is required");return t<0&&(t=-t,n=-n),(s===!1||s===void 0)&&(e=lu(e)),Xa(e,function(u){var l=Tt(ex(u,t,n,{units:o}));u[0]=l[0],u[1]=l[1],a&&u.length===3&&(u[2]+=a)}),e}function cP(e){var t=e[0],n=e[1];return[n[0]-t[0],n[1]-t[1]]}function N3(e,t){return e[0]*t[1]-t[0]*e[1]}function Mxe(e,t){return[e[0]+t[0],e[1]+t[1]]}function Lxe(e,t){return[e[0]-t[0],e[1]-t[1]]}function Rxe(e,t){return[e*t[0],e*t[1]]}function Oxe(e,t){var n=e[0],r=cP(e),o=t[0],a=cP(t),s=N3(r,a),u=Lxe(o,n),l=N3(u,a),c=l/s,f=Mxe(n,Rxe(c,r));return f}function Nxe(e,t){var n=cP(e),r=cP(t);return N3(n,r)===0}function Bxe(e,t){return Nxe(e,t)?!1:Oxe(e,t)}function Fxe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var o=Bi(e),a=e.properties;switch(o){case"LineString":return J7(e,t,r);case"MultiLineString":var s=[];return Ho(e,function(u){s.push(J7(u,t,r).geometry.coordinates)}),N0(s,a);default:throw new Error("geometry "+o+" is not supported")}}function J7(e,t,n){var r=[],o=iP(t,n),a=Tt(e),s=[];return a.forEach(function(u,l){if(l!==a.length-1){var c=zxe(u,a[l+1],o);if(r.push(c),l>0){var f=r[l-1],h=Bxe(c,f);h!==!1&&(f[1]=h,c[0]=h),s.push(f[0]),l===a.length-2&&(s.push(c[0]),s.push(c[1]))}a.length===2&&(s.push(c[0]),s.push(c[1]))}}),Ni(s,e.properties)}function zxe(e,t,n){var r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),o=e[0]+n*(t[1]-e[1])/r,a=t[0]+n*(t[1]-e[1])/r,s=e[1]+n*(e[0]-t[0])/r,u=t[1]+n*(e[0]-t[0])/r;return[[o,s],[a,u]]}function dB(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],a=n[0]-t[0],s=n[1]-t[1];return Math.sign(r*s-a*o)}function Vxe(e,t){var n=e.geometry.coordinates.map(function(s){return s[0]}),r=e.geometry.coordinates.map(function(s){return s[1]}),o=t.geometry.coordinates.map(function(s){return s[0]}),a=t.geometry.coordinates.map(function(s){return s[1]});return Math.max(null,n)===Math.max(null,o)&&Math.max(null,r)===Math.max(null,a)&&Math.min(null,n)===Math.min(null,o)&&Math.min(null,r)===Math.min(null,a)}function $7(e,t){return t.geometry.coordinates[0].every(function(n){return Co(kr(n),e)})}function kxe(e,t){return e[0]===t[0]&&e[1]===t[1]}var Sp=function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};Sp.buildId=function(t){return t.join(",")};Sp.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(n){return n.from.id!==t.from.id})};Sp.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(n){return n.to.id!==t.to.id})};Sp.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1};Sp.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(n,r){var o=n.to,a=r.to;if(o.coordinates[0]-t.coordinates[0]>=0&&a.coordinates[0]-t.coordinates[0]<0)return 1;if(o.coordinates[0]-t.coordinates[0]<0&&a.coordinates[0]-t.coordinates[0]>=0)return-1;if(o.coordinates[0]-t.coordinates[0]===0&&a.coordinates[0]-t.coordinates[0]===0)return o.coordinates[1]-t.coordinates[1]>=0||a.coordinates[1]-t.coordinates[1]>=0?o.coordinates[1]-a.coordinates[1]:a.coordinates[1]-o.coordinates[1];var s=dB(t.coordinates,o.coordinates,a.coordinates);if(s<0)return 1;if(s>0)return-1;var u=Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2),l=Math.pow(a.coordinates[0]-t.coordinates[0],2)+Math.pow(a.coordinates[1]-t.coordinates[1],2);return u-l}),this.outerEdgesSorted=!0)};Sp.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges};Sp.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]};Sp.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var S0=function(t,n){this.from=t,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};S0.prototype.getSymetric=function(){return this.symetric||(this.symetric=new S0(this.to,this.from),this.symetric.symetric=this),this.symetric};S0.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)};S0.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id};S0.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"};S0.prototype.toLineString=function(){return Ni([this.from.coordinates,this.to.coordinates])};S0.prototype.compareTo=function(t){return dB(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var Kl=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},LX={length:{configurable:!0}};Kl.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0};Kl.prototype.get=function(t){return this.edges[t]};LX.length.get=function(){return this.edges.length};Kl.prototype.forEach=function(t){this.edges.forEach(t)};Kl.prototype.map=function(t){return this.edges.map(t)};Kl.prototype.some=function(t){return this.edges.some(t)};Kl.prototype.isValid=function(){return!0};Kl.prototype.isHole=function(){var t=this,n=this.edges.reduce(function(s,u,l){return u.from.coordinates[1]>t.edges[s].from.coordinates[1]&&(s=l),s},0),r=(n===0?this.length:n)-1,o=(n+1)%this.length,a=dB(this.edges[r].from.coordinates,this.edges[n].from.coordinates,this.edges[o].from.coordinates);return a===0?this.edges[r].from.coordinates[0]>this.edges[o].from.coordinates[0]:a>0};Kl.prototype.toMultiPoint=function(){return TP(this.edges.map(function(t){return t.from.coordinates}))};Kl.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(n){return n.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=Pn([t])};Kl.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=lX(this.toPolygon())};Kl.findEdgeRingContaining=function(t,n){var r=t.getEnvelope(),o,a;return n.forEach(function(s){var u=s.getEnvelope();if(a&&(o=a.getEnvelope()),!Vxe(u,r)&&$7(u,r)){var l=t.map(function(c){return c.from.coordinates}).find(function(c){return!s.some(function(f){return kxe(c,f.from.coordinates)})});l&&s.inside(kr(l))&&(!a||$7(o,u))&&(a=s)}}),a};Kl.prototype.inside=function(t){return Co(t,this.toPolygon())};Object.defineProperties(Kl.prototype,LX);function Gxe(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var fl=function(){this.edges=[],this.nodes={}};fl.fromGeoJson=function(t){Gxe(t);var n=new fl;return Ho(t,function(r){xT(r,"LineString","Graph::fromGeoJson"),AP(r,function(o,a){if(o){var s=n.getNode(o),u=n.getNode(a);n.addEdge(s,u)}return a})}),n};fl.prototype.getNode=function(t){var n=Sp.buildId(t),r=this.nodes[n];return r||(r=this.nodes[n]=new Sp(t)),r};fl.prototype.addEdge=function(t,n){var r=new S0(t,n),o=r.getSymetric();this.edges.push(r),this.edges.push(o)};fl.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(n){return t.nodes[n]}).forEach(function(n){return t._removeIfDangle(n)})};fl.prototype._removeIfDangle=function(t){var n=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map(function(o){return o.to});this.removeNode(t),r.forEach(function(o){return n._removeIfDangle(o)})}};fl.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(n){n.label===n.symetric.label&&(t.removeEdge(n.symetric),t.removeEdge(n))})};fl.prototype._computeNextCWEdges=function(t){var n=this;typeof t>"u"?Object.keys(this.nodes).forEach(function(r){return n._computeNextCWEdges(n.nodes[r])}):t.getOuterEdges().forEach(function(r,o){t.getOuterEdge((o===0?t.getOuterEdges().length:o)-1).symetric.next=r})};fl.prototype._computeNextCCWEdges=function(t,n){for(var r=t.getOuterEdges(),o,a,s=r.length-1;s>=0;--s){var u=r[s],l=u.symetric,c=void 0,f=void 0;u.label===n&&(c=u),l.label===n&&(f=l),!(!c||!f)&&(f&&(a=f),c&&(a&&(a.next=c,a=void 0),o||(o=c)))}a&&(a.next=o)};fl.prototype._findLabeledEdgeRings=function(){var t=[],n=0;return this.edges.forEach(function(r){if(!(r.label>=0)){t.push(r);var o=r;do o.label=n,o=o.next;while(!r.isEqual(o));n++}}),t};fl.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){t._findIntersectionNodes(r).forEach(function(o){t._computeNextCCWEdges(o,r.label)})});var n=[];return this.edges.forEach(function(r){r.ring||n.push(t._findEdgeRing(r))}),n};fl.prototype._findIntersectionNodes=function(t){var n=[],r=t,o=function(){var a=0;r.from.getOuterEdges().forEach(function(s){s.label===t.label&&++a}),a>1&&n.push(r.from),r=r.next};do o();while(!t.isEqual(r));return n};fl.prototype._findEdgeRing=function(t){var n=t,r=new Kl;do r.push(n),n.ring=r,n=n.next;while(!t.isEqual(n));return r};fl.prototype.removeNode=function(t){var n=this;t.getOuterEdges().forEach(function(r){return n.removeEdge(r)}),t.innerEdges.forEach(function(r){return n.removeEdge(r)}),delete this.nodes[t.id]};fl.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(n){return!n.isEqual(t)}),t.deleteEdge()};function Uxe(e){var t=fl.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var n=[],r=[];return t.getEdgeRings().filter(function(o){return o.isValid()}).forEach(function(o){o.isHole()?n.push(o):r.push(o)}),n.forEach(function(o){Kl.findEdgeRingContaining(o,r)&&r.push(o)}),Vt(r.map(function(o){return o.toPolygon()}))}function RX(e,t){var n;return Ho(e,function(r){Ho(t,function(o){if(n===!1)return!1;n=Hxe(r.geometry,o.geometry)})}),n}function Hxe(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!Xxe(e.coordinates,t.coordinates);case"LineString":return!eY(t,e);case"Polygon":return!Co(e,t)}break;case"LineString":switch(t.type){case"Point":return!eY(e,t);case"LineString":return!qxe(e,t);case"Polygon":return!tY(t,e)}break;case"Polygon":switch(t.type){case"Point":return!Co(t,e);case"LineString":return!tY(e,t);case"Polygon":return!Wxe(t,e)}}}function eY(e,t){for(var n=0;n<e.coordinates.length-1;n++)if(Yxe(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function qxe(e,t){var n=ng(e,t);return n.features.length>0}function tY(e,t){var n=ng(t,sP(e));return n.features.length>0}function Wxe(e,t){for(var n=0;n<e.coordinates[0].length;n++)if(Co(e.coordinates[0][n],t))return!0;for(var r=0;r<t.coordinates[0].length;r++)if(Co(t.coordinates[0][r],e))return!0;return!1}function Yxe(e,t,n){var r=n[0]-e[0],o=n[1]-e[1],a=t[0]-e[0],s=t[1]-e[1],u=r*s-o*a;return u!==0?!1:Math.abs(a)>=Math.abs(s)?a>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:s>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function Xxe(e,t){return e[0]===t[0]&&e[1]===t[1]}function jxe(e,t){var n=Bi(e),r=Bi(t),o=Hl(e),a=Hl(t),s=Tt(e),u=Tt(t);switch(n){case"Point":switch(r){case"Point":return pB(s,u);default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"Point":return Kxe(o,a);case"MultiPoint":return Zxe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return xc(a,o,{ignoreEndVertices:!0});case"LineString":return $xe(o,a);case"MultiPoint":return Qxe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return Co(a,o,{ignoreBoundary:!0});case"LineString":return e1e(o,a);case"Polygon":return t1e(o,a);case"MultiPoint":return Jxe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Kxe(e,t){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(pB(e.coordinates[n],t.coordinates)){r=!0;break}return r}function Zxe(e,t){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,o=0;o<e.coordinates.length;o++)if(pB(t.coordinates[n],e.coordinates[o])){r=!0;break}if(!r)return!1}return!0}function Qxe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(xc(t.coordinates[r],e,{ignoreEndVertices:!0})&&(n=!0),!xc(t.coordinates[r],e))return!1;return!!n}function Jxe(e,t){for(var n=0;n<t.coordinates.length;n++)if(!Co(t.coordinates[n],e,{ignoreBoundary:!0}))return!1;return!0}function $xe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(xc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!0})&&(n=!0),!xc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!1}))return!1;return n}function e1e(e,t){var n=!1,r=0,o=wa(e),a=wa(t);if(!OX(o,a))return!1;for(r;r<t.coordinates.length-1;r++){var s=n1e(t.coordinates[r],t.coordinates[r+1]);if(Co({type:"Point",coordinates:s},e,{ignoreBoundary:!0})){n=!0;break}}return n}function t1e(e,t){var n=wa(e),r=wa(t);if(!OX(n,r))return!1;for(var o=0;o<t.coordinates[0].length;o++)if(!Co(t.coordinates[0][o],e))return!1;return!0}function OX(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function pB(e,t){return e[0]===t[0]&&e[1]===t[1]}function n1e(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function r1e(e,t){var n=Bi(e),r=Bi(t),o=Hl(e),a=Hl(t);switch(n){case"MultiPoint":switch(r){case"LineString":return nY(o,a);case"Polygon":return iY(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return nY(a,o);case"LineString":return i1e(o,a);case"Polygon":return rY(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return iY(a,o);case"LineString":return rY(a,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function nY(e,t){for(var n=!1,r=!1,o=e.coordinates.length,a=0;a<o&&!n&&!r;){for(var s=0;s<t.coordinates.length-1;s++){var u=!0;(s===0||s===t.coordinates.length-2)&&(u=!1),NX(t.coordinates[s],t.coordinates[s+1],e.coordinates[a],u)?n=!0:r=!0}a++}return n&&r}function i1e(e,t){var n=ng(e,t);if(n.features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var o=0;o<t.coordinates.length-1;o++){var a=!0;if((o===0||o===t.coordinates.length-2)&&(a=!1),NX(e.coordinates[r],e.coordinates[r+1],t.coordinates[o],a))return!0}return!1}function rY(e,t){var n=ng(e,sP(t));return n.features.length>0}function iY(e,t){for(var n=!1,r=!1,o=e.coordinates[0].length,a=0;a<o&&n&&r;)Co(kr(e.coordinates[0][a]),t)?n=!0:r=!0,a++;return r&&r}function NX(e,t,n,r){var o=n[0]-e[0],a=n[1]-e[1],s=t[0]-e[0],u=t[1]-e[1],l=o*u-a*s;return l!==0?!1:r?Math.abs(s)>=Math.abs(u)?s>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:u>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]:Math.abs(s)>=Math.abs(u)?s>0?e[0]<n[0]&&n[0]<t[0]:t[0]<n[0]&&n[0]<e[0]:u>0?e[1]<n[1]&&n[1]<t[1]:t[1]<n[1]&&n[1]<e[1]}var B3=tg(function(e,t){t=e.exports=typeof Object.keys=="function"?Object.keys:n,t.shim=n;function n(r){var o=[];for(var a in r)o.push(a);return o}}),D0t=B3.shim,fP=tg(function(e,t){var n=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";t=e.exports=n?r:o,t.supported=r;function r(a){return Object.prototype.toString.call(a)=="[object Arguments]"}t.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}}),P0t=fP.supported,M0t=fP.unsupported,o1e=tg(function(e){var t=Array.prototype.slice,n=e.exports=function(s,u,l){return l||(l={}),s===u?!0:s instanceof Date&&u instanceof Date?s.getTime()===u.getTime():!s||!u||typeof s!="object"&&typeof u!="object"?l.strict?s===u:s==u:a(s,u,l)};function r(s){return s==null}function o(s){return!(!s||typeof s!="object"||typeof s.length!="number"||typeof s.copy!="function"||typeof s.slice!="function"||s.length>0&&typeof s[0]!="number")}function a(s,u,l){var c,f;if(r(s)||r(u)||s.prototype!==u.prototype)return!1;if(fP(s))return fP(u)?(s=t.call(s),u=t.call(u),n(s,u,l)):!1;if(o(s)){if(!o(u)||s.length!==u.length)return!1;for(c=0;c<s.length;c++)if(s[c]!==u[c])return!1;return!0}try{var h=B3(s),d=B3(u)}catch{return!1}if(h.length!=d.length)return!1;for(h.sort(),d.sort(),c=h.length-1;c>=0;c--)if(h[c]!=d[c])return!1;for(c=h.length-1;c>=0;c--)if(f=h[c],!n(s[f],u[f],l))return!1;return typeof s==typeof u}}),Lp=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:a1e};Lp.prototype.compare=function(e,t){if(e.type!==t.type||!BX(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(e.type.indexOf("Multi")===0){var n=this,r=oY(e),o=oY(t);return r.every(function(a){return this.some(function(s){return n.compare(a,s)})},o)}}return!1};function oY(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function BX(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}Lp.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].toFixed(this.precision)!==t[n].toFixed(this.precision))return!1;return!0};Lp.prototype.compareLine=function(e,t,n,r){if(!BX(e,t))return!1;var o=this.pseudoNode?e:this.removePseudo(e),a=this.pseudoNode?t:this.removePseudo(t);if(!(r&&!this.compareCoord(o[0],a[0])&&(a=this.fixStartIndex(a,o),!a))){var s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}};Lp.prototype.fixStartIndex=function(e,t){for(var n,r=-1,o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){r=o;break}return r>=0&&(n=[].concat(e.slice(r,e.length),e.slice(1,r+1))),n};Lp.prototype.comparePath=function(e,t){var n=this;return e.every(function(r,o){return n.compareCoord(r,this[o])},t)};Lp.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var n=e.coordinates.slice(1,e.coordinates.length),r=t.coordinates.slice(1,t.coordinates.length),o=this;return n.every(function(a){return this.some(function(s){return o.compareLine(a,s,1,!0)})},r)}else return!1};Lp.prototype.compareFeature=function(e,t){return e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t)?!1:this.compare(e.geometry,t.geometry)};Lp.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))};Lp.prototype.removePseudo=function(e){return e};function a1e(e,t){return o1e(e,t,{strict:!0})}var FX=Lp;function zX(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Bi(e),r=Bi(t);if(n!==r)throw new Error("features must be of the same type");if(n==="Point")throw new Error("Point geometry not supported");var o=new FX({precision:6});if(o.compare(e,t))return!1;var a=0;switch(n){case"MultiPoint":var s=Ep(e),u=Ep(t);s.forEach(function(l){u.forEach(function(c){l[0]===c[0]&&l[1]===c[1]&&a++})});break;case"LineString":case"MultiLineString":km(e,function(l){km(t,function(c){DX(l,c).features.length&&a++})});break;case"Polygon":case"MultiPolygon":km(e,function(l){km(t,function(c){ng(l,c).features.length&&a++})});break}return a>0}function s1e(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Bi(e),r=Bi(t);if(n!==r)return!1;var o=new FX({precision:6});return o.compare(Wm(e),Wm(t))}var u1e=tg(function(e){function t(n,r,o,a){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,o,a)}t.prototype.run=function(n,r,o,a){this._init(n,r,o,a);for(var s=0;s<this._datasetLength;s++)if(this._visited[s]!==1){this._visited[s]=1;var u=this._regionQuery(s);if(u.length<this.minPts)this.noise.push(s);else{var l=this.clusters.length;this.clusters.push([]),this._addToCluster(s,l),this._expandCluster(l,u)}}return this.clusters},t.prototype._init=function(n,r,o,a){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),o&&(this.minPts=o),a&&(this.distance=a)},t.prototype._expandCluster=function(n,r){for(var o=0;o<r.length;o++){var a=r[o];if(this._visited[a]!==1){this._visited[a]=1;var s=this._regionQuery(a);s.length>=this.minPts&&(r=this._mergeArrays(r,s))}this._assigned[a]!==1&&this._addToCluster(a,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],o=0;o<this._datasetLength;o++){var a=this.distance(this.dataset[n],this.dataset[o]);a<this.epsilon&&r.push(o)}return r},t.prototype._mergeArrays=function(n,r){for(var o=r.length,a=0;a<o;a++){var s=r[a];n.indexOf(s)<0&&n.push(s)}return n},t.prototype._euclideanDistance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;)o+=(n[a]-r[a])*(n[a]-r[a]);return Math.sqrt(o)},e.exports&&(e.exports=t)}),l1e=tg(function(e){function t(n,r,o){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,o)}t.prototype.init=function(n,r,o){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof o<"u"&&(this.distance=o)},t.prototype.run=function(n,r){this.init(n,r);for(var o=this.dataset.length,a=0;a<this.k;a++)this.centroids[a]=this.randomCentroid();for(var s=!0;s;){s=this.assign();for(var u=0;u<this.k;u++){for(var l=new Array(d),c=0,f=0;f<d;f++)l[f]=0;for(var h=0;h<o;h++){var d=this.dataset[h].length;if(u===this.assignments[h]){for(var f=0;f<d;f++)l[f]+=this.dataset[h][f];c++}}if(c>0){for(var f=0;f<d;f++)l[f]/=c;this.centroids[u]=l}else this.centroids[u]=this.randomCentroid(),s=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,o;do o=Math.round(Math.random()*n),r=this.dataset[o];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,o,a=0;a<r;a++)o=this.argmin(this.dataset[a],this.centroids,this.distance),o!=this.assignments[a]&&(this.assignments[a]=o,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,o=0;o<this.assignments.length;o++)r=this.assignments[o],typeof n[r]>"u"&&(n[r]=[]),n[r].push(o);return n},t.prototype.argmin=function(n,r,o){for(var a=Number.MAX_VALUE,s=0,u=r.length,l,c=0;c<u;c++)l=o(n,r[c]),l<a&&(a=l,s=c);return s},t.prototype.distance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;){var s=n[a]-r[a];o+=s*s}return Math.sqrt(o)},e.exports&&(e.exports=t)}),VX=tg(function(e){function t(n,r,o){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,o)}t.prototype.insert=function(n,r){for(var o=this._queue.length,a=o;a--;){var s=this._priorities[a];this._sorting==="desc"?r>s&&(o=a):r<s&&(o=a)}this._insertAt(n,r,o)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var o=this._queue[r];if(n===o){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,o=this._queue.length;r<o;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,o){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var a=0;a<n.length;a++)this.insert(n[a],r[a])}o&&(this._sorting=o)},t.prototype._insertAt=function(n,r,o){this._queue.length===o?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(o,0,n),this._priorities.splice(o,0,r))},e.exports&&(e.exports=t)}),c1e=tg(function(e){if(e.exports)var t=VX;function n(r,o,a,s){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,o,a,s)}n.prototype.run=function(r,o,a,s){this._init(r,o,a,s);for(var u=0,l=this.dataset.length;u<l;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var c=this.clusters.length-1;this._orderedList.push(u);var f=new t(null,null,"asc"),h=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,h,f),this._expandCluster(c,f))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],o=0,a=this._orderedList.length;o<a;o++){var s=this._orderedList[o],u=this._reachability[s];r.push([s,u])}return r},n.prototype._init=function(r,o,a,s){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}o&&(this.epsilon=o),a&&(this.minPts=a),s&&(this.distance=s)},n.prototype._updateQueue=function(r,o,a){var s=this;this._coreDistance=this._distanceToCore(r),o.forEach(function(u){if(s._processed[u]===void 0){var l=s.distance(s.dataset[r],s.dataset[u]),c=Math.max(s._coreDistance,l);s._reachability[u]===void 0?(s._reachability[u]=c,a.insert(u,c)):c<s._reachability[u]&&(s._reachability[u]=c,a.remove(u),a.insert(u,c))}})},n.prototype._expandCluster=function(r,o){for(var a=o.getElements(),s=0,u=a.length;s<u;s++){var l=a[s];if(this._processed[l]===void 0){var c=this._regionQuery(l);this._processed[l]=1,this.clusters[r].push(l),this._orderedList.push(l),this._distanceToCore(l)!==void 0&&(this._updateQueue(l,c,o),this._expandCluster(r,o))}}},n.prototype._distanceToCore=function(r){for(var o=this.epsilon,a=0;a<o;a++){var s=this._regionQuery(r,a);if(s.length>=this.minPts)return a}},n.prototype._regionQuery=function(r,o){o=o||this.epsilon;for(var a=[],s=0,u=this.dataset.length;s<u;s++)this.distance(this.dataset[r],this.dataset[s])<o&&a.push(s);return a},n.prototype._euclideanDistance=function(r,o){for(var a=0,s=Math.min(r.length,o.length);s--;)a+=(r[s]-o[s])*(r[s]-o[s]);return Math.sqrt(a)},e.exports&&(e.exports=n)}),KT=tg(function(e){e.exports&&(e.exports={DBSCAN:u1e,KMEANS:l1e,OPTICS:c1e,PriorityQueue:VX})}),L0t=KT.DBSCAN,R0t=KT.KMEANS,O0t=KT.OPTICS,N0t=KT.PriorityQueue;function f1e(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.minPoints,o=n.units;if(Sd(e,"Point","Input must contain Points"),t==null)throw new Error("maxDistance is required");if(!(Math.sign(t)>0))throw new Error("Invalid maxDistance");if(!(r==null||Math.sign(r)>0))throw new Error("Invalid minPoints");e=lu(e,!0),r=r||3;var a=new KT.DBSCAN,s=a.run(Ep(e),hy(t,o),r,li),u=-1;return s.forEach(function(l){u++,l.forEach(function(c){var f=e.features[c];f.properties||(f.properties={}),f.properties.cluster=u,f.properties.dbscan="core"})}),a.noise.forEach(function(l){var c=e.features[l];c.properties||(c.properties={}),c.properties.cluster?c.properties.dbscan="edge":c.properties.dbscan="noise"}),e}var mB={eudist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++){var u=(t[s]||0)-(n[s]||0);a+=u*u}return r?Math.sqrt(a):a},mandist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++)a+=Math.abs((t[s]||0)-(n[s]||0));return r?Math.sqrt(a):a},dist:function(t,n,r){var o=Math.abs(t-n);return r?o:o*o}},h1e=mB.eudist,d1e=mB.dist,kX={kmrand:function(t,n){for(var r={},o=[],a=n<<2,s=t.length,u=t[0].length>0;o.length<n&&a-- >0;){var l=t[Math.floor(Math.random()*s)],c=u?l.join("_"):""+l;r[c]||(r[c]=!0,o.push(l))}if(o.length<n)throw new Error("Error initializating clusters");return o},kmpp:function(t,n){var r=t[0].length?h1e:d1e,o=[],a=t.length,s=t[0].length>0,u=t[Math.floor(Math.random()*a)],l=s?u.join("_"):""+u;for(o.push(u);o.length<n;){for(var c=[],f=o.length,h=0,d=[],p=0;p<a;p++){for(var _=1/0,y=0;y<f;y++){var v=r(t[p],o[y]);v<=_&&(_=v)}c[p]=_}for(var w=0;w<a;w++)h+=c[w];for(var C=0;C<a;C++)d[C]={i:C,v:t[C],pr:c[C]/h,cs:0};d.sort(function(D,P){return D.pr-P.pr}),d[0].cs=d[0].pr;for(var E=1;E<a;E++)d[E].cs=d[E-1].cs+d[E].pr;for(var S=Math.random(),A=0;A<a-1&&d[A++].cs<S;);o.push(d[A-1].v)}return o}},p1e=mB.eudist,m1e=kX.kmrand,g1e=kX.kmpp,aY=1e4;function sY(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function _1e(e,t,n,r){var o=[],a=[],s=[],u=[],l=!1,c=r||aY,f=e.length,h=e[0].length,d=h>0,p=[];if(n)n=="kmrand"?o=m1e(e,t):n=="kmpp"?o=g1e(e,t):o=n;else for(var _={};o.length<t;){var y=Math.floor(Math.random()*f);_[y]||(_[y]=!0,o.push(e[y]))}do{sY(t,0,p);for(var v=0;v<f;v++){for(var w=1/0,C=0,E=0;E<t;E++){var u=d?p1e(e[v],o[E]):Math.abs(e[v]-o[E]);u<=w&&(w=u,C=E)}s[v]=C,p[C]++}for(var S=[],a=[],A=0;A<t;A++)S[A]=d?sY(h,0,S[A]):0,a[A]=o[A];if(d){for(var D=0;D<t;D++)o[D]=[];for(var P=0;P<f;P++)for(var M=s[P],b=S[M],O=e[P],m=0;m<h;m++)b[m]+=O[m];l=!0;for(var I=0;I<t;I++){for(var L=o[I],R=S[I],N=a[I],B=p[I],V=0;V<h;V++)L[V]=R[V]/B||0;if(l){for(var z=0;z<h;z++)if(N[z]!=L[z]){l=!1;break}}}}else{for(var U=0;U<f;U++){var Q=s[U];S[Q]+=e[U]}for(var ne=0;ne<t;ne++)o[ne]=S[ne]/p[ne]||0;l=!0;for(var se=0;se<t;se++)if(a[se]!=o[se]){l=!1;break}}l=l||--c<=0}while(!l);return{it:aY-c,k:t,idxs:s,centroids:o}}var y1e=_1e;function v1e(e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.numberOfClusters,r=t.mutate;Sd(e,"Point","Input must contain Points");var o=e.features.length;n=n||Math.round(Math.sqrt(o/2)),n>o&&(n=o),(r===!1||r===void 0)&&(e=lu(e,!0));var a=Ep(e),s=a.slice(0,n),u=y1e(a,n,s),l={};return u.centroids.forEach(function(c,f){l[f]=c}),fi(e,function(c,f){var h=u.idxs[f];c.properties.cluster=h,c.properties.centroid=l[h]}),e}function C1e(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var n=uY(e,"line1");if(n!=="LineString")throw new Error("line1 must be a LineString");var r=uY(t,"line2");if(r!=="LineString")throw new Error("line2 must be a LineString");for(var o=py(Wm(e)).features,a=py(Wm(t)).features,s=0;s<o.length;s++){var u=o[s].geometry.coordinates;if(!a[s])break;var l=a[s].geometry.coordinates;if(!w1e(u,l))return!1}return!0}function x1e(e,t){var n=!1;return Ho(e,function(r){Ho(t,function(o){if(n===!0)return!0;n=!RX(r.geometry,o.geometry)})}),n}function w1e(e,t){var n=v0(C0(e[0],e[1])),r=v0(C0(t[0],t[1]));return n===r}function uY(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function lY(e){for(var t=e,n=[];t.parent;)n.unshift(t),t=t.parent;return n}function E1e(){return new GX(function(e){return e.f})}var RP={search:function(e,t,n,r){e.cleanDirty(),r=r||{};var o=r.heuristic||RP.heuristics.manhattan,a=r.closest||!1,s=E1e(),u=t;for(t.h=o(t,n),s.push(t);s.size()>0;){var l=s.pop();if(l===n)return lY(l);l.closed=!0;for(var c=e.neighbors(l),f=0,h=c.length;f<h;++f){var d=c[f];if(!(d.closed||d.isWall())){var p=l.g+d.getCost(l),_=d.visited;(!_||p<d.g)&&(d.visited=!0,d.parent=l,d.h=d.h||o(d,n),d.g=p,d.f=d.g+d.h,e.markDirty(d),a&&(d.h<u.h||d.h===u.h&&d.g<u.g)&&(u=d),_?s.rescoreElement(d):s.push(d))}}}return a?lY(u):[]},heuristics:{manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},diagonal:function(e,t){var n=1,r=Math.sqrt(2),o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return n*(o+a)+(r-2*n)*Math.min(o,a)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function Tx(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var n=0;n<e.length;n++){this.grid[n]=[];for(var r=0,o=e[n];r<o.length;r++){var a=new OP(n,r,o[r]);this.grid[n][r]=a,this.nodes.push(a)}}this.init()}Tx.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)RP.cleanNode(this.nodes[e])};Tx.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)RP.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};Tx.prototype.markDirty=function(e){this.dirtyNodes.push(e)};Tx.prototype.neighbors=function(e){var t=[],n=e.x,r=e.y,o=this.grid;return o[n-1]&&o[n-1][r]&&t.push(o[n-1][r]),o[n+1]&&o[n+1][r]&&t.push(o[n+1][r]),o[n]&&o[n][r-1]&&t.push(o[n][r-1]),o[n]&&o[n][r+1]&&t.push(o[n][r+1]),this.diagonal&&(o[n-1]&&o[n-1][r-1]&&t.push(o[n-1][r-1]),o[n+1]&&o[n+1][r-1]&&t.push(o[n+1][r-1]),o[n-1]&&o[n-1][r+1]&&t.push(o[n-1][r+1]),o[n+1]&&o[n+1][r+1]&&t.push(o[n+1][r+1])),t};Tx.prototype.toString=function(){for(var e=[],t=this.grid,n,r,o,a,s=0,u=t.length;s<u;s++){for(n=[],r=t[s],o=0,a=r.length;o<a;o++)n.push(r[o].weight);e.push(n.join(" "))}return e.join(`
`)};function OP(e,t,n){this.x=e,this.y=t,this.weight=n}OP.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};OP.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};OP.prototype.isWall=function(){return this.weight===0};function GX(e){this.content=[],this.scoreFunction=e}GX.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r))this.content[n]=t,this.content[e]=r,e=n;else break}},bubbleUp:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,a=o-1,s=null,u;if(a<t){var l=this.content[a];u=this.scoreFunction(l),u<r&&(s=a)}if(o<t){var c=this.content[o],f=this.scoreFunction(c);f<(s===null?r:u)&&(s=o)}if(s!==null)this.content[e]=this.content[s],this.content[s]=n,e=s;else break}}};function T1e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.resolution,o=n.minDistance,a=n.obstacles||Vt([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(r&&!ci(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(o)throw new Error("options.minDistance is not yet implemented");var s=so(e),u=so(t);switch(e=kr(s),t=kr(u),Bi(a)){case"FeatureCollection":if(a.features.length===0)return Ni([s,u]);break;case"Polygon":a=Vt([aa(Hl(a))]);break;default:throw new Error("invalid obstacles")}var l=a;l.features.push(e),l.features.push(t);var c=wa(MX(eB(wa(l)),1.15));if(!r){var f=li([c[0],c[1]],[c[2],c[1]],n);r=f/100}l.features.pop(),l.features.pop();for(var h=c[0],d=c[1],p=c[2],_=c[3],y=r/li([h,d],[p,d],n),v=y*(p-h),w=r/li([h,d],[h,_],n),C=w*(_-d),E=p-h,S=_-d,A=Math.floor(E/v),D=Math.floor(S/C),P=(E-A*v)/2,M=(S-D*C)/2,b=[],O=[],m=[],I=[],L=1/0,R=1/0,N=_-M,B=0;N>=d;){for(var V=[],z=[],U=h+P,Q=0;U<=p;){var ne=kr([U,N]),se=S1e(ne,a);V.push(se?0:1),z.push(U+"|"+N);var de=li(ne,e);!se&&de<L&&(L=de,m={x:Q,y:B});var pe=li(ne,t);!se&&pe<R&&(R=pe,I={x:Q,y:B}),U+=v,Q++}O.push(V),b.push(z),N-=C,B++}var ve=new Tx(O,{diagonal:!0}),ft=ve.grid[m.y][m.x],pt=ve.grid[I.y][I.x],Xt=RP.search(ve,ft,pt),At=[s];return Xt.forEach(function(wt){var Rr=b[wt.x][wt.y].split("|");At.push([+Rr[0],+Rr[1]])}),At.push(u),Wm(Ni(At))}function S1e(e,t){for(var n=0;n<t.features.length;n++)if(Co(e,t.features[n]))return!0;return!1}var cY=function(e){return function(){return e}};function A1e(e){return e[0]}function b1e(e){return e[1]}function hP(){this._=null}function NP(e){e.U=e.C=e.L=e.R=e.P=e.N=null}hP.prototype={constructor:hP,insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=fY(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(o=r.R,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(uT(this,n),e=n,n=e.U),n.C=!1,r.C=!0,lT(this,r))):(o=r.L,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(lT(this,n),e=n,n=e.U),n.C=!1,r.C=!0,uT(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,o=e.R,a,s;if(r?o?a=fY(o):a=r:a=o,t?t.L===e?t.L=a:t.R=a:this._=a,r&&o?(s=a.C,a.C=e.C,a.L=r,r.U=a,a!==o?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=o,o.U=a):(a.U=t,t=a,e=a.R)):(s=e.C,e=a),e&&(e.U=t),!s){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,uT(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,lT(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,uT(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,lT(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,uT(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,lT(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function uT(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function lT(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function fY(e){for(;e.L;)e=e.L;return e}function yT(e,t,n,r){var o=[null,null],a=ll.push(o)-1;return o.left=e,o.right=t,n&&dP(o,e,t,n),r&&dP(o,t,e,r),nf[e.index].halfedges.push(a),nf[t.index].halfedges.push(a),o}function cT(e,t,n){var r=[t,n];return r.left=e,r}function dP(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function I1e(e,t,n,r,o){var a=e[0],s=e[1],u=a[0],l=a[1],c=s[0],f=s[1],h=0,d=1,p=c-u,_=f-l,y;if(y=t-u,!(!p&&y>0)){if(y/=p,p<0){if(y<h)return;y<d&&(d=y)}else if(p>0){if(y>d)return;y>h&&(h=y)}if(y=r-u,!(!p&&y<0)){if(y/=p,p<0){if(y>d)return;y>h&&(h=y)}else if(p>0){if(y<h)return;y<d&&(d=y)}if(y=n-l,!(!_&&y>0)){if(y/=_,_<0){if(y<h)return;y<d&&(d=y)}else if(_>0){if(y>d)return;y>h&&(h=y)}if(y=o-l,!(!_&&y<0)){if(y/=_,_<0){if(y>d)return;y>h&&(h=y)}else if(_>0){if(y<h)return;y<d&&(d=y)}return!(h>0)&&!(d<1)||(h>0&&(e[0]=[u+h*p,l+h*_]),d<1&&(e[1]=[u+d*p,l+d*_])),!0}}}}}function D1e(e,t,n,r,o){var a=e[1];if(a)return!0;var s=e[0],u=e.left,l=e.right,c=u[0],f=u[1],h=l[0],d=l[1],p=(c+h)/2,_=(f+d)/2,y,v;if(d===f){if(p<t||p>=r)return;if(c>h){if(!s)s=[p,n];else if(s[1]>=o)return;a=[p,o]}else{if(!s)s=[p,o];else if(s[1]<n)return;a=[p,n]}}else if(y=(c-h)/(d-f),v=_-y*p,y<-1||y>1)if(c>h){if(!s)s=[(n-v)/y,n];else if(s[1]>=o)return;a=[(o-v)/y,o]}else{if(!s)s=[(o-v)/y,o];else if(s[1]<n)return;a=[(n-v)/y,n]}else if(f<d){if(!s)s=[t,y*t+v];else if(s[0]>=r)return;a=[r,y*r+v]}else{if(!s)s=[r,y*r+v];else if(s[0]<t)return;a=[t,y*t+v]}return e[0]=s,e[1]=a,!0}function P1e(e,t,n,r){for(var o=ll.length,a;o--;)(!D1e(a=ll[o],e,t,n,r)||!I1e(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>ao||Math.abs(a[0][1]-a[1][1])>ao))&&delete ll[o]}function M1e(e){return nf[e.index]={site:e,halfedges:[]}}function L1e(e,t){var n=e.site,r=t.left,o=t.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=t[1],o=t[0]):(r=t[0],o=t[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function UX(e,t){return t[+(t.left!==e.site)]}function R1e(e,t){return t[+(t.left===e.site)]}function O1e(){for(var e=0,t=nf.length,n,r,o,a;e<t;++e)if((n=nf[e])&&(a=(r=n.halfedges).length)){var s=new Array(a),u=new Array(a);for(o=0;o<a;++o)s[o]=o,u[o]=L1e(n,ll[r[o]]);for(s.sort(function(l,c){return u[c]-u[l]}),o=0;o<a;++o)u[o]=r[s[o]];for(o=0;o<a;++o)r[o]=u[o]}}function N1e(e,t,n,r){var o=nf.length,a,s,u,l,c,f,h,d,p,_,y,v,w=!0;for(a=0;a<o;++a)if(s=nf[a]){for(u=s.site,c=s.halfedges,l=c.length;l--;)ll[c[l]]||c.splice(l,1);for(l=0,f=c.length;l<f;)_=R1e(s,ll[c[l]]),y=_[0],v=_[1],h=UX(s,ll[c[++l%f]]),d=h[0],p=h[1],(Math.abs(y-d)>ao||Math.abs(v-p)>ao)&&(c.splice(l,0,ll.push(cT(u,_,Math.abs(y-e)<ao&&r-v>ao?[e,Math.abs(d-e)<ao?p:r]:Math.abs(v-r)<ao&&n-y>ao?[Math.abs(p-r)<ao?d:n,r]:Math.abs(y-n)<ao&&v-t>ao?[n,Math.abs(d-n)<ao?p:t]:Math.abs(v-t)<ao&&y-e>ao?[Math.abs(p-t)<ao?d:e,t]:null))-1),++f);f&&(w=!1)}if(w){var C,E,S,A=1/0;for(a=0,w=null;a<o;++a)(s=nf[a])&&(u=s.site,C=u[0]-e,E=u[1]-t,S=C*C+E*E,S<A&&(A=S,w=s));if(w){var D=[e,t],P=[e,r],M=[n,r],b=[n,t];w.halfedges.push(ll.push(cT(u=w.site,D,P))-1,ll.push(cT(u,P,M))-1,ll.push(cT(u,M,b))-1,ll.push(cT(u,b,D))-1)}}for(a=0;a<o;++a)(s=nf[a])&&(s.halfedges.length||delete nf[a])}var HX=[],gB;function B1e(){NP(this),this.x=this.y=this.arc=this.site=this.cy=null}function jC(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,o=e.site,a=n.site;if(r!==a){var s=o[0],u=o[1],l=r[0]-s,c=r[1]-u,f=a[0]-s,h=a[1]-u,d=2*(l*h-c*f);if(!(d>=-G1e)){var p=l*l+c*c,_=f*f+h*h,y=(h*p-c*_)/d,v=(l*_-f*p)/d,w=HX.pop()||new B1e;w.arc=e,w.site=o,w.x=y+s,w.y=(w.cy=v+u)+Math.sqrt(y*y+v*v),e.circle=w;for(var C=null,E=PT._;E;)if(w.y<E.y||w.y===E.y&&w.x<=E.x)if(E.L)E=E.L;else{C=E.P;break}else if(E.R)E=E.R;else{C=E;break}PT.insert(C,w),C||(gB=w)}}}}function ZC(e){var t=e.circle;t&&(t.P||(gB=t.N),PT.remove(t),HX.push(t),NP(t),e.circle=null)}var qX=[];function F1e(){NP(this),this.edge=this.site=this.circle=null}function hY(e){var t=qX.pop()||new F1e;return t.site=e,t}function C3(e){ZC(e),QC.remove(e),qX.push(e),NP(e)}function z1e(e){var t=e.circle,n=t.x,r=t.cy,o=[n,r],a=e.P,s=e.N,u=[e];C3(e);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<ao&&Math.abs(r-l.circle.cy)<ao;)a=l.P,u.unshift(l),C3(l),l=a;u.unshift(l),ZC(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<ao&&Math.abs(r-c.circle.cy)<ao;)s=c.N,u.push(c),C3(c),c=s;u.push(c),ZC(c);var f=u.length,h;for(h=1;h<f;++h)c=u[h],l=u[h-1],dP(c.edge,l.site,c.site,o);l=u[0],c=u[f-1],c.edge=yT(l.site,c.site,null,o),jC(l),jC(c)}function V1e(e){for(var t=e[0],n=e[1],r,o,a,s,u=QC._;u;)if(a=WX(u,n)-t,a>ao)u=u.L;else if(s=t-k1e(u,n),s>ao){if(!u.R){r=u;break}u=u.R}else{a>-ao?(r=u.P,o=u):s>-ao?(r=u,o=u.N):r=o=u;break}M1e(e);var l=hY(e);if(QC.insert(r,l),!(!r&&!o)){if(r===o){ZC(r),o=hY(r.site),QC.insert(l,o),l.edge=o.edge=yT(r.site,l.site),jC(r),jC(o);return}if(!o){l.edge=yT(r.site,l.site);return}ZC(r),ZC(o);var c=r.site,f=c[0],h=c[1],d=e[0]-f,p=e[1]-h,_=o.site,y=_[0]-f,v=_[1]-h,w=2*(d*v-p*y),C=d*d+p*p,E=y*y+v*v,S=[(v*C-p*E)/w+f,(d*E-y*C)/w+h];dP(o.edge,c,_,S),l.edge=yT(c,e,null,S),o.edge=yT(e,_,null,S),jC(r),jC(o)}}function WX(e,t){var n=e.site,r=n[0],o=n[1],a=o-t;if(!a)return r;var s=e.P;if(!s)return-1/0;n=s.site;var u=n[0],l=n[1],c=l-t;if(!c)return u;var f=u-r,h=1/a-1/c,d=f/c;return h?(-d+Math.sqrt(d*d-2*h*(f*f/(-2*c)-l+c/2+o-a/2)))/h+r:(r+u)/2}function k1e(e,t){var n=e.N;if(n)return WX(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var ao=1e-6,G1e=1e-12,QC,nf,PT,ll;function U1e(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function H1e(e,t){return t[1]-e[1]||t[0]-e[0]}function F3(e,t){var n=e.sort(H1e).pop(),r,o,a;for(ll=[],nf=new Array(e.length),QC=new hP,PT=new hP;;)if(a=gB,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==o)&&(V1e(n),r=n[0],o=n[1]),n=e.pop();else if(a)z1e(a.arc);else break;if(O1e(),t){var s=+t[0][0],u=+t[0][1],l=+t[1][0],c=+t[1][1];P1e(s,u,l,c),N1e(s,u,l,c)}this.edges=ll,this.cells=nf,QC=PT=ll=nf=null}F3.prototype={constructor:F3,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return UX(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(!!(u=(a=n.halfedges).length))for(var o=n.site,a,s=-1,u,l,c=t[a[u-1]],f=c.left===o?c.right:c.left;++s<u;)l=f,c=t[a[s]],f=c.left===o?c.right:c.left,l&&f&&r<l.index&&r<f.index&&U1e(o,l,f)<0&&e.push([o.data,l.data,f.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,o,a=r._found||0,s=r.cells.length,u;!(u=r.cells[a]);)if(++a>=s)return null;var l=e-u.site[0],c=t-u.site[1],f=l*l+c*c;do u=r.cells[o=a],a=null,u.halfedges.forEach(function(h){var d=r.edges[h],p=d.left;if(!((p===u.site||!p)&&!(p=d.right))){var _=e-p[0],y=t-p[1],v=_*_+y*y;v<f&&(f=v,a=p.index)}});while(a!==null);return r._found=o,n==null||f<=n*n?u.site:null}};var q1e=function(){var e=A1e,t=b1e,n=null;function r(o){return new F3(o.map(function(a,s){var u=[Math.round(e(a,s,o)/ao)*ao,Math.round(t(a,s,o)/ao)*ao];return u.index=s,u.data=a,u}),n)}return r.polygons=function(o){return r(o).polygons()},r.links=function(o){return r(o).links()},r.triangles=function(o){return r(o).triangles()},r.x=function(o){return arguments.length?(e=typeof o=="function"?o:cY(+o),r):e},r.y=function(o){return arguments.length?(t=typeof o=="function"?o:cY(+o),r):t},r.extent=function(o){return arguments.length?(n=o==null?null:[[+o[0][0],+o[0][1]],[+o[1][0],+o[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(o){return arguments.length?(n=o==null?null:[[0,0],[+o[0],+o[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r};function W1e(e){return e=e.slice(),e.push(e[0]),Pn([e])}function Y1e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return Sd(e,"Point","points"),Vt(q1e().x(function(r){return r.geometry.coordinates[0]}).y(function(r){return r.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(W1e))}function YX(e,t,n,r){r=r||{};var o=r.steps||64,a=r.units||"kilometers",s=r.angle||0,u=r.pivot||e,l=r.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!gt(r))throw new Error("options must be an object");if(!ci(o))throw new Error("steps must be a number");if(!ci(s))throw new Error("angle must be a number");var c=so(e);if(a==="degrees")var f=Ya(s);else t=ex(e,t,90,{units:a}),n=ex(e,n,0,{units:a}),t=so(t)[0]-c[0],n=so(n)[1]-c[1];for(var h=[],d=0;d<o;d+=1){var p=d*-360/o,_=t*n/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)*Math.pow(dY(p),2)),y=t*n/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)/Math.pow(dY(p),2));if(p<-90&&p>=-270&&(_=-_),p<-180&&p>=-360&&(y=-y),a==="degrees"){var v=_*Math.cos(f)+y*Math.sin(f),w=y*Math.cos(f)-_*Math.sin(f);_=v,y=w}h.push([_+c[0],y+c[1]])}return h.push(h[0]),a==="degrees"?Pn([h],l):PX(Pn([h],l),s,{pivot:u})}function dY(e){var t=e*Math.PI/180;return Math.tan(t)}function _B(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=t.weight;if(!e)throw new Error("geojson is required");var o=0,a=0,s=0;return ch(e,function(u,l,c){var f=c[r];if(f=f??1,!ci(f))throw new Error("weight value must be a number for feature index "+l);f=Number(f),f>0&&Xa(u,function(h){o+=h[0]*f,a+=h[1]*f,s+=f})}),kr([o/s,a/s],n)}function X1e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.counter||10;if(!ci(n))throw new Error("counter must be a number");var r=t.weight,o=_B(e,{weight:t.weight}),a=Vt([]);return fi(e,function(s){a.features.push(dy(s,{weight:s.properties[r]}))}),a.properties={tolerance:t.tolerance,medianCandidates:[]},XX(o.geometry.coordinates,[0,0],a,n)}function XX(e,t,n,r){var o=n.properties.tolerance||.001,a=0,s=0,u=0,l=0;if(fi(n,function(h){var d=h.properties.weight,p=d??1;if(p=Number(p),!ci(p))throw new Error("weight value must be a number");if(p>0){l+=1;var _=p*li(h,e);_===0&&(_=1);var y=p/_;a+=h.geometry.coordinates[0]*y,s+=h.geometry.coordinates[1]*y,u+=y}}),l<1)throw new Error("no features to measure");var c=a/u,f=s/u;return l===1||r===0||Math.abs(c-t[0])<o&&Math.abs(f-t[1])<o?kr([c,f],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,f]),XX([c,f],e,n,r-1))}function j1e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.steps||64,r=t.weight,o=t.properties||{};if(!ci(n))throw new Error("steps must be a number");if(!gt(o))throw new Error("properties must be a number");var a=Ep(e).length,s=_B(e,{weight:r}),u=0,l=0,c=0;fi(e,function(P){var M=P.properties[r]||1,b=pY(Tt(P),Tt(s));u+=Math.pow(b.x,2)*M,l+=Math.pow(b.y,2)*M,c+=b.x*b.y*M});var f=u-l,h=Math.sqrt(Math.pow(f,2)+4*Math.pow(c,2)),d=2*c,p=Math.atan((f+h)/d),_=p*180/Math.PI,y=0,v=0,w=0;fi(e,function(P){var M=P.properties[r]||1,b=pY(Tt(P),Tt(s));y+=Math.pow(b.x*Math.cos(p)-b.y*Math.sin(p),2)*M,v+=Math.pow(b.x*Math.sin(p)+b.y*Math.cos(p),2)*M,w+=M});var C=Math.sqrt(2*y/w),E=Math.sqrt(2*v/w),S=YX(s,C,E,{units:"degrees",angle:_,steps:n,properties:o}),A=T3(e,Vt([S])),D={meanCenterCoordinates:Tt(s),semiMajorAxis:C,semiMinorAxis:E,numberOfFeatures:a,angle:_,percentageWithinEllipse:100*Ep(A).length/a};return S.properties.standardDeviationalEllipse=D,S}function pY(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function ZT(e){if(gt(e)&&(e=e.bbox),e&&!Array.isArray(e))throw new Error("bbox is invalid");return e?J1e(e):[Z1e(),Q1e()]}function jX(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox;e==null&&(e=1);for(var r=[],o=0;o<e;o++)r.push(kr(ZT(n)));return Vt(r)}function KX(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_radial_length;e==null&&(e=1),ci(r)||(r=10),ci(o)||(o=10);for(var a=[],s=0;s<e;s++){var u=[],l=Array.apply(null,new Array(r+1)).map(Math.random);l.forEach(c),l.forEach(f),u[u.length-1]=u[0],u=u.map(K1e(ZT(n))),a.push(Pn([u]))}function c(h,d,p){p[d]=d>0?h+p[d-1]:h}function f(h){h=h*2*Math.PI/l[l.length-1];var d=Math.random();u.push([d*o*Math.sin(h),d*o*Math.cos(h)])}return Vt(a)}function ZX(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_length,a=t.max_rotation;e==null&&(e=1),(!ci(r)||r<2)&&(r=10),ci(o)||(o=1e-4),ci(a)||(a=Math.PI/8);for(var s=[],u=0;u<e;u++){for(var l=ZT(n),c=[l],f=0;f<r-1;f++){var h=f===0?Math.random()*2*Math.PI:Math.tan((c[f][1]-c[f-1][1])/(c[f][0]-c[f-1][0])),d=h+(Math.random()-.5)*a*2,p=Math.random()*o;c.push([c[f][0]+p*Math.cos(d),c[f][1]+p*Math.sin(d)])}s.push(Ni(c))}return Vt(s)}function K1e(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function QX(){return Math.random()-.5}function Z1e(){return QX()*360}function Q1e(){return QX()*180}function J1e(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var $1e=Object.freeze({randomPosition:ZT,randomPoint:jX,randomPolygon:KX,randomLineString:ZX});function JX(e,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var n=[];return fi(e,function(r){BP(r.properties,t)&&n.push(r)}),Vt(n)}function yB(e,t,n){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var r=vB(e,t),o=Object.keys(r),a=0;a<o.length;a++){for(var s=o[a],u=r[s],l=[],c=0;c<u.length;c++)l.push(e.features[u[c]]);n(Vt(l),s,a)}}function $X(e,t,n,r){var o=r;return yB(e,t,function(a,s,u){u===0&&r===void 0?o=a:o=n(o,a,s,u)}),o}function vB(e,t){var n={};return fi(e,function(r,o){var a=r.properties||{};if(a.hasOwnProperty(t)){var s=a[t];n.hasOwnProperty(s)?n[s].push(o):n[s]=[o]}}),n}function BP(e,t){if(e===void 0)return!1;var n=typeof t;if(n==="number"||n==="string")return e.hasOwnProperty(t);if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(!BP(e,t[r]))return!1;return!0}else return CB(e,t)}function CB(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];if(e[o]!==t[o])return!1}return!0}function ej(e,t){if(!t)return{};if(!t.length)return{};for(var n={},r=0;r<t.length;r++){var o=t[r];e.hasOwnProperty(o)&&(n[o]=e[o])}return n}var ewe=Object.freeze({getCluster:JX,clusterEach:yB,clusterReduce:$X,createBins:vB,applyFilter:BP,propertiesContainsFilter:CB,filterProperties:ej});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(a=a<0?Math.max(r+arguments[2],0):Math.min(a,r);o<a;)n[o]=t,++o;return n},writable:!0});Number.isFinite=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)};Number.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(e){return e!==e};Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var my=function(){};my.prototype.interfaces_=function(){return[]};my.prototype.getClass=function(){return my};my.prototype.equalsWithTolerance=function(t,n,r){return Math.abs(t-n)<=r};var uo=function(){},Kt=function(){},tj={MAX_VALUE:{configurable:!0}};Kt.isNaN=function(t){return Number.isNaN(t)};Kt.doubleToLongBits=function(t){return t};Kt.longBitsToDouble=function(t){return t};Kt.isInfinite=function(t){return!Number.isFinite(t)};tj.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Kt,tj);var Dc=function(){},FP=function(){},tx=function(){};function Pc(){}var oe=function e(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},by={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};oe.prototype.setOrdinate=function(t,n){switch(t){case oe.X:this.x=n;break;case oe.Y:this.y=n;break;case oe.Z:this.z=n;break;default:throw new uo("Invalid ordinate index: "+t)}};oe.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!my.equalsWithTolerance(this.x,n.x,r)||!my.equalsWithTolerance(this.y,n.y,r))}};oe.prototype.getOrdinate=function(t){switch(t){case oe.X:return this.x;case oe.Y:return this.y;case oe.Z:return this.z;default:}throw new uo("Invalid ordinate index: "+t)};oe.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Kt.isNaN(this.z))&&Kt.isNaN(t.z)};oe.prototype.equals=function(t){return t instanceof oe?this.equals2D(t):!1};oe.prototype.equalInZ=function(t,n){return my.equalsWithTolerance(this.z,t.z,n)};oe.prototype.compareTo=function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};oe.prototype.clone=function(){};oe.prototype.copy=function(){return new oe(this)};oe.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};oe.prototype.distance3D=function(t){var n=this.x-t.x,r=this.y-t.y,o=this.z-t.z;return Math.sqrt(n*n+r*r+o*o)};oe.prototype.distance=function(t){var n=this.x-t.x,r=this.y-t.y;return Math.sqrt(n*n+r*r)};oe.prototype.hashCode=function(){var t=17;return t=37*t+oe.hashCode(this.x),t=37*t+oe.hashCode(this.y),t};oe.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};oe.prototype.interfaces_=function(){return[Dc,FP,Pc]};oe.prototype.getClass=function(){return oe};oe.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=Kt.doubleToLongBits(t);return Math.trunc((n^n)>>>32)}};by.DimensionalComparator.get=function(){return Um};by.serialVersionUID.get=function(){return 6683108902428367e3};by.NULL_ORDINATE.get=function(){return Kt.NaN};by.X.get=function(){return 0};by.Y.get=function(){return 1};by.Z.get=function(){return 2};Object.defineProperties(oe,by);var Um=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new uo("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Um.prototype.compare=function(t,n){var r=t,o=n,a=Um.compare(r.x,o.x);if(a!==0)return a;var s=Um.compare(r.y,o.y);if(s!==0)return s;if(this._dimensionsToTest<=2)return 0;var u=Um.compare(r.z,o.z);return u};Um.prototype.interfaces_=function(){return[tx]};Um.prototype.getClass=function(){return Um};Um.compare=function(t,n){return t<n?-1:t>n?1:Kt.isNaN(t)?Kt.isNaN(n)?0:-1:Kt.isNaN(n)?1:0};var nx=function(){};nx.prototype.create=function(){};nx.prototype.interfaces_=function(){return[]};nx.prototype.getClass=function(){return nx};var fe=function(){},QT={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};fe.prototype.interfaces_=function(){return[]};fe.prototype.getClass=function(){return fe};fe.toLocationSymbol=function(t){switch(t){case fe.EXTERIOR:return"e";case fe.BOUNDARY:return"b";case fe.INTERIOR:return"i";case fe.NONE:return"-";default:}throw new uo("Unknown location value: "+t)};QT.INTERIOR.get=function(){return 0};QT.BOUNDARY.get=function(){return 1};QT.EXTERIOR.get=function(){return 2};QT.NONE.get=function(){return-1};Object.defineProperties(fe,QT);var Rt=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},ql=function(){},nj={LOG_10:{configurable:!0}};ql.prototype.interfaces_=function(){return[]};ql.prototype.getClass=function(){return ql};ql.log10=function(t){var n=Math.log(t);return Kt.isInfinite(n)||Kt.isNaN(n)?n:n/ql.LOG_10};ql.min=function(t,n,r,o){var a=t;return n<a&&(a=n),r<a&&(a=r),o<a&&(a=o),a};ql.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],r=arguments[2];return t<n?n:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1],s=arguments[2];return o<a?a:o>s?s:o}};ql.wrap=function(t,n){return t<0?n- -t%n:t%n};ql.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2],o=t;return n>o&&(o=n),r>o&&(o=r),o}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=a;return s>c&&(c=s),u>c&&(c=u),l>c&&(c=l),c}};ql.average=function(t,n){return(t+n)/2};nj.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(ql,nj);var fh=function(t){this.str=t};fh.prototype.append=function(t){this.str+=t};fh.prototype.setCharAt=function(t,n){this.str=this.str.substr(0,t)+n+this.str.substr(t+1)};fh.prototype.toString=function(t){return this.str};var eh=function(t){this.value=t};eh.prototype.intValue=function(){return this.value};eh.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};eh.isNaN=function(t){return Number.isNaN(t)};var MT=function(){};MT.isWhitespace=function(t){return t<=32&&t>=0||t===127};MT.toUpperCase=function(t){return t.toUpperCase()};var me=function e(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];e.call(this,e.parse(r))}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.init(o,a)}},df={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};me.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};me.prototype.extractSignificantDigits=function(t,n){var r=this.abs(),o=me.magnitude(r._hi),a=me.TEN.pow(o);r=r.divide(a),r.gt(me.TEN)?(r=r.divide(me.TEN),o+=1):r.lt(me.ONE)&&(r=r.multiply(me.TEN),o-=1);for(var s=o+1,u=new fh,l=me.MAX_PRINT_DIGITS-1,c=0;c<=l;c++){t&&c===s&&u.append(".");var f=Math.trunc(r._hi);if(f<0)break;var h=!1,d=0;f>9?(h=!0,d="9"):d="0"+f,u.append(d),r=r.subtract(me.valueOf(f)).multiply(me.TEN),h&&r.selfAdd(me.TEN);var p=!0,_=me.magnitude(r._hi);if(_<0&&Math.abs(_)>=l-c&&(p=!1),!p)break}return n[0]=o,u.toString()};me.prototype.sqr=function(){return this.multiply(this)};me.prototype.doubleValue=function(){return this._hi+this._lo};me.prototype.subtract=function(){if(arguments[0]instanceof me){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};me.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};me.prototype.isZero=function(){return this._hi===0&&this._lo===0};me.prototype.selfSubtract=function(){if(arguments[0]instanceof me){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};me.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};me.prototype.min=function(t){return this.le(t)?this:t};me.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof me){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null,h=null,d=null;return c=this._hi/r,f=me.SPLIT*c,a=f-c,d=me.SPLIT*r,a=f-a,s=c-a,u=d-r,h=c*r,u=d-u,l=r-u,d=a*u-h+a*l+s*u+s*l,f=(this._hi-h-d+this._lo-c*o)/r,d=c+f,this._hi=d,this._lo=c-d+f,this}};me.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};me.prototype.divide=function(){if(arguments[0]instanceof me){var t=arguments[0],n=null,r=null,o=null,a=null,s=null,u=null,l=null,c=null;s=this._hi/t._hi,u=me.SPLIT*s,n=u-s,c=me.SPLIT*t._hi,n=u-n,r=s-n,o=c-t._hi,l=s*t._hi,o=c-o,a=t._hi-o,c=n*o-l+n*a+r*o+r*a,u=(this._hi-l-c+this._lo-s*t._lo)/t._hi,c=s+u;var f=c,h=s-c+u;return new me(f,h)}else if(typeof arguments[0]=="number"){var d=arguments[0];return Kt.isNaN(d)?me.createNaN():me.copy(this).selfDivide(d,0)}};me.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};me.prototype.pow=function(t){if(t===0)return me.valueOf(1);var n=new me(this),r=me.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2===1&&r.selfMultiply(n),o/=2,o>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r};me.prototype.ceil=function(){if(this.isNaN())return me.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new me(t,n)};me.prototype.compareTo=function(t){var n=t;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};me.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};me.prototype.setValue=function(){if(arguments[0]instanceof me){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};me.prototype.max=function(t){return this.ge(t)?this:t};me.prototype.sqrt=function(){if(this.isZero())return me.valueOf(0);if(this.isNegative())return me.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=me.valueOf(n),o=this.subtract(r.sqr()),a=o._hi*(t*.5);return r.add(a)};me.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof me){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,o=null,a=null,s=null,u=null,l=null;return a=this._hi+n,u=a-this._hi,s=a-u,s=n-u+(this._hi-s),l=s+this._lo,r=a+l,o=l+(a-r),this._hi=r+o,this._lo=o+(r-this._hi),this}}else if(arguments.length===2){var c=arguments[0],f=arguments[1],h=null,d=null,p=null,_=null,y=null,v=null,w=null,C=null;y=this._hi+c,p=this._lo+f,w=y-this._hi,C=p-this._lo,v=y-w,_=p-C,v=c-w+(this._hi-v),_=f-C+(this._lo-_),w=v+p,h=y+w,d=w+(y-h),w=_+d;var E=h+w,S=w+(h-E);return this._hi=E,this._lo=S,this}};me.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof me){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null;c=me.SPLIT*this._hi,a=c-this._hi,f=me.SPLIT*r,a=c-a,s=this._hi-a,u=f-r,c=this._hi*r,u=f-u,l=r-u,f=a*u-c+a*l+s*u+s*l+(this._hi*o+this._lo*r);var h=c+f;a=c-h;var d=f+a;return this._hi=h,this._lo=d,this}};me.prototype.selfSqr=function(){return this.selfMultiply(this)};me.prototype.floor=function(){if(this.isNaN())return me.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new me(t,n)};me.prototype.negate=function(){return this.isNaN()?this:new me(-this._hi,-this._lo)};me.prototype.clone=function(){};me.prototype.multiply=function(){if(arguments[0]instanceof me){var t=arguments[0];return t.isNaN()?me.createNaN():me.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Kt.isNaN(n)?me.createNaN():me.copy(this).selfMultiply(n,0)}};me.prototype.isNaN=function(){return Kt.isNaN(this._hi)};me.prototype.intValue=function(){return Math.trunc(this._hi)};me.prototype.toString=function(){var t=me.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};me.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),o=n[0]+1,a=r;if(r.charAt(0)===".")a="0"+r;else if(o<0)a="0."+me.stringOfChar("0",-o)+r;else if(r.indexOf(".")===-1){var s=o-r.length,u=me.stringOfChar("0",s);a=r+u+".0"}return this.isNegative()?"-"+a:a};me.prototype.reciprocal=function(){var t=null,n=null,r=null,o=null,a=null,s=null,u=null,l=null;a=1/this._hi,s=me.SPLIT*a,t=s-a,l=me.SPLIT*this._hi,t=s-t,n=a-t,r=l-this._hi,u=a*this._hi,r=l-r,o=this._hi-r,l=t*r-u+t*o+n*r+n*o,s=(1-u-l-a*this._lo)/this._hi;var c=a+s,f=a-c+s;return new me(c,f)};me.prototype.toSciNotation=function(){if(this.isZero())return me.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),o=me.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var a="";r.length>1&&(a=r.substring(1));var s=r.charAt(0)+"."+a;return this.isNegative()?"-"+s+o:s+o};me.prototype.abs=function(){return this.isNaN()?me.NaN:this.isNegative()?this.negate():new me(this)};me.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};me.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};me.prototype.add=function(){if(arguments[0]instanceof me){var t=arguments[0];return me.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return me.copy(this).selfAdd(n)}};me.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof me){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._hi=r,this._lo=o}};me.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};me.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};me.prototype.trunc=function(){return this.isNaN()?me.NaN:this.isPositive()?this.floor():this.ceil()};me.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};me.prototype.interfaces_=function(){return[Pc,Dc,FP]};me.prototype.getClass=function(){return me};me.sqr=function(t){return me.valueOf(t).selfMultiply(t)};me.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return me.parse(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new me(n)}};me.sqrt=function(t){return me.valueOf(t).sqrt()};me.parse=function(t){for(var n=0,r=t.length;MT.isWhitespace(t.charAt(n));)n++;var o=!1;if(n<r){var a=t.charAt(n);(a==="-"||a==="+")&&(n++,a==="-"&&(o=!0))}for(var s=new me,u=0,l=0,c=0;!(n>=r);){var f=t.charAt(n);if(n++,MT.isDigit(f)){var h=f-"0";s.selfMultiply(me.TEN),s.selfAdd(h),u++;continue}if(f==="."){l=u;continue}if(f==="e"||f==="E"){var d=t.substring(n);try{c=eh.parseInt(d)}catch(w){throw w instanceof Error?new Error("Invalid exponent "+d+" in string "+t):w}finally{}break}throw new Error("Unexpected character '"+f+"' at position "+n+" in string "+t)}var p=s,_=u-l-c;if(_===0)p=s;else if(_>0){var y=me.TEN.pow(_);p=s.divide(y)}else if(_<0){var v=me.TEN.pow(-_);p=s.multiply(v)}return o?p.negate():p};me.createNaN=function(){return new me(Kt.NaN,Kt.NaN)};me.copy=function(t){return new me(t)};me.magnitude=function(t){var n=Math.abs(t),r=Math.log(n)/Math.log(10),o=Math.trunc(Math.floor(r)),a=Math.pow(10,o);return a*10<=n&&(o+=1),o};me.stringOfChar=function(t,n){for(var r=new fh,o=0;o<n;o++)r.append(t);return r.toString()};df.PI.get=function(){return new me(3.141592653589793,12246467991473532e-32)};df.TWO_PI.get=function(){return new me(6.283185307179586,24492935982947064e-32)};df.PI_2.get=function(){return new me(1.5707963267948966,6123233995736766e-32)};df.E.get=function(){return new me(2.718281828459045,14456468917292502e-32)};df.NaN.get=function(){return new me(Kt.NaN,Kt.NaN)};df.EPS.get=function(){return 123259516440783e-46};df.SPLIT.get=function(){return 134217729};df.MAX_PRINT_DIGITS.get=function(){return 32};df.TEN.get=function(){return me.valueOf(10)};df.ONE.get=function(){return me.valueOf(1)};df.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};df.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(me,df);var Vu=function(){},rj={DP_SAFE_EPSILON:{configurable:!0}};Vu.prototype.interfaces_=function(){return[]};Vu.prototype.getClass=function(){return Vu};Vu.orientationIndex=function(t,n,r){var o=Vu.orientationIndexFilter(t,n,r);if(o<=1)return o;var a=me.valueOf(n.x).selfAdd(-t.x),s=me.valueOf(n.y).selfAdd(-t.y),u=me.valueOf(r.x).selfAdd(-n.x),l=me.valueOf(r.y).selfAdd(-n.y);return a.selfMultiply(l).selfSubtract(s.selfMultiply(u)).signum()};Vu.signOfDet2x2=function(t,n,r,o){var a=t.multiply(o).selfSubtract(n.multiply(r));return a.signum()};Vu.intersection=function(t,n,r,o){var a=me.valueOf(o.y).selfSubtract(r.y).selfMultiply(me.valueOf(n.x).selfSubtract(t.x)),s=me.valueOf(o.x).selfSubtract(r.x).selfMultiply(me.valueOf(n.y).selfSubtract(t.y)),u=a.subtract(s),l=me.valueOf(o.x).selfSubtract(r.x).selfMultiply(me.valueOf(t.y).selfSubtract(r.y)),c=me.valueOf(o.y).selfSubtract(r.y).selfMultiply(me.valueOf(t.x).selfSubtract(r.x)),f=l.subtract(c),h=f.selfDivide(u).doubleValue(),d=me.valueOf(t.x).selfAdd(me.valueOf(n.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),p=me.valueOf(n.x).selfSubtract(t.x).selfMultiply(me.valueOf(t.y).selfSubtract(r.y)),_=me.valueOf(n.y).selfSubtract(t.y).selfMultiply(me.valueOf(t.x).selfSubtract(r.x)),y=p.subtract(_),v=y.selfDivide(u).doubleValue(),w=me.valueOf(r.y).selfAdd(me.valueOf(o.y).selfSubtract(r.y).selfMultiply(v)).doubleValue();return new oe(d,w)};Vu.orientationIndexFilter=function(t,n,r){var o=null,a=(t.x-r.x)*(n.y-r.y),s=(t.y-r.y)*(n.x-r.x),u=a-s;if(a>0){if(s<=0)return Vu.signum(u);o=a+s}else if(a<0){if(s>=0)return Vu.signum(u);o=-a-s}else return Vu.signum(u);var l=Vu.DP_SAFE_EPSILON*o;return u>=l||-u>=l?Vu.signum(u):2};Vu.signum=function(t){return t>0?1:t<0?-1:0};rj.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Vu,rj);var Tn=function(){},JT={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};JT.X.get=function(){return 0};JT.Y.get=function(){return 1};JT.Z.get=function(){return 2};JT.M.get=function(){return 3};Tn.prototype.setOrdinate=function(t,n,r){};Tn.prototype.size=function(){};Tn.prototype.getOrdinate=function(t,n){};Tn.prototype.getCoordinate=function(){};Tn.prototype.getCoordinateCopy=function(t){};Tn.prototype.getDimension=function(){};Tn.prototype.getX=function(t){};Tn.prototype.clone=function(){};Tn.prototype.expandEnvelope=function(t){};Tn.prototype.copy=function(){};Tn.prototype.getY=function(t){};Tn.prototype.toCoordinateArray=function(){};Tn.prototype.interfaces_=function(){return[FP]};Tn.prototype.getClass=function(){return Tn};Object.defineProperties(Tn,JT);var ij=function(){},Sx=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ij),ps=function(){};ps.arraycopy=function(t,n,r,o,a){for(var s=0,u=n;u<n+a;u++)r[o+s]=t[u],s++};ps.getProperty=function(t){return{"line.separator":`
`}[t]};var rf=function e(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var o=arguments[0],a=arguments[1];this.x=o.y*a.w-a.y*o.w,this.y=a.x*o.w-o.x*a.w,this.w=o.x*a.y-a.x*o.y}else if(arguments[0]instanceof oe&&arguments[1]instanceof oe){var s=arguments[0],u=arguments[1];this.x=s.y-u.y,this.y=u.x-s.x,this.w=s.x*u.y-u.x*s.y}}else if(arguments.length===3){var l=arguments[0],c=arguments[1],f=arguments[2];this.x=l,this.y=c,this.w=f}else if(arguments.length===4){var h=arguments[0],d=arguments[1],p=arguments[2],_=arguments[3],y=h.y-d.y,v=d.x-h.x,w=h.x*d.y-d.x*h.y,C=p.y-_.y,E=_.x-p.x,S=p.x*_.y-_.x*p.y;this.x=v*S-E*w,this.y=C*w-y*S,this.w=y*E-C*v}};rf.prototype.getY=function(){var t=this.y/this.w;if(Kt.isNaN(t)||Kt.isInfinite(t))throw new Sx;return t};rf.prototype.getX=function(){var t=this.x/this.w;if(Kt.isNaN(t)||Kt.isInfinite(t))throw new Sx;return t};rf.prototype.getCoordinate=function(){var t=new oe;return t.x=this.getX(),t.y=this.getY(),t};rf.prototype.interfaces_=function(){return[]};rf.prototype.getClass=function(){return rf};rf.intersection=function(t,n,r,o){var a=t.y-n.y,s=n.x-t.x,u=t.x*n.y-n.x*t.y,l=r.y-o.y,c=o.x-r.x,f=r.x*o.y-o.x*r.y,h=s*f-c*u,d=l*u-a*f,p=a*c-l*s,_=h/p,y=d/p;if(Kt.isNaN(_)||Kt.isInfinite(_)||Kt.isNaN(y)||Kt.isInfinite(y))throw new Sx;return new oe(_,y)};var lt=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof oe){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];this.init(a,s,u,l)}},oj={serialVersionUID:{configurable:!0}};lt.prototype.getArea=function(){return this.getWidth()*this.getHeight()};lt.prototype.equals=function(t){if(!(t instanceof lt))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};lt.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new lt;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new lt(n,o,r,a)};lt.prototype.isNull=function(){return this._maxx<this._minx};lt.prototype.getMaxX=function(){return this._maxx};lt.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof oe){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&o>=this._miny&&o<=this._maxy}};lt.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof lt){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof oe){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||o>this._maxy||o<this._miny)}};lt.prototype.getMinY=function(){return this._miny};lt.prototype.getMinX=function(){return this._minx};lt.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof oe){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=o,this._maxy=o):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}};lt.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t<n?t:n};lt.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};lt.prototype.compareTo=function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};lt.prototype.translate=function(t,n){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)};lt.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};lt.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};lt.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};lt.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n};lt.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};lt.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof lt){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof oe){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.covers(r,o)}};lt.prototype.centre=function(){return this.isNull()?null:new oe((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};lt.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof oe){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];a<s?(this._minx=a,this._maxx=s):(this._minx=s,this._maxx=a),u<l?(this._miny=u,this._maxy=l):(this._miny=l,this._maxy=u)}};lt.prototype.getMaxY=function(){return this._maxy};lt.prototype.distance=function(t){if(this.intersects(t))return 0;var n=0;this._maxx<t._minx?n=t._minx-this._maxx:this._minx>t._maxx&&(n=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};lt.prototype.hashCode=function(){var t=17;return t=37*t+oe.hashCode(this._minx),t=37*t+oe.hashCode(this._maxx),t=37*t+oe.hashCode(this._miny),t=37*t+oe.hashCode(this._maxy),t};lt.prototype.interfaces_=function(){return[Dc,Pc]};lt.prototype.getClass=function(){return lt};lt.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(t.x<n.x?t.x:n.x)&&r.x<=(t.x>n.x?t.x:n.x)&&r.y>=(t.y<n.y?t.y:n.y)&&r.y<=(t.y>n.y?t.y:n.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=Math.min(s.x,u.x),c=Math.max(s.x,u.x),f=Math.min(o.x,a.x),h=Math.max(o.x,a.x);return!(f>c||h<l||(l=Math.min(s.y,u.y),c=Math.max(s.y,u.y),f=Math.min(o.y,a.y),h=Math.max(o.y,a.y),f>c)||h<l)}};oj.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(lt,oj);var Xf={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},zP=function(t){this.geometryFactory=t||new dn};zP.prototype.read=function(t){var n,r,o;t=t.replace(/[\n\r]/g," ");var a=Xf.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(a=Xf.emptyTypeStr.exec(t),a[2]=void 0),a&&(r=a[1].toLowerCase(),o=a[2],KC[r]&&(n=KC[r].apply(this,[o]))),n===void 0)throw new Error("Could not parse WKT "+t);return n};zP.prototype.write=function(t){return this.extractGeometry(t)};zP.prototype.extractGeometry=function(t){var n=t.getGeometryType().toLowerCase();if(!yp[n])return null;var r=n.toUpperCase(),o;return t.isEmpty()?o=r+" EMPTY":o=r+"("+yp[n].apply(this,[t])+")",o};var yp={coordinate:function(t){return t.x+" "+t.y},point:function(t){return yp.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+yp.point.apply(n,[t._geometries[o]])+")");return r.join(",")},linestring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(yp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},linearring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(yp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},multilinestring:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+yp.linestring.apply(n,[t._geometries[o]])+")");return r.join(",")},polygon:function(t){var n=this,r=[];r.push("("+yp.linestring.apply(this,[t._shell])+")");for(var o=0,a=t._holes.length;o<a;++o)r.push("("+yp.linestring.apply(n,[t._holes[o]])+")");return r.join(",")},multipolygon:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+yp.polygon.apply(n,[t._geometries[o]])+")");return r.join(",")},geometrycollection:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push(n.extractGeometry(t._geometries[o]));return r.join(",")}},KC={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(Xf.spaces);return this.geometryFactory.createPoint(new oe(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,o=t.trim().split(","),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Xf.trimParens,"$1"),a.push(KC.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(a)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Xf.spaces),r.push(new oe(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Xf.spaces),r.push(new oe(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,o=t.trim().split(Xf.parenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Xf.trimParens,"$1"),a.push(KC.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(a)},polygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,o,a,s=t.trim().split(Xf.parenComma),u,l=[],c=0,f=s.length;c<f;++c)r=s[c].replace(Xf.trimParens,"$1"),o=KC.linestring.apply(n,[r]),a=n.geometryFactory.createLinearRing(o._points),c===0?u=a:l.push(a);return this.geometryFactory.createPolygon(u,l)},multipolygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,o=t.trim().split(Xf.doubleParenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Xf.trimParens,"$1"),a.push(KC.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(t){var n=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),o=[],a=0,s=r.length;a<s;++a)o.push(n.read(r[a]));return this.geometryFactory.createGeometryCollection(o)}},af=function(t){this.parser=new zP(t)};af.prototype.write=function(t){return this.parser.write(t)};af.toLineString=function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"};var Ap=function(e){function t(n){e.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),pP=function(e){function t(){if(e.call(this),arguments.length===0)e.call(this);else if(arguments.length===1){var n=arguments[0];e.call(this,n)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ap),on=function(){};on.prototype.interfaces_=function(){return[]};on.prototype.getClass=function(){return on};on.shouldNeverReachHere=function(){if(arguments.length===0)on.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new pP("Should never reach here"+(t!==null?": "+t:""))}};on.isTrue=function(){var t,n;if(arguments.length===1)t=arguments[0],on.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],n=arguments[1],!t))throw n===null?new pP:new pP(n)};on.equals=function(){var t,n,r;if(arguments.length===2)t=arguments[0],n=arguments[1],on.equals(t,n,null);else if(arguments.length===3&&(t=arguments[0],n=arguments[1],r=arguments[2],!n.equals(t)))throw new pP("Expected "+t+" but encountered "+n+(r!==null?": "+r:""))};var xo=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new oe,this._intPt[1]=new oe,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Iy={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};xo.prototype.getIndexAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intLineIndex[t][n]};xo.prototype.getTopologySummary=function(){var t=new fh;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};xo.prototype.computeIntersection=function(t,n,r,o){this._inputLines[0][0]=t,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,n,r,o)};xo.prototype.getIntersectionNum=function(){return this._result};xo.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);n>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};xo.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};xo.prototype.setPrecisionModel=function(t){this._precisionModel=t};xo.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[n][0])||t._intPt[r].equals2D(t._inputLines[n][1])))return!0;return!1}};xo.prototype.getIntersection=function(t){return this._intPt[t]};xo.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};xo.prototype.hasIntersection=function(){return this._result!==xo.NO_INTERSECTION};xo.prototype.getEdgeDistance=function(t,n){var r=xo.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1]);return r};xo.prototype.isCollinear=function(){return this._result===xo.COLLINEAR_INTERSECTION};xo.prototype.toString=function(){return af.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+af.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};xo.prototype.getEndpoint=function(t,n){return this._inputLines[t][n]};xo.prototype.isIntersection=function(t){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(t))return!0;return!1};xo.prototype.getIntersectionAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][n]]};xo.prototype.interfaces_=function(){return[]};xo.prototype.getClass=function(){return xo};xo.computeEdgeDistance=function(t,n,r){var o=Math.abs(r.x-n.x),a=Math.abs(r.y-n.y),s=-1;if(t.equals(n))s=0;else if(t.equals(r))o>a?s=o:s=a;else{var u=Math.abs(t.x-n.x),l=Math.abs(t.y-n.y);o>a?s=u:s=l,s===0&&!t.equals(n)&&(s=Math.max(u,l))}return on.isTrue(!(s===0&&!t.equals(n)),"Bad distance calculation"),s};xo.nonRobustComputeEdgeDistance=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=Math.sqrt(o*o+a*a);return on.isTrue(!(s===0&&!t.equals(n)),"Invalid distance calculation"),s};Iy.DONT_INTERSECT.get=function(){return 0};Iy.DO_INTERSECT.get=function(){return 1};Iy.COLLINEAR.get=function(){return 2};Iy.NO_INTERSECTION.get=function(){return 0};Iy.POINT_INTERSECTION.get=function(){return 1};Iy.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(xo,Iy);var B0=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var o=new lt(this._inputLines[0][0],this._inputLines[0][1]),a=new lt(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(r)&&a.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];if(this._isProper=!1,lt.intersects(o,a,r)&&Ue.orientationIndex(o,a,r)===0&&Ue.orientationIndex(a,o,r)===0)return this._isProper=!0,(r.equals(o)||r.equals(a))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION}else return e.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,o,a,s,u){u.x=this.smallestInAbsValue(r.x,o.x,a.x,s.x),u.y=this.smallestInAbsValue(r.y,o.y,a.y,s.y),r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.safeHCoordinateIntersection=function(r,o,a,s){var u=null;try{u=rf.intersection(r,o,a,s)}catch(l){if(l instanceof Sx)u=t.nearestEndpoint(r,o,a,s);else throw l}finally{}return u},t.prototype.intersection=function(r,o,a,s){var u=this.intersectionWithNormalization(r,o,a,s);return this.isInSegmentEnvelopes(u)||(u=new oe(t.nearestEndpoint(r,o,a,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u},t.prototype.smallestInAbsValue=function(r,o,a,s){var u=r,l=Math.abs(u);return Math.abs(o)<l&&(u=o,l=Math.abs(o)),Math.abs(a)<l&&(u=a,l=Math.abs(a)),Math.abs(s)<l&&(u=s),u},t.prototype.checkDD=function(r,o,a,s,u){var l=Vu.intersection(r,o,a,s),c=this.isInSegmentEnvelopes(l);ps.out.println("DD in env = "+c+"  --------------------- "+l),u.distance(l)>1e-4&&ps.out.println("Distance = "+u.distance(l))},t.prototype.intersectionWithNormalization=function(r,o,a,s){var u=new oe(r),l=new oe(o),c=new oe(a),f=new oe(s),h=new oe;this.normalizeToEnvCentre(u,l,c,f,h);var d=this.safeHCoordinateIntersection(u,l,c,f);return d.x+=h.x,d.y+=h.y,d},t.prototype.computeCollinearIntersection=function(r,o,a,s){var u=lt.intersects(r,o,a),l=lt.intersects(r,o,s),c=lt.intersects(a,s,r),f=lt.intersects(a,s,o);return u&&l?(this._intPt[0]=a,this._intPt[1]=s,e.COLLINEAR_INTERSECTION):c&&f?(this._intPt[0]=r,this._intPt[1]=o,e.COLLINEAR_INTERSECTION):u&&c?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!l&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):u&&f?(this._intPt[0]=a,this._intPt[1]=o,a.equals(o)&&!l&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&c?(this._intPt[0]=s,this._intPt[1]=r,s.equals(r)&&!u&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&f?(this._intPt[0]=s,this._intPt[1]=o,s.equals(o)&&!u&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,o,a,s,u){var l=r.x<o.x?r.x:o.x,c=r.y<o.y?r.y:o.y,f=r.x>o.x?r.x:o.x,h=r.y>o.y?r.y:o.y,d=a.x<s.x?a.x:s.x,p=a.y<s.y?a.y:s.y,_=a.x>s.x?a.x:s.x,y=a.y>s.y?a.y:s.y,v=l>d?l:d,w=f<_?f:_,C=c>p?c:p,E=h<y?h:y,S=(v+w)/2,A=(C+E)/2;u.x=S,u.y=A,r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.computeIntersect=function(r,o,a,s){if(this._isProper=!1,!lt.intersects(r,o,a,s))return e.NO_INTERSECTION;var u=Ue.orientationIndex(r,o,a),l=Ue.orientationIndex(r,o,s);if(u>0&&l>0||u<0&&l<0)return e.NO_INTERSECTION;var c=Ue.orientationIndex(a,s,r),f=Ue.orientationIndex(a,s,o);if(c>0&&f>0||c<0&&f<0)return e.NO_INTERSECTION;var h=u===0&&l===0&&c===0&&f===0;return h?this.computeCollinearIntersection(r,o,a,s):(u===0||l===0||c===0||f===0?(this._isProper=!1,r.equals2D(a)||r.equals2D(s)?this._intPt[0]=r:o.equals2D(a)||o.equals2D(s)?this._intPt[0]=o:u===0?this._intPt[0]=new oe(a):l===0?this._intPt[0]=new oe(s):c===0?this._intPt[0]=new oe(r):f===0&&(this._intPt[0]=new oe(o))):(this._isProper=!0,this._intPt[0]=this.intersection(r,o,a,s)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,o,a,s){var u=r,l=Ue.distancePointLine(r,a,s),c=Ue.distancePointLine(o,a,s);return c<l&&(l=c,u=o),c=Ue.distancePointLine(a,r,o),c<l&&(l=c,u=a),c=Ue.distancePointLine(s,r,o),c<l&&(l=c,u=s),u},t}(xo),gy=function(){};gy.prototype.interfaces_=function(){return[]};gy.prototype.getClass=function(){return gy};gy.orientationIndex=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=r.x-n.x,u=r.y-n.y;return gy.signOfDet2x2(o,a,s,u)};gy.signOfDet2x2=function(t,n,r,o){var a=null,s=null,u=null;if(a=1,t===0||o===0)return n===0||r===0?0:n>0?r>0?-a:a:r>0?a:-a;if(n===0||r===0)return o>0?t>0?a:-a:t>0?-a:a;if(n>0?o>0?n<=o||(a=-a,s=t,t=r,r=s,s=n,n=o,o=s):n<=-o?(a=-a,r=-r,o=-o):(s=t,t=-r,r=s,s=n,n=-o,o=s):o>0?-n<=o?(a=-a,t=-t,n=-n):(s=-t,t=r,r=s,s=-n,n=o,o=s):n>=o?(t=-t,n=-n,r=-r,o=-o):(a=-a,s=-t,t=-r,r=s,s=-n,n=-o,o=s),t>0)if(r>0){if(!(t<=r))return a}else return a;else{if(r>0)return-a;if(t>=r)a=-a,t=-t,r=-r;else return-a}for(;;){if(u=Math.floor(r/t),r=r-u*t,o=o-u*n,o<0)return-a;if(o>n)return a;if(t>r+r){if(n<o+o)return a}else{if(n>o+o)return-a;r=t-r,o=n-o,a=-a}if(o===0)return r===0?0:-a;if(r===0||(u=Math.floor(t/r),t=t-u*r,n=n-u*o,n<0))return a;if(n>o)return-a;if(r>t+t){if(o<n+n)return-a}else{if(o>n+n)return a;t=r-t,n=o-n,a=-a}if(n===0)return t===0?0:a;if(t===0)return-a}};var Jf=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Jf.prototype.countSegment=function(t,n){if(t.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&n.y===this._p.y){var r=t.x,o=n.x;return r>o&&(r=n.x,o=t.x),this._p.x>=r&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&t.y<=this._p.y){var a=t.x-this._p.x,s=t.y-this._p.y,u=n.x-this._p.x,l=n.y-this._p.y,c=gy.signOfDet2x2(a,s,u,l);if(c===0)return this._isPointOnSegment=!0,null;l<s&&(c=-c),c>0&&this._crossingCount++}};Jf.prototype.isPointInPolygon=function(){return this.getLocation()!==fe.EXTERIOR};Jf.prototype.getLocation=function(){return this._isPointOnSegment?fe.BOUNDARY:this._crossingCount%2===1?fe.INTERIOR:fe.EXTERIOR};Jf.prototype.isOnSegment=function(){return this._isPointOnSegment};Jf.prototype.interfaces_=function(){return[]};Jf.prototype.getClass=function(){return Jf};Jf.locatePointInRing=function(){if(arguments[0]instanceof oe&&Rt(arguments[1],Tn)){for(var t=arguments[0],n=arguments[1],r=new Jf(t),o=new oe,a=new oe,s=1;s<n.size();s++)if(n.getCoordinate(s,o),n.getCoordinate(s-1,a),r.countSegment(o,a),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof oe&&arguments[1]instanceof Array){for(var u=arguments[0],l=arguments[1],c=new Jf(u),f=1;f<l.length;f++){var h=l[f],d=l[f-1];if(c.countSegment(h,d),c.isOnSegment())return c.getLocation()}return c.getLocation()}};var Ue=function(){},Dy={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Ue.prototype.interfaces_=function(){return[]};Ue.prototype.getClass=function(){return Ue};Ue.orientationIndex=function(t,n,r){return Vu.orientationIndex(t,n,r)};Ue.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,r=t[0].x,o=1;o<t.length-1;o++){var a=t[o].x-r,s=t[o+1].y,u=t[o-1].y;n+=a*(u-s)}return n/2}else if(Rt(arguments[0],Tn)){var l=arguments[0],c=l.size();if(c<3)return 0;var f=new oe,h=new oe,d=new oe;l.getCoordinate(0,h),l.getCoordinate(1,d);var p=h.x;d.x-=p;for(var _=0,y=1;y<c-1;y++)f.y=h.y,h.x=d.x,h.y=d.y,l.getCoordinate(y+1,d),d.x-=p,_+=h.x*(f.y-d.y);return _/2}};Ue.distanceLineLine=function(t,n,r,o){if(t.equals(n))return Ue.distancePointLine(t,r,o);if(r.equals(o))return Ue.distancePointLine(o,t,n);var a=!1;if(!lt.intersects(t,n,r,o))a=!0;else{var s=(n.x-t.x)*(o.y-r.y)-(n.y-t.y)*(o.x-r.x);if(s===0)a=!0;else{var u=(t.y-r.y)*(o.x-r.x)-(t.x-r.x)*(o.y-r.y),l=(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y),c=l/s,f=u/s;(f<0||f>1||c<0||c>1)&&(a=!0)}}return a?ql.min(Ue.distancePointLine(t,r,o),Ue.distancePointLine(n,r,o),Ue.distancePointLine(r,t,n),Ue.distancePointLine(o,t,n)):0};Ue.isPointInRing=function(t,n){return Ue.locatePointInRing(t,n)!==fe.EXTERIOR};Ue.computeLength=function(t){var n=t.size();if(n<=1)return 0;var r=0,o=new oe;t.getCoordinate(0,o);for(var a=o.x,s=o.y,u=1;u<n;u++){t.getCoordinate(u,o);var l=o.x,c=o.y,f=l-a,h=c-s;r+=Math.sqrt(f*f+h*h),a=l,s=c}return r};Ue.isCCW=function(t){var n=t.length-1;if(n<3)throw new uo("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],o=0,a=1;a<=n;a++){var s=t[a];s.y>r.y&&(r=s,o=a)}var u=o;do u=u-1,u<0&&(u=n);while(t[u].equals2D(r)&&u!==o);var l=o;do l=(l+1)%n;while(t[l].equals2D(r)&&l!==o);var c=t[u],f=t[l];if(c.equals2D(r)||f.equals2D(r)||c.equals2D(f))return!1;var h=Ue.computeOrientation(c,r,f),d=!1;return h===0?d=c.x>f.x:d=h>0,d};Ue.locatePointInRing=function(t,n){return Jf.locatePointInRing(t,n)};Ue.distancePointLinePerpendicular=function(t,n,r){var o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),a=((n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y))/o;return Math.abs(a)*Math.sqrt(o)};Ue.computeOrientation=function(t,n,r){return Ue.orientationIndex(t,n,r)};Ue.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new uo("Line array must contain at least one vertex");for(var r=t.distance(n[0]),o=0;o<n.length-1;o++){var a=Ue.distancePointLine(t,n[o],n[o+1]);a<r&&(r=a)}return r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];if(u.x===l.x&&u.y===l.y)return s.distance(u);var c=(l.x-u.x)*(l.x-u.x)+(l.y-u.y)*(l.y-u.y),f=((s.x-u.x)*(l.x-u.x)+(s.y-u.y)*(l.y-u.y))/c;if(f<=0)return s.distance(u);if(f>=1)return s.distance(l);var h=((u.y-s.y)*(l.x-u.x)-(u.x-s.x)*(l.y-u.y))/c;return Math.abs(h)*Math.sqrt(c)}};Ue.isOnLine=function(t,n){for(var r=new B0,o=1;o<n.length;o++){var a=n[o-1],s=n[o];if(r.computeIntersection(t,a,s),r.hasIntersection())return!0}return!1};Dy.CLOCKWISE.get=function(){return-1};Dy.RIGHT.get=function(){return Ue.CLOCKWISE};Dy.COUNTERCLOCKWISE.get=function(){return 1};Dy.LEFT.get=function(){return Ue.COUNTERCLOCKWISE};Dy.COLLINEAR.get=function(){return 0};Dy.STRAIGHT.get=function(){return Ue.COLLINEAR};Object.defineProperties(Ue,Dy);var bp=function(){};bp.prototype.filter=function(t){};bp.prototype.interfaces_=function(){return[]};bp.prototype.getClass=function(){return bp};var Pt=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Ad={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Pt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Pt.SORTINDEX_GEOMETRYCOLLECTION};Pt.prototype.getFactory=function(){return this._factory};Pt.prototype.getGeometryN=function(t){return this};Pt.prototype.getArea=function(){return 0};Pt.prototype.isRectangle=function(){return!1};Pt.prototype.equals=function(){if(arguments[0]instanceof Pt){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof Pt))return!1;var r=n;return this.equalsExact(r)}};Pt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Pt.prototype.geometryChanged=function(){this.apply(Pt.geometryChangedFilter)};Pt.prototype.geometryChangedAction=function(){this._envelope=null};Pt.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Pt.prototype.getLength=function(){return 0};Pt.prototype.getNumGeometries=function(){return 1};Pt.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,o)}};Pt.prototype.getUserData=function(){return this._userData};Pt.prototype.getSRID=function(){return this._SRID};Pt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Pt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Pt.SORTINDEX_GEOMETRYCOLLECTION)throw new uo("This method does not support GeometryCollection arguments")};Pt.prototype.equal=function(t,n,r){return r===0?t.equals(n):t.distance(n)<=r};Pt.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Pt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Pt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new lt(this._envelope)};Pt.prototype.setSRID=function(t){this._SRID=t};Pt.prototype.setUserData=function(t){this._userData=t};Pt.prototype.compare=function(t,n){for(var r=t.iterator(),o=n.iterator();r.hasNext()&&o.hasNext();){var a=r.next(),s=o.next(),u=a.compareTo(s);if(u!==0)return u}return r.hasNext()?1:o.hasNext()?-1:0};Pt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Pt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Pt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Pt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Pt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Pt.SORTINDEX_MULTIPOLYGON};Pt.prototype.interfaces_=function(){return[FP,Dc,Pc]};Pt.prototype.getClass=function(){return Pt};Pt.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1};Pt.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1};Ad.serialVersionUID.get=function(){return 8763622679187377e3};Ad.SORTINDEX_POINT.get=function(){return 0};Ad.SORTINDEX_MULTIPOINT.get=function(){return 1};Ad.SORTINDEX_LINESTRING.get=function(){return 2};Ad.SORTINDEX_LINEARRING.get=function(){return 3};Ad.SORTINDEX_MULTILINESTRING.get=function(){return 4};Ad.SORTINDEX_POLYGON.get=function(){return 5};Ad.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Ad.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Ad.geometryChangedFilter.get=function(){return xB};Object.defineProperties(Pt,Ad);var xB=function(){};xB.interfaces_=function(){return[bp]};xB.filter=function(t){t.geometryChangedAction()};var gd=function(){};gd.prototype.filter=function(t){};gd.prototype.interfaces_=function(){return[]};gd.prototype.getClass=function(){return gd};var Ac=function(){},Rp={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Ac.prototype.isInBoundary=function(t){};Ac.prototype.interfaces_=function(){return[]};Ac.prototype.getClass=function(){return Ac};Rp.Mod2BoundaryNodeRule.get=function(){return rx};Rp.EndPointBoundaryNodeRule.get=function(){return ix};Rp.MultiValentEndPointBoundaryNodeRule.get=function(){return ox};Rp.MonoValentEndPointBoundaryNodeRule.get=function(){return ax};Rp.MOD2_BOUNDARY_RULE.get=function(){return new rx};Rp.ENDPOINT_BOUNDARY_RULE.get=function(){return new ix};Rp.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ox};Rp.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ax};Rp.OGC_SFS_BOUNDARY_RULE.get=function(){return Ac.MOD2_BOUNDARY_RULE};Object.defineProperties(Ac,Rp);var rx=function(){};rx.prototype.isInBoundary=function(t){return t%2===1};rx.prototype.interfaces_=function(){return[Ac]};rx.prototype.getClass=function(){return rx};var ix=function(){};ix.prototype.isInBoundary=function(t){return t>0};ix.prototype.interfaces_=function(){return[Ac]};ix.prototype.getClass=function(){return ix};var ox=function(){};ox.prototype.isInBoundary=function(t){return t>1};ox.prototype.interfaces_=function(){return[Ac]};ox.prototype.getClass=function(){return ox};var ax=function(){};ax.prototype.isInBoundary=function(t){return t===1};ax.prototype.interfaces_=function(){return[Ac]};ax.prototype.getClass=function(){return ax};var Ca=function(){};Ca.prototype.add=function(){};Ca.prototype.addAll=function(){};Ca.prototype.isEmpty=function(){};Ca.prototype.iterator=function(){};Ca.prototype.size=function(){};Ca.prototype.toArray=function(){};Ca.prototype.remove=function(){};var twe=function(e){function t(r){e.call(this),this.message=r||""}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error),Ax=function(){};Ax.prototype.hasNext=function(){};Ax.prototype.next=function(){};Ax.prototype.remove=function(){};var of=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Ca);function bx(e){this.message=e||""}bx.prototype=new Error;bx.prototype.name="NoSuchElementException";var Be=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Ca&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,Ca]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.set=function(r,o){var a=this.array_[r];return this.array_[r]=o,a},t.prototype.iterator=function(){return new nwe(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new twe;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.remove=function(r){for(var o=this,a=!1,s=0,u=this.array_.length;s<u;s++)if(o.array_[s]===r){o.array_.splice(s,1),a=!0;break}return a},t}(of),nwe=function(e){function t(n){e.call(this),this.arrayList_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new bx;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(Ax),$T=function(e){function t(){if(e.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.ensureCapacity(o.length),this.add(o,a)}}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(o){return this.get(o)},t.prototype.addAll=function(){var o=this;if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=!1,l=a.iterator();l.hasNext();)o.add(l.next(),s),u=!0;return u}else return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var o=this,a=e.prototype.clone.call(this),s=0;s<this.size();s++)a.add(s,o.get(s).copy());return a},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var o=this;if(arguments.length===1){var a=arguments[0];e.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1];return this.add(s,u,!0),!0}else if(arguments[0]instanceof oe&&typeof arguments[1]=="boolean"){var l=arguments[0],c=arguments[1];if(!c&&this.size()>=1){var f=this.get(this.size()-1);if(f.equals2D(l))return null}e.prototype.add.call(this,l)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var h=arguments[0],d=arguments[1];return this.add(h,d),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],_=arguments[1],y=arguments[2];if(y)for(var v=0;v<p.length;v++)o.add(p[v],_);else for(var w=p.length-1;w>=0;w--)o.add(p[w],_);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof oe){var C=arguments[0],E=arguments[1],S=arguments[2];if(!S){var A=this.size();if(A>0){if(C>0){var D=this.get(C-1);if(D.equals2D(E))return null}if(C<A){var P=this.get(C);if(P.equals2D(E))return null}}}e.prototype.add.call(this,C,E)}}else if(arguments.length===4){var M=arguments[0],b=arguments[1],O=arguments[2],m=arguments[3],I=1;O>m&&(I=-1);for(var L=O;L!==m;L+=I)o.add(M[L],b);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new oe(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,n),t}(Be),pn=function(){},VP={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};VP.ForwardComparator.get=function(){return LT};VP.BidirectionalComparator.get=function(){return sx};VP.coordArrayType.get=function(){return new Array(0).fill(null)};pn.prototype.interfaces_=function(){return[]};pn.prototype.getClass=function(){return pn};pn.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};pn.ptNotInList=function(t,n){for(var r=0;r<t.length;r++){var o=t[r];if(pn.indexOf(o,n)<0)return o}return null};pn.scroll=function(t,n){var r=pn.indexOf(n,t);if(r<0)return null;var o=new Array(t.length).fill(null);ps.arraycopy(t,r,o,0,t.length-r),ps.arraycopy(t,0,o,t.length-r,r),ps.arraycopy(o,0,t,0,t.length)};pn.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(o===a)return!0;if(o===null||a===null||o.length!==a.length)return!1;for(var u=0;u<o.length;u++)if(s.compare(o[u],a[u])!==0)return!1;return!0}};pn.intersection=function(t,n){for(var r=new $T,o=0;o<t.length;o++)n.intersects(t[o])&&r.add(t[o],!0);return r.toCoordinateArray()};pn.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1};pn.removeRepeatedPoints=function(t){if(!pn.hasRepeatedPoints(t))return t;var n=new $T(t,!1);return n.toCoordinateArray()};pn.reverse=function(t){for(var n=t.length-1,r=Math.trunc(n/2),o=0;o<=r;o++){var a=t[o];t[o]=t[n-o],t[n-o]=a}};pn.removeNull=function(t){for(var n=0,r=0;r<t.length;r++)t[r]!==null&&n++;var o=new Array(n).fill(null);if(n===0)return o;for(var a=0,s=0;s<t.length;s++)t[s]!==null&&(o[a++]=t[s]);return o};pn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),r=0;r<t.length;r++)n[r]=new oe(t[r]);return n}else if(arguments.length===5)for(var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=arguments[4],c=0;c<l;c++)s[u+c]=new oe(o[a+c])};pn.isEqualReversed=function(t,n){for(var r=0;r<t.length;r++){var o=t[r],a=n[t.length-r-1];if(o.compareTo(a)!==0)return!1}return!0};pn.envelope=function(t){for(var n=new lt,r=0;r<t.length;r++)n.expandToInclude(t[r]);return n};pn.toCoordinateArray=function(t){return t.toArray(pn.coordArrayType)};pn.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]};pn.indexOf=function(t,n){for(var r=0;r<n.length;r++)if(t.equals(n[r]))return r;return-1};pn.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var r=t.length-1-n,o=t[n].compareTo(t[r]);if(o!==0)return o}return 1};pn.compare=function(t,n){for(var r=0;r<t.length&&r<n.length;){var o=t[r].compareTo(n[r]);if(o!==0)return o;r++}return r<n.length?-1:r<t.length?1:0};pn.minCoordinate=function(t){for(var n=null,r=0;r<t.length;r++)(n===null||n.compareTo(t[r])>0)&&(n=t[r]);return n};pn.extract=function(t,n,r){n=ql.clamp(n,0,t.length),r=ql.clamp(r,-1,t.length);var o=r-n+1;r<0&&(o=0),n>=t.length&&(o=0),r<n&&(o=0);var a=new Array(o).fill(null);if(o===0)return a;for(var s=0,u=n;u<=r;u++)a[s++]=t[u];return a};Object.defineProperties(pn,VP);var LT=function(){};LT.prototype.compare=function(t,n){var r=t,o=n;return pn.compare(r,o)};LT.prototype.interfaces_=function(){return[tx]};LT.prototype.getClass=function(){return LT};var sx=function(){};sx.prototype.compare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;var a=pn.compare(r,o),s=pn.isEqualReversed(r,o);return s?0:a};sx.prototype.OLDcompare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;for(var a=pn.increasingDirection(r),s=pn.increasingDirection(o),u=a>0?0:r.length-1,l=s>0?0:r.length-1,c=0;c<r.length;c++){var f=r[u].compareTo(o[l]);if(f!==0)return f;u+=a,l+=s}return 0};sx.prototype.interfaces_=function(){return[tx]};sx.prototype.getClass=function(){return sx};var Py=function(){};Py.prototype.get=function(){};Py.prototype.put=function(){};Py.prototype.size=function(){};Py.prototype.values=function(){};Py.prototype.entrySet=function(){};var rwe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Py);function eS(e){this.message=e||""}eS.prototype=new Error;eS.prototype.name="OperationNotSupported";function kP(){}kP.prototype=new Ca;kP.prototype.contains=function(){};var wB=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Ca&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var o=this,a=0,s=this.array_.length;a<s;a++){var u=o.array_[a];if(u===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.iterator=function(){return new iwe(this)},t}(kP),iwe=function(e){function t(n){e.call(this),this.hashSet_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new bx;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new eS},t}(Ax),Cp=0,y0=1;function mY(e){return e===null?Cp:e.color}function Hi(e){return e===null?null:e.parent}function _p(e,t){e!==null&&(e.color=t)}function x3(e){return e===null?null:e.left}function gY(e){return e===null?null:e.right}function zs(){this.root_=null,this.size_=0}zs.prototype=new rwe;zs.prototype.get=function(e){for(var t=this.root_;t!==null;){var n=e.compareTo(t.key);if(n<0)t=t.left;else if(n>0)t=t.right;else return t.value}return null};zs.prototype.put=function(e,t){if(this.root_===null)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:Cp,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,o;do if(r=n,o=e.compareTo(n.key),o<0)n=n.left;else if(o>0)n=n.right;else{var a=n.value;return n.value=t,a}while(n!==null);var s={key:e,left:null,right:null,value:t,parent:r,color:Cp,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null};zs.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=y0;e!=null&&e!==this.root_&&e.parent.color===y0;)if(Hi(e)===x3(Hi(Hi(e)))){var n=gY(Hi(Hi(e)));mY(n)===y0?(_p(Hi(e),Cp),_p(n,Cp),_p(Hi(Hi(e)),y0),e=Hi(Hi(e))):(e===gY(Hi(e))&&(e=Hi(e),t.rotateLeft(e)),_p(Hi(e),Cp),_p(Hi(Hi(e)),y0),t.rotateRight(Hi(Hi(e))))}else{var r=x3(Hi(Hi(e)));mY(r)===y0?(_p(Hi(e),Cp),_p(r,Cp),_p(Hi(Hi(e)),y0),e=Hi(Hi(e))):(e===x3(Hi(e))&&(e=Hi(e),t.rotateRight(e)),_p(Hi(e),Cp),_p(Hi(Hi(e)),y0),t.rotateLeft(Hi(Hi(e))))}this.root_.color=Cp};zs.prototype.values=function(){var e=new Be,t=this.getFirstEntry();if(t!==null)for(e.add(t.value);(t=zs.successor(t))!==null;)e.add(t.value);return e};zs.prototype.entrySet=function(){var e=new wB,t=this.getFirstEntry();if(t!==null)for(e.add(t);(t=zs.successor(t))!==null;)e.add(t);return e};zs.prototype.rotateLeft=function(e){if(e!=null){var t=e.right;e.right=t.left,t.left!=null&&(t.left.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}};zs.prototype.rotateRight=function(e){if(e!=null){var t=e.left;e.left=t.right,t.right!=null&&(t.right.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}};zs.prototype.getFirstEntry=function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e};zs.successor=function(e){if(e===null)return null;if(e.right!==null){for(var t=e.right;t.left!==null;)t=t.left;return t}else{for(var n=e.parent,r=e;n!==null&&r===n.right;)r=n,n=n.parent;return n}};zs.prototype.size=function(){return this.size_};var RT=function(){};RT.prototype.interfaces_=function(){return[]};RT.prototype.getClass=function(){return RT};function aj(){}aj.prototype=new kP;function th(){this.array_=[],arguments[0]instanceof Ca&&this.addAll(arguments[0])}th.prototype=new aj;th.prototype.contains=function(e){for(var t=this,n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===0)return!0}return!1};th.prototype.add=function(e){var t=this;if(this.contains(e))return!1;for(var n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===1)return t.array_.splice(n,0,e),!0}return this.array_.push(e),!0};th.prototype.addAll=function(e){for(var t=this,n=e.iterator();n.hasNext();)t.add(n.next());return!0};th.prototype.remove=function(e){throw new eS};th.prototype.size=function(){return this.array_.length};th.prototype.isEmpty=function(){return this.array_.length===0};th.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};th.prototype.iterator=function(){return new GP(this)};var GP=function(e){this.treeSet_=e,this.position_=0};GP.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new bx;return this.treeSet_.array_[this.position_++]};GP.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};GP.prototype.remove=function(){throw new eS};var w0=function(){};w0.sort=function(){var t=arguments[0],n,r,o,a;if(arguments.length===1)a=function(u,l){return u.compareTo(l)},t.sort(a);else if(arguments.length===2)o=arguments[1],a=function(u,l){return o.compare(u,l)},t.sort(a);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),o=arguments[3],a=function(u,l){return o.compare(u,l)},r.sort(a),s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])};w0.asList=function(t){for(var n=new Be,r=0,o=t.length;r<o;r++)n.add(t[r]);return n};var zr=function(){},pf={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};pf.P.get=function(){return 0};pf.L.get=function(){return 1};pf.A.get=function(){return 2};pf.FALSE.get=function(){return-1};pf.TRUE.get=function(){return-2};pf.DONTCARE.get=function(){return-3};pf.SYM_FALSE.get=function(){return"F"};pf.SYM_TRUE.get=function(){return"T"};pf.SYM_DONTCARE.get=function(){return"*"};pf.SYM_P.get=function(){return"0"};pf.SYM_L.get=function(){return"1"};pf.SYM_A.get=function(){return"2"};zr.prototype.interfaces_=function(){return[]};zr.prototype.getClass=function(){return zr};zr.toDimensionSymbol=function(t){switch(t){case zr.FALSE:return zr.SYM_FALSE;case zr.TRUE:return zr.SYM_TRUE;case zr.DONTCARE:return zr.SYM_DONTCARE;case zr.P:return zr.SYM_P;case zr.L:return zr.SYM_L;case zr.A:return zr.SYM_A;default:}throw new uo("Unknown dimension value: "+t)};zr.toDimensionValue=function(t){switch(MT.toUpperCase(t)){case zr.SYM_FALSE:return zr.FALSE;case zr.SYM_TRUE:return zr.TRUE;case zr.SYM_DONTCARE:return zr.DONTCARE;case zr.SYM_P:return zr.P;case zr.SYM_L:return zr.L;case zr.SYM_A:return zr.A;default:}throw new uo("Unknown dimension symbol: "+t)};Object.defineProperties(zr,pf);var nh=function(){};nh.prototype.filter=function(t){};nh.prototype.interfaces_=function(){return[]};nh.prototype.getClass=function(){return nh};var sf=function(){};sf.prototype.filter=function(t,n){};sf.prototype.isDone=function(){};sf.prototype.isGeometryChanged=function(){};sf.prototype.interfaces_=function(){return[]};sf.prototype.getClass=function(){return sf};var cu=function(e){function t(r,o){if(e.call(this,o),this._geometries=r||[],e.hasNullElements(this._geometries))throw new uo("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var o=this,a=new lt,s=0;s<this._geometries.length;s++)a.expandToInclude(o._geometries[s].getEnvelopeInternal());return a},t.prototype.getGeometryN=function(o){return this._geometries[o]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var o=this,a=new Array(this.getNumPoints()).fill(null),s=-1,u=0;u<this._geometries.length;u++)for(var l=o._geometries[u].getCoordinates(),c=0;c<l.length;c++)s++,a[s]=l[c];return a},t.prototype.getArea=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getArea();return a},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._geometries.length!==u._geometries.length)return!1;for(var l=0;l<this._geometries.length;l++)if(!o._geometries[l].equalsExact(u._geometries[l],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<this._geometries.length;a++)o._geometries[a].normalize();w0.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var o=this,a=zr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getBoundaryDimension());return a},t.prototype.getDimension=function(){for(var o=this,a=zr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getDimension());return a},t.prototype.getLength=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getNumPoints();return a},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createGeometryCollection(s)},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=new th(w0.asList(this._geometries)),u=new th(w0.asList(a._geometries));return this.compare(s,u)}else if(arguments.length===2){for(var l=arguments[0],c=arguments[1],f=l,h=this.getNumGeometries(),d=f.getNumGeometries(),p=0;p<h&&p<d;){var _=o.getGeometryN(p),y=f.getGeometryN(p),v=_.compareToSameClass(y,c);if(v!==0)return v;p++}return p<h?1:p<d?-1:0}},t.prototype.apply=function(){var o=this;if(Rt(arguments[0],gd))for(var a=arguments[0],s=0;s<this._geometries.length;s++)o._geometries[s].apply(a);else if(Rt(arguments[0],sf)){var u=arguments[0];if(this._geometries.length===0)return null;for(var l=0;l<this._geometries.length&&(o._geometries[l].apply(u),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Rt(arguments[0],nh)){var c=arguments[0];c.filter(this);for(var f=0;f<this._geometries.length;f++)o._geometries[f].apply(c)}else if(Rt(arguments[0],bp)){var h=arguments[0];h.filter(this);for(var d=0;d<this._geometries.length;d++)o._geometries[d].apply(h)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),on.shouldNeverReachHere(),null},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var s=0;s<this._geometries.length;s++)a._geometries[s]=o._geometries[s].clone();return a},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.isEmpty=function(){for(var o=this,a=0;a<this._geometries.length;a++)if(!o._geometries[a].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,n),t}(Pt),A0=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Pt.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?zr.FALSE:0},t.prototype.isClosed=function(){var o=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!o._geometries[a].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[a-1-u]=o._geometries[u].reverse();return this.getFactory().createMultiLineString(s)},t.prototype.getBoundary=function(){return new Ec(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[RT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,n),t}(cu),Ec=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],n=Ac.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};Ec.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};Ec.prototype.getBoundary=function(){return this._geom instanceof Po?this.boundaryLineString(this._geom):this._geom instanceof A0?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Ec.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this._bnRule.isInBoundary(2);return n?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Ec.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Ec.prototype.computeBoundaryCoordinates=function(t){var n=this,r=new Be;this._endpointMap=new zs;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);a.getNumPoints()!==0&&(n.addEndpoint(a.getCoordinateN(0)),n.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var s=this._endpointMap.entrySet().iterator();s.hasNext();){var u=s.next(),l=u.getValue(),c=l.count;n._bnRule.isInBoundary(c)&&r.add(u.getKey())}return pn.toCoordinateArray(r)};Ec.prototype.addEndpoint=function(t){var n=this._endpointMap.get(t);n===null&&(n=new mP,this._endpointMap.put(t,n)),n.count++};Ec.prototype.interfaces_=function(){return[]};Ec.prototype.getClass=function(){return Ec};Ec.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new Ec(t);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new Ec(r,o);return a.getBoundary()}};var mP=function(){this.count=null};mP.prototype.interfaces_=function(){return[]};mP.prototype.getClass=function(){return mP};function owe(){}function awe(){}var swe=function(){};function uwe(){}function lwe(){}function cwe(){}var Tc=function(){},EB={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};Tc.chars=function(t,n){for(var r=new Array(n).fill(null),o=0;o<n;o++)r[o]=t;return String(r)};Tc.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new uwe,r=new owe(n);return t.printStackTrace(r),n.toString()}else if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s="",u=new awe(Tc.getStackTrace(o)),l=new cwe(u),c=0;c<a;c++)try{s+=l.readLine()+Tc.NEWLINE}catch(f){if(f instanceof lwe)on.shouldNeverReachHere();else throw f}finally{}return s}};Tc.split=function(t,n){for(var r=n.length,o=new Be,a=""+t,s=a.indexOf(n);s>=0;){var u=a.substring(0,s);o.add(u),a=a.substring(s+r),s=a.indexOf(n)}a.length>0&&o.add(a);for(var l=new Array(o.size()).fill(null),c=0;c<l.length;c++)l[c]=o.get(c);return l};Tc.toString=function(){if(arguments.length===1){var t=arguments[0];return Tc.SIMPLE_ORDINATE_FORMAT.format(t)}};Tc.spaces=function(t){return Tc.chars(" ",t)};EB.NEWLINE.get=function(){return ps.getProperty("line.separator")};EB.SIMPLE_ORDINATE_FORMAT.get=function(){return new swe("0.#")};Object.defineProperties(Tc,EB);var Uo=function(){};Uo.prototype.interfaces_=function(){return[]};Uo.prototype.getClass=function(){return Uo};Uo.copyCoord=function(t,n,r,o){for(var a=Math.min(t.getDimension(),r.getDimension()),s=0;s<a;s++)r.setOrdinate(o,s,t.getOrdinate(n,s))};Uo.isRing=function(t){var n=t.size();return n===0?!0:n<=3?!1:t.getOrdinate(0,Tn.X)===t.getOrdinate(n-1,Tn.X)&&t.getOrdinate(0,Tn.Y)===t.getOrdinate(n-1,Tn.Y)};Uo.isEqual=function(t,n){var r=t.size(),o=n.size();if(r!==o)return!1;for(var a=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)for(var u=0;u<a;u++){var l=t.getOrdinate(s,u),c=n.getOrdinate(s,u);if(t.getOrdinate(s,u)!==n.getOrdinate(s,u)&&!(Kt.isNaN(l)&&Kt.isNaN(c)))return!1}return!0};Uo.extend=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();if(Uo.copy(n,0,o,0,a),a>0)for(var s=a;s<r;s++)Uo.copy(n,a-1,o,s,1);return o};Uo.reverse=function(t){for(var n=t.size()-1,r=Math.trunc(n/2),o=0;o<=r;o++)Uo.swap(t,o,n-o)};Uo.swap=function(t,n,r){if(n===r)return null;for(var o=0;o<t.getDimension();o++){var a=t.getOrdinate(n,o);t.setOrdinate(n,o,t.getOrdinate(r,o)),t.setOrdinate(r,o,a)}};Uo.copy=function(t,n,r,o,a){for(var s=0;s<a;s++)Uo.copyCoord(t,n+s,r,o+s)};Uo.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var r=t.getDimension(),o=new fh;o.append("(");for(var a=0;a<n;a++){a>0&&o.append(" ");for(var s=0;s<r;s++)s>0&&o.append(","),o.append(Tc.toString(t.getOrdinate(a,s)))}return o.append(")"),o.toString()}};Uo.ensureValidRing=function(t,n){var r=n.size();if(r===0)return n;if(r<=3)return Uo.createClosedRing(t,n,4);var o=n.getOrdinate(0,Tn.X)===n.getOrdinate(r-1,Tn.X)&&n.getOrdinate(0,Tn.Y)===n.getOrdinate(r-1,Tn.Y);return o?n:Uo.createClosedRing(t,n,r+1)};Uo.createClosedRing=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();Uo.copy(n,0,o,0,a);for(var s=a;s<r;s++)Uo.copy(n,0,o,s,1);return o};var Po=function(e){function t(r,o){e.call(this,o),this._points=null,this.init(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new lt:this._points.expandEnvelope(new lt)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._points.size()!==u._points.size())return!1;for(var l=0;l<this._points.size();l++)if(!o.equal(o._points.getCoordinate(l),u._points.getCoordinate(l),s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<Math.trunc(this._points.size()/2);a++){var s=o._points.size()-1-a;if(!o._points.getCoordinate(a).equals(o._points.getCoordinate(s)))return o._points.getCoordinate(a).compareTo(o._points.getCoordinate(s))>0&&Uo.reverse(o._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?zr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return Ue.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var o=this._points.copy();Uo.reverse(o);var a=this.getFactory().createLineString(o);return a},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){for(var a=arguments[0],s=a,u=0,l=0;u<this._points.size()&&l<s._points.size();){var c=o._points.getCoordinate(u).compareTo(s._points.getCoordinate(l));if(c!==0)return c;u++,l++}return u<this._points.size()?1:l<s._points.size()?-1:0}else if(arguments.length===2){var f=arguments[0],h=arguments[1],d=f;return h.compare(this._points,d._points)}},t.prototype.apply=function(){var o=this;if(Rt(arguments[0],gd))for(var a=arguments[0],s=0;s<this._points.size();s++)a.filter(o._points.getCoordinate(s));else if(Rt(arguments[0],sf)){var u=arguments[0];if(this._points.size()===0)return null;for(var l=0;l<this._points.size()&&(u.filter(o._points,l),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Rt(arguments[0],nh)){var c=arguments[0];c.filter(this)}else if(Rt(arguments[0],bp)){var f=arguments[0];f.filter(this)}},t.prototype.getBoundary=function(){return new Ec(this).getBoundary()},t.prototype.isEquivalentClass=function(o){return o instanceof t},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._points=this._points.clone(),o},t.prototype.getCoordinateN=function(o){return this._points.getCoordinate(o)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(o){if(o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),o.size()===1)throw new uo("Invalid number of points in LineString (found "+o.size()+" - must be 0 or >= 2)");this._points=o},t.prototype.isCoordinate=function(o){for(var a=this,s=0;s<this._points.size();s++)if(a._points.getCoordinate(s).equals(o))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(o){return this.getFactory().createPoint(this._points.getCoordinate(o))},t.prototype.interfaces_=function(){return[RT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,n),t}(Pt),OT=function(){};OT.prototype.interfaces_=function(){return[]};OT.prototype.getClass=function(){return OT};var hl=function(e){function t(r,o){e.call(this,o),this._coordinates=r||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new lt;var o=new lt;return o.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),o},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?this.isEmpty()&&o.isEmpty()?!0:this.isEmpty()!==o.isEmpty()?!1:this.equal(o.getCoordinate(),this.getCoordinate(),a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return zr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var o=arguments[0],a=o;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var s=arguments[0],u=arguments[1],l=s;return u.compare(this._coordinates,l._coordinates)}},t.prototype.apply=function(){if(Rt(arguments[0],gd)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this.getCoordinate())}else if(Rt(arguments[0],sf)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Rt(arguments[0],nh)){var s=arguments[0];s.filter(this)}else if(Rt(arguments[0],bp)){var u=arguments[0];u.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._coordinates=this._coordinates.clone(),o},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(o){o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),on.isTrue(o.size()<=1),this._coordinates=o},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[OT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,n),t}(Pt),Ym=function(){};Ym.prototype.interfaces_=function(){return[]};Ym.prototype.getClass=function(){return Ym};var Ea=function(e){function t(r,o,a){if(e.call(this,a),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),o===null&&(o=[]),e.hasNullElements(o))throw new uo("holes must not contain null elements");if(r.isEmpty()&&e.hasNonEmptyElements(o))throw new uo("shell is empty but holes are not");this._shell=r,this._holes=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var o=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),s=-1,u=this._shell.getCoordinates(),l=0;l<u.length;l++)s++,a[s]=u[l];for(var c=0;c<this._holes.length;c++)for(var f=o._holes[c].getCoordinates(),h=0;h<f.length;h++)s++,a[s]=f[h];return a},t.prototype.getArea=function(){var o=this,a=0;a+=Math.abs(Ue.signedArea(this._shell.getCoordinateSequence()));for(var s=0;s<this._holes.length;s++)a-=Math.abs(Ue.signedArea(o._holes[s].getCoordinateSequence()));return a},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var o=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),s=0;s<5;s++){var u=o.getX(s);if(!(u===a.getMinX()||u===a.getMaxX()))return!1;var l=o.getY(s);if(!(l===a.getMinY()||l===a.getMaxY()))return!1}for(var c=o.getX(0),f=o.getY(0),h=1;h<=4;h++){var d=o.getX(h),p=o.getY(h),_=d!==c,y=p!==f;if(_===y)return!1;c=d,f=p}return!0},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a,l=this._shell,c=u._shell;if(!l.equalsExact(c,s)||this._holes.length!==u._holes.length)return!1;for(var f=0;f<this._holes.length;f++)if(!o._holes[f].equalsExact(u._holes[f],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var o=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)o.normalize(o._holes[a],!1);w0.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],u=arguments[1];if(s.isEmpty())return null;var l=new Array(s.getCoordinates().length-1).fill(null);ps.arraycopy(s.getCoordinates(),0,l,0,l.length);var c=pn.minCoordinate(s.getCoordinates());pn.scroll(l,c),ps.arraycopy(l,0,s.getCoordinates(),0,l.length),s.getCoordinates()[l.length]=l[0],Ue.isCCW(s.getCoordinates())===u&&pn.reverse(s.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var o=this,a=0;a+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)a+=o._holes[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)a+=o._holes[s].getNumPoints();return a},t.prototype.reverse=function(){var o=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].copy().reverse();return a},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=this._shell,u=a._shell;return s.compareToSameClass(u)}else if(arguments.length===2){var l=arguments[0],c=arguments[1],f=l,h=this._shell,d=f._shell,p=h.compareToSameClass(d,c);if(p!==0)return p;for(var _=this.getNumInteriorRing(),y=f.getNumInteriorRing(),v=0;v<_&&v<y;){var w=o.getInteriorRingN(v),C=f.getInteriorRingN(v),E=w.compareToSameClass(C,c);if(E!==0)return E;v++}return v<_?1:v<y?-1:0}},t.prototype.apply=function(o){var a=this;if(Rt(o,gd)){this._shell.apply(o);for(var s=0;s<this._holes.length;s++)a._holes[s].apply(o)}else if(Rt(o,sf)){if(this._shell.apply(o),!o.isDone())for(var u=0;u<this._holes.length&&(a._holes[u].apply(o),!o.isDone());u++);o.isGeometryChanged()&&this.geometryChanged()}else if(Rt(o,nh))o.filter(this);else if(Rt(o,bp)){o.filter(this),this._shell.apply(o);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(o)}},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var s=0;s<this._holes.length;s++)a[s+1]=o._holes[s];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].clone();return a},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var o=this,a=this._shell.copy(),s=new Array(this._holes.length).fill(null),u=0;u<s.length;u++)s[u]=o._holes[u].copy();return new t(a,s,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(o){return this._holes[o]},t.prototype.interfaces_=function(){return[Ym]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,n),t}(Pt),ux=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Pt.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._geometries[o].getCoordinate()}else return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return zr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[OT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,n),t}(cu),_d=function(e){function t(r,o){r instanceof oe&&o instanceof dn&&(r=o.getCoordinateSequenceFactory().create(r)),e.call(this,r,o),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Pt.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return zr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var o=this._points.copy();Uo.reverse(o);var a=this.getFactory().createLinearRing(o);return a},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new uo("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new uo("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,n),t}(Po),pd=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Pt.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createMultiPolygon(s)},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new Be,s=0;s<this._geometries.length;s++)for(var u=o._geometries[s],l=u.getBoundary(),c=0;c<l.getNumGeometries();c++)a.add(l.getGeometryN(c));var f=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(f))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[Ym]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,n),t}(cu),bc=function(t){this._factory=t||null,this._isUserDataCopied=!1},UP={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};bc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};bc.prototype.edit=function(t,n){if(t===null)return null;var r=this.editInternal(t,n);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};bc.prototype.editInternal=function(t,n){return this._factory===null&&(this._factory=t.getFactory()),t instanceof cu?this.editGeometryCollection(t,n):t instanceof Ea?this.editPolygon(t,n):t instanceof hl?n.edit(t,this._factory):t instanceof Po?n.edit(t,this._factory):(on.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};bc.prototype.editGeometryCollection=function(t,n){for(var r=this,o=n.edit(t,this._factory),a=new Be,s=0;s<o.getNumGeometries();s++){var u=r.edit(o.getGeometryN(s),n);u===null||u.isEmpty()||a.add(u)}return o.getClass()===ux?this._factory.createMultiPoint(a.toArray([])):o.getClass()===A0?this._factory.createMultiLineString(a.toArray([])):o.getClass()===pd?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};bc.prototype.editPolygon=function(t,n){var r=this,o=n.edit(t,this._factory);if(o===null&&(o=this._factory.createPolygon(null)),o.isEmpty())return o;var a=this.edit(o.getExteriorRing(),n);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var s=new Be,u=0;u<o.getNumInteriorRing();u++){var l=r.edit(o.getInteriorRingN(u),n);l===null||l.isEmpty()||s.add(l)}return this._factory.createPolygon(a,s.toArray([]))};bc.prototype.interfaces_=function(){return[]};bc.prototype.getClass=function(){return bc};bc.GeometryEditorOperation=function(){};UP.NoOpGeometryOperation.get=function(){return NT};UP.CoordinateOperation.get=function(){return BT};UP.CoordinateSequenceOperation.get=function(){return FT};Object.defineProperties(bc,UP);var NT=function(){};NT.prototype.edit=function(t,n){return t};NT.prototype.interfaces_=function(){return[bc.GeometryEditorOperation]};NT.prototype.getClass=function(){return NT};var BT=function(){};BT.prototype.edit=function(t,n){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof _d?n.createLinearRing(r):t instanceof Po?n.createLineString(r):t instanceof hl?r.length>0?n.createPoint(r[0]):n.createPoint():t};BT.prototype.interfaces_=function(){return[bc.GeometryEditorOperation]};BT.prototype.getClass=function(){return BT};var FT=function(){};FT.prototype.edit=function(t,n){return t instanceof _d?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Po?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof hl?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t};FT.prototype.interfaces_=function(){return[bc.GeometryEditorOperation]};FT.prototype.getClass=function(){return FT};var ko=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)t._coordinates[r]=new oe}else if(Rt(arguments[0],Tn)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._coordinates=new Array(o.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)t._coordinates[a]=o.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],u=arguments[1];this._coordinates=s,this._dimension=u,s===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],c=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=c;for(var f=0;f<l;f++)t._coordinates[f]=new oe}}},sj={serialVersionUID:{configurable:!0}};ko.prototype.setOrdinate=function(t,n,r){switch(n){case Tn.X:this._coordinates[t].x=r;break;case Tn.Y:this._coordinates[t].y=r;break;case Tn.Z:this._coordinates[t].z=r;break;default:throw new uo("invalid ordinateIndex")}};ko.prototype.size=function(){return this._coordinates.length};ko.prototype.getOrdinate=function(t,n){switch(n){case Tn.X:return this._coordinates[t].x;case Tn.Y:return this._coordinates[t].y;case Tn.Z:return this._coordinates[t].z;default:}return Kt.NaN};ko.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};ko.prototype.getCoordinateCopy=function(t){return new oe(this._coordinates[t])};ko.prototype.getDimension=function(){return this._dimension};ko.prototype.getX=function(t){return this._coordinates[t].x};ko.prototype.clone=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].clone();return new ko(n,this._dimension)};ko.prototype.expandEnvelope=function(t){for(var n=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(n._coordinates[r]);return t};ko.prototype.copy=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].copy();return new ko(n,this._dimension)};ko.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var n=new fh(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(t._coordinates[r]);return n.append(")"),n.toString()}else return"()"};ko.prototype.getY=function(t){return this._coordinates[t].y};ko.prototype.toCoordinateArray=function(){return this._coordinates};ko.prototype.interfaces_=function(){return[Tn,Pc]};ko.prototype.getClass=function(){return ko};sj.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(ko,sj);var yd=function(){},TB={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};yd.prototype.readResolve=function(){return yd.instance()};yd.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new ko(t)}else if(Rt(arguments[0],Tn)){var n=arguments[0];return new ko(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return o>3&&(o=3),o<2?new ko(r):new ko(r,o)}};yd.prototype.interfaces_=function(){return[nx,Pc]};yd.prototype.getClass=function(){return yd};yd.instance=function(){return yd.instanceObject};TB.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};TB.instanceObject.get=function(){return new yd};Object.defineProperties(yd,TB);var uj=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,o){return this.map_.set(r,o),o},t.prototype.values=function(){for(var r=new Be,o=this.map_.values(),a=o.next();!a.done;)r.add(a.value),a=o.next();return r},t.prototype.entrySet=function(){var r=new wB;return this.map_.entries().forEach(function(o){return r.add(o)}),r},t.prototype.size=function(){return this.map_.size()},t}(Py),Gr=function e(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof rh){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},SB={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Gr.prototype.equals=function(t){if(!(t instanceof Gr))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale};Gr.prototype.compareTo=function(t){var n=t,r=this.getMaximumSignificantDigits(),o=n.getMaximumSignificantDigits();return new eh(r).compareTo(new eh(o))};Gr.prototype.getScale=function(){return this._scale};Gr.prototype.isFloating=function(){return this._modelType===Gr.FLOATING||this._modelType===Gr.FLOATING_SINGLE};Gr.prototype.getType=function(){return this._modelType};Gr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Gr.FLOATING?t="Floating":this._modelType===Gr.FLOATING_SINGLE?t="Floating-Single":this._modelType===Gr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};Gr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Kt.isNaN(t))return t;if(this._modelType===Gr.FLOATING_SINGLE){var n=t;return n}return this._modelType===Gr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof oe){var r=arguments[0];if(this._modelType===Gr.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Gr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Gr.FLOATING?t=16:this._modelType===Gr.FLOATING_SINGLE?t=6:this._modelType===Gr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};Gr.prototype.setScale=function(t){this._scale=Math.abs(t)};Gr.prototype.interfaces_=function(){return[Pc,Dc]};Gr.prototype.getClass=function(){return Gr};Gr.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n};SB.serialVersionUID.get=function(){return 7777263578777804e3};SB.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Gr,SB);var rh=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},AB={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};rh.prototype.readResolve=function(){return rh.nameToTypeMap.get(this._name)};rh.prototype.toString=function(){return this._name};rh.prototype.interfaces_=function(){return[Pc]};rh.prototype.getClass=function(){return rh};AB.serialVersionUID.get=function(){return-552860263173159e4};AB.nameToTypeMap.get=function(){return new uj};Object.defineProperties(rh,AB);Gr.Type=rh;Gr.FIXED=new rh("FIXED");Gr.FLOATING=new rh("FLOATING");Gr.FLOATING_SINGLE=new rh("FLOATING SINGLE");var dn=function e(){this._precisionModel=new Gr,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Rt(arguments[0],nx)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Gr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},lj={serialVersionUID:{configurable:!0}};dn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new oe(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new oe(t.getMinX(),t.getMinY()),new oe(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new oe(t.getMinX(),t.getMinY()),new oe(t.getMinX(),t.getMaxY()),new oe(t.getMaxX(),t.getMaxY()),new oe(t.getMaxX(),t.getMinY()),new oe(t.getMinX(),t.getMinY())]),null)};dn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new Po(this.getCoordinateSequenceFactory().create(t),this);if(Rt(t,Tn))return new Po(t,this)}else return new Po(this.getCoordinateSequenceFactory().create([]),this)};dn.prototype.createMultiLineString=function(){if(arguments.length===0)return new A0(null,this);if(arguments.length===1){var t=arguments[0];return new A0(t,this)}};dn.prototype.buildGeometry=function(t){for(var n=null,r=!1,o=!1,a=t.iterator();a.hasNext();){var s=a.next(),u=s.getClass();n===null&&(n=u),u!==n&&(r=!0),s.isGeometryCollectionOrDerived()&&(o=!0)}if(n===null)return this.createGeometryCollection();if(r||o)return this.createGeometryCollection(dn.toGeometryArray(t));var l=t.iterator().next(),c=t.size()>1;if(c){if(l instanceof Ea)return this.createMultiPolygon(dn.toPolygonArray(t));if(l instanceof Po)return this.createMultiLineString(dn.toLineStringArray(t));if(l instanceof hl)return this.createMultiPoint(dn.toPointArray(t));on.shouldNeverReachHere("Unhandled class: "+l.getClass().getName())}return l};dn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};dn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof oe){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Rt(arguments[0],Tn)){var n=arguments[0];return new hl(n,this)}}};dn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};dn.prototype.createPolygon=function(){if(arguments.length===0)return new Ea(null,null,this);if(arguments.length===1){if(Rt(arguments[0],Tn)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof _d){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return new Ea(o,a,this)}};dn.prototype.getSRID=function(){return this._SRID};dn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new cu(null,this);if(arguments.length===1){var t=arguments[0];return new cu(t,this)}};dn.prototype.createGeometry=function(t){var n=new bc(this);return n.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};dn.prototype.getPrecisionModel=function(){return this._precisionModel};dn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Rt(arguments[0],Tn)){var n=arguments[0];return new _d(n,this)}}};dn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new pd(null,this);if(arguments.length===1){var t=arguments[0];return new pd(t,this)}};dn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new ux(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new ux(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(Rt(arguments[0],Tn)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(o.size()).fill(null),s=0;s<o.size();s++){var u=t.getCoordinateSequenceFactory().create(1,o.getDimension());Uo.copy(o,s,u,0,1),a[s]=t.createPoint(u)}return this.createMultiPoint(a)}}};dn.prototype.interfaces_=function(){return[Pc]};dn.prototype.getClass=function(){return dn};dn.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.getDefaultCoordinateSequenceFactory=function(){return yd.instance()};dn.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};dn.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)};lj.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(dn,lj);var fwe=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],HP=function(t){this.geometryFactory=t||new dn};HP.prototype.read=function(t){var n;typeof t=="string"?n=JSON.parse(t):n=t;var r=n.type;if(!jf[r])throw new Error("Unknown GeoJSON type: "+n.type);return fwe.indexOf(r)!==-1?jf[r].apply(this,[n.coordinates]):r==="GeometryCollection"?jf[r].apply(this,[n.geometries]):jf[r].apply(this,[n])};HP.prototype.write=function(t){var n=t.getGeometryType();if(!vp[n])throw new Error("Geometry is not supported");return vp[n].apply(this,[t])};var jf={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var r=e.geometry.type;if(!jf[r])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=jf.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t=this,n={};if(e.features){n.features=[];for(var r=0;r<e.features.length;++r)n.features.push(t.read(e.features[r]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push(new oe(r[0],r[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new oe(e[0],e[1]),new oe(e[2],e[1]),new oe(e[2],e[3]),new oe(e[0],e[3]),new oe(e[0],e[1])])},Point:function(e){var t=new oe(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(jf.Point.apply(t,[e[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var t=jf.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(jf.LineString.apply(t,[e[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var t=this,n=jf.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(n),o=[],a=1;a<e.length;++a){var s=e[a],u=jf.coordinates.apply(t,[s]),l=t.geometryFactory.createLinearRing(u);o.push(l)}return this.geometryFactory.createPolygon(r,o)},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(jf.Polygon.apply(t,[o]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(t.read(o))}return this.geometryFactory.createGeometryCollection(n)}},vp={coordinate:function(e){return[e.x,e.y]},Point:function(e){var t=vp.coordinate.apply(this,[e.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=vp.Point.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var t=this,n=[],r=e.getCoordinates(),o=0;o<r.length;++o){var a=r[o];n.push(vp.coordinate.apply(t,[a]))}return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=vp.LineString.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var t=this,n=[],r=vp.LineString.apply(this,[e._shell]);n.push(r.coordinates);for(var o=0;o<e._holes.length;++o){var a=e._holes[o],s=vp.LineString.apply(t,[a]);n.push(s.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=vp.Polygon.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=o.getGeometryType();n.push(vp[a].apply(t,[o]))}return{type:"GeometryCollection",geometries:n}}},Ix=function(t){this.geometryFactory=t||new dn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new HP(this.geometryFactory)};Ix.prototype.read=function(t){var n=this.parser.read(t);return this.precisionModel.getType()===Gr.FIXED&&this.reducePrecision(n),n};Ix.prototype.reducePrecision=function(t){var n=this,r,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,o=t.points.length;r<o;r++)n.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,o=t.geometries.length;r<o;r++)n.reducePrecision(t.geometries[r])};var tS=function(){this.parser=new HP(this.geometryFactory)};tS.prototype.write=function(t){return this.parser.write(t)};var Pe=function(){},qP={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Pe.prototype.interfaces_=function(){return[]};Pe.prototype.getClass=function(){return Pe};Pe.opposite=function(t){return t===Pe.LEFT?Pe.RIGHT:t===Pe.RIGHT?Pe.LEFT:t};qP.ON.get=function(){return 0};qP.LEFT.get=function(){return 1};qP.RIGHT.get=function(){return 2};Object.defineProperties(Pe,qP);function WP(e){this.message=e||""}WP.prototype=new Error;WP.prototype.name="EmptyStackException";function hh(){this.array_=[]}hh.prototype=new of;hh.prototype.add=function(e){return this.array_.push(e),!0};hh.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]};hh.prototype.push=function(e){return this.array_.push(e),e};hh.prototype.pop=function(e){if(this.array_.length===0)throw new WP;return this.array_.pop()};hh.prototype.peek=function(){if(this.array_.length===0)throw new WP;return this.array_[this.array_.length-1]};hh.prototype.empty=function(){return this.array_.length===0};hh.prototype.isEmpty=function(){return this.empty()};hh.prototype.search=function(e){return this.array_.indexOf(e)};hh.prototype.size=function(){return this.array_.length};hh.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};var ih=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};ih.prototype.getCoordinate=function(){return this._minCoord};ih.prototype.getRightmostSide=function(t,n){var r=this.getRightmostSideOfSegment(t,n);return r<0&&(r=this.getRightmostSideOfSegment(t,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};ih.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();on.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this._minIndex-1],r=t[this._minIndex+1],o=Ue.computeOrientation(this._minCoord,r,n),a=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&o===Ue.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&o===Ue.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};ih.prototype.getRightmostSideOfSegment=function(t,n){var r=t.getEdge(),o=r.getCoordinates();if(n<0||n+1>=o.length||o[n].y===o[n+1].y)return-1;var a=Pe.LEFT;return o[n].y<o[n+1].y&&(a=Pe.RIGHT),a};ih.prototype.getEdge=function(){return this._orientedDe};ih.prototype.checkForRightmostCoordinate=function(t){for(var n=this,r=t.getEdge().getCoordinates(),o=0;o<r.length-1;o++)(n._minCoord===null||r[o].x>n._minCoord.x)&&(n._minDe=t,n._minIndex=o,n._minCoord=r[o])};ih.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),n=t.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};ih.prototype.findEdge=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();!o.isForward()||n.checkForRightmostCoordinate(o)}on.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Pe.LEFT&&(this._orientedDe=this._minDe.getSym())};ih.prototype.interfaces_=function(){return[]};ih.prototype.getClass=function(){return ih};var Ip=function(e){function t(n,r){e.call(this,t.msgWithCoord(n,r)),this.pt=r?new oe(r):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,o){return o?r:r+" [ "+o+" ]"},t}(Ap),YP=function(){this.array_=[]};YP.prototype.addLast=function(t){this.array_.push(t)};YP.prototype.removeFirst=function(){return this.array_.shift()};YP.prototype.isEmpty=function(){return this.array_.length===0};var fu=function(){this._finder=null,this._dirEdgeList=new Be,this._nodes=new Be,this._rightMostCoord=null,this._env=null,this._finder=new ih};fu.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}};fu.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};fu.prototype.computeNodeDepth=function(t){for(var n=this,r=null,o=t.getEdges().iterator();o.hasNext();){var a=o.next();if(a.isVisited()||a.getSym().isVisited()){r=a;break}}if(r===null)throw new Ip("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var s=t.getEdges().iterator();s.hasNext();){var u=s.next();u.setVisited(!0),n.copySymDepths(u)}};fu.prototype.computeDepth=function(t){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(Pe.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)};fu.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};fu.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Pe.RIGHT)>=1&&n.getDepth(Pe.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};fu.prototype.computeDepths=function(t){var n=this,r=new wB,o=new YP,a=t.getNode();for(o.addLast(a),r.add(a),t.setVisited(!0);!o.isEmpty();){var s=o.removeFirst();r.add(s),n.computeNodeDepth(s);for(var u=s.getEdges().iterator();u.hasNext();){var l=u.next(),c=l.getSym();if(!c.isVisited()){var f=c.getNode();r.contains(f)||(o.addLast(f),r.add(f))}}}};fu.prototype.compareTo=function(t){var n=t;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};fu.prototype.getEnvelope=function(){if(this._env===null){for(var t=new lt,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),o=r.getEdge().getCoordinates(),a=0;a<o.length-1;a++)t.expandToInclude(o[a]);this._env=t}return this._env};fu.prototype.addReachable=function(t){var n=this,r=new hh;for(r.add(t);!r.empty();){var o=r.pop();n.add(o,r)}};fu.prototype.copySymDepths=function(t){var n=t.getSym();n.setDepth(Pe.LEFT,t.getDepth(Pe.RIGHT)),n.setDepth(Pe.RIGHT,t.getDepth(Pe.LEFT))};fu.prototype.add=function(t,n){var r=this;t.setVisited(!0),this._nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var a=o.next();r._dirEdgeList.add(a);var s=a.getSym(),u=s.getNode();u.isVisited()||n.push(u)}};fu.prototype.getNodes=function(){return this._nodes};fu.prototype.getDirectedEdges=function(){return this._dirEdgeList};fu.prototype.interfaces_=function(){return[Dc]};fu.prototype.getClass=function(){return fu};var qi=function e(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Pe.ON]=r}else if(arguments[0]instanceof e){var o=arguments[0];if(this.init(o.location.length),o!==null)for(var a=0;a<this.location.length;a++)t.location[a]=o.location[a]}}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.init(3),this.location[Pe.ON]=s,this.location[Pe.LEFT]=u,this.location[Pe.RIGHT]=l}};qi.prototype.setAllLocations=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=t};qi.prototype.isNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]!==fe.NONE)return!1;return!0};qi.prototype.setAllLocationsIfNull=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===fe.NONE&&(n.location[r]=t)};qi.prototype.isLine=function(){return this.location.length===1};qi.prototype.merge=function(t){var n=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[Pe.ON]=this.location[Pe.ON],r[Pe.LEFT]=fe.NONE,r[Pe.RIGHT]=fe.NONE,this.location=r}for(var o=0;o<this.location.length;o++)n.location[o]===fe.NONE&&o<t.location.length&&(n.location[o]=t.location[o])};qi.prototype.getLocations=function(){return this.location};qi.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Pe.LEFT];this.location[Pe.LEFT]=this.location[Pe.RIGHT],this.location[Pe.RIGHT]=t};qi.prototype.toString=function(){var t=new fh;return this.location.length>1&&t.append(fe.toLocationSymbol(this.location[Pe.LEFT])),t.append(fe.toLocationSymbol(this.location[Pe.ON])),this.location.length>1&&t.append(fe.toLocationSymbol(this.location[Pe.RIGHT])),t.toString()};qi.prototype.setLocations=function(t,n,r){this.location[Pe.ON]=t,this.location[Pe.LEFT]=n,this.location[Pe.RIGHT]=r};qi.prototype.get=function(t){return t<this.location.length?this.location[t]:fe.NONE};qi.prototype.isArea=function(){return this.location.length>1};qi.prototype.isAnyNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]===fe.NONE)return!0;return!1};qi.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Pe.ON,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};qi.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(fe.NONE)};qi.prototype.isEqualOnSide=function(t,n){return this.location[n]===t.location[n]};qi.prototype.allPositionsEqual=function(t){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==t)return!1;return!0};qi.prototype.interfaces_=function(){return[]};qi.prototype.getClass=function(){return qi};var ri=function e(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new qi(t),this.elt[1]=new qi(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new qi(n.elt[0]),this.elt[1]=new qi(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.elt[0]=new qi(fe.NONE),this.elt[1]=new qi(fe.NONE),this.elt[r].setLocation(o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this.elt[0]=new qi(a,s,u),this.elt[1]=new qi(a,s,u)}else if(arguments.length===4){var l=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3];this.elt[0]=new qi(fe.NONE,fe.NONE,fe.NONE),this.elt[1]=new qi(fe.NONE,fe.NONE,fe.NONE),this.elt[l].setLocations(c,f,h)}};ri.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};ri.prototype.setAllLocations=function(t,n){this.elt[t].setAllLocations(n)};ri.prototype.isNull=function(t){return this.elt[t].isNull()};ri.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};ri.prototype.isLine=function(t){return this.elt[t].isLine()};ri.prototype.merge=function(t){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&t.elt[r]!==null?n.elt[r]=new qi(t.elt[r]):n.elt[r].merge(t.elt[r])};ri.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};ri.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Pe.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};ri.prototype.toString=function(){var t=new fh;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};ri.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};ri.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};ri.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Pe.ON,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this.elt[r].setLocation(o,a)}};ri.prototype.isEqualOnSide=function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)};ri.prototype.allPositionsEqual=function(t,n){return this.elt[t].allPositionsEqual(n)};ri.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new qi(this.elt[t].location[0]))};ri.prototype.interfaces_=function(){return[]};ri.prototype.getClass=function(){return ri};ri.toLineLabel=function(t){for(var n=new ri(fe.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n};var sa=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Be,this._pts=new Be,this._label=new ri(fe.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Be,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()};sa.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=Ue.isCCW(this._ring.getCoordinates())};sa.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};sa.prototype.computePoints=function(t){var n=this;this._startDe=t;var r=t,o=!0;do{if(r===null)throw new Ip("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new Ip("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var a=r.getLabel();on.isTrue(a.isArea()),n.mergeLabel(a),n.addPoints(r.getEdge(),r.isForward(),o),o=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};sa.prototype.getLinearRing=function(){return this._ring};sa.prototype.getCoordinate=function(t){return this._pts.get(t)};sa.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),o=r.getEdges().getOutgoingDegree(t);o>t._maxNodeDegree&&(t._maxNodeDegree=o),n=t.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};sa.prototype.addPoints=function(t,n,r){var o=this,a=t.getCoordinates();if(n){var s=1;r&&(s=0);for(var u=s;u<a.length;u++)o._pts.add(a[u])}else{var l=a.length-2;r&&(l=a.length-1);for(var c=l;c>=0;c--)o._pts.add(a[c])}};sa.prototype.isHole=function(){return this._isHole};sa.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};sa.prototype.containsPoint=function(t){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(t)||!Ue.isPointInRing(t,n.getCoordinates()))return!1;for(var o=this._holes.iterator();o.hasNext();){var a=o.next();if(a.containsPoint(t))return!1}return!0};sa.prototype.addHole=function(t){this._holes.add(t)};sa.prototype.isShell=function(){return this._shell===null};sa.prototype.getLabel=function(){return this._label};sa.prototype.getEdges=function(){return this._edges};sa.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};sa.prototype.getShell=function(){return this._shell};sa.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=n.getLocation(r,Pe.RIGHT);if(o===fe.NONE)return null;if(this._label.getLocation(r)===fe.NONE)return this._label.setLocation(r,o),null}};sa.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};sa.prototype.toPolygon=function(t){for(var n=this,r=new Array(this._holes.size()).fill(null),o=0;o<this._holes.size();o++)r[o]=n._holes.get(o).getLinearRing();var a=t.createPolygon(this.getLinearRing(),r);return a};sa.prototype.interfaces_=function(){return[]};sa.prototype.getClass=function(){return sa};var hwe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,o){r.setMinEdgeRing(o)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(sa),dwe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,o=new Be,a=this._startDe;do{if(a.getMinEdgeRing()===null){var s=new hwe(a,r._geometryFactory);o.add(s)}a=a.getNext()}while(a!==this._startDe);return o},t.prototype.setEdgeRing=function(r,o){r.setEdgeRing(o)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,o=this._startDe;do{var a=o.getNode();a.getEdges().linkMinimalDirectedEdges(r),o=o.getNext()}while(o!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(sa),Wl=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};Wl.prototype.setVisited=function(t){this._isVisited=t};Wl.prototype.setInResult=function(t){this._isInResult=t};Wl.prototype.isCovered=function(){return this._isCovered};Wl.prototype.isCoveredSet=function(){return this._isCoveredSet};Wl.prototype.setLabel=function(t){this._label=t};Wl.prototype.getLabel=function(){return this._label};Wl.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};Wl.prototype.updateIM=function(t){on.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};Wl.prototype.isInResult=function(){return this._isInResult};Wl.prototype.isVisited=function(){return this._isVisited};Wl.prototype.interfaces_=function(){return[]};Wl.prototype.getClass=function(){return Wl};var XP=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new ri(0,fe.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var o=r.next();if(o.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,o){var a=fe.NONE;if(a=this._label.getLocation(o),!r.isNull(o)){var s=r.getLocation(o);a!==fe.BOUNDARY&&(a=s)}return a},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];this._label===null?this._label=new ri(r,o):this._label.setLocation(r,o)}else return e.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var o=arguments[0];this.mergeLabel(o._label)}else if(arguments[0]instanceof ri)for(var a=arguments[0],s=0;s<2;s++){var u=r.computeMergedLocation(a,s),l=r._label.getLocation(s);l===fe.NONE&&r._label.setLocation(s,u)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var o=fe.NONE;this._label!==null&&(o=this._label.getLocation(r));var a=null;switch(o){case fe.BOUNDARY:a=fe.INTERIOR;break;case fe.INTERIOR:a=fe.BOUNDARY;break;default:a=fe.BOUNDARY;break}this._label.setLocation(r,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Wl),oh=function(){this.nodeMap=new zs,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};oh.prototype.find=function(t){return this.nodeMap.get(t)};oh.prototype.addNode=function(){if(arguments[0]instanceof oe){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}else if(arguments[0]instanceof XP){var r=arguments[0],o=this.nodeMap.get(r.getCoordinate());return o===null?(this.nodeMap.put(r.getCoordinate(),r),r):(o.mergeLabel(r),o)}};oh.prototype.print=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};oh.prototype.iterator=function(){return this.nodeMap.values().iterator()};oh.prototype.values=function(){return this.nodeMap.values()};oh.prototype.getBoundaryNodes=function(t){for(var n=new Be,r=this.iterator();r.hasNext();){var o=r.next();o.getLabel().getLocation(t)===fe.BOUNDARY&&n.add(o)}return n};oh.prototype.add=function(t){var n=t.getCoordinate(),r=this.addNode(n);r.add(t)};oh.prototype.interfaces_=function(){return[]};oh.prototype.getClass=function(){return oh};var bi=function(){},nS={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};bi.prototype.interfaces_=function(){return[]};bi.prototype.getClass=function(){return bi};bi.isNorthern=function(t){return t===bi.NE||t===bi.NW};bi.isOpposite=function(t,n){if(t===n)return!1;var r=(t-n+4)%4;return r===2};bi.commonHalfPlane=function(t,n){if(t===n)return t;var r=(t-n+4)%4;if(r===2)return-1;var o=t<n?t:n,a=t>n?t:n;return o===0&&a===3?3:o};bi.isInHalfPlane=function(t,n){return n===bi.SE?t===bi.SE||t===bi.SW:t===n||t===n+1};bi.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new uo("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?bi.NE:bi.SE:n>=0?bi.NW:bi.SW}else if(arguments[0]instanceof oe&&arguments[1]instanceof oe){var r=arguments[0],o=arguments[1];if(o.x===r.x&&o.y===r.y)throw new uo("Cannot compute the quadrant for two identical points "+r);return o.x>=r.x?o.y>=r.y?bi.NE:bi.SE:o.y>=r.y?bi.NW:bi.SW}};nS.NE.get=function(){return 0};nS.NW.get=function(){return 1};nS.SW.get=function(){return 2};nS.SE.get=function(){return 3};Object.defineProperties(bi,nS);var Vs=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=null;this._edge=n,this.init(r,o),this._label=a}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this._edge=s,this.init(u,l),this._label=c}};Vs.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Ue.computeOrientation(t._p0,t._p1,this._p1)};Vs.prototype.getDy=function(){return this._dy};Vs.prototype.getCoordinate=function(){return this._p0};Vs.prototype.setNode=function(t){this._node=t};Vs.prototype.print=function(t){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),o=r.lastIndexOf("."),a=r.substring(o+1);t.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Vs.prototype.compareTo=function(t){var n=t;return this.compareDirection(n)};Vs.prototype.getDirectedCoordinate=function(){return this._p1};Vs.prototype.getDx=function(){return this._dx};Vs.prototype.getLabel=function(){return this._label};Vs.prototype.getEdge=function(){return this._edge};Vs.prototype.getQuadrant=function(){return this._quadrant};Vs.prototype.getNode=function(){return this._node};Vs.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),o=n.substring(r+1);return"  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Vs.prototype.computeLabel=function(t){};Vs.prototype.init=function(t,n){this._p0=t,this._p1=n,this._dx=n.x-t.x,this._dy=n.y-t.y,this._quadrant=bi.quadrant(this._dx,this._dy),on.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Vs.prototype.interfaces_=function(){return[Dc]};Vs.prototype.getClass=function(){return Vs};var z3=function(e){function t(){var n=arguments[0],r=arguments[1];if(e.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var o=n.getNumPoints()-1;this.init(n.getCoordinate(o),n.getCoordinate(o-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new ri(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,o){if(this._depth[r]!==-999&&this._depth[r]!==o)throw new Ip("assigned depths do not match",this.getCoordinate());this._depth[r]=o},t.prototype.isInteriorAreaEdge=function(){for(var r=this,o=!0,a=0;a<2;a++)r._label.isArea(a)&&r._label.getLocation(a,Pe.LEFT)===fe.INTERIOR&&r._label.getLocation(a,Pe.RIGHT)===fe.INTERIOR||(o=!1);return o},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){e.prototype.print.call(this,r),r.print(" "+this._depth[Pe.LEFT]+"/"+this._depth[Pe.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,fe.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,fe.EXTERIOR);return r&&o&&a},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,o){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var s=1;r===Pe.LEFT&&(s=-1);var u=Pe.opposite(r),l=a*s,c=o+l;this.setDepth(r,o),this.setDepth(u,c)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,o){return r===fe.EXTERIOR&&o===fe.INTERIOR?1:r===fe.INTERIOR&&o===fe.EXTERIOR?-1:0},t}(Vs),lx=function(){};lx.prototype.createNode=function(t){return new XP(t,null)};lx.prototype.interfaces_=function(){return[]};lx.prototype.getClass=function(){return lx};var wo=function(){if(this._edges=new Be,this._nodes=null,this._edgeEndList=new Be,arguments.length===0)this._nodes=new oh(new lx);else if(arguments.length===1){var t=arguments[0];this._nodes=new oh(t)}};wo.prototype.printEdges=function(t){var n=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var o=n._edges.get(r);o.print(t),o.eiList.print(t)}};wo.prototype.find=function(t){return this._nodes.find(t)};wo.prototype.addNode=function(){if(arguments[0]instanceof XP){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof oe){var n=arguments[0];return this._nodes.addNode(n)}};wo.prototype.getNodeIterator=function(){return this._nodes.iterator()};wo.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}};wo.prototype.debugPrintln=function(t){ps.out.println(t)};wo.prototype.isBoundaryNode=function(t,n){var r=this._nodes.find(n);if(r===null)return!1;var o=r.getLabel();return o!==null&&o.getLocation(t)===fe.BOUNDARY};wo.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}};wo.prototype.matchInSameDirection=function(t,n,r,o){return t.equals(r)?Ue.computeOrientation(t,n,o)===Ue.COLLINEAR&&bi.quadrant(t,n)===bi.quadrant(r,o):!1};wo.prototype.getEdgeEnds=function(){return this._edgeEndList};wo.prototype.debugPrint=function(t){ps.out.print(t)};wo.prototype.getEdgeIterator=function(){return this._edges.iterator()};wo.prototype.findEdgeInSameDirection=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(r.matchInSameDirection(t,n,s[0],s[1])||r.matchInSameDirection(t,n,s[s.length-1],s[s.length-2]))return a}return null};wo.prototype.insertEdge=function(t){this._edges.add(t)};wo.prototype.findEdgeEnd=function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===t)return r}return null};wo.prototype.addEdges=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();n._edges.add(o);var a=new z3(o,!0),s=new z3(o,!1);a.setSym(s),s.setSym(a),n.add(a),n.add(s)}};wo.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};wo.prototype.getNodes=function(){return this._nodes.values()};wo.prototype.findEdge=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(t.equals(s[0])&&n.equals(s[1]))return a}return null};wo.prototype.interfaces_=function(){return[]};wo.prototype.getClass=function(){return wo};wo.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var dl=function(){this._geometryFactory=null,this._shellList=new Be;var t=arguments[0];this._geometryFactory=t};dl.prototype.sortShellsAndHoles=function(t,n,r){for(var o=t.iterator();o.hasNext();){var a=o.next();a.isHole()?r.add(a):n.add(a)}};dl.prototype.computePolygons=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=a.toPolygon(n._geometryFactory);r.add(s)}return r};dl.prototype.placeFreeHoles=function(t,n){for(var r=this,o=n.iterator();o.hasNext();){var a=o.next();if(a.getShell()===null){var s=r.findEdgeRingContaining(a,t);if(s===null)throw new Ip("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(s)}}};dl.prototype.buildMinimalEdgeRings=function(t,n,r){for(var o=this,a=new Be,s=t.iterator();s.hasNext();){var u=s.next();if(u.getMaxNodeDegree()>2){u.linkDirectedEdgesForMinimalEdgeRings();var l=u.buildMinimalRings(),c=o.findShell(l);c!==null?(o.placePolygonHoles(c,l),n.add(c)):r.addAll(l)}else a.add(u)}return a};dl.prototype.containsPoint=function(t){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(t))return!0}return!1};dl.prototype.buildMaximalEdgeRings=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var s=new dwe(a,n._geometryFactory);r.add(s),s.setInResult()}}return r};dl.prototype.placePolygonHoles=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next();o.isHole()&&o.setShell(t)}};dl.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};dl.prototype.findEdgeRingContaining=function(t,n){for(var r=t.getLinearRing(),o=r.getEnvelopeInternal(),a=r.getCoordinateN(0),s=null,u=null,l=n.iterator();l.hasNext();){var c=l.next(),f=c.getLinearRing(),h=f.getEnvelopeInternal();s!==null&&(u=s.getLinearRing().getEnvelopeInternal());var d=!1;h.contains(o)&&Ue.isPointInRing(a,f.getCoordinates())&&(d=!0),d&&(s===null||u.contains(h))&&(s=c)}return s};dl.prototype.findShell=function(t){for(var n=0,r=null,o=t.iterator();o.hasNext();){var a=o.next();a.isHole()||(r=a,n++)}return on.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};dl.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];wo.linkResultDirectedEdges(r);var o=this.buildMaximalEdgeRings(n),a=new Be,s=this.buildMinimalEdgeRings(o,this._shellList,a);this.sortShellsAndHoles(s,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};dl.prototype.interfaces_=function(){return[]};dl.prototype.getClass=function(){return dl};var cx=function(){};cx.prototype.getBounds=function(){};cx.prototype.interfaces_=function(){return[]};cx.prototype.getClass=function(){return cx};var uf=function(){this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n};uf.prototype.getItem=function(){return this._item};uf.prototype.getBounds=function(){return this._bounds};uf.prototype.interfaces_=function(){return[cx,Pc]};uf.prototype.getClass=function(){return uf};var Dp=function(){this._size=null,this._items=null,this._size=0,this._items=new Be,this._items.add(null)};Dp.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};Dp.prototype.size=function(){return this._size};Dp.prototype.reorder=function(t){for(var n=this,r=null,o=this._items.get(t);t*2<=this._size&&(r=t*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(o)<0);t=r)n._items.set(t,n._items.get(r));this._items.set(t,o)};Dp.prototype.clear=function(){this._size=0,this._items.clear()};Dp.prototype.isEmpty=function(){return this._size===0};Dp.prototype.add=function(t){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,t)};Dp.prototype.interfaces_=function(){return[]};Dp.prototype.getClass=function(){return Dp};var Xm=function(){};Xm.prototype.visitItem=function(t){};Xm.prototype.interfaces_=function(){return[]};Xm.prototype.getClass=function(){return Xm};var _y=function(){};_y.prototype.insert=function(t,n){};_y.prototype.remove=function(t,n){};_y.prototype.query=function(){};_y.prototype.interfaces_=function(){return[]};_y.prototype.getClass=function(){return _y};var xa=function(){if(this._childBoundables=new Be,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},cj={serialVersionUID:{configurable:!0}};xa.prototype.getLevel=function(){return this._level};xa.prototype.size=function(){return this._childBoundables.size()};xa.prototype.getChildBoundables=function(){return this._childBoundables};xa.prototype.addChildBoundable=function(t){on.isTrue(this._bounds===null),this._childBoundables.add(t)};xa.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};xa.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};xa.prototype.interfaces_=function(){return[cx,Pc]};xa.prototype.getClass=function(){return xa};cj.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(xa,cj);var lf=function(){};lf.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};lf.min=function(t){return lf.sort(t),t.get(0)};lf.sort=function(t,n){var r=t.toArray();n?w0.sort(r,n):w0.sort(r);for(var o=t.iterator(),a=0,s=r.length;a<s;a++)o.next(),o.set(r[a])};lf.singletonList=function(t){var n=new Be;return n.add(t),n};var ia=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};ia.prototype.expandToQueue=function(t,n){var r=ia.isComposite(this._boundable1),o=ia.isComposite(this._boundable2);if(r&&o)return ia.area(this._boundable1)>ia.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,t,n),null;if(o)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new uo("neither boundable is composite")};ia.prototype.isLeaves=function(){return!(ia.isComposite(this._boundable1)||ia.isComposite(this._boundable2))};ia.prototype.compareTo=function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0};ia.prototype.expand=function(t,n,r,o){for(var a=this,s=t.getChildBoundables(),u=s.iterator();u.hasNext();){var l=u.next(),c=new ia(l,n,a._itemDistance);c.getDistance()<o&&r.add(c)}};ia.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};ia.prototype.getDistance=function(){return this._distance};ia.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};ia.prototype.interfaces_=function(){return[Dc]};ia.prototype.getClass=function(){return ia};ia.area=function(t){return t.getBounds().getArea()};ia.isComposite=function(t){return t instanceof xa};var ja=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Be,this._nodeCapacity=null,arguments.length===0){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var n=arguments[0];on.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},jP={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ja.prototype.getNodeCapacity=function(){return this._nodeCapacity};ja.prototype.lastNode=function(t){return t.get(t.size()-1)};ja.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof xa?r+=t.size(a):a instanceof uf&&(r+=1)}return r}};ja.prototype.removeItem=function(t,n){for(var r=null,o=t.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof uf&&a.getItem()===n&&(r=a)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};ja.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new Be:n}else if(arguments.length===1){for(var r=arguments[0],o=new Be,a=r.getChildBoundables().iterator();a.hasNext();){var s=a.next();if(s instanceof xa){var u=t.itemsTree(s);u!==null&&o.add(u)}else s instanceof uf?o.add(s.getItem()):on.shouldNeverReachHere()}return o.size()<=0?null:o}};ja.prototype.insert=function(t,n){on.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new uf(t,n))};ja.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var n=arguments[0],r=new Be;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(on.isTrue(o>-2),a.getLevel()===o)return s.add(a),null;for(var u=a.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof xa?t.boundablesAtLevel(o,l,s):(on.isTrue(l instanceof uf),o===-1&&s.add(l))}return null}};ja.prototype.query=function(){var t=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new Be;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var o=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,a)}else if(arguments.length===3){if(Rt(arguments[2],Xm)&&arguments[0]instanceof Object&&arguments[1]instanceof xa)for(var s=arguments[0],u=arguments[1],l=arguments[2],c=u.getChildBoundables(),f=0;f<c.size();f++){var h=c.get(f);!t.getIntersectsOp().intersects(h.getBounds(),s)||(h instanceof xa?t.query(s,h,l):h instanceof uf?l.visitItem(h.getItem()):on.shouldNeverReachHere())}else if(Rt(arguments[2],of)&&arguments[0]instanceof Object&&arguments[1]instanceof xa)for(var d=arguments[0],p=arguments[1],_=arguments[2],y=p.getChildBoundables(),v=0;v<y.size();v++){var w=y.get(v);!t.getIntersectsOp().intersects(w.getBounds(),d)||(w instanceof xa?t.query(d,w,_):w instanceof uf?_.add(w.getItem()):on.shouldNeverReachHere())}}};ja.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};ja.prototype.getRoot=function(){return this.build(),this._root};ja.prototype.remove=function(){var t=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=this.removeItem(a,s);if(u)return!0;for(var l=null,c=a.getChildBoundables().iterator();c.hasNext();){var f=c.next();if(!!t.getIntersectsOp().intersects(f.getBounds(),o)&&f instanceof xa&&(u=t.remove(o,f,s),u)){l=f;break}}return l!==null&&l.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(l),u}};ja.prototype.createHigherLevels=function(t,n){on.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};ja.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();if(a instanceof xa){var s=t.depth(a);s>r&&(r=s)}}return r+1}};ja.prototype.createParentBoundables=function(t,n){var r=this;on.isTrue(!t.isEmpty());var o=new Be;o.add(this.createNode(n));var a=new Be(t);lf.sort(a,this.getComparator());for(var s=a.iterator();s.hasNext();){var u=s.next();r.lastNode(o).getChildBoundables().size()===r.getNodeCapacity()&&o.add(r.createNode(n)),r.lastNode(o).addChildBoundable(u)}return o};ja.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};ja.prototype.interfaces_=function(){return[Pc]};ja.prototype.getClass=function(){return ja};ja.compareDoubles=function(t,n){return t>n?1:t<n?-1:0};jP.IntersectsOp.get=function(){return pwe};jP.serialVersionUID.get=function(){return-3886435814360241e3};jP.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(ja,jP);var pwe=function(){},fx=function(){};fx.prototype.distance=function(t,n){};fx.prototype.interfaces_=function(){return[]};fx.prototype.getClass=function(){return fx};var fj=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(o,a){var s=this;on.isTrue(o.length>0);for(var u=new Be,l=0;l<o.length;l++)u.addAll(s.createParentBoundablesFromVerticalSlice(o[l],a));return u},t.prototype.createNode=function(o){return new _Y(o)},t.prototype.size=function(){return arguments.length===0?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];if(o.isNull())return null;e.prototype.insert.call(this,o,a)}else return e.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(o,a){for(var s=Math.trunc(Math.ceil(o.size()/a)),u=new Array(a).fill(null),l=o.iterator(),c=0;c<a;c++){u[c]=new Be;for(var f=0;l.hasNext()&&f<s;){var h=l.next();u[c].add(h),f++}}return u},t.prototype.query=function(){if(arguments.length===1){var o=arguments[0];return e.prototype.query.call(this,o)}else if(arguments.length===2){var a=arguments[0],s=arguments[1];e.prototype.query.call(this,a,s)}else if(arguments.length===3){if(Rt(arguments[2],Xm)&&arguments[0]instanceof Object&&arguments[1]instanceof xa){var u=arguments[0],l=arguments[1],c=arguments[2];e.prototype.query.call(this,u,l,c)}else if(Rt(arguments[2],of)&&arguments[0]instanceof Object&&arguments[1]instanceof xa){var f=arguments[0],h=arguments[1],d=arguments[2];e.prototype.query.call(this,f,h,d)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(o,a){return e.prototype.createParentBoundables.call(this,o,a)},t.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return e.prototype.remove.call(this,o,a)}else return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(o,a){on.isTrue(!o.isEmpty());var s=Math.trunc(Math.ceil(o.size()/this.getNodeCapacity())),u=new Be(o);lf.sort(u,t.xComparator);var l=this.verticalSlices(u,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(l,a)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Rt(arguments[0],fx)){var o=arguments[0],a=new ia(this.getRoot(),this.getRoot(),o);return this.nearestNeighbour(a)}else if(arguments[0]instanceof ia){var s=arguments[0];return this.nearestNeighbour(s,Kt.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Rt(arguments[1],fx)){var u=arguments[0],l=arguments[1],c=new ia(this.getRoot(),u.getRoot(),l);return this.nearestNeighbour(c)}else if(arguments[0]instanceof ia&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=h,p=null,_=new Dp;for(_.add(f);!_.isEmpty()&&d>0;){var y=_.poll(),v=y.getDistance();if(v>=d)break;y.isLeaves()?(d=v,p=y):y.expandToQueue(_,d)}return[p.getBoundable(0).getItem(),p.getBoundable(1).getItem()]}}else if(arguments.length===3){var w=arguments[0],C=arguments[1],E=arguments[2],S=new uf(w,C),A=new ia(this.getRoot(),S,E);return this.nearestNeighbour(A)[0]}},t.prototype.interfaces_=function(){return[_y,Pc]},t.prototype.getClass=function(){return t},t.centreX=function(o){return t.avg(o.getMinX(),o.getMaxX())},t.avg=function(o,a){return(o+a)/2},t.centreY=function(o){return t.avg(o.getMinY(),o.getMaxY())},n.STRtreeNode.get=function(){return _Y},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[tx]},compare:function(r,o){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(o.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[tx]},compare:function(r,o){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(o.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(r,o){return r.intersects(o)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,n),t}(ja),_Y=function(e){function t(){var n=arguments[0];e.call(this,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,o=this.getChildBoundables().iterator();o.hasNext();){var a=o.next();r===null?r=new lt(a.getBounds()):r.expandToInclude(a.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(xa),Fu=function(){};Fu.prototype.interfaces_=function(){return[]};Fu.prototype.getClass=function(){return Fu};Fu.relativeSign=function(t,n){return t<n?-1:t>n?1:0};Fu.compare=function(t,n,r){if(n.equals2D(r))return 0;var o=Fu.relativeSign(n.x,r.x),a=Fu.relativeSign(n.y,r.y);switch(t){case 0:return Fu.compareValue(o,a);case 1:return Fu.compareValue(a,o);case 2:return Fu.compareValue(a,-o);case 3:return Fu.compareValue(-o,a);case 4:return Fu.compareValue(-o,-a);case 5:return Fu.compareValue(-a,-o);case 6:return Fu.compareValue(-a,o);case 7:return Fu.compareValue(o,-a);default:}return on.shouldNeverReachHere("invalid octant value"),0};Fu.compareValue=function(t,n){return t<0?-1:t>0?1:n<0?-1:n>0?1:0};var jm=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._segString=t,this.coord=new oe(n),this.segmentIndex=r,this._segmentOctant=o,this._isInterior=!n.equals2D(t.getCoordinate(r))};jm.prototype.getCoordinate=function(){return this.coord};jm.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};jm.prototype.compareTo=function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Fu.compare(this._segmentOctant,this.coord,n.coord)};jm.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};jm.prototype.isInterior=function(){return this._isInterior};jm.prototype.interfaces_=function(){return[Dc]};jm.prototype.getClass=function(){return jm};var hu=function(){this._nodeMap=new zs,this._edge=null;var t=arguments[0];this._edge=t};hu.prototype.getSplitCoordinates=function(){var t=this,n=new $T;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next();t.addEdgeCoordinates(o,a,n),o=a}return n.toCoordinateArray()};hu.prototype.addCollapsedNodes=function(){var t=this,n=new Be;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var o=r.next().intValue();t.add(t._edge.getCoordinate(o),o)}};hu.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};hu.prototype.findCollapsesFromExistingVertices=function(t){for(var n=this,r=0;r<this._edge.size()-2;r++){var o=n._edge.getCoordinate(r),a=n._edge.getCoordinate(r+2);o.equals2D(a)&&t.add(new eh(r+1))}};hu.prototype.addEdgeCoordinates=function(t,n,r){var o=this,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);r.add(new oe(t.coord),!1);for(var u=t.segmentIndex+1;u<=n.segmentIndex;u++)r.add(o._edge.getCoordinate(u));s&&r.add(new oe(n.coord))};hu.prototype.iterator=function(){return this._nodeMap.values().iterator()};hu.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};hu.prototype.findCollapseIndex=function(t,n,r){if(!t.coord.equals2D(n.coord))return!1;var o=n.segmentIndex-t.segmentIndex;return n.isInterior()||o--,o===1?(r[0]=t.segmentIndex+1,!0):!1};hu.prototype.findCollapsesFromInsertedNodes=function(t){for(var n=this,r=new Array(1).fill(null),o=this.iterator(),a=o.next();o.hasNext();){var s=o.next(),u=n.findCollapseIndex(a,s,r);u&&t.add(new eh(r[0])),a=s}};hu.prototype.getEdge=function(){return this._edge};hu.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};hu.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new oe(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r._edge.getCoordinate(c);return s&&(u[l]=new oe(n.coord)),new qo(u,this._edge.getData())};hu.prototype.add=function(t,n){var r=new jm(this._edge,t,n,this._edge.getSegmentOctant(n)),o=this._nodeMap.get(r);return o!==null?(on.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(r,r),r)};hu.prototype.checkSplitEdgesCorrectness=function(t){var n=this._edge.getCoordinates(),r=t.get(0),o=r.getCoordinate(0);if(!o.equals2D(n[0]))throw new Ap("bad split edge start point at "+o);var a=t.get(t.size()-1),s=a.getCoordinates(),u=s[s.length-1];if(!u.equals2D(n[n.length-1]))throw new Ap("bad split edge end point at "+u)};hu.prototype.interfaces_=function(){return[]};hu.prototype.getClass=function(){return hu};var yy=function(){};yy.prototype.interfaces_=function(){return[]};yy.prototype.getClass=function(){return yy};yy.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new uo("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),o=Math.abs(n);return t>=0?n>=0?r>=o?0:1:r>=o?7:6:n>=0?r>=o?3:2:r>=o?4:5}else if(arguments[0]instanceof oe&&arguments[1]instanceof oe){var a=arguments[0],s=arguments[1],u=s.x-a.x,l=s.y-a.y;if(u===0&&l===0)throw new uo("Cannot compute the octant for two identical points "+a);return yy.octant(u,l)}};var vd=function(){};vd.prototype.getCoordinates=function(){};vd.prototype.size=function(){};vd.prototype.getCoordinate=function(t){};vd.prototype.isClosed=function(){};vd.prototype.setData=function(t){};vd.prototype.getData=function(){};vd.prototype.interfaces_=function(){return[]};vd.prototype.getClass=function(){return vd};var zT=function(){};zT.prototype.addIntersection=function(t,n){};zT.prototype.interfaces_=function(){return[vd]};zT.prototype.getClass=function(){return zT};var qo=function(){this._nodeList=new hu(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};qo.prototype.getCoordinates=function(){return this._pts};qo.prototype.size=function(){return this._pts.length};qo.prototype.getCoordinate=function(t){return this._pts[t]};qo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};qo.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};qo.prototype.setData=function(t){this._data=t};qo.prototype.safeOctant=function(t,n){return t.equals2D(n)?0:yy.octant(t,n)};qo.prototype.getData=function(){return this._data};qo.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[3],s=new oe(r.getIntersection(a));this.addIntersection(s,o)}};qo.prototype.toString=function(){return af.toLineString(new ko(this._pts))};qo.prototype.getNodeList=function(){return this._nodeList};qo.prototype.addIntersectionNode=function(t,n){var r=n,o=r+1;if(o<this._pts.length){var a=this._pts[o];t.equals2D(a)&&(r=o)}var s=this._nodeList.add(t,r);return s};qo.prototype.addIntersections=function(t,n,r){for(var o=this,a=0;a<t.getIntersectionNum();a++)o.addIntersection(t,n,r,a)};qo.prototype.interfaces_=function(){return[zT]};qo.prototype.getClass=function(){return qo};qo.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new Be;return qo.getNodedSubstrings(t,n),n}else if(arguments.length===2)for(var r=arguments[0],o=arguments[1],a=r.iterator();a.hasNext();){var s=a.next();s.getNodeList().addSplitEdges(o)}};var ht=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new oe,this.p1=new oe;else if(arguments.length===1){var t=arguments[0];this.p0=new oe(t.p0),this.p1=new oe(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3];this.p0=new oe(n,r),this.p1=new oe(o,a)}},hj={serialVersionUID:{configurable:!0}};ht.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ht.prototype.orientationIndex=function(){if(arguments[0]instanceof ht){var t=arguments[0],n=Ue.orientationIndex(this.p0,this.p1,t.p0),r=Ue.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof oe){var o=arguments[0];return Ue.orientationIndex(this.p0,this.p1,o)}};ht.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};ht.prototype.isVertical=function(){return this.p0.x===this.p1.x};ht.prototype.equals=function(t){if(!(t instanceof ht))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};ht.prototype.intersection=function(t){var n=new B0;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null};ht.prototype.project=function(){if(arguments[0]instanceof oe){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new oe(t);var n=this.projectionFactor(t),r=new oe;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof ht){var o=arguments[0],a=this.projectionFactor(o.p0),s=this.projectionFactor(o.p1);if(a>=1&&s>=1||a<=0&&s<=0)return null;var u=this.project(o.p0);a<0&&(u=this.p0),a>1&&(u=this.p1);var l=this.project(o.p1);return s<0&&(l=this.p0),s>1&&(l=this.p1),new ht(u,l)}};ht.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ht.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ht.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};ht.prototype.distancePerpendicular=function(t){return Ue.distancePointLinePerpendicular(t,this.p0,this.p1)};ht.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ht.prototype.midPoint=function(){return ht.midPoint(this.p0,this.p1)};ht.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,o=n*n+r*r;if(o<=0)return Kt.NaN;var a=((t.x-this.p0.x)*n+(t.y-this.p0.y)*r)/o;return a};ht.prototype.closestPoints=function(t){var n=this.intersection(t);if(n!==null)return[n,n];var r=new Array(2).fill(null),o=Kt.MAX_VALUE,a=null,s=this.closestPoint(t.p0);o=s.distance(t.p0),r[0]=s,r[1]=t.p0;var u=this.closestPoint(t.p1);a=u.distance(t.p1),a<o&&(o=a,r[0]=u,r[1]=t.p1);var l=t.closestPoint(this.p0);a=l.distance(this.p0),a<o&&(o=a,r[0]=this.p0,r[1]=l);var c=t.closestPoint(this.p1);return a=c.distance(this.p1),a<o&&(o=a,r[0]=this.p1,r[1]=c),r};ht.prototype.closestPoint=function(t){var n=this.projectionFactor(t);if(n>0&&n<1)return this.project(t);var r=this.p0.distance(t),o=this.p1.distance(t);return r<o?this.p0:this.p1};ht.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ht.prototype.getLength=function(){return this.p0.distance(this.p1)};ht.prototype.compareTo=function(t){var n=t,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};ht.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};ht.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};ht.prototype.lineIntersection=function(t){try{var n=rf.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(r){if(!(r instanceof Sx))throw r}finally{}return null};ht.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ht.prototype.pointAlongOffset=function(t,n){var r=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,u=Math.sqrt(a*a+s*s),l=0,c=0;if(n!==0){if(u<=0)throw new Error("Cannot compute offset from zero-length line segment");l=n*a/u,c=n*s/u}var f=r-c,h=o+l,d=new oe(f,h);return d};ht.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};ht.prototype.segmentFraction=function(t){var n=this.projectionFactor(t);return n<0?n=0:(n>1||Kt.isNaN(n))&&(n=1),n};ht.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ht.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ht.prototype.distance=function(){if(arguments[0]instanceof ht){var t=arguments[0];return Ue.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof oe){var n=arguments[0];return Ue.distancePointLine(n,this.p0,this.p1)}};ht.prototype.pointAlong=function(t){var n=new oe;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n};ht.prototype.hashCode=function(){var t=Kt.doubleToLongBits(this.p0.x);t^=Kt.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(t)^Math.trunc(t>>32),r=Kt.doubleToLongBits(this.p1.x);r^=Kt.doubleToLongBits(this.p1.y)*31;var o=Math.trunc(r)^Math.trunc(r>>32);return n^o};ht.prototype.interfaces_=function(){return[Dc,Pc]};ht.prototype.getClass=function(){return ht};ht.midPoint=function(t,n){return new oe((t.x+n.x)/2,(t.y+n.y)/2)};hj.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ht,hj);var VT=function(){this.tempEnv1=new lt,this.tempEnv2=new lt,this._overlapSeg1=new ht,this._overlapSeg2=new ht};VT.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];t.getLineSegment(n,this._overlapSeg1),r.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};VT.prototype.interfaces_=function(){return[]};VT.prototype.getClass=function(){return VT};var pl=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._pts=t,this._start=n,this._end=r,this._context=o};pl.prototype.getLineSegment=function(t,n){n.p0=this._pts[t],n.p1=this._pts[t+1]};pl.prototype.computeSelect=function(t,n,r,o){var a=this._pts[n],s=this._pts[r];if(o.tempEnv1.init(a,s),r-n===1)return o.select(this,n),null;if(!t.intersects(o.tempEnv1))return null;var u=Math.trunc((n+r)/2);n<u&&this.computeSelect(t,n,u,o),u<r&&this.computeSelect(t,u,r,o)};pl.prototype.getCoordinates=function(){for(var t=this,n=new Array(this._end-this._start+1).fill(null),r=0,o=this._start;o<=this._end;o++)n[r++]=t._pts[o];return n};pl.prototype.computeOverlaps=function(t,n){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,n)};pl.prototype.setId=function(t){this._id=t};pl.prototype.select=function(t,n){this.computeSelect(t,this._start,this._end,n)};pl.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],n=this._pts[this._end];this._env=new lt(t,n)}return this._env};pl.prototype.getEndIndex=function(){return this._end};pl.prototype.getStartIndex=function(){return this._start};pl.prototype.getContext=function(){return this._context};pl.prototype.getId=function(){return this._id};pl.prototype.computeOverlapsInternal=function(t,n,r,o,a,s){var u=this._pts[t],l=this._pts[n],c=r._pts[o],f=r._pts[a];if(n-t===1&&a-o===1)return s.overlap(this,t,r,o),null;if(s.tempEnv1.init(u,l),s.tempEnv2.init(c,f),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((t+n)/2),d=Math.trunc((o+a)/2);t<h&&(o<d&&this.computeOverlapsInternal(t,h,r,o,d,s),d<a&&this.computeOverlapsInternal(t,h,r,d,a,s)),h<n&&(o<d&&this.computeOverlapsInternal(h,n,r,o,d,s),d<a&&this.computeOverlapsInternal(h,n,r,d,a,s))};pl.prototype.interfaces_=function(){return[]};pl.prototype.getClass=function(){return pl};var $f=function(){};$f.prototype.interfaces_=function(){return[]};$f.prototype.getClass=function(){return $f};$f.getChainStartIndices=function(t){var n=0,r=new Be;r.add(new eh(n));do{var o=$f.findChainEnd(t,n);r.add(new eh(o)),n=o}while(n<t.length-1);var a=$f.toIntArray(r);return a};$f.findChainEnd=function(t,n){for(var r=n;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var o=bi.quadrant(t[r],t[r+1]),a=n+1;a<t.length;){if(!t[a-1].equals2D(t[a])){var s=bi.quadrant(t[a-1],t[a]);if(s!==o)break}a++}return a-1};$f.getChains=function(){if(arguments.length===1){var t=arguments[0];return $f.getChains(t,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],o=new Be,a=$f.getChainStartIndices(n),s=0;s<a.length-1;s++){var u=new pl(n,a[s],a[s+1],r);o.add(u)}return o}};$f.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var b0=function(){};b0.prototype.computeNodes=function(t){};b0.prototype.getNodedSubstrings=function(){};b0.prototype.interfaces_=function(){return[]};b0.prototype.getClass=function(){return b0};var kT=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};kT.prototype.setSegmentIntersector=function(t){this._segInt=t};kT.prototype.interfaces_=function(){return[b0]};kT.prototype.getClass=function(){return kT};var bB=function(e){function t(r){r?e.call(this,r):e.call(this),this._monoChains=new Be,this._index=new fj,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return qo.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(o){for(var a=this,s=$f.getChains(o.getCoordinates(),o),u=s.iterator();u.hasNext();){var l=u.next();l.setId(a._idCounter++),a._index.insert(l.getEnvelope(),l),a._monoChains.add(l)}},t.prototype.computeNodes=function(o){var a=this;this._nodedSegStrings=o;for(var s=o.iterator();s.hasNext();)a.add(s.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var o=this,a=new yY(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var u=s.next(),l=o._index.query(u.getEnvelope()),c=l.iterator();c.hasNext();){var f=c.next();if(f.getId()>u.getId()&&(u.computeOverlaps(f,a),o._nOverlaps++),o._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return yY},Object.defineProperties(t,n),t}(kT),yY=function(e){function t(){e.call(this),this._si=null;var n=arguments[0];this._si=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=r.getContext(),l=a.getContext();this._si.processIntersections(u,o,l,s)}else return e.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(VT),Vr=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(a),this.setJoinStyle(s),this.setMitreLimit(u)}}},Op={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Vr.prototype.getEndCapStyle=function(){return this._endCapStyle};Vr.prototype.isSingleSided=function(){return this._isSingleSided};Vr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=Vr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Vr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Vr.JOIN_ROUND&&(this._quadrantSegments=Vr.DEFAULT_QUADRANT_SEGMENTS)};Vr.prototype.getJoinStyle=function(){return this._joinStyle};Vr.prototype.setJoinStyle=function(t){this._joinStyle=t};Vr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};Vr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Vr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Vr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};Vr.prototype.getMitreLimit=function(){return this._mitreLimit};Vr.prototype.setMitreLimit=function(t){this._mitreLimit=t};Vr.prototype.setSingleSided=function(t){this._isSingleSided=t};Vr.prototype.interfaces_=function(){return[]};Vr.prototype.getClass=function(){return Vr};Vr.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)};Op.CAP_ROUND.get=function(){return 1};Op.CAP_FLAT.get=function(){return 2};Op.CAP_SQUARE.get=function(){return 3};Op.JOIN_ROUND.get=function(){return 1};Op.JOIN_MITRE.get=function(){return 2};Op.JOIN_BEVEL.get=function(){return 3};Op.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};Op.DEFAULT_MITRE_LIMIT.get=function(){return 5};Op.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Vr,Op);var Mo=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ue.COUNTERCLOCKWISE,this._inputLine=t||null},rS={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Mo.prototype.isDeletable=function(t,n,r,o){var a=this._inputLine[t],s=this._inputLine[n],u=this._inputLine[r];return!this.isConcave(a,s,u)||!this.isShallow(a,s,u,o)?!1:this.isShallowSampled(a,s,t,r,o)};Mo.prototype.deleteShallowConcavities=function(){for(var t=this,n=1,r=this.findNextNonDeletedIndex(n),o=this.findNextNonDeletedIndex(r),a=!1;o<this._inputLine.length;){var s=!1;t.isDeletable(n,r,o,t._distanceTol)&&(t._isDeleted[r]=Mo.DELETE,s=!0,a=!0),s?n=o:n=r,r=t.findNextNonDeletedIndex(n),o=t.findNextNonDeletedIndex(r)}return a};Mo.prototype.isShallowConcavity=function(t,n,r,o){var a=Ue.computeOrientation(t,n,r),s=a===this._angleOrientation;if(!s)return!1;var u=Ue.distancePointLine(n,t,r);return u<o};Mo.prototype.isShallowSampled=function(t,n,r,o,a){var s=this,u=Math.trunc((o-r)/Mo.NUM_PTS_TO_CHECK);u<=0&&(u=1);for(var l=r;l<o;l+=u)if(!s.isShallow(t,n,s._inputLine[l],a))return!1;return!0};Mo.prototype.isConcave=function(t,n,r){var o=Ue.computeOrientation(t,n,r),a=o===this._angleOrientation;return a};Mo.prototype.simplify=function(t){var n=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Ue.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Mo.prototype.findNextNonDeletedIndex=function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===Mo.DELETE;)n++;return n};Mo.prototype.isShallow=function(t,n,r,o){var a=Ue.distancePointLine(n,t,r);return a<o};Mo.prototype.collapseLine=function(){for(var t=this,n=new $T,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==Mo.DELETE&&n.add(t._inputLine[r]);return n.toCoordinateArray()};Mo.prototype.interfaces_=function(){return[]};Mo.prototype.getClass=function(){return Mo};Mo.simplify=function(t,n){var r=new Mo(t);return r.simplify(n)};rS.INIT.get=function(){return 0};rS.DELETE.get=function(){return 1};rS.KEEP.get=function(){return 1};rS.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Mo,rS);var Yl=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Be},dj={COORDINATE_ARRAY_TYPE:{configurable:!0}};Yl.prototype.getCoordinates=function(){var t=this._ptList.toArray(Yl.COORDINATE_ARRAY_TYPE);return t};Yl.prototype.setPrecisionModel=function(t){this._precisionModel=t};Yl.prototype.addPt=function(t){var n=new oe(t);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};Yl.prototype.revere=function(){};Yl.prototype.addPts=function(t,n){var r=this;if(n)for(var o=0;o<t.length;o++)r.addPt(t[o]);else for(var a=t.length-1;a>=0;a--)r.addPt(t[a])};Yl.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=t.distance(n);return r<this._minimimVertexDistance};Yl.prototype.toString=function(){var t=new dn,n=t.createLineString(this.getCoordinates());return n.toString()};Yl.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new oe(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(t.equals(n))return null;this._ptList.add(t)};Yl.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};Yl.prototype.interfaces_=function(){return[]};Yl.prototype.getClass=function(){return Yl};dj.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(Yl,dj);var xn=function(){},My={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};xn.prototype.interfaces_=function(){return[]};xn.prototype.getClass=function(){return xn};xn.toDegrees=function(t){return t*180/Math.PI};xn.normalize=function(t){for(;t>Math.PI;)t-=xn.PI_TIMES_2;for(;t<=-Math.PI;)t+=xn.PI_TIMES_2;return t};xn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=r.x-n.x,a=r.y-n.y;return Math.atan2(a,o)}};xn.isAcute=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l>0};xn.isObtuse=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l<0};xn.interiorAngle=function(t,n,r){var o=xn.angle(n,t),a=xn.angle(n,r);return Math.abs(a-o)};xn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=xn.PI_TIMES_2;t>=xn.PI_TIMES_2&&(t=0)}else{for(;t>=xn.PI_TIMES_2;)t-=xn.PI_TIMES_2;t<0&&(t=0)}return t};xn.angleBetween=function(t,n,r){var o=xn.angle(n,t),a=xn.angle(n,r);return xn.diff(o,a)};xn.diff=function(t,n){var r=null;return t<n?r=n-t:r=t-n,r>Math.PI&&(r=2*Math.PI-r),r};xn.toRadians=function(t){return t*Math.PI/180};xn.getTurn=function(t,n){var r=Math.sin(n-t);return r>0?xn.COUNTERCLOCKWISE:r<0?xn.CLOCKWISE:xn.NONE};xn.angleBetweenOriented=function(t,n,r){var o=xn.angle(n,t),a=xn.angle(n,r),s=a-o;return s<=-Math.PI?s+xn.PI_TIMES_2:s>Math.PI?s-xn.PI_TIMES_2:s};My.PI_TIMES_2.get=function(){return 2*Math.PI};My.PI_OVER_2.get=function(){return Math.PI/2};My.PI_OVER_4.get=function(){return Math.PI/4};My.COUNTERCLOCKWISE.get=function(){return Ue.COUNTERCLOCKWISE};My.CLOCKWISE.get=function(){return Ue.CLOCKWISE};My.NONE.get=function(){return Ue.COLLINEAR};Object.defineProperties(xn,My);var to=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ht,this._seg1=new ht,this._offset0=new ht,this._offset1=new ht,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new B0,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Vr.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},iS={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};to.prototype.addNextSegment=function(t,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=Ue.computeOrientation(this._s0,this._s1,this._s2),o=r===Ue.CLOCKWISE&&this._side===Pe.LEFT||r===Ue.COUNTERCLOCKWISE&&this._side===Pe.RIGHT;r===0?this.addCollinear(n):o?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};to.prototype.addLineEndCap=function(t,n){var r=new ht(t,n),o=new ht;this.computeOffsetSegment(r,Pe.LEFT,this._distance,o);var a=new ht;this.computeOffsetSegment(r,Pe.RIGHT,this._distance,a);var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s);switch(this._bufParams.getEndCapStyle()){case Vr.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(n,l+Math.PI/2,l-Math.PI/2,Ue.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case Vr.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(a.p1);break;case Vr.CAP_SQUARE:var c=new oe;c.x=Math.abs(this._distance)*Math.cos(l),c.y=Math.abs(this._distance)*Math.sin(l);var f=new oe(o.p1.x+c.x,o.p1.y+c.y),h=new oe(a.p1.x+c.x,a.p1.y+c.y);this._segList.addPt(f),this._segList.addPt(h);break;default:}};to.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};to.prototype.addMitreJoin=function(t,n,r,o){var a=!0,s=null;try{s=rf.intersection(n.p0,n.p1,r.p0,r.p1);var u=o<=0?1:s.distance(t)/Math.abs(o);u>this._bufParams.getMitreLimit()&&(a=!1)}catch(l){if(l instanceof Sx)s=new oe(0,0),a=!1;else throw l}finally{}a?this._segList.addPt(s):this.addLimitedMitreJoin(n,r,o,this._bufParams.getMitreLimit())};to.prototype.addFilletCorner=function(t,n,r,o,a){var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s),c=r.x-t.x,f=r.y-t.y,h=Math.atan2(f,c);o===Ue.CLOCKWISE?l<=h&&(l+=2*Math.PI):l>=h&&(l-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(t,l,h,o,a),this._segList.addPt(r)};to.prototype.addOutsideTurn=function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*to.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Vr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Vr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};to.prototype.createSquare=function(t){this._segList.addPt(new oe(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new oe(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new oe(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new oe(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};to.prototype.addSegments=function(t,n){this._segList.addPts(t,n)};to.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};to.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};to.prototype.initSideSegments=function(t,n,r){this._s1=t,this._s2=n,this._side=r,this._seg1.setCoordinates(t,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};to.prototype.addLimitedMitreJoin=function(t,n,r,o){var a=this._seg0.p1,s=xn.angle(a,this._seg0.p0),u=xn.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),l=u/2,c=xn.normalize(s+l),f=xn.normalize(c+Math.PI),h=o*r,d=h*Math.abs(Math.sin(l)),p=r-d,_=a.x+h*Math.cos(f),y=a.y+h*Math.sin(f),v=new oe(_,y),w=new ht(a,v),C=w.pointAlongOffset(1,p),E=w.pointAlongOffset(1,-p);this._side===Pe.LEFT?(this._segList.addPt(C),this._segList.addPt(E)):(this._segList.addPt(E),this._segList.addPt(C))};to.prototype.computeOffsetSegment=function(t,n,r,o){var a=n===Pe.LEFT?1:-1,s=t.p1.x-t.p0.x,u=t.p1.y-t.p0.y,l=Math.sqrt(s*s+u*u),c=a*r*s/l,f=a*r*u/l;o.p0.x=t.p0.x-f,o.p0.y=t.p0.y+c,o.p1.x=t.p1.x-f,o.p1.y=t.p1.y+c};to.prototype.addFilletArc=function(t,n,r,o,a){var s=this,u=o===Ue.CLOCKWISE?-1:1,l=Math.abs(n-r),c=Math.trunc(l/this._filletAngleQuantum+.5);if(c<1)return null;for(var f=0,h=l/c,d=f,p=new oe;d<l;){var _=n+u*d;p.x=t.x+a*Math.cos(_),p.y=t.y+a*Math.sin(_),s._segList.addPt(p),d+=h}};to.prototype.addInsideTurn=function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*to.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new oe((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var o=new oe((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};to.prototype.createCircle=function(t){var n=new oe(t.x+this._distance,t.y);this._segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};to.prototype.addBevelJoin=function(t,n){this._segList.addPt(t.p1),this._segList.addPt(n.p0)};to.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Yl,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*to.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};to.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===Vr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Vr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Ue.CLOCKWISE,this._distance))};to.prototype.closeRing=function(){this._segList.closeRing()};to.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};to.prototype.interfaces_=function(){return[]};to.prototype.getClass=function(){return to};iS.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};iS.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};iS.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};iS.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(to,iS);var ku=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n};ku.prototype.getOffsetCurve=function(t,n){if(this._distance=n,n===0)return null;var r=n<0,o=Math.abs(n),a=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],a):this.computeOffsetCurve(t,r,a);var s=a.getCoordinates();return r&&pn.reverse(s),s};ku.prototype.computeSingleSidedBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){r.addSegments(t,!0);var a=Mo.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Pe.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{r.addSegments(t,!1);var l=Mo.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Pe.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment(),r.closeRing()};ku.prototype.computeRingBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);n===Pe.RIGHT&&(o=-o);var a=Mo.simplify(t,o),s=a.length-1;r.initSideSegments(a[s-1],a[0],n);for(var u=1;u<=s;u++){var l=u!==1;r.addNextSegment(a[u],l)}r.closeRing()};ku.prototype.computeLineBufferCurve=function(t,n){var r=this.simplifyTolerance(this._distance),o=Mo.simplify(t,r),a=o.length-1;n.initSideSegments(o[0],o[1],Pe.LEFT);for(var s=2;s<=a;s++)n.addNextSegment(o[s],!0);n.addLastSegment(),n.addLineEndCap(o[a-1],o[a]);var u=Mo.simplify(t,-r),l=u.length-1;n.initSideSegments(u[l],u[l-1],Pe.LEFT);for(var c=l-2;c>=0;c--)n.addNextSegment(u[c],!0);n.addLastSegment(),n.addLineEndCap(u[1],u[0]),n.closeRing()};ku.prototype.computePointCurve=function(t,n){switch(this._bufParams.getEndCapStyle()){case Vr.CAP_ROUND:n.createCircle(t);break;case Vr.CAP_SQUARE:n.createSquare(t);break;default:}};ku.prototype.getLineCurve=function(t,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),o=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var a=n<0;this.computeSingleSidedBufferCurve(t,a,o)}else this.computeLineBufferCurve(t,o);var s=o.getCoordinates();return s};ku.prototype.getBufferParameters=function(){return this._bufParams};ku.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};ku.prototype.getRingCurve=function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return ku.copyCoordinates(t);var o=this.getSegGen(r);return this.computeRingBufferCurve(t,n,o),o.getCoordinates()};ku.prototype.computeOffsetCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){var a=Mo.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Pe.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{var l=Mo.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Pe.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment()};ku.prototype.getSegGen=function(t){return new to(this._precisionModel,this._bufParams,t)};ku.prototype.interfaces_=function(){return[]};ku.prototype.getClass=function(){return ku};ku.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),r=0;r<n.length;r++)n[r]=new oe(t[r]);return n};var vy=function(){this._subgraphs=null,this._seg=new ht,this._cga=new Ue;var t=arguments[0];this._subgraphs=t},pj={DepthSegment:{configurable:!0}};vy.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=new Be,o=this._subgraphs.iterator();o.hasNext();){var a=o.next(),s=a.getEnvelope();n.y<s.getMinY()||n.y>s.getMaxY()||t.findStabbedSegments(n,a.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(Rt(arguments[2],of)&&arguments[0]instanceof oe&&arguments[1]instanceof z3)for(var u=arguments[0],l=arguments[1],c=arguments[2],f=l.getEdge().getCoordinates(),h=0;h<f.length-1;h++){t._seg.p0=f[h],t._seg.p1=f[h+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var d=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(d<u.x)&&!t._seg.isHorizontal()&&!(u.y<t._seg.p0.y||u.y>t._seg.p1.y)&&Ue.computeOrientation(t._seg.p0,t._seg.p1,u)!==Ue.RIGHT){var p=l.getDepth(Pe.LEFT);t._seg.p0.equals(f[h])||(p=l.getDepth(Pe.RIGHT));var _=new I0(t._seg,p);c.add(_)}}else if(Rt(arguments[2],of)&&arguments[0]instanceof oe&&Rt(arguments[1],of))for(var y=arguments[0],v=arguments[1],w=arguments[2],C=v.iterator();C.hasNext();){var E=C.next();!E.isForward()||t.findStabbedSegments(y,E,w)}}};vy.prototype.getDepth=function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var r=lf.min(n);return r._leftDepth};vy.prototype.interfaces_=function(){return[]};vy.prototype.getClass=function(){return vy};pj.DepthSegment.get=function(){return I0};Object.defineProperties(vy,pj);var I0=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new ht(t),this._leftDepth=n};I0.prototype.compareTo=function(t){var n=t;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};I0.prototype.compareX=function(t,n){var r=t.p0.compareTo(n.p0);return r!==0?r:t.p1.compareTo(n.p1)};I0.prototype.toString=function(){return this._upwardSeg.toString()};I0.prototype.interfaces_=function(){return[Dc]};I0.prototype.getClass=function(){return I0};var Ur=function(t,n,r){this.p0=t||null,this.p1=n||null,this.p2=r||null};Ur.prototype.area=function(){return Ur.area(this.p0,this.p1,this.p2)};Ur.prototype.signedArea=function(){return Ur.signedArea(this.p0,this.p1,this.p2)};Ur.prototype.interpolateZ=function(t){if(t===null)throw new uo("Supplied point is null.");return Ur.interpolateZ(t,this.p0,this.p1,this.p2)};Ur.prototype.longestSideLength=function(){return Ur.longestSideLength(this.p0,this.p1,this.p2)};Ur.prototype.isAcute=function(){return Ur.isAcute(this.p0,this.p1,this.p2)};Ur.prototype.circumcentre=function(){return Ur.circumcentre(this.p0,this.p1,this.p2)};Ur.prototype.area3D=function(){return Ur.area3D(this.p0,this.p1,this.p2)};Ur.prototype.centroid=function(){return Ur.centroid(this.p0,this.p1,this.p2)};Ur.prototype.inCentre=function(){return Ur.inCentre(this.p0,this.p1,this.p2)};Ur.prototype.interfaces_=function(){return[]};Ur.prototype.getClass=function(){return Ur};Ur.area=function(t,n,r){return Math.abs(((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2)};Ur.signedArea=function(t,n,r){return((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2};Ur.det=function(t,n,r,o){return t*o-n*r};Ur.interpolateZ=function(t,n,r,o){var a=n.x,s=n.y,u=r.x-a,l=o.x-a,c=r.y-s,f=o.y-s,h=u*f-l*c,d=t.x-a,p=t.y-s,_=(f*d-l*p)/h,y=(-c*d+u*p)/h,v=n.z+_*(r.z-n.z)+y*(o.z-n.z);return v};Ur.longestSideLength=function(t,n,r){var o=t.distance(n),a=n.distance(r),s=r.distance(t),u=o;return a>u&&(u=a),s>u&&(u=s),u};Ur.isAcute=function(t,n,r){return!(!xn.isAcute(t,n,r)||!xn.isAcute(n,r,t)||!xn.isAcute(r,t,n))};Ur.circumcentre=function(t,n,r){var o=r.x,a=r.y,s=t.x-o,u=t.y-a,l=n.x-o,c=n.y-a,f=2*Ur.det(s,u,l,c),h=Ur.det(u,s*s+u*u,c,l*l+c*c),d=Ur.det(s,s*s+u*u,l,l*l+c*c),p=o-h/f,_=a+d/f;return new oe(p,_)};Ur.perpendicularBisector=function(t,n){var r=n.x-t.x,o=n.y-t.y,a=new rf(t.x+r/2,t.y+o/2,1),s=new rf(t.x-o+r/2,t.y+r+o/2,1);return new rf(a,s)};Ur.angleBisector=function(t,n,r){var o=n.distance(t),a=n.distance(r),s=o/(o+a),u=r.x-t.x,l=r.y-t.y,c=new oe(t.x+s*u,t.y+s*l);return c};Ur.area3D=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=n.z-t.z,u=r.x-t.x,l=r.y-t.y,c=r.z-t.z,f=a*c-s*l,h=s*u-o*c,d=o*l-a*u,p=f*f+h*h+d*d,_=Math.sqrt(p)/2;return _};Ur.centroid=function(t,n,r){var o=(t.x+n.x+r.x)/3,a=(t.y+n.y+r.y)/3;return new oe(o,a)};Ur.inCentre=function(t,n,r){var o=n.distance(r),a=t.distance(r),s=t.distance(n),u=o+a+s,l=(o*t.x+a*n.x+s*r.x)/u,c=(o*t.y+a*n.y+s*r.y)/u;return new oe(l,c)};var Ic=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=r};Ic.prototype.addPoint=function(t){if(this._distance<=0)return null;var n=t.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,fe.EXTERIOR,fe.INTERIOR)};Ic.prototype.addPolygon=function(t){var n=this,r=this._distance,o=Pe.LEFT;this._distance<0&&(r=-this._distance,o=Pe.RIGHT);var a=t.getExteriorRing(),s=pn.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&s.length<3)return null;this.addPolygonRing(s,r,o,fe.EXTERIOR,fe.INTERIOR);for(var u=0;u<t.getNumInteriorRing();u++){var l=t.getInteriorRingN(u),c=pn.removeRepeatedPoints(l.getCoordinates());n._distance>0&&n.isErodedCompletely(l,-n._distance)||n.addPolygonRing(c,r,Pe.opposite(o),fe.INTERIOR,fe.EXTERIOR)}};Ic.prototype.isTriangleErodedCompletely=function(t,n){var r=new Ur(t[0],t[1],t[2]),o=r.inCentre(),a=Ue.distancePointLine(o,r.p0,r.p1);return a<Math.abs(n)};Ic.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=pn.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,fe.EXTERIOR,fe.INTERIOR)};Ic.prototype.addCurve=function(t,n,r){if(t===null||t.length<2)return null;var o=new qo(t,new ri(0,fe.BOUNDARY,n,r));this._curveList.add(o)};Ic.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Ic.prototype.addPolygonRing=function(t,n,r,o,a){if(n===0&&t.length<_d.MINIMUM_VALID_SIZE)return null;var s=o,u=a;t.length>=_d.MINIMUM_VALID_SIZE&&Ue.isCCW(t)&&(s=a,u=o,r=Pe.opposite(r));var l=this._curveBuilder.getRingCurve(t,r,n);this.addCurve(l,s,u)};Ic.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ea?this.addPolygon(t):t instanceof Po?this.addLineString(t):t instanceof hl?this.addPoint(t):t instanceof ux?this.addCollection(t):t instanceof A0?this.addCollection(t):t instanceof pd?this.addCollection(t):t instanceof cu&&this.addCollection(t)};Ic.prototype.isErodedCompletely=function(t,n){var r=t.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var o=t.getEnvelopeInternal(),a=Math.min(o.getHeight(),o.getWidth());return n<0&&2*Math.abs(n)>a};Ic.prototype.addCollection=function(t){for(var n=this,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r);n.add(o)}};Ic.prototype.interfaces_=function(){return[]};Ic.prototype.getClass=function(){return Ic};var hx=function(){};hx.prototype.locate=function(t){};hx.prototype.interfaces_=function(){return[]};hx.prototype.getClass=function(){return hx};var md=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};md.prototype.next=function(){if(this._atStart)return this._atStart=!1,md.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new bx;var t=this._parent.getGeometryN(this._index++);return t instanceof cu?(this._subcollectionIterator=new md(t),this._subcollectionIterator.next()):t};md.prototype.remove=function(){throw new Error(this.getClass().getName())};md.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};md.prototype.interfaces_=function(){return[Ax]};md.prototype.getClass=function(){return md};md.isAtomic=function(t){return!(t instanceof cu)};var Ul=function(){this._geom=null;var t=arguments[0];this._geom=t};Ul.prototype.locate=function(t){return Ul.locate(t,this._geom)};Ul.prototype.interfaces_=function(){return[hx]};Ul.prototype.getClass=function(){return Ul};Ul.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?Ue.isPointInRing(t,n.getCoordinates()):!1};Ul.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Ul.isPointInRing(t,r))return!1;for(var o=0;o<n.getNumInteriorRing();o++){var a=n.getInteriorRingN(o);if(Ul.isPointInRing(t,a))return!1}return!0};Ul.containsPoint=function(t,n){if(n instanceof Ea)return Ul.containsPointInPolygon(t,n);if(n instanceof cu)for(var r=new md(n);r.hasNext();){var o=r.next();if(o!==n&&Ul.containsPoint(t,o))return!0}return!1};Ul.locate=function(t,n){return n.isEmpty()?fe.EXTERIOR:Ul.containsPoint(t,n)?fe.INTERIOR:fe.EXTERIOR};var ks=function(){this._edgeMap=new zs,this._edgeList=null,this._ptInAreaLocation=[fe.NONE,fe.NONE]};ks.prototype.getNextCW=function(t){this.getEdges();var n=this._edgeList.indexOf(t),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};ks.prototype.propagateSideLabels=function(t){for(var n=fe.NONE,r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.isArea(t)&&a.getLocation(t,Pe.LEFT)!==fe.NONE&&(n=a.getLocation(t,Pe.LEFT))}if(n===fe.NONE)return null;for(var s=n,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();if(c.getLocation(t,Pe.ON)===fe.NONE&&c.setLocation(t,Pe.ON,s),c.isArea(t)){var f=c.getLocation(t,Pe.LEFT),h=c.getLocation(t,Pe.RIGHT);if(h!==fe.NONE){if(h!==s)throw new Ip("side location conflict",l.getCoordinate());f===fe.NONE&&on.shouldNeverReachHere("found single null side (at "+l.getCoordinate()+")"),s=f}else on.isTrue(c.getLocation(t,Pe.LEFT)===fe.NONE,"found single null side"),c.setLocation(t,Pe.RIGHT,s),c.setLocation(t,Pe.LEFT,s)}}};ks.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()};ks.prototype.print=function(t){ps.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};ks.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};ks.prototype.checkAreaLabelsConsistent=function(t){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,o=n.get(r).getLabel(),a=o.getLocation(t,Pe.LEFT);on.isTrue(a!==fe.NONE,"Found unlabelled area edge");for(var s=a,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();on.isTrue(c.isArea(t),"Found non-area edge");var f=c.getLocation(t,Pe.LEFT),h=c.getLocation(t,Pe.RIGHT);if(f===h||h!==s)return!1;s=f}return!0};ks.prototype.findIndex=function(t){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var o=n._edgeList.get(r);if(o===t)return r}return-1};ks.prototype.iterator=function(){return this.getEdges().iterator()};ks.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Be(this._edgeMap.values())),this._edgeList};ks.prototype.getLocation=function(t,n,r){return this._ptInAreaLocation[t]===fe.NONE&&(this._ptInAreaLocation[t]=Ul.locate(n,r[t].getGeometry())),this._ptInAreaLocation[t]};ks.prototype.toString=function(){var t=new fh;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();t.append(r),t.append(`
`)}return t.toString()};ks.prototype.computeEdgeEndLabels=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(t)}};ks.prototype.computeLabelling=function(t){var n=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),u=0;u<2;u++)s.isLine(u)&&s.getLocation(u)===fe.BOUNDARY&&(r[u]=!0);for(var l=this.iterator();l.hasNext();)for(var c=l.next(),f=c.getLabel(),h=0;h<2;h++)if(f.isAnyNull(h)){var d=fe.NONE;if(r[h])d=fe.EXTERIOR;else{var p=c.getCoordinate();d=n.getLocation(h,p,t)}f.setAllLocationsIfNull(h,d)}};ks.prototype.getDegree=function(){return this._edgeMap.size()};ks.prototype.insertEdgeEnd=function(t,n){this._edgeMap.put(t,n),this._edgeList=null};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};var mwe=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var o=null,a=null,s=this._SCANNING_FOR_INCOMING,u=0;u<this._resultAreaEdgeList.size();u++){var l=r._resultAreaEdgeList.get(u),c=l.getSym();if(!!l.getLabel().isArea())switch(o===null&&l.isInResult()&&(o=l),s){case r._SCANNING_FOR_INCOMING:if(!c.isInResult())continue;a=c,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!l.isInResult())continue;a.setNext(l),s=r._SCANNING_FOR_INCOMING;break;default:}}if(s===this._LINKING_TO_OUTGOING){if(o===null)throw new Ip("no outgoing dirEdge found",this.getCoordinate());on.isTrue(o.isInResult(),"unable to link last incoming dirEdge"),a.setNext(o)}},t.prototype.insert=function(r){var o=r;this.insertEdgeEnd(o,o)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),o=r.size();if(o<1)return null;var a=r.get(0);if(o===1)return a;var s=r.get(o-1),u=a.getQuadrant(),l=s.getQuadrant();return bi.isNorthern(u)&&bi.isNorthern(l)?a:!bi.isNorthern(u)&&!bi.isNorthern(l)?s:a.getDy()!==0?a:s.getDy()!==0?s:(on.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){ps.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var a=o.next();r.print("out "),a.print(r),r.println(),r.print("in "),a.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Be;for(var o=this.iterator();o.hasNext();){var a=o.next();(a.isInResult()||a.getSym().isInResult())&&r._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.setAllLocationsIfNull(0,r.getLocation(0)),s.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var o=null,a=null,s=this._edgeList.size()-1;s>=0;s--){var u=r._edgeList.get(s),l=u.getSym();a===null&&(a=l),o!==null&&l.setNext(o),o=u}a.setNext(o)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var o=arguments[0],a=this.findIndex(o),s=o.getDepth(Pe.LEFT),u=o.getDepth(Pe.RIGHT),l=this.computeDepths(a+1,this._edgeList.size(),s),c=this.computeDepths(0,a,l);if(c!==u)throw new Ip("depth mismatch at "+o.getCoordinate())}else if(arguments.length===3){for(var f=arguments[0],h=arguments[1],d=arguments[2],p=d,_=f;_<h;_++){var y=r._edgeList.get(_);y.setEdgeDepths(Pe.RIGHT,p),p=y.getDepth(Pe.LEFT)}return p}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.merge(o.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var o=this,a=null,s=null,u=this._SCANNING_FOR_INCOMING,l=this._resultAreaEdgeList.size()-1;l>=0;l--){var c=o._resultAreaEdgeList.get(l),f=c.getSym();switch(a===null&&c.getEdgeRing()===r&&(a=c),u){case o._SCANNING_FOR_INCOMING:if(f.getEdgeRing()!==r)continue;s=f,u=o._LINKING_TO_OUTGOING;break;case o._LINKING_TO_OUTGOING:if(c.getEdgeRing()!==r)continue;s.setNextMin(c),u=o._SCANNING_FOR_INCOMING;break;default:}}u===this._LINKING_TO_OUTGOING&&(on.isTrue(a!==null,"found null for first outgoing dirEdge"),on.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),s.setNextMin(a))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,o=this.iterator();o.hasNext();){var a=o.next();a.isInResult()&&r++}return r}else if(arguments.length===1){for(var s=arguments[0],u=0,l=this.iterator();l.hasNext();){var c=l.next();c.getEdgeRing()===s&&u++}return u}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=fe.NONE,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){r=fe.INTERIOR;break}if(s.isInResult()){r=fe.EXTERIOR;break}}}if(r===fe.NONE)return null;for(var u=r,l=this.iterator();l.hasNext();){var c=l.next(),f=c.getSym();c.isLineEdge()?c.getEdge().setCovered(u===fe.INTERIOR):(c.isInResult()&&(u=fe.EXTERIOR),f.isInResult()&&(u=fe.INTERIOR))}},t.prototype.computeLabelling=function(r){var o=this;e.prototype.computeLabelling.call(this,r),this._label=new ri(fe.NONE);for(var a=this.iterator();a.hasNext();)for(var s=a.next(),u=s.getEdge(),l=u.getLabel(),c=0;c<2;c++){var f=l.getLocation(c);(f===fe.INTERIOR||f===fe.BOUNDARY)&&o._label.setLocation(c,fe.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ks),mj=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new XP(r,new mwe)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(lx),Km=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};Km.prototype.compareTo=function(t){var n=t,r=Km.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};Km.prototype.interfaces_=function(){return[Dc]};Km.prototype.getClass=function(){return Km};Km.orientation=function(t){return pn.increasingDirection(t)===1};Km.compareOriented=function(t,n,r,o){for(var a=n?1:-1,s=o?1:-1,u=n?t.length:-1,l=o?r.length:-1,c=n?0:t.length-1,f=o?0:r.length-1;;){var h=t[c].compareTo(r[f]);if(h!==0)return h;c+=a,f+=s;var d=c===u,p=f===l;if(d&&!p)return-1;if(!d&&p)return 1;if(d&&p)return 0}};var cf=function(){this._edges=new Be,this._ocaMap=new zs};cf.prototype.print=function(t){var n=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var o=n._edges.get(r);r>0&&t.print(","),t.print("(");for(var a=o.getCoordinates(),s=0;s<a.length;s++)s>0&&t.print(","),t.print(a[s].x+" "+a[s].y);t.println(")")}t.print(")  ")};cf.prototype.addAll=function(t){for(var n=this,r=t.iterator();r.hasNext();)n.add(r.next())};cf.prototype.findEdgeIndex=function(t){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(t))return r;return-1};cf.prototype.iterator=function(){return this._edges.iterator()};cf.prototype.getEdges=function(){return this._edges};cf.prototype.get=function(t){return this._edges.get(t)};cf.prototype.findEqualEdge=function(t){var n=new Km(t.getCoordinates()),r=this._ocaMap.get(n);return r};cf.prototype.add=function(t){this._edges.add(t);var n=new Km(t.getCoordinates());this._ocaMap.put(n,t)};cf.prototype.interfaces_=function(){return[]};cf.prototype.getClass=function(){return cf};var D0=function(){};D0.prototype.processIntersections=function(t,n,r,o){};D0.prototype.isDone=function(){};D0.prototype.interfaces_=function(){return[]};D0.prototype.getClass=function(){return D0};var Xl=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Xl.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(Xl.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.size()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};Xl.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Xl.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Xl.prototype.getLineIntersector=function(){return this._li};Xl.prototype.hasProperIntersection=function(){return this._hasProper};Xl.prototype.processIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};Xl.prototype.hasIntersection=function(){return this._hasIntersection};Xl.prototype.isDone=function(){return!1};Xl.prototype.hasInteriorIntersection=function(){return this._hasInterior};Xl.prototype.interfaces_=function(){return[D0]};Xl.prototype.getClass=function(){return Xl};Xl.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var ah=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],r=arguments[2];this.coord=new oe(t),this.segmentIndex=n,this.dist=r};ah.prototype.getSegmentIndex=function(){return this.segmentIndex};ah.prototype.getCoordinate=function(){return this.coord};ah.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};ah.prototype.compareTo=function(t){var n=t;return this.compare(n.segmentIndex,n.dist)};ah.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};ah.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};ah.prototype.getDistance=function(){return this.dist};ah.prototype.compare=function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0};ah.prototype.interfaces_=function(){return[Dc]};ah.prototype.getClass=function(){return ah};var Cd=function(){this._nodeMap=new zs,this.edge=null;var t=arguments[0];this.edge=t};Cd.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Cd.prototype.iterator=function(){return this._nodeMap.values().iterator()};Cd.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};Cd.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};Cd.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this.edge.pts[n.segmentIndex],s=n.dist>0||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new oe(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r.edge.pts[c];return s&&(u[l]=n.coord),new gP(u,new ri(this.edge._label))};Cd.prototype.add=function(t,n,r){var o=new ah(t,n,r),a=this._nodeMap.get(o);return a!==null?a:(this._nodeMap.put(o,o),o)};Cd.prototype.isIntersection=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(t))return!0}return!1};Cd.prototype.interfaces_=function(){return[]};Cd.prototype.getClass=function(){return Cd};var P0=function(){};P0.prototype.getChainStartIndices=function(t){var n=this,r=0,o=new Be;o.add(new eh(r));do{var a=n.findChainEnd(t,r);o.add(new eh(a)),r=a}while(r<t.length-1);var s=P0.toIntArray(o);return s};P0.prototype.findChainEnd=function(t,n){for(var r=bi.quadrant(t[n],t[n+1]),o=n+1;o<t.length;){var a=bi.quadrant(t[o-1],t[o]);if(a!==r)break;o++}return o-1};P0.prototype.interfaces_=function(){return[]};P0.prototype.getClass=function(){return P0};P0.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var Pp=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new lt,this.env2=new lt;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new P0;this.startIndex=n.getChainStartIndices(this.pts)};Pp.prototype.getCoordinates=function(){return this.pts};Pp.prototype.getMaxX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n>r?n:r};Pp.prototype.getMinX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n<r?n:r};Pp.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[r],n.startIndex[r+1],o)}else if(arguments.length===6){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=arguments[4],f=arguments[5],h=this.pts[a],d=this.pts[s],p=u.pts[l],_=u.pts[c];if(s-a===1&&c-l===1)return f.addIntersections(this.e,a,u.e,l),null;if(this.env1.init(h,d),this.env2.init(p,_),!this.env1.intersects(this.env2))return null;var y=Math.trunc((a+s)/2),v=Math.trunc((l+c)/2);a<y&&(l<v&&this.computeIntersectsForChain(a,y,u,l,v,f),v<c&&this.computeIntersectsForChain(a,y,u,v,c,f)),y<s&&(l<v&&this.computeIntersectsForChain(y,s,u,l,v,f),v<c&&this.computeIntersectsForChain(y,s,u,v,c,f))}};Pp.prototype.getStartIndexes=function(){return this.startIndex};Pp.prototype.computeIntersects=function(t,n){for(var r=this,o=0;o<this.startIndex.length-1;o++)for(var a=0;a<t.startIndex.length-1;a++)r.computeIntersectsForChain(o,t,a,n)};Pp.prototype.interfaces_=function(){return[]};Pp.prototype.getClass=function(){return Pp};var ds=function e(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)t._depth[n][r]=e.NULL_VALUE},gj={NULL_VALUE:{configurable:!0}};ds.prototype.getDepth=function(t,n){return this._depth[t][n]};ds.prototype.setDepth=function(t,n,r){this._depth[t][n]=r};ds.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(t._depth[n][r]!==ds.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var o=arguments[0];return this._depth[o][1]===ds.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._depth[a][s]===ds.NULL_VALUE}};ds.prototype.normalize=function(){for(var t=this,n=0;n<2;n++)if(!t.isNull(n)){var r=t._depth[n][1];t._depth[n][2]<r&&(r=t._depth[n][2]),r<0&&(r=0);for(var o=1;o<3;o++){var a=0;t._depth[n][o]>r&&(a=1),t._depth[n][o]=a}}};ds.prototype.getDelta=function(t){return this._depth[t][Pe.RIGHT]-this._depth[t][Pe.LEFT]};ds.prototype.getLocation=function(t,n){return this._depth[t][n]<=0?fe.EXTERIOR:fe.INTERIOR};ds.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};ds.prototype.add=function(){var t=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var o=1;o<3;o++){var a=n.getLocation(r,o);(a===fe.EXTERIOR||a===fe.INTERIOR)&&(t.isNull(r,o)?t._depth[r][o]=ds.depthAtLocation(a):t._depth[r][o]+=ds.depthAtLocation(a))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];l===fe.INTERIOR&&this._depth[s][u]++}};ds.prototype.interfaces_=function(){return[]};ds.prototype.getClass=function(){return ds};ds.depthAtLocation=function(t){return t===fe.EXTERIOR?0:t===fe.INTERIOR?1:ds.NULL_VALUE};gj.NULL_VALUE.get=function(){return-1};Object.defineProperties(ds,gj);var gP=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new Cd(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ds,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.pts=r,this._label=o}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var o=new t(r,ri.toLineLabel(this._label));return o},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var o=this;if(!(r instanceof t))return!1;var a=r;if(this.pts.length!==a.pts.length)return!1;for(var s=!0,u=!0,l=this.pts.length,c=0;c<this.pts.length;c++)if(o.pts[c].equals2D(a.pts[c])||(s=!1),o.pts[c].equals2D(a.pts[--l])||(u=!1),!s&&!u)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var o=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(o.pts[a].x+" "+o.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var o=this;r.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)r.print(o.pts[a]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Pp(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new lt;for(var o=0;o<this.pts.length;o++)r._env.expandToInclude(r.pts[o])}return this._env},t.prototype.addIntersection=function(r,o,a,s){var u=new oe(r.getIntersection(s)),l=o,c=r.getEdgeDistance(a,s),f=l+1;if(f<this.pts.length){var h=this.pts[f];u.equals2D(h)&&(l=f,c=0)}this.eiList.add(u,l,c)},t.prototype.toString=function(){var r=this,o=new fh;o.append("edge "+this._name+": "),o.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&o.append(","),o.append(r.pts[a].x+" "+r.pts[a].y);return o.append(")  "+this._label+" "+this._depthDelta),o.toString()},t.prototype.isPointwiseEqual=function(r){var o=this;if(this.pts.length!==r.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!o.pts[a].equals2D(r.pts[a]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,o,a){for(var s=this,u=0;u<r.getIntersectionNum();u++)s.addIntersection(r,o,a,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];o.setAtLeastIfValid(r.getLocation(0,Pe.ON),r.getLocation(1,Pe.ON),1),r.isArea()&&(o.setAtLeastIfValid(r.getLocation(0,Pe.LEFT),r.getLocation(1,Pe.LEFT),2),o.setAtLeastIfValid(r.getLocation(0,Pe.RIGHT),r.getLocation(1,Pe.RIGHT),2))}else return e.prototype.updateIM.apply(this,arguments)},t}(Wl),uu=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new cf,this._bufParams=t||null};uu.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};uu.prototype.insertUniqueEdge=function(t){var n=this._edgeList.findEqualEdge(t);if(n!==null){var r=n.getLabel(),o=t.getLabel();n.isPointwiseEqual(t)||(o=new ri(t.getLabel()),o.flip()),r.merge(o);var a=uu.depthDelta(o),s=n.getDepthDelta(),u=s+a;n.setDepthDelta(u)}else this._edgeList.add(t),t.setDepthDelta(uu.depthDelta(t.getLabel()))};uu.prototype.buildSubgraphs=function(t,n){for(var r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=a.getRightmostCoordinate(),u=new vy(r),l=u.getDepth(s);a.computeDepth(l),a.findResultEdges(),r.add(a),n.add(a.getDirectedEdges(),a.getNodes())}};uu.prototype.createSubgraphs=function(t){for(var n=new Be,r=t.getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isVisited()){var a=new fu;a.create(o),n.add(a)}}return lf.sort(n,lf.reverseOrder()),n};uu.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};uu.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var n=new bB,r=new B0;return r.setPrecisionModel(t),n.setSegmentIntersector(new Xl(r)),n};uu.prototype.buffer=function(t,n){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new ku(r,this._bufParams),a=new Ic(t,n,o),s=a.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,r),this._graph=new wo(new mj),this._graph.addEdges(this._edgeList.getEdges());var u=this.createSubgraphs(this._graph),l=new dl(this._geomFact);this.buildSubgraphs(u,l);var c=l.getPolygons();if(c.size()<=0)return this.createEmptyResultGeometry();var f=this._geomFact.buildGeometry(c);return f};uu.prototype.computeNodedEdges=function(t,n){var r=this,o=this.getNoder(n);o.computeNodes(t);for(var a=o.getNodedSubstrings(),s=a.iterator();s.hasNext();){var u=s.next(),l=u.getCoordinates();if(!(l.length===2&&l[0].equals2D(l[1]))){var c=u.getData(),f=new gP(u.getCoordinates(),new ri(c));r.insertUniqueEdge(f)}}};uu.prototype.setNoder=function(t){this._workingNoder=t};uu.prototype.interfaces_=function(){return[]};uu.prototype.getClass=function(){return uu};uu.depthDelta=function(t){var n=t.getLocation(0,Pe.LEFT),r=t.getLocation(0,Pe.RIGHT);return n===fe.INTERIOR&&r===fe.EXTERIOR?1:n===fe.EXTERIOR&&r===fe.INTERIOR?-1:0};uu.convertSegStrings=function(t){for(var n=new dn,r=new Be;t.hasNext();){var o=t.next(),a=n.createLineString(o.getCoordinates());r.add(a)}return n.buildGeometry(r)};var Zm=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._noder=r,this._scaleFactor=o,this._offsetX=a,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};Zm.prototype.rescale=function(){var t=this;if(Rt(arguments[0],Ca))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.rescale(o.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],s=0;s<a.length;s++)a[s].x=a[s].x/t._scaleFactor+t._offsetX,a[s].y=a[s].y/t._scaleFactor+t._offsetY;a.length===2&&a[0].equals2D(a[1])&&ps.out.println(a)}};Zm.prototype.scale=function(){var t=this;if(Rt(arguments[0],Ca)){for(var n=arguments[0],r=new Be,o=n.iterator();o.hasNext();){var a=o.next();r.add(new qo(t.scale(a.getCoordinates()),a.getData()))}return r}else if(arguments[0]instanceof Array){for(var s=arguments[0],u=new Array(s.length).fill(null),l=0;l<s.length;l++)u[l]=new oe(Math.round((s[l].x-t._offsetX)*t._scaleFactor),Math.round((s[l].y-t._offsetY)*t._scaleFactor),s[l].z);var c=pn.removeRepeatedPoints(u);return c}};Zm.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Zm.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Zm.prototype.computeNodes=function(t){var n=t;this._isScaled&&(n=this.scale(t)),this._noder.computeNodes(n)};Zm.prototype.interfaces_=function(){return[b0]};Zm.prototype.getClass=function(){return Zm};var sh=function(){this._li=new B0,this._segStrings=null;var t=arguments[0];this._segStrings=t},_j={fact:{configurable:!0}};sh.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();t.checkEndPtVertexIntersections(o[0],t._segStrings),t.checkEndPtVertexIntersections(o[o.length-1],t._segStrings)}else if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=s.iterator();u.hasNext();)for(var l=u.next(),c=l.getCoordinates(),f=1;f<c.length-1;f++)if(c[f].equals(a))throw new Ap("found endpt/interior pt intersection at index "+f+" :pt "+a)}};sh.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),o=this._segStrings.iterator();o.hasNext();){var a=o.next();t.checkInteriorIntersections(r,a)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],l=s.getCoordinates(),c=u.getCoordinates(),f=0;f<l.length-1;f++)for(var h=0;h<c.length-1;h++)t.checkInteriorIntersections(s,f,u,h);else if(arguments.length===4){var d=arguments[0],p=arguments[1],_=arguments[2],y=arguments[3];if(d===_&&p===y)return null;var v=d.getCoordinates()[p],w=d.getCoordinates()[p+1],C=_.getCoordinates()[y],E=_.getCoordinates()[y+1];if(this._li.computeIntersection(v,w,C,E),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,v,w)||this.hasInteriorIntersection(this._li,C,E)))throw new Ap("found non-noded intersection at "+v+"-"+w+" and "+C+"-"+E)}};sh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};sh.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkCollapses(r)}else if(arguments.length===1)for(var o=arguments[0],a=o.getCoordinates(),s=0;s<a.length-2;s++)t.checkCollapse(a[s],a[s+1],a[s+2])};sh.prototype.hasInteriorIntersection=function(t,n,r){for(var o=0;o<t.getIntersectionNum();o++){var a=t.getIntersection(o);if(!(a.equals(n)||a.equals(r)))return!0}return!1};sh.prototype.checkCollapse=function(t,n,r){if(t.equals(r))throw new Ap("found non-noded collapse at "+sh.fact.createLineString([t,n,r]))};sh.prototype.interfaces_=function(){return[]};sh.prototype.getClass=function(){return sh};_j.fact.get=function(){return new dn};Object.defineProperties(sh,_j);var Gu=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=r,n<=0)throw new uo("Scale factor must be non-zero");n!==1&&(this._pt=new oe(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new oe,this._p1Scaled=new oe),this.initCorners(this._pt)},yj={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Gu.prototype.intersectsScaled=function(t,n){var r=Math.min(t.x,n.x),o=Math.max(t.x,n.x),a=Math.min(t.y,n.y),s=Math.max(t.y,n.y),u=this._maxx<r||this._minx>o||this._maxy<a||this._miny>s;if(u)return!1;var l=this.intersectsToleranceSquare(t,n);return on.isTrue(!(u&&l),"Found bad envelope test"),l};Gu.prototype.initCorners=function(t){var n=.5;this._minx=t.x-n,this._maxx=t.x+n,this._miny=t.y-n,this._maxy=t.y+n,this._corner[0]=new oe(this._maxx,this._maxy),this._corner[1]=new oe(this._minx,this._maxy),this._corner[2]=new oe(this._minx,this._miny),this._corner[3]=new oe(this._maxx,this._miny)};Gu.prototype.intersects=function(t,n){return this._scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Gu.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};Gu.prototype.getCoordinate=function(){return this._originalPt};Gu.prototype.copyScaled=function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)};Gu.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=Gu.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new lt(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};Gu.prototype.intersectsPixelClosure=function(t,n){return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Gu.prototype.intersectsToleranceSquare=function(t,n){var r=!1,o=!1;return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&o||t.equals(this._pt)||n.equals(this._pt))};Gu.prototype.addSnappedNode=function(t,n){var r=t.getCoordinate(n),o=t.getCoordinate(n+1);return this.intersects(r,o)?(t.addIntersection(this.getCoordinate(),n),!0):!1};Gu.prototype.interfaces_=function(){return[]};Gu.prototype.getClass=function(){return Gu};yj.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Gu,yj);var GT=function(){this.tempEnv1=new lt,this.selectedSegment=new ht};GT.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};GT.prototype.interfaces_=function(){return[]};GT.prototype.getClass=function(){return GT};var dx=function(){this._index=null;var t=arguments[0];this._index=t},vj={HotPixelSnapAction:{configurable:!0}};dx.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=n.getSafeEnvelope(),s=new Cj(n,r,o);return this._index.query(a,{interfaces_:function(){return[Xm]},visitItem:function(u){var l=u;l.select(a,s)}}),s.isNodeAdded()}};dx.prototype.interfaces_=function(){return[]};dx.prototype.getClass=function(){return dx};vj.HotPixelSnapAction.get=function(){return Cj};Object.defineProperties(dx,vj);var Cj=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],o=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1],a=r.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&o===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,o)}else return e.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(GT),Cy=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Be};Cy.prototype.processIntersections=function(t,n,r,o){var a=this;if(t===r&&n===o)return null;var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];if(this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var f=0;f<this._li.getIntersectionNum();f++)a._interiorIntersections.add(a._li.getIntersection(f));t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)}};Cy.prototype.isDone=function(){return!1};Cy.prototype.getInteriorIntersections=function(){return this._interiorIntersections};Cy.prototype.interfaces_=function(){return[D0]};Cy.prototype.getClass=function(){return Cy};var xd=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new B0,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};xd.prototype.checkCorrectness=function(t){var n=qo.getNodedSubstrings(t),r=new sh(n);try{r.checkValid()}catch(o){if(o instanceof ij)o.printStackTrace();else throw o}finally{}};xd.prototype.getNodedSubstrings=function(){return qo.getNodedSubstrings(this._nodedSegStrings)};xd.prototype.snapRound=function(t,n){var r=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};xd.prototype.findInteriorIntersections=function(t,n){var r=new Cy(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};xd.prototype.computeVertexSnaps=function(){var t=this;if(Rt(arguments[0],Ca))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.computeVertexSnaps(o)}else if(arguments[0]instanceof qo)for(var a=arguments[0],s=a.getCoordinates(),u=0;u<s.length;u++){var l=new Gu(s[u],t._scaleFactor,t._li),c=t._pointSnapper.snap(l,a,u);c&&a.addIntersection(s[u],u)}};xd.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new bB,this._pointSnapper=new dx(this._noder.getIndex()),this.snapRound(t,this._li)};xd.prototype.computeIntersectionSnaps=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=new Gu(o,n._scaleFactor,n._li);n._pointSnapper.snap(a)}};xd.prototype.interfaces_=function(){return[b0]};xd.prototype.getClass=function(){return xd};var hs=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Vr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},Dx={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};hs.prototype.bufferFixedPrecision=function(t){var n=new Zm(new xd(new Gr(1)),t.getScale()),r=new uu(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};hs.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var n=hs.MAX_PRECISION_DIGITS;n>=0;n--){try{t.bufferReducedPrecision(n)}catch(s){if(s instanceof Ip)t._saveException=s;else throw s}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],o=hs.precisionScaleFactor(this._argGeom,this._distance,r),a=new Gr(o);this.bufferFixedPrecision(a)}};hs.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Gr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};hs.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};hs.prototype.bufferOriginalPrecision=function(){try{var t=new uu(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof Ap)this._saveException=n;else throw n}finally{}};hs.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};hs.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};hs.prototype.interfaces_=function(){return[]};hs.prototype.getClass=function(){return hs};hs.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new hs(t),o=r.getResultGeometry(n);return o}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Pt&&typeof arguments[1]=="number"){var a=arguments[0],s=arguments[1],u=arguments[2],l=new hs(a);l.setQuadrantSegments(u);var c=l.getResultGeometry(s);return c}else if(arguments[2]instanceof Vr&&arguments[0]instanceof Pt&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=arguments[2],p=new hs(f,d),_=p.getResultGeometry(h);return _}}else if(arguments.length===4){var y=arguments[0],v=arguments[1],w=arguments[2],C=arguments[3],E=new hs(y);E.setQuadrantSegments(w),E.setEndCapStyle(C);var S=E.getResultGeometry(v);return S}};hs.precisionScaleFactor=function(t,n,r){var o=t.getEnvelopeInternal(),a=ql.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY())),s=n>0?n:0,u=a+2*s,l=Math.trunc(Math.log(u)/Math.log(10)+1),c=r-l,f=Math.pow(10,c);return f};Dx.CAP_ROUND.get=function(){return Vr.CAP_ROUND};Dx.CAP_BUTT.get=function(){return Vr.CAP_FLAT};Dx.CAP_FLAT.get=function(){return Vr.CAP_FLAT};Dx.CAP_SQUARE.get=function(){return Vr.CAP_SQUARE};Dx.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(hs,Dx);var ou=function(){this._pt=[new oe,new oe],this._distance=Kt.NaN,this._isNull=!0};ou.prototype.getCoordinates=function(){return this._pt};ou.prototype.getCoordinate=function(t){return this._pt[t]};ou.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};ou.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};ou.prototype.getDistance=function(){return this._distance};ou.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};ou.prototype.interfaces_=function(){return[]};ou.prototype.getClass=function(){return ou};var dd=function(){};dd.prototype.interfaces_=function(){return[]};dd.prototype.getClass=function(){return dd};dd.computeDistance=function(){if(arguments[2]instanceof ou&&arguments[0]instanceof Po&&arguments[1]instanceof oe)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=t.getCoordinates(),a=new ht,s=0;s<o.length-1;s++){a.setCoordinates(o[s],o[s+1]);var u=a.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof ou&&arguments[0]instanceof Ea&&arguments[1]instanceof oe){var l=arguments[0],c=arguments[1],f=arguments[2];dd.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)dd.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof ou&&arguments[0]instanceof Pt&&arguments[1]instanceof oe){var d=arguments[0],p=arguments[1],_=arguments[2];if(d instanceof Po)dd.computeDistance(d,p,_);else if(d instanceof Ea)dd.computeDistance(d,p,_);else if(d instanceof cu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);dd.computeDistance(w,p,_)}else _.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof ou&&arguments[0]instanceof ht&&arguments[1]instanceof oe){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var M0=function(t){this._maxPtDist=new ou,this._inputGeom=t||null},IB={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};M0.prototype.computeMaxMidpointDistance=function(t){var n=new Qm(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};M0.prototype.computeMaxVertexDistance=function(t){var n=new xy(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};M0.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};M0.prototype.getDistancePoints=function(){return this._maxPtDist};M0.prototype.interfaces_=function(){return[]};M0.prototype.getClass=function(){return M0};IB.MaxPointDistanceFilter.get=function(){return xy};IB.MaxMidpointDistanceFilter.get=function(){return Qm};Object.defineProperties(M0,IB);var xy=function(t){this._maxPtDist=new ou,this._minPtDist=new ou,this._geom=t||null};xy.prototype.filter=function(t){this._minPtDist.initialize(),dd.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};xy.prototype.getMaxPointDistance=function(){return this._maxPtDist};xy.prototype.interfaces_=function(){return[gd]};xy.prototype.getClass=function(){return xy};var Qm=function(t){this._maxPtDist=new ou,this._minPtDist=new ou,this._geom=t||null};Qm.prototype.filter=function(t,n){if(n===0)return null;var r=t.getCoordinate(n-1),o=t.getCoordinate(n),a=new oe((r.x+o.x)/2,(r.y+o.y)/2);this._minPtDist.initialize(),dd.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Qm.prototype.isDone=function(){return!1};Qm.prototype.isGeometryChanged=function(){return!1};Qm.prototype.getMaxPointDistance=function(){return this._maxPtDist};Qm.prototype.interfaces_=function(){return[sf]};Qm.prototype.getClass=function(){return Qm};var wp=function(t){this._comps=t||null};wp.prototype.filter=function(t){t instanceof Ea&&this._comps.add(t)};wp.prototype.interfaces_=function(){return[nh]};wp.prototype.getClass=function(){return wp};wp.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return wp.getPolygons(t,new Be)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Ea?r.add(n):n instanceof cu&&n.apply(new wp(r)),r}};var cs=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};cs.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof _d){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(n),null}t instanceof Po&&this._lines.add(t)};cs.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};cs.prototype.interfaces_=function(){return[bp]};cs.prototype.getClass=function(){return cs};cs.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(cs.getLines(t))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(cs.getLines(n,r))}};cs.getLines=function(){if(arguments.length===1){var t=arguments[0];return cs.getLines(t,!1)}else if(arguments.length===2){if(Rt(arguments[0],Ca)&&Rt(arguments[1],Ca)){for(var n=arguments[0],r=arguments[1],o=n.iterator();o.hasNext();){var a=o.next();cs.getLines(a,r)}return r}else if(arguments[0]instanceof Pt&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1],l=new Be;return s.apply(new cs(l,u)),l}else if(arguments[0]instanceof Pt&&Rt(arguments[1],Ca)){var c=arguments[0],f=arguments[1];return c instanceof Po?f.add(c):c.apply(new cs(f)),f}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Rt(arguments[0],Ca)&&Rt(arguments[1],Ca)){for(var h=arguments[0],d=arguments[1],p=arguments[2],_=h.iterator();_.hasNext();){var y=_.next();cs.getLines(y,d,p)}return d}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Pt&&Rt(arguments[1],Ca)){var v=arguments[0],w=arguments[1],C=arguments[2];return v.apply(new cs(w,C)),w}}};var ff=function(){if(this._boundaryRule=Ac.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new uo("Rule must be non-null");this._boundaryRule=t}}};ff.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof oe&&arguments[1]instanceof Ea){var n=arguments[0],r=arguments[1];if(r.isEmpty())return fe.EXTERIOR;var o=r.getExteriorRing(),a=this.locateInPolygonRing(n,o);if(a===fe.EXTERIOR)return fe.EXTERIOR;if(a===fe.BOUNDARY)return fe.BOUNDARY;for(var s=0;s<r.getNumInteriorRing();s++){var u=r.getInteriorRingN(s),l=t.locateInPolygonRing(n,u);if(l===fe.INTERIOR)return fe.EXTERIOR;if(l===fe.BOUNDARY)return fe.BOUNDARY}return fe.INTERIOR}else if(arguments[0]instanceof oe&&arguments[1]instanceof Po){var c=arguments[0],f=arguments[1];if(!f.getEnvelopeInternal().intersects(c))return fe.EXTERIOR;var h=f.getCoordinates();return!f.isClosed()&&(c.equals(h[0])||c.equals(h[h.length-1]))?fe.BOUNDARY:Ue.isOnLine(c,h)?fe.INTERIOR:fe.EXTERIOR}else if(arguments[0]instanceof oe&&arguments[1]instanceof hl){var d=arguments[0],p=arguments[1],_=p.getCoordinate();return _.equals2D(d)?fe.INTERIOR:fe.EXTERIOR}};ff.prototype.locateInPolygonRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?Ue.locatePointInRing(t,n.getCoordinates()):fe.EXTERIOR};ff.prototype.intersects=function(t,n){return this.locate(t,n)!==fe.EXTERIOR};ff.prototype.updateLocationInfo=function(t){t===fe.INTERIOR&&(this._isIn=!0),t===fe.BOUNDARY&&this._numBoundaries++};ff.prototype.computeLocation=function(t,n){var r=this;if(n instanceof hl&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof Po)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Ea)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof A0)for(var o=n,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);r.updateLocationInfo(r.locateInternal(t,s))}else if(n instanceof pd)for(var u=n,l=0;l<u.getNumGeometries();l++){var c=u.getGeometryN(l);r.updateLocationInfo(r.locateInternal(t,c))}else if(n instanceof cu)for(var f=new md(n);f.hasNext();){var h=f.next();h!==n&&r.computeLocation(t,h)}};ff.prototype.locate=function(t,n){return n.isEmpty()?fe.EXTERIOR:n instanceof Po?this.locateInternal(t,n):n instanceof Ea?this.locateInternal(t,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,n),this._boundaryRule.isInBoundary(this._numBoundaries)?fe.BOUNDARY:this._numBoundaries>0||this._isIn?fe.INTERIOR:fe.EXTERIOR)};ff.prototype.interfaces_=function(){return[]};ff.prototype.getClass=function(){return ff};var au=function e(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._component=r,this._segIndex=o,this._pt=a}},xj={INSIDE_AREA:{configurable:!0}};au.prototype.isInsideArea=function(){return this._segIndex===au.INSIDE_AREA};au.prototype.getCoordinate=function(){return this._pt};au.prototype.getGeometryComponent=function(){return this._component};au.prototype.getSegmentIndex=function(){return this._segIndex};au.prototype.interfaces_=function(){return[]};au.prototype.getClass=function(){return au};xj.INSIDE_AREA.get=function(){return-1};Object.defineProperties(au,xj);var Hm=function(t){this._pts=t||null};Hm.prototype.filter=function(t){t instanceof hl&&this._pts.add(t)};Hm.prototype.interfaces_=function(){return[nh]};Hm.prototype.getClass=function(){return Hm};Hm.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof hl?lf.singletonList(t):Hm.getPoints(t,new Be)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof hl?r.add(n):n instanceof cu&&n.apply(new Hm(r)),r}};var wy=function(){this._locations=null;var t=arguments[0];this._locations=t};wy.prototype.filter=function(t){(t instanceof hl||t instanceof Po||t instanceof Ea)&&this._locations.add(new au(t,0,t.getCoordinate()))};wy.prototype.interfaces_=function(){return[nh]};wy.prototype.getClass=function(){return wy};wy.getLocations=function(t){var n=new Be;return t.apply(new wy(n)),n};var ms=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new ff,this._minDistanceLocation=null,this._minDistance=Kt.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=o,this._terminateDistance=a}};ms.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=1-r,s=wp.getPolygons(this._geom[r]);if(s.size()>0){var u=wy.getLocations(this._geom[a]);if(this.computeContainmentDistance(u,s,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=o[0],this._minDistanceLocation[r]=o[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Rt(arguments[0],of)&&Rt(arguments[1],of)){for(var l=arguments[0],c=arguments[1],f=arguments[2],h=0;h<l.size();h++)for(var d=l.get(h),p=0;p<c.size();p++)if(t.computeContainmentDistance(d,c.get(p),f),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof au&&arguments[1]instanceof Ea){var _=arguments[0],y=arguments[1],v=arguments[2],w=_.getCoordinate();if(fe.EXTERIOR!==this._ptLocator.locate(w,y))return this._minDistance=0,v[0]=_,v[1]=new au(y,w),null}}};ms.prototype.computeMinDistanceLinesPoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};ms.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),n=cs.getLines(this._geom[0]),r=cs.getLines(this._geom[1]),o=Hm.getPoints(this._geom[0]),a=Hm.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,a,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(o,a,t),this.updateMinDistance(t,!1)};ms.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};ms.prototype.updateMinDistance=function(t,n){if(t[0]===null)return null;n?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};ms.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};ms.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Po&&arguments[1]instanceof hl){var n=arguments[0],r=arguments[1],o=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var a=n.getCoordinates(),s=r.getCoordinate(),u=0;u<a.length-1;u++){var l=Ue.distancePointLine(s,a[u],a[u+1]);if(l<t._minDistance){t._minDistance=l;var c=new ht(a[u],a[u+1]),f=c.closestPoint(s);o[0]=new au(n,u,f),o[1]=new au(r,0,s)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Po&&arguments[1]instanceof Po){var h=arguments[0],d=arguments[1],p=arguments[2];if(h.getEnvelopeInternal().distance(d.getEnvelopeInternal())>this._minDistance)return null;for(var _=h.getCoordinates(),y=d.getCoordinates(),v=0;v<_.length-1;v++)for(var w=0;w<y.length-1;w++){var C=Ue.distanceLineLine(_[v],_[v+1],y[w],y[w+1]);if(C<t._minDistance){t._minDistance=C;var E=new ht(_[v],_[v+1]),S=new ht(y[w],y[w+1]),A=E.closestPoints(S);p[0]=new au(h,v,A[0]),p[1]=new au(d,w,A[1])}if(t._minDistance<=t._terminateDistance)return null}}}};ms.prototype.computeMinDistancePoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u),c=s.getCoordinate().distance(l.getCoordinate());if(c<o._minDistance&&(o._minDistance=c,r[0]=new au(s,0,s.getCoordinate()),r[1]=new au(l,0,l.getCoordinate())),o._minDistance<=o._terminateDistance)return null}};ms.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new uo("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};ms.prototype.computeMinDistanceLines=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};ms.prototype.interfaces_=function(){return[]};ms.prototype.getClass=function(){return ms};ms.distance=function(t,n){var r=new ms(t,n);return r.distance()};ms.isWithinDistance=function(t,n,r){var o=new ms(t,n,r);return o.distance()<=r};ms.nearestPoints=function(t,n){var r=new ms(t,n);return r.nearestPoints()};var Fs=function(){this._pt=[new oe,new oe],this._distance=Kt.NaN,this._isNull=!0};Fs.prototype.getCoordinates=function(){return this._pt};Fs.prototype.getCoordinate=function(t){return this._pt[t]};Fs.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};Fs.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};Fs.prototype.toString=function(){return af.toLineString(this._pt[0],this._pt[1])};Fs.prototype.getDistance=function(){return this._distance};Fs.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};Fs.prototype.interfaces_=function(){return[]};Fs.prototype.getClass=function(){return Fs};var Zf=function(){};Zf.prototype.interfaces_=function(){return[]};Zf.prototype.getClass=function(){return Zf};Zf.computeDistance=function(){if(arguments[2]instanceof Fs&&arguments[0]instanceof Po&&arguments[1]instanceof oe)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=new ht,a=t.getCoordinates(),s=0;s<a.length-1;s++){o.setCoordinates(a[s],a[s+1]);var u=o.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof Fs&&arguments[0]instanceof Ea&&arguments[1]instanceof oe){var l=arguments[0],c=arguments[1],f=arguments[2];Zf.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)Zf.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof Fs&&arguments[0]instanceof Pt&&arguments[1]instanceof oe){var d=arguments[0],p=arguments[1],_=arguments[2];if(d instanceof Po)Zf.computeDistance(d,p,_);else if(d instanceof Ea)Zf.computeDistance(d,p,_);else if(d instanceof cu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);Zf.computeDistance(w,p,_)}else _.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof Fs&&arguments[0]instanceof ht&&arguments[1]instanceof oe){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var Sc=function(){this._g0=null,this._g1=null,this._ptDist=new Fs,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n},DB={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Sc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Sc.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new uo("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};Sc.prototype.compute=function(t,n){this.computeOrientedDistance(t,n,this._ptDist),this.computeOrientedDistance(n,t,this._ptDist)};Sc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Sc.prototype.computeOrientedDistance=function(t,n,r){var o=new Ey(n);if(t.apply(o),r.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var a=new Jm(n,this._densifyFrac);t.apply(a),r.setMaximum(a.getMaxPointDistance())}};Sc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};Sc.distance=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Sc(t,n);return r.distance()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Sc(o,a);return u.setDensifyFraction(s),u.distance()}};DB.MaxPointDistanceFilter.get=function(){return Ey};DB.MaxDensifiedByFractionDistanceFilter.get=function(){return Jm};Object.defineProperties(Sc,DB);var Ey=function(){this._maxPtDist=new Fs,this._minPtDist=new Fs,this._euclideanDist=new Zf,this._geom=null;var t=arguments[0];this._geom=t};Ey.prototype.filter=function(t){this._minPtDist.initialize(),Zf.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Ey.prototype.getMaxPointDistance=function(){return this._maxPtDist};Ey.prototype.interfaces_=function(){return[gd]};Ey.prototype.getClass=function(){return Ey};var Jm=function(){this._maxPtDist=new Fs,this._minPtDist=new Fs,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))};Jm.prototype.filter=function(t,n){var r=this;if(n===0)return null;for(var o=t.getCoordinate(n-1),a=t.getCoordinate(n),s=(a.x-o.x)/this._numSubSegs,u=(a.y-o.y)/this._numSubSegs,l=0;l<this._numSubSegs;l++){var c=o.x+l*s,f=o.y+l*u,h=new oe(c,f);r._minPtDist.initialize(),Zf.computeDistance(r._geom,h,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Jm.prototype.isDone=function(){return!1};Jm.prototype.isGeometryChanged=function(){return!1};Jm.prototype.getMaxPointDistance=function(){return this._maxPtDist};Jm.prototype.interfaces_=function(){return[sf]};Jm.prototype.getClass=function(){return Jm};var cl=function(t,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=r||null},PB={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};cl.prototype.checkMaximumDistance=function(t,n,r){var o=new Sc(n,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var a=o.getCoordinates();this._errorLocation=a[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+af.toLineString(a[0],a[1])+")"}};cl.prototype.isValid=function(){var t=Math.abs(this._bufDistance),n=cl.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),cl.VERBOSE&&ps.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};cl.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ea||this._input instanceof pd||this._input instanceof cu))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};cl.prototype.getErrorIndicator=function(){return this._errorIndicator};cl.prototype.checkMinimumDistance=function(t,n,r){var o=new ms(t,n,r);if(this._minDistanceFound=o.distance(),this._minDistanceFound<r){this._isValid=!1;var a=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+af.toLineString(a[0],a[1])+" )"}};cl.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};cl.prototype.getErrorLocation=function(){return this._errorLocation};cl.prototype.getPolygonLines=function(t){for(var n=new Be,r=new cs(n),o=wp.getPolygons(t),a=o.iterator();a.hasNext();){var s=a.next();s.apply(r)}return t.getFactory().buildGeometry(n)};cl.prototype.getErrorMessage=function(){return this._errMsg};cl.prototype.interfaces_=function(){return[]};cl.prototype.getClass=function(){return cl};PB.VERBOSE.get=function(){return!1};PB.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(cl,PB);var gs=function(t,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=r||null},MB={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};gs.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};gs.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*gs.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var n=new lt(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new lt(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};gs.prototype.checkDistance=function(){var t=new cl(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};gs.prototype.checkArea=function(){var t=this._input.getArea(),n=this._result.getArea();this._distance>0&&t>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};gs.prototype.checkPolygonal=function(){this._result instanceof Ea||this._result instanceof pd||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};gs.prototype.getErrorIndicator=function(){return this._errorIndicator};gs.prototype.getErrorLocation=function(){return this._errorLocation};gs.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};gs.prototype.report=function(t){if(!gs.VERBOSE)return null;ps.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};gs.prototype.getErrorMessage=function(){return this._errorMsg};gs.prototype.interfaces_=function(){return[]};gs.prototype.getClass=function(){return gs};gs.isValidMsg=function(t,n,r){var o=new gs(t,n,r);return o.isValid()?null:o.getErrorMessage()};gs.isValid=function(t,n,r){var o=new gs(t,n,r);return!!o.isValid()};MB.VERBOSE.get=function(){return!1};MB.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(gs,MB);var uh=function(){this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};uh.prototype.getCoordinates=function(){return this._pts};uh.prototype.size=function(){return this._pts.length};uh.prototype.getCoordinate=function(t){return this._pts[t]};uh.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};uh.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:yy.octant(this.getCoordinate(t),this.getCoordinate(t+1))};uh.prototype.setData=function(t){this._data=t};uh.prototype.getData=function(){return this._data};uh.prototype.toString=function(){return af.toLineString(new ko(this._pts))};uh.prototype.interfaces_=function(){return[vd]};uh.prototype.getClass=function(){return uh};var Ka=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Be,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Ka.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Ka.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};Ka.prototype.getIntersectionSegments=function(){return this._intSegments};Ka.prototype.count=function(){return this._intersectionCount};Ka.prototype.getIntersections=function(){return this._intersections};Ka.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Ka.prototype.setKeepIntersections=function(t){this._keepIntersections=t};Ka.prototype.processIntersections=function(t,n,r,o){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&n===o)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(t,n)||this.isEndSegment(r,o);if(!a)return null}var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=u,this._intSegments[2]=l,this._intSegments[3]=c,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Ka.prototype.isEndSegment=function(t,n){return n===0||n>=t.size()-2};Ka.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Ka.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Ka.prototype.interfaces_=function(){return[D0]};Ka.prototype.getClass=function(){return Ka};Ka.createAllIntersectionsFinder=function(t){var n=new Ka(t);return n.setFindAllIntersections(!0),n};Ka.createAnyIntersectionFinder=function(t){return new Ka(t)};Ka.createIntersectionCounter=function(t){var n=new Ka(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var hf=function(){this._li=new B0,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};hf.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};hf.prototype.getIntersections=function(){return this._segInt.getIntersections()};hf.prototype.isValid=function(){return this.execute(),this._isValid};hf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};hf.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ka(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new bB;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};hf.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ip(this.getErrorMessage(),this._segInt.getInteriorIntersection())};hf.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+af.toLineString(t[0],t[1])+" and "+af.toLineString(t[2],t[3])};hf.prototype.interfaces_=function(){return[]};hf.prototype.getClass=function(){return hf};hf.computeIntersections=function(t){var n=new hf(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var L0=function e(){this._nv=null;var t=arguments[0];this._nv=new hf(e.toSegmentStrings(t))};L0.prototype.checkValid=function(){this._nv.checkValid()};L0.prototype.interfaces_=function(){return[]};L0.prototype.getClass=function(){return L0};L0.toSegmentStrings=function(t){for(var n=new Be,r=t.iterator();r.hasNext();){var o=r.next();n.add(new uh(o.getCoordinates(),o))}return n};L0.checkValid=function(t){var n=new L0(t);n.checkValid()};var Ty=function(t){this._mapOp=t};Ty.prototype.map=function(t){for(var n=this,r=new Be,o=0;o<t.getNumGeometries();o++){var a=n._mapOp.map(t.getGeometryN(o));a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(dn.toGeometryArray(r))};Ty.prototype.interfaces_=function(){return[]};Ty.prototype.getClass=function(){return Ty};Ty.map=function(t,n){var r=new Ty(n);return r.map(t)};var lh=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Be,this._resultLineList=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=r};lh.prototype.collectLines=function(t){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var o=r.next();n.collectLineEdge(o,t,n._lineEdgesList),n.collectBoundaryTouchEdge(o,t,n._lineEdgesList)}};lh.prototype.labelIsolatedLine=function(t,n){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(n));t.getLabel().setLocation(n,r)};lh.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};lh.prototype.collectLineEdge=function(t,n,r){var o=t.getLabel(),a=t.getEdge();t.isLineEdge()&&!t.isVisited()&&jt.isResultOfOp(o,n)&&!a.isCovered()&&(r.add(a),t.setVisitedEdge(!0))};lh.prototype.findCoveredLineEdges=function(){for(var t=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var o=this._op.getGraph().getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getEdge();if(a.isLineEdge()&&!s.isCoveredSet()){var u=t._op.isCoveredByA(a.getCoordinate());s.setCovered(u)}}};lh.prototype.labelIsolatedLines=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();o.isIsolated()&&(a.isNull(0)?n.labelIsolatedLine(o,0):n.labelIsolatedLine(o,1))}};lh.prototype.buildLines=function(t){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var o=r.next(),a=n._geometryFactory.createLineString(o.getCoordinates());n._resultLineList.add(a),o.setInResult(!0)}};lh.prototype.collectBoundaryTouchEdge=function(t,n,r){var o=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;on.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),jt.isResultOfOp(o,n)&&n===jt.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};lh.prototype.interfaces_=function(){return[]};lh.prototype.getClass=function(){return lh};var Sy=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Be;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n};Sy.prototype.filterCoveredNodeToPoint=function(t){var n=t.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};Sy.prototype.extractNonCoveredResultNodes=function(t){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isInResult()&&!o.isIncidentEdgeInResult()&&(o.getEdges().getDegree()===0||t===jt.INTERSECTION)){var a=o.getLabel();jt.isResultOfOp(a,t)&&n.filterCoveredNodeToPoint(o)}}};Sy.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Sy.prototype.interfaces_=function(){return[]};Sy.prototype.getClass=function(){return Sy};var Uu=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Uu.prototype.transformPoint=function(t,n){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};Uu.prototype.transformPolygon=function(t,n){var r=this,o=!0,a=this.transformLinearRing(t.getExteriorRing(),t);(a===null||!(a instanceof _d)||a.isEmpty())&&(o=!1);for(var s=new Be,u=0;u<t.getNumInteriorRing();u++){var l=r.transformLinearRing(t.getInteriorRingN(u),t);l===null||l.isEmpty()||(l instanceof _d||(o=!1),s.add(l))}if(o)return this._factory.createPolygon(a,s.toArray([]));var c=new Be;return a!==null&&c.add(a),c.addAll(s),this._factory.buildGeometry(c)};Uu.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};Uu.prototype.getInputGeometry=function(){return this._inputGeom};Uu.prototype.transformMultiLineString=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformLineString(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Uu.prototype.transformCoordinates=function(t,n){return this.copy(t)};Uu.prototype.transformLineString=function(t,n){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};Uu.prototype.transformMultiPoint=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformPoint(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Uu.prototype.transformMultiPolygon=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformPolygon(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Uu.prototype.copy=function(t){return t.copy()};Uu.prototype.transformGeometryCollection=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transform(t.getGeometryN(a));s!==null&&(r._pruneEmptyGeometry&&s.isEmpty()||o.add(s))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(dn.toGeometryArray(o)):this._factory.buildGeometry(o)};Uu.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof hl)return this.transformPoint(t,null);if(t instanceof ux)return this.transformMultiPoint(t,null);if(t instanceof _d)return this.transformLinearRing(t,null);if(t instanceof Po)return this.transformLineString(t,null);if(t instanceof A0)return this.transformMultiLineString(t,null);if(t instanceof Ea)return this.transformPolygon(t,null);if(t instanceof pd)return this.transformMultiPolygon(t,null);if(t instanceof cu)return this.transformGeometryCollection(t,null);throw new uo("Unknown Geometry subtype: "+t.getClass().getName())};Uu.prototype.transformLinearRing=function(t,n){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var o=r.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};Uu.prototype.interfaces_=function(){return[]};Uu.prototype.getClass=function(){return Uu};var wd=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ht,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Po&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],o=arguments[1];this._srcPts=r,this._isClosed=e.isClosed(r),this._snapTolerance=o}};wd.prototype.snapVertices=function(t,n){for(var r=this,o=this._isClosed?t.size()-1:t.size(),a=0;a<o;a++){var s=t.get(a),u=r.findSnapForVertex(s,n);u!==null&&(t.set(a,new oe(u)),a===0&&r._isClosed&&t.set(t.size()-1,new oe(u)))}};wd.prototype.findSnapForVertex=function(t,n){for(var r=this,o=0;o<n.length;o++){if(t.equals2D(n[o]))return null;if(t.distance(n[o])<r._snapTolerance)return n[o]}return null};wd.prototype.snapTo=function(t){var n=new $T(this._srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var r=n.toCoordinateArray();return r};wd.prototype.snapSegments=function(t,n){var r=this;if(n.length===0)return null;var o=n.length;n[0].equals2D(n[n.length-1])&&(o=n.length-1);for(var a=0;a<o;a++){var s=n[a],u=r.findSegmentIndexToSnap(s,t);u>=0&&t.add(u+1,new oe(s),!1)}};wd.prototype.findSegmentIndexToSnap=function(t,n){for(var r=this,o=Kt.MAX_VALUE,a=-1,s=0;s<n.size()-1;s++){if(r._seg.p0=n.get(s),r._seg.p1=n.get(s+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var u=r._seg.distance(t);u<r._snapTolerance&&u<o&&(o=u,a=s)}return a};wd.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};wd.prototype.interfaces_=function(){return[]};wd.prototype.getClass=function(){return wd};wd.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var Go=function(t){this._srcGeom=t||null},wj={SNAP_PRECISION_FACTOR:{configurable:!0}};Go.prototype.snapTo=function(t,n){var r=this.extractTargetCoordinates(t),o=new Ej(n,r);return o.transform(this._srcGeom)};Go.prototype.snapToSelf=function(t,n){var r=this.extractTargetCoordinates(this._srcGeom),o=new Ej(t,r,!0),a=o.transform(this._srcGeom),s=a;return n&&Rt(s,Ym)&&(s=a.buffer(0)),s};Go.prototype.computeSnapTolerance=function(t){var n=this.computeMinimumSegmentLength(t),r=n/10;return r};Go.prototype.extractTargetCoordinates=function(t){for(var n=new th,r=t.getCoordinates(),o=0;o<r.length;o++)n.add(r[o]);return n.toArray(new Array(0).fill(null))};Go.prototype.computeMinimumSegmentLength=function(t){for(var n=Kt.MAX_VALUE,r=0;r<t.length-1;r++){var o=t[r].distance(t[r+1]);o<n&&(n=o)}return n};Go.prototype.interfaces_=function(){return[]};Go.prototype.getClass=function(){return Go};Go.snap=function(t,n,r){var o=new Array(2).fill(null),a=new Go(t);o[0]=a.snapTo(n,r);var s=new Go(n);return o[1]=s.snapTo(o[0],r),o};Go.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=Go.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===Gr.FIXED){var o=1/r.getScale()*2/1.415;o>n&&(n=o)}return n}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return Math.min(Go.computeOverlaySnapTolerance(a),Go.computeOverlaySnapTolerance(s))}};Go.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),o=r*Go.SNAP_PRECISION_FACTOR;return o};Go.snapToSelf=function(t,n,r){var o=new Go(t);return o.snapToSelf(n,r)};wj.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Go,wj);var Ej=function(e){function t(n,r,o){e.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=o!==void 0?o:!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,o){var a=new wd(r,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(o)},t.prototype.transformCoordinates=function(r,o){var a=r.toCoordinateArray(),s=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(s)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Uu),iu=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};iu.prototype.getCommon=function(){return Kt.longBitsToDouble(this._commonBits)};iu.prototype.add=function(t){var n=Kt.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=iu.signExpBits(this._commonBits),this._isFirst=!1,null;var r=iu.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=iu.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=iu.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};iu.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],n=Kt.longBitsToDouble(t),r=Kt.toBinaryString(t),o="0000000000000000000000000000000000000000000000000000000000000000"+r,a=o.substring(o.length-64),s=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+n+" ]";return s}};iu.prototype.interfaces_=function(){return[]};iu.prototype.getClass=function(){return iu};iu.getBit=function(t,n){var r=1<<n;return(t&r)!==0?1:0};iu.signExpBits=function(t){return t>>52};iu.zeroLowerBits=function(t,n){var r=(1<<n)-1,o=~r,a=t&o;return a};iu.numCommonMostSigMantissaBits=function(t,n){for(var r=0,o=52;o>=0;o--){if(iu.getBit(t,o)!==iu.getBit(n,o))return r;r++}return 52};var $m=function(){this._commonCoord=null,this._ccFilter=new Ay},LB={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};$m.prototype.addCommonBits=function(t){var n=new eg(this._commonCoord);t.apply(n),t.geometryChanged()};$m.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var n=new oe(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new eg(n);return t.apply(r),t.geometryChanged(),t};$m.prototype.getCommonCoordinate=function(){return this._commonCoord};$m.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};$m.prototype.interfaces_=function(){return[]};$m.prototype.getClass=function(){return $m};LB.CommonCoordinateFilter.get=function(){return Ay};LB.Translater.get=function(){return eg};Object.defineProperties($m,LB);var Ay=function(){this._commonBitsX=new iu,this._commonBitsY=new iu};Ay.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};Ay.prototype.getCommonCoordinate=function(){return new oe(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Ay.prototype.interfaces_=function(){return[gd]};Ay.prototype.getClass=function(){return Ay};var eg=function(){this.trans=null;var t=arguments[0];this.trans=t};eg.prototype.filter=function(t,n){var r=t.getOrdinate(n,0)+this.trans.x,o=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,r),t.setOrdinate(n,1,o)};eg.prototype.isDone=function(){return!1};eg.prototype.isGeometryChanged=function(){return!0};eg.prototype.interfaces_=function(){return[sf]};eg.prototype.getClass=function(){return eg};var Za=function(t,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()};Za.prototype.selfSnap=function(t){var n=new Go(t),r=n.snapTo(t,this._snapTolerance);return r};Za.prototype.removeCommonBits=function(t){this._cbr=new $m,this._cbr.add(t[0]),this._cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t[0].copy()),n[1]=this._cbr.removeCommonBits(t[1].copy()),n};Za.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};Za.prototype.getResultGeometry=function(t){var n=this.snap(this._geom),r=jt.overlayOp(n[0],n[1],t);return this.prepareResult(r)};Za.prototype.checkValid=function(t){t.isValid()||ps.out.println("Snapped geometry is invalid")};Za.prototype.computeSnapTolerance=function(){this._snapTolerance=Go.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};Za.prototype.snap=function(t){var n=this.removeCommonBits(t),r=Go.snap(n[0],n[1],this._snapTolerance);return r};Za.prototype.interfaces_=function(){return[]};Za.prototype.getClass=function(){return Za};Za.overlayOp=function(t,n,r){var o=new Za(t,n);return o.getResultGeometry(r)};Za.union=function(t,n){return Za.overlayOp(t,n,jt.UNION)};Za.intersection=function(t,n){return Za.overlayOp(t,n,jt.INTERSECTION)};Za.symDifference=function(t,n){return Za.overlayOp(t,n,jt.SYMDIFFERENCE)};Za.difference=function(t,n){return Za.overlayOp(t,n,jt.DIFFERENCE)};var du=function(t,n){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n};du.prototype.getResultGeometry=function(t){var n=null,r=!1,o=null;try{n=jt.overlayOp(this._geom[0],this._geom[1],t);var a=!0;a&&(r=!0)}catch(s){if(s instanceof Ap)o=s;else throw s}finally{}if(!r)try{n=Za.overlayOp(this._geom[0],this._geom[1],t)}catch(s){throw s instanceof Ap?o:s}finally{}return n};du.prototype.interfaces_=function(){return[]};du.prototype.getClass=function(){return du};du.overlayOp=function(t,n,r){var o=new du(t,n);return o.getResultGeometry(r)};du.union=function(t,n){return du.overlayOp(t,n,jt.UNION)};du.intersection=function(t,n){return du.overlayOp(t,n,jt.INTERSECTION)};du.symDifference=function(t,n){return du.overlayOp(t,n,jt.SYMDIFFERENCE)};du.difference=function(t,n){return du.overlayOp(t,n,jt.DIFFERENCE)};var UT=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n};UT.prototype.computeIntersections=function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)};UT.prototype.interfaces_=function(){return[]};UT.prototype.getClass=function(){return UT};var ml=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._eventType=e.INSERT,this._label=r,this._xValue=o,this._obj=a}},RB={INSERT:{configurable:!0},DELETE:{configurable:!0}};ml.prototype.isDelete=function(){return this._eventType===ml.DELETE};ml.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};ml.prototype.getObject=function(){return this._obj};ml.prototype.compareTo=function(t){var n=t;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};ml.prototype.getInsertEvent=function(){return this._insertEvent};ml.prototype.isInsert=function(){return this._eventType===ml.INSERT};ml.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};ml.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};ml.prototype.interfaces_=function(){return[Dc]};ml.prototype.getClass=function(){return ml};RB.INSERT.get=function(){return 1};RB.DELETE.get=function(){return 2};Object.defineProperties(ml,RB);var _P=function(){};_P.prototype.interfaces_=function(){return[]};_P.prototype.getClass=function(){return _P};var _s=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=r};_s.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(_s.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.getNumPoints()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};_s.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};_s.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};_s.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};_s.prototype.isBoundaryPointInternal=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next(),a=o.getCoordinate();if(t.isIntersection(a))return!0}return!1};_s.prototype.hasProperIntersection=function(){return this._hasProper};_s.prototype.hasIntersection=function(){return this._hasIntersection};_s.prototype.isDone=function(){return this._isDone};_s.prototype.isBoundaryPoint=function(t,n){return n===null?!1:!!(this.isBoundaryPointInternal(t,n[0])||this.isBoundaryPointInternal(t,n[1]))};_s.prototype.setBoundaryNodes=function(t,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=n};_s.prototype.addIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};_s.prototype.interfaces_=function(){return[]};_s.prototype.getClass=function(){return _s};_s.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var gwe=function(e){function t(){e.call(this),this.events=new Be,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;lf.sort(this.events);for(var o=0;o<this.events.size();o++){var a=r.events.get(o);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(o)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var o=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var s=r.events.get(a);if(s.isInsert()&&r.processOverlaps(a,s.getDeleteEventIndex(),s,o),o.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof _s&&Rt(arguments[0],of)&&Rt(arguments[1],of)){var u=arguments[0],l=arguments[1],c=arguments[2];this.addEdges(u,u),this.addEdges(l,l),this.computeIntersections(c)}else if(typeof arguments[2]=="boolean"&&Rt(arguments[0],of)&&arguments[1]instanceof _s){var f=arguments[0],h=arguments[1],d=arguments[2];d?this.addEdges(f,null):this.addEdges(f),this.computeIntersections(h)}}},t.prototype.addEdge=function(r,o){for(var a=this,s=r.getMonotoneChainEdge(),u=s.getStartIndexes(),l=0;l<u.length-1;l++){var c=new UT(s,l),f=new ml(o,s.getMinX(l),c);a.events.add(f),a.events.add(new ml(s.getMaxX(l),f))}},t.prototype.processOverlaps=function(r,o,a,s){for(var u=this,l=a.getObject(),c=r;c<o;c++){var f=u.events.get(c);if(f.isInsert()){var h=f.getObject();a.isSameLabel(f)||(l.computeIntersections(h,s),u.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var o=arguments[0],a=o.iterator();a.hasNext();){var s=a.next();r.addEdge(s,s)}else if(arguments.length===2)for(var u=arguments[0],l=arguments[1],c=u.iterator();c.hasNext();){var f=c.next();r.addEdge(f,l)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(_P),Ed=function(){this._min=Kt.POSITIVE_INFINITY,this._max=Kt.NEGATIVE_INFINITY},Tj={NodeComparator:{configurable:!0}};Ed.prototype.getMin=function(){return this._min};Ed.prototype.intersects=function(t,n){return!(this._min>n||this._max<t)};Ed.prototype.getMax=function(){return this._max};Ed.prototype.toString=function(){return af.toLineString(new oe(this._min,0),new oe(this._max,0))};Ed.prototype.interfaces_=function(){return[]};Ed.prototype.getClass=function(){return Ed};Tj.NodeComparator.get=function(){return HT};Object.defineProperties(Ed,Tj);var HT=function(){};HT.prototype.compare=function(t,n){var r=t,o=n,a=(r._min+r._max)/2,s=(o._min+o._max)/2;return a<s?-1:a>s?1:0};HT.prototype.interfaces_=function(){return[tx]};HT.prototype.getClass=function(){return HT};var _we=function(e){function t(){e.call(this),this._item=null;var n=arguments[0],r=arguments[1],o=arguments[2];this._min=n,this._max=r,this._item=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;a.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ed),ywe=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,o){this._min=Math.min(r._min,o._min),this._max=Math.max(r._max,o._max)},t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;this._node1!==null&&this._node1.query(r,o,a),this._node2!==null&&this._node2.query(r,o,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ed),Td=function(){this._leaves=new Be,this._root=null,this._level=0};Td.prototype.buildTree=function(){var t=this;lf.sort(this._leaves,new Ed.NodeComparator);for(var n=this._leaves,r=null,o=new Be;;){if(t.buildLevel(n,o),o.size()===1)return o.get(0);r=n,n=o,o=r}};Td.prototype.insert=function(t,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new _we(t,n,r))};Td.prototype.query=function(t,n,r){this.init(),this._root.query(t,n,r)};Td.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Td.prototype.printNode=function(t){ps.out.println(af.toLineString(new oe(t._min,this._level),new oe(t._max,this._level)))};Td.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Td.prototype.buildLevel=function(t,n){this._level++,n.clear();for(var r=0;r<t.size();r+=2){var o=t.get(r),a=r+1<t.size()?t.get(r):null;if(a===null)n.add(o);else{var s=new ywe(t.get(r),t.get(r+1));n.add(s)}}};Td.prototype.interfaces_=function(){return[]};Td.prototype.getClass=function(){return Td};var px=function(){this._items=new Be};px.prototype.visitItem=function(t){this._items.add(t)};px.prototype.getItems=function(){return this._items};px.prototype.interfaces_=function(){return[Xm]};px.prototype.getClass=function(){return px};var mx=function(){this._index=null;var t=arguments[0];if(!Rt(t,Ym))throw new uo("Argument must be Polygonal");this._index=new R0(t)},OB={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};mx.prototype.locate=function(t){var n=new Jf(t),r=new gx(n);return this._index.query(t.y,t.y,r),n.getLocation()};mx.prototype.interfaces_=function(){return[hx]};mx.prototype.getClass=function(){return mx};OB.SegmentVisitor.get=function(){return gx};OB.IntervalIndexedGeometry.get=function(){return R0};Object.defineProperties(mx,OB);var gx=function(){this._counter=null;var t=arguments[0];this._counter=t};gx.prototype.visitItem=function(t){var n=t;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};gx.prototype.interfaces_=function(){return[Xm]};gx.prototype.getClass=function(){return gx};var R0=function(){this._index=new Td;var t=arguments[0];this.init(t)};R0.prototype.init=function(t){for(var n=this,r=cs.getLines(t),o=r.iterator();o.hasNext();){var a=o.next(),s=a.getCoordinates();n.addLine(s)}};R0.prototype.addLine=function(t){for(var n=this,r=1;r<t.length;r++){var o=new ht(t[r-1],t[r]),a=Math.min(o.p0.y,o.p1.y),s=Math.max(o.p0.y,o.p1.y);n._index.insert(a,s,o)}};R0.prototype.query=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new px;return this._index.query(t,n,r),r.getItems()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this._index.query(o,a,s)}};R0.prototype.interfaces_=function(){return[]};R0.prototype.getClass=function(){return R0};var fT=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new uj,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new ff,arguments.length===2){var n=arguments[0],r=arguments[1],o=Ac.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=o,r!==null&&this.add(r)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this._argIndex=a,this._parentGeom=s,this._boundaryNodeRule=u,s!==null&&this.add(s)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,o){var a=this._nodes.addNode(o),s=a.getLabel(),u=1,l=fe.NONE;l=s.getLocation(r,Pe.ON),l===fe.BOUNDARY&&u++;var c=t.determineBoundary(this._boundaryNodeRule,u);s.setLocation(r,c)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.computeSelfNodes(r,o,!1)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2],l=new _s(a,!0,!1);l.setIsDoneIfProperInt(u);var c=this.createEdgeSetIntersector(),f=this._parentGeom instanceof _d||this._parentGeom instanceof Ea||this._parentGeom instanceof pd,h=s||!f;return c.computeIntersections(this._edges,l,h),this.addSelfIntersectionNodes(this._argIndex),l}},t.prototype.computeSplitEdges=function(r){for(var o=this._edges.iterator();o.hasNext();){var a=o.next();a.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,o,a){var s=new _s(o,a,!0);s.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var u=this.createEdgeSetIntersector();return u.computeIntersections(this._edges,r._edges,s),s},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof hl){var r=arguments[0],o=r.getCoordinate();this.insertPoint(this._argIndex,o,fe.INTERIOR)}else if(arguments[0]instanceof oe){var a=arguments[0];this.insertPoint(this._argIndex,a,fe.INTERIOR)}},t.prototype.addPolygon=function(r){var o=this;this.addPolygonRing(r.getExteriorRing(),fe.EXTERIOR,fe.INTERIOR);for(var a=0;a<r.getNumInteriorRing();a++){var s=r.getInteriorRingN(a);o.addPolygonRing(s,fe.INTERIOR,fe.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var o=r.getCoordinates();this.insertPoint(this._argIndex,o[0],fe.BOUNDARY),this.insertPoint(this._argIndex,o[o.length-1],fe.BOUNDARY)},t.prototype.addLineString=function(r){var o=pn.removeRepeatedPoints(r.getCoordinates());if(o.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var a=new gP(o,new ri(this._argIndex,fe.INTERIOR));this._lineEdgeMap.put(r,a),this.insertEdge(a),on.isTrue(o.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,o[0]),this.insertBoundaryPoint(this._argIndex,o[o.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),o=new Array(r.size()).fill(null),a=0,s=r.iterator();s.hasNext();){var u=s.next();o[a++]=u.getCoordinate().copy()}return o},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,o,a){if(this.isBoundaryNode(r,o))return null;a===fe.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,o):this.insertPoint(r,o,a)},t.prototype.addPolygonRing=function(r,o,a){if(r.isEmpty())return null;var s=pn.removeRepeatedPoints(r.getCoordinates());if(s.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var u=o,l=a;Ue.isCCW(s)&&(u=a,l=o);var c=new gP(s,new ri(this._argIndex,fe.BOUNDARY,u,l));this._lineEdgeMap.put(r,c),this.insertEdge(c),this.insertPoint(this._argIndex,s[0],fe.BOUNDARY)},t.prototype.insertPoint=function(r,o,a){var s=this._nodes.addNode(o),u=s.getLabel();u===null?s._label=new ri(r,a):u.setLocation(r,a)},t.prototype.createEdgeSetIntersector=function(){return new gwe},t.prototype.addSelfIntersectionNodes=function(r){for(var o=this,a=this._edges.iterator();a.hasNext();)for(var s=a.next(),u=s.getLabel().getLocation(r),l=s.eiList.iterator();l.hasNext();){var c=l.next();o.addSelfIntersectionNode(r,c.coord,u)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof pd&&(this._useBoundaryDeterminationRule=!1),r instanceof Ea)this.addPolygon(r);else if(r instanceof Po)this.addLineString(r);else if(r instanceof hl)this.addPoint(r);else if(r instanceof ux)this.addCollection(r);else if(r instanceof A0)this.addCollection(r);else if(r instanceof pd)this.addCollection(r);else if(r instanceof cu)this.addCollection(r);else throw new Error(r.getClass().getName())}else return e.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var o=this,a=0;a<r.getNumGeometries();a++){var s=r.getGeometryN(a);o.add(s)}},t.prototype.locate=function(r){return Rt(this._parentGeom,Ym)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new mx(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,o){return r.isInBoundary(o)?fe.BOUNDARY:fe.INTERIOR},t}(wo),_x=function(){if(this._li=new B0,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new fT(0,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=Ac.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fT(0,n,o),this._arg[1]=new fT(1,r,o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];a.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new fT(0,a,u),this._arg[1]=new fT(1,s,u)}};_x.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};_x.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};_x.prototype.interfaces_=function(){return[]};_x.prototype.getClass=function(){return _x};var E0=function(){};E0.prototype.interfaces_=function(){return[]};E0.prototype.getClass=function(){return E0};E0.map=function(){if(arguments[0]instanceof Pt&&Rt(arguments[1],E0.MapOp)){for(var t=arguments[0],n=arguments[1],r=new Be,o=0;o<t.getNumGeometries();o++){var a=n.map(t.getGeometryN(o));a!==null&&r.add(a)}return t.getFactory().buildGeometry(r)}else if(Rt(arguments[0],Ca)&&Rt(arguments[1],E0.MapOp)){for(var s=arguments[0],u=arguments[1],l=new Be,c=s.iterator();c.hasNext();){var f=c.next(),h=u.map(f);h!==null&&l.add(h)}return l}};E0.MapOp=function(){};var jt=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r),this._ptLocator=new ff,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new cf,this._resultPolyList=new Be,this._resultLineList=new Be,this._resultPointList=new Be,this._graph=new wo(new mj),this._geomFact=n.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var o=this._edgeList.findEqualEdge(r);if(o!==null){var a=o.getLabel(),s=r.getLabel();o.isPointwiseEqual(r)||(s=new ri(r.getLabel()),s.flip());var u=o.getDepth();u.isNull()&&u.add(a),u.add(s),a.merge(s)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var o=r.next(),a=o.getSym();o.isInResult()&&a.isInResult()&&(o.setInResult(!1),a.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,o,a,s){var u=new Be;return u.addAll(r),u.addAll(o),u.addAll(a),u.isEmpty()?t.createEmptyResult(s,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(u)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next();o.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,o){for(var a=this,s=o.iterator();s.hasNext();){var u=s.next(),l=a._ptLocator.locate(r,u);if(l!==fe.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new Be,o=this._edgeList.iterator();o.hasNext();){var a=o.next();a.isCollapsed()&&(o.remove(),r.add(a.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next(),a=o.getEdges().getLabel();o.getLabel().merge(a)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var o=this,a=r.iterator();a.hasNext();){var s=a.next();o.insertUniqueEdge(s)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var o=new Be;this._arg[0].computeSplitEdges(o),this._arg[1].computeSplitEdges(o),this.insertUniqueEdges(o),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),L0.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var a=new dl(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var s=new lh(this,this._geomFact,this._ptLocator);this._resultLineList=s.build(r);var u=new Sy(this,this._geomFact,this._ptLocator);this._resultPointList=u.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,o){var a=this._ptLocator.locate(r.getCoordinate(),this._arg[o].getGeometry());r.getLabel().setLocation(o,a)},t.prototype.copyPoints=function(r){for(var o=this,a=this._arg[r].getNodeIterator();a.hasNext();){var s=a.next(),u=o._graph.addNode(s.getCoordinate());u.setLabel(r,s.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var o=this._graph.getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.isArea()&&!a.isInteriorAreaEdge()&&t.isResultOfOp(s.getLocation(0,Pe.RIGHT),s.getLocation(1,Pe.RIGHT),r)&&a.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var o=r.next(),a=o.getLabel(),s=o.getDepth();if(!s.isNull()){s.normalize();for(var u=0;u<2;u++)!a.isNull(u)&&a.isArea()&&!s.isNull(u)&&(s.getDelta(u)===0?a.toLine(u):(on.isTrue(!s.isNull(u,Pe.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(u,Pe.LEFT,s.getLocation(u,Pe.LEFT)),on.isTrue(!s.isNull(u,Pe.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(u,Pe.RIGHT,s.getLocation(u,Pe.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next();a.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();a.isIsolated()&&(s.isNull(0)?r.labelIncompleteNode(a,0):r.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(s)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(_x);jt.overlayOp=function(e,t,n){var r=new jt(e,t),o=r.getResultGeometry(n);return o};jt.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return jt.createEmptyResult(jt.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return Ty.map(e,{interfaces_:function(){return[E0.MapOp]},map:function(r){return r.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),du.overlayOp(e,t,jt.INTERSECTION)};jt.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return jt.createEmptyResult(jt.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),du.overlayOp(e,t,jt.SYMDIFFERENCE)};jt.resultDimension=function(e,t,n){var r=t.getDimension(),o=n.getDimension(),a=-1;switch(e){case jt.INTERSECTION:a=Math.min(r,o);break;case jt.UNION:a=Math.max(r,o);break;case jt.DIFFERENCE:a=r;break;case jt.SYMDIFFERENCE:a=Math.max(r,o);break;default:}return a};jt.createEmptyResult=function(e,t,n,r){var o=null;switch(jt.resultDimension(e,t,n)){case-1:o=r.createGeometryCollection(new Array(0).fill(null));break;case 0:o=r.createPoint();break;case 1:o=r.createLineString();break;case 2:o=r.createPolygon();break;default:}return o};jt.difference=function(e,t){return e.isEmpty()?jt.createEmptyResult(jt.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),du.overlayOp(e,t,jt.DIFFERENCE))};jt.isResultOfOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=e.getLocation(0),r=e.getLocation(1);return jt.isResultOfOp(n,r,t)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];switch(o===fe.BOUNDARY&&(o=fe.INTERIOR),a===fe.BOUNDARY&&(a=fe.INTERIOR),s){case jt.INTERSECTION:return o===fe.INTERIOR&&a===fe.INTERIOR;case jt.UNION:return o===fe.INTERIOR||a===fe.INTERIOR;case jt.DIFFERENCE:return o===fe.INTERIOR&&a!==fe.INTERIOR;case jt.SYMDIFFERENCE:return o===fe.INTERIOR&&a!==fe.INTERIOR||o!==fe.INTERIOR&&a===fe.INTERIOR;default:}return!1}};jt.INTERSECTION=1;jt.UNION=2;jt.DIFFERENCE=3;jt.SYMDIFFERENCE=4;var qm=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new ff,this._seg=new ht;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)};qm.prototype.isWithinToleranceOfBoundary=function(t){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var o=n._linework.getGeometryN(r),a=o.getCoordinateSequence(),s=0;s<a.size()-1;s++){a.getCoordinate(s,n._seg.p0),a.getCoordinate(s+1,n._seg.p1);var u=n._seg.distance(t);if(u<=n._boundaryDistanceTolerance)return!0}return!1};qm.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?fe.BOUNDARY:this._ptLocator.locate(t,this._g)};qm.prototype.extractLinework=function(t){var n=new yx;t.apply(n);var r=n.getLinework(),o=dn.toLineStringArray(r);return t.getFactory().createMultiLineString(o)};qm.prototype.interfaces_=function(){return[]};qm.prototype.getClass=function(){return qm};var yx=function(){this._linework=null,this._linework=new Be};yx.prototype.getLinework=function(){return this._linework};yx.prototype.filter=function(t){var n=this;if(t instanceof Ea){var r=t;this._linework.add(r.getExteriorRing());for(var o=0;o<r.getNumInteriorRing();o++)n._linework.add(r.getInteriorRingN(o))}};yx.prototype.interfaces_=function(){return[nh]};yx.prototype.getClass=function(){return yx};var O0=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};O0.prototype.extractPoints=function(t,n,r){for(var o=this,a=t.getCoordinates(),s=0;s<a.length-1;s++)o.computeOffsetPoints(a[s],a[s+1],n,r)};O0.prototype.setSidesToGenerate=function(t,n){this._doLeft=t,this._doRight=n};O0.prototype.getPoints=function(t){for(var n=this,r=new Be,o=cs.getLines(this._g),a=o.iterator();a.hasNext();){var s=a.next();n.extractPoints(s,t,r)}return r};O0.prototype.computeOffsetPoints=function(t,n,r,o){var a=n.x-t.x,s=n.y-t.y,u=Math.sqrt(a*a+s*s),l=r*a/u,c=r*s/u,f=(n.x+t.x)/2,h=(n.y+t.y)/2;if(this._doLeft){var d=new oe(f-c,h+l);o.add(d)}if(this._doRight){var p=new oe(f+c,h-l);o.add(p)}};O0.prototype.interfaces_=function(){return[]};O0.prototype.getClass=function(){return O0};var jl=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,r],this._locFinder=[new qm(this._geom[0],this._boundaryDistanceTolerance),new qm(this._geom[1],this._boundaryDistanceTolerance),new qm(this._geom[2],this._boundaryDistanceTolerance)]},Sj={TOLERANCE:{configurable:!0}};jl.prototype.reportResult=function(t,n,r){ps.out.println("Overlay result invalid - A:"+fe.toLocationSymbol(n[0])+" B:"+fe.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+fe.toLocationSymbol(n[2]))};jl.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(t);return n};jl.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var o=t._testCoords.get(r);if(!t.checkValid(n,o))return t._invalidLocation=o,!1}return!0}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),jl.hasLocation(this._location,fe.BOUNDARY)?!0:this.isValidResult(a,this._location)}};jl.prototype.addTestPts=function(t){var n=new O0(t);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};jl.prototype.isValidResult=function(t,n){var r=jt.isResultOfOp(n[0],n[1],t),o=n[2]===fe.INTERIOR,a=!(r^o);return a||this.reportResult(t,n,r),a};jl.prototype.getInvalidLocation=function(){return this._invalidLocation};jl.prototype.interfaces_=function(){return[]};jl.prototype.getClass=function(){return jl};jl.hasLocation=function(t,n){for(var r=0;r<3;r++)if(t[r]===n)return!0;return!1};jl.computeBoundaryDistanceTolerance=function(t,n){return Math.min(Go.computeSizeBasedSnapTolerance(t),Go.computeSizeBasedSnapTolerance(n))};jl.isValid=function(t,n,r,o){var a=new jl(t,n,o);return a.isValid(r)};Sj.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(jl,Sj);var kl=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};kl.prototype.extractElements=function(t,n){var r=this;if(t===null)return null;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);r._skipEmpty&&a.isEmpty()||n.add(a)}};kl.prototype.combine=function(){for(var t=this,n=new Be,r=this._inputGeoms.iterator();r.hasNext();){var o=r.next();t.extractElements(o,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};kl.prototype.interfaces_=function(){return[]};kl.prototype.getClass=function(){return kl};kl.combine=function(){if(arguments.length===1){var t=arguments[0],n=new kl(t);return n.combine()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new kl(kl.createList(r,o));return a.combine()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2],c=new kl(kl.createList(s,u,l));return c.combine()}};kl.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};kl.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Be;return r.add(t),r.add(n),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Be;return u.add(o),u.add(a),u.add(s),u}};var oa=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new Be)},Aj={STRTREE_NODE_CAPACITY:{configurable:!0}};oa.prototype.reduceToGeometries=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=null;Rt(a,of)?s=n.unionTree(a):a instanceof Pt&&(s=a),r.add(s)}return r};oa.prototype.extractByEnvelope=function(t,n,r){for(var o=new Be,a=0;a<n.getNumGeometries();a++){var s=n.getGeometryN(a);s.getEnvelopeInternal().intersects(t)?o.add(s):r.add(s)}return this._geomFactory.buildGeometry(o)};oa.prototype.unionOptimized=function(t,n){var r=t.getEnvelopeInternal(),o=n.getEnvelopeInternal();if(!r.intersects(o)){var a=kl.combine(t,n);return a}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var s=r.intersection(o);return this.unionUsingEnvelopeIntersection(t,n,s)};oa.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new fj(oa.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var o=t.itemsTree(),a=this.unionTree(o);return a};oa.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2];if(o-r<=1){var a=oa.getGeometry(n,r);return this.unionSafe(a,null)}else{if(o-r===2)return this.unionSafe(oa.getGeometry(n,r),oa.getGeometry(n,r+1));var s=Math.trunc((o+r)/2),u=this.binaryUnion(n,r,s),l=this.binaryUnion(n,s,o);return this.unionSafe(u,l)}}};oa.prototype.repeatedUnion=function(t){for(var n=null,r=t.iterator();r.hasNext();){var o=r.next();n===null?n=o.copy():n=n.union(o)}return n};oa.prototype.unionSafe=function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)};oa.prototype.unionActual=function(t,n){return oa.restrictToPolygons(t.union(n))};oa.prototype.unionTree=function(t){var n=this.reduceToGeometries(t),r=this.binaryUnion(n);return r};oa.prototype.unionUsingEnvelopeIntersection=function(t,n,r){var o=new Be,a=this.extractByEnvelope(r,t,o),s=this.extractByEnvelope(r,n,o),u=this.unionActual(a,s);o.add(u);var l=kl.combine(o);return l};oa.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),r=n.buildGeometry(t),o=r.buffer(0);return o}else if(arguments.length===2){var a=arguments[0],s=arguments[1],u=a.getFactory(),l=u.createGeometryCollection([a,s]),c=l.buffer(0);return c}};oa.prototype.interfaces_=function(){return[]};oa.prototype.getClass=function(){return oa};oa.restrictToPolygons=function(t){if(Rt(t,Ym))return t;var n=wp.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(dn.toPolygonArray(n))};oa.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)};oa.union=function(t){var n=new oa(t);return n.union()};Aj.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(oa,Aj);var qT=function(){};qT.prototype.interfaces_=function(){return[]};qT.prototype.getClass=function(){return qT};qT.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return jt.createEmptyResult(jt.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),du.overlayOp(t,n,jt.UNION)};function vwe(e,t){var n=Hl(e),r=Hl(t),o=e.properties||{};if(n=vY(n),r=vY(r),!n)return null;if(!r)return aa(n,o);var a=new Ix,s=a.read(n),u=a.read(r),l=jt.difference(s,u);if(l.isEmpty())return null;var c=new tS,f=c.write(l);return aa(f,o)}function vY(e){switch(e.type){case"Polygon":return bT(e)>1?e:null;case"MultiPolygon":var t=[];if(Ho(e,function(n){bT(n)>1&&t.push(n.geometry.coordinates)}),t.length)return{type:"MultiPolygon",coordinates:t}}}var F0=function(){return new yP};function yP(){this.reset()}yP.prototype={constructor:yP,reset:function(){this.s=this.t=0},add:function(e){CY(XD,e,this.t),CY(this,XD.s,this.s),this.s?this.t+=XD.t:this.s=XD.t},valueOf:function(){return this.s}};var XD=new yP;function CY(e,t,n){var r=e.s=t+n,o=r-t,a=r-o;e.t=t-a+(n-o)}var Do=1e-6,Ii=Math.PI,wc=Ii/2,xY=Ii/4,Mp=Ii*2,Kf=180/Ii,Os=Ii/180,su=Math.abs,NB=Math.atan,WT=Math.atan2,fs=Math.cos,bj=Math.exp,Ij=Math.log,Bs=Math.sin,KP=Math.sqrt,Dj=Math.tan;function Cwe(e){return e>1?0:e<-1?Ii:Math.acos(e)}function YT(e){return e>1?wc:e<-1?-wc:Math.asin(e)}function vT(){}function vP(e,t){e&&EY.hasOwnProperty(e.type)&&EY[e.type](e,t)}var wY={Feature:function(e,t){vP(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,o=n.length;++r<o;)vP(n[r].geometry,t)}},EY={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){V3(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)V3(n[r],t,0)},Polygon:function(e,t){TY(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)TY(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,o=n.length;++r<o;)vP(n[r],t)}};function V3(e,t,n){var r=-1,o=e.length-n,a;for(t.lineStart();++r<o;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function TY(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)V3(e[n],t,1);t.polygonEnd()}var xwe=function(e,t){e&&wY.hasOwnProperty(e.type)?wY[e.type](e,t):vP(e,t)},B0t=F0(),F0t=F0();function k3(e){return[WT(e[1],e[0]),YT(e[2])]}function vx(e){var t=e[0],n=e[1],r=fs(n);return[r*fs(t),r*Bs(t),Bs(n)]}function jD(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function CP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function w3(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function KD(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function G3(e){var t=KP(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var z0t=F0(),Pj=function(e,t){function n(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,o){return r=t.invert(r,o),r&&e.invert(r[0],r[1])}),n};function U3(e,t){return[e>Ii?e-Mp:e<-Ii?e+Mp:e,t]}U3.invert=U3;function Mj(e,t,n){return(e%=Mp)?t||n?Pj(AY(e),bY(t,n)):AY(e):t||n?bY(t,n):U3}function SY(e){return function(t,n){return t+=e,[t>Ii?t-Mp:t<-Ii?t+Mp:t,n]}}function AY(e){var t=SY(e);return t.invert=SY(-e),t}function bY(e,t){var n=fs(e),r=Bs(e),o=fs(t),a=Bs(t);function s(u,l){var c=fs(l),f=fs(u)*c,h=Bs(u)*c,d=Bs(l),p=d*n+f*r;return[WT(h*o-p*a,f*n-d*r),YT(p*o+h*a)]}return s.invert=function(u,l){var c=fs(l),f=fs(u)*c,h=Bs(u)*c,d=Bs(l),p=d*o-h*a;return[WT(h*o+d*a,f*n+p*r),YT(p*n-f*r)]},s}var wwe=function(e){e=Mj(e[0]*Os,e[1]*Os,e.length>2?e[2]*Os:0);function t(n){return n=e(n[0]*Os,n[1]*Os),n[0]*=Kf,n[1]*=Kf,n}return t.invert=function(n){return n=e.invert(n[0]*Os,n[1]*Os),n[0]*=Kf,n[1]*=Kf,n},t};function Ewe(e,t,n,r,o,a){if(!!n){var s=fs(t),u=Bs(t),l=r*n;o==null?(o=t+r*Mp,a=t-l/2):(o=IY(s,o),a=IY(s,a),(r>0?o<a:o>a)&&(o+=r*Mp));for(var c,f=o;r>0?f>a:f<a;f-=l)c=k3([s,-u*fs(f),-u*Bs(f)]),e.point(c[0],c[1])}}function IY(e,t){t=vx(t),t[0]-=e,G3(t);var n=Cwe(-t[1]);return((-t[2]<0?-n:n)+Mp-Do)%Mp}var Lj=function(){var e=[],t;return{point:function(n,r){t.push([n,r])},lineStart:function(){e.push(t=[])},lineEnd:vT,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Twe=function(e,t,n,r,o,a){var s=e[0],u=e[1],l=t[0],c=t[1],f=0,h=1,d=l-s,p=c-u,_;if(_=n-s,!(!d&&_>0)){if(_/=d,d<0){if(_<f)return;_<h&&(h=_)}else if(d>0){if(_>h)return;_>f&&(f=_)}if(_=o-s,!(!d&&_<0)){if(_/=d,d<0){if(_>h)return;_>f&&(f=_)}else if(d>0){if(_<f)return;_<h&&(h=_)}if(_=r-u,!(!p&&_>0)){if(_/=p,p<0){if(_<f)return;_<h&&(h=_)}else if(p>0){if(_>h)return;_>f&&(f=_)}if(_=a-u,!(!p&&_<0)){if(_/=p,p<0){if(_>h)return;_>f&&(f=_)}else if(p>0){if(_<f)return;_<h&&(h=_)}return f>0&&(e[0]=s+f*d,e[1]=u+f*p),h<1&&(t[0]=s+h*d,t[1]=u+h*p),!0}}}}},tP=function(e,t){return su(e[0]-t[0])<Do&&su(e[1]-t[1])<Do};function ZD(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Rj=function(e,t,n,r,o){var a=[],s=[],u,l;if(e.forEach(function(_){if(!((y=_.length-1)<=0)){var y,v=_[0],w=_[y],C;if(tP(v,w)){for(o.lineStart(),u=0;u<y;++u)o.point((v=_[u])[0],v[1]);o.lineEnd();return}a.push(C=new ZD(v,_,null,!0)),s.push(C.o=new ZD(v,null,C,!1)),a.push(C=new ZD(w,_,null,!1)),s.push(C.o=new ZD(w,null,C,!0))}}),!!a.length){for(s.sort(t),DY(a),DY(s),u=0,l=s.length;u<l;++u)s[u].e=n=!n;for(var c=a[0],f,h;;){for(var d=c,p=!0;d.v;)if((d=d.n)===c)return;f=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(u=0,l=f.length;u<l;++u)o.point((h=f[u])[0],h[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(f=d.p.z,u=f.length-1;u>=0;--u)o.point((h=f[u])[0],h[1]);else r(d.x,d.p.x,-1,o);d=d.p}d=d.o,f=d.z,p=!p}while(!d.v);o.lineEnd()}}};function DY(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],o;++n<t;)r.n=o=e[n],o.p=r,r=o;r.n=o=e[0],o.p=r}}var Oj=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Swe=function(e){return e.length===1&&(e=Awe(e)),{left:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)<0?r=a+1:o=a}return r},right:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)>0?o=a:r=a+1}return r}}};function Awe(e){return function(t,n){return Oj(e(t),n)}}var V0t=Swe(Oj),Nj=function(e){for(var t=e.length,n,r=-1,o=0,a,s;++r<t;)o+=e[r].length;for(a=new Array(o);--t>=0;)for(s=e[t],n=s.length;--n>=0;)a[--o]=s[n];return a},CT=1e9,QD=-CT;function bwe(e,t,n,r){function o(c,f){return e<=c&&c<=n&&t<=f&&f<=r}function a(c,f,h,d){var p=0,_=0;if(c==null||(p=s(c,h))!==(_=s(f,h))||l(c,f)<0^h>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+h+4)%4)!==_);else d.point(f[0],f[1])}function s(c,f){return su(c[0]-e)<Do?f>0?0:3:su(c[0]-n)<Do?f>0?2:1:su(c[1]-t)<Do?f>0?1:0:f>0?3:2}function u(c,f){return l(c.x,f.x)}function l(c,f){var h=s(c,1),d=s(f,1);return h!==d?h-d:h===0?f[1]-c[1]:h===1?c[0]-f[0]:h===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,h=Lj(),d,p,_,y,v,w,C,E,S,A,D,P={point:M,lineStart:I,lineEnd:L,polygonStart:O,polygonEnd:m};function M(N,B){o(N,B)&&f.point(N,B)}function b(){for(var N=0,B=0,V=p.length;B<V;++B)for(var z=p[B],U=1,Q=z.length,ne=z[0],se,de,pe=ne[0],ve=ne[1];U<Q;++U)se=pe,de=ve,ne=z[U],pe=ne[0],ve=ne[1],de<=r?ve>r&&(pe-se)*(r-de)>(ve-de)*(e-se)&&++N:ve<=r&&(pe-se)*(r-de)<(ve-de)*(e-se)&&--N;return N}function O(){f=h,d=[],p=[],D=!0}function m(){var N=b(),B=D&&N,V=(d=Nj(d)).length;(B||V)&&(c.polygonStart(),B&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),V&&Rj(d,u,N,a,c),c.polygonEnd()),f=c,d=p=_=null}function I(){P.point=R,p&&p.push(_=[]),A=!0,S=!1,C=E=NaN}function L(){d&&(R(y,v),w&&S&&h.rejoin(),d.push(h.result())),P.point=M,S&&f.lineEnd()}function R(N,B){var V=o(N,B);if(p&&_.push([N,B]),A)y=N,v=B,w=V,A=!1,V&&(f.lineStart(),f.point(N,B));else if(V&&S)f.point(N,B);else{var z=[C=Math.max(QD,Math.min(CT,C)),E=Math.max(QD,Math.min(CT,E))],U=[N=Math.max(QD,Math.min(CT,N)),B=Math.max(QD,Math.min(CT,B))];Twe(z,U,e,t,n,r)?(S||(f.lineStart(),f.point(z[0],z[1])),f.point(U[0],U[1]),V||f.lineEnd(),D=!1):V&&(f.lineStart(),f.point(N,B),D=!1)}C=N,E=B,S=V}return P}}var E3=F0(),Iwe=function(e,t){var n=t[0],r=t[1],o=[Bs(n),-fs(n),0],a=0,s=0;E3.reset();for(var u=0,l=e.length;u<l;++u)if(!!(f=(c=e[u]).length))for(var c,f,h=c[f-1],d=h[0],p=h[1]/2+xY,_=Bs(p),y=fs(p),v=0;v<f;++v,d=C,_=S,y=A,h=w){var w=c[v],C=w[0],E=w[1]/2+xY,S=Bs(E),A=fs(E),D=C-d,P=D>=0?1:-1,M=P*D,b=M>Ii,O=_*S;if(E3.add(WT(O*P*Bs(M),y*A+O*fs(M))),a+=b?D+P*Mp:D,b^d>=n^C>=n){var m=CP(vx(h),vx(w));G3(m);var I=CP(o,m);G3(I);var L=(b^D>=0?-1:1)*YT(I[2]);(r>L||r===L&&(m[0]||m[1]))&&(s+=b^D>=0?1:-1)}}return(a<-Do||a<Do&&E3<-Do)^s&1},k0t=F0(),PY=function(e){return e},G0t=F0(),U0t=F0(),Cx=1/0,xP=Cx,XT=-Cx,wP=XT,MY={point:Dwe,lineStart:vT,lineEnd:vT,polygonStart:vT,polygonEnd:vT,result:function(){var e=[[Cx,xP],[XT,wP]];return XT=wP=-(xP=Cx=1/0),e}};function Dwe(e,t){e<Cx&&(Cx=e),e>XT&&(XT=e),t<xP&&(xP=t),t>wP&&(wP=t)}var H0t=F0(),Bj=function(e,t,n,r){return function(o,a){var s=t(a),u=o.invert(r[0],r[1]),l=Lj(),c=t(l),f=!1,h,d,p,_={point:y,lineStart:w,lineEnd:C,polygonStart:function(){_.point=E,_.lineStart=S,_.lineEnd=A,d=[],h=[]},polygonEnd:function(){_.point=y,_.lineStart=w,_.lineEnd=C,d=Nj(d);var D=Iwe(h,u);d.length?(f||(a.polygonStart(),f=!0),Rj(d,Mwe,D,n,a)):D&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),d=h=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function y(D,P){var M=o(D,P);e(D=M[0],P=M[1])&&a.point(D,P)}function v(D,P){var M=o(D,P);s.point(M[0],M[1])}function w(){_.point=v,s.lineStart()}function C(){_.point=y,s.lineEnd()}function E(D,P){p.push([D,P]);var M=o(D,P);c.point(M[0],M[1])}function S(){c.lineStart(),p=[]}function A(){E(p[0][0],p[0][1]),c.lineEnd();var D=c.clean(),P=l.result(),M,b=P.length,O,m,I;if(p.pop(),h.push(p),p=null,!!b){if(D&1){if(m=P[0],(O=m.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),M=0;M<O;++M)a.point((I=m[M])[0],I[1]);a.lineEnd()}return}b>1&&D&2&&P.push(P.pop().concat(P.shift())),d.push(P.filter(Pwe))}}return _}};function Pwe(e){return e.length>1}function Mwe(e,t){return((e=e.x)[0]<0?e[1]-wc-Do:wc-e[1])-((t=t.x)[0]<0?t[1]-wc-Do:wc-t[1])}var LY=Bj(function(){return!0},Lwe,Owe,[-Ii,-wc]);function Lwe(e){var t=NaN,n=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(a,s){var u=a>0?Ii:-Ii,l=su(a-t);su(l-Ii)<Do?(e.point(t,n=(n+s)/2>0?wc:-wc),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(a,n),o=0):r!==u&&l>=Ii&&(su(t-r)<Do&&(t-=r*Do),su(a-u)<Do&&(a-=u*Do),n=Rwe(t,n,a,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),o=0),e.point(t=a,n=s),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-o}}}function Rwe(e,t,n,r){var o,a,s=Bs(e-n);return su(s)>Do?NB((Bs(t)*(a=fs(r))*Bs(n)-Bs(r)*(o=fs(t))*Bs(e))/(o*a*s)):(t+r)/2}function Owe(e,t,n,r){var o;if(e==null)o=n*wc,r.point(-Ii,o),r.point(0,o),r.point(Ii,o),r.point(Ii,0),r.point(Ii,-o),r.point(0,-o),r.point(-Ii,-o),r.point(-Ii,0),r.point(-Ii,o);else if(su(e[0]-t[0])>Do){var a=e[0]<t[0]?Ii:-Ii;o=n*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}var Nwe=function(e,t){var n=fs(e),r=n>0,o=su(n)>Do;function a(f,h,d,p){Ewe(p,e,t,d,f,h)}function s(f,h){return fs(f)*fs(h)>n}function u(f){var h,d,p,_,y;return{lineStart:function(){_=p=!1,y=1},point:function(v,w){var C=[v,w],E,S=s(v,w),A=r?S?0:c(v,w):S?c(v+(v<0?Ii:-Ii),w):0;if(!h&&(_=p=S)&&f.lineStart(),S!==p&&(E=l(h,C),(!E||tP(h,E)||tP(C,E))&&(C[0]+=Do,C[1]+=Do,S=s(C[0],C[1]))),S!==p)y=0,S?(f.lineStart(),E=l(C,h),f.point(E[0],E[1])):(E=l(h,C),f.point(E[0],E[1]),f.lineEnd()),h=E;else if(o&&h&&r^S){var D;!(A&d)&&(D=l(C,h,!0))&&(y=0,r?(f.lineStart(),f.point(D[0][0],D[0][1]),f.point(D[1][0],D[1][1]),f.lineEnd()):(f.point(D[1][0],D[1][1]),f.lineEnd(),f.lineStart(),f.point(D[0][0],D[0][1])))}S&&(!h||!tP(h,C))&&f.point(C[0],C[1]),h=C,p=S,d=A},lineEnd:function(){p&&f.lineEnd(),h=null},clean:function(){return y|(_&&p)<<1}}}function l(f,h,d){var p=vx(f),_=vx(h),y=[1,0,0],v=CP(p,_),w=jD(v,v),C=v[0],E=w-C*C;if(!E)return!d&&f;var S=n*w/E,A=-n*C/E,D=CP(y,v),P=KD(y,S),M=KD(v,A);w3(P,M);var b=D,O=jD(P,b),m=jD(b,b),I=O*O-m*(jD(P,P)-1);if(!(I<0)){var L=KP(I),R=KD(b,(-O-L)/m);if(w3(R,P),R=k3(R),!d)return R;var N=f[0],B=h[0],V=f[1],z=h[1],U;B<N&&(U=N,N=B,B=U);var Q=B-N,ne=su(Q-Ii)<Do,se=ne||Q<Do;if(!ne&&z<V&&(U=V,V=z,z=U),se?ne?V+z>0^R[1]<(su(R[0]-N)<Do?V:z):V<=R[1]&&R[1]<=z:Q>Ii^(N<=R[0]&&R[0]<=B)){var de=KD(b,(-O+L)/m);return w3(de,P),[R,k3(de)]}}}function c(f,h){var d=r?e:Ii-e,p=0;return f<-d?p|=1:f>d&&(p|=2),h<-d?p|=4:h>d&&(p|=8),p}return Bj(s,u,a,r?[0,-e]:[-Ii,e-Ii])};function Fj(e){return function(t){var n=new H3;for(var r in e)n[r]=e[r];return n.stream=t,n}}function H3(){}H3.prototype={constructor:H3,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function zj(e,t,n){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),xwe(n,e.stream(MY));var s=MY.result(),u=Math.min(r/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),l=+t[0][0]+(r-u*(s[1][0]+s[0][0]))/2,c=+t[0][1]+(o-u*(s[1][1]+s[0][1]))/2;return a!=null&&e.clipExtent(a),e.scale(u*150).translate([l,c])}function Bwe(e,t,n){return zj(e,[[0,0],t],n)}var RY=16,Fwe=fs(30*Os),OY=function(e,t){return+t?Vwe(e,t):zwe(e)};function zwe(e){return Fj({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Vwe(e,t){function n(r,o,a,s,u,l,c,f,h,d,p,_,y,v){var w=c-r,C=f-o,E=w*w+C*C;if(E>4*t&&y--){var S=s+d,A=u+p,D=l+_,P=KP(S*S+A*A+D*D),M=YT(D/=P),b=su(su(D)-1)<Do||su(a-h)<Do?(a+h)/2:WT(A,S),O=e(b,M),m=O[0],I=O[1],L=m-r,R=I-o,N=C*L-w*R;(N*N/E>t||su((w*L+C*R)/E-.5)>.3||s*d+u*p+l*_<Fwe)&&(n(r,o,a,s,u,l,m,I,b,S/=P,A/=P,D,y,v),v.point(m,I),n(m,I,b,S,A,D,c,f,h,d,p,_,y,v))}}return function(r){var o,a,s,u,l,c,f,h,d,p,_,y,v={point:w,lineStart:C,lineEnd:S,polygonStart:function(){r.polygonStart(),v.lineStart=A},polygonEnd:function(){r.polygonEnd(),v.lineStart=C}};function w(M,b){M=e(M,b),r.point(M[0],M[1])}function C(){h=NaN,v.point=E,r.lineStart()}function E(M,b){var O=vx([M,b]),m=e(M,b);n(h,d,f,p,_,y,h=m[0],d=m[1],f=M,p=O[0],_=O[1],y=O[2],RY,r),r.point(h,d)}function S(){v.point=w,r.lineEnd()}function A(){C(),v.point=D,v.lineEnd=P}function D(M,b){E(o=M,b),a=h,s=d,u=p,l=_,c=y,v.point=E}function P(){n(h,d,f,p,_,y,a,s,o,u,l,c,RY,r),v.lineEnd=S,S()}return v}}var kwe=Fj({point:function(e,t){this.stream.point(e*Os,t*Os)}});function Gwe(e){return Uwe(function(){return e})()}function Uwe(e){var t,n=150,r=480,o=250,a,s,u=0,l=0,c=0,f=0,h=0,d,p,_=null,y=LY,v=null,w,C,E,S=PY,A=.5,D=OY(m,A),P,M;function b(R){return R=p(R[0]*Os,R[1]*Os),[R[0]*n+a,s-R[1]*n]}function O(R){return R=p.invert((R[0]-a)/n,(s-R[1])/n),R&&[R[0]*Kf,R[1]*Kf]}function m(R,N){return R=t(R,N),[R[0]*n+a,s-R[1]*n]}b.stream=function(R){return P&&M===R?P:P=kwe(y(d,D(S(M=R))))},b.clipAngle=function(R){return arguments.length?(y=+R?Nwe(_=R*Os,6*Os):(_=null,LY),L()):_*Kf},b.clipExtent=function(R){return arguments.length?(S=R==null?(v=w=C=E=null,PY):bwe(v=+R[0][0],w=+R[0][1],C=+R[1][0],E=+R[1][1]),L()):v==null?null:[[v,w],[C,E]]},b.scale=function(R){return arguments.length?(n=+R,I()):n},b.translate=function(R){return arguments.length?(r=+R[0],o=+R[1],I()):[r,o]},b.center=function(R){return arguments.length?(u=R[0]%360*Os,l=R[1]%360*Os,I()):[u*Kf,l*Kf]},b.rotate=function(R){return arguments.length?(c=R[0]%360*Os,f=R[1]%360*Os,h=R.length>2?R[2]%360*Os:0,I()):[c*Kf,f*Kf,h*Kf]},b.precision=function(R){return arguments.length?(D=OY(m,A=R*R),L()):KP(A)},b.fitExtent=function(R,N){return zj(b,R,N)},b.fitSize=function(R,N){return Bwe(b,R,N)};function I(){p=Pj(d=Mj(c,f,h),t);var R=t(u,l);return a=r-R[0]*n,s=o+R[1]*n,L()}function L(){return P=M=null,b}return function(){return t=e.apply(this,arguments),b.invert=t.invert&&O,I()}}function Vj(e,t){return[e,Ij(Dj((wc+t)/2))]}Vj.invert=function(e,t){return[e,2*NB(bj(t))-wc]};function Hwe(e){var t=Gwe(e),n=t.center,r=t.scale,o=t.translate,a=t.clipExtent,s=null,u,l,c;t.scale=function(h){return arguments.length?(r(h),f()):r()},t.translate=function(h){return arguments.length?(o(h),f()):o()},t.center=function(h){return arguments.length?(n(h),f()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=u=l=c=null:(s=+h[0][0],u=+h[0][1],l=+h[1][0],c=+h[1][1]),f()):s==null?null:[[s,u],[l,c]]};function f(){var h=Ii*r(),d=t(wwe(t.rotate()).invert([0,0]));return a(s==null?[[d[0]-h,d[1]-h],[d[0]+h,d[1]+h]]:e===Vj?[[Math.max(d[0]-h,s),u],[Math.min(d[0]+h,l),c]]:[[s,Math.max(d[1]-h,u)],[l,Math.min(d[1]+h,c)]])}return f()}function kj(e,t){return[Ij(Dj((wc+t)/2)),-e]}kj.invert=function(e,t){return[-t,2*NB(bj(e))-wc]};var qwe=function(){var e=Hwe(kj),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)};function Wwe(e,t,n){n=n||{};var r=n.units,o=n.steps||64;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");o=o||64,r=r||"kilometers";var a=[];switch(e.type){case"GeometryCollection":return ch(e,function(s){var u=nP(s,t,r,o);u&&a.push(u)}),Vt(a);case"FeatureCollection":return fi(e,function(s){var u=nP(s,t,r,o);u&&fi(u,function(l){l&&a.push(l)})}),Vt(a)}return nP(e,t,r,o)}function nP(e,t,n,r){var o=e.properties||{},a=e.type==="Feature"?e.geometry:e;if(a.type==="GeometryCollection"){var s=[];return ch(e,function(v){var w=nP(v,t,n,r);w&&s.push(w)}),Vt(s)}var u,l=wa(e),c=l[1]>50&&l[3]>50;c?u={type:a.type,coordinates:Uj(a.coordinates,NY(a))}:u=x0(a);var f=new Ix,h=f.read(u),d=JC(fy(t,n),"meters"),p=hs.bufferOp(h,d),_=new tS;if(p=_.write(p),!Gj(p.coordinates)){var y;return c?y={type:p.type,coordinates:Hj(p.coordinates,NY(a))}:y=LP(p),y.geometry?y:aa(y,o)}}function Gj(e){return Array.isArray(e[0])?Gj(e[0]):isNaN(e[0])}function Uj(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return Uj(n,t)})}function Hj(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return Hj(n,t)})}function NY(e){var t=DP(e).geometry.coordinates.reverse(),n=t.map(function(r){return-r});return qwe().center(t).rotate(n).scale(ls)}function BB(){for(var e=new Ix,t=e.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)t=qT.union(t,e.read(JSON.stringify(arguments[n].geometry)));var r=new tS;return t=r.write(t),{type:"Feature",geometry:t,properties:arguments[0].properties}}function xx(e,t){var n=Hl(e),r=Hl(t);if(Wm(YC(r,{precision:4})).coordinates[0].length<4||Wm(YC(n,{precision:4})).coordinates[0].length<4)return null;var o=new Ix,a=o.read(YC(n)),s=o.read(YC(r)),u=jt.intersection(a,s);if(u.isEmpty())return null;var l=new tS,c=l.write(u);return aa(c)}/**
 * @license get-closest https://github.com/cosmosio/get-closest
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2017 Olivier Scherrer <pode.fr@gmail.com>
 */function Ywe(e,t,n){var r,o;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(a,s){var u=n(a,e);u>=0&&(typeof o>"u"||u<o)&&(o=u,r=s)}),r}function Xwe(e,t){return Ywe(e,t,function(n,r){return n-r})}function jwe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.propertyName;Sd(e,"Polygon","dissolve");var r=lu(e),o=r.features,a=[];o.forEach(function(f,h){f.properties.origIndexPosition=h});var s=jT();s.load(r);for(var u in o){var l=o[u],c=!1;if(s.search(l).features.forEach(function(f){l=o[u];var h=f.properties.origIndexPosition;if(a.length>0&&h!==0)if(h>a[a.length-1])h=h-a.length;else{var d=Xwe(h,a);d!==0&&(h=h-d)}if(h!==+u){var p=o[h];!p||!l||n!==void 0&&p.properties[n]!==l.properties[n]||!zX(l,p)||!Kwe(l,p)||(o[u]=BB(l,p),a.push(f.properties.origIndexPosition),a.sort(function(_,y){return _-y}),s.remove(f),o.splice(h,1),l.properties.origIndexPosition=u,s.remove(l,function(_,y){return _.properties.origIndexPosition===y.properties.origIndexPosition}),c=!0)}}),c){if(!l)continue;l.properties.origIndexPosition=u,s.insert(l),u--}}return o.forEach(function(f){delete f.properties.origIndexPosition,delete f.bbox}),r}function Kwe(e,t){var n=Ni(Ep(e)),r=Ni(Ep(t)),o=ng(n,r).features;return o.length>0}function qj(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties||{},o=n.triangles,a=n.mask;if(t==null)throw new Error("cellSide is required");if(!ci(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(a&&["Polygon","MultiPolygon"].indexOf(Bi(a))===-1)throw new Error("options.mask must be a (Multi)Polygon");var s=e[0],u=e[1],l=e[2],c=e[3],f=(u+c)/2,h=(s+l)/2,d=t*2/li([s,f],[l,f],n),p=d*(l-s),_=t*2/li([h,u],[h,c],n),y=_*(c-u),v=p/2,w=v*2,C=Math.sqrt(3)/2*y,E=l-s,S=c-u,A=3/4*w,D=C,P=(E-w)/(w-v/2),M=Math.floor(P),b=(M*A-v/2-E)/2-v/2+A/2,O=Math.floor((S-C)/C),m=(S-O*C)/2,I=O*C-S>C/2;I&&(m-=C/4);for(var L=[],R=[],N=0;N<6;N++){var B=2*Math.PI/6*N;L.push(Math.cos(B)),R.push(Math.sin(B))}for(var V=[],z=0;z<=M;z++)for(var U=0;U<=O;U++){var Q=z%2===1;if(!(U===0&&Q)&&!(U===0&&I)){var ne=z*A+s-b,se=U*D+u+m;if(Q&&(se-=C/2),o===!0)Qwe([ne,se],p/2,y/2,r,L,R).forEach(function(pe){a?xx(a,pe)&&V.push(pe):V.push(pe)});else{var de=Zwe([ne,se],p/2,y/2,r,L,R);a?xx(a,de)&&V.push(de):V.push(de)}}}return Vt(V)}function Zwe(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=e[0]+t*o[u],c=e[1]+n*a[u];s.push([l,c])}return s.push(s[0].slice()),Pn([s],r)}function Qwe(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=[];l.push(e),l.push([e[0]+t*o[u],e[1]+n*a[u]]),l.push([e[0]+t*o[(u+1)%6],e[1]+n*a[(u+1)%6]]),l.push(e),s.push(Pn([l],r))}return s}function Jwe(e,t){var n=tEe(t),r=eEe(e),o=r[0],a=r[1];o=BY(o),a=BY(a);var s=$we(n,o,a);return s}function $we(e,t,n){var r=[];return r.push(e.geometry.coordinates[0]),Ho(t,function(o){r.push(o.geometry.coordinates[0])}),Ho(n,function(o){r.push(o.geometry.coordinates[0])}),Pn(r)}function eEe(e){var t=[],n=[];return Ho(e,function(r){var o=r.geometry.coordinates,a=o[0],s=o.slice(1);t.push(Pn([a])),s.forEach(function(u){n.push(Pn([u]))})}),[Vt(t),Vt(n)]}function tEe(e){var t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],n=e&&e.geometry.coordinates||t;return Pn(n)}function BY(e){if(e.features.length<=1)return e;var t=nEe(e),n=[],r={};return Ho(e,function(o,a){if(r[a])return!0;for(t.remove({index:a},FY),r[a]=!0;;){var s=wa(o),u=t.search({minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]});if(u.length>0){var l=u.map(function(c){return r[c.index]=!0,t.remove({index:c.index},FY),c.geojson});l.push(o),o=BB.apply(this,l)}if(u.length===0)break}n.push(o)}),Vt(n)}function FY(e,t){return e.index===t.index}function nEe(e){var t=$C(),n=[];return Ho(e,function(r,o){var a=wa(r);n.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],geojson:r,index:o})}),t.load(n),t}function Wj(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!ci(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Bi(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/li([s,u],[l,u],n),h=f*(l-s),d=t/li([s,u],[s,c],n),p=d*(c-u),_=l-s,y=c-u,v=Math.floor(_/h),w=Math.floor(y/p),C=(_-v*h)/2,E=(y-w*p)/2,S=s+C,A=0;A<v;A++){for(var D=u+E,P=0;P<w;P++){var M=Pn([[[S,D],[S,D+p],[S+h,D+p],[S+h,D],[S,D]]],r);o?xx(o,M)&&a.push(M):a.push(M),D+=p}S+=h}return Vt(a)}function Yj(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!ci(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Bi(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=t/li([e[0],e[1]],[e[2],e[1]],n),u=s*(e[2]-e[0]),l=t/li([e[0],e[1]],[e[0],e[3]],n),c=l*(e[3]-e[1]),f=0,h=e[0];h<=e[2];){for(var d=0,p=e[1];p<=e[3];){var _=null,y=null;f%2===0&&d%2===0?(_=Pn([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=Pn([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)):f%2===0&&d%2===1?(_=Pn([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r),y=Pn([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r)):d%2===0&&f%2===1?(_=Pn([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r),y=Pn([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r)):d%2===1&&f%2===1&&(_=Pn([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=Pn([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)),o?(xx(o,_)&&a.push(_),xx(o,y)&&a.push(y)):(a.push(_),a.push(y)),p+=c,d++}f++,h+=u}return Vt(a)}function rEe(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.gridType,o=n.property,a=n.weight;if(!e)throw new Error("points is required");if(Sd(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(a!==void 0&&typeof a!="number")throw new Error("weight must be a number");o=o||"elevation",r=r||"square",a=a||1;var s=wa(e),u;switch(r){case"point":case"points":u=TX(s,t,n);break;case"square":case"squares":u=Wj(s,t,n);break;case"hex":case"hexes":u=qj(s,t,n);break;case"triangle":case"triangles":u=Yj(s,t,n);break;default:throw new Error("invalid gridType")}var l=[];return fi(u,function(c){var f=0,h=0;fi(e,function(p){var _=r==="point"?c:dy(c),y=li(_,p,n),v;if(o!==void 0&&(v=p.properties[o]),v===void 0&&(v=p.geometry.coordinates[2]),v===void 0)throw new Error("zValue is missing");y===0&&(f=v);var w=1/Math.pow(y,a);h+=w,f+=w*v});var d=lu(c);d.properties[o]=f/h,l.push(d)}),Vt(l)}var Xj={projection:qve,random:$1e,clusters:ewe,helpers:O_e,invariant:B_e,meta:N_e,isolines:q_e,convex:tX,pointsWithinPolygon:T3,concave:Jye,collect:eve,flip:tve,simplify:uve,bezierSpline:m7,tag:fve,sample:hve,envelope:lX,square:cX,circle:tB,midpoint:mve,center:DP,centerOfMass:fX,centroid:dy,combine:gve,distance:li,explode:nB,bbox:wa,tesselate:Lve,bboxPolygon:eB,booleanPointInPolygon:Co,nearestPoint:M3,nearestPointOnLine:Gm,nearestPointToLine:jve,planepoint:Zve,tin:nX,bearing:xp,destination:Tp,kinks:Qve,pointOnFeature:A7,area:bT,along:eCe,length:L3,lineSlice:tCe,lineSliceAlong:CX,pointGrid:TX,truncate:YC,flatten:hCe,lineIntersect:ng,lineChunk:dCe,unkinkPolygon:CCe,greatCircle:xCe,lineSegment:py,lineSplit:wCe,lineArc:bX,polygonToLine:sP,lineToPolygon:z7,bboxClip:SCe,lineOverlap:DX,sector:ICe,rhumbBearing:C0,rhumbDistance:MP,rhumbDestination:ex,polygonTangents:PCe,rewind:RCe,isobands:wxe,transformRotate:PX,transformScale:MX,transformTranslate:Pxe,lineOffset:Fxe,polygonize:Uxe,booleanDisjoint:RX,booleanContains:jxe,booleanCrosses:r1e,booleanClockwise:lP,booleanOverlap:zX,booleanPointOnLine:xc,booleanEqual:s1e,booleanWithin:xX,clone:lu,cleanCoords:Wm,clustersDbscan:f1e,clustersKmeans:v1e,pointToLineDistance:yX,booleanParallel:C1e,booleanIntersects:x1e,shortestPath:T1e,voronoi:Y1e,ellipse:YX,centerMean:_B,centerMedian:X1e,standardDeviationalEllipse:j1e,difference:vwe,buffer:Wwe,union:BB,intersect:xx,dissolve:jwe,hexGrid:qj,mask:Jwe,squareGrid:Wj,triangleGrid:Yj,interpolate:rEe,pointOnSurface:A7,polygonToLineString:sP,lineStringToPolygon:z7,inside:Co,within:T3,bezier:m7,nearest:M3,pointOnLine:Gm,lineDistance:L3,radians2degrees:T0,degrees2radians:Ya,distanceToDegrees:iP,distanceToRadians:fy,radiansToDistance:JC,bearingToAngle:v0,convertDistance:hy,toMercator:x0,toWgs84:LP,randomPosition:ZT,randomPoint:jX,randomPolygon:KX,randomLineString:ZX,getCluster:JX,clusterEach:yB,clusterReduce:$X,createBins:vB,applyFilter:BP,propertiesContainsFilter:CB,filterProperties:ej,earthRadius:ls,factors:EP,unitsFactors:zY,areaFactors:rP,feature:aa,geometry:VY,point:kr,points:kY,polygon:Pn,polygons:GY,lineString:Ni,lineStrings:UY,featureCollection:Vt,multiLineString:N0,multiPoint:TP,multiPolygon:wx,geometryCollection:q3,round:HY,radiansToLength:JC,lengthToRadians:fy,lengthToDegrees:iP,bearingToAzimuth:v0,radiansToDegrees:T0,degreesToRadians:Ya,convertLength:hy,convertArea:qY,isNumber:ci,isObject:gt,validateBBox:Ex,validateId:SP,getCoord:so,getCoords:Tt,containsNumber:bP,geojsonType:XY,featureOf:xT,collectionOf:Sd,getGeom:Hl,getGeomType:jY,getType:Bi,coordEach:Xa,coordReduce:AP,propEach:W3,propReduce:WY,featureEach:fi,featureReduce:Y3,coordAll:Ep,geomEach:ch,geomReduce:X3,flattenEach:Ho,flattenReduce:YY,segmentEach:km,segmentReduce:j3,lineEach:K3,lineReduce:Z3};function FB(e,t,n){this.viewer=e,this.handler=void 0,this.turf=T(t,Xj),this.curEntity="",this.stop=!0,this.selectType="",this.leftClickSelectEntity=new xe,this.selectEntityList=new Ga,this.entityList=n}FB.prototype.startAnalysis=function(e,t){this.stop=!1,this.selectType=T(t,"radio"),iEe(this),this.leftClickSelectEntity._listeners.length===0&&this.leftClickSelectEntity.addEventListener(e)};FB.prototype.stopAnalysis=function(e){this.stop=!0,this.leftClickSelectEntity._listeners.length!==0&&this.leftClickSelectEntity.removeEventListener(e),this.selectEntityList.removeAll()};function iEe(e){let t=e;t.handler===void 0&&(t.handler=new e0(t.viewer.scene.canvas)),t.handler.setInputAction(function(n){if(!t.stop){if(t.selectType==="radio"){let r=t.viewer.scene.pick(n.position);if(r!==void 0&&r.id instanceof us){r.id.id.split("_")[1]==="outline"&&(r.id.id=r.id.id.split("_")[0]),t.selectEntityList.set(r.id.id,{id:r.id.id,type:r.id.geometryType});let o=[];for(let a in t.selectEntityList._hash)t.selectEntityList._hash.hasOwnProperty(a)&&o.push(t.selectEntityList.get(a));t.leftClickSelectEntity.raiseEvent(o)}}else if(t.selectType==="checkbox"){let r=t.viewer.camera.pickEllipsoid(n.position,t.viewer.scene.globe.ellipsoid);if(r!==void 0){let o=[r];t.curEntity=t.viewer.entities.add({polygon:{arcType:Fa.RHUMB,material:K.RED.withAlpha(.6),hierarchy:new tu(function(){let a=[],s=o;if(s.length===2){let u=le.fromCartesian(s[0]),l=le.fromCartesian(s[1]),c=x.fromRadians(l.longitude,u.latitude),f=x.fromRadians(u.longitude,l.latitude);a=[s[0],c,s[1],f]}return{positions:a}},!1)},nodelist:o}),t.viewer.scene.screenSpaceCameraController.enableTranslate=!1,t.viewer.scene.screenSpaceCameraController.enableRotate=!1}}}},_n.LEFT_DOWN),t.handler.setInputAction(function(n){if(!t.stop&&t.selectType==="checkbox"){let r=t.viewer.camera.pickEllipsoid(n.endPosition,t.viewer.scene.globe.ellipsoid);t.curEntity!==""&&t.curEntity!==void 0&&r!==void 0&&(t.curEntity.nodelist[1]=r)}},_n.MOUSE_MOVE),t.handler.setInputAction(function(n){t.stop||(t.viewer.scene.screenSpaceCameraController.enableTranslate=!0,t.viewer.scene.screenSpaceCameraController.enableRotate=!0,t.curEntity instanceof us&&t.leftClickSelectEntity.raiseEvent(oEe(t.curEntity,t.entityList,t.turf)),t.selectType==="checkbox"&&(t.viewer.entities.remove(t.curEntity),t.curEntity=void 0))},_n.LEFT_UP)}function oEe(e,t,n){let r=[],o=e.polygon.hierarchy.getValue().positions;if(e.polygon.hierarchy.getValue().positions.length<4)return r;let a=ZP(o,"polygon"),s=n.polygon([a]);if(t instanceof Ga){for(let u in t._hash)if(t._hash.hasOwnProperty(u)){let l=t._hash[u][0];if(t._hash[u][0].geometryType==="polyline"){let c=l.polyline.positions.getValue(),f=ZP(c),h=n.lineString(f);(n.booleanContains(s,h)||n.booleanCrosses(s,h))&&r.push({id:l.id,type:"polyline"})}else if(t._hash[u][0].geometryType==="point"){let c=l.position.getValue(),f=ZP([c]),h=n.point(f[0]);n.booleanContains(s,h)&&r.push({id:l.id,type:"point"})}else{let c=l.polygon.hierarchy.getValue().positions,f=ZP(c,"polygon"),h=n.polygon([f]);(n.booleanContains(s,h)||!n.booleanDisjoint(s,h)||n.booleanContains(h,s))&&r.push({id:l.id,type:l.geometryType})}}}return r}function ZP(e,t){let n=[];return e.forEach(function(r){let o=le.fromCartesian(r);n.push([Math.toDegrees(o.longitude),Math.toDegrees(o.latitude)])}),t==="polygon"&&n.push(n[0]),n}var jj=FB;function Px(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._dynamic=Cesium.defaultValue(e.dynamic,!1),this._cylinderLength=Cesium.defaultValue(e.cylinderLength,1e3),this._topRadius=Cesium.defaultValue(e.topRadius,34),this._bottomRadius=Cesium.defaultValue(e.bottomRadius,.001),this._updateGeometryMesh=!0,this.instances=[],this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this.cylinderGeometry=void 0,this.geometryBuffer=void 0,this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1},this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(Px.prototype,{cylinderLength:{get:function(){return this._cylinderLength},set:function(e){this._updateGeometryMesh=this._cylinderLength!=e,this._cylinderLength=e}},topRadius:{get:function(){return this._topRadius},set:function(e){this._updateGeometryMesh=this._topRadius!=e,this._topRadius=e}},bottomRadius:{get:function(){return this._bottomRadius},set:function(e){this._updateGeometryMesh=this._bottomRadius!=e,this._bottomRadius=e}}});Px.prototype.recreateVertexArrays=function(e,t){this.instances=e||[],!(this.instances.length<1)&&(this.blUpdateVAO=!0)};Px.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!this.blUpdateVAO){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:cEe(),fragmentShaderSource:fEe()})),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this._updateGeometryMesh&&(this.cylinderGeometry=new Cesium.CylinderGeometry({length:this._cylinderLength,topRadius:this._topRadius,bottomRadius:this._bottomRadius,showTop:!1}),aEe(this),this._updateGeometryMesh=!1),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=sEe(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1}};Px.prototype.isDestroyed=function(){return!1};Px.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.defined(this.geometryBuffer)&&(delete this.geometryBuffer.indices,delete this.geometryBuffer.attributes.normal.values,delete this.geometryBuffer.attributes.position.values,delete this.geometryBuffer.attributes.st.values),Cesium.destroyObject(this)};function aEe(e){Cesium.defined(e.geometryBuffer)&&(delete e.geometryBuffer.indices,delete e.geometryBuffer.attributes.normal.values,delete e.geometryBuffer.attributes.position.values,delete e.geometryBuffer.attributes.st.values),e.geometryBuffer=void 0,e.geometryBuffer=Cesium.CylinderGeometry.createGeometry(e.cylinderGeometry)}function sEe(e,t){var n=lEe(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=16,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1},czm_modelColor:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*12,strideInBytes:a*o,instanceDivisor:1}},u=0,l=[],c=t.geometryBuffer.attributes.position,f=t.geometryBuffer.indices;return l.push({index:u++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(c.values.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),s.czm_modelMatrixRow0.index=u++,l.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=u++,l.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=u++,l.push(s.czm_modelMatrixRow2),s.czm_modelColor.index=u++,l.push(s.czm_modelColor),new Cesium.VertexArray({context:e,attributes:l,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:new Uint16Array(f.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var uEe=new G;function lEe(e){var t=e.instances,n=t.length,r=16,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(n*r)),e._dynamic&&(e._vertexBufferTypedArray=o);for(var a=[],s=0;s<n;++s){var u=t[s].modelMatrix;a.push(new Cesium.Cartesian3(u[12],u[13],u[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(a);for(var s=0;s<n;++s){var u=t[s].modelMatrix,l=t[s].color,c=Cesium.Matrix4.clone(u,uEe);c[12]=c[12]-e.boundingSphere.center.x,c[13]=c[13]-e.boundingSphere.center.y,c[14]=c[14]-e.boundingSphere.center.z;var f=s*r;o[f+0]=c[0],o[f+1]=c[4],o[f+2]=c[8],o[f+3]=c[12],o[f+4]=c[1],o[f+5]=c[5],o[f+6]=c[9],o[f+7]=c[13],o[f+8]=c[2],o[f+9]=c[6],o[f+10]=c[10],o[f+11]=c[14],o[f+12]=l.red,o[f+13]=l.green,o[f+14]=l.blue,o[f+15]=l.alpha}return o}function cEe(){var e=`precision highp float;
attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = color; 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function fEe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var QP=Px;function Ly(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.blUpdateVAO=!1,this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this._startYaw=Cesium.defaultValue(e.startYaw,-30),this._yawSpan=Cesium.defaultValue(e.yawSpan,60),this._startPitch=Cesium.defaultValue(e.startPitch,-20),this._pitchSpan=Cesium.defaultValue(e.pitchSpan,40),this._radius=Cesium.defaultValue(e.radius,30),this._forwardDis=Cesium.defaultValue(e.forwardDis,15),this.color=Cesium.defaultValue(e.color,new Cesium.Color(99/255,164/255,164/255,.6)),this._heading=Cesium.defaultValue(e.heading,0),this._pitch=Cesium.defaultValue(e.pitch,0),this._roll=Cesium.defaultValue(e.roll,0),this._center=new Cesium.Cartesian3,this.instances=[],this._dynamic=Cesium.defaultValue(e.dynamic,!1),this._updateGeometryMesh=!1,this.openSectorPyramid=Cesium.defaultValue(e.openSectorPyramid,!1),this.geometryMesh=Kj(this),this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1};var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(Ly.prototype,{forwardDis:{get:function(){return this._forwardDis},set:function(e){this._updateGeometryMesh=this._forwardDis!=e,this._forwardDis=e}},startYaw:{get:function(){return this._startYaw},set:function(e){this._updateGeometryMesh=this._startYaw!=e,this._startYaw=e}},yawSpan:{get:function(){return this._yawSpan},set:function(e){this._updateGeometryMesh=this._yawSpan!=e,this._yawSpan=e}},startPitch:{get:function(){return this._startPitch},set:function(e){this._updateGeometryMesh=this._startPitch!=e,this._startPitch=e}},pitchSpan:{get:function(){return this._pitchSpan},set:function(e){this._updateGeometryMesh=this._pitchSpan!=e,this._pitchSpan=e}},radius:{get:function(){return this._radius},set:function(e){this._updateGeometryMesh=this._radius!=e,this._radius=e}},heading:{get:function(){return this._heading},set:function(e){this._updateGeometryMesh=this._heading!=e,this._heading=e}},pitch:{get:function(){return this._pitch},set:function(e){this._updateGeometryMesh=this._pitch!=e,this._pitch=e}},roll:{get:function(){return this._roll},set:function(e){this._updateGeometryMesh=this._roll!=e,this._roll=e}}});Ly.prototype.resetRadarInstances=function(e){this.instances=e,this.blUpdateVAO=!0};var hEe=new G;Ly.prototype.resetRadarByPositionProperty=function(e){this.instances=[];for(var t=0;t<e.length;t++){var n=e[t].position,r=this.transformFunc(n,void 0,hEe),o=Cesium.Quaternion.fromHeadingPitchRoll(e[t].headingPitchRoll,new Cesium.Quaternion),a=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),o,e[t].scale);r=Cesium.Matrix4.multiply(r,a,new Cesium.Matrix4),Cesium.defined(r)&&this.instances.push({modelMatrix:r,color:e[t].color})}this.blUpdateVAO=!0};Ly.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.geometryMesh)){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:gEe(),fragmentShaderSource:_Ee()})),this._updateGeometryMesh&&(Cesium.defined(this.geometryMesh)&&(Cesium.defined(this.geometryMesh.position)&&delete this.geometryMesh.position,Cesium.defined(this.geometryMesh.surfaceTag)&&delete this.geometryMesh.surfaceTag,Cesium.defined(this.geometryMesh.indices)&&delete this.geometryMesh.indices),this.geometryMesh=Kj(this),this._updateGeometryMesh=!1,this.blUpdateVAO=!0),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&this.blUpdateVAO&&n.vertexArray.destroy(),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=dEe(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1}};function dEe(e,t){var n=mEe(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=16,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1},czm_modelColor:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*12,strideInBytes:a*o,instanceDivisor:1}},u=t.geometryMesh,l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(u.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(u.surfaceTag.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:1,normalize:!1}),s.czm_modelMatrixRow0.index=l++,c.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=l++,c.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=l++,c.push(s.czm_modelMatrixRow2),s.czm_modelColor.index=l++,c.push(s.czm_modelColor),new Cesium.VertexArray({context:e,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:new Uint16Array(u.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var pEe=new G;function mEe(e){var t=e.instances,n=t.length,r=e._center,o=16,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix;s.push(new Cesium.Cartesian3(l[12],l[13],l[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(s);for(var u=0;u<n;++u){var l=t[u].modelMatrix,c=t[u].color,f=Cesium.Matrix4.clone(l,pEe);f[12]=f[12]-e.boundingSphere.center.x-r.x,f[13]=f[13]-e.boundingSphere.center.y-r.y,f[14]=f[14]-e.boundingSphere.center.z-r.z;var h=u*o;a[h+0]=f[0],a[h+1]=f[4],a[h+2]=f[8],a[h+3]=f[12],a[h+4]=f[1],a[h+5]=f[5],a[h+6]=f[9],a[h+7]=f[13],a[h+8]=f[2],a[h+9]=f[6],a[h+10]=f[10],a[h+11]=f[14],a[h+12]=c.red,a[h+13]=c.green,a[h+14]=c.blue,a[h+15]=c.alpha}return a}function gEe(){var e=`precision highp float;
attribute vec3 position;
attribute float surfaceTag; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = color; 
    if(surfaceTag<0.5){ 
    v_colour.a = 0.0; 
     } 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function _Ee(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}function Kj(e){var t=5,n=5,r=e._forwardDis,o=e.color,a=e.radius,s=e.startYaw,u=e.yawSpan/t+1,l=e.startPitch,c=e.pitchSpan/n+1,f=u*c;f++;var h=(u-1)*2+(c-1)*2+(u-1)*(c-1)*2;h*=3;for(var d=Cesium.IndexDatatype.createTypedArray(f,h),p=new Float64Array(f*3),_=new Float64Array(f),y=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(e._heading,e._pitch,e._roll),new Cesium.Quaternion),v=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(r,0,0),y,new Cesium.Cartesian3(1,1,1)),w=new Cesium.Cartesian3,C=0,E=0,S=0;S<u;S++){var A=s+S*t;A=-A;for(var D=0;D<c;D++){var P=l+D*n;if(P=-P,e.openSectorPyramid)var M=a*Math.tan(P*Math.PI/180),b=a,O=b,m=b*Math.tan(A*Math.PI/180);else var M=a*Math.sin(P*Math.PI/180),b=a*Math.cos(P*Math.PI/180),O=b*Math.cos(A*Math.PI/180),m=b*Math.sin(A*Math.PI/180);w.x=O+r,w.y=m,w.z=M,w=Cesium.Matrix4.multiplyByPoint(v,w,w),p[C++]=w.x,p[C++]=w.y,p[C++]=w.z,_[E++]=1}}p[C++]=r,p[C++]=0,p[C++]=0,_[E++]=0;for(var I=0,S=0;S<u-1;S++)for(var D=0;D<c-1;D++)d[I++]=S*c+D,d[I++]=(S+1)*c+D,d[I++]=(S+1)*c+D+1,d[I++]=S*c+D,d[I++]=(S+1)*c+D+1,d[I++]=S*c+D+1;for(var S=0;S<u-1;S++)d[I++]=S*c,d[I++]=f-1,d[I++]=(S+1)*c,d[I++]=(S+1)*c+(c-1),d[I++]=S*c+(c-1),d[I++]=f-1;for(var D=0;D<c-1;D++)d[I++]=D,d[I++]=D+1,d[I++]=f-1,d[I++]=(u-1)*c+D,d[I++]=f-1,d[I++]=(u-1)*c+D+1;return{position:p,surfaceTag:_,indices:d}}Ly.prototype.isDestroyed=function(){return!1};Ly.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.defined(this.geometryMesh)&&(Cesium.defined(this.geometryMesh.position)&&delete this.geometryMesh.position,Cesium.defined(this.geometryMesh.surfaceTag)&&delete this.geometryMesh.surfaceTag,Cesium.defined(this.geometryMesh.indices)&&delete this.geometryMesh.indices),Cesium.destroyObject(this)};var Mx=Ly;function Lx(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.scene=e.scene,this.geometry=void 0,this.blUpdateVAO=!1,this.boundingSphere=void 0,this.pullWireMesh=void 0,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDistanceDisplayCondition=!1,this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!1),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1},this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(Lx.prototype,{depthTestState:{get:function(){return this._renderState.depthTest.enabled},set:function(e){this._renderState.depthTest.enabled=e,this._command&&(this._command.renderState=Cesium.RenderState.fromCache(this._renderState))}}});var zB=new ti;Lx.prototype.resizeLabelInfos=function(e){var t=e.length,n=0,r=Number.MAX_VALUE;if(this.pullWireMesh=void 0,e instanceof Array&&t>0){for(var o=t*2,a=t*2,s=Cesium.IndexDatatype.createTypedArray(o,a),u=0;u<a;u++)s[u]=u;for(var l=new Cesium.BoundingSphere(e[0].position,200),c=new Float64Array(o*3),f=new Float64Array(o*3),h=new Float64Array(o*2),d=new Float32Array(o*2),p=new Float32Array(o*3),_=new Float32Array(o*3),y=new Uint8Array(o*4),v=0;v<e.length;v++){var w=e[v].distanceDisplayCondition;Cesium.defined(w)&&(n=w.near,r=w.far,n*=n,r*=r,this._shaderDistanceDisplayCondition=!0);var C=e[v].position,E=e[v].imageSize,S=e[v].pixelOffset,A=e[v].origin,D=e[v].scale;l=Cesium.BoundingSphere.expand(l,C),Cesium.EncodedCartesian3.fromCartesian(C,zB);var P=zB.high,M=zB.low;c[v*6]=P.x,c[v*6+1]=P.y,c[v*6+2]=P.z,c[v*6+3]=P.x,c[v*6+4]=P.y,c[v*6+5]=P.z,f[v*6]=M.x,f[v*6+1]=M.y,f[v*6+2]=M.z,f[v*6+3]=M.x,f[v*6+4]=M.y,f[v*6+5]=M.z,h[v*4]=n,h[v*4+1]=r,h[v*4+2]=n,h[v*4+3]=r,d[v*4]=0,d[v*4+1]=0,d[v*4+2]=1,d[v*4+3]=D,p[v*6]=0,p[v*6+1]=0,p[v*6+2]=0,p[v*6+3]=S.x,p[v*6+4]=S.y,p[v*6+5]=E.x,_[v*6]=0,_[v*6+1]=0,_[v*6+2]=0,_[v*6+3]=A.x,_[v*6+4]=A.y,_[v*6+5]=E.y,y[v*8]=Cesium.Color.floatToByte(e[v].color.red),y[v*8+1]=Cesium.Color.floatToByte(e[v].color.green),y[v*8+2]=Cesium.Color.floatToByte(e[v].color.blue),y[v*8+3]=Cesium.Color.floatToByte(e[v].color.alpha),y[v*8+4]=Cesium.Color.floatToByte(e[v].color.red),y[v*8+5]=Cesium.Color.floatToByte(e[v].color.green),y[v*8+6]=Cesium.Color.floatToByte(e[v].color.blue),y[v*8+7]=Cesium.Color.floatToByte(e[v].color.alpha)}this.pullWireMesh={position3DHigh:c,position3DLow:f,disCondition:h,st:d,tangent:p,bitangent:_,color:y,indices:s},this.boundingSphere=l.clone(),this.blUpdateVAO=!0}};Lx.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&this.pullWireMesh){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.tangent),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.bitangent),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.pullWireMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.disCondition),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.pullWireMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:yEe(),fragmentShaderSource:vEe()})),this._shaderDistanceDisplayCondition!=this._compiledShaderDistanceDisplayCondition&&(n.shaderProgram.vertexShaderSource.defines.push("DISTANCE_DISPLAY_CONDITION"),this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition)}if(Cesium.defined(n.vertexArray)){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};Lx.prototype.isDestroyed=function(){return!1};Lx.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function yEe(){return`attribute vec3 position3DHigh;
  attribute vec3 position3DLow;
  attribute vec2 uv;
  attribute vec3 tangent;
  attribute vec3 bitangent;
  attribute vec4 color;
  attribute vec2 disCondition;
  varying vec4  v_colour;
  vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
  {
  vec2 halfSize = imageSize * scale * 0.5;
  halfSize *= ((direction * 2.0) - 1.0);
  vec2 originTranslate = origin * abs(halfSize);
  #if defined(ROTATION) || defined(ALIGNED_AXIS)
  if (validAlignedAxis || rotation != 0.0)
  {
  float angle = rotation;
  if (validAlignedAxis)
  {
  vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);
  angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
  (projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
  }
  float cosTheta = cos(angle);
  float sinTheta = sin(angle);
  rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
  halfSize = rotationMatrix * halfSize;
  }
  else
  {
  rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
  }
  #endif
  mpp = czm_metersPerPixel(positionEC);
  positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
  positionEC.xy += (translate + pixelOffset) * mpp;
  return positionEC;
  }
  void main(){
  vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);
  vec4 positionEC = czm_modelViewRelativeToEye * p;
  if(uv.x > 0.5){
  float scale = uv.y;
  vec2 pixelOffset = vec2(tangent.x, -tangent.y);
  vec2 imageSize = vec2(tangent.z, bitangent.z);
  vec2 origin = vec2(bitangent.x, bitangent.y);
  vec2 direction = vec2(0.0, 1.0);
  if((pixelOffset.x+ 0.5*imageSize.x) >=0.0 && (pixelOffset.y- 0.5*imageSize.y)>0.0){
  pixelOffset = vec2(pixelOffset.x, pixelOffset.y-imageSize.y);
  }else if((pixelOffset.x+ 0.5*imageSize.x) <0.0 && (pixelOffset.y- 0.5*imageSize.y)<0.0){
  pixelOffset = vec2(pixelOffset.x+imageSize.x , pixelOffset.y);
  }else if((pixelOffset.x+ 0.5*imageSize.x) <0.0 && (pixelOffset.y- 0.5*imageSize.y)>0.0){
  pixelOffset = vec2(pixelOffset.x+imageSize.x , pixelOffset.y-imageSize.y);
  }
  vec2 translate = vec2(0.0, 0.0);
  vec3 alignedAxis = vec3(0.0);
  bool validAlignedAxis = false;
  float rotation = 0.0;
  bool sizeInMeters = false;
  mat2 rotationMatrix;
  float mpp;
  positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
  }
  #if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
  float lengthSq;
  if (czm_sceneMode == czm_sceneMode2D)
  {
  lengthSq = czm_eyeHeight2D.y;
  }
  else
  {
  lengthSq = dot(positionEC.xyz, positionEC.xyz);
  }
  #endif
  #ifdef DISTANCE_DISPLAY_CONDITION
  float nearSq = disCondition.x;
  float farSq = disCondition.y;
  if (lengthSq < nearSq || lengthSq > farSq)
  {
  positionEC.xyz = vec3(0.0);
  }
  #endif
  v_colour = vec4(color.r, color.g, color.b, color.a);
  gl_Position = czm_projection * positionEC;
  #ifdef LOG_DEPTH
  czm_vertexLogDepth();
  #endif
  }
  `}function vEe(){return`varying vec4  v_colour;
  void main(){
  gl_FragColor = v_colour;
  }
  `}var JP=Lx;function CEe(e){var t;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))t=Bo().resolve(e);else{var n=vt.createIfNeeded(e);t=n.fetchArrayBuffer()}if(!!g(t))return t.then(function(r){if(g(r))return wEe(r)})}var Zj=[171,75,84,88,32,49,49,187,13,10,26,10],xEe=67305985,Qj=["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"],Mc=4;function wEe(e){var t=new Uint8Array(e),n=!0,r;for(r=0;r<Zj.length;++r)if(Zj[r]!==t[r]){n=!1;break}if(!n)throw new at("Invalid KTX file.");var o,a;g(e.buffer)?(o=new DataView(e.buffer),a=e.byteOffset):(o=new DataView(e),a=0),a+=12;var s=o.getUint32(a,!0);if(a+=Mc,s!==xEe)throw new at("File is the wrong endianness.");var u=o.getUint32(a,!0);a+=Mc;var l=o.getUint32(a,!0);a+=Mc;var c=o.getUint32(a,!0);a+=Mc;var f=o.getUint32(a,!0);a+=Mc;var h=o.getUint32(a,!0);a+=Mc;var d=o.getUint32(a,!0);a+=Mc;var p=o.getUint32(a,!0);a+=Mc;var _=o.getUint32(a,!0);a+=Mc;var y=o.getUint32(a,!0);a+=Mc;var v=o.getUint32(a,!0);a+=Mc;var w=o.getUint32(a,!0);a+=Mc;var C=o.getUint32(a,!0);a+=Mc,a+=C;var E=o.getUint32(a,!0);a+=Mc;var S;if(g(e.buffer)?S=new Uint8Array(e.buffer,a,E):S=new Uint8Array(e,a,E),f===k.RGB8?f=qt.RGB:f===k.RGBA8&&(f=qt.RGBA),!qt.validate(f))throw new at("glInternalFormat is not a valid format.");if(qt.isCompressedFormat(f)){if(u!==0)throw new at("glType must be zero when the texture is compressed.");if(l!==1)throw new at("The type size for compressed textures must be 1.");if(c!==0)throw new at("glFormat must be zero when the texture is compressed.")}else{if(u!==k.UNSIGNED_BYTE)throw new at("Only unsigned byte buffers are supported.");if(h!==c)throw new at("The base internal format must be the same as the format for uncompressed textures.")}if(_!==0)throw new at("3D textures are unsupported.");if(y!==0)throw new at("Texture arrays are unsupported.");var A=S.byteOffset,D=new Array(w);for(r=0;r<w;++r){for(var P=D[r]={},M=0;M<v;++M){var b=d>>r,O=p>>r;b<1&&(b=1),O<1&&(O=1);var m=qt.isCompressedFormat(f)?qt.compressedTextureSizeInBytes(f,b,O):qt.textureSizeInBytes(f,u,b,O),I=new Uint8Array(S.buffer,A,m);P[Qj[M]]=new ZI(f,xt.UNSIGNED_BYTE,b,O,I),A+=m}g(e.buffer)?A+=4:A+=3-(A+3)%4+4}var L=D;if(v===1)for(r=0;r<w;++r)L[r]=L[r][Qj[0]];return w===1&&(L=L[0]),L}var $P=CEe;var EEe={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},mf=Object.freeze(EEe);var TEe={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},pu=Object.freeze(TEe);function VB(e){e=T(e,T.EMPTY_OBJECT);let t=e.currentTime,n=e.startTime,r=e.stopTime;g(t)?t=ce.clone(t):g(n)?t=ce.clone(n):g(r)?t=ce.addDays(r,-1,new ce):t=ce.now(),g(n)?n=ce.clone(n):n=ce.clone(t),g(r)?r=ce.clone(r):r=ce.addDays(n,1,new ce),this.startTime=n,this.stopTime=r,this.clockRange=T(e.clockRange,mf.UNBOUNDED),this.canAnimate=T(e.canAnimate,!0),this.onTick=new xe,this.onStop=new xe,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=xC(),this.currentTime=t,this.multiplier=T(e.multiplier,1),this.shouldAnimate=T(e.shouldAnimate,!1),this.clockStep=T(e.clockStep,pu.SYSTEM_CLOCK_MULTIPLIER)}Object.defineProperties(VB.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){ce.equals(this._currentTime,e)||(this._clockStep===pu.SYSTEM_CLOCK&&(this._clockStep=pu.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===pu.SYSTEM_CLOCK&&(this._clockStep=pu.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===pu.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=ce.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===pu.SYSTEM_CLOCK&&(this._clockStep=pu.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}});VB.prototype.tick=function(){let e=xC(),t=ce.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){let n=this._clockStep;if(n===pu.SYSTEM_CLOCK)t=ce.now(t);else{let r=this._multiplier;if(n===pu.TICK_DEPENDENT)t=ce.addSeconds(t,r,t);else{let u=e-this._lastSystemTime;t=ce.addSeconds(t,r*(u/1e3),t)}let o=this.clockRange,a=this.startTime,s=this.stopTime;if(o===mf.CLAMPED)ce.lessThan(t,a)?t=ce.clone(a,t):ce.greaterThan(t,s)&&(t=ce.clone(s,t),this.onStop.raiseEvent(this));else if(o===mf.LOOP_STOP)for(ce.lessThan(t,a)&&(t=ce.clone(a,t));ce.greaterThan(t,s);)t=ce.addSeconds(a,ce.secondsDifference(t,s),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};var Rx=VB;function gl(e,t,n){this.clock=T(e,0),this.cone=T(t,0),this.magnitude=T(n,1)}gl.fromCartesian3=function(e,t){let n=e.x,r=e.y,o=e.z,a=n*n+r*r;return g(t)||(t=new gl),t.clock=Math.atan2(r,n),t.cone=Math.atan2(Math.sqrt(a),o),t.magnitude=Math.sqrt(a+o*o),t};gl.clone=function(e,t){if(!!g(e))return g(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new gl(e.clock,e.cone,e.magnitude)};gl.normalize=function(e,t){return g(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new gl(e.clock,e.cone,1)};gl.equals=function(e,t){return e===t||g(e)&&g(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude};gl.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||g(e)&&g(t)&&Math.abs(e.clock-t.clock)<=n&&Math.abs(e.cone-t.cone)<=n&&Math.abs(e.magnitude-t.magnitude)<=n};gl.prototype.equals=function(e){return gl.equals(this,e)};gl.prototype.clone=function(e){return gl.clone(this,e)};gl.prototype.equalsEpsilon=function(e,t){return gl.equalsEpsilon(this,e,t)};gl.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};var Jj=gl;function Lo(e){e=T(e,T.EMPTY_OBJECT),this.start=g(e.start)?ce.clone(e.start):new ce,this.stop=g(e.stop)?ce.clone(e.stop):new ce,this.data=e.data,this.isStartIncluded=T(e.isStartIncluded,!0),this.isStopIncluded=T(e.isStopIncluded,!0)}Object.defineProperties(Lo.prototype,{isEmpty:{get:function(){let e=ce.compare(this.stop,this.start);return e<0||e===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var Ox={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};Lo.fromIso8601=function(e,t){let n=e.iso8601.split("/");if(n.length!==2)throw new Le("options.iso8601 is an invalid ISO 8601 interval.");let r=ce.fromIso8601(n[0]),o=ce.fromIso8601(n[1]),a=T(e.isStartIncluded,!0),s=T(e.isStopIncluded,!0),u=e.data;return g(t)?(t.start=r,t.stop=o,t.isStartIncluded=a,t.isStopIncluded=s,t.data=u,t):(Ox.start=r,Ox.stop=o,Ox.isStartIncluded=a,Ox.isStopIncluded=s,Ox.data=u,new Lo(Ox))};Lo.toIso8601=function(e,t){return`${ce.toIso8601(e.start,t)}/${ce.toIso8601(e.stop,t)}`};Lo.clone=function(e,t){if(!!g(e))return g(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new Lo(e)};Lo.equals=function(e,t,n){return e===t||g(e)&&g(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&ce.equals(e.start,t.start)&&ce.equals(e.stop,t.stop)&&(e.data===t.data||g(n)&&n(e.data,t.data)))};Lo.equalsEpsilon=function(e,t,n,r){return n=T(n,0),e===t||g(e)&&g(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&ce.equalsEpsilon(e.start,t.start,n)&&ce.equalsEpsilon(e.stop,t.stop,n)&&(e.data===t.data||g(r)&&r(e.data,t.data)))};Lo.intersect=function(e,t,n,r){if(!g(t))return Lo.clone(Lo.EMPTY,n);let o=e.start,a=e.stop,s=t.start,u=t.stop,l=ce.greaterThanOrEquals(s,o)&&ce.greaterThanOrEquals(a,s),c=!l&&ce.lessThanOrEquals(s,o)&&ce.lessThanOrEquals(o,u);if(!l&&!c)return Lo.clone(Lo.EMPTY,n);let f=e.isStartIncluded,h=e.isStopIncluded,d=t.isStartIncluded,p=t.isStopIncluded,_=ce.lessThan(a,u);return g(n)||(n=new Lo),n.start=l?s:o,n.isStartIncluded=f&&d||!ce.equals(s,o)&&(l&&d||c&&f),n.stop=_?a:u,n.isStopIncluded=_?h:h&&p||!ce.equals(u,a)&&p,n.data=g(r)?r(e.data,t.data):e.data,n};Lo.contains=function(e,t){if(e.isEmpty)return!1;let n=ce.compare(e.start,t);if(n===0)return e.isStartIncluded;let r=ce.compare(t,e.stop);return r===0?e.isStopIncluded:n<0&&r<0};Lo.prototype.clone=function(e){return Lo.clone(this,e)};Lo.prototype.equals=function(e,t){return Lo.equals(this,e,t)};Lo.prototype.equalsEpsilon=function(e,t,n){return Lo.equalsEpsilon(this,e,t,n)};Lo.prototype.toString=function(){return Lo.toIso8601(this)};Lo.EMPTY=Object.freeze(new Lo({start:new ce,stop:new ce,isStartIncluded:!1,isStopIncluded:!1}));var ii=Lo;var SEe=F.factorial;function kB(e,t,n,r,o,a){let s=0,u,l,c;if(r>0){for(l=0;l<o;l++){for(u=!1,c=0;c<a.length&&!u;c++)l===a[c]&&(u=!0);u||(a.push(l),s+=kB(e,t,n,r-1,o,a),a.splice(a.length-1,1))}return s}for(s=1,l=0;l<o;l++){for(u=!1,c=0;c<a.length&&!u;c++)l===a[c]&&(u=!0);u||(s*=e-n[t[l]])}return s}var eM={type:"Hermite"};eM.getRequiredDataPoints=function(e,t){return t=T(t,0),Math.max(Math.floor((e+1)/(t+1)),2)};eM.interpolateOrderZero=function(e,t,n,r,o){g(o)||(o=new Array(r));let a,s,u,l,c,f,h=t.length,d=new Array(r);for(a=0;a<r;a++){o[a]=0;let v=new Array(h);for(d[a]=v,s=0;s<h;s++)v[s]=[]}let p=h,_=new Array(p);for(a=0;a<p;a++)_[a]=a;let y=h-1;for(l=0;l<r;l++){for(s=0;s<p;s++)f=_[s]*r+l,d[l][0].push(n[f]);for(a=1;a<p;a++){let v=!1;for(s=0;s<p-a;s++){let w=t[_[s]],C=t[_[s+a]],E;C-w<=0?(f=_[s]*r+r*a+l,E=n[f],d[l][a].push(E/SEe(a))):(E=d[l][a-1][s+1]-d[l][a-1][s],d[l][a].push(E/(C-w))),v=v||E!==0}v||(y=a-1)}}for(u=0,c=0;u<=c;u++)for(a=u;a<=y;a++){let v=kB(e,_,t,u,a,[]);for(l=0;l<r;l++){let w=d[l][a][0];o[l+u*r]+=w*v}}return o};var AEe=[];eM.interpolate=function(e,t,n,r,o,a,s){let u=r*(a+1);g(s)||(s=new Array(u));for(let w=0;w<u;w++)s[w]=0;let l=t.length,c=new Array(l*(o+1)),f;for(f=0;f<l;f++)for(let w=0;w<o+1;w++)c[f*(o+1)+w]=f;let h=c.length,d=AEe,p=bEe(d,c,t,n,r,o),_=[],y=h*(h+1)/2,v=Math.min(p,a);for(let w=0;w<=v;w++)for(f=w;f<=p;f++){_.length=0;let C=kB(e,c,t,w,f,_),E=Math.floor(f*(1-f)/2)+h*f;for(let S=0;S<r;S++){let A=Math.floor(S*y),D=d[A+E];s[S+w*r]+=D*C}}return s};function bEe(e,t,n,r,o,a){let s,u,l=-1,c=t.length,f=c*(c+1)/2;for(let h=0;h<o;h++){let d=Math.floor(h*f);for(s=0;s<c;s++)u=t[s]*o*(a+1)+h,e[d+s]=r[u];for(let p=1;p<c;p++){let _=0,y=Math.floor(p*(1-p)/2)+c*p,v=!1;for(s=0;s<c-p;s++){let w=n[t[s]],C=n[t[s+p]],E,S;if(C-w<=0)u=t[s]*o*(a+1)+o*p+h,E=r[u],S=E/F.factorial(p),e[d+y+_]=S,_++;else{let A=Math.floor((p-1)*(2-p)/2)+c*(p-1);E=e[d+A+s+1]-e[d+A+s],S=E/(C-w),e[d+y+_]=S,_++}v=v||E!==0}v&&(l=Math.max(l,p))}}return l}var $j=eM;var GB={type:"Lagrange"};GB.getRequiredDataPoints=function(e){return Math.max(e+1,2)};GB.interpolateOrderZero=function(e,t,n,r,o){g(o)||(o=new Array(r));let a,s,u=t.length;for(a=0;a<r;a++)o[a]=0;for(a=0;a<u;a++){let l=1;for(s=0;s<u;s++)if(s!==a){let c=t[a]-t[s];l*=(e-t[s])/c}for(s=0;s<r;s++)o[s]+=l*n[a*r+s]}return o};var eK=GB;var UB={type:"Linear"};UB.getRequiredDataPoints=function(e){return 2};UB.interpolateOrderZero=function(e,t,n,r,o){g(o)||(o=new Array(r));let a,s,u,l=t[0],c=t[1];for(a=0;a<r;a++)s=n[a],u=n[a+r],o[a]=((u-s)*e+c*s-l*u)/(c-l);return o};var tM=UB;var IEe={ROUNDED:0,MITERED:1,BEVELED:2,EV_ARC:3},Di=Object.freeze(IEe);var DEe={NONE:0,HOLD:1,EXTRAPOLATE:2},Np=Object.freeze(DEe);var tK=Object.freeze(ce.fromIso8601("0000-01-01T00:00:00Z")),nK=Object.freeze(ce.fromIso8601("9999-12-31T24:00:00Z")),PEe=Object.freeze(new ii({start:tK,stop:nK})),MEe={MINIMUM_VALUE:tK,MAXIMUM_VALUE:nK,MAXIMUM_INTERVAL:PEe},ys=MEe;function WB(e,t){return ce.compare(e.start,t.start)}function Ta(e){if(this._intervals=[],this._changedEvent=new xe,g(e)){let t=e.length;for(let n=0;n<t;n++)this.addInterval(e[n])}}Object.defineProperties(Ta.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){let e=this._intervals;return e.length===0?void 0:e[0].start}},isStartIncluded:{get:function(){let e=this._intervals;return e.length===0?!1:e[0].isStartIncluded}},stop:{get:function(){let e=this._intervals,t=e.length;return t===0?void 0:e[t-1].stop}},isStopIncluded:{get:function(){let e=this._intervals,t=e.length;return t===0?!1:e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});Ta.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof Ta))return!1;let n=this._intervals,r=e._intervals,o=n.length;if(o!==r.length)return!1;for(let a=0;a<o;a++)if(!ii.equals(n[a],r[a],t))return!1;return!0};Ta.prototype.get=function(e){return this._intervals[e]};Ta.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))};Ta.prototype.findIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t]:void 0};Ta.prototype.findDataForIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0};Ta.prototype.contains=function(e){return this.indexOf(e)>=0};var HB=new ii;Ta.prototype.indexOf=function(e){let t=this._intervals;HB.start=e,HB.stop=e;let n=Lu(t,HB,WB);return n>=0?t[n].isStartIncluded?n:n>0&&t[n-1].stop.equals(e)&&t[n-1].isStopIncluded?n-1:~n:(n=~n,n>0&&n-1<t.length&&ii.contains(t[n-1],e)?n-1:~n)};Ta.prototype.findInterval=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.start,n=e.stop,r=e.isStartIncluded,o=e.isStopIncluded,a=this._intervals;for(let s=0,u=a.length;s<u;s++){let l=a[s];if((!g(t)||l.start.equals(t))&&(!g(n)||l.stop.equals(n))&&(!g(r)||l.isStartIncluded===r)&&(!g(o)||l.isStopIncluded===o))return a[s]}};Ta.prototype.addInterval=function(e,t){if(e.isEmpty)return;let n=this._intervals;if(n.length===0||ce.greaterThan(e.start,n[n.length-1].stop)){n.push(e),this._changedEvent.raiseEvent(this);return}let r=Lu(n,e,WB);r<0?r=~r:r>0&&e.isStartIncluded&&n[r-1].isStartIncluded&&n[r-1].start.equals(e.start)?--r:r<n.length&&!e.isStartIncluded&&n[r].isStartIncluded&&n[r].start.equals(e.start)&&++r;let o;for(r>0&&(o=ce.compare(n[r-1].stop,e.start),(o>0||o===0&&(n[r-1].isStopIncluded||e.isStartIncluded))&&((g(t)?t(n[r-1].data,e.data):n[r-1].data===e.data)?(ce.greaterThan(e.stop,n[r-1].stop)?e=new ii({start:n[r-1].start,stop:e.stop,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):e=new ii({start:n[r-1].start,stop:n[r-1].stop,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:n[r-1].isStopIncluded||e.stop.equals(n[r-1].stop)&&e.isStopIncluded,data:e.data}),n.splice(r-1,1),--r):(o=ce.compare(n[r-1].stop,e.stop),(o>0||o===0&&n[r-1].isStopIncluded&&!e.isStopIncluded)&&n.splice(r,0,new ii({start:e.stop,stop:n[r-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[r-1].isStopIncluded,data:n[r-1].data})),n[r-1]=new ii({start:n[r-1].start,stop:e.start,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[r-1].data}))));r<n.length&&(o=ce.compare(e.stop,n[r].start),o>0||o===0&&(e.isStopIncluded||n[r].isStartIncluded));)if(g(t)?t(n[r].data,e.data):n[r].data===e.data)e=new ii({start:e.start,stop:ce.greaterThan(n[r].stop,e.stop)?n[r].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:ce.greaterThan(n[r].stop,e.stop)?n[r].isStopIncluded:e.isStopIncluded,data:e.data}),n.splice(r,1);else if(n[r]=new ii({start:e.stop,stop:n[r].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[r].isStopIncluded,data:n[r].data}),n[r].isEmpty)n.splice(r,1);else break;n.splice(r,0,e),this._changedEvent.raiseEvent(this)};Ta.prototype.removeInterval=function(e){if(e.isEmpty)return!1;let t=this._intervals,n=Lu(t,e,WB);n<0&&(n=~n);let r=!1;for(n>0&&(ce.greaterThan(t[n-1].stop,e.start)||t[n-1].stop.equals(e.start)&&t[n-1].isStopIncluded&&e.isStartIncluded)&&(r=!0,(ce.greaterThan(t[n-1].stop,e.stop)||t[n-1].isStopIncluded&&!e.isStopIncluded&&t[n-1].stop.equals(e.stop))&&t.splice(n,0,new ii({start:e.stop,stop:t[n-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n-1].isStopIncluded,data:t[n-1].data})),t[n-1]=new ii({start:t[n-1].start,stop:e.start,isStartIncluded:t[n-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[n-1].data})),n<t.length&&!e.isStartIncluded&&t[n].isStartIncluded&&e.start.equals(t[n].start)&&(r=!0,t.splice(n,0,new ii({start:t[n].start,stop:t[n].start,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data})),++n);n<t.length&&ce.greaterThan(e.stop,t[n].stop);)r=!0,t.splice(n,1);return n<t.length&&e.stop.equals(t[n].stop)&&(r=!0,!e.isStopIncluded&&t[n].isStopIncluded?n+1<t.length&&t[n+1].start.equals(e.stop)&&t[n].data===t[n+1].data?(t.splice(n,1),t[n]=new ii({start:t[n].start,stop:t[n].stop,isStartIncluded:!0,isStopIncluded:t[n].isStopIncluded,data:t[n].data})):t[n]=new ii({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data}):t.splice(n,1)),n<t.length&&(ce.greaterThan(e.stop,t[n].start)||e.stop.equals(t[n].start)&&e.isStopIncluded&&t[n].isStartIncluded)&&(r=!0,t[n]=new ii({start:e.stop,stop:t[n].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n].isStopIncluded,data:t[n].data})),r&&this._changedEvent.raiseEvent(this),r};Ta.prototype.intersect=function(e,t,n){let r=new Ta,o=0,a=0,s=this._intervals,u=e._intervals;for(;o<s.length&&a<u.length;){let l=s[o],c=u[a];if(ce.lessThan(l.stop,c.start))++o;else if(ce.lessThan(c.stop,l.start))++a;else{if(g(n)||g(t)&&t(l.data,c.data)||!g(t)&&c.data===l.data){let f=ii.intersect(l,c,new ii,n);f.isEmpty||r.addInterval(f,t)}ce.lessThan(l.stop,c.stop)||l.stop.equals(c.stop)&&!l.isStopIncluded&&c.isStopIncluded?++o:++a}}return r};Ta.fromJulianDateArray=function(e,t){g(t)||(t=new Ta);let n=e.julianDates,r=n.length,o=e.dataCallback,a=T(e.isStartIncluded,!0),s=T(e.isStopIncluded,!0),u=T(e.leadingInterval,!1),l=T(e.trailingInterval,!1),c,f=0;u&&(++f,c=new ii({start:ys.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!a}),c.data=g(o)?o(c,t.length):t.length,t.addInterval(c));for(let h=0;h<r-1;++h){let d=n[h],p=n[h+1];c=new ii({start:d,stop:p,isStartIncluded:t.length===f?a:!0,isStopIncluded:h===r-2?s:!1}),c.data=g(o)?o(c,t.length):t.length,t.addInterval(c),d=p}return l&&(c=new ii({start:n[r-1],stop:ys.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0}),c.data=g(o)?o(c,t.length):t.length,t.addInterval(c)),t};var _l=new oC,oS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function qB(e,t,n){g(n)||(n=new ce),ce.toGregorianDate(e,_l);let r=_l.millisecond+t.millisecond,o=_l.second+t.second,a=_l.minute+t.minute,s=_l.hour+t.hour,u=_l.day+t.day,l=_l.month+t.month,c=_l.year+t.year;for(r>=1e3&&(o+=Math.floor(r/1e3),r=r%1e3),o>=60&&(a+=Math.floor(o/60),o=o%60),a>=60&&(s+=Math.floor(a/60),a=a%60),s>=24&&(u+=Math.floor(s/24),s=s%24),oS[2]=aC(c)?29:28;u>oS[l]||l>=13;)u>oS[l]&&(u-=oS[l],++l),l>=13&&(--l,c+=Math.floor(l/12),l=l%12,++l),oS[2]=aC(c)?29:28;return _l.millisecond=r,_l.second=o,_l.minute=a,_l.hour=s,_l.day=u,_l.month=l,_l.year=c,ce.fromGregorianDate(_l,n)}var LEe=new ce,REe=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function rK(e,t){if(!g(e)||e.length===0)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,e[0]==="P"){let n=e.match(REe);if(!g(n))return!1;if(g(n[1])&&(t.year=Number(n[1].replace(",","."))),g(n[2])&&(t.month=Number(n[2].replace(",","."))),g(n[3])&&(t.day=Number(n[3].replace(",","."))*7),g(n[4])&&(t.day+=Number(n[4].replace(",","."))),g(n[5])&&(t.hour=Number(n[5].replace(",","."))),g(n[6])&&(t.minute=Number(n[6].replace(",","."))),g(n[7])){let r=Number(n[7].replace(",","."));t.second=Math.floor(r),t.millisecond=r%1*1e3}}else e[e.length-1]!=="Z"&&(e+="Z"),ce.toGregorianDate(ce.fromIso8601(e,LEe),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var aS=new oC;Ta.fromIso8601=function(e,t){let n=e.iso8601.split("/"),r=ce.fromIso8601(n[0]),o=ce.fromIso8601(n[1]),a=[];if(!rK(n[2],aS))a.push(r,o);else{let s=ce.clone(r);for(a.push(s);ce.compare(s,o)<0;)s=qB(s,aS),ce.compare(o,s)<=0&&ce.clone(o,s),a.push(s)}return Ta.fromJulianDateArray({julianDates:a,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};Ta.fromIso8601DateArray=function(e,t){return Ta.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(n){return ce.fromIso8601(n)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};Ta.fromIso8601DurationArray=function(e,t){let n=e.epoch,r=e.iso8601Durations,o=T(e.relativeToPrevious,!1),a=[],s,u,l=r.length;for(let c=0;c<l;++c)(rK(r[c],aS)||c===0)&&(o&&g(u)?s=qB(u,aS):s=qB(n,aS),a.push(s),u=s);return Ta.fromJulianDateArray({julianDates:a,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};var rg=Ta;function OEe(e){let t=new eo.default(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return r!==-1&&(n=n.substr(r+1)),n}var iK=OEe;function Bp(e,t){this._ellipsoid=e,this._cameraPosition=new x,this._cameraPositionInScaledSpace=new x,this._distanceToLimbInScaledSpaceSquared=0,g(t)&&(this.cameraPosition=t)}Object.defineProperties(Bp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),r=x.magnitudeSquared(n)-1;x.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=n,this._distanceToLimbInScaledSpaceSquared=r}}});var oK=new x;Bp.prototype.isPointVisible=function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,oK);return XB(n,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};Bp.prototype.isScaledSpacePointVisible=function(e){return XB(e,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var NEe=new x;Bp.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(e,t){let n=this._ellipsoid,r,o;return g(t)&&t<0&&n.minimumRadius>-t?(o=NEe,o.x=this._cameraPosition.x/(n.radii.x+t),o.y=this._cameraPosition.y/(n.radii.y+t),o.z=this._cameraPosition.z/(n.radii.z+t),r=o.x*o.x+o.y*o.y+o.z*o.z-1):(o=this._cameraPositionInScaledSpace,r=this._distanceToLimbInScaledSpaceSquared),XB(e,o,r)};Bp.prototype.computeHorizonCullingPoint=function(e,t,n){return uK(this._ellipsoid,e,t,n)};var aK=Ge.clone(Ge.UNIT_SPHERE);Bp.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(e,t,n,r){let o=sK(this._ellipsoid,n,aK);return uK(o,e,t,r)};Bp.prototype.computeHorizonCullingPointFromVertices=function(e,t,n,r,o){return lK(this._ellipsoid,e,t,n,r,o)};Bp.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(e,t,n,r,o,a){let s=sK(this._ellipsoid,o,aK);return lK(s,e,t,n,r,a)};var BEe=[];Bp.prototype.computeHorizonCullingPointFromRectangle=function(e,t,n){let r=hn.subsample(e,t,0,BEe),o=Ee.fromPoints(r);if(!(x.magnitude(o.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(o.center,r,n)};var FEe=new x;function sK(e,t,n){if(g(t)&&t<0&&e.minimumRadius>-t){let r=x.fromElements(e.radii.x+t,e.radii.y+t,e.radii.z+t,FEe);e=Ge.fromCartesian3(r,n)}return e}function uK(e,t,n,r){g(r)||(r=new x);let o=hK(e,t),a=0;for(let s=0,u=n.length;s<u;++s){let l=n[s],c=cK(e,l,o);if(c<0)return;a=Math.max(a,c)}return fK(o,a,r)}var nM=new x;function lK(e,t,n,r,o,a){g(a)||(a=new x),r=T(r,3),o=T(o,x.ZERO);let s=hK(e,t),u=0;for(let l=0,c=n.length;l<c;l+=r){nM.x=n[l]+o.x,nM.y=n[l+1]+o.y,nM.z=n[l+2]+o.z;let f=cK(e,nM,s);if(f<0)return;u=Math.max(u,f)}return fK(s,u,a)}function XB(e,t,n){let r=t,o=n,a=x.subtract(e,r,oK),s=-x.dot(a,r);return!(o<0?s>0:s>o&&s*s/x.magnitudeSquared(a)>o)}var zEe=new x,VEe=new x;function cK(e,t,n){let r=e.transformPositionToScaledSpace(t,zEe),o=x.magnitudeSquared(r),a=Math.sqrt(o),s=x.divideByScalar(r,a,VEe);o=Math.max(1,o),a=Math.max(1,a);let u=x.dot(s,n),l=x.magnitude(x.cross(s,n,s)),c=1/a,f=Math.sqrt(o-1)*c;return 1/(u*c-l*f)}function fK(e,t,n){if(!(t<=0||t===1/0||t!==t))return x.multiplyByScalar(e,t,n)}var YB=new x;function hK(e,t){return x.equals(t,x.ZERO)?t:(e.transformPositionToScaledSpace(t,YB),x.normalize(YB,YB))}var jB=Bp;function nr(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;g(n)&&(n=bt.clone(n)),g(r)&&(r=bt.clone(r)),g(o)&&(o=bt.clone(o)),g(a)&&(a=yn.clone(a)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._translate=new X(0,0),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._heightReference=T(e.heightReference,Lt.NONE),this._verticalOrigin=T(e.verticalOrigin,ln.CENTER),this._horizontalOrigin=T(e.horizontalOrigin,go.CENTER),this._scale=T(e.scale,1),this._color=K.clone(T(e.color,K.WHITE)),this._rotation=T(e.rotation,0),this._alignedAxis=x.clone(T(e.alignedAxis,x.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=o,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._sizeInMeters=T(e.sizeInMeters,!1),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=T(e.collection,t),this._pickId=void 0,this._pickPrimitive=T(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0,this._clusterId=void 0;let s=e.image,u=e.imageId;g(s)&&(g(u)||(typeof s=="string"?u=s:g(s.src)?u=s.src:u=Ci()),this._imageId=u,this._image=s),g(e.imageSubRegion)&&(this._imageId=u,this._imageSubRegion=e.imageSubRegion),g(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=Ne.SCENE3D,this._clusterShow=!0,this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,0),this._animation=T(e.animation,!1),this._updateClamping()}var dK=nr.SHOW_INDEX=0,iM=nr.POSITION_INDEX=1,yK=nr.PIXEL_OFFSET_INDEX=2,kEe=nr.EYE_OFFSET_INDEX=3,GEe=nr.HORIZONTAL_ORIGIN_INDEX=4,UEe=nr.VERTICAL_ORIGIN_INDEX=5,HEe=nr.SCALE_INDEX=6,oM=nr.IMAGE_INDEX_INDEX=7,pK=nr.COLOR_INDEX=8,qEe=nr.ROTATION_INDEX=9,WEe=nr.ALIGNED_AXIS_INDEX=10,YEe=nr.SCALE_BY_DISTANCE_INDEX=11,XEe=nr.TRANSLUCENCY_BY_DISTANCE_INDEX=12,jEe=nr.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,KEe=nr.DISTANCE_DISPLAY_CONDITION=14,ZEe=nr.DISABLE_DEPTH_DISTANCE=15;nr.TEXTURE_COORDINATE_BOUNDS=16;var mK=nr.SDF_INDEX=17;nr.NUMBER_OF_PROPERTIES=18;function Eo(e,t){let n=e._billboardCollection;g(n)&&(n._updateBillboard(e,t),e._dirty=!0)}Object.defineProperties(nr.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,Eo(this,dK))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),this._updateClamping(),Eo(this,iM))}},heightReference:{get:function(){return this._heightReference},set:function(e){let t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),Eo(this,iM))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;X.equals(t,e)||(X.clone(e,t),Eo(this,yK))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;bt.equals(t,e)||(this._scaleByDistance=bt.clone(e,t),Eo(this,YEe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;bt.equals(t,e)||(this._translucencyByDistance=bt.clone(e,t),Eo(this,XEe))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;bt.equals(t,e)||(this._pixelOffsetScaleByDistance=bt.clone(e,t),Eo(this,jEe))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;x.equals(t,e)||(x.clone(e,t),Eo(this,kEe))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,Eo(this,GEe))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,Eo(this,UEe))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,Eo(this,HEe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),Eo(this,pK))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,Eo(this,qEe))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;x.equals(t,e)||(x.clone(e,t),Eo(this,WEe))}},width:{get:function(){return T(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,Eo(this,oM))}},height:{get:function(){return T(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,Eo(this,oM))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,Eo(this,pK))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){yn.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=yn.clone(e,this._distanceDisplayCondition),Eo(this,KEe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,Eo(this,ZEe))}},id:{get:function(){return this._id},set:function(e){this._id=e,g(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,g(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){g(e)?typeof e=="string"?this.setImage(e,e):e instanceof vt?this.setImage(e.url,e):g(e.src)?this.setImage(e.src,e):this.setImage(Ci(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,Eo(this,oM))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition),Eo(this,iM)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,Eo(this,dK))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),Eo(this,mK))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Eo(this,mK))}},animation:{get:function(){return this._animation},set:function(e){this._animation!==e&&(this._animation=e)}}});nr.prototype.getPickId=function(e){return g(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};nr.prototype._updateClamping=function(){nr._updateClamping(this._billboardCollection,this)};var sS=new le,gK=new x;nr._updateClamping=function(e,t){let n=e._scene;if(!g(n)||!g(n.globe))return;let r=n.globe,o=r.ellipsoid,a=r._surface,s=n.frameState.mode,u=s!==t._mode;if(t._mode=s,(t._heightReference===Lt.NONE||u)&&g(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===Lt.NONE||!g(t._position))return;let l=o.cartesianToCartographic(t._position);if(!g(l)){t._actualClampedPosition=void 0;return}g(t._removeCallbackFunc)&&t._removeCallbackFunc();function c(h){if(t._heightReference===Lt.RELATIVE_TO_GROUND)if(t._mode===Ne.SCENE3D){let d=o.cartesianToCartographic(h,sS);d.height+=l.height,o.cartographicToCartesian(d,h)}else h.x+=l.height;t._clampedPosition=x.clone(h,t._clampedPosition)}t._removeCallbackFunc=a.updateHeight(l,c),le.clone(l,sS);let f=r.getHeight(l);g(f)&&(sS.height=f),o.cartographicToCartesian(sS,gK),c(gK)};nr.prototype._loadImage=function(){let e=this._billboardCollection._textureAtlas,t=this._imageId,n=this._image,r=this._imageSubRegion,o,a=this;function s(u){if(a._imageId!==t||a._image!==n||!rn.equals(a._imageSubRegion,r))return;let l=e.textureCoordinates[u];a._imageWidth=e.texture.width*l.width,a._imageHeight=e.texture.height*l.height,a._imageIndex=u,a._ready=!0,a._imageIndexPromise=void 0,Eo(a,oM)}if(g(n)){let u=e.getImageIndex(t);if(g(u)){s(u);return}o=e.addImage(t,n)}g(r)&&(o=e.addSubRegion(t,r)),this._imageIndexPromise=o,g(o)&&o.then(s).catch(function(u){console.error(`Error loading image for billboard: ${u}`),a._imageIndexPromise=void 0})};nr.prototype._updateImage=function(){this._billboardCollection._textureAtlas.updateImage(this._imageIndex,this._image)};nr.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,g(this._billboardCollection._textureAtlas)&&this._loadImage())};nr.prototype.setImageSubRegion=function(e,t){this._imageId===e&&rn.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=rn.clone(t),g(this._billboardCollection._textureAtlas)&&this._loadImage())};nr.prototype._setTranslate=function(e){let t=this._translate;X.equals(t,e)||(X.clone(e,t),Eo(this,yK))};nr.prototype._getActualPosition=function(){return g(this._clampedPosition)?this._clampedPosition:this._actualPosition};nr.prototype._setActualPosition=function(e){g(this._clampedPosition)||x.clone(e,this._actualPosition),Eo(this,iM)};var _K=new Se;nr._computeActualPosition=function(e,t,n,r){return g(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===Ne.SCENE3D?t:(G.multiplyByPoint(r,t,_K),Ff.computeActualWgs84Position(n,_K))};var vK=new x;nr._computeScreenSpacePosition=function(e,t,n,r,o,a){let s=G.multiplyByPoint(e,t,vK),u=Ff.wgs84WithEyeOffsetToWindowCoordinates(o,s,n,a);if(!!g(u))return X.add(u,r,u),u};var rM=new X(0,0);nr.prototype.computeScreenSpacePosition=function(e,t){let n=this._billboardCollection;g(t)||(t=new X),X.clone(this._pixelOffset,rM),X.add(rM,this._translate,rM);let r=n.modelMatrix,o=this._position;if(g(this._clampedPosition)&&(o=this._clampedPosition,e.mode!==Ne.SCENE3D)){let s=e.mapProjection,u=s.ellipsoid,l=s.unproject(o,sS);o=u.cartographicToCartesian(l,vK),r=G.IDENTITY}return nr._computeScreenSpacePosition(r,o,this._eyeOffset,rM,e,t)};nr.getScreenSpaceBoundingBox=function(e,t,n){let r=e.width,o=e.height,a=e.scale;r*=a,o*=a;let s=t.x;e.horizontalOrigin===go.RIGHT?s-=r:e.horizontalOrigin===go.CENTER&&(s-=r*.5);let u=t.y;return e.verticalOrigin===ln.BOTTOM||e.verticalOrigin===ln.BASELINE?u-=o:e.verticalOrigin===ln.CENTER&&(u-=o*.5),g(n)||(n=new rn),n.x=s,n.y=u,n.width=r,n.height=o,n};nr.prototype.equals=function(e){return this===e||g(e)&&this._id===e._id&&x.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&rn.equals(this._imageSubRegion,e._imageSubRegion)&&K.equals(this._color,e._color)&&X.equals(this._pixelOffset,e._pixelOffset)&&X.equals(this._translate,e._translate)&&x.equals(this._eyeOffset,e._eyeOffset)&&bt.equals(this._scaleByDistance,e._scaleByDistance)&&bt.equals(this._translucencyByDistance,e._translucencyByDistance)&&bt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&yn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};nr.prototype._destroy=function(){g(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),g(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var lo=nr;var QEe=lo.SHOW_INDEX,lS=lo.POSITION_INDEX,CK=lo.PIXEL_OFFSET_INDEX,xK=lo.EYE_OFFSET_INDEX,JEe=lo.HORIZONTAL_ORIGIN_INDEX,$Ee=lo.VERTICAL_ORIGIN_INDEX,eTe=lo.SCALE_INDEX,uS=lo.IMAGE_INDEX_INDEX,wK=lo.COLOR_INDEX,tTe=lo.ROTATION_INDEX,nTe=lo.ALIGNED_AXIS_INDEX,EK=lo.SCALE_BY_DISTANCE_INDEX,TK=lo.TRANSLUCENCY_BY_DISTANCE_INDEX,SK=lo.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,AK=lo.DISTANCE_DISPLAY_CONDITION,rTe=lo.DISABLE_DEPTH_DISTANCE,iTe=lo.TEXTURE_COORDINATE_BOUNDS,bK=lo.SDF_INDEX,tF=lo.NUMBER_OF_PROPERTIES,Ji,oTe={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},aTe={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function mh(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(tF),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._modelMatrix=G.clone(G.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=T(e.debugShowTextureAtlas,!1),this.blendOption=T(e.blendOption,Nr.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW],this._highlightColor=K.clone(K.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let n=this._scene;g(n)&&g(n.terrainProviderChanged)&&(this._removeCallbackFunc=n.terrainProviderChanged.addEventListener(function(){let r=this._billboards,o=r.length;for(let a=0;a<o;++a)g(r[a])&&r[a]._updateClamping()},this))}Object.defineProperties(mh.prototype,{length:{get:function(){return nF(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function IK(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}mh.prototype.add=function(e){let t=new lo(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t};mh.prototype.remove=function(e){return this.contains(e)?(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};mh.prototype.removeAll=function(){IK(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function nF(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],n=e._billboards,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];g(s)&&(s._index=a++,t.push(s))}e._billboards=t}}mh.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]};mh.prototype.contains=function(e){return g(e)&&e._billboardCollection===this};mh.prototype.get=function(e){return nF(this),this._billboards[e]};var KB;function sTe(e){let n=e.cache.billboardCollection_indexBufferBatched;if(g(n))return n;let r=16384*6-6,o=new Uint16Array(r);for(let a=0,s=0;a<r;a+=6,s+=4)o[a]=s,o[a+1]=s+1,o[a+2]=s+2,o[a+3]=s+0,o[a+4]=s+2,o[a+5]=s+3;return n=Ui.createIndexBuffer({context:e,typedArray:o,usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=n,n}function uTe(e){let t=e.cache.billboardCollection_indexBufferInstanced;return g(t)||(t=Ui.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function lTe(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return g(t)||(t=Ui.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:We.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}mh.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<tF;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function cTe(e,t,n,r,o,a){let s=[{index:Ji.positionHighAndScale,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[lS]},{index:Ji.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[lS]},{index:Ji.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[CK]},{index:Ji.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[TK]},{index:Ji.compressedAttribute2,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[wK]},{index:Ji.eyeOffset,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[xK]},{index:Ji.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[EK]},{index:Ji.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[SK]},{index:Ji.compressedAttribute3,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[AK]},{index:Ji.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[iTe]}];r&&s.push({index:Ji.direction,componentsPerAttribute:2,componentDatatype:ie.FLOAT,vertexBuffer:lTe(e)}),g(o)&&s.push({index:Ji.a_batchId,componentsPerAttribute:1,componentDatatype:ie.FLOAT,bufferUsage:We.STATIC_DRAW}),a&&s.push({index:Ji.sdf,componentsPerAttribute:2,componentDatatype:ie.FLOAT,usage:n[bK]});let u=r?t:4*t;return new fC(e,s,u,r)}var ZB=new ti;function DK(e,t,n,r,o){let a,s=r[Ji.positionHighAndScale],u=r[Ji.positionLowAndRotation],l=o._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),ti.fromCartesian(l,ZB);let c=o.scale,f=o.rotation;f!==0&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,c);let h=ZB.high,d=ZB.low;e._instanced?(a=o._index,s(a,h.x,h.y,h.z,c),u(a,d.x,d.y,d.z,f)):(a=o._index*4,s(a+0,h.x,h.y,h.z,c),s(a+1,h.x,h.y,h.z,c),s(a+2,h.x,h.y,h.z,c),s(a+3,h.x,h.y,h.z,c),u(a+0,d.x,d.y,d.z,f),u(a+1,d.x,d.y,d.z,f),u(a+2,d.x,d.y,d.z,f),u(a+3,d.x,d.y,d.z,f))}var ph=new X,dh=32768,Nx=65536,QB=4096,Fp=256,fTe=128,hTe=32,dTe=8,PK=4,pTe=1/256,MK=0,LK=2,RK=3,OK=1;function NK(e,t,n,r,o){let a,s=r[Ji.compressedAttribute0],u=o.pixelOffset,l=u.x,c=u.y,f=o._translate,h=f.x,d=f.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+h),Math.abs(-c+d));let p=o.horizontalOrigin,_=o._verticalOrigin,y=o.show&&o.clusterShow;o.color.alpha===0&&(y=!1),_===ln.BASELINE&&(_=ln.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===go.CENTER,e._allVerticalCenter=e._allVerticalCenter&&_===ln.CENTER;let v=0,w=0,C=0,E=0,S=o._imageIndex;if(S!==-1){let V=n[S];v=V.x,w=V.y,C=V.width,E=V.height}let A=v+C,D=w+E,P=Math.floor(F.clamp(l,-dh,dh)+dh)*fTe;P+=(p+1)*hTe,P+=(_+1)*dTe,P+=(y?1:0)*PK;let M=Math.floor(F.clamp(c,-dh,dh)+dh)*Fp,b=Math.floor(F.clamp(h,-dh,dh)+dh)*Fp,O=(F.clamp(d,-dh,dh)+dh)*pTe,m=Math.floor(O),I=Math.floor((O-m)*Fp);M+=m,b+=I,ph.x=v,ph.y=w;let L=_a.compressTextureCoordinates(ph);ph.x=A;let R=_a.compressTextureCoordinates(ph);ph.y=D;let N=_a.compressTextureCoordinates(ph);ph.x=v;let B=_a.compressTextureCoordinates(ph);e._instanced?(a=o._index,s(a,P,M,b,L)):(a=o._index*4,s(a+0,P+MK,M,b,L),s(a+1,P+LK,M,b,R),s(a+2,P+RK,M,b,N),s(a+3,P+OK,M,b,B))}function BK(e,t,n,r,o){let a,s=r[Ji.compressedAttribute1],u=o.alignedAxis;x.equals(u,x.ZERO)||(e._shaderAlignedAxis=!0);let l=0,c=1,f=1,h=1,d=o.translucencyByDistance;g(d)&&(l=d.near,c=d.nearValue,f=d.far,h=d.farValue,(c!==1||h!==1)&&(e._shaderTranslucencyByDistance=!0));let p=0,_=o._imageIndex;_!==-1&&(p=n[_].width);let y=e._textureAtlas.texture.width,v=Math.round(T(o.width,y*p));e._maxSize=Math.max(e._maxSize,v);let w=F.clamp(v,0,Nx),C=0;Math.abs(x.magnitudeSquared(u)-1)<F.EPSILON6&&(C=_a.octEncodeFloat(u)),c=F.clamp(c,0,1),c=c===1?255:c*255|0,w=w*Fp+c,h=F.clamp(h,0,1),h=h===1?255:h*255|0,C=C*Fp+h,e._instanced?(a=o._index,s(a,w,C,l,f)):(a=o._index*4,s(a+0,w,C,l,f),s(a+1,w,C,l,f),s(a+2,w,C,l,f),s(a+3,w,C,l,f))}function $B(e,t,n,r,o){let a,s=r[Ji.compressedAttribute2],u=o.color,l=g(e._batchTable)?K.WHITE:o.getPickId(t.context).color,c=o.sizeInMeters?1:0,f=Math.abs(x.magnitudeSquared(o.alignedAxis)-1)<F.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&c===1;let h=0,d=o._imageIndex;d!==-1&&(h=n[d].height);let p=e._textureAtlas.texture.dimensions,_=Math.round(T(o.height,p.y*h));e._maxSize=Math.max(e._maxSize,_);let y=T(o._labelHorizontalOrigin,-2);y+=2;let v=_*PK+y,w=K.floatToByte(u.red),C=K.floatToByte(u.green),E=K.floatToByte(u.blue),S=w*Nx+C*Fp+E;w=K.floatToByte(l.red),C=K.floatToByte(l.green),E=K.floatToByte(l.blue);let A=w*Nx+C*Fp+E,D=K.floatToByte(u.alpha)*Nx+K.floatToByte(l.alpha)*Fp;D+=c*2+f,e._instanced?(a=o._index,s(a,S,A,D,v)):(a=o._index*4,s(a+0,S,A,D,v),s(a+1,S,A,D,v),s(a+2,S,A,D,v),s(a+3,S,A,D,v))}function eF(e,t,n,r,o){let a,s=r[Ji.eyeOffset],u=o.eyeOffset,l=u.z;if(o._heightReference!==Lt.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(u.x),Math.abs(u.y),Math.abs(l)),e._instanced){let c=0,f=0,h=o._imageIndex;if(h!==-1){let p=n[h];c=p.width,f=p.height}ph.x=c,ph.y=f;let d=_a.compressTextureCoordinates(ph);a=o._index,s(a,u.x,u.y,l,d)}else a=o._index*4,s(a+0,u.x,u.y,l,0),s(a+1,u.x,u.y,l,0),s(a+2,u.x,u.y,l,0),s(a+3,u.x,u.y,l,0)}function FK(e,t,n,r,o){let a,s=r[Ji.scaleByDistance],u=0,l=1,c=1,f=1,h=o.scaleByDistance;g(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function zK(e,t,n,r,o){let a,s=r[Ji.pixelOffsetScaleByDistance],u=0,l=1,c=1,f=1,h=o.pixelOffsetScaleByDistance;g(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function VK(e,t,n,r,o){let a,s=r[Ji.compressedAttribute3],u=0,l=Number.MAX_VALUE,c=o.distanceDisplayCondition;g(c)&&(u=c.near,l=c.far,u*=u,l*=l,e._shaderDistanceDisplayCondition=!0);let f=o.disableDepthTestDistance,h=o.heightReference===Lt.CLAMP_TO_GROUND&&t.context.depthTexture;g(f)||(f=h?5e3:0),f*=f,(h||f>0)&&(e._shaderDisableDepthDistance=!0,f===Number.POSITIVE_INFINITY&&(f=-1));let d,p;if(g(o._labelDimensions))p=o._labelDimensions.x,d=o._labelDimensions.y;else{let w=0,C=0,E=o._imageIndex;if(E!==-1){let A=n[E];w=A.height,C=A.width}d=Math.round(T(o.height,e._textureAtlas.texture.dimensions.y*w));let S=e._textureAtlas.texture.width;p=Math.round(T(o.width,S*C))}let _=Math.floor(F.clamp(p,0,QB)),y=Math.floor(F.clamp(d,0,QB)),v=_*QB+y;e._instanced?(a=o._index,s(a,u,l,f,v)):(a=o._index*4,s(a+0,u,l,f,v),s(a+1,u,l,f,v),s(a+2,u,l,f,v),s(a+3,u,l,f,v))}function kK(e,t,n,r,o){if(o.heightReference===Lt.CLAMP_TO_GROUND){let _=e._scene,y=t.context,v=t.globeTranslucencyState.translucent,w=g(_.globe)&&_.globe.depthTestAgainstTerrain;e._shaderClampToGround=y.depthTexture&&!v&&w}let a,s=r[Ji.textureCoordinateBoundsOrLabelTranslate];if(Jt.maximumVertexTextureImageUnits>0){let _=0,y=0;g(o._labelTranslate)&&(_=o._labelTranslate.x,y=o._labelTranslate.y),e._instanced?(a=o._index,s(a,_,y,0,0)):(a=o._index*4,s(a+0,_,y,0,0),s(a+1,_,y,0,0),s(a+2,_,y,0,0),s(a+3,_,y,0,0));return}let u=0,l=0,c=0,f=0,h=o._imageIndex;if(h!==-1){let _=n[h];u=_.x,l=_.y,c=_.width,f=_.height}let d=u+c,p=l+f;e._instanced?(a=o._index,s(a,u,l,d,p)):(a=o._index*4,s(a+0,u,l,d,p),s(a+1,u,l,d,p),s(a+2,u,l,d,p),s(a+3,u,l,d,p))}function mTe(e,t,n,r,o){if(!g(e._batchTable))return;let a=r[Ji.a_batchId],s=o._batchIndex,u;e._instanced?(u=o._index,a(u,s)):(u=o._index*4,a(u+0,s),a(u+1,s),a(u+2,s),a(u+3,s))}function GK(e,t,n,r,o){if(!e._sdf)return;let a,s=r[Ji.sdf],u=o.outlineColor,l=o.outlineWidth,c=K.floatToByte(u.red),f=K.floatToByte(u.green),h=K.floatToByte(u.blue),d=c*Nx+f*Fp+h,p=l/Rs.RADIUS,_=K.floatToByte(u.alpha)*Nx+K.floatToByte(p)*Fp;e._instanced?(a=o._index,s(a,d,_)):(a=o._index*4,s(a+0,d+MK,_),s(a+1,d+LK,_),s(a+2,d+RK,_),s(a+3,d+OK,_))}function gTe(e,t,n,r,o){DK(e,t,n,r,o),NK(e,t,n,r,o),BK(e,t,n,r,o),$B(e,t,n,r,o),eF(e,t,n,r,o),FK(e,t,n,r,o),zK(e,t,n,r,o),VK(e,t,n,r,o),kK(e,t,n,r,o),mTe(e,t,n,r,o),GK(e,t,n,r,o)}function JB(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=lo._computeActualPosition(c,f,r,o);g(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function _Te(e,t){let n=t.mode,r=e._billboards,o=e._billboardsToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!G.equals(a,e.modelMatrix)?(e._mode=n,G.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&JB(e,r,r.length,t,a,!0)):n===Ne.MORPHING?JB(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&JB(e,o,e._billboardsToUpdateIndex,t,a,!1)}function yTe(e,t,n){let r=1;(!e._allSizedInMeters||e._maxPixelOffset!==0)&&(r=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let o=r*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(o*=.5);let a=r*e._maxPixelOffset+e._maxEyeOffset;n.radius+=o+a}function vTe(e,t){let n=`uniform sampler2D billboard_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); 
} 
`,r=t.createViewportQuadCommand(n,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return r.pass=en.OVERLAY,r}var CTe=[];mh.prototype.update=function(e){if(nF(this),!this.show)return;let t=this._billboards,n=t.length,r=e.context;this._instanced=r.instancedArrays,Ji=this._instanced?aTe:oTe,KB=this._instanced?uTe:sTe;let o=this._textureAtlas;if(g(o))for(let M=0;M<n;++M){let b=t[M];b.animation&&b.ready&&b._updateImage()}else{o=this._textureAtlas=new B_({context:r});for(let M=0;M<n;++M)t[M]._loadImage()}let a=o.textureCoordinates;if(a.length===0)return;_Te(this,e),t=this._billboards,n=t.length;let s=this._billboardsToUpdate,u=this._billboardsToUpdateIndex,l=this._propertiesChanged,c=o.guid,f=this._createVertexArray||this._textureAtlasGUID!==c;this._textureAtlasGUID=c;let h,d=e.passes,p=d.pick;if(f||!p&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let M=0;M<tF;++M)l[M]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=cTe(r,n,this._buffersUsage,this._instanced,this._batchTable,this._sdf),h=this._vaf.writers;for(let M=0;M<n;++M){let b=this._billboards[M];b._dirty=!1,gTe(this,e,a,h,b)}this._vaf.commit(KB(r))}this._billboardsToUpdateIndex=0}else if(u>0){let M=CTe;M.length=0,(l[lS]||l[tTe]||l[eTe])&&M.push(DK),(l[uS]||l[CK]||l[JEe]||l[$Ee]||l[QEe])&&(M.push(NK),this._instanced&&M.push(eF)),(l[uS]||l[nTe]||l[TK])&&(M.push(BK),M.push($B)),(l[uS]||l[wK])&&M.push($B),l[xK]&&M.push(eF),l[EK]&&M.push(FK),l[SK]&&M.push(zK),(l[AK]||l[rTe]||l[uS]||l[lS])&&M.push(VK),(l[uS]||l[lS])&&M.push(kK),l[bK]&&M.push(GK);let b=M.length;if(h=this._vaf.writers,u/n>.1){for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let I=0;I<b;++I)M[I](this,e,a,h,m)}this._vaf.commit(KB(r))}else{for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let I=0;I<b;++I)M[I](this,e,a,h,m);this._instanced?this._vaf.subCommit(m._index,1):this._vaf.subCommit(m._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(u>n*1.5&&(s.length=n),!g(this._vaf)||!g(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let _,y=G.IDENTITY;e.mode===Ne.SCENE3D?(y=this.modelMatrix,_=Ee.clone(this._baseVolumeWC,this._boundingVolume)):_=Ee.clone(this._baseVolume2D,this._boundingVolume),yTe(this,e,_);let v=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,v){this._blendOption===Nr.OPAQUE||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=fn.fromCache({depthTest:{enabled:!0,func:k.LESS},depthMask:!0}):this._rsOpaque=void 0;let M=this._blendOption===Nr.TRANSLUCENT;this._blendOption===Nr.TRANSLUCENT||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=fn.fromCache({depthTest:{enabled:!0,func:M?k.LEQUAL:k.LESS},depthMask:M,blending:ka.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let w,C,E,S,A,D=Jt.maximumVertexTextureImageUnits>0;if(v||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){w=fI,C=cI,A=[],g(this._batchTable)&&(A.push("VECTOR_TILE"),w=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(w),C=this._batchTable.getFragmentShaderCallback(!1,void 0)(C)),E=new Et({defines:A,sources:[w]}),this._instanced&&E.defines.push("INSTANCED"),this._shaderRotation&&E.defines.push("ROTATION"),this._shaderAlignedAxis&&E.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&E.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&E.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&E.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&E.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&E.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK"));let M=1-Rs.CUTOFF;this._sdf&&E.defines.push("SDF");let b=g(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT&&(S=new Et({defines:["OPAQUE",b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=wi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ji}),S=new Et({defines:["TRANSLUCENT",b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=wi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ji})),this._blendOption===Nr.OPAQUE&&(S=new Et({defines:[b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=wi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ji})),this._blendOption===Nr.TRANSLUCENT&&(S=new Et({defines:[b],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=wi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ji})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let P=e.commandList;if(d.render||d.pick){let M=this._colorCommands,b=this._blendOption===Nr.OPAQUE,O=this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT,m=this._vaf.va,I=m.length,L=this._uniforms,R;g(this._batchTable)?(L=this._batchTable.getUniformMapCallback()(L),R=this._batchTable.getPickId()):R="v_pickColor",M.length=I;let N=O?I*2:I;for(let B=0;B<N;++B){let V=M[B];g(V)||(V=M[B]=new $t);let z=b||O&&B%2===0;V.pass=z||!O?en.OPAQUE:en.TRANSLUCENT,V.owner=this;let U=O?Math.floor(B/2):B;V.boundingVolume=_,V.modelMatrix=y,V.count=m[U].indicesCount,V.shaderProgram=z?this._sp:this._spTranslucent,V.uniformMap=L,V.vertexArray=m[U].va,V.renderState=z?this._rsOpaque:this._rsTranslucent,V.debugShowBoundingVolume=this.debugShowBoundingVolume,V.pickId=R,this._instanced&&(V.count=6,V.instanceCount=n),P.push(V)}this.debugShowTextureAtlas&&(g(this.debugCommand)||(this.debugCommand=vTe(this,e.context)),P.push(this.debugCommand))}};mh.prototype.isDestroyed=function(){return!1};mh.prototype.destroy=function(){return g(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),IK(this._billboards),st(this)};var ig=mh;var xTe={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2},yl=Object.freeze(xTe);var UK={},HK=0,wTe=256,ETe=new K(.165,.165,.165,.8),TTe=new X(7,5),Qa=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function Ry(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function cS(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function fS(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function WK(e){let t=UK[e._font];if(!g(t)){let n=document.createElement("div");n.style.position="absolute",n.style.opacity=0,n.style.font=e._font,document.body.appendChild(n);let r=parseFloat(fS(n,"line-height"));isNaN(r)&&(r=void 0),t={family:fS(n,"font-family"),size:fS(n,"font-size").replace("px",""),style:fS(n,"font-style"),weight:fS(n,"font-weight"),lineHeight:r},document.body.removeChild(n),HK<wTe&&(UK[e._font]=t,HK++)}e._fontFamily=t.family,e._fontSize=t.size,e._fontStyle=t.style,e._fontWeight=t.weight,e._lineHeight=t.lineHeight}function og(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;g(n)&&(n=bt.clone(n)),g(r)&&(r=bt.clone(r)),g(o)&&(o=bt.clone(o)),g(a)&&(a=yn.clone(a)),this._renderedText=void 0,this._text=void 0,this._show=T(e.show,!0),this._font=T(e.font,"30px sans-serif"),this._fillColor=K.clone(T(e.fillColor,K.WHITE)),this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,1),this._showBackground=T(e.showBackground,!1),this._backgroundColor=K.clone(T(e.backgroundColor,ETe)),this._backgroundPadding=X.clone(T(e.backgroundPadding,TTe)),this._style=T(e.style,yl.FILL),this._verticalOrigin=T(e.verticalOrigin,ln.BASELINE),this._horizontalOrigin=T(e.horizontalOrigin,go.LEFT),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._position=x.clone(T(e.position,x.ZERO)),this._scale=T(e.scale,1),this._id=e.id,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._scaleByDistance=o,this._heightReference=T(e.heightReference,Lt.NONE),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=T(e.text,""),this._relativeSize=1,this._clusterId=void 0,WK(this),this._updateClamping()}Object.defineProperties(og.prototype,{show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r].billboard;g(a)&&(a.show=e)}let n=this._backgroundBillboard;g(n)&&(n.show=e)}}},position:{get:function(){return this._position},set:function(e){let t=this._position;if(!x.equals(t,e)){x.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o].billboard;g(s)&&(s.position=e)}let r=this._backgroundBillboard;g(r)&&(r.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(e!==this._heightReference){this._heightReference=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r].billboard;g(a)&&(a.heightReference=e)}let n=this._backgroundBillboard;g(n)&&(n.heightReference=e),cS(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(this._text!==e){this._text=e;let t=e.replace(/\u00ad/g,"");this._renderedText=og.enableRightToLeftDetection?PTe(t):t,Ry(this)}}},font:{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,Ry(this),WK(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){let t=this._fillColor;K.equals(t,e)||(K.clone(e,t),Ry(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),Ry(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Ry(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){this._showBackground!==e&&(this._showBackground=e,Ry(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){let t=this._backgroundColor;if(!K.equals(t,e)){K.clone(e,t);let n=this._backgroundBillboard;g(n)&&(n.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){let t=this._backgroundPadding;X.equals(t,e)||(X.clone(e,t),cS(this))}},style:{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,Ry(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;if(!X.equals(t,e)){X.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];g(s.billboard)&&(s.billboard.pixelOffset=e)}let r=this._backgroundBillboard;g(r)&&(r.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;if(!bt.equals(t,e)){this._translucencyByDistance=bt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];g(s.billboard)&&(s.billboard.translucencyByDistance=e)}let r=this._backgroundBillboard;g(r)&&(r.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;if(!bt.equals(t,e)){this._pixelOffsetScaleByDistance=bt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];g(s.billboard)&&(s.billboard.pixelOffsetScaleByDistance=e)}let r=this._backgroundBillboard;g(r)&&(r.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;if(!bt.equals(t,e)){this._scaleByDistance=bt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];g(s.billboard)&&(s.billboard.scaleByDistance=e)}let r=this._backgroundBillboard;g(r)&&(r.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;if(!x.equals(t,e)){x.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];g(s.billboard)&&(s.billboard.eyeOffset=e)}let r=this._backgroundBillboard;g(r)&&(r.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,cS(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(this._verticalOrigin!==e){this._verticalOrigin=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.verticalOrigin=e)}let n=this._backgroundBillboard;g(n)&&(n.verticalOrigin=e),cS(this)}}},scale:{get:function(){return this._scale},set:function(e){if(this._scale!==e){this._scale=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.scale=e*this._relativeSize)}let n=this._backgroundBillboard;g(n)&&(n.scale=e*this._relativeSize),cS(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!yn.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=yn.clone(e,this._distanceDisplayCondition);let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.distanceDisplayCondition=e)}let n=this._backgroundBillboard;g(n)&&(n.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){this._disableDepthTestDistance=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.disableDepthTestDistance=e)}let n=this._backgroundBillboard;g(n)&&(n.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.id=e)}let n=this._backgroundBillboard;g(n)&&(n.id=e)}}},pickId:{get:function(){if(!(this._glyphs.length===0||!g(this._glyphs[0].billboard)))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition);let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard._clampedPosition=e)}let n=this._backgroundBillboard;g(n)&&(n._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];g(a.billboard)&&(a.billboard.clusterShow=e)}let n=this._backgroundBillboard;g(n)&&(n.clusterShow=e)}}}});og.prototype._updateClamping=function(){lo._updateClamping(this._labelCollection,this)};og.prototype.computeScreenSpacePosition=function(e,t){g(t)||(t=new X);let r=this._labelCollection.modelMatrix,o=g(this._actualClampedPosition)?this._actualClampedPosition:this._position;return lo._computeScreenSpacePosition(r,o,this._eyeOffset,this._pixelOffset,e,t)};og.getScreenSpaceBoundingBox=function(e,t,n){let r=0,o=0,a=0,s=0,u=e.totalScale,l=e._backgroundBillboard;if(g(l))r=t.x+l._translate.x,o=t.y-l._translate.y,a=l.width*u,s=l.height*u,e.verticalOrigin===ln.BOTTOM||e.verticalOrigin===ln.BASELINE?o-=s:e.verticalOrigin===ln.CENTER&&(o-=s*.5);else{r=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;let c=0,f=0,h=e._glyphs,d=h.length;for(let p=0;p<d;++p){let _=h[p],y=_.billboard;if(!g(y))continue;let v=t.x+y._translate.x,w=t.y-y._translate.y,C=_.dimensions.width*u,E=_.dimensions.height*u;e.verticalOrigin===ln.BOTTOM||e.verticalOrigin===ln.BASELINE?w-=E:e.verticalOrigin===ln.CENTER&&(w-=E*.5),e._verticalOrigin===ln.TOP?w+=Rs.PADDING*u:(e._verticalOrigin===ln.BOTTOM||e._verticalOrigin===ln.BASELINE)&&(w-=Rs.PADDING*u),r=Math.min(r,v),o=Math.min(o,w),c=Math.max(c,v+C),f=Math.max(f,w+E)}a=c-r,s=f-o}return g(n)||(n=new rn),n.x=r,n.y=o,n.width=a,n.height=s,n};og.prototype.equals=function(e){return this===e||g(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&x.equals(this._position,e._position)&&K.equals(this._fillColor,e._fillColor)&&K.equals(this._outlineColor,e._outlineColor)&&K.equals(this._backgroundColor,e._backgroundColor)&&X.equals(this._backgroundPadding,e._backgroundPadding)&&X.equals(this._pixelOffset,e._pixelOffset)&&x.equals(this._eyeOffset,e._eyeOffset)&&bt.equals(this._translucencyByDistance,e._translucencyByDistance)&&bt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&bt.equals(this._scaleByDistance,e._scaleByDistance)&&yn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id};og.prototype.isDestroyed=function(){return!1};og.enableRightToLeftDetection=!1;function STe(e,t){let n=/[a-zA-Z0-9]/,r=/[()[\]{}<>]/,o=[],a="",s=Qa.LTR,u="",l=e.length;for(let c=0;c<l;++c){let f=e.charAt(c);t.test(f)?u=Qa.RTL:n.test(f)?u=Qa.LTR:r.test(f)?u=Qa.BRACKETS:u=Qa.WEAK,c===0&&(s=u),s===u&&u!==Qa.BRACKETS?a+=f:(a!==""&&o.push({Type:s,Word:a}),s=u,a=f)}return o.push({Type:u,Word:a}),o}function ATe(e){return e.split("").reverse().join("")}function hS(e,t,n){return e.slice(0,t)+n+e.slice(t)}function bTe(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}var ITe="\u05D0-\u05EA",DTe="\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF",qK=new RegExp(`[${ITe}${DTe}]`);function PTe(e){let t=e.split(`
`),n="";for(let r=0;r<t.length;r++){let o=t[r],a=qK.test(o.charAt(0)),s=STe(o,qK),u=0,l="";for(let c=0;c<s.length;++c){let f=s[c],h=f.Type===Qa.BRACKETS?bTe(f.Word):ATe(f.Word);a?f.Type===Qa.RTL?(l=h+l,u=0):f.Type===Qa.LTR?(l=hS(l,u,f.Word),u+=f.Word.length):(f.Type===Qa.WEAK||f.Type===Qa.BRACKETS)&&(f.Type===Qa.WEAK&&s[c-1].Type===Qa.BRACKETS?l=h+l:s[c-1].Type===Qa.RTL?(l=h+l,u=0):s.length>c+1?s[c+1].Type===Qa.RTL?(l=h+l,u=0):(l=hS(l,u,f.Word),u+=f.Word.length):l=hS(l,0,h)):f.Type===Qa.RTL?l=hS(l,u,h):f.Type===Qa.LTR?(l+=f.Word,u=l.length):(f.Type===Qa.WEAK||f.Type===Qa.BRACKETS)&&(c>0&&s[c-1].Type===Qa.RTL?s.length>c+1?s[c+1].Type===Qa.RTL?l=hS(l,u,h):(l+=f.Word,u=l.length):l+=f.Word:(l+=f.Word,u=l.length))}n+=l,r<t.length-1&&(n+=`
`)}return n}var dS=og;function MTe(e,t,n,r,o){let a=e.measureText(t);if(!!/\S/.test(t)){let u=document.defaultView.getComputedStyle(e.canvas).getPropertyValue("font-size").replace("px",""),l=document.createElement("canvas"),c=100,f=a.width+c|0,h=3*u,d=h/2;l.width=f,l.height=h;let p=l.getContext("2d");p.font=n,p.fillStyle="white",p.fillRect(0,0,l.width+1,l.height+1),r&&(p.strokeStyle="black",p.lineWidth=e.lineWidth,p.strokeText(t,c/2,d)),o&&(p.fillStyle="black",p.fillText(t,c/2,d));let _=p.getImageData(0,0,f,h).data,y=_.length,v=f*4,w,C,E,S;for(w=0;w<y;++w)if(_[w]!==255){E=w/v|0;break}for(w=y-1;w>=0;--w)if(_[w]!==255){S=w/v|0;break}let A=-1;for(w=0;w<f&&A===-1;++w)for(C=0;C<h;++C){let D=w*4+C*v;if(_[D]!==255||_[D+1]!==255||_[D+2]!==255||_[D+3]!==255){A=w;break}}return{width:a.width,height:S-E,ascent:d-E,descent:S-d,minx:A-c/2}}return{width:a.width,height:0,ascent:0,descent:0,minx:0}}var Oy;function LTe(e,t){if(e==="")return;t=T(t,T.EMPTY_OBJECT);let n=T(t.font,"10px sans-serif"),r=T(t.stroke,!1),o=T(t.fill,!0),a=T(t.strokeWidth,1),s=T(t.backgroundColor,K.TRANSPARENT),u=T(t.padding,0),l=u*2,c=document.createElement("canvas");c.width=1,c.height=1,c.style.font=n;let f=c.getContext("2d");g(Oy)||(g(f.imageSmoothingEnabled)?Oy="imageSmoothingEnabled":g(f.mozImageSmoothingEnabled)?Oy="mozImageSmoothingEnabled":g(f.webkitImageSmoothingEnabled)?Oy="webkitImageSmoothingEnabled":g(f.msImageSmoothingEnabled)&&(Oy="msImageSmoothingEnabled")),f.font=n,f.lineJoin="round",f.lineWidth=a,f[Oy]=!1,c.style.visibility="hidden",document.body.appendChild(c);let h=MTe(f,e,n,r,o);c.dimensions=h,document.body.removeChild(c),c.style.visibility="";let d=-h.minx,p=Math.ceil(h.width)+d+l,_=h.height+l,y=_-h.ascent+u,v=_-y+l;if(c.width=p,c.height=_,f.font=n,f.lineJoin="round",f.lineWidth=a,f[Oy]=!1,s!==K.TRANSPARENT&&(f.fillStyle=s.toCssColorString(),f.fillRect(0,0,c.width,c.height)),r){let w=T(t.strokeColor,K.BLACK);f.strokeStyle=w.toCssColorString(),f.strokeText(e,d+u,v)}if(o){let w=T(t.fillColor,K.WHITE);f.fillStyle=w.toCssColorString(),f.fillText(e,d+u,v)}return c}var YK=LTe;var rF=Xv(ZK(),1);var iF=Xv(QK(),1);function NTe(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function BTe(e,t,n){this.labelCollection=e,this.index=t,this.dimensions=n}var FTe=1.2,eZ="ID_WHITE_PIXEL",aF=new X(4,4),zTe=new rn(1,1,1,1);function VTe(e){let t=document.createElement("canvas");t.width=aF.x,t.height=aF.y;let n=t.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,t.width,t.height),e.addImage(eZ,t)}var gh={};function kTe(e,t,n,r,o,a,s){return gh.font=t,gh.fillColor=n,gh.strokeColor=r,gh.strokeWidth=o,gh.padding=Rs.PADDING,s===ln.CENTER?gh.textBaseline="middle":s===ln.TOP?gh.textBaseline="top":gh.textBaseline="bottom",gh.fill=a===yl.FILL||a===yl.FILL_AND_OUTLINE,gh.stroke=a===yl.OUTLINE||a===yl.FILL_AND_OUTLINE,gh.backgroundColor=K.BLACK,YK(e,gh)}function sF(e,t){t.textureInfo=void 0,t.dimensions=void 0;let n=t.billboard;g(n)&&(n.show=!1,n.image=void 0,g(n._removeCallbackFunc)&&(n._removeCallbackFunc(),n._removeCallbackFunc=void 0),e._spareBillboards.push(n),t.billboard=void 0)}var oF={},JK=0,GTe=256*2;function UTe(e,t,n,r){r.index=e.addImageSync(t,n)}var HTe=new iF.default;function qTe(e,t){let n=t._renderedText,r=HTe.splitGraphemes(n),o=r.length,a=t._glyphs,s=a.length,u,l,c;if(t._relativeSize=t._fontSize/Rs.FONT_SIZE,o<s)for(l=o;l<s;++l)sF(e,a[l]);a.length=o;let f=t._showBackground&&n.split(`
`).join("").length>0,h=t._backgroundBillboard,d=e._backgroundBillboardCollection;f?(g(h)||(h=d.add({collection:e,image:eZ,imageSubRegion:zTe}),t._backgroundBillboard=h),h.color=t._backgroundColor,h.show=t._show,h.position=t._position,h.eyeOffset=t._eyeOffset,h.pixelOffset=t._pixelOffset,h.horizontalOrigin=go.LEFT,h.verticalOrigin=t._verticalOrigin,h.heightReference=t._heightReference,h.scale=t.totalScale,h.pickPrimitive=t,h.id=t._id,h.translucencyByDistance=t._translucencyByDistance,h.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,h.scaleByDistance=t._scaleByDistance,h.distanceDisplayCondition=t._distanceDisplayCondition,h.disableDepthTestDistance=t._disableDepthTestDistance):g(h)&&(d.remove(h),t._backgroundBillboard=h=void 0);let p=e._glyphTextureCache;for(c=0;c<o;++c){let _=r[c],y=t._verticalOrigin,v=JSON.stringify([_,t._fontFamily,t._fontStyle,t._fontWeight,+y]),w=p[v];if(!g(w)){let C=`${t._fontStyle} ${t._fontWeight} ${Rs.FONT_SIZE}px ${t._fontFamily}`,E=!1,S;if(g(oF[v])?(S=oF[v],E=!0):(S=kTe(_,C,K.WHITE,K.WHITE,0,yl.FILL,y),JK<GTe&&(oF[v]=S,JK++)),w=new BTe(e,-1,S.dimensions),p[v]=w,S.width>0&&S.height>0){if(!E){let A=(0,rF.default)(S,{cutoff:Rs.CUTOFF,radius:Rs.RADIUS}),D=S.getContext("2d"),P=S.width,M=S.height,b=D.getImageData(0,0,P,M);for(let O=0;O<P;O++)for(let m=0;m<M;m++){let I=m*P+O,L=A[I]*255,R=I*4;b.data[R+0]=L,b.data[R+1]=L,b.data[R+2]=L,b.data[R+3]=L}D.putImageData(b,0,0)}_!==" "&&UTe(e._textureAtlas,v,S,w)}}if(u=a[c],g(u)?w.index===-1?sF(e,u):g(u.textureInfo)&&(u.textureInfo=void 0):(u=new NTe,a[c]=u),u.textureInfo=w,u.dimensions=w.dimensions,w.index!==-1){let C=u.billboard,E=e._spareBillboards;g(C)||(E.length>0?C=E.pop():(C=e._billboardCollection.add({collection:e}),C._labelDimensions=new X,C._labelTranslate=new X),u.billboard=C),C.show=t._show,C.position=t._position,C.eyeOffset=t._eyeOffset,C.pixelOffset=t._pixelOffset,C.horizontalOrigin=go.LEFT,C.verticalOrigin=t._verticalOrigin,C._clampedPosition=t._clampedPosition,C.scale=t.totalScale,C.pickPrimitive=t,C.id=t._id,C.image=v,C.translucencyByDistance=t._translucencyByDistance,C.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,C.scaleByDistance=t._scaleByDistance,C.distanceDisplayCondition=t._distanceDisplayCondition,C.disableDepthTestDistance=t._disableDepthTestDistance,C._batchIndex=t._batchIndex,C.outlineColor=t.outlineColor,t.style===yl.FILL_AND_OUTLINE?(C.color=t._fillColor,C.outlineWidth=t.outlineWidth):t.style===yl.FILL?(C.color=t._fillColor,C.outlineWidth=0):t.style===yl.OUTLINE&&(C.color=K.TRANSPARENT,C.outlineWidth=t.outlineWidth)}}t._repositionAllGlyphs=!0}function $K(e,t,n){return t===go.CENTER?-e/2:t===go.RIGHT?-(e+n.x):n.x}var Wo=new X,WTe=new X;function YTe(e){let t=e._glyphs,n=e._renderedText,r,o,a=0,s=0,u=[],l=Number.NEGATIVE_INFINITY,c=0,f=1,h,d=t.length,p=e._backgroundBillboard,_=X.clone(g(p)?e._backgroundPadding:X.ZERO,WTe);for(_.x/=e._relativeSize,_.y/=e._relativeSize,h=0;h<d;++h)n.charAt(h)===`
`?(u.push(a),++f,a=0):(r=t[h],o=r.dimensions,c=Math.max(c,o.height-o.descent),l=Math.max(l,o.descent),a+=o.width-o.minx,h<d-1&&(a+=t[h+1].dimensions.minx),s=Math.max(s,a));u.push(a);let y=c+l,v=e.totalScale,w=e._horizontalOrigin,C=e._verticalOrigin,E=0,S=u[E],A=$K(S,w,_),D=(g(e._lineHeight)?e._lineHeight:FTe*e._fontSize)/e._relativeSize,P=D*(f-1),M=s,b=y+P;g(p)&&(M+=_.x*2,b+=_.y*2,p._labelHorizontalOrigin=w),Wo.x=A*v,Wo.y=0;let O=!0,m=0;for(h=0;h<d;++h)if(n.charAt(h)===`
`)++E,m+=D,S=u[E],A=$K(S,w,_),Wo.x=A*v,O=!0;else if(r=t[h],o=r.dimensions,C===ln.TOP?(Wo.y=o.height-c-_.y,Wo.y+=Rs.PADDING):C===ln.CENTER?Wo.y=(P+o.height-c)/2:C===ln.BASELINE?(Wo.y=P,Wo.y-=Rs.PADDING):(Wo.y=P+l+_.y,Wo.y-=Rs.PADDING),Wo.y=(Wo.y-o.descent-m)*v,O&&(Wo.x-=Rs.PADDING*v,O=!1),g(r.billboard)&&(r.billboard._setTranslate(Wo),r.billboard._labelDimensions.x=M,r.billboard._labelDimensions.y=b,r.billboard._labelHorizontalOrigin=w),h<d-1){let I=t[h+1];Wo.x+=(o.width-o.minx+I.dimensions.minx)*v}if(g(p)&&n.split(`
`).join("").length>0&&(w===go.CENTER?A=-s/2-_.x:w===go.RIGHT?A=-(s+_.x*2):A=0,Wo.x=A*v,C===ln.TOP?Wo.y=y-c-l:C===ln.CENTER?Wo.y=(y-c)/2-l:C===ln.BASELINE?Wo.y=-_.y-l:Wo.y=0,Wo.y=Wo.y*v,p.width=M,p.height=b,p._setTranslate(Wo),p._labelTranslate=X.clone(Wo,p._labelTranslate)),e.heightReference===Lt.CLAMP_TO_GROUND)for(h=0;h<d;++h){r=t[h];let I=r.billboard;g(I)&&(I._labelTranslate=X.clone(Wo,I._labelTranslate))}}function tZ(e,t){let n=t._glyphs;for(let r=0,o=n.length;r<o;++r)sF(e,n[r]);g(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,g(t._removeCallbackFunc)&&t._removeCallbackFunc(),st(t)}function zp(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new ig({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new ig({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=K.clone(K.WHITE),this.show=T(e.show,!0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.blendOption=T(e.blendOption,Nr.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(zp.prototype,{length:{get:function(){return this._labels.length}}});zp.prototype.add=function(e){let t=new dS(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t};zp.prototype.remove=function(e){if(g(e)&&e._labelCollection===this){let t=this._labels.indexOf(e);if(t!==-1)return this._labels.splice(t,1),tZ(this,e),!0}return!1};zp.prototype.removeAll=function(){let e=this._labels;for(let t=0,n=e.length;t<n;++t)tZ(this,e[t]);e.length=0};zp.prototype.contains=function(e){return g(e)&&e._labelCollection===this};zp.prototype.get=function(e){return this._labels[e]};zp.prototype.update=function(e){if(!this.show)return;let t=this._billboardCollection,n=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,n.modelMatrix=this.modelMatrix,n.debugShowBoundingVolume=this.debugShowBoundingVolume;let r=e.context;g(this._textureAtlas)||(this._textureAtlas=new B_({context:r}),t.textureAtlas=this._textureAtlas),g(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new B_({context:r,initialSize:aF}),n.textureAtlas=this._backgroundTextureAtlas,VTe(this._backgroundTextureAtlas));let o=this._labelsToUpdate.length;for(let s=0;s<o;++s){let u=this._labelsToUpdate[s];if(u.isDestroyed())continue;let l=u._glyphs.length;u._rebindAllGlyphs&&(qTe(this,u),u._rebindAllGlyphs=!1),u._repositionAllGlyphs&&(YTe(u),u._repositionAllGlyphs=!1);let c=u._glyphs.length-l;this._totalGlyphCount+=c}var a=this.blendOption;t.blendOption=a,n.blendOption=a,t._highlightColor=this._highlightColor,n._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,n.update(e),t.update(e)};zp.prototype.isDestroyed=function(){return!1};zp.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),st(this)};var sM=zp;function Sa(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.scaleByDistance,o=e.distanceDisplayCondition;g(n)&&(n=bt.clone(n)),g(r)&&(r=bt.clone(r)),g(o)&&(o=yn.clone(o)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._color=K.clone(T(e.color,K.WHITE)),this._outlineColor=K.clone(T(e.outlineColor,K.TRANSPARENT)),this._outlineWidth=T(e.outlineWidth,0),this._pixelSize=T(e.pixelSize,10),this._scaleByDistance=r,this._translucencyByDistance=n,this._distanceDisplayCondition=o,this._disableDepthTestDistance=T(e.disableDepthTestDistance,0),this._id=e.id,this._collection=T(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1,this._clusterId=void 0}var nZ=Sa.SHOW_INDEX=0,oZ=Sa.POSITION_INDEX=1,XTe=Sa.COLOR_INDEX=2,jTe=Sa.OUTLINE_COLOR_INDEX=3,KTe=Sa.OUTLINE_WIDTH_INDEX=4,ZTe=Sa.PIXEL_SIZE_INDEX=5,QTe=Sa.SCALE_BY_DISTANCE_INDEX=6,JTe=Sa.TRANSLUCENCY_BY_DISTANCE_INDEX=7,$Te=Sa.DISTANCE_DISPLAY_CONDITION_INDEX=8,eSe=Sa.DISABLE_DEPTH_DISTANCE_INDEX=9;Sa.NUMBER_OF_PROPERTIES=10;function _h(e,t){let n=e._pointPrimitiveCollection;g(n)&&(n._updatePointPrimitive(e,t),e._dirty=!0)}Object.defineProperties(Sa.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,_h(this,nZ))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),_h(this,oZ))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;bt.equals(t,e)||(this._scaleByDistance=bt.clone(e,t),_h(this,QTe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;bt.equals(t,e)||(this._translucencyByDistance=bt.clone(e,t),_h(this,JTe))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,_h(this,ZTe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),_h(this,XTe))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),_h(this,jTe))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,_h(this,KTe))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){yn.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=yn.clone(e,this._distanceDisplayCondition),_h(this,$Te))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,_h(this,eSe))}},id:{get:function(){return this._id},set:function(e){this._id=e,g(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,_h(this,nZ))}}});Sa.prototype.getPickId=function(e){return g(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId};Sa.prototype._getActualPosition=function(){return this._actualPosition};Sa.prototype._setActualPosition=function(e){x.clone(e,this._actualPosition),_h(this,oZ)};var rZ=new Se;Sa._computeActualPosition=function(e,t,n){return t.mode===Ne.SCENE3D?e:(G.multiplyByPoint(n,e,rZ),Ff.computeActualWgs84Position(t,rZ))};var iZ=new Se;Sa._computeScreenSpacePosition=function(e,t,n,r){let o=G.multiplyByVector(e,Se.fromElements(t.x,t.y,t.z,1,iZ),iZ);return Ff.wgs84ToWindowCoordinates(n,o,r)};Sa.prototype.computeScreenSpacePosition=function(e,t){let n=this._pointPrimitiveCollection;g(t)||(t=new X);let r=n.modelMatrix,o=Sa._computeScreenSpacePosition(r,this._actualPosition,e,t);if(!!g(o))return o};Sa.getScreenSpaceBoundingBox=function(e,t,n){let r=e.pixelSize,o=r*.5,a=t.x-o,s=t.y-o,u=r,l=r;return g(n)||(n=new rn),n.x=a,n.y=s,n.width=u,n.height=l,n};Sa.prototype.equals=function(e){return this===e||g(e)&&this._id===e._id&&x.equals(this._position,e._position)&&K.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&K.equals(this._outlineColor,e._outlineColor)&&bt.equals(this._scaleByDistance,e._scaleByDistance)&&bt.equals(this._translucencyByDistance,e._translucencyByDistance)&&yn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};Sa.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var vl=Sa;var mS=`varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
void main()
{
float distanceToCenter = length(gl_PointCoord - vec2(0.5));
float maxDistance = max(0.0, 0.5 - v_pixelDistance);
float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);
float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);
vec4 color = mix(v_outlineColor, v_color, innerAlpha);
color.a *= wholeAlpha;
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
gl_FragColor = czm_gammaCorrect(color);
czm_writeLogDepth();
}
`;var aZ=`uniform float u_maxTotalPointSize;
attribute vec4 positionHighAndSize;
attribute vec4 positionLowAndOutline;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 scaleByDistance;
attribute vec3 distanceDisplayConditionAndDisableDepth;
varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
void main()
{
vec3 positionHigh = positionHighAndSize.xyz;
vec3 positionLow = positionLowAndOutline.xyz;
float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;
float totalSize = positionHighAndSize.w + outlineWidthBothSides;
float outlinePercent = outlineWidthBothSides / totalSize;
totalSize *= czm_pixelRatio;
totalSize += 3.0;
float temp = compressedAttribute1.x * SHIFT_RIGHT8;
float show = floor(temp);
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
vec4 color;
vec4 outlineColor;
vec4 pickColor;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute0.x * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute0.y * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = compressedAttribute0.w * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor = pickColor / 255.0;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);
#endif
totalSize = min(totalSize, u_maxTotalPointSize);
if (totalSize < 1.0)
{
positionEC.xyz = vec3(0.0);
totalSize = 1.0;
}
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency < 0.004)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = distanceDisplayConditionAndDisableDepth.x;
float farSq = distanceDisplayConditionAndDisableDepth.y;
if (lengthSq < nearSq || lengthSq > farSq) {
positionEC.xyz = vec3(0.0, 0.0, 1.0);
}
#endif
gl_Position = czm_projection * positionEC;
czm_vertexLogDepth();
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
czm_vertexLogDepth(vec4(czm_currentFrustum.x));
#endif
}
}
#endif
v_color = color;
v_color.a *= translucency * show;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency * show;
v_innerPercent = 1.0 - outlinePercent;
v_pixelDistance = 2.0 / totalSize;
gl_PointSize = totalSize * show;
gl_Position *= show;
v_pickColor = pickColor;
}
`;var tSe=vl.SHOW_INDEX,cF=vl.POSITION_INDEX,sZ=vl.COLOR_INDEX,nSe=vl.OUTLINE_COLOR_INDEX,rSe=vl.OUTLINE_WIDTH_INDEX,iSe=vl.PIXEL_SIZE_INDEX,uZ=vl.SCALE_BY_DISTANCE_INDEX,lZ=vl.TRANSLUCENCY_BY_DISTANCE_INDEX,cZ=vl.DISTANCE_DISPLAY_CONDITION_INDEX,oSe=vl.DISABLE_DEPTH_DISTANCE_INDEX,fF=vl.NUMBER_OF_PROPERTIES,Cl={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function yh(e){e=T(e,T.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(fF),this._maxPixelSize=1,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._modelMatrix=G.clone(G.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.blendOption=T(e.blendOption,Nr.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW];let t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}Object.defineProperties(yh.prototype,{length:{get:function(){return hF(this),this._pointPrimitives.length}}});function fZ(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}yh.prototype.add=function(e){let t=new vl(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t};yh.prototype.remove=function(e){return this.contains(e)?(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};yh.prototype.removeAll=function(){fZ(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0};function hF(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;let t=[],n=e._pointPrimitives,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];s&&(s._index=a++,t.push(s))}e._pointPrimitives=t}}yh.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]};yh.prototype.contains=function(e){return g(e)&&e._pointPrimitiveCollection===this};yh.prototype.get=function(e){return hF(this),this._pointPrimitives[e]};yh.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<fF;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function aSe(e,t,n){return new fC(e,[{index:Cl.positionHighAndSize,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[cF]},{index:Cl.positionLowAndShow,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[cF]},{index:Cl.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[sZ]},{index:Cl.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[lZ]},{index:Cl.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[uZ]},{index:Cl.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:ie.FLOAT,usage:n[cZ]}],t)}var uF=new ti;function hZ(e,t,n,r){let o=r._index,a=r._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,a,e._baseVolume),e._boundingVolumeDirty=!0),ti.fromCartesian(a,uF);let s=r.pixelSize,u=r.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,s+u);let l=n[Cl.positionHighAndSize],c=uF.high;l(o,c.x,c.y,c.z,s);let f=n[Cl.positionLowAndOutline],h=uF.low;f(o,h.x,h.y,h.z,u)}var uM=65536,gS=256;function dZ(e,t,n,r){let o=r._index,a=r.color,s=r.getPickId(t).color,u=r.outlineColor,l=K.floatToByte(a.red),c=K.floatToByte(a.green),f=K.floatToByte(a.blue),h=l*uM+c*gS+f;l=K.floatToByte(u.red),c=K.floatToByte(u.green),f=K.floatToByte(u.blue);let d=l*uM+c*gS+f;l=K.floatToByte(s.red),c=K.floatToByte(s.green),f=K.floatToByte(s.blue);let p=l*uM+c*gS+f,_=K.floatToByte(a.alpha)*uM+K.floatToByte(u.alpha)*gS+K.floatToByte(s.alpha),y=n[Cl.compressedAttribute0];y(o,h,d,p,_)}function pZ(e,t,n,r){let o=r._index,a=0,s=1,u=1,l=1,c=r.translucencyByDistance;g(c)&&(a=c.near,s=c.nearValue,u=c.far,l=c.farValue,(s!==1||l!==1)&&(e._shaderTranslucencyByDistance=!0));let f=r.show&&r.clusterShow;r.color.alpha===0&&r.outlineColor.alpha===0&&(f=!1),s=F.clamp(s,0,1),s=s===1?255:s*255|0;let h=(f?1:0)*gS+s;l=F.clamp(l,0,1),l=l===1?255:l*255|0;let d=l,p=n[Cl.compressedAttribute1];p(o,h,d,a,u)}function mZ(e,t,n,r){let o=r._index,a=n[Cl.scaleByDistance],s=0,u=1,l=1,c=1,f=r.scaleByDistance;g(f)&&(s=f.near,u=f.nearValue,l=f.far,c=f.farValue,(u!==1||c!==1)&&(e._shaderScaleByDistance=!0)),a(o,s,u,l,c)}function gZ(e,t,n,r){let o=r._index,a=n[Cl.distanceDisplayConditionAndDisableDepth],s=0,u=Number.MAX_VALUE,l=r.distanceDisplayCondition;g(l)&&(s=l.near,u=l.far,s*=s,u*=u,e._shaderDistanceDisplayCondition=!0);let c=r.disableDepthTestDistance;c*=c,c>0&&(e._shaderDisableDepthDistance=!0,c===Number.POSITIVE_INFINITY&&(c=-1)),a(o,s,u,c)}function sSe(e,t,n,r){hZ(e,t,n,r),dZ(e,t,n,r),pZ(e,t,n,r),mZ(e,t,n,r),gZ(e,t,n,r)}function lF(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=vl._computeActualPosition(f,r,o);g(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function uSe(e,t){let n=t.mode,r=e._pointPrimitives,o=e._pointPrimitivesToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!G.equals(a,e.modelMatrix)?(e._mode=n,G.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&lF(e,r,r.length,t,a,!0)):n===Ne.MORPHING?lF(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&lF(e,o,e._pointPrimitivesToUpdateIndex,t,a,!1)}function lSe(e,t,n){let o=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;n.radius+=o}var cSe=[];yh.prototype.update=function(e){if(hF(this),!this.show)return;this._maxTotalPointSize=Jt.maximumAliasedPointSize,uSe(this,e);let n=this._pointPrimitives.length,r=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,a=this._propertiesChanged,s=this._createVertexArray,u,l=e.context,c=e.passes,f=c.pick;if(s||!f&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let A=0;A<fF;++A)a[A]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=aSe(l,n,this._buffersUsage),u=this._vaf.writers;for(let A=0;A<n;++A){let D=this._pointPrimitives[A];D._dirty=!1,sSe(this,l,u,D)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){let A=cSe;A.length=0,(a[cF]||a[rSe]||a[iSe])&&A.push(hZ),(a[sZ]||a[nSe])&&A.push(dZ),(a[tSe]||a[lZ])&&A.push(pZ),a[uZ]&&A.push(mZ),(a[cZ]||a[oSe])&&A.push(gZ);let D=A.length;if(u=this._vaf.writers,o/n>.1){for(let P=0;P<o;++P){let M=r[P];M._dirty=!1;for(let b=0;b<D;++b)A[b](this,l,u,M)}this._vaf.commit()}else{for(let P=0;P<o;++P){let M=r[P];M._dirty=!1;for(let b=0;b<D;++b)A[b](this,l,u,M);this._vaf.subCommit(M._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>n*1.5&&(r.length=n),!g(this._vaf)||!g(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let h,d=G.IDENTITY;e.mode===Ne.SCENE3D?(d=this.modelMatrix,h=Ee.clone(this._baseVolumeWC,this._boundingVolume)):h=Ee.clone(this._baseVolume2D,this._boundingVolume),lSe(this,e,h);let p=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,p&&(this._blendOption===Nr.OPAQUE||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=fn.fromCache({depthTest:{enabled:!0,func:k.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===Nr.TRANSLUCENT||this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=fn.fromCache({depthTest:{enabled:!0,func:k.LEQUAL},depthMask:!1,blending:ka.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let _,y;(p||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(_=new Et({sources:[aZ]}),this._shaderScaleByDistance&&_.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&_.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&_.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&_.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT&&(y=new Et({defines:["OPAQUE"],sources:[mS]}),this._sp=wi.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:_,fragmentShaderSource:y,attributeLocations:Cl}),y=new Et({defines:["TRANSLUCENT"],sources:[mS]}),this._spTranslucent=wi.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:_,fragmentShaderSource:y,attributeLocations:Cl})),this._blendOption===Nr.OPAQUE&&(y=new Et({sources:[mS]}),this._sp=wi.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:_,fragmentShaderSource:y,attributeLocations:Cl})),this._blendOption===Nr.TRANSLUCENT&&(y=new Et({sources:[mS]}),this._spTranslucent=wi.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:_,fragmentShaderSource:y,attributeLocations:Cl})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);let v,w,C,E,S=e.commandList;if(c.render||f){let A=this._colorCommands,D=this._blendOption===Nr.OPAQUE,P=this._blendOption===Nr.OPAQUE_AND_TRANSLUCENT;v=this._vaf.va,w=v.length,A.length=w;let M=P?w*2:w;for(E=0;E<M;++E){let b=D||P&&E%2===0;C=A[E],g(C)||(C=A[E]=new $t),C.primitiveType=sn.POINTS,C.pass=b||!P?en.OPAQUE:en.TRANSLUCENT,C.owner=this;let O=P?Math.floor(E/2):E;C.boundingVolume=h,C.modelMatrix=d,C.shaderProgram=b?this._sp:this._spTranslucent,C.uniformMap=this._uniforms,C.vertexArray=v[O].va,C.renderState=b?this._rsOpaque:this._rsTranslucent,C.debugShowBoundingVolume=this.debugShowBoundingVolume,C.pickId="v_pickColor",S.push(C)}}};yh.prototype.isDestroyed=function(){return!1};yh.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),fZ(this._pointPrimitives),st(this)};var lM=yh;function yS(e,t,n,r,o,a){if(o-r<=n)return;let s=r+o>>1;_Z(e,t,s,r,o,a%2),yS(e,t,n,r,s-1,a+1),yS(e,t,n,s+1,o,a+1)}function _Z(e,t,n,r,o,a){for(;o>r;){if(o-r>600){let c=o-r+1,f=n-r+1,h=Math.log(c),d=.5*Math.exp(2*h/3),p=.5*Math.sqrt(h*d*(c-d)/c)*(f-c/2<0?-1:1),_=Math.max(r,Math.floor(n-f*d/c+p)),y=Math.min(o,Math.floor(n+(c-f)*d/c+p));_Z(e,t,n,_,y,a)}let s=t[2*n+a],u=r,l=o;for(_S(e,t,r,n),t[2*o+a]>s&&_S(e,t,r,o);u<l;){for(_S(e,t,u,l),u++,l--;t[2*u+a]<s;)u++;for(;t[2*l+a]>s;)l--}t[2*r+a]===s?_S(e,t,r,l):(l++,_S(e,t,l,o)),l<=n&&(r=l+1),n<=l&&(o=l-1)}}function _S(e,t,n,r){dF(e,n,r),dF(t,2*n,2*r),dF(t,2*n+1,2*r+1)}function dF(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function pF(e,t,n,r,o,a,s){let u=[0,e.length-1,0],l=[],c,f;for(;u.length;){let h=u.pop(),d=u.pop(),p=u.pop();if(d-p<=s){for(let v=p;v<=d;v++)c=t[2*v],f=t[2*v+1],c>=n&&c<=o&&f>=r&&f<=a&&l.push(e[v]);continue}let _=Math.floor((p+d)/2);c=t[2*_],f=t[2*_+1],c>=n&&c<=o&&f>=r&&f<=a&&l.push(e[_]);let y=(h+1)%2;(h===0?n<=c:r<=f)&&(u.push(p),u.push(_-1),u.push(y)),(h===0?o>=c:a>=f)&&(u.push(_+1),u.push(d),u.push(y))}return l}function mF(e,t,n,r,o,a){let s=[0,e.length-1,0],u=[],l=o*o;for(;s.length;){let c=s.pop(),f=s.pop(),h=s.pop();if(f-h<=a){for(let v=h;v<=f;v++)yZ(t[2*v],t[2*v+1],n,r)<=l&&u.push(e[v]);continue}let d=Math.floor((h+f)/2),p=t[2*d],_=t[2*d+1];yZ(p,_,n,r)<=l&&u.push(e[d]);let y=(c+1)%2;(c===0?n-o<=p:r-o<=_)&&(s.push(h),s.push(d-1),s.push(y)),(c===0?n+o>=p:r+o>=_)&&(s.push(d+1),s.push(f),s.push(y))}return u}function yZ(e,t,n,r){let o=e-n,a=t-r;return o*o+a*a}var fSe=e=>e[0],hSe=e=>e[1],Ny=class{constructor(t,n=fSe,r=hSe,o=64,a=Float64Array){this.nodeSize=o,this.points=t;let s=t.length<65536?Uint16Array:Uint32Array,u=this.ids=new s(t.length),l=this.coords=new a(t.length*2);for(let c=0;c<t.length;c++)u[c]=c,l[2*c]=n(t[c]),l[2*c+1]=r(t[c]);yS(u,l,o,0,u.length-1,0)}range(t,n,r,o){return pF(this.ids,this.coords,t,n,r,o,this.nodeSize)}within(t,n,r){return mF(this.ids,this.coords,t,n,r,this.nodeSize)}};function bd(e){e=T(e,T.EMPTY_OBJECT),this._enabled=T(e.enabled,!1),this._pixelRange=T(e.pixelRange,80),this._minimumClusterSize=T(e.minimumClusterSize,2),this._clusterBillboards=T(e.clusterBillboards,!0),this._clusterLabels=T(e.clusterLabels,!0),this._clusterPoints=T(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new xe,this.show=T(e.show,!0)}function CZ(e){return e.coord.x}function xZ(e){return e.coord.y}function vZ(e,t){e.x-=t,e.y-=t,e.width+=t*2,e.height+=t*2}var dSe=new rn;function _F(e,t,n,r,o){if(g(e._labelCollection)&&r._clusterLabels?o=dS.getScreenSpaceBoundingBox(e,t,o):g(e._billboardCollection)&&r._clusterBillboards?o=lo.getScreenSpaceBoundingBox(e,t,o):g(e._pointPrimitiveCollection)&&r._clusterPoints&&(o=vl.getScreenSpaceBoundingBox(e,t,o)),vZ(o,n),r._clusterLabels&&!g(e._labelCollection)&&g(e.id)&&EZ(r,e.id.id)&&g(e.id._label)){let a=r._collectionIndicesByEntity[e.id.id].labelIndex,s=r._labelCollection.get(a),u=dS.getScreenSpaceBoundingBox(s,t,dSe);vZ(u,n),o=rn.union(o,u,o)}return o}function wZ(e,t){if(e.clusterShow=!0,!g(e._labelCollection)&&g(e.id)&&EZ(t,e.id.id)&&g(e.id._label)){let n=t._collectionIndicesByEntity[e.id.id].labelIndex,r=t._labelCollection.get(n);r.clusterShow=!0}}function yF(e,t,n,r){let o={billboard:r._clusterBillboardCollection.add(),label:r._clusterLabelCollection.add(),point:r._clusterPointCollection.add()};o.billboard.show=!1,o.point.show=!1,o.label.show=!0,o.label.text=t.toLocaleString(),o.label.id=n,o.billboard.position=o.label.position=o.point.position=e,r._clusterEvent.raiseEvent(n,o)}function EZ(e,t){return g(e)&&g(e._collectionIndicesByEntity[t])&&g(e._collectionIndicesByEntity[t].labelIndex)}function vS(e,t,n,r,o){if(!g(e))return;let a=e.length;for(let s=0;s<a;++s){let u=e.get(s);if(u.clusterShow=!1,!u.show||o._scene.mode===Ne.SCENE3D&&!r.isPointVisible(u.position))continue;let l=o._clusterLabels&&g(u._labelCollection),c=o._clusterBillboards&&g(u.id._billboard),f=o._clusterPoints&&g(u.id._point);if(l&&(f||c))continue;let h=u.computeScreenSpacePosition(n);!g(h)||t.push({index:s,collection:e,clustered:!1,coord:h})}}var pSe=new rn,TZ=new rn,SZ=new rn;function mSe(e){let t=e._scene,n=e._labelCollection,r=e._billboardCollection,o=e._pointCollection;if(!g(n)&&!g(r)&&!g(o)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let a=e._clusterLabelCollection,s=e._clusterBillboardCollection,u=e._clusterPointCollection;g(a)?a.removeAll():a=e._clusterLabelCollection=new sM({scene:t}),g(s)?s.removeAll():s=e._clusterBillboardCollection=new ig({scene:t}),g(u)?u.removeAll():u=e._clusterPointCollection=new lM;let l=e._pixelRange,c=e._minimumClusterSize,f=[],h=t.camera.positionCartographic.height,d=t.mapProjection.ellipsoid,p=t.camera.positionWC,_=new jB(d,p),y=[],v=t.canvas.clientWidth,w=t.canvas.clientHeight;for(let z=0;z<r.length;++z){let U=r.get(z);U&&!(U._id instanceof us)&&y.push(U)}y.length>0&&e._dataSource.billbordsInited&&y.forEach(function(z){let U=Ff.wgs84ToWindowCoordinates(e._scene,z.position),Q=!0;U&&U.x>=0&&U.y>=0&&U.x<=v&&U.y<=w&&(Q=!1),Q&&r.remove(z)});let C=[],E=0;e._totalWeight=0;for(let z=0;z<r.length;++z){let U=r.get(z);if(U.show=!0,U._id&&U._id instanceof us&&E<=20){let Q=Ff.wgs84ToWindowCoordinates(e._scene,U.position);Q&&Q.x>=0&&Q.y>=0&&Q.x<=v&&Q.y<=w&&(E++,(U._id._weight>1||U._id._weight===1)&&C.push(z))}}if(e._dataSource.billbordsInited&&delete e._dataSource.billbordsInited,E<=20)for(let z=0;z<C.length;z++){let U=C[z];r.get(U).show=!1;for(let Q=0;Q<r.get(U).id._clusterChildren.length;Q++){let ne=r.get(U).id._clusterChildren[Q],se=!1;for(let pe=0;pe<y.length;pe++)y[pe].id===ne&&(se=!0);if(se)continue;let de=e._dataSource._clusterChildren[ne];g(de)&&r.add({id:ne,_weight:1,position:x.fromDegrees(de.x,de.y,0),image:de.imageUrl,_detail:!0})}}let S=[];if(e._clusterLabels&&vS(n,S,t,_,e),e._clusterBillboards){let z=r.length;for(let U=0;U<z;++U){let Q=r.get(U);Q&&Q._id&&Q._id._clusterChildren&&!Q.show||(Q.clusterShow=!1,S.push({index:U,collection:r,clustered:!1,coord:new X(Q.position.x,Q.position.y)}))}}e._clusterPoints&&vS(o,S,t,_,e);let A,D,P,M,b,O,m,I,L,R,N,B=new Ny(S,CZ,xZ,64,Float32Array),V=S.length;for(A=0;A<V;++A){let z=S[A];if(z.clustered)continue;let U=t.camera.positionCartographic.height*l;z.clustered=!0,R=z.collection,N=z.index;let Q=R.get(N);if(!Q.id)continue;P={x:z.coord.x-U,y:z.coord.y-U,width:U*2,height:U*2};let ne=rn.clone(P,TZ);M=B.range(P.x,P.y,P.x+P.width,P.y+P.height),b=M.length;let se=x.clone(Q.position),de=0;for(Q.id._weight>0&&(de=Q.id._weight),L=1,I=[Q.id],D=0;D<b;++D)if(O=M[D],m=S[O],!m.clustered){let pe=m.collection.get(m.index),ve=_F(pe,m.coord,l,e,SZ);x.add(pe.position,se,se),rn.union(ne,ve,ne),++L,pe.id._weight>0&&(de+=pe.id._weight),I.push(pe.id)}if(de>c||L>=c){let pe=x.multiplyByScalar(se,1/L,se);for(yF(pe,L,I,e),f.push({position:pe,width:ne.width,height:ne.height,minimumWidth:P.width,minimumHeight:P.height}),D=0;D<b;++D)S[M[D]].clustered=!0}else wZ(Q,e)}a.length===0&&(a.destroy(),e._clusterLabelCollection=void 0),s.length===0&&(s.destroy(),e._clusterBillboardCollection=void 0),u.length===0&&(u.destroy(),e._clusterPointCollection=void 0),e._previousClusters=f,e._previousHeight=h}function gSe(e){return function(t){if(g(t)&&t<.05||!e.enabled)return;if(g(e._dataSource)&&g(e._dataSource._clusterType)){mSe(e);return}let n=e._scene,r=e._labelCollection,o=e._billboardCollection,a=e._pointCollection;if(!g(r)&&!g(o)&&!g(a)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let s=e._clusterLabelCollection,u=e._clusterBillboardCollection,l=e._clusterPointCollection;g(s)?s.removeAll():s=e._clusterLabelCollection=new sM({scene:n}),g(u)?u.removeAll():u=e._clusterBillboardCollection=new ig({scene:n}),g(l)?l.removeAll():l=e._clusterPointCollection=new lM;let c=e._pixelRange,f=e._minimumClusterSize,h=e._previousClusters,d=[],p=e._previousHeight,_=n.camera.positionCartographic.height,y=n.mapProjection.ellipsoid,v=n.camera.positionWC,w=new jB(y,v),C=[];e._clusterLabels&&vS(r,C,n,w,e),e._clusterBillboards&&vS(o,C,n,w,e),e._clusterPoints&&vS(a,C,n,w,e);let E,S,A,D,P,M,b,O,m,I,L,R,N=new Ny(C,CZ,xZ,64,Int32Array);if(_<p)for(A=h.length,E=0;E<A;++E){let B=h[E];if(!w.isPointVisible(B.position))continue;let V=lo._computeScreenSpacePosition(G.IDENTITY,B.position,x.ZERO,X.ZERO,n);if(!g(V))continue;let z=1-_/p,U=B.width=B.width*z,Q=B.height=B.height*z;U=Math.max(U,B.minimumWidth),Q=Math.max(Q,B.minimumHeight);let ne=V.x-U*.5,se=V.y-Q*.5,de=V.x+U,pe=V.y+Q;for(P=N.range(ne,se,de,pe),M=P.length,I=0,m=[],S=0;S<M;++S)b=P[S],O=C[b],O.clustered||(++I,L=O.collection,R=O.index,m.push(L.get(R).id));if(I>=f)for(yF(B.position,I,m,e),d.push(B),S=0;S<M;++S)C[P[S]].clustered=!0}for(A=C.length,E=0;E<A;++E){let B=C[E];if(B.clustered)continue;B.clustered=!0,L=B.collection,R=B.index;let V=L.get(R);D=_F(V,B.coord,c,e,pSe);let z=rn.clone(D,TZ);P=N.range(D.x,D.y,D.x+D.width,D.y+D.height),M=P.length;let U=x.clone(V.position);for(I=1,m=[V.id],S=0;S<M;++S)if(b=P[S],O=C[b],!O.clustered){let Q=O.collection.get(O.index),ne=_F(Q,O.coord,c,e,SZ);x.add(Q.position,U,U),rn.union(z,ne,z),++I,m.push(Q.id)}if(I>=f){let Q=x.multiplyByScalar(U,1/I,U);for(yF(Q,I,m,e),d.push({position:Q,width:z.width,height:z.height,minimumWidth:D.width,minimumHeight:D.height}),S=0;S<M;++S)C[P[S]].clustered=!0}else wZ(V,e)}s.length===0&&(s.destroy(),e._clusterLabelCollection=void 0),u.length===0&&(u.destroy(),e._clusterBillboardCollection=void 0),l.length===0&&(l.destroy(),e._clusterPointCollection=void 0),e._previousClusters=d,e._previousHeight=_}}bd.prototype._initialize=function(e){this._scene=e,this._scene.camera.isRotating=!0;let t=gSe(this);this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)};Object.defineProperties(bd.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}});function vF(e,t,n,r){return function(o){let a=this[e];g(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let s=this._collectionIndicesByEntity[o.id];if(g(s)||(s=this._collectionIndicesByEntity[o.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),g(a)&&g(s[r]))return a.get(s[r]);g(a)||(a=this[e]=new t({scene:this._scene}));let u,l,c=this[n];c.length>0?(u=c.pop(),l=a.get(u)):(l=a.add(),u=a.length-1),s[r]=u;let f=this;return Promise.resolve().then(function(){f._clusterDirty=!0}),l}}function CF(e,t){let n=e._collectionIndicesByEntity[t];!g(n.billboardIndex)&&!g(n.labelIndex)&&!g(n.pointIndex)&&delete e._collectionIndicesByEntity[t]}bd.prototype.getLabel=vF("_labelCollection",sM,"_unusedLabelIndices","labelIndex");bd.prototype.removeLabel=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!g(this._labelCollection)||!g(t)||!g(t.labelIndex))return;let n=t.labelIndex;t.labelIndex=void 0,CF(this,e.id);let r=this._labelCollection.get(n);r.show=!1,r.text="",r.id=void 0,this._unusedLabelIndices.push(n),this._clusterDirty=!0};bd.prototype.getBillboard=vF("_billboardCollection",ig,"_unusedBillboardIndices","billboardIndex");bd.prototype.removeBillboard=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!g(this._billboardCollection)||!g(t)||!g(t.billboardIndex))return;let n=t.billboardIndex;t.billboardIndex=void 0,CF(this,e.id);let r=this._billboardCollection.get(n);r.id=void 0,r.show=!1,r.image=void 0,this._unusedBillboardIndices.push(n),this._clusterDirty=!0};bd.prototype.getPoint=vF("_pointCollection",lM,"_unusedPointIndices","pointIndex");bd.prototype.removePoint=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!g(this._pointCollection)||!g(t)||!g(t.pointIndex))return;let n=t.pointIndex;t.pointIndex=void 0,CF(this,e.id);let r=this._pointCollection.get(n);r.show=!1,r.id=void 0,this._unusedPointIndices.push(n),this._clusterDirty=!0};function gF(e){if(!g(e))return;let t=e.length;for(let n=0;n<t;++n)e.get(n).clusterShow=!0}function _Se(e){e.enabled||(g(e._clusterLabelCollection)&&e._clusterLabelCollection.destroy(),g(e._clusterBillboardCollection)&&e._clusterBillboardCollection.destroy(),g(e._clusterPointCollection)&&e._clusterPointCollection.destroy(),e._clusterLabelCollection=void 0,e._clusterBillboardCollection=void 0,e._clusterPointCollection=void 0,gF(e._labelCollection),gF(e._billboardCollection),gF(e._pointCollection))}bd.prototype.update=function(e){if(!this.show)return;let t;g(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),g(this._billboardCollection)&&this._billboardCollection.length>0&&!g(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,_Se(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),g(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),g(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),g(this._clusterPointCollection)&&this._clusterPointCollection.update(e),g(this._labelCollection)&&this._labelCollection.update(e),g(this._billboardCollection)&&this._billboardCollection.update(e),g(this._pointCollection)&&this._pointCollection.update(e)};bd.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),g(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var AZ=bd;var bZ={id:void 0};function CS(e){if(e._firing){e._refire=!0;return}if(e._suspendCount===0){let t=e._addedEntities,n=e._removedEntities,r=e._changedEntities;if(r.length!==0||t.length!==0||n.length!==0){e._firing=!0;do{e._refire=!1;let o=t.values.slice(0),a=n.values.slice(0),s=r.values.slice(0);t.removeAll(),n.removeAll(),r.removeAll(),e._collectionChanged.raiseEvent(e,o,a,s)}while(e._refire);e._firing=!1}}}function xl(e){this._owner=e,this._entities=new Ga,this._addedEntities=new Ga,this._removedEntities=new Ga,this._changedEntities=new Ga,this._suspendCount=0,this._collectionChanged=new xe,this._id=Ci(),this._show=!0,this._firing=!1,this._refire=!1}xl.prototype.suspendEvents=function(){this._suspendCount++};xl.prototype.resumeEvents=function(){this._suspendCount--,CS(this)};Object.defineProperties(xl.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(e===this._show)return;this.suspendEvents();let t,n=[],r=this._entities.values,o=r.length;for(t=0;t<o;t++)n.push(r[t].isShowing);for(this._show=e,t=0;t<o;t++){let a=n[t],s=r[t];a!==s.isShowing&&s.definitionChanged.raiseEvent(s,"isShowing",s.isShowing,a)}this.resumeEvents()}},owner:{get:function(){return this._owner}}});xl.prototype.computeAvailability=function(){let e=ys.MAXIMUM_VALUE,t=ys.MINIMUM_VALUE,n=this._entities.values;for(let r=0,o=n.length;r<o;r++){let s=n[r].availability;if(g(s)){let u=s.start,l=s.stop;ce.lessThan(u,e)&&!u.equals(ys.MINIMUM_VALUE)&&(e=u),ce.greaterThan(l,t)&&!l.equals(ys.MAXIMUM_VALUE)&&(t=l)}}return ys.MAXIMUM_VALUE.equals(e)&&(e=ys.MINIMUM_VALUE),ys.MINIMUM_VALUE.equals(t)&&(t=ys.MAXIMUM_VALUE),new ii({start:e,stop:t})};xl.prototype.add=function(e){e instanceof us||(e=new us(e));let t=e.id,n=this._entities;if(n.contains(t))throw new at(`An entity with id ${t} already exists in this collection.`);return e.entityCollection=this,n.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(xl.prototype._onEntityDefinitionChanged,this),CS(this),e};xl.prototype.remove=function(e){return g(e)?this.removeById(e.id):!1};xl.prototype.contains=function(e){return this._entities.get(e.id)===e};xl.prototype.removeById=function(e){if(!g(e))return!1;let n=this._entities.get(e);return this._entities.remove(e)?(this._addedEntities.remove(e)||(this._removedEntities.set(e,n),this._changedEntities.remove(e)),this._entities.remove(e),n.definitionChanged.removeEventListener(xl.prototype._onEntityDefinitionChanged,this),CS(this),!0):!1};xl.prototype.removeAll=function(){let e=this._entities,t=e.length,n=e.values,r=this._addedEntities,o=this._removedEntities;for(let a=0;a<t;a++){let s=n[a],u=s.id,l=r.get(u);g(l)||(s.definitionChanged.removeEventListener(xl.prototype._onEntityDefinitionChanged,this),o.set(u,s))}e.removeAll(),r.removeAll(),this._changedEntities.removeAll(),CS(this)};xl.prototype.getById=function(e){return this._entities.get(e)};xl.prototype.getOrCreateEntity=function(e){let t=this._entities.get(e);return g(t)||(bZ.id=e,t=new us(bZ),this.add(t)),t};xl.prototype._onEntityDefinitionChanged=function(e){let t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),CS(this)};var IZ=xl;function cM(){Le.throwInstantiationError()}Object.defineProperties(cM.prototype,{name:{get:Le.throwInstantiationError},clock:{get:Le.throwInstantiationError},entities:{get:Le.throwInstantiationError},isLoading:{get:Le.throwInstantiationError},changedEvent:{get:Le.throwInstantiationError},errorEvent:{get:Le.throwInstantiationError},loadingEvent:{get:Le.throwInstantiationError},show:{get:Le.throwInstantiationError},clustering:{get:Le.throwInstantiationError}});cM.prototype.update=function(e){Le.throwInstantiationError()};cM.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var xS=cM;function By(){this._definitionChanged=new xe,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(By.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:cd("startTime"),stopTime:cd("stopTime"),currentTime:cd("currentTime"),clockRange:cd("clockRange"),clockStep:cd("clockStep"),multiplier:cd("multiplier")});By.prototype.clone=function(e){return g(e)||(e=new By),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e};By.prototype.equals=function(e){return this===e||g(e)&&ce.equals(this.startTime,e.startTime)&&ce.equals(this.stopTime,e.stopTime)&&ce.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier};By.prototype.merge=function(e){this.startTime=T(this.startTime,e.startTime),this.stopTime=T(this.stopTime,e.stopTime),this.currentTime=T(this.currentTime,e.currentTime),this.clockRange=T(this.clockRange,e.clockRange),this.clockStep=T(this.clockStep,e.clockStep),this.multiplier=T(this.multiplier,e.multiplier)};By.prototype.getValue=function(e){return g(e)||(e=new Rx),e.startTime=T(this.startTime,e.startTime),e.stopTime=T(this.stopTime,e.stopTime),e.currentTime=T(this.currentTime,e.currentTime),e.clockRange=T(this.clockRange,e.clockRange),e.multiplier=T(this.multiplier,e.multiplier),e.clockStep=T(this.clockStep,e.clockStep),e};var xF=By;function wF(){this._removalFunctions=[]}wF.prototype.add=function(e,t,n){let r=e.addEventListener(t,n);this._removalFunctions.push(r);let o=this;return function(){r();let a=o._removalFunctions;a.splice(a.indexOf(r),1)}};wF.prototype.removeAll=function(){let e=this._removalFunctions;for(let t=0,n=e.length;t<n;++t)e[t]();e.length=0};var Bx=wF;function z0(e){this._value=void 0,this._definitionChanged=new xe,this._eventHelper=new Bx,this.setValue(e)}Object.defineProperties(z0.prototype,{isConstant:{get:function(){let e=this._value;if(!g(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!_e.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});z0.prototype.getValue=function(e,t){let n=this._value;if(!g(n))return;let r=n.length;g(t)||(t=new Array(r));let o=0,a=0;for(;o<r;){let u=this._value[o].getValue(e,t[o]);g(u)&&(t[a]=u,a++),o++}return t.length=a,t};z0.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),g(e)){this._value=e.slice();let n=e.length;for(let r=0;r<n;r++){let o=e[r];g(o)&&t.add(o.definitionChanged,z0.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};z0.prototype.equals=function(e){return this===e||e instanceof z0&&_e.arrayEquals(this._value,e._value)};z0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var DZ=z0;var ySe=K.WHITE,vSe=K.BLACK,CSe=new X(2,2);function Fx(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(Fx.prototype,{isConstant:{get:function(){return _e.isConstant(this._evenColor)&&_e.isConstant(this._oddColor)&&_e.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:Z("evenColor"),oddColor:Z("oddColor"),repeat:Z("repeat")});Fx.prototype.getType=function(e){return"Checkerboard"};Fx.prototype.getValue=function(e,t){return g(t)||(t={}),t.lightColor=_e.getValueOrClonedDefault(this._evenColor,e,ySe,t.lightColor),t.darkColor=_e.getValueOrClonedDefault(this._oddColor,e,vSe,t.darkColor),t.repeat=_e.getValueOrDefault(this._repeat,e,CSe),t};Fx.prototype.equals=function(e){return this===e||e instanceof Fx&&_e.equals(this._evenColor,e._evenColor)&&_e.equals(this._oddColor,e._oddColor)&&_e.equals(this._repeat,e._repeat)};var EF=Fx;var xSe={HORIZONTAL:0,VERTICAL:1},V0=Object.freeze(xSe);var wSe=V0.HORIZONTAL,ESe=K.WHITE,TSe=K.BLACK,SSe=0,ASe=1;function zx(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(zx.prototype,{isConstant:{get:function(){return _e.isConstant(this._orientation)&&_e.isConstant(this._evenColor)&&_e.isConstant(this._oddColor)&&_e.isConstant(this._offset)&&_e.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:Z("orientation"),evenColor:Z("evenColor"),oddColor:Z("oddColor"),offset:Z("offset"),repeat:Z("repeat")});zx.prototype.getType=function(e){return"Stripe"};zx.prototype.getValue=function(e,t){return g(t)||(t={}),t.horizontal=_e.getValueOrDefault(this._orientation,e,wSe)===V0.HORIZONTAL,t.evenColor=_e.getValueOrClonedDefault(this._evenColor,e,ESe,t.evenColor),t.oddColor=_e.getValueOrClonedDefault(this._oddColor,e,TSe,t.oddColor),t.offset=_e.getValueOrDefault(this._offset,e,SSe),t.repeat=_e.getValueOrDefault(this._repeat,e,ASe),t};zx.prototype.equals=function(e){return this===e||e instanceof zx&&_e.equals(this._orientation,e._orientation)&&_e.equals(this._evenColor,e._evenColor)&&_e.equals(this._oddColor,e._oddColor)&&_e.equals(this._offset,e._offset)&&_e.equals(this._repeat,e._repeat)};var TF=zx;function Vx(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(Vx.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color")});Vx.prototype.getType=function(e){return"PolylineArrow"};Vx.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t};Vx.prototype.equals=function(e){return this===e||e instanceof Vx&&_e.equals(this._color,e._color)};var SF=Vx;function kx(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.trailImage=e.trailImage,this.duration=e.duration||3e3,this.isFlow=T(e.isFlow,!0),this._time=new Date().getTime(),this.isTranslucent=function(){return!0}}Object.defineProperties(kx.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color")});kx.prototype.getType=function(e){return"PolylineTrailLink"};kx.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t.image=this.trailImage,this.isFlow?t.time=(new Date().getTime()-this._time)%this.duration/this.duration:t.time=0,t};kx.prototype.equals=function(e){return this===e||e instanceof kx&&_e.equals(this._color,e._color)};var PZ=kx;function ag(e,t){this._value=void 0,this._definitionChanged=new xe,this._eventHelper=new Bx,this._referenceFrame=T(t,za.FIXED),this.setValue(e)}Object.defineProperties(ag.prototype,{isConstant:{get:function(){let e=this._value;if(!g(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!_e.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});ag.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,za.FIXED,t)};ag.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._value;if(!g(r))return;let o=r.length;g(n)||(n=new Array(o));let a=0,s=0;for(;a<o;){let l=r[a].getValueInReferenceFrame(e,t,n[a]);g(l)&&(n[s]=l,s++),a++}return n.length=s,n};ag.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),g(e)){this._value=e.slice();let n=e.length;for(let r=0;r<n;r++){let o=e[r];g(o)&&t.add(o.definitionChanged,ag.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};ag.prototype.equals=function(e){return this===e||e instanceof ag&&this._referenceFrame===e._referenceFrame&&_e.arrayEquals(this._value,e._value)};ag.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var fM=ag;var bSe=K.WHITE,ISe=.25,DSe=1;function Gx(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(Gx.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)&&_e.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color"),glowPower:Z("glowPower"),taperPower:Z("taperPower")});Gx.prototype.getType=function(e){return"PolylineGlow"};Gx.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,bSe,t.color),t.glowPower=_e.getValueOrDefault(this._glowPower,e,ISe,t.glowPower),t.taperPower=_e.getValueOrDefault(this._taperPower,e,DSe,t.taperPower),t};Gx.prototype.equals=function(e){return this===e||e instanceof Gx&&_e.equals(this._color,e._color)&&_e.equals(this._glowPower,e._glowPower)&&_e.equals(this._taperPower,e._taperPower)};var AF=Gx;var PSe=K.WHITE,MSe=K.TRANSPARENT,LSe=16,RSe=255;function Ux(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(Ux.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)&&_e.isConstant(this._gapColor)&&_e.isConstant(this._dashLength)&&_e.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color"),gapColor:Z("gapColor"),dashLength:Z("dashLength"),dashPattern:Z("dashPattern")});Ux.prototype.getType=function(e){return"PolylineDash"};Ux.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,PSe,t.color),t.gapColor=_e.getValueOrClonedDefault(this._gapColor,e,MSe,t.gapColor),t.dashLength=_e.getValueOrDefault(this._dashLength,e,LSe,t.dashLength),t.dashPattern=_e.getValueOrDefault(this._dashPattern,e,RSe,t.dashPattern),t};Ux.prototype.equals=function(e){return this===e||e instanceof Ux&&_e.equals(this._color,e._color)&&_e.equals(this._gapColor,e._gapColor)&&_e.equals(this._dashLength,e._dashLength)&&_e.equals(this._dashPattern,e._dashPattern)};var bF=Ux;var OSe=K.WHITE,NSe=.1,BSe=new X(8,8),FSe=new X(0,0),zSe=new X(1,1);function Hx(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(Hx.prototype,{isConstant:{get:function(){return _e.isConstant(this._color)&&_e.isConstant(this._cellAlpha)&&_e.isConstant(this._lineCount)&&_e.isConstant(this._lineThickness)&&_e.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Z("color"),cellAlpha:Z("cellAlpha"),lineCount:Z("lineCount"),lineThickness:Z("lineThickness"),lineOffset:Z("lineOffset")});Hx.prototype.getType=function(e){return"Grid"};Hx.prototype.getValue=function(e,t){return g(t)||(t={}),t.color=_e.getValueOrClonedDefault(this._color,e,OSe,t.color),t.cellAlpha=_e.getValueOrDefault(this._cellAlpha,e,NSe),t.lineCount=_e.getValueOrClonedDefault(this._lineCount,e,BSe,t.lineCount),t.lineThickness=_e.getValueOrClonedDefault(this._lineThickness,e,zSe,t.lineThickness),t.lineOffset=_e.getValueOrClonedDefault(this._lineOffset,e,FSe,t.lineOffset),t};Hx.prototype.equals=function(e){return this===e||e instanceof Hx&&_e.equals(this._color,e._color)&&_e.equals(this._cellAlpha,e._cellAlpha)&&_e.equals(this._lineCount,e._lineCount)&&_e.equals(this._lineThickness,e._lineThickness)&&_e.equals(this._lineOffset,e._lineOffset)};var IF=Hx;function VSe(e,t,n,r){function o(){n.raiseEvent(e)}let a=[];t.removeAll();let s=r.length;for(let u=0;u<s;u++){let l=r.get(u);g(l.data)&&a.indexOf(l.data)===-1&&t.add(l.data.definitionChanged,o)}}function Fy(){this._eventHelper=new Bx,this._definitionChanged=new xe,this._intervals=new rg,this._intervals.changedEvent.addEventListener(Fy.prototype._intervalsChanged,this)}Object.defineProperties(Fy.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});Fy.prototype.getValue=function(e,t){let n=this._intervals.findDataForIntervalContainingDate(e);if(g(n))return n.getValue(e,t)};Fy.prototype.equals=function(e){return this===e||e instanceof Fy&&this._intervals.equals(e._intervals,_e.equals)};Fy.prototype._intervalsChanged=function(){VSe(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var vh=Fy;function k0(){this._definitionChanged=new xe,this._composite=new vh,this._composite.definitionChanged.addEventListener(k0.prototype._raiseDefinitionChanged,this)}Object.defineProperties(k0.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});k0.prototype.getType=function(e){let t=this._composite._intervals.findDataForIntervalContainingDate(e);if(g(t))return t.getType(e)};k0.prototype.getValue=function(e,t){let n=this._composite._intervals.findDataForIntervalContainingDate(e);if(g(n))return n.getValue(e,t)};k0.prototype.equals=function(e){return this===e||e instanceof k0&&this._composite.equals(e._composite,_e.equals)};k0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var DF=k0;var MZ={packedLength:1,pack:function(e,t,n){n=T(n,0),t[n]=e},unpack:function(e,t,n){return t=T(t,0),e[t]}};function LZ(e,t,n){let r,o=e.length,a=n.length,s=o+a;if(e.length=s,o!==t){let u=o-1;for(r=s-1;r>=t;r--)e[r]=e[u--]}for(r=0;r<a;r++)e[t++]=n[r]}function RZ(e,t){return e instanceof ce?e:typeof e=="string"?ce.fromIso8601(e):ce.addSeconds(t,e,new ce)}var PF=[],MF=[];function hM(e,t,n,r,o){let a=0,s,u,l,c,f,h;for(;a<r.length;){f=RZ(r[a],e),l=Lu(t,f,ce.compare);let d=0,p=0;if(l<0){for(l=~l,c=l*o,u=void 0,h=t[l];a<r.length&&(f=RZ(r[a],e),!(g(u)&&ce.compare(u,f)>=0||g(h)&&ce.compare(f,h)>=0));){for(PF[d++]=f,a=a+1,s=0;s<o;s++)MF[p++]=r[a],a=a+1;u=f}d>0&&(MF.length=p,LZ(n,c,MF),PF.length=d,LZ(t,l,PF))}else{for(s=0;s<o;s++)a++,n[l*o+s]=r[a];a++}}}function Id(e,t){let n=e;n===Number&&(n=MZ);let r=n.packedLength,o=T(n.packedInterpolationLength,r),a=0,s;if(g(t)){let u=t.length;s=new Array(u);for(let l=0;l<u;l++){let c=t[l];c===Number&&(c=MZ);let f=c.packedLength;r+=f,o+=T(c.packedInterpolationLength,f),s[l]=c}a=u}this._type=e,this._innerType=n,this._interpolationDegree=1,this._interpolationAlgorithm=tM,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=r,this._packedInterpolationLength=o,this._updateTableLength=!0,this._interpolationResult=new Array(o),this._definitionChanged=new xe,this._derivativeTypes=t,this._innerDerivativeTypes=s,this._inputOrder=a,this._forwardExtrapolationType=Np.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=Np.NONE,this._backwardExtrapolationDuration=0}Object.defineProperties(Id.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}});Id.prototype.getValue=function(e,t){let n=this._times,r=n.length;if(r===0)return;let o,a=this._innerType,s=this._values,u=Lu(n,e,ce.compare);if(u<0){if(u=~u,u===0){let S=n[u];if(o=this._backwardExtrapolationDuration,this._backwardExtrapolationType===Np.NONE||o!==0&&ce.secondsDifference(S,e)>o)return;if(this._backwardExtrapolationType===Np.HOLD)return a.unpack(s,0,t)}if(u>=r){u=r-1;let S=n[u];if(o=this._forwardExtrapolationDuration,this._forwardExtrapolationType===Np.NONE||o!==0&&ce.secondsDifference(e,S)>o)return;if(this._forwardExtrapolationType===Np.HOLD)return u=r-1,a.unpack(s,u*a.packedLength,t)}let l=this._xTable,c=this._yTable,f=this._interpolationAlgorithm,h=this._packedInterpolationLength,d=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;let S=Math.min(f.getRequiredDataPoints(this._interpolationDegree,d),r);S!==this._numberOfPoints&&(this._numberOfPoints=S,l.length=S,c.length=S*h)}let p=this._numberOfPoints-1;if(p<1)return;let _=0,y=r-1;if(y-_+1>=p+1){let S=u-(p/2|0)-1;S<_&&(S=_);let A=S+p;A>y&&(A=y,S=A-p,S<_&&(S=_)),_=S,y=A}let w=y-_+1;for(let S=0;S<w;++S)l[S]=ce.secondsDifference(n[_+S],n[y]);if(g(a.convertPackedArrayForInterpolation))a.convertPackedArrayForInterpolation(s,_,y,c);else{let S=0,A=this._packedLength,D=_*A,P=(y+1)*A;for(;D<P;)c[S]=s[D],D++,S++}let C=ce.secondsDifference(e,n[y]),E;if(d===0||!g(f.interpolate))E=f.interpolateOrderZero(C,l,c,h,this._interpolationResult);else{let S=Math.floor(h/(d+1));E=f.interpolate(C,l,c,S,d,d,this._interpolationResult)}return g(a.unpackInterpolationResult)?a.unpackInterpolationResult(E,s,_,y,t):a.unpack(E,0,t)}return a.unpack(s,u*this._packedLength,t)};Id.prototype.setInterpolationOptions=function(e){if(!g(e))return;let t=!1,n=e.interpolationAlgorithm,r=e.interpolationDegree;g(n)&&this._interpolationAlgorithm!==n&&(this._interpolationAlgorithm=n,t=!0),g(r)&&this._interpolationDegree!==r&&(this._interpolationDegree=r,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))};Id.prototype.addSample=function(e,t,n){let r=this._innerDerivativeTypes,o=g(r),a=this._innerType,s=[];if(s.push(e),a.pack(t,s,s.length),o){let u=r.length;for(let l=0;l<u;l++)r[l].pack(n[l],s,s.length)}hM(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Id.prototype.addSamples=function(e,t,n){let r=this._innerDerivativeTypes,o=g(r),a=this._innerType,s=e.length,u=[];for(let l=0;l<s;l++)if(u.push(e[l]),a.pack(t[l],u,u.length),o){let c=n[l],f=r.length;for(let h=0;h<f;h++)r[h].pack(c[h],u,u.length)}hM(void 0,this._times,this._values,u,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Id.prototype.addSamplesPackedArray=function(e,t){hM(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Id.prototype.removeSample=function(e){let t=Lu(this._times,e,ce.compare);return t<0?!1:(OZ(this,t,1),!0)};function OZ(e,t,n){let r=e._packedLength;e._times.splice(t,n),e._values.splice(t*r,n*r),e._updateTableLength=!0,e._definitionChanged.raiseEvent(e)}Id.prototype.removeSamples=function(e){let t=this._times,n=Lu(t,e.start,ce.compare);n<0?n=~n:e.isStartIncluded||++n;let r=Lu(t,e.stop,ce.compare);r<0?r=~r:e.isStopIncluded&&++r,OZ(this,n,r-n)};Id.prototype.equals=function(e){if(this===e)return!0;if(!g(e)||this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;let t=this._derivativeTypes,n=g(t),r=e._derivativeTypes,o=g(r);if(n!==o)return!1;let a,s;if(n){if(s=t.length,s!==r.length)return!1;for(a=0;a<s;a++)if(t[a]!==r[a])return!1}let u=this._times,l=e._times;if(s=u.length,s!==l.length)return!1;for(a=0;a<s;a++)if(!ce.equals(u[a],l[a]))return!1;let c=this._values,f=e._values;for(s=c.length,a=0;a<s;a++)if(c[a]!==f[a])return!1;return!0};Id._mergeNewSamples=hM;var sg=Id;function Ch(e,t){t=T(t,0);let n;if(t>0){n=new Array(t);for(let r=0;r<t;r++)n[r]=x}this._numberOfDerivatives=t,this._property=new sg(x,n),this._definitionChanged=new xe,this._referenceFrame=T(e,za.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}Object.defineProperties(Ch.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});Ch.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,za.FIXED,t)};Ch.prototype.getValueInReferenceFrame=function(e,t,n){if(n=this._property.getValue(e,n),g(n))return zC.convertToReferenceFrame(e,n,this._referenceFrame,t,n)};Ch.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)};Ch.prototype.addSample=function(e,t,n){let r=this._numberOfDerivatives;this._property.addSample(e,t,n)};Ch.prototype.addSamples=function(e,t,n){this._property.addSamples(e,t,n)};Ch.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)};Ch.prototype.removeSample=function(e){return this._property.removeSample(e)};Ch.prototype.removeSamples=function(e){this._property.removeSamples(e)};Ch.prototype.equals=function(e){return this===e||e instanceof Ch&&_e.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};var qx=Ch;function zy(){this._definitionChanged=new xe,this._intervals=new rg,this._intervals.changedEvent.addEventListener(zy.prototype._intervalsChanged,this)}Object.defineProperties(zy.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});zy.prototype.getValue=function(e,t){let n=this._intervals.findDataForIntervalContainingDate(e);return g(n)&&typeof n.clone=="function"?n.clone(t):n};zy.prototype.equals=function(e){return this===e||e instanceof zy&&this._intervals.equals(e._intervals,_e.equals)};zy.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var dM=zy;function G0(e){this._referenceFrame=T(e,za.FIXED),this._definitionChanged=new xe,this._composite=new vh,this._composite.definitionChanged.addEventListener(G0.prototype._raiseDefinitionChanged,this)}Object.defineProperties(G0.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});G0.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,za.FIXED,t)};G0.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._composite._intervals.findDataForIntervalContainingDate(e);if(g(r))return r.getValueInReferenceFrame(e,t,n)};G0.prototype.equals=function(e){return this===e||e instanceof G0&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,_e.equals)};G0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var ug=G0;function Vy(e){let t=e._targetProperty;if(!g(t)){let n=e._targetEntity;if(!g(n)){if(n=e._targetCollection.getById(e._targetId),!g(n)){e._targetEntity=e._targetProperty=void 0;return}n.definitionChanged.addEventListener(gf.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=n}let r=e._targetPropertyNames;t=e._targetEntity;for(let o=0,a=r.length;o<a&&g(t);++o)t=t[r[o]];e._targetProperty=t}return t}function gf(e,t,n){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=n,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new xe,e.collectionChanged.addEventListener(gf.prototype._onCollectionChanged,this)}Object.defineProperties(gf.prototype,{isConstant:{get:function(){return _e.isConstant(Vy(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){let e=Vy(this);return g(e)?e.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Vy(this)}}});gf.fromString=function(e,t){let n,r=[],o=!0,a=!1,s="";for(let u=0;u<t.length;++u){let l=t.charAt(u);a?(s+=l,a=!1):l==="\\"?a=!0:o&&l==="#"?(n=s,o=!1,s=""):!o&&l==="."?(r.push(s),s=""):s+=l}return r.push(s),new gf(e,n,r)};gf.prototype.getValue=function(e,t){let n=Vy(this);return g(n)?n.getValue(e,t):void 0};gf.prototype.getValueInReferenceFrame=function(e,t,n){let r=Vy(this);return g(r)?r.getValueInReferenceFrame(e,t,n):void 0};gf.prototype.getType=function(e){let t=Vy(this);return g(t)?t.getType(e):void 0};gf.prototype.equals=function(e){if(this===e)return!0;let t=this._targetPropertyNames,n=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==n.length)return!1;let r=this._targetPropertyNames.length;for(let o=0;o<r;o++)if(t[o]!==n[o])return!1;return!0};gf.prototype._onTargetEntityDefinitionChanged=function(e,t,n,r){g(this._targetProperty)&&this._targetPropertyNames[0]===t&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))};gf.prototype._onCollectionChanged=function(e,t,n){let r=this._targetEntity;g(r)&&n.indexOf(r)!==-1?(r.definitionChanged.removeEventListener(gf.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):g(r)||(r=Vy(this),g(r)&&this._definitionChanged.raiseEvent(this))};var NZ=gf;var kSe={packedLength:1,pack:function(e,t,n){return n=T(n,0),t[n]=e,t},unpack:function(e,t,n){return t=T(t,0),e[t]},convertPackedArrayForInterpolation:function(e,t,n,r){g(r)||(r=[]),t=T(t,0),n=T(n,e.length);let o;for(let a=0,s=n-t+1;a<s;a++){let u=e[t+a];a===0||Math.abs(o-u)<Math.PI?r[a]=u:r[a]=u-F.TWO_PI,o=u}},unpackInterpolationResult:function(e,t,n,r,o){return o=e[0],o<0?o+F.TWO_PI:o}},lg=kSe;function Wx(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new xe,this._normalize=T(t,!0),this.position=e}Object.defineProperties(Wx.prototype,{isConstant:{get:function(){return _e.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){let t=this._position;t!==e&&(g(t)&&this._subscription(),this._position=e,g(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var GSe=new x,BZ=new x,FZ=new ce,LF=1/60;Wx.prototype.getValue=function(e,t){return this._getValue(e,t)};Wx.prototype._getValue=function(e,t,n){g(t)||(t=new x);let r=this._position;if(_e.isConstant(r))return this._normalize?void 0:x.clone(x.ZERO,t);let o=r.getValue(e,GSe),a=r.getValue(ce.addSeconds(e,LF,FZ),BZ);if(!g(o)||!g(a)&&(a=o,o=r.getValue(ce.addSeconds(e,-LF,FZ),BZ),!g(o)))return;if(x.equals(o,a))return this._normalize?void 0:x.clone(x.ZERO,t);g(n)&&o.clone(n);let s=x.subtract(a,o,t);return this._normalize?x.normalize(s,t):x.divideByScalar(s,LF,t)};Wx.prototype.equals=function(e){return this===e||e instanceof Wx&&_e.equals(this._position,e._position)};var pM=Wx;function U0(e){this._definitionChanged=new xe,this._intervals=new rg,this._intervals.changedEvent.addEventListener(U0.prototype._intervalsChanged,this),this._referenceFrame=T(e,za.FIXED)}Object.defineProperties(U0.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});U0.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,za.FIXED,t)};U0.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._intervals.findDataForIntervalContainingDate(e);if(g(r))return zC.convertToReferenceFrame(e,r,this._referenceFrame,t,n)};U0.prototype.equals=function(e){return this===e||e instanceof U0&&this._intervals.equals(e._intervals,_e.equals)&&this._referenceFrame===e._referenceFrame};U0.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var mM=U0;function wS(e,t){this._velocityVectorProperty=new pM(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new xe,this.ellipsoid=T(t,Ge.WGS84);let n=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){n._definitionChanged.raiseEvent(n)})}Object.defineProperties(wS.prototype,{isConstant:{get:function(){return _e.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var zZ=new x,USe=new x,VZ=new te;wS.prototype.getValue=function(e,t){let n=this._velocityVectorProperty._getValue(e,USe,zZ);if(!!g(n))return Cn.rotationMatrixFromPositionVelocity(zZ,n,this._ellipsoid,VZ),je.fromRotationMatrix(VZ,t)};wS.prototype.equals=function(e){return this===e||e instanceof wS&&_e.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};var kZ=wS;var ES={HIGHLIGHT:0,REPLACE:1,MIX:2};ES.getColorBlend=function(e,t){if(e===ES.HIGHLIGHT)return 0;if(e===ES.REPLACE)return 1;if(e===ES.MIX)return F.clamp(t,F.EPSILON4,1)};var cg=Object.freeze(ES);function HSe(e,t){return g(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0}var Yo=HSe;function et(){}et.objectLegacy=function(e,t){if(g(e)){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],o=t(r,n);if(g(o))return o}}};et.object=function(e,t){if(g(e)){let n=e.length;for(let r=0;r<n;r++){let o=e[r],a=t(o,r);if(g(a))return a}}};et.topLevel=function(e,t,n){let r=e[t];return g(r)&&!Array.isArray(r)?et.objectLegacy(r,n):et.object(r,n)};et.accessor=function(e,t){return et.topLevel(e,"accessors",t)};et.accessorWithSemantic=function(e,t,n){let r={};return et.mesh(e,function(o){return et.meshPrimitive(o,function(a){let s=et.meshPrimitiveAttribute(a,function(u,l){if(l.indexOf(t)===0&&!g(r[u])){r[u]=!0;let c=n(u);if(g(c))return c}});return g(s)?s:et.meshPrimitiveTarget(a,function(u){return et.meshPrimitiveTargetAttribute(u,function(l,c){if(c.indexOf(t)===0&&!g(r[l])){r[l]=!0;let f=n(l);if(g(f))return f}})})})})};et.accessorContainingVertexAttributeData=function(e,t){let n={};return et.mesh(e,function(r){return et.meshPrimitive(r,function(o){let a=et.meshPrimitiveAttribute(o,function(s){if(!g(n[s])){n[s]=!0;let u=t(s);if(g(u))return u}});return g(a)?a:et.meshPrimitiveTarget(o,function(s){return et.meshPrimitiveTargetAttribute(s,function(u){if(!g(n[u])){n[u]=!0;let l=t(u);if(g(l))return l}})})})})};et.accessorContainingIndexData=function(e,t){let n={};return et.mesh(e,function(r){return et.meshPrimitive(r,function(o){let a=o.indices;if(g(a)&&!g(n[a])){n[a]=!0;let s=t(a);if(g(s))return s}})})};et.animation=function(e,t){return et.topLevel(e,"animations",t)};et.animationChannel=function(e,t){let n=e.channels;return et.object(n,t)};et.animationSampler=function(e,t){let n=e.samplers;return et.object(n,t)};et.buffer=function(e,t){return et.topLevel(e,"buffers",t)};et.bufferView=function(e,t){return et.topLevel(e,"bufferViews",t)};et.camera=function(e,t){return et.topLevel(e,"cameras",t)};et.image=function(e,t){return et.topLevel(e,"images",t)};et.material=function(e,t){return et.topLevel(e,"materials",t)};et.materialValue=function(e,t){let n=e.values;g(e.extensions)&&g(e.extensions.KHR_techniques_webgl)&&(n=e.extensions.KHR_techniques_webgl.values);for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(g(o))return o}};et.mesh=function(e,t){return et.topLevel(e,"meshes",t)};et.meshPrimitive=function(e,t){let n=e.primitives;if(g(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o],s=t(a,o);if(g(s))return s}}};et.meshPrimitiveAttribute=function(e,t){let n=e.attributes;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(g(o))return o}};et.meshPrimitiveTarget=function(e,t){let n=e.targets;if(g(n)){let r=n.length;for(let o=0;o<r;++o){let a=t(n[o],o);if(g(a))return a}}};et.meshPrimitiveTargetAttribute=function(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],o=t(r,n);if(g(o))return o}};et.node=function(e,t){return et.topLevel(e,"nodes",t)};et.nodeInTree=function(e,t,n){let r=e.nodes;if(g(r)){let o=t.length;for(let a=0;a<o;a++){let s=t[a],u=r[s];if(g(u)){let l=n(u,s);if(g(l))return l;let c=u.children;if(g(c)&&(l=et.nodeInTree(e,c,n),g(l)))return l}}}};et.nodeInScene=function(e,t,n){let r=t.nodes;if(g(r))return et.nodeInTree(e,r,n)};et.program=function(e,t){return Yo(e,"KHR_techniques_webgl")?et.object(e.extensions.KHR_techniques_webgl.programs,t):et.topLevel(e,"programs",t)};et.sampler=function(e,t){return et.topLevel(e,"samplers",t)};et.scene=function(e,t){return et.topLevel(e,"scenes",t)};et.shader=function(e,t){return Yo(e,"KHR_techniques_webgl")?et.object(e.extensions.KHR_techniques_webgl.shaders,t):et.topLevel(e,"shaders",t)};et.skin=function(e,t){return et.topLevel(e,"skins",t)};et.skinJoint=function(e,t){let n=e.joints;if(g(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o],s=t(a);if(g(s))return s}}};et.techniqueAttribute=function(e,t){let n=e.attributes;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(g(o))return o}};et.techniqueUniform=function(e,t){let n=e.uniforms;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(g(o))return o}};et.techniqueParameter=function(e,t){let n=e.parameters;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(g(o))return o}};et.technique=function(e,t){return Yo(e,"KHR_techniques_webgl")?et.object(e.extensions.KHR_techniques_webgl.techniques,t):et.topLevel(e,"techniques",t)};et.texture=function(e,t){return et.topLevel(e,"textures",t)};var re=et;function qSe(e){return re.shader(e,function(t){gM(t)}),re.buffer(e,function(t){gM(t)}),re.image(e,function(t){gM(t)}),gM(e),e}function gM(e){e.extras=g(e.extras)?e.extras:{},e.extras._pipeline=g(e.extras._pipeline)?e.extras._pipeline:{}}var TS=qSe;function WSe(e,t){let n=e.extensionsRequired;if(g(n)){let r=n.indexOf(t);r>=0&&n.splice(r,1),n.length===0&&delete e.extensionsRequired}}var GZ=WSe;function YSe(e,t){let n=e.extensionsUsed;if(g(n)){let r=n.indexOf(t);r>=0&&n.splice(r,1),GZ(e,t),n.length===0&&delete e.extensionsUsed}}var UZ=YSe;function H0(e,t,n){return t=T(t,0),n=T(n,e.byteLength-t),e=e.subarray(t,t+n),H0.decode(e)}H0.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)};H0.decodeWithFromCharCode=function(e){let t="",n=XSe(e),r=n.length;for(let o=0;o<r;++o){let a=n[o];a<=65535?t+=String.fromCharCode(a):(a-=65536,t+=String.fromCharCode((a>>10)+55296,(a&1023)+56320))}return t};function SS(e,t,n){return t<=e&&e<=n}function XSe(e){let t=0,n=0,r=0,o=128,a=191,s=[],u=e.length;for(let l=0;l<u;++l){let c=e[l];if(r===0){if(SS(c,0,127)){s.push(c);continue}if(SS(c,194,223)){r=1,t=c&31;continue}if(SS(c,224,239)){c===224&&(o=160),c===237&&(a=159),r=2,t=c&15;continue}if(SS(c,240,244)){c===240&&(o=144),c===244&&(a=143),r=3,t=c&7;continue}throw new at("String decoding failed.")}if(!SS(c,o,a)){t=r=n=0,o=128,a=191,--l;continue}o=128,a=191,t=t<<6|c&63,++n,n===r&&(s.push(t),t=r=n=0)}return s}typeof TextDecoder<"u"?H0.decode=H0.decodeWithTextDecoder:H0.decode=H0.decodeWithFromCharCode;var Zl=H0;function jSe(e,t){return t=T(t,0),Zl(e,t,Math.min(4,e.length))}var _M=jSe;var KSe=4;function ZSe(e){if(_M(e)!=="glTF")throw new at("File is not valid binary glTF");let n=HZ(e,0,5),r=n[1];if(r!==1&&r!==2)throw new at("Binary glTF version is not 1 or 2");return r===1?QSe(e,n):JSe(e,n)}function HZ(e,t,n){let r=new DataView(e.buffer),o=new Array(n);for(let a=0;a<n;++a)o[a]=r.getUint32(e.byteOffset+t+a*KSe,!0);return o}function QSe(e,t){let n=t[2],r=t[3];if(t[4]!==0)throw new at("Binary glTF scene format is not JSON");let a=20,s=a+r,u=Zl(e,a,r),l=JSON.parse(u);TS(l);let c=e.subarray(s,n),f=l.buffers;if(g(f)&&Object.keys(f).length>0){let h=T(f.binary_glTF,f.KHR_binary_glTF);g(h)&&(h.extras._pipeline.source=c,delete h.uri)}return UZ(l,"KHR_binary_glTF"),l}function JSe(e,t){let n=t[2],r=12,o,a;for(;r<n;){let s=HZ(e,r,2),u=s[0],l=s[1];r+=8;let c=e.subarray(r,r+u);if(r+=u,l===1313821514){let f=Zl(c);o=JSON.parse(f),TS(o)}else l===5130562&&(a=c)}if(g(o)&&g(a)){let s=o.buffers;if(g(s)&&s.length>0){let u=s[0];u.extras._pipeline.source=a}}return o}var Yx=ZSe;function qZ(e){e=T(e,T.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.canceled=e.canceled,this.persists=T(e.persists,!1),this.pass=en.COMPUTE,this.owner=e.owner}qZ.prototype.execute=function(e){e.execute(this)};var RF=qZ;var WZ=`varying vec2 v_textureCoordinates;
uniform float originalSize;
uniform sampler2D texture0;
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform sampler2D texture3;
uniform sampler2D texture4;
uniform sampler2D texture5;
const float yMipLevel1 = 1.0 - (1.0 / pow(2.0, 1.0));
const float yMipLevel2 = 1.0 - (1.0 / pow(2.0, 2.0));
const float yMipLevel3 = 1.0 - (1.0 / pow(2.0, 3.0));
const float yMipLevel4 = 1.0 - (1.0 / pow(2.0, 4.0));
void main()
{
vec2 uv = v_textureCoordinates;
vec2 textureSize = vec2(originalSize * 1.5 + 2.0, originalSize);
vec2 pixel = 1.0 / textureSize;
float mipLevel = 0.0;
if (uv.x - pixel.x > (textureSize.y / textureSize.x))
{
mipLevel = 1.0;
if (uv.y - pixel.y > yMipLevel1)
{
mipLevel = 2.0;
if (uv.y - pixel.y * 3.0 > yMipLevel2)
{
mipLevel = 3.0;
if (uv.y - pixel.y * 5.0 > yMipLevel3)
{
mipLevel = 4.0;
if (uv.y - pixel.y * 7.0 > yMipLevel4)
{
mipLevel = 5.0;
}
}
}
}
}
if (mipLevel > 0.0)
{
float scale = pow(2.0, mipLevel);
uv.y -= (pixel.y * (mipLevel - 1.0) * 2.0);
uv.x *= ((textureSize.x - 2.0) / textureSize.y);
uv.x -= 1.0 + pixel.x;
uv.y -= (1.0 - (1.0 / pow(2.0, mipLevel - 1.0)));
uv *= scale;
}
else
{
uv.x *= (textureSize.x / textureSize.y);
}
if(mipLevel == 0.0)
{
gl_FragColor = texture2D(texture0, uv);
}
else if(mipLevel == 1.0)
{
gl_FragColor = texture2D(texture1, uv);
}
else if(mipLevel == 2.0)
{
gl_FragColor = texture2D(texture2, uv);
}
else if(mipLevel == 3.0)
{
gl_FragColor = texture2D(texture3, uv);
}
else if(mipLevel == 4.0)
{
gl_FragColor = texture2D(texture4, uv);
}
else if(mipLevel == 5.0)
{
gl_FragColor = texture2D(texture5, uv);
}
else
{
gl_FragColor = vec4(0.0);
}
}
`;var YZ=`varying vec3 v_cubeMapCoordinates;
uniform samplerCube cubeMap;
void main()
{
vec4 rgba = textureCube(cubeMap, v_cubeMapCoordinates);
#ifdef RGBA_NORMALIZED
gl_FragColor = vec4(rgba.rgb, 1.0);
#else
float m = rgba.a * 16.0;
vec3 r = rgba.rgb * m;
gl_FragColor = vec4(r * r, 1.0);
#endif
}
`;var XZ=`attribute vec4 position;
attribute vec3 cubeMapCoordinates;
varying vec3 v_cubeMapCoordinates;
void main()
{
gl_Position = position;
v_cubeMapCoordinates = cubeMapCoordinates;
}
`;function ky(e){this._url=e,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1;let t=this;this._readyPromise=new Promise((n,r)=>{t._completeLoadFromCache=o=>{OF(this),this._texture=o,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0,n()},t._failLoad=o=>{r(o)},t._completeLoad=()=>{this._ready=!0,n()}})}Object.defineProperties(ky.prototype,{url:{get:function(){return this._url}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});ky.isSupported=function(e){return e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat};var $Se=new x(1,0,0),eAe=new x(0,0,1),tAe=new x(-1,0,0),nAe=new x(0,0,-1),yM=new x(0,1,0),rAe=new x(0,-1,0),ZZ=[yM,tAe,eAe,rAe,$Se,yM,nAe,yM,yM],QZ=ZZ.length,JZ=new Float32Array(QZ*3),jZ=0;for(let e=0;e<QZ;++e,jZ+=3)x.pack(ZZ[e],JZ,jZ);var iAe=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),oAe=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function aAe(e){let t=Ui.createVertexBuffer({context:e,typedArray:iAe,usage:We.STATIC_DRAW}),n=Ui.createVertexBuffer({context:e,typedArray:JZ,usage:We.STATIC_DRAW}),r=Ui.createIndexBuffer({context:e,typedArray:oAe,usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT}),o=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:ie.FLOAT},{index:1,vertexBuffer:n,componentsPerAttribute:3,componentDatatype:ie.FLOAT}];return new $h({context:e,attributes:o,indexBuffer:r})}function KZ(e){return function(){return e}}function OF(e){e._va=e._va&&e._va.destroy(),e._sp=e._sp&&e._sp.destroy();let t,n,r=e._cubeMaps;if(g(r))for(n=r.length,t=0;t<n;++t)r[t].destroy();let o=e._mipTextures;if(g(o))for(n=o.length,t=0;t<n;++t)o[t].destroy();e._va=void 0,e._sp=void 0,e._cubeMaps=void 0,e._cubeMapBuffers=void 0,e._mipTextures=void 0}ky.prototype.update=function(e){let t=e.context;if(!ky.isSupported(t)||(g(this._texture)&&g(this._va)&&OF(this),g(this._texture)))return;if(!g(this._texture)&&!this._loading){let p=e.context.textureCache.getTexture(this._url);g(p)&&this._completeLoadFromCache(p)}let n=this._cubeMapBuffers;if(!g(n)&&!this._loading){let p=this;Lm(this._url).then(function(_){p._cubeMapBuffers=_,p._loading=!1}).catch(function(_){p._failLoad(_)}),this._loading=!0}if(!g(this._cubeMapBuffers))return;let r=[],o=n[0].positiveX.pixelDatatype;g(o)?r.push("RGBA_NORMALIZED"):o=t.halfFloatingPointTexture?xt.HALF_FLOAT:xt.FLOAT;let a=qt.RGBA,s=new Et({defines:r,sources:[YZ]});this._va=aAe(t),this._sp=wi.fromCache({context:t,vertexShaderSource:XZ,fragmentShaderSource:s,attributeLocations:{position:0,cubeMapCoordinates:1}});let u=Math.min(n.length,6);this._maximumMipmapLevel=u-1;let l=this._cubeMaps=new Array(u),c=this._mipTextures=new Array(u),f=n[0].positiveX.width*2,h={originalSize:function(){return f}};for(let p=0;p<u;++p){let _=n[p].positiveY;n[p].positiveY=n[p].negativeY,n[p].negativeY=_;let y=l[p]=new TE({context:t,source:n[p],pixelDatatype:o}),v=l[p].width*2,w=c[p]=new na({context:t,width:v,height:v,pixelDatatype:o,pixelFormat:a}),C=new RF({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:KZ(y)},outputTexture:w,persists:!0,owner:this});e.commandList.push(C),h[`texture${p}`]=KZ(w)}this._texture=new na({context:t,width:f*1.5+2,height:f,pixelDatatype:o,pixelFormat:a}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture);let d=new RF({fragmentShaderSource:WZ,uniformMap:h,outputTexture:this._texture,persists:!1,owner:this});e.commandList.push(d),this._completeLoad()};ky.prototype.isDestroyed=function(){return!1};ky.prototype.destroy=function(){return OF(this),this._texture=this._texture&&this._texture.destroy(),st(this)};var Xx=ky;function fg(e){e=T(e,T.EMPTY_OBJECT);let t=g(e.imageBasedLightingFactor)?X.clone(e.imageBasedLightingFactor):new X(1,1);this._imageBasedLightingFactor=t;let n=T(e.luminanceAtZenith,.2);this._luminanceAtZenith=n;let r=e.sphericalHarmonicCoefficients;this._sphericalHarmonicCoefficients=r,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapAtlas=void 0,this._specularEnvironmentMapAtlasDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousImageBasedLightingFactor=X.clone(t),this._previousLuminanceAtZenith=n,this._previousSphericalHarmonicCoefficients=r}Object.defineProperties(fg.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){this._previousImageBasedLightingFactor=X.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=X.clone(e,this._imageBasedLightingFactor)}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){this._previousLuminanceAtZenith=this._luminanceAtZenith,this._luminanceAtZenith=e}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){e!==this._specularEnvironmentMaps&&(this._specularEnvironmentMapAtlasDirty=this._specularEnvironmentMapAtlasDirty||e!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=e}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useSphericalHarmonicCoefficients:{get:function(){return g(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics}},specularEnvironmentMapAtlas:{get:function(){return this._specularEnvironmentMapAtlas}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return g(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps}}});function sAe(e,t){if(!!Xx.isSupported(t)){if(e._specularEnvironmentMapAtlas=e._specularEnvironmentMapAtlas&&e._specularEnvironmentMapAtlas.destroy(),g(e._specularEnvironmentMaps)){let n=new Xx(e._specularEnvironmentMaps);e._specularEnvironmentMapAtlas=n,n.readyPromise.then(function(){e._specularEnvironmentMapLoaded=!0}).catch(function(r){console.error(`Error loading specularEnvironmentMaps: ${r}`)})}e._shouldRegenerateShaders=!0}}fg.prototype.update=function(e){if(e.frameNumber===this._previousFrameNumber)return;this._previousFrameNumber=e.frameNumber;let t=e.context;e.brdfLutGenerator.update(e),this._shouldRegenerateShaders=!1;let n=this._imageBasedLightingFactor,r=this._previousImageBasedLightingFactor;X.equals(n,r)||(this._shouldRegenerateShaders=n.x>0&&r.x===0||n.x===0&&r.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||n.y>0&&r.y===0||n.y===0&&r.y>0,this._previousImageBasedLightingFactor=X.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._luminanceAtZenith!==this._previousLuminanceAtZenith&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||g(this._luminanceAtZenith)!==g(this._previousLuminanceAtZenith),this._previousLuminanceAtZenith=this._luminanceAtZenith),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||g(this._previousSphericalHarmonicCoefficients)!==g(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentMapAtlasDirty&&(sAe(this,t),this._specularEnvironmentMapAtlasDirty=!1),g(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e);let o=!g(this._specularEnvironmentMapAtlas)&&g(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,a=!g(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,s=!g(this._sphericalHarmonicCoefficients)&&g(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,u=!g(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||o||a||s||u,this._useDefaultSpecularMaps=!g(this._specularEnvironmentMapAtlas)&&g(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!g(this._sphericalHarmonicCoefficients)&&g(e.sphericalHarmonicCoefficients)};fg.prototype.isDestroyed=function(){return!1};fg.prototype.destroy=function(){return this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),st(this)};var FF=Xv($Z(),1);var uAe=0,zF={};function hg(e,t){let n,r=e;g(zF[r])?n=zF[r]:(n=uAe++,zF[r]=n),t=T(t,!1),this._id=n,this._html=e,this._showOnScreen=t,this._element=void 0}Object.defineProperties(hg.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen},set:function(e){this._showOnScreen=e}},element:{get:function(){if(!g(this._element)){let e=FF.default.sanitize(this._html),t=document.createElement("div");t._creditId=this._id,t.style.display="inline",t.innerHTML=e;let n=t.querySelectorAll("a");for(let r=0;r<n.length;r++)n[r].setAttribute("target","_blank");this._element=t}return this._element}}});hg.equals=function(e,t){return e===t||g(e)&&g(t)&&e._id===t._id&&e._showOnScreen===t._showOnScreen};hg.prototype.equals=function(e){return hg.equals(this,e)};hg.getIonCredit=function(e){let t=g(e.collapsible)&&!e.collapsible,n=new hg(e.html,t);return n._isIon=n.html.indexOf("ion-credit.png")!==-1,n};hg.clone=function(e){if(g(e))return new hg(e.html,e.showOnScreen)};var AS=hg;function lAe(e,t,n){return JSON.parse(Zl(e,t,n))}var eQ=lAe;function cAe(e){let t=e.uint8Array,n=e.format,r=e.request,o=T(e.flipY,!1),a=T(e.skipColorSpaceConversion,!1),s=new Blob([t],{type:n}),u;return vt.supportsImageBitmapOptions().then(function(l){return l?Promise.resolve(vt.createImageBitmapFromBlob(s,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:a})):(u=window.URL.createObjectURL(s),new vt({url:u,request:r}).fetchImage({flipY:o,skipColorSpaceConversion:a}))}).then(function(l){return g(u)&&window.URL.revokeObjectURL(u),l}).catch(function(l){return g(u)&&window.URL.revokeObjectURL(u),Promise.reject(l)})}var tQ=cAe;function fAe(e,t,n){if(n=T(n,!1),n){let r=e.indexOf(t);if(r>-1)return r}return e.push(t),e.length-1}var no=fAe;function hAe(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}var Ql=hAe;function dAe(e,t){let n=t.bufferView;if(g(n)){let r=e.bufferViews[n];if(g(r.byteStride)&&r.byteStride>0)return r.byteStride}return ie.getSizeInBytes(t.componentType)*Ql(t.type)}var Lc=dAe;function pAe(e){re.accessor(e,function(n){g(n.bufferView)&&(n.byteOffset=T(n.byteOffset,0))}),re.bufferView(e,function(n){g(n.buffer)&&(n.byteOffset=T(n.byteOffset,0))}),re.mesh(e,function(n){re.meshPrimitive(n,function(r){if(r.mode=T(r.mode,k.TRIANGLES),!g(r.material)){g(e.materials)||(e.materials=[]);let o={name:"default"};r.material=no(e.materials,o)}})}),re.accessorContainingVertexAttributeData(e,function(n){let r=e.accessors[n],o=r.bufferView;if(r.normalized=T(r.normalized,!1),g(o)){let a=e.bufferViews[o];a.byteStride=Lc(e,r),a.target=k.ARRAY_BUFFER}}),re.accessorContainingIndexData(e,function(n){let o=e.accessors[n].bufferView;if(g(o)){let a=e.bufferViews[o];a.target=k.ELEMENT_ARRAY_BUFFER}}),re.material(e,function(n){let r=T(n.extensions,T.EMPTY_OBJECT),o=r.KHR_materials_common;if(g(o)){let l=o.technique,c=g(o.values)?o.values:{};o.values=c,c.ambient=g(c.ambient)?c.ambient:[0,0,0,1],c.emission=g(c.emission)?c.emission:[0,0,0,1],c.transparency=T(c.transparency,1),c.transparent=T(c.transparent,!1),c.doubleSided=T(c.doubleSided,!1),l!=="CONSTANT"&&(c.diffuse=g(c.diffuse)?c.diffuse:[0,0,0,1],l!=="LAMBERT"&&(c.specular=g(c.specular)?c.specular:[0,0,0,1],c.shininess=T(c.shininess,0)));return}n.emissiveFactor=T(n.emissiveFactor,[0,0,0]),n.alphaMode=T(n.alphaMode,"OPAQUE"),n.doubleSided=T(n.doubleSided,!1),n.alphaMode==="MASK"&&(n.alphaCutoff=T(n.alphaCutoff,.5));let a=r.KHR_techniques_webgl;g(a)&&re.materialValue(n,function(l){g(l.index)&&Gy(l)}),Gy(n.emissiveTexture),Gy(n.normalTexture),Gy(n.occlusionTexture);let s=n.pbrMetallicRoughness;g(s)&&(s.baseColorFactor=T(s.baseColorFactor,[1,1,1,1]),s.metallicFactor=T(s.metallicFactor,1),s.roughnessFactor=T(s.roughnessFactor,1),Gy(s.baseColorTexture),Gy(s.metallicRoughnessTexture));let u=r.KHR_materials_pbrSpecularGlossiness;g(u)&&(u.diffuseFactor=T(u.diffuseFactor,[1,1,1,1]),u.specularFactor=T(u.specularFactor,[1,1,1]),u.glossinessFactor=T(u.glossinessFactor,1),Gy(u.specularGlossinessTexture))}),re.animation(e,function(n){re.animationSampler(n,function(r){r.interpolation=T(r.interpolation,"LINEAR")})});let t=mAe(e);return re.node(e,function(n,r){g(t[r])||g(n.translation)||g(n.rotation)||g(n.scale)?(n.translation=T(n.translation,[0,0,0]),n.rotation=T(n.rotation,[0,0,0,1]),n.scale=T(n.scale,[1,1,1])):n.matrix=T(n.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}),re.sampler(e,function(n){n.wrapS=T(n.wrapS,k.REPEAT),n.wrapT=T(n.wrapT,k.REPEAT)}),g(e.scenes)&&!g(e.scene)&&(e.scene=0),e}function mAe(e){let t={};return re.animation(e,function(n){re.animationChannel(n,function(r){let o=r.target,a=o.node,s=o.path;(s==="translation"||s==="rotation"||s==="scale")&&(t[a]=!0)})}),t}function Gy(e){g(e)&&(e.texCoord=T(e.texCoord,0))}var nQ=pAe;function gAe(e,t){let n=e.extensionsUsed;g(n)||(n=[],e.extensionsUsed=n),no(n,t,!0)}var q0=gAe;function _Ae(e){switch(e){case ie.BYTE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt8(n+s*o)};case ie.UNSIGNED_BYTE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint8(n+s*o)};case ie.SHORT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt16(n+s*o,!0)};case ie.UNSIGNED_SHORT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint16(n+s*o,!0)};case ie.INT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt32(n+s*o,!0)};case ie.UNSIGNED_INT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint32(n+s*o,!0)};case ie.FLOAT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getFloat32(n+s*o,!0)};case ie.DOUBLE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getFloat64(n+s*o,!0)}}}var vM=_Ae;function yAe(e,t){let n=e.bufferViews,r=e.buffers,o=t.bufferView,a=Ql(t.type);if(!g(t.bufferView))return{min:new Array(a).fill(0),max:new Array(a).fill(0)};let s=new Array(a).fill(Number.POSITIVE_INFINITY),u=new Array(a).fill(Number.NEGATIVE_INFINITY),l=n[o],c=l.buffer,h=r[c].extras._pipeline.source,d=t.count,p=Lc(e,t),_=t.byteOffset+l.byteOffset+h.byteOffset,y=t.componentType,v=ie.getSizeInBytes(y),w=new DataView(h.buffer),C=new Array(a),E=vM(y);for(let S=0;S<d;S++){E(w,_,a,v,C);for(let A=0;A<a;A++){let D=C[A];s[A]=Math.min(s[A],D),u[A]=Math.max(u[A],D)}_+=p}return{min:s,max:u}}var VF=yAe;var vAe=[k.FUNC_ADD,k.FUNC_ADD],CAe=[k.ONE,k.ZERO,k.ONE,k.ZERO];function rQ(e,t){let n=e.enable;return g(n)?n.indexOf(t)>-1:!1}var xAe=[k.ZERO,k.ONE,k.SRC_COLOR,k.ONE_MINUS_SRC_COLOR,k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.DST_ALPHA,k.ONE_MINUS_DST_ALPHA,k.DST_COLOR,k.ONE_MINUS_DST_COLOR];function wAe(e,t){if(!g(e))return t;for(let n=0;n<4;n++)if(xAe.indexOf(e[n])===-1)return t;return e}function EAe(e){let t={},n={},r=e.techniques;return g(r)&&(re.technique(e,function(o,a){let s=o.states;if(g(s)){let u=n[a]={};if(rQ(s,k.BLEND)){u.alphaMode="BLEND";let l=s.functions;g(l)&&(g(l.blendEquationSeparate)||g(l.blendFuncSeparate))&&(t[a]={blendEquation:T(l.blendEquationSeparate,vAe),blendFactors:wAe(l.blendFuncSeparate,CAe)})}rQ(s,k.CULL_FACE)||(u.doubleSided=!0),delete o.states}}),Object.keys(t).length>0&&(g(e.extensions)||(e.extensions={}),q0(e,"KHR_blend")),re.material(e,function(o){if(g(o.technique)){let a=n[o.technique];re.objectLegacy(a,function(u,l){o[l]=u});let s=t[o.technique];g(s)&&(g(o.extensions)||(o.extensions={}),o.extensions.KHR_blend=s)}})),e}var iQ=EAe;function TAe(e,t){let n=e.extensionsRequired;g(n)||(n=[],e.extensionsRequired=n),no(n,t,!0),q0(e,t)}var oQ=TAe;function SAe(e){let t=e.techniques,n={},r={},o={};if(g(t)){let a={programs:[],shaders:[],techniques:[]},s=e.glExtensionsUsed;delete e.glExtensionsUsed,re.technique(e,function(u,l){let c={name:u.name,program:void 0,attributes:{},uniforms:{}},f;if(re.techniqueAttribute(u,function(h,d){f=u.parameters[h],c.attributes[d]={semantic:f.semantic}}),re.techniqueUniform(u,function(h,d){f=u.parameters[h],c.uniforms[d]={count:f.count,node:f.node,type:f.type,semantic:f.semantic,value:f.value},g(n[l])||(n[l]={}),n[l][h]=d}),g(o[u.program]))c.program=o[u.program];else{let h=e.programs[u.program],d={name:h.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:s},p=e.shaders[h.fragmentShader];d.fragmentShader=no(a.shaders,p,!0);let _=e.shaders[h.vertexShader];d.vertexShader=no(a.shaders,_,!0),c.program=no(a.programs,d),o[u.program]=c.program}r[l]=no(a.techniques,c)}),a.techniques.length>0&&(g(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=a,q0(e,"KHR_techniques_webgl"),oQ(e,"KHR_techniques_webgl"))}return re.material(e,function(a){if(g(a.technique)){let s={technique:r[a.technique]};re.objectLegacy(a.values,function(u,l){g(s.values)||(s.values={});let c=n[a.technique][l];s.values[c]=u}),g(a.extensions)||(a.extensions={}),a.extensions.KHR_techniques_webgl=s}delete a.technique,delete a.values}),delete e.techniques,delete e.programs,delete e.shaders,e}var aQ=SAe;function AAe(e,t){Ds.typeOf.object("material",e),Ds.defined("handler",t);let n=e.pbrMetallicRoughness;if(g(n)){if(g(n.baseColorTexture)){let o=n.baseColorTexture,a=t(o.index,o);if(g(a))return a}if(g(n.metallicRoughnessTexture)){let o=n.metallicRoughnessTexture,a=t(o.index,o);if(g(a))return a}}if(g(e.extensions)){let o=e.extensions.KHR_materials_pbrSpecularGlossiness;if(g(o)){if(g(o.diffuseTexture)){let s=o.diffuseTexture,u=t(s.index,s);if(g(u))return u}if(g(o.specularGlossinessTexture)){let s=o.specularGlossinessTexture,u=t(s.index,s);if(g(u))return u}}let a=e.extensions.KHR_materials_common;if(g(a)){let s=a.values.diffuse,u=a.values.ambient,l=a.values.emission,c=a.values.specular;if(g(s)&&g(s.index)){let f=t(s.index,s);if(g(f))return f}if(g(u)&&g(u.index)){let f=t(u.index,u);if(g(f))return f}if(g(l)&&g(l.index)){let f=t(l.index,l);if(g(f))return f}if(g(c)&&g(c.index)){let f=t(c.index,c);if(g(f))return f}}}let r=re.materialValue(e,function(o){if(g(o.index)){let a=t(o.index,o);if(g(a))return a}});if(g(r))return r;if(g(e.emissiveTexture)){let o=e.emissiveTexture,a=t(o.index,o);if(g(a))return a}if(g(e.normalTexture)){let o=e.normalTexture,a=t(o.index,o);if(g(a))return a}if(g(e.occlusionTexture)){let o=e.occlusionTexture,a=t(o.index,o);if(g(a))return a}}var kF=AAe;var sQ=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"];function bAe(e,t){return t=T(t,sQ),sQ.forEach(function(n){t.indexOf(n)>-1&&DAe(e,n)}),e}var IAe={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function DAe(e,t){let n=IAe[t],r=e[n];if(g(r)){let o=0,a=kp[t](e),s=r.length;for(let u=0;u<s;++u)a[u]||(Vp[t](e,u-o),o++)}}function Vp(){}Vp.accessor=function(e,t){e.accessors.splice(t,1),re.mesh(e,function(r){re.meshPrimitive(r,function(o){re.meshPrimitiveAttribute(o,function(s,u){s>t&&o.attributes[u]--}),re.meshPrimitiveTarget(o,function(s){re.meshPrimitiveTargetAttribute(s,function(u,l){u>t&&s[l]--})});let a=o.indices;g(a)&&a>t&&o.indices--})}),re.skin(e,function(r){g(r.inverseBindMatrices)&&r.inverseBindMatrices>t&&r.inverseBindMatrices--}),re.animation(e,function(r){re.animationSampler(r,function(o){g(o.input)&&o.input>t&&o.input--,g(o.output)&&o.output>t&&o.output--})})};Vp.buffer=function(e,t){e.buffers.splice(t,1),re.bufferView(e,function(r){g(r.buffer)&&r.buffer>t&&r.buffer--,g(r.extensions)&&g(r.extensions.EXT_meshopt_compression)&&r.extensions.EXT_meshopt_compression.buffer--})};Vp.bufferView=function(e,t){if(e.bufferViews.splice(t,1),re.accessor(e,function(r){g(r.bufferView)&&r.bufferView>t&&r.bufferView--}),re.shader(e,function(r){g(r.bufferView)&&r.bufferView>t&&r.bufferView--}),re.image(e,function(r){g(r.bufferView)&&r.bufferView>t&&r.bufferView--}),Yo(e,"KHR_draco_mesh_compression")&&re.mesh(e,function(r){re.meshPrimitive(r,function(o){g(o.extensions)&&g(o.extensions.KHR_draco_mesh_compression)&&o.extensions.KHR_draco_mesh_compression.bufferView>t&&o.extensions.KHR_draco_mesh_compression.bufferView--})}),Yo(e,"EXT_feature_metadata")){let o=e.extensions.EXT_feature_metadata.featureTables;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].properties;if(g(u)){for(let l in u)if(u.hasOwnProperty(l)){let c=u[l];g(c.bufferView)&&c.bufferView>t&&c.bufferView--,g(c.arrayOffsetBufferView)&&c.arrayOffsetBufferView>t&&c.arrayOffsetBufferView--,g(c.stringOffsetBufferView)&&c.stringOffsetBufferView>t&&c.stringOffsetBufferView--}}}}};Vp.image=function(e,t){e.images.splice(t,1),re.texture(e,function(r){g(r.source)&&r.source>t&&--r.source;let o=r.extensions;g(o)&&g(o.EXT_texture_webp)&&o.EXT_texture_webp.source>t?--r.extensions.EXT_texture_webp.source:g(o)&&g(o.KHR_texture_basisu)&&o.KHR_texture_basisu.source>t&&--r.extensions.KHR_texture_basisu.source})};Vp.mesh=function(e,t){e.meshes.splice(t,1),re.node(e,function(r){g(r.mesh)&&(r.mesh>t?r.mesh--:r.mesh===t&&delete r.mesh)})};Vp.node=function(e,t){e.nodes.splice(t,1),re.skin(e,function(r){g(r.skeleton)&&r.skeleton>t&&r.skeleton--,r.joints=r.joints.map(function(o){return o>t?o-1:o})}),re.animation(e,function(r){re.animationChannel(r,function(o){g(o.target)&&g(o.target.node)&&o.target.node>t&&o.target.node--})}),re.technique(e,function(r){re.techniqueUniform(r,function(o){g(o.node)&&o.node>t&&o.node--})}),re.node(e,function(r){!g(r.children)||(r.children=r.children.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o}))}),re.scene(e,function(r){r.nodes=r.nodes.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o})})};Vp.material=function(e,t){e.materials.splice(t,1),re.mesh(e,function(r){re.meshPrimitive(r,function(o){g(o.material)&&o.material>t&&o.material--})})};Vp.sampler=function(e,t){e.samplers.splice(t,1),re.texture(e,function(r){g(r.sampler)&&r.sampler>t&&--r.sampler})};Vp.texture=function(e,t){if(e.textures.splice(t,1),re.material(e,function(r){kF(r,function(o,a){a.index>t&&--a.index})}),Yo(e,"EXT_feature_metadata")){re.mesh(e,function(a){re.meshPrimitive(a,function(s){let u=s.extensions;if(g(u)&&g(u.EXT_feature_metadata)){let c=u.EXT_feature_metadata.featureIdTextures;if(g(c)){let f=c.length;for(let h=0;h<f;++h){let p=c[h].featureIds.texture;p.index>t&&--p.index}}}})});let o=e.extensions.EXT_feature_metadata.featureTextures;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].properties;if(g(u)){for(let l in u)if(u.hasOwnProperty(l)){let f=u[l].texture;f.index>t&&--f.index}}}}};function kp(){}kp.accessor=function(e){let t={};return re.mesh(e,function(n){re.meshPrimitive(n,function(r){re.meshPrimitiveAttribute(r,function(a){t[a]=!0}),re.meshPrimitiveTarget(r,function(a){re.meshPrimitiveTargetAttribute(a,function(s){t[s]=!0})});let o=r.indices;g(o)&&(t[o]=!0)})}),re.skin(e,function(n){g(n.inverseBindMatrices)&&(t[n.inverseBindMatrices]=!0)}),re.animation(e,function(n){re.animationSampler(n,function(r){g(r.input)&&(t[r.input]=!0),g(r.output)&&(t[r.output]=!0)})}),Yo(e,"EXT_mesh_gpu_instancing")&&re.node(e,function(n){g(n.extensions)&&g(n.extensions.EXT_mesh_gpu_instancing)&&Object.keys(n.extensions.EXT_mesh_gpu_instancing.attributes).forEach(function(r){let o=n.extensions.EXT_mesh_gpu_instancing.attributes[r];t[o]=!0})}),t};kp.buffer=function(e){let t={};return re.bufferView(e,function(n){g(n.buffer)&&(t[n.buffer]=!0),g(n.extensions)&&g(n.extensions.EXT_meshopt_compression)&&(t[n.extensions.EXT_meshopt_compression.buffer]=!0)}),t};kp.bufferView=function(e){let t={};if(re.accessor(e,function(n){g(n.bufferView)&&(t[n.bufferView]=!0)}),re.shader(e,function(n){g(n.bufferView)&&(t[n.bufferView]=!0)}),re.image(e,function(n){g(n.bufferView)&&(t[n.bufferView]=!0)}),Yo(e,"KHR_draco_mesh_compression")&&re.mesh(e,function(n){re.meshPrimitive(n,function(r){g(r.extensions)&&g(r.extensions.KHR_draco_mesh_compression)&&(t[r.extensions.KHR_draco_mesh_compression.bufferView]=!0)})}),Yo(e,"EXT_feature_metadata")){let r=e.extensions.EXT_feature_metadata.featureTables;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o].properties;if(g(s)){for(let u in s)if(s.hasOwnProperty(u)){let l=s[u];g(l.bufferView)&&(t[l.bufferView]=!0),g(l.arrayOffsetBufferView)&&(t[l.arrayOffsetBufferView]=!0),g(l.stringOffsetBufferView)&&(t[l.stringOffsetBufferView]=!0)}}}}return t};kp.image=function(e){let t={};return re.texture(e,function(n){g(n.source)&&(t[n.source]=!0),g(n.extensions)&&g(n.extensions.EXT_texture_webp)?t[n.extensions.EXT_texture_webp.source]=!0:g(n.extensions)&&g(n.extensions.KHR_texture_basisu)&&(t[n.extensions.KHR_texture_basisu.source]=!0)}),t};kp.mesh=function(e){let t={};return re.node(e,function(n){if(g(n.mesh&&g(e.meshes))){let r=e.meshes[n.mesh];g(r)&&g(r.primitives)&&r.primitives.length>0&&(t[n.mesh]=!0)}}),t};function uQ(e,t,n){let r=e.nodes[t];return g(r.mesh)||g(r.camera)||g(r.skin)||g(r.weights)||g(r.extras)||g(r.extensions)&&Object.keys(r.extensions).length!==0||g(n[t])?!1:!g(r.children)||r.children.filter(function(o){return!uQ(e,o,n)}).length===0}kp.node=function(e){let t={};return re.skin(e,function(n){g(n.skeleton)&&(t[n.skeleton]=!0),re.skinJoint(n,function(r){t[r]=!0})}),re.animation(e,function(n){re.animationChannel(n,function(r){g(r.target)&&g(r.target.node)&&(t[r.target.node]=!0)})}),re.technique(e,function(n){re.techniqueUniform(n,function(r){g(r.node)&&(t[r.node]=!0)})}),re.node(e,function(n,r){uQ(e,r,t)||(t[r]=!0)}),t};kp.material=function(e){let t={};return re.mesh(e,function(n){re.meshPrimitive(n,function(r){g(r.material)&&(t[r.material]=!0)})}),t};kp.texture=function(e){let t={};if(re.material(e,function(n){kF(n,function(r){t[r]=!0})}),Yo(e,"EXT_feature_metadata")){re.mesh(e,function(o){re.meshPrimitive(o,function(a){let s=a.extensions;if(g(s)&&g(s.EXT_feature_metadata)){let l=s.EXT_feature_metadata.featureIdTextures;if(g(l)){let c=l.length;for(let f=0;f<c;++f){let d=l[f].featureIds.texture;t[d.index]=!0}}}})});let r=e.extensions.EXT_feature_metadata.featureTextures;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o].properties;if(g(s)){for(let u in s)if(s.hasOwnProperty(u)){let c=s[u].texture;t[c.index]=!0}}}}return t};kp.sampler=function(e){let t={};return re.texture(e,function(n){g(n.sampler)&&(t[n.sampler]=!0)}),t};var lQ=bAe;function PAe(e,t){let n={byteLength:t.length,extras:{_pipeline:{source:t}}},o={buffer:no(e.buffers,n),byteOffset:0,byteLength:t.length};return no(e.bufferViews,o)}var cQ=PAe;function MAe(e,t){let n=Lc(e,t),r=ie.getSizeInBytes(t.componentType),o=Ql(t.type),a=t.count,s=new Array(o*a);if(!g(t.bufferView))return s.fill(0);let u=e.bufferViews[t.bufferView],l=e.buffers[u.buffer].extras._pipeline.source,c=t.byteOffset+u.byteOffset+l.byteOffset,f=new DataView(l.buffer),h=new Array(o),d=vM(t.componentType);for(let p=0;p<a;++p){d(f,c,o,r,h);for(let _=0;_<o;++_)s[p*o+_]=h[_];c+=n}return s}var fQ=MAe;function LAe(e){let t;return re.accessorWithSemantic(e,"JOINTS_0",function(n){let r=e.accessors[n];t=r.componentType,t===k.BYTE?CM(e,r,ie.UNSIGNED_BYTE):t!==k.UNSIGNED_BYTE&&t!==k.UNSIGNED_SHORT&&CM(e,r,ie.UNSIGNED_SHORT)}),re.accessorWithSemantic(e,"WEIGHTS_0",function(n){let r=e.accessors[n];t=r.componentType,t===k.BYTE?CM(e,r,ie.UNSIGNED_BYTE):t===k.SHORT&&CM(e,r,ie.UNSIGNED_SHORT)}),e}function CM(e,t,n){let r=ie.createTypedArray(n,fQ(e,t)),o=new Uint8Array(r.buffer);t.bufferView=cQ(e,o),t.componentType=n,t.byteOffset=0}var hQ=LAe;var xM={.8:zAe,"1.0":ibe,"2.0":void 0};function RAe(e,t){t=T(t,T.EMPTY_OBJECT);let n=t.targetVersion,r=e.version;e.asset=T(e.asset,{version:"1.0"}),e.asset.version=T(e.asset.version,"1.0"),r=T(r,e.asset.version).toString(),Object.prototype.hasOwnProperty.call(xM,r)||(g(r)&&(r=r.substring(0,3)),Object.prototype.hasOwnProperty.call(xM,r)||(r="1.0"));let o=xM[r];for(;g(o)&&r!==n;)o(e,t),r=e.asset.version,o=xM[r];return e}function pQ(e){let t=e.materials;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.instanceTechnique;g(o)&&(r.technique=o.technique,r.values=o.values,delete r.instanceTechnique)}}function OAe(e){let t=e.meshes;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let o=t[n].primitives;if(g(o)){let a=o.length;for(let s=0;s<a;++s){let u=o[s],l=T(u.primitive,k.TRIANGLES);u.mode=T(u.mode,l),delete u.primitive}}}}function NAe(e){let t=e.nodes,n=new x,r=new je;for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let a=t[o];if(g(a.rotation)){let u=a.rotation;x.fromArray(u,0,n),je.fromAxisAngle(n,u[3],r),a.rotation=[r.x,r.y,r.z,r.w]}let s=a.instanceSkin;g(s)&&(a.skeletons=s.skeletons,a.skin=s.skin,a.meshes=s.meshes,delete a.instanceSkin)}}function BAe(e){let t=e.animations,n=e.accessors,r=e.bufferViews,o=e.buffers,a={},s=new x,u=new je;for(let l in t)if(Object.prototype.hasOwnProperty.call(t,l)){let c=t[l],f=c.channels,h=c.parameters,d=c.samplers;if(g(f)){let p=f.length;for(let _=0;_<p;++_){let y=f[_];if(y.target.path==="rotation"){let v=h[d[y.sampler].output];if(g(a[v]))continue;a[v]=!0;let w=n[v],C=r[w.bufferView],S=o[C.buffer].extras._pipeline.source,A=S.byteOffset+C.byteOffset+w.byteOffset,D=w.componentType,P=w.count,M=Ql(w.type),b=w.count*M,O=ie.createArrayBufferView(D,S.buffer,A,b);for(let m=0;m<P;m++){let I=m*M;x.unpack(O,I,s);let L=O[I+3];je.fromAxisAngle(s,L,u),je.pack(u,O,I)}}}}}}function FAe(e){let t=e.techniques;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.passes;if(g(o)){let a=T(r.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(o,a)){let s=o[a],u=s.instanceProgram;r.attributes=T(r.attributes,u.attributes),r.program=T(r.program,u.program),r.uniforms=T(r.uniforms,u.uniforms),r.states=T(r.states,s.states)}delete r.passes,delete r.pass}}}function zAe(e){g(e.asset)||(e.asset={});let t=e.asset;if(t.version="1.0",typeof t.profile=="string"){let n=t.profile.split(" ");t.profile={api:n[0],version:n[1]}}else t.profile={};if(g(e.version)&&delete e.version,pQ(e),OAe(e),NAe(e),BAe(e),FAe(e),g(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions),g(e.lights)){let n=T(e.extensions,{});e.extensions=n;let r=T(n.KHR_materials_common,{});n.KHR_materials_common=r,r.lights=e.lights,delete e.lights,q0(e,"KHR_materials_common")}}function VAe(e){let t=e.animations;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.parameters;if(g(o)){let a=r.samplers;for(let s in a)if(Object.prototype.hasOwnProperty.call(a,s)){let u=a[s];u.input=o[u.input],u.output=o[u.output]}delete r.parameters}}}function dQ(e,t){let n=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];t[r]=n.length,n.push(o),g(o.name)||(o.name=r)}return n}function kAe(e){let t,n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},r,o={},a=e.nodes;for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r=a[s].jointName,g(r)&&(o[r]=s));for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&g(n[s])){let u={},l=e[s];e[s]=dQ(l,u),n[s]=u}for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(o[r]=n.nodes[o[r]]);g(e.scene)&&(e.scene=n.scenes[e.scene]),re.bufferView(e,function(s){g(s.buffer)&&(s.buffer=n.buffers[s.buffer])}),re.accessor(e,function(s){g(s.bufferView)&&(s.bufferView=n.bufferViews[s.bufferView])}),re.shader(e,function(s){let u=s.extensions;if(g(u)){let l=u.KHR_binary_glTF;g(l)&&(s.bufferView=n.bufferViews[l.bufferView],delete u.KHR_binary_glTF),Object.keys(u).length===0&&delete s.extensions}}),re.program(e,function(s){g(s.vertexShader)&&(s.vertexShader=n.shaders[s.vertexShader]),g(s.fragmentShader)&&(s.fragmentShader=n.shaders[s.fragmentShader])}),re.technique(e,function(s){g(s.program)&&(s.program=n.programs[s.program]),re.techniqueParameter(s,function(u){g(u.node)&&(u.node=n.nodes[u.node]);let l=u.value;typeof l=="string"&&(u.value={index:n.textures[l]})})}),re.mesh(e,function(s){re.meshPrimitive(s,function(u){g(u.indices)&&(u.indices=n.accessors[u.indices]),re.meshPrimitiveAttribute(u,function(l,c){u.attributes[c]=n.accessors[l]}),g(u.material)&&(u.material=n.materials[u.material])})}),re.node(e,function(s){let u=s.children;if(g(u)){let l=u.length;for(t=0;t<l;++t)u[t]=n.nodes[u[t]]}if(g(s.meshes)){let l=s.meshes,c=l.length;if(c>0)for(s.mesh=n.meshes[l[0]],t=1;t<c;++t){let f={mesh:n.meshes[l[t]]},h=no(e.nodes,f);g(u)||(u=[],s.children=u),u.push(h)}delete s.meshes}if(g(s.camera)&&(s.camera=n.cameras[s.camera]),g(s.skin)&&(s.skin=n.skins[s.skin]),g(s.skeletons)){let l=s.skeletons;if(l.length>0&&g(s.skin)){let f=e.skins[s.skin];f.skeleton=n.nodes[l[0]]}delete s.skeletons}g(s.jointName)&&delete s.jointName}),re.skin(e,function(s){g(s.inverseBindMatrices)&&(s.inverseBindMatrices=n.accessors[s.inverseBindMatrices]);let u=s.jointNames;if(g(u)){let l=[],c=u.length;for(t=0;t<c;++t)l[t]=o[u[t]];s.joints=l,delete s.jointNames}}),re.scene(e,function(s){let u=s.nodes;if(g(u)){let l=u.length;for(t=0;t<l;++t)u[t]=n.nodes[u[t]]}}),re.animation(e,function(s){let u={};s.samplers=dQ(s.samplers,u),re.animationSampler(s,function(l){l.input=n.accessors[l.input],l.output=n.accessors[l.output]}),re.animationChannel(s,function(l){l.sampler=u[l.sampler];let c=l.target;g(c)&&(c.node=n.nodes[c.id],delete c.id)})}),re.material(e,function(s){g(s.technique)&&(s.technique=n.techniques[s.technique]),re.materialValue(s,function(l,c){typeof l=="string"&&(s.values[c]={index:n.textures[l]})});let u=s.extensions;if(g(u)){let l=u.KHR_materials_common;g(l)&&re.materialValue(l,function(c,f){typeof c=="string"&&(l.values[f]={index:n.textures[c]})})}}),re.image(e,function(s){let u=s.extensions;if(g(u)){let l=u.KHR_binary_glTF;g(l)&&(s.bufferView=n.bufferViews[l.bufferView],s.mimeType=l.mimeType,delete u.KHR_binary_glTF),Object.keys(u).length===0&&delete s.extensions}}),re.texture(e,function(s){g(s.sampler)&&(s.sampler=n.samplers[s.sampler]),g(s.source)&&(s.source=n.images[s.source])})}function GAe(e){re.animation(e,function(t){re.animationSampler(t,function(n){delete n.name})})}function UAe(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];Array.isArray(n)&&n.length===0&&delete e[t]}re.node(e,function(t){g(t.children)&&t.children.length===0&&delete t.children})}function HAe(e){let t=e.asset;delete t.profile,delete t.premultipliedAlpha}var qAe={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};function WAe(e){let t=e.extensionsUsed;if(e.extensionsRequired=T(e.extensionsRequired,[]),g(t)){let n=t.length;for(let r=0;r<n;++r){let o=t[r];g(qAe[o])&&e.extensionsRequired.push(o)}}}function YAe(e){re.buffer(e,function(t){delete t.type})}function XAe(e){re.texture(e,function(t){delete t.format,delete t.internalFormat,delete t.target,delete t.type})}function jAe(e){re.mesh(e,function(t){re.meshPrimitive(t,function(n){re.meshPrimitiveAttribute(n,function(r,o){o==="TEXCOORD"?n.attributes.TEXCOORD_0=r:o==="COLOR"&&(n.attributes.COLOR_0=r)}),delete n.attributes.TEXCOORD,delete n.attributes.COLOR})}),re.technique(e,function(t){re.techniqueParameter(t,function(n){let r=n.semantic;g(r)&&(r==="TEXCOORD"?n.semantic="TEXCOORD_0":r==="COLOR"&&(n.semantic="COLOR_0"))})})}var KAe={POSITION:!0,NORMAL:!0,TANGENT:!0},ZAe={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function QAe(e){let t={};re.mesh(e,function(n){re.meshPrimitive(n,function(r){re.meshPrimitiveAttribute(r,function(o,a){if(a.charAt(0)!=="_"){let s=a.search(/_[0-9]+/g),u=a,l="_0";s>=0&&(u=a.substring(0,s),l=a.substring(s));let c,f=ZAe[u];g(f)?(c=f+l,t[a]=c):g(KAe[u])||(c="_"+a,t[a]=c)}});for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let a=t[o],s=r.attributes[o];g(s)&&(delete r.attributes[o],r.attributes[a]=s)}})}),re.technique(e,function(n){re.techniqueParameter(n,function(r){let o=t[r.semantic];g(o)&&(r.semantic=o)})})}function JAe(e){re.camera(e,function(t){let n=t.perspective;if(g(n)){let r=n.aspectRatio;g(r)&&r===0&&delete n.aspectRatio;let o=n.yfov;g(o)&&o===0&&(n.yfov=1)}})}function GF(e,t){return g(t.byteStride)&&t.byteStride!==0?t.byteStride:Lc(e,t)}function $Ae(e){re.buffer(e,function(t){g(t.byteLength)||(t.byteLength=t.extras._pipeline.source.length)}),re.accessor(e,function(t){let n=t.bufferView;if(g(n)){let r=e.bufferViews[n],o=GF(e,t),a=t.byteOffset+t.count*o;r.byteLength=Math.max(T(r.byteLength,0),a)}})}function ebe(e){let t,n,r,o=e.bufferViews,a={};re.accessorContainingVertexAttributeData(e,function(u){let l=e.accessors[u];g(l.bufferView)&&(a[l.bufferView]=!0)});let s={};re.accessor(e,function(u){g(u.bufferView)&&(s[u.bufferView]=T(s[u.bufferView],[]),s[u.bufferView].push(u))});for(let u in s)if(Object.prototype.hasOwnProperty.call(s,u)){r=o[u];let l=s[u];l.sort(function(d,p){return d.byteOffset-p.byteOffset});let c=0,f=0,h=l.length;for(t=0;t<h;++t){let d=l[t],p=GF(e,d),_=d.byteOffset,y=d.count*p;delete d.byteStride;let v=t<h-1,w=v?GF(e,l[t+1]):void 0;if(p!==w){let C=Ht(r,!0);a[u]&&(C.byteStride=p),C.byteOffset+=c,C.byteLength=_+y-c;let E=no(o,C);for(n=f;n<=t;++n)d=l[n],d.bufferView=E,d.byteOffset=d.byteOffset-c;c=v?l[t+1].byteOffset:void 0,f=t+1}}}lQ(e,["accessor","bufferView","buffer"])}function tbe(e){re.accessorWithSemantic(e,"POSITION",function(t){let n=e.accessors[t];if(!g(n.min)||!g(n.max)){let r=VF(e,n);n.min=r.min,n.max=r.max}})}function mQ(e){return(!g(e.children)||e.children.length===0)&&(!g(e.meshes)||e.meshes.length===0)&&!g(e.camera)&&!g(e.skin)&&!g(e.skeletons)&&!g(e.jointName)&&(!g(e.translation)||x.fromArray(e.translation).equals(x.ZERO))&&(!g(e.scale)||x.fromArray(e.scale).equals(new x(1,1,1)))&&(!g(e.rotation)||Se.fromArray(e.rotation).equals(new Se(0,0,0,1)))&&(!g(e.matrix)||G.fromColumnMajorArray(e.matrix).equals(G.IDENTITY))&&!g(e.extensions)&&!g(e.extras)}function gQ(e,t){re.scene(e,function(n){let r=n.nodes;if(g(r)){let o=r.length;for(let a=o;a>=0;--a)if(r[a]===t){r.splice(a,1);return}}}),re.node(e,function(n,r){if(g(n.children)){let o=n.children.indexOf(t);o>-1&&(n.children.splice(o,1),mQ(n)&&gQ(e,r))}}),delete e.nodes[t]}function nbe(e){return re.node(e,function(t,n){mQ(t)&&gQ(e,n)}),e}function rbe(e){re.animation(e,function(t){re.animationSampler(t,function(n){let r=e.accessors[n.input];if(!g(r.min)||!g(r.max)){let o=VF(e,r);r.min=o.min,r.max=o.max}})})}function ibe(e){e.asset=T(e.asset,{}),e.asset.version="2.0",pQ(e),VAe(e),nbe(e),kAe(e),GAe(e),HAe(e),WAe(e),$Ae(e),ebe(e),tbe(e),rbe(e),YAe(e),XAe(e),jAe(e),QAe(e),hQ(e),JAe(e),iQ(e),aQ(e),UAe(e)}var _Q=RAe;var dg={X:0,Y:1,Z:2};dg.Y_UP_TO_Z_UP=G.fromRotationTranslation(te.fromRotationX(F.PI_OVER_TWO));dg.Z_UP_TO_Y_UP=G.fromRotationTranslation(te.fromRotationX(-F.PI_OVER_TWO));dg.X_UP_TO_Z_UP=G.fromRotationTranslation(te.fromRotationY(-F.PI_OVER_TWO));dg.Z_UP_TO_X_UP=G.fromRotationTranslation(te.fromRotationY(F.PI_OVER_TWO));dg.X_UP_TO_Y_UP=G.fromRotationTranslation(te.fromRotationZ(F.PI_OVER_TWO));dg.Y_UP_TO_X_UP=G.fromRotationTranslation(te.fromRotationZ(-F.PI_OVER_TWO));dg.fromName=function(e){return dg[e]};var Hu=Object.freeze(dg);function jx(e,t){this._distance=t,this._normal=new yQ(e,this),this.onChangeCallback=void 0,this.index=-1}Object.defineProperties(jx.prototype,{distance:{get:function(){return this._distance},set:function(e){g(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){g(this.onChangeCallback)&&!x.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),x.clone(e,this._normal._cartesian3)}}});jx.fromPlane=function(e,t){return g(t)?(t.normal=e.normal,t.distance=e.distance):t=new jx(e.normal,e.distance),t};jx.clone=function(e,t){return g(t)?(t.normal=e.normal,t.distance=e.distance,t):new jx(e.normal,e.distance)};function yQ(e,t){this._clippingPlane=t,this._cartesian3=x.clone(e)}Object.defineProperties(yQ.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){g(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){g(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){g(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});var wM=jx;function wl(e){e=T(e,T.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=T(e.enabled,!0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this.edgeColor=K.clone(T(e.edgeColor,K.WHITE)),this.edgeWidth=T(e.edgeWidth,0),this.planeAdded=new xe,this.planeRemoved=new xe,this._owner=void 0;let t=T(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?EQ:TQ,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;let n=e.planes;if(g(n)){let r=n.length;for(let o=0;o<r;++o)this.add(n[o])}}function EQ(e){return e===vi.OUTSIDE}function TQ(e){return e===vi.INSIDE}Object.defineProperties(wl.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?EQ:TQ)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}});function vQ(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||e._dirtyIndex!==-1&&e._dirtyIndex!==t,e._dirtyIndex=t}wl.prototype.add=function(e){let t=this._planes.length,n=this;e.onChangeCallback=function(r){vQ(n,r)},e.index=t,vQ(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)};wl.prototype.get=function(e){return this._planes[e]};function SQ(e,t){let n=e.length;for(let r=0;r<n;++r)if(si.equals(e[r],t))return r;return-1}wl.prototype.contains=function(e){return SQ(this._planes,e)!==-1};wl.prototype.remove=function(e){let t=this._planes,n=SQ(t,e);if(n===-1)return!1;e instanceof wM&&(e.onChangeCallback=void 0,e.index=-1);let r=t.length-1;for(let o=n;o<r;++o){let a=t[o+1];t[o]=a,a instanceof wM&&(a.index=o)}return this._multipleDirtyPlanes=!0,t.length=r,this.planeRemoved.raiseEvent(e,n),!0};wl.prototype.removeAll=function(){let e=this._planes,t=e.length;for(let n=0;n<t;++n){let r=e[n];r instanceof wM&&(r.onChangeCallback=void 0,r.index=-1),this.planeRemoved.raiseEvent(r,n)}this._multipleDirtyPlanes=!0,this._planes=[]};var obe=new Se,abe=new Se;function CQ(e,t,n){let r=e._uint8View,o=e._planes,a=0;for(let s=t;s<n;++s){let u=o[s],l=_a.octEncodeToCartesian4(u.normal,abe);r[a]=l.x,r[a+1]=l.y,r[a+2]=l.z,r[a+3]=l.w;let c=Se.packFloat(u.distance,obe);r[a+4]=c.x,r[a+5]=c.y,r[a+6]=c.z,r[a+7]=c.w,a+=8}}function xQ(e,t,n){let r=e._float32View,o=e._planes,a=0;for(let s=t;s<n;++s){let u=o[s],l=u.normal;r[a]=l.x,r[a+1]=l.y,r[a+2]=l.z,r[a+3]=u.distance,a+=4}}function AQ(e,t){let n=Jt.maximumTextureSize;return t.x=Math.min(e,n),t.y=Math.ceil(e/t.x),t}var sbe=new X;wl.prototype.update=function(e){let t=this._clippingPlanesTexture,n=e.context,r=wl.useFloatTexture(n),o=r?this.length:this.length*2;if(g(t)){let s=t.width*t.height;(s<o||o<.25*s)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(this.length===0)return;if(!g(t)){let s=AQ(o,sbe);s.y*=2,r?(t=new na({context:n,width:s.x,height:s.y,pixelFormat:qt.RGBA,pixelDatatype:xt.FLOAT,sampler:Oa.NEAREST,flipY:!1}),this._float32View=new Float32Array(s.x*s.y*4)):(t=new na({context:n,width:s.x,height:s.y,pixelFormat:qt.RGBA,pixelDatatype:xt.UNSIGNED_BYTE,sampler:Oa.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(s.x*s.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}let a=this._dirtyIndex;if(!(!this._multipleDirtyPlanes&&a===-1)){if(this._multipleDirtyPlanes)r?(xQ(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(CQ(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let s=0,u=0;r?(u=Math.floor(a/t.width),s=Math.floor(a-u*t.width),xQ(this,a,a+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:s,yOffset:u})):(u=Math.floor(a*2/t.width),s=Math.floor(a*2-u*t.width),CQ(this,a,a+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:s,yOffset:u}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};var ube=new G,wQ=new si(x.UNIT_X,0);wl.prototype.computeIntersectionWithBoundingVolume=function(e,t){let n=this._planes,r=n.length,o=this.modelMatrix;g(t)&&(o=G.multiply(t,o,ube));let a=vi.INSIDE;!this.unionClippingRegions&&r>0&&(a=vi.OUTSIDE);for(let s=0;s<r;++s){let u=n[s];si.transform(u,o,wQ);let l=e.intersectPlane(wQ);if(l===vi.INTERSECTING)a=l;else if(this._testIntersection(l))return l}return a};wl.setOwner=function(e,t,n){e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),g(e)&&(e._owner=t,t[n]=e))};wl.useFloatTexture=function(e){return e.floatingPointTexture};wl.getTextureResolution=function(e,t,n){let r=e.texture;if(g(r))return n.x=r.width,n.y=r.height,n;let o=wl.useFloatTexture(t)?e.length:e.length*2,a=AQ(o,n);return a.y*=2,a};wl.prototype.isDestroyed=function(){return!1};wl.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),st(this)};var bS=wl;function Hr(){}Hr._maxDecodingConcurrency=Math.max(ea.hardwareConcurrency-1,1);Hr._decoderTaskProcessor=void 0;Hr._taskProcessorReady=!1;Hr._getDecoderTaskProcessor=function(){if(!g(Hr._decoderTaskProcessor)){let e=new jc("decodeDraco",Hr._maxDecodingConcurrency);e.initWebAssemblyModule({modulePath:"ThirdParty/Workers/draco_decoder_nodejs.js",wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then(function(){Hr._taskProcessorReady=!0}),Hr._decoderTaskProcessor=e}return Hr._decoderTaskProcessor};Hr.hasExtension=function(e){return g(e.extensionsRequired.KHR_draco_mesh_compression)||g(e.extensionsUsed.KHR_draco_mesh_compression)};function IQ(e,t){let n=`runtime.${Object.keys(e.createdBufferViews).length}`,r=e.buffers,o=Object.keys(r).length;return r[o]=t,e.createdBufferViews[n]={buffer:o,byteOffset:0,byteLength:t.byteLength},n}function lbe(e,t,n){let r=t._loadResources,o=IQ(r,e);return r.vertexBuffersToCreate.enqueue(o),o}function cbe(e,t,n){let r=e.typedArray,o=t._loadResources,a=IQ(o,r);return o.indexBuffersToCreate.enqueue({id:a,componentType:ie.fromTypedArray(r)}),{bufferViewId:a,numberOfIndices:e.numberOfIndices}}function bQ(e,t,n,r){if(!Hr._taskProcessorReady)return;let o=n.primitivesToDecode.peek();if(!g(o))return;let a=e.scheduleTask(o,[o.array.buffer]);if(!!g(a))return n.activeDecodingTasks++,n.primitivesToDecode.dequeue(),a.then(function(s){n.activeDecodingTasks--;let u=cbe(s.indexArray,t,r),l={},c=s.attributeData;for(let f in c)if(c.hasOwnProperty(f)){let h=c[f],d=h.array,p=lbe(d,t,r),_=h.data;_.bufferView=p,l[f]=_}t._decodedData[`${o.mesh}.primitive.${o.primitive}`]={bufferView:u.bufferViewId,numberOfIndices:u.numberOfIndices,attributes:l}})}Hr._decodedModelResourceCache=void 0;Hr.parse=function(e,t){if(!Hr.hasExtension(e))return;let n=e._loadResources,r=e.cacheKey;if(g(r)){g(Hr._decodedModelResourceCache)||(g(t.cache.modelDecodingCache)||(t.cache.modelDecodingCache={}),Hr._decodedModelResourceCache=t.cache.modelDecodingCache);let s=Hr._decodedModelResourceCache[r];if(g(s)){s.count++,n.pendingDecodingCache=!0;return}}let o=e._dequantizeInShader,a=e.gltfInternal;re.mesh(a,function(s,u){re.meshPrimitive(s,function(l,c){if(!g(l.extensions))return;let f=l.extensions.KHR_draco_mesh_compression;if(!g(f))return;let h=a.bufferViews[f.bufferView],p=a.buffers[h.buffer].extras._pipeline.source.slice(h.byteOffset,h.byteOffset+h.byteLength);n.primitivesToDecode.enqueue({mesh:u,primitive:c,array:p,bufferView:h,compressedAttributes:f.attributes,dequantizeInShader:o})})})};Hr.decodeModel=function(e,t){if(!Hr.hasExtension(e))return Promise.resolve();let n=e._loadResources,r=e.cacheKey;if(g(r)&&g(Hr._decodedModelResourceCache)){let u=Hr._decodedModelResourceCache[r];if(g(u)&&n.pendingDecodingCache)return Promise.resolve(u.ready).then(function(){e._decodedData=u.data,n.pendingDecodingCache=!1});Hr._decodedModelResourceCache[r]={ready:!1,count:1,data:void 0}}if(n.primitivesToDecode.length===0)return Promise.resolve();let o=Hr._getDecoderTaskProcessor(),a=[],s=bQ(o,e,n,t);for(;g(s);)a.push(s),s=bQ(o,e,n,t);return Promise.all(a)};Hr.decodePointCloud=function(e){let t=Hr._getDecoderTaskProcessor();if(!!Hr._taskProcessorReady)return t.scheduleTask(e,[e.buffer.buffer])};Hr.decodeBufferView=function(e){let t=Hr._getDecoderTaskProcessor();if(!!Hr._taskProcessorReady)return t.scheduleTask(e,[e.array.buffer])};Hr.cacheDataForModel=function(e){let t=e.cacheKey;if(g(t)&&g(Hr._decodedModelResourceCache)){let n=Hr._decodedModelResourceCache[t];g(n)&&(n.ready=!0,n.data=e._decodedData)}};Hr.destroyCachedDataForModel=function(e){let t=e.cacheKey;if(g(t)&&g(Hr._decodedModelResourceCache)){let n=Hr._decodedModelResourceCache[t];g(n)&&--n.count===0&&delete Hr._decodedModelResourceCache[t]}};var Kx=Hr;function fbe(e,t,n){return`    float clipDistance = clip(gl_FragCoord, ${e}, ${t}); 
    vec4 clippingPlanesEdgeColor = vec4(1.0); 
    clippingPlanesEdgeColor.rgb = ${n}.rgb; 
    float clippingPlanesEdgeWidth = ${n}.a; 
    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) 
    { 
        gl_FragColor = clippingPlanesEdgeColor;
    } 
`}var DQ=fbe;var hbe=new X;function dbe(e,t){let n=e.unionClippingRegions,r=e.length,o=bS.useFloatTexture(t),a=bS.getTextureResolution(e,t,hbe),s=a.x,u=a.y,l=o?gbe(s,u):_be(s,u);return l+=`
`,l+=n?pbe(r):mbe(r),l}function pbe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount;
    float pixelWidth = czm_metersPerPixel(position);
    bool breakAndDiscard = false;
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
        if (amount <= 0.0)
        {
           breakAndDiscard = true;
           break;
        }
    }
    if (breakAndDiscard) {
        discard;
    }
    return clipAmount;
}
`}function mbe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    bool clipped = true;
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount = 0.0;
    float pixelWidth = czm_metersPerPixel(position);
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = max(amount, clipAmount);
        clipped = clipped && (amount <= 0.0);
    }
    if (clipped)
    {
        discard;
    }
    return clipAmount;
}
`}function gbe(e,t){let n=1/e,r=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let a=`${r}`;return a.indexOf(".")===-1&&(a+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int pixY = clippingPlaneNumber / ${e};
    int pixX = clippingPlaneNumber - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${a};
    vec4 plane = texture2D(packedClippingPlanes, vec2(u, v));
    return czm_transformPlane(plane, transform);
}
`}function _be(e,t){let n=1/e,r=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let a=`${r}`;return a.indexOf(".")===-1&&(a+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int clippingPlaneStartIndex = clippingPlaneNumber * 2;
    int pixY = clippingPlaneStartIndex / ${e};
    int pixX = clippingPlaneStartIndex - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${a};
    vec4 oct32 = texture2D(packedClippingPlanes, vec2(u, v)) * 255.0;
    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
    vec4 plane;
    plane.xyz = czm_octDecode(oct, 65535.0);
    plane.w = czm_unpackFloat(texture2D(packedClippingPlanes, vec2(u + ${o}, v)));
    return czm_transformPlane(plane, transform);
}
`}var PQ=dbe;var ybe={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3},IS=Object.freeze(ybe);function Zx(){this.times=void 0,this.points=void 0,Le.throwInstantiationError()}Zx.getPointType=function(e){if(typeof e=="number")return Number;if(e instanceof x)return x;if(e instanceof je)return je};Zx.prototype.evaluate=Le.throwInstantiationError;Zx.prototype.findTimeInterval=function(e,t){let n=this.times,r=n.length;if(t=T(t,0),e>=n[t]){if(t+1<r&&e<n[t+1])return t;if(t+2<r&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;let o;if(e>n[t])for(o=t;o<r-1&&!(e>=n[o]&&e<n[o+1]);++o);else for(o=t-1;o>=0&&!(e>=n[o]&&e<n[o+1]);--o);return o===r-1&&(o=r-2),o};Zx.prototype.wrapTime=function(e){let t=this.times,n=t[t.length-1],r=t[0],o=n-r,a;return e<r&&(a=Math.floor((r-e)/o)+1,e+=a*o),e>n&&(a=Math.floor((e-n)/o)+1,e-=a*o),e};Zx.prototype.clampTime=function(e){let t=this.times;return F.clamp(e,t[0],t[t.length-1])};var qu=Zx;function Qx(e){this._value=e,this._valueType=qu.getPointType(e)}Object.defineProperties(Qx.prototype,{value:{get:function(){return this._value}}});Qx.prototype.findTimeInterval=function(e){};Qx.prototype.wrapTime=function(e){return 0};Qx.prototype.clampTime=function(e){return 0};Qx.prototype.evaluate=function(e,t){let n=this._value,r=this._valueType;return r===Number?n:r.clone(n,t)};var MQ=Qx;function Jx(e){e=T(e,T.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._pointType=qu.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(Jx.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});Jx.prototype.findTimeInterval=qu.prototype.findTimeInterval;Jx.prototype.wrapTime=qu.prototype.wrapTime;Jx.prototype.clampTime=qu.prototype.clampTime;Jx.prototype.evaluate=function(e,t){let n=this.points,r=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-r[o])/(r[o+1]-r[o]);return this._pointType===Number?(1-a)*n[o]+a*n[o+1]:(g(t)||(t=new x),x.lerp(n[o],n[o+1],a,t))};var LQ=Jx;function $x(e){e=T(e,T.EMPTY_OBJECT);let t=e.weights,n=e.times;this._times=n,this._weights=t,this._count=t.length/n.length,this._lastTimeIndex=0}Object.defineProperties($x.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}});$x.prototype.findTimeInterval=qu.prototype.findTimeInterval;$x.prototype.wrapTime=qu.prototype.wrapTime;$x.prototype.clampTime=qu.prototype.clampTime;$x.prototype.evaluate=function(e,t){let n=this.weights,r=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-r[o])/(r[o+1]-r[o]);g(t)||(t=new Array(this._count));for(let s=0;s<this._count;s++){let u=o*this._count+s;t[s]=n[u]*(1-a)+n[u+this._count]*a}return t};var RQ=$x;function vbe(e){let t=e.points,n=e.times;return function(r,o){g(o)||(o=new je);let a=e._lastTimeIndex=e.findTimeInterval(r,e._lastTimeIndex),s=(r-n[a])/(n[a+1]-n[a]),u=t[a],l=t[a+1];return je.fastSlerp(u,l,s,o)}}function e1(e){e=T(e,T.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._evaluateFunction=vbe(this),this._lastTimeIndex=0}Object.defineProperties(e1.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});e1.prototype.findTimeInterval=qu.prototype.findTimeInterval;e1.prototype.wrapTime=qu.prototype.wrapTime;e1.prototype.clampTime=qu.prototype.clampTime;e1.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var OQ=e1;function EM(){}var Cbe=/^data\:/i;function zQ(e,t){let n=e.gltfInternal,r=n.buffers,a=n.bufferViews[t.bufferView],s=r[a.buffer],u=a.byteOffset+t.byteOffset,l=t.count*Ql(t.type),c=Cbe.test(s.uri)?"":s.uri;return`${e.cacheKey}//${c}/${u}/${l}`}var NQ={};EM.getAnimationParameterValues=function(e,t){let n=zQ(e,t),r=NQ[n];if(!g(r)){let o=e.gltfInternal,a=o.buffers,u=o.bufferViews[t.bufferView],l=u.buffer,f=a[l].extras._pipeline.source,h=t.componentType,d=t.type,p=Ql(d),_=t.count,y=Lc(o,t);r=new Array(_);let v=T(t.byteOffset,0),w=u.byteOffset+v;for(let C=0;C<_;C++){let E=ie.createArrayBufferView(h,f.buffer,f.byteOffset+w,p);d==="SCALAR"?r[C]=E[0]:d==="VEC3"?r[C]=x.fromArray(E):d==="VEC4"&&(r[C]=je.unpack(E)),w+=y}g(e.cacheKey)&&(NQ[n]=r)}return r};var BQ={};function xbe(e,t,n){return`${e.cacheKey}//${t}/${n}`}function t1(e){this._spline=e,this._lastTimeIndex=0}t1.prototype.findTimeInterval=qu.prototype.findTimeInterval;t1.prototype.evaluate=function(e,t){let n=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),r=this._spline.times,o=e>=r[n+1]?r[n+1]:r[n];return this._spline.evaluate(o,t)};Object.defineProperties(t1.prototype,{times:{get:function(){return this._spline.times}}});t1.prototype.wrapTime=function(e){return this._spline.wrapTime(e)};t1.prototype.clampTime=function(e){return this._spline.clampTime(e)};EM.getAnimationSpline=function(e,t,n,r,o,a,s,u){let l=xbe(e,t,r),c=BQ[l];if(!g(c)){let f=a,h=u;f.length===1&&h.length===1?c=new MQ(h[0]):(o.interpolation==="LINEAR"||o.interpolation==="STEP")&&(s==="translation"||s==="scale"?c=new LQ({times:f,points:h}):s==="rotation"?c=new OQ({times:f,points:h}):s==="weights"&&(c=new RQ({times:f,weights:h})),g(c)&&o.interpolation==="STEP"&&(c=new t1(c))),g(e.cacheKey)&&(BQ[l]=c)}return c};var FQ={};EM.getSkinInverseBindMatrices=function(e,t){let n=zQ(e,t),r=FQ[n];if(!g(r)){let o=e.gltfInternal,a=o.buffers,s=o.bufferViews,u=t.bufferView,l=s[u],c=l.buffer,h=a[c].extras._pipeline.source,d=t.componentType,p=t.type,_=t.count,y=Lc(o,t),v=l.byteOffset+t.byteOffset,w=Ql(p);if(r=new Array(_),d===k.FLOAT&&p===Wc.MAT4)for(let C=0;C<_;++C){let E=ie.createArrayBufferView(d,h.buffer,h.byteOffset+v,w);r[C]=G.fromArray(E),v+=y}FQ[n]=r}return r};var DS=EM;var wbe={NONE:0,REPEAT:1,MIRRORED_REPEAT:2},Uy=Object.freeze(wbe);var W0=Object.freeze({STOPPED:0,ANIMATING:1});function VQ(e,t,n){this._name=n.name,this._startTime=ce.clone(e.startTime),this._delay=T(e.delay,0),this._stopTime=e.stopTime,this.removeOnStop=T(e.removeOnStop,!1),this._multiplier=T(e.multiplier,1),this._reverse=T(e.reverse,!1),this._loop=T(e.loop,Uy.NONE),this._animationTime=e.animationTime,this._prevAnimationDelta=void 0,this.start=new xe,this.update=new xe,this.stop=new xe,this._state=W0.STOPPED,this._runtimeAnimation=n,this._computedStartTime=void 0,this._duration=void 0;let r=this;this._raiseStartEvent=function(){r.start.raiseEvent(t,r)},this._updateEventTime=0,this._raiseUpdateEvent=function(){r.update.raiseEvent(t,r,r._updateEventTime)},this._raiseStopEvent=function(){r.stop.raiseEvent(t,r)}}Object.defineProperties(VQ.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}});var kQ=VQ;function pg(e){this.animationAdded=new xe,this.animationRemoved=new xe,this.animateWhilePaused=!1,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}Object.defineProperties(pg.prototype,{length:{get:function(){return this._scheduledAnimations.length}}});function UF(e,t,n){let r=e._model,a=r._runtime.animations[t],s=new kQ(n,r,a);return e._scheduledAnimations.push(s),e.animationAdded.raiseEvent(r,s),s}pg.prototype.add=function(e){e=T(e,T.EMPTY_OBJECT);let n=this._model._runtime.animations;if(g(e.index))return UF(this,e.index,e);let r,o=n.length;for(let a=0;a<o;++a)if(n[a].name===e.name){r=a;break}return UF(this,r,e)};pg.prototype.addAll=function(e){e=T(e,T.EMPTY_OBJECT);let t=[],o=this._model._runtime.animations.length;for(let a=0;a<o;++a)t.push(UF(this,a,e));return t};pg.prototype.remove=function(e){if(g(e)){let t=this._scheduledAnimations,n=t.indexOf(e);if(n!==-1)return t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1};pg.prototype.removeAll=function(){let e=this._model,t=this._scheduledAnimations,n=t.length;this._scheduledAnimations=[];for(let r=0;r<n;++r)this.animationRemoved.raiseEvent(e,t[r])};pg.prototype.contains=function(e){return g(e)?this._scheduledAnimations.indexOf(e)!==-1:!1};pg.prototype.get=function(e){return this._scheduledAnimations[e]};function Ebe(e,t){let n=e.channelEvaluators,r=n.length;for(let o=0;o<r;++o)n[o](t)}var TM=[];function Tbe(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}pg.prototype.update=function(e){let t=this._scheduledAnimations,n=t.length;if(n===0)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&ce.equals(e.time,this._previousTime))return!1;this._previousTime=ce.clone(e.time,this._previousTime);let r=!1,o=e.time,a=this._model;for(let s=0;s<n;++s){let u=t[s],l=u._runtimeAnimation;g(u._computedStartTime)||(u._computedStartTime=ce.addSeconds(T(u.startTime,o),u.delay,new ce)),g(u._duration)||(u._duration=l.stopTime*(1/u.multiplier));let c=u._computedStartTime,f=u._duration,h=u.stopTime,d=ce.lessThanOrEquals(c,o),p=g(h)&&ce.greaterThan(o,h),_=0;if(f!==0){let w=ce.secondsDifference(p?h:o,c);_=g(u._animationTime)?u._animationTime(f,w):w/f}let y=u.loop===Uy.REPEAT||u.loop===Uy.MIRRORED_REPEAT,v=(d||y&&!g(u.startTime))&&(_<=1||y)&&!p;if(_===u._prevAnimationDelta){let w=u._state===W0.STOPPED;if(v!==w)continue}if(u._prevAnimationDelta=_,v||u._state===W0.ANIMATING){if(v&&u._state===W0.STOPPED&&(u._state=W0.ANIMATING,u.start.numberOfListeners>0&&e.afterRender.push(u._raiseStartEvent)),u.loop===Uy.REPEAT)_=_-Math.floor(_);else if(u.loop===Uy.MIRRORED_REPEAT){let C=Math.floor(_),E=_-C;_=C%2===1?1-E:E}u.reverse&&(_=1-_);let w=_*f*u.multiplier;w=F.clamp(w,l.startTime,l.stopTime),Ebe(l,w),u.update.numberOfListeners>0&&(u._updateEventTime=w,e.afterRender.push(u._raiseUpdateEvent)),r=!0,v||(u._state=W0.STOPPED,u.stop.numberOfListeners>0&&e.afterRender.push(u._raiseStopEvent),u.removeOnStop&&TM.push(u))}}n=TM.length;for(let s=0;s<n;++s){let u=TM[s];t.splice(t.indexOf(u),1),e.afterRender.push(Tbe(this,a,u))}return TM.length=0,r};var GQ=pg;function Y0(){this._array=[],this._offset=0,this._length=0}Object.defineProperties(Y0.prototype,{length:{get:function(){return this._length}}});Y0.prototype.enqueue=function(e){this._array.push(e),this._length++};Y0.prototype.dequeue=function(){if(this._length===0)return;let e=this._array,t=this._offset,n=e[t];return e[t]=void 0,t++,t>10&&t*2>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,n};Y0.prototype.peek=function(){if(this._length!==0)return this._array[this._offset]};Y0.prototype.contains=function(e){return this._array.indexOf(e)!==-1};Y0.prototype.clear=function(){this._array.length=this._offset=this._length=0};Y0.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};var Hy=Y0;function mg(){this.initialized=!1,this.resourcesParsed=!1,this.vertexBuffersToCreate=new Hy,this.indexBuffersToCreate=new Hy,this.buffers={},this.pendingBufferLoads=0,this.programsToCreate=new Hy,this.shaders={},this.pendingShaderLoads=0,this.texturesToCreate=new Hy,this.pendingTextureLoads=0,this.texturesToCreateFromBufferView=new Hy,this.pendingBufferViewToImage=0,this.createSamplers=!0,this.createSkins=!0,this.createRuntimeAnimations=!0,this.createVertexArrays=!0,this.createRenderStates=!0,this.createUniformMaps=!0,this.createRuntimeNodes=!0,this.createdBufferViews={},this.primitivesToDecode=new Hy,this.activeDecodingTasks=0,this.pendingDecodingCache=!1,this.skinnedNodesIds=[]}function Sbe(e,t,n){return e.subarray(t,t+n)}mg.prototype.getBuffer=function(e){return Sbe(this.buffers[e.buffer],e.byteOffset,e.byteLength)};mg.prototype.finishedPendingBufferLoads=function(){return this.pendingBufferLoads===0};mg.prototype.finishedBuffersCreation=function(){return this.pendingBufferLoads===0&&this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0};mg.prototype.finishedProgramCreation=function(){return this.pendingShaderLoads===0&&this.programsToCreate.length===0};mg.prototype.finishedTextureCreation=function(){let e=this.pendingTextureLoads===0,t=this.texturesToCreate.length===0&&this.texturesToCreateFromBufferView.length===0;return e&&t};mg.prototype.finishedEverythingButTextureCreation=function(){let e=this.pendingBufferLoads===0&&this.pendingShaderLoads===0,t=this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0&&this.programsToCreate.length===0&&this.pendingBufferViewToImage===0;return this.finishedDecoding()&&e&&t};mg.prototype.finishedDecoding=function(){return this.primitivesToDecode.length===0&&this.activeDecodingTasks===0&&!this.pendingDecodingCache};mg.prototype.finished=function(){return this.finishedDecoding()&&this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()};var UQ=mg;function SM(e,t,n){this._name=t.name,this._id=n,this._uniformMap=e._uniformMaps[n],this._technique=void 0,this._program=void 0,this._values=void 0}Object.defineProperties(SM.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}});SM.prototype.setValue=function(e,t){let n=`u_${e}`,r=this._uniformMap.values[n];r.value=r.clone(t,r.value)};SM.prototype.getValue=function(e){let t=`u_${e}`,n=this._uniformMap.values[t];if(!!g(n))return n.value};var HQ=SM;function qQ(e,t,n){let r=[],o=e.primitives,a=o.length;for(let s=0;s<a;++s){let u=o[s];r[s]=t[u.material]}this._name=e.name,this._materials=r,this._id=n}Object.defineProperties(qQ.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}});var WQ=qQ;function HF(e,t,n,r,o){this._model=e,this._runtimeNode=n,this._name=t.name,this._id=r,this.useMatrix=!1,this._show=!0,this._matrix=G.clone(o),this._originalMatrix=G.clone(o)}Object.defineProperties(HF.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,this._model._perNodeShowDirty=!0)}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=G.clone(e,this._matrix),this.useMatrix=!0;let t=this._model;t._cesiumAnimationsDirty=!0,this._runtimeNode.dirtyNumber=t._maxDirtyNumber}},originalMatrix:{get:function(){return this._originalMatrix}}});HF.prototype.setMatrix=function(e){G.clone(e,this._matrix)};var YQ=HF;var Abe=65534;function PS(){}PS.hasExtension=function(e){return g(e.extensionsRequired.CESIUM_primitive_outline)||g(e.extensionsUsed.CESIUM_primitive_outline)};PS.outlinePrimitives=function(e){if(!PS.hasExtension(e))return;let t=e.gltfInternal,n=[];re.mesh(t,function(r,o){re.meshPrimitive(r,function(a,s){if(!g(a.extensions))return;let u=a.extensions.CESIUM_primitive_outline;if(!g(u))return;let l=Mbe(e,a);l!==void 0&&(n.indexOf(l)<0&&n.push(l),bbe(e,o,s,u.indices,l))})});for(let r=0;r<n.length;++r)Ibe(e,n[r].bufferViews);Dbe(e)};PS.createTexture=function(e,t){let n=t.cache.modelOutliningCache;if(g(n)||(n=t.cache.modelOutliningCache={}),g(n.outlineTexture))return n.outlineTexture;let r=Math.min(4096,Jt.maximumTextureSize),o=r,a=jQ(o),s=[];for(;o>1;)o>>=1,s.push(jQ(o));let u=new na({context:t,source:{arrayBufferView:a,mipLevels:s},width:r,height:1,pixelFormat:qt.LUMINANCE,sampler:new Oa({wrapS:Nl.CLAMP_TO_EDGE,wrapT:Nl.CLAMP_TO_EDGE,minificationFilter:In.LINEAR_MIPMAP_LINEAR,magnificationFilter:kf.LINEAR})});return n.outlineTexture=u,u};function bbe(e,t,n,r,o){let a=o.vertexCopies,s=o.extraVertices,u=o.outlineCoordinates,l=e.gltfInternal,f=l.meshes[t].primitives[n],h=l.accessors,d=l.bufferViews,p;for(let O in f.attributes)if(f.attributes.hasOwnProperty(O)){let m=f.attributes[O],I=h[m];if(g(I)){p=I.count;break}}if(!g(p))return;let _=h[f.indices],y=d[_.bufferView],v=h[r],w=d[v.bufferView],C=e._loadResources,E=C.getBuffer(y),S=C.getBuffer(w),A=_.componentType===5123?new Uint16Array(E.buffer,E.byteOffset+_.byteOffset,_.count):new Uint32Array(E.buffer,E.byteOffset+_.byteOffset,_.count),D=v.componentType===5123?new Uint16Array(S.buffer,S.byteOffset+v.byteOffset,v.count):new Uint32Array(S.buffer,S.byteOffset+v.byteOffset,v.count),P=p,M=[P],b;for(b=0;b<D.length;b+=2){let O=D[b],m=D[b+1],I=Math.min(O,m),L=Math.max(O,m);M[I*P+L]=1}for(b=0;b<A.length;b+=3){let O=A[b],m=A[b+1],I=A[b+2],L=!1,R=L||YF(M,O,m),N=L||YF(M,m,I),B=L||YF(M,I,O),V=XQ(u,O,m,I,R,N,B);for(;V>=0;){let z;if(V===O?z=a[O]:V===m?z=a[m]:z=a[I],z===void 0){z=p+s.length;let U=V;for(;U>=p;)U=s[U-p];s.push(U),a[V]=z}z>Abe&&A instanceof Uint16Array&&(A=new Uint32Array(A),_.componentType=5125,y.buffer=l.buffers.push({byteLength:A.byteLength,extras:{_pipeline:{source:A.buffer}}})-1,y.byteLength=A.byteLength,y.byteOffset=0,e._loadResources.buffers[y.buffer]=new Uint8Array(A.buffer,0,A.byteLength),C.indexBuffersToCreate._array.forEach(function(U){!g(U)||U.id===_.bufferView&&(U.componentType=_.componentType)})),V===O?(O=z,A[b]=z):V===m?(m=z,A[b+1]=z):(I=z,A[b+2]=z),g(_.max)&&(_.max[0]=Math.max(_.max[0],z)),V=XQ(u,O,m,I,R,N,B)}}}function qF(e,t,n,r,o){let a=t*3,s=e[a],u=e[a+1],l=e[a+2];return s===void 0?63:((s===n&&u===r&&l===o)<<0)+((s===n&&u===o&&l===r)<<1)+((s===r&&u===n&&l===o)<<2)+((s===r&&u===o&&l===n)<<3)+((s===o&&u===n&&l===r)<<4)+((s===o&&u===r&&l===n)<<5)}function WF(e){return(e&1)+(e>>1&1)+(e>>2&1)+(e>>3&1)+(e>>4&1)+(e>>5&1)}function XQ(e,t,n,r,o,a,s){let u=s?1:0,l=o?1:0,c=0,f=qF(e,t,u,l,c);if(f===0)return t;let h=0,d=o?1:0,p=a?1:0,_=qF(e,n,h,d,p);if(_===0)return n;let y=s?1:0,v=0,w=a?1:0,C=qF(e,r,y,v,w);if(C===0)return r;let E=f&_&C,S,A,D;if(E&1<<0)S=0,A=1,D=2;else if(E&1<<1)S=0,D=1,A=2;else if(E&1<<2)A=0,S=1,D=2;else if(E&1<<3)A=0,D=1,S=2;else if(E&1<<4)D=0,S=1,A=2;else if(E&1<<5)D=0,A=1,S=2;else{let O=WF(f),m=WF(_),I=WF(C);return O<m&&O<I?t:m<I?n:r}let P=t*3;e[P+S]=u,e[P+A]=l,e[P+D]=c;let M=n*3;e[M+S]=h,e[M+A]=d,e[M+D]=p;let b=r*3;return e[b+S]=y,e[b+A]=v,e[b+D]=w,-1}function YF(e,t,n){let r=e[0],o=Math.min(t,n)*r+Math.max(t,n);return e[o]===1}function jQ(e){let t=new Uint8Array(e);return t[e-1]=192,e===8?t[e-1]=96:e===4?t[e-1]=48:e===2?t[e-1]=24:e===1&&(t[e-1]=12),t}function Ibe(e,t){let n=e.gltfInternal,r=e._loadResources,o,a;for(o=0;o<t.length;++o){let s=t[o],u=s.extras._pipeline.vertexNumberingScope;s.extras._pipeline.vertexNumberingScope=void 0;let l=u.extraVertices,c=r.getBuffer(s),f=s.byteStride||4,h=l.length,d=new Uint8Array(c.byteLength+h*f);for(d.set(c),a=0;a<h;++a){let y=l[a]*f,v=c.length+a*f;for(let w=0;w<f;++w)d[v+w]=d[y+w]}s.byteOffset=0,s.byteLength=d.byteLength;let p=n.buffers.push({byteLength:d.byteLength,extras:{_pipeline:{source:d.buffer}}})-1;s.buffer=p,r.buffers[p]=d;let _=u.accessors;for(a=0;a<_.length;++a){let y=_[a];n.accessors[y].count+=h}if(!u.createdOutlines){let y=u.outlineCoordinates,v=new Float32Array(y),w=e.gltfInternal.buffers.push({byteLength:v.byteLength,extras:{_pipeline:{source:v.buffer}}})-1;r.buffers[w]=new Uint8Array(v.buffer,0,v.byteLength);let C=e.gltfInternal.bufferViews.push({buffer:w,byteLength:v.byteLength,byteOffset:0,byteStride:3*Float32Array.BYTES_PER_ELEMENT,target:34962})-1,E=e.gltfInternal.accessors.push({bufferView:C,byteOffset:0,componentType:5126,count:v.length/3,type:"VEC3",min:[0,0,0],max:[1,1,1]})-1,S=u.primitives;for(a=0;a<S.length;++a)S[a].attributes._OUTLINE_COORDINATES=E;r.vertexBuffersToCreate.enqueue(C),u.createdOutlines=!0}}}function Dbe(e){let t=e.gltfInternal,n=e._loadResources,r;for(r=0;r<t.buffers.length;++r){let o=t.buffers[r],a=t.bufferViews.filter(Pbe.bind(void 0,r)),s=a.reduce(function(c,f){return c+f.byteLength},0);if(s===o.byteLength)continue;let u=new Uint8Array(s),l=0;for(let c=0;c<a.length;++c){let f=a[c],h=n.getBuffer(f);u.set(h,l),f.byteOffset=l,l+=h.byteLength}n.buffers[r]=u,o.extras._pipeline.source=u.buffer,o.byteLength=s}}function Pbe(e,t){return t.buffer===e}function Mbe(e,t){let n=t.attributes;if(n===void 0)return;let r=e.gltfInternal,o;for(let a in n){if(!n.hasOwnProperty(a))continue;let s=n[a],l=r.accessors[s].bufferView,c=r.bufferViews[l];if(g(c.extras)||(c.extras={}),g(c.extras._pipeline)||(c.extras._pipeline={}),!g(c.extras._pipeline.vertexNumberingScope))c.extras._pipeline.vertexNumberingScope=o||{vertexCopies:[],extraVertices:[],outlineCoordinates:[],accessors:[],bufferViews:[],primitives:[],createdOutlines:!1};else if(o!==void 0&&c.extras._pipeline.vertexNumberingScope!==o)return;o=c.extras._pipeline.vertexNumberingScope,o.bufferViews.indexOf(c)<0&&o.bufferViews.push(c),o.accessors.indexOf(s)<0&&o.accessors.push(s)}return o.primitives.push(t),o}var XF=PS;var Jr={};Jr.updateForwardAxis=function(e){let t=e.gltfInternal.extras.sourceVersion;(g(t)&&t!=="2.0"||Jr.getAssetVersion(e.gltfInternal)!=="2.0")&&(e._gltfForwardAxis=Hu.X)};Jr.getAssetVersion=function(e){return!g(e.asset)||!g(e.asset.version)?"1.0":e.asset.version};Jr.splitIncompatibleMaterials=function(e){let t=e.accessors,n=e.materials,r={};return re.mesh(e,function(o){re.meshPrimitive(o,function(a){let s=a.material,u=n[s],l=a.attributes.JOINTS_0,c,f;if(g(l)){let S=t[l];c=S.componentType,f=S.type}let h=g(l)&&f==="VEC4",d=g(a.attributes.COLOR_0),p=g(a.targets),_=g(a.attributes.NORMAL),y=g(a.attributes.TANGENT),v=g(a.attributes.TEXCOORD_0),w=v&&g(a.attributes.TEXCOORD_1),C=g(a.extensions)&&g(a.extensions.CESIUM_primitive_outline),E=r[s];if(!g(E))r[s]={skinning:{skinned:h,componentType:c},hasVertexColors:d,hasMorphTargets:p,hasNormals:_,hasTangents:y,hasTexCoords:v,hasTexCoord1:w,hasOutline:C};else if(E.skinning.skinned!==h||E.hasVertexColors!==d||E.hasMorphTargets!==p||E.hasNormals!==_||E.hasTangents!==y||E.hasTexCoords!==v||E.hasTexCoord1!==w||E.hasOutline!==C){let S=Ht(u,!0);s=no(n,S),a.material=s,r[s]={skinning:{skinned:h,componentType:c},hasVertexColors:d,hasMorphTargets:p,hasNormals:_,hasTangents:y,hasTexCoords:v,hasTexCoord1:w,hasOutline:C}}})}),r};Jr.getShaderVariable=function(e){return e==="SCALAR"?"float":e.toLowerCase()};Jr.ModelState={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};Jr.getFailedLoadFunction=function(e,t,n){return function(r){e._state=Jr.ModelState.FAILED;let o=`Failed to load ${t}: ${n}`;g(r)&&(o+=`
${r.message}`),e._readyPromise.reject(new at(o))}};Jr.parseBuffers=function(e,t){let n=e._loadResources;re.buffer(e.gltfInternal,function(r,o){if(g(r.extras._pipeline.source))n.buffers[o]=r.extras._pipeline.source;else if(g(t)){let a=e._resource.getDerivedResource({url:r.uri});++n.pendingBufferLoads,a.fetchArrayBuffer().then(t(e,o)).catch(Jr.getFailedLoadFunction(e,"buffer",a.url))}})};var Lbe=new x,Rbe=new x;Jr.computeBoundingSphere=function(e){let t=e.gltfInternal,n=t.nodes,r=t.meshes,o=t.scenes[t.scene].nodes,a=o.length,s=[],u=new x(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new x(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let f=0;f<a;++f){let h=n[o[f]];for(h._transformToRoot=Jr.getTransform(h),s.push(h);s.length>0;){h=s.pop();let d=h._transformToRoot,p=h.mesh;if(g(p)){let v=r[p].primitives,w=v.length;for(let C=0;C<w;++C){let E=v[C].attributes.POSITION;if(g(E)){let S=Jr.getAccessorMinMax(t,E);if(g(S.min)&&g(S.max)){let A=x.fromArray(S.min,0,Lbe),D=x.fromArray(S.max,0,Rbe);G.multiplyByPoint(d,A,A),G.multiplyByPoint(d,D,D),x.minimumByComponent(u,A,u),x.maximumByComponent(l,D,l)}}}}let _=h.children;if(g(_)){let y=_.length;for(let v=0;v<y;++v){let w=n[_[v]];w._transformToRoot=Jr.getTransform(w),G.multiplyTransformation(d,w._transformToRoot,w._transformToRoot),s.push(w)}}delete h._transformToRoot}}let c=Ee.fromCornerPoints(u,l);return e.forwardAxis===Hu.Z&&Ee.transformWithoutScale(c,Hu.Z_UP_TO_X_UP,c),e._upAxis===Hu.Y?Ee.transformWithoutScale(c,Hu.Y_UP_TO_Z_UP,c):e._upAxis===Hu.X&&Ee.transformWithoutScale(c,Hu.X_UP_TO_Z_UP,c),c};function Obe(e,t){return re.techniqueAttribute(e,function(n,r){if(n.semantic===t)return r})}function Nbe(e,t){let n=e.accessors,r=e.materials,o=e.extensions.KHR_techniques_webgl,a=o.techniques,s=o.programs,u=o.shaders,l=t.targets,c=t.attributes;for(let _ in l)if(l.hasOwnProperty(_)){let y=l[_];for(let v in y)v!=="extras"&&(c[`${v}_${_}`]=y[v])}let f=r[t.material],h=a[f.extensions.KHR_techniques_webgl.technique],d=s[h.program],p=u[d.vertexShader];for(let _ in c)if(c.hasOwnProperty(_)&&!g(Obe(h,_))){let y=c[_],v=n[y],w=_.toLowerCase();w.charAt(0)==="_"&&(w=w.slice(1));let C=`a_${w}`;h.attributes[C]={semantic:_,type:v.componentType};let E=p.extras._pipeline,S=E.source;S=`attribute ${Jr.getShaderVariable(v.type)} ${C};
${S}`,E.source=S}}Jr.ensureSemanticExistence=function(e){return re.mesh(e,function(t){re.meshPrimitive(t,function(n){Nbe(e,n)})}),e};Jr.createAttributeLocations=function(e,t){let n={},r=!1,o=1;if(re.techniqueAttribute(e,function(a,s){/pos/i.test(s)&&!r?(n[s]=0,r=!0):n[s]=o++}),g(t))for(let a in t)t.hasOwnProperty(a)&&(n[a]=o++);return n};Jr.getAccessorMinMax=function(e,t){let n=e.accessors[t],r=n.extensions,o=n.min,a=n.max;if(g(r)){let s=r.WEB3D_quantized_attributes;g(s)&&(o=s.decodedMin,a=s.decodedMax)}return{min:o,max:a}};function KQ(e,t,n,r){return Yo(e,"KHR_techniques_webgl")?function(o,a){if(o.semantic===n&&(!r||!g(o.node)))return a}:function(o,a){let s=t.parameters[o];if(s.semantic===n&&(!r||!g(s.node)))return a}}Jr.getAttributeOrUniformBySemantic=function(e,t,n,r){return re.technique(e,function(o){if(g(n)&&o.program!==n)return;let a=re.techniqueAttribute(o,KQ(e,o,t,r));return g(a)?a:re.techniqueUniform(o,KQ(e,o,t,r))})};Jr.getDiffuseAttributeOrUniform=function(e,t){let n=Jr.getAttributeOrUniformBySemantic(e,"COLOR_0",t);return g(n)||(n=Jr.getAttributeOrUniformBySemantic(e,"_3DTILESDIFFUSE",t)),n};var Bbe=new x,Fbe=new je,zbe=new x;Jr.getTransform=function(e,t){return g(e.matrix)?G.fromColumnMajorArray(e.matrix,t):G.fromTranslationQuaternionRotationScale(x.fromArray(e.translation,0,Bbe),je.unpack(e.rotation,0,Fbe),x.fromArray(e.scale,0,zbe),t)};Jr.getUsedExtensions=function(e){let t=e.extensionsUsed,n={};if(g(t)){let r=t.length;for(let o=0;o<r;o++){let a=t[o];n[a]=!0}}return n};Jr.getRequiredExtensions=function(e){let t=e.extensionsRequired,n={};if(g(t)){let r=t.length;for(let o=0;o<r;o++){let a=t[o];n[a]=!0}}return n};Jr.supportedExtensions={AGI_articulations:!0,CESIUM_RTC:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_binary_glTF:!0,KHR_texture_basisu:!0,KHR_draco_mesh_compression:!0,KHR_materials_common:!0,KHR_techniques_webgl:!0,KHR_materials_unlit:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_texture_transform:!0,WEB3D_quantized_attributes:!0};Jr.checkSupportedExtensions=function(e,t){for(let n in e)if(e.hasOwnProperty(n)){if(!Jr.supportedExtensions[n])throw new at(`Unsupported glTF Extension: ${n}`);if(n==="EXT_texture_webp"&&t===!1)throw new at("Loaded model requires WebP but browser does not support it.")}};Jr.checkSupportedGlExtensions=function(e,t){if(g(e)){let n=e.length;for(let r=0;r<n;r++){let o=e[r];if(o!=="OES_element_index_uint")throw new at(`Unsupported WebGL Extension: ${o}`);if(!t.elementIndexUint)throw new at("OES_element_index_uint WebGL extension is not enabled.")}}};function jF(e,t,n){t+="(?!\\w)",t=new RegExp(t,"g");let r=e.search(t);return e.replace(t,function(o,a){return r===a?o:n})}function Vbe(e,t){let r=e.accessors[t].extensions;if(g(r))return r.WEB3D_quantized_attributes}function ZQ(e,t,n){let r=t.material,o=e.materials[r];if(!Yo(e,"KHR_techniques_webgl")||!g(o.extensions)||!g(o.extensions.KHR_techniques_webgl))return;let a=o.extensions.KHR_techniques_webgl.technique,u=e.extensions.KHR_techniques_webgl.techniques[a];return re.techniqueAttribute(u,function(l,c){if(l.semantic===n)return c})}Jr.modifyShaderForDracoQuantizedAttributes=function(e,t,n,r){let o={};for(let a in r)if(r.hasOwnProperty(a)){let s=r[a],u=s.quantization;if(!g(u))continue;let l=ZQ(e,t,a);a.charAt(0)==="_"&&(a=a.substring(1));let c=`gltf_u_dec_${a.toLowerCase()}`;if(!g(o[c])){let f=`gltf_decoded_${a}`,h=l.replace("a_","gltf_a_dec_"),d=s.componentsPerAttribute;n=jF(n,l,h);let p;u.octEncoded?p="vec3":d>1?p=`vec${d}`:p="float",n=`${p} ${h};
${n}`;let _=d===3&&a==="COLOR_0";_&&(n=jF(n,h,`vec4(${h}, 1.0)`));let y="";if(u.octEncoded){let v=`${c}_rangeConstant`;n=`uniform float ${v};
${n}`,y=`
void main() {
    ${h} = czm_octDecode(${l}.xy, ${v}).zxy;
    ${f}();
}
`}else{let v=`${c}_normConstant`,w=`${c}_min`;n=`uniform float ${v};
uniform ${p} ${w};
${n}`,y=`
void main() {
    ${h} = ${w} + ${l}${_?".xyz":""} * ${v};
    ${f}();
}
`}n=Et.replaceMain(n,f),n+=y}}return{shader:n}};Jr.modifyShaderForQuantizedAttributes=function(e,t,n){let r={},o=t.attributes;for(let a in o)if(o.hasOwnProperty(a)){let s=ZQ(e,t,a),u=t.attributes[a];a.charAt(0)==="_"&&(a=a.substring(1));let l=`gltf_u_dec_${a.toLowerCase()}`,c=`${l}_scale`,f=`${l}_translate`;if(!g(r[l])&&!g(r[c])){let h=Vbe(e,u);if(g(h)){let d=h.decodeMatrix,p=`gltf_decoded_${a}`,_=s.replace("a_","gltf_a_dec_"),y=Math.floor(Math.sqrt(d.length));n=jF(n,s,_);let v;y>2?v=`vec${y-1}`:v="float",n=`${v} ${_};
${n}`;let w="";y===5?(n=`uniform mat4 ${c};
${n}`,n=`uniform vec4 ${f};
${n}`,w=`
void main() {
    ${_} = ${c} * ${s} + ${f};
    ${p}();
}
`,r[c]={mat:4},r[f]={vec:4}):(n=`uniform mat${y} ${l};
${n}`,w=`
void main() {
    ${_} = ${v}(${l} * vec${y}(${s},1.0));
    ${p}();
}
`,r[l]={mat:y}),n=Et.replaceMain(n,p),n+=w}}}return{shader:n,uniforms:r}};function r1(e){let t={value:e,clone:function(n,r){return n},func:function(){return t.value}};return t}function bM(e){let t={value:X.fromArray(e),clone:X.clone,func:function(){return t.value}};return t}function IM(e){let t={value:x.fromArray(e),clone:x.clone,func:function(){return t.value}};return t}function i1(e){let t={value:Se.fromArray(e),clone:Se.clone,func:function(){return t.value}};return t}function KF(e){let t={value:Ra.fromColumnMajorArray(e),clone:Ra.clone,func:function(){return t.value}};return t}function ZF(e){let t={value:te.fromColumnMajorArray(e),clone:te.clone,func:function(){return t.value}};return t}function AM(e){let t={value:G.fromColumnMajorArray(e),clone:G.clone,func:function(){return t.value}};return t}function DM(e,t,n){this._value=void 0,this._textureId=e.index,this._textures=t,this._defaultTexture=n}Object.defineProperties(DM.prototype,{value:{get:function(){if(!g(this._value)){let e=this._textures[this._textureId];if(g(e))this._value=e;else return this._defaultTexture}return this._value},set:function(e){this._value=e}}});DM.prototype.clone=function(e){return e};DM.prototype.func=void 0;function kbe(e,t,n){let r=new DM(e,t,n);return r.func=function(){return r.value},r}var Wu={};Wu[k.FLOAT]=r1;Wu[k.FLOAT_VEC2]=bM;Wu[k.FLOAT_VEC3]=IM;Wu[k.FLOAT_VEC4]=i1;Wu[k.INT]=r1;Wu[k.INT_VEC2]=bM;Wu[k.INT_VEC3]=IM;Wu[k.INT_VEC4]=i1;Wu[k.BOOL]=r1;Wu[k.BOOL_VEC2]=bM;Wu[k.BOOL_VEC3]=IM;Wu[k.BOOL_VEC4]=i1;Wu[k.FLOAT_MAT2]=KF;Wu[k.FLOAT_MAT3]=ZF;Wu[k.FLOAT_MAT4]=AM;Wu[k.SAMPLER_2D]=kbe;Jr.createUniformFunction=function(e,t,n,r){return Wu[e](t,n,r)};function Gbe(e){return[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]]}function Ube(e){return[e[20],e[21],e[22],e[23]]}Jr.createUniformsForDracoQuantizedAttributes=function(e){let t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n],o=r.quantization;if(!g(o))continue;n.charAt(0)==="_"&&(n=n.substring(1));let a=`gltf_u_dec_${n.toLowerCase()}`;if(o.octEncoded){let c=`${a}_rangeConstant`,f=(1<<o.quantizationBits)-1;t[c]=r1(f).func;continue}let s=`${a}_normConstant`,u=o.range/(1<<o.quantizationBits);t[s]=r1(u).func;let l=`${a}_min`;switch(r.componentsPerAttribute){case 1:t[l]=r1(o.minValues).func;break;case 2:t[l]=bM(o.minValues).func;break;case 3:t[l]=IM(o.minValues).func;break;case 4:t[l]=i1(o.minValues).func;break}}return t};Jr.createUniformsForQuantizedAttributes=function(e,t,n){let r=e.accessors,o={},a={},s=t.attributes;for(let u in s)if(s.hasOwnProperty(u)){let l=s[u],c=r[l],f=c.extensions;if(u.charAt(0)==="_"&&(u=u.substring(1)),g(f)){let h=f.WEB3D_quantized_attributes;if(g(h)){let d=h.decodeMatrix,p=`gltf_u_dec_${u.toLowerCase()}`,_,y;switch(c.type){case Wc.SCALAR:a[p]=KF(d).func,o[p]=!0;break;case Wc.VEC2:a[p]=ZF(d).func,o[p]=!0;break;case Wc.VEC3:a[p]=AM(d).func,o[p]=!0;break;case Wc.VEC4:_=`${p}_scale`,y=`${p}_translate`,a[_]=AM(Gbe(d)).func,a[y]=i1(Ube(d)).func,o[_]=!0,o[y]=!0;break}}}}for(let u in n)if(n.hasOwnProperty(u)&&!o[u]){let l=n[u];g(l.mat)&&(l.mat===2?a[u]=KF(Ra.IDENTITY).func:l.mat===3?a[u]=ZF(te.IDENTITY).func:l.mat===4&&(a[u]=AM(G.IDENTITY).func)),g(l.vec)&&l.vec===4&&(a[u]=i1([0,0,0,0]).func)}return a};var n1=new x,Hbe={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){let n=new G;return function(){return g(t._rtcCenter)?(G.getTranslation(e.model,n1),x.add(n1,t._rtcCenter,n1),G.multiplyByPoint(e.view,n1,n1),G.setTranslation(e.modelView,n1,n)):e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};Jr.getGltfSemanticUniforms=function(){return Hbe};var Mr=Jr;function qbe(e){switch(e){case k.FLOAT:return"float";case k.FLOAT_VEC2:return"vec2";case k.FLOAT_VEC3:return"vec3";case k.FLOAT_VEC4:return"vec4";case k.FLOAT_MAT2:return"mat2";case k.FLOAT_MAT3:return"mat3";case k.FLOAT_MAT4:return"mat4";case k.SAMPLER_2D:return"sampler2D";case k.BOOL:return"bool"}}var o1=qbe;function Wbe(e,t){if(t=T(t,T.EMPTY_OBJECT),!g(e)||!Yo(e,"KHR_materials_common"))return;Yo(e,"KHR_techniques_webgl")||(g(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl"));let n=e.extensions.KHR_techniques_webgl;Kbe(e);let r=Ybe(e),o=Mr.splitIncompatibleMaterials(e),a={},s=!1;return re.material(e,function(u,l){if(g(u.extensions)&&g(u.extensions.KHR_materials_common)){let c=u.extensions.KHR_materials_common,f=o[l],h=jbe(c,f),d=a[h];g(d)||(d=Xbe(e,n,f,c,r,t.addBatchIdToGeneratedShaders),a[h]=d,s=!0);let p={},_=c.values,y;for(let v in _)_.hasOwnProperty(v)&&v!=="transparent"&&v!=="doubleSided"&&(y=`u_${v.toLowerCase()}`,p[y]=_[v]);u.extensions.KHR_techniques_webgl={technique:d,values:p},u.alphaMode="OPAQUE",c.transparent&&(u.alphaMode="BLEND"),c.doubleSided&&(u.doubleSided=!0)}}),s&&Mr.ensureSemanticExistence(e),e}function Ybe(e){let t={},n;if(g(e.extensions)&&g(e.extensions.KHR_materials_common)&&(n=e.extensions.KHR_materials_common.lights),g(n)){let r=e.nodes;for(let a in r)if(r.hasOwnProperty(a)){let s=r[a];if(g(s.extensions)&&g(s.extensions.KHR_materials_common)){let u=s.extensions.KHR_materials_common.light;g(u)&&g(n[u])&&(n[u].node=a),delete s.extensions.KHR_materials_common}}let o=0;for(let a in n)if(n.hasOwnProperty(a)){let s=n[a],u=s.type;if(u!=="ambient"&&!g(s.node)){delete n[a];continue}let l=`light${o.toString()}`;s.baseName=l;let c,f,h,d;switch(u){case"ambient":c=s.ambient,t[`${l}Color`]={type:k.FLOAT_VEC3,value:c.color};break;case"directional":f=s.directional,t[`${l}Color`]={type:k.FLOAT_VEC3,value:f.color},g(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:k.FLOAT_MAT4});break;case"point":h=s.point,t[`${l}Color`]={type:k.FLOAT_VEC3,value:h.color},g(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:k.FLOAT_MAT4}),t[`${l}Attenuation`]={type:k.FLOAT_VEC3,value:[h.constantAttenuation,h.linearAttenuation,h.quadraticAttenuation]};break;case"spot":d=s.spot,t[`${l}Color`]={type:k.FLOAT_VEC3,value:d.color},g(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:k.FLOAT_MAT4},t[`${l}InverseTransform`]={node:s.node,semantic:"MODELVIEWINVERSE",type:k.FLOAT_MAT4,useInFragment:!0}),t[`${l}Attenuation`]={type:k.FLOAT_VEC3,value:[d.constantAttenuation,d.linearAttenuation,d.quadraticAttenuation]},t[`${l}FallOff`]={type:k.FLOAT_VEC2,value:[d.fallOffAngle,d.fallOffExponent]};break}++o}}return t}function Xbe(e,t,n,r,o,a){g(r)||(r={}),a=T(a,!1);let s=t.techniques,u=t.shaders,l=t.programs,c=r.technique.toUpperCase(),f;g(e.extensions)&&g(e.extensions.KHR_materials_common)&&(f=e.extensions.KHR_materials_common.lights);let h=r.values,d=T(r.jointCount,0),p,_=!1,y=!1;g(n)&&(p=n.skinning,_=p.skinned,y=n.hasVertexColors);let v=`precision highp float;
`,w=`precision highp float;
`,C=c!=="CONSTANT",E={u_modelViewMatrix:{semantic:Yo(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:k.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:k.FLOAT_MAT4}};C&&(E.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:k.FLOAT_MAT3}),_&&(E.u_jointMatrix={count:d,semantic:"JOINTMATRIX",type:k.FLOAT_MAT4});let S,A=!1;for(let U in h)if(h.hasOwnProperty(U)&&U!=="transparent"&&U!=="doubleSided"){let Q=QQ(U,h[U]);S=`u_${U.toLowerCase()}`,!A&&Q===k.SAMPLER_2D&&(A=!0),E[S]={type:Q}}if(g(E.u_diffuse)&&(E.u_diffuse.semantic="_3DTILESDIFFUSE"),g(o))for(let U in o)o.hasOwnProperty(U)&&(S=`u_${U}`,E[S]=o[U]);for(S in E)if(E.hasOwnProperty(S)){let U=E[S],Q=g(U.count)?`[${U.count}]`:"";U.type!==k.FLOAT_MAT3&&U.type!==k.FLOAT_MAT4||U.useInFragment?(w+=`uniform ${o1(U.type)} ${S}${Q};
`,delete U.useInFragment):v+=`uniform ${o1(U.type)} ${S}${Q};
`}let D="";_&&(D+=`    mat4 skinMatrix =
        a_weight.x * u_jointMatrix[int(a_joint.x)] +
        a_weight.y * u_jointMatrix[int(a_joint.y)] +
        a_weight.z * u_jointMatrix[int(a_joint.z)] +
        a_weight.w * u_jointMatrix[int(a_joint.w)];
`);let P={a_position:{semantic:"POSITION"}};v+=`attribute vec3 a_position;
`,v+=`varying vec3 v_positionEC;
`,_?D+=`  vec4 pos = u_modelViewMatrix * skinMatrix * vec4(a_position,1.0);
`:D+=`  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);
`,D+=`  v_positionEC = pos.xyz;
`,D+=`  gl_Position = u_projectionMatrix * pos;
`,w+=`varying vec3 v_positionEC;
`,C&&(P.a_normal={semantic:"NORMAL"},v+=`attribute vec3 a_normal;
`,v+=`varying vec3 v_normal;
`,_?D+=`  v_normal = u_normalMatrix * mat3(skinMatrix) * a_normal;
`:D+=`  v_normal = u_normalMatrix * a_normal;
`,w+=`varying vec3 v_normal;
`);let M;A&&(P.a_texcoord_0={semantic:"TEXCOORD_0"},M="v_texcoord_0",v+=`attribute vec2 a_texcoord_0;
`,v+=`varying vec2 ${M};
`,D+=`  ${M} = a_texcoord_0;
`,w+=`varying vec2 ${M};
`),_&&(P.a_joint={semantic:"JOINTS_0"},P.a_weight={semantic:"WEIGHTS_0"},v+=`attribute vec4 a_joint;
`,v+=`attribute vec4 a_weight;
`),y&&(P.a_vertexColor={semantic:"COLOR_0"},v+=`attribute vec4 a_vertexColor;
`,v+=`varying vec4 v_vertexColor;
`,D+=`  v_vertexColor = a_vertexColor;
`,w+=`varying vec4 v_vertexColor;
`),a&&(P.a_batchId={semantic:"_BATCHID"},v+=`attribute float a_batchId;
`);let b=C&&(c==="BLINN"||c==="PHONG")&&g(E.u_specular)&&g(E.u_shininess)&&E.u_shininess>0,O=!1,m=!1,I="";for(let U in f)if(f.hasOwnProperty(U)){let Q=f[U],ne=Q.type.toLowerCase(),se=Q.baseName;I+=`  {
`;let de=`u_${se}Color`;if(ne==="ambient")m=!0,I+=`    ambientLight += ${de};
`;else if(C){O=!0;let pe=`v_${se}Direction`,ve=`v_${se}Position`;ne!=="point"&&(v+=`varying vec3 ${pe};
`,w+=`varying vec3 ${pe};
`,D+=`  ${pe} = mat3(u_${se}Transform) * vec3(0.,0.,1.);
`,ne==="directional"&&(I+=`    vec3 l = normalize(${pe});
`)),ne!=="directional"?(v+=`varying vec3 ${ve};
`,w+=`varying vec3 ${ve};
`,D+=`  ${ve} = u_${se}Transform[3].xyz;
`,I+=`    vec3 VP = ${ve} - v_positionEC;
`,I+=`    vec3 l = normalize(VP);
`,I+=`    float range = length(VP);
`,I+=`    float attenuation = 1.0 / (u_${se}Attenuation.x + `,I+=`(u_${se}Attenuation.y * range) + `,I+=`(u_${se}Attenuation.z * range * range));
`):I+=`    float attenuation = 1.0;
`,ne==="spot"&&(I+=`    float spotDot = dot(l, normalize(${pe}));
`,I+=`    if (spotDot < cos(u_${se}FallOff.x * 0.5))
`,I+=`    {
`,I+=`      attenuation = 0.0;
`,I+=`    }
`,I+=`    else
`,I+=`    {
`,I+=`        attenuation *= max(0.0, pow(spotDot, u_${se}FallOff.y));
`,I+=`    }
`),I+=`    diffuseLight += ${de}* max(dot(normal,l), 0.) * attenuation;
`,b&&(c==="BLINN"?(I+=`    vec3 h = normalize(l + viewDir);
`,I+=`    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;
`):(I+=`    vec3 reflectDir = reflect(-l, normal);
`,I+=`    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;
`),I+=`    specularLight += ${de} * specularIntensity;
`)}I+=`  }
`}m||(I+=`  ambientLight += vec3(0.2, 0.2, 0.2);
`),!O&&c!=="CONSTANT"&&(w+=`#ifdef USE_CUSTOM_LIGHT_COLOR 
`,w+=`uniform vec3 gltf_lightColor; 
`,w+=`#endif 
`,I+=`#ifndef USE_CUSTOM_LIGHT_COLOR 
`,I+=`    vec3 lightColor = czm_lightColor;
`,I+=`#else 
`,I+=`    vec3 lightColor = gltf_lightColor;
`,I+=`#endif 
`,I+=`  vec3 l = normalize(czm_lightDirectionEC);
`,I+=`  diffuseLight += lightColor * max(dot(normal,l), 0.2);
`,b&&(c==="BLINN"?(I+=`  vec3 h = normalize(l + viewDir);
`,I+=`  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));
`):(I+=`  vec3 reflectDir = reflect(-l, normal);
`,I+=`  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));
`),I+=`  specularLight += lightColor * specularIntensity;
`)),v+=`void main(void) {
`,v+=D,v+=`}
`,w+=`void main(void) {
`;let L=`  vec3 color = vec3(0.0, 0.0, 0.0);
`;C&&(w+=`  vec3 normal = normalize(v_normal);
`,r.doubleSided&&(w+=`  if (czm_backFacing())
`,w+=`  {
`,w+=`    normal = -normal;
`,w+=`  }
`));let R;c!=="CONSTANT"?(g(E.u_diffuse)&&(E.u_diffuse.type===k.SAMPLER_2D?w+=`  vec4 diffuse = texture2D(u_diffuse, ${M});
`:w+=`  vec4 diffuse = u_diffuse;
`,w+=`  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);
`,L+=`  color += diffuse.rgb * diffuseLight;
`),b&&(E.u_specular.type===k.SAMPLER_2D?w+=`  vec3 specular = texture2D(u_specular, ${M}).rgb;
`:w+=`  vec3 specular = u_specular.rgb;
`,w+=`  vec3 specularLight = vec3(0.0, 0.0, 0.0);
`,L+=`  color += specular * specularLight;
`),g(E.u_transparency)?R=`  gl_FragColor = vec4(color * diffuse.a * u_transparency, diffuse.a * u_transparency);
`:R=`  gl_FragColor = vec4(color * diffuse.a, diffuse.a);
`):g(E.u_transparency)?R=`  gl_FragColor = vec4(color * u_transparency, u_transparency);
`:R=`  gl_FragColor = vec4(color, 1.0);
`,y&&(L+=`  color *= v_vertexColor.rgb;
`),g(E.u_emission)&&(E.u_emission.type===k.SAMPLER_2D?w+=`  vec3 emission = texture2D(u_emission, ${M}).rgb;
`:w+=`  vec3 emission = u_emission.rgb;
`,L+=`  color += emission;
`),(g(E.u_ambient)||c!=="CONSTANT")&&(g(E.u_ambient)?E.u_ambient.type===k.SAMPLER_2D?w+=`  vec3 ambient = texture2D(u_ambient, ${M}).rgb;
`:w+=`  vec3 ambient = u_ambient.rgb;
`:w+=`  vec3 ambient = diffuse.rgb;
`,L+=`  color += ambient * ambientLight;
`),w+=`  vec3 viewDir = -normalize(v_positionEC);
`,w+=`  vec3 ambientLight = vec3(0.0, 0.0, 0.0);
`,w+=I,w+=L,w+=R,w+=`}
`;let N=no(u,{type:k.VERTEX_SHADER,extras:{_pipeline:{source:v,extension:".glsl"}}}),B=no(u,{type:k.FRAGMENT_SHADER,extras:{_pipeline:{source:w,extension:".glsl"}}}),V=no(l,{fragmentShader:B,vertexShader:N});return no(s,{attributes:P,program:V,uniforms:E})}function QQ(e,t){let n;switch(g(t.value)?n=t.value:g(t.index)?n=[t.index]:n=t,e){case"ambient":return n.length===1?k.SAMPLER_2D:k.FLOAT_VEC4;case"diffuse":return n.length===1?k.SAMPLER_2D:k.FLOAT_VEC4;case"emission":return n.length===1?k.SAMPLER_2D:k.FLOAT_VEC4;case"specular":return n.length===1?k.SAMPLER_2D:k.FLOAT_VEC4;case"shininess":return k.FLOAT;case"transparency":return k.FLOAT;case"transparent":return k.BOOL;case"doubleSided":return k.BOOL}}function jbe(e,t){let n="";n+=`technique:${e.technique};`;let r=e.values,o=Object.keys(r).sort(),a=o.length;for(let u=0;u<a;++u){let l=o[u];r.hasOwnProperty(l)&&(n+=`${l}:${QQ(l,r[l])}`,n+=";")}let s=T(e.jointCount,0);if(n+=`${s.toString()};`,g(t)){let u=t.skinning;s>0&&(n+=`${u.type};`),n+=t.hasVertexColors}return n}function Kbe(e){let t=e.extensions.KHR_materials_common;if(!g(t)||!g(t.lights))return;let n=t.lights,r=n.length;for(let o=0;o<r;o++){let a=n[o];if(a.type==="ambient"){g(a.ambient)||(a.ambient={});let s=a.ambient;g(s.color)||(s.color=[1,1,1])}else if(a.type==="directional"){g(a.directional)||(a.directional={});let s=a.directional;g(s.color)||(s.color=[1,1,1])}else if(a.type==="point"){g(a.point)||(a.point={});let s=a.point;g(s.color)||(s.color=[1,1,1]),s.constantAttenuation=T(s.constantAttenuation,1),s.linearAttenuation=T(s.linearAttenuation,0),s.quadraticAttenuation=T(s.quadraticAttenuation,0)}else if(a.type==="spot"){g(a.spot)||(a.spot={});let s=a.spot;g(s.color)||(s.color=[1,1,1]),s.constantAttenuation=T(s.constantAttenuation,1),s.fallOffAngle=T(s.fallOffAngle,3.14159265),s.fallOffExponent=T(s.fallOffExponent,0),s.linearAttenuation=T(s.linearAttenuation,0),s.quadraticAttenuation=T(s.quadraticAttenuation,0)}}}var JQ=Wbe;function Zbe(e,t){if(t=T(t,T.EMPTY_OBJECT),Yo(e,"KHR_techniques_webgl")||!g(e.materials)||e.materials.length===0)return e;g(e.extensions)||(e.extensions={}),g(e.extensionsUsed)||(e.extensionsUsed=[]),g(e.extensionsRequired)||(e.extensionsRequired=[]),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl");let n=Mr.splitIncompatibleMaterials(e);return re.material(e,function(r,o){let a={},s=tIe(e,r,o,a,n,t);g(r.extensions)||(r.extensions={}),r.extensions.KHR_techniques_webgl={values:a,technique:s}}),Mr.ensureSemanticExistence(e),e}function Qbe(e){return g(e.extensions)&&g(e.extensions.KHR_materials_pbrSpecularGlossiness)}function qy(e,t,n,r,o){let a,s=n[t];return g(s)&&g(s.texCoord)&&s.texCoord===1&&(r=r.replace("0","1")),g(n[`${t}Offset`])?(a=`${t}Coord`,o.fragmentShaderMain+=`    vec2 ${a} = computeTexCoord(${r}, ${t}Offset, ${t}Rotation, ${t}Scale);
`):a=r,a}var Jbe=[0,0],$be=[0],eIe=[1,1];function QF(e,t,n){if(e.indexOf("Texture")===-1||!g(t.extensions)||!g(t.extensions.KHR_texture_transform))return;let r=`u_${e}`,o=t.extensions.KHR_texture_transform;n[`${r}Offset`]=T(o.offset,Jbe),n[`${r}Rotation`]=T(o.rotation,$be),n[`${r}Scale`]=T(o.scale,eIe),g(t.texCoord)&&g(o.texCoord)&&(n[r].texCoord=o.texCoord)}function tIe(e,t,n,r,o,a){let s=T(a.addBatchIdToGeneratedShaders,!1),u=e.extensions.KHR_techniques_webgl,l=u.techniques,c=u.shaders,f=u.programs,h=Qbe(t),d,p,_;if(!h){let ut=t.pbrMetallicRoughness;if(g(ut))for(p in ut)ut.hasOwnProperty(p)&&(_=ut[p],d=`u_${p}`,r[d]=_,QF(p,_,r));else r.u_baseColorFactor=[1,1,1,1]}if(h){let ut=t.extensions.KHR_materials_pbrSpecularGlossiness;for(p in ut)ut.hasOwnProperty(p)&&(_=ut[p],d=`u_${p}`,r[d]=_,QF(p,_,r))}for(let ut in t)t.hasOwnProperty(ut)&&(ut.indexOf("Texture")>=0||ut.indexOf("Factor")>=0)&&(_=t[ut],d=`u_${ut}`,r[d]=_,QF(ut,_,r));let y=`precision highp float;
`,v=`precision highp float;
`,w;g(e.skins)&&(w=e.skins[0]);let C=g(w)?w.joints:[],E=C.length,S=o[n],A,D=!1,P=!1,M=!1,b=!1,O=!1,m=!1,I=!1,L=!1,R=!1;g(S)&&(A=S.skinning,D=A.skinned&&C.length>0,P=S.hasVertexColors,M=S.hasMorphTargets,b=S.hasNormals,O=S.hasTangents,m=S.hasTexCoords,I=S.hasTexCoord1,L=S.hasOutline);let N;M&&re.mesh(e,function(ut){re.meshPrimitive(ut,function(ai){if(ai.material===n){let rs=ai.targets;g(rs)&&(N=rs)}})});let B={u_modelViewMatrix:{semantic:Yo(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:k.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:k.FLOAT_MAT4}};g(t.extensions)&&g(t.extensions.KHR_materials_unlit)&&(R=!0),b&&(B.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:k.FLOAT_MAT3}),D&&(B.u_jointMatrix={count:E,semantic:"JOINTMATRIX",type:k.FLOAT_MAT4}),M&&(B.u_morphWeights={count:N.length,semantic:"MORPHWEIGHTS",type:k.FLOAT});let V=t.alphaMode;g(V)&&V==="MASK"&&(B.u_alphaCutoff={semantic:"ALPHACUTOFF",type:k.FLOAT});for(d in r)r.hasOwnProperty(d)&&(B[d]={type:nIe(d)});let z=T(B.u_baseColorTexture,B.u_baseColorFactor);g(z)&&(z.semantic="_3DTILESDIFFUSE");for(d in B)if(B.hasOwnProperty(d)){let ut=B[d],ai=g(ut.count)?`[${ut.count}]`:"";ut.type!==k.FLOAT_MAT3&&ut.type!==k.FLOAT_MAT4&&d!=="u_morphWeights"||ut.useInFragment?(v+=`uniform ${o1(ut.type)} ${d}${ai};
`,delete ut.useInFragment):y+=`uniform ${o1(ut.type)} ${d}${ai};
`}L&&(v+=`uniform sampler2D u_outlineTexture;
`);let U="";D&&(U+=`    mat4 skinMatrix =
        a_weight.x * u_jointMatrix[int(a_joint.x)] +
        a_weight.y * u_jointMatrix[int(a_joint.y)] +
        a_weight.z * u_jointMatrix[int(a_joint.z)] +
        a_weight.w * u_jointMatrix[int(a_joint.w)];
`);let Q={a_position:{semantic:"POSITION"}};if(L&&(Q.a_outlineCoordinates={semantic:"_OUTLINE_COORDINATES"}),y+=`attribute vec3 a_position;
`,b&&(y+=`varying vec3 v_positionEC;
`),L&&(y+=`attribute vec3 a_outlineCoordinates;
`,y+=`varying vec3 v_outlineCoordinates;
`),U+=`    vec3 weightedPosition = a_position;
`,b&&(U+=`    vec3 weightedNormal = a_normal;
`),O&&(U+=`    vec4 weightedTangent = a_tangent;
`),M)for(let ut=0;ut<N.length;ut++){let ai=N[ut];for(let rs in ai)if(ai.hasOwnProperty(rs)&&rs!=="extras"){let fc=`a_${rs}_${ut}`;Q[fc]={semantic:`${rs}_${ut}`},y+=`attribute vec3 ${fc};
`,rs==="POSITION"?U+=`    weightedPosition += u_morphWeights[${ut}] * ${fc};
`:rs==="NORMAL"?U+=`    weightedNormal += u_morphWeights[${ut}] * ${fc};
`:O&&rs==="TANGENT"&&(U+=`    weightedTangent.xyz += u_morphWeights[${ut}] * ${fc};
`)}}D?U+=`    vec4 position = skinMatrix * vec4(weightedPosition, 1.0);
`:U+=`    vec4 position = vec4(weightedPosition, 1.0);
`,U+=`    position = u_modelViewMatrix * position;
`,b&&(U+=`    v_positionEC = position.xyz;
`),U+=`    gl_Position = u_projectionMatrix * position;
`,L&&(U+=`    v_outlineCoordinates = a_outlineCoordinates;
`),b&&(Q.a_normal={semantic:"NORMAL"},y+=`attribute vec3 a_normal;
`,R||(y+=`varying vec3 v_normal;
`,D?U+=`    v_normal = u_normalMatrix * mat3(skinMatrix) * weightedNormal;
`:U+=`    v_normal = u_normalMatrix * weightedNormal;
`,v+=`varying vec3 v_normal;
`),v+=`varying vec3 v_positionEC;
`),O&&(Q.a_tangent={semantic:"TANGENT"},y+=`attribute vec4 a_tangent;
`,y+=`varying vec4 v_tangent;
`,U+=`    v_tangent.xyz = u_normalMatrix * weightedTangent.xyz;
`,U+=`    v_tangent.w = weightedTangent.w;
`,v+=`varying vec4 v_tangent;
`),L&&(v+=`varying vec3 v_outlineCoordinates;
`);let ne="",se,de,pe,ve,ft,pt,Xt,At;if(m){if(Q.a_texcoord_0={semantic:"TEXCOORD_0"},se="v_texcoord_0",y+=`attribute vec2 a_texcoord_0;
`,y+=`varying vec2 ${se};
`,U+=`    ${se} = a_texcoord_0;
`,v+=`varying vec2 ${se};
`,I){Q.a_texcoord_1={semantic:"TEXCOORD_1"};let ai=se.replace("0","1");y+=`attribute vec2 a_texcoord_1;
`,y+=`varying vec2 ${ai};
`,U+=`    ${ai} = a_texcoord_1;
`,v+=`varying vec2 ${ai};
`}let ut={fragmentShaderMain:ne};de=qy(e,"u_normalTexture",r,se,ut),pe=qy(e,"u_baseColorTexture",r,se,ut),ve=qy(e,"u_specularGlossinessTexture",r,se,ut),ft=qy(e,"u_diffuseTexture",r,se,ut),pt=qy(e,"u_metallicRoughnessTexture",r,se,ut),Xt=qy(e,"u_occlusionTexture",r,se,ut),At=qy(e,"u_emissiveTexture",r,se,ut),ne=ut.fragmentShaderMain}D&&(Q.a_joint={semantic:"JOINTS_0"},Q.a_weight={semantic:"WEIGHTS_0"},y+=`attribute vec4 a_joint;
`,y+=`attribute vec4 a_weight;
`),P&&(Q.a_vertexColor={semantic:"COLOR_0"},y+=`attribute vec4 a_vertexColor;
`,y+=`varying vec4 v_vertexColor;
`,U+=`  v_vertexColor = a_vertexColor;
`,v+=`varying vec4 v_vertexColor;
`),s&&(Q.a_batchId={semantic:"_BATCHID"},y+=`attribute float a_batchId;
`),y+=`void main(void) 
{
`,y+=U,y+=`}
`,b&&!R&&(v+=`const float M_PI = 3.141592653589793;
`,v+=`vec3 lambertianDiffuse(vec3 diffuseColor) 
{
    return diffuseColor / M_PI;
}

`,v+=`vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) 
{
    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}

`,v+=`vec3 fresnelSchlick(float metalness, float VdotH) 
{
    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);
}

`,v+=`float smithVisibilityG1(float NdotV, float roughness) 
{
    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
    return NdotV / (NdotV * (1.0 - k) + k);
}

`,v+=`float smithVisibilityGGX(float roughness, float NdotL, float NdotV) 
{
    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);
}

`,v+=`float GGX(float roughness, float NdotH) 
{
    float roughnessSquared = roughness * roughness;
    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
    return roughnessSquared / (M_PI * f * f);
}

`),v+=`vec3 SRGBtoLINEAR3(vec3 srgbIn) 
{
    return pow(srgbIn, vec3(2.2));
}

`,v+=`vec4 SRGBtoLINEAR4(vec4 srgbIn) 
{
    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
    return vec4(linearOut, srgbIn.a);
}

`,v+=`vec3 applyTonemapping(vec3 linearIn) 
{
#ifndef HDR 
    return czm_acesTonemapping(linearIn);
#else 
    return linearIn;
#endif 
}

`,v+=`vec3 LINEARtoSRGB(vec3 linearIn) 
{
#ifndef HDR 
    return pow(linearIn, vec3(1.0/2.2));
#else 
    return linearIn;
#endif 
}

`,v+=`vec2 computeTexCoord(vec2 texCoords, vec2 offset, float rotation, vec2 scale) 
{
    rotation = -rotation; 
    mat3 transform = mat3(
        cos(rotation) * scale.x, sin(rotation) * scale.x, 0.0, 
       -sin(rotation) * scale.y, cos(rotation) * scale.y, 0.0, 
        offset.x, offset.y, 1.0); 
    vec2 transformedTexCoords = (transform * vec3(fract(texCoords), 1.0)).xy; 
    return transformedTexCoords; 
}

`,v+=`#ifdef USE_IBL_LIGHTING 
`,v+=`uniform vec2 gltf_iblFactor; 
`,v+=`#endif 
`,v+=`#ifdef USE_CUSTOM_LIGHT_COLOR 
`,v+=`uniform vec3 gltf_lightColor; 
`,v+=`#endif 
`,v+=`void main(void) 
{
`,v+=ne,b&&!R&&(v+=`    vec3 ng = normalize(v_normal);
`,v+=`    vec3 positionWC = vec3(czm_inverseView * vec4(v_positionEC, 1.0));
`,g(r.u_normalTexture)?O?(v+=`    vec3 t = normalize(v_tangent.xyz);
`,v+=`    vec3 b = normalize(cross(ng, t) * v_tangent.w);
`,v+=`    mat3 tbn = mat3(t, b, ng);
`,v+=`    vec3 n = texture2D(u_normalTexture, ${de}).rgb;
`,v+=`    n = normalize(tbn * (2.0 * n - 1.0));
`):(v=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
${v}`,v+=`#ifdef GL_OES_standard_derivatives
`,v+=`    vec3 pos_dx = dFdx(v_positionEC);
`,v+=`    vec3 pos_dy = dFdy(v_positionEC);
`,v+=`    vec3 tex_dx = dFdx(vec3(${de},0.0));
`,v+=`    vec3 tex_dy = dFdy(vec3(${de},0.0));
`,v+=`    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);
`,v+=`    t = normalize(t - ng * dot(ng, t));
`,v+=`    vec3 b = normalize(cross(ng, t));
`,v+=`    mat3 tbn = mat3(t, b, ng);
`,v+=`    vec3 n = texture2D(u_normalTexture, ${de}).rgb;
`,v+=`    n = normalize(tbn * (2.0 * n - 1.0));
`,v+=`#else
`,v+=`    vec3 n = ng;
`,v+=`#endif
`):v+=`    vec3 n = ng;
`,t.doubleSided&&(v+=`    if (czm_backFacing())
`,v+=`    {
`,v+=`        n = -n;
`,v+=`    }
`)),g(r.u_baseColorTexture)?(v+=`    vec4 baseColorWithAlpha = SRGBtoLINEAR4(texture2D(u_baseColorTexture, ${pe}));
`,g(r.u_baseColorFactor)&&(v+=`    baseColorWithAlpha *= u_baseColorFactor;
`)):g(r.u_baseColorFactor)?v+=`    vec4 baseColorWithAlpha = u_baseColorFactor;
`:v+=`    vec4 baseColorWithAlpha = vec4(1.0);
`,P&&(v+=`    baseColorWithAlpha *= v_vertexColor;
`),v+=`    vec3 baseColor = baseColorWithAlpha.rgb;
`,b&&!R?(h?(g(r.u_specularGlossinessTexture)?(v+=`    vec4 specularGlossiness = SRGBtoLINEAR4(texture2D(u_specularGlossinessTexture, ${ve}));
`,v+=`    vec3 specular = specularGlossiness.rgb;
`,v+=`    float glossiness = specularGlossiness.a;
`,g(r.u_specularFactor)&&(v+=`    specular *= u_specularFactor;
`),g(r.u_glossinessFactor)&&(v+=`    glossiness *= u_glossinessFactor;
`)):(g(r.u_specularFactor)?v+=`    vec3 specular = clamp(u_specularFactor, vec3(0.0), vec3(1.0));
`:v+=`    vec3 specular = vec3(1.0);
`,g(r.u_glossinessFactor)?v+=`    float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);
`:v+=`    float glossiness = 1.0;
`),g(r.u_diffuseTexture)?(v+=`    vec4 diffuse = SRGBtoLINEAR4(texture2D(u_diffuseTexture, ${ft}));
`,g(r.u_diffuseFactor)&&(v+=`    diffuse *= u_diffuseFactor;
`)):g(r.u_diffuseFactor)?v+=`    vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));
`:v+=`    vec4 diffuse = vec4(1.0);
`,v+=`    baseColorWithAlpha.a = diffuse.a;
`):g(r.u_metallicRoughnessTexture)?(v+=`    vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, ${pt}).rgb;
`,v+=`    float metalness = clamp(metallicRoughness.b, 0.0, 1.0);
`,v+=`    float roughness = clamp(metallicRoughness.g, 0.04, 1.0);
`,g(r.u_metallicFactor)&&(v+=`    metalness *= u_metallicFactor;
`),g(r.u_roughnessFactor)&&(v+=`    roughness *= u_roughnessFactor;
`)):(g(r.u_metallicFactor)?v+=`    float metalness = clamp(u_metallicFactor, 0.0, 1.0);
`:v+=`    float metalness = 1.0;
`,g(r.u_roughnessFactor)?v+=`    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);
`:v+=`    float roughness = 1.0;
`),v+=`    vec3 v = -normalize(v_positionEC);
`,v+=`#ifndef USE_CUSTOM_LIGHT_COLOR 
`,v+=`    vec3 lightColorHdr = czm_lightColorHdr;
`,v+=`#else 
`,v+=`    vec3 lightColorHdr = gltf_lightColor;
`,v+=`#endif 
`,v+=`    vec3 l = normalize(czm_lightDirectionEC);
`,v+=`    vec3 h = normalize(v + l);
`,v+=`    float NdotL = clamp(dot(n, l), 0.001, 1.0);
`,v+=`    float NdotV = abs(dot(n, v)) + 0.001;
`,v+=`    float NdotH = clamp(dot(n, h), 0.0, 1.0);
`,v+=`    float LdotH = clamp(dot(l, h), 0.0, 1.0);
`,v+=`    float VdotH = clamp(dot(v, h), 0.0, 1.0);
`,v+=`    vec3 f0 = vec3(0.04);
`,h?(v+=`    float roughness = 1.0 - glossiness;
`,v+=`    vec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));
`,v+=`    vec3 specularColor = specular;
`):(v+=`    vec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);
`,v+=`    vec3 specularColor = mix(f0, baseColor, metalness);
`),v+=`    float alpha = roughness * roughness;
`,v+=`    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);
`,v+=`    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
`,v+=`    vec3 r0 = specularColor.rgb;
`,v+=`    vec3 F = fresnelSchlick2(r0, r90, VdotH);
`,v+=`    float G = smithVisibilityGGX(alpha, NdotL, NdotV);
`,v+=`    float D = GGX(alpha, NdotH);
`,v+=`    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
`,v+=`    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
`,v+=`    vec3 color = NdotL * lightColorHdr * (diffuseContribution + specularContribution);
`,v+=`#if defined(USE_IBL_LIGHTING) && !defined(DIFFUSE_IBL) && !defined(SPECULAR_IBL) 
`,v+=`    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));
`,v+=`    float vertexRadius = length(positionWC);
`,v+=`    float horizonDotNadir = 1.0 - min(1.0, czm_ellipsoidRadii.x / vertexRadius);
`,v+=`    float reflectionDotNadir = dot(r, normalize(positionWC));
`,v+=`    r.x = -r.x;
`,v+=`    r = -normalize(czm_temeToPseudoFixed * r);
`,v+=`    r.x = -r.x;
`,v+=`    float inverseRoughness = 1.04 - roughness;
`,v+=`    inverseRoughness *= inverseRoughness;
`,v+=`    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;
`,v+=`    float atmosphereHeight = 0.05;
`,v+=`    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);
`,v+=`    float blendRegionOffset = roughness * -1.0;
`,v+=`    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);
`,v+=`    vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);
`,v+=`    vec3 nadirColor = belowHorizonColor * 0.5;
`,v+=`    vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);
`,v+=`    vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);
`,v+=`    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);
`,v+=`    vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);
`,v+=`    float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;
`,v+=`    float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));
`,v+=`    vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);
`,v+=`    float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);
`,v+=`    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);
`,v+=`    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);
`,v+=`    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);
`,v+=`#ifdef USE_SUN_LUMINANCE 
`,v+=`    float LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), normalize(positionWC * -1.0)), 0.001, 1.0);
`,v+=`    float S = acos(LdotZenith);
`,v+=`    float NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), normalize(positionWC * -1.0)), 0.001, 1.0);
`,v+=`    float gamma = acos(NdotL);
`,v+=`    float numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));
`,v+=`    float denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));
`,v+=`    float luminance = gltf_luminanceAtZenith * (numerator / denominator);
`,v+=`#endif 
`,v+=`    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
`,v+=`    vec3 IBLColor = (diffuseIrradiance * diffuseColor * gltf_iblFactor.x) + (specularIrradiance * SRGBtoLINEAR3(specularColor * brdfLut.x + brdfLut.y) * gltf_iblFactor.y);
`,v+=`    float maximumComponent = max(max(lightColorHdr.x, lightColorHdr.y), lightColorHdr.z);
`,v+=`    vec3 lightColor = lightColorHdr / max(maximumComponent, 1.0);
`,v+=`    IBLColor *= lightColor;
`,v+=`#ifdef USE_SUN_LUMINANCE 
`,v+=`    color += IBLColor * luminance;
`,v+=`#else 
`,v+=`    color += IBLColor; 
`,v+=`#endif 
`,v+=`#elif defined(DIFFUSE_IBL) || defined(SPECULAR_IBL) 
`,v+=`    const mat3 yUpToZUp = mat3(-1.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0); 
`,v+=`    vec3 cubeDir = normalize(yUpToZUp * gltf_iblReferenceFrameMatrix * normalize(reflect(-v, n))); 
`,v+=`#ifdef DIFFUSE_IBL 
`,v+=`#ifdef CUSTOM_SPHERICAL_HARMONICS 
`,v+=`    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, gltf_sphericalHarmonicCoefficients); 
`,v+=`#else 
`,v+=`    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); 
`,v+=`#endif 
`,v+=`#else 
`,v+=`    vec3 diffuseIrradiance = vec3(0.0); 
`,v+=`#endif 
`,v+=`#ifdef SPECULAR_IBL 
`,v+=`    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
`,v+=`#ifdef CUSTOM_SPECULAR_IBL 
`,v+=`    vec3 specularIBL = czm_sampleOctahedralProjection(gltf_specularMap, gltf_specularMapSize, cubeDir,  roughness * gltf_maxSpecularLOD, gltf_maxSpecularLOD);
`,v+=`#else 
`,v+=`    vec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);
`,v+=`#endif 
`,v+=`    specularIBL *= F * brdfLut.x + brdfLut.y;
`,v+=`#else 
`,v+=`    vec3 specularIBL = vec3(0.0); 
`,v+=`#endif 
`,v+=`    color += diffuseIrradiance * diffuseColor + specularColor * specularIBL;
`,v+=`#endif 
`):v+=`    vec3 color = baseColor;
`,R||(g(r.u_occlusionTexture)&&(v+=`    color *= texture2D(u_occlusionTexture, ${Xt}).r;
`),g(r.u_emissiveTexture)?(v+=`    vec3 emissive = SRGBtoLINEAR3(texture2D(u_emissiveTexture, ${At}).rgb);
`,g(r.u_emissiveFactor)&&(v+=`    emissive *= u_emissiveFactor;
`),v+=`    color += emissive;
`):g(r.u_emissiveFactor)&&(v+=`    color += u_emissiveFactor;
`)),R||(v+=`    color = applyTonemapping(color);
`),v+=`    color = LINEARtoSRGB(color);
`,L&&(v+=`    float outlineness = max(
`,v+=`        texture2D(u_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r,
`,v+=`        max(
`,v+=`          texture2D(u_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r,
`,v+=`          texture2D(u_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r));
`,v+=`    color = mix(color, vec3(0.0, 0.0, 0.0), outlineness);
`),g(V)?V==="MASK"?(v+=`    if (baseColorWithAlpha.a < u_alphaCutoff) {
`,v+=`        discard;
`,v+=`    }
`,v+=`    gl_FragColor = vec4(color, 1.0);
`):V==="BLEND"?v+=`    gl_FragColor = vec4(color, baseColorWithAlpha.a);
`:v+=`    gl_FragColor = vec4(color, 1.0);
`:v+=`    gl_FragColor = vec4(color, 1.0);
`,v+=`}
`;let wt=no(c,{type:k.VERTEX_SHADER,extras:{_pipeline:{source:y,extension:".glsl"}}}),Rr=no(c,{type:k.FRAGMENT_SHADER,extras:{_pipeline:{source:v,extension:".glsl"}}}),gi=no(f,{fragmentShader:Rr,vertexShader:wt});return no(l,{attributes:Q,program:gi,uniforms:B})}function nIe(e){if(e.indexOf("Offset")!==-1)return k.FLOAT_VEC2;if(e.indexOf("Rotation")!==-1)return k.FLOAT;if(e.indexOf("Scale")!==-1)return k.FLOAT_VEC2;if(e.indexOf("Texture")!==-1)return k.SAMPLER_2D;switch(e){case"u_baseColorFactor":return k.FLOAT_VEC4;case"u_metallicFactor":return k.FLOAT;case"u_roughnessFactor":return k.FLOAT;case"u_emissiveFactor":return k.FLOAT_VEC3;case"u_diffuseFactor":return k.FLOAT_VEC4;case"u_specularFactor":return k.FLOAT_VEC3;case"u_glossinessFactor":return k.FLOAT}}var $Q=Zbe;var rIe={LEFT:-1,NONE:0,RIGHT:1,UP:1,BOTTOM:-1},Wy=Object.freeze(rIe);var iIe={modifyFragmentShader:function(t){return t=Et.replaceMain(t,"czm_splitter_main"),t+=`uniform float czm_splitDirection; 
void main() 
{ 
#ifndef SHADOW_MAP
    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; 
    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; 
#endif
    czm_splitter_main(); 
} 
`,t},addUniforms:function(t,n){n.czm_splitDirection=function(){return t.splitDirection}}},JF=iIe;var oIe=new x,gg=Mr.ModelState,aIe="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01",sIe=F.EPSILON16;function oz(e,t){e._cachedGltf=t}function LS(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object.defineProperties(LS.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}});LS.prototype.makeReady=function(e){this.gltf=e;let t=this.modelsToLoad,n=t.length;for(let r=0;r<n;++r){let o=t[r];o.isDestroyed()||oz(o,this)}this.modelsToLoad=void 0,this.ready=!0};var X0={},eJ={};function gu(e){e=T(e,T.EMPTY_OBJECT);let t=e.cacheKey;this._cacheKey=t,this._cachedGltf=void 0,this._releaseGltfJson=T(e.releaseGltfJson,!1);let n;if(g(t)&&g(X0[t])&&X0[t].ready)n=X0[t],++n.count;else{let s=e.gltf;if(g(s)){if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),s instanceof Uint8Array){let u=Yx(s);n=new LS({gltf:u,ready:!0})}else n=new LS({gltf:e.gltf,ready:!0});n.count=1,g(t)&&(X0[t]=n)}}oz(this,n);let r=T(e.basePath,"");this._resource=vt.createIfNeeded(r);let o=e.credit;typeof o=="string"&&(o=new AS(o)),this._credit=o,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=T(e.showCreditsOnScreen,!1),this.show=T(e.show,!0),this.silhouetteColor=T(e.silhouetteColor,K.RED),this._silhouetteColor=new K,this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=T(e.silhouetteSize,0),this.modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._modelMatrix=G.clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=T(e.scale,1),this._scale=this.scale,this.minimumPixelSize=T(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=T(e.heightReference,Lt.NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;let a=e.scene;this._scene=a,g(a)&&g(a.terrainProviderChanged)&&(this._terrainProviderChangedCallback=a.terrainProviderChanged.addEventListener(function(){this._heightChanged=!0},this)),this._pickObject=e.pickObject,this._allowPicking=T(e.allowPicking,!0),this._ready=!1,this._readyPromise=Bo(),this.activeAnimations=new GQ(this),this.clampAnimations=T(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=T(e.incrementallyLoadTextures,!0),this._asynchronous=T(e.asynchronous,!0),this.shadows=T(e.shadows,io.ENABLED),this._shadows=this.shadows,this.color=K.clone(T(e.color,K.WHITE)),this._colorPreviousAlpha=1,this.colorBlendMode=T(e.colorBlendMode,cg.HIGHLIGHT),this.colorBlendAmount=T(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.referenceMatrix=void 0,this.backFaceCulling=T(e.backFaceCulling,!0),this.showOutline=T(e.showOutline,!0),this.splitDirection=T(e.splitDirection,Wy.NONE),this._splittingEnabled=!1,this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=T(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=T(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=T(e.upAxis,Hu.Y),this._gltfForwardAxis=Hu.Z,this._forwardAxis=e.forwardAxis,this.cull=T(e.cull,!0),this.opaquePass=T(e.opaquePass,en.OPAQUE),this._computedModelMatrix=new G,this._clippingPlanesMatrix=G.clone(G.IDENTITY),this._iblReferenceFrameMatrix=te.clone(te.IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new Ee,this._state=gg.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,articulationsByName:void 0,articulationsByStageKey:void 0,stagesByKey:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,e.dequantizeInShader&&ul("EV_MTModel.dequantizeInShader","The EV_MTModel dequantizeInShader constructor parameter was deprecated in CesiumJS 1.94 and will be removed in 1.97"),this._dequantizeInShader=T(e.dequantizeInShader,!0),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._pointsLength=0,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._lightColor=x.clone(e.lightColor),g(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new fg,this._shouldDestroyImageBasedLighting=!0),this._shouldRegenerateShaders=!1,this.recreateVertexArraysOnce=!1,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._boundingBox=void 0}Object.defineProperties(gu.prototype,{gltf:{get:function(){return ul("EV_MTModel.gltf","EV_MTModel.gltf getter was deprecated in CesiumJS 1.94 and will be removed in 1.97"),this.gltfInternal}},gltfInternal:{get:function(){return g(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return ul("model.basePath","EV_MTModel.basePath getter is deprecated in CesiumJS 1.94. It will be removed in CesiumJS 1.97"),this.basePathInternal}},basePathInternal:{get:function(){return this._resource.url}},boundingSphere:{get:function(){let e=this.modelMatrix;this.heightReference!==Lt.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);let t=g(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale,n=Ee.clone(this._boundingSphere,this._scaledBoundingSphere);return n.radius*=t,Ee.transform(n,e,n),g(this._rtcCenter)&&x.add(this._rtcCenter,n.center,n.center),n}},boundingSphereInternal:{get:function(){let e=this.modelMatrix;this.heightReference!==Lt.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);let t=G.getScale(e,oIe),n=g(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;x.multiplyByScalar(t,n,t);let r=this._scaledBoundingSphere;return r.center=x.multiplyComponents(this._boundingSphere.center,t,r.center),r.radius=x.maximumComponent(t)*this._initialRadius,g(this._rtcCenter)&&x.add(this._rtcCenter,r.center,r.center),r}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return ul("EV_MTModel.pendingTextureLoads","The EV_MTModel.pendingTextureLoads getter was deprecated in CesiumJS 1.94 and will be removed in CesiumJS 1.97"),this.pendingTextureLoadsInternal}},pendingTextureLoadsInternal:{get:function(){return g(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=yn.clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return g(this._extensionsUsed)||(this._extensionsUsed=Mr.getUsedExtensions(this.gltfInternal)),this._extensionsUsed}},extensionsRequired:{get:function(){return g(this._extensionsRequired)||(this._extensionsRequired=Mr.getRequiredExtensions(this.gltfInternal)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return g(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&bS.setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},lightColor:{get:function(){return this._lightColor},set:function(e){let t=this._lightColor;e===t||x.equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||g(t)&&!g(e)||g(e)&&!g(t),this._lightColor=x.clone(e,t))}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this._shouldRegenerateShaders=!0)}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){if(this._showCreditsOnScreen!==e){g(this._credit)&&(this._credit.showOnScreen=e);let t=this._resourceCredits.length;for(let r=0;r<t;r++)this._resourceCredits[r].showOnScreen=e;let n=this._gltfCredits.length;for(let r=0;r<n;r++)this._gltfCredits[r].showOnScreen=e}this._showCreditsOnScreen=e}}});function hJ(e){return e.stencilBuffer}function az(e){return!K.equals(e.color,K.WHITE)||e.colorBlendMode!==cg.HIGHLIGHT}function sz(e){let t=e._clippingPlanes;return g(t)&&t.enabled&&t.length!==0}gu.silhouetteSupported=function(e){return hJ(e.context)};function uIe(e){return _M(e)==="glTF"}gu.fromGltf=function(e){let t=e.url;e=Ht(e);let n=vt.createIfNeeded(t),r=T(e.basePath,n.clone()),o=vt.createIfNeeded(r),a=T(e.cacheKey,eJ[S_(n.url)]);g(a)||(a=Ci(),eJ[S_(n.url)]=a),g(e.basePath)&&!g(e.cacheKey)&&(a+=o.url),e.cacheKey=a,e.basePath=o;let s=new gu(e),u=X0[a];return g(u)?u.ready||(++u.count,u.modelsToLoad.push(s)):(u=new LS({ready:!1}),u.count=1,u.modelsToLoad.push(s),oz(s,u),X0[a]=u,g(n.headers.Accept)||(n.headers.Accept=aIe),n.fetchArrayBuffer().then(function(l){let c=new Uint8Array(l);if(uIe(c)){let d=Yx(c);u.makeReady(d)}else{let d=eQ(c);u.makeReady(d)}let f=s._resourceCredits,h=n.credits;if(g(h)){let d=h.length;for(let p=0;p<d;p++)f.push(h[p])}}).catch(Mr.getFailedLoadFunction(s,"model",n.url))),s};gu._gltfCache=X0;function RS(e,t,n){return e._runtime[t][n]}gu.prototype.getNode=function(e){let t=RS(this,"nodesByName",e);return g(t)?t.publicNode:void 0};gu.prototype.getMesh=function(e){return RS(this,"meshesByName",e)};gu.prototype.getMaterial=function(e){return RS(this,"materialsByName",e)};gu.prototype.setArticulationStage=function(e,t){let n=RS(this,"stagesByKey",e),r=RS(this,"articulationsByStageKey",e);g(n)&&g(r)&&(t=F.clamp(t,n.minimumValue,n.maximumValue),F.equalsEpsilon(n.currentValue,t,sIe)||(n.currentValue=t,r.isDirty=!0))};var lIe=new x,$F=new te;function dJ(e,t){let n=e.currentValue,r=lIe,o;switch(e.type){case"xRotate":o=te.fromRotationX(F.toRadians(n),$F),G.multiplyByMatrix3(t,o,t);break;case"yRotate":o=te.fromRotationY(F.toRadians(n),$F),G.multiplyByMatrix3(t,o,t);break;case"zRotate":o=te.fromRotationZ(F.toRadians(n),$F),G.multiplyByMatrix3(t,o,t);break;case"xTranslate":r.x=n,r.y=0,r.z=0,G.multiplyByTranslation(t,r,t);break;case"yTranslate":r.x=0,r.y=n,r.z=0,G.multiplyByTranslation(t,r,t);break;case"zTranslate":r.x=0,r.y=0,r.z=n,G.multiplyByTranslation(t,r,t);break;case"xScale":r.x=n,r.y=1,r.z=1,G.multiplyByScale(t,r,t);break;case"yScale":r.x=1,r.y=n,r.z=1,G.multiplyByScale(t,r,t);break;case"zScale":r.x=1,r.y=1,r.z=n,G.multiplyByScale(t,r,t);break;case"uniformScale":G.multiplyByUniformScale(t,n,t);break;default:break}return t}var cIe=new G;gu.prototype.applyArticulations=function(){let e=this._runtime.articulationsByName;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];if(n.isDirty){n.isDirty=!1;let r=n.nodes.length;for(let o=0;o<r;++o){let a=n.nodes[o],s=G.clone(a.originalMatrix,cIe),u=n.stages.length;for(let l=0;l<u;++l){let c=n.stages[l];s=dJ(c,s)}a.matrix=s}}}};function fIe(e){let t=e.gltfInternal,n=e._loadResources;re.buffer(t,function(r,o){n.buffers[o]=r.extras._pipeline.source})}function hIe(e,t){return function(n){let r=e._loadResources,o=new Uint8Array(n);--r.pendingBufferLoads,e.gltfInternal.buffers[t].extras._pipeline.source=o}}function dIe(e){let t=e.gltfInternal.bufferViews,n=e._loadResources.vertexBuffersToCreate;re.bufferView(e.gltfInternal,function(a,s){a.target===k.ARRAY_BUFFER&&n.enqueue(s)});let r=e._loadResources.indexBuffersToCreate,o={};re.accessor(e.gltfInternal,function(a){let s=a.bufferView;if(!g(s))return;t[s].target===k.ELEMENT_ARRAY_BUFFER&&!g(o[s])&&(o[s]=!0,r.enqueue({id:s,componentType:a.componentType}))})}function pIe(e){let t=e.gltfInternal;if(!Yo(t,"KHR_techniques_webgl"))return;let n=e._sourcePrograms,r=e._sourceTechniques,o=t.extensions.KHR_techniques_webgl.programs;re.technique(t,function(a,s){r[s]=Ht(a);let u=a.program;g(n[u])||(n[u]=Ht(o[u]))})}function mIe(e,t,n){return function(r){let o=e._loadResources;o.shaders[n]={source:r,type:t,bufferView:void 0},--o.pendingShaderLoads,e._rendererResources.sourceShaders[n]=r}}function gIe(e){let t=e.gltfInternal,n=t.buffers,r=t.bufferViews,o=e._rendererResources.sourceShaders;re.shader(t,function(a,s){if(g(a.bufferView)){let u=a.bufferView,l=r[u],c=l.buffer,f=n[c],h=Zl(f.extras._pipeline.source,l.byteOffset,l.byteLength);o[s]=h}else if(g(a.extras._pipeline.source))o[s]=a.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;let u=e._resource.getDerivedResource({url:a.uri});u.fetchText().then(mIe(e,a.type,s)).catch(Mr.getFailedLoadFunction(e,"shader",u.url))}})}function _Ie(e){let t=e._sourceTechniques;for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e._loadResources.programsToCreate.enqueue({programId:r.program,techniqueId:n})}}function yIe(e){let t={},n={},r={};e._runtime.articulationsByName=t,e._runtime.articulationsByStageKey=n,e._runtime.stagesByKey=r;let o=e.gltfInternal;if(!Yo(o,"AGI_articulations")||!g(o.extensions)||!g(o.extensions.AGI_articulations))return;let a=o.extensions.AGI_articulations.articulations;if(!g(a))return;let s=a.length;for(let u=0;u<s;++u){let l=Ht(a[u]);l.nodes=[],l.isDirty=!0,t[l.name]=l;let c=l.stages.length;for(let f=0;f<c;++f){let h=l.stages[f];h.currentValue=h.initialValue;let d=`${l.name} ${h.name}`;n[d]=l,r[d]=h}}}function pJ(e,t){return function(n){let r=e._loadResources;--r.pendingTextureLoads;let o;Array.isArray(n)&&(o=n.slice(1,n.length).map(function(a){return a.bufferView}),n=n[0]),r.texturesToCreate.enqueue({id:t,image:n,bufferView:n.bufferView,width:n.width,height:n.height,internalFormat:n.internalFormat,mipLevels:o})}}var vIe=/(^data:image\/ktx)|(data:image\/ktx)|(\.ktx$)|(\.ktx.gz$)/i,CIe=/(^data:image\/ktx2)|(\.ktx2$)/i;function xIe(e,t,n){let r=e.gltfInternal,o=r.images,a;re.texture(r,function(s,u){let l=s.source;g(s.extensions)&&g(s.extensions.EXT_texture_webp)&&n?l=s.extensions.EXT_texture_webp.source:g(s.extensions)&&g(s.extensions.KHR_texture_basisu)&&t.supportsBasis&&(l=s.extensions.KHR_texture_basisu.source);let c=o[l],f=c.bufferView,h=c.mimeType;if(a=c.uri,g(f))e._loadResources.texturesToCreateFromBufferView.enqueue({id:u,image:void 0,bufferView:f,mimeType:h});else{++e._loadResources.pendingTextureLoads;let d=e._resource.getDerivedResource({url:a}),p;vIe.test(a)?p=$P(d):CIe.test(a)?p=Lm(d):p=d.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0}),p.then(pJ(e,u,l)).catch(Mr.getFailedLoadFunction(e,"image",d.url))}})}var wIe=new G;function EIe(e){let t={},n={},r=[],o=e._loadResources.skinnedNodesIds,a=e._runtime.articulationsByName;re.node(e.gltfInternal,function(s,u){let l={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new G,computedMatrix:new G,dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:s.jointName,weights:[],children:[],parents:[],publicNode:void 0};if(l.publicNode=new YQ(e,s,l,u,Mr.getTransform(s)),t[u]=l,n[s.name]=l,g(s.skin)&&(o.push(u),r.push(l)),g(s.extensions)&&g(s.extensions.AGI_articulations)){let c=s.extensions.AGI_articulations.articulationName;if(g(c)){let f=G.clone(l.publicNode.originalMatrix,wIe),h=a[c];h.nodes.push(l.publicNode);let d=h.stages.length;for(let p=0;p<d;++p){let _=h.stages[p];f=dJ(_,f)}l.publicNode.matrix=f}}}),e._runtime.nodes=t,e._runtime.nodesByName=n,e._runtime.skinnedNodes=r}function TIe(e){let t=e.gltfInternal,n=e._sourceTechniques,r={},o={},a=e._uniformMaps;re.material(t,function(s,u){a[u]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};let l=new HQ(e,s,u);if(g(s.extensions)&&g(s.extensions.KHR_techniques_webgl)){let c=s.extensions.KHR_techniques_webgl.technique;l._technique=c,l._program=n[c].program,re.materialValue(s,function(f,h){g(l._values)||(l._values={}),l._values[h]=Ht(f)})}r[s.name]=l,o[u]=l}),e._runtime.materialsByName=r,e._runtime.materialsById=o}function SIe(e){let t={},n=e._runtime.materialsById;re.mesh(e.gltfInternal,function(r,o){t[r.name]=new WQ(r,n,o),(g(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&re.meshPrimitive(r,function(a,s){let u=cz(e,a),l=e._programPrimitives[u];g(l)||(l={},e._programPrimitives[u]=l),l[`${o}.primitive.${s}`]=a})}),e._runtime.meshesByName=t}function AIe(e){let n=e.gltfInternal.asset.copyright;if(!g(n))return;let r=e._showCreditsOnScreen,o=n.split(";").map(function(a){return new AS(a.trim(),r)});e._gltfCredits=o}var uz=function(){this.id=void 0,this.model=void 0,this.context=void 0};uz.prototype.set=function(e,t,n){this.id=e,this.model=t,this.context=n};uz.prototype.execute=function(){mJ(this.id,this.model,this.context)};function mJ(e,t,n){let r=t._loadResources,a=t.gltfInternal.bufferViews[e];g(a)||(a=r.createdBufferViews[e]);let s=Ui.createVertexBuffer({context:n,typedArray:r.getBuffer(a),usage:We.STATIC_DRAW});s.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=s,t._geometryByteLength+=s.sizeInBytes}var lz=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};lz.prototype.set=function(e,t,n,r){this.id=e,this.componentType=t,this.model=n,this.context=r};lz.prototype.execute=function(){gJ(this.id,this.componentType,this.model,this.context)};function gJ(e,t,n,r){let o=n._loadResources,s=n.gltfInternal.bufferViews[e];g(s)||(s=o.createdBufferViews[e]);let u=Ui.createIndexBuffer({context:r,typedArray:o.getBuffer(s),usage:We.STATIC_DRAW,indexDatatype:t});u.vertexArrayDestroyable=!1,n._rendererResources.buffers[e]=u,n._geometryByteLength+=u.sizeInBytes}var tJ=new uz,nJ=new lz;function bIe(e,t){let n=e._loadResources;if(n.pendingBufferLoads!==0)return;let r=t.context,o=n.vertexBuffersToCreate,a=n.indexBuffersToCreate,s;if(e.asynchronous){for(;o.length>0&&(tJ.set(o.peek(),e,r),!!t.jobScheduler.execute(tJ,IS.BUFFER));)o.dequeue();for(;a.length>0&&(s=a.peek(),nJ.set(s.id,s.componentType,e,r),!!t.jobScheduler.execute(nJ,IS.BUFFER));)a.dequeue()}else{for(;o.length>0;)mJ(o.dequeue(),e,r);for(;a.length>0;)s=a.dequeue(),gJ(s.id,s.componentType,e,r)}}function cz(e,t){let n=e._runtime.materialsById[t.material];if(!!g(n))return n._program}function _J(e,t,n){let r,o=n._programPrimitives[t];if(!g(o))return e;let a;for(a in o)if(o.hasOwnProperty(a)&&(r=o[a],cz(n,r)===t))break;n._programPrimitives[t]=void 0;let s;if(n.extensionsUsed.WEB3D_quantized_attributes)s=Mr.modifyShaderForQuantizedAttributes(n.gltfInternal,r,e),n._quantizedUniforms[t]=s.uniforms;else{let u=n._decodedData[a];if(g(u))s=Mr.modifyShaderForDracoQuantizedAttributes(n.gltfInternal,r,e,u.attributes);else return e}return s.shader}function IIe(e){return e=Et.replaceMain(e,"gltf_blend_main"),e+=`uniform vec4 gltf_color; 
uniform float gltf_colorBlend; 
void main() 
{ 
    gltf_blend_main(); 
    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); 
    float highlight = ceil(gltf_colorBlend); 
    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); 
    gl_FragColor.a *= gltf_color.a; 
} 
`,e}function OS(e,t,n){return g(n)&&(e=n(e,t)),e}var fz=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};fz.prototype.set=function(e,t,n){this.programToCreate=e,this.model=t,this.context=n};fz.prototype.execute=function(){yJ(this.programToCreate,this.model,this.context)};function yJ(e,t,n){let r=e.programId,o=e.techniqueId,a=t._sourcePrograms[r],s=t._rendererResources.sourceShaders,u=s[a.vertexShader],l=s[a.fragmentShader],c=t._quantizedVertexShaders;if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){let w=c[r];g(w)||(w=_J(u,r,t),c[r]=w),u=w}let f=OS(u,r,t._vertexShaderLoaded),h=OS(l,r,t._fragmentShaderLoaded);g(t._uniformMapLoaded)||(h=`uniform vec4 czm_pickColor;
${h}`);let d=h.lastIndexOf("tile_main();");if(t._useInstancedColor&&d>-1){let w="";h.indexOf("v_normal")!=-1&&h.indexOf("v_positionEC")!=-1&&(w=`  czm_material material; material.diffuse = gl_FragColor.rgb; material.specular = 1.0; material.shininess = 256.0;  
  material.normal = normalize(v_normal); material.emission = vec3(0.0);  material.alpha = 1.0; 
  vec4 phoneColor = czm_phong(normalize(v_positionEC), material, czm_lightDirectionEC);  
  gl_FragColor.rgb = phoneColor.rgb; 
`);var p=t.gltfInternal;if(p.materials.length>0&&Cesium.defined(p.materials[0].useInstancedColor)){h=`varying vec4 v_instancedColor;
uniform float u_useInstancedColor;
`+h;var _=`tile_main(); 
if(v_instancedColor.a>0.0 && u_useInstancedColor > 0.5){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+w+`} 
`;h=h.replace("tile_main();",_)}else{h=`varying vec4 v_instancedColor;
`+h;var _=`tile_main(); 
if(v_instancedColor.a>0.0){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+w+`} 
`;h=h.replace("tile_main();",_)}}let y=t._imageBasedLighting,v=y.enabled;if(v&&(h=`#define USE_IBL_LIGHTING 

${h}`),g(t._lightColor)&&(h=`#define USE_CUSTOM_LIGHT_COLOR 

${h}`),(t._sourceVersion!=="2.0"||t._sourceKHRTechniquesWebGL)&&(h=Et.replaceMain(h,"non_gamma_corrected_main"),h=`${h}
void main() { 
    non_gamma_corrected_main(); 
    gl_FragColor = czm_gammaCorrect(gl_FragColor); 
} 
`),Xx.isSupported(n)){let w=y.useSphericalHarmonicCoefficients,C=y.useSpecularEnvironmentMaps;(w||C||v)&&(h=`uniform mat3 gltf_iblReferenceFrameMatrix; 
${h}`),g(y.sphericalHarmonicCoefficients)?h=`#define DIFFUSE_IBL 
#define CUSTOM_SPHERICAL_HARMONICS 
uniform vec3 gltf_sphericalHarmonicCoefficients[9]; 
${h}`:y.useDefaultSphericalHarmonics&&(h=`#define DIFFUSE_IBL 
${h}`),g(y.specularEnvironmentMapAtlas)&&y.specularEnvironmentMapAtlas.ready?h=`#define SPECULAR_IBL 
#define CUSTOM_SPECULAR_IBL 
uniform sampler2D gltf_specularMap; 
uniform vec2 gltf_specularMapSize; 
uniform float gltf_maxSpecularLOD; 
${h}`:y.useDefaultSpecularMaps&&(h=`#define SPECULAR_IBL 
${h}`)}g(y.luminanceAtZenith)&&(h=`#define USE_SUN_LUMINANCE 
uniform float gltf_luminanceAtZenith;
${h}`),vJ(r,o,h,f,t,n)}function DIe(e,t,n){let r=e.programId,o=e.techniqueId,a=t._sourcePrograms[r],s=t._rendererResources.sourceShaders,u=t._quantizedVertexShaders,l=t.clippingPlanes,c=sz(t),f=s[a.vertexShader],h=s[a.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(f=u[r]);let d=h;az(t)&&(d=gu._modifyShaderForColor(d)),c&&(d=MDe(d,l,n)),t.splitDirection!==Wy.NONE&&(d=JF.modifyFragmentShader(d));let p=OS(f,r,t._vertexShaderLoaded),_=OS(d,r,t._fragmentShaderLoaded);g(t._uniformMapLoaded)||(_=`uniform vec4 czm_pickColor;
${_}`);let y=_.lastIndexOf("tile_main();");if(t._useInstancedColor&&y>-1){let C=t.gltfInternal,E="";if(_.indexOf("v_normal")!=-1&&_.indexOf("v_positionEC")!=-1&&(E=`  czm_material material; material.diffuse = gl_FragColor.rgb; material.specular = 1.0; material.shininess = 256.0;  
  material.normal = normalize(v_normal); material.emission = vec3(0.0);  material.alpha = 1.0; 
  vec4 phoneColor = czm_phong(normalize(v_positionEC), material, czm_lightDirectionEC);  
  gl_FragColor.rgb = phoneColor.rgb; 
`),C.materials.length>0&&Cesium.defined(C.materials[0].useInstancedColor)){_=`varying vec4 v_instancedColor;
uniform float u_useInstancedColor;
`+_;let S=`tile_main(); 
if(v_instancedColor.a>0.0 && u_useInstancedColor > 0.5){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+E+`} 
`;_=_.replace("tile_main();",S)}else{_=`varying vec4 v_instancedColor;
`+_;let S=`tile_main(); 
if(v_instancedColor.a>0.0){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+E+`} 
`;_=_.replace("tile_main();",S)}}let v=t._imageBasedLighting,w=v.enabled;if(w&&(_=`#define USE_IBL_LIGHTING 

${_}`),g(t._lightColor)&&(_=`#define USE_CUSTOM_LIGHT_COLOR 

${_}`),(t._sourceVersion!=="2.0"||t._sourceKHRTechniquesWebGL)&&(_=Et.replaceMain(_,"non_gamma_corrected_main"),_=`${_}
void main() { 
    non_gamma_corrected_main(); 
    gl_FragColor = czm_gammaCorrect(gl_FragColor); 
} 
`),Xx.isSupported(n)){let C=v.useSphericalHarmonicCoefficients,E=v.useSpecularEnvironmentMaps;(C||E||w)&&(_=`uniform mat3 gltf_iblReferenceFrameMatrix; 
${_}`),g(v.sphericalHarmonicCoefficients)?_=`#define DIFFUSE_IBL 
#define CUSTOM_SPHERICAL_HARMONICS 
uniform vec3 gltf_sphericalHarmonicCoefficients[9]; 
${_}`:v.useDefaultSphericalHarmonics&&(_=`#define DIFFUSE_IBL 
${_}`),g(v.specularEnvironmentMapAtlas)&&v.specularEnvironmentMapAtlas.ready?_=`#define SPECULAR_IBL 
#define CUSTOM_SPECULAR_IBL 
uniform sampler2D gltf_specularMap; 
uniform vec2 gltf_specularMapSize; 
uniform float gltf_maxSpecularLOD; 
${_}`:v.useDefaultSpecularMaps&&(_=`#define SPECULAR_IBL 
${_}`)}g(v.luminanceAtZenith)&&(_=`#define USE_SUN_LUMINANCE 
uniform float gltf_luminanceAtZenith;
${_}`),vJ(r,o,_,p,t,n)}function vJ(e,t,n,r,o,a){let s=o._sourceTechniques[t],u=Mr.createAttributeLocations(s,o._precreatedAttributes);o._rendererResources.programs[e]=wi.fromCache({context:a,vertexShaderSource:r,fragmentShaderSource:n,attributeLocations:u})}var rJ=new fz;function PIe(e,t){let n=e._loadResources,r=n.programsToCreate;if(n.pendingShaderLoads!==0||n.pendingBufferLoads!==0)return;let o=t.context;if(e.asynchronous)for(;r.length>0&&(rJ.set(r.peek(),e,o),!!t.jobScheduler.execute(rJ,IS.PROGRAM));)r.dequeue();else for(;r.length>0;)yJ(r.dequeue(),e,o)}function MIe(e,t){return function(n){e.texturesToCreate.enqueue({id:t.id,image:n,bufferView:void 0}),--e.pendingBufferViewToImage}}function LIe(e){let t=e._loadResources;if(t.pendingBufferLoads===0)for(;t.texturesToCreateFromBufferView.length>0;){let n=t.texturesToCreateFromBufferView.dequeue(),r=e.gltfInternal,o=r.bufferViews[n.bufferView],a=r.textures[n.id].source,s=Mr.getFailedLoadFunction(e,"image",`id: ${n.id}, bufferView: ${n.bufferView}`);if(n.mimeType==="image/ktx2"){let u=new Uint8Array(t.getBuffer(o));Lm(u).then(pJ(e,n.id,a)).catch(s),++e._loadResources.pendingTextureLoads}else{let u=MIe(t,n);tQ({uint8Array:t.getBuffer(o),format:n.mimeType,flipY:!1,skipColorSpaceConversion:!0}).then(u).catch(s),++t.pendingBufferViewToImage}}}function RIe(e){let t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;let n=e._rendererResources.samplers;re.sampler(e.gltfInternal,function(r,o){n[o]=new Oa({wrapS:r.wrapS,wrapT:r.wrapT,minificationFilter:r.minFilter,magnificationFilter:r.magFilter})})}}var hz=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};hz.prototype.set=function(e,t,n){this.gltfTexture=e,this.model=t,this.context=n};hz.prototype.execute=function(){CJ(this.gltfTexture,this.model,this.context)};function CJ(e,t,n){let o=t.gltfInternal.textures[e.id],s=t._rendererResources.samplers[o.sampler];g(s)||(s=new Oa({wrapS:Nl.REPEAT,wrapT:Nl.REPEAT}));let u=!1,l=t.gltfInternal.materials,c=l.length;for(let E=0;E<c;++E){let S=l[E];if(g(S.extensions)&&g(S.extensions.KHR_techniques_webgl)){let A=S.extensions.KHR_techniques_webgl.values;for(let D in A)if(A.hasOwnProperty(D)&&D.indexOf("Texture")!==-1){let P=A[D];if(P.index===e.id&&g(P.extensions)&&g(P.extensions.KHR_texture_transform)){u=!0;break}}}if(u)break}let f=s.wrapS,h=s.wrapT,d=s.minificationFilter;u&&d!==In.LINEAR&&d!==In.NEAREST&&(d===In.NEAREST_MIPMAP_NEAREST||d===In.NEAREST_MIPMAP_LINEAR?d=In.NEAREST:d=In.LINEAR,s=new Oa({wrapS:s.wrapS,wrapT:s.wrapT,minificationFilter:d,magnificationFilter:s.magnificationFilter}));let p=e.internalFormat,_=!(g(p)&&qt.isCompressedFormat(p))&&(d===In.NEAREST_MIPMAP_NEAREST||d===In.NEAREST_MIPMAP_LINEAR||d===In.LINEAR_MIPMAP_NEAREST||d===In.LINEAR_MIPMAP_LINEAR),y=_||f===Nl.REPEAT||f===Nl.MIRRORED_REPEAT||h===Nl.REPEAT||h===Nl.MIRRORED_REPEAT,v,w,C=e.image;if(g(p)){v=!F.isPowerOfTwo(e.width)||!F.isPowerOfTwo(e.height),!n.webgl2&&qt.isCompressedFormat(p)&&v&&y&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly. See the EV_MTModel.js constructor documentation for more information.");let E=s.minificationFilter;!g(e.mipLevels)&&(d===In.NEAREST_MIPMAP_NEAREST||d===In.NEAREST_MIPMAP_LINEAR)?E=In.NEAREST:!g(e.mipLevels)&&(d===In.LINEAR_MIPMAP_NEAREST||d===In.LINEAR_MIPMAP_LINEAR)&&(E=In.LINEAR),s=new Oa({wrapS:s.wrapS,wrapT:s.wrapT,minificationFilter:E,magnificationFilter:s.magnificationFilter}),w=new na({context:n,source:{arrayBufferView:e.bufferView,mipLevels:e.mipLevels},width:e.width,height:e.height,pixelFormat:p,sampler:s})}else if(g(C)){if(v=!F.isPowerOfTwo(C.width)||!F.isPowerOfTwo(C.height),y&&v){let E=document.createElement("canvas");E.width=F.nextPowerOfTwo(C.width),E.height=F.nextPowerOfTwo(C.height),E.getContext("2d").drawImage(C,0,0,C.width,C.height,0,0,E.width,E.height),C=E}w=new na({context:n,source:C,pixelFormat:o.internalFormat,pixelDatatype:o.type,sampler:s,flipY:!1,skipColorSpaceConversion:!0}),_&&w.generateMipmap()}g(w)&&(t._rendererResources.textures[e.id]=w,t._texturesByteLength+=w.sizeInBytes)}var iJ=new hz;function OIe(e,t){let n=t.context,r=e._loadResources.texturesToCreate;if(e.asynchronous)for(;r.length>0&&(iJ.set(r.peek(),e,n),!!t.jobScheduler.execute(iJ,IS.TEXTURE));)r.dequeue();else for(;r.length>0;)CJ(r.dequeue(),e,n)}function xJ(e,t){let n=e._sourceTechniques,r={},o,a,s=e._runtime.materialsById[t.material];if(!g(s))return r;let u=n[s._technique];if(!g(u))return r;let l=u.attributes,f=e._rendererResources.programs[u.program]._attributeLocations;for(o in f)if(f.hasOwnProperty(o)){let d=l[o];g(d)&&(a=f[o],r[d.semantic]=a)}let h=e._precreatedAttributes;if(g(h))for(o in h)h.hasOwnProperty(o)&&(a=f[o],r[o]=a);return r}function NIe(e,t){let n=e.gltfInternal,r=n.skins,o=n.nodes,a=e._runtime.nodes,s=e._loadResources.skinnedNodesIds,u=s.length;for(let l=0;l<u;++l){let c=s[l],f=a[c],h=o[c],d=t[h.skin];f.inverseBindMatrices=d.inverseBindMatrices,f.bindShapeMatrix=d.bindShapeMatrix;let p=r[h.skin].joints,_=p.length;for(let y=0;y<_;++y){let v=p[y],w=a[v];f.joints.push(w)}}}function BIe(e){let t=e._loadResources;if(t.pendingBufferLoads!==0||!t.createSkins)return;t.createSkins=!1;let n=e.gltfInternal,r=n.accessors,o={};re.skin(n,function(a,s){let u=r[a.inverseBindMatrices],l;G.equals(a.bindShapeMatrix,G.IDENTITY)||(l=G.clone(a.bindShapeMatrix)),o[s]={inverseBindMatrices:DS.getSkinInverseBindMatrices(e,u),bindShapeMatrix:l}}),NIe(e,o)}function FIe(e,t,n,r){return function(o){g(r)&&(o=e.clampAnimations?r.clampTime(o):r.wrapTime(o),t[n]=r.evaluate(o,t[n]),t.dirtyNumber=e._maxDirtyNumber)}}function zIe(e){let t=e._loadResources;if(!t.finishedPendingBufferLoads()||!t.createRuntimeAnimations)return;t.createRuntimeAnimations=!1,e._runtime.animations=[];let n=e._runtime.nodes,r=e.gltfInternal.accessors;re.animation(e.gltfInternal,function(o,a){let s=o.channels,u=o.samplers,l=Number.MAX_VALUE,c=-Number.MAX_VALUE,f=s.length,h=new Array(f);for(let d=0;d<f;++d){let p=s[d],_=p.target,y=_.path,v=u[p.sampler],w=DS.getAnimationParameterValues(e,r[v.input]),C=DS.getAnimationParameterValues(e,r[v.output]);l=Math.min(l,w[0]),c=Math.max(c,w[w.length-1]);let E=DS.getAnimationSpline(e,a,o,p.sampler,v,w,y,C);h[d]=FIe(e,n[_.node],_.path,E)}e._runtime.animations[a]={name:o.name,startTime:l,stopTime:c,channelEvaluators:h}})}function oJ(e,t){let n=e._loadResources;if(!n.finishedBuffersCreation()||!n.finishedProgramCreation()||!n.createVertexArrays)return;n.createVertexArrays=!1;let r=e._rendererResources.buffers,o=e._rendererResources.vertexArrays,a=e.gltfInternal,s=a.accessors;re.mesh(a,function(u,l){re.meshPrimitive(u,function(c,f){let h=[],d,p=xJ(e,c),_=e._decodedData[`${l}.primitive.${f}`];re.meshPrimitiveAttribute(c,function(E,S){if(d=p[S],g(d)){if(g(_)){let P=_.attributes;if(P.hasOwnProperty(S)){let M=P[S];h.push({index:d,vertexBuffer:r[M.bufferView],componentsPerAttribute:M.componentsPerAttribute,componentDatatype:M.componentDatatype,normalize:M.normalized,offsetInBytes:M.byteOffset,strideInBytes:M.byteStride});return}}let A=s[E],D=g(A.normalized)&&A.normalized;h.push({index:d,vertexBuffer:r[A.bufferView],componentsPerAttribute:Ql(A.type),componentDatatype:A.componentType,normalize:D,offsetInBytes:A.byteOffset,strideInBytes:Lc(a,A)})}});let y,v,w=e._precreatedAttributes;if(g(w))for(v in w)w.hasOwnProperty(v)&&(d=p[v],g(d)&&(y=w[v],y.index=d,h.push(y)));let C;if(g(c.indices)){let S=s[c.indices].bufferView;g(_)&&(S=_.bufferView),C=r[S]}o[`${l}.primitive.${f}`]=new $h({context:t,attributes:h,indexBuffer:C})})})}function VIe(e,t){_g(e._rendererResources.vertexArrays),e._rendererResources.vertexArrays=void 0,e._nodeCommands.length=0,e._runtime.rootNodes=void 0;for(var n in e._runtime.nodes)Cesium.defined(e._runtime.nodes[n].commands)&&(e._runtime.nodes[n].commands=[],e._runtime.nodes[n].children=[],e._runtime.nodes[n].parents=[]);let r=t.scene3DOnly,o=t.context,a=e._rendererResources.buffers,s={},u=e.gltfInternal,l=u.accessors;re.mesh(u,function(w,C){re.meshPrimitive(w,function(E,S){let A=[],D,P=xJ(e,E),M=e._decodedData[`${C}.primitive.${S}`];re.meshPrimitiveAttribute(E,function(L,R){if(D=P[R],g(D)){if(g(M)){let V=M.attributes;if(V.hasOwnProperty(R)){let z=V[R];A.push({index:D,vertexBuffer:a[z.bufferView],componentsPerAttribute:z.componentsPerAttribute,componentDatatype:z.componentDatatype,normalize:z.normalized,offsetInBytes:z.byteOffset,strideInBytes:z.byteStride});return}}let N=l[L],B=g(N.normalized)&&N.normalized;A.push({index:D,vertexBuffer:a[N.bufferView],componentsPerAttribute:Ql(N.type),componentDatatype:N.componentType,normalize:B,offsetInBytes:N.byteOffset,strideInBytes:Lc(u,N)})}});let b,O,m=e._precreatedAttributes;if(g(m))for(O in m)m.hasOwnProperty(O)&&(D=P[O],g(D)&&(b=m[O],b.index=D,A.push(b)));let I;if(g(E.indices)){let R=l[E.indices].bufferView;g(M)&&(R=M.bufferView),I=a[R]}s[`${C}.primitive.${S}`]=new $h({context:o,attributes:A,indexBuffer:I})})}),e._rendererResources.vertexArrays=s;let c=[],f=e._runtime.nodes,h=u.nodes,p=u.scenes[u.scene].nodes,_=p.length,y=[],v={};for(let w=0;w<_;++w)for(y.push({parentRuntimeNode:void 0,gltfNode:h[p[w]],id:p[w]});y.length>0;){let C=y.pop();v[C.id]=!0;let E=C.parentRuntimeNode,S=C.gltfNode,A=f[C.id];if(A.parents.length===0)if(g(S.matrix))A.matrix=G.fromColumnMajorArray(S.matrix);else{let P=S.rotation;A.translation=x.fromArray(S.translation),A.rotation=je.unpack(P),A.scale=x.fromArray(S.scale)}g(E)?(E.children.push(A),A.parents.push(E)):c.push(A),g(S.mesh)&&wJ(e,S,A,o,r);let D=S.children;if(g(D)){let P=D.length;for(let M=0;M<P;M++){let b=D[M];v[b]||y.push({parentRuntimeNode:A,gltfNode:h[b],id:D[M]})}}}e._runtime.rootNodes=c,e._runtime.nodes=f}function kIe(e){let t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,re.material(e.gltfInternal,function(n,r){GIe(e,n,r)}))}function GIe(e,t,n){let r=e._rendererResources.renderStates,o=[k.FUNC_ADD,k.FUNC_ADD],a=[k.ONE,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA];g(t.extensions)&&g(t.extensions.KHR_blend)&&(o=t.extensions.KHR_blend.blendEquation,a=t.extensions.KHR_blend.blendFactors);let s=!t.doubleSided,u=t.alphaMode==="BLEND";r[n]=fn.fromCache({cull:{enabled:s},depthTest:{enabled:!0,func:s0.LESS_OR_EQUAL},depthMask:!u,blending:{enabled:u,equationRgb:o[0],equationAlpha:o[1],functionSourceRgb:a[0],functionDestinationRgb:a[1],functionSourceAlpha:a[2],functionDestinationAlpha:a[3]}})}var UIe={MODEL:function(e,t,n){return function(){return n.computedMatrix}},VIEW:function(e,t,n){return function(){return e.view}},PROJECTION:function(e,t,n){return function(){return e.projection}},MODELVIEW:function(e,t,n){let r=new G;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r)}},CESIUM_RTC_MODELVIEW:function(e,t,n){let r=new G;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r),G.setTranslation(r,t._rtcCenterEye,r)}},MODELVIEWPROJECTION:function(e,t,n){let r=new G;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r),G.multiply(e._projection,r,r)}},MODELINVERSE:function(e,t,n){let r=new G;return function(){return G.inverse(n.computedMatrix,r)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,n){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,n){let r=new G,o=new G;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r),G.inverse(r,o)}},MODELVIEWPROJECTIONINVERSE:function(e,t,n){let r=new G,o=new G;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r),G.multiply(e._projection,r,r),G.inverse(r,o)}},MODELINVERSETRANSPOSE:function(e,t,n){let r=new G,o=new te;return function(){return G.inverse(n.computedMatrix,r),G.getMatrix3(r,o),te.transpose(o,o)}},MODELVIEWINVERSETRANSPOSE:function(e,t,n){let r=new G,o=new G,a=new te;return function(){return G.multiplyTransformation(e.view,n.computedMatrix,r),G.inverse(r,o),G.getMatrix3(o,a),te.transpose(a,a)}},VIEWPORT:function(e,t,n){return function(){return e.viewportCartesian4}}};function HIe(e,t,n,r){let o=t._runtime.nodes[e];return UIe[n](r,t,o)}function qIe(e,t,n,r,o,a,s){let u={},l={},c,f;return re.techniqueUniform(n,function(h,d){let p;if(g(r)&&g(r[d]))p=Mr.createUniformFunction(h.type,r[d],a,s),u[d]=p.func,l[d]=p;else if(g(h.node))u[d]=HIe(h.node,e,h.semantic,o.uniformState);else if(g(h.semantic))if(h.semantic==="JOINTMATRIX")c=d;else if(h.semantic==="MORPHWEIGHTS")f=d;else if(h.semantic==="ALPHACUTOFF"){let _=t.alphaMode;if(g(_)&&_==="MASK"){let y=T(t.alphaCutoff,.5);p=Mr.createUniformFunction(h.type,y,a,s),u[d]=p.func,l[d]=p}}else u[d]=Mr.getGltfSemanticUniforms()[h.semantic](o.uniformState,e);else if(g(h.value)){let _=Mr.createUniformFunction(h.type,h.value,a,s);u[d]=_.func,l[d]=_}}),{map:u,values:l,jointMatrixUniformName:c,morphWeightsUniformName:f}}function WIe(e,t){let n=e._loadResources;if(!n.finishedProgramCreation()||!n.createUniformMaps)return;n.createUniformMaps=!1;let r=e.gltfInternal,o=e._sourceTechniques,a=e._uniformMaps,s=e._rendererResources.textures,u=e._defaultTexture;re.material(r,function(l,c){let f=e._runtime.materialsById[c],h=o[f._technique],d=f._values,p=qIe(e,l,h,d,t,s,u),_=a[c];if(_.uniformMap=p.map,_.values=p.values,_.jointMatrixUniformName=p.jointMatrixUniformName,_.morphWeightsUniformName=p.morphWeightsUniformName,g(h.attributes.a_outlineCoordinates)){let y=XF.createTexture(e,t);_.uniformMap.u_outlineTexture=function(){return y}}})}function YIe(e){return Mr.createUniformsForDracoQuantizedAttributes(e.attributes)}function XIe(e,t){let n=cz(e,t),r=e._quantizedUniforms[n];return Mr.createUniformsForQuantizedAttributes(e.gltfInternal,t,r)}function jIe(e){return function(){return e}}function KIe(e){return function(){return e.computedJointMatrices}}function ZIe(e){return function(){return e.weights}}function QIe(e){return function(){return e.silhouetteColor}}function JIe(e){return function(){return e.silhouetteSize}}function $Ie(e){return function(){return e.color}}function eDe(e){return function(){return e._clippingPlanesMatrix}}function tDe(e){return function(){return e._iblReferenceFrameMatrix}}function nDe(e){return function(){let t=e.clippingPlanes;return!g(t)||!t.enabled?e._defaultTexture:t.texture}}function rDe(e){return function(){let t=e.clippingPlanes;if(!g(t))return K.WHITE.withAlpha(0);let n=K.clone(t.edgeColor);return n.alpha=t.edgeWidth,n}}function iDe(e){return function(){return cg.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function oDe(e){return function(){return e._imageBasedLighting.imageBasedLightingFactor}}function aDe(e){return function(){return e._lightColor}}function sDe(e){return function(){return e._imageBasedLighting.luminanceAtZenith}}function uDe(e){return function(){return e._imageBasedLighting.sphericalHarmonicCoefficients}}function lDe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture}}function cDe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture.dimensions}}function fDe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.maximumMipmapLevel}}function hDe(e,t){switch(e.mode){case sn.TRIANGLES:return t/3;case sn.TRIANGLE_STRIP:case sn.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function wJ(e,t,n,r,o){let a=e._nodeCommands,s=e._pickIds,u=e.allowPicking,l=e._runtime.meshesByName,c=e._rendererResources,f=c.vertexArrays,h=c.programs,d=c.renderStates,p=e._uniformMaps,_=e.gltfInternal,y=_.accessors,v=_.meshes,w=t.mesh,C=v[w],E=C.primitives,S=E.length;for(let D=0;D<S;++D){let P=E[D],M=y[P.indices],O=e._runtime.materialsById[P.material]._program,m=e._decodedData[`${w}.primitive.${D}`],I,L=P.attributes.POSITION;if(g(L)){let At=Mr.getAccessorMinMax(_,L);I=Ee.fromCornerPoints(x.fromArray(At.min),x.fromArray(At.max))}let R=f[`${w}.primitive.${D}`],N,B;g(m)?(B=m.numberOfIndices,N=0):g(M)?(B=M.count,N=M.byteOffset/Or.getSizeInBytes(M.componentType)):(B=y[P.attributes.POSITION].count,N=0),e._trianglesLength+=hDe(P,B),P.mode===sn.POINTS&&(e._pointsLength+=B);let V=p[P.material],z=V.uniformMap;if(g(V.jointMatrixUniformName)){let At={};At[V.jointMatrixUniformName]=KIe(n),z=ji(z,At)}if(g(V.morphWeightsUniformName)){let At={};At[V.morphWeightsUniformName]=ZIe(n),z=ji(z,At)}if(z=ji(z,{gltf_color:$Ie(e),gltf_colorBlend:iDe(e),gltf_clippingPlanes:nDe(e),gltf_clippingPlanesEdgeStyle:rDe(e),gltf_clippingPlanesMatrix:eDe(e),gltf_iblReferenceFrameMatrix:tDe(e),gltf_iblFactor:oDe(e),gltf_lightColor:aDe(e),gltf_sphericalHarmonicCoefficients:uDe(e),gltf_specularMap:lDe(e),gltf_specularMapSize:cDe(e),gltf_maxSpecularLOD:fDe(e),gltf_luminanceAtZenith:sDe(e)}),JF.addUniforms(e,z),Cesium.defined(_.materials[w])&&Cesium.defined(_.materials[w].useInstancedColor)&&e._useInstancedColor){var A=_.materials[w].useInstancedColor?1:0;z=Cesium.combine(z,{u_useInstancedColor:function(){return A}})}g(e._uniformMapLoaded)&&(z=e._uniformMapLoaded(z,O,n));let U={};e.extensionsUsed.WEB3D_quantized_attributes?U=XIe(e,P):e._dequantizeInShader&&g(m)&&(U=YIe(m)),z=ji(z,U);let Q=d[P.material],ne=Q.blending.enabled,se=e._pickObject;g(se)||(se={primitive:e,id:e.id,node:n.publicNode,mesh:l[C.name]});let de=io.castShadows(e._shadows),pe=io.receiveShadows(e._shadows),ve;if(u&&!g(e._uniformMapLoaded)){ve=r.createPickId(se),s.push(ve);let At={czm_pickColor:jIe(ve.color)};z=ji(z,At)}u&&(g(e._pickIdLoaded)&&g(e._uniformMapLoaded)?ve=e._pickIdLoaded():ve="czm_pickColor");let ft=new $t({boundingVolume:new Ee,cull:e.cull,modelMatrix:new G,primitiveType:P.mode,vertexArray:R,count:B,offset:N,shaderProgram:h[O],castShadows:de,receiveShadows:pe,uniformMap:z,renderState:Q,owner:se,pass:ne?en.TRANSLUCENT:e.opaquePass,pickId:ve}),pt;o||(pt=$t.shallowClone(ft),pt.boundingVolume=new Ee,pt.modelMatrix=new G);let Xt={show:!0,boundingSphere:I,command:ft,command2D:pt,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,disableCullingCommand:void 0,disableCullingCommand2D:void 0,programId:O};n.commands.push(Xt),a.push(Xt)}}function dDe(e,t,n){let r=e._loadResources;if(!r.finishedEverythingButTextureCreation()||!r.createRuntimeNodes)return;r.createRuntimeNodes=!1;let o=[],a=e._runtime.nodes,s=e.gltfInternal,u=s.nodes,c=s.scenes[s.scene].nodes,f=c.length,h=[],d={};for(let p=0;p<f;++p)for(h.push({parentRuntimeNode:void 0,gltfNode:u[c[p]],id:c[p]});h.length>0;){let _=h.pop();d[_.id]=!0;let y=_.parentRuntimeNode,v=_.gltfNode,w=a[_.id];if(w.parents.length===0)if(g(v.matrix))w.matrix=G.fromColumnMajorArray(v.matrix);else{let E=v.rotation;w.translation=x.fromArray(v.translation),w.rotation=je.unpack(E),w.scale=x.fromArray(v.scale)}g(y)?(y.children.push(w),w.parents.push(y)):o.push(w),g(v.mesh)&&wJ(e,v,w,t,n);let C=v.children;if(g(C)){let E=C.length;for(let S=0;S<E;S++){let A=C[S];d[A]||h.push({parentRuntimeNode:w,gltfNode:u[A],id:C[S]})}}}e._runtime.rootNodes=o,e._runtime.nodes=a}function pDe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function mDe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function aJ(e,t){let n=t.context,r=t.scene3DOnly,o=e._quantizedVertexShaders,a=e._sourceTechniques,s=e._sourcePrograms,u=e._rendererResources,l=u.sourceShaders;e._loadRendererResourcesFromCache&&(l=u.sourceShaders=e._cachedRendererResources.sourceShaders);for(let c in a)if(a.hasOwnProperty(c)){let f=a[c].program,h=s[f],d=l[h.vertexShader];if(Mr.checkSupportedGlExtensions(h.glExtensions,n),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){let p=o[f];g(p)||(p=_J(d,f,e),o[f]=p),d=p}d=OS(d,f,e._vertexShaderLoaded)}if(e._loadRendererResourcesFromCache){let c=e._cachedRendererResources;u.buffers=c.buffers,u.vertexArrays=c.vertexArrays,u.programs=c.programs,u.silhouettePrograms=c.silhouettePrograms,u.textures=c.textures,u.samplers=c.samplers,u.renderStates=c.renderStates,g(e._precreatedAttributes)&&oJ(e,n),e._cachedGeometryByteLength+=pDe(c.buffers),e._cachedTexturesByteLength+=mDe(c.textures)}else bIe(e,t),PIe(e,t),RIe(e,n),LIe(e),OIe(e,t);BIe(e),zIe(e),e._loadRendererResourcesFromCache||(oJ(e,n),kIe(e)),WIe(e,n),dDe(e,n,r)}function sJ(e,t){let n=e.publicNode,r=n.matrix;n.useMatrix&&g(r)?G.clone(r,t):g(e.matrix)?G.clone(e.matrix,t):(G.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),n.setMatrix(t))}var EJ=[],gDe=new Se,ez=new G;function _De(e,t,n,r){let o=e._maxDirtyNumber,a=e._runtime.rootNodes,s=a.length,u=EJ,l=e._computedModelMatrix;if(e._mode!==Ne.SCENE3D&&!e._ignoreCommands){let c=G.getColumn(l,3,gDe);if(!Se.equals(c,Se.UNIT_W))l=Cn.basisTo2D(r,l,ez),e._rtcCenter=e._rtcCenter3D;else{let f=e.boundingSphereInternal.center,h=Cn.wgs84To2DModelMatrix(r,f,ez);l=G.multiply(h,l,ez),g(e._rtcCenter)&&(G.setTranslation(l,Se.UNIT_W,l),e._rtcCenter=e._rtcCenter2D)}}for(let c=0;c<s;++c){let f=a[c];for(sJ(f,f.transformToRoot),u.push(f);u.length>0;){f=u.pop();let h=f.transformToRoot,d=f.commands;if(f.dirtyNumber===o||t||n){let _=G.multiplyTransformation(l,h,f.computedMatrix),y=d.length;if(y>0)for(let v=0;v<y;++v){let w=d[v],C=w.command;G.clone(_,C.modelMatrix),Ee.transform(w.boundingSphere,C.modelMatrix,C.boundingVolume),g(e._rtcCenter)&&x.add(e._rtcCenter,C.boundingVolume.center,C.boundingVolume.center),C=w.command2D,g(C)&&e._mode===Ne.SCENE2D&&(G.clone(_,C.modelMatrix),C.modelMatrix[13]-=F.sign(C.modelMatrix[13])*2*F.PI*r.ellipsoid.maximumRadius,Ee.transform(w.boundingSphere,C.modelMatrix,C.boundingVolume))}}let p=f.children;if(g(p)){let _=p.length;for(let y=0;y<_;++y){let v=p[y];v.dirtyNumber=Math.max(v.dirtyNumber,f.dirtyNumber),(v.dirtyNumber===o||n)&&(sJ(v,v.transformToRoot),G.multiplyTransformation(h,v.transformToRoot,v.transformToRoot)),u.push(v)}}}}++e._maxDirtyNumber}var tz=new G;function yDe(e){let t=e._runtime.skinnedNodes,n=t.length;for(let r=0;r<n;++r){let o=t[r];tz=G.inverseTransformation(o.transformToRoot,tz);let a=o.computedJointMatrices,s=o.joints,u=o.bindShapeMatrix,l=o.inverseBindMatrices,c=l.length;for(let f=0;f<c;++f)g(a[f])||(a[f]=new G),a[f]=G.multiplyTransformation(tz,s[f].transformToRoot,a[f]),a[f]=G.multiplyTransformation(a[f],l[f],a[f]),g(u)&&(a[f]=G.multiplyTransformation(a[f],u,a[f]))}}function vDe(e){let t=e._runtime.rootNodes,n=t.length,r=EJ;for(let o=0;o<n;++o){let a=t[o];for(a.computedShow=a.publicNode.show,r.push(a);r.length>0;){a=r.pop();let s=a.computedShow,u=a.commands,l=u.length;for(let f=0;f<l;++f)u[f].show=s;let c=a.children;if(g(c)){let f=c.length;for(let h=0;h<f;++h){let d=c[h];d.computedShow=s&&d.publicNode.show,r.push(d)}}}}}function CDe(e,t){let n=e.id;if(e._id!==n){e._id=n;let r=e._pickIds,o=r.length;for(let a=0;a<o;++a)r[a].object.id=n}}function xDe(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;let t=e.debugWireframe?sn.LINES:sn.TRIANGLES,n=e._nodeCommands,r=n.length;for(let o=0;o<r;++o)n[o].command.primitiveType=t}}function wDe(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;let t=e.debugShowBoundingVolume,n=e._nodeCommands,r=n.length;for(let o=0;o<r;++o)n[o].command.debugShowBoundingVolume=t}}function EDe(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;let t=io.castShadows(e.shadows),n=io.receiveShadows(e.shadows),r=e._nodeCommands,o=r.length;for(let a=0;a<o;a++){let s=r[a];s.command.castShadows=t,s.command.receiveShadows=n}}}function TDe(e,t){let n=Ht(t,!0);return n.cull.enabled=!1,n.depthTest.enabled=!0,n.depthMask=!1,n.blending=ka.ALPHA_BLEND,e.opaquePass===en.CESIUM_3D_TILE&&(n.stencilTest=oo.setCesium3DTileBit(),n.stencilMask=oo.CESIUM_3D_TILE_MASK),fn.fromCache(n)}function uJ(e,t){let n=$t.shallowClone(t);return n.pass=en.TRANSLUCENT,n.renderState=TDe(e,t.renderState),n}function TJ(e,t,n){let r=t.scene3DOnly,o=e.color.alpha;if(o>0&&o<1){let a=e._nodeCommands,s=a.length;if(s>0&&(!g(a[0].translucentCommand)||n))for(let u=0;u<s;++u){let l=a[u],c=l.command;if(l.translucentCommand=uJ(e,c),!r){let f=l.command2D;l.translucentCommand2D=uJ(e,f)}}}}function SDe(e){let t=Ht(e,!0);return t.cull.enabled=!1,fn.fromCache(t)}function lJ(e){let t=$t.shallowClone(e);return t.renderState=SDe(e.renderState),t}function SJ(e,t,n){let r=t.scene3DOnly;if(!e.backFaceCulling){let a=e._nodeCommands,s=a.length;if(s>0&&(!g(a[0].disableCullingCommand)||n))for(let u=0;u<s;++u){let l=a[u],c=l.command;if(l.disableCullingCommand=lJ(c),!r){let f=l.command2D;l.disableCullingCommand2D=lJ(f)}}}}function ADe(e,t){let n=e._rendererResources.programs;for(let r in n)if(n.hasOwnProperty(r)&&n[r]===t)return r}function bDe(e,t,n){let r=t.vertexShaderSource.sources[0],o=t._attributeLocations,a=e._normalAttributeName;r=Et.replaceMain(r,"gltf_silhouette_main"),r+=`uniform float gltf_silhouetteSize; 
void main() 
{ 
    gltf_silhouette_main(); 
    vec3 n = normalize(czm_normal3D * ${a}); 
    n.x *= czm_projection[0][0]; 
    n.y *= czm_projection[1][1]; 
    vec4 clip = gl_Position; 
    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; 
    gl_Position = clip; 
}`;let s=`uniform vec4 gltf_silhouetteColor; 
void main() 
{ 
    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); 
}`;return wi.fromCache({context:n.context,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o})}function AJ(e,t){return hJ(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&g(e._normalAttributeName)}function IDe(e){let t=e._nodeCommands,n=t.length;for(let r=0;r<n;++r)if(t[r].command.pass===en.TRANSLUCENT)return!0;return!1}function rz(e){return e.color.alpha>0&&e.color.alpha<1}function bJ(e){return e.color.alpha===0}function cJ(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var DDe=0;function PDe(e,t){let n=++DDe%255,r=IDe(e)||rz(e)||e.silhouetteColor.alpha<1,o=e._rendererResources.silhouettePrograms,a=t.scene3DOnly,s=e._nodeCommands,u=s.length;for(let l=0;l<u;++l){let c=s[l],f=c.command,h=rz(e)?c.translucentCommand:f,d=$t.shallowClone(h),p=Ht(h.renderState);p.stencilTest={enabled:!0,frontFunction:k.ALWAYS,backFunction:k.ALWAYS,reference:n,mask:-1,frontOperation:{fail:k.KEEP,zFail:k.KEEP,zPass:k.REPLACE},backOperation:{fail:k.KEEP,zFail:k.KEEP,zPass:k.REPLACE}},bJ(e)&&(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1),p=fn.fromCache(p),d.renderState=p,c.silhouetteModelCommand=d;let _=$t.shallowClone(f);p=Ht(f.renderState,!0),p.depthTest.enabled=!0,p.cull.enabled=!1,r&&(_.pass=en.TRANSLUCENT,p.depthMask=!1,p.blending=ka.ALPHA_BLEND),p.stencilTest={enabled:!0,frontFunction:k.NOTEQUAL,backFunction:k.NOTEQUAL,reference:n,mask:-1,frontOperation:{fail:k.KEEP,zFail:k.KEEP,zPass:k.KEEP},backOperation:{fail:k.KEEP,zFail:k.KEEP,zPass:k.KEEP}},p=fn.fromCache(p);let y=f.shaderProgram,v=ADe(e,y),w=o[v];g(w)||(w=bDe(e,y,t),o[v]=w);let C=ji(f.uniformMap,{gltf_silhouetteColor:QIe(e),gltf_silhouetteSize:JIe(e)});if(_.renderState=p,_.shaderProgram=w,_.uniformMap=C,_.castShadows=!1,_.receiveShadows=!1,c.silhouetteColorCommand=_,!a){let E=c.command2D,S=$t.shallowClone(d);S.boundingVolume=E.boundingVolume,S.modelMatrix=E.modelMatrix,c.silhouetteModelCommand2D=S;let A=$t.shallowClone(_);S.boundingVolume=E.boundingVolume,S.modelMatrix=E.modelMatrix,c.silhouetteColorCommand2D=A}}}function MDe(e,t,n){return e=Et.replaceMain(e,"gltf_clip_main"),e+=`${gu._getClippingFunction(t,n)}
`,e+=`uniform highp sampler2D gltf_clippingPlanes; 
uniform mat4 gltf_clippingPlanesMatrix; 
uniform vec4 gltf_clippingPlanesEdgeStyle; 
void main() 
{ 
    gltf_clip_main(); 
${DQ("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")}} 
`,e}function IJ(e,t,n){if(!AJ(e,t))return;let r=e._nodeCommands,o=r.length>0&&(cJ(e.color.alpha,e._colorPreviousAlpha)||cJ(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!g(r[0].silhouetteModelCommand));e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(o||n)&&PDe(e,t)}function LDe(e,t){let n=e._clippingPlanes;g(n)&&n.owner===e&&n.enabled&&n.update(t)}var nz=new Ee;function RDe(e,t,n){return nz.center=e,nz.radius=t,n.camera.getPixelSize(nz,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}var mu=new x,MS=new le;function ODe(e,t){let n=e.scale;if(e.minimumPixelSize!==0){let r=t.context,o=Math.max(r.drawingBufferWidth,r.drawingBufferHeight),a=g(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(mu.x=a[12],mu.y=a[13],mu.z=a[14],g(e._rtcCenter)&&x.add(e._rtcCenter,mu,mu),e._mode!==Ne.SCENE3D){let f=t.mapProjection,h=f.ellipsoid.cartesianToCartographic(mu,MS);f.project(h,mu),x.fromElements(mu.z,mu.x,mu.y,mu)}let s=e.boundingSphereInternal.radius,u=RDe(mu,s,t),l=1/u;Math.min(l*(2*s),o)<e.minimumPixelSize&&(n=e.minimumPixelSize*u/(2*e._initialRadius))}return g(e.maximumScale)?Math.min(e.maximumScale,n):n}function DJ(e){g(e._cacheKey)&&g(e._cachedGltf)&&--e._cachedGltf.count===0&&delete X0[e._cacheKey],e._cachedGltf=void 0}function iz(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function _g(e){for(let t in e)e.hasOwnProperty(t)&&(e[t].isDestroyed()||e[t].destroy())}function NDe(e){_g(e.buffers),_g(e.vertexArrays),_g(e.programs),_g(e.silhouettePrograms),_g(e.textures)}iz.prototype.release=function(){if(--this.count===0)return g(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],NDe(this),st(this)};function fJ(e,t,n){return function(r){if(e.heightReference===Lt.RELATIVE_TO_GROUND){let a=t.cartesianToCartographic(r,MS);a.height+=n.height,t.cartographicToCartesian(a,r)}let o=e._clampedModelMatrix;G.clone(e.modelMatrix,o),o[12]=r.x,o[13]=r.y,o[14]=r.z,e._heightChanged=!0}}function BDe(e){g(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);let t=e._scene;if(!g(t)||!g(t.globe)||e.heightReference===Lt.NONE){e._clampedModelMatrix=void 0;return}let n=t.globe,r=n.ellipsoid,o=e.modelMatrix;mu.x=o[12],mu.y=o[13],mu.z=o[14];let a=r.cartesianToCartographic(mu);g(e._clampedModelMatrix)||(e._clampedModelMatrix=G.clone(o,new G));let s=n._surface;e._removeUpdateHeightCallback=s.updateHeight(a,fJ(e,r,a));let u=n.getHeight(a);if(g(u)){let l=fJ(e,r,a);le.clone(a,MS),MS.height=u,r.cartographicToCartesian(MS,mu),l(mu)}}var FDe=new x,zDe=new le;function VDe(e,t){let n,r=e.distanceDisplayCondition,o=r.near*r.near,a=r.far*r.far;if(t.mode===Ne.SCENE2D)n=(t.camera.frustum.right-t.camera.frustum.left)*.5,n=n*n;else{let s=G.getTranslation(e.modelMatrix,FDe);if(t.mode===Ne.COLUMBUS_VIEW){let u=t.mapProjection,c=u.ellipsoid.cartesianToCartographic(s,zDe);s=u.project(c,s),x.fromElements(s.z,s.x,s.y,s)}n=x.distanceSquared(s,t.camera.positionWC)}return n>=o&&n<=a}var kDe=new G,GDe=new te,UDe=new G;gu.prototype.update=function(e){if(e.mode===Ne.MORPHING)return;if(!ea.supportsWebP.initialized){ea.supportsWebP.initialize();return}let t=e.context;this._defaultTexture=t.defaultTexture;let n=ea.supportsWebP();if(this._state===gg.NEEDS_LOAD&&g(this.gltfInternal)){let w,C=this.cacheKey;if(g(C)){t.cache.modelRendererResourceCache=T(t.cache.modelRendererResourceCache,{});let E=t.cache.modelRendererResourceCache;if(w=E[this.cacheKey],g(w)){if(!w.ready)return;++w.count,this._loadRendererResourcesFromCache=!0}else w=new iz(t,C),w.count=1,E[this.cacheKey]=w;this._cachedRendererResources=w}else w=new iz(t),w.count=1,this._cachedRendererResources=w;if(this._state=gg.LOADING,this._state!==gg.FAILED){let E=this.gltfInternal.extensions;if(g(E)&&g(E.CESIUM_RTC)){let S=x.fromArray(E.CESIUM_RTC.center);if(!x.equals(S,x.ZERO)){this._rtcCenter3D=S;let A=e.mapProjection,P=A.ellipsoid.cartesianToCartographic(this._rtcCenter3D),M=A.project(P);x.fromElements(M.z,M.x,M.y,M),this._rtcCenter2D=M,this._rtcCenterEye=new x,this._rtcCenter=this._rtcCenter3D}}TS(this.gltfInternal),this._loadResources=new UQ,this._loadRendererResourcesFromCache||Mr.parseBuffers(this,hIe)}}let r=this._loadResources,o=this._incrementallyLoadTextures,a=!1;if(this._state===gg.LOADING){if(r.pendingBufferLoads===0){if(!r.initialized){if(e.brdfLutGenerator.update(e),Mr.checkSupportedExtensions(this.extensionsRequired,n),Mr.updateForwardAxis(this),!g(this.gltfInternal.extras.sourceVersion)){let w=this.gltfInternal,C=Mr.getAssetVersion(w),E=g(Mr.getUsedExtensions(w).KHR_techniques_webgl);C!=="2.0"&&ul("gltf-1.0","glTF 1.0 assets were deprecated in CesiumJS 1.94. They will be removed in 1.97. Please convert any glTF 1.0 assets to glTF 2.0."),E&&ul("KHR_techniques_webgl","Support for glTF 1.0 techniques and the KHR_techniques_webgl glTF extension were deprecated in CesiumJS 1.94. It will be removed in 1.97. If custom GLSL shaders are needed, use CustomShader instead."),w.extras.sourceVersion=C,w.extras.sourceKHRTechniquesWebGL=E,this._sourceVersion=C,this._sourceKHRTechniquesWebGL=E,_Q(w),nQ(w);let S={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};JQ(w,S),$Q(w,S)}this._sourceVersion=this.gltfInternal.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltfInternal.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&Kx.hasExtension(this),fIe(this),yIe(this),pIe(this),this._loadRendererResourcesFromCache||(dIe(this),gIe(this),_Ie(this),xIe(this,t,n)),TIe(this),SIe(this),EIe(this),AIe(this),Kx.parse(this,t),r.initialized=!0}r.finishedDecoding()||Kx.decodeModel(this,t).catch(Mr.getFailedLoadFunction(this,"model",this.basePathInternal)),r.finishedDecoding()&&!r.resourcesParsed&&(WDe(this),this._initialRadius=this._boundingSphere.radius,Kx.cacheDataForModel(this),r.resourcesParsed=!0),r.resourcesParsed&&r.pendingShaderLoads===0&&(this.showOutline&&XF.outlinePrimitives(this),aJ(this,e))}(r.finished()||o&&r.finishedEverythingButTextureCreation())&&(this._state=gg.LOADED,a=!0)}if(Cesium.defined(this._cachedRendererResources)&&this._cachedRendererResources.ready&&this._state===gg.LOADED&&this.recreateVertexArraysOnce&&(VIe(this,e),this.recreateVertexArraysOnce=!1),g(r)&&this._state===gg.LOADED&&(o&&!a&&aJ(this,e),r.finished())){this._loadResources=void 0;let w=this._rendererResources,C=this._cachedRendererResources;C.buffers=w.buffers,C.vertexArrays=w.vertexArrays,C.programs=w.programs,C.sourceShaders=w.sourceShaders,C.silhouettePrograms=w.silhouettePrograms,C.textures=w.textures,C.samplers=w.samplers,C.renderStates=w.renderStates,C.ready=!0,this._normalAttributeName=Mr.getAttributeOrUniformBySemantic(this.gltfInternal,"NORMAL"),g(this._precreatedAttributes)&&(C.vertexArrays={}),this.releaseGltfJson&&DJ(this)}let s=AJ(this,e),u=rz(this),l=bJ(this),c=this.backFaceCulling,f=g(this.distanceDisplayCondition)?VDe(this,e):!0,h=this.show&&f&&this.scale!==0&&(!l||s);if(this._imageBasedLighting.update(e),h&&this._state===gg.LOADED||a){let w=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;let C=this.modelMatrix,E=e.mode!==this._mode;this._mode=e.mode;let S=!G.equals(this._modelMatrix,C)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||this.minimumPixelSize!==0||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||E;if(S||a){G.clone(C,this._modelMatrix),BDe(this),g(this._clampedModelMatrix)&&(C=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;let O=ODe(this,e),m=this._computedModelMatrix;G.multiplyByUniformScale(C,O,m),this._upAxis===Hu.Y?G.multiplyTransformation(m,Hu.Y_UP_TO_Z_UP,m):this._upAxis===Hu.X&&G.multiplyTransformation(m,Hu.X_UP_TO_Z_UP,m),this.forwardAxis===Hu.Z&&G.multiplyTransformation(m,Hu.Z_UP_TO_X_UP,m)}(w||S||a)&&(_De(this,S,a,e.mapProjection),this._dirty=!0,(w||a)&&yDe(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,vDe(this)),CDe(this,t),xDe(this),wDe(this),EDe(this),LDe(this,e);let A=this._clippingPlanes,D=0,P=T(this.referenceMatrix,C);if(this._imageBasedLighting.useSphericalHarmonicCoefficients||this._imageBasedLighting.useSpecularEnvironmentMaps){let O=GDe,m=kDe;m=G.multiply(t.uniformState.view3D,P,m),O=G.getMatrix3(m,O),O=te.getRotation(O,O),this._iblReferenceFrameMatrix=te.transpose(O,this._iblReferenceFrameMatrix)}if(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLighting.shouldRegenerateShaders,sz(this)){let O=UDe;O=G.multiply(t.uniformState.view3D,P,O),O=G.multiply(O,A.modelMatrix,O),this._clippingPlanesMatrix=G.inverseTranspose(O,this._clippingPlanesMatrix),D=A.clippingPlanesState}this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._clippingPlanesState!==D,this._clippingPlanesState=D;let M=az(this);M!==this._colorShadingEnabled&&(this._colorShadingEnabled=M,this._shouldRegenerateShaders=!0);let b=this.splitDirection!==Wy.NONE;this._splittingEnabled!==b&&(this._splittingEnabled=b,this._shouldRegenerateShaders=!0),this._shouldRegenerateShaders?YDe(this,e):(TJ(this,e,!1),SJ(this,e,!1),IJ(this,e,!1))}if(a){let w=this;e.afterRender.push(function(){w._ready=!0,w._readyPromise.resolve(w)});return}if(h&&!this._ignoreCommands){let w=e.commandList,C=e.passes,E=this._nodeCommands,S=E.length,A,D,P=e.mapProjection.ellipsoid.maximumRadius*F.PI,M;if(C.render||C.pick&&this.allowPicking){for(A=0;A<S;++A)if(D=E[A],D.show){let b=D.command;s?b=D.silhouetteModelCommand:u?b=D.translucentCommand:c||(b=D.disableCullingCommand),w.push(b),M=D.command.boundingVolume;let O=M.center.y-M.radius,m=M.center.y+M.radius,I=O<P&&m>P||O<-P&&m>-P;if(e.mode===Ne.SCENE2D&&I){let L=D.command2D;s?L=D.silhouetteModelCommand2D:u?L=D.translucentCommand2D:c||(L=D.disableCullingCommand2D),w.push(L)}}if(s&&!C.pick){for(A=0;A<S;++A)if(D=E[A],D.show){w.push(D.silhouetteColorCommand),M=D.command.boundingVolume;let b=M.center.y-M.radius,O=M.center.y+M.radius,m=b<P&&O>P||b<-P&&O>-P;e.mode===Ne.SCENE2D&&m&&w.push(D.silhouetteColorCommand2D)}}}}let d=this._credit;g(d)&&e.creditDisplay.addCredit(d);let p=this._resourceCredits,_=p.length;for(let w=0;w<_;w++)e.creditDisplay.addCredit(p[w]);let y=this._gltfCredits,v=y.length;for(let w=0;w<v;w++)e.creditDisplay.addCredit(y[w])};function PJ(e,t){e.programs!==t.programs&&_g(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&_g(e.silhouettePrograms)}var HDe=new x,qDe=new x;function WDe(e){for(var t=e.gltf,n=t.nodes,r=t.meshes,o=t.scenes[t.scene].nodes,a=o.length,s=[],u=new Cesium.Cartesian3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new Cesium.Cartesian3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),c=0;c<a;++c){var f=n[o[c]];for(f._transformToRoot=Cesium.ModelUtility.getTransform(f),s.push(f);s.length>0;){f=s.pop();var h=f._transformToRoot,d=f.mesh;if(Cesium.defined(d))for(var p=r[d],_=p.primitives,y=_.length,v=0;v<y;++v){var w=_[v].attributes.POSITION;if(Cesium.defined(w)){var C=Cesium.ModelUtility.getAccessorMinMax(t,w);if(Cesium.defined(C.min)&&Cesium.defined(C.max)){var E=Cesium.Cartesian3.fromArray(C.min,0,HDe),S=Cesium.Cartesian3.fromArray(C.max,0,qDe);Cesium.defined(u)&&Cesium.defined(l)&&(Cesium.Matrix4.multiplyByPoint(h,E,E),Cesium.Matrix4.multiplyByPoint(h,S,S),Cesium.Cartesian3.minimumByComponent(u,E,u),Cesium.Cartesian3.maximumByComponent(l,S,l))}}}var A=f.children;if(Cesium.defined(A))for(var D=A.length,P=0;P<D;++P){var M=n[A[P]];M._transformToRoot=Cesium.ModelUtility.getTransform(M),Cesium.Matrix4.multiplyTransformation(h,M._transformToRoot,M._transformToRoot),s.push(M)}delete f._transformToRoot}}var b=Cesium.Cartesian3.clone(u),O=Cesium.Cartesian3.clone(l),m=Cesium.BoundingSphere.fromCornerPoints(u,l);e._forwardAxis===Cesium.Axis.Z&&(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.Z_UP_TO_X_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Z_UP_TO_X_UP,b,b),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Z_UP_TO_X_UP,O,O)),e._upAxis===Cesium.Axis.Y?(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.Y_UP_TO_Z_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Y_UP_TO_Z_UP,b,b),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Y_UP_TO_Z_UP,O,O)):e._upAxis===Cesium.Axis.X&&(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.X_UP_TO_Z_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.X_UP_TO_Z_UP,b,b),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.X_UP_TO_Z_UP,O,O)),e._boundingBox=new Cesium.BoxGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,maximum:O,minimum:b}),e._boundingSphere=m}function YDe(e,t){let n=e._rendererResources,r=e._cachedRendererResources;PJ(n,r);let o;if(sz(e)||az(e)||e.splitDirection!==Wy.NONE||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,n.programs={},n.silhouettePrograms={};let l={},c=e._sourceTechniques,f;for(let h in c)c.hasOwnProperty(h)&&(f=c[h],o=f.program,l[o]||(l[o]=!0,DIe({programId:o,techniqueId:h},e,t.context)))}else n.programs=r.programs,n.silhouettePrograms=r.silhouettePrograms;let a=n.programs,s=e._nodeCommands,u=s.length;for(let l=0;l<u;++l){let c=s[l];o=c.programId;let f=a[o];c.command.shaderProgram=f,g(c.command2D)&&(c.command2D.shaderProgram=f)}TJ(e,t,!0),SJ(e,t,!0),IJ(e,t,!0)}gu.prototype.isDestroyed=function(){return!1};gu.prototype.destroy=function(){g(this._precreatedAttributes)&&_g(this._rendererResources.vertexArrays),g(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),g(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),g(this._cachedRendererResources)&&PJ(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),Kx.destroyCachedDataForModel(this);let e=this._pickIds,t=e.length;for(let r=0;r<t;++r)e[r].destroy();DJ(this),this._quantizedVertexShaders=void 0;let n=this._clippingPlanes;return g(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,st(this)};gu._getClippingFunction=PQ;gu._modifyShaderForColor=IIe;var NS=gu;function MJ(e,t,n,r){this.primitive=e,this._modelMatrix=G.clone(t),this._instanceId=n,this._modelColor=r}Object.defineProperties(MJ.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return G.clone(this._modelMatrix)},set:function(e){G.clone(e,this._modelMatrix),this.primitive.expandBoundingSphere(this._modelMatrix),this.primitive._dirty=!0}},modelColor:{get:function(){return this._modelColor}}});var PM=MJ;var Yy={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function Xy(e){e=T(e,T.EMPTY_OBJECT),this.show=T(e.show,!0),this._instancingSupported=!1,this._dynamic=T(e.dynamic,!1),this._allowPicking=T(e.allowPicking,!0),this._ready=!1,this._readyPromise=Bo(),this._state=Yy.NEEDS_LOAD,this._dirty=!1,this._cull=T(e.cull,!0),this._opaquePass=T(e.opaquePass,en.OPAQUE),this._instances=RJ(this,e.instances),this._batchTable=e.batchTable,this._model=void 0,this._vertexBufferTypedArray=void 0,this._vertexBuffer=void 0,this._batchIdBuffer=void 0,this._instancedColorTypedArray=void 0,this._instancedColorBuffer=void 0,this._instancedUniformsByProgram=void 0,this._drawCommands=[],this._modelCommands=void 0,this._renderStates=void 0,this._disableCullingRenderStates=void 0,this._boundingSphere=OJ(this),this._center=x.clone(this._boundingSphere.center),this._rtcTransform=new G,this._rtcModelView=new G,this._mode=void 0,this.modelMatrix=G.clone(G.IDENTITY),this._modelMatrix=G.clone(this.modelMatrix),this._url=vt.createIfNeeded(e.url),this._requestType=e.requestType,this._gltf=e.gltf,this._basePath=vt.createIfNeeded(e.basePath),this._asynchronous=e.asynchronous,this._incrementallyLoadTextures=e.incrementallyLoadTextures,this._upAxis=e.upAxis,this._forwardAxis=e.forwardAxis,this.shadows=T(e.shadows,io.ENABLED),this._shadows=this.shadows,this._pickIdLoaded=e.pickIdLoaded,this.splitDirection=T(e.splitDirection,Wy.NONE),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=T(e.debugWireframe,!1),this._debugWireframe=!1,g(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new fg,this._shouldDestroyImageBasedLighting=!0),this.backFaceCulling=T(e.backFaceCulling,!0),this._backFaceCulling=this.backFaceCulling,this.showCreditsOnScreen=T(e.showCreditsOnScreen,!1),this.precreatedAttributes=void 0,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._instancingRegenertedOnce=!1}Object.defineProperties(Xy.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},instancingRegenertedOnce:{get:function(){return this._instancingRegenertedOnce},set:function(e){this._instancingRegenertedOnce=e}},dirty:{get:function(){return this._dirty},set:function(e){this._dirty=e}}});function RJ(e,t){t=T(t,[]);let n=t.length,r=new Array(n);for(let a=0;a<n;++a){let s=t[a],u=s.modelMatrix,l=T(s.batchId,a);var o=s.modelColor;r[a]=new PM(e,u,l,o)}return r}function OJ(e){let t=e.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=G.getTranslation(e._instances[r]._modelMatrix,new x);return Ee.fromPoints(n)}var XDe=new x,dz=new G;Xy.prototype.expandBoundingSphere=function(e){let t=G.getTranslation(e,XDe);Ee.expand(this._boundingSphere,t,this._boundingSphere)};function jDe(e,t,n,r){return function(o,a){let s=o.semantic;if(g(s)&&e.indexOf(s)>-1)if(t.indexOf(s)>-1)r[a]=s;else throw new at(`Shader program cannot be optimized for instancing. Uniform "${a}" in program "${n}" uses unsupported semantic "${s}"`)}}function NJ(e,t){if(g(e._instancedUniformsByProgram))return e._instancedUniformsByProgram[t];let n={};e._instancedUniformsByProgram=n;let r=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"],o=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"],a=e._model._sourceTechniques;for(let s in a)if(a.hasOwnProperty(s)){let u=a[s],l=u.program;if(!g(n[l])){let c={};n[l]=c,re.techniqueUniform(u,jDe(r,o,t,c))}}return n[t]}function KDe(e){return function(t,n){let r=NJ(e,n),o=g(e._batchTable),a=e._useInstancedColor,s=Et.replaceMain(t,"czm_instancing_main"),u="",l="";for(let y in r)if(r.hasOwnProperty(y)){let v=r[y],w;v==="MODELVIEW"||v==="CESIUM_RTC_MODELVIEW"?w="czm_instanced_modelView":v==="MODELVIEWPROJECTION"?(w="czm_instanced_modelViewProjection",u+=`mat4 czm_instanced_modelViewProjection;
`,l+=`czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;
`):v==="MODELVIEWINVERSETRANSPOSE"&&(w="czm_instanced_modelViewInverseTranspose",u+=`mat3 czm_instanced_modelViewInverseTranspose;
`,l+=`czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);
`);let C=new RegExp(`uniform.*${y}.*`);s=s.replace(C,""),C=new RegExp(`${y}\\b`,"g"),s=s.replace(C,w)}let c=`uniform mat4 czm_instanced_modifiedModelView;
uniform mat4 czm_instanced_nodeTransform;
`,f,h,d;o?(f=`attribute float a_batchId;
`,h="",d=""):(f="",h=`attribute vec4 pickColor;
varying vec4 v_pickColor;
`,d=`    v_pickColor = pickColor;
`);var p="";a&&(p=`attribute vec4 instancedColor;
varying vec4 v_instancedColor;
`,d+=` v_instancedColor = instancedColor;
`);let _=`${c+u}mat4 czm_instanced_modelView;
attribute vec4 czm_modelMatrixRow0;
attribute vec4 czm_modelMatrixRow1;
attribute vec4 czm_modelMatrixRow2;
${f}${h}${p}${s}void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);
    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;
${l}    czm_instancing_main();
${d}}
`;if(o){let y=e._model.gltfInternal,v=Mr.getDiffuseAttributeOrUniform(y,n);_=e._batchTable.getVertexShaderCallback(!0,"a_batchId",v)(_)}return _}}function ZDe(e){return function(t,n){let r=e._batchTable;if(g(r)){let o=e._model.gltfInternal,a=Mr.getDiffuseAttributeOrUniform(o,n);t=r.getFragmentShaderCallback(!0,a,!1)(t)}else t=`varying vec4 v_pickColor;
${t}`;return t}}function QDe(e,t){return function(){return G.multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}function JDe(e){return function(){return e.computedMatrix}}function $De(e,t){return function(n,r,o){n=Ht(n),n.czm_instanced_modifiedModelView=QDe(e,t),n.czm_instanced_nodeTransform=JDe(o);let a=NJ(e,r);for(let s in a)a.hasOwnProperty(s)&&delete n[s];return g(e._batchTable)&&(n=e._batchTable.getUniformMapCallback()(n)),n}}function ePe(e){return function(t,n){if(g(e._batchTable)){let r=e._model.gltfInternal,o=Mr.getDiffuseAttributeOrUniform(r,n);t=e._batchTable.getVertexShaderCallback(!0,"a_batchId",o)(t),t=`uniform float a_batchId
;${t}`}return t}}function tPe(e){return function(t,n){let r=e._batchTable;if(g(r)){let o=e._model.gltfInternal,a=Mr.getDiffuseAttributeOrUniform(o,n);t=r.getFragmentShaderCallback(!0,a,!1)(t)}else t=`uniform vec4 czm_pickColor;
${t}`;return t}}function nPe(e){return function(t){return g(e._batchTable)&&(t=e._batchTable.getUniformMapCallback()(t)),t}}function BJ(e){let t=e._instances,n=e.length,r=e._center,o=12,a=e._vertexBufferTypedArray;g(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(let s=0;s<n;++s){let u=t[s]._modelMatrix,l=G.clone(u,dz);l[12]-=r.x,l[13]-=r.y,l[14]-=r.z;let c=s*o;a[c+0]=l[0],a[c+1]=l[4],a[c+2]=l[8],a[c+3]=l[12],a[c+4]=l[1],a[c+5]=l[5],a[c+6]=l[9],a[c+7]=l[13],a[c+8]=l[2],a[c+9]=l[6],a[c+10]=l[10],a[c+11]=l[14]}return a}function FJ(e){var t=e._instances,n=e.length,r=4,o=e._instancedColorTypedArray;Cesium.defined(o)||(o=new Float32Array(n*r)),e._dynamic&&(e._instancedColorTypedArray=o);for(var a=0;a<n;++a){var s=t[a]._modelColor,u=a*r;o[u+0]=s.red,o[u+1]=s.green,o[u+2]=s.blue,o[u+3]=e._useInstancedColor?s.alpha:-1}return o}function zJ(e,t){let n,r=e._instances,o=e.length,a=e._dynamic,s=g(e._batchTable);if(s){let c=new Uint16Array(o);for(n=0;n<o;++n)c[n]=r[n]._instanceId;e._batchIdBuffer=Ui.createVertexBuffer({context:t,typedArray:c,usage:We.STATIC_DRAW})}if(!s){let c=new Uint8Array(o*4);for(n=0;n<o;++n){let h=e._pickIds[n].color,d=n*4;c[d]=K.floatToByte(h.red),c[d+1]=K.floatToByte(h.green),c[d+2]=K.floatToByte(h.blue),c[d+3]=K.floatToByte(h.alpha)}e._pickIdBuffer=Ui.createVertexBuffer({context:t,typedArray:c,usage:We.STATIC_DRAW})}if(e._useInstancedColor){var u=FJ(e);e._instancedColorBuffer=Cesium.Buffer.createVertexBuffer({context:t,typedArray:u,usage:a?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW})}let l=BJ(e);e._vertexBuffer=Ui.createVertexBuffer({context:t,typedArray:l,usage:a?We.STREAM_DRAW:We.STATIC_DRAW})}function rPe(e){e._vertexBufferTypedArray=void 0;let t=BJ(e);if(e._vertexBuffer.copyFromArrayView(t),e._useInstancedColor){e._instancedColorTypedArray=void 0;var n=FJ(e);e._instancedColorBuffer.copyFromArrayView(n)}}function VJ(e,t){let n=e._instances,r=n.length,o=new Array(r);for(let a=0;a<r;++a)o[a]=t.createPickId(n[a]);return o}function iPe(e,t){let n=e._instancingSupported;n||ul("cpuModelInstancing","Support for rendering instanced models on the CPU has been deprecated and will be removed in CesiumJS 1.97.");let r=g(e._batchTable),o=e._allowPicking,a={url:e._url,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:e._cacheKey,asynchronous:e._asynchronous,allowPicking:o,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,forwardAxis:e._forwardAxis,precreatedAttributes:void 0,vertexShaderLoaded:void 0,fragmentShaderLoaded:void 0,uniformMapLoaded:void 0,pickIdLoaded:e._pickIdLoaded,ignoreCommands:!0,opaquePass:e._opaquePass,imageBasedLighting:e._imageBasedLighting,showOutline:e.showOutline,showCreditsOnScreen:e.showCreditsOnScreen,useInstancedColor:e._useInstancedColor};if(r||(e._pickIds=VJ(e,t)),n){zJ(e,t);let s=12,u=ie.getSizeInBytes(ie.FLOAT),l={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:u*4,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:u*8,strideInBytes:u*s,instanceDivisor:1}};r&&(l.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:ie.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),r||(l.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:ie.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),e._useInstancedColor&&(l.instancedColor={index:0,vertexBuffer:e._instancedColorBuffer,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),e.precreatedAttributes=l,a.precreatedAttributes=l,a.vertexShaderLoaded=KDe(e),a.fragmentShaderLoaded=ZDe(e),a.uniformMapLoaded=$De(e,t),g(e._url)&&(a.cacheKey=`${e._url.getUrlComponent()}#instanced`)}else a.vertexShaderLoaded=ePe(e),a.fragmentShaderLoaded=tPe(e),a.uniformMapLoaded=nPe(e,t);g(e._url)?e._model=NS.fromGltf(a):e._model=new NS(a)}function oPe(e,t){e._vertexBufferTypedArray=void 0,e._instancedColorTypedArray=void 0;var n=Cesium.defined(e._batchTable);if(!n){var r=e._pickIds;if(Cesium.defined(r))for(var o=r.length,a=0;a<o;++a)r[a].destroy();e._pickIds=VJ(e,t)}e._instancingSupported&&(e._batchIdBuffer&&!e._batchIdBuffer.isDestroyed()&&e._batchIdBuffer.destroy(),e._batchIdBuffer=void 0,e._pickIdBuffer&&!e._pickIdBuffer.isDestroyed()&&e._pickIdBuffer.destroy(),e._pickIdBuffer=void 0,e._vertexBuffer&&!e._vertexBuffer.isDestroyed()&&e._vertexBuffer.destroy(),e._vertexBuffer=void 0,e._instancedColorBuffer&&!e._instancedColorBuffer.isDestroyed()&&e._instancedColorBuffer.destroy(),e._instancedColorBuffer=void 0,zJ(e,t),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow0)&&(e.precreatedAttributes.czm_modelMatrixRow0.vertexBuffer=e._vertexBuffer),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow1)&&(e.precreatedAttributes.czm_modelMatrixRow1.vertexBuffer=e._vertexBuffer),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow2)&&(e.precreatedAttributes.czm_modelMatrixRow2.vertexBuffer=e._vertexBuffer),n&&Cesium.defined(e.precreatedAttributes.a_batchId)&&(e.precreatedAttributes.a_batchId.vertexBuffer=e._batchIdBuffer),!n&&Cesium.defined(e.precreatedAttributes.pickColor)&&(e.precreatedAttributes.pickColor.vertexBuffer=e._pickIdBuffer),e._useInstancedColor&&Cesium.defined(e.precreatedAttributes.instancedColor)&&(e.precreatedAttributes.instancedColor.vertexBuffer=e._instancedColorBuffer))}function aPe(e,t){if(e._debugWireframe!==e.debugWireframe||t){e._debugWireframe=e.debugWireframe;let n=e.debugWireframe?sn.LINES:sn.TRIANGLES,r=e._drawCommands,o=r.length;for(let a=0;a<o;++a)r[a].primitiveType=n}}function sPe(e){let t=Ht(e,!0);return t.cull.enabled=!1,fn.fromCache(t)}function uPe(e,t){if(e._backFaceCulling!==e.backFaceCulling||t){e._backFaceCulling=e.backFaceCulling;let n=e._drawCommands,r=n.length,o;if(!g(e._disableCullingRenderStates))for(e._disableCullingRenderStates=new Array(r),e._renderStates=new Array(r),o=0;o<r;++o){let a=n[o].renderState,s=sPe(a);e._disableCullingRenderStates[o]=s,e._renderStates[o]=a}for(o=0;o<r;++o)n[o].renderState=e._backFaceCulling?e._renderStates[o]:e._disableCullingRenderStates[o]}}function lPe(e,t){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume||t){e._debugShowBoundingVolume=e.debugShowBoundingVolume;let n=e._drawCommands,r=n.length;for(let o=0;o<r;++o)n[o].debugShowBoundingVolume=e.debugShowBoundingVolume}}function cPe(e,t){let n=t.length,r=e.length,o=e._boundingSphere,a=e._cull;for(let s=0;s<n;++s){let u=$t.shallowClone(t[s]);u.instanceCount=r,u.boundingVolume=o,u.cull=a,g(e._batchTable)?u.pickId=e._batchTable.getPickId():u.pickId="v_pickColor",e._drawCommands.push(u)}}function fPe(e){return function(){return e}}function hPe(e){return function(){return e}}function dPe(e,t){let n=e._instances,r=t.length,o=e.length,a=e._batchTable,s=g(a),u=e._cull;for(let l=0;l<r;++l)for(let c=0;c<o;++c){let f=$t.shallowClone(t[l]);if(f.modelMatrix=new G,f.boundingVolume=new Ee,f.cull=u,f.uniformMap=Ht(f.uniformMap),s)f.uniformMap.a_batchId=fPe(n[c]._instanceId);else{let h=e._pickIds[c];f.uniformMap.czm_pickColor=hPe(h.color)}e._drawCommands.push(f)}}function kJ(e){let t=e._modelCommands,n=t.length,r=e.length,o=e._rtcTransform,a=e._center;for(let s=0;s<n;++s){let u=t[s];for(let l=0;l<r;++l){let c=s*r+l,f=e._drawCommands[c],h=G.clone(e._instances[l]._modelMatrix,dz);h[12]-=a.x,h[13]-=a.y,h[14]-=a.z,h=G.multiply(o,h,dz);let d=u.modelMatrix,p=f.modelMatrix;G.multiply(h,d,p);let _=u.boundingVolume,y=f.boundingVolume;Ee.transform(_,h,y)}}}function GJ(e){let t=e._nodeCommands,n=t.length,r=[];for(let o=0;o<n;++o){let a=t[o];a.show&&r.push(a.command)}return r}function pPe(e){let t=e._nodeCommands,n=t.length,r=!1;for(let o=0;o<n;o++){let a=t[o];a.command.dirty&&(a.command.dirty=!1,r=!0)}return r}function LJ(e,t){e._drawCommands=[];let n=GJ(e._model);t?cPe(e,n):(dPe(e,n),kJ(e))}function mPe(e,t){if(e.shadows!==e._shadows||t){e._shadows=e.shadows;let n=io.castShadows(e.shadows),r=io.receiveShadows(e.shadows),o=e._drawCommands,a=o.length;for(let s=0;s<a;++s){let u=o[s];u.castShadows=n,u.receiveShadows=r}}}Xy.prototype.regenerteInstanced=function(e){this._instances=[],this._instances=RJ(this,e)};Xy.prototype.update=function(e){if(e.mode===Ne.MORPHING||!this.show||this.length===0)return;let t=e.context;if(this._state===Yy.NEEDS_LOAD){this._state=Yy.LOADING,this._instancingSupported=t.instancedArrays,iPe(this,t);let y=this;this._model.readyPromise.catch(function(v){y._state=Yy.FAILED,y._readyPromise.reject(v)})}let n=this._instancingSupported,r=this._model;r.imageBasedLighting=this._imageBasedLighting,r.showCreditsOnScreen=this.showCreditsOnScreen,r.splitDirection=this.splitDirection;var o=Cesium.Cartesian3.clone(this._center);if(n&&r.ready){this._boundingSphere=OJ(this);var a=r.boundingSphere.radius+Cesium.Cartesian3.magnitude(r.boundingSphere.center);this._boundingSphere.radius+=a,this._center=Cesium.Cartesian3.clone(this._boundingSphere.center)}if(n&&this._instancingRegenertedOnce&&(oPe(this,t),this._instancingRegenertedOnce=!1,r.recreateVertexArraysOnce=!0),r.update(e),r.ready&&this._state===Yy.LOADING){this._state=Yy.LOADED,this._ready=!0;let y=r.boundingSphereInternal.radius+x.magnitude(r.boundingSphereInternal.center);this._boundingSphere.radius+=y,this._modelCommands=GJ(r),LJ(this,n),this._readyPromise.resolve(this);return}if(this._state!==Yy.LOADED)return;let s=e.mode!==this._mode,u=this.modelMatrix,l=!G.equals(this._modelMatrix,u),c=!Cesium.Cartesian3.equals(o,this._center);if(s||l||c){this._mode=e.mode,G.clone(u,this._modelMatrix);let y=G.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);this._mode!==Ne.SCENE3D&&(y=Cn.basisTo2D(e.mapProjection,y,y)),G.getTranslation(y,this._boundingSphere.center)}n&&this._dirty&&(this._dynamic=!0,this._dirty=!1,rPe(this));let f=pPe(r);f&&LJ(this,n),!n&&(r.dirty||this._dirty||s||l)&&kJ(this),mPe(this,f),aPe(this,f),uPe(this,f),lPe(this,f);let h=e.passes;if(!h.render&&!h.pick)return;let d=e.commandList,p=this._drawCommands,_=p.length;for(let y=0;y<_;++y)d.push(p[y])};Xy.prototype.isDestroyed=function(){return!1};Xy.prototype.destroy=function(){this._model=this._model&&this._model.destroy();let e=this._pickIds;if(g(e)){let t=e.length;for(let n=0;n<t;++n)e[n].destroy()}return this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,this._instancingSupported&&(this._batchIdBuffer&&!this._batchIdBuffer.isDestroyed()&&this._batchIdBuffer.destroy(),this._batchIdBuffer=void 0,this._pickIdBuffer&&!this._pickIdBuffer.isDestroyed()&&this._pickIdBuffer.destroy(),this._pickIdBuffer=void 0,this._vertexBuffer&&!this._vertexBuffer.isDestroyed()&&this._vertexBuffer.destroy(),this._vertexBuffer=void 0,this._instancedColorBuffer&&!this._instancedColorBuffer.isDestroyed()&&this._instancedColorBuffer.destroy(),this._instancedColorBuffer=void 0),st(this)};var MM=Xy;function vs(e){this._id=Ci();let t=e.featuresLength;this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[];let n,r;if(t>0){let o=Math.min(t,Jt.maximumTextureSize),a=Math.ceil(t/Jt.maximumTextureSize),s=1/o,u=s*.5,l=1/a,c=l*.5;n=new X(o,a),r=new Se(s,u,l,c)}this._translucentFeaturesLength=0,this._featuresLength=t,this._textureDimensions=n,this._textureStep=r,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}Object.defineProperties(vs.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return g(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),g(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}});vs.DEFAULT_COLOR_VALUE=K.WHITE;vs.DEFAULT_SHOW_VALUE=!0;function UJ(e){let t=e._textureDimensions;return t.x*t.y*4}function HJ(e){if(!g(e._batchValues)){let t=UJ(e),n=new Uint8Array(t).fill(255);e._batchValues=n}return e._batchValues}function qJ(e){if(!g(e._showAlphaProperties)){let t=2*e._featuresLength,n=new Uint8Array(t).fill(255);e._showAlphaProperties=n}return e._showAlphaProperties}vs.prototype.setShow=function(e,t){if(t&&!g(this._showAlphaProperties))return;let n=qJ(this),r=e*2,o=t?255:0;if(n[r]!==o){n[r]=o;let a=HJ(this),s=e*4+3;a[s]=t?n[r+1]:0,this._batchValuesDirty=!0}};vs.prototype.setAllShow=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setShow(n,e)};vs.prototype.getShow=function(e){if(!g(this._showAlphaProperties))return!0;let t=e*2;return this._showAlphaProperties[t]===255};var gPe=new Array(4);vs.prototype.setColor=function(e,t){if(K.equals(t,vs.DEFAULT_COLOR_VALUE)&&!g(this._batchValues))return;let n=t.toBytes(gPe),r=n[3],o=HJ(this),a=e*4,s=qJ(this),u=e*2;if(o[a]!==n[0]||o[a+1]!==n[1]||o[a+2]!==n[2]||s[u+1]!==r){o[a]=n[0],o[a+1]=n[1],o[a+2]=n[2];let l=s[u+1]!==255,c=s[u]!==0;o[a+3]=c?r:0,s[u+1]=r;let f=r!==255;f&&!l?++this._translucentFeaturesLength:!f&&l&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,g(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}};vs.prototype.setAllColor=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setColor(n,e)};vs.prototype.getColor=function(e,t){if(!g(this._batchValues))return K.clone(vs.DEFAULT_COLOR_VALUE,t);let n=this._batchValues,r=e*4,o=this._showAlphaProperties,a=e*2;return K.fromBytes(n[r],n[r+1],n[r+2],o[a+1],t)};vs.prototype.getPickColor=function(e){return this._pickIds[e]};function WJ(e,t,n){let r=e._textureDimensions;return new na({context:t,pixelFormat:qt.RGBA,pixelDatatype:xt.UNSIGNED_BYTE,source:{width:r.x,height:r.y,arrayBufferView:n},flipY:!1,sampler:Oa.NEAREST})}function _Pe(e,t){let n=e._featuresLength;if(!g(e._pickTexture)&&n>0){let r=e._pickIds,o=UJ(e),a=new Uint8Array(o),s=e._owner,u=e._statistics;for(let l=0;l<n;++l){let c=t.createPickId(s.getFeature(l));r.push(c);let f=c.color,h=l*4;a[h]=K.floatToByte(f.red),a[h+1]=K.floatToByte(f.green),a[h+2]=K.floatToByte(f.blue),a[h+3]=K.floatToByte(f.alpha)}e._pickTexture=WJ(e,t,a),g(u)&&(u.batchTableByteLength+=e._pickTexture.sizeInBytes)}}function yPe(e){let t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}vs.prototype.update=function(e,t){let n=t.context;this._defaultTexture=n.defaultTexture;let r=t.passes;(r.pick||r.postProcess)&&_Pe(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,g(this._batchTexture)||(this._batchTexture=WJ(this,n,this._batchValues),g(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),yPe(this))};vs.prototype.isDestroyed=function(){return!1};vs.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let e=this._pickIds,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return st(this)};var vPe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CPe={SCALAR:void 0,VEC2:X,VEC3:x,VEC4:Se,MAT2:Ra,MAT3:te,MAT4:G};function xPe(e){let t=e.componentType,n;typeof t=="string"?n=ie.fromName(t):n=t;let r=vPe[e.type],o=CPe[e.type];return{componentsPerAttribute:r,classType:o,createArrayBufferView:function(a,s,u){return ie.createArrayBufferView(n,a,s,r*u)}}}var jy=xPe;function Dd(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,wPe(this,e.extension,e.binaryBody)}Object.defineProperties(Dd.prototype,{byteLength:{get:function(){return this._byteLength}}});function wPe(e,t,n){let r,o,a,s=t.instancesLength,u=t.classes,l=t.classIds,c=t.parentCounts,f=t.parentIds,h=s,d=0;g(l.byteOffset)&&(l.componentType=T(l.componentType,ie.UNSIGNED_SHORT),l.type=Wc.SCALAR,a=jy(l),l=a.createArrayBufferView(n.buffer,n.byteOffset+l.byteOffset,s),d+=l.byteLength);let p;if(g(c)){for(g(c.byteOffset)&&(c.componentType=T(c.componentType,ie.UNSIGNED_SHORT),c.type=Wc.SCALAR,a=jy(c),c=a.createArrayBufferView(n.buffer,n.byteOffset+c.byteOffset,s),d+=c.byteLength),p=new Uint16Array(s),h=0,r=0;r<s;++r)p[r]=h,h+=c[r];d+=p.byteLength}g(f)&&g(f.byteOffset)&&(f.componentType=T(f.componentType,ie.UNSIGNED_SHORT),f.type=Wc.SCALAR,a=jy(f),f=a.createArrayBufferView(n.buffer,n.byteOffset+f.byteOffset,h),d+=f.byteLength);let _=u.length;for(r=0;r<_;++r){let w=u[r].length,C=u[r].instances,E=EPe(w,C,n);d+=TPe(E),u[r].instances=ji(E,C)}let y=new Array(_).fill(0),v=new Uint16Array(s);for(r=0;r<s;++r)o=l[r],v[r]=y[o],++y[o];d+=v.byteLength,e._classes=u,e._classIds=l,e._classIndexes=v,e._parentCounts=c,e._parentIndexes=p,e._parentIds=f,e._byteLength=d}function EPe(e,t,n){let r;for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=a.byteOffset;if(g(s)){let u=a.componentType,l=a.type;if(!g(u))throw new at("componentType is required.");if(!g(l))throw new at("type is required.");if(!g(n))throw new at(`Property ${o} requires a batch table binary.`);let c=jy(a),f=c.componentsPerAttribute,h=c.classType,d=c.createArrayBufferView(n.buffer,n.byteOffset+s,e);g(r)||(r={}),r[o]={typedArray:d,componentCount:f,type:h}}}return r}function TPe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}var SPe=[],APe=[],bPe=0;function IPe(e,t,n){let r=e._classIds,o=e._parentCounts,a=e._parentIds,s=e._parentIndexes,u=r.length,l=SPe;l.length=Math.max(l.length,u);let c=++bPe,f=APe;for(f.length=0,f.push(t);f.length>0;){if(t=f.pop(),l[t]===c)continue;l[t]=c;let h=n(e,t);if(g(h))return h;let d=o[t],p=s[t];for(let _=0;_<d;++_){let y=a[p+_];y!==t&&f.push(y)}}}function DPe(e,t,n){let r=!0;for(;r;){let o=n(e,t);if(g(o))return o;let a=e._parentIds[t];r=a!==t,t=a}}function BS(e,t,n){let r=e._parentCounts,o=e._parentIds;if(g(o)){if(g(r))return IPe(e,t,n)}else return n(e,t);return DPe(e,t,n)}Dd.prototype.hasProperty=function(e,t){let n=BS(this,e,function(r,o){let a=r._classIds[o],s=r._classes[a].instances;if(g(s[t]))return!0});return g(n)};Dd.prototype.propertyExists=function(e){let t=this._classes,n=t.length;for(let r=0;r<n;++r){let o=t[r].instances;if(g(o[e]))return!0}return!1};Dd.prototype.getPropertyIds=function(e,t){return t=g(t)?t:[],t.length=0,BS(this,e,function(n,r){let o=n._classIds[r],a=n._classes[o].instances;for(let s in a)a.hasOwnProperty(s)&&t.indexOf(s)===-1&&t.push(s)}),t};Dd.prototype.getProperty=function(e,t){return BS(this,e,function(n,r){let o=n._classIds[r],a=n._classes[o],s=n._classIndexes[r],u=a.instances[t];if(g(u))return g(u.typedArray)?PPe(u,s):Ht(u[s],!0)})};function PPe(e,t){let n=e.typedArray,r=e.componentCount;return r===1?n[t]:e.type.unpack(n,t*r)}Dd.prototype.setProperty=function(e,t,n){let r=BS(this,e,function(o,a){let s=o._classIds[a],u=o._classes[s],l=o._classIndexes[a],c=u.instances[t];if(g(c))return g(c.typedArray)?MPe(c,l,n):c[l]=Ht(n,!0),!0});return g(r)};function MPe(e,t,n){let r=e.typedArray,o=e.componentCount;o===1?r[t]=n:e.type.pack(n,r,t*o)}Dd.prototype.isClass=function(e,t){let n=BS(this,e,function(r,o){let a=r._classIds[o];if(r._classes[a].name===t)return!0});return g(n)};Dd.prototype.getClassName=function(e){let t=this._classIds[e];return this._classes[t].name};var LPe={HIGHLIGHT:0,REPLACE:1,MIX:2},LM=Object.freeze(LPe);var pz=vs.DEFAULT_COLOR_VALUE,mz=vs.DEFAULT_SHOW_VALUE;function Fi(e,t,n,r,o){this.featuresLength=t;let a;g(n)&&(a=n.extensions),this._extensions=T(a,{});let s=RPe(n);this._properties=s,this._batchTableHierarchy=OPe(this,n,r);let u=XJ(t,s,r);this._binaryPropertiesByteLength=NPe(u),this._batchTableBinaryProperties=u,this._content=e,this._batchTexture=new vs({featuresLength:t,colorChangedCallback:o,owner:e,statistics:e.tileset.statistics})}Fi._deprecationWarning=ul;Object.defineProperties(Fi.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return g(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}});function RPe(e){let t={};if(!g(e))return t;for(let n in e)e.hasOwnProperty(n)&&n!=="HIERARCHY"&&n!=="extensions"&&n!=="extras"&&(t[n]=Ht(e[n],!0));return t}function OPe(e,t,n){if(!g(t))return;let r=e._extensions["3DTILES_batch_table_hierarchy"],o=t.HIERARCHY;if(g(o)&&(Fi._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=o,r=o),!!g(r))return new Dd({extension:r,binaryBody:n})}function XJ(e,t,n){let r;for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=a.byteOffset;if(g(s)){let u=a.componentType,l=a.type;if(!g(u))throw new at("componentType is required.");if(!g(l))throw new at("type is required.");if(!g(n))throw new at(`Property ${o} requires a batch table binary.`);let c=jy(a),f=c.componentsPerAttribute,h=c.classType,d=c.createArrayBufferView(n.buffer,n.byteOffset+s,e);g(r)||(r={}),r[o]={typedArray:d,componentCount:f,type:h}}}return r}function NPe(e){if(!g(e))return 0;let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}Fi.getBinaryProperties=function(e,t,n){return XJ(e,t,n)};Fi.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)};Fi.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)};Fi.prototype.getShow=function(e){return this._batchTexture.getShow(e)};Fi.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)};Fi.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)};Fi.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)};Fi.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};var BPe=new K;Fi.prototype.applyStyle=function(e){if(!g(e)){this.setAllColor(pz),this.setAllShow(mz);return}let t=this._content,n=this.featuresLength;for(let r=0;r<n;++r){let o=t.getFeature(r),a=g(e.color)?T(e.color.evaluateColor(o,BPe),pz):pz,s=g(e.show)?T(e.show.evaluate(o),mz):mz;this.setColor(r,a),this.setShow(r,s)}};function FPe(e,t){let n=e.typedArray,r=e.componentCount;return r===1?n[t]:e.type.unpack(n,t*r)}function zPe(e,t,n){let r=e.typedArray,o=e.componentCount;o===1?r[t]=n:e.type.pack(n,r,t*o)}Fi.prototype.isClass=function(e,t){let n=this._batchTableHierarchy;return g(n)?n.isClass(e,t):!1};Fi.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t};Fi.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(!!g(t))return t.getClassName(e)};Fi.prototype.hasProperty=function(e,t){return g(this._properties[t])||g(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)};Fi.prototype.hasPropertyBySemantic=function(){return!1};Fi.prototype.getPropertyIds=function(e,t){t=g(t)?t:[],t.length=0;let n=Object.keys(this._properties);return t.push.apply(t,n),g(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,n)),t};Fi.prototype.getPropertyBySemantic=function(e,t){};Fi.prototype.getProperty=function(e,t){if(g(this._batchTableBinaryProperties)){let r=this._batchTableBinaryProperties[t];if(g(r))return FPe(r,e)}let n=this._properties[t];if(g(n))return Ht(n[e],!0);if(g(this._batchTableHierarchy)){let r=this._batchTableHierarchy.getProperty(e,t);if(g(r))return r}};Fi.prototype.setProperty=function(e,t,n){let r=this.featuresLength;if(g(this._batchTableBinaryProperties)){let a=this._batchTableBinaryProperties[t];if(g(a)){zPe(a,e,n);return}}if(g(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))return;let o=this._properties[t];g(o)||(this._properties[t]=new Array(r),o=this._properties[t]),o[e]=Ht(n,!0)};function VPe(e){return e._batchTexture.textureDimensions.y===1?`uniform vec4 tile_textureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    return vec2(centerX + (batchId * stepX), 0.5); 
} 
`:`uniform vec4 tile_textureStep; 
uniform vec2 tile_textureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    float stepY = tile_textureStep.z; 
    float centerY = tile_textureStep.w; 
    float xId = mod(batchId, tile_textureDimensions.x); 
    float yId = floor(batchId / tile_textureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}Fi.prototype.getVertexShaderCallback=function(e,t,n){if(this.featuresLength===0)return;let r=this;return function(o){let a=jJ(o,n,!1),s;return Jt.maximumVertexTextureImageUnits>0?(s="",e&&(s+=`uniform bool tile_translucentCommand; 
`),s+=`uniform sampler2D tile_batchTexture; 
varying vec4 tile_featureColor; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec2 st = computeSt(${t}); 
    vec4 featureProperties = texture2D(tile_batchTexture, st); 
    tile_color(featureProperties); 
    float show = ceil(featureProperties.a); 
    gl_Position *= show; 
`,e&&(s+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
`),s+=`    tile_featureColor = featureProperties; 
    tile_featureSt = st; 
}`):s=`varying vec2 tile_featureSt; 
void main() 
{ 
    tile_color(vec4(1.0)); 
    tile_featureSt = computeSt(${t}); 
}`,`${a}
${VPe(r)}${s}`}};function YJ(e,t){return e=Et.replaceMain(e,"tile_main"),t?`${e}uniform float tile_colorBlend; 
void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
} 
`:`${e}void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
} 
`}function kPe(e,t){let n=`texture2D(${t}`,r=0,o=e.indexOf(n,r),a;for(;o>-1;){let s=0;for(let c=o;c<e.length;++c){let f=e.charAt(c);if(f==="(")++s;else if(f===")"&&(--s,s===0)){a=c+1;break}}let l=`tile_diffuse_final(${e.slice(o,a)}, tile_diffuse)`;e=e.slice(0,o)+l+e.slice(a),r=o+l.length,o=e.indexOf(n,r)}return e}function jJ(e,t,n){if(!g(t))return YJ(e,n);let r=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${t};`),o=e.match(r);if(!g(o))return YJ(e,n);let a=o[0],s=o[2];e=Et.replaceMain(e,"tile_main"),e=e.replace(a,"");let u=`bool isWhite(vec3 color) 
{ 
    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); 
} 
vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) 
{ 
    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); 
    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; 
    return vec4(diffuse.rgb, sourceDiffuse.a); 
} 
`,l=`    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
`,c;if(s==="vec3"||s==="vec4"){let f=s==="vec3"?`vec4(${t}, 1.0)`:t,h=s==="vec3"?"tile_diffuse.xyz":"tile_diffuse";r=new RegExp(t,"g"),e=e.replace(r,h),c=`    vec4 source = ${f}; 
    tile_diffuse = tile_diffuse_final(source, tile_featureColor); 
    tile_main(); 
`}else s==="sampler2D"&&(e=kPe(e,t),c=`    tile_diffuse = tile_featureColor; 
    tile_main(); 
`);return e=`uniform float tile_colorBlend; 
vec4 tile_diffuse = vec4(1.0); 
${u}${a}
${e}
void tile_color(vec4 tile_featureColor) 
{ 
${c}`,n&&(e+=l),e+=`} 
`,e}Fi.prototype.getFragmentShaderCallback=function(e,t,n){if(this.featuresLength!==0)return function(r){return r=jJ(r,t,!0),Jt.maximumVertexTextureImageUnits>0?(r+=`uniform sampler2D tile_pickTexture; 
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_color(tile_featureColor); 
`,n&&(r+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),r+="}"):(e&&(r+=`uniform bool tile_translucentCommand; 
`),r+=`uniform sampler2D tile_pickTexture; 
uniform sampler2D tile_batchTexture; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
`,e&&(r+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            discard; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            discard; 
        } 
    } 
`),r+=`    tile_color(featureProperties); 
`,n&&(r+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),r+=`} 
`),r}};Fi.prototype.getClassificationFragmentShaderCallback=function(){if(this.featuresLength!==0)return function(e){return e=Et.replaceMain(e,"tile_main"),Jt.maximumVertexTextureImageUnits>0?e+=`uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_main(); 
    gl_FragColor = tile_featureColor; 
    gl_FragColor.rgb *= gl_FragColor.a; 
}`:e+=`uniform sampler2D tile_batchTexture; 
uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
void main() 
{ 
    tile_main(); 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
    gl_FragColor = featureProperties; 
    gl_FragColor.rgb *= gl_FragColor.a; 
} 
`,e}};function GPe(e){let t=e._content.tileset,n=Cesium.defined(t)&&Cesium.defined(t.colorBlendMode)?t.colorBlendMode:Cesium.Cesium3DTileColorBlendMode.REPLACE,r=Cesium.defined(t)&&Cesium.defined(t.colorBlendAmount)?t.colorBlendAmount:.5;if(n===LM.HIGHLIGHT)return 0;if(n===LM.REPLACE)return 1;if(n===LM.MIX)return F.clamp(r,F.EPSILON4,1)}Fi.prototype.getUniformMapCallback=function(){if(this.featuresLength===0)return;let e=this;return function(t){return ji(t,{tile_batchTexture:function(){return T(e._batchTexture.batchTexture,e._batchTexture.defaultTexture)},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return GPe(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}})}};Fi.prototype.getPickId=function(){return"texture2D(tile_pickTexture, tile_featureSt)"};var _f={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};Fi.prototype.addDerivedCommands=function(e,t){let n=e.commandList,r=n.length,o=this._content._tile,a=o._finalResolution,s=o.tileset,u=s._skipLevelOfDetail&&s._hasMixedContent&&e.context.stencilBuffer,l=KJ(this);for(let c=t;c<r;++c){let f=n[c];if(f.pass===en.COMPUTE)continue;let h=f.derivedCommands.tileset;(!g(h)||f.dirty)&&(h={},f.derivedCommands.tileset=h,h.originalCommand=ZJ(f),f.dirty=!1);let d=h.originalCommand;l!==_f.ALL_OPAQUE&&f.pass!==en.TRANSLUCENT&&(g(h.translucent)||(h.translucent=QJ(d))),l!==_f.ALL_TRANSLUCENT&&f.pass!==en.TRANSLUCENT&&(g(h.opaque)||(h.opaque=JJ(d)),u&&(a||(g(h.zback)||(h.zback=$J(e.context,d)),s._backfaceCommands.push(h.zback)),(!g(h.stencil)||o._selectionDepth!==t$(h.stencil))&&(f.renderState.depthMask?h.stencil=e$(d,o._selectionDepth):h.stencil=h.opaque)));let p=u?h.stencil:h.opaque,_=h.translucent;f.pass!==en.TRANSLUCENT?(l===_f.ALL_OPAQUE&&(n[c]=p),l===_f.ALL_TRANSLUCENT&&(n[c]=_),l===_f.OPAQUE_AND_TRANSLUCENT&&(n[c]=p,n.push(_))):n[c]=d}};Fi.prototype.addDerivedCommandsNoTileset=function(e,t){let n=e.commandList,r=n.length,o=!1,a=KJ(this);for(let s=t;s<r;++s){let u=n[s];if(u.pass===en.COMPUTE)continue;let l=u.derivedCommands.tileset;(!g(l)||u.dirty)&&(l={},u.derivedCommands.tileset=l,l.originalCommand=ZJ(u),u.dirty=!1);let c=l.originalCommand;a!==_f.ALL_OPAQUE&&u.pass!==en.TRANSLUCENT&&(g(l.translucent)||(l.translucent=QJ(c))),a!==_f.ALL_TRANSLUCENT&&u.pass!==en.TRANSLUCENT&&(g(l.opaque)||(l.opaque=JJ(c)),o&&(finalResolution||(g(l.zback)||(l.zback=$J(e.context,c)),tileset._backfaceCommands.push(l.zback)),(!g(l.stencil)||tile._selectionDepth!==t$(l.stencil))&&(u.renderState.depthMask?l.stencil=e$(c,tile._selectionDepth):l.stencil=l.opaque)));let f=o?l.stencil:l.opaque,h=l.translucent;u.pass!==en.TRANSLUCENT?(a===_f.ALL_OPAQUE&&(n[s]=f),a===_f.ALL_TRANSLUCENT&&(n[s]=h),a===_f.OPAQUE_AND_TRANSLUCENT&&(n[s]=f,n.push(h))):n[s]=c}};function KJ(e){let t=e._batchTexture.translucentFeaturesLength;return t===0?_f.ALL_OPAQUE:t===e.featuresLength?_f.ALL_TRANSLUCENT:_f.OPAQUE_AND_TRANSLUCENT}function ZJ(e){let t=$t.shallowClone(e),n=t.pass===en.TRANSLUCENT;return t.uniformMap=g(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return n},t}function QJ(e){let t=$t.shallowClone(e);return t.pass=en.TRANSLUCENT,t.renderState=HPe(e.renderState),t}function JJ(e){let t=$t.shallowClone(e);return t.renderState=qPe(e.renderState),t}function UPe(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!g(n)){let r=t.fragmentShaderSource.clone();r.defines=g(r.defines)?r.defines.slice(0):[],r.defines.push("POLYGON_OFFSET"),r.sources.unshift(`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
`),n=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:r,attributeLocations:t._attributeLocations})}return n}function $J(e,t){let n=$t.shallowClone(t),r=Ht(n.renderState,!0);r.cull.enabled=!0,r.cull.face=sd.FRONT,r.colorMask={red:!1,green:!1,blue:!1,alpha:!1},r.polygonOffset={enabled:!0,factor:5,units:5},r.stencilTest=oo.setCesium3DTileBit(),r.stencilMask=oo.CESIUM_3D_TILE_MASK,n.renderState=fn.fromCache(r),n.castShadows=!1,n.receiveShadows=!1,n.uniformMap=Ht(t.uniformMap);let o=new X(5,5);return n.uniformMap.u_polygonOffset=function(){return o},n.shaderProgram=UPe(e,t.shaderProgram),n}function e$(e,t){let n=$t.shallowClone(e),r=Ht(n.renderState,!0);return r.stencilTest.enabled=!0,r.stencilTest.mask=oo.SKIP_LOD_MASK,r.stencilTest.reference=oo.CESIUM_3D_TILE_MASK|t<<oo.SKIP_LOD_BIT_SHIFT,r.stencilTest.frontFunction=sl.GREATER_OR_EQUAL,r.stencilTest.frontOperation.zPass=Zr.REPLACE,r.stencilTest.backFunction=sl.GREATER_OR_EQUAL,r.stencilTest.backOperation.zPass=Zr.REPLACE,r.stencilMask=oo.CESIUM_3D_TILE_MASK|oo.SKIP_LOD_MASK,n.renderState=fn.fromCache(r),n}function t$(e){return(e.renderState.stencilTest.reference&oo.SKIP_LOD_MASK)>>>oo.SKIP_LOD_BIT_SHIFT}function HPe(e){let t=Ht(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=ka.ALPHA_BLEND,t.stencilTest=oo.setCesium3DTileBit(),t.stencilMask=oo.CESIUM_3D_TILE_MASK,fn.fromCache(t)}function qPe(e){let t=Ht(e,!0);return t.stencilTest=oo.setCesium3DTileBit(),t.stencilMask=oo.CESIUM_3D_TILE_MASK,fn.fromCache(t)}Fi.prototype.update=function(e,t){this._batchTexture.update(e,t)};Fi.prototype.isDestroyed=function(){return!1};Fi.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),st(this)};var FS=Fi;function Gp(e,t){t=Cesium.defaultValue(t,Cesium.defaultValue.EMPTY_OBJECT),this._tileset=e,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this._blUpdate=!0,this._useInstancedColor=Cesium.defaultValue(t.useInstancedColor,!1),this._cacheInstances=Cesium.defaultValue(t.instances,[]);for(var n=[],r=0;r<this._cacheInstances.length;r++)n.push(this._cacheInstances[r].name);this._batchTable=new FS(this,this._cacheInstances.length,{name:n});var o={batchTable:this._batchTable,instances:this._cacheInstances,cacheKey:t.cacheKey,dynamic:!0,cull:!1,url:void 0,requestType:Cesium.RequestType.TILES3D,gltf:t.gltf,basePath:t.uri,incrementallyLoadTextures:!1,upAxis:Cesium.Axis.Y,forwardAxis:Cesium.Axis.Z,opaquePass:Cesium.Pass.CESIUM_3D_TILE,debugShowBoundingVolume:!1,useInstancedColor:this._useInstancedColor};this._modelInstanceCollection=new MM(o)}Object.defineProperties(Gp.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},ready:{get:function(){return this._modelInstanceCollection.ready}},batchTable:{get:function(){return this._batchTable}},model:{get:function(){return Cesium.defined(this._modelInstanceCollection)?this._modelInstanceCollection._model:void 0}},tileset:{get:function(){return this._tileset}},useInstancedColor:{get:function(){return this._useInstancedColor},set:function(e){this._useInstancedColor=e,Cesium.defined(this._modelInstanceCollection)&&(this._modelInstanceCollection._useInstancedColor=e)}}});Gp.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};Gp.prototype.getFeature=function(e){var t=this.featuresLength;return WPe(this),this._features[e]};function WPe(e){var t=e.featuresLength;if(!Cesium.defined(e._features)&&t>0){for(var n=new Array(t),r=0;r<t;++r)n[r]=new Cesium.Cesium3DTileFeature(e,r);e._features=n}}Gp.prototype.applyDebugSettings=function(e,t){t=e?t:Cesium.Color.WHITE,this._batchTable.setAllColor(t)};Gp.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)};Gp.prototype.regenerteInstanced=function(e){var t=!1,n=[];this._cacheInstances.length<e.length&&(t=!0);for(var r=!1,o=0;o<e.length;o++)this._cacheInstances.length>=e.length&&(this._cacheInstances[o].name!=e[o].name||!Cesium.Color.equals(this._cacheInstances[o].modelColor,e[o].modelColor))&&(t=!0),e[o].visible&&(r=!0),n.push(e[o].name);this._blUpdate=r,t?(this._cacheInstances=e,this._features=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._batchTable=new FS(this,e.length,{name:n}),this._modelInstanceCollection._batchTable=this._batchTable,this._modelInstanceCollection.instancingRegenertedOnce=!0):(this._cacheInstances=e,this._modelInstanceCollection.dirty=!0),this._modelInstanceCollection.regenerteInstanced(e)};Gp.prototype.update=function(e){if(!!this._blUpdate){var t=e.commandList.length;this._batchTable.update(this,e),this._modelInstanceCollection.update(e);var n=e.commandList.length;t<n&&(e.passes.render||e.passes.pick)&&this._modelInstanceCollection._batchTable.addDerivedCommandsNoTileset(e,t)}};Gp.prototype.isDestroyed=function(){return!1};Gp.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Cesium.destroyObject(this)};var Pd=Gp;function a1(e){this.geometry=void 0,this.blUpdateVAO=!1,this.blDestroyVAO=!1,this.tracesLength=0,this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1})})}Object.defineProperties(a1.prototype,{});var YPe=new jc("createTraceWallVertices",1);function XPe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function jPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}a1.prototype.recreateVertexArrays=function(e){var t=e.length;if(this.tracesLength=t,e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)Cesium.defined(e[r])&&e[r].wallVisible&&e[r].trackPoints.length>1&&n.push({color:e[r].wallColor,trackPoints:e[r].trackPoints});if(n.length>0){var o=YPe.scheduleTask({traceWalls:n});if(!Cesium.defined(o)){n=[];return}var a=this;Cesium.when(o).then(function(s){var u=new Cesium.GeometryAttributes;u.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float64Array(s.positionBuffer)}),u.pickColor=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:new Uint8Array(s.colorBuffer),normalize:!0}),a.geometry=new Cesium.Geometry({attributes:u,indices:Cesium.IndexDatatype.createTypedArray(u.position.values.length/3,s.indices),boundingSphere:new Cesium.BoundingSphere(s.boundingSphere.center,s.boundingSphere.radius)}),a.blUpdateVAO=!0})}else this.blDestroyVAO=!0}else this.blDestroyVAO=!0};a1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.geometry)){if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&(this.blUpdateVAO||this.blDestroyVAO)&&n.vertexArray.destroy(),this.blUpdateVAO&&(n.vertexArray=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:Cesium.GeometryPipeline.createAttributeLocations(this.geometry),bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),n._boundingVolume=this.geometry.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:XPe(),fragmentShaderSource:jPe()}))),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1,this.blDestroyVAO=!1}};a1.prototype.isDestroyed=function(){return!1};a1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var RM=a1;function s1(e){this.blUpdateVAO=!1,this.barMesh=void 0,this.boundingSphere=new Cesium.BoundingSphere,this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1})})}Object.defineProperties(s1.prototype,{});function KPe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function ZPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}s1.prototype.recreateVertexArrays=function(e){var t=e.length;if(e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)if(Cesium.defined(e[r])&&e[r].barVisible&&e[r].barPoints.length>1)for(var o=0;o<e[r].barPoints.length;o++)n.push({pos:e[r].barPoints[o].wcPosition,color:e[r].barColor});if(n.length>0){this.boundingSphere=new Cesium.BoundingSphere;for(var a=n.length*2,s=a,u=Cesium.IndexDatatype.createTypedArray(a,s),l=new Float64Array(a*3),c=new Uint8Array(a*4),f=0;f<n.length;f++){l[f*6+0]=n[f].pos.x,l[f*6+1]=n[f].pos.y,l[f*6+2]=n[f].pos.z;var h=Cesium.Cartographic.fromCartesian(n[f].pos),d=Cesium.Cartesian3.fromRadians(h.longitude,h.latitude);l[f*6+3]=d.x,l[f*6+4]=d.y,l[f*6+5]=d.z,c[f*8+0]=Cesium.Color.floatToByte(n[f].color.red),c[f*8+1]=Cesium.Color.floatToByte(n[f].color.green),c[f*8+2]=Cesium.Color.floatToByte(n[f].color.blue),c[f*8+3]=Cesium.Color.floatToByte(n[f].color.alpha),c[f*8+4]=Cesium.Color.floatToByte(n[f].color.red),c[f*8+5]=Cesium.Color.floatToByte(n[f].color.green),c[f*8+6]=Cesium.Color.floatToByte(n[f].color.blue),c[f*8+7]=Cesium.Color.floatToByte(n[f].color.alpha),this.boundingSphere=Cesium.BoundingSphere.expand(this.boundingSphere,n[f].pos),this.boundingSphere=Cesium.BoundingSphere.expand(this.boundingSphere,d)}for(var o=0;o<s;o++)u[o]=o;this.barMesh={position:l,color:c,indices:u},this.blUpdateVAO=!0}}};s1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.barMesh)){if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.barMesh.position),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.barMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.barMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.barMesh.position.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:KPe(),fragmentShaderSource:ZPe()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1}};s1.prototype.isDestroyed=function(){return!1};s1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var OM=s1;function zS(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.scene=e.scene,this.geometry=void 0,this.blUpdateVAO=!1,this.extentBox=Cesium.defaultValue(e.extentBox,new Cesium.Cartesian3(2,2,2)),this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})})}zS.prototype.recreateVertexArrays=function(e){var t=e.length;if(e instanceof Array&&t>0){for(var n=t*8,r=t*36,o=Cesium.IndexDatatype.createTypedArray(n,r),a=new Cesium.BoundingSphere(new Cesium.Cartesian3(0,0,0),6378137),s=new Float32Array(n*3),u=new Uint8Array(n*4),l=0,c=0,f=0;f<t;f++){for(var h=QPe(e[f].modelMatrix,e[f].boxGeometry,this.extentBox),d=0;d<h.length;d++)s[l++]=h[d].x,s[l++]=h[d].y,s[l++]=h[d].z,u[c++]=Cesium.Color.floatToByte(e[f].color.red),u[c++]=Cesium.Color.floatToByte(e[f].color.green),u[c++]=Cesium.Color.floatToByte(e[f].color.blue),u[c++]=Cesium.Color.floatToByte(e[f].color.alpha);o[f*36+0]=f*8+0,o[f*36+1]=f*8+1,o[f*36+2]=f*8+3,o[f*36+3]=f*8+1,o[f*36+4]=f*8+2,o[f*36+5]=f*8+3,o[f*36+6]=f*8+7,o[f*36+7]=f*8+6,o[f*36+8]=f*8+4,o[f*36+9]=f*8+6,o[f*36+10]=f*8+5,o[f*36+11]=f*8+4,o[f*36+12]=f*8+3,o[f*36+13]=f*8+2,o[f*36+14]=f*8+6,o[f*36+15]=f*8+3,o[f*36+16]=f*8+6,o[f*36+17]=f*8+7,o[f*36+18]=f*8+0,o[f*36+19]=f*8+4,o[f*36+20]=f*8+5,o[f*36+21]=f*8+0,o[f*36+22]=f*8+5,o[f*36+23]=f*8+1,o[f*36+24]=f*8+3,o[f*36+25]=f*8+7,o[f*36+26]=f*8+4,o[f*36+27]=f*8+3,o[f*36+28]=f*8+4,o[f*36+29]=f*8+0,o[f*36+30]=f*8+2,o[f*36+31]=f*8+1,o[f*36+32]=f*8+5,o[f*36+33]=f*8+2,o[f*36+34]=f*8+5,o[f*36+35]=f*8+6}var p=new Cesium.GeometryAttributes;p.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:s}),p.pickColor=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:u,normalize:!0}),this.geometry=new Cesium.Geometry({attributes:p,indices:o,boundingSphere:a}),this.blUpdateVAO=!0}};var Sn=new x,zOt=new x;function QPe(e,t,n){var r=[],o=Cesium.Cartesian3.subtract(t._minimum,n,new Cesium.Cartesian3),a=Cesium.Cartesian3.add(t._maximum,n,new Cesium.Cartesian3);return Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,a.y,o.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,o.y,o.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,o.y,a.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,a.y,a.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,a.y,o.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,o.y,o.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,o.y,a.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),Sn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,a.y,a.z),Sn),r.push({x:Sn.x,y:Sn.y,z:Sn.z}),r}zS.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&(n.vertexArray=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:Cesium.GeometryPipeline.createAttributeLocations(this.geometry),bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),n._boundingVolume=this.geometry.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:JPe(),fragmentShaderSource:$Pe()}))),Cesium.defined(n.vertexArray)){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1};function JPe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function $Pe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}zS.prototype.isDestroyed=function(){return!1};zS.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var NM=zS;function u1(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.geometry=void 0,this.blUpdateVAO=!1,this.boundingSphere=void 0,this._mode=void 0;var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL}}),uniformMap:{}})}Object.defineProperties(u1.prototype,{});var n$=new le,gz=new ti;u1.prototype.recreateVertexArrays=function(e,t){this._mode=t.mode;var n=t.mapProjection,r=e.length,o=0,a=0,s=[];if(e instanceof Array&&r>0){for(var u=0;u<r;u++)Cesium.defined(e[u])&&e[u].lineVisible&&e[u].trackPoints.length>1&&(o+=(e[u].trackPoints.length-1)*2,a+=e[u].trackPoints.length,s.push(e[u]));if(s.length==0)return;for(var l=Cesium.IndexDatatype.createTypedArray(a,o),c=new Float32Array(a*3),f=new Float32Array(a*3),h=new Uint8Array(a*4),d=[],p=0,_=0,y=0;y<s.length;y++){for(var v=s[y].lineColor,w=0;w<s[y].trackPoints.length;w++){var C=s[y].trackPoints[w],E=void 0;w<s[y].trackPoints.length-1&&(l[p++]=_+w,l[p++]=_+w+1,E=s[y].trackPoints[w+1]);var S=C.wcPosition;if(this._mode==Cesium.SceneMode.SCENE2D){if(S=n.project(n.ellipsoid.cartesianToCartographic(C.wcPosition,n$)),S.z=0,Cesium.defined(E)){var A=n.project(n.ellipsoid.cartesianToCartographic(E.wcPosition,n$));(S.x>0&&A.x<0||S.x<0&&A.x>0)&&(l[p-1]=_+w)}d.push(new Cesium.Cartesian3(S.z,S.x,S.y))}else d.push(C.wcPosition);Cesium.EncodedCartesian3.fromCartesian(S,gz);var D=gz.high,P=gz.low;c[(_+w)*3]=D.x,c[(_+w)*3+1]=D.y,c[(_+w)*3+2]=D.z,f[(_+w)*3]=P.x,f[(_+w)*3+1]=P.y,f[(_+w)*3+2]=P.z,h[(_+w)*4]=Cesium.Color.floatToByte(v.red),h[(_+w)*4+1]=Cesium.Color.floatToByte(v.green),h[(_+w)*4+2]=Cesium.Color.floatToByte(v.blue),h[(_+w)*4+3]=Cesium.Color.floatToByte(v.alpha)}_+=s[y].trackPoints.length}this.traceMesh={position3DHigh:c,position3DLow:f,color:h,indices:l},this.boundingSphere=new Cesium.BoundingSphere.fromPoints(d),this.blUpdateVAO=!0}};u1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&Cesium.defined(this.traceMesh)){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.traceMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.traceMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.traceMesh.position3DHigh.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:eMe(),fragmentShaderSource:tMe()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};u1.prototype.isDestroyed=function(){return!1};u1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function eMe(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec4 color;
varying vec4  v_colour;
void main()
{
   v_colour = color; 
   vec4 p;
   if(czm_morphTime == 1.0){
    p = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
   }else if(czm_morphTime == 0.0){
    p = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
   }else{
    p = czm_columbusViewMorph(
    czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
    czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
    czm_morphTime);
   }
   vec4 positionEC = czm_modelViewRelativeToEye * p;
   gl_Position = czm_projection * positionEC;
   #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
   #endif
}
`;return e}function tMe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var BM=u1;function _z(){this.modelType=void 0,this.modelCollection=void 0,this.iconCollection=void 0,this.cacheIconUri=void 0,this.cacheIcon=void 0,this.instancesPerFrame=[],this.modelIconsPerFrame=[],this.modelLabelPerFrame=[],this.modelLabelPullWirePerFrame=[],this.modelTracePerFrame=[],this.modelBoundingboxPerFrame=[],this.modelSectorsPerFrame=[]}function xh(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("new EV_MovingTargetVisualizer object  viewer of options is empty!");this._viewer=e.viewer,this._scene=this._viewer.scene,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._statistics=new Cesium.Cesium3DTilesetStatistics,this.mtVisualDatas=new Cesium.AssociativeArray,this.modifiedModels=new Cesium.AssociativeArray,this.modelRibbonCollection=new _C,this.modelTraceWallCollection=new RM,this.modelTraceBarCollection=new OM,this.modelLabelCollection=new Cesium.LabelCollection({scene:this._scene}),this._modelLabelPullWireCollection=new JP({scene:this._scene}),this.modelBoundingBoxCollection=new NM({scene:this._scene}),this.modelTraceLineCollection=new BM({viewer:this._viewer}),this.modelSectorRadarCollection=void 0}Object.defineProperties(xh.prototype,{modelLabelPullWireCollection:{get:function(){return this._modelLabelPullWireCollection}}});function nMe(e,t){var n=e,r=t.modelUri,o=t.modelType,a=t.keyName,s=Cesium.defaultValue(t.instances,[]),u=void 0;if(n.mtVisualDatas.contains(a)?u=n.mtVisualDatas.get(a):(u=new _z,u.modelType=t.modelType,n.mtVisualDatas.set(a,u)),!!Cesium.defined(r)){var l=Cesium.Resource.createIfNeeded(r),c=Cesium.defaultValue(t.basePath,l.clone()),f=Cesium.Resource.createIfNeeded(c);l.fetchArrayBuffer().then(function(h){var d=new Uint8Array(h),p=void 0;if(r$(d))p=Yx(d);else{var _=Cesium.getStringFromTypedArray(d);p=JSON.parse(_)}var y=r.split("/").length,v=y>0?a+r.split("/")[y-1]:a;u.modelCollection=new Pd(n,{instances:s,cacheKey:v,gltf:p,uri:r,useInstancedColor:n._useInstancedColor})}).catch()}}function rMe(e,t){var n=e,r=t.modelType,o=t.modelIconUri,a=t.keyName,s=Cesium.defaultValue(t.iconInstances,[]),u=void 0;if(n.mtVisualDatas.contains(a)?u=n.mtVisualDatas.get(a):(u=new _z,u.modelType=t.modelType,u.cacheIconUri=o,n.mtVisualDatas.set(a,u)),!Cesium.defined(u))throw new Cesium.DeveloperError("creat Moving Target Icon  Data is empty!.");Cesium.defined(u.cacheIcon)?u.iconCollection=new uE({scene:n._scene}):Cesium.Resource.fetchImage(o).then(function(l){u.iconCollection=new uE({scene:n._scene}),u.cacheIcon=l;for(var c=0;c<s;c++)u.iconCollection.add(s[c])})}xh.prototype.add=function(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.keyName)||e.keyName=="")throw new Cesium.DeveloperError("options of keyName  is empty!");nMe(this,e),Cesium.defined(e.modelIconUri)&&rMe(this,e);var t=e.keyName,n=void 0;this.mtVisualDatas.contains(t)?n=this.mtVisualDatas.get(t):(n=new _z,n.modelType=e.modelType,this.mtVisualDatas.set(t,n))};xh.prototype.modifiedLoadedModel=function(e,t){var n=this,r=void 0,o=void 0;for(r in this.mtVisualDatas._hash){var a=this.mtVisualDatas.get(r);if(a.modelType===e){o=a;break}}if(o){var s=Cesium.Resource.createIfNeeded(t);s.fetchArrayBuffer().then(function(u){var l=new Uint8Array(u),c=void 0;if(r$(l))c=Yx(l);else{var f=Cesium.getStringFromTypedArray(l);c=JSON.parse(f)}var h=[{batchId:0,modelColor:new Cesium.Color(1,0,0,1),modelMatrix:new Cesium.Matrix4,name:0}],d=t.split("/").length,p=d>0?r+t.split("/")[d-1]:r,_=new Pd(n,{instances:h,cacheKey:p,gltf:c,uri:t,useInstancedColor:o.modelCollection._useInstancedColor});n.modifiedModels.set(r,_),_._modelInstanceCollection.readyPromise.then(function(){n.modifiedModels.remove(r),o.modelCollection.destroy(),o.modelCollection=_})}).catch()}};xh.prototype.modifiedLoadedModelIcon=function(e,t){for(var n=void 0,r=0;r<this.mtVisualDatas.length;r++){var o=this.mtVisualDatas.values[r];if(o.modelType===e){n=o;break}}n&&Cesium.Resource.fetchImage(t).then(function(a){n.cacheIcon=a})};xh.prototype.getMTVisualData=function(e){return this.mtVisualDatas.get(e)};xh.prototype.contains=function(e){return!!this.mtVisualDatas.get(e)};xh.prototype.prePassesUpdate=function(e){for(var t=0;t<this.mtVisualDatas.length;t++){var n=this.mtVisualDatas.values[t];Cesium.defined(n.modelCollection)}};xh.prototype.postPassesUpdate=function(e){for(var t=0;t<this.mtVisualDatas.length;t++){var n=this.mtVisualDatas.values[t];Cesium.defined(n.modelCollection)}};var l1=new X;xh.prototype.update=function(e){this._statistics.clear();for(var t=[],n=[],r=[],o=[],a=0;a<this.modifiedModels.length;a++){var s=this.modifiedModels.values[a];Cesium.defined(s)&&s.update(e)}for(var a=0;a<this.mtVisualDatas.length;a++){var s=this.mtVisualDatas.values[a];if(Cesium.defined(s.modelCollection)&&(s.modelCollection.ready&&s.modelCollection.regenerteInstanced(s.instancesPerFrame),s.modelCollection.update(e)),Cesium.defined(s.iconCollection)){for(var u=[],l=0;l<s.modelIconsPerFrame.length;l++)s.modelIconsPerFrame[l].image=Cesium.defined(s.cacheIcon)?s.cacheIcon:s.cacheIconUri,u[l]=new Ki(s.modelIconsPerFrame[l],s.iconCollection),u[l].movingTargetIcon=!0,u[l].id=s.modelIconsPerFrame[l].name;s.iconCollection.resize(u),s.iconCollection.update(e)}t=t.concat(s.modelLabelPerFrame),n=n.concat(s.modelTracePerFrame),r=r.concat(s.modelBoundingboxPerFrame),o=o.concat(s.modelSectorsPerFrame)}if(t.length>0){for(var c=[],l=0;l<t.length;l++)c[l]=new Cesium.Label(t[l],this.modelLabelCollection),c[l].modelLabelPullWireColor=t[l].modelLabelPullWireColor,c[l].id=t[l].id;iMe(this.modelLabelCollection,c),this.modelLabelCollection.update(e);for(var f=[],h=0;h<this.modelLabelCollection.length;h++){var d=this.modelLabelCollection.get(h);l1.x=0,l1.y=0,l1=Cesium.Label.getScreenSpaceBoundingBox(d,l1);var p=Cesium.Cartesian3.clone(d.position);p=Cesium.SceneTransforms.computeActualWgs84Position(e,p),f.push({position:p,scale:d.totalScale,imageSize:new Cesium.Cartesian2(l1.width,l1.height),pixelOffset:d.pixelOffset,origin:new Cesium.Cartesian2(d.horizontalOrigin,d.verticalOrigin),color:d.modelLabelPullWireColor,distanceDisplayCondition:d.distanceDisplayCondition})}this._modelLabelPullWireCollection.resizeLabelInfos(f),this._modelLabelPullWireCollection.update(e)}n.length>0&&(this.modelRibbonCollection.recreateVertexArrays(n),this.modelRibbonCollection.update(e),this.modelTraceWallCollection.recreateVertexArrays(n),this.modelTraceBarCollection.recreateVertexArrays(n),this.modelTraceLineCollection.recreateVertexArrays(n,e),this.modelTraceWallCollection.update(e)),this.modelTraceBarCollection.update(e),this.modelTraceLineCollection.update(e),r.length>0&&(this.modelBoundingBoxCollection.recreateVertexArrays(r),this.modelBoundingBoxCollection.update(e)),o.length>0&&(Cesium.defined(this.modelSectorRadarCollection)||(this.modelSectorRadarCollection=new Mx({radius:20,forwardDis:10}))),this.modelSectorRadarCollection&&this.modelSectorRadarCollection.resetRadarByPositionProperty(o),Cesium.defined(this.modelSectorRadarCollection)&&this.modelSectorRadarCollection.update(e)};xh.prototype.isDestroyed=function(){return!1};xh.prototype.destroy=function(){for(var e=0;e<this.mtVisualDatas.length;e++){var t=this.mtVisualDatas.values[e];Cesium.defined(t.modelCollection)&&t.modelCollection.destroy(),Cesium.defined(t.iconCollection)&&t.iconCollection.destroy()}return this.mtVisualDatas.removeAll(),Cesium.defined(this.modelRibbonCollection)&&this.modelRibbonCollection.destroy(),Cesium.defined(this.modelTraceWallCollection)&&this.modelTraceWallCollection.destroy(),Cesium.defined(this.modelTraceBarCollection)&&this.modelTraceBarCollection.destroy(),Cesium.defined(this.modelTraceLineCollection)&&this.modelTraceLineCollection.destroy(),Cesium.defined(this.modelLabelCollection)&&this.modelLabelCollection.destroy(),Cesium.defined(this._modelLabelPullWireCollection)&&this._modelLabelPullWireCollection.destroy(),Cesium.defined(this.modelBoundingBoxCollection)&&this.modelBoundingBoxCollection.destroy(),Cesium.defined(this.modelSectorRadarCollection)&&this.modelSectorRadarCollection.destroy(),Cesium.destroyObject(this)};function r$(e){var t=Cesium.getMagic(e);return t==="glTF"}function iMe(e,t){e.removeAll(),e._spareBillboards=[],e._billboardCollection.removeAll(),e._labels=t;for(var n=0;n<t.length;n++)e._labelsToUpdate.push(t[n]);return e._backgroundTextureAtlas&&e._backgroundTextureAtlas.textureCoordinates.length>=2&&(e._backgroundTextureAtlas.textureCoordinates[0]=e._backgroundTextureAtlas.textureCoordinates[1]),!0}var FM=xh;var oMe={Ribbon:0,Wall:1,Bar:2,Line:3},Wi=Object.freeze(oMe);function zM(e){this.name=T(e.name,"EV_MTTrackedPoint"),this.attackName="EV_MTAttackTrackedPoint",this.viewer=T(e.viewer),this.trackedFreedomEntity=void 0,this.trackedAttackEntity=void 0,this.type="locking"}Object.defineProperties(zM.prototype,{useAttackView:{set:function(){this.viewer.trackedEntity=this.trackedAttackEntity}},useFreedomView:{set:function(){this.viewer.trackedEntity=this.trackedFreedomEntity}}});zM.prototype.createLockingEntity=function(e){let t=this,n=t.viewer.entities.getById("EV_MTTrackedPoint");g(n)||(t.trackedFreedomEntity=t.viewer.entities.add({id:t.name,position:new tu(e,!1),point:{color:new K(1,0,0,.1),pixelSize:6},show:!0,viewFrom:new x(1e3,0,2e3)}),t.trackedAttackEntity=t.viewer.entities.add({id:t.attackName,position:new tu(e,!1),point:{color:new K(1,0,0,.1),pixelSize:6},show:!0,viewFrom:new x(0,0,2)}),t.viewer.trackedEntity=t.trackedFreedomEntity)};zM.prototype.removeLocking=function(){let e=this,t=e.viewer.entities.getById(e.name);e.viewer.camera.lookAtTransform(G.IDENTITY),t!==void 0&&e.viewer.entities.remove(t),e.trackedFreedomEntity=void 0;let n=e.viewer.entities.getById(e.attackName);n!==void 0&&e.viewer.entities.remove(n)};var VM=zM;function hi(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("new EV_MovingTargetManager object  viewer of options is empty!");if(!Cesium.defined(e.ev_dataMgr))throw new Cesium.DeveloperError("ev_dataMgr is empty!.");this._viewer=e.viewer,this._scene=this._viewer.scene,this._camera=this._viewer.camera,this._scene.view.oit&&(this._scene.view.oit.useTranslucentDepth=!1),this._ev_MTVisualizer=new FM({viewer:this._viewer,useInstancedColor:Cesium.defaultValue(e.useInstancedColor,!1)}),this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.ev_dataMgr=e.ev_dataMgr,this.trainingClock=Cesium.defaultValue(e.trainingClock,void 0),this._retainOutdatedData=Cesium.defaultValue(e.retainOutdatedData,!1),this._blShowOutdated=Cesium.defaultValue(e.blShowOutdated,!1),this.lastTrainingTimeMsec=0,this._mtVisibleCountInFrustum=0,this.dataOperated=Fr.ADD,this.curFrameTime=new Date().getTime(),this.curTimeMovingTargets=[],this._mode=Cesium.SceneMode.SCENE3D,this._clampToGround=!1,this.blTraceEfficient=Cesium.defaultValue(e.blTraceEfficient,!0),this.evLockingTarget=new VM({name:"EV_MTTrackedPoint",viewer:this._viewer}),this.preUpdateRenderMovingTargetFunc=Cesium.defaultValue(e.preUpdateRenderMovingTargetFunc,void 0),this.ev_MTZoomFactors=new Cesium.AssociativeArray,this.ev_MTLabelConfigurationTables=new Cesium.AssociativeArray,this.graduatedColors=new Cesium.AssociativeArray,this.ev_MTFlightDatas=new Cesium.AssociativeArray,this.onMouseLeftDownEvent=new Cesium.Event,this.onMouseLeftDoubleDownEvent=new Cesium.Event,this.onMouseRightDownEvent=new Cesium.Event,this.silhouette=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),this.silhouetteStage=Cesium.PostProcessStageLibrary.createSilhouetteStage([this.silhouette]),this.silhouetteMTIDs=[],this._scene.primitives.add(this);var t=this,n="MTManagerDataSource";t.dataSource=new Cesium.CustomDataSource(n),t.dataSource.update=function(r){if(t.curFrameTime=Cesium.JulianDate.toDate(r).getTime(),t.dataOperated==Fr.ADD){if(Cesium.defined(t.trainingClock)){var o=t.trainingClock.tick();t.curFrameTime=Cesium.JulianDate.toDate(o).getTime()}t.lastTrainingTimeMsec=t.curFrameTime}else t.dataOperated==Fr.REPLACE&&(Cesium.defined(t.trainingClock)?t.curFrameTime=t.trainingClock.shouldAnimate?t.lastTrainingTimeMsec+=40:t.lastTrainingTimeMsec:t.curFrameTime=t._viewer.clock.shouldAnimate?t.lastTrainingTimeMsec+=40:t.lastTrainingTimeMsec);return t.curTimeMovingTargets=sMe(t,t.curFrameTime,t._retainOutdatedData,t._blShowOutdated),!0},t._viewer.dataSourceDisplay.dataSources.add(t.dataSource),t.receiveDataListenerFunc=function(r,o){var a=Cesium.defined(o)?o:Fr.ADD;if(r instanceof Cesium.AssociativeArray){if(a==Fr.ADD)for(var s=0;s<r.length;s++){var u=t.ev_MTFlightDatas.get(r._array[s].uId);Cesium.defined(u)||(u=new Bu(r._array[s]),t.ev_MTFlightDatas.set(r._array[s].uId,u)),u.timeAttitudeCollection=u.timeAttitudeCollection.concat(r._array[s].timeAttitudeCollection)}else if(a==Fr.REPLACE){for(var s=0;s<r.length;s++){var u=t.ev_MTFlightDatas.get(r._array[s].uId);Cesium.defined(u)||(u=new Bu(r._array[s]),t.ev_MTFlightDatas.set(r._array[s].uId,u)),u.timeAttitudeCollection=[],u.timeAttitudeCollection=r._array[s].timeAttitudeCollection,Cesium.defined(u.trace)&&u.trace.clearAll()}t.dataOperated=Fr.ADD}}},t.ev_dataMgr.addReceiveDataListener(Re.NET_MSG_TSPI,t.receiveDataListenerFunc),aMe(t)}Object.defineProperties(hi.prototype,{scene:{get:function(){return this._scene}},mtVisibleCountInFrustum:{get:function(){return this._mtVisibleCountInFrustum}},ev_MTVisualizer:{get:function(){return this._ev_MTVisualizer}},ev_MTRadarSectorCollection:{get:function(){return this._ev_MTVisualizer.modelSectorRadarCollection}},retainOutdatedData:{get:function(){return this._retainOutdatedData},set:function(e){typeof e=="boolean"&&(this._retainOutdatedData=e)}},blShowOutdated:{get:function(){return this._blShowOutdated},set:function(e){typeof e=="boolean"&&(this._blShowOutdated=e)}}});function aMe(e){var t=e,n=void 0,r=void 0,o=!1,a=void 0,s=void 0;t.eventHandler=new Cesium.ScreenSpaceEventHandler(t._scene.canvas),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Pd){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else{var h=l.primitive;h instanceof Cesium.Label&&Cesium.defined(h.id)?Cesium.defined(t._scene._screenSpaceCameraController)&&(n=t._scene._screenSpaceCameraController._aggregator._eventHandler.getInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),Cesium.defined(n)&&(typeof h.id=="string"||typeof h.id=="number")&&(t._scene._screenSpaceCameraController._aggregator._eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),o=!0,a=t.ev_MTFlightDatas.get(h.id),Cesium.defined(a)&&(s=a.modelLabelPixelOffset))):h instanceof Ki&&Cesium.defined(h.movingTargetIcon)&&h.movingTargetIcon&&Cesium.defined(h.id)&&t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(t.ev_MTFlightDatas.get(h.id))}else t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.LEFT_DOWN),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Pd){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else l.primitive instanceof Ki&&Cesium.defined(l.primitive.movingTargetIcon)&&l.primitive.movingTargetIcon&&Cesium.defined(l.id)&&t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(t.ev_MTFlightDatas.get(l.id));else t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Pd){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else l.primitive instanceof Ki&&Cesium.defined(l.primitive.movingTargetIcon)&&l.primitive.movingTargetIcon&&Cesium.defined(l.id)?t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(t.ev_MTFlightDatas.get(l.id)):t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(void 0);else t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.RIGHT_DOWN),t.eventHandler.setInputAction(function(u){Cesium.defined(t._scene._screenSpaceCameraController&&Cesium.defined(n))&&!Cesium.defined(t._scene._screenSpaceCameraController._aggregator._eventHandler.getInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE))&&(t._scene._screenSpaceCameraController._aggregator._eventHandler.setInputAction(n,Cesium.ScreenSpaceEventType.MOUSE_MOVE),o=!1,a=void 0)},Cesium.ScreenSpaceEventType.LEFT_UP),t.eventHandler.setInputAction(function(u){if(o&&Cesium.defined(a)){var l=u.endPosition,c=Cesium.Cartesian2.subtract(l,r,new Cesium.Cartesian2);a.modelLabelPixelOffset=Cesium.Cartesian2.add(s,c,new Cesium.Cartesian2)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}hi.prototype.registerMouseLeftDownListener=function(e){return Cesium.defined(this.onMouseLeftDownEvent)?this.onMouseLeftDownEvent.addEventListener(e):void 0};hi.prototype.removeMouseLeftDownListener=function(e){return Cesium.defined(this.onMouseLeftDownEvent)?this.onMouseLeftDownEvent.removeEventListener(e):void 0};hi.prototype.registerMouseLeftDoubleDownListener=function(e){return Cesium.defined(this.onMouseLeftDoubleDownEvent)?this.onMouseLeftDoubleDownEvent.addEventListener(e):void 0};hi.prototype.removeMouseLeftDoubleDownistener=function(e){return Cesium.defined(this.onMouseLeftDoubleDownEvent)?this.onMouseLeftDoubleDownEvent.removeEventListener(e):void 0};hi.prototype.registerMouseRightDownListener=function(e){return Cesium.defined(this.onMouseRightDownEvent)?this.onMouseRightDownEvent.addEventListener(e):void 0};hi.prototype.removeMouseRightDownListener=function(e){return Cesium.defined(this.onMouseRightDownEvent)?this.onMouseRightDownEvent.removeEventListener(e):void 0};function i$(e,t,n,r){var o="",a=r.ev_MTLabelConfigurationTables.get(e.mtType);if(Cesium.defined(a)&&a.labelFieldParas.length>0){for(var s=0;s<a.labelFieldParas.length;s++){var u=a.labelFieldParas[s];o.indexOf(u.chineseName)==-1&&(s==0?u.chineseName==""&&e.hasOwnProperty(u.propertyName)?o=o+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.hasOwnProperty(u.propertyName)?o=u.chineseName+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.specialAttributes.hasOwnProperty(u.propertyName)&&(o=u.chineseName+(u.decimalPrec>-1?e.specialAttributes[u.propertyName].toFixed(u.decimalPrec):e.specialAttributes[u.propertyName])):u.chineseName==""&&e.hasOwnProperty(u.propertyName)?o=o+`
`+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.hasOwnProperty(u.propertyName)?o=o+`
`+u.chineseName+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.specialAttributes.hasOwnProperty(u.propertyName)&&(o=o+`
`+u.chineseName+(u.decimalPrec>-1?e.specialAttributes[u.propertyName].toFixed(u.decimalPrec):e.specialAttributes[u.propertyName])))}return{id:e.uId.toString(),text:o,position:e.position,fillColor:t,pixelOffset:e.modelLabelPixelOffset,font:a.font,horizontalOrigin:a.horizontalOrigin,verticalOrigin:a.verticalOrigin,style:a.style,disableDepthTestDistance:a.disableDepthTestDistance,showBackground:a.showBackground,backgroundColor:a.backgroundColor,distanceDisplayCondition:a.distanceDisplayCondition,modelLabelPullWireColor:n}}}function sMe(e,t,n,r){var o=[];for(var a in e.ev_MTFlightDatas._hash){var s=e.ev_MTFlightDatas.get(a),u=s.getMovingTargetStateByTime(t,n,r);Cesium.defined(u)&&o.push(u)}return o}var o$=new G;hi.prototype.prePassesUpdate=function(e){this._mtVisibleCountInFrustum=0;var t=this.curFrameTime,n=this.curTimeMovingTargets;Cesium.defined(this.preUpdateRenderMovingTargetFunc)&&this.preUpdateRenderMovingTargetFunc(n);for(var r=0;r<this._ev_MTVisualizer.mtVisualDatas.length;r++){var o=this._ev_MTVisualizer.mtVisualDatas.values[r];Cesium.defined(o)&&(o.instancesPerFrame=[],o.modelLabelPerFrame=[],o.modelIconsPerFrame=[],o.modelTracePerFrame=[],o.modelBoundingboxPerFrame=[],o.modelSectorsPerFrame=[])}var a=new Cesium.Cartesian3;if(e.mode!=Cesium.SceneMode.SCENE3D){var s=e.mapProjection;a=s.ellipsoid.cartographicToCartesian(this._camera.positionCartographic,a)}for(var u=0;u<n.length;u++){var l=n[u].mtType,c=n[u].modelType,f=n[u].nRedOrBlue,h=this.graduatedColors.get(f),d=n[u].uId,p=n[u].show,_=l.toString()+"_"+c.toString(),y=n[u].position;if(this._clampToGround){var v=Cesium.Cartographic.fromCartesian(y),w=this.scene.globe.getHeight(v);v.height=w,y=Cesium.Cartographic.toCartesian(v)}var o=this._ev_MTVisualizer.getMTVisualData(_);if(Cesium.defined(o)){if(Cesium.defined(o.modelCollection)&&o.modelCollection.ready){var C=this.transformFunc(y,void 0,o$),E=o.modelCollection.model.boundingSphere;E.center=Cesium.Matrix4.multiplyByPoint(C,E.center,new Cesium.Cartesian3);var S=1;Cesium.defined(n[u].scale)&&(S=n[u].scale);var S=Cesium.defined(n[u].scale)?n[u].scale:1,A=this.ev_MTZoomFactors.get(l),D=Cesium.defined(A)?A.minimumPixelSize:0,P=Cesium.defined(A)?A.maximumScale:0;S=lMe(S,y,E.radius,D,P,e),p||(S=0);var M=Cesium.Quaternion.fromHeadingPitchRoll(n[u].headingPitchRoll,new Cesium.Quaternion),b=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),M,new Cesium.Cartesian3(S,S,S));C=Cesium.Matrix4.multiply(C,b,new Cesium.Matrix4),n[u].boundingBoxVisible&&o.modelBoundingboxPerFrame.push({modelMatrix:C,boxGeometry:o.modelCollection.model._boundingBox,color:new Cesium.Color(.3,.3,.3,.5)});var O={modelMatrix:C,batchId:o.instancesPerFrame.length,name:d,modelColor:Cesium.defined(h)&&Cesium.defined(h.modelColor)?h.modelColor:new Cesium.Color(1,0,0,1),visible:!1};if((e.cullingVolume.computeVisibility(E)!=Cesium.Visibility.NONE||e.mode!=this._mode||e.mode!=Cesium.SceneMode.SCENE3D)&&p){this._mtVisibleCountInFrustum++;var m=Cesium.Cartesian3.distance(this._camera.positionWC,E.center);if(Cesium.defined(n[u].modelIconUri))if(e.mode!=Cesium.SceneMode.SCENE3D){if(m=Cesium.Cartesian3.distance(a,E.center),m<=n[u].modelIconDisplayDistance.far){var I=n[u].modelIconColor;Cesium.defined(h)&&Cesium.defined(h.modelIconColor)?I=h.modelIconColor:Cesium.defined(I)||(I=Cesium.Color.RED),o.modelIconsPerFrame.push({position:y,rotation:-n[u].headingPitchRoll.heading,scale:n[u].modelIconScale,color:I,name:d,alignedAxis:Cesium.Cartesian3.UNIT_Z}),O.visible=!1}}else{if(m<=n[u].modelIconDisplayDistance.far&&m>n[u].modelIconDisplayDistance.near){var I=n[u].modelIconColor;Cesium.defined(h)&&Cesium.defined(h.modelIconColor)?I=h.modelIconColor:Cesium.defined(I)||(I=Cesium.Color.RED),o.modelIconsPerFrame.push({position:y,rotation:-n[u].headingPitchRoll.heading,scale:n[u].modelIconScale,color:I,name:d,alignedAxis:Cesium.Cartesian3.UNIT_Z}),O.visible=!1}else m<=n[u].modelIconDisplayDistance.near&&(O.visible=!0,o.instancesPerFrame.push(O));n[u].sectorRadarVisible&&o.modelSectorsPerFrame.push({position:y,scale:new Cesium.Cartesian3(S,S,S),headingPitchRoll:new Cesium.HeadingPitchRoll(n[u].headingPitchRoll.heading,n[u].headingPitchRoll.pitch,n[u].headingPitchRoll.roll),color:n[u].sectorRadarColor})}else O.visible=!0,o.instancesPerFrame.push(O),n[u].sectorRadarVisible&&o.modelSectorsPerFrame.push({position:y,scale:new Cesium.Cartesian3(S,S,S),headingPitchRoll:new Cesium.HeadingPitchRoll(n[u].headingPitchRoll.heading,n[u].headingPitchRoll.pitch,n[u].headingPitchRoll.roll),color:n[u].sectorRadarColor});var L=n[u].trace;if(Cesium.defined(L)&&(L.ribbonVisible||L.wallVisible||L.barVisible||L.lineVisible)&&(Cesium.defined(h)&&Cesium.defined(h.traceRibbonColor)?(L.ribbonColor.red=h.traceRibbonColor.red,L.ribbonColor.green=h.traceRibbonColor.green,L.ribbonColor.blue=h.traceRibbonColor.blue):Cesium.defined(L.ribbonColor)||(L.ribbonColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceWallColor)?(L.wallColor.red=h.traceWallColor.red,L.wallColor.green=h.traceWallColor.green,L.wallColor.blue=h.traceWallColor.blue):Cesium.defined(L.wallColor)||(L.wallColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceBarColor)?(L.barColor.red=h.traceBarColor.red,L.barColor.green=h.traceBarColor.green,L.barColor.blue=h.traceBarColor.blue):Cesium.defined(L.barColor)||(L.barColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceLineColor)?(L.lineColor.red=h.traceLineColor.red,L.lineColor.green=h.traceLineColor.green,L.lineColor.blue=h.traceLineColor.blue):Cesium.defined(L.lineColor)||(L.lineColor=Cesium.Color.RED),L.add(y,n[u].headingPitchRoll,t,S),o.modelTracePerFrame.push(L)),n[u].modelLabelVisible){var R=this.ev_MTLabelConfigurationTables.get(n[u].mtType);if(R&&e.mode!=Cesium.SceneMode.SCENE3D){if(m<=R.distanceDisplayCondition.far){var N=n[u].modelLabelTextColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelTextColor)?N=h.modelLabelTextColor:Cesium.defined(N)||(N=Cesium.Color.RED);var B=n[u].modelLabelPullWireColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelPullWireColor)?B=h.modelLabelPullWireColor:Cesium.defined(B)||(B=Cesium.Color.RED);var V=i$(n[u],N,B,this);Cesium.defined(V)&&o.modelLabelPerFrame.push(V)}}else if(R&&m<=R.distanceDisplayCondition.far&&m>R.distanceDisplayCondition.near){var N=n[u].modelLabelTextColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelTextColor)?N=h.modelLabelTextColor:Cesium.defined(N)||(N=Cesium.Color.RED);var B=n[u].modelLabelPullWireColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelPullWireColor)?B=h.modelLabelPullWireColor:Cesium.defined(B)||(B=Cesium.Color.RED);var V=i$(n[u],N,B,this);Cesium.defined(V)&&o.modelLabelPerFrame.push(V)}}}else{o.instancesPerFrame.push(O);var L=n[u].trace;Cesium.defined(L)&&!this.blTraceEfficient&&(L.ribbonVisible||L.wallVisible||L.barVisible||L.lineVisible)&&(Cesium.defined(h)&&Cesium.defined(h.traceRibbonColor)?(L.ribbonColor.red=h.traceRibbonColor.red,L.ribbonColor.green=h.traceRibbonColor.green,L.ribbonColor.blue=h.traceRibbonColor.blue):Cesium.defined(L.ribbonColor)||(L.ribbonColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceWallColor)?(L.wallColor.red=h.traceWallColor.red,L.wallColor.green=h.traceWallColor.green,L.wallColor.blue=h.traceWallColor.blue):Cesium.defined(L.wallColor)||(L.wallColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceBarColor)?(L.barColor.red=h.traceBarColor.red,L.barColor.green=h.traceBarColor.green,L.barColor.blue=h.traceBarColor.blue):Cesium.defined(L.barColor)||(L.barColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceLineColor)?(L.lineColor.red=h.traceLineColor.red,L.lineColor.green=h.traceLineColor.green,L.lineColor.blue=h.traceLineColor.blue):Cesium.defined(L.lineColor)||(L.lineColor=Cesium.Color.RED),L.add(y,n[u].headingPitchRoll,t,S))}var z=this.ev_MTFlightDatas.get(d);Cesium.defined(z)&&(z.curTimeAttitude.scale=S,z.curTimeAttitude.visible=O.visible)}}else{var M=Cesium.Quaternion.fromHeadingPitchRoll(n[u].headingPitchRoll,new Cesium.Quaternion),b=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),M,new Cesium.Cartesian3(1,1,1)),U=this.transformFunc(y,void 0,o$),C=Cesium.Matrix4.multiply(U,b,new Cesium.Matrix4),Q=[];Q.push({modelMatrix:C,batchId:0,name:d,modelColor:Cesium.defined(h)?h.modelColor:Cesium.Color.RED});var ne=[];ne.push({position:y,scale:.1}),this._ev_MTVisualizer.add({keyName:_,modelType:c,modelUri:n[u].modelUri,modelIconUri:n[u].modelIconUri,instances:Q,iconInstances:ne})}}this._ev_MTVisualizer.prePassesUpdate(e),this._mode=e.mode};hi.prototype.update=function(e){if(this._ev_MTVisualizer.update(e),this.silhouetteMTIDs.length>0){this.silhouette.selected=[];for(var t in this._scene.context._pickObjects){var n=this._scene.context._pickObjects[t];if(n.content&&n.content instanceof Pd){var r=n._batchId,o=n.content._cacheInstances[r];if(o){var a=this.silhouetteMTIDs.indexOf(o.name);a!=-1&&this.silhouette.selected.push(n)}}}}};hi.prototype.postPassesUpdate=function(e){this._ev_MTVisualizer.postPassesUpdate(e)};hi.prototype.removeAllMovingTargets=function(){this.ev_MTFlightDatas.removeAll()};hi.prototype.setAllMovingTargetsVisible=function(e){var t=Cesium.defaultValue(e,!1);for(var n in this.ev_MTFlightDatas._hash){var r=this.ev_MTFlightDatas.get(n);r&&(r.show=t)}};hi.prototype.removeMovingTargetById=function(e){this.ev_MTFlightDatas.contains(e)&&this.ev_MTFlightDatas.remove(e)};hi.prototype.getMovingTargetById=function(e){return this.ev_MTFlightDatas.get(e)};hi.prototype.setMovingTargetVisibleById=function(e,t){var n=Cesium.defaultValue(t,!1),r=this.ev_MTFlightDatas.get(e);return r?(r.show=n,!0):!1};hi.prototype.addMovingTargetTimeAttitude=function(e,t){var n=this.ev_MTFlightDatas.get(e);Cesium.defined(n)||(n=new Bu(t),this.ev_MTFlightDatas.set(e,n)),n.timeAttitudeCollection=n.timeAttitudeCollection.concat(t.timeAttitudeCollection)};hi.prototype.modifiedLoadedModelIcon=function(e,t){!e||!t||this._ev_MTVisualizer&&this._ev_MTVisualizer.modifiedLoadedModelIcon(e,t)};hi.prototype.modifiedLoadedModel=function(e,t){!e||!t||this._ev_MTVisualizer&&this._ev_MTVisualizer.modifiedLoadedModel(e,t)};hi.prototype.setBlinkById=function(e,t,n,r){if(!t||!n)return!1;var o=this.ev_MTFlightDatas.get(e);if(o){var a=o.show,s=this,u=0;return this._timer=setInterval(function(){if(s._timer&&u>=n*t){clearInterval(s._timer),s._timer=void 0,o.show=a,r&&r();return}o.show=!o.show,u++},1e3/t),!0}else return!1};hi.prototype.setModelLabelVisibleById=function(e,t){var n=Cesium.defaultValue(t,!1),r=this.ev_MTFlightDatas.get(e);return r?(r.modelLabelVisible=n,!0):!1};hi.prototype.setTraceVisibleById=function(e,t,n){var r=Cesium.defaultValue(n,!1),o=this.ev_MTFlightDatas.get(e);return o?(t==Wi.Ribbon?o.trace.ribbonVisible=r:t==Wi.Wall?o.trace.wallVisible=r:t==Wi.Bar?o.trace.barVisible=r:t==Wi.Line&&(o.trace.lineVisible=r),!0):!1};hi.prototype.setTraceColorById=function(e,t,n){var r=Cesium.defaultValue(n,Cesium.Color.RED),o=this.ev_MTFlightDatas.get(e);return o?(t==Wi.Ribbon?r.clone(o.trace.ribbonColor=o.trace.ribbonColor):t==Wi.Wall?r.clone(o.trace.wallColor=o.trace.wallColor):t==Wi.Bar?r.clone(o.trace.barColor=o.trace.barColor):t==Wi.Line&&r.clone(o.trace.lineColor=o.trace.lineColor),!0):!1};hi.prototype.setTraceVisible=function(e,t,n){var r=Cesium.defaultValue(n,!1);for(var o in this.ev_MTFlightDatas._hash){var a=this.ev_MTFlightDatas.get(o);t==-1?e==Wi.Ribbon?a.trace.ribbonVisible=r:e==Wi.Wall?a.trace.wallVisible=r:e==Wi.Bar?a.trace.barVisible=r:e==Wi.Line&&(a.trace.lineVisible=r):a.mtType==t&&(e==Wi.Ribbon?a.trace.ribbonVisible=r:e==Wi.Wall?a.trace.wallVisible=r:e==Wi.Bar?a.trace.barVisible=r:e==Wi.Line&&(a.trace.lineVisible=r))}};hi.prototype.setTraceAlpha=function(e,t,n){n=Cesium.defaultValue(n,1);for(var r in this.ev_MTFlightDatas._hash){var o=this.ev_MTFlightDatas.get(r);t==-1?e==Wi.Ribbon?o.trace.ribbonColor=o.trace.ribbonColor.withAlpha(n):e==Wi.Wall?o.trace.wallColor=o.trace.wallColor.withAlpha(n):e==Wi.Bar?o.trace.barColor=o.trace.barColor.withAlpha(n):e==Wi.Line&&(o.trace.lineColor=o.trace.lineColor.withAlpha(n)):o.mtType==t&&(e==Wi.Ribbon?o.trace.ribbonColor=o.trace.ribbonColor.withAlpha(n):e==Wi.Wall?o.trace.wallColor=o.trace.wallColor.withAlpha(n):e==Wi.Bar?o.trace.barColor=o.trace.barColor.withAlpha(n):e==Wi.Line&&(o.trace.lineColor=o.trace.lineColor.withAlpha(n)))}};hi.prototype.setTraceTimeDuration=function(e,t){var n=Cesium.defaultValue(t,1e3);for(var r in this.ev_MTFlightDatas._hash){var o=this.ev_MTFlightDatas.get(r);o.mtType==e&&(o.trace.traceTimeDuration=n)}};hi.prototype.setTraceBarTimeInterval=function(t){var t=Cesium.defaultValue(t,1);for(var n in this.ev_MTFlightDatas._hash){var r=this.ev_MTFlightDatas.get(n);r.trace.barTimeInterval=t}};hi.prototype.lockingTarget=function(e){var t=this;return t.unLockingTarget(),t.ev_MTFlightDatas.get(e)?(this.evLockingTarget.createLockingEntity(function(){var n=t.ev_MTFlightDatas.get(e);return n?n.curTimeAttitude.position:new Cesium.Cartesian3}),!0):!1};hi.prototype.unLockingTarget=function(){return this.evLockingTarget&&this.evLockingTarget.removeLocking(),!0};hi.prototype.flyToTarget=function(e,t,n){var r=this.ev_MTFlightDatas.get(e);if(r&&this._ev_MTVisualizer){var o=r.mtType.toString()+"_"+r.modelType.toString(),a=this._ev_MTVisualizer.mtVisualDatas.get(o);if(a){var s=a.modelCollection.model.boundingSphere.radius,u=r.curTimeAttitude.position,l=Cesium.defaultValue(t,new Cesium.Cartesian3(.3138931386742197,-.6687061031905268,.6740202111576385));u.x-=l.x*s*r.scale*2,u.y-=l.y*s*r.scale*2,u.z-=l.z*s*r.scale*2,this._camera.flyTo({destination:u,orientation:{direction:l,up:Cesium.defaultValue(n,new Cesium.Cartesian3(-.37193546807702543,.5665603886813149,.735304925567347))}})}}};hi.prototype.enableSilhouette=function(e,t){if(this._scene.context&&this.silhouette){this.silhouetteStage.isDestroyed()&&(this.silhouette=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),this.silhouetteStage=Cesium.PostProcessStageLibrary.createSilhouetteStage([this.silhouette])),this.silhouette.selected=[],this.silhouette.uniforms.color=e,this.silhouette.uniforms.length=.01,this._scene.postProcessStages.getStageByName(this.silhouetteStage.name)||this._scene.postProcessStages.add(this.silhouetteStage),this.silhouetteMTIDs=t;for(var n in this._scene.context._pickObjects){var r=this._scene.context._pickObjects[n];if(r.content&&r.content instanceof Pd){var o=r._batchId,a=r.content._cacheInstances[o];if(a){var s=this.silhouetteMTIDs.indexOf(a.name);s!=-1&&this.silhouette.selected.push(r)}}}}};hi.prototype.disableSilhouette=function(){this.silhouetteMTIDs=[],this._scene.context&&this.silhouetteStage&&this._scene.postProcessStages.remove(this.silhouetteStage)};hi.prototype.isDestroyed=function(){return!1};hi.prototype.destroy=function(){this.evLockingTarget&&this._viewer._dataSourceDisplay&&this.evLockingTarget.removeLocking(),this.disableSilhouette(),this.eventHandler=this.eventHandler&&this.eventHandler.destroy(),this.onMouseLeftDownEvent=void 0,this.onMouseLeftDoubleDownEvent=void 0,this.onMouseRightDownEvent=void 0,Cesium.defined(this.ev_dataMgr)&&Cesium.defined(this.ev_dataMgr.removeReceiveDataListener)&&this.ev_dataMgr.removeReceiveDataListener(this.receiveDataListenerFunc),this.ev_MTFlightDatas.removeAll();var e=this._scene.primitives.destroyPrimitives;return this._scene.primitives.destroyPrimitives=!1,this._scene.primitives.remove(this),this._scene.primitives.destroyPrimitives=e,this._ev_MTVisualizer.destroy(),Cesium.destroyObject(this)};var uMe=new le;function lMe(e,t,n,r,o,a){if(r!==0){var s=a.context,u=Math.max(s.drawingBufferWidth,s.drawingBufferHeight),l=Cesium.Cartesian3.clone(t);if(a.mode!==Cesium.SceneMode.SCENE3D){var c=a.mapProjection,f=c.ellipsoid.cartesianToCartographic(l,uMe);c.project(f,l),Cesium.Cartesian3.fromElements(l.z,l.x,l.y,l)}var h=n*e,d=a.camera.getPixelSize(new Cesium.BoundingSphere(l,h),a.context.drawingBufferWidth,a.context.drawingBufferHeight),p=1/d,_=Math.min(p*(2*h),u);_<r&&(e=r*d/(1*n))}return Cesium.defined(o)&&o!==0?Math.min(o,e):e}var wh=hi;function yz(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.labelFieldParas=[],this.showBackground=Cesium.defaultValue(e.showBackground,!0),this.backgroundColor=Cesium.defaultValue(e.backgroundColor,new Cesium.Color(1,1,1,.2)),this.font=Cesium.defaultValue(e.font,"12px Helvetica"),this.style=Cesium.defaultValue(e.style,Cesium.LabelStyle.FILL),this.disableDepthTestDistance=Cesium.defaultValue(e.disableDepthTestDistance,Number.POSITIVE_INFINITY),this.distanceDisplayCondition=Cesium.defaultValue(e.distanceDisplayCondition,new Cesium.DistanceDisplayCondition),this.horizontalOrigin=Cesium.defaultValue(e.horizontalOrigin,Cesium.HorizontalOrigin.LEFT),this.verticalOrigin=Cesium.defaultValue(e.verticalOrigin,Cesium.VerticalOrigin.TOP)}yz.prototype.addDisplayFieldPara=function(e,t,n){n=Cesium.defaultValue(n,-1),this.labelFieldParas.push({chineseName:e,propertyName:t,decimalPrec:n})};yz.prototype.removeAllDisplayFieldParas=function(){this.labelFieldParas=[]};var Eh=yz;function j0(){}j0.packedLength=x.packedLength;j0.unpack=x.unpack;j0.pack=x.pack;var vz;function VS(e,t){return t[0]==="#"&&(t=vz+t),NZ.fromString(e,t)}function a$(e,t,n){if(g(n.reference))return VS(t,n.reference);if(g(n.velocityReference)){let r=VS(t,n.velocityReference);switch(e){case x:case j0:return new pM(r,e===j0);case je:return new kZ(r)}}throw new at(`${JSON.stringify(n)} is not valid CZML.`)}function cMe(e,t){return new tu(function(n,r){return t(e.getValue(n,r))},e.isConstant)}var $r=new x,Jl=new Jj,El=new le,Zy=new ii,kM=new je;function fMe(e){let t=e.rgbaf;if(g(t))return t;let n=e.rgba;if(!g(n))return;let r=n.length;if(r===K.packedLength)return[K.byteToFloat(n[0]),K.byteToFloat(n[1]),K.byteToFloat(n[2]),K.byteToFloat(n[3])];t=new Array(r);for(let o=0;o<r;o+=5)t[o]=n[o],t[o+1]=K.byteToFloat(n[o+1]),t[o+2]=K.byteToFloat(n[o+2]),t[o+3]=K.byteToFloat(n[o+3]),t[o+4]=K.byteToFloat(n[o+4]);return t}function s$(e,t){let n=T(e.uri,e);return g(t)?t.getDerivedResource({url:n}):vt.createIfNeeded(n)}function hMe(e){let t=e.wsen;if(g(t))return t;let n=e.wsenDegrees;if(!g(n))return;let r=n.length;if(r===hn.packedLength)return[Math.toRadians(n[0]),Math.toRadians(n[1]),Math.toRadians(n[2]),Math.toRadians(n[3])];t=new Array(r);for(let o=0;o<r;o+=5)t[o]=n[o],t[o+1]=Math.toRadians(n[o+1]),t[o+2]=Math.toRadians(n[o+2]),t[o+3]=Math.toRadians(n[o+3]),t[o+4]=Math.toRadians(n[o+4]);return t}function dMe(e){let t=e.length;if(Jl.magnitude=1,t===2)return Jl.clock=e[0],Jl.cone=e[1],x.fromSpherical(Jl,$r),[$r.x,$r.y,$r.z];let n=new Array(t/3*4);for(let r=0,o=0;r<t;r+=3,o+=4)n[o]=e[r],Jl.clock=e[r+1],Jl.cone=e[r+2],x.fromSpherical(Jl,$r),n[o+1]=$r.x,n[o+2]=$r.y,n[o+3]=$r.z;return n}function pMe(e){let t=e.length;if(t===3)return Jl.clock=e[0],Jl.cone=e[1],Jl.magnitude=e[2],x.fromSpherical(Jl,$r),[$r.x,$r.y,$r.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],Jl.clock=e[r+1],Jl.cone=e[r+2],Jl.magnitude=e[r+3],x.fromSpherical(Jl,$r),n[r+1]=$r.x,n[r+2]=$r.y,n[r+3]=$r.z;return n}function mMe(e){let t=e.length;if(t===3)return El.longitude=e[0],El.latitude=e[1],El.height=e[2],Ge.WGS84.cartographicToCartesian(El,$r),[$r.x,$r.y,$r.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],El.longitude=e[r+1],El.latitude=e[r+2],El.height=e[r+3],Ge.WGS84.cartographicToCartesian(El,$r),n[r+1]=$r.x,n[r+2]=$r.y,n[r+3]=$r.z;return n}function gMe(e){let t=e.length;if(t===3)return El.longitude=Math.toRadians(e[0]),El.latitude=Math.toRadians(e[1]),El.height=e[2],Ge.WGS84.cartographicToCartesian(El,$r),[$r.x,$r.y,$r.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],El.longitude=Math.toRadians(e[r+1]),El.latitude=Math.toRadians(e[r+2]),El.height=e[r+3],Ge.WGS84.cartographicToCartesian(El,$r),n[r+1]=$r.x,n[r+2]=$r.y,n[r+3]=$r.z;return n}function Cz(e){let t=e.cartesian;if(g(t))return t;let n=e.cartesianVelocity;if(g(n))return n;let r=e.unitCartesian;if(g(r))return r;let o=e.unitSpherical;if(g(o))return dMe(o);let a=e.spherical;if(g(a))return pMe(a);let s=e.cartographicRadians;if(g(s))return mMe(s);let u=e.cartographicDegrees;if(g(u))return gMe(u);throw new at(`${JSON.stringify(e)} is not a valid CZML interval.`)}function u$(e,t){x.unpack(e,t,$r),x.normalize($r,$r),x.pack($r,e,t)}function _Me(e){let t=Cz(e);if(t.length===3)return u$(t,0),t;for(let n=1;n<t.length;n+=4)u$(t,n);return t}function l$(e,t){je.unpack(e,t,kM),je.normalize(kM,kM),je.pack(kM,e,t)}function yMe(e){let t=e.unitQuaternion;if(g(t)){if(t.length===4)return l$(t,0),t;for(let n=1;n<t.length;n+=5)l$(t,n)}return t}function c$(e){return typeof e=="boolean"?Boolean:typeof e=="number"?Number:typeof e=="string"?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?rn:e.hasOwnProperty("cartesian2")?X:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?x:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?j0:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?K:e.hasOwnProperty("arcType")?Fa:e.hasOwnProperty("classificationType")?Ua:e.hasOwnProperty("colorBlendMode")?cg:e.hasOwnProperty("cornerType")?Di:e.hasOwnProperty("heightReference")?Lt:e.hasOwnProperty("horizontalOrigin")?go:e.hasOwnProperty("date")?ce:e.hasOwnProperty("labelStyle")?yl:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?bt:e.hasOwnProperty("distanceDisplayCondition")?yn:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?je:e.hasOwnProperty("shadowMode")?io:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?V0:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?hn:e.hasOwnProperty("uri")?eo.default:e.hasOwnProperty("verticalOrigin")?ln:Object}function E$(e,t,n){switch(e){case Fa:return Fa[T(t.arcType,t)];case Array:return t.array;case Boolean:return T(t.boolean,t);case rn:return t.boundingRectangle;case X:return t.cartesian2;case x:return Cz(t);case j0:return _Me(t);case K:return fMe(t);case Ua:return Ua[T(t.classificationType,t)];case cg:return cg[T(t.colorBlendMode,t)];case Di:return Di[T(t.cornerType,t)];case Lt:return Lt[T(t.heightReference,t)];case go:return go[T(t.horizontalOrigin,t)];case Image:return s$(t,n);case ce:return ce.fromIso8601(T(t.date,t));case yl:return yl[T(t.labelStyle,t)];case Number:return T(t.number,t);case bt:return t.nearFarScalar;case yn:return t.distanceDisplayCondition;case Object:return T(T(t.object,t.value),t);case je:return yMe(t);case lg:return T(t.number,t);case io:return io[T(T(t.shadowMode,t.shadows),t)];case String:return T(t.string,t);case V0:return V0[T(t.stripeOrientation,t)];case hn:return hMe(t);case eo.default:return s$(t,n);case ln:return ln[T(t.verticalOrigin,t)];default:throw new at(e)}}var vMe={HERMITE:$j,LAGRANGE:eK,LINEAR:tM};function kS(e,t){let n=e.interpolationAlgorithm,r=e.interpolationDegree;(g(n)||g(r))&&t.setInterpolationOptions({interpolationAlgorithm:vMe[n],interpolationDegree:r});let o=e.forwardExtrapolationType;g(o)&&(t.forwardExtrapolationType=Np[o]);let a=e.forwardExtrapolationDuration;g(a)&&(t.forwardExtrapolationDuration=a);let s=e.backwardExtrapolationType;g(s)&&(t.backwardExtrapolationType=Np[s]);let u=e.backwardExtrapolationDuration;g(u)&&(t.backwardExtrapolationDuration=u)}var f$={iso8601:void 0};function Xo(e){if(!!g(e))return f$.iso8601=e,ii.fromIso8601(f$)}function xz(e){let t=ys.MAXIMUM_INTERVAL.clone();return t.data=e,t}function h$(e){let t=new vh;return t.intervals.addInterval(xz(e)),t}function d$(e){let t=new ug(e.referenceFrame);return t.intervals.addInterval(xz(e)),t}function GM(e,t,n,r,o,a,s){let u=Xo(r.interval);g(o)&&(g(u)?u=ii.intersect(u,o,Zy):u=o);let l,c,f,h=!g(r.reference)&&!g(r.velocityReference),d=g(u)&&!u.equals(ys.MAXIMUM_INTERVAL);if(r.delete===!0){if(!d){t[n]=void 0;return}return T$(t[n],u)}let p=!1;if(h){if(c=E$(e,r,a),!g(c))return;l=T(e.packedLength,1),f=T(c.length,1),p=!g(r.array)&&typeof c!="string"&&f>l&&e!==Object}let _=typeof e.unpack=="function"&&e!==lg;if(!p&&!d){h?t[n]=new cp(_?e.unpack(c,0):c):t[n]=a$(e,s,r);return}let y=t[n],v,w=r.epoch;if(g(w)&&(v=ce.fromIso8601(w)),p&&!d){y instanceof sg||(t[n]=y=new sg(e)),y.addSamplesPackedArray(c,v),kS(r,y);return}let C;if(!p&&d){u=u.clone(),h?u.data=_?e.unpack(c,0):c:u.data=a$(e,s,r),g(y)||(t[n]=y=h?new dM:new vh),h&&y instanceof dM?y.intervals.addInterval(u):y instanceof vh?(h&&(u.data=new cp(u.data)),y.intervals.addInterval(u)):(t[n]=y=h$(y),h&&(u.data=new cp(u.data)),y.intervals.addInterval(u));return}g(y)||(t[n]=y=new vh),y instanceof vh||(t[n]=y=h$(y));let E=y.intervals;C=E.findInterval(u),(!g(C)||!(C.data instanceof sg))&&(C=u.clone(),C.data=new sg(e),E.addInterval(C)),C.data.addSamplesPackedArray(c,v),kS(r,C.data)}function T$(e,t){if(e instanceof sg){e.removeSamples(t);return}else if(e instanceof dM){e.intervals.removeInterval(t);return}else if(e instanceof vh){let n=e.intervals;for(let r=0;r<n.length;++r){let o=ii.intersect(n.get(r),t,Zy);o.isEmpty||T$(o.data,t)}n.removeInterval(t);return}}function J(e,t,n,r,o,a,s){if(!!g(r))if(Array.isArray(r))for(let u=0,l=r.length;u<l;++u)GM(e,t,n,r[u],o,a,s);else GM(e,t,n,r,o,a,s)}function p$(e,t,n,r,o,a){let s=Xo(n.interval);g(r)&&(g(s)?s=ii.intersect(s,r,Zy):s=r);let u=g(n.cartesianVelocity)?1:0,l=x.packedLength*(u+1),c,f,h=!g(n.reference),d=g(s)&&!s.equals(ys.MAXIMUM_INTERVAL);if(n.delete===!0){if(!d){e[t]=void 0;return}return S$(e[t],s)}let p,_=!1;if(h&&(g(n.referenceFrame)&&(p=za[n.referenceFrame]),p=T(p,za.FIXED),c=Cz(n),f=T(c.length,1),_=f>l),!_&&!d){h?e[t]=new VC(x.unpack(c),p):e[t]=VS(a,n.reference);return}let y=e[t],v,w=n.epoch;if(g(w)&&(v=ce.fromIso8601(w)),_&&!d){(!(y instanceof qx)||g(p)&&y.referenceFrame!==p)&&(e[t]=y=new qx(p,u)),y.addSamplesPackedArray(c,v),kS(n,y);return}let C;if(!_&&d){s=s.clone(),h?s.data=x.unpack(c):s.data=VS(a,n.reference),g(y)||(h?y=new mM(p):y=new ug(p),e[t]=y),h&&y instanceof mM&&g(p)&&y.referenceFrame===p?y.intervals.addInterval(s):y instanceof ug?(h&&(s.data=new VC(s.data,p)),y.intervals.addInterval(s)):(e[t]=y=d$(y),h&&(s.data=new VC(s.data,p)),y.intervals.addInterval(s));return}g(y)?y instanceof ug||(e[t]=y=d$(y)):e[t]=y=new ug(p);let E=y.intervals;C=E.findInterval(s),(!g(C)||!(C.data instanceof qx)||g(p)&&C.data.referenceFrame!==p)&&(C=s.clone(),C.data=new qx(p,u),E.addInterval(C)),C.data.addSamplesPackedArray(c,v),kS(n,C.data)}function S$(e,t){if(e instanceof qx){e.removeSamples(t);return}else if(e instanceof mM){e.intervals.removeInterval(t);return}else if(e instanceof ug){let n=e.intervals;for(let r=0;r<n.length;++r){let o=ii.intersect(n.get(r),t,Zy);o.isEmpty||S$(o.data,t)}n.removeInterval(t);return}}function A$(e,t,n,r,o,a){if(!!g(n))if(Array.isArray(n))for(let s=0,u=n.length;s<u;++s)p$(e,t,n[s],r,o,a);else p$(e,t,n,r,o,a)}function m$(e,t,n,r,o,a){let s=Xo(n.interval);g(r)&&(g(s)?s=ii.intersect(s,r,Zy):s=r);let u=e[t],l,c;if(g(s)){u instanceof DF||(u=new DF,e[t]=u);let h=u.intervals;c=h.findInterval({start:s.start,stop:s.stop}),g(c)?l=c.data:(c=s.clone(),h.addInterval(c))}else l=u;let f;g(n.solidColor)?(l instanceof NE||(l=new NE),f=n.solidColor,J(K,l,"color",f.color,void 0,void 0,a)):g(n.grid)?(l instanceof IF||(l=new IF),f=n.grid,J(K,l,"color",f.color,void 0,o,a),J(Number,l,"cellAlpha",f.cellAlpha,void 0,o,a),J(X,l,"lineCount",f.lineCount,void 0,o,a),J(X,l,"lineThickness",f.lineThickness,void 0,o,a),J(X,l,"lineOffset",f.lineOffset,void 0,o,a)):g(n.image)?(l instanceof BE||(l=new BE),f=n.image,J(Image,l,"image",f.image,void 0,o,a),J(X,l,"repeat",f.repeat,void 0,o,a),J(K,l,"color",f.color,void 0,o,a),J(Boolean,l,"transparent",f.transparent,void 0,o,a)):g(n.stripe)?(l instanceof TF||(l=new TF),f=n.stripe,J(V0,l,"orientation",f.orientation,void 0,o,a),J(K,l,"evenColor",f.evenColor,void 0,o,a),J(K,l,"oddColor",f.oddColor,void 0,o,a),J(Number,l,"offset",f.offset,void 0,o,a),J(Number,l,"repeat",f.repeat,void 0,o,a)):g(n.polylineOutline)?(l instanceof _E||(l=new _E),f=n.polylineOutline,J(K,l,"color",f.color,void 0,o,a),J(K,l,"outlineColor",f.outlineColor,void 0,o,a),J(Number,l,"outlineWidth",f.outlineWidth,void 0,o,a)):g(n.polylineGlow)?(l instanceof AF||(l=new AF),f=n.polylineGlow,J(K,l,"color",f.color,void 0,o,a),J(Number,l,"glowPower",f.glowPower,void 0,o,a),J(Number,l,"taperPower",f.taperPower,void 0,o,a)):g(n.polylineArrow)?(l instanceof SF||(l=new SF),f=n.polylineArrow,J(K,l,"color",f.color,void 0,void 0,a)):g(n.polylineDash)?(l instanceof bF||(l=new bF),f=n.polylineDash,J(K,l,"color",f.color,void 0,void 0,a),J(K,l,"gapColor",f.gapColor,void 0,void 0,a),J(Number,l,"dashLength",f.dashLength,void 0,o,a),J(Number,l,"dashPattern",f.dashPattern,void 0,o,a)):g(n.checkerboard)&&(l instanceof EF||(l=new EF),f=n.checkerboard,J(K,l,"evenColor",f.evenColor,void 0,o,a),J(K,l,"oddColor",f.oddColor,void 0,o,a),J(X,l,"repeat",f.repeat,void 0,o,a)),g(c)?c.data=l:e[t]=l}function Th(e,t,n,r,o,a){if(!!g(n))if(Array.isArray(n))for(let s=0,u=n.length;s<u;++s)m$(e,t,n[s],r,o,a);else m$(e,t,n,r,o,a)}function CMe(e,t,n,r){let o=t.name;g(o)&&(e.name=t.name)}function xMe(e,t,n,r){let o=t.description;g(o)&&J(String,e,"description",o,void 0,r,n)}function wMe(e,t,n,r){let o=t.position;g(o)&&A$(e,"position",o,void 0,r,n)}function EMe(e,t,n,r){let o=t.viewFrom;g(o)&&J(x,e,"viewFrom",o,void 0,r,n)}function TMe(e,t,n,r){let o=t.orientation;g(o)&&J(je,e,"orientation",o,void 0,r,n)}function SMe(e,t,n,r){let o=t.properties;if(g(o)){g(e.properties)||(e.properties=new fd);for(let a in o)if(o.hasOwnProperty(a)){e.properties.hasProperty(a)||e.properties.addProperty(a);let s=o[a];if(Array.isArray(s))for(let u=0,l=s.length;u<l;++u)GM(c$(s[u]),e.properties,a,s[u],void 0,r,n);else GM(c$(s),e.properties,a,s,void 0,r,n)}}}function wz(e,t,n,r,o,a,s){let u=n.map(function(l){return VS(o,l)});if(g(r)){r=Xo(r);let l=e[t];if(!(l instanceof s)){let c=new s;c.intervals.addInterval(xz(l)),e[t]=l=c}r.data=new a(u),l.intervals.addInterval(r)}else e[t]=new a(u)}function g$(e,t,n,r){let o=n.references;g(o)?wz(e,t,o,n.interval,r,DZ,vh):J(Array,e,t,n,void 0,void 0,r)}function _$(e,t,n,r){if(!!g(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)g$(e,t,n[o],r);else g$(e,t,n,r)}function y$(e,t,n,r){let o=n.references;g(o)?wz(e,t,o,n.interval,r,fM,ug):(g(n.cartesian)?n.array=x.unpackArray(n.cartesian):g(n.cartographicRadians)?n.array=x.fromRadiansArrayHeights(n.cartographicRadians):g(n.cartographicDegrees)&&(n.array=x.fromDegreesArrayHeights(n.cartographicDegrees)),g(n.array)&&J(Array,e,t,n,void 0,void 0,r))}function US(e,t,n,r){if(!!g(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)y$(e,t,n[o],r);else y$(e,t,n,r)}function AMe(e){return x.unpackArray(e)}function bMe(e){return x.fromRadiansArrayHeights(e)}function IMe(e){return x.fromDegreesArrayHeights(e)}function v$(e,t,n,r){let o=n.references;if(g(o)){let a=o.map(function(s){let u={};return wz(u,"positions",s,n.interval,r,fM,ug),u.positions});e[t]=new fM(a)}else g(n.cartesian)?n.array=n.cartesian.map(AMe):g(n.cartographicRadians)?n.array=n.cartographicRadians.map(bMe):g(n.cartographicDegrees)&&(n.array=n.cartographicDegrees.map(IMe)),g(n.array)&&J(Array,e,t,n,void 0,void 0,r)}function DMe(e,t,n,r){if(!!g(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)v$(e,t,n[o],r);else v$(e,t,n,r)}function PMe(e,t,n,r){let o=t.availability;if(!g(o))return;let a;if(Array.isArray(o))for(let s=0,u=o.length;s<u;++s)g(a)||(a=new rg),a.addInterval(Xo(o[s]));else a=new rg,a.addInterval(Xo(o));e.availability=a}function MMe(e,t,n,r,o){!g(t)||J(j0,e,"alignedAxis",t,n,r,o)}function LMe(e,t,n,r){let o=t.billboard;if(!g(o))return;let a=Xo(o.interval),s=e.billboard;g(s)||(e.billboard=s=new dD),J(Boolean,s,"show",o.show,a,r,n),J(Image,s,"image",o.image,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(X,s,"pixelOffset",o.pixelOffset,a,r,n),J(x,s,"eyeOffset",o.eyeOffset,a,r,n),J(go,s,"horizontalOrigin",o.horizontalOrigin,a,r,n),J(ln,s,"verticalOrigin",o.verticalOrigin,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"color",o.color,a,r,n),J(lg,s,"rotation",o.rotation,a,r,n),MMe(s,o.alignedAxis,a,r,n),J(Boolean,s,"sizeInMeters",o.sizeInMeters,a,r,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"height",o.height,a,r,n),J(bt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(bt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(bt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,a,r,n),J(rn,s,"imageSubRegion",o.imageSubRegion,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function RMe(e,t,n,r){let o=t.box;if(!g(o))return;let a=Xo(o.interval),s=e.box;g(s)||(e.box=s=new pD),J(Boolean,s,"show",o.show,a,r,n),J(x,s,"dimensions",o.dimensions,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function OMe(e,t,n,r){let o=t.corridor;if(!g(o))return;let a=Xo(o.interval),s=e.corridor;g(s)||(e.corridor=s=new mD),J(Boolean,s,"show",o.show,a,r,n),US(s,"positions",o.positions,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Lt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(Di,s,"cornerType",o.cornerType,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Ua,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function NMe(e,t,n,r){let o=t.cylinder;if(!g(o))return;let a=Xo(o.interval),s=e.cylinder;g(s)||(e.cylinder=s=new gD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"length",o.length,a,r,n),J(Number,s,"topRadius",o.topRadius,a,r,n),J(Number,s,"bottomRadius",o.bottomRadius,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,a,r,n),J(Number,s,"slices",o.slices,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function BMe(e,t){let n=e.version;if(g(n)&&typeof n=="string"){let a=n.split(".");if(a.length===2){if(a[0]!=="1")throw new at("Cesium only supports CZML version 1.");t._version=n}}if(!g(t._version))throw new at("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");let r=t._documentPacket;g(e.name)&&(r.name=e.name);let o=e.clock;if(g(o)){let a=r.clock;g(a)?(a.interval=T(o.interval,a.interval),a.currentTime=T(o.currentTime,a.currentTime),a.range=T(o.range,a.range),a.step=T(o.step,a.step),a.multiplier=T(o.multiplier,a.multiplier)):r.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}function FMe(e,t,n,r){let o=t.ellipse;if(!g(o))return;let a=Xo(o.interval),s=e.ellipse;g(s)||(e.ellipse=s=new _D),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"semiMajorAxis",o.semiMajorAxis,a,r,n),J(Number,s,"semiMinorAxis",o.semiMinorAxis,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Lt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(lg,s,"rotation",o.rotation,a,r,n),J(lg,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Ua,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function zMe(e,t,n,r){let o=t.ellipsoid;if(!g(o))return;let a=Xo(o.interval),s=e.ellipsoid;g(s)||(e.ellipsoid=s=new yD),J(Boolean,s,"show",o.show,a,r,n),J(x,s,"radii",o.radii,a,r,n),J(x,s,"innerRadii",o.innerRadii,a,r,n),J(Number,s,"minimumClock",o.minimumClock,a,r,n),J(Number,s,"maximumClock",o.maximumClock,a,r,n),J(Number,s,"minimumCone",o.minimumCone,a,r,n),J(Number,s,"maximumCone",o.maximumCone,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"stackPartitions",o.stackPartitions,a,r,n),J(Number,s,"slicePartitions",o.slicePartitions,a,r,n),J(Number,s,"subdivisions",o.subdivisions,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function VMe(e,t,n,r){let o=t.label;if(!g(o))return;let a=Xo(o.interval),s=e.label;g(s)||(e.label=s=new vD),J(Boolean,s,"show",o.show,a,r,n),J(String,s,"text",o.text,a,r,n),J(String,s,"font",o.font,a,r,n),J(yl,s,"style",o.style,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(Boolean,s,"showBackground",o.showBackground,a,r,n),J(K,s,"backgroundColor",o.backgroundColor,a,r,n),J(X,s,"backgroundPadding",o.backgroundPadding,a,r,n),J(X,s,"pixelOffset",o.pixelOffset,a,r,n),J(x,s,"eyeOffset",o.eyeOffset,a,r,n),J(go,s,"horizontalOrigin",o.horizontalOrigin,a,r,n),J(ln,s,"verticalOrigin",o.verticalOrigin,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"fillColor",o.fillColor,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(bt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(bt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,a,r,n),J(bt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function kMe(e,t,n,r){let o=t.model;if(!g(o))return;let a=Xo(o.interval),s=e.model;g(s)||(e.model=s=new xD),J(Boolean,s,"show",o.show,a,r,n),J(eo.default,s,"uri",o.gltf,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(Number,s,"minimumPixelSize",o.minimumPixelSize,a,r,n),J(Number,s,"maximumScale",o.maximumScale,a,r,n),J(Boolean,s,"incrementallyLoadTextures",o.incrementallyLoadTextures,a,r,n),J(Boolean,s,"runAnimations",o.runAnimations,a,r,n),J(Boolean,s,"clampAnimations",o.clampAnimations,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"silhouetteColor",o.silhouetteColor,a,r,n),J(Number,s,"silhouetteSize",o.silhouetteSize,a,r,n),J(K,s,"color",o.color,a,r,n),J(cg,s,"colorBlendMode",o.colorBlendMode,a,r,n),J(Number,s,"colorBlendAmount",o.colorBlendAmount,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n);let u,l,c=o.nodeTransformations;if(g(c))if(Array.isArray(c))for(u=0,l=c.length;u<l;++u)C$(s,c[u],a,r,n);else C$(s,c,a,r,n);let f=o.articulations;if(g(f))if(Array.isArray(f))for(u=0,l=f.length;u<l;++u)x$(s,f[u],a,r,n);else x$(s,f,a,r,n)}function C$(e,t,n,r,o){let a=Xo(t.interval);g(n)&&(g(a)?a=ii.intersect(a,n,Zy):a=n);let s=e.nodeTransformations,u=Object.keys(t);for(let l=0,c=u.length;l<c;++l){let f=u[l];if(f==="interval")continue;let h=t[f];if(!g(h))continue;g(s)||(e.nodeTransformations=s=new fd),s.hasProperty(f)||s.addProperty(f);let d=s[f];g(d)||(s[f]=d=new CD),J(x,d,"translation",h.translation,a,r,o),J(je,d,"rotation",h.rotation,a,r,o),J(x,d,"scale",h.scale,a,r,o)}}function x$(e,t,n,r,o){let a=Xo(t.interval);g(n)&&(g(a)?a=ii.intersect(a,n,Zy):a=n);let s=e.articulations,u=Object.keys(t);for(let l=0,c=u.length;l<c;++l){let f=u[l];if(f==="interval")continue;let h=t[f];!g(h)||(g(s)||(e.articulations=s=new fd),s.hasProperty(f)||s.addProperty(f),J(Number,s,f,h,a,r,o))}}function GMe(e,t,n,r){let o=t.path;if(!g(o))return;let a=Xo(o.interval),s=e.path;g(s)||(e.path=s=new ED),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"leadTime",o.leadTime,a,r,n),J(Number,s,"trailTime",o.trailTime,a,r,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"resolution",o.resolution,a,r,n),Th(s,"material",o.material,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function UMe(e,t,n,r){let o=t.point;if(!g(o))return;let a=Xo(o.interval),s=e.point;g(s)||(e.point=s=new TD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"pixelSize",o.pixelSize,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"color",o.color,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(bt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(bt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function GS(e){this.polygon=e,this._definitionChanged=new Event}Object.defineProperties(GS.prototype,{isConstant:{get:function(){let e=this.polygon._positions,t=this.polygon._holes;return(!g(e)||e.isConstant)&&(!g(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}});GS.prototype.getValue=function(e,t){let n;g(this.polygon._positions)&&(n=this.polygon._positions.getValue(e));let r;return g(this.polygon._holes)&&(r=this.polygon._holes.getValue(e),g(r)&&(r=r.map(function(o){return new ey(o)}))),g(t)?(t.positions=n,t.holes=r,t):new ey(n,r)};GS.prototype.equals=function(e){return this===e||e instanceof GS&&_e.equals(this.polygon._positions,e.polygon._positions)&&_e.equals(this.polygon._holes,e.polygon._holes)};function HMe(e,t,n,r){let o=t.polygon;if(!g(o))return;let a=Xo(o.interval),s=e.polygon;g(s)||(e.polygon=s=new SD),J(Boolean,s,"show",o.show,a,r,n),US(s,"_positions",o.positions,n),DMe(s,"_holes",o.holes,n),(g(s._positions)||g(s._holes))&&(s.hierarchy=new GS(s)),J(Number,s,"height",o.height,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Lt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(lg,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Boolean,s,"perPositionHeight",o.perPositionHeight,a,r,n),J(Boolean,s,"closeTop",o.closeTop,a,r,n),J(Boolean,s,"closeBottom",o.closeBottom,a,r,n),J(Fa,s,"arcType",o.arcType,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Ua,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function qMe(e){return e?Fa.GEODESIC:Fa.NONE}function WMe(e,t,n,r){let o=t.polyline;if(!g(o))return;let a=Xo(o.interval),s=e.polyline;if(g(s)||(e.polyline=s=new AD),J(Boolean,s,"show",o.show,a,r,n),US(s,"positions",o.positions,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),Th(s,"material",o.material,a,r,n),Th(s,"depthFailMaterial",o.depthFailMaterial,a,r,n),J(Fa,s,"arcType",o.arcType,a,r,n),J(Boolean,s,"clampToGround",o.clampToGround,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Ua,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n),g(o.followSurface)&&!g(o.arcType)){let u={};J(Boolean,u,"followSurface",o.followSurface,a,r,n),s.arcType=cMe(u.followSurface,qMe)}}function YMe(e,t,n,r){let o=t.rectangle;if(!g(o))return;let a=Xo(o.interval),s=e.rectangle;g(s)||(e.rectangle=s=new bD),J(Boolean,s,"show",o.show,a,r,n),J(hn,s,"coordinates",o.coordinates,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Lt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Lt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(lg,s,"rotation",o.rotation,a,r,n),J(lg,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Ua,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function XMe(e,t,n,r){let o=t.tileset;if(!g(o))return;let a=Xo(o.interval),s=e.tileset;g(s)||(e.tileset=s=new wD),J(Boolean,s,"show",o.show,a,r,n),J(eo.default,s,"uri",o.uri,a,r,n),J(Number,s,"maximumScreenSpaceError",o.maximumScreenSpaceError,a,r,n)}function jMe(e,t,n,r){let o=t.wall;if(!g(o))return;let a=Xo(o.interval),s=e.wall;g(s)||(e.wall=s=new ID),J(Boolean,s,"show",o.show,a,r,n),US(s,"positions",o.positions,n),_$(s,"minimumHeights",o.minimumHeights,n),_$(s,"maximumHeights",o.maximumHeights,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),Th(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(io,s,"shadows",o.shadows,a,r,n),J(yn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function w$(e,t,n,r,o,a,s){let u=n.id;if(g(u)||(u=Ci()),vz=u,!g(s._version)&&u!=="document")throw new at("The first CZML packet is required to be the document object.");if(n.delete===!0)r.removeById(u);else if(u==="document")BMe(n,s);else{let l;if(u!=="CustomPrimitive"){l=r.getOrCreateEntity(u);let c=n.parent;g(c)&&(l.parent=r.getOrCreateEntity(c))}else{let c=n.parent;n.viewer=e,g(c)&&(n.parentEntity=r.getOrCreateEntity(c)),n.movingTarget&&(n.receiveData=new Event,n.addReceiveDataListener=function(f,h){switch(f){case Re.NET_MSG_TSPI:return n.receiveData.addEventListener(h)}})}for(let c=o.length-1;c>-1;c--)o[c](l,n,r,a,t)}vz=void 0}function KMe(e,t,n,r,o){let a=t.parseArrayRadar;if(!g(a))return;let s;if(g(t.CustomOrientation)){let c=t.CustomOrientation,f=E$(je,c,r);s=new sg(je),s.addSamplesPackedArray(f,c.epoch),kS(c,s)}let u=g(a.color)?Ky(a.color):void 0,l=new pC({viewer:t.viewer,id:t.CustomName,position:t.parentEntity.position,orientation:s,radius:a.radius,showScan:a.showScan,showLines:a.showLines,showSurfaces:a.showSurfaces,color:u,show:a.show,lineColor:g(a.lineColor)?Ky(a.lineColor):void 0,yawSpan:a.yawSpan,pitchSpan:a.pitchSpan,direction:a.direction});o&&o.push(l)}function ZMe(e,t,n,r,o){let a=t.customizedPARadar;if(!g(a))return;let s=a.yawRange;s&&s.length===2&&(s=new X(s[0],s[1]));let u=a.pitchRange;u&&u.length===2&&(u=new X(u[0],u[1]));let l=new yC({viewer:t.viewer,id:t.CustomName,show:a.show,position:t.parentEntity.position,showScan:a.showScan,renderStyle:a.renderStyle,outRadius:a.outRadius,inRadius:a.inRadius,color:g(a.color)?Ky(a.color):void 0,lineColor:g(a.lineColor)?Ky(a.lineColor):void 0,yawRange:s,pitchRange:u,circleDensity:a.circleDensity,ms:a.ms});o&&o.push(l)}function QMe(e,t,n,r,o){let a=t.mechanicalRadar;if(!g(a))return;let s=a.position.cartesian;if(!g(s))return;let u=new Qg({viewer:t.viewer,id:t.CustomName,show:a.show,position:new x(s[0],s[1],s[2]),showScan:a.showScan,startYaw:a.startYaw,endYaw:a.endYaw,angularRate:a.angularRate,envelopeColor:a.envelopeColor,sectorColor:a.sectorColor,radius:a.radius});o&&o.push(u)}function JMe(e,t,n,r,o){let a=t.vehicleRadar;if(!g(a))return;let s=a.position.cartesian;if(!g(s))return;let u=g(a.color)?Ky(a.color):void 0,l=g(a.scanPlaneColor)?Ky(a.scanPlaneColor):void 0,c=new Zg({viewer:t.viewer,id:t.id,show:a.show,position:new x(s[0],s[1],s[2]),radius:a.radius,color:u,showScanPlane:a.showScanPlane,scanPlaneColor:l,scanPlaneRate:a.scanPlaneRate});o&&o.push(c)}function $Me(e,t,n,r,o){let a=t.customCylider;if(!g(a))return;J(Boolean,t,"show",a.show,void 0,r,n),US(t,"positions",a.positions,n);let s=[x.ZERO,new x(1,1,1)];if(t.viewer.scene.preRender.addEventListener(function(){let f=t.viewer.scene.frameState.time;e&&e._cylinder._show.getValue(f)&&(s=t.positions.getValue(f))}),!g(a.material))return;let u=T(Ky(a.material.color),K.YELLOW.withAlpha(1)),l=T(a.material.duration,3e3),c=T(La(a.material.trailImage),La("Assets/EMExtensions/downwave.png"));e=t.viewer.entities.add({id:t.CustomName,orientation:new tu(function(){let f=tLe(s[0],s[1]);return f.pitch+=Math.PI_OVER_TWO,f.heading-=Math.PI_OVER_TWO,Cn.headingPitchRollQuaternion(s[1],f)},!1),position:new tu(function(){let f=x.subtract(s[0],s[1],new x),h=x.divideByScalar(f,2,new x);return x.add(h,s[1],new x)},!1),cylinder:{show:t.show,length:new tu(function(){return x.distance(s[0],s[1])},!1),topRadius:1e3,bottomRadius:0,showBottom:!1,showTop:!1,changeStCoordinate:!0,material:new PZ({color:u,duration:l,trailImage:c})}}),o&&o.push(e)}function eLe(e,t,n,r,o){let a=t.movingTarget;if(!g(a))return;let s,u,l;a.color==="Red"?(s=0,u=new K(1,0,0,1),l=new K(1,0,0,1)):(s=1,u=new K(0,0,1,1),l=new K(0,0,1,1));let c=Xo(t.timeInterval),f=new wh({viewer:t.viewer,ev_dataMgr:t,retainOutdatedData:!0}),h=new Bu({uId:t.CustomName,mtType:a.type,name:t.CustomName,modelType:a.type,modelUri:La(a.modelUri),modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(a.scale),sectorRadarVisible:a.sectorRadarVisible,trace:{traceTimeDuration:a.traceTimeDuration,upOffset:a.upOffset},modelLabelVisible:a.modelLabelVisible,modelLabelPullWireColor:l,modelLabelTextColor:u}),p=a.position.cartesian,_=a.orientation.unitQuaternion,y=[];for(let E=1;E<_.length;E+=5)y.push(_[E]),y.push(_[E+1]),y.push(_[E+2]),y.push(_[E+3]);let v=ce.toDate(c.start);v=v.getTime();let w=new Ga;for(let E=0;E<p.length;E+=4){let S=le.fromCartesian(new x(p[E+1],p[E+2],p[E+3]),Ge.WGS84),A=Math.toDegrees(S.longitude),D=Math.toDegrees(S.latitude),P=S.height;h.addTimeAttitude({realTime:v+p[E]*1e3,fLon:A,fLat:D,fAlt:P,position:new x(p[E+1],p[E+2],p[E+3]),nRedOrBlue:s,headingPitchRoll:qc.fromQuaternion(new je(y[E+1],y[E+2],y[E+3],y[E]))})}w.set(h.uId,h),t.receiveData.raiseEvent(w,Fr.ADD);let C=new Eh({showBackground:!0});C.addDisplayFieldPara("","name"),C.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),C.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),C.addDisplayFieldPara("\u9AD8\u5EA6:","fAlt",2),f.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,C),f.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,C),f.setTraceVisible(Wi.Ribbon,Re.NET_MSG_MIN,!0),f.graduatedColors.set(0,{traceRibbonColor:new K(1,0,0,1)}),f.graduatedColors.set(1,{traceRibbonColor:new K(0,0,1,1)})}function Ky(e){let t=e.split(","),n=Number(t[0].slice(t[0].indexOf("(")+1));n!==0&&(n=n/255);let r=Number(t[1]);r!==0&&(r=r/255);let o=Number(t[2]);o!==0&&(o=o/255);let a=Number(t[3].slice(0,t[3].indexOf(")")))/255;return new K(n,r,o,a)}function tLe(e,t){let n=Cn.eastNorthUpToFixedFrame(e),r=x.subtract(t,e,new x),o=G.multiplyByPointAsVector(G.inverse(n,new G),r,new x),a=x.normalize(o,new x),s=Math.atan2(a.y,a.x)-Math.PI_OVER_TWO,u=Math.TWO_PI-Math.zeroToTwoPi(s),l=Cn.eastNorthUpToFixedFrame(e);o=x.subtract(t,e,new x);let c=G.multiplyByPointAsVector(G.inverse(l,l),o,o);x.normalize(c,c);let f=Math.PI_OVER_TWO-Math.acosClamped(c.z);return new qc(u,f,0)}function nLe(e){let t,n=e._documentPacket.clock;if(!g(n)){if(!g(e._clock)){let o=e._entityCollection.computeAvailability();if(!o.start.equals(ys.MINIMUM_VALUE)){let a=o.start,s=o.stop,u=ce.secondsDifference(s,a),l=Math.round(u/120);return t=new xF,t.startTime=ce.clone(a),t.stopTime=ce.clone(s),t.clockRange=mf.LOOP_STOP,t.multiplier=l,t.currentTime=ce.clone(a),t.clockStep=pu.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}g(e._clock)?t=e._clock.clone():(t=new xF,t.startTime=ys.MINIMUM_VALUE.clone(),t.stopTime=ys.MAXIMUM_VALUE.clone(),t.currentTime=ys.MINIMUM_VALUE.clone(),t.clockRange=mf.LOOP_STOP,t.clockStep=pu.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);let r=Xo(n.interval);return g(r)&&(t.startTime=r.start,t.stopTime=r.stop),g(n.currentTime)&&(t.currentTime=ce.fromIso8601(n.currentTime)),g(n.range)&&(t.clockRange=T(mf[n.range],mf.LOOP_STOP)),g(n.step)&&(t.clockStep=T(pu[n.step],pu.SYSTEM_CLOCK_MULTIPLIER)),g(n.multiplier)&&(t.multiplier=n.multiplier),t.equals(e._clock)?!1:(e._clock=t.clone(e._clock),!0)}function b$(e,t,n,r){n=T(n,T.EMPTY_OBJECT);let o=t,a=n.sourceUri,s=n.credit;if(typeof s=="string"&&(s=new Di(s)),e._credit=s,typeof t=="string"||t instanceof vt){t=vt.createIfNeeded(t),o=t.fetchJson(),a=T(a,t.clone());let u=e._resourceCredits,l=t.credits;if(g(l)){let c=l.length;for(let f=0;f<c;f++)u.push(l[f])}}return a=vt.createIfNeeded(a),xS.setLoading(e,!0),Promise.resolve(o).then(function(u){return rLe(e,u,a,r)}).catch(function(u){return xS.setLoading(e,!1),e._error.raiseEvent(e,u),console.log(u),Promise.reject(u)})}function rLe(e,t,n,r){xS.setLoading(e,!0);let o=e._entityCollection;r&&(e._version=void 0,e._documentPacket=new I$,o.removeAll()),yf._processCzml(t,o,n,void 0,e);let a=nLe(e),s=e._documentPacket;return g(s.name)&&e._name!==s.name?(e._name=s.name,a=!0):!g(e._name)&&g(n)&&(e._name=iK(n.getUrlComponent()),a=!0),xS.setLoading(e,!1),a&&e._changed.raiseEvent(e),e}function I$(){this.name=void 0,this.clock=void 0}function yf(e){this._name=e,this._changed=new Event,this._error=new Event,this._isLoading=!1,this._loading=new Event,this._clock=void 0,this._documentPacket=new I$,this._version=void 0,this._entityCollection=new IZ(this),this._entityCluster=new AZ,this._credit=void 0,this._resourceCredits=[]}yf.load=function(e,t){if(!g(t.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");return this.viewer=t.viewer,this.geometryArr=t.geometryArr,new yf().load(e,t)};Object.defineProperties(yf.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}});yf.updaters=[LMe,RMe,OMe,NMe,FMe,zMe,VMe,kMe,CMe,xMe,GMe,UMe,HMe,WMe,SMe,YMe,wMe,XMe,EMe,jMe,TMe,PMe,KMe,ZMe,QMe,JMe,$Me,eLe];yf.prototype.process=function(e,t){return b$(this,e,t,!1)};yf.prototype.load=function(e,t){return b$(this,e,t,!0)};yf.processPacketData=J;yf.processPositionPacketData=A$;yf.processMaterialPacketData=Th;yf._processCzml=function(e,t,n,r,o){if(r=T(r,yf.updaters),Array.isArray(e))for(let a=0,s=e.length;a<s;++a)w$(this.viewer,this.geometryArr,e[a],t,r,n,o);else w$(this.viewer,this.geometryArr,e,t,r,n,o)};var UM=yf;var iLe="czm_material czm_getMaterial(czm_materialInput materialInput)   {      czm_material material = czm_getDefaultMaterial(materialInput);      vec2 st = materialInput.st;      vec4 colorImage;      if(reverse == true){        colorImage = texture2D(image, vec2(fract((-st.s - offset) * quantity), st.t));      }else{        colorImage = texture2D(image, vec2(fract((st.s - offset) * quantity), st.t));      }      material.diffuse = colorImage.rgb;      material.alpha = colorImage.a * alpha;      return material;   }";function HS(e){e=T(e,{}),this._definitionChanged=new xe,this._image=void 0,this._speed=void 0,this._quantity=void 0,this._reverse=void 0,this._alpha=void 0,this._ready=!1,this.duration=T(e.duration,60),this.quantity=T(e.quantity,1),this.reverse=T(e.reverse,!1),this.alpha=T(e.alpha,1),this.clock=e.clock,this._offset=0,this._frames=0,this._readyPromise=Bo(),this.image=e.image,this._startTime=ce.now()}Object.defineProperties(HS.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},image:{get:function(){return this._image},set:function(e){if(e instanceof Image)this._image=e,this._ready=!0,this._readyPromise.resolve(!0);else if(typeof e=="string"){let t=this;vt.createIfNeeded(e).fetchImage().then(function(n){t._image=n,t._ready=!0,t._readyPromise.resolve(!0)})}else e===void 0?this._ready=!0:console.error("invalid image!")}},quantity:{get:function(){return this._quantity},set:function(e){typeof e=="number"?e>=0?this._quantity=Math.round(e):(console.log("invalid 'quantity' value!"),this._quantity===void 0&&(this._quantity=1)):(console.log("'quantity' value is not a number!"),this._quantity===void 0&&(this._quantity=1))}},reverse:{get:function(){return this._reverse},set:function(e){typeof e=="boolean"?this._reverse!==e&&(this._reverse=e):(e=Boolean(e),this._reverse!==e&&(this._reverse=e))}},alpha:{get:function(){return this._alpha},set:function(e){this._alpha=e}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});AE._materialCache.addMaterial("EV_FlowMaterial",{fabric:{uniforms:{image:"",quantity:1,reverse:!1,offset:0,alpha:0},source:iLe},translucent:!0});HS.prototype.getType=function(e){return"EV_FlowMaterial"};HS.prototype.equals=function(e){return this===e};HS.prototype.getValue=function(e,t){!this._ready||(this._frames>1?t.alpha=this._alpha:this._frames++,this.clock&&(e=this.clock.currentTime),ce.greaterThan(e,this._startTime)&&(t.offset=ce.secondsDifference(e,this._startTime)/this.duration,t.offset>1&&(t.offset=t.offset-Math.floor(t.offset))),t.image=this._image?this._image:t.image,t.quantity=this._quantity,t.reverse=this._reverse)};var D$=HS;var $l={};$l.numberOfPoints=function(e,t,n){let r=x.distance(e,t);return Math.ceil(r/n)};$l.numberOfPointsRhumbLine=function(e,t,n){let r=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(r/(n*n))))};var oLe=new le;$l.extractHeights=function(e,t){let n=e.length,r=new Array(n);for(let o=0;o<n;o++){let a=e[o];r[o]=t.cartesianToCartographic(a,oLe).height}return r};var aLe=new G,sLe=new x,P$=new x,uLe=new si(x.UNIT_X,0),M$=new x,lLe=new si(x.UNIT_X,0),cLe=new x,fLe=new x,Tz=[];function R$(e,t,n){let r=Tz;r.length=e;let o;if(t===n){for(o=0;o<e;o++)r[o]=t;return r}let s=(n-t)/e;for(o=0;o<e;o++){let u=t+o*s;r[o]=u}return r}var qM=new le,HM=new le,K0=new x,Sz=new x,hLe=new x,Ez=new r0,qS=new fp;function dLe(e,t,n,r,o,a,s,u){let l=r.scaleToGeodeticSurface(e,Sz),c=r.scaleToGeodeticSurface(t,hLe),f=$l.numberOfPoints(e,t,n),h=r.cartesianToCartographic(l,qM),d=r.cartesianToCartographic(c,HM),p=R$(f,o,a);Ez.setEndPoints(h,d);let _=Ez.surfaceDistance/f,y=u;h.height=o;let v=r.cartographicToCartesian(h,K0);x.pack(v,s,y),y+=3;for(let w=1;w<f;w++){let C=Ez.interpolateUsingSurfaceDistance(w*_,HM);C.height=p[w],v=r.cartographicToCartesian(C,K0),x.pack(v,s,y),y+=3}return y}function pLe(e,t,n,r,o,a,s,u){let l=r.cartesianToCartographic(e,qM),c=r.cartesianToCartographic(t,HM),f=$l.numberOfPointsRhumbLine(l,c,n);l.height=0,c.height=0;let h=R$(f,o,a);qS.ellipsoid.equals(r)||(qS=new fp(void 0,void 0,r)),qS.setEndPoints(l,c);let d=qS.surfaceDistance/f,p=u;l.height=o;let _=r.cartographicToCartesian(l,K0);x.pack(_,s,p),p+=3;for(let y=1;y<f;y++){let v=qS.interpolateUsingSurfaceDistance(y*d,HM);v.height=h[y],_=r.cartographicToCartesian(v,K0),x.pack(_,s,p),p+=3}return p}$l.wrapLongitude=function(e,t){let n=[],r=[];if(g(e)&&e.length>0){t=T(t,G.IDENTITY);let o=G.inverseTransformation(t,aLe),a=G.multiplyByPoint(o,x.ZERO,sLe),s=x.normalize(G.multiplyByPointAsVector(o,x.UNIT_Y,P$),P$),u=si.fromPointNormal(a,s,uLe),l=x.normalize(G.multiplyByPointAsVector(o,x.UNIT_X,M$),M$),c=si.fromPointNormal(a,l,lLe),f=1;n.push(x.clone(e[0]));let h=n[0],d=e.length;for(let p=1;p<d;++p){let _=e[p];if(si.getPointDistance(c,h)<0||si.getPointDistance(c,_)<0){let y=Jc.lineSegmentPlane(h,_,u,cLe);if(g(y)){let v=x.multiplyByScalar(s,5e-9,fLe);si.getPointDistance(u,h)<0&&x.negate(v,v),n.push(x.add(y,v,new x)),r.push(f+1),x.negate(v,v),n.push(x.add(y,v,new x)),f=1}}n.push(x.clone(e[p])),f++,h=_}r.push(f)}return{positions:n,lengths:r}};$l.generateArc=function(e){g(e)||(e={});let t=e.positions,n=t.length,r=T(e.ellipsoid,Ge.WGS84),o=T(e.height,0),a=Array.isArray(o);if(n<1)return[];if(n===1){let y=r.scaleToGeodeticSurface(t[0],Sz);if(o=a?o[0]:o,o!==0){let v=r.geodeticSurfaceNormal(y,K0);x.multiplyByScalar(v,o,v),x.add(y,v,y)}return[y.x,y.y,y.z]}let s=e.minDistance;if(!g(s)){let y=T(e.granularity,F.RADIANS_PER_DEGREE);s=F.chordLength(y,r.maximumRadius)}let u=0,l;for(l=0;l<n-1;l++)u+=$l.numberOfPoints(t[l],t[l+1],s);let c=(u+1)*3,f=new Array(c),h=0;for(l=0;l<n-1;l++){let y=t[l],v=t[l+1],w=a?o[l]:o,C=a?o[l+1]:o;h=dLe(y,v,s,r,w,C,f,h)}Tz.length=0;let d=t[n-1],p=r.cartesianToCartographic(d,qM);p.height=a?o[n-1]:o;let _=r.cartographicToCartesian(p,K0);return x.pack(_,f,c-3),f};var L$=new le,mLe=new le;$l.generateRhumbArc=function(e){g(e)||(e={});let t=e.positions,n=t.length,r=T(e.ellipsoid,Ge.WGS84),o=T(e.height,0),a=Array.isArray(o);if(n<1)return[];if(n===1){let w=r.scaleToGeodeticSurface(t[0],Sz);if(o=a?o[0]:o,o!==0){let C=r.geodeticSurfaceNormal(w,K0);x.multiplyByScalar(C,o,C),x.add(w,C,w)}return[w.x,w.y,w.z]}let s=T(e.granularity,F.RADIANS_PER_DEGREE),u=0,l,c=r.cartesianToCartographic(t[0],L$),f;for(l=0;l<n-1;l++)f=r.cartesianToCartographic(t[l+1],mLe),u+=$l.numberOfPointsRhumbLine(c,f,s),c=le.clone(f,L$);let h=(u+1)*3,d=new Array(h),p=0;for(l=0;l<n-1;l++){let w=t[l],C=t[l+1],E=a?o[l]:o,S=a?o[l+1]:o;p=pLe(w,C,s,r,E,S,d,p)}Tz.length=0;let _=t[n-1],y=r.cartesianToCartographic(_,qM);y.height=a?o[n-1]:o;let v=r.cartographicToCartesian(y,K0);return x.pack(v,d,h-3),d};$l.generateCartesianArc=function(e){let t=$l.generateArc(e),n=t.length/3,r=new Array(n);for(let o=0;o<n;o++)r[o]=x.unpack(t,o*3);return r};$l.generateCartesianRhumbArc=function(e){let t=$l.generateRhumbArc(e),n=t.length/3,r=new Array(n);for(let o=0;o<n;o++)r[o]=x.unpack(t,o*3);return r};var Sh=$l;var _u=[new x,new x],gLe=new x,_Le=new x,yLe=new x,vLe=new x,CLe=new x,xLe=new x,wLe=new x,ELe=new x,TLe=new x,c1=new x,WM=new x,WS={},Az=new le;function SLe(e,t){let n=new Array(e.length);for(let r=0;r<e.length;r++){let o=e[r];Az=t.cartesianToCartographic(o,Az),n[r]=Az.height,e[r]=t.scaleToGeodeticSurface(o,o)}return n}function bz(e,t,n,r){let o=e[0],a=e[1],s=x.angleBetween(o,a),u=Math.ceil(s/r),l=new Array(u),c;if(t===n){for(c=0;c<u;c++)l[c]=t;return l.push(n),l}let h=(n-t)/u;for(c=1;c<u;c++){let d=t+c*h;l[c]=d}return l[0]=t,l.push(n),l}var YM=new x,XM=new x;function ALe(e,t,n,r){let o=new l0(n,r),a=o.projectPointOntoPlane(x.add(n,e,YM),YM),s=o.projectPointOntoPlane(x.add(n,t,XM),XM),u=X.angleBetween(a,s);return s.x*a.y-s.y*a.x>=0?-u:u}var bLe=new x(-1,0,0),Qy=new G,ILe=new G,Iz=new te,DLe=te.IDENTITY.clone(),PLe=new x,MLe=new Se,O$=new x;function yg(e,t,n,r,o,a,s,u){let l=PLe,c=MLe;Qy=Cn.eastNorthUpToFixedFrame(e,o,Qy),l=G.multiplyByPointAsVector(Qy,bLe,l),l=x.normalize(l,l);let f=ALe(l,t,e,o);Iz=te.fromRotationZ(f,Iz),O$.z=a,Qy=G.multiplyTransformation(Qy,G.fromRotationTranslation(Iz,O$,ILe),Qy);let h=DLe;h[0]=s;for(let d=0;d<u;d++)for(let p=0;p<n.length;p+=3)c=x.fromArray(n,p,c),c=te.multiplyByVector(h,c,c),c=G.multiplyByPoint(Qy,c,c),r.push(c.x,c.y,c.z);return r}var LLe=new x;function Dz(e,t,n,r,o,a,s){for(let u=0;u<e.length;u+=3){let l=x.fromArray(e,u,LLe);r=yg(l,t,n,r,o,a[u/3],s,1)}return r}function RLe(e,t){let n=e.length,r=new Array(n*6),o=0,a=t.x+t.width/2,s=t.y+t.height/2,u=e[0];r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s;for(let l=1;l<n;l++){u=e[l];let c=u.x-a,f=u.y-s;r[o++]=c,r[o++]=0,r[o++]=f,r[o++]=c,r[o++]=0,r[o++]=f}return u=e[0],r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s,r}function N$(e,t){let n=e.length,r=new Array(n*3),o=0,a=t.x+t.width/2,s=t.y+t.height/2;for(let u=0;u<n;u++)r[o++]=e[u].x-a,r[o++]=0,r[o++]=e[u].y-s;return r}var B$=new je,F$=new x,z$=new te;function V$(e,t,n,r,o,a,s,u,l,c){let f=x.angleBetween(x.subtract(t,e,c1),x.subtract(n,e,WM)),h=r===Di.BEVELED?0:Math.ceil(f/F.toRadians(5)),d;o?d=te.fromQuaternion(je.fromAxisAngle(x.negate(e,c1),f/(h+1),B$),z$):d=te.fromQuaternion(je.fromAxisAngle(e,f/(h+1),B$),z$);let p,_;if(t=x.clone(t,F$),h>0){let y=c?2:1;for(let v=0;v<h;v++)t=te.multiplyByVector(d,t,t),p=x.subtract(t,e,c1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(t,WM),s=yg(_,p,u,s,a,l,1,y)}else p=x.subtract(t,e,c1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(t,WM),s=yg(_,p,u,s,a,l,1,1),n=x.clone(n,F$),p=x.subtract(n,e,c1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(n,WM),s=yg(_,p,u,s,a,l,1,1);return s}WS.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let r=t-1,o=0;o<t;r=o++){let a=e[r],s=e[o];X.equals(a,s)||n.push(s)}return n};WS.angleIsGreaterThanPi=function(e,t,n,r){let o=new l0(n,r),a=o.projectPointOntoPlane(x.add(n,e,YM),YM),s=o.projectPointOntoPlane(x.add(n,t,XM),XM);return s.x*a.y-s.y*a.x>=0};var OLe=new x,NLe=new x;WS.computePositions=function(e,t,n,r,o){let a=r._ellipsoid,s=SLe(e,a),u=r._granularity,l=r._cornerType,c=o?RLe(t,n):N$(t,n),f=o?N$(t,n):void 0,h=n.height/2,d=n.width/2,p=e.length,_=[],y=o?[]:void 0,v=gLe,w=_Le,C=yLe,E=vLe,S=CLe,A=xLe,D=wLe,P=ELe,M=TLe,b=e[0],O=e[1];E=a.geodeticSurfaceNormal(b,E),v=x.subtract(O,b,v),v=x.normalize(v,v),P=x.cross(E,v,P),P=x.normalize(P,P);let m=s[0],I=s[1];o&&(y=yg(b,P,f,y,a,m+h,1,1)),M=x.clone(b,M),b=O,w=x.negate(v,w);let L,R;for(let V=1;V<p-1;V++){let z=o?2:1;if(O=e[V+1],b.equals(O)){f0("Positions are too close and are considered equivalent with rounding error.");continue}v=x.subtract(O,b,v),v=x.normalize(v,v),C=x.add(v,w,C),C=x.normalize(C,C),E=a.geodeticSurfaceNormal(b,E);let U=x.multiplyByScalar(E,x.dot(v,E),OLe);x.subtract(v,U,U),x.normalize(U,U);let Q=x.multiplyByScalar(E,x.dot(w,E),NLe);if(x.subtract(w,Q,Q),x.normalize(Q,Q),!F.equalsEpsilon(Math.abs(x.dot(U,Q)),1,F.EPSILON7)){C=x.cross(C,E,C),C=x.cross(E,C,C),C=x.normalize(C,C);let se=1/Math.max(.25,x.magnitude(x.cross(C,w,c1))),de=WS.angleIsGreaterThanPi(v,w,b,a);de?(S=x.add(b,x.multiplyByScalar(C,se*d,C),S),A=x.add(S,x.multiplyByScalar(P,d,A),A),_u[0]=x.clone(M,_u[0]),_u[1]=x.clone(A,_u[1]),L=bz(_u,m+h,I+h,u),R=Sh.generateArc({positions:_u,granularity:u,ellipsoid:a}),_=Dz(R,P,c,_,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,d,D),D),l===Di.ROUNDED||l===Di.BEVELED?V$(S,A,D,l,de,a,_,c,I+h,o):(C=x.negate(C,C),_=yg(b,C,c,_,a,I+h,se,z)),M=x.clone(D,M)):(S=x.add(b,x.multiplyByScalar(C,se*d,C),S),A=x.add(S,x.multiplyByScalar(P,-d,A),A),_u[0]=x.clone(M,_u[0]),_u[1]=x.clone(A,_u[1]),L=bz(_u,m+h,I+h,u),R=Sh.generateArc({positions:_u,granularity:u,ellipsoid:a}),_=Dz(R,P,c,_,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,-d,D),D),l===Di.ROUNDED||l===Di.BEVELED?V$(S,A,D,l,de,a,_,c,I+h,o):_=yg(b,C,c,_,a,I+h,se,z),M=x.clone(D,M)),w=x.negate(v,w)}else _=yg(M,P,c,_,a,m+h,1,1),M=b;m=I,I=s[V+1],b=O}_u[0]=x.clone(M,_u[0]),_u[1]=x.clone(b,_u[1]),L=bz(_u,m+h,I+h,u),R=Sh.generateArc({positions:_u,granularity:u,ellipsoid:a}),_=Dz(R,P,c,_,a,L,1),o&&(y=yg(b,P,f,y,a,I+h,1,1)),p=_.length;let N=o?p+y.length:p,B=new Float64Array(N);return B.set(_),o&&B.set(y,p),B};var YS=WS;var XS={},f1=new x,q$=new x,BLe=new x,k$=new x,ec=[new x,new x],KM=new x,ZM=new x,QM=new x,W$=new x,Y$=new x,X$=new x,FLe=new x,zLe=new x,VLe=new x,kLe=new x,G$=new je,U$=new te;function jM(e,t,n,r,o){let a=x.angleBetween(x.subtract(t,e,f1),x.subtract(n,e,q$)),s=r===Di.BEVELED?1:Math.ceil(a/F.toRadians(5))+1,u=s*3,l=new Array(u);l[u-3]=n.x,l[u-2]=n.y,l[u-1]=n.z;let c;o?c=te.fromQuaternion(je.fromAxisAngle(x.negate(e,f1),a/s,G$),U$):c=te.fromQuaternion(je.fromAxisAngle(e,a/s,G$),U$);let f=0;t=x.clone(t,f1);for(let h=0;h<s;h++)t=te.multiplyByVector(c,t,t),l[f++]=t.x,l[f++]=t.y,l[f++]=t.z;return l}function GLe(e){let t=KM,n=ZM,r=QM,o=e[1];n=x.fromArray(e[1],o.length-3,n),r=x.fromArray(e[0],0,r),t=x.midpoint(n,r,t);let a=jM(t,n,r,Di.ROUNDED,!1),s=e.length-1,u=e[s-1];o=e[s],n=x.fromArray(u,u.length-3,n),r=x.fromArray(o,0,r),t=x.midpoint(n,r,t);let l=jM(t,n,r,Di.ROUNDED,!1);return[a,l]}function H$(e,t,n,r){let o=f1;return r?o=x.add(e,t,o):(t=x.negate(t,t),o=x.add(e,t,o)),[o.x,o.y,o.z,n.x,n.y,n.z]}function Pz(e,t,n,r){let o=new Array(e.length),a=new Array(e.length),s=x.multiplyByScalar(t,n,f1),u=x.negate(s,q$),l=0,c=e.length-1;for(let f=0;f<e.length;f+=3){let h=x.fromArray(e,f,BLe),d=x.add(h,u,k$);o[l++]=d.x,o[l++]=d.y,o[l++]=d.z;let p=x.add(h,s,k$);a[c--]=p.z,a[c--]=p.y,a[c--]=p.x}return r.push(o,a),r}function ULe(e,t){let n=e[0],r=e[1],o=e[2],a=new x,s=new x,u=new x,l=1/(t+1),c=0,f=new Array(t);for(let h=0;h<t;h++){c=(h+1)*l;let d=(1-c)*(1-c),p=2*c*(1-c),_=c*c;x.multiplyByScalar(n,d,a),x.multiplyByScalar(r,p,s),x.multiplyByScalar(o,_,u),x.add(a,s,s),f[h]=x.add(s,u,new x)}return f}XS.addAttribute=function(e,t,n,r){let o=t.x,a=t.y,s=t.z;g(n)&&(e[n]=o,e[n+1]=a,e[n+2]=s),g(r)&&(e[r]=s,e[r-1]=a,e[r-2]=o)};var j$=new x,K$=new x;XS.computePositions=function(e){let t=e.granularity,n=e.positions,r=e.ellipsoid,o=e.width/2,a=e.cornerType,s=e.saveAttributes,u=KM,l=ZM,c=QM,f=W$,h=Y$,d=X$,p=FLe,_=zLe,y=VLe,v=kLe,w=[],C=s?[]:void 0,E=s?[]:void 0,S=n[0],A=n[1];l=x.normalize(x.subtract(A,S,l),l),u=r.geodeticSurfaceNormal(S,u),f=x.normalize(x.cross(u,l,f),f),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),p=x.clone(S,p),S=A,c=x.negate(l,c);let D,P=[],M,b=n.length;for(M=1;M<b-1;M++){u=r.geodeticSurfaceNormal(S,u),A=n[M+1],l=x.normalize(x.subtract(A,S,l),l),h=x.normalize(x.add(l,c,h),h);let m=x.multiplyByScalar(u,x.dot(l,u),j$);x.subtract(l,m,m),x.normalize(m,m);let I=x.multiplyByScalar(u,x.dot(c,u),K$);if(x.subtract(c,I,I),x.normalize(I,I),!F.equalsEpsilon(Math.abs(x.dot(m,I)),1,F.EPSILON7)){h=x.cross(h,u,h),h=x.cross(u,h,h),h=x.normalize(h,h);let R=o/Math.max(.25,x.magnitude(x.cross(h,c,f1))),N=YS.angleIsGreaterThanPi(l,c,S,r);h=x.multiplyByScalar(h,R,h),N?(_=x.add(S,h,_),v=x.add(_,x.multiplyByScalar(f,o,v),v),y=x.add(_,x.multiplyByScalar(f,o*2,y),y),ec[0]=x.clone(p,ec[0]),ec[1]=x.clone(v,ec[1]),D=Sh.generateArc({positions:ec,granularity:t,ellipsoid:r}),w=Pz(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),d=x.clone(y,d),f=x.normalize(x.cross(u,l,f),f),y=x.add(_,x.multiplyByScalar(f,o*2,y),y),p=x.add(_,x.multiplyByScalar(f,o,p),p),a===Di.ROUNDED||a===Di.BEVELED?P.push({leftPositions:jM(_,d,y,a,N)}):P.push({leftPositions:H$(S,x.negate(h,h),y,N)})):(y=x.add(S,h,y),v=x.add(y,x.negate(x.multiplyByScalar(f,o,v),v),v),_=x.add(y,x.negate(x.multiplyByScalar(f,o*2,_),_),_),ec[0]=x.clone(p,ec[0]),ec[1]=x.clone(v,ec[1]),D=Sh.generateArc({positions:ec,granularity:t,ellipsoid:r}),w=Pz(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),d=x.clone(_,d),f=x.normalize(x.cross(u,l,f),f),_=x.add(y,x.negate(x.multiplyByScalar(f,o*2,_),_),_),p=x.add(y,x.negate(x.multiplyByScalar(f,o,p),p),p),a===Di.ROUNDED||a===Di.BEVELED?P.push({rightPositions:jM(y,d,_,a,N)}):P.push({rightPositions:H$(S,h,_,N)})),c=x.negate(l,c)}S=A}u=r.geodeticSurfaceNormal(S,u),ec[0]=x.clone(p,ec[0]),ec[1]=x.clone(S,ec[1]),D=Sh.generateArc({positions:ec,granularity:t,ellipsoid:r}),w=Pz(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z));let O;return a===Di.ROUNDED&&(O=GLe(w)),{positions:w,corners:P,lefts:C,normals:E,endPositions:O}};XS.computeInterpolationPositions=function(e){let t=e.positions,n=e.width/2,r=e.globe,o=r.ellipsoid,a=e.granularity,s=e.cornerLength,u=e.height,l=T(e.heightReference,Lt.NONE),c=Math.PI;if(t.length<2)return;let f=KM,h=ZM,d=QM,p=W$,_=Y$,y=X$,v=new le,w=F.toRadians(170),C=new r0(null,null,o),E=t[0],S=t[1],A=null,D=[b(t[0])];f=x.normalize(x.subtract(S,E,f),f),h=x.negate(f,h);let P=t.length-1;for(let m=1;m<P;m++){A=t[m+1],f=x.normalize(x.subtract(A,S,f),f),d=o.geodeticSurfaceNormal(S,d);let I=x.multiplyByScalar(d,x.dot(f,d),j$);x.subtract(f,I,I),x.normalize(I,I);let L=x.multiplyByScalar(d,x.dot(h,d),K$);x.subtract(h,L,L),x.normalize(L,L);let R=Math.acos(x.dot(I,L));if(R<w){let B=(s/(c-R)+n)*Math.tan((c-R)/2);if(B<=0)continue;let V=x.distance(S,A),z=x.distance(S,E);B=Math.min(B,V,z),_=x.add(S,x.multiplyByScalar(h,B,_),_),y=x.add(S,x.multiplyByScalar(f,B,y),y),M(E,_);let U=Math.ceil(s/n*10),Q=ULe([_,S,y],U);for(let ne=0;ne<U;ne++)D.push(b(Q[ne],Q[ne]));D.push(b(y)),E=x.clone(y,p)}else M(E,S),E=S;S=A,h=x.negate(f,h)}M(E,S);for(let m=1;m<D.length;++m)x.equals(D[m-1],D[m])&&(D.splice(m,1),--m);return D;function M(m,I){let L=o.cartesianToCartographic(m),R=o.cartesianToCartographic(I),N=R.height-L.height;C.setEndPoints(L,R);let B=a,V=C.surfaceDistance;if(!(V<=0)){for(;B<V;)C.interpolateUsingSurfaceDistance(B,v),v.height=L.height+B/V*N,O(v),D.push(o.cartographicToCartesian(v)),B+=a;D.push(b(I))}}function b(m,I){return!g(u)&&l===Lt.NONE?I||x.clone(m):(o.cartesianToCartographic(m,v),O(v),o.cartographicToCartesian(v,I))}function O(m){if(l===Lt.CLAMP_TO_GROUND){let I=r.getHeight(m);I&&(m.height=I)}else if(typeof u=="number"){if(l===Lt.NONE)m.height=u;else if(l===Lt.RELATIVE_TO_GROUND){let I=r.getHeight(m);I?m.height=I+u:console.error("\u83B7\u53D6\u5730\u5F62\u9AD8\u7A0B\u5931\u8D25\uFF01")}}}};XS.ev_computePositions=function(e){let t=e.positions,n=e.width/2,r=T(e.ellipsoid,Ge.WGS84),o=KM,a=ZM,s=QM,u=[],l=[],c=[],f=[],h=t[0],d=null;for(let p=1,_=t.length;p<_;p++)d=t[p],o=r.geodeticSurfaceNormal(h,o),a=x.subtract(d,h,a),s=x.normalize(x.cross(o,a,s),s),s=x.multiplyByScalar(s,n,s),u.push(x.add(h,s,new x)),l.push(x.subtract(h,s,new x)),c.push(o),f.push(o),h=d;for(u.push(x.add(h,s,new x)),l.push(x.subtract(h,s,new x)),c.push(o),f.push(o);u.length>0;)l.push(u.pop()),f.push(c.pop());return{positions:l,normals:f}};var Z$=XS;function jS(e){this.viewer=e.viewer,this.useIndependentClock=T(e.useIndependentClock,!0);let t=T(e.speed,100),n=T(e.granularity,1e3),r=Bo();this._positionPromise=Bo(),this._readyPromise=Bo();let o=Promise.all([r.promise,this._positionPromise.promise]);if(typeof e.image=="string"){let u=new Image;u.onload=function(){r.resolve(u)},u.src=e.image}else r.resolve(e.image);let a=Z$.computeInterpolationPositions({positions:e.positions,width:e.width,globe:this.viewer.scene.globe,granularity:n,cornerLength:T(e.cornerLength,e.width),height:e.height,heightReference:e.heightReference});a&&this._positionPromise.resolve(a);let s=this;o.then(function(u){let l=u[0],c=HLe(a,Fa.NONE),f=0;e.imageAspectRatio?f=e.width*e.imageAspectRatio:f=e.width*(l.width/l.height);let h=Math.round(c/f)||1,d=c/t;if(s.useIndependentClock){let p=ce.now();s._clock=new Rx({startTime:p,stopTime:ce.addSeconds(p,d,new ce),clockRange:mf.LOOP_STOP,shouldAnimate:!0}),s.viewer.clock.onTick.addEventListener(s._clock.tick,s._clock)}s._material=new D$({image:l,duration:d,quantity:h,reverse:e.reverse,alpha:e.alpha,clock:s._clock}),n=Math.asin(n/2/s.viewer.scene.globe.ellipsoid.maximumRadius)*2,s._entity=s.viewer.entities.add({id:e.id,name:e.name,show:e.show,corridor:{positions:a,width:e.width,material:s._material,height:e.height,heightReference:0,cornerType:Di.EV_ARC,granularity:n}}),s._readyPromise.resolve()})}Object.defineProperties(jS.prototype,{id:{get:function(){return this._entity.id},set:function(e){e!==this._entity.id&&(this._entity.id=e)}},name:{get:function(){return this._entity.name},set:function(e){e!==this._entity.name&&(this._entity.name=e)}},entity:{get:function(){return this._entity}},material:{get:function(){return this._material}},show:{get:function(){return this._entity.show},set:function(e){this._entity.show!==e&&(this._entity.show=e)}},positionPromise:{get:function(){return this._positionPromise}},readyPromise:{get:function(){return this._readyPromise}}});jS.prototype.play=function(){this.useIndependentClock?this._clock&&(this._clock.shouldAnimate=!0):this.viewer.clock.shouldAnimate=!0};jS.prototype.pause=function(){this.useIndependentClock?this._clock&&(this._clock.shouldAnimate=!1):this.viewer.clock.shouldAnimate=!1};jS.prototype.destroy=function(){this.viewer.entities.remove(this._entity),this._material=null,this._entity=null,this.viewer=null};function HLe(e,t){if(!Array.isArray(e)||e.length<2)return 0;let n=0,r=e.length;if(t===Fa.NONE||t===Fa.RHUMB)for(let o=r-1;o>0;o--)n+=x.distance(e[o],e[o-1]);else{let o=le.fromCartesian(e[r-1]),a=new r0;for(let s=r-2;s>-1;s--){let u=le.fromCartesian(e[s]);a.setEndPoints(o,u),n+=a.surfaceDistance,o=u}}return n}var Q$=jS;function JM(e){this.viewer=e.viewer,this.viewer.clock.shouldAnimate=!0,this.trainingClock=void 0,this.receiveData=new Event,this.geometryArr=e.geometryArr,this.receiveMTFlightDatas=new Ga}JM.prototype.loadCzml=function(e){let t=e.czml,n=this.viewer,r=this.viewer.dataSources.add(UM.load(t,{viewer:this.viewer,geometryArr:this.geometryArr}));n.flyTo(r),r.then(function(o){console.log(o)}).catch(function(o){console.log(o)})};JM.prototype.loadJson=function(e){let t=e.json;if(g(t)){let n=this;vt.fetchJson(t).then(function(r){if(g(r.modelList)&&r.modelList.length!==0&&g(r.offectLongitude)){console.log(r);let o=r.offectLongitude,a=r.offectLatitude,s=n.viewer.scene,u=r.modelList[0].timePositionObj.timePosition;s.camera.setView({destination:x.fromDegrees(u[1]+o,u[2]+a,5e4),orientation:{heading:Math.toRadians(0),pitch:Math.toRadians(-90),roll:0}});let l=r.wallList;if(l&&l.length!==0)for(let d=0;d<l.length;d++){let p=qLe(x.fromDegrees(l[d].position[0],l[d].position[1],l[d].position[2]),l[d].radius),_=[],y=[];for(let v=0;v<p.length;v+=1)_.push(l[d].maximumHeight),y.push(l[d].minimumHeight);n.viewer.entities.add({id:l[d].id,wall:{positions:p,maximumHeights:_,minimumHeights:y,fill:l[d].fill,material:WLe(l[d].color[0])}})}let c=r.modelList,f=c.filter(function(d){if(g(d.effectList))return d});console.log(f);for(let d=0;d<f.length;d++){let p=f[d].effectList;for(let _=0;_<p.length;_++)if(p[_].type==="dynnamicLineEffect"){let y=p[_].positions,v=[];for(let C=0;C<y.length;C++)v.push(x.fromDegrees(y[C][0],y[C][1],y[C][2]));let w=new Q$({viewer:n.viewer,positions:v,width:p[_].width,height:y[0][2],granularity:10,image:La("Assets/EMExtensions/DataTransLine.png"),speed:100,alpha:p[_].alpha,reverse:!1})}else p[_].type==="scanRadar"&&console.log(f[d])}n.trainingClock=new Rx({startTime:ce.fromDate(new Date(r.glbReferenceTime)),currentTime:ce.fromDate(new Date(r.glbReferenceTime)),stopTime:ce.fromDate(new Date(r.endTime)),clockStep:pu.SYSTEM_CLOCK_MULTIPLIER,multiplier:r.multiplier,clockRange:mf.CLAMPED}),n.ev_mtMgr=new wh({viewer:n.viewer,ev_dataMgr:n,trainingClock:n.trainingClock,useInstancedColor:!0}),c=r.modelList;for(let d=0;d<c.length;d++){let p=c[d],_,y;p.color==="Red"?(_=0,y=new K(1,0,0,1)):(_=1,y=new K(0,0,1,1)),console.log(p.scale);let v=new Bu({uId:p.id,mtType:p.type,name:p.name,modelType:p.type,modelUri:La(p.modelUri),modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(p.scale),sectorRadarVisible:p.sectorRadarVisible,trace:{traceTimeDuration:2,upOffset:5},modelLabelVisible:p.modelLabelVisible,modelLabelTextColor:y}),w=p.timePositionObj.timePosition,C=p.timeOrientationObj.timeOrientation;for(let E=0;E<w.length;E+=4)v.addTimeAttitude({realTime:w[E],fLon:o+w[E+1],fLat:a+w[E+2],fAlt:w[E+3],position:x.fromDegrees(o+w[E+1],a+w[E+2],w[E+3]),nRedOrBlue:_,headingPitchRoll:new qc(Math.toRadians(C[E+1]),Math.toRadians(C[E+2]),Math.toRadians(C[E+3]))});n.receiveMTFlightDatas.set(v.uId,v)}n.trainingClock.shouldAnimate=!0,n.trainingClock.tick(),n.receiveData.raiseEvent(n.receiveMTFlightDatas,Fr.ADD);let h=new Eh({showBackground:!0});h.addDisplayFieldPara("","name"),h.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),h.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),h.addDisplayFieldPara("\u9AD8\u5EA6:","fAlt",2),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,h),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,h),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_WPN_TRAJ,h),n.ev_mtMgr.setTraceVisible(Wi.Ribbon,Re.NET_MSG_MIN,!0),n.ev_mtMgr.graduatedColors.set(0,{modelColor:new K(1,0,0,1),modelLabelPullWireColor:new K(1,0,0,1),traceRibbonColor:new K(1,0,0,1)}),n.ev_mtMgr.graduatedColors.set(1,{modelColor:new K(0,0,1,1),modelLabelPullWireColor:new K(0,0,1,1),traceRibbonColor:new K(0,0,1,1)})}}).catch(function(r){throw new Le("\u52A0\u8F7Djson\u5931\u8D25")})}};function qLe(e,t){let n=Cn.headingPitchRollToFixedFrame(e,qc.fromDegrees(0,0,0),Ge.WGS84,Cn.eastNorthUpToFixedFrame),r=[];for(let o=0;o<=360;o++){let a=Math.toRadians(o);r.push(new x(t*Math.cos(a),t*Math.sin(a),0))}return r=r.map(function(o){return G.multiplyByPoint(n,o,o)}),r}function WLe(e){let t=e.split(","),n=Number(t[0].slice(t[0].indexOf("(")+1));n!==0&&(n=n/255);let r=Number(t[1]);r!==0&&(r=r/255);let o=Number(t[2]);o!==0&&(o=o/255);let a=Number(t[3].slice(0,t[3].indexOf(")")));return new K(n,r,o,a)}JM.prototype.addReceiveDataListener=function(e,t){switch(e){case Re.NET_MSG_TSPI:return this.receiveData.addEventListener(t)}};var J$=JM;function eL(e,t){this._url=e,this._resource=new Cesium.Resource({url:e,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})}Object.defineProperties(eL.prototype,{});eL.prototype.getSymbolMeshJson=function(e,t){var n=$$(),r=n.ele("SOAP-ENV:Body").ele("ev1:getSymbolMesh");$M(e,r),this._resource.clone().post(n.end(),{responseType:"document",overrideMimeType:"text/xml"}).then(function(o){var a=eee(o);Cesium.defined(t)&&t(a)}).catch(function(o){Cesium.defined(t)&&t("error")})};eL.prototype.getSymbolMeshData=function(e,t){var n={libraryID:e.libraryID,symbolID:e.symbolID,symbolSpecialInfo:e.symbolSpecialInfo},r=$$(),o=r.ele("SOAP-ENV:Body").ele("ev1:getSymbolMesh");$M(n,o),this._resource.clone().post(r.end(),{responseType:"document",overrideMimeType:"text/xml"}).then(function(a){var s=eee(a);if(Cesium.defined(t)){var u=JSON.parse(s),l={code:u.code,distance:u.distance,id:u.id};if(u.AlgoTextData){l.AlgoTextData=[];for(var c=0;c<u.AlgoTextData.length;c++)l.AlgoTextData.push({TextColor:new Uint8Array(u.AlgoTextData[c].TextColor),TextIndex:new Int32Array(u.AlgoTextData[c].TextIndex),TextNormal:new Float64Array(u.AlgoTextData[c].TextNormal),TextVertex:new Float64Array(u.AlgoTextData[c].TextVertex)})}if(u.WallData){l.WallData=[];for(var c=0;c<u.WallData.length;c++)l.WallData.push({WallColor:new Uint8Array(u.WallData[c].WallColor),WallIndex:new Int32Array(u.WallData[c].WallIndex),WallNormal:new Float64Array(u.WallData[c].WallNormal),WallVertex:new Float64Array(u.WallData[c].WallVertex)})}if(u.TextData){l.TextData=[];for(var c=0;c<u.TextData.length;c++)l.TextData.push({TextColor:new Uint8Array(u.TextData[c].TextColor),TextIndex:new Int32Array(u.TextData[c].TextIndex),TextNormal:new Float64Array(u.TextData[c].TextNormal),TextVertex:new Float64Array(u.TextData[c].TextVertex)})}if(u.FillData){l.FillData=[];for(var c=0;c<u.FillData.length;c++)l.FillData.push({FillColor:new Uint8Array(u.FillData[c].FillColor),FillIndex:new Int32Array(u.FillData[c].FillIndex),FillNormal:new Float64Array(u.FillData[c].FillNormal),FillVertex:new Float64Array(u.FillData[c].FillVertex)})}if(u.MainData){l.MainData=[];for(var c=0;c<u.MainData.length;c++)l.MainData.push({MainColor:new Uint8Array(u.MainData[c].MainColor),MainIndex:new Int32Array(u.MainData[c].MainIndex),MainNormal:new Float64Array(u.MainData[c].MainNormal),MainVertex:new Float64Array(u.MainData[c].MainVertex)})}u=null,t(l)}}).catch(function(a){Cesium.defined(t)&&t("error")})};function $$(){var e=Cesium.XMLBuilder.create({"SOAP-ENV:Envelope":{"@xmlns:xsd":"http://www.w3.org/2001/XMLSchema","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xmlns:enc":"http://schemas.xmlsoap.org/soap/encoding/","@xmlns:SOAP-ENV":"http://schemas.xmlsoap.org/soap/envelope/","@xmlns:ev1":"http://gx.web.services.server.earthview/"}});return e}function $M(e,t){for(var n in e){var r=e[n];YLe(n,r,t)}}function YLe(e,t,n){if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];typeof o=="object"?$M(o,n.ele(e)):n.ele(e).text(o)}else typeof t=="object"?$M(t,n.ele(e)):n.ele(e).text(t)}function eee(e){for(var t=e.all.length,n=0;n<t;n++){var r=e.all[n],o=r.localName;if(o=="symbolDataText")return r.textContent}}var tL=eL;var tee={};function Up(e){this.olMap=e.olMap,this.layerSource=e.layerSource,this.vertexData=e.vertexData,this.symbol=e.symbol,this._show=!0,this._fillColor=void 0,this._strokeColorFlag=!0,this._strokeColor=void 0,this._markShow=!1,this._editMode=!1,this.updataFeature()}Object.defineProperties(Up.prototype,{id:{get:function(){return this.symbol._id},set:function(e){this._id=e,this.feature&&this.feature.setId(e),this.mark&&this.mark.setId("mark_"+e)}},position:{get:function(){return this.symbol.positionDegrees},set:function(e){e&&((!e||!Array.isArray(e)||!e.length===2)&&console.error("position error"),this._position=e,this.feature&&this.feature.getGeometry().setCoordinates(e),this.mark&&this.mark.getGeometry().setCoordinates(e))}},show:{get:function(){return this._show},set:function(e){this.feature._Geometry||(this.feature._Geometry=this.feature.getGeometry()),e?this.feature.setGeometry(this.feature._Geometry):(this.feature.setGeometry(void 0),this.setEditMode(!1)),this._show=e}},strokeColorFlag:{get:function(){return this._strokeColorFlag},set:function(e){this._strokeColorFlag=e,this.updataFeature()}},strokeColor:{get:function(){return this._strokeColor},set:function(e){e&&(this._strokeColor=e,this.updataFeature())}},fillColor:{get:function(){return this._fillColor},set:function(e){e&&(this._fillColor=e,this.updataFeature())}},markShow:{get:function(){return this._markShow},set:function(e){!this.value||(this.mark._Geometry||(this.mark._Geometry=this.feature.getGeometry()),e?this.mark.setGeometry(this.mark._Geometry):this.mark.setGeometry(void 0),this._markShow=e)}},editMode:{get:function(){return this._editMode},set:function(e){this._editMode!==e&&(this._editMode!==e&&this.setEditMode(e),this._editMode=e)}}});Up.prototype.updataFeature=function(){this.destroy();var e=this,t=new Image,n=this.vertexData,r=[],o=[],a=[];n.forEach(function(E,S,A){E.Text&&a.push(E),E.FillStyle==2&&o.push(E),E.FillStyle==1&&r.push(E)});var s=0,u=0,l=0,c=0;o.forEach(function(E,S,A){E.Vertexes.forEach(function(D,P,M){D.X<0&&s>D.X&&(s=D.X),D.Y<0&&u>D.Y&&(u=D.Y),l<D.X&&(l=D.X),c<D.Y&&(c=D.Y)})}),r.forEach(function(E,S,A){E.Vertexes.forEach(function(D,P,M){D.X<0&&s>D.X&&(s=D.X),D.Y<0&&u>D.Y&&(u=D.Y),l<D.X&&(l=D.X),c<D.Y&&(c=D.Y)})});var f=!1,h=0;a.forEach(function(E,S,A){function D(P,M){for(var b=0,O=/[\u4e00-\u9fa5]/,m=0;m<P.length;m++)O.test(P.charAt(m))?b+=2:b++;return b>M?b/2:M}h=D(E.Text,h),E.FontPos.X<0&&s>E.FontPos.X&&(s=E.FontPos.X),E.FontPos.Y<0&&u>E.FontPos.Y&&(u=E.FontPos.Y),l<E.FontPos.X+E.FontWidth*h&&(l=E.FontPos.X+E.FontWidth*h),c<E.FontPos.Y&&(c=E.FontPos.Y)});var d=-s+20,p=-u+20,_=[];o.forEach(function(E,S,A){E.IsClose&&E.Vertexes.push(E.Vertexes[0]),(!E.IsOutline||f)&&(_[S]='d="',E.Vertexes.forEach(function(D,P,M){P===0?_[S]+="M"+(D.X+d)+","+(D.Y+p):_[S]+=" L"+(D.X+d)+","+(D.Y+p)}),_[S]+='"')});var y=[];r.forEach(function(E,S,A){E.IsClose&&E.Vertexes.push(E.Vertexes[0]),(!E.IsOutline||f)&&(y[S]='d="',E.Vertexes.forEach(function(D,P,M){P===0?y[S]+="M"+(D.X+d)+","+(D.Y+p):y[S]+=" L"+(D.X+d)+","+(D.Y+p)}),y[S]+='"')});var v=l+d+20,w=c+p+20,C='<svg version="1.1" encoding="UTF-8" standalone="no" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+v+'px" heigh="'+w+'px" viewBox="0 0 '+v+" "+w+'" enable-background="new 0 0 '+v+" "+w+'" xml:space="preserve">';_.forEach(function(E,S,A){var D=o[S],P="rgba("+D.FillColor.R+","+D.FillColor.G+","+D.FillColor.B+","+D.FillColor.A+")",M="rgba("+D.LineColor.R+","+D.LineColor.G+","+D.LineColor.B+","+D.LineColor.A+")",b=D.LineWidth;if(e.fillColor||(e.fillColor=P),D.FillStyle==2){var O='<path fill="rgba(255,0,0,255)"',m=' stroke="'+M+'"';C+='<path fill="'+e.fillColor+'"'}else C+='<path fill="none"';C+=' stroke="'+M+'" stroke-opacity="1" stroke-width="'+b+'" stroke-linecap="square" stroke-linejoin="miter" stroke-miterlimit="4" transform="matrix(1,0,0,1,0,0)" font-family="SimSun" font-size="9" font-weight="400" font-style="normal" '+E+"/>",D=void 0}),y.forEach(function(E,S,A){var D=r[S],P="rgba("+D.FillColor.R+","+D.FillColor.G+","+D.FillColor.B+","+D.FillColor.A+")",M="rgba("+D.LineColor.R+","+D.LineColor.G+","+D.LineColor.B+","+D.LineColor.A+")",b=D.LineWidth;if(D.FillStyle==2){var O='<path fill="rgba(255,0,0,255)"',m=' stroke="'+M+'"';C+='<path fill="'+P+'"'}else C+='<path fill="none"';e.strokeColorFlag&&(e._strokeColor=M),C+=' stroke="'+e.strokeColor+'" stroke-opacity="1" stroke-width="'+b+'" stroke-linecap="square" stroke-linejoin="miter" stroke-miterlimit="4" transform="matrix(1,0,0,1,0,0)" font-family="SimSun" font-size="9" font-weight="400" font-style="normal" '+E+"/>",D=void 0}),a.forEach(function(E,S,A){var D=E.FontPos.X+d,P=E.FontPos.Y+p-22,M="rgba("+E.FontColor.R+","+E.FontColor.G+","+E.FontColor.B+","+E.FontColor.A+")",b=E.FontHeight,O=E.FontWidth*h,m=E.FontName;C+='<text x="'+D+'" y="'+P+'" font-family="'+m+'" font-size="'+b+'" textLength="'+O+'" transform="matrix(1, 0, 0, 1, 0,'+b+')" fill="'+M+'">'+E.Text+"</text>"}),C+="</svg>",t.src="data:image/svg+xml,"+encodeURI(C),this.featureStyle=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[v,w],scale:.05})}),this.drawFeature(this.id)};Up.prototype.setEditMode=function(e,t){!t&&t!=="false"&&(t=!0),!(this.editMode===e||!t)&&(this._editMode=e,e?t&&this.drawMark(this.id):t&&this.destoryMark())};Up.prototype.drawFeature=function(e){this.destoryFeature();var t=this;e||(e=this.id),this.feature=new ol.Feature({geometry:new ol.geom.Point(t.position)}),this.feature.type=0,this.feature.setId(this._id),this.featureStyle&&this.feature.setStyle(this.featureStyle)};Up.prototype.drawMark=function(e){this.destoryMark();var t=this;e||(e=this.id),this.mark=new ol.Feature({geometry:new ol.geom.Point(t.position)}),this.mark.setId("mark_"+e),this.layerSource.addFeature(this.mark)};Up.prototype.isDestroyed=function(){return!1};Up.prototype.destroy=function(){delete this};Up.prototype.destoryFeature=function(){this.feature&&this.layerSource.hasFeature(this.feature)&&(this.layerSource.removeFeature(this.feature),delete this.feature)};Up.prototype.destoryMark=function(){this.mark&&this.layerSource.hasFeature(this.mark)&&(this._editMode=!1,this.layerSource.removeFeature(this.mark),delete this.mark)};var nL=Up;function Jy(e){if(!(e&&e.olMap&&e.plottingService)){console.error("'EV_MilStd2DRenderManager' parameter 'options' error");return}this.olMap=e.olMap,this.plottingService=e.plottingService,XLe(this),this.symbols=new $y}Jy.prototype.drawByPositions=function(e,t){var n=e.libraryID,r=e.code,o=e.type,a=e.positionDegrees,s=this.plottingService,u=e.isExternalSetLine,l=e.isExternalSetFill,c=e.isisExternalSetInnertext,f=this;jLe({libraryID:n,code:r,type:o,mainLineColor:u?e.mainLineColor:void 0,fillMode:1,fillColor:l?e.fillColor:void 0,innerText:c?e.innertext:"",positionDegrees:a,plottingService:s}).then(function(h){e.vertexData=h,f.createRenderSymbol(e,function(d){t(d)})})};Jy.prototype.createRenderSymbol=function(e,t){let n=e.vertexData,r=e.id,o=new nL({olMap:this.olMap,layerSource:this.layerSource,symbol:e,vertexData:n});this.symbols.set(r,o),this.layerSource.addFeature(o.feature),t&&t(r)};Jy.prototype.getSymbol=function(e){return this.symbols.get(e)};Jy.prototype.removeSymbol=function(e){var t=this.getSymbol(e);return this.layerSource.removeFeature(t.feature),this.symbols.remove(e)};Jy.prototype.removeAllSymbol=function(){this.removeAll();for(var e=this.symbols.values,t=0;t<this.symbols.length;t++){var n=e[t];this.removeSymbol(n.id)}};Jy.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.getSymbol(e),r=n.feature;r.getGeometry().setCoordinates(t)};function XLe(e){let t=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(188, 0, 0,0.4)"}),stroke:new ol.style.Stroke({color:"rgba(188, 0, 0,1)",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})}),zIndex:9999});e.olMap.addLayer(t),e.vectorLayer=t,e.layerSource=t.getSource()}function jLe(e){var t=e.libraryID,n=e.code,r=e.plottingService,o=Cesium.defer();if(r){var a={libraryID:t,symbolID:n,symbolSpecialInfo:'{ "ReturnSymbolDataType": "1" }'};r.getSymbolMeshJson(a,function(s){var u=JSON.parse(s),l=JSON.parse(u.symbolStyle);l&&o.resolve(l)})}return o.promise}function $y(){this._array=[],this._hash={}}Object.defineProperties($y.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});$y.prototype.contains=function(e){if(typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number."),this._hash[e]||this._hash[e]===0||this._hash[e]==="")return!0};$y.prototype.set=function(e,t){typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number.");var n=this._hash[e];t!==n&&(this.remove(e),this._hash[e]=t,this._array.push(t))};$y.prototype.get=function(e){return typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number."),this._hash[e]||this._hash[e]===0||this._hash[e]===""?this._hash[e]:!1};$y.prototype.remove=function(e){typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number.");var t=this.get(e);if(t){var n=this._array;return n.splice(n.indexOf(t),1),delete this._hash[e],!0}else return!1};$y.prototype.removeAll=function(){var e=this._array;e.length>0&&(this._hash={},e.length=0)};var rL=Jy;var Nz=Xv(aee(),1);var cRe=new x,fRe=new x,Z0={};Z0.computeArea2D=function(e){let t=e.length,n=0;for(let r=t-1,o=0;o<t;r=o++){let a=e[r],s=e[o];n+=a.x*s.y-s.x*a.y}return n*.5};Z0.computeWindingOrder2D=function(e){return Z0.computeArea2D(e)>0?Em.COUNTER_CLOCKWISE:Em.CLOCKWISE};Z0.triangulate=function(e,t){let n=X.packArray(e);return(0,Nz.default)(n,t,2)};var cee=new x,fee=new x,hee=new x,see=new x,uee=new x,lee=new x,vg=new x,dee=new X,pee=new X,mee=new X,d1=new X;Z0.computeSubdivision=function(e,t,n,r,o){o=T(o,F.RADIANS_PER_DEGREE);let a=g(r),s=n.slice(0),u,l=t.length,c=new Array(l*3),f=new Array(l*2),h=0,d=0;for(u=0;u<l;u++){let E=t[u];if(c[h++]=E.x,c[h++]=E.y,c[h++]=E.z,a){let S=r[u];f[d++]=S.x,f[d++]=S.y}}let p=[],_={},y=e.maximumRadius,v=F.chordLength(o,y),w=v*v;for(;s.length>0;){let E=s.pop(),S=s.pop(),A=s.pop(),D=x.fromArray(c,A*3,cee),P=x.fromArray(c,S*3,fee),M=x.fromArray(c,E*3,hee),b,O,m;a&&(b=X.fromArray(f,A*2,dee),O=X.fromArray(f,S*2,pee),m=X.fromArray(f,E*2,mee));let I=x.multiplyByScalar(x.normalize(D,see),y,see),L=x.multiplyByScalar(x.normalize(P,uee),y,uee),R=x.multiplyByScalar(x.normalize(M,lee),y,lee),N=x.magnitudeSquared(x.subtract(I,L,vg)),B=x.magnitudeSquared(x.subtract(L,R,vg)),V=x.magnitudeSquared(x.subtract(R,I,vg)),z=Math.max(N,B,V),U,Q,ne;z>w?N===z?(U=`${Math.min(A,S)} ${Math.max(A,S)}`,u=_[U],g(u)||(Q=x.add(D,P,vg),x.multiplyByScalar(Q,.5,Q),c.push(Q.x,Q.y,Q.z),u=c.length/3-1,_[U]=u,a&&(ne=X.add(b,O,d1),X.multiplyByScalar(ne,.5,ne),f.push(ne.x,ne.y))),s.push(A,u,E),s.push(u,S,E)):B===z?(U=`${Math.min(S,E)} ${Math.max(S,E)}`,u=_[U],g(u)||(Q=x.add(P,M,vg),x.multiplyByScalar(Q,.5,Q),c.push(Q.x,Q.y,Q.z),u=c.length/3-1,_[U]=u,a&&(ne=X.add(O,m,d1),X.multiplyByScalar(ne,.5,ne),f.push(ne.x,ne.y))),s.push(S,u,A),s.push(u,E,A)):V===z&&(U=`${Math.min(E,A)} ${Math.max(E,A)}`,u=_[U],g(u)||(Q=x.add(M,D,vg),x.multiplyByScalar(Q,.5,Q),c.push(Q.x,Q.y,Q.z),u=c.length/3-1,_[U]=u,a&&(ne=X.add(m,b,d1),X.multiplyByScalar(ne,.5,ne),f.push(ne.x,ne.y))),s.push(E,u,S),s.push(u,A,S)):(p.push(A),p.push(S),p.push(E))}let C={attributes:{position:new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:c})},indices:p,primitiveType:sn.TRIANGLES};return a&&(C.attributes.st=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:f})),new Ei(C)};var hRe=new le,dRe=new le,pRe=new le,Bz=new le;Z0.computeRhumbLineSubdivision=function(e,t,n,r,o){o=T(o,F.RADIANS_PER_DEGREE);let a=g(r),s=n.slice(0),u,l=t.length,c=new Array(l*3),f=new Array(l*2),h=0,d=0;for(u=0;u<l;u++){let A=t[u];if(c[h++]=A.x,c[h++]=A.y,c[h++]=A.z,a){let D=r[u];f[d++]=D.x,f[d++]=D.y}}let p=[],_={},y=e.maximumRadius,v=F.chordLength(o,y),w=new fp(void 0,void 0,e),C=new fp(void 0,void 0,e),E=new fp(void 0,void 0,e);for(;s.length>0;){let A=s.pop(),D=s.pop(),P=s.pop(),M=x.fromArray(c,P*3,cee),b=x.fromArray(c,D*3,fee),O=x.fromArray(c,A*3,hee),m,I,L;a&&(m=X.fromArray(f,P*2,dee),I=X.fromArray(f,D*2,pee),L=X.fromArray(f,A*2,mee));let R=e.cartesianToCartographic(M,hRe),N=e.cartesianToCartographic(b,dRe),B=e.cartesianToCartographic(O,pRe);w.setEndPoints(R,N);let V=w.surfaceDistance;C.setEndPoints(N,B);let z=C.surfaceDistance;E.setEndPoints(B,R);let U=E.surfaceDistance,Q=Math.max(V,z,U),ne,se,de,pe,ve;Q>v?V===Q?(ne=`${Math.min(P,D)} ${Math.max(P,D)}`,u=_[ne],g(u)||(se=w.interpolateUsingFraction(.5,Bz),de=(R.height+N.height)*.5,pe=x.fromRadians(se.longitude,se.latitude,de,e,vg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,_[ne]=u,a&&(ve=X.add(m,I,d1),X.multiplyByScalar(ve,.5,ve),f.push(ve.x,ve.y))),s.push(P,u,A),s.push(u,D,A)):z===Q?(ne=`${Math.min(D,A)} ${Math.max(D,A)}`,u=_[ne],g(u)||(se=C.interpolateUsingFraction(.5,Bz),de=(N.height+B.height)*.5,pe=x.fromRadians(se.longitude,se.latitude,de,e,vg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,_[ne]=u,a&&(ve=X.add(I,L,d1),X.multiplyByScalar(ve,.5,ve),f.push(ve.x,ve.y))),s.push(D,u,P),s.push(u,A,P)):U===Q&&(ne=`${Math.min(A,P)} ${Math.max(A,P)}`,u=_[ne],g(u)||(se=E.interpolateUsingFraction(.5,Bz),de=(B.height+R.height)*.5,pe=x.fromRadians(se.longitude,se.latitude,de,e,vg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,_[ne]=u,a&&(ve=X.add(L,m,d1),X.multiplyByScalar(ve,.5,ve),f.push(ve.x,ve.y))),s.push(A,u,D),s.push(u,P,D)):(p.push(P),p.push(D),p.push(A))}let S={attributes:{position:new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:c})},indices:p,primitiveType:sn.TRIANGLES};return a&&(S.attributes.st=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:f})),new Ei(S)};Z0.scaleToGeodeticHeight=function(e,t,n,r){n=T(n,Ge.WGS84);let o=cRe,a=fRe;if(t=T(t,0),r=T(r,!0),g(e)){let s=e.length;for(let u=0;u<s;u+=3)x.fromArray(e,u,a),r&&(a=n.scaleToGeodeticSurface(a,a)),t!==0&&(o=n.geodeticSurfaceNormal(a,o),x.multiplyByScalar(o,t,o),x.add(a,o,a)),e[u]=a.x,e[u+1]=a.y,e[u+2]=a.z}return e};var p1=Z0;function mRe(e,t,n,r){let o=new a0;r.position&&(o.position=new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:e}));let a=t.length,s=e.length/3,u=(s-a*2)/(a*2),l=p1.triangulate(t),c=(u-1)*a*6+l.length*2,f=Or.createTypedArray(s,c),h,d,p,_,y,v,w=a*2,C=0;for(h=0;h<u-1;h++){for(d=0;d<a-1;d++)p=d*2+h*a*2,v=p+w,_=p+1,y=_+w,f[C++]=_,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v;p=a*2-2+h*a*2,_=p+1,y=_+w,v=p+w,f[C++]=_,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v}if(r.st||r.tangent||r.bitangent){let A=new Float32Array(s*2),D=1/(u-1),P=1/n.height,M=n.height/2,b,O,m=0;for(h=0;h<u;h++){for(b=h*D,O=P*(t[0].y+M),A[m++]=b,A[m++]=O,d=1;d<a;d++)O=P*(t[d].y+M),A[m++]=b,A[m++]=O,A[m++]=b,A[m++]=O;O=P*(t[0].y+M),A[m++]=b,A[m++]=O}for(d=0;d<a;d++)b=0,O=P*(t[d].y+M),A[m++]=b,A[m++]=O;for(d=0;d<a;d++)b=(u-1)*D,O=P*(t[d].y+M),A[m++]=b,A[m++]=O;o.st=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:new Float32Array(A)})}let E=s-a*2;for(h=0;h<l.length;h+=3){let A=l[h]+E,D=l[h+1]+E,P=l[h+2]+E;f[C++]=A,f[C++]=D,f[C++]=P,f[C++]=P+a,f[C++]=D+a,f[C++]=A+a}let S=new Ei({attributes:o,indices:f,boundingSphere:Ee.fromVertices(e),primitiveType:sn.TRIANGLES});if(r.normal&&(S=va.computeNormal(S)),r.tangent||r.bitangent){try{S=va.computeTangentAndBitangent(S)}catch{f0("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(S.attributes.tangent=void 0),r.bitangent||(S.attributes.bitangent=void 0),r.st||(S.attributes.st=void 0)}return S}function $S(e){e=T(e,T.EMPTY_OBJECT);let t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=Ge.clone(T(e.ellipsoid,Ge.WGS84)),this._cornerType=T(e.cornerType,Di.ROUNDED),this._vertexFormat=vo.clone(T(e.vertexFormat,vo.DEFAULT)),this._granularity=T(e.granularity,F.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";let r=1+t.length*x.packedLength;r+=1+n.length*X.packedLength,this.packedLength=r+Ge.packedLength+vo.packedLength+2}$S.pack=function(e,t,n){n=T(n,0);let r,o=e._positions,a=o.length;for(t[n++]=a,r=0;r<a;++r,n+=x.packedLength)x.pack(o[r],t,n);let s=e._shape;for(a=s.length,t[n++]=a,r=0;r<a;++r,n+=X.packedLength)X.pack(s[r],t,n);return Ge.pack(e._ellipsoid,t,n),n+=Ge.packedLength,vo.pack(e._vertexFormat,t,n),n+=vo.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var gee=Ge.clone(Ge.UNIT_SPHERE),_ee=new vo,JS={polylinePositions:void 0,shapePositions:void 0,ellipsoid:gee,vertexFormat:_ee,cornerType:void 0,granularity:void 0};$S.unpack=function(e,t,n){t=T(t,0);let r,o=e[t++],a=new Array(o);for(r=0;r<o;++r,t+=x.packedLength)a[r]=x.unpack(e,t);o=e[t++];let s=new Array(o);for(r=0;r<o;++r,t+=X.packedLength)s[r]=X.unpack(e,t);let u=Ge.unpack(e,t,gee);t+=Ge.packedLength;let l=vo.unpack(e,t,_ee);t+=vo.packedLength;let c=e[t++],f=e[t];return g(n)?(n._positions=a,n._shape=s,n._ellipsoid=Ge.clone(u,n._ellipsoid),n._vertexFormat=vo.clone(l,n._vertexFormat),n._cornerType=c,n._granularity=f,n):(JS.polylinePositions=a,JS.shapePositions=s,JS.cornerType=c,JS.granularity=f,new $S(JS))};var gRe=new rn;$S.createGeometry=function(e){let t=e._positions,n=SC(t,x.equalsEpsilon),r=e._shape;if(r=YS.removeDuplicatesFromShape(r),n.length<2||r.length<3)return;p1.computeWindingOrder2D(r)===Em.CLOCKWISE&&r.reverse();let o=rn.fromPoints(r,gRe),a=YS.computePositions(n,r,o,e,!0);return mRe(a,r,o,e._vertexFormat)};var yee=$S;var yu=[new x,new x],_Re=new x,yRe=new x,vRe=new x,CRe=new x,xRe=new x,wRe=new x,ERe=new x,TRe=new x,SRe=new x,m1=new x,uL=new x;function eA(){}var Fz=new le;function ARe(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++){var o=e[r];Fz=t.cartesianToCartographic(o,Fz),n[r]=Fz.height,e[r]=t.scaleToGeodeticSurface(o,o)}return n}function zz(e,t,n,r){var o=e[0],a=e[1],s=x.angleBetween(o,a),u=Math.ceil(s/r),l=new Array(u),c;if(t===n){for(c=0;c<u;c++)l[c]=t;return l.push(n),l}var f=n-t,h=f/u;for(c=1;c<u;c++){var d=t+c*h;l[c]=d}return l[0]=t,l.push(n),l}var lL=new x,cL=new x;function bRe(e,t,n,r){var o=new l0(n,r),a=o.projectPointOntoPlane(x.add(n,e,lL),lL),s=o.projectPointOntoPlane(x.add(n,t,cL),cL),u=X.angleBetween(a,s);return s.x*a.y-s.y*a.x>=0?-u:u}var IRe=new x(-1,0,0),tv=new G,DRe=new G,Vz=new te,PRe=te.IDENTITY.clone(),MRe=new x,LRe=new Se,vee=new x;function Cg(e,t,n,r,o,a,s,u){var l=MRe,c=LRe;tv=Cn.eastNorthUpToFixedFrame(e,o,tv),l=G.multiplyByPointAsVector(tv,IRe,l),l=x.normalize(l,l);var f=bRe(l,t,e,o);Vz=te.fromRotationZ(f,Vz),vee.z=a,tv=G.multiplyTransformation(tv,G.fromRotationTranslation(Vz,vee,DRe),tv);var h=PRe;h[0]=s;for(var d=0;d<u;d++)for(var p=0;p<n.length;p+=3)c=x.fromArray(n,p,c),c=te.multiplyByVector(h,c,c),c=G.multiplyByPoint(tv,c,c),r.push(c.x,c.y,c.z);return r}var RRe=new x;function kz(e,t,n,r,o,a,s){for(var u=0;u<e.length;u+=3){var l=x.fromArray(e,u,RRe);r=Cg(l,t,n,r,o,a[u/3],s,1)}return r}function ORe(e,t){var n=e.length,r=new Array(n*6),o=0,a=0,s=0,u=e[0];r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s;for(var l=1;l<n;l++){u=e[l];var c=u.x-a,f=u.y-s;r[o++]=c,r[o++]=0,r[o++]=f,r[o++]=c,r[o++]=0,r[o++]=f}return u=e[0],r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s,r}function Cee(e,t){for(var n=e.length,r=new Array(n*3),o=0,a=0,s=0,u=0;u<n;u++)r[o++]=e[u].x-a,r[o++]=0,r[o++]=e[u].y-s;return r}var xee=new je,wee=new x,Eee=new te;function Tee(e,t,n,r,o,a,s,u,l,c){var f=x.angleBetween(x.subtract(t,e,m1),x.subtract(n,e,uL)),h=r===Di.BEVELED?0:Math.ceil(f/F.toRadians(5)),d;o?d=te.fromQuaternion(je.fromAxisAngle(x.negate(e,m1),f/(h+1),xee),Eee):d=te.fromQuaternion(je.fromAxisAngle(e,f/(h+1),xee),Eee);var p,_;if(t=x.clone(t,wee),h>0)for(var y=c?2:1,v=0;v<h;v++)t=te.multiplyByVector(d,t,t),p=x.subtract(t,e,m1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(t,uL),s=Cg(_,p,u,s,a,l,1,y);else p=x.subtract(t,e,m1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(t,uL),s=Cg(_,p,u,s,a,l,1,1),n=x.clone(n,wee),p=x.subtract(n,e,m1),p=x.normalize(p,p),o||(p=x.negate(p,p)),_=a.scaleToGeodeticSurface(n,uL),s=Cg(_,p,u,s,a,l,1,1);return s}eA.removeDuplicatesFromShape=function(e){for(var t=e.length,n=[],r=t-1,o=0;o<t;r=o++){var a=e[r],s=e[o];X.equals(a,s)||n.push(s)}return n};eA.angleIsGreaterThanPi=function(e,t,n,r){var o=new l0(n,r),a=o.projectPointOntoPlane(x.add(n,e,lL),lL),s=o.projectPointOntoPlane(x.add(n,t,cL),cL);return s.x*a.y-s.y*a.x>=0};var NRe=new x,BRe=new x;eA.computePositions=function(e,t,n,r,o){var a=r._ellipsoid,s=ARe(e,a),u=r._granularity,l=r._cornerType,c=o?ORe(t,n):Cee(t,n),f=o?Cee(t,n):void 0,h=n.height/2,d=n.width/2,p=e.length,_=[],y=o?[]:void 0,v=_Re,w=yRe,C=vRe,E=CRe,S=xRe,A=wRe,D=ERe,P=TRe,M=SRe,b=e[0].clone(),O=e[1].clone();E=a.geodeticSurfaceNormal(b,E),v=x.subtract(O,b,v),v=x.normalize(v,v),P=x.cross(E,v,P),P=x.normalize(P,P);var m=s[0],I=s[1];o&&(y=Cg(b,P,f,y,a,m+h,1,1)),M=x.clone(b,M),b=x.clone(O,b),w=x.negate(v,w);for(var L,R,N=1;N<p-1;N++){var B=o?2:1;O=x.clone(e[N+1],O),v=x.subtract(O,b,v),v=x.normalize(v,v),C=x.add(v,w,C),C=x.normalize(C,C),E=a.geodeticSurfaceNormal(b,E);var V=x.multiplyByScalar(E,x.dot(v,E),NRe);x.subtract(v,V,V),x.normalize(V,V);var z=x.multiplyByScalar(E,x.dot(w,E),BRe);x.subtract(w,z,z),x.normalize(z,z);var U=!F.equalsEpsilon(Math.abs(x.dot(V,z)),1,F.EPSILON7);if(U){C=x.cross(C,E,C),C=x.cross(E,C,C),C=x.normalize(C,C);var Q=1/Math.max(.25,x.magnitude(x.cross(C,w,m1))),ne=eA.angleIsGreaterThanPi(v,w,b,a);ne?(S=x.add(b,x.multiplyByScalar(C,Q*d,C),S),A=x.add(S,x.multiplyByScalar(P,d,A),A),yu[0]=x.clone(M,yu[0]),yu[1]=x.clone(A,yu[1]),L=zz(yu,m+h,I+h,u),R=Sh.generateArc({positions:yu,granularity:u,ellipsoid:a}),_=kz(R,P,c,_,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,d,D),D),l===Di.ROUNDED||l===Di.BEVELED?Tee(S,A,D,l,ne,a,_,c,I+h,o):(C=x.negate(C,C),_=Cg(b,C,c,_,a,I+h,Q,B)),M=x.clone(D,M)):(S=x.add(b,x.multiplyByScalar(C,Q*d,C),S),A=x.add(S,x.multiplyByScalar(P,-d,A),A),yu[0]=x.clone(M,yu[0]),yu[1]=x.clone(A,yu[1]),L=zz(yu,m+h,I+h,u),R=Sh.generateArc({positions:yu,granularity:u,ellipsoid:a}),_=kz(R,P,c,_,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,-d,D),D),l===Di.ROUNDED||l===Di.BEVELED?Tee(S,A,D,l,ne,a,_,c,I+h,o):_=Cg(b,C,c,_,a,I+h,Q,B),M=x.clone(D,M)),w=x.negate(v,w)}else _=Cg(M,P,c,_,a,m+h,1,1),M=x.clone(b,M);m=I,I=s[N+1],b=x.clone(O,b)}yu[0]=x.clone(M,yu[0]),yu[1]=x.clone(b,yu[1]),L=zz(yu,m+h,I+h,u),R=Sh.generateArc({positions:yu,granularity:u,ellipsoid:a}),_=kz(R,P,c,_,a,L,1),o&&(y=Cg(b,P,f,y,a,I+h,1,1)),p=_.length;var se=o?p+y.length:p,de=new Float64Array(se);return de.set(_),o&&de.set(y,p),de};var tA=eA;function fL(e){e=T(e,T.EMPTY_OBJECT);var t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=Ge.clone(T(e.ellipsoid,Ge.WGS84)),this._cornerType=T(e.cornerType,Di.ROUNDED),this._vertexFormat=vo.clone(T(e.vertexFormat,vo.DEFAULT)),this._granularity=T(e.granularity,Cesium.Math.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry",this.isOffset=T(e.isOffset,!1),this.isMultiImage=T(e.isMultiImage,!1);var r=1+t.length*x.packedLength;r+=1+n.length*Cesium.Cartesian2.packedLength,this.packedLength=r+Ge.packedLength+vo.packedLength+2+1+1}fL.pack=function(e,t,n){n=T(n,0);var r,o=e._positions,a=o.length;for(t[n++]=a,r=0;r<a;++r,n+=x.packedLength)x.pack(o[r],t,n);var s=e._shape;for(a=s.length,t[n++]=a,r=0;r<a;++r,n+=Cesium.Cartesian2.packedLength)Cesium.Cartesian2.pack(s[r],t,n);return Ge.pack(e._ellipsoid,t,n),n+=Ge.packedLength,vo.pack(e._vertexFormat,t,n),n+=vo.packedLength,t[n++]=e._cornerType,t[n++]=e._granularity,t[n++]=e.isOffset?1:0,t[n]=e.isMultiImage?1:0,t};var See=Ge.clone(Ge.UNIT_SPHERE),Aee=new vo,nv={polylinePositions:void 0,shapePositions:void 0,ellipsoid:See,vertexFormat:Aee,cornerType:void 0,granularity:void 0,isOffset:void 0,isMultiImage:void 0};fL.unpack=function(e,t,n){t=T(t,0);var r,o=e[t++],a=new Array(o);for(r=0;r<o;++r,t+=x.packedLength)a[r]=x.unpack(e,t);o=e[t++];var s=new Array(o);for(r=0;r<o;++r,t+=Cesium.Cartesian2.packedLength)s[r]=Cesium.Cartesian2.unpack(e,t);var u=Ge.unpack(e,t,See);t+=Ge.packedLength;var l=vo.unpack(e,t,Aee);t+=vo.packedLength;var c=e[t++],f=e[t],h=e[++t],d=e[++t];return Cesium.defined(n)?(n._positions=a,n._shape=s,n._ellipsoid=Ge.clone(u,n._ellipsoid),n._vertexFormat=vo.clone(l,n._vertexFormat),n._cornerType=c,n._granularity=f,n.isOffset=h,n.isMultiImage=d,n):(nv.polylinePositions=a,nv.shapePositions=s,nv.cornerType=c,nv.granularity=f,nv.isOffset=h,nv.isMultiImage=d,new yee(nv))};function FRe(e,t,n,r){var o=new a0;r.position&&(o.position=new Ti({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:e}));var a=t.length,s=e.length/3,u=(s-a*2)/(a*2),l=p1.triangulate(t),c=(u-1)*a*6+l.length*2,f=Or.createTypedArray(s,c),h,d,p,_,y,v,w=a*2,C=0;for(h=0;h<u-1;h++){for(d=0;d<a-1;d++)p=d*2+h*a*2,v=p+w,_=p+1,y=_+w,f[C++]=_,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v;p=a*2-2+h*a*2,_=p+1,y=_+w,v=p+w,f[C++]=_,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v}if(r.st||r.tangent||r.bitangent){var E=new Float32Array(s*2),S=1/(u-1),A=1/n.height,D=n.height/2,P,M,b=0;for(h=0;h<u;h++){for(P=h*S,M=A*(t[0].y+D),E[b++]=P,E[b++]=M,d=1;d<a;d++)M=A*(t[d].y+D),E[b++]=P,E[b++]=M,E[b++]=P,E[b++]=M;M=A*(t[0].y+D),E[b++]=P,E[b++]=M}for(d=0;d<a;d++)P=0,M=A*(t[d].y+D),E[b++]=P,E[b++]=M;for(d=0;d<a;d++)P=(u-1)*S,M=A*(t[d].y+D),E[b++]=P,E[b++]=M;o.st=new Ti({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:new Float32Array(E)})}var O=s-a*2;for(h=0;h<l.length;h+=3){var m=l[h]+O,I=l[h+1]+O,L=l[h+2]+O;f[C++]=m,f[C++]=I,f[C++]=L,f[C++]=L+a,f[C++]=I+a,f[C++]=m+a}var R=new Ei({attributes:o,indices:f,boundingSphere:Ee.fromVertices(e),primitiveType:sn.TRIANGLES});if(r.normal&&(R=va.computeNormal(R)),r.tangent||r.bitangent){try{R=va.computeTangentAndBitangent(R)}catch{f0("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(R.attributes.tangent=void 0),r.bitangent||(R.attributes.bitangent=void 0),r.st||(R.attributes.st=void 0)}return R}fL.createGeometry=function(e){var t=e._positions,n=SC(t,x.equalsEpsilon),r=e._shape;if(r=tA.removeDuplicatesFromShape(r),!(n.length<2||r.length<3)){p1.computeWindingOrder2D(r)===Em.CLOCKWISE&&r.reverse();var o=rn.fromPoints(r,new rn),a=tA.computePositions(n,r,o,e,!0);return FRe(a,r,o,e._vertexFormat)}};var rv=fL;function Wp(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.vertexData))throw new DeveloperError("EV_MilStd3DLinePrimitive options.vertexData  undefined!");this.ellipsoid=Cesium.defaultValue(e.ellipsoid,Cesium.Ellipsoid.WGS84),this.opaqueAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,translucent:!1,closed:!0}),this.transParentAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,closed:!0}),this.asynchronous=!1,this.isMilitarySymbol=!0,this.symbol=e.symbol,this._vertexData=e.vertexData,this._textureRotationAngle=Cesium.defaultValue(e.textureRotationAngle,0),this._mainLinePositionsWithText=[],this._fillPositionsWithText=[],this._wallPositionsWithText=[],this._mainLinePositions=[],this._fillPositions=[],this._originMainLineColors=[],this._originFillColors=[],this._isAnchorHeightChange=!1,this._minAnchorMarkHeight=0,this._anchorHeight=0,this._isUpdatePrimitive=!1,this.updatePrimitive()}Object.defineProperties(Wp.prototype,{vertexData:{get:function(){return this._vertexData},set:function(e){if(this._vertexData.AlgoTextData)for(var t=0;t<this._vertexData.AlgoTextData.length;t++)delete this._vertexData.AlgoTextData[t].TextColor,delete this._vertexData.AlgoTextData[t].TextIndex,delete this._vertexData.AlgoTextData[t].TextNormal,delete this._vertexData.AlgoTextData[t].TextVertex;if(this._vertexData.WallData)for(var t=0;t<this._vertexData.WallData.length;t++)delete this._vertexData.WallData[t].WallColor,delete this._vertexData.WallData[t].WallIndex,delete this._vertexData.WallData[t].WallNormal,delete this._vertexData.WallData[t].WallVertex;if(this._vertexData.FillData)for(var t=0;t<this._vertexData.FillData.length;t++)delete this._vertexData.FillData[t].FillColor,delete this._vertexData.FillData[t].FillIndex,delete this._vertexData.FillData[t].FillNormal,delete this._vertexData.FillData[t].FillVertex;if(this._vertexData.MainData)for(var t=0;t<this._vertexData.MainData.length;t++)delete this._vertexData.MainData[t].MainColor,delete this._vertexData.MainData[t].MainIndex,delete this._vertexData.MainData[t].MainNormal,delete this._vertexData.MainData[t].MainVertex;this._vertexData=e,this._isUpdatePrimitive=!0}},mainLinePositions:{get:function(){return this._mainLinePositions}}});Wp.prototype.setSurroundLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("surroundLine")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Wp.prototype.setFillColor=function(e){if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];n.indexOf("fill")>-1&&(this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Wp.prototype.setMainLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];if(n.indexOf("mainLine")>-1){var r=new K(e.red*100/255,e.green*100/255,e.blue*100/255,e.alpha);this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(r)}}if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];if(n.indexOf("wall")>-1){var r=new K(e.red,e.green,e.blue,this.symbol.wallTransparent);this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(r)}}};Wp.prototype.updatePrimitive=function(){var e=qRe(this.symbol.positionCartographics);e>700?(this._isUpdatePrimitive=!0,this._isAnchorHeightChange=!0):this._isUpdatePrimitive=!1};Wp.prototype.update=function(e){if(!!this.symbol.show&&!(!this._isUpdatePrimitive&&!Cesium.defined(this._primitive))){if(this._isUpdatePrimitive){this._isUpdatePrimitive=!1,this._primitive=this._primitive&&this._primitive.destroy();var t=VRe(this);this._primitive=new Cesium.Primitive({geometryInstances:t,appearance:this.opaqueAppearance,asynchronous:this.asynchronous}),this._framePrimitive=this._framePrimitive&&this._framePrimitive.destroy();var n=kRe(this);this._framePrimitive=new Cesium.Primitive({geometryInstances:n,appearance:this.transParentAppearance,asynchronous:this.asynchronous})}this._primitive.update(e),this._framePrimitive&&this._framePrimitive.update(e)}};Wp.prototype.isDestroyed=function(){return!1};Wp.prototype.destroy=function(){if(this.vertexData.TextData)for(var e=0;e<this.vertexData.TextData.length;e++)delete this.vertexData.TextData[e].TextColor,delete this.vertexData.TextData[e].TextIndex,delete this.vertexData.TextData[e].TextNormal,delete this.vertexData.TextData[e].TextVertex;if(this.vertexData.FillData)for(var e=0;e<this.vertexData.FillData.length;e++)delete this.vertexData.FillData[e].FillColor,delete this.vertexData.FillData[e].FillIndex,delete this.vertexData.FillData[e].FillNormal,delete this.vertexData.FillData[e].FillVertex;if(this.vertexData.MainData)for(var e=0;e<this.vertexData.MainData.length;e++)delete this.vertexData.MainData[e].MainColor,delete this.vertexData.MainData[e].MainIndex,delete this.vertexData.MainData[e].MainNormal,delete this.vertexData.MainData[e].MainVertex;return this.vertexData=void 0,this._primitive&&(this._primitive.destroy(),this._primitive=void 0),this._framePrimitive&&(this._framePrimitive.destroy(),this._framePrimitive=void 0),Cesium.destroyObject(this)};Wp.prototype.getAnchorHeight=function(){if(this._isAnchorHeightChange){this._isAnchorHeightChange=!1;var e=-1e4,t=1e4;if(Array.isArray(this.symbol.positionCartographics)&&this.symbol.positionCartographics.forEach(r=>{e<r.height&&(e=r.height),t>r.height&&(t=r.height)}),typeof e=="number"&&typeof t=="number"){var n=this.symbol.floatHeight3D*1e3+e;if(typeof n=="number")return this._anchorHeight=n,this._minAnchorMarkHeight=t,n}}else return this._anchorHeight};function nA(e,t){for(var n=new Array(e.length/2),r=0;r<e.length;r+=2){var o=r/2;n[o]=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],t)}return n}var qp=new x;function bee(e,t){for(var n=new Array(e.length/3),r=0;r<e.length;r+=3)qp=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],t,void 0,qp),n[r]=qp.x,n[r+1]=qp.y,n[r+2]=qp.z;return n}function zRe(e,t){for(var n=new Array(e.length/3),r=0;r<e.length;r+=3){var o=0;e[r+2]===0&&(o=t),qp=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],o,void 0,qp),n[r]=qp.x,n[r+1]=qp.y,n[r+2]=qp.z}return n}function VRe(e){e._mainLinePositions=[];var t=[],n=void 0;if(e.vertexData.hasOwnProperty("AlgoTextData")){for(var c=0;c<e._mainLinePositionsWithText.length;c++)delete e._mainLinePositionsWithText[c];e._mainLinePositionsWithText=[];for(var o=0;o<e.vertexData.MainData.length;++o){var f=e.vertexData.MainData[o],h=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._mainLinePositionsWithText[o]=bee(f.MainVertex,h),e._originMainLineColors[o]=new K(f.MainColor[0]/255,f.MainColor[1]/255,f.MainColor[2]/255,f.MainColor[3]/255);var d=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);n=hL(e._mainLinePositionsWithText[o],f.MainIndex,void 0,void 0),t[t.length]=Hp(e,n,"mianLineWithFont"+o,d)}}else if(g(e.vertexData)&&g(e.vertexData.MainData)&&e.symbol.mainLineIsTransparency===!1)for(var r=e.vertexData.MainData.length,o=0;o<r;++o){if(e._mainLinePositions[o]=nA(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight()),e._originMainLineColors.length!==r){var a=e.vertexData.MainData[o].MainColor;e._originMainLineColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.mainLineColor=e._originMainLineColors[0]}var s=Iee(e);n=new rv({polylinePositions:e._mainLinePositions[o],shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,ellipsoid:e.ellipsoid,cornerType:Cesium.CornerType.MITERED});var u;e.symbol.isExternalSetLine&&g(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red*99/255,e.symbol.mainLineColor.green*99/255,e.symbol.mainLineColor.blue*99/255,e.symbol.mainLineColor.alpha):u=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);let p;if(e.symbol.mainLineIsDeepenColor?p=u:e.symbol.isExternalSetLine&&g(e.symbol.mainLineColor)?p=e.symbol.mainLineColor:p=e._originMainLineColors[o],t[t.length]=Hp(e,n,"mainLine"+o,p),e.symbol.surroundLineType==3){var s=Dee(e),l=nA(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=new rv({polylinePositions:l,shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,cornerType:Cesium.CornerType.MITERED,ellipsoid:e.ellipsoid}),t[t.length]=Hp(e,n,"surroundLine"+o,e.symbol.surroundLineColor)}}return t}function kRe(e){var t=[],n=void 0;if(e.vertexData){if(e.vertexData.hasOwnProperty("AlgoTextData")){if(!e.isOnlyDrawMainLine&&e.vertexData.WallData){for(var _=0;_<e._wallPositionsWithText.length;_++)delete e._wallPositionsWithText[_];e._wallPositionsWithText=[];for(var o=0;o<e.vertexData.WallData.length;++o){var y=e.vertexData.WallData[o],v=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._wallPositionsWithText[o]=zRe(y.WallVertex,v);var w=new K(y.WallColor[0]/255,y.WallColor[1]/255,y.WallColor[2]/255,y.WallColor[3]/255);n=hL(e._wallPositionsWithText[o],y.WallIndex,void 0,void 0),t[t.length]=Hp(e,n,"wallWithFont"+o,w)}}if(!e.isOnlyDrawMainLine&&e.vertexData.FillData){for(var _=0;_<e._fillPositionsWithText.length;_++)delete e._fillPositionsWithText[_];e._fillPositionsWithText=[];for(var o=0;o<e.vertexData.FillData.length;++o){var C=e.vertexData.FillData[o],v=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._fillPositionsWithText[o]=bee(C.FillVertex,v);var E=new K(C.FillColor[0]/255,C.FillColor[1]/255,C.FillColor[2]/255,C.FillColor[3]/255);n=hL(e._fillPositionsWithText[o],C.FillIndex,void 0,void 0),t[t.length]=Hp(e,n,"fillWithFont"+o,E)}}if(!e.symbol.isOnlyDrawMainLine&&e.vertexData.AlgoTextData)for(var S=HRe(e.symbol.positionCartographics),v=e.symbol.positionCartographics[0].height+1500,A=Cesium.Cartesian3.fromRadians(S[0],S[1],v),D=URe(A),o=0;o<e.vertexData.AlgoTextData.length;++o){var P=e.vertexData.AlgoTextData[o],M=new K(P.TextColor[0]/255,P.TextColor[1]/255,P.TextColor[2]/255,P.TextColor[3]/255);n=hL(P.TextVertex,P.TextIndex,P.TextNormal),t[t.length]=GRe(e,n,D,"fontWithLine"+o,M)}}else{if(g(e.vertexData)&&g(e.vertexData.MainData&&e.symbol.mainLineIsTransparency!==!1))for(var r=e.vertexData.MainData.length,o=0;o<r;++o){if(e._mainLinePositions[o]=nA(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight()),e._originMainLineColors.length!==r){var a=e.vertexData.MainData[o].MainColor;e._originMainLineColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.mainLineColor=e._originMainLineColors[0]}var s=Iee(e);n=new rv({polylinePositions:e._mainLinePositions[o],shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,ellipsoid:e.ellipsoid,cornerType:Cesium.CornerType.MITERED});var u;e.symbol.isExternalSetLine&&g(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red*99/255,e.symbol.mainLineColor.green*99/255,e.symbol.mainLineColor.blue*99/255,e.symbol.mainLineColor.alpha):u=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);let b;if(e.symbol.mainLineIsDeepenColor?b=u:(e.symbol.isExternalSetLine&&g(e.symbol.mainLineColor)?b=e.symbol.mainLineColor:b=e._originMainLineColors[o],b.alpha=e.symbol.wallTransparent),t[t.length]=Hp(e,n,"mainLine"+o,b),e.symbol.surroundLineType==3){var s=Dee(e),l=nA(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=new rv({polylinePositions:l,shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,cornerType:Cesium.CornerType.MITERED,ellipsoid:e.ellipsoid}),t[t.length]=Hp(e,n,"surroundLine"+o,e.symbol.surroundLineColor)}}if(e.symbol.fillMode===1&&g(e.vertexData.FillData))for(var c=e.vertexData.FillData.length,o=0;o<c;++o){if(e._fillPositions[o]=Cesium.Cartesian3.fromDegreesArray(e.vertexData.FillData[o].FillVertex),e._originFillColors.length!==c){var a=e.vertexData.FillData[o].FillColor;e._originFillColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.fillColor=e._originFillColors[0]}var f=e.symbol.distanceLegend*(e.getAnchorHeight()/1e3);n=Cesium.PolygonGeometry.fromPositions({positions:e._fillPositions[o],height:f,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,stRotation:e._textureRotationAngle,ellipsoid:e.ellipsoid}),e.symbol.isExternalSetFill&&g(e.symbol.fillColor)?t[t.length]=Hp(e,n,"fill"+o,e.symbol.fillColor):t[t.length]=Hp(e,n,"fill"+o,e._originFillColors[o])}if(!e.symbol.isOnlyDrawMainLine&&e.vertexData.MainData)for(var o=0;o<e.vertexData.MainData.length;++o){var h=e.symbol.distanceLegend*(e.getAnchorHeight()/1e3),d=e.symbol.distanceLegend*e._minAnchorMarkHeight/1e3,p=nA(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=Cesium.WallGeometry.fromConstantHeights({positions:p,minimumHeight:d,maximumHeight:h,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL});var u;e.symbol.isExternalSetLine&&g(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red,e.symbol.mainLineColor.green,e.symbol.mainLineColor.blue,e.symbol.wallTransparent):u=new K(e._originMainLineColors[o].red,e._originMainLineColors[o].green,e._originMainLineColors[o].blue,e.symbol.wallTransparent),t[t.length]=Hp(e,n,"wall"+o,u)}}return t}}function Iee(e){return Cesium.Cartesian2.unpackArray([-e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*(e.symbol.topLineHeight-e.symbol.thickness3D),e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*(e.symbol.topLineHeight-e.symbol.thickness3D),e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*e.symbol.topLineHeight,-e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*e.symbol.topLineHeight])}function Dee(e){return Cesium.Cartesian2.unpackArray([-e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*((e.symbol.topLineHeight-e.symbol.thickness3D)*.95),e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*((e.symbol.topLineHeight-e.symbol.thickness3D)*.95),e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*(e.symbol.thickness3D*.01),-e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*(e.symbol.thickness3D*.01)])}function hL(e,t,n,r){var o=void 0;e&&(o=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}));var a=void 0;r&&(a=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}));var s=void 0;return n&&(s=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n})),new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:e?o:void 0,color:r?a:void 0,normal:n?s:void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})}function Hp(e,t,n,r){return r?new Cesium.GeometryInstance({geometry:t,id:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:new Cesium.ColorGeometryInstanceAttribute(r.red,r.green,r.blue,r.alpha)}}):new Cesium.GeometryInstance({geometry:t,id:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0)}})}function GRe(e,t,n,r,o){return new Cesium.GeometryInstance({geometry:t,id:r,modelMatrix:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:new Cesium.ColorGeometryInstanceAttribute(o.red,o.green,o.blue,o.alpha)}})}function URe(e){var t=Cesium.Transforms.headingPitchRollToFixedFrame(e,Cesium.HeadingPitchRoll.fromDegrees(0,0,180)),n=Cesium.Matrix4.multiplyByUniformScale(t,1,new Cesium.Matrix4);return n}function HRe(e){if(e.length>2){for(var t=0,n=0,r=0,o=1;o<=e.length;o++){var a=e[o%e.length].latitude,s=e[o%e.length].longitude,u=e[o-1].latitude,l=e[o-1].longitude,c=(a*l-s*u)*.5;t+=c,n+=c*(a+u)/3,r+=c*(s+l)/3}return n=n/t,r=r/t,[r,n]}else return[(e[0].longitude+e[1].longitude)*.5,(e[0].latitude+e[1].latitude)*.5]}function qRe(e){var t=new Cesium.EllipsoidGeodesic;t.setEndPoints(e[e.length-2],e[e.length-1]);var n=t.surfaceDistance;return n}var dL=Wp;function Tl(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.symbol))throw new Le("EV_MilStd3DMarkerPrimitive options.symbol  undefined!");if(!Cesium.defined(e.vertexData))throw new Le("EV_MilStd3DMarkerPrimitive options.vertexData  undefined!");if(!Cesium.defined(e.camera))throw new Le("EV_MilStd3DMarkerPrimitive options.camera  undefined!");this.symbol=e.symbol,this._vertexData=e.vertexData,this.isMilitarySymbol=!0,this.camera=e.camera,this.appearance=new Cesium.PerInstanceColorAppearance({flat:!0,translucent:!1}),this.frameAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,closed:!0}),this.viewPosition=new Cesium.Cartesian3(0,0,0),this._fixedScale=1,this._startFixedSValue=1,this.modelMatrix=Cesium.Matrix4.IDENTITY.clone(),this.asynchronous=Cesium.defaultValue(e.asynchronous,!1),this.debugShowBoundingVolume=Cesium.defaultValue(e.debugShowBoundingVolume,!1),this._primitive=void 0,this._geometryInstanceId=0,this._originMainLineColors=[],this._originFillColors=[],this._originTextColors=[],this.isWithText=!1,(this.libraryID==32&&(this.code>=1900&&this.code<=1906||this.code>=2e3&&this.code<=2006||this.code>=2100&&this.code<=2106||this.code>=2200&&this.code<=2206||this.code>=2300&&this.code<=2306||this.code>=2400&&this.code<=2406)||this.libraryID==32&&this.code==3||this.libraryID==10&&this.code>=2800&&this.code<=2807)&&(this.isWithText=!0),this._isUpdatePrimitive=!0}Object.defineProperties(Tl.prototype,{vertexData:{get:function(){return this._vertexData},set:function(e){e&&(this._vertexData=e,this._isUpdatePrimitive=!0)}},anchorPosition:{get:function(){var e=this.getAnchorHeight(),t=Cesium.Cartesian3.fromRadians(this.symbol.positionCartographic.longitude,this.symbol.positionCartographic.latitude,e);return t}}});Tl.prototype.setScaleMode=function(e){if(e===0){this.viewPosition=Cesium.Cartesian3.clone(this.camera.position);var t=this.getAnchorHeight(),n=Cesium.Cartesian3.fromRadians(this.symbol.positionCartographic.longitude,this.symbol.positionCartographic.latitude,t);this._startFixedSValue=Cesium.Cartesian3.distance(this.viewPosition,n)}else this._fixedScale=1;this._isUpdatePrimitive=!0};Tl.prototype.setInnerTextColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("innerText")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Tl.prototype.setFillColor=function(e){if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e)}};Tl.prototype.setMainLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("mainLine")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Tl.prototype.updatePrimitive=function(){this._isUpdatePrimitive=!0};Tl.prototype.update=function(e){if(!!this.symbol.show&&!(!this._isUpdatePrimitive&&!Cesium.defined(this._primitive))){if(this._isUpdatePrimitive||Cesium.defined(this.symbol.drawMode)&&this.symbol.drawMode===360||Cesium.defined(this.symbol.scaleMode)&&this.symbol.scaleMode===0){this._isUpdatePrimitive=!1;var t=this.getGeometryInstances();this._primitive=this._primitive&&this._primitive.destroy(),this._primitive=new Cesium.Primitive({geometryInstances:t,appearance:this.appearance,asynchronous:this.asynchronous});var n=this.getTransGeometryInstances();this._framePrimitive=this._framePrimitive&&this._framePrimitive.destroy(),this.getTransGeometryInstances&&(this._framePrimitive=new Cesium.Primitive({geometryInstances:n,appearance:this.frameAppearance,asynchronous:this.asynchronous}))}this._primitive.update(e),this._framePrimitive&&this._framePrimitive.update(e)}};Tl.prototype.getGeometryInstances=function(){if(!!Cesium.defined(this.vertexData)){var e=[],t=this.vertexData,n=null;if(t.TextData)for(var r=0;r<t.TextData.length;r++)t.TextData[r].TextColor.length>0&&(n=Gz(t.TextData[r].TextVertex,t.TextData[r].TextIndex,t.TextData[r].TextNormal),this.symbol.isExternalSetInnertext&&this.symbol.innertextColor?e[e.length]=this.createGeometryInstance(n,"innerText"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.innertextColor)):(this._originTextColors.length===0&&(this._originTextColors[r]=new K(t.TextData[r].TextColor[0]/255,t.TextData[r].TextColor[1]/255,t.TextData[r].TextColor[2]/255,t.TextData[r].TextColor[3]/255),this.symbol.innertextColor=this._originTextColors[0]),e[e.length]=this.createGeometryInstance(n,"innerText"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originTextColors[r]))));if(t.MainData)for(var o=t.MainData.length,r=0;r<o;r++)t.MainData[r].MainColor.length>0&&(n=Gz(t.MainData[r].MainVertex,t.MainData[r].MainIndex,t.MainData[r].MainNormal),this.symbol.isExternalSetLine&&this.symbol.mainLineColor?e[e.length]=this.createGeometryInstance(n,"mainLine"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.mainLineColor)):(this._originMainLineColors.length!==o&&(this._originMainLineColors[r]=new K(t.MainData[r].MainColor[0]/255,t.MainData[r].MainColor[1]/255,t.MainData[r].MainColor[2]/255,t.MainData[r].MainColor[3]/255),this.symbol.mainLineColor=this._originMainLineColors[0]),e[e.length]=this.createGeometryInstance(n,"mainLine"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originMainLineColors[r]))));return e}};Tl.prototype.getTransGeometryInstances=function(){if(!!Cesium.defined(this.vertexData.FillData)){for(var e=[],t=this.vertexData,n=void 0,r=0;r<t.FillData.length;r++)t.FillData&&(n=Gz(t.FillData[r].FillVertex,t.FillData[r].FillIndex,t.FillData[r].FillNormal),this.symbol.isExternalSetFill&&this.symbol.fillColor?e[e.length]=this.createGeometryInstance(n,"fill"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.fillColor)):(this._originFillColors.length===0&&(this._originFillColors[r]=new K(t.FillData[r].FillColor[0]/255,t.FillData[r].FillColor[1]/255,t.FillData[r].FillColor[2]/255,t.FillData[r].FillColor[3]/255),this.symbol.fillColor=this._originFillColors[0]),e[e.length]=this.createGeometryInstance(n,"fill"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originFillColors[r]))));return n=void 0,e}};Tl.prototype.vertexDataInterpolation=function(e){var t=e.data,n=e.sum;if(n%2!==1){var r={FillColor:[],FillIndex:[],FillNormal:[],FillVertex:[]},o=[];if(t[0].FillVertex.forEach(function(c,f){f%3===0&&!o[Math.floor(f/3)]&&(o[Math.floor(f/3)]=[]),o[Math.floor(f/3)].push(c)}),o[0][0]===o[1][0])for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[3][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[3][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[3][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[1][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[1][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[1][2]-o[2][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[2][2])}else for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[1][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[1][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[1][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[3][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[3][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[3][2]-o[3][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[3][2])}delete this.vertexData.FillData[0].FillVertex,this.vertexData.FillData[0].FillVertex=new Float64Array(r.FillVertex.length);for(var a=0;a<r.FillVertex.length;a++)this.vertexData.FillData[0].FillVertex[a]=r.FillVertex[a];delete this.vertexData.FillData[0].FillNormal,this.vertexData.FillData[0].FillNormal=new Float64Array(r.FillNormal.length);for(var a=0;a<r.FillNormal.length;a++)this.vertexData.FillData[0].FillNormal[a]=r.FillNormal[a];delete this.vertexData.FillData[0].FillIndex,this.vertexData.FillData[0].FillIndex=new Int32Array(r.FillIndex.length);for(var a=0;a<r.FillIndex.length;a++)this.vertexData.FillData[0].FillIndex[a]=r.FillIndex[a];delete this.vertexData.FillData[0].FillColor,this.vertexData.FillData[0].FillColor=new Uint8Array(r.FillColor.length);for(var a=0;a<r.FillColor.length;a++)this.vertexData.FillData[0].FillColor[a]=r.FillColor[a]}};Tl.prototype.updateModelMatrix=function(){var e=this.anchorPosition,t=null;if((!Cesium.defined(this.camera.heading)||!Cesium.defined(this.camera.pitch))&&(this.symbol.drawMode=0),this.symbol.drawMode===360){var n=Cesium.Transforms.headingPitchRollToFixedFrame(e,new Cesium.HeadingPitchRoll(this.camera.heading,0,this.camera.pitch+Math.PI*.5));t=Cesium.Matrix4.multiplyByMatrix3(n,Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(parseFloat(this.symbol.rotate)),new Cesium.Matrix3),new Cesium.Matrix4)}else t=Cesium.Transforms.headingPitchRollToFixedFrame(e,Cesium.HeadingPitchRoll.fromDegrees(parseFloat(this.symbol.rotate),0,this.symbol.drawMode));if(Cesium.defined(this.symbol.scaleMode)&&this.symbol.scaleMode===0&&!Cesium.Cartesian3.equals(this.viewPosition,this.camera.position)){var r=Cesium.Cartesian3.distance(this.camera.position,e);this._fixedScale=r/this._startFixedSValue}var o=Number(this.symbol.scale)*Number(this.symbol.distanceLegend)*this._fixedScale/1e5;this.modelMatrix=Cesium.Matrix4.multiplyByUniformScale(t,o,new Cesium.Matrix4)};Tl.prototype.createGeometryInstance=function(e,t,n){return this.updateModelMatrix(),n?new Cesium.GeometryInstance({geometry:e,modelMatrix:this.modelMatrix,pickPrimitive:this,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:n},id:t}):new Cesium.GeometryInstance({geometry:e,modelMatrix:this.modelMatrix,pickPrimitive:this,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0)},id:t})};Tl.prototype.isDestroyed=function(){return!1};Tl.prototype.destroy=function(){if(this.vertexData.TextData)for(var e=0;e<this.vertexData.TextData.length;e++)delete this.vertexData.TextData[e].TextColor,delete this.vertexData.TextData[e].TextIndex,delete this.vertexData.TextData[e].TextNormal,delete this.vertexData.TextData[e].TextVertex;if(this.vertexData.FillData)for(var e=0;e<this.vertexData.FillData.length;e++)delete this.vertexData.FillData[e].FillColor,delete this.vertexData.FillData[e].FillIndex,delete this.vertexData.FillData[e].FillNormal,delete this.vertexData.FillData[e].FillVertex;if(this.vertexData.MainData)for(var e=0;e<this.vertexData.MainData.length;e++)delete this.vertexData.MainData[e].MainColor,delete this.vertexData.MainData[e].MainIndex,delete this.vertexData.MainData[e].MainNormal,delete this.vertexData.MainData[e].MainVertex;return this.vertexData=void 0,this._primitive&&(this._primitive.destroy(),this._primitive=void 0),this._framePrimitive&&(this._framePrimitive.destroy(),this._framePrimitive=void 0),Cesium.destroyObject(this)};Tl.prototype.getAnchorHeight=function(){var e=0;return this.symbol.drawMode==0?e=this.symbol.floatHeight3D*1e3:e=this.vertexData.distance*10*this.symbol.scale+this.symbol.floatHeight3D*1e3,e+this.symbol.positionCartographic.height};function Gz(e,t,n,r){return r?new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),color:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}),normal:n?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n}):void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)}):new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),normal:n?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n}):void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})}var pL=Tl;var Pee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sKHAksBNXfIvIAAADGSURBVBjTlZC9DsFgFIafWsQgDE0vwGBjNVjNdYl1BYYmbkDim0yMEotFooNEW+Wjr6GfpCQG73J+nmc5B/6I924kNYEh0APawAXYAxvP827URUlTSZGkg6S7q5HbN+vySNJM0lOfebr9CKABUBRFH5i851oawMTxCuZ53gGCH3cFjldymqYZcPohnxyv5CzLdsASKL/EElg6XsnW2rUxZgHMgSPwcHVujFlYa9cff47juJUkyRgYAF3gDGx931+FYXjl37wANeOE+Ghv1/sAAAAASUVORK5CYII=";function ua(e,t,n){if(!Cesium.defined(e))throw new DeveloperError("scene of options  must be defined");this._scene=e,this._billboards=new Cesium.BillboardCollection,this._primitives=n||this._scene.primitives,this._primitives.add(this._billboards),this._orderedBillboards=[],this.billboards=[],this.ellipsoid=e.globe.ellipsoid,this.scale=t,this.distanceHeigh=void 0}function g1(e,t,n){e[t]=n}ua.prototype.createBillboard=function(e,t,n){var r=this.getAnchorPosition(e,t),o=this._billboards.add({show:!0,position:r,eyeOffset:new Cesium.Cartesian3(0,0,-2e3),horizontalOrigin:0,verticalOrigin:0,scale:this.scale,image:Pee,color:new Cesium.Color(1,1,0,1)});if(n){var a=this,s=a._scene.screenSpaceCameraController;if(n.dragHandlers){var a=this;g1(o,"leftDown",function(l){function c(d){var p=a.getAnchorPosition(d);o.position=p;for(var _=a._orderedBillboards.length,y=0;y<_&&a._orderedBillboards[y]!=o;++y);n.dragHandlers.onDrag&&n.dragHandlers.onDrag(Yp(a,o),d)}function f(d){h.destroy(),s.enableRotate=!0,s.enableTranslate=!0,n.dragHandlers.onDragEnd&&n.dragHandlers.onDragEnd(Yp(a,o),d)}var h=new Cesium.ScreenSpaceEventHandler(a._scene.canvas);h.setInputAction(function(d){f(a._scene.globe.pick(a._scene.camera.getPickRay(d.position),a._scene))},Cesium.ScreenSpaceEventType.LEFT_UP),h.setInputAction(function(d){var p=a._scene.globe.pick(a._scene.camera.getPickRay(d.endPosition),a._scene);p?c(p):f(p)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),h._buttonDown[0]=!0,s.enableRotate=!1,s.enableTranslate=!1,n.dragHandlers.onDragStart&&n.dragHandlers.onDragStart(Yp(a,o),a._scene.globe.pick(a._scene.camera.getPickRay(l),a._scene))})}n.onDoubleClick&&g1(o,"leftDoubleClick",function(u){n.onDoubleClick(Yp(a,o))}),n.onClick&&g1(o,"leftClick",function(u){n.onClick(Yp(a,o))})}return o};function Yp(e,t){for(var n=e._orderedBillboards.length,r=0;r<n&&e._orderedBillboards[r]!=t;++r);return r}ua.prototype.insertBillboard=function(e,t,n){this._orderedBillboards.splice(e,0,this.createBillboard(t,n))};ua.prototype.addBillboard=function(e,t,n){var r=this.createBillboard(e,t,n);return r.isMilitaryAnchor=!0,this._orderedBillboards.push(r),r};ua.prototype.addBillboards=function(e,t,n){for(var r=0;r<e.length;r++)this.addBillboard(e[r],t,n)};ua.prototype.updateBillboardsPositions=function(e){for(var t=0;t<e.length;t++)this.getBillboard(t).position=e[t]};ua.prototype.updateBillboardPosition=function(e,t,n){var r=this.getAnchorPosition(t,n);this.getBillboard(e).position=r};ua.prototype.updateBillboardsHeight=function(e){for(var t=this._orderedBillboards.length,n=0;n<t;n++){var r=this._orderedBillboards[n].position;this._orderedBillboards[n].position=this.getAnchorPosition(r,e)}};ua.prototype.countBillboards=function(){return this._orderedBillboards.length};ua.prototype.getBillboard=function(e){return this._orderedBillboards[e]};ua.prototype.removeBillboard=function(e){this._billboards.remove(this.getBillboard(e)),this._orderedBillboards.splice(e,1)};ua.prototype.removeAllBillboards=function(){this._billboards.removeAll(),this._orderedBillboards=[],this._anchorHeight=0};ua.prototype.remove=function(){this._billboards.removeAll(),this._primitives.remove(this._billboards)};ua.prototype.setOnTop=function(){this._primitives.raiseToTop(this._billboards)};ua.prototype.destroy=function(){this._billboards.destroy()};ua.prototype.getAnchorPosition=function(e,t){t&&(this._anchorHeight=t);var n;if(e instanceof Cesium.Cartesian3){var r=Cesium.Cartographic.fromCartesian(e);n=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,this._anchorHeight)}else e instanceof Cesium.Cartographic&&(n=Cesium.Cartesian3.fromRadians(e.longitude,e.latitude,this._anchorHeight));return n};ua.prototype.changeBillboardColor=function(e,t){let n=this.getBillboard(e);n.color=t};ua.prototype.myCreatedBillboard=function(e,t,n){let r=this._billboards.add({id:e,show:!0,position:t,eyeOffset:new Cesium.Cartesian3(0,0,-2e3),horizontalOrigin:0,verticalOrigin:0,scale:this.scale,image:Pee,color:new Cesium.Color(1,1,0,1)});if(n){let a=this._scene.screenSpaceCameraController;if(n.dragHandlers){var o=this;g1(r,"leftDown",function(s){function u(f){var h=o.getAnchorPosition(f);r.position=h;for(var d=o._orderedBillboards.length,p=0;p<d&&o._orderedBillboards[p]!=r;++p);n.dragHandlers.onDrag&&n.dragHandlers.onDrag(Yp(o,r),f)}function l(f){c.destroy(),a.enableRotate=!0,a.enableTranslate=!0,n.dragHandlers.onDragEnd&&n.dragHandlers.onDragEnd(Yp(o,r),f)}var c=new Cesium.ScreenSpaceEventHandler(o._scene.canvas);c.setInputAction(function(f){l(o._scene.globe.pick(o._scene.camera.getPickRay(f.position),o._scene))},Cesium.ScreenSpaceEventType.LEFT_UP),c.setInputAction(function(f){var h=o._scene.globe.pick(o._scene.camera.getPickRay(f.endPosition),o._scene);h?u(h):l(h)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),c._buttonDown[0]=!0,a.enableRotate=!1,a.enableTranslate=!1,n.dragHandlers.onDragStart&&n.dragHandlers.onDragStart(Yp(o,r),o._scene.globe.pick(o._scene.camera.getPickRay(s),o._scene))})}n.onDoubleClick&&g1(r,"leftDoubleClick",function(s){n.onDoubleClick(Yp(o,r))}),n.onClick&&g1(r,"leftClick",function(s){n.onClick(Yp(o,r))})}return r};ua.prototype.myAddBillboard=function(e,t,n){if(Cesium.defined(t)){Cesium.defined(e)||(e=Cesium.createGuid());let r=this.myCreatedBillboard(e,t,n);return this.billboards[e]=r,r}};ua.prototype.myGetBillboard=function(e){if(Cesium.defined(e))return this.billboards[e]};ua.prototype.myRemoveBillboard=function(e){Cesium.defined(e)&&(this._billboards.remove(this.myGetBillboard(e)),delete this.billboards[e])};ua.prototype.myRemoveAllBillboard=function(){for(let e in this.billboards)this.billboards.hasOwnProperty.call(this.billboards,e)&&this.myRemoveBillboard(e)};ua.prototype.myChangeBillboardColor=function(e,t){let n=this.myGetBillboard(e);n.color=t};ua.prototype.myChangeBillboardPosition=function(e,t){let n=this.myGetBillboard(e);n.position=t};var iv=ua;function rr(e){this.viewer=e.viewer,this._plottingService=e.plottingService,this._drawState=0,this.milStdAnchorCollection=new iv(this.viewer.scene,1.5,this._primitiveCollection),this.editingSymbolId=void 0,this.symbols=new Ga,ZRe(this),this._leftDown=new xe,this._rightDown=new xe,this._draggingAnchor=new xe,this._endDragAnchor=new xe,this.viewer.scene.primitives.add(this),this._copyVertexDataState=!1,this._vertexDataObjs={},this._sameVertexInfoObjs={}}rr.prototype.createRenderSymbol=function(e,t){var n=e.symbol.type,r=e.vertexData,o=this.viewer.scene.camera,a=void 0;switch(n){case 0:{a=new pL({viewer:this.viewer,camera:o,symbol:e.symbol,vertexData:r});break}case 1:{a=new dL({viewer:this.viewer,vertexData:r,symbol:e.symbol});break}default:break}this.symbols.set(a.symbol.id,a),t(a.symbol.id)};rr.prototype.getSymbol=function(e){return g(e)||console.error("EV_MilStd3DRenderManager methods 'getSymbol' parameter 'symbolId' error !"),this.symbols.get(e)};rr.prototype.removeSymbol=function(e){this.editingSymbolId===e&&(this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=void 0);var t=this.getSymbol(e);this.symbols.remove(e),t.destroy()};rr.prototype.removeAllSymbol=function(){this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=void 0;for(var e=0;e<this.symbols.length;e++)this.symbols.values[e].destroy();this.symbols.removeAll()};rr.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.getSymbol(e);n.updatePrimitive();var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t,r)};rr.prototype.setMarkSymbolMainLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setMainLineColor(t)};rr.prototype.setMarkSymbolFillColor=function(e,t){var n=this.getSymbol(e);n&&n.setFillColor(t)};rr.prototype.updateMarkSymbolFloatHeight3D=function(e){var t=this.getSymbol(e);if(t){t.updatePrimitive();var n=t.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t.symbol.positionCartographic,n)}};rr.prototype.updateMarkSymbolRotate=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.updateMarkSymbolScale=function(e){var t=this.getSymbol(e);if(t){t.updatePrimitive();var n=t.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t.symbol.positionCartographic,n)}};rr.prototype.updateMarkSymbolDrawMode=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.setMarkSymbolScaleMode=function(e,t){var n=this.getSymbol(e);if(n){n.setScaleMode(t);var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,n.symbol.positionCartographic,r)}};rr.prototype.setMarkSymbolInnerText=function(e,t){var n=this.getSymbol(e);n&&_1({libraryID:n.symbol.libraryID,code:n.symbol.code,type:n.symbol.type,mainLineColor:n.symbol.isExternalSetLine?n.symbol.mainLineColor:void 0,fillMode:1,fillColor:n.symbol.isExternalSetFill?n.symbol.fillColor:void 0,innerText:t||"",positionCartographics:n.symbol.positionCartographics,plottingService:this._plottingService}).then(function(r){n&&(n.vertexData=r)})};rr.prototype.setInnerTextColor=function(e,t){var n=this.getSymbol(e);n&&n.setInnerTextColor(t)};rr.prototype.setLineSymbolPositionCartographics=function(e,t){var n=this.getSymbol(e);if(n){n.updatePrimitive();var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardsHeight(r),_1({id:e,libraryID:n.symbol.libraryID,code:n.symbol.code,type:n.symbol.type,mainLineColor:n.symbol.isExternalSetLine?n.symbol.mainLineColor:void 0,fillMode:1,fillColor:n.symbol.isExternalSetFill?n.symbol.fillColor:void 0,innerText:"",positionCartographics:t,plottingService:this._plottingService}).then(function(o){n.vertexData=o})}};rr.prototype.updateLineSymbolMainLineWidth=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.setLineSymbolMainLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setMainLineColor(t)};rr.prototype.setLineSymbolFillColor=function(e,t){var n=this.getSymbol(e);n&&n.setFillColor(t)};rr.prototype.updateLineSymbolSurroundLineType=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.setLineSymbolSurroundLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setSurroundLineColor(t)};rr.prototype.updateLineSymbolSurroundLineWidth=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.updateLineSymbolFillMode=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.updateLineSymbolFloatHeight3D=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.updateLineSymbolThickness3D=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.updateLineSymbolWallTransparent=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};rr.prototype.update=function(e){for(var t=0;t<this.symbols.length;t++)this.symbols.values[t].update(e)};rr.prototype.getDrawPositions=function(e,t){switch(e){case 0:WRe(this,t);break;case 1:YRe(this,t);break;default:throw destroy,new Cesium.DeveloperError("\u519B\u6807\u7C7B\u578B\u672A\u5B9A\u4E49")}};rr.prototype.isDestroyed=function(){return!1};rr.prototype.destroy=function(){return this.symbols=void 0,this._leftDown=void 0,this._rightDown=void 0,this._draggingAnchor=void 0,this._endDragAnchor=void 0,this._vertexDataObjs=void 0,this._sameVertexInfoObjs=void 0,this.viewer.scene.primitives.remove(this),Cesium.destroyObject(this)};function WRe(e,t){if(!e._drawState){e.startDrawing(function(){n&&n.destroy()}),e._drawState=!0;var n=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);n.setInputAction(function(r){if(!Cesium.defined(r.position)){console.error("EV_MilStd3DRenderManager function 'startDrawPointSymbol' get position error"),e.stopDrawing(),e.setDrawState(!1);return}var o;if(e.viewer.scene.mode!==2){var a=e.viewer.camera.getPickRay(r.position),s=e.viewer.scene.globe.pick(a,e.viewer.scene);o=Cesium.Cartographic.fromCartesian(s)}else{var s=e.viewer.scene.camera.pickEllipsoid(r.position);o=Cesium.Cartographic.fromCartesian(s)}if(!Cesium.defined(o)){console.error("EV_MilStd3DRenderManager function 'startDrawPointSymbol' get position error"),stopDraw();return}e.stopDrawing(),e.setDrawState(!1),t([o])},Cesium.ScreenSpaceEventType.LEFT_CLICK)}}function YRe(e,t){if(!e._drawState){e.startDrawing(function(){n.destroy()}),e._drawState=!0;var n=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas),r=[],o=!1;e._isDrawFile=!0,n.setInputAction(function(a){if(!Cesium.defined(a.position)){console.error("EV_MilStd3DRenderManager function 'startDrawLineSymbol' get position error"),e.stopDrawing(),e.setDrawState(!1);return}if(Cesium.defined(a.position)){var s;if(e.viewer.scene.mode!==2){var u=e.viewer.camera.getPickRay(a.position),l=e.viewer.scene.globe.pick(u,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(l)}else{var l=e.viewer.scene.camera.pickEllipsoid(a.position);s=Cesium.Cartographic.fromCartesian(l)}if(!Cesium.defined(s)){console.error("EV_MilStd3DRenderManager function 'startDrawLineSymbol' get position error"),stopDraw();return}s&&(r.length===0?(r.push(s),t(r),r.push(s)):(r.push(s),t(r)),o=!0)}},Cesium.ScreenSpaceEventType.LEFT_CLICK),n.setInputAction(function(a){if(o){var s;if(e.viewer.scene.mode!==2){var u=e.viewer.camera.getPickRay(a.endPosition),l=e.viewer.scene.globe.pick(u,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(l)}else{var l=e.viewer.scene.camera.pickEllipsoid(a.endPosition);s=Cesium.Cartographic.fromCartesian(l)}r.pop(),r.push(s),t(r)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction(function(a){if(Cesium.defined(a.position)){e.stopDrawing(),e.setDrawState(!1);var s;if(e.viewer.scene.mode!==2){var l=e.viewer.camera.getPickRay(a.position),u=e.viewer.scene.globe.pick(l,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(u)}else{var u=e.viewer.scene.camera.pickEllipsoid(a.position);s=Cesium.Cartographic.fromCartesian(u)}var l=e.viewer.camera.getPickRay(a.position),c=e.viewer.scene.globe.pick(l,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(c),s&&(r.pop(),r.push(s),e.setLineSymbolPositionCartographics(e.editingSymbolId,r))}},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}}rr.prototype.drawByPositions=function(e,t,n){if(g(e)){var r=e.type;r===0?XRe(this,e,t,function(o){n(o)}):r===1?jRe(this,e,t,function(o){n(o)}):console.error("'EV_MilStd3DRenderManager' method 'drawByPositions' parameter 'type' error!")}};function XRe(e,t,n,r){var o=t.libraryID,a=t.code,s=t.type,u=[t.positionCartographic],l=e._plottingService,c=t.isExternalSetLine,f=t.isExternalSetFill;if(!e._copyVertexDataState)_1({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(h){e.createRenderSymbol({symbol:t,vertexData:h},function(d){r(d)})});else{let h=o+"_"+a,d=e._vertexDataObjs[h];d&&Object.keys(d.MainData[0]).length===0&&(delete e._vertexDataObjs[h],e._sameVertexInfoObjs[h]&&delete e._sameVertexInfoObjs[h]),e._vertexDataObjs[h]?Object.keys(d.MainData[0]).length>0&&e.drawByVertexData(t,d,r):(e._sameVertexInfoObjs[h]||(e._sameVertexInfoObjs[h]=[]),e._sameVertexInfoObjs[h].push(t),e._sameVertexInfoObjs[h].length===1&&_1({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(p){(o==32&&(a>=1900&&a<=1906||a>=2e3&&a<=2006||a>=2100&&a<=2106||a>=2200&&a<=2206||a>=2300&&a<=2306||a>=2400&&a<=2406)||o==32&&a==3||o==10&&a>=2800&&a<=2807)&&p.FillData&&Lee(p),e._vertexDataObjs[h]=p;let _=0,y=e._sameVertexInfoObjs[h],v=y.length;for(;_<v;){let w=y[_];w.vertexData=p,e.drawByVertexData(e._sameVertexInfoObjs[h][_],p,r),_++}}))}}rr.prototype.turnOnUseSameVertexDrawing=function(){this._copyVertexDataState=!0};rr.prototype.initUseSameVertexDrawing=function(){this._vertexDataObjs={},this._sameVertexInfoObjs={}};rr.prototype.turnOffUseSameVertexDrawing=function(){this.initUseSamevertexDrawing(),this._copyVertexDataState=!1};rr.prototype.startDrawing=function(e){this.milStdAnchorCollection&&this.milStdAnchorCollection.removeAllBillboards(),this.editCleanUp&&typeof this.editCleanUp=="function"&&this.editCleanUp(),this.editCleanUp=e};rr.prototype.stopDrawing=function(){this.editCleanUp&&(this.editCleanUp(),this.editCleanUp=null)};rr.prototype.setDrawState=function(e){this._drawState=e};function jRe(e,t,n,r){var o=t.libraryID,a=t.code,s=t.type,u=t.positionCartographics,l=e._plottingService,c=t.isExternalSetLine,f=t.isExternalSetFill,h=t.isisExternalSetInnertext;if(!e._copyVertexDataState)_1({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:h?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(d){e.createRenderSymbol({vertexData:d,symbol:t},function(p){r(p)})});else{let d=o+"_"+a,p=e._vertexDataObjs[d];p&&Object.keys(p.MainData[0]).length===0&&(delete e._vertexDataObjs[d],e._sameVertexInfoObjs[d]&&delete e._sameVertexInfoObjs[d]),e._vertexDataObjs[d]||(e._sameVertexInfoObjs[d]||(e._sameVertexInfoObjs[d]=[]),e._sameVertexInfoObjs[d].push(t),e._sameVertexInfoObjs[d].length===1&&_1({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(_){(o==32&&(a>=1900&&a<=1906||a>=2e3&&a<=2006||a>=2100&&a<=2106||a>=2200&&a<=2206||a>=2300&&a<=2306||a>=2400&&a<=2406)||o==32&&a==3||o==10&&a>=2800&&a<=2807)&&_.FillData&&Lee(_),e._vertexDataObjs[d]=_;let y=0,v=e._sameVertexInfoObjs[d],w=v.length,C=new Array(w),E=new Array(w),S=new Array(w),A=new Array(w);for(;y<w;){if(y===0)C[0]=void 0;else{let D=v[y],P=v[0],M=(D.positionCartographics[0].longitude-P.positionCartographics[0].longitude)*180/Math.PI,b=(D.positionCartographics[0].latitude-P.positionCartographics[0].latitude)*180/Math.PI;C[y]={lonDiff:M,latDiff:b}}y++}C.forEach((D,P)=>{if(D){let M=_.MainData;S[P]=[],M.forEach((O,m)=>{if(O){let I=O.MainVertex,L=I.length;S[P][m]=new Float64Array(L);for(let R=0;R<L;R=R+2)S[P][m][R]=I[R]+D.lonDiff,S[P][m][R+1]=I[R+1]+D.latDiff}});let b=_.FillData;b&&(A[P]=[],b.forEach((O,m)=>{if(O){let I=O.FillVertex,L=I.length;A[P][m]=new Float64Array(L);for(let R=0;R<L;R=R+3)A[P][m][q]=I[q]+D.lonDiff,A[P][m][q+1]=I[q+1]+D.latDiff}})),E[P]=KRe(_),E[P].MainData.forEach((O,m)=>{O&&O.MainVertex&&(O.MainVertex=S[P][m])}),E[P].FillVertex&&E[P].FillData.forEach((O,m)=>{P>0&&O&&O.FillVertex&&(O.FillVertex=A[P][m])})}else E[P]=_}),E.forEach((D,P)=>{e.drawByVertexData(e._sameVertexInfoObjs[d][P],D,r)})}))}}function KRe(e){let t={};if(e.MainData){let n=e.MainData;t.MainData=[],n.forEach(r=>{t.MainData.push({MainColor:Uint8Array.from(r.MainColor),MainIndex:Int32Array.from(r.MainIndex),MainNormal:Float64Array.from(r.MainNormal),MainVertex:Float64Array.from(r.MainVertex)})})}if(e.FillData){let n=e.FillDatas;t.FillData=[],n.forEach(r=>{t.FillData.push({FillColor:Uint8Array.from(r.FillColor),FillIndex:Int32Array.from(r.FillIndex),FillNormal:Float64Array.from(r.FillNormal),FillVertex:Float64Array.from(r.FillVertex)})})}return e.code&&(t.code=e.code),t.distance=void 0,t}rr.prototype.drawByVertexData=function(e,t,n){this.createRenderSymbol({symbol:e,vertexData:t},function(r){n(r)})};rr.prototype.setEditingSymbol=function(e){if(this.editingSymbolId!==e&&(this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=e,g(e))){var t=this;this.anchorChangeCallBacksObj={dragHandlers:{onDrag:function(a,s){var u=t.getSymbol(t.editingSymbolId);if(u){var l=Cesium.Cartographic.fromCartesian(s);u.symbol.type===0?t._draggingAnchor.raiseEvent(u.symbol.id,l):u.symbol.type===1&&(u.symbol.positionCartographics[a]=l,t._draggingAnchor.raiseEvent(u.symbol.id,u.symbol.positionCartographics,a))}},onDragEnd:function(a,s){var u=t.getSymbol(t.editingSymbolId);if(u){var l=Cesium.Cartographic.fromCartesian(s);u.symbol.type===0?t._endDragAnchor.raiseEvent(u.symbol.id,l):u.symbol.type===1&&(u.symbol.positionCartographics[a]=l,t._endDragAnchor.raiseEvent(u.symbol.id,u.symbol.positionCartographics,a))}}}};var n=t.getSymbol(t.editingSymbolId),r=n.getAnchorHeight(),o=[];n.symbol.type===0?o.push(n.symbol.positionCartographic):n.symbol.type===1&&(o=n.symbol.positionCartographics),this.milStdAnchorCollection.addBillboards(o,r,this.anchorChangeCallBacksObj)}};function _1(e){var t=e.libraryID,n=e.code,r=e.type,o=e.mainLineColor,a=e.fillMode,s=e.fillColor,u=e.innerText||"",l=e.positionCartographics,c=e.plottingService,f=e.id,h="{";if(u&&(h+='"InnerText" : "'+u+'",'),o&&(h+='"MainLineColor" : "'+Mee(o)+'",'),a&&(h+='"FillMode" : "'+a+'",'),s&&(h+='"FillColor" : "'+Mee(s)+'",'),h+='"Positions":"',l)for(var d=0;d<l.length;++d)h+=Cesium.Math.toDegrees(l[d].longitude)+","+Cesium.Math.toDegrees(l[d].latitude)+","+l[d].height+";";h+='"}';var p=Cesium.defer();if(c){var _={id:f,libraryID:t,symbolID:n,markType:r,symbolSpecialInfo:h};c.getSymbolMeshData(_,function(y){y&&p.resolve(y)})}return p.promise}function ZRe(e){var t=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);t.setInputAction(function(r){n("leftDown",r.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(function(r){n("rightDown",r.position)},Cesium.ScreenSpaceEventType.RIGHT_DOWN);function n(r,o){if(!e._drawState){var a=e.viewer.scene.pick(o),s;a?(s=a.primitive,s&&s.isMilitarySymbol?r==="leftDown"?e._leftDown.raiseEvent(s.symbol.id):r==="rightDown"&&e._rightDown.raiseEvent(s.symbol.id,o):s&&s.isMilitaryAnchor&&s[r]&&s[r](a.primitive,o)):r==="leftDown"?e._leftDown.raiseEvent(void 0):r==="rightDown"&&e._rightDown.raiseEvent(void 0,o)}}}function Lee(e){var t=e.FillData,n=50;if(n%2!==1){var r={FillColor:[],FillIndex:[],FillNormal:[],FillVertex:[]},o=[];if(t[0].FillVertex.forEach(function(c,f){f%3===0&&!o[Math.floor(f/3)]&&(o[Math.floor(f/3)]=[]),o[Math.floor(f/3)].push(c)}),o[0][0]===o[1][0])for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[3][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[3][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[3][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[1][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[1][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[1][2]-o[2][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[2][2])}else for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[1][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[1][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[1][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[3][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[3][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[3][2]-o[3][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[3][2])}delete t[0].FillVertex,t[0].FillVertex=new Float64Array(r.FillVertex.length);for(var a=0;a<r.FillVertex.length;a++)t[0].FillVertex[a]=r.FillVertex[a];delete t[0].FillNormal,t[0].FillNormal=new Float64Array(r.FillNormal.length);for(var a=0;a<r.FillNormal.length;a++)t[0].FillNormal[a]=r.FillNormal[a];delete t[0].FillIndex,t[0].FillIndex=new Int32Array(r.FillIndex.length);for(var a=0;a<r.FillIndex.length;a++)t[0].FillIndex[a]=r.FillIndex[a];delete t[0].FillColor,t[0].FillColor=new Uint8Array(r.FillColor.length);for(var a=0;a<r.FillColor.length;a++)t[0].FillColor[a]=r.FillColor[a]}}function Mee(e){if(!!e){var t=parseInt((e.alpha||1)*255),n=parseInt(e.red*255),r=parseInt(e.green*255),o=parseInt(e.blue*255),a=n<<24|r<<16|o<<8|t;return a>>>0}}var mL=rr;function Md(e){g(e.viewer)||console.error("'EV_MilStdActionDeduce' parameter 'options.viewer' error !"),this.viewer=e.viewer,this.dudeceGeometry={},this.allSymbol={},this.action={},this.actionGroup={},this.actionTreeData=[],this.defaultActionAttri={startTime:"0",durationTime:"5",isPlayEndReset:0,blinkInterval:1,rotateType:1,routeBindGuid:-1,isVisibleRoute:0,rotateCorrect:0,moveType:1},this.actionIndex=0}Md.prototype.clickAddAction=function(e){let t=new Date().getTime().toString(),n=t.replace(t.slice(3,6),"");switch(this.action={_actionGuid:n,_symbolGuid:this.dudeceGeometry.id,actionAttr:{_startTime:this.defaultActionAttri.startTime,_durationTime:this.defaultActionAttri.durationTime,_isPlayEndReset:this.defaultActionAttri.isPlayEndReset,_type:e},othersAttri:{actionName:void 0,playinAttrigName:void 0},specialAttri:[],valueResetFlag:!0},e){case 1:this.action.actionAttr.actionBlinkInterval={_blinkInterval:this.defaultActionAttri.blinkInterval},this.action.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:this.action.actionAttr.actionRotateType={_rotateType:this.defaultActionAttri.rotateType},this.action.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:this.action.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:this.action.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:this.action.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:this.action.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:this.action.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:this.action.actionAttr.actionRouteBindGuid={routeBindGuid:this.defaultActionAttri.routeBindGuid},this.action.actionAttr.actionVisibleRoute={isVisibleRoute:this.defaultActionAttri.isVisibleRoute},this.action.actionAttr.actionRotateRoute={rotateCorrect:this.defaultActionAttri.rotateCorrect},this.action.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:this.action.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},this.action.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:this.action.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:this.action.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:this.action.othersAttri={actionName:"\u64E6\u5165"};break;case 13:this.action.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("tpye erro!")}this.actionGroup[this.action._actionGuid]=this.action,this.actionTreeData.push({label:`${this.action.othersAttri.actionName}-${this.dudeceGeometry.name}`,index:this.actionIndex,type:e,actionGuid:this.action._actionGuid,width:this.action.actionAttr._durationTime*15+30,left:0}),this.actionIndex++};Md.prototype.openAddAction=function(e){let t;for(let n=0;n<e.length;n++){switch(t=e[n],this.action={_actionGuid:t._ActionGuid,_symbolGuid:t._SymbolGuid,actionAttr:{_startTime:t.ActionAttr._StartTime,_durationTime:t.ActionAttr._DurationTime,_isPlayEndReset:t.ActionAttr._IsPlayEndReset,_type:t.ActionAttr._Type*1},othersAttri:{actionName:void 0},specialAttri:[],valueResetFlag:!0},this.action.actionAttr._type){case 1:this.action.actionAttr.actionBlinkInterval={_blinkInterval:t.ActionAttr.ActionBlinkInterval._BlinkInterval},this.action.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:this.action.actionAttr.actionRotateType={_rotateType:t.ActionAttr.ActionRotateType._RotateType},this.action.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:this.action.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:this.action.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:this.action.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:this.action.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:this.action.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:this.action.actionAttr.actionRouteBindGuid={routeBindGuid:t.ActionAttr.ActionRouteBindGuid._RouteBindGuid},g(t.ActionAttr.ActionVisibleRoute)&&(this.action.actionAttr.actionVisibleRoute={isVisibleRoute:t.ActionAttr.ActionVisibleRoute._IsVisibleRoute}),g(t.ActionAttr.ActionRotateRoute)&&(this.action.actionAttr.actionRotateRoute={rotateCorrect:t.ActionAttr.ActionRotateRoute._RotateCorrect}),this.action.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:this.action.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},this.action.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:this.action.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:this.action.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:this.action.othersAttri={actionName:"\u64E6\u5165"};break;case 13:this.action.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("tpye erro!")}this.actionGroup[this.action._actionGuid]=this.action;let r=this.getGeometry(this.action._symbolGuid),o;r&&(o=r.name),this.actionTreeData.push({label:`${this.action.othersAttri.actionName}-${o}`,index:n,type:this.action.actionAttr._type,actionGuid:this.action._actionGuid,width:this.action.actionAttr._durationTime*15+30,left:this.action.actionAttr._startTime*15})}};Md.prototype.getTimerEndTime=function(){let e=0;if(Object.keys(this.actionGroup).length===0)return 5;for(let t in this.actionGroup)if(this.actionGroup.hasOwnProperty(t)){let n=this.actionGroup[t],r=n.actionAttr._startTime*1+n.actionAttr._durationTime*1;r>e&&(e=r)}return e};Md.prototype.resetDurationTime=function(e){if(Object.keys(this.actionGroup).length!==0){for(let t in this.actionGroup)if(this.actionGroup.hasOwnProperty(t)){let n=this.actionGroup[t];e===2?n.actionAttr._durationTime=n.actionAttr._durationTime/2:e===.5?n.actionAttr._durationTime=n.actionAttr._durationTime*2:console.error("\u500D\u901F\u7684\u53C2\u6570\u9519\u8BEF")}}};Md.prototype.getPalyActions=function(e){let t=[];for(let n in this.actionGroup)if(this.actionGroup.hasOwnProperty(n)){let r=this.actionGroup[n];e>r.actionAttr._startTime*1e3&&e<=r.actionAttr._startTime*1e3+r.actionAttr._durationTime*1e3&&t.push(r)}return t};Md.prototype.playAction=function(e,t){let n,o=this;a(0);function a(s){if(s<t.length){n=t[s];let u=100,l,c,f,h=n.othersAttri.changingAttriName,d=n.actionAttr._startTime*1e3,p=n.actionAttr._durationTime*1e3,_=d+p,y=e-d,v=n.actionAttr._type,w=o.getGeometry(n._symbolGuid);switch(v){case 1:if(n.startValue||(n.startValue=w[h]),n.valueResetFlag){n.valueResetFlag=!1,n.blinkChangeMoment=Math.ceil(1e3/(2*n.actionAttr.actionBlinkInterval._blinkInterval)),n.copyBlink=n.blinkChangeMoment,n.nextValues=[];let C=n.startValue;for(let E=100;E<p+100;E+=u)n.blinkChangeMoment-E<50?(C=!C,n.nextValues.push(C),n.blinkChangeMoment+=n.copyBlink):n.nextValues.push(C)}w[h]=n.nextValues[y/100-1],e===_&&n.actionAttr._isPlayEndReset===1&&o.resetValue(w,h,n),s++,a(s);break;case 2:if(!n.startValue&&n.startValue!==0&&(n.startValue=Number(w[h])),n.valueResetFlag){n.valueResetFlag=!1;let C=n.actionAttr.actionRotateType._rotateType;c=n.startValue,C===1?l=c+360:l=c-360,f=y1(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let E=100;E<p+100;E+=u)n.nextValues.push(ov(c,y1(f,E/u)))}w[h]=n.nextValues[y/100-1],e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 3:if(n.startValue||(n.startValue=w[h]-0),n.valueResetFlag){n.valueResetFlag=!1,c=0,l=n.startValue,f=y1(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let C=100;C<p+100;C+=u)n.nextValues.push(ov(c,y1(f,C/u)))}w[h]=n.nextValues[y/100-1],e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 4:if(n.startValue||(n.startValue=w[h]),n.valueResetFlag){n.valueResetFlag=!1,c=n.startValue,l=0,f=y1(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let C=100;C<p+100;C+=u)n.nextValues.push(ov(c,y1(f,C/u)));n.nextValues[n.nextValues.length-1]=1e-4}w[h]=n.nextValues[y/100-1],e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 5:if(n.valueResetFlag){n.valueResetFlag=!1,n.resetValue=w[h],n.growPositionIndex=1,c=n.resetValue,l=Ree(c,p,v),n.growPositions=[],n.growPositions[0]=c[0],n.nextValues=[],n.nextValues.push(n.growPositions);for(let C=100;C<p+100;C+=u)n.growPositionIndex<c.length&&(l[C/100].x!==c[n.growPositionIndex].x||l[C/100].y!==c[n.growPositionIndex].y||l[C/100].z!==c[n.growPositionIndex].z?(n.growPositions[n.growPositionIndex]=l[C/100],n.nextValues.push(Uz(n.growPositions))):(n.growPositions[n.growPositionIndex]=l[C/100],n.growPositionIndex++,n.nextValues.push(Uz(n.growPositions))))}if(!n.startValue){let C=n.nextValues.length;n.startValue=n.nextValues[C-1]}w.setEditMode(!0,!1),w.positions=n.nextValues[y/100-1],w.requestVartexData(),e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 6:n.startValue||(n.startValue=w[h]),e===_&&(w[h]=!0),e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 7:n.startValue||(n.startValue=w[h]),n.valueResetFlag&&(n.valueResetFlag=!1,c=n.startValue),e===_&&(w[h]=!1),e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 8:{let C=o.getGeometry(n.actionAttr.actionRouteBindGuid.routeBindGuid);if(C.setEditMode(!1),n.startValue||(n.startValue=w[h],n.wayGeometry=C,n.wayGeometry.resetValue=n.wayGeometry.show),n.valueResetFlag){let E=C.mainLinePositions[0],S=[];E.forEach(function(M,b,O){let m=le.fromCartesian(M),I=Math.toDegrees(m.longitude),L=Math.toDegrees(m.latitude),R=(C.height+C.maxAnchorMarkHeight)*1e3;S.push(x.fromDegrees(I,L,R))});let A=S.length,D=p/100,P=S.concat([]);if(n.nextValues=[],A>D){let M=Math.floor(A/D),b=A%D,O;for(let m=0;m<D;m++)if(n.nextValues[m]=[],n.nextValues.length<=b)for(let I=0;I<M+1;I++)O=P.shift(),n.nextValues[m].push(O);else for(let I=0;I<M;I++)O=P.shift(),n.nextValues[m].push(O)}else n.nextValues=Ree(S,p,v);C.show=!1,n.actionAttr.actionVisibleRoute&&!n.actionAttr.actionVisibleRoute.isVisibleRoute===0&&(C.show=!0)}if(n.nextValues[y/100-1].length){let E=n.nextValues[y/100-1].length;for(let S=0;S<E;S++)w[h]=n.nextValues[y/100-1][S]}else w[h]=n.nextValues[y/100-1];e===_&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break}case 9:o.viewer.camera.flyToBoundingSphere(w._primitive._boundingSpheres[0],{duration:p/1e3-1}),console.log(n),s++,a(s);break;case 10:e===d+100&&(w[h]=!0),e===_&&(w[h]=!1),s++,a(s);break;case 11:e===d+100&&(w[h]=!1),e===_&&(w[h]=!0),s++,a(s);break;case 12:break;case 13:break}}}console.log(11111)};Md.prototype.getGeometry=function(e){if(this.allSymbol[e])return this.allSymbol[e]};Md.prototype.createTween=function(e,t,n,r,o,a,s,u,l){let c=this,f=setInterval(function(){t<n?(t+=e,r=ov(r,o),l(t,r)):(clearInterval(f),a===1&&c.resetValue(s,u))},e)};Md.prototype.resetValue=function(e,t,n){let r=n.startValue;r&&(e[t]=r,n.wayGeometry&&(n.wayGeometry.show=n.wayGeometry.resetValue))};Md.prototype.getWayGeometryId=function(e){this.action.actionAttr.actionRouteBindGuid.routeBindGuid=e.id};function Ree(e,t,n){let r=[],o=[],a=[],s=[],u=0;for(let d=0;d<e.length-1;d++){let p=ov(e[d+1].x,-e[d].x),_=ov(e[d+1].y,-e[d].y);r[d]=Math.sqrt(ov(p*p,_*_)),u+=r[d]}r.forEach(function(d,p){a[p]=Math.floor(d/u*t/100),o[p]=d/u*t/100});let l=[],c=[],f=[],h=0;o.forEach(function(d,p){l[p]=d%1}),c=l.sort(function(d,p){return p-d}),l.forEach(function(d,p){h+=d,f[p]=c.indexOf(d)}),h=Math.round(h);for(let d=0;d<h;d++)a[f[d]]++;for(let d=0;d<a.length;d++)for(let p=1;p<a[d]+1;p++){let _=e[d+1].x-e[d].x,y=e[d+1].y-e[d].y,v=e[d+1].z-e[d].z,w={x:e[d].x+_/(a[d]-1)*(p-1),y:e[d].y+y/(a[d]-1)*(p-1),z:e[d].z+v/(a[d]-1)*(p-1)};s.push(w)}return s}function y1(e,t){let n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch(a){console.log(a)}try{n+=o.split(".")[1].length}catch(a){console.log(a)}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function ov(e,t){let n,r;try{n=e.toString().split(".")[1].length}catch{n=0}try{r=t.toString().split(".")[1].length}catch{r=0}let o=Math.pow(10,Math.max(n,r));return(Oee(e,o)+Oee(t,o))/o}function Oee(e,t){let n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch(a){console.log(a)}try{n+=o.split(".")[1].length}catch(a){console.log(a)}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function Uz(e){let t=e.constructor===Array?[]:{};if(typeof e!="object")return e;for(let n in e)typeof e[n]=="object"?t[n]=Uz(e[n]):t[n]=e[n];return t}var Nee=Md;function av(e){this.groupName=e,this.id=Cesium.createGuid(),this.actions=new Cesium.AssociativeArray,this.timerMoment=0,this.groupStartTime=0,this.groupEndTime=0}av.prototype.addAction=function(e,t){if(!Cesium.defined(e)){console.error("MilStdDeduceGroup methods addAction parameter 'actionId' error!");return}if(!Cesium.defined(t)){console.error("MilStdDeduceGroup methods addAction parameter 'action' error!");return}return this.actions.set(e,t)};av.prototype.getAction=function(e){let t=this.actions.get(e);if(!Cesium.defined(t)){console.error("MilStdDeduceGroup methods 'getAction' undefined this 'action'");return}return t};av.prototype.removeAction=function(e){this.actions.remove(e)};av.prototype.getAllActions=function(){return this.actions.values};av.prototype.removeAllActions=function(){this.actions.removeAll()};av.prototype.destroy=function(){return this.removeAllActions(),this.actions=void 0,Cesium.destroyObject(this)};var gL=av;function la(e){this.milStdDrawHelper=e,this.camera=e.viewer.camera,this.deduceMap=new Cesium.AssociativeArray,this.initDefaultAttr(),this.timerplayState=0,this.playPlanId=void 0,this.playGroupIndex=0,this.playedDeduceGroups=[],this.getSymbol=function(t){return milStdLayerManager.getSymbol(t)},this.fpsNum=20,this._momentFps=1,this.speed=1}la.prototype.createDeducePlan=function(e){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'createDeducePlan' parameter 'deducePlanName' error!");return}var t=Cesium.createGuid(),n={name:e,id:t,deduceGroups:new Cesium.AssociativeArray};return this.deduceMap.set(t,n),n};la.prototype.getDeducePlan=function(e){if(Cesium.defined(e)){if(this.deduceMap.contains(e)){var t=this.deduceMap.get(e);return t}}else{console.error("EV_MilStdDeduceManager methods 'getDeducePlan' parameter 'deducePlanId' error!");return}};la.prototype.deleteDeducePlan=function(e){if(this.resetDeduce(),!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'deleteDeducePlan' parameter 'deducePlanId' error!");return}this.deduceMap.contains(e)&&this.deduceMap.remove(e)};la.prototype.clearDeducePlan=function(e){if(this.resetDeduce(),!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'clearDeducePlan' parameter 'deducePlanId' error!");return}var t=this.getDeduceGroups(e);t&&t.forEach(n=>{if(n){var r=n.id;this.removeDeduceGroup(r)}})};la.prototype.deleteAllDeducePlans=function(){var e=this.deduceMap.values;e&&e.forEach(t=>{if(t){var n=t.id;this.deleteDeducePlan(n)}}),this.deduceMap=new Cesium.AssociativeArray};la.prototype.createDeduceGroup=function(e,t){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'createDeduceGroup' parameter 'deducePlanId' error!");return}if(!Cesium.defined(t)){console.error("EV_MilStdDeduceManager methods 'createDeduceGroup' parameter 'groupName' error!");return}var n=this.getDeducePlan(e);if(n){var r=new gL(t),o=n.deduceGroups.length;return r.groupIndex=o,n.deduceGroups.set(r.id,r),r}};la.prototype.getDeduceGroup=function(e,t){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'getDeduceGroup' parameter 'deducePlanId' error!");return}if(!Cesium.defined(t)){console.error("EV_MilStdDeduceManager methods 'getDeduceGroup' parameter 'groupId' error!");return}var n=this.getDeducePlan(e);if(n&&n.deduceGroups.contains(t)){var r=n.deduceGroups.get(t);return r}};la.prototype.removeDeduceGroup=function(e,t){this.resetDeduce();var n=this.getDeducePlan(e),r=this.getDeduceGroup(e,t);n&&r&&(r.destroy(),n.deduceGroups.remove(t))};la.prototype.clearDeduceGroup=function(e,t){this.resetDeduce();var n=this.getDeduceGroup(e,t);n&&n.removeAllActions()};la.prototype.getDeduceGroups=function(e){var t=this.getDeducePlan(e);if(t){var n=t.deduceGroups.values;return n&&Array.isArray(n)?n:[]}};la.prototype.getPlanActions=function(e){var t=this.getDeduceGroups(e);if(t){var n=[];return t.forEach(r=>{if(r){var o=r.getAllActions();n.push(...o)}}),n}};la.prototype.playDeduceGroup=function(e,t,n,r){var o=this.getDeduceGroup(e,t);if(Cesium.defined(o)){var a=o.getAllActions();if(a.length!==0){if(this.playGroupIndex=o.groupIndex,this.playedDeduceGroups.push([e,t]),this.timerplayState===0&&a){let l=function(c,f,h,d){var p=Date.now(),_=p;let y=1e3/f/h;var v=!1;function w(){if(!v){requestAnimationFrame(w);var C=Date.now();_=C-p,_>y&&(p=C-_%y,c<=u?(d&&d(c,t),a&&a.length>0?Bee(s,c,a):(console.log("no action need playe"),s.cancelRAF(),s.timerplayState=0),c++,s._momentFps=c):(s.cancelRAF(),s._momentFps=1,s.timerplayState=0,Bee&&r(o.id)))}}return w(),function(){v=!0}};this.timerplayState=1;var s=this,u=o.groupEndTime*this.fpsNum;this.cancelRAF=l(this._momentFps,this.fpsNum,this.speed,n)}}else r(null)}else r(null)};la.prototype.playDeducePlan=function(e,t,n){var r=this.getDeduceGroups(e);if(r){let s=function(u,l,c){var f=r.filter(h=>{if(h.groupIndex===l[c])return h.id});f.length!==1?console.error("EV_MilStdDeduceManager methods 'playDeducePlan' playGroupIndex is same"):u.playDeduceGroup(e,f[0].id,t,function(h){c++,c<l.length?u.playGroupIndex++:(u.playGroupIndex=0,n(e))})};var o=r.map(u=>u.groupIndex);o.sort(function(u,l){return u-l});var a=o.indexOf(this.playGroupIndex);s(this,o,a)}else n(null)};la.prototype.pauseDeduce=function(){this.cancelRAF&&this.cancelRAF(),this.timerplayState=0};la.prototype.resetDeduce=function(){this.pauseDeduce(),this._momentFps=0,this.playGroupIndex=0;var e=this;this.playedDeduceGroups.forEach(t=>{var n=t[0],r=t[1];e.resetDeduceGroupPlayState(n,r)}),this.playedDeduceGroups=[]};la.prototype.resetActionPlaySate=function(e){var t=e.startValue;if(!!t){var n=e.actionAttr._type,r=e._symbolGuid;switch(n){case 1:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 2:this.milStdDrawHelper.setMarkSymbolRotate(r,t);break;case 3:this.milStdDrawHelper.setMarkSymbolScale(r,t);break;case 4:this.milStdDrawHelper.setMarkSymbolScale(r,t);break;case 5:this.milStdDrawHelper.setLineSymbolPositionCartographics(r,t);break;case 6:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 7:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 8:this.milStdDrawHelper.setMarkSymbolPositionCartographic(r,t),e.wayGeometry&&(e.wayGeometry.symbol.show=e.wayGeometry.resetValue||!0);break;case 9:break;case 10:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 11:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 12:break;case 13:break}}};la.prototype.resetDeduceGroupPlayState=function(e,t){var n=this.getDeduceGroup(e,t);if(n){var r=n.getAllActions(),o=this;r.forEach(function(a){o.resetActionPlaySate(a)})}};la.prototype.actionChangeGroup=function(e,t,n,r){this.resetDeduce();var o=this.getDeduceGroup(t,n),a=this.getDeduceGroup(t,r);if(o&&a){var s=o.getAction(e);a.addAction(e,s),o.removeAction(e)}};la.prototype.setSpeed=function(e){this.speed=e};la.prototype.createDeducePlanByFile=function(e,t){var n=this.createDeducePlan(e),r=t.SITSYMBOLFILE.ACTIONGROUPS,o=0;if(r&&r._Count>0){r._Count==1&&(r.ActionGroup=[r.ActionGroup]);for(var a=0;a<r._Count;a++){var s=0,u=0,l="\u7EC4"+a,c=parseInt(r.ActionGroup[a]._GroupIndex),f=this.createDeduceGroup(n.id,l);f.groupIndex=c;var h=r.ActionGroup[a]&&r.ActionGroup[a].Action||r.ActionGroup.Action;h&&(Array.isArray(h)||(h=[h]),h.forEach(d=>{var p=d._ActionGuid,_=d._SymbolGuid,y=Number(d.ActionAttr._Type),v=Number(d.ActionAttr._StartTime),w=Number(d.ActionAttr._DurationTime),C=v+w;u<C&&(u=C),s>v&&(s=v),f.groupStartTime=s,f.groupEndTime=u;var E={_actionGuid:p,_symbolGuid:_,actionAttr:{_startTime:d.ActionAttr._StartTime,_durationTime:d.ActionAttr._DurationTime,_isPlayEndReset:d.ActionAttr._IsPlayEndReset,_type:Number(d.ActionAttr._Type)},valueResetFlag:!0};switch(y){case 1:E.actionAttr.actionBlinkInterval={_blinkInterval:d.ActionAttr.ActionBlinkInterval._BlinkInterval},E.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:E.actionAttr.actionRotateType={_rotateType:d.ActionAttr.ActionRotateType._RotateType},E.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:d.ActionAttr.ActionScaleType&&d.ActionAttr.ActionScaleType._ScaleType?E.actionAttr.actionScaleType={_scaleType:d.ActionAttr.ActionScaleType._ScaleType}:E.actionAttr.actionScaleType={_scaleType:1},E.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:E.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:d.ActionAttr.ActionGrowType&&d.ActionAttr.ActionGrowType._GrowType?E.actionAttr.actionGrowType={_growType:d.ActionAttr.ActionGrowType._GrowType}:E.actionAttr.actionGrowType={_growType:1},E.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:E.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:E.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:E.actionAttr.actionRouteBindGuid={routeBindGuid:d.ActionAttr.ActionRouteBindGuid._RouteBindGuid},Cesium.defined(d.ActionAttr.ActionVisibleRoute)&&(E.actionAttr.actionVisibleRoute={isVisibleRoute:d.ActionAttr.ActionVisibleRoute._IsVisibleRoute}),Cesium.defined(d.ActionAttr.ActionRotateRoute)&&(E.actionAttr.actionRotateRoute={rotateCorrect:d.ActionAttr.ActionRotateRoute._RotateCorrect}),E.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:E.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},E.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:E.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:E.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:E.othersAttri={actionName:"\u64E6\u5165"};break;case 13:E.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("EV_MilStdDeduceManager methods 'createDeducePlanByFile' parameter 'type' error!")}f.addAction(p,E)}),o<u&&(o=u))}}return n.planEndTime=o,n};la.prototype.createDeducePlanByClick=function(e,t,n,r){var o=this.getDeduceGroup(e,t);if(o){var a=$Re(),s=r,u=this.defaultAttr.startTime,l=this.defaultAttr.durationTime,c=this.defaultAttr.isPlayEndReset,f=this.defaultAttr.blinkInterval,h=this.defaultAttr.rotateType,d=this.defaultAttr.scaleType,p=this.defaultAttr.growType,_=this.defaultAttr.routeBindGuid,y=this.defaultAttr.isVisibleRoute,v=this.defaultAttr.rotateCorrect,w=this.defaultAttr.moveType,C=u+l;o.groupEndTime<C&&(o.groupEndTime=C),o.groupStartTime>C&&(o.groupStartTime=C);var E={_actionGuid:a,_symbolGuid:n,actionAttr:{_startTime:u,_durationTime:l,_isPlayEndReset:c,_type:s},valueResetFlag:!0};switch(s){case 1:E.actionAttr.actionBlinkInterval={_blinkInterval:f},E.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:E.actionAttr.actionRotateType={_rotateType:h},E.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:d?E.actionAttr.actionScaleType={_scaleType:d}:E.actionAttr.actionScaleType={_scaleType:1},E.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:E.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:p?E.actionAttr.actionGrowType={_growType:p}:E.actionAttr.actionGrowType={_growType:1},E.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:E.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:E.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:E.actionAttr.actionRouteBindGuid={routeBindGuid:_},Cesium.defined(item.ActionAttr.ActionVisibleRoute)&&(E.actionAttr.actionVisibleRoute={isVisibleRoute:y}),Cesium.defined(item.ActionAttr.ActionRotateRoute)&&(E.actionAttr.actionRotateRoute={rotateCorrect:v}),E.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:var S=this.camera._positionCartographic.longitude*180/Math.PI,A=this.camera._positionCartographic.latitude*180/Math.PI,D=this.camera._positionCartographic.height,P=this.camera.heading,M=this.camera.pitch;E.actionAttr.actionMoveInfo={Longitude:S,Heading:P,Latitude:A,Tilt:M,Altitude:D},E.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:E.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:E.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:E.othersAttri={actionName:"\u64E6\u5165"};break;case 13:E.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("EV_MilStdDeduceManager methods 'createDeducePlanByFile' parameter 'type' error!")}return o.addAction(a,E),E}};la.prototype.saveDeduceData=function(){var e={};if(!(this.deduceMap.length<1)){var t=this.deduceMap.values[0],n=t.deduceGroups,r=n.length;e._Count=r;var o=e;o.ActionGroup=[];for(var a=0;a<r;a++){var s=n.values[a],u=o.ActionGroup[o.ActionGroup.length]={};u._GroupIndex=a,u.Action=[];for(var l=s.actions.values,c=l.length,f=0;f<c;f++){var h=l[f],d=u.Action[u.Action.length]={};d._ActionGuid=h._actionGuid,d._SymbolGuid=h._symbolGuid,d.ActionAttr={_StartTime:h.actionAttr._startTime,_DurationTime:h.actionAttr._durationTime,_IsPlayEndReset:h.actionAttr._isPlayEndReset,_Type:h.actionAttr._type};var p=h.actionAttr._type;switch(p){case 1:d.ActionAttr.ActionBlinkInterval={_BlinkInterval:h.actionAttr.actionBlinkInterval._blinkInterval};break;case 2:d.ActionAttr.ActionRotateType={_RotateType:h.actionAttr.actionRotateType._rotateType};break;case 3:d.ActionAttr.ActionScaleType={_ScaleType:h.actionAttr.actionScaleType._scaleType};break;case 4:break;case 5:d.ActionAttr.ActionGrowType={_GrowType:h.actionAttr.actionGrowType._growType};break;case 8:d.ActionAttr.ActionRouteBindGuid={_RouteBindGuid:h.actionAttr.actionRouteBindGuid.routeBindGuid};break;default:break}}}return e}};la.prototype.initDefaultAttr=function(){this.defaultAttr={startTime:0,durationTime:5,isPlayEndReset:0,blinkInterval:1,rotateType:1,scaleType:1,growType:1,routeBindGuid:-1,isVisibleRoute:0,rotateCorrect:0,moveType:1}};function Bee(e,t,n){var r=void 0,o=0;a(o);function a(s){if(s<n.length&&(r=n[s],r)){var u,l,c,f,h=r._symbolGuid,d=void 0,p=void 0,_=void 0,y;if(r.actionAttr&&(u=r.actionAttr._startTime*e.fpsNum,l=r.actionAttr._durationTime*e.fpsNum,c=r.actionAttr._type,f=u+l),u<t&&t<=f)switch(c){case 1:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag){r.valueResetFlag=!1,r.blinkChangeMoment=r.actionAttr.actionBlinkInterval._blinkInterval,r.copyBlink=r.blinkChangeMoment,r.nextValues=[];var v;for(y=0;y<l;y++)y%(e.fpsNum/r.copyBlink)>=e.fpsNum/(r.copyBlink*2)?v=!0:v=!1,r.nextValues.push(v)}e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 2:if(!r.startValue&&r.startValue!==0&&(r.startValue=e.milStdDrawHelper.getMarkSymbolRotate(h)),r.valueResetFlag){r.valueResetFlag=!1;var w=parseInt(r.actionAttr.actionRotateType._rotateType);if(d=r.startValue,w===0)p=d-360;else if(w===1)p=d+360;else return;for(_=sv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(parseFloat(d+(_*(y+1)).toFixed(2)))}e.milStdDrawHelper.setMarkSymbolRotate(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 3:if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolScale(h)),r.valueResetFlag)for(r.valueResetFlag=!1,d=0,p=r.startValue,_=sv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(Fee(d,v1(_,y+1)));e.milStdDrawHelper.setMarkSymbolScale(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 4:if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolScale(h)),r.valueResetFlag){for(r.valueResetFlag=!1,d=r.startValue,p=0,_=sv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(Fee(d,v1(_,y+1)));r.nextValues[r.nextValues.length-1]=1e-4}e.milStdDrawHelper.setMarkSymbolScale(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 5:r.startValue||(r.startValue=e.milStdDrawHelper.getLineSymbolPositionCartographics(h)),r.valueResetFlag&&(r.valueResetFlag=!1,p=r.startValue,r.nextValues=JRe(p,l)),e.milStdDrawHelper.setLineSymbolPositionCartographics(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 6:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!1):r.nextValues.push(!0);t===u+1&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 7:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!0):r.nextValues.push(!1);t===u+1&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 8:var C=e.milStdDrawHelper._milStd3DRanderManager.getSymbol(r.actionAttr.actionRouteBindGuid.routeBindGuid);if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolPositionCartographic(h),r.wayGeometry=C,r.wayGeometry.resetValue=r.wayGeometry.symbol.show),r.valueResetFlag){r.valueResetFlag=!1;var E=C.mainLinePositions[0],S=C.getAnchorHeight(),A=[];E.forEach(function(R){var N=Cesium.Cartographic.fromCartesian(R);N.height=S,A.push(Cesium.Cartographic.toCartesian(N))});var D=A.length,P=l,M=A.concat([]);if(r.nextValues=[],D>P)for(var b=Math.floor(D/P),O=D%P,m,I=0;I<P;I++)if(r.nextValues[I]=[],r.nextValues.length<=O)for(var L=0;L<b+1;L++)m=M.shift(),r.nextValues[I].push(m);else for(var L=0;L<b;L++)m=M.shift(),r.nextValues[I].push(m);else r.nextValues=QRe(A,l);C.symbol.show=!1,r.actionAttr.actionVisibleRoute&&r.actionAttr.actionVisibleRoute.isVisibleRoute!=="0"&&(C.symbol.show=!0)}e.milStdDrawHelper.setMarkSymbolPositionCartographic(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 9:break;case 10:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!1):r.nextValues.push(!0);e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 11:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!0):r.nextValues.push(!1);e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 12:break;case 13:break}s++,a(s)}}}function QRe(e,t){let n=t;t=t-1;var r=e.length,o=[],a=0,s=[];if(r-1!==1){for(var u=0;u<r-1;u++){var l=Cesium.Cartesian3.distance(e[u+1],e[u]);o[u]=l,a+=l}var c=o.length;t=t-c;for(var f=[],h=[],u=0;u<c;u++){var d=Math.floor(v1(sv(o[u],a),t));f[u]=d;var p=v1(sv(o[u],a),t)%1;h[u]=p}var _=h.sort(function(P,M){return M-P}),y=0;_.forEach(P=>{y+=P}),y=Math.round(y);for(var v=0,w=!1,u=0;u<_.length&&!w;u++)for(var C=0;C<c;C++)if(_[u]===h[C])if(v<y)v++,f[C]++;else{w=!0;break}for(var u=0;u<c;u++)for(var E=f[u],S=1;S<=E+1;S++)s.push(Cesium.Cartesian3.lerp(e[u],e[u+1],S/(E+1),new Cesium.Cartesian3))}else{t=t==0?1:t;for(var S=1/(t+1);S<=1;S+=1/(t+1))s.push(Cesium.Cartesian3.lerp(e[0],e[1],S,new Cesium.Cartesian3))}var A=[];A.push(Cesium.Cartographic.fromCartesian(e[0]));for(var u=0;u<s.length;u++)A.push(Cesium.Cartographic.fromCartesian(s[u]));let D=n-A.length;return D!==0&&console.log("\u8DEF\u5F84\u52A8\u753B\u70B9\u6570"+D),A}function JRe(e,t){for(var n=[],r=0;r<e.length;r++)n.push(Cesium.Cartographic.toCartesian(e[r]));var o=n.length,a=[],s=0,u=[];if(o-1!==1){for(var r=0;r<o-1;r++){var l=Cesium.Cartesian3.distance(n[r+1],n[r]);a[r]=l,s+=l}for(var c=a.length,f=[],h=[],r=0;r<c;r++){var d=Math.floor(v1(sv(a[r],s),t));f[r]=d;var p=v1(sv(a[r],s),t)%1;h[r]=p}var _=h.sort(function(P,M){return M-P}),y=0;_.forEach(P=>{y+=P}),y=Math.round(y);for(var v=0,r=0;r<_.length;r++)for(var w=0;w<c;w++)if(_[r]===h[w])if(v<y)v++,f[w]++;else break;for(var r=0;r<c;r++){var C=f[r],E=[];C=C==0?1:C;for(var S=0;S<C;S++)E.push([n[r],Cesium.Cartesian3.lerp(n[r],n[r+1],S/C,new Cesium.Cartesian3)]);if(r>0)for(var v=r;v>0;)E.forEach(b=>{b.unshift(n[v-1])}),v--;u.push(...E)}}else{t=t==0?1:t;for(var S=0;S<t;S++)u.push([n[0],Cesium.Cartesian3.lerp(n[0],n[1],S/t,new Cesium.Cartesian3)])}for(var A=[],r=0;r<u.length;r++){A[r]=[];for(var w=0;w<u[r].length;w++)A[r].push(Cesium.Cartographic.fromCartesian(u[r][w]))}let D=t-A.length;return D!==0&&console.log("\u8DEF\u5F84\u52A8\u753B\u70B9\u6570"+D),A}var v1=(e,t)=>{var n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch{}try{n+=o.split(".")[1].length}catch{}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)},sv=(e,t)=>{var n=0,r=0,o,a;try{n=e.toString().split(".")[1].length}catch{}try{r=t.toString().split(".")[1].length}catch{}return o=Number(e.toString().replace(".","")),a=Number(t.toString().replace(".","")),o/a*Math.pow(10,r-n)};function Fee(e,t){var n,r,o;try{n=e.toString().split(".")[1].length}catch{n=0}try{r=t.toString().split(".")[1].length}catch{r=0}return o=Math.pow(10,Math.max(n,r)),(zee(e,o)+zee(t,o))/o}function zee(e,t){var n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch{}try{n+=o.split(".")[1].length}catch{}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function $Re(e,t){e=10,t=10;var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],o;if(t=t||n.length,e)for(o=0;o<e;o++)r[o]=n[0|Math.random()*t];else{var a;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(a=0|Math.random()*16,r[o]=n[o==19?a&3|8:a])}return parseInt(r.join(""))}var _L=la;function eOe(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.groupName=e.groupName,this.layerName=e.layerName,this.type=1,this.name=e.name,this.id=e.id,this.libraryID=e.libraryID,this.code=e.code,this.show=Cesium.defaultValue(e.show,!0),this.isOnlyDrawMainLine=Cesium.defaultValue(e.isOnlyDrawMainLine,!1),this.floatHeight3D=Cesium.defaultValue(e.floatHeight3D,1.5),this.fillMode=Cesium.defaultValue(e.fillMode,1),this.mainLineColor=Cesium.defaultValue(e.mainLineColor,new K(1,0,0,1)),this.isExternalSetLine=Cesium.defaultValue(e.isExternalSetLine,!1),this.fillColor=Cesium.defaultValue(e.fillColor,new K(1,0,0,.392156)),this.isExternalSetFill=Cesium.defaultValue(e.isExternalSetFill,!0),this.distanceLegend=Cesium.defaultValue(e.distanceLegend,1e3),this.thickness3D=Cesium.defaultValue(e.thickness3D,.01),this.mainLineWidth=Cesium.defaultValue(e.mainLineWidth,.01),this.wallTransparent=Cesium.defaultValue(e.wallTransparent,.392156),this.surroundLineWidth=Cesium.defaultValue(e.surroundLineWidth,.001),this.surroundLineType=Cesium.defaultValue(e.surroundLineType,0),this.surroundLineColor=Cesium.defaultValue(e.surroundLineColor,new K(1,1,0,1)),this.topLineHeight=Cesium.defaultValue(e.topLineHeight,.01),this.positionCartographics=e.positionCartographics,this.mainLineIsTransparency=Cesium.defaultValue(e.mainLineIsTransparency,!1),this.mainLineIsDeepenColor=Cesium.defaultValue(e.mainLineIsDeepenColor,!0)}var C1=eOe;function Vee(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.groupName=e.groupName,this.layerName=e.layerName,this.type=0,this.name=e.name,this.id=e.id,this.libraryID=e.libraryID,this.code=e.code,this.show=Cesium.defaultValue(e.show,!0),this.floatHeight3D=Cesium.defaultValue(e.floatHeight3D,0),this._scale=Cesium.defaultValue(e.scale,.01),this._rotate=Cesium.defaultValue(e.rotate,0),this.drawMode=Cesium.defaultValue(e.drawMode,90),this.scaleMode=Cesium.defaultValue(e.scaleMode,1),this.mainLineWidth=Cesium.defaultValue(e.mainLineWidth,20),this.isExternalSetLine=Cesium.defaultValue(e.isExternalSetLine,!1),this.mainLineColor=Cesium.defaultValue(e.mainLineColor,new K(1,0,0,1)),this.mainLineHeight=Cesium.defaultValue(e.mainLineHeight,20),this.fillMode=Cesium.defaultValue(e.fillMode,1),this.isExternalSetFill=Cesium.defaultValue(e.isExternalSetFill,!1),this.fillColor=Cesium.defaultValue(e.fillColor,new K(1,0,0,.784313)),this.innertext=Cesium.defaultValue(e.innertext,""),this.innertextColor=Cesium.defaultValue(e.innertextColor,new K(0,0,0,1)),this.isExternalSetInnertext=Cesium.defaultValue(e.isExternalSetInnertext,!1),this.distanceLegend=Cesium.defaultValue(e.distanceLegend,1e5),this.positionCartographic=e.positionCartographic}Object.defineProperties(Vee.prototype,{scale:{get:function(){return this._scale},set:function(e){if(this.scale!==e){if(e<=0)return;this._scale=e}}},rotate:{get:function(){return this._rotate},set:function(e){this.rotate!==e&&(e>360&&(e=e%360),e<-360&&(e=e%360),this._rotate=e)}}});var x1=Vee;function Va(){this.layerGroupMap=new Cesium.AssociativeArray}Va.prototype.parseFileData=function(e){let t={},n=e.SITSYMBOLFILE.LAYGROUPS,r;for(var o=0;o<n._Count;o++){r=n.LayerGroup[o]||n.LayerGroup;let Rr=r._Name,gi=this.createLayerGroup(Rr),$i=gi.name;for(var a=r.LAYERS,s,u=0;u<a._Count;u++){s=a.Layer[u]||a.Layer;let ut=s._Name,ai=this.createLayer($i,ut);for(var l=s.SYMBOLS,c,f=0;f<l._Count;f++){c=l.Symbol[f]||l.Symbol;var h,d,p,_,y=[];if(d=c.GeoAttr.POINTS._Count,p=c.GeoAttr.POINTS.Point,d<2){h=0;var v=gi.name,w=ai.name,C=parseInt(c._Guid),E=c._Name,S=c._Code,A=parseInt(S.split(",")[0]),D=parseInt(S.split(",")[1]),P=c._Visible==="TRUE",M=parseInt(c.StyleAttr._DisplayType),b=kee(M).drawMode,O=kee(M).scaleMode;_=Cesium.Cartographic.fromDegrees(parseFloat(p._X),parseFloat(p._Y),parseFloat(p._Z)),y.push(_);var m=c.GeoAttr.GeoAttribute._FloatHeight3D-0,I=c.GeoAttr.GeoAttribute._Scale-0,L=c.GeoAttr.GeoAttribute._Rotate-0,R=parseInt(c.StyleAttr.MainLine._Width),N=lv(c.StyleAttr.MainLine._Color),B=c.StyleAttr.MainLine._IsExternalSetLine==="TRUE",V=c.StyleAttr.Fill._Mode,z=lv(c.StyleAttr.Fill._Color),U=c.StyleAttr.Fill._IsExternalSetFill==="TRUE";if(c.InnerTextAttr)var Q=c.InnerTextAttr[0]||c.InnerTextAttr,ne=Q.InnerText._Text,se=lv(Q.InnerColor._Back),de=lv(c.AnnoTextAttr.AnnoColor._Text),pe=!0;Cesium.defined(se)&&Cesium.defined(z)&&(z=se),t[C]={type:h,groupName:v,layerName:w,id:C,name:E,libraryID:A,code:D,show:P,drawMode:b,scaleMode:O,positionCartographics:y,floatHeight3D:m,scale:I,rotate:L,mainLineWidth:R,mainLineColor:N,isExternalSetLine:B,fillMode:V,fillColor:z,isExternalSetFill:U,innertext:ne,innertextColor:de,isExternalSetInnertext:pe}}else{h=1;for(var v=gi.name,w=ai.name,C=parseInt(c._Guid),E=c._Name,S=c._Code,A=parseInt(S.split(",")[0]),D=parseInt(S.split(",")[1]),P=c._Visible==="TRUE",o=0;o<d;o++)_=Cesium.Cartographic.fromDegrees(p[o]._X-0,p[o]._Y-0,p[o]._Z-0||0),y.push(_);var ve=parseFloat(c.GeoAttr.GeoAttribute._WallTransparent/255),m=parseFloat(c.GeoAttr.GeoAttribute._FloatHeight3D),ft=parseFloat(c.GeoAttr.GeoAttribute._Thickness3D),R=parseFloat(c.StyleAttr.MainLine._Width),N=lv(c.StyleAttr.MainLine._Color),B=c.StyleAttr.MainLine._IsExternalSetLine==="TRUE",pt=parseFloat(c.StyleAttr.SurroundLine._Width),Xt=parseInt(c.StyleAttr.SurroundLine._Type),At=lv(c.StyleAttr.SurroundLine._Color),V=parseInt(c.StyleAttr.Fill._Mode),z=lv(c.StyleAttr.Fill._Color),wt=c.StyleAttr.Fill._IsExternalSetFill==="TRUE";t[C]={type:h,groupName:v,layerName:w,id:C,name:E,libraryID:A,code:D,show:P,positionCartographics:y,wallTransparent:ve,floatHeight3D:m,thickness3D:ft,mainLineWidth:R,mainLineColor:N,isExternalSetLine:B,surroundLineWidth:pt,surroundLineType:Xt,surroundLineColor:At,fillMode:V,fillColor:z,isExternalSetFill:U,isExternalSetFill2:wt}}}}}return t};Va.prototype.saveSymbolData=function(){let e=this.layerGroupMap,t=e.length,n={_Count:t,LayerGroup:[]},r=n;r._Count=t;for(let o=0;o<t;o++){let a=e.values[o],s=r.LayerGroup[r.LayerGroup.length]={};s._Name=a.name,s._Visible="TRUE",s._Describe="",s.LAYERS=[];let u=s.LAYERS[s.LAYERS.length]={};u.Layer=[];let l=a.layers,c=l.length;u._Count=c;for(let f=0;f<c;f++){let h=l.values[f],d=u.Layer[u.Layer.length]={};d._Name=h.name,d._Visible="TRUE",d._Describe="",d._IsLayerActive=o==0,d.SYMBOLS=[];let p=d.SYMBOLS[d.SYMBOLS.length]={};p._Count=h.symbols.length,tOe(this,p,h)}}return n};Va.prototype.getLayerGroupMap=function(){return this.layerGroupMap};Va.prototype.createLayerGroup=function(e,t){if(Cesium.defined(e)||console.error("EV_MilStdLayerManager methods 'createLayerGroup' parameter 'groupName' error!"),this.layerGroupMap.contains(e))return this.layerGroupMap.get(e);{let n={name:e,layers:new Cesium.AssociativeArray};return this.layerGroupMap.set(e,n),Cesium.defined(t)&&this.createLayer(e,t),n}};Va.prototype.getLayerGroup=function(e){if(g(e)&&this.layerGroupMap&&this.layerGroupMap.contains(e))return this.layerGroupMap.get(e)};Va.prototype.clearLayerGroup=function(e){let n=this.getLayerGroup(e).layers._array.concat([]);for(let r=0;r<n.length;r++){let o=n[r].name;this.removeLayer(e,o)}};Va.prototype.removeLayerGroup=function(e){let n=this.getLayerGroup(e).layers._array.concat([]);for(let r=0;r<n.length;r++){let o=n[r].name;this.removeLayer(e,o)}this.layerGroupMap.remove(e)};Va.prototype.changeLayerGroupName=function(e,t){let n=this.getLayerGroup(t);n.layers.values.forEach(function(o){Cesium.defined(o)&&o.symbols.values.forEach(function(a){a&&(a.groupName=e)})});let r=n.name;n.name=e,this.layerGroupMap.set(e,n),this.layerGroupMap.remove(r)};Va.prototype.removeAllLayerGroup=function(){let e=Object.assign({},this.layerGroupMap.values),t=this.layerGroupMap.length;for(let n=0;n<t;n++){let r=e[n],o=r.name;r=void 0,this.removeLayerGroup(o)}};Va.prototype.createLayer=function(e,t){if(Cesium.defined(t)){let n=this.getLayerGroup(e);if(Cesium.defined(n)){if(n.layers.contains(t))return this.getLayer(e,t);{let r={name:t,symbols:new Cesium.AssociativeArray};return n.layers.set(t,r),r}}else{console.error("EV_MilStdLayerManager methods 'createLayer' error, undefined this layerGroup");return}}else{console.error("EV_MilStdLayerManager methods 'createLayer' parameter 'layerName' error!");return}};Va.prototype.getLayer=function(e,t){let n=this.getLayerGroup(e);if(Cesium.defined(n)&&g(t)&&n.layers.contains(t))return n.layers.get(t)};Va.prototype.clearLayer=function(e,t){let r=this.getLayer(e,t).symbols._array.concat([]);for(let o=0;o<r.length;o++){let s=r[o].id;this.removeSymbol(e,t,s)}};Va.prototype.removeLayer=function(e,t){let r=this.getLayer(e,t).symbols._array.concat([]);for(let a=0;a<r.length;a++){let u=r[a].id;this.removeSymbol(e,t,u)}this.getLayerGroup(e).layers.remove(t)};Va.prototype.symbolChangeLayer=function(e,t,n){let r=this.getSymbolById(n),o=r.groupName,a=r.layerName;this.getLayer(o,a).symbols.remove(n),this.getLayer(e,t).symbols.set(n,r)};Va.prototype.changeLayerName=function(e,t,n){let r=this.getLayer(t,n);r.symbols.values.forEach(function(a){Cesium.defined(a)&&(a.layerName=e)});let o=r.name;r.name=e,this.layerGroupMap.get(t).layers.set(e,r),this.layerGroupMap.get(t).layers.remove(o)};Va.prototype.createSymbol=function(e){if(g(e.id)&&g(e.type)){let n=this.getLayer(e.groupName,e.layerName);if(g(n)){var t=void 0;return e.type===0?(e.positionCartographic=e.positionCartographics[0].clone(),t=new x1(e)):e.type===1&&(t=new C1(e)),n.symbols.set(e.id,t),t}}};Va.prototype.getSymbolById=function(e){let t=this.layerGroupMap.values;if(g(t))for(let n=0;n<t.length;n++){let r=t[n].layers.values;if(g(r))for(let o=0;o<r.length;o++){let a=r[o];if(g(a.symbols)&&a.symbols.contains(e))return a.symbols.get(e)}}};Va.prototype.getSymbol=function(e,t,n){let r=this.getLayer(e,t);if(g(r)&&r.symbols.contains(n))return r.symbols.get(n)};Va.prototype.removeSymbol=function(e,t,n){this.getLayer(e,t).symbols.remove(n)};Va.prototype.changeSymbolName=function(e,t,n,r){let o=this.getSymbol(t,n,r);o&&(o.name=e)};Va.prototype.getAllSymbols=function(){let e=[],t=this.layerGroupMap.values;for(let n=0;n<t.length;n++){let r=t[n].layers.values;for(let o=0;o<r.length;o++){let a=r[o];if(a.symbols){let s=a.symbols.values;for(let u=0;u<s.length;u++)e.push(s[u])}}}return e};function tOe(e,t,n){t.Symbol=[],n.symbols.values.forEach(r=>{var o=t.Symbol[t.Symbol.length]={};if(r.type===0){o._Guid=r.id,o._CanSelected="TRUE",o._Name=r.name,o._Code=r.libraryID+","+r.code,o._Visible=r.show===!0?"TRUE":"FALSE";var a=r.positionCartographic;o.GeoAttr={POINTS:{_Count:1,Point:[{_X:a.longitude*180/Math.PI,_Y:a.latitude*180/Math.PI,_Z:a.height}]},GeoAttribute:{_WallTransparent:"100",_FloatHeight3D:r.floatHeight3D,_Scale:r.scale,_HeightType:"0",_Rotate:r.rotate,_Thickness3D:"20"}};var s=r.drawMode+"/"+r.scaleMode;o.StyleAttr={_LineType:"1",_DisplayType:nOe(s),MainLine:{_IsExternalSetLine:r.isExternalSetLine===!0?"TRUE":"FALSE",_Color:uv(r.mainLineColor),_Width:r.mainLineWidth},SurroundLine:{_Type:"3",_Color:"4294902015",_Width:"20.000000"},Fill:{_IsExternalSetFill:r.isExternalSetFill===!0?"TRUE":"FALSE",_Mode:r.fillMode,_Color:uv(r.fillColor)},Mirroring:{_Horizontal:"FALSE",_Vertical:"FALSE"}},o.AnnoTextAttr={_Text:"",_Visible:"TRUE",AnnoFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_Width:"20",_Height:"100"},AnnoFontEffect:{_Italic:"FALSE",_Bold:"FALSE"},AnnoColor:{_Back:"0",_Text:uv(r.innertextColor)},AnnoPosType:{_PosType:"1"},AnnoTextRotate:{_IsRorate:"1"}},o.InnerTextAttr={InnerText:{_Text:r.innertext,Index:"0"},InnerFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_InnerFontSize:"-1.000000",_Index:"0"},InnerColor:{_Back:uv(r.fillColor),_Text:"255",_Index:"0"}},o.DotDragLine={_DragLineVisble:"FALSE",DotDragLinePoint:{_X:"96.337753",_Y:"34.408583",_Z:"4623.950492"}},o.RangAttr={ShowRang:{_Min:"-1.000000",_Max:"-1.000000"},HalfPixelRang:{_Min:"20000000.000000",_Max:"20000000.000000"}}}if(r.type===1){o._Guid=r.id,o._CanSelected="TRUE",o._Name=r.name,o._Code=r.libraryID+","+r.code,o.OperType="EDIT",o._Visible=r.show!==!1?"TRUE":"FALSE",o._IsSetGenAttr="FALSE",o._DisplayType="STAND_NOPIXEL",o.GeoAttr={POINTS:{_Count:r.positionCartographics.length,Point:[]},GeoAttribute:{_WallTransparent:parseInt(r.wallTransparent*255),_FloatHeight3D:r.floatHeight3D,_Scale:"1.000000",_HeightType:"0",_Rotate:"0.000000",_ISVisibleDragLine:"FALSE",_Thickness3D:r.thickness3D},GeoScaleValues:{GeoScaleValue:{_Value:"0.100000",_Index:"0"}}};for(var u=0,l=r.positionCartographics.length;u<l;u++){let c=r.positionCartographics[u];o.GeoAttr.POINTS.Point[u]={_X:c.longitude*180/Math.PI,_Y:c.latitude*180/Math.PI,_Z:c.height}}o.StyleAttr={_DisplayType:"3",_LineType:"1",MainLine:{_Width:r.mainLineWidth,_Color:uv(r.mainLineColor),_IsExternalSetLine:r.isExternalSetLine===!0?"TRUE":"FALSE"},SurroundLine:{_Width:r.surroundLineWidth,_Type:r.surroundLineType,_Color:uv(r.surroundLineColor)},Fill:{_Mode:r.fillMode,_Color:uv(r.fillColor),_IsExternalSetFill:r.isExternalSetFill===!0?"TRUE":"FALSE"},Mirroring:{_Horizontal:"FALSE",_Vertical:"FALSE"}},o.AnnoTextAttr={_Text:"",_Visible:"TRUE",AnnoFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_Width:"20",_Height:"200"},AnnoFontEffect:{_Italic:"FALSE",_Bold:"FALSE"},AnnoColor:{_Back:"0",_Text:"255"},AnnoPosType:{_PosType:"1"}},o.AvoidPoints={_Count:"0"},o.RangAttr={ShowRang:{_Min:"-1.000000",_Max:"-1.000000"},HalfPixelRang:{_Min:"20000000.000000",_Max:"20000000.000000"}}}})}function kee(e){let t={1:{drawMode:360,scaleMode:1},2:{drawMode:360,scaleMode:0},3:{drawMode:90,scaleMode:1},4:{drawMode:90,scaleMode:0},5:{drawMode:0,scaleMode:1},6:{drawMode:0,scaleMode:0},7:{drawMode:360,scaleMode:1}};if(t[e])return t[e];console.error("EV_MilStdLayerManager function 'parseDisplayType' error!")}function nOe(e){let t;if(t={"360/1":"1","360/0":"2","90/1":"3","90/0":"4","0/1":"5","0/0":"6"}[e],t)return t;console.error("EV_MilStdLayerManager function 'getDisplayType' error!")}function uv(e){if(!!e){var t=parseInt((e.alpha||1)*255),n=parseInt(e.red*255),r=parseInt(e.green*255),o=parseInt(e.blue*255),a=n<<24|r<<16|o<<8|t;return a>>>0}}function lv(e){if(!!e){var t=[];return t[0]=(e&4278190080)>>>24,t[1]=(e&16711680)>>>16,t[2]=(e&65280)>>>8,t[3]=e&255>>>0,new K(t[0]/255,t[1]/255,t[2]/255,t[3]/255)}}var yL=Va;function rt(e){Cesium.defined(e.viewer)&&(this.isDraw3D=!0),Cesium.defined(e.olMap)&&(this.isDraw2D=!0),Cesium.defined(e.url)||console.error("'EV_MilStdDrawHelper' parameter 'options.url' error !"),(this.isDraw3D||this.isDraw2D)&&(this.updatePlottingService(e.url),this._milStdLayerManager=new yL,this.isDraw3D&&(this.viewer=e.viewer,this.isDraw3D=!0,this._milStd3DRanderManager=new mL({viewer:this.viewer,plottingService:this.evPlottingService}),rOe(this),this._milStdDeduceManager=new _L(this)),this.isDraw2D&&(this.olMap=e.olMap,this.isDraw2D=!0,this._milStd2DRanderManager=new rL({olMap:this.olMap,plottingService:this.evPlottingService})),this._editingSymbolId=void 0,this.vertexDataObjs={},this.sameVertexInfoObjs={},this.symbolMultipleChoice=!1,this._copyVertexDataState=!1,this._defaultAttriConfig={defaultMarkSymbol:new x1,defaultLineSymbol:new C1},this._defaultAttriArray=new Cesium.AssociativeArray)}Object.defineProperties(rt.prototype,{milStdLayerManager:{get:function(){return this._milStdLayerManager}},milStdDeduceManager:{get:function(){return this._milStdDeduceManager}},milStd3DRanderManager:{get:function(){return this._milStd3DRanderManager}},activeGroupName:{get:function(){return this._milStdLayerManager.activeGroupName},set:function(e){}},activeLayerName:{get:function(){return this._milStdLayerManager.activeLayerName},set:function(e){}},editingSymbolId:{get:function(){return this._editingSymbolId},set:function(e){this._editingSymbolId=e}}});rt.prototype.removeSymbol=function(e,t,n){var r=this._milStdLayerManager.getSymbol(e,t,n);r&&(this._milStdLayerManager.removeSymbol(e,t,n),this.isDraw3D&&this._milStd3DRanderManager.removeSymbol(n),this.isDraw2D&&this._milStd2DRanderManager.removeSymbol(n))};rt.prototype.clearLayer=function(e,t){var n=this._milStdLayerManager.getLayer(e,t);if(g(n)){var r=n.symbols.values;if(g(r)&&r.length>0){var o=r.concat([]),a=this;o.forEach(function(s){if(g(s)&&g(s.id)){var u=s.id;a.removeSymbol(e,t,u)}})}}};rt.prototype.removeLayer=function(e,t){this.clearLayer(e,t);var n=this.milStdLayerManager.getLayerGroup(e);g(n)&&n.layers.contains(t)&&n.layers.remove(t)};rt.prototype.clearLayerGroup=function(e){var t=this._milStdLayerManager.getLayerGroup(e);if(g(t)){var n=t.layers.values;if(n.length>0){var r=this;n.forEach(function(o){r.clearLayer(e,o.name)})}}};rt.prototype.removeLayerGroup=function(e){var t=this._milStdLayerManager.getLayerGroup(e);if(g(t)){var n=t.layers.values,r=n.concat([]);if(n.length>0){var o=this;r.forEach(function(s){o.removeLayer(e,s.name)})}}var a=this._milStdLayerManager.getLayerGroupMap();a.remove(e)};rt.prototype.removeAllLayerGroup=function(){this._milStdLayerManager.removeAllLayerGroup(),this._milStd3DRanderManager&&this._milStd3DRanderManager.removeAllSymbol()};rt.prototype.setEditingSymbol=function(e){this.editingSymbolId=e,this._milStd3DRanderManager&&this._milStd3DRanderManager.setEditingSymbol(e)};rt.prototype.startDrawSymbol=function(e,t){var n=e.type,r=this,o,a=0,s=!1;this._milStd3DRanderManager&&this._milStd3DRanderManager.getDrawPositions(n,function(u){switch(n){case 0:{e.positionCartographics=u,r.drawByPositions(e,t);break}case 1:{if(o&&a!==u.length&&(r.setEditingSymbol(void 0),r.setEditingSymbol(o.symbol.id)),u.length>1){var l=oOe(u);l>700&&(s||(o?r.setLineSymbolPositionCartographics(o.symbol.id,u):(s=!0,e.positionCartographics=u,r.drawByPositions(e,function(c){o=c,s=!1,t(c)}))))}break}default:break}})};rt.prototype.changeDefaultAttri=function(e,t,n){if(g(e)&&g(t)&&g(n)){var r=t+"_"+e;this._defaultAttriArray.contains(r),this._defaultAttriArray.set(r,{type:e,key:t,value:n})}};rt.prototype.drawByPositions=function(e,t){if(!g(e.groupName)||!g(e.layerName)){console.error("no groupName and layerName");return}var n;g(e.id)?n=e.id:(n=iOe(),e.id=n);var r=this._milStdLayerManager.getSymbolById(n);if(!r){var o=this._defaultAttriArray.values;o.forEach(function(c){var f=c.type,h=c.key,d=c.value;f===e.type&&(e[h]=d)});var r=this.milStdLayerManager.createSymbol(e),a=this;if(this.isDraw3D){let f=function(h,d){console.log("need change someone value")};this._milStd3DRanderManager.drawByPositions(r,f,function(h){var d=a._milStd3DRanderManager.getSymbol(h);d._isUpdatePrimitive=!0,a.viewer.scene.postRender.addEventListener(p);function p(){a.viewer.scene.postRender.removeEventListener(p),a.setEditingSymbol(d.symbol.id),t(d)}});var a=this}if(this.isDraw2D)if(r.type===0){var s=r.positionCartographic.longitude*180/Math.PI,u=r.positionCartographic.latitude*180/Math.PI;r.positionDegrees=[s,u],a._milStd2DRanderManager.drawByPositions(r,function(c){var f=a._milStd2DRanderManager.getSymbol(c);a._milStd2DRanderManager.vectorLayer.on("postrender",h);function h(){a._milStd2DRanderManager.vectorLayer.un("postrender",h),t(f)}})}else r.positionDegrees=[],r.positionCartographics.forEach(c=>{let f=parseFloat((c.longitude*180/Math.PI).toFixed(2)),h=parseFloat((c.latitude*180/Math.PI).toFixed(2));r.positionDegrees.push([f,h])}),a._milStd2DRanderManager.drawByPositions(r,function(c){var f=a._milStd2DRanderManager.getSymbol(c);a._milStd2DRanderManager.vectorLayer.on("postrender",h);function h(){a._milStd2DRanderManager.vectorLayer.un("postrender",h),t(f)}})}};rt.prototype.drawByVertexData=function(e,t){this._milStd3DRanderManager&&this._milStd3DRanderManager.drawByVertexData(e,t)};rt.prototype.drawByFile=function(e,t,n,r){this._isDrawFile=!0,this.vertexDataObjs={},this.sameVertexInfoObjs={};for(var o=this._milStdLayerManager.parseFileData(e),a=Object.keys(o),s=this,u=[],l=0;l<a.length;l++){var c=o[a[l]];c.type===0?this.drawByPositions({groupName:c.groupName,layerName:c.layerName,libraryID:c.libraryID,code:c.code,type:c.type,name:c.name,positionCartographics:c.positionCartographics,id:c.id,show:c.show,drawMode:c.drawMode,scaleMode:c.scaleMode,floatHeight3D:c.floatHeight3D,scale:c.scale,rotate:c.rotate,mainLineWidth:c.mainLineWidth,mainLineColor:c.mainLineColor,isExternalSetLine:c.isExternalSetLine,fillMode:c.fillMode,fillColor:c.fillColor,isExternalSetFill:c.isExternalSetFill,innertext:c.innertext,innertextColor:c.innertextColor,isExternalSetInnertext:c.isExternalSetInnertext},f):c.type===1&&this.drawByPositions({groupName:c.groupName,layerName:c.layerName,libraryID:c.libraryID,code:c.code,type:c.type,name:c.name,positionCartographics:c.positionCartographics,id:c.id,show:c.show,wallTransparent:c.wallTransparent,floatHeight3D:c.floatHeight3D,thickness3D:c.thickness3D,mainLineWidth:c.mainLineWidth,mainLineColor:c.mainLineColor,isExternalSetLine:c.isExternalSetLine,surroundLineWidth:c.surroundLineWidth,surroundLineType:c.surroundLineType,surroundLineColor:c.surroundLineColor,fillMode:c.fillMode,fillColor:c.fillColor,isExternalSetFill:c.isExternalSetFill},f)}function f(h){if(n(h.symbol.id),u.push(h.symbol.id),u.length===a.length){s._isDrawFile=!1;var d=t.split(".")[0],p=s._milStdDeduceManager.createDeducePlanByFile(d,e);r(u,p)}}};rt.prototype.saveSMLFile=function(){var e={SITSYMBOLFILE:{LAYGROUPS:{},ACTIONGROUPS:{}}},t=this._milStdLayerManager.saveSymbolData();t&&(e.SITSYMBOLFILE.LAYGROUPS=t);var n=this._milStdDeduceManager.saveDeduceData();return n&&(e.SITSYMBOLFILE.ACTIONGROUPS=n),e};rt.prototype.setSymbolVisible=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.show=t)};rt.prototype.getSymbolVisible=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.show:!1};rt.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);if(n&&(this.isDraw3D&&(n.positionCartographic=t,this._milStd3DRanderManager.setMarkSymbolPositionCartographic(e,t)),this.isDraw2D)){var r=t.longitude*180/Math.PI,o=t.latitude*180/Math.PI,a=[r,o];this._milStd2DRanderManager.setMarkSymbolPositionCartographic(e,a)}};rt.prototype.getMarkSymbolPositionCartographic=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.positionCartographic};rt.prototype.setMarkSymbolMainLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);if(n&&(this.isDraw3D||this.isDraw2D)&&(n.mainLineColor=t,n.isExternalSetLine=!0,this.isDraw3D&&this._milStd3DRanderManager.setMarkSymbolMainLineColor(e,t),this.isDraw2D)){let r=t.toBytes(),o="rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")";this._milStd2DRanderManager.setMarkSymbolMainLineColor(e,o)}};rt.prototype.getMarkSymbolMainLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.mainLineColor};rt.prototype.setMarkSymbolFillColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillColor=t,n.isExternalSetFill=!0,this._milStd3DRanderManager.setMarkSymbolFillColor(e,t))};rt.prototype.getMarkSymbolFillColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.fillColor};rt.prototype.setMarkSymbolFloatHeight3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.floatHeight3D=t,this._milStd3DRanderManager.updateMarkSymbolFloatHeight3D(e))};rt.prototype.getMarkSymbolFloatHeight3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.floatHeight3D:0};rt.prototype.setMarkSymbolRotate=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&((this.isDraw3D||this.isDraw2D)&&(n.rotate=t),this.isDraw3D&&this._milStd3DRanderManager.updateMarkSymbolRotate(e),this.isDraw2D&&this._milStd2DRanderManager.updateMarkSymbolRotate(e,t))};rt.prototype.getMarkSymbolRotate=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.rotate:0};rt.prototype.setMarkSymbolScale=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&((this.isDraw3D||this.isDraw2D)&&(n.scale=t),this.isDraw3D&&this._milStd3DRanderManager.updateMarkSymbolScale(e),this.isDraw2D&&this._milStd2DRanderManager.updateMarkSymbolScale(e,t))};rt.prototype.getMarkSymbolScale=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.scale:1};rt.prototype.setMarkSymbolDrawMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.drawMode=t,this._milStd3DRanderManager.updateMarkSymbolDrawMode(e))};rt.prototype.getMarkSymbolDrawMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.drawMode:90};rt.prototype.setMarkSymbolScaleMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.scaleMode=t,this._milStd3DRanderManager.setMarkSymbolScaleMode(e,t))};rt.prototype.getMarkSymbolScaleMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.scaleMode:0};rt.prototype.setMarkSymbolInnerText=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.innertext=t,this._milStd3DRanderManager.setMarkSymbolInnerText(e,t))};rt.prototype.getMarkSymbolInnerText=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.innertext:""};rt.prototype.setInnerTextColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.innertextColor=t,this._milStd3DRanderManager.setInnerTextColor(e,t))};rt.prototype.getInnerTextColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.innertextColor};rt.prototype.setLineSymbolPositionCartographics=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.positionCartographics=t,this._milStd3DRanderManager.setLineSymbolPositionCartographics(e,t))};rt.prototype.getLineSymbolPositionCartographics=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.positionCartographics:[]};rt.prototype.setLineSymbolMainLineWidth=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.mainLineWidth=t,this._milStd3DRanderManager.updateLineSymbolMainLineWidth(e))};rt.prototype.getLineSymbolMainLineWidth=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.mainLineWidth:0};rt.prototype.setLineSymbolMainLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.mainLineColor=t,n.isExternalSetLine=!0,this._milStd3DRanderManager.setLineSymbolMainLineColor(e,t))};rt.prototype.getLineSymbolMainLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.mainLineColor};rt.prototype.setLineSymbolFillColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillColor=t,n.isExternalSetFill=!0,this._milStd3DRanderManager.setLineSymbolFillColor(e,t))};rt.prototype.getLineSymbolFillColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.fillColor};rt.prototype.setLineSymbolSurroundLineType=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineType=t,this._milStd3DRanderManager.updateLineSymbolSurroundLineType(e))};rt.prototype.getLineSymbolSurroundLineType=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.surroundLineType:0};rt.prototype.setLineSymbolSurroundLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineColor=t,this._milStd3DRanderManager.setLineSymbolSurroundLineColor(e,t))};rt.prototype.getLineSymbolSurroundLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.surroundLineColor};rt.prototype.setLineSymbolSurroundLineWidth=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineWidth=t,this._milStd3DRanderManager.updateLineSymbolSurroundLineWidth(e))};rt.prototype.getLineSymbolSurroundLineWidth=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.surroundLineWidth:0};rt.prototype.setLineSymbolFillMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillMode=t,this._milStd3DRanderManager.updateLineSymbolFillMode(e))};rt.prototype.getLineSymbolFillMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.fillMode:0};rt.prototype.setLineSymbolFloatHeight3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.floatHeight3D=t,this._milStd3DRanderManager.updateLineSymbolFloatHeight3D(e))};rt.prototype.getLineSymbolFloatHeight3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.floatHeight3D:0};rt.prototype.setLineSymbolThickness3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.thickness3D=t,this._milStd3DRanderManager.updateLineSymbolThickness3D(e))};rt.prototype.getLineSymbolThickness3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.thickness3D:1};rt.prototype.setLineSymbolWallTransparent=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.wallTransparent=t,this._milStd3DRanderManager.updateLineSymbolWallTransparent(e))};rt.prototype.getLineSymbolWallTransparent=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.wallTransparent:.5};rt.prototype.registerDraggingAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._draggingAnchor)?this._milStd3DRanderManager._draggingAnchor.addEventListener(e):void 0};rt.prototype.removeDraggingAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._draggingAnchor)?this._milStd3DRanderManager._draggingAnchor.removeEventListener(e):void 0};rt.prototype.registerEndDragAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._endDragAnchor)?this._milStd3DRanderManager._endDragAnchor.addEventListener(e):void 0};rt.prototype.removeEndDragAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._endDragAnchor)?this._milStd3DRanderManager._endDragAnchor.removeEventListener(e):void 0};rt.prototype.registerMouseLeftDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._leftDown)?this._milStd3DRanderManager._leftDown.addEventListener(e):void 0};rt.prototype.removeMouseLeftDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._leftDown)?this._milStd3DRanderManager._leftDown.removeEventListener(e):void 0};rt.prototype.registerMouseRightDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._rightDown)?this._milStd3DRanderManager._rightDown.addEventListener(e):void 0};rt.prototype.removeMouseRightDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._rightDown)?this._milStd3DRanderManager._rightDown.removeEventListener(e):void 0};rt.prototype.turnOnUseSameVertexDrawing=function(){this._milStd3DRanderManager.turnOnUseSameVertexDrawing()};rt.prototype.initUseSameVertexDrawing=function(){this._milStd3DRanderManager.initUseSameVertexDrawing()};rt.prototype.turnOffUseSameVertexDrawing=function(){this._milStd3DRanderManager.turnOffUseSamevertexDrawing()};rt.prototype.updatePlottingService=function(e){localStorage.getItem("plottingServiceIp")&&localStorage.getItem("plottingServicePort")?this.plottingServiceUrl="http://"+localStorage.getItem("plottingServiceIp")+":"+localStorage.getItem("plottingServicePort"):this.plottingServiceUrl=e,this.evPlottingService?this.evPlottingService._url=this.plottingServiceUrl+"/earthview/services / v / soap / plottingservice / 10000":this.evPlottingService=new tL(this.plottingServiceUrl+"/earthview/services/v/soap/plottingservice/10000",{viewer:this.viewer}),Cesium.defined(this.evPlottingService)||console.error("EV_MilStdDrawHelper need statement 'evPlottingService'")};rt.prototype.drawLine=function(e,t,n){this.drawByPositions(e,r=>{var o,a;r.libID===32&&r.code==40502,o=Hz(e.vertexData),a=Hz(o);for(var s=1;s<n;){var u=Math.floor(s/t),l=s%t,c=[];a.MainData[0].MainVertex.forEach(function(h,d){d%2===1&&c.push(h+l*.3),d%2===0&&c.push(h+u*.3)}),o.MainData[0].MainVertex=c;var f=[];f[0]=Cesium.Cartesian3.fromDegrees(122-.025+u*.3,31.5+l*.3,200),f[1]=Cesium.Cartesian3.fromDegrees(122+.2-.025+u*.3,31.5+l*.3,200),drawLineByVertexData(this,{viewer:this.viewer,evPlottingService:this.evPlottingService,groupName:e.groupName,layerName:e.layerName,vertexData:o,libID:e.libID,code:e.code,name:"newLine"+s,id:"newLine"+s,cartesian3Array:f},function(h){h.processVertexData()}),s++}})};function rOe(e){var t=function(o,a){e.setEditingSymbol(o)};e.milStd3DRanderManager._leftDown.addEventListener(t);var n=function(o,a,s){if(g(s))e.setLineSymbolPositionCartographics(o,a);else{var u=a;e.setMarkSymbolPositionCartographic(o,u)}};e._milStd3DRanderManager._draggingAnchor.addEventListener(n);var r=function(o,a,s){if(g(s))e.setLineSymbolPositionCartographics(o,a);else{var u=a;e.setMarkSymbolPositionCartographic(o,u)}};e._milStd3DRanderManager._endDragAnchor.addEventListener(r)}function Hz(e){if(!(e instanceof Object))return e;var t=e.constructor===Array?[]:{};for(var n in e)t[n]=Hz(e[n]);return t}function iOe(e,t){e=10,t=10;var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],o;if(t=t||n.length,e)for(o=0;o<e;o++)r[o]=n[0|Math.random()*t];else{var a;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(a=0|Math.random()*16,r[o]=n[o==19?a&3|8:a])}return parseInt(r.join(""))}function oOe(e){var t=new Cesium.EllipsoidGeodesic;t.setEndPoints(e[e.length-2],e[e.length-1]);var n=t.surfaceDistance;return n}var Gee=rt;var qz=class{constructor(t,n){this.viewer=t,this.ev_DrawHelper=n,this.anchorHandler=new iv(this.viewer.scene,2),this.boxs={},this.radians,this.boxRadians,this.boxCenterRadian,this.boxAnchor,this.symbolAnchors,this.symbolAnchorsId={}}start(t){let n=this.viewer,r=0,o,a,s;this.getMouseEventPositions(t,(u,l)=>{if(r++,console.log(u),r===2){o=Ci(),a=[];let c=[];s=this.createBoxEntity(o,t,u,a,c)}if(u.length===t&&l==="mouseLeftUp"){let h=function(y,v){var w=n.scene.pick(v),C;if(w){C=w.primitive;let E=[],S=[];for(let A in p.boxs)if(Object.hasOwnProperty.call(p.boxs,A)){let D=p.boxs[A];E.push(A),S.push(D.boxEntityAnchorId)}S.includes(C.id)?C[y](w.primitive,v):E.includes(C.id)}else f.destroy(),p.removeBox(Object.keys(p.boxs)[0])},_=function(y,v){let w=p.symbolAnchorsId[y][0],C=p.ev_DrawHelper.milStd3DRanderManager.getSymbol(w);if(C.symbol.type===0)p.ev_DrawHelper.setMarkSymbolPositionCartographic(w,v);else if(C.symbol.type===1){let E=p.symbolAnchorsId[y][1],S=C.symbol.positionCartographics;S[E]=v,p.ev_DrawHelper.setLineSymbolPositionCartographics(w,S)}},c=new Wz({viewer:n,id:o,pointNum:t,mouseEventRadians:u,boxRadians:a,boxEntity:s});this.boxs[o]=c,c.startEditBoxEntity();let f=new Cesium.ScreenSpaceEventHandler(n.scene.canvas);f.setInputAction(function(y){h("leftDown",y.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN),f.setInputAction(function(y){h("rightDown",y.position)},Cesium.ScreenSpaceEventType.RIGHT_DOWN),c.createCillingvolume(),c.setChangeSymbolPositionFunc(_),this.ev_DrawHelper.milStdLayerManager.getAllSymbols().forEach(y=>{let v=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(y.id),w=v._primitive._boundingSpheres[0],C=v._framePrimitive._boundingSpheres[0],E=w||C;if(c.checkBoundingsphere(E))if(y.type===0){let A=Cesium.createGuid(),D=v.symbol.positionCartographic;c.addSymbolAnchors(A,D),this.symbolAnchorsId[A]=[y.id,0]}else y.type===1&&v.symbol.positionCartographics.forEach((D,P)=>{let M=Cesium.createGuid();c.addSymbolAnchors(M,D),this.symbolAnchorsId[M]=[y.id,P]})});let p=this}})}removeAllBox(){for(let t in this.boxs){let n=this.boxs[t];n.isDestroyed()||(n.removeAnchor(n.boxEntityAnchorId),n.remoSymbolAnchors(),n.destroy()),delete this.boxs[t]}}removeBox(t){let n=this.boxs[t];n.isDestroyed()||(n.removeAnchor(n.boxEntityAnchorId),n.remoSymbolAnchors(),n.destroy()),delete this.boxs[t]}createBoxEntity(t,n,r,o,a){return this.viewer.entities.add({id:t,polygon:{hierarchy:new Cesium.CallbackProperty(()=>(n===2?(o[0]=new Cesium.Cartographic(r[0].longitude,r[0].latitude,r[0].height),o[2]=new Cesium.Cartographic(r[1].longitude,r[1].latitude,r[1].height),o[1]=new Cesium.Cartographic(r[0].longitude,r[1].latitude,(r[0].height+r[1].height)/2),o[3]=new Cesium.Cartographic(r[1].longitude,r[0].latitude,(r[0].height+r[1].height)/2)):r.forEach(u=>{o.push(u)}),o.forEach((u,l)=>{a[l*3]=u.longitude,a[l*3+1]=u.latitude,a[l*3+2]=u.height}),{positions:Cesium.Cartesian3.fromRadiansArrayHeights(a)}),!1),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,material:new Cesium.Color(1,0,0,.4)}})}changeSymbolAndAnchorsPosition(t){this.selectedSymbolIds.forEach(n=>{let r=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(n.id),o=this.symbolAnchors[r.id],a=r.symbol.positionCartographic;a.longitude=a.longitude+t.longitude,a.latitude=a.longitude+t.latitude,this.ev_DrawHelper.setMarkSymbolPositionCartographic(symbolId,a),this.changeAnchorPosition(o.id,a)})}drawSymbolAnchors(){this.selectedSymbolIds.forEach(t=>{let n=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(t.id),r=n.symbol.positionCartographic,o=this.drawAnchor(void 0,r,void 0);this.symbolAnchors.push(n.id,o)})}endEditBox(){this.removeAnchor(this.boxAnchor.id),this.remoSymbolAnchors()}getMouseEventPositions(t,n){if(typeof t=="number"){let s=function(h){let d=f(h);c(t,d,n)},u=function(h){let d=f(h);c(t,d,n)},l=function(h){let d=f(h);o[o.length-1]=d,n&&n(o,"mouseMove")},c=function(h,d,p){if(h===1)o.push(d),p&&p(o,"mouseLeftUp"),a.isDestroy||a.destroy();else{let _=o.length;_===0?(o.push(d),o.push(void 0),a.setInputAction(l,Cesium.ScreenSpaceEventType.MOUSE_MOVE)):_===h?(o[o.length-1]=d,a.isDestroy||a.destroy(),p&&p(o,"mouseLeftUp")):(o.push(position),p&&p(o,"mouseLeftUp"))}},f=function(h){if(typeof h!=null&&h!=null){let d,p;if(h.position?d=h.position:h.startPosition&&h.endPosition?d=h.endPosition:console.error("plaece check more mouse type"),r.scene.mode!==2){let _=r.camera.getPickRay(d),y=r.scene.globe.pick(_,r.scene);p=Cesium.Cartographic.fromCartesian(y)}else{let _=r.scene.camera.pickEllipsoid(d);p=Cesium.Cartographic.fromCartesian(_)}return p}},r=this.viewer,o=[],a=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);a.setInputAction(s,Cesium.ScreenSpaceEventType.LEFT_UP)}else console.error("'getMouseEventPositions' methods paremeter must be number")}isDestroyed(){return!1}destroy(){delete this.id,this.radiansCoordinates=void 0,delete this.radiansCoordinates,this.selectedSymbolIds=void 0,delete this.selectedSymbolIds,this.mouseEventHandler.destroy(),delete this.mouseEventHandler}},Wz=class{constructor(t){Cesium.defined(t)&&(this.viewer=t.viewer,this.id=t.id||Ci(),this.pointNum=t.pointNum,this.mouseEventRadians=t.mouseEventRadians,this.boxRadians=t.boxRadians,this.boxEntity=t.boxEntity,this.anchorHandler=new iv(this.viewer.scene,1.5),this.boxEntityAnchor,this.boxEntityAnchorId,this.symbolAnchors={},this.cillingvolume)}checkBoundingsphere(t){if(Cesium.defined(t)&&this.cillingvolume.computeVisibility(t)!==-1)return!0}createCillingvolume(){let t=this.mouseEventRadians,n=[];n[0]=new Cesium.Cartographic(t[0].longitude,t[0].latitude,-1e5),n[2]=new Cesium.Cartographic(t[1].longitude,t[1].latitude,-1e5),n[1]=new Cesium.Cartographic(t[0].longitude,t[1].latitude,-1e5),n[3]=new Cesium.Cartographic(t[1].longitude,t[0].latitude,-1e5),n[4]=new Cesium.Cartographic(t[0].longitude,t[0].latitude,1e5),n[6]=new Cesium.Cartographic(t[1].longitude,t[1].latitude,1e5),n[5]=new Cesium.Cartographic(t[0].longitude,t[1].latitude,1e5),n[7]=new Cesium.Cartographic(t[1].longitude,t[0].latitude,1e5);let r=[];n.forEach((M,b)=>{r[b*3]=M.longitude,r[b*3+1]=M.latitude,r[b*3+2]=M.height});let o=Cesium.Cartesian3.fromRadiansArrayHeights(r);console.log(n);let a=Cesium.Cartesian3.subtract(o[1],o[0]),s=Cesium.Cartesian3.subtract(o[3],o[0]),u=Cesium.Cartesian3.subtract(o[4],o[0]),l=Cesium.Cartesian3.subtract(o[5],o[6]),c=Cesium.Cartesian3.subtract(o[7],o[6]),f=Cesium.Cartesian3.subtract(o[6],o[2]),h=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(a,s,new Cesium.Cartesian3),new Cesium.Cartesian3),d=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(u,a,new Cesium.Cartesian3),new Cesium.Cartesian3),p=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(s,u,new Cesium.Cartesian3),new Cesium.Cartesian3),_=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(l,c,new Cesium.Cartesian3),new Cesium.Cartesian3),y=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(f,c,new Cesium.Cartesian3),new Cesium.Cartesian3),v=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(l,f,new Cesium.Cartesian3),new Cesium.Cartesian3),w=Cesium.Cartesian4.fromElements(h.x,h.y,h.z,-Cesium.Cartesian3.dot(h,o[0])),C=Cesium.Cartesian4.fromElements(d.x,d.y,d.z,-Cesium.Cartesian3.dot(d,o[0])),E=Cesium.Cartesian4.fromElements(p.x,p.y,p.z,-Cesium.Cartesian3.dot(p,o[0])),S=Cesium.Cartesian4.fromElements(_.x,_.y,_.z,-Cesium.Cartesian3.dot(_,o[6])),A=Cesium.Cartesian4.fromElements(y.x,y.y,y.z,-Cesium.Cartesian3.dot(y,o[6])),D=Cesium.Cartesian4.fromElements(v.x,v.y,v.z,-Cesium.Cartesian3.dot(v,o[6])),P=[w,C,E,S,A,D];this.cillingvolume=new Cesium.CullingVolume(P)}remoSymbolAnchors(){for(let t in this.symbolAnchors)Object.hasOwnProperty.call(this.symbolAnchors,t)&&this.removeAnchor(t)}setChangeSymbolPositionFunc(t){t&&typeof t=="function"&&(this.changeSymbolPositionFunc=t)}updateSymbolAnchorsPositions(t){for(let n in this.symbolAnchors)if(Object.hasOwnProperty.call(this.symbolAnchors,n)){let o=this.symbolAnchors[n].position,a=Cesium.Cartographic.fromCartesian(o),s=new Cesium.Cartographic(a.longitude+t.longitude,a.latitude+t.latitude,a.height+t.height);this.changeAnchorPosition(n,s),this.changeSymbolPositionFunc&&this.changeSymbolPositionFunc(n,a)}}addSymbolAnchors(t,n){let r=this.drawAnchor(t,n,void 0);this.symbolAnchors[t]=r}startEditBoxEntity(){let t=this.getBoxEntityAnchorRadian(),n=this,r={dragHandlers:{onDrag:function(u,l){let c=Cesium.Cartographic.clone(n.getBoxEntityAnchorRadian()),f=Cesium.Cartographic.fromCartesian(l),h=f.longitude-c.longitude,d=f.latitude-c.latitude,p=f.height-c.height,_={longitude:h,latitude:d,height:p};n.mouseEventRadians.forEach(y=>{y.longitude+=h,y.latitude+=d,y.height+=p}),n.updateSymbolAnchorsPositions(_)},onDragEnd:function(u,l){let c=Cesium.Cartographic.clone(n.getBoxEntityAnchorRadian()),f=Cesium.Cartographic.fromCartesian(l),h=f.longitude-c.longitude,d=f.latitude-c.latitude,p=f.height-c.height,_={longitude:h,latitude:d,height:p};n.mouseEventRadians.forEach(y=>{y.longitude+=h,y.latitude+=d}),n.updateSymbolAnchorsPositions(_)}}},o=Cesium.createGuid();this.boxEntityAnchorId=o;let a=this.drawAnchor(o,t,r),s=new Cesium.Color(0,0,1,1);this.anchorHandler.myChangeBillboardColor(a.id,s),this.boxEntityAnchor=a}changeAnchorPosition(t,n){let r=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);this.anchorHandler.myChangeBillboardPosition(t,r)}removeAllAnchor(){this.anchorHandler.myRemoveAllBillboard()}removeAnchor(t){this.anchorHandler.myRemoveBillboard(t)}drawAnchor(t,n,r){let o=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);return this.anchorHandler.myAddBillboard(t,o,r)}getBoxEntityAnchorRadian(){let t=this.boxRadians.length,n=0,r=0,o=0;return this.boxRadians.forEach(s=>{n+=s.longitude,r+=s.latitude,o+=s.height}),new Cesium.Cartographic(n/t,r/t,o/t)}isDestroyed(){return!1}destroy(){this.viewer.entities.remove(this.boxEntity),this.removeAllAnchor(),this.boxEntity=void 0,delete this.boxEntity,delete this.viewer,delete this.id,delete this.pointNum,this.mouseEventRadians=void 0,delete this.mouseEventRadians,this.boxRadians=void 0,delete this.boxRadians,delete this.anchorHandler,this.cillingvolume=void 0,delete this.cillingvolume}},Uee=qz;var Cs=63710088e-1,iR={meters:Cs,metres:Cs,millimeters:Cs*1e3,millimetres:Cs*1e3,centimeters:Cs*100,centimetres:Cs*100,kilometers:Cs/1e3,kilometres:Cs/1e3,miles:Cs/1609.344,nauticalmiles:Cs/1852,inches:Cs*39.37,yards:Cs/1.0936,feet:Cs*3.28084,radians:1,degrees:Cs/111325},bne={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:1/1e3,kilometres:1/1e3,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/Cs,degrees:1/111325},zL={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function ha(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.bbox,o=n.id;if(e===void 0)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");r&&rw(r),o&&aR(o);var a={type:"Feature"};return o&&(a.id=o),r&&(a.bbox=r),a.properties=t||{},a.geometry=e,a}function Ine(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.bbox;if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");r&&rw(r);var o;switch(e){case"Point":o=Yr(t).geometry;break;case"LineString":o=Vi(t).geometry;break;case"Polygon":o=ir(t).geometry;break;case"MultiPoint":o=oR(t).geometry;break;case"MultiLineString":o=p_(t).geometry;break;case"MultiPolygon":o=nw(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(o.bbox=r),o}function Yr(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!pi(e[0])||!pi(e[1]))throw new Error("coordinates must contain numbers");return ha({type:"Point",coordinates:e},t,n)}function Dne(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return kt(e.map(function(r){return Yr(r,t)}),n)}function ir(e,t,n){if(!e)throw new Error("coordinates is required");for(var r=0;r<e.length;r++){var o=e[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(r===0&&a===0&&!pi(o[0][0])||!pi(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return ha({type:"Polygon",coordinates:e},t,n)}function Pne(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return kt(e.map(function(r){return ir(r,t)}),n)}function Vi(e,t,n){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!pi(e[0][1])||!pi(e[0][1]))throw new Error("coordinates must contain numbers");return ha({type:"LineString",coordinates:e},t,n)}function Mne(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return kt(e.map(function(r){return Vi(r,t)}),n)}function kt(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.bbox,r=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");n&&rw(n),r&&aR(r);var o={type:"FeatureCollection"};return r&&(o.id=r),n&&(o.bbox=n),o.features=e,o}function p_(e,t,n){if(!e)throw new Error("coordinates is required");return ha({type:"MultiLineString",coordinates:e},t,n)}function oR(e,t,n){if(!e)throw new Error("coordinates is required");return ha({type:"MultiPoint",coordinates:e},t,n)}function nw(e,t,n){if(!e)throw new Error("coordinates is required");return ha({type:"MultiPolygon",coordinates:e},t,n)}function L4(e,t,n){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return ha({type:"GeometryCollection",geometries:e},t,n)}function Lne(e,t){if(e==null||isNaN(e))throw new Error("num is required");if(t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function L1(e,t){if(e==null)throw new Error("radians is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=iR[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e*n}function pv(e,t){if(e==null)throw new Error("distance is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=iR[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e/n}function VL(e,t){return r_(pv(e,t))}function J0(e){if(e==null)throw new Error("bearing is required");var t=e%360;return t<0&&(t+=360),t}function r_(e){if(e==null)throw new Error("radians is required");var t=e%(2*Math.PI);return t*180/Math.PI}function Ja(e){if(e==null)throw new Error("degrees is required");var t=e%360;return t*Math.PI/180}function mv(e,t,n){if(e==null)throw new Error("length is required");if(!(e>=0))throw new Error("length must be a positive number");return L1(pv(e,t),n||"kilometers")}function Rne(e,t,n){if(e==null)throw new Error("area is required");if(!(e>=0))throw new Error("area must be a positive number");var r=zL[t||"meters"];if(!r)throw new Error("invalid original units");var o=zL[n||"kilometers"];if(!o)throw new Error("invalid final units");return e/r*o}function pi(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function yt(e){return!!e&&e.constructor===Object}function rw(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!pi(t))throw new Error("bbox must only contain numbers")})}function aR(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function aOe(){throw new Error("method has been renamed to `radiansToDegrees`")}function sOe(){throw new Error("method has been renamed to `degreesToRadians`")}function uOe(){throw new Error("method has been renamed to `lengthToDegrees`")}function lOe(){throw new Error("method has been renamed to `lengthToRadians`")}function cOe(){throw new Error("method has been renamed to `radiansToLength`")}function fOe(){throw new Error("method has been renamed to `bearingToAzimuth`")}function hOe(){throw new Error("method has been renamed to `convertLength`")}var dOe=Object.freeze({earthRadius:Cs,factors:iR,unitsFactors:bne,areaFactors:zL,feature:ha,geometry:Ine,point:Yr,points:Dne,polygon:ir,polygons:Pne,lineString:Vi,lineStrings:Mne,featureCollection:kt,multiLineString:p_,multiPoint:oR,multiPolygon:nw,geometryCollection:L4,round:Lne,radiansToLength:L1,lengthToRadians:pv,lengthToDegrees:VL,bearingToAzimuth:J0,radiansToDegrees:r_,degreesToRadians:Ja,convertLength:mv,convertArea:Rne,isNumber:pi,isObject:yt,validateBBox:rw,validateId:aR,radians2degrees:aOe,degrees2radians:sOe,distanceToDegrees:uOe,distanceToRadians:lOe,radiansToDistance:cOe,bearingToAngle:fOe,convertDistance:hOe});function $a(e,t,n){if(e!==null)for(var r,o,a,s,u,l,c,f=0,h=0,d,p=e.type,_=p==="FeatureCollection",y=p==="Feature",v=_?e.features.length:1,w=0;w<v;w++){c=_?e.features[w].geometry:y?e.geometry:e,d=c?c.type==="GeometryCollection":!1,u=d?c.geometries.length:1;for(var C=0;C<u;C++){var E=0,S=0;if(s=d?c.geometries[C]:c,s!==null){l=s.coordinates;var A=s.type;switch(f=n&&(A==="Polygon"||A==="MultiPolygon")?1:0,A){case null:break;case"Point":t(l,h,w,E,S),h++,E++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++)t(l[r],h,w,E,S),h++,A==="MultiPoint"&&E++;A==="LineString"&&E++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-f;o++)t(l[r][o],h,w,E,S),h++;A==="MultiLineString"&&E++,A==="Polygon"&&S++}A==="Polygon"&&E++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(A==="MultiPolygon"&&(S=0),o=0;o<l[r].length;o++){for(a=0;a<l[r][o].length-f;a++)t(l[r][o][a],h,w,E,S),h++;S++}E++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)$a(s.geometries[r],t,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function sR(e,t,n,r){var o=n;return $a(e,function(a,s,u,l,c){s===0&&n===void 0?o=a:o=t(o,a,s,u,l,c)},r),o}function R4(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length;n++)t(e.features[n].properties,n);break;case"Feature":t(e.properties,0);break}}function One(e,t,n){var r=n;return R4(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function mi(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)t(e.features[n],n)}function O4(e,t,n){var r=n;return mi(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function $p(e){var t=[];return $a(e,function(n){t.push(n)}),t}function Hh(e,t){var n,r,o,a,s,u,l,c,f,h,d=0,p=e.type==="FeatureCollection",_=e.type==="Feature",y=p?e.features.length:1;for(n=0;n<y;n++){for(u=p?e.features[n].geometry:_?e.geometry:e,c=p?e.features[n].properties:_?e.properties:{},f=p?e.features[n].bbox:_?e.bbox:void 0,h=p?e.features[n].id:_?e.id:void 0,l=u?u.type==="GeometryCollection":!1,s=l?u.geometries.length:1,o=0;o<s;o++){if(a=l?u.geometries[o]:u,a===null){t(null,d,c,f,h);continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{t(a,d,c,f,h);break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)t(a.geometries[r],d,c,f,h);break}default:throw new Error("Unknown Geometry Type")}}d++}}function N4(e,t,n){var r=n;return Hh(e,function(o,a,s,u,l){a===0&&n===void 0?r=o:r=t(r,o,a,s,u,l)}),r}function Da(e,t){Hh(e,function(n,r,o,a,s){var u=n===null?null:n.type;switch(u){case null:case"Point":case"LineString":case"Polygon":t(ha(n,o,{bbox:a,id:s}),r,0);return}var l;switch(u){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}n.coordinates.forEach(function(c,f){var h={type:l,coordinates:c};t(ha(h,o),r,f)})})}function Nne(e,t,n){var r=n;return Da(e,function(o,a,s){a===0&&s===0&&n===void 0?r=o:r=t(r,o,a,s)}),r}function xg(e,t){Da(e,function(n,r,o){var a=0;if(!!n.geometry){var s=n.geometry.type;s==="Point"||s==="MultiPoint"||sR(n,function(u,l,c,f,h,d){var p=Vi([u,l],n.properties);return t(p,r,o,d,a),a++,l})}})}function B4(e,t,n){var r=n,o=!1;return xg(e,function(a,s,u,l,c){o===!1&&n===void 0?r=a:r=t(r,a,s,u,l,c),o=!0}),r}function F4(e,t){if(!e)throw new Error("geojson is required");Da(e,function(n,r,o){if(n.geometry!==null){var a=n.geometry.type,s=n.geometry.coordinates;switch(a){case"LineString":t(n,r,o,0,0);break;case"Polygon":for(var u=0;u<s.length;u++)t(Vi(s[u],n.properties),r,o,u);break}}})}function z4(e,t,n){var r=n;return F4(e,function(o,a,s,u){a===0&&n===void 0?r=o:r=t(r,o,a,s,u)}),r}var pOe=Object.freeze({coordEach:$a,coordReduce:sR,propEach:R4,propReduce:One,featureEach:mi,featureReduce:O4,coordAll:$p,geomEach:Hh,geomReduce:N4,flattenEach:Da,flattenReduce:Nne,segmentEach:xg,segmentReduce:B4,lineEach:F4,lineReduce:z4});function Pa(e){var t=[1/0,1/0,-1/0,-1/0];return $a(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function fo(e){if(!e)throw new Error("obj is required");var t=St(e);if(t.length>1&&pi(t[0])&&pi(t[1]))return t;throw new Error("Coordinate is not a valid Point")}function St(e){if(!e)throw new Error("obj is required");var t;if(e.length?t=e:e.coordinates?t=e.coordinates:e.geometry&&e.geometry.coordinates&&(t=e.geometry.coordinates),t)return uR(t),t;throw new Error("No valid coordinates")}function uR(e){if(e.length>1&&pi(e[0])&&pi(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return uR(e[0]);throw new Error("coordinates must only contain numbers")}function Bne(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function yA(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function qd(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<e.features.length;r++){var o=e.features[r];if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+o.geometry.type)}}function ic(e){if(!e)throw new Error("geojson is required");if(e.geometry!==void 0)return e.geometry;if(e.coordinates||e.geometries)return e;throw new Error("geojson must be a valid Feature or Geometry Object")}function Fne(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function ki(e,t){if(!e)throw new Error((t||"geojson")+" is required");if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error((t||"geojson")+" is invalid")}var mOe=Object.freeze({getCoord:fo,getCoords:St,containsNumber:uR,geojsonType:Bne,featureOf:yA,collectionOf:qd,getGeom:ic,getGeomType:Fne,getType:ki});/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var Hee={successCallback:null,verbose:!1},vL={};function gOe(e,t,n){n=n||{};for(var r=Object.keys(Hee),o=0;o<r.length;o++){var a=r[o],s=n[a];s=typeof s<"u"&&s!==null?s:Hee[a],vL[a]=s}vL.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var u=vOe(_Oe(e,t));return typeof vL.successCallback=="function"&&vL.successCallback(u),u}function zi(e,t,n){return(e-t)/(n-t)}function _Oe(e,t){for(var n=e.length-1,r=e[0].length-1,o={rows:n,cols:r,cells:[]},a=0;a<n;++a){o.cells[a]=[];for(var s=0;s<r;++s){var u=0,l=e[a+1][s],c=e[a+1][s+1],f=e[a][s+1],h=e[a][s];if(!(isNaN(l)||isNaN(c)||isNaN(f)||isNaN(h))){u|=l>=t?8:0,u|=c>=t?4:0,u|=f>=t?2:0,u|=h>=t?1:0;var d=!1;if(u===5||u===10){var p=(l+c+f+h)/4;u===5&&p<t?(u=10,d=!0):u===10&&p<t&&(u=5,d=!0)}if(u!==0&&u!==15){var _,y,v,w;_=y=v=w=.5,u===1?(v=1-zi(t,l,h),y=1-zi(t,f,h)):u===2?(y=zi(t,h,f),w=1-zi(t,c,f)):u===3?(v=1-zi(t,l,h),w=1-zi(t,c,f)):u===4?(_=zi(t,l,c),w=zi(t,f,c)):u===5?(_=zi(t,l,c),w=zi(t,f,c),y=1-zi(t,f,h),v=1-zi(t,l,h)):u===6?(y=zi(t,h,f),_=zi(t,l,c)):u===7?(v=1-zi(t,l,h),_=zi(t,l,c)):u===8?(v=zi(t,h,l),_=1-zi(t,c,l)):u===9?(y=1-zi(t,f,h),_=1-zi(t,c,l)):u===10?(_=1-zi(t,c,l),w=1-zi(t,c,f),y=zi(t,h,f),v=zi(t,h,l)):u===11?(_=1-zi(t,c,l),w=1-zi(t,c,f)):u===12?(v=zi(t,h,l),w=zi(t,f,c)):u===13?(y=1-zi(t,f,h),w=zi(t,f,c)):u===14?(v=zi(t,h,l),y=zi(t,h,f)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+u),o.cells[a][s]={cval:u,flipped:d,top:_,right:w,bottom:y,left:v}}}}}return o}function yOe(e){return e.cval===5||e.cval===10}function zne(e){return e.cval===0||e.cval===15}function qee(e){!zne(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function Yz(e,t){if(t==="top")return[e.top,1];if(t==="bottom")return[e.bottom,0];if(t==="right")return[1,e.right];if(t==="left")return[0,e.left]}function vOe(e){var t=[],n=0,r=e.rows,o=e.cols,a=1e-7;return e.cells.forEach(function(s,u){s.forEach(function(l,c){if(typeof l<"u"&&!yOe(l)&&!zne(l)){var f=COe(e.cells,u,c),h=!1;if(f.info==="mergeable"){for(var d=f.path[f.path.length-1][0],p=f.path[f.path.length-1][1],_=n-1;_>=0;_--)if(Math.abs(t[_][0][0]-d)<=a&&Math.abs(t[_][0][1]-p)<=a){for(var y=f.path.length-2;y>=0;--y)t[_].unshift(f.path[y]);h=!0;break}}h||(t[n++]=f.path)}})}),t}function COe(e,t,n){var r=e.length,o=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],s=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u,l,c=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],f=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],_,h=e[t][n],d=e[t][n],p=d.cval,_=c[p],y=Yz(d,_);o.push([n+y[0],t+y[1]]),_=f[p],y=Yz(d,_),o.push([n+y[0],t+y[1]]),qee(d);for(var v=n+a[p],w=t+s[p],C=p;v>=0&&w>=0&&w<r&&(v!=n||w!=t)&&(d=e[w][v],!(typeof d>"u"));){if(p=d.cval,p===0||p===15)return{path:o,info:"mergeable"};_=f[p],u=a[p],l=s[p],(p===5||p===10)&&(p===5?d.flipped?s[C]===-1?(_="left",u=-1,l=0):(_="right",u=1,l=0):a[C]===-1&&(_="bottom",u=0,l=-1):p===10&&(d.flipped?a[C]===-1?(_="top",u=0,l=1):(_="bottom",u=0,l=-1):s[C]===1&&(_="left",u=-1,l=0))),y=Yz(d,_),o.push([v+y[0],w+y[1]]),qee(d),v+=u,w+=l,C=p}return{path:o,info:"closed"}}function xOe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;qd(e,"Point","input must contain Points");for(var a=wOe(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function wOe(e,t){var n={};mi(e,function(a){var s=St(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return St(l)[0]-St(c)[0]});return u}),o=r.sort(function(a,s){return t?St(a[0])[1]-St(s[0])[1]:St(s[0])[1]-St(a[0])[1]});return o}function EOe(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(qd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!yt(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(a))throw new Error("breaksProperties must be an Array");var s=xOe(e,{zProperty:r,flip:!0}),u=TOe(s,t,r,o,a),l=SOe(u,s,e);return kt(l)}function TOe(e,t,n,r,o){for(var a=[],s=1;s<t.length;s++){var u=+t[s],l=Object.assign({},r,o[s]);l[n]=u;var c=p_(gOe(e,u),l);a.push(c)}return a}function SOe(e,t,n){var r=Pa(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){$a(p,d)}),e}var AOe=Vne;function Vne(e,t,n,r,o){for(n=n||0,r=r||e.length-1,o=o||bOe;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));Vne(e,t,f,h,o)}var d=e[t],p=n,_=r;for(rA(e,n,t),o(e[r],d)>0&&rA(e,n,r);p<_;){for(rA(e,p,_),p++,_--;o(e[p],d)<0;)p++;for(;o(e[_],d)>0;)_--}o(e[n],d)===0?rA(e,n,_):(_++,rA(e,_,r)),_<=t&&(n=_+1),t<=_&&(r=_-1)}}function rA(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function bOe(e,t){return e<t?-1:e>t?1:0}var R1=kL;function kL(e,t){if(!(this instanceof kL))return new kL(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}kL.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!xL(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,xL(e,l)&&(t.leaf?n.push(u):jz(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!xL(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,xL(e,u)){if(t.leaf||jz(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=T1([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=IOe(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&jz(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:Wee,compareMinY:Yee,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=T1(e.slice(t,n+1)),w1(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=T1([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(Xee(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),Xee(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return w1(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=Xz(s),c=DOe(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),cA(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=T1(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,w1(n,this.toBBox),w1(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=T1([e,t]),this.data.height=e.height+1,this.data.leaf=!1,w1(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=lA(e,0,r,this.toBBox),a=lA(e,r,n,this.toBBox),s=POe(o,a),u=Xz(o)+Xz(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:Wee,o=e.leaf?this.compareMinY:Yee,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=lA(e,0,t,o),s=lA(e,n-t,n,o),u=CL(a)+CL(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],cA(a,e.leaf?o(c):c),u+=CL(a);for(l=n-t-1;l>=t;l--)c=e.children[l],cA(s,e.leaf?o(c):c),u+=CL(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)cA(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():w1(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function IOe(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function w1(e,t){lA(e,0,e.children.length,t,e)}function lA(e,t,n,r,o){o||(o=T1(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],cA(o,e.leaf?r(s):s);return o}function cA(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Wee(e,t){return e.minX-t.minX}function Yee(e,t){return e.minY-t.minY}function Xz(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function CL(e){return e.maxX-e.minX+(e.maxY-e.minY)}function DOe(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function POe(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function jz(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function xL(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function T1(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Xee(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,AOe(e,s,t,n,o),a.push(t,s,s,n))}function Bg(e,t){return t={exports:{}},e(t,t.exports),t.exports}var RL=MOe,jee=+(Math.pow(2,27)+1);function MOe(e,t,n){var r=e*t,o=jee*e,a=o-e,s=o-a,u=e-s,l=jee*t,c=l-t,f=l-c,h=t-f,d=r-s*f,p=d-u*f,_=p-s*h,y=u*h-_;return n?(n[0]=y,n[1]=r,n):[y,r]}var LOe=OOe;function ROe(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function OOe(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return ROe(e[0],t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=t[l],p=c(d),_,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=t[l],p=c(d))),u<n&&h<p||l>=r?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=t[l],p=c(d)));for(var v=_+y,w=v-_,C=y-w,E=C,S=v,A,D,P,M,b;u<n&&l<r;)h<p?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=t[l],p=c(d))),y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A;for(;u<n;)_=f,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)_=d,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,l+=1,l<r&&(d=t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var NOe=BOe;function BOe(e,t,n){var r=e+t,o=r-e,a=r-o,s=t-o,u=e-a;return n?(n[0]=u+s,n[1]=r,n):[u+s,r]}var FOe=zOe;function zOe(e,t){var n=e.length;if(n===1){var r=RL(e[0],t);return r[0]?r:[r[1]]}var o=new Array(2*n),a=[.1,.1],s=[.1,.1],u=0;RL(e[0],t,a),a[0]&&(o[u++]=a[0]);for(var l=1;l<n;++l){RL(e[l],t,s);var c=a[1];NOe(c,s[0],a),a[0]&&(o[u++]=a[0]);var f=s[1],h=a[1],d=f+h,p=d-f,_=h-p;a[1]=d,_&&(o[u++]=_)}return a[1]&&(o[u++]=a[1]),u===0&&(o[u++]=0),o.length=u,o}var VOe=GOe;function kOe(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function GOe(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return kOe(e[0],-t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=-t[l],p=c(d),_,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=-t[l],p=c(d))),u<n&&h<p||l>=r?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=-t[l],p=c(d)));for(var v=_+y,w=v-_,C=y-w,E=C,S=v,A,D,P,M,b;u<n&&l<r;)h<p?(_=f,u+=1,u<n&&(f=e[u],h=c(f))):(_=d,l+=1,l<r&&(d=-t[l],p=c(d))),y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A;for(;u<n;)_=f,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)_=d,y=E,v=_+y,w=v-_,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,b=S-P,E=b+M,S=A,l+=1,l<r&&(d=-t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var kne=Bg(function(e){var t=5,n=11102230246251565e-32,r=(3+16*n)*n,o=(7+56*n)*n;function a(v,w){for(var C=new Array(v.length-1),E=1;E<v.length;++E)for(var S=C[E-1]=new Array(v.length-1),A=0,D=0;A<v.length;++A)A!==w&&(S[D++]=v[E][A]);return C}function s(v){for(var w=new Array(v),C=0;C<v;++C){w[C]=new Array(v);for(var E=0;E<v;++E)w[C][E]=["m",E,"[",v-C-1,"]"].join("")}return w}function u(v){return v&1?"-":""}function l(v){if(v.length===1)return v[0];if(v.length===2)return["sum(",v[0],",",v[1],")"].join("");var w=v.length>>1;return["sum(",l(v.slice(0,w)),",",l(v.slice(w)),")"].join("")}function c(v){if(v.length===2)return[["sum(prod(",v[0][0],",",v[1][1],"),prod(-",v[0][1],",",v[1][0],"))"].join("")];for(var w=[],C=0;C<v.length;++C)w.push(["scale(",l(c(a(v,C))),",",u(C),v[0][C],")"].join(""));return w}function f(v){for(var w=[],C=[],E=s(v),S=[],A=0;A<v;++A)(A&1)===0?w.push.apply(w,c(a(E,A))):C.push.apply(C,c(a(E,A))),S.push("m"+A);var D=l(w),P=l(C),M="orientation"+v+"Exact",b=["function ",M,"(",S.join(),"){var p=",D,",n=",P,",d=sub(p,n);return d[d.length-1];};return ",M].join(""),O=new Function("sum","prod","scale","sub",b);return O(LOe,RL,FOe,VOe)}var h=f(3),d=f(4),p=[function(){return 0},function(){return 0},function(w,C){return C[0]-w[0]},function(w,C,E){var S=(w[1]-E[1])*(C[0]-E[0]),A=(w[0]-E[0])*(C[1]-E[1]),D=S-A,P;if(S>0){if(A<=0)return D;P=S+A}else if(S<0){if(A>=0)return D;P=-(S+A)}else return D;var M=r*P;return D>=M||D<=-M?D:h(w,C,E)},function(w,C,E,S){var A=w[0]-S[0],D=C[0]-S[0],P=E[0]-S[0],M=w[1]-S[1],b=C[1]-S[1],O=E[1]-S[1],m=w[2]-S[2],I=C[2]-S[2],L=E[2]-S[2],R=D*O,N=P*b,B=P*M,V=A*O,z=A*b,U=D*M,Q=m*(R-N)+I*(B-V)+L*(z-U),ne=(Math.abs(R)+Math.abs(N))*Math.abs(m)+(Math.abs(B)+Math.abs(V))*Math.abs(I)+(Math.abs(z)+Math.abs(U))*Math.abs(L),se=o*ne;return Q>se||-Q>se?Q:d(w,C,E,S)}];function _(v){var w=p[v.length];return w||(w=p[v.length]=f(v.length)),w.apply(void 0,v)}function y(){for(;p.length<=t;)p.push(f(p.length));for(var v=[],w=["slow"],C=0;C<=t;++C)v.push("a"+C),w.push("o"+C);for(var E=["function getOrientation(",v.join(),"){switch(arguments.length){case 0:case 1:return 0;"],C=2;C<=t;++C)E.push("case ",C,":return o",C,"(",v.slice(0,C).join(),");");E.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),w.push(E.join(""));var S=Function.apply(void 0,w);e.exports=S.apply(void 0,[_].concat(p));for(var C=0;C<=t;++C)e.exports[C]=p[C]}y()}),UOe=HOe,Kee=kne[3];function HOe(e){var t=e.length;if(t<3){for(var c=new Array(t),n=0;n<t;++n)c[n]=n;return t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:c}for(var r=new Array(t),n=0;n<t;++n)r[n]=n;r.sort(function(p,_){var y=e[p][0]-e[_][0];return y||e[p][1]-e[_][1]});for(var o=[r[0],r[1]],a=[r[0],r[1]],n=2;n<t;++n){for(var s=r[n],u=e[s],l=o.length;l>1&&Kee(e[o[l-2]],e[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(s),l=a.length;l>1&&Kee(e[a[l-2]],e[a[l-1]],u)>=0;)l-=1,a.pop();a.push(s)}for(var c=new Array(a.length+o.length-2),f=0,n=0,h=o.length;n<h;++n)c[f++]=o[n];for(var d=a.length-2;d>0;--d)c[f++]=a[d];return c}var Gne=vA,qOe=vA;function vA(e,t){if(!(this instanceof vA))return new vA(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||WOe,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function WOe(e,t){return e<t?-1:e>t?1:0}vA.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var o=e-1>>1,a=t[o];if(n(r,a)>=0)break;t[e]=a,e=o}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,o=t[e];e<r;){var a=(e<<1)+1,s=a+1,u=t[a];if(s<this.length&&n(t[s],u)<0&&(a=s,u=t[s]),n(u,o)>=0)break;t[e]=u,e=a}t[e]=o}};Gne.default=qOe;var YOe=function(e,t){for(var n=e[0],r=e[1],o=!1,a=0,s=t.length-1;a<t.length;s=a++){var u=t[a][0],l=t[a][1],c=t[s][0],f=t[s][1],h=l>r!=f>r&&n<(c-u)*(r-l)/(f-l)+u;h&&(o=!o)}return o},wL=kne[3],Une=Hne,XOe=Hne;function Hne(e,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;for(var r=JOe(e),o=R1(16,["[0]","[1]","[0]","[1]"]).load(e),a=[],s=0,u;s<r.length;s++){var l=r[s];o.remove(l),u=Jee(l,u),a.push(u)}var c=R1(16);for(s=0;s<a.length;s++)c.insert(Kz(a[s]));for(var f=t*t,h=n*n;a.length;){var d=a.shift(),p=d.p,_=d.next.p,y=Zz(p,_);if(!(y<h)){var v=y/f;l=jOe(o,d.prev.p,p,_,d.next.next.p,v,c),l&&Math.min(Zz(l,p),Zz(l,_))<=v&&(a.push(d),a.push(Jee(l,d)),o.remove(l),c.remove(d),c.insert(Kz(d)),c.insert(Kz(d.next)))}}d=u;var w=[];do w.push(d.p),d=d.next;while(d!==u);return w.push(d.p),w}function jOe(e,t,n,r,o,a,s){for(var u=new Gne(null,KOe),l=e.data;l;){for(var c=0;c<l.children.length;c++){var f=l.children[c],h=l.leaf?Qz(f,n,r):ZOe(n,r,f);h>a||u.push({node:f,dist:h})}for(;u.length&&!u.peek().node.children;){var d=u.pop(),p=d.node,_=Qz(p,t,n),y=Qz(p,r,o);if(d.dist<_&&d.dist<y&&Qee(n,p,s)&&Qee(r,p,s))return p}l=u.pop(),l&&(l=l.node)}return null}function KOe(e,t){return e.dist-t.dist}function ZOe(e,t,n){if(Zee(e,n)||Zee(t,n))return 0;var r=EL(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var o=EL(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(o===0)return 0;var a=EL(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var s=EL(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return s===0?0:Math.min(r,o,a,s)}function Zee(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function Qee(e,t,n){for(var r=Math.min(e[0],t[0]),o=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),s=Math.max(e[1],t[1]),u=n.search({minX:r,minY:o,maxX:a,maxY:s}),l=0;l<u.length;l++)if(QOe(u[l].p,u[l].next.p,e,t))return!1;return!0}function QOe(e,t,n,r){return e!==r&&t!==n&&wL(e,t,n)>0!=wL(e,t,r)>0&&wL(n,r,e)>0!=wL(n,r,t)>0}function Kz(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function JOe(e){for(var t=e[0],n=e[0],r=e[0],o=e[0],a=0;a<e.length;a++){var s=e[a];s[0]<t[0]&&(t=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>o[1]&&(o=s)}var u=[t,n,r,o],l=u.slice();for(a=0;a<e.length;a++)YOe(e[a],u)||l.push(e[a]);var c=UOe(l),f=[];for(a=0;a<c.length;a++)f.push(l[c[a]]);return f}function Jee(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function Zz(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function Qz(e,t,n){var r=t[0],o=t[1],a=n[0]-r,s=n[1]-o;if(a!==0||s!==0){var u=((e[0]-r)*a+(e[1]-o)*s)/(a*a+s*s);u>1?(r=n[0],o=n[1]):u>0&&(r+=a*u,o+=s*u)}return a=e[0]-r,s=e[1]-o,a*a+s*s}function EL(e,t,n,r,o,a,s,u){var l=n-e,c=r-t,f=s-o,h=u-a,d=e-o,p=t-a,_=l*l+c*c,y=l*f+c*h,v=f*f+h*h,w=l*d+c*p,C=f*d+h*p,E=_*v-y*y,S,A,D,P,M=E,b=E;E===0?(A=0,M=1,P=C,b=v):(A=y*C-v*w,P=_*C-y*w,A<0?(A=0,P=C,b=v):A>M&&(A=M,P=C+y,b=v)),P<0?(P=0,-w<0?A=0:-w>_?A=M:(A=-w,M=_)):P>b&&(P=b,-w+y<0?A=0:-w+y>_?A=M:(A=-w+y,M=_)),S=A===0?0:A/M,D=P===0?0:P/b;var O=(1-S)*e+S*n,m=(1-S)*t+S*r,I=(1-D)*o+D*s,L=(1-D)*a+D*u,R=I-O,N=L-m;return R*R+N*N}Une.default=XOe;function qne(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.concavity||1/0,r=[];if($a(e,function(a){r.push([a[0],a[1]])}),!r.length)return null;var o=Une(r,n);return o.length>3?ir([o]):null}function To(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=fo(e),a=St(t),s=t.geometry?t.geometry.type:t.type,u=t.bbox;if(u&&$Oe(o,u)===!1)return!1;s==="Polygon"&&(a=[a]);for(var l=0,c=!1;l<a.length&&!c;l++)if($ee(o,a[l][0],r)){for(var f=!1,h=1;h<a[l].length&&!f;)$ee(o,a[l][h],!r)&&(f=!0),h++;f||(c=!0)}return c}function $ee(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],u=t[o][1],l=t[a][0],c=t[a][1],f=e[1]*(s-l)+u*(l-e[0])+c*(e[0]-s)===0&&(s-e[0])*(l-e[0])<=0&&(u-e[1])*(c-e[1])<=0;if(f)return!n;var h=u>e[1]!=c>e[1]&&e[0]<(l-s)*(e[1]-u)/(c-u)+s;h&&(r=!r)}return r}function $Oe(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function h4(e,t){var n=[];return Hh(t,function(r){mi(e,function(o){To(o,r)&&n.push(o)})}),kt(n)}function Wne(e,t){if(e.type!=="FeatureCollection")throw new Error("points must be a FeatureCollection");var n=!1;return kt(nNe(e.features.map(function(r){var o={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1]};return t?o.z=r.properties[t]:r.geometry.coordinates.length===3&&(n=!0,o.z=r.geometry.coordinates[2]),o})).map(function(r){var o=[r.a.x,r.a.y],a=[r.b.x,r.b.y],s=[r.c.x,r.c.y],u={};return n?(o.push(r.a.z),a.push(r.b.z),s.push(r.c.z)):u={a:r.a.z,b:r.b.z,c:r.c.z},ir([[o,a,s,o]],u)}))}function ete(e,t,n){this.a=e,this.b=t,this.c=n;var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,u=r*(e.x+t.x)+o*(e.y+t.y),l=a*(e.x+n.x)+s*(e.y+n.y),c=2*(r*(n.y-t.y)-o*(n.x-t.x)),f,h;this.x=(s*u-o*l)/c,this.y=(r*l-a*u)/c,f=this.x-e.x,h=this.y-e.y,this.r=f*f+h*h}function eNe(e,t){return t.x-e.x}function tNe(e){var t=e.length,n,r,o,a,s;e:for(;t;)for(r=e[--t],n=e[--t],o=t;o;)if(s=e[--o],a=e[--o],n===a&&r===s||n===s&&r===a){e.splice(t,2),e.splice(o,2),t-=2;continue e}}function nNe(e){if(e.length<3)return[];e.sort(eNe);for(var t=e.length-1,n=e[t].x,r=e[0].x,o=e[t].y,a=o,s=1e-12,u,l,c,f,h,d;t--;)e[t].y<o&&(o=e[t].y),e[t].y>a&&(a=e[t].y);var p=r-n,_=a-o,y=p>_?p:_,v=(r+n)*.5,w=(a+o)*.5,C=[new ete({x:v-20*y,y:w-y,__sentinel:!0},{x:v,y:w+20*y,__sentinel:!0},{x:v+20*y,y:w-y,__sentinel:!0})],E=[],S=[],A;for(t=e.length;t--;){for(S.length=0,A=C.length;A--;){if(p=e[t].x-C[A].x,p>0&&p*p>C[A].r){E.push(C[A]),C.splice(A,1);continue}_=e[t].y-C[A].y,!(p*p+_*_>C[A].r)&&(S.push(C[A].a,C[A].b,C[A].b,C[A].c,C[A].c,C[A].a),C.splice(A,1))}for(tNe(S),A=S.length;A;)l=S[--A],u=S[--A],c=e[t],f=l.x-u.x,h=l.y-u.y,d=2*(f*(c.y-l.y)-h*(c.x-l.x)),Math.abs(d)>s&&C.push(new ete(u,l,c))}for(Array.prototype.push.apply(E,C),t=E.length;t--;)(E[t].a.__sentinel||E[t].b.__sentinel||E[t].c.__sentinel)&&E.splice(t,1);return E}function di(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.units,o=fo(e),a=fo(t),s=Ja(a[1]-o[1]),u=Ja(a[0]-o[0]),l=Ja(o[1]),c=Ja(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return L1(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r)}function Su(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return Yne(e);case"FeatureCollection":return rNe(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return V4(e);default:throw new Error("unknown GeoJSON type")}}function Yne(e){var t={type:"Feature"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}}),t.properties=Xne(e.properties),t.geometry=V4(e.geometry),t}function Xne(e){var t={};return e&&Object.keys(e).forEach(function(n){var r=e[n];typeof r=="object"?r===null?t[n]=null:r.length?t[n]=r.map(function(o){return o}):t[n]=Xne(r):t[n]=r}),t}function rNe(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}}),t.features=e.features.map(function(n){return Yne(n)}),t}function V4(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(function(n){return V4(n)}),t):(t.coordinates=jne(e.coordinates),t)}function jne(e){return typeof e[0]!="object"?e.slice():e.map(function(t){return jne(t)})}var iNe=function(e){return e},oNe=function(e){if(e==null)return iNe;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f);for(h[0]=(t+=u[0])*r+a,h[1]=(n+=u[1])*o+s;c<f;)h[c]=u[c],++c;return h}},aNe=function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n};function Kne(e,t){var n=oNe(e.transform),r=e.arcs;function o(f,h){h.length&&h.pop();for(var d=r[f<0?~f:f],p=0,_=d.length;p<_;++p)h.push(n(d[p],p));f<0&&aNe(h,_)}function a(f){return n(f)}function s(f){for(var h=[],d=0,p=f.length;d<p;++d)o(f[d],h);return h.length<2&&h.push(h[0]),h}function u(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function l(f){return f.map(u)}function c(f){var h=f.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":d=a(f.coordinates);break;case"MultiPoint":d=f.coordinates.map(a);break;case"LineString":d=s(f.arcs);break;case"MultiLineString":d=f.arcs.map(s);break;case"Polygon":d=l(f.arcs);break;case"MultiPolygon":d=f.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(t)}var sNe=function(e,t){var n={},r={},o={},a=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=t[++s],t[s]=c,t[f]=d)}),t.forEach(function(c){var f=u(c),h=f[0],d=f[1],p,_;if(p=o[h])if(delete o[p.end],p.push(c),p.end=d,_=r[d]){delete r[_.start];var y=_===p?p:p.concat(_);r[y.start=p.start]=o[y.end=_.end]=y}else r[p.start]=o[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(c),p.start=h,_=o[h]){delete o[_.end];var v=_===p?p:_.concat(p);r[v.start=_.start]=o[v.end=p.end]=v}else r[p.start]=o[p.end]=p;else p=[c],r[p.start=h]=o[p.end=d]=p});function u(c){var f=e.arcs[c<0?~c:c],h=f[0],d;return e.transform?(d=[0,0],f.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=f[f.length-1],c<0?[d,h]:[h,d]}function l(c,f){for(var h in c){var d=c[h];delete f[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),a.push(d)}}return l(o,r),l(r,o),t.forEach(function(c){n[c<0?~c:c]||a.push([c])}),a};function uNe(e){for(var t=-1,n=e.length,r,o=e[n-1],a=0;++t<n;)r=o,o=e[t],a+=r[0]*o[1]-r[1]*o[0];return Math.abs(a)}var lNe=function(e){return Kne(e,cNe.apply(this,arguments))};function cNe(e,t){var n={},r=[],o=[];t.forEach(a);function a(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(a);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(c){c.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),r.push(l)}function u(l){return uNe(Kne(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return r.forEach(function(l){if(!l._){var c=[],f=[l];for(l._=1,o.push(c);l=f.pop();)c.push(l),l.forEach(function(h){h.forEach(function(d){n[d<0?~d:d].forEach(function(p){p._||(p._=1,f.push(p))})})})}}),r.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:o.map(function(l){var c=[],f;if(l.forEach(function(y){y.forEach(function(v){v.forEach(function(w){n[w<0?~w:w].length<2&&c.push(w)})})}),c=sNe(e,c),(f=c.length)>1)for(var h=1,d=u(c[0]),p,_;h<f;++h)(p=u(c[h]))>d&&(_=c[0],c[0]=c[h],c[h]=_,d=p);return c})}}var fNe=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;function a(h){h!=null&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},Point:function(h){u(h.coordinates)},MultiPoint:function(h){h.coordinates.forEach(u)},LineString:function(h){l(h.arcs)},MultiLineString:function(h){h.arcs.forEach(l)},Polygon:function(h){h.arcs.forEach(l)},MultiPolygon:function(h){h.arcs.forEach(c)}};function u(h){var d=h[0],p=h[1];d<t&&(t=d),d>r&&(r=d),p<n&&(n=p),p>o&&(o=p)}function l(h){h.forEach(u)}function c(h){h.forEach(l)}for(var f in e)a(e[f]);return r>=t&&o>=n?[t,n,r,o]:void 0},hNe=function(e,t,n,r,o){arguments.length===3&&(r=Array,o=null);for(var a=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,u=0;u<e;++u)a[u]=o;function l(h){for(var d=t(h)&s,p=a[d],_=0;p!=o;){if(n(p,h))return!0;if(++_>=e)throw new Error("full hashset");p=a[d=d+1&s]}return a[d]=h,!0}function c(h){for(var d=t(h)&s,p=a[d],_=0;p!=o;){if(n(p,h))return!0;if(++_>=e)break;p=a[d=d+1&s]}return!1}function f(){for(var h=[],d=0,p=a.length;d<p;++d){var _=a[d];_!=o&&h.push(_)}return h}return{add:l,has:c,values:f}},k4=function(e,t,n,r,o,a){arguments.length===3&&(r=a=Array,o=null);for(var s=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new a(e),l=e-1,c=0;c<e;++c)s[c]=o;function f(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v]=y;if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=_,u[v]=y,y}function h(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v];if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=_,u[v]=y,y}function d(_,y){for(var v=t(_)&l,w=s[v],C=0;w!=o;){if(n(w,_))return u[v];if(++C>=e)break;w=s[v=v+1&l]}return y}function p(){for(var _=[],y=0,v=s.length;y<v;++y){var w=s[y];w!=o&&_.push(w)}return _}return{set:f,maybeSet:h,get:d,keys:p}},fv=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zne=new ArrayBuffer(16),tte=new Float64Array(Zne),TL=new Uint32Array(Zne),d4=function(e){tte[0]=e[0],tte[1]=e[1];var t=TL[0]^TL[1];return t=t<<5^t>>7^TL[2]^TL[3],t&2147483647},dNe=function(e){var t=e.coordinates,n=e.lines,r=e.rings,o=D(),a=new Int32Array(t.length),s=new Int32Array(t.length),u=new Int32Array(t.length),l=new Int8Array(t.length),c=0,f,h,d,p,_;for(f=0,h=t.length;f<h;++f)a[f]=s[f]=u[f]=-1;for(f=0,h=n.length;f<h;++f){var y=n[f],v=y[0],w=y[1];for(p=o[v],_=o[++v],++c,l[p]=1;++v<=w;)A(f,d=p,p=_,_=o[v]);++c,l[_]=1}for(f=0,h=t.length;f<h;++f)a[f]=-1;for(f=0,h=r.length;f<h;++f){var C=r[f],E=C[0]+1,S=C[1];for(d=o[S-1],p=o[E-1],_=o[E],A(f,d,p,_);++E<=S;)A(f,d=p,p=_,_=o[E])}function A(m,I,L,R){if(a[L]!==m){a[L]=m;var N=s[L];if(N>=0){var B=u[L];(N!==I||B!==R)&&(N!==R||B!==I)&&(++c,l[L]=1)}else s[L]=I,u[L]=R}}function D(){for(var m=k4(t.length*1.4,P,M,Int32Array,-1,Int32Array),I=new Int32Array(t.length),L=0,R=t.length;L<R;++L)I[L]=m.maybeSet(L,L);return I}function P(m){return d4(t[m])}function M(m,I){return fv(t[m],t[I])}a=s=u=null;var b=hNe(c*1.4,d4,fv),O;for(f=0,h=t.length;f<h;++f)l[O=o[f]]&&b.add(t[O]);return b},pNe=function(e){var t=dNe(e),n=e.coordinates,r=e.lines,o=e.rings,a,s,u;for(s=0,u=r.length;s<u;++s)for(var l=r[s],c=l[0],f=l[1];++c<f;)t.has(n[c])&&(a={0:c,1:l[1]},l[1]=c,l=l.next=a);for(s=0,u=o.length;s<u;++s)for(var h=o[s],d=h[0],p=d,_=h[1],y=t.has(n[d]);++p<_;)t.has(n[p])&&(y?(a={0:p,1:h[1]},h[1]=p,h=h.next=a):(mNe(n,d,_,_-p),n[_]=n[d],y=!0,p=d));return e};function mNe(e,t,n,r){Jz(e,t,n),Jz(e,t,t+r),Jz(e,t+r,n)}function Jz(e,t,n){for(var r=t+(n---t>>1),o;t<r;++t,--n)o=e[t],e[t]=e[n],e[n]=o}var gNe=function(e){var t=e.coordinates,n=e.lines,r,o=e.rings,a,s=n.length+o.length,u,l;for(delete e.lines,delete e.rings,u=0,l=n.length;u<l;++u)for(r=n[u];r=r.next;)++s;for(u=0,l=o.length;u<l;++u)for(a=o[u];a=a.next;)++s;var c=k4(s*2*1.4,d4,fv),f=e.arcs=[];for(u=0,l=n.length;u<l;++u){r=n[u];do h(r);while(r=r.next)}for(u=0,l=o.length;u<l;++u)if(a=o[u],a.next)do h(a);while(a=a.next);else d(a);function h(C){var E,S,A,D,P,M,b,O;if(A=c.get(E=t[C[0]])){for(b=0,O=A.length;b<O;++b)if(D=A[b],p(D,C)){C[0]=D[0],C[1]=D[1];return}}if(P=c.get(S=t[C[1]])){for(b=0,O=P.length;b<O;++b)if(M=P[b],_(M,C)){C[1]=M[0],C[0]=M[1];return}}A?A.push(C):c.set(E,[C]),P?P.push(C):c.set(S,[C]),f.push(C)}function d(C){var E,S,A,D,P;if(S=c.get(E=t[C[0]]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}if(S=c.get(E=t[C[0]+w(C)]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}S?S.push(C):c.set(E,[C]),f.push(C)}function p(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,++A)if(!fv(t[S],t[A]))return!1;return!0}function _(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,--P)if(!fv(t[S],t[P]))return!1;return!0}function y(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var b=w(C),O=w(E),m=0;m<M;++m)if(!fv(t[S+(m+b)%M],t[A+(m+O)%M]))return!1;return!0}function v(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var b=w(C),O=M-w(E),m=0;m<M;++m)if(!fv(t[S+(m+b)%M],t[P-(m+O)%M]))return!1;return!0}function w(C){for(var E=C[0],S=C[1],A=E,D=A,P=t[A];++A<S;){var M=t[A];(M[0]<P[0]||M[0]===P[0]&&M[1]<P[1])&&(D=A,P=M)}return D-E}return e},_Ne=function(e){for(var t=-1,n=e.length;++t<n;){for(var r=e[t],o=0,a=1,s=r.length,u=r[0],l=u[0],c=u[1],f,h;++o<s;)u=r[o],f=u[0],h=u[1],(f!==l||h!==c)&&(r[a++]=[f-l,h-c],l=f,c=h);a===1&&(r[a++]=[0,0]),r.length=a}return e},yNe=function(e){var t=-1,n=[],r=[],o=[];function a(h){h&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},LineString:function(h){h.arcs=u(h.arcs)},MultiLineString:function(h){h.arcs=h.arcs.map(u)},Polygon:function(h){h.arcs=h.arcs.map(l)},MultiPolygon:function(h){h.arcs=h.arcs.map(c)}};function u(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var _={0:t-p+1,1:t};return n.push(_),_}function l(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var _={0:t-p+1,1:t};return r.push(_),_}function c(h){return h.map(l)}for(var f in e)a(e[f]);return{type:"Topology",coordinates:o,lines:n,rings:r,objects:e}},vNe=function(e){var t={},n;for(n in e)t[n]=CNe(e[n]);return t};function CNe(e){return e==null?{type:null}:(e.type==="FeatureCollection"?xNe:e.type==="Feature"?Qne:G4)(e)}function xNe(e){var t={type:"GeometryCollection",geometries:e.features.map(Qne)};return e.bbox!=null&&(t.bbox=e.bbox),t}function Qne(e){var t=G4(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function G4(e){if(e==null)return{type:null};var t=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map(G4)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(t.bbox=e.bbox),t}var wNe=function(e,t,n){var r=t[0],o=t[1],a=t[2],s=t[3],u=a-r?(n-1)/(a-r):1,l=s-o?(n-1)/(s-o):1;function c(w){return[Math.round((w[0]-r)*u),Math.round((w[1]-o)*l)]}function f(w,C){for(var E=-1,S=0,A=w.length,D=new Array(A),P,M,b,O,m;++E<A;)P=w[E],O=Math.round((P[0]-r)*u),m=Math.round((P[1]-o)*l),(O!==M||m!==b)&&(D[S++]=[M=O,b=m]);for(D.length=S;S<C;)S=D.push([D[0][0],D[0][1]]);return D}function h(w){return f(w,2)}function d(w){return f(w,4)}function p(w){return w.map(d)}function _(w){w!=null&&y.hasOwnProperty(w.type)&&y[w.type](w)}var y={GeometryCollection:function(w){w.geometries.forEach(_)},Point:function(w){w.coordinates=c(w.coordinates)},MultiPoint:function(w){w.coordinates=w.coordinates.map(c)},LineString:function(w){w.arcs=h(w.arcs)},MultiLineString:function(w){w.arcs=w.arcs.map(h)},Polygon:function(w){w.arcs=p(w.arcs)},MultiPolygon:function(w){w.arcs=w.arcs.map(p)}};for(var v in e)_(e[v]);return{scale:[1/u,1/l],translate:[r,o]}},ENe=function(e,t){var n=fNe(e=vNe(e)),r=t>0&&n&&wNe(e,n,t),o=gNe(pNe(yNe(e))),a=o.coordinates,s=k4(o.arcs.length*1.4,TNe,SNe);e=o.objects,o.bbox=n,o.arcs=o.arcs.map(function(d,p){return s.set(d,p),a.slice(d[0],d[1]+1)}),delete o.coordinates,a=null;function u(d){d&&l.hasOwnProperty(d.type)&&l[d.type](d)}var l={GeometryCollection:function(d){d.geometries.forEach(u)},LineString:function(d){d.arcs=c(d.arcs)},MultiLineString:function(d){d.arcs=d.arcs.map(c)},Polygon:function(d){d.arcs=d.arcs.map(c)},MultiPolygon:function(d){d.arcs=d.arcs.map(f)}};function c(d){var p=[];do{var _=s.get(d);p.push(d[0]<d[1]?_:~_)}while(d=d.next);return p}function f(d){return d.map(c)}for(var h in e)u(e[h]);return r&&(o.transform=r,o.arcs=_Ne(o.arcs)),o};function TNe(e){var t=e[0],n=e[1],r;return n<t&&(r=t,t=n,n=r),t+31*n}function SNe(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s;return r<n&&(s=n,n=r,r=s),a<o&&(s=o,o=a,a=s),n===o&&r===a}function ANe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.mutate;if(ki(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=Su(e));var r=[],o=z4(e,function(a,s){var u=bNe(a,s);return u||(r.push(a),s)});return o&&r.push(o),r.length?r.length===1?r[0]:p_(r.map(function(a){return a.coordinates})):null}function SL(e){return e[0].toString()+","+e[1].toString()}function bNe(e,t){var n=e.geometry.coordinates,r=t.geometry.coordinates,o=SL(n[0]),a=SL(n[n.length-1]),s=SL(r[0]),u=SL(r[r.length-1]),l;if(o===u)l=r.concat(n.slice(1));else if(s===a)l=n.concat(r.slice(1));else if(o===s)l=n.slice(1).reverse().concat(r);else if(a===u)l=n.concat(r.reverse().slice(1));else return null;return Vi(l)}function INe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.mutate;if(ki(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=Su(e));var r=[];Da(e,function(a){r.push(a.geometry)});var o=ENe({geoms:L4(r).geometry});return lNe(o,o.objects.geoms.geometries)}function DNe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.mutate;if(ki(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=Su(e));var r=PNe(e);if(!r)throw new Error("geojson must be homogenous");switch(r){case"LineString":return ANe(e,t);case"Polygon":return INe(e,t);default:throw new Error(r+" is not supported")}}function PNe(e){var t={};Da(e,function(r){t[r.geometry.type]=!0});var n=Object.keys(t);return n.length===1?n[0]:null}function MNe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");if(!e)throw new Error("points is required");var n=t.maxEdge||1/0;if(!pi(n))throw new Error("maxEdge is invalid");var r=LNe(e),o=Wne(r);if(o.features=o.features.filter(function(s){var u=s.geometry.coordinates[0][0],l=s.geometry.coordinates[0][1],c=s.geometry.coordinates[0][2],f=di(u,l,t),h=di(l,c,t),d=di(u,c,t);return f<=n&&h<=n&&d<=n}),o.features.length<1)return null;var a=DNe(o,t);return a.coordinates.length===1&&(a.coordinates=a.coordinates[0],a.type="Polygon"),ha(a)}function LNe(e){var t=[],n={};return mi(e,function(r){if(!!r.geometry){var o=r.geometry.coordinates.join("-");n.hasOwnProperty(o)||(t.push(r),n[o]=!0)}}),kt(t)}function RNe(e,t,n,r){var o=R1(6),a=t.features.map(function(s){return{minX:s.geometry.coordinates[0],minY:s.geometry.coordinates[1],maxX:s.geometry.coordinates[0],maxY:s.geometry.coordinates[1],property:s.properties[n]}});return o.load(a),e.features.forEach(function(s){s.properties||(s.properties={});var u=Pa(s),l=o.search({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}),c=[];l.forEach(function(f){To([f.minX,f.minY],s)&&c.push(f.property)}),s.properties[r]=c}),e}function ONe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.mutate;if(!e)throw new Error("geojson is required");return(n===!1||n===void 0)&&(e=Su(e)),$a(e,function(r){var o=r[0],a=r[1];r[0]=a,r[1]=o}),e}function Ag(e,t){var n=typeof t=="object"?t.mutate:t;if(!e)throw new Error("geojson is required");var r=ki(e),o=[];switch(r){case"LineString":o=$z(e);break;case"MultiLineString":case"Polygon":St(e).forEach(function(s){o.push($z(s))});break;case"MultiPolygon":St(e).forEach(function(s){var u=[];s.forEach(function(l){u.push($z(l))}),o.push(u)});break;case"Point":return e;case"MultiPoint":var a={};St(e).forEach(function(s){var u=s.join("-");a.hasOwnProperty(u)||(o.push(s),a[u]=!0)});break;default:throw new Error(r+" geometry not supported")}return e.coordinates?n===!0?(e.coordinates=o,e):{type:r,coordinates:o}:n===!0?(e.geometry.coordinates=o,e):ha({type:r,coordinates:o},e.properties,e.bbox,e.id)}function $z(e){var t=St(e);if(t.length===2&&!NNe(t[0],t[1]))return t;var n,r,o,a=[],s=t.length-1;a.push(t[0]);for(var u=1;u<s;u++)n=t[u-1],r=t[u],o=t[u+1],BNe(n,o,r)||a.push(r);return a.push(o),a}function NNe(e,t){return e[0]===t[0]&&e[1]===t[1]}function BNe(e,t,n){var r=n[0],o=n[1],a=e[0],s=e[1],u=t[0],l=t[1],c=r-a,f=o-s,h=u-a,d=l-s,p=c*d-f*h;return p!==0?!1:Math.abs(h)>=Math.abs(d)?h>0?a<=r&&r<=u:u<=r&&r<=a:d>0?s<=o&&o<=l:l<=o&&o<=s}function FNe(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function zNe(e,t,n){var r=t.x,o=t.y,a=n.x-r,s=n.y-o;if(a!==0||s!==0){var u=((e.x-r)*a+(e.y-o)*s)/(a*a+s*s);u>1?(r=n.x,o=n.y):u>0&&(r+=a*u,o+=s*u)}return a=e.x-r,s=e.y-o,a*a+s*s}function VNe(e,t){for(var n=e[0],r=[n],o,a=1,s=e.length;a<s;a++)o=e[a],FNe(o,n)>t&&(r.push(o),n=o);return n!==o&&r.push(o),r}function p4(e,t,n,r,o){for(var a=r,s,u=t+1;u<n;u++){var l=zNe(e[u],e[t],e[n]);l>a&&(s=u,a=l)}a>r&&(s-t>1&&p4(e,t,s,r,o),o.push(e[s]),n-s>1&&p4(e,s,n,r,o))}function kNe(e,t){var n=e.length-1,r=[e[0]];return p4(e,0,n,t,r),r.push(e[n]),r}function m4(e,t,n){if(e.length<=2)return e;var r=t!==void 0?t*t:1;return e=n?e:VNe(e,r),e=kNe(e,r),e}function GNe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.tolerance!==void 0?t.tolerance:1,r=t.highQuality||!1,o=t.mutate||!1;if(!e)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return o!==!0&&(e=Su(e)),Hh(e,function(a){UNe(a,n,r)}),e}function UNe(e,t,n){var r=e.type;if(r==="Point"||r==="MultiPoint")return e;Ag(e,!0);var o=e.coordinates;switch(r){case"LineString":e.coordinates=nte(o,t,n);break;case"MultiLineString":e.coordinates=o.map(function(a){return nte(a,t,n)});break;case"Polygon":e.coordinates=rte(o,t,n);break;case"MultiPolygon":e.coordinates=o.map(function(a){return rte(a,t,n)})}return e}function nte(e,t,n){return m4(e.map(function(r){return{x:r[0],y:r[1],z:r[2]}}),t,n).map(function(r){return r.z?[r.x,r.y,r.z]:[r.x,r.y]})}function rte(e,t,n){return e.map(function(r){var o=r.map(function(s){return{x:s[0],y:s[1]}});if(o.length<4)throw new Error("invalid polygon");for(var a=m4(o,t,n).map(function(s){return[s.x,s.y]});!HNe(a);)t-=t*.01,a=m4(o,t,n).map(function(s){return[s.x,s.y]});return(a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),a})}function HNe(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var lR=function(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],r=this.points[t+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var n=this.centers[t],r=this.centers[t+1],o=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,a=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,s=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+s)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};lR.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var o=this.pos(r),a=Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)+(o.z-n.z)*(o.z-n.z));a>e&&(t.push(r),n=o)}return t};lR.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}};lR.prototype.pos=function(e){function t(s,u,l,c,f){var h=function(_){var y=_*_,v=y*_;return[v,3*y*(1-_),3*_*(1-_)*(1-_),(1-_)*(1-_)*(1-_)]},d=h(s),p={x:f.x*d[0]+c.x*d[1]+l.x*d[2]+u.x*d[3],y:f.y*d[0]+c.y*d[1]+l.y*d[2]+u.y*d[3],z:f.z*d[0]+c.z*d[1]+l.z*d[2]+u.z*d[3]};return p}var n=e-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);var r=n/this.duration;if(r>=1)return this.points[this.length-1];var o=Math.floor((this.points.length-1)*r),a=(this.length-1)*r-o;return t(a,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])};function ite(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.resolution||1e4,r=t.sharpness||.85;if(!e)throw new Error("line is required");if(!pi(n))throw new Error("resolution must be an number");if(!pi(r))throw new Error("sharpness must be an number");for(var o=[],a=new lR({points:ic(e).coordinates.map(function(l){return{x:l[0],y:l[1]}}),duration:n,sharpness:r}),s=0;s<a.duration;s+=10){var u=a.pos(s);Math.floor(s/100)%2===0&&o.push([u.x,u.y])}return Vi(o,e.properties)}function qNe(e,t,n,r){return e=Su(e),t=Su(t),mi(e,function(o){o.properties||(o.properties={}),mi(t,function(a){o.properties[r]===void 0&&To(o,a)&&(o.properties[r]=a.properties[n])})}),e}function WNe(e,t){if(!e)throw new Error("featurecollection is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var n=kt(YNe(e.features,t));return n}function YNe(e,t){for(var n=e.slice(0),r=e.length,o=r-t,a,s;r-- >o;)s=Math.floor((r+1)*Math.random()),a=n[s],n[s]=n[r],n[r]=a;return n.slice(o)}function U4(e){rw(e);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]),o=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[t,n],s=[t,o],u=[r,o],l=[r,n];return ir([[a,l,u,s,a]])}function Jne(e){return U4(Pa(e))}function $ne(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=di(e.slice(0,2),[r,n]),s=di(e.slice(0,2),[t,o]);if(a>=s){var u=(n+o)/2;return[t,u-(r-t)/2,r,u+(r-t)/2]}else{var l=(t+r)/2;return[l-(o-n)/2,n,l+(o-n)/2,o]}}function em(e,t,n,r){if(r=r||{},!yt(r))throw new Error("options is invalid");var o=r.units,a=r.properties,s=fo(e),u=Ja(s[0]),l=Ja(s[1]),c=Ja(n),f=pv(t,o),h=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(c)),d=u+Math.atan2(Math.sin(c)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(h)),p=r_(d),_=r_(h);return Yr([p,_],a)}function H4(e,t,n){n=n||{};var r=n.steps||64,o=n.properties;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be a number");r=r||64,o=o||e.properties||{};for(var a=[],s=0;s<r;s++)a.push(em(e,t,s*-360/r,n).geometry.coordinates);return a.push(a[0]),ir([a],o)}function Qp(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.final;if(r===!0)return XNe(e,t);var o=fo(e),a=fo(t),s=Ja(o[0]),u=Ja(a[0]),l=Ja(o[1]),c=Ja(a[1]),f=Math.sin(u-s)*Math.cos(c),h=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-s);return r_(Math.atan2(f,h))}function XNe(e,t){var n=Qp(t,e);return n=(n+180)%360,n}function jNe(e,t){var n=di(e,t),r=Qp(e,t),o=em(e,n/2,r);return o}function cR(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.properties;if(!e)throw new Error("geojson is required");var r=Pa(e),o=(r[0]+r[2])/2,a=(r[1]+r[3])/2;return Yr([o,a],n)}function gv(e,t){var n=0,r=0,o=0;return $a(e,function(a){n+=a[0],r+=a[1],o++},!0),Yr([n/o,r/o],t)}function ere(e,t){switch(ki(e)){case"Point":return e;case"Polygon":var n=[];$a(e,function(S){n.push(S)});var r=gv(e,t),o=r.geometry.coordinates,a=0,s=0,u=0,l,c,f,h,d,p,_,y,v=n.map(function(S){return[S[0]-o[0],S[1]-o[1]]});for(l=0;l<n.length-1;l++)c=v[l],h=c[0],p=c[1],f=v[l+1],d=f[0],_=f[1],y=h*_-d*p,u+=y,a+=(h+d)*y,s+=(p+_)*y;if(u===0)return r;var w=u*.5,C=1/(6*w);return Yr([o[0]+C*a,o[1]+C*s],t);default:var E=qne(e);return E?ere(E,t):gv(e,t)}}function KNe(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(t).reduce(function(o,a){return o[a.replace("Multi","")]=a,o},{});function r(o,a,s){s?t[a].coordinates=t[a].coordinates.concat(o.geometry.coordinates):t[a].coordinates.push(o.geometry.coordinates),t[a].properties.push(o.properties)}return mi(e,function(o){!o.geometry||(t[o.geometry.type]?r(o,o.geometry.type,!0):n[o.geometry.type]&&r(o,n[o.geometry.type],!1))}),kt(Object.keys(t).filter(function(o){return t[o].coordinates.length}).sort().map(function(o){var a={type:o,coordinates:t[o].coordinates},s={collectedProperties:t[o].properties};return ha(a,s)}))}function q4(e){var t=[];return e.type==="FeatureCollection"?mi(e,function(n){$a(n,function(r){t.push(Yr(r,n.properties))})}):$a(e,function(n){t.push(Yr(n,e.properties))}),kt(t)}var tre=fR,ZNe=fR;function fR(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=nre(e,0,o,n,!0),s=[];if(!a)return s;var u,l,c,f,h,d,p;if(r&&(a=t2e(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var _=n;_<o;_+=n)h=e[_],d=e[_+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?1/p:0}return xA(a,s,n,u,l,p),s}function nre(e,t,n,r,o){var a,s;if(o===y4(e,t,n,r)>0)for(a=t;a<n;a+=r)s=ote(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=ote(a,e[a],e[a+1],s);return s&&hv(s,s.next)&&(EA(s),s=s.next),s}function CA(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(hv(n,n.next)||nc(n.prev,n,n.next)===0)){if(EA(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function xA(e,t,n,r,o,a,s){if(!!e){!s&&a&&o2e(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?JNe(e,r,o,a):QNe(e)){t.push(l.i/n),t.push(e.i/n),t.push(c.i/n),EA(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=$Ne(e,t,n),xA(e,t,n,r,o,a,2)):s===2&&e2e(e,t,n,r,o,a):xA(CA(e),t,n,r,o,a,1);break}}}}function QNe(e){var t=e.prev,n=e,r=e.next;if(nc(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(GL(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&nc(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function JNe(e,t,n,r){var o=e.prev,a=e,s=e.next;if(nc(o,a,s)>=0)return!1;for(var u=o.x<a.x?o.x<s.x?o.x:s.x:a.x<s.x?a.x:s.x,l=o.y<a.y?o.y<s.y?o.y:s.y:a.y<s.y?a.y:s.y,c=o.x>a.x?o.x>s.x?o.x:s.x:a.x>s.x?a.x:s.x,f=o.y>a.y?o.y>s.y?o.y:s.y:a.y>s.y?a.y:s.y,h=g4(u,l,t,n,r),d=g4(c,f,t,n,r),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&GL(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&nc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&GL(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&nc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function $Ne(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!hv(o,a)&&rre(o,r,r.next,a)&&wA(o,a)&&wA(a,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(a.i/n),EA(r),EA(r.next),r=e=a),r=r.next}while(r!==e);return r}function e2e(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&u2e(s,u)){var l=ire(s,u);s=CA(s,s.next),l=CA(l,l.next),xA(s,t,n,r,o,a),xA(l,t,n,r,o,a);return}u=u.next}s=s.next}while(s!==e)}function t2e(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=nre(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(s2e(c));for(o.sort(n2e),a=0;a<o.length;a++)r2e(o[a],n),n=CA(n,n.next);return n}function n2e(e,t){return e.x-t.x}function r2e(e,t){if(t=i2e(e,t),t){var n=ire(t,e);CA(n,n.next)}}function i2e(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a){if(a=u,u===r){if(o===n.y)return n;if(o===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(r===a)return s.prev;var l=s,c=s.x,f=s.y,h=1/0,d;for(n=s.next;n!==l;)r>=n.x&&n.x>=c&&r!==n.x&&GL(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),(d<h||d===h&&n.x>s.x)&&wA(n,e)&&(s=n,h=d)),n=n.next;return s}function o2e(e,t,n,r){var o=e;do o.z===null&&(o.z=g4(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,a2e(o)}function a2e(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function g4(e,t,n,r,o){return e=32767*(e-n)*o,t=32767*(t-r)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function s2e(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function GL(e,t,n,r,o,a,s,u){return(o-s)*(t-u)-(e-s)*(a-u)>=0&&(e-s)*(r-u)-(n-s)*(t-u)>=0&&(n-s)*(a-u)-(o-s)*(r-u)>=0}function u2e(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!l2e(e,t)&&wA(e,t)&&wA(t,e)&&c2e(e,t)}function nc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function hv(e,t){return e.x===t.x&&e.y===t.y}function rre(e,t,n,r){return hv(e,t)&&hv(n,r)||hv(e,r)&&hv(n,t)?!0:nc(e,t,n)>0!=nc(e,t,r)>0&&nc(n,r,e)>0!=nc(n,r,t)>0}function l2e(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&rre(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function wA(e,t){return nc(e.prev,e,e.next)<0?nc(e,t,e.next)>=0&&nc(e,e.prev,t)>=0:nc(e,t,e.prev)<0||nc(e,e.next,t)<0}function c2e(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function ire(e,t){var n=new _4(e.i,e.x,e.y),r=new _4(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ote(e,t,n,r){var o=new _4(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function EA(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _4(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}fR.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(y4(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(y4(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,_=r[u+2]*n;h+=Math.abs((e[d]-e[_])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[_+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function y4(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}fR.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};tre.default=ZNe;function f2e(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?t.features=ate(e.geometry.coordinates):e.geometry.coordinates.forEach(function(n){t.features=t.features.concat(ate(n))}),t}function ate(e){var t=h2e(e),n=2,r=tre(t.vertices,t.holes,n),o=[],a=[];r.forEach(function(l,c){var f=r[c];a.push([t.vertices[f*n],t.vertices[f*n+1]])});for(var s=0;s<a.length;s+=3){var u=a.slice(s,s+3);u.push(a[s]),o.push(ir([u]))}return o}function h2e(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}function v4(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var n,r=1/0;return mi(t,function(o,a){var s=di(e,o);s<r&&(n=Su(o),n.properties.featureIndex=a,n.properties.distanceToPoint=s,r=s)}),n}function d2e(e,t,n,r,o){ore(e,t,n||0,r||e.length-1,o||p2e)}function ore(e,t,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));ore(e,t,f,h,o)}var d=e[t],p=n,_=r;for(iA(e,n,t),o(e[r],d)>0&&iA(e,n,r);p<_;){for(iA(e,p,_),p++,_--;o(e[p],d)<0;)p++;for(;o(e[_],d)>0;)_--}o(e[n],d)===0?iA(e,n,_):(_++,iA(e,_,r)),_<=t&&(n=_+1),t<=_&&(r=_-1)}}function iA(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function p2e(e,t){return e<t?-1:e>t?1:0}function vf(e,t){if(!(this instanceof vf))return new vf(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}vf.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!bL(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,bL(e,l)&&(t.leaf?n.push(u):t4(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!bL(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,bL(e,u)){if(t.leaf||t4(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=S1([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=m2e(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&t4(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:ste,compareMinY:ute,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=S1(e.slice(t,n+1)),E1(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=S1([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(lte(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),lte(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return E1(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=e4(s),c=g2e(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),hA(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=S1(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,E1(n,this.toBBox),E1(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=S1([e,t]),this.data.height=e.height+1,this.data.leaf=!1,E1(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=fA(e,0,r,this.toBBox),a=fA(e,r,n,this.toBBox),s=_2e(o,a),u=e4(o)+e4(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:ste,o=e.leaf?this.compareMinY:ute,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=fA(e,0,t,o),s=fA(e,n-t,n,o),u=AL(a)+AL(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],hA(a,e.leaf?o(c):c),u+=AL(a);for(l=n-t-1;l>=t;l--)c=e.children[l],hA(s,e.leaf?o(c):c),u+=AL(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)hA(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():E1(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function m2e(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function E1(e,t){fA(e,0,e.children.length,t,e)}function fA(e,t,n,r,o){o||(o=S1(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],hA(o,e.leaf?r(s):s);return o}function hA(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function ste(e,t){return e.minX-t.minX}function ute(e,t){return e.minY-t.minY}function e4(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function AL(e){return e.maxX-e.minX+(e.maxY-e.minY)}function g2e(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function _2e(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function t4(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function bL(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function S1(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function lte(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,d2e(e,s,t,n,o),a.push(t,s,s,n))}function WA(e){var t=vf(e);return t.insert=function(n){if(Array.isArray(n)){var r=n;n=n4(r),n.bbox=r}else n.bbox=n.bbox?n.bbox:r4(n);return vf.prototype.insert.call(this,n)},t.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(o){var a=n4(o);a.bbox=o,r.push(a)}):mi(n,function(o){o.bbox=o.bbox?o.bbox:r4(o),r.push(o)}),vf.prototype.load.call(this,r)},t.remove=function(n){if(Array.isArray(n)){var r=n;n=n4(r),n.bbox=r}return vf.prototype.remove.call(this,n)},t.clear=function(){return vf.prototype.clear.call(this)},t.search=function(n){var r=vf.prototype.search.call(this,this.toBBox(n));return{type:"FeatureCollection",features:r}},t.collides=function(n){return vf.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=vf.prototype.all.call(this);return{type:"FeatureCollection",features:n}},t.toJSON=function(){return vf.prototype.toJSON.call(this)},t.fromJSON=function(n){return vf.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var r;return n.bbox?r=n.bbox:Array.isArray(n)&&n.length===4?r=n:r=r4(n),{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},t}function n4(e){var t=[e[0],e[1]],n=[e[0],e[3]],r=[e[2],e[3]],o=[e[2],e[1]],a=[[t,o,r,n,t]];return{type:"Feature",bbox:e,properties:{},geometry:{type:"Polygon",coordinates:a}}}function r4(e){var t=[1/0,1/0,-1/0,-1/0];return $a(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function _v(e){if(!e)throw new Error("geojson is required");var t=[];return Da(e,function(n){y2e(n,t)}),kt(t)}function y2e(e,t){var n=[],r=e.geometry;switch(r.type){case"Polygon":n=St(r);break;case"LineString":n=[St(r)]}n.forEach(function(o){var a=v2e(o,e.properties);a.forEach(function(s){s.id=t.length,t.push(s)})})}function v2e(e,t){var n=[];return e.reduce(function(r,o){var a=Vi([r,o],t);return a.bbox=C2e(r,o),n.push(a),o}),n}function C2e(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s=n<o?n:o,u=r<a?r:a,l=n>o?n:o,c=r>a?r:a;return[s,u,l,c]}function Fg(e,t){var n={},r=[];if(e.type==="LineString"&&(e=ha(e)),t.type==="LineString"&&(t=ha(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var o=cte(e,t);return o&&r.push(o),kt(r)}var a=WA();return a.load(_v(t)),mi(_v(e),function(s){mi(a.search(s),function(u){var l=cte(s,u);if(l){var c=St(l).join(",");n[c]||(n[c]=!0,r.push(l))}})}),kt(r)}function cte(e,t){var n=St(e),r=St(t);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],u=n[1][1],l=r[0][0],c=r[0][1],f=r[1][0],h=r[1][1],d=(h-c)*(s-o)-(f-l)*(u-a),p=(f-l)*(a-c)-(h-c)*(o-l),_=(s-o)*(a-c)-(u-a)*(o-l);if(d===0)return p===0&&_===0,null;var y=p/d,v=_/d;if(y>=0&&y<=1&&v>=0&&v<=1){var w=o+y*(s-o),C=a+y*(u-a);return Yr([w,C])}return null}function wg(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=e.geometry?e.geometry.type:e.type;if(r!=="LineString"&&r!=="MultiLineString")throw new Error("lines must be LineString or MultiLineString");var o=Yr([1/0,1/0],{dist:1/0}),a=0;return Da(e,function(s){for(var u=St(s),l=0;l<u.length-1;l++){var c=Yr(u[l]);c.properties.dist=di(t,c,n);var f=Yr(u[l+1]);f.properties.dist=di(t,f,n);var h=di(c,f,n),d=Math.max(c.properties.dist,f.properties.dist),p=Qp(c,f),_=em(t,d,p+90,n),y=em(t,d,p-90,n),v=Fg(Vi([_.geometry.coordinates,y.geometry.coordinates]),Vi([c.geometry.coordinates,f.geometry.coordinates])),w=null;v.features.length>0&&(w=v.features[0],w.properties.dist=di(t,w,n),w.properties.location=a+di(c,w,n)),c.properties.dist<o.properties.dist&&(o=c,o.properties.index=l,o.properties.location=a),f.properties.dist<o.properties.dist&&(o=f,o.properties.index=l+1,o.properties.location=a+h),w&&w.properties.dist<o.properties.dist&&(o=w,o.properties.index=l),a+=h}}),o}function $0(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.final;if(!e)throw new Error("start point is required");if(!t)throw new Error("end point is required");var o;r?o=fte(fo(t),fo(e)):o=fte(fo(e),fo(t));var a=o>180?-(360-o):o;return a}function fte(e,t){var n=Ja(e[1]),r=Ja(t[1]),o=Ja(t[0]-e[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),s=Math.atan2(o,a);return(r_(s)+360)%360}function hR(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("from point is required");if(!t)throw new Error("to point is required");var o=fo(e),a=fo(t);a[0]+=a[0]-o[0]>180?-360:o[0]-a[0]>180?360:0;var s=x2e(o,a),u=mv(s,"meters",r);return u}function x2e(e,t,n){n=n===void 0?Cs:Number(n);var r=n,o=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-o,u=Math.abs(t[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var l=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(l)>1e-11?s/l:Math.cos(o),f=Math.sqrt(s*s+c*c*u*u),h=f*r;return h}function e_(e,t){return are(e,"mercator",t)}function dR(e,t){return are(e,"wgs84",t)}function are(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&pi(e[0])?e=t==="mercator"?hte(e):dte(e):(r!==!0&&(e=Su(e)),$a(e,function(o){var a=t==="mercator"?hte(o):dte(o);o[0]=a[0],o[1]=a[1]})),e}function hte(e){var t=Math.PI/180,n=6378137,r=20037508342789244e-9,o=Math.abs(e[0])<=180?e[0]:e[0]-w2e(e[0])*360,a=[n*o*t,n*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return a[0]>r&&(a[0]=r),a[0]<-r&&(a[0]=-r),a[1]>r&&(a[1]=r),a[1]<-r&&(a[1]=-r),a}function dte(e){var t=180/Math.PI,n=6378137;return[e[0]*t/n,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/n)))*t]}function w2e(e){return e<0?-1:e>0?1:0}var E2e=Object.freeze({toMercator:e_,toWgs84:dR});function sre(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");if(!e)throw new Error("pt is required");if(Array.isArray(e)?e=Yr(e):e.type==="Point"?e=ha(e):yA(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=Vi(t):t.type==="LineString"?t=ha(t):yA(t,"LineString","line");var r=1/0,o=e.geometry.coordinates;return xg(t,function(a){var s=a.geometry.coordinates[0],u=a.geometry.coordinates[1],l=T2e(o,s,u,n);r>l&&(r=l)}),r}function T2e(e,t,n,r){var o=r.mercator,a=o!==!0?di(t,e,r):pte(t,e,r),s=J0(o!==!0?Qp(t,e):$0(t,e)),u=J0(o!==!0?Qp(t,n):$0(t,n)),l=Math.abs(s-u);if(l>90)return a;var c=(u+180)%360,f=J0(o!==!0?Qp(n,e):$0(n,e)),h=Math.abs(f-c);return h>180&&(h=Math.abs(h-360)),h>90?o!==!0?di(e,n,r):pte(e,n,r):o!==!0?a*Math.sin(Ja(l)):S2e(t,n,e,r)}function S2e(e,t,n,r){var o=0;(Math.abs(e[0])>=180||Math.abs(t[0])>=180||Math.abs(n[0])>=180)&&(o=e[0]>0||t[0]>0||n[0]>0?-180:180);var a=Yr(n),s=e_([e[0]+o,e[1]]),u=e_([t[0]+o,t[1]]),l=e_([n[0]+o,n[1]]),c=dR(A2e(s,u,l));o!==0&&(c[0]-=o);var f=hR(a,c,r);return f}function A2e(e,t,n){var r=e[0],o=e[1],a=t[0],s=t[1],u=n[0],l=n[1],c=a-r,f=s-o,h=c*c+f*f,d=((u-r)*c+(l-o)*f)/h,p=r+d*c,_=o+d*f;return[p,_]}function pte(e,t,n){var r=n.units,o=0;Math.abs(e[0])>=180&&(o=e[0]>0?-180:180),Math.abs(t[0])>=180&&(o=t[0]>0?-180:180);var a=e_([e[0]+o,e[1]]),s=e_([t[0]+o,t[1]]),u=function(f){return f*f},l=u(a[0]-s[0])+u(a[1]-s[1]),c=Math.sqrt(l);return mv(c,"meters",r)}function b2e(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.units,o=n.properties||{};if(!e)throw new Error("points is required");if(e=I2e(e),!e.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(ki(t)!=="LineString")throw new Error("line must be a LineString");var a=1/0,s=null;return mi(e,function(u){var l=sre(u,t,{units:r});l<a&&(a=l,s=u)}),s&&(s.properties=Object.assign({dist:a},s.properties,o)),s}function I2e(e){var t=[],n=e.geometry?e.geometry.type:e.type;switch(n){case"GeometryCollection":return Hh(e,function(r){r.type==="Point"&&t.push({type:"Feature",properties:{},geometry:r})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(r){return r.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}function D2e(e,t){var n=fo(e),r=ic(t),o=r.coordinates,a=o[0];if(a.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var s=t.properties||{},u=s.a,l=s.b,c=s.c,f=n[0],h=n[1],d=a[0][0],p=a[0][1],_=u!==void 0?u:a[0][2],y=a[1][0],v=a[1][1],w=l!==void 0?l:a[1][2],C=a[2][0],E=a[2][1],S=c!==void 0?c:a[2][2],A=(S*(f-d)*(h-v)+_*(f-y)*(h-E)+w*(f-C)*(h-p)-w*(f-d)*(h-E)-S*(f-y)*(h-p)-_*(f-C)*(h-v))/((f-d)*(h-v)+(f-y)*(h-E)+(f-C)*(h-p)-(f-d)*(h-E)-(f-y)*(h-p)-(f-C)*(h-v));return A}function P2e(e){var t,n,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?n=e.geometry:n=e,n.type==="LineString")t=[n.coordinates];else if(n.type==="MultiLineString")t=n.coordinates;else if(n.type==="MultiPolygon")t=[].concat.apply([],n.coordinates);else if(n.type==="Polygon")t=n.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(o){t.forEach(function(a){for(var s=0;s<o.length-1;s++)for(var u=s;u<a.length-1;u++)if(!(o===a&&(Math.abs(s-u)===1||s===0&&u===o.length-2&&o[s][0]===o[o.length-1][0]&&o[s][1]===o[o.length-1][1]))){var l=M2e(o[s][0],o[s][1],o[s+1][0],o[s+1][1],a[u][0],a[u][1],a[u+1][0],a[u+1][1]);l&&r.features.push(Yr([l[0],l[1]]))}})}),r}function M2e(e,t,n,r,o,a,s,u){var l,c,f,h,d,p={x:null,y:null,onLine1:!1,onLine2:!1};return l=(u-a)*(n-e)-(s-o)*(r-t),l===0?p.x!==null&&p.y!==null?p:!1:(c=t-a,f=e-o,h=(s-o)*c-(u-a)*f,d=(n-e)*c-(r-t)*f,c=h/l,f=d/l,p.x=e+c*(n-e),p.y=t+c*(r-t),c>=0&&c<=1&&(p.onLine1=!0),f>=0&&f<=1&&(p.onLine2=!0),p.onLine1&&p.onLine2?[p.x,p.y]:!1)}function mte(e){for(var t=L2e(e),n=cR(t),r=!1,o=0;!r&&o<t.features.length;){var a=t.features[o].geometry,s,u,l,c,f,h,d,p=!1;if(a.type==="Point")n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if(a.type==="MultiPoint"){var _=!1;for(d=0;!_&&d<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[d][0]&&n.geometry.coordinates[1]===a.coordinates[d][1]&&(r=!0,_=!0),d++}else if(a.type==="LineString")for(d=0;!p&&d<a.coordinates.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=a.coordinates[d][0],c=a.coordinates[d][1],f=a.coordinates[d+1][0],h=a.coordinates[d+1][1],gte(s,u,l,c,f,h)&&(p=!0,r=!0),d++;else if(a.type==="MultiLineString")for(var y=0;y<a.coordinates.length;){p=!1,d=0;for(var v=a.coordinates[y];!p&&d<v.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=v[d][0],c=v[d][1],f=v[d+1][0],h=v[d+1][1],gte(s,u,l,c,f,h)&&(p=!0,r=!0),d++;y++}else(a.type==="Polygon"||a.type==="MultiPolygon")&&To(n,a)&&(r=!0);o++}if(r)return n;var w=kt([]);for(o=0;o<t.features.length;o++)w.features=w.features.concat(q4(t.features[o]).features);return Yr(v4(n,w).geometry.coordinates)}function L2e(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?kt([ha(e)]):kt([e]):e}function gte(e,t,n,r,o,a){var s=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r)),l=Math.sqrt((o-e)*(o-e)+(a-t)*(a-t));return s===u+l}function TA(e){return N4(e,function(t,n){return t+ure(n)},0)}var _te=6378137;function ure(e){var t=0,n;switch(e.type){case"Polygon":return yte(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=yte(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=ure(e.geometries[n]);return t}}function yte(e){var t=0;if(e&&e.length>0){t+=Math.abs(vte(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(vte(e[n]))}return t}function vte(e){var t,n,r,o,a,s,u,l=0,c=e.length;if(c>2){for(u=0;u<c;u++)u===c-2?(o=c-2,a=c-1,s=0):u===c-1?(o=c-1,a=0,s=1):(o=u,a=u+1,s=u+2),t=e[o],n=e[a],r=e[s],l+=(i4(r[0])-i4(t[0]))*Math.sin(i4(n[1]));l=l*_te*_te/2}return l}function i4(e){return e*Math.PI/180}function R2e(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r;if(e.type==="Feature")r=e.geometry.coordinates;else if(e.type==="LineString")r=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");if(!pi(t))throw new Error("distance must be a number");for(var o=0,a=0;a<r.length&&!(t>=o&&a===r.length-1);a++)if(o>=t){var s=t-o;if(s){var u=Qp(r[a],r[a-1])-180,l=em(r[a],s,u,n);return l}else return Yr(r[a])}else o+=di(r[a],r[a+1],n);return Yr(r[r.length-1])}function C4(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");if(!e)throw new Error("geojson is required");return B4(e,function(n,r){var o=r.geometry.coordinates;return n+di(o[0],o[1],t)},0)}function O2e(e,t,n){var r=St(n);if(ki(n)!=="LineString")throw new Error("line must be a LineString");var o=wg(n,e),a=wg(n,t),s;o.properties.index<=a.properties.index?s=[o,a]:s=[a,o];for(var u=[s[0].geometry.coordinates],l=s[0].properties.index+1;l<s[1].properties.index+1;l++)u.push(r[l]);return u.push(s[1].geometry.coordinates),Vi(u,n.properties)}function lre(e,t,n,r){if(r=r||{},!yt(r))throw new Error("options is invalid");var o,a=[];if(e.type==="Feature")o=e.geometry.coordinates;else if(e.type==="LineString")o=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=0,u,l,c,f=0;f<o.length&&!(t>=s&&f===o.length-1);f++){if(s>t&&a.length===0){if(u=t-s,!u)return a.push(o[f]),Vi(a);l=Qp(o[f],o[f-1])-180,c=em(o[f],u,l,r),a.push(c.geometry.coordinates)}if(s>=n)return u=n-s,u?(l=Qp(o[f],o[f-1])-180,c=em(o[f],u,l,r),a.push(c.geometry.coordinates),Vi(a)):(a.push(o[f]),Vi(a));if(s>=t&&a.push(o[f]),f===o.length-1)return Vi(a);s+=di(o[f],o[f+1],r)}return Vi(o[o.length-1])}function Rc(e,t,n){n=n||{};var r=n.ignoreEndVertices;if(!yt(n))throw new Error("invalid options");if(!e)throw new Error("pt is required");if(!t)throw new Error("line is required");for(var o=fo(e),a=St(t),s=0;s<a.length-1;s++){var u=!1;if(r&&(s===0&&(u="start"),s===a.length-2&&(u="end"),s===0&&s+1===a.length-1&&(u="both")),N2e(a[s],a[s+1],o,u))return!0}return!1}function N2e(e,t,n,r){var o=n[0],a=n[1],s=e[0],u=e[1],l=t[0],c=t[1],f=n[0]-s,h=n[1]-u,d=l-s,p=c-u,_=f*p-h*d;if(_!==0)return!1;if(r){if(r==="start")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<=l:l<=o&&o<s:p>0?u<a&&a<=c:c<=a&&a<u;if(r==="end")return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<l:l<o&&o<=s:p>0?u<=a&&a<c:c<a&&a<=u;if(r==="both")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<l:l<o&&o<s:p>0?u<a&&a<c:c<a&&a<u}else return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<=l:l<=o&&o<=s:p>0?u<=a&&a<=c:c<=a&&a<=u}function cre(e,t){var n=ki(e),r=ki(t),o=ic(e),a=ic(t);switch(n){case"Point":switch(r){case"MultiPoint":return B2e(o,a);case"LineString":return Rc(o,a,{ignoreEndVertices:!0});case"Polygon":return To(o,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"MultiPoint":return F2e(o,a);case"LineString":return z2e(o,a);case"Polygon":return V2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"LineString":return k2e(o,a);case"Polygon":return G2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Polygon":return U2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function B2e(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(hre(t.coordinates[n],e.coordinates)){r=!0;break}return r}function F2e(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,o=0;o<t.coordinates.length;o++)hre(e.coordinates[n],t.coordinates[o])&&(r=!0);if(!r)return!1}return!0}function z2e(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!Rc(e.coordinates[r],t))return!1;n||(n=Rc(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}function V2e(e,t){for(var n=!0,r=!1,o=0;o<e.coordinates.length;o++){var a=To(e.coordinates[1],t);if(!a){n=!1;break}r||(a=To(e.coordinates[1],t,{ignoreBoundary:!0}))}return n&&a}function k2e(e,t){for(var n=0;n<e.coordinates.length;n++)if(!Rc(e.coordinates[n],t))return!1;return!0}function G2e(e,t){var n=Pa(t),r=Pa(e);if(!fre(n,r))return!1;for(var o=!1,a=0;a<e.coordinates.length-1;a++){if(!To(e.coordinates[a],t))return!1;if(o||(o=To(e.coordinates[a],t,{ignoreBoundary:!0})),!o){var s=H2e(e.coordinates[a],e.coordinates[a+1]);o=To(s,t,{ignoreBoundary:!0})}}return o}function U2e(e,t){var n=Pa(e),r=Pa(t);if(!fre(r,n))return!1;for(var o=0;o<e.coordinates[0].length;o++)if(!To(e.coordinates[0][o],t))return!1;return!0}function fre(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function hre(e,t){return e[0]===t[0]&&e[1]===t[1]}function H2e(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function dre(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.mask,o=n.properties,a=[];if(t==null)throw new Error("cellSide is required");if(!pi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(r&&["Polygon","MultiPolygon"].indexOf(ki(r))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/di([s,u],[l,u],n),h=f*(l-s),d=t/di([s,u],[s,c],n),p=d*(c-u),_=l-s,y=c-u,v=Math.floor(_/h),w=Math.floor(y/p),C=(_-v*h)/2,E=(y-w*p)/2,S=s+C;S<=l;){for(var A=u+E;A<=c;){var D=Yr([S,A],o);r?cre(D,r)&&a.push(D):a.push(D),A+=p}S+=h}return kt(a)}function A1(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.precision,r=t.coordinates,o=t.mutate;if(n=n==null||isNaN(n)?6:n,r=r==null||isNaN(r)?3:r,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(o===!1||o===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,n);return $a(e,function(s){q2e(s,a,r)}),e}function q2e(e,t,n){e.length>n&&e.splice(n,e.length);for(var r=0;r<e.length;r++)e[r]=Math.round(e[r]*t)/t;return e}function W2e(e){if(!e)throw new Error("geojson is required");var t=[];return Da(e,function(n){t.push(n)}),kt(t)}function Y2e(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.units,o=n.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var a=[];return Da(e,function(s){o&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),X2e(s,t,r,function(u){a.push(u)})}),kt(a)}function X2e(e,t,n,r){var o=C4(e,{units:n});if(o<=t)return r(e);var a=o/t;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var u=lre(e,t*s,t*(s+1),{units:n});r(u,s)}}var j2e=function(e,t,n){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");n===void 0&&(n=1);var r=e.geometry.coordinates,o=[],a={};if(n){for(var s=[],u=0;u<r.length;u++)for(var l=0;l<r[u].length-1;l++)s.push(v(u,l));var c=R1();c.load(s)}for(var f=0;f<r.length;f++)for(var h=0;h<r[f].length-1;h++)if(n){var d=c.search(v(f,h));d.forEach(function(w){var C=w.ring,E=w.edge;y(f,h,C,E)})}else for(var p=0;p<r.length;p++)for(var _=0;_<r[p].length-1;_++)y(f,h,p,_);return t||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function y(w,C,E,S){var A=r[w][C],D=r[w][C+1],P=r[E][S],M=r[E][S+1],b=K2e(A,D,P,M);if(b!==null){var O,m;if(D[0]!==A[0]?O=(b[0]-A[0])/(D[0]-A[0]):O=(b[1]-A[1])/(D[1]-A[1]),M[0]!==P[0]?m=(b[0]-P[0])/(M[0]-P[0]):m=(b[1]-P[1])/(M[1]-P[1]),!(O>=1||O<=0||m>=1||m<=0)){var I=b,L=!a[I];L&&(a[I]=!0),t?o.push(t(b,w,C,A,D,O,E,S,P,M,m,L)):o.push(b)}}}function v(w,C){var E=r[w][C],S=r[w][C+1],A,D,P,M;return E[0]<S[0]?(A=E[0],D=S[0]):(A=S[0],D=E[0]),E[1]<S[1]?(P=E[1],M=S[1]):(P=S[1],M=E[1]),{minX:A,minY:P,maxX:D,maxY:M,ring:w,edge:C}}};function K2e(e,t,n,r){if(dA(e,n)||dA(e,r)||dA(t,n)||dA(r,n))return null;var o=e[0],a=e[1],s=t[0],u=t[1],l=n[0],c=n[1],f=r[0],h=r[1],d=(o-s)*(c-h)-(a-u)*(l-f);if(d===0)return null;var p=((o*u-a*s)*(l-f)-(o-s)*(l*h-c*f))/d,_=((o*u-a*s)*(c-h)-(a-u)*(l*h-c*f))/d;return[p,_]}function dA(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!dA(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}var Z2e=function(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,n=[],C=0;C<t;C++){var r=e.geometry.coordinates[C];pA(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!J2e(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,a=j2e(e,function(pe,ve,ft,pt,Xt,At,wt,Rr,gi,$i,ut,ai){return[pe,ve,ft,pt,Xt,At,wt,Rr,gi,$i,ut,ai]}),s=a.length;if(s==0){for(var P=[],C=0;C<t;C++)P.push(ir([e.geometry.coordinates[C]],{parent:-1,winding:Q2e(e.geometry.coordinates[C])}));var U=kt(P);return Q(),ne(),U}for(var u=[],l=[],C=0;C<t;C++){u.push([]);for(var c=0;c<e.geometry.coordinates[C].length-1;c++)u[C].push([new Cte(e.geometry.coordinates[C][(c+1).modulo(e.geometry.coordinates[C].length-1)],1,[C,c],[C,(c+1).modulo(e.geometry.coordinates[C].length-1)],void 0)]),l.push(new xte(e.geometry.coordinates[C][c],[C,(c-1).modulo(e.geometry.coordinates[C].length-1)],[C,c],void 0,void 0,!1,!0))}for(var C=0;C<s;C++)u[a[C][1]][a[C][2]].push(new Cte(a[C][0],a[C][5],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0)),a[C][11]&&l.push(new xte(a[C][0],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0,void 0,!0,!0));for(var f=l.length,C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)u[C][c].sort(function(ve,ft){return ve.param<ft.param?-1:1});for(var h=[],C=0;C<f;C++)h.push({minX:l[C].coord[0],minY:l[C].coord[1],maxX:l[C].coord[0],maxY:l[C].coord[1],index:C});var d=R1();d.load(h);for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var _;p==u[C][c].length-1?_=u[C][(c+1).modulo(e.geometry.coordinates[C].length-1)][0].coord:_=u[C][c][p+1].coord;var y=d.search({minX:_[0],minY:_[1],maxX:_[0],maxY:_[1]})[0];u[C][c][p].nxtIsectAlongEdgeIn=y.index}for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var _=u[C][c][p].coord,y=d.search({minX:_[0],minY:_[1],maxX:_[0],maxY:_[1]})[0],v=y.index;v<o?l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn:pA(l[v].ringAndEdge1,u[C][c][p].ringAndEdgeIn)?l[v].nxtIsectAlongRingAndEdge1=u[C][c][p].nxtIsectAlongEdgeIn:l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn}for(var w=[],C=0,c=0;c<t;c++){for(var E=C,p=0;p<e.geometry.coordinates[c].length-1;p++)l[C].coord[0]<l[E].coord[0]&&(E=C),C++;for(var S=l[E].nxtIsectAlongRingAndEdge2,p=0;p<l.length;p++)if(l[p].nxtIsectAlongRingAndEdge1==E||l[p].nxtIsectAlongRingAndEdge2==E){var A=p;break}var D=OL([l[A].coord,l[E].coord,l[S].coord],!0)?1:-1;w.push({isect:E,parent:-1,winding:D})}w.sort(function(de,pe){return l[de.isect].coord>l[pe.isect].coord?-1:1});for(var P=[];w.length>0;){var M=w.pop(),b=M.isect,O=M.parent,m=M.winding,I=P.length,L=[l[b].coord],R=b;if(l[b].ringAndEdge1Walkable)var N=l[b].ringAndEdge1,B=l[b].nxtIsectAlongRingAndEdge1;else var N=l[b].ringAndEdge2,B=l[b].nxtIsectAlongRingAndEdge2;for(;!pA(l[b].coord,l[B].coord);){L.push(l[B].coord);for(var V=void 0,C=0;C<w.length;C++)if(w[C].isect==B){V=C;break}if(V!=null&&w.splice(V,1),pA(N,l[B].ringAndEdge1)){if(N=l[B].ringAndEdge2,l[B].ringAndEdge2Walkable=!1,l[B].ringAndEdge1Walkable){var z={isect:B};OL([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge2].coord],m==1)?(z.parent=O,z.winding=-m):(z.parent=I,z.winding=m),w.push(z)}R=B,B=l[B].nxtIsectAlongRingAndEdge2}else{if(N=l[B].ringAndEdge1,l[B].ringAndEdge1Walkable=!1,l[B].ringAndEdge2Walkable){var z={isect:B};OL([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge1].coord],m==1)?(z.parent=O,z.winding=-m):(z.parent=I,z.winding=m),w.push(z)}R=B,B=l[B].nxtIsectAlongRingAndEdge1}}L.push(l[B].coord),P.push(ir([L],{index:I,parent:O,winding:m,netWinding:void 0}))}var U=kt(P);Q(),ne();function Q(){for(var de=[],pe=0;pe<U.features.length;pe++)U.features[pe].properties.parent==-1&&de.push(pe);if(de.length>1)for(var pe=0;pe<de.length;pe++){for(var ve=-1,ft=1/0,pt=0;pt<U.features.length;pt++)de[pe]!=pt&&To(U.features[de[pe]].geometry.coordinates[0][0],U.features[pt],{ignoreBoundary:!0})&&TA(U.features[pt])<ft&&(ve=pt);U.features[de[pe]].properties.parent=ve}}function ne(){for(var de=0;de<U.features.length;de++)if(U.features[de].properties.parent==-1){var pe=U.features[de].properties.winding;U.features[de].properties.netWinding=pe,se(de,pe)}}function se(de,pe){for(var ve=0;ve<U.features.length;ve++)if(U.features[ve].properties.parent==de){var ft=pe+U.features[ve].properties.winding;U.features[ve].properties.netWinding=ft,se(ve,ft)}}return U},Cte=function(e,t,n,r,o){this.coord=e,this.param=t,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=o},xte=function(e,t,n,r,o,a,s){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=a,this.ringAndEdge2Walkable=s};function OL(e,t){if(typeof t>"u"&&(t=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var n=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return n>=0==t}function Q2e(e){for(var t=0,n=0;n<e.length-1;n++)e[n][0]<e[t][0]&&(t=n);if(OL([e[(t-1).modulo(e.length-1)],e[t],e[(t+1).modulo(e.length-1)]],!0))var r=1;else var r=-1;return r}function pA(e,t){if(!e||!t||e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!pA(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}Number.prototype.modulo=function(e){return(this%e+e)%e};function J2e(e){for(var t={},n=1,r=0,o=e.length;r<o;++r){if(t.hasOwnProperty(e[r])){n=0;break}t[e[r]]=1}return n}function $2e(e){var t=[];return Da(e,function(n){n.geometry.type==="Polygon"&&mi(Z2e(n),function(r){t.push(ir(r.geometry.coordinates,n.properties))})}),kt(t)}var wte=Math.PI/180,Ete=180/Math.PI,SA=function(e,t){this.lon=e,this.lat=t,this.x=wte*e,this.y=wte*t};SA.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};SA.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new SA(t,e)};var pre=function(){this.coords=[],this.length=0};pre.prototype.move_to=function(e){this.length++,this.coords.push(e)};var W4=function(e){this.properties=e||{},this.geometries=[]};W4.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};W4.prototype.wkt=function(){for(var e="",t="LINESTRING(",n=function(a){t+=a[0]+" "+a[1]+","},r=0;r<this.geometries.length;r++){if(this.geometries[r].coords.length===0)return"LINESTRING(empty)";var o=this.geometries[r].coords;o.forEach(n),e+=t.substring(0,t.length-1)+")"}return e};var Y4=function(e,t,n){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new SA(e.x,e.y),this.end=new SA(t.x,t.y),this.properties=n||{};var r=this.start.x-this.end.x,o=this.start.y-this.end.y,a=Math.pow(Math.sin(o/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};Y4.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),n=Math.sin(e*this.g)/Math.sin(this.g),r=t*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=t*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=t*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=Ete*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(o,2))),u=Ete*Math.atan2(o,r);return[u,s]};Y4.prototype.Arc=function(e,t){var n=[];if(!e||e<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(e-1),o=0;o<e;++o){var a=r*o,s=this.interpolate(a);n.push(s)}for(var u=!1,l=0,c=t&&t.offset?t.offset:10,f=180-c,h=-180+c,d=360-c,p=1;p<n.length;++p){var _=n[p-1][0],y=n[p][0],v=Math.abs(y-_);v>d&&(y>f&&_<h||_>f&&y<h)?u=!0:v>l&&(l=v)}var w=[];if(u&&l<c){var C=[];w.push(C);for(var E=0;E<n.length;++E){var S=parseFloat(n[E][0]);if(E>0&&Math.abs(S-n[E-1][0])>d){var A=parseFloat(n[E-1][0]),D=parseFloat(n[E-1][1]),P=parseFloat(n[E][0]),M=parseFloat(n[E][1]);if(A>-180&&A<h&&P===180&&E+1<n.length&&n[E-1][0]>-180&&n[E-1][0]<h){C.push([-180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}else if(A>f&&A<180&&P===-180&&E+1<n.length&&n[E-1][0]>f&&n[E-1][0]<180){C.push([180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}if(A<h&&P>f){var b=A;A=P,P=b;var O=D;D=M,M=O}if(A>f&&P<h&&(P+=360),A<=180&&P>=180&&A<P){var m=(180-A)/(P-A),I=m*M+(1-m)*D;C.push([n[E-1][0]>f?180:-180,I]),C=[],C.push([n[E-1][0]>f?-180:180,I]),w.push(C)}else C=[],w.push(C);C.push([S,n[E][1]])}else C.push([n[E][0],n[E][1]])}}else{var L=[];w.push(L);for(var R=0;R<n.length;++R)L.push([n[R][0],n[R][1]])}for(var N=new W4(this.properties),B=0;B<w.length;++B){var V=new pre;N.geometries.push(V);for(var z=w[B],U=0;U<z.length;++U)V.move_to(z[U])}return N};function e3e(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.properties,o=n.npoints,a=n.offset;e=fo(e),t=fo(t),r=r||{},o=o||100,a=a||10;var s=new Y4({x:e[0],y:e[1]},{x:t[0],y:t[1]},r),u=s.Arc(o,{offset:a});return u.json()}function t3e(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=ki(e),r=ki(t);if(n!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var o=A1(t,{precision:7});switch(r){case"Point":return x4(e,o);case"MultiPoint":return Tte(e,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Tte(e,Fg(e,o))}}function Tte(e,t){var n=[],r=WA();return Da(t,function(o){if(n.forEach(function(u,l){u.id=l}),!n.length)n=x4(e,o).features,n.forEach(function(u){u.bbox||(u.bbox=$ne(Pa(u)))}),r.load(kt(n));else{var a=r.search(o);if(a.features.length){var s=mre(o,a);n=n.filter(function(u){return u.id!==s.id}),r.remove(s),mi(x4(s,o),function(u){n.push(u),r.insert(u)})}}}),kt(n)}function x4(e,t){var n=[],r=St(e)[0],o=St(e)[e.geometry.coordinates.length-1];if(o4(r,fo(t))||o4(o,fo(t)))return kt([e]);var a=WA(),s=_v(e);a.load(s);var u=a.search(t);if(!u.features.length)return kt([e]);var l=mre(t,u),c=[r],f=O4(s,function(h,d,p){var _=St(d)[1],y=fo(t);return p===l.id?(h.push(y),n.push(Vi(h)),o4(y,_)?[y]:[y,_]):(h.push(_),h)},c);return f.length>1&&n.push(Vi(f)),kt(n)}function mre(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,r=1/0;return mi(t,function(o){var a=wg(o,e),s=a.properties.dist;s<r&&(n=o,r=s)}),n}function o4(e,t){return e[0]===t[0]&&e[1]===t[1]}function gre(e,t,n,r,o){if(o=o||{},!yt(o))throw new Error("options is invalid");var a=o.steps,s=o.units;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(typeof o!="object")throw new Error("options must be an object");a=a||64;var u=Ste(n),l=Ste(r),c=e.properties;if(u===l)return Vi(H4(e,t,o).geometry.coordinates[0],c);for(var f=u,h=u<l?l:l+360,d=f,p=[],_=0;d<h;)p.push(em(e,t,d,s).geometry.coordinates),_++,d=f+_*360/a;return d>h&&p.push(em(e,t,h,s).geometry.coordinates),Vi(p,c)}function Ste(e){var t=e%360;return t<0&&(t+=360),t}function UL(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.properties,r=ki(e),o=St(e);if(n=n||e.properties||{},!o.length)throw new Error("polygon must contain coordinates");switch(r){case"Polygon":return Ate(o,n);case"MultiPolygon":var a=[];return o.forEach(function(s){a.push(Ate(s,n))}),kt(a);default:throw new Error("geom "+r+" not supported")}}function Ate(e,t){return e.length>1?p_(e,t):Vi(e[0],t)}function bte(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.properties,r=t.autoComplete,o=t.orderCoords;if(!e)throw new Error("lines is required");r=r!==void 0?r:!0,o=o!==void 0?o:!0;var a=ki(e);switch(a){case"FeatureCollection":case"GeometryCollection":var s=[],u=e.features?e.features:e.geometries;return u.forEach(function(l){s.push(St(Ite(l,{},r,o)))}),nw(s,n)}return Ite(e,n,r,o)}function Ite(e,t,n,r){t=t||e.properties||{};var o=St(e),a=ki(e);if(!o.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(o=Dte(o)),ir([o],t);case"MultiLineString":var s=[],u=0;return o.forEach(function(l){if(n&&(l=Dte(l)),r){var c=n3e(Pa(Vi(l)));c>u?(s.unshift(l),u=c):s.push(l)}else s.push(l)}),ir(s,t);default:throw new Error("geometry type "+a+" is not supported")}}function Dte(e){var t=e[0],n=t[0],r=t[1],o=e[e.length-1],a=o[0],s=o[1];return(n!==a||r!==s)&&e.push(t),e}function n3e(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.abs(t-r)*Math.abs(n-o)}var _re=HL;HL.polyline=HL;HL.polygon=r3e;function HL(e,t,n){var r=e.length,o=b1(e[0],t),a=[],s,u,l,c,f;for(n||(n=[]),s=1;s<r;s++){for(u=e[s-1],l=e[s],c=f=b1(l,t);;)if(o|c){if(o&c)break;o?(u=w4(u,l,o,t),o=b1(u,t)):(l=w4(u,l,c,t),c=b1(l,t))}else{a.push(u),c!==f?(a.push(l),s<r-1&&(n.push(a),a=[])):s===r-1&&a.push(l);break}o=f}return a.length&&n.push(a),n}function r3e(e,t){var n,r,o,a,s,u,l;for(r=1;r<=8;r*=2){for(n=[],o=e[e.length-1],a=!(b1(o,t)&r),s=0;s<e.length;s++)u=e[s],l=!(b1(u,t)&r),l!==a&&n.push(w4(o,u,r,t)),l&&n.push(u),o=u,a=l;if(e=n,!e.length)break}return n}function w4(e,t,n,r){return n&8?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:n&4?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:n&2?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:n&1?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function b1(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function i3e(e,t){var n=o3e(e),r=St(e),o=e.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return n==="LineString"&&(r=[r]),r.forEach(function(s){_re(s,t,a)}),a.length===1?Vi(a[0],o):p_(a,o);case"Polygon":return ir(Pte(r,t),o);case"MultiPolygon":return nw(r.map(function(s){return Pte(s,t)}),o);default:throw new Error("geometry "+n+" not supported")}}function Pte(e,t){for(var n=[],r=0;r<e.length;r++){var o=_re.polygon(e[r],t);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&n.push(o))}return n}function o3e(e){return e.geometry?e.geometry.type:e.type}var Mte=Array.prototype.slice;function Lte(e){return Object.prototype.toString.call(e)==="[object Arguments]"}function dv(e,t,n){return n||(n={}),e===t?!0:e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||typeof e!="object"&&typeof t!="object"?(n.strict,e===t):a3e(e,t,n)}function Rte(e){return e==null}function Ote(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function a3e(e,t,n){var r,o;if(Rte(e)||Rte(t)||e.prototype!==t.prototype)return!1;if(Lte(e))return Lte(t)?(e=Mte.call(e),t=Mte.call(t),dv(e,t,n)):!1;if(Ote(e)){if(!Ote(t)||e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}try{var a=Object.keys(e),s=Object.keys(t)}catch{return!1}if(a.length!==s.length)return!1;for(a.sort(),s.sort(),r=a.length-1;r>=0;r--)if(a[r]!==s[r])return!1;for(r=a.length-1;r>=0;r--)if(o=a[r],!dv(e[o],t[o],n))return!1;return typeof e==typeof t}function yre(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.tolerance||0,o=[],a=WA();a.load(_v(e));var s;return xg(t,function(u){var l=!1;mi(a.search(u),function(c){if(l===!1){var f=St(u).sort(),h=St(c).sort();dv(f,h)||(r===0?Rc(f[0],c)&&Rc(f[1],c):wg(c,f[0]).properties.dist<=r&&wg(c,f[1]).properties.dist<=r)?(l=!0,s?s=a4(s,u):s=u):(r===0?Rc(h[0],u)&&Rc(h[1],u):wg(u,h[0]).properties.dist<=r&&wg(u,h[1]).properties.dist<=r)&&(s?s=a4(s,c):s=c)}}),l===!1&&s&&(o.push(s),s=void 0)}),s&&o.push(s),kt(o)}function a4(e,t){var n=St(t),r=St(e),o=r[0],a=r[r.length-1],s=e.geometry.coordinates;return dv(n[0],o)?s.unshift(n[1]):dv(n[0],a)?s.push(n[1]):dv(n[1],o)?s.unshift(n[0]):dv(n[1],a)&&s.push(n[0]),e}function s3e(e,t,n,r,o){if(o=o||{},!yt(o))throw new Error("options is invalid");if(!e)throw new Error("center is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof o!="object")throw new Error("options must be an object");if(Nte(n)===Nte(r))return H4(e,t,o);var a=St(e),s=gre(e,t,n,r,o),u=[[a]];return $a(s,function(l){u[0].push(l)}),u[0].push(a),ir(u)}function Nte(e){var t=e%360;return t<0&&(t+=360),t}function O1(e,t,n,r){if(r=r||{},!yt(r))throw new Error("options is invalid");var o=r.units,a=r.properties;if(!e)throw new Error("origin is required");if(t==null)throw new Error("distance is required");if(n==null)throw new Error("bearing is required");if(!(t>=0))throw new Error("distance must be greater than 0");var s=mv(t,o,"meters"),u=fo(e),l=u3e(u,s,n);return l[0]+=l[0]-u[0]>180?-360:u[0]-l[0]>180?360:0,Yr(l,a)}function u3e(e,t,n,r){r=r===void 0?Cs:Number(r);var o=t/r,a=e[0]*Math.PI/180,s=Ja(e[1]),u=Ja(n),l=o*Math.cos(u),c=s+l;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var f=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(f)>1e-11?l/f:Math.cos(s),d=o*Math.sin(u)/h,p=a+d;return[(p*180/Math.PI+540)%360-180,c*180/Math.PI]}function l3e(e,t){var n=St(e),r=St(t),o,a,s,u,l=ki(t);switch(l){case"Polygon":o=r[0][0],a=r[0][0],u=AA(r[0][0],r[0][r[0].length-1],n);var c=Bte(r[0],n,u,s,o,a);o=c[0],a=c[1];break;case"MultiPolygon":o=r[0][0][0],a=r[0][0][0],u=AA(r[0][0][0],r[0][0][r[0][0].length-1],n),r.forEach(function(f){var h=Bte(f[0],n,u,s,o,a);o=h[0],a=h[1]});break}return kt([Yr(o),Yr(a)])}function Bte(e,t,n,r,o,a){for(var s=0;s<e.length;s++){var u=e[s],l=e[s+1];s===e.length-1&&(l=e[0]),r=AA(u,l,t),n<=0&&r>0?f3e(t,u,o)||(o=u):n>0&&r<=0&&(c3e(t,u,a)||(a=u)),n=r}return[o,a]}function c3e(e,t,n){return AA(e,t,n)>0}function f3e(e,t,n){return AA(e,t,n)<0}function AA(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function qL(e){if(!e)throw new Error("line is required");var t=e.geometry?e.geometry.type:e.type;if(!Array.isArray(e)&&t!=="LineString")throw new Error("geometry must be a LineString");for(var n=St(e),r=0,o=1,a,s;o<n.length;)a=s||n[0],s=n[o],r+=(s[0]-a[0])*(s[1]+a[1]),o++;return r>0}function h3e(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.reverse||!1,r=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(e=Su(e));var o=[];switch(e.type){case"GeometryCollection":return Hh(e,function(a){NL(a,n)}),e;case"FeatureCollection":return mi(e,function(a){mi(NL(a,n),function(s){o.push(s)})}),kt(o)}return NL(e,n)}function NL(e,t){var n=e.type==="Feature"?e.geometry.type:e.type;switch(n){case"GeometryCollection":return Hh(e,function(r){NL(r,t)}),e;case"LineString":return Fte(St(e),t),e;case"Polygon":return zte(St(e),t),e;case"MultiLineString":return St(e).forEach(function(r){Fte(r,t)}),e;case"MultiPolygon":return St(e).forEach(function(r){zte(r,t)}),e;case"Point":case"MultiPoint":return e}}function Fte(e,t){qL(e)===t&&e.reverse()}function zte(e,t){qL(e[0])!==t&&e[0].reverse();for(var n=1;n<e.length;n++)qL(e[n])===t&&e[n].reverse()}function d3e(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;qd(e,"Point","input must contain Points");for(var a=p3e(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function p3e(e,t){var n={};mi(e,function(a){var s=St(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return St(l)[0]-St(c)[0]});return u}),o=r.sort(function(a,s){return t?St(a[0])[1]-St(s[0])[1]:St(s[0])[1]-St(a[0])[1]});return o}/*!
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*/var Vte={successCallback:null,verbose:!1,polygons:!1},cv={};function m3e(e,t,n,r){r=r||{};for(var o=Object.keys(Vte),a=0;a<o.length;a++){var s=o[a],u=r[s];u=typeof u<"u"&&u!==null?u:Vte[s],cv[s]=u}cv.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n)+"]");var l=j3e(e,t,n),c;return cv.polygons?(cv.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),c=eBe(l)):(cv.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),c=K3e(l)),typeof cv.successCallback=="function"&&cv.successCallback(c),c}var Xu=64,Ph=16,Us=4,vu=1,or=[],ar=[],sr=[],ur=[],lr=[],cr=[],fr=[],hr=[],dr=[],pr=[],mr=[],gr=[],_r=[],yr=[],vr=[],Cr=[],xr=[],wr=[],Er=[],Tr=[],Sr=[],Ar=[],br=[],Ir=[];fr[85]=pr[85]=-1;hr[85]=mr[85]=0;dr[85]=gr[85]=1;Er[85]=Ar[85]=1;Tr[85]=br[85]=0;Sr[85]=Ir[85]=1;or[85]=ur[85]=0;ar[85]=lr[85]=-1;sr[85]=vr[85]=0;Cr[85]=_r[85]=0;xr[85]=yr[85]=1;cr[85]=wr[85]=1;Ar[1]=Ar[169]=0;br[1]=br[169]=-1;Ir[1]=Ir[169]=0;_r[1]=_r[169]=-1;yr[1]=yr[169]=0;vr[1]=vr[169]=0;pr[4]=pr[166]=0;mr[4]=mr[166]=-1;gr[4]=gr[166]=1;Cr[4]=Cr[166]=1;xr[4]=xr[166]=0;wr[4]=wr[166]=0;fr[16]=fr[154]=0;hr[16]=hr[154]=1;dr[16]=dr[154]=1;ur[16]=ur[154]=1;lr[16]=lr[154]=0;cr[16]=cr[154]=1;Er[64]=Er[106]=0;Tr[64]=Tr[106]=1;Sr[64]=Sr[106]=0;or[64]=or[106]=-1;ar[64]=ar[106]=0;sr[64]=sr[106]=1;Er[2]=Er[168]=0;Tr[2]=Tr[168]=-1;Sr[2]=Sr[168]=1;Ar[2]=Ar[168]=0;br[2]=br[168]=-1;Ir[2]=Ir[168]=0;_r[2]=_r[168]=-1;yr[2]=yr[168]=0;vr[2]=vr[168]=0;Cr[2]=Cr[168]=-1;xr[2]=xr[168]=0;wr[2]=wr[168]=1;fr[8]=fr[162]=0;hr[8]=hr[162]=-1;dr[8]=dr[162]=0;pr[8]=pr[162]=0;mr[8]=mr[162]=-1;gr[8]=gr[162]=1;_r[8]=_r[162]=1;yr[8]=yr[162]=0;vr[8]=vr[162]=1;Cr[8]=Cr[162]=1;xr[8]=xr[162]=0;wr[8]=wr[162]=0;fr[32]=fr[138]=0;hr[32]=hr[138]=1;dr[32]=dr[138]=1;pr[32]=pr[138]=0;mr[32]=mr[138]=1;gr[32]=gr[138]=0;or[32]=or[138]=1;ar[32]=ar[138]=0;sr[32]=sr[138]=0;ur[32]=ur[138]=1;lr[32]=lr[138]=0;cr[32]=cr[138]=1;Ar[128]=Ar[42]=0;br[128]=br[42]=1;Ir[128]=Ir[42]=1;Er[128]=Er[42]=0;Tr[128]=Tr[42]=1;Sr[128]=Sr[42]=0;or[128]=or[42]=-1;ar[128]=ar[42]=0;sr[128]=sr[42]=1;ur[128]=ur[42]=-1;lr[128]=lr[42]=0;cr[128]=cr[42]=0;pr[5]=pr[165]=-1;mr[5]=mr[165]=0;gr[5]=gr[165]=0;Ar[5]=Ar[165]=1;br[5]=br[165]=0;Ir[5]=Ir[165]=0;Cr[20]=Cr[150]=0;xr[20]=xr[150]=1;wr[20]=wr[150]=1;ur[20]=ur[150]=0;lr[20]=lr[150]=-1;cr[20]=cr[150]=1;fr[80]=fr[90]=-1;hr[80]=hr[90]=0;dr[80]=dr[90]=1;Er[80]=Er[90]=1;Tr[80]=Tr[90]=0;Sr[80]=Sr[90]=1;_r[65]=_r[105]=0;yr[65]=yr[105]=1;vr[65]=vr[105]=0;or[65]=or[105]=0;ar[65]=ar[105]=-1;sr[65]=sr[105]=0;fr[160]=fr[10]=-1;hr[160]=hr[10]=0;dr[160]=dr[10]=1;pr[160]=pr[10]=-1;mr[160]=mr[10]=0;gr[160]=gr[10]=0;Ar[160]=Ar[10]=1;br[160]=br[10]=0;Ir[160]=Ir[10]=0;Er[160]=Er[10]=1;Tr[160]=Tr[10]=0;Sr[160]=Sr[10]=1;Cr[130]=Cr[40]=0;xr[130]=xr[40]=1;wr[130]=wr[40]=1;_r[130]=_r[40]=0;yr[130]=yr[40]=1;vr[130]=vr[40]=0;or[130]=or[40]=0;ar[130]=ar[40]=-1;sr[130]=sr[40]=0;ur[130]=ur[40]=0;lr[130]=lr[40]=-1;cr[130]=cr[40]=1;pr[37]=pr[133]=0;mr[37]=mr[133]=1;gr[37]=gr[133]=1;Ar[37]=Ar[133]=0;br[37]=br[133]=1;Ir[37]=Ir[133]=0;or[37]=or[133]=-1;ar[37]=ar[133]=0;sr[37]=sr[133]=0;ur[37]=ur[133]=1;lr[37]=lr[133]=0;cr[37]=cr[133]=0;Cr[148]=Cr[22]=-1;xr[148]=xr[22]=0;wr[148]=wr[22]=0;Ar[148]=Ar[22]=0;br[148]=br[22]=-1;Ir[148]=Ir[22]=1;Er[148]=Er[22]=0;Tr[148]=Tr[22]=1;Sr[148]=Sr[22]=1;ur[148]=ur[22]=-1;lr[148]=lr[22]=0;cr[148]=cr[22]=1;fr[82]=fr[88]=0;hr[82]=hr[88]=-1;dr[82]=dr[88]=1;Cr[82]=Cr[88]=1;xr[82]=xr[88]=0;wr[82]=wr[88]=1;_r[82]=_r[88]=-1;yr[82]=yr[88]=0;vr[82]=vr[88]=1;Er[82]=Er[88]=0;Tr[82]=Tr[88]=-1;Sr[82]=Sr[88]=0;fr[73]=fr[97]=0;hr[73]=hr[97]=1;dr[73]=dr[97]=0;pr[73]=pr[97]=0;mr[73]=mr[97]=-1;gr[73]=gr[97]=0;_r[73]=_r[97]=1;yr[73]=yr[97]=0;vr[73]=vr[97]=0;or[73]=or[97]=1;ar[73]=ar[97]=0;sr[73]=sr[97]=1;fr[145]=fr[25]=0;hr[145]=hr[25]=-1;dr[145]=dr[25]=0;_r[145]=_r[25]=1;yr[145]=yr[25]=0;vr[145]=vr[25]=1;Ar[145]=Ar[25]=0;br[145]=br[25]=1;Ir[145]=Ir[25]=1;ur[145]=ur[25]=-1;lr[145]=lr[25]=0;cr[145]=cr[25]=0;pr[70]=pr[100]=0;mr[70]=mr[100]=1;gr[70]=gr[100]=0;Cr[70]=Cr[100]=-1;xr[70]=xr[100]=0;wr[70]=wr[100]=1;Er[70]=Er[100]=0;Tr[70]=Tr[100]=-1;Sr[70]=Sr[100]=1;or[70]=or[100]=1;ar[70]=ar[100]=0;sr[70]=sr[100]=0;pr[101]=pr[69]=0;mr[101]=mr[69]=1;gr[101]=gr[69]=0;or[101]=or[69]=1;ar[101]=ar[69]=0;sr[101]=sr[69]=0;Ar[149]=Ar[21]=0;br[149]=br[21]=1;Ir[149]=Ir[21]=1;ur[149]=ur[21]=-1;lr[149]=lr[21]=0;cr[149]=cr[21]=0;Cr[86]=Cr[84]=-1;xr[86]=xr[84]=0;wr[86]=wr[84]=1;Er[86]=Er[84]=0;Tr[86]=Tr[84]=-1;Sr[86]=Sr[84]=1;fr[89]=fr[81]=0;hr[89]=hr[81]=-1;dr[89]=dr[81]=0;_r[89]=_r[81]=1;yr[89]=yr[81]=0;vr[89]=vr[81]=1;fr[96]=fr[74]=0;hr[96]=hr[74]=1;dr[96]=dr[74]=0;pr[96]=pr[74]=-1;mr[96]=mr[74]=0;gr[96]=gr[74]=1;Er[96]=Er[74]=1;Tr[96]=Tr[74]=0;Sr[96]=Sr[74]=0;or[96]=or[74]=1;ar[96]=ar[74]=0;sr[96]=sr[74]=1;fr[24]=fr[146]=0;hr[24]=hr[146]=-1;dr[24]=dr[146]=1;Cr[24]=Cr[146]=1;xr[24]=xr[146]=0;wr[24]=wr[146]=1;_r[24]=_r[146]=0;yr[24]=yr[146]=1;vr[24]=vr[146]=1;ur[24]=ur[146]=0;lr[24]=lr[146]=-1;cr[24]=cr[146]=0;pr[6]=pr[164]=-1;mr[6]=mr[164]=0;gr[6]=gr[164]=1;Cr[6]=Cr[164]=-1;xr[6]=xr[164]=0;wr[6]=wr[164]=0;Ar[6]=Ar[164]=0;br[6]=br[164]=-1;Ir[6]=Ir[164]=1;Er[6]=Er[164]=1;Tr[6]=Tr[164]=0;Sr[6]=Sr[164]=0;_r[129]=_r[41]=0;yr[129]=yr[41]=1;vr[129]=vr[41]=1;Ar[129]=Ar[41]=0;br[129]=br[41]=1;Ir[129]=Ir[41]=0;or[129]=or[41]=-1;ar[129]=ar[41]=0;sr[129]=sr[41]=0;ur[129]=ur[41]=0;lr[129]=lr[41]=-1;cr[129]=cr[41]=0;Cr[66]=Cr[104]=0;xr[66]=xr[104]=1;wr[66]=wr[104]=0;_r[66]=_r[104]=-1;yr[66]=yr[104]=0;vr[66]=vr[104]=1;Er[66]=Er[104]=0;Tr[66]=Tr[104]=-1;Sr[66]=Sr[104]=0;or[66]=or[104]=0;ar[66]=ar[104]=-1;sr[66]=sr[104]=1;fr[144]=fr[26]=-1;hr[144]=hr[26]=0;dr[144]=dr[26]=0;Ar[144]=Ar[26]=1;br[144]=br[26]=0;Ir[144]=Ir[26]=1;Er[144]=Er[26]=0;Tr[144]=Tr[26]=1;Sr[144]=Sr[26]=1;ur[144]=ur[26]=-1;lr[144]=lr[26]=0;cr[144]=cr[26]=1;pr[36]=pr[134]=0;mr[36]=mr[134]=1;gr[36]=gr[134]=1;Cr[36]=Cr[134]=0;xr[36]=xr[134]=1;wr[36]=wr[134]=0;or[36]=or[134]=0;ar[36]=ar[134]=-1;sr[36]=sr[134]=1;ur[36]=ur[134]=1;lr[36]=lr[134]=0;cr[36]=cr[134]=0;fr[9]=fr[161]=-1;hr[9]=hr[161]=0;dr[9]=dr[161]=0;pr[9]=pr[161]=0;mr[9]=mr[161]=-1;gr[9]=gr[161]=0;_r[9]=_r[161]=1;yr[9]=yr[161]=0;vr[9]=vr[161]=0;Ar[9]=Ar[161]=1;br[9]=br[161]=0;Ir[9]=Ir[161]=1;fr[136]=0;hr[136]=1;dr[136]=1;pr[136]=0;mr[136]=1;gr[136]=0;Cr[136]=-1;xr[136]=0;wr[136]=1;_r[136]=-1;yr[136]=0;vr[136]=0;Ar[136]=0;br[136]=-1;Ir[136]=0;Er[136]=0;Tr[136]=-1;Sr[136]=1;or[136]=1;ar[136]=0;sr[136]=0;ur[136]=1;lr[136]=0;cr[136]=1;fr[34]=0;hr[34]=-1;dr[34]=0;pr[34]=0;mr[34]=-1;gr[34]=1;Cr[34]=1;xr[34]=0;wr[34]=0;_r[34]=1;yr[34]=0;vr[34]=1;Ar[34]=0;br[34]=1;Ir[34]=1;Er[34]=0;Tr[34]=1;Sr[34]=0;or[34]=-1;ar[34]=0;sr[34]=1;ur[34]=-1;lr[34]=0;cr[34]=0;fr[35]=0;hr[35]=1;dr[35]=1;pr[35]=0;mr[35]=-1;gr[35]=1;Cr[35]=1;xr[35]=0;wr[35]=0;_r[35]=-1;yr[35]=0;vr[35]=0;Ar[35]=0;br[35]=-1;Ir[35]=0;Er[35]=0;Tr[35]=1;Sr[35]=0;or[35]=-1;ar[35]=0;sr[35]=1;ur[35]=1;lr[35]=0;cr[35]=1;fr[153]=0;hr[153]=1;dr[153]=1;_r[153]=-1;yr[153]=0;vr[153]=0;Ar[153]=0;br[153]=-1;Ir[153]=0;ur[153]=1;lr[153]=0;cr[153]=1;pr[102]=0;mr[102]=-1;gr[102]=1;Cr[102]=1;xr[102]=0;wr[102]=0;Er[102]=0;Tr[102]=1;Sr[102]=0;or[102]=-1;ar[102]=0;sr[102]=1;fr[155]=0;hr[155]=-1;dr[155]=0;_r[155]=1;yr[155]=0;vr[155]=1;Ar[155]=0;br[155]=1;Ir[155]=1;ur[155]=-1;lr[155]=0;cr[155]=0;pr[103]=0;mr[103]=1;gr[103]=0;Cr[103]=-1;xr[103]=0;wr[103]=1;Er[103]=0;Tr[103]=-1;Sr[103]=1;or[103]=1;ar[103]=0;sr[103]=0;fr[152]=0;hr[152]=1;dr[152]=1;Cr[152]=-1;xr[152]=0;wr[152]=1;_r[152]=-1;yr[152]=0;vr[152]=0;Ar[152]=0;br[152]=-1;Ir[152]=0;Er[152]=0;Tr[152]=-1;Sr[152]=1;ur[152]=1;lr[152]=0;cr[152]=1;fr[156]=0;hr[156]=-1;dr[156]=1;Cr[156]=1;xr[156]=0;wr[156]=1;_r[156]=-1;yr[156]=0;vr[156]=0;Ar[156]=0;br[156]=-1;Ir[156]=0;Er[156]=0;Tr[156]=1;Sr[156]=1;ur[156]=-1;lr[156]=0;cr[156]=1;fr[137]=0;hr[137]=1;dr[137]=1;pr[137]=0;mr[137]=1;gr[137]=0;_r[137]=-1;yr[137]=0;vr[137]=0;Ar[137]=0;br[137]=-1;Ir[137]=0;or[137]=1;ar[137]=0;sr[137]=0;ur[137]=1;lr[137]=0;cr[137]=1;fr[139]=0;hr[139]=1;dr[139]=1;pr[139]=0;mr[139]=-1;gr[139]=0;_r[139]=1;yr[139]=0;vr[139]=0;Ar[139]=0;br[139]=1;Ir[139]=0;or[139]=-1;ar[139]=0;sr[139]=0;ur[139]=1;lr[139]=0;cr[139]=1;fr[98]=0;hr[98]=-1;dr[98]=0;pr[98]=0;mr[98]=-1;gr[98]=1;Cr[98]=1;xr[98]=0;wr[98]=0;_r[98]=1;yr[98]=0;vr[98]=1;Er[98]=0;Tr[98]=1;Sr[98]=0;or[98]=-1;ar[98]=0;sr[98]=1;fr[99]=0;hr[99]=1;dr[99]=0;pr[99]=0;mr[99]=-1;gr[99]=1;Cr[99]=1;xr[99]=0;wr[99]=0;_r[99]=-1;yr[99]=0;vr[99]=1;Er[99]=0;Tr[99]=-1;Sr[99]=0;or[99]=1;ar[99]=0;sr[99]=1;pr[38]=0;mr[38]=-1;gr[38]=1;Cr[38]=1;xr[38]=0;wr[38]=0;Ar[38]=0;br[38]=1;Ir[38]=1;Er[38]=0;Tr[38]=1;Sr[38]=0;or[38]=-1;ar[38]=0;sr[38]=1;ur[38]=-1;lr[38]=0;cr[38]=0;pr[39]=0;mr[39]=1;gr[39]=1;Cr[39]=-1;xr[39]=0;wr[39]=0;Ar[39]=0;br[39]=-1;Ir[39]=1;Er[39]=0;Tr[39]=1;Sr[39]=0;or[39]=-1;ar[39]=0;sr[39]=1;ur[39]=1;lr[39]=0;cr[39]=0;var X4=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},j4=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},K4=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},Z4=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},Q4=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},J4=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},$4=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},eV=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},g3e=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},_3e=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},y3e=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},v3e=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},C3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},x3e=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},w3e=function(){return[[0,0],[0,1],[1,1],[1,0]]},E3e=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},T3e=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},S3e=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},A3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},b3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},I3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},D3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},P3e=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},M3e=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},L3e=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},R3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},O3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},N3e=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},B3e=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},F3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},z3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},V3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},k3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},G3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},U3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},H3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},q3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},W3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},Y3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},X3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},it=[],$e=[],Dt=[],_t=[],Yt=[],Ut=[],Dr=[],Lr=[];_t[1]=Yt[1]=18;_t[169]=Yt[169]=18;Dt[4]=$e[4]=12;Dt[166]=$e[166]=12;it[16]=Lr[16]=4;it[154]=Lr[154]=4;Ut[64]=Dr[64]=22;Ut[106]=Dr[106]=22;Dt[2]=Ut[2]=17;_t[2]=Yt[2]=18;Dt[168]=Ut[168]=17;_t[168]=Yt[168]=18;it[8]=_t[8]=9;$e[8]=Dt[8]=12;it[162]=_t[162]=9;$e[162]=Dt[162]=12;it[32]=Lr[32]=4;$e[32]=Dr[32]=1;it[138]=Lr[138]=4;$e[138]=Dr[138]=1;Yt[128]=Lr[128]=21;Ut[128]=Dr[128]=22;Yt[42]=Lr[42]=21;Ut[42]=Dr[42]=22;$e[5]=Yt[5]=14;$e[165]=Yt[165]=14;Dt[20]=Lr[20]=6;Dt[150]=Lr[150]=6;it[80]=Ut[80]=11;it[90]=Ut[90]=11;_t[65]=Dr[65]=3;_t[105]=Dr[105]=3;it[160]=Ut[160]=11;$e[160]=Yt[160]=14;it[10]=Ut[10]=11;$e[10]=Yt[10]=14;Dt[130]=Lr[130]=6;_t[130]=Dr[130]=3;Dt[40]=Lr[40]=6;_t[40]=Dr[40]=3;$e[101]=Dr[101]=1;$e[69]=Dr[69]=1;Yt[149]=Lr[149]=21;Yt[21]=Lr[21]=21;Dt[86]=Ut[86]=17;Dt[84]=Ut[84]=17;it[89]=_t[89]=9;it[81]=_t[81]=9;it[96]=Dr[96]=0;$e[96]=Ut[96]=15;it[74]=Dr[74]=0;$e[74]=Ut[74]=15;it[24]=Dt[24]=8;_t[24]=Lr[24]=7;it[146]=Dt[146]=8;_t[146]=Lr[146]=7;$e[6]=Ut[6]=15;Dt[6]=Yt[6]=16;$e[164]=Ut[164]=15;Dt[164]=Yt[164]=16;_t[129]=Lr[129]=7;Yt[129]=Dr[129]=20;_t[41]=Lr[41]=7;Yt[41]=Dr[41]=20;Dt[66]=Dr[66]=2;_t[66]=Ut[66]=19;Dt[104]=Dr[104]=2;_t[104]=Ut[104]=19;it[144]=Yt[144]=10;Ut[144]=Lr[144]=23;it[26]=Yt[26]=10;Ut[26]=Lr[26]=23;$e[36]=Lr[36]=5;Dt[36]=Dr[36]=2;$e[134]=Lr[134]=5;Dt[134]=Dr[134]=2;it[9]=Yt[9]=10;$e[9]=_t[9]=13;it[161]=Yt[161]=10;$e[161]=_t[161]=13;$e[37]=Lr[37]=5;Yt[37]=Dr[37]=20;$e[133]=Lr[133]=5;Yt[133]=Dr[133]=20;Dt[148]=Yt[148]=16;Ut[148]=Lr[148]=23;Dt[22]=Yt[22]=16;Ut[22]=Lr[22]=23;it[82]=Dt[82]=8;_t[82]=Ut[82]=19;it[88]=Dt[88]=8;_t[88]=Ut[88]=19;it[73]=Dr[73]=0;$e[73]=_t[73]=13;it[97]=Dr[97]=0;$e[97]=_t[97]=13;it[145]=_t[145]=9;Yt[145]=Lr[145]=21;it[25]=_t[25]=9;Yt[25]=Lr[25]=21;$e[70]=Dr[70]=1;Dt[70]=Ut[70]=17;$e[100]=Dr[100]=1;Dt[100]=Ut[100]=17;it[34]=_t[34]=9;$e[34]=Dt[34]=12;Yt[34]=Lr[34]=21;Ut[34]=Dr[34]=22;it[136]=Lr[136]=4;$e[136]=Dr[136]=1;Dt[136]=Ut[136]=17;_t[136]=Yt[136]=18;it[35]=Lr[35]=4;$e[35]=Dt[35]=12;_t[35]=Yt[35]=18;Ut[35]=Dr[35]=22;it[153]=Lr[153]=4;_t[153]=Yt[153]=18;$e[102]=Dt[102]=12;Ut[102]=Dr[102]=22;it[155]=_t[155]=9;Yt[155]=Lr[155]=23;$e[103]=Dr[103]=1;Dt[103]=Ut[103]=17;it[152]=Lr[152]=4;Dt[152]=Ut[152]=17;_t[152]=Yt[152]=18;it[156]=Dt[156]=8;_t[156]=Yt[156]=18;Ut[156]=Lr[156]=23;it[137]=Lr[137]=4;$e[137]=Dr[137]=1;_t[137]=Yt[137]=18;it[139]=Lr[139]=4;$e[139]=_t[139]=13;Yt[139]=Dr[139]=20;it[98]=_t[98]=9;$e[98]=Dt[98]=12;Ut[98]=Dr[98]=22;it[99]=Dr[99]=0;$e[99]=Dt[99]=12;_t[99]=Ut[99]=19;$e[38]=Dt[38]=12;Yt[38]=Lr[38]=21;Ut[38]=Dr[38]=22;$e[39]=Lr[39]=5;Dt[39]=Yt[39]=16;Ut[39]=Dr[39]=22;var Xe=[];Xe[1]=Xe[169]=X4;Xe[4]=Xe[166]=j4;Xe[16]=Xe[154]=K4;Xe[64]=Xe[106]=Z4;Xe[168]=Xe[2]=Q4;Xe[162]=Xe[8]=J4;Xe[138]=Xe[32]=$4;Xe[42]=Xe[128]=eV;Xe[5]=Xe[165]=g3e;Xe[20]=Xe[150]=_3e;Xe[80]=Xe[90]=y3e;Xe[65]=Xe[105]=v3e;Xe[160]=Xe[10]=C3e;Xe[130]=Xe[40]=x3e;Xe[85]=w3e;Xe[101]=Xe[69]=E3e;Xe[149]=Xe[21]=T3e;Xe[86]=Xe[84]=S3e;Xe[89]=Xe[81]=A3e;Xe[96]=Xe[74]=b3e;Xe[24]=Xe[146]=I3e;Xe[6]=Xe[164]=D3e;Xe[129]=Xe[41]=P3e;Xe[66]=Xe[104]=M3e;Xe[144]=Xe[26]=L3e;Xe[36]=Xe[134]=R3e;Xe[9]=Xe[161]=O3e;Xe[37]=Xe[133]=N3e;Xe[148]=Xe[22]=B3e;Xe[82]=Xe[88]=F3e;Xe[73]=Xe[97]=z3e;Xe[145]=Xe[25]=V3e;Xe[70]=Xe[100]=k3e;Xe[34]=function(e){return[eV(e),J4(e)]};Xe[35]=G3e;Xe[136]=function(e){return[$4(e),Q4(e)]};Xe[153]=function(e){return[K4(e),X4(e)]};Xe[102]=function(e){return[j4(e),Z4(e)]};Xe[155]=U3e;Xe[103]=H3e;Xe[152]=function(e){return[K4(e),Q4(e)]};Xe[156]=q3e;Xe[137]=function(e){return[$4(e),X4(e)]};Xe[139]=W3e;Xe[98]=function(e){return[J4(e),Z4(e)]};Xe[99]=Y3e;Xe[38]=function(e){return[j4(e),eV(e)]};Xe[39]=X3e;function W(e,t,n){return(e-t)/(n-t)}function s4(e){return e.constructor.toString().indexOf("Array")>-1}function j3e(e,t,n){for(var r=e.length-1,o=e[0].length-1,a={rows:r,cols:o,cells:[]},s=t+Math.abs(n),u=0;u<r;++u){a.cells[u]=[];for(var l=0;l<o;++l){var c=0,f=e[u+1][l],h=e[u+1][l+1],d=e[u][l+1],p=e[u][l];if(!(isNaN(f)||isNaN(h)||isNaN(d)||isNaN(p))){c|=f<t?0:f>s?128:64,c|=h<t?0:h>s?32:16,c|=d<t?0:d>s?8:4,c|=p<t?0:p>s?2:1;var _=+c,y=0;if(c===17||c===18||c===33||c===34||c===38||c===68||c===72||c===98||c===102||c===132||c===136||c===137||c===152||c===153){var v=(f+h+d+p)/4;y=v>s?2:v<t?0:1,c===34?y===1?c=35:y===0&&(c=136):c===136?y===1?(c=35,y=4):y===0&&(c=34):c===17?y===1?(c=155,y=4):y===0&&(c=153):c===68?y===1?(c=103,y=4):y===0&&(c=102):c===153?y===1&&(c=155):c===102?y===1&&(c=103):c===152?y<2&&(c=156,y=1):c===137?y<2&&(c=139,y=1):c===98?y<2&&(c=99,y=1):c===38?y<2&&(c=39,y=1):c===18?y>0?(c=156,y=4):c=152:c===33?y>0?(c=139,y=4):c=137:c===72?y>0?(c=99,y=4):c=98:c===132&&(y>0?(c=39,y=4):c=38)}if(c!=0&&c!=170){var w,C,E,S,A,D,P,M;w=C=E=S=A=D=P=M=.5;var b=[];c===1?(E=1-W(t,d,p),M=1-W(t,f,p),b.push(_t[c])):c===169?(E=W(s,p,d),M=W(s,p,f),b.push(_t[c])):c===4?(D=1-W(t,h,d),S=W(t,p,d),b.push($e[c])):c===166?(D=W(s,d,h),S=1-W(s,d,p),b.push($e[c])):c===16?(A=W(t,d,h),C=W(t,f,h),b.push(it[c])):c===154?(A=1-W(s,h,d),C=1-W(s,h,f),b.push(it[c])):c===64?(P=W(t,p,f),w=1-W(t,h,f),b.push(Ut[c])):c===106?(P=1-W(s,f,p),w=W(s,f,h),b.push(Ut[c])):c===168?(S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),b.push(Dt[c]),b.push(_t[c])):c===2?(S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),b.push(Dt[c]),b.push(_t[c])):c===162?(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),b.push(Dt[c]),b.push(_t[c])):c===8?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),b.push(it[c]),b.push($e[c])):c===138?(A=1-W(t,h,d),D=1-W(s,h,d),w=1-W(s,h,f),C=1-W(t,h,f),b.push(it[c]),b.push($e[c])):c===32?(A=W(s,d,h),D=W(t,d,h),w=W(t,f,h),C=W(s,f,h),b.push(it[c]),b.push($e[c])):c===42?(M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),b.push(Yt[c]),b.push(Ut[c])):c===128&&(M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),b.push(Yt[c]),b.push(Ut[c])),c===5?(D=1-W(t,h,d),M=1-W(t,f,p),b.push($e[c])):c===165?(D=W(s,d,h),M=W(s,p,f),b.push($e[c])):c===20?(S=W(t,p,d),C=W(t,f,h),b.push(Dt[c])):c===150?(S=1-W(s,d,p),C=1-W(s,h,f),b.push(Dt[c])):c===80?(A=W(t,d,h),P=W(t,p,f),b.push(it[c])):c===90?(A=1-W(s,h,d),P=1-W(s,f,p),b.push(it[c])):c===65?(E=1-W(t,d,p),w=1-W(t,h,f),b.push(_t[c])):c===105?(E=W(s,p,d),w=W(s,f,h),b.push(_t[c])):c===160?(A=W(s,d,h),D=W(t,d,h),M=W(t,p,f),P=W(s,p,f),b.push(it[c]),b.push($e[c])):c===10?(A=1-W(t,h,d),D=1-W(s,h,d),M=1-W(s,f,p),P=1-W(t,f,p),b.push(it[c]),b.push($e[c])):c===130?(S=1-W(t,d,p),E=1-W(s,d,p),w=1-W(s,h,f),C=1-W(t,h,f),b.push(Dt[c]),b.push(_t[c])):c===40?(S=W(s,p,d),E=W(t,p,d),w=W(t,f,h),C=W(s,f,h),b.push(Dt[c]),b.push(_t[c])):c===101?(D=W(s,d,h),w=W(s,f,h),b.push($e[c])):c===69?(D=1-W(t,h,d),w=1-W(t,h,f),b.push($e[c])):c===149?(M=W(s,p,f),C=1-W(s,h,f),b.push(Yt[c])):c===21?(M=1-W(t,f,p),C=W(t,f,h),b.push(Yt[c])):c===86?(S=1-W(s,d,p),P=1-W(s,f,p),b.push(Dt[c])):c===84?(S=W(t,p,d),P=W(t,p,f),b.push(Dt[c])):c===89?(A=1-W(s,h,d),E=W(s,p,d),b.push(_t[c])):c===81?(A=W(t,d,h),E=1-W(t,d,p),b.push(_t[c])):c===96?(A=W(s,d,h),D=W(t,d,h),P=W(t,p,f),w=W(s,f,h),b.push(it[c]),b.push($e[c])):c===74?(A=1-W(t,h,d),D=1-W(s,h,d),P=1-W(s,f,p),w=1-W(t,h,f),b.push(it[c]),b.push($e[c])):c===24?(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),C=W(t,f,h),b.push(it[c]),b.push(_t[c])):c===146?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),C=1-W(s,h,f),b.push(it[c]),b.push(_t[c])):c===6?(D=1-W(t,h,d),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),b.push($e[c]),b.push(Dt[c])):c===164?(D=W(s,d,h),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),b.push($e[c]),b.push(Dt[c])):c===129?(E=1-W(t,d,p),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),b.push(_t[c]),b.push(Yt[c])):c===41?(E=W(s,p,d),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),b.push(_t[c]),b.push(Yt[c])):c===66?(S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=1-W(t,h,f),b.push(Dt[c]),b.push(_t[c])):c===104?(S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=W(s,f,h),b.push(_t[c]),b.push(Dr[c])):c===144?(A=W(t,d,h),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f),b.push(it[c]),b.push(Ut[c])):c===26?(A=1-W(s,h,d),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h),b.push(it[c]),b.push(Ut[c])):c===36?(D=W(s,d,h),S=W(t,p,d),w=W(t,f,h),C=W(s,f,h),b.push($e[c]),b.push(Dt[c])):c===134?(D=1-W(t,h,d),S=1-W(s,d,p),w=1-W(s,h,f),C=1-W(t,h,f),b.push($e[c]),b.push(Dt[c])):c===9?(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=1-W(t,f,p),b.push(it[c]),b.push($e[c])):c===161?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=W(s,p,f),b.push(it[c]),b.push($e[c])):c===37?(D=W(s,d,h),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),b.push($e[c]),b.push(Yt[c])):c===133?(D=1-W(t,h,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),b.push($e[c]),b.push(Yt[c])):c===148?(S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f),b.push(Dt[c]),b.push(Ut[c])):c===22?(S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h),b.push(Dt[c]),b.push(Ut[c])):c===82?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),b.push(it[c]),b.push(_t[c])):c===88?(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),b.push(it[c]),b.push(_t[c])):c===73?(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),w=1-W(t,h,f),b.push(it[c]),b.push($e[c])):c===97?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),w=W(s,f,h),b.push(it[c]),b.push($e[c])):c===145?(A=W(t,d,h),E=1-W(t,d,p),M=W(s,p,f),C=1-W(s,h,f),b.push(it[c]),b.push(Yt[c])):c===25?(A=1-W(s,h,d),E=W(s,p,d),M=1-W(t,f,p),C=W(t,f,h),b.push(it[c]),b.push(Yt[c])):c===70?(D=1-W(t,h,d),S=1-W(s,d,p),P=1-W(s,f,p),w=1-W(t,h,f),b.push($e[c]),b.push(Dt[c])):c===100?(D=W(s,d,h),S=W(t,p,d),P=W(t,p,f),w=W(s,f,h),b.push($e[c]),b.push(Dt[c])):c===34?(y===0?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),b.push(it[c]),b.push($e[c]),b.push(Yt[c]),b.push(Ut[c])):c===35?(y===4?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),b.push(it[c]),b.push($e[c]),b.push(_t[c]),b.push(Ut[c])):c===136?(y===0?(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),b.push(it[c]),b.push($e[c]),b.push(Yt[c]),b.push(Ut[c])):c===153?(y===0?(A=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),C=1-W(s,h,f)),b.push(it[c]),b.push(_t[c])):c===102?(y===0?(D=1-W(t,h,d),S=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),b.push($e[c]),b.push(Ut[c])):c===155?(y===4?(A=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),C=1-W(s,h,f)),b.push(it[c]),b.push(Yt[c])):c===103?(y===4?(D=1-W(t,h,d),S=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),b.push($e[c]),b.push(Dt[c])):c===152?(y===0?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f)),b.push(it[c]),b.push(Dt[c]),b.push(_t[c])):c===156?(y===4?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f)),b.push(it[c]),b.push(_t[c]),b.push(Ut[c])):c===137?(y===0?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),b.push(it[c]),b.push($e[c]),b.push(_t[c])):c===139?(y===4?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),b.push(it[c]),b.push($e[c]),b.push(Yt[c])):c===98?(y===0?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),b.push(it[c]),b.push($e[c]),b.push(Ut[c])):c===99?(y===4?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),b.push(it[c]),b.push($e[c]),b.push(_t[c])):c===38?(y===0?(D=1-W(t,h,d),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),b.push($e[c]),b.push(Yt[c]),b.push(Ut[c])):c===39?(y===4?(D=1-W(t,h,d),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),b.push($e[c]),b.push(Dt[c]),b.push(Ut[c])):c===85&&(A=1,D=0,S=1,E=0,M=0,P=1,w=0,C=1),(w<0||w>1||C<0||C>1||A<0||A>1||S<0||S>1||M<0||M>1||P<0||P>1)&&console.log("MarchingSquaresJS-isoBands: "+c+" "+_+" "+f+","+h+","+d+","+p+" "+y+" "+w+" "+C+" "+A+" "+D+" "+S+" "+E+" "+M+" "+P),a.cells[u][l]={cval:c,cval_real:_,flipped:y,topleft:w,topright:C,righttop:A,rightbottom:D,bottomright:S,bottomleft:E,leftbottom:M,lefttop:P,edges:b}}}}}return a}function K3e(e){for(var t=[],n=e.rows,r=e.cols,o=[],a=0;a<n;a++)for(var s=0;s<r;s++)if(typeof e.cells[a][s]<"u"&&e.cells[a][s].edges.length>0){var u=e.cells[a][s],l=J3e(u),c=null,f=s,h=a;l!==null&&o.push([l.p[0]+f,l.p[1]+h]);do{if(c=$3e(e.cells[h][f],l.x,l.y,l.o),c!==null)o.push([c.p[0]+f,c.p[1]+h]),f+=c.x,h+=c.y,l=c;else break;if(h<0||h>=n||f<0||f>=r||typeof e.cells[h][f]>"u"){f-=c.x,h-=c.y;var d=Z3e(e,f,h,c.x,c.y,c.o);if(d!==null)d.path.forEach(function(p){o.push(p)}),f=d.i,h=d.j,l=d;else break}}while(typeof e.cells[h][f]<"u"&&e.cells[h][f].edges.length>0);t.push(o),o=[],e.cells[a][s].edges.length>0&&s--}return t}function Z3e(e,t,n,r,o,a){for(var s=e.cells[n][t],u=s.cval_real,l=t+r,c=n+o,f=[],h=!1;!h;){if(typeof e.cells[c]>"u"||typeof e.cells[c][l]>"u")if(c-=o,l-=r,s=e.cells[c][l],u=s.cval_real,o===-1)if(a===0)if(u&vu)f.push([l,c]),r=-1,o=0,a=0;else if(u&Us)f.push([l+1,c]),r=1,o=0,a=0;else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&vu)f.push([l,c]),r=-1,o=0,a=0;else if(u&Us){f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else{f.push([l+s.bottomleft,c]),r=0,o=1,a=0,h=!0;break}else if(o===1)if(a===0)if(u&Ph)f.push([l+1,c+1]),r=1,o=0,a=1;else if(u&Xu){f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else{f.push([l+s.topright,c+1]),r=0,o=-1,a=1,h=!0;break}else u&Ph?(f.push([l+1,c+1]),r=1,o=0,a=1):(f.push([l+1,c+1]),r=1,o=0,a=1);else if(r===-1)if(a===0)if(u&Xu)f.push([l,c+1]),r=0,o=1,a=0;else if(u&vu){f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{f.push([l,c+s.lefttop]),r=1,o=0,a=1,h=!0;break}else if(u&Xu)f.push([l,c+1]),r=0,o=1,a=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(r===1)if(a===0)if(u&Us)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else if(u&Us)f.push([l+1,c]),r=0,o=-1,a=1;else if(u&Ph){f.push([l+1,c+s.righttop]),r=-1,o=0,a=1;break}else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(s=e.cells[c][l],u=s.cval_real,r===-1)if(a===0)if(typeof e.cells[c-1]<"u"&&typeof e.cells[c-1][l]<"u")r=0,o=-1,a=1;else if(u&vu)f.push([l,c]);else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&Xu)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+c);break}else if(r===1)if(a===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof e.cells[c+1]<"u"&&typeof e.cells[c+1][l]<"u")r=0,o=1,a=0;else if(u&Ph)f.push([l+1,c+1]),r=1,o=0,a=1;else{f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else if(o===-1)if(a===1)if(typeof e.cells[c][l+1]<"u")r=1,o=0,a=1;else if(u&Us)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.righttop]),r=-1,o=0,a=1,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(o===1)if(a===0)if(typeof e.cells[c][l-1]<"u")r=-1,o=0,a=0;else if(u&Xu)f.push([l,c+1]),r=0,o=1,a=0;else{f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(l+=r,c+=o,l===t&&c===n)break}return{path:f,i:l,j:c,x:r,y:o,o:a}}function Q3e(e,t){delete e.edges[t];for(var n=t+1;n<e.edges.length;n++)e.edges[n-1]=e.edges[n];e.edges.pop()}function J3e(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],n=e.cval_real;switch(t){case 0:return n&Ph?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return n&Us?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return n&Us?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return n&vu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return n&Ph?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return n&Us?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return n&Us?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return n&vu?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return n&Us?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return n&vu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return n&vu?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return n&Xu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return n&Us?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return n&vu?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return n&vu?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return n&Xu?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return n&Us?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return n&Xu?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return n&vu?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return n&Xu?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return n&Xu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return n&Ph?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return n&Xu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return n&Ph?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e);break}}return null}function $3e(e,t,n,r){var o,a,s,u,l=e.cval,c;switch(t){case-1:switch(r){case 0:o=$e[l],s=pr[l],u=mr[l],c=gr[l];break;default:o=it[l],s=fr[l],u=hr[l],c=dr[l];break}break;case 1:switch(r){case 0:o=Yt[l],s=Ar[l],u=br[l],c=Ir[l];break;default:o=Ut[l],s=Er[l],u=Tr[l],c=Sr[l];break}break;default:switch(n){case-1:switch(r){case 0:o=Dr[l],s=or[l],u=ar[l],c=sr[l];break;default:o=Lr[l],s=ur[l],u=lr[l],c=cr[l];break}break;case 1:switch(r){case 0:o=_t[l],s=_r[l],u=yr[l],c=vr[l];break;default:o=Dt[l],s=Cr[l],u=xr[l],c=wr[l];break}break;default:break}break}if(a=e.edges.indexOf(o),typeof e.edges[a]<"u")Q3e(e,a);else return null;switch(l=e.cval_real,o){case 0:l&Ph?(t=e.topleft,n=1):(t=1,n=e.righttop);break;case 1:l&Us?(t=1,n=e.rightbottom):(t=e.topleft,n=1);break;case 2:l&Us?(t=e.topleft,n=1):(t=e.bottomright,n=0);break;case 3:l&vu?(t=e.bottomleft,n=0):(t=e.topleft,n=1);break;case 4:l&Ph?(t=e.topright,n=1):(t=1,n=e.righttop);break;case 5:l&Us?(t=1,n=e.rightbottom):(t=e.topright,n=1);break;case 6:l&Us?(t=e.topright,n=1):(t=e.bottomright,n=0);break;case 7:l&vu?(t=e.bottomleft,n=0):(t=e.topright,n=1);break;case 8:l&Us?(t=1,n=e.righttop):(t=e.bottomright,n=0);break;case 9:l&vu?(t=e.bottomleft,n=0):(t=1,n=e.righttop);break;case 10:l&vu?(t=1,n=e.righttop):(t=0,n=e.leftbottom);break;case 11:l&Xu?(t=0,n=e.lefttop):(t=1,n=e.righttop);break;case 12:l&Us?(t=1,n=e.rightbottom):(t=e.bottomright,n=0);break;case 13:l&vu?(t=e.bottomleft,n=0):(t=1,n=e.rightbottom);break;case 14:l&vu?(t=1,n=e.rightbottom):(t=0,n=e.leftbottom);break;case 15:l&Xu?(t=0,n=e.lefttop):(t=1,n=e.rightbottom);break;case 16:l&Us?(t=0,n=e.leftbottom):(t=e.bottomright,n=0);break;case 17:l&Xu?(t=0,n=e.lefttop):(t=e.bottomright,n=0);break;case 18:l&vu?(t=e.bottomleft,n=0):(t=0,n=e.leftbottom);break;case 19:l&Xu?(t=0,n=e.lefttop):(t=e.bottomleft,n=0);break;case 20:l&Xu?(t=0,n=e.leftbottom):(t=e.topleft,n=1);break;case 21:l&Ph?(t=e.topright,n=1):(t=0,n=e.leftbottom);break;case 22:l&Xu?(t=0,n=e.lefttop):(t=e.topleft,n=1);break;case 23:l&Ph?(t=e.topright,n=1):(t=0,n=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return(typeof t>"u"||typeof n>"u"||typeof s>"u"||typeof u>"u"||typeof c>"u")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+n+" "+s+" "+u+" "+c)),{p:[t,n],x:s,y:u,o:c}}function eBe(e){var t=[],n=0;return e.cells.forEach(function(r,o){r.forEach(function(a,s){if(typeof a<"u"){var u=Xe[a.cval](a);typeof u=="object"&&s4(u)?typeof u[0]=="object"&&s4(u[0])?typeof u[0][0]=="object"&&s4(u[0][0])?u.forEach(function(l){l.forEach(function(c){c[0]+=s,c[1]+=o}),t[n++]=l}):(u.forEach(function(l){l[0]+=s,l[1]+=o}),t[n++]=u):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}function tBe(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(qd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!yt(o))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=d3e(e,{zProperty:r,flip:!0}),u=nBe(s,t,r);u=rBe(u,s,e);var l=u.map(function(c,f){if(a[f]&&!yt(a[f]))throw new Error("Each mappedProperty is required to be an Object");var h=Object.assign({},o,a[f]);h[r]=c[r];var d=nw(c.groupedRings,h);return d});return kt(l)}function nBe(e,t,n){for(var r=[],o=1;o<t.length;o++){var a=+t[o-1],s=+t[o],u=m3e(e,a,s-a),l=iBe(u),c=oBe(l),f={};f.groupedRings=c,f[n]=a+"-"+s,r.push(f)}return r}function rBe(e,t,n){var r=Pa(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){p.groupedRings.forEach(function(_){_.forEach(function(y){y.forEach(d)})})}),e}function iBe(e){var t=[],n=[];e.forEach(function(o){var a=TA(ir([o]));n.push(a),t.push({ring:o,area:a})}),n.sort(function(o,a){return a-o});var r=[];return n.forEach(function(o){for(var a=0;a<t.length;a++)if(t[a].area===o){r.push(t[a].ring),t.splice(a,1);break}}),r}function oBe(e){for(var t=e.map(function(l){return{lrCoordinates:l,grouped:!1}}),n=[];!sBe(t);)for(var r=0;r<t.length;r++)if(!t[r].grouped){var o=[];o.push(t[r].lrCoordinates),t[r].grouped=!0;for(var a=ir([t[r].lrCoordinates]),s=r+1;s<t.length;s++)if(!t[s].grouped){var u=ir([t[s].lrCoordinates]);aBe(u,a)&&(o.push(t[s].lrCoordinates),t[s].grouped=!0)}n.push(o)}return n}function aBe(e,t){for(var n=q4(e),r=0;r<n.features.length;r++)if(!To(n.features[r],t))return!1;return!0}function sBe(e){for(var t=0;t<e.length;t++)if(e[t].grouped===!1)return!1;return!0}function vre(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.pivot,o=n.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");return t===0||(r||(r=gv(e)),(o===!1||o===void 0)&&(e=Su(e)),$a(e,function(a){var s=$0(r,a),u=s+t,l=hR(r,a),c=St(O1(r,l,u));a[0]=c[0],a[1]=c[1]})),e}function Cre(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!e)throw new Error("geojson required");if(typeof t!="number"||t===0)throw new Error("invalid factor");var a=Array.isArray(r)||typeof r=="object";return o!==!0&&(e=Su(e)),e.type==="FeatureCollection"&&!a?(mi(e,function(s,u){e.features[u]=kte(s,t,r)}),e):kte(e,t,r)}function kte(e,t,n){var r=ki(e)==="Point";return n=uBe(e,n),t===1||r||$a(e,function(o){var a=hR(n,o),s=$0(n,o),u=a*t,l=St(O1(n,u,s));o[0]=l[0],o[1]=l[1],o.length===3&&(o[2]*=t)}),e}function uBe(e,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return fo(t);var n=e.bbox?e.bbox:Pa(e),r=n[0],o=n[1],a=n[2],s=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return Yr([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return Yr([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return Yr([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Yr([a,s]);case"center":return cR(e);case void 0:case null:case"centroid":return gv(e);default:throw new Error("invalid origin")}}function lBe(e,t,n,r){if(r=r||{},!yt(r))throw new Error("options is invalid");var o=r.units,a=r.zTranslation,s=r.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(a&&typeof a!="number"&&isNaN(a))throw new Error("zTranslation is not a number");if(a=a!==void 0?a:0,t===0&&a===0)return e;if(n==null||isNaN(n))throw new Error("direction is required");return t<0&&(t=-t,n=-n),(s===!1||s===void 0)&&(e=Su(e)),$a(e,function(u){var l=St(O1(u,t,n,{units:o}));u[0]=l[0],u[1]=l[1],a&&u.length===3&&(u[2]+=a)}),e}function WL(e){var t=e[0],n=e[1];return[n[0]-t[0],n[1]-t[1]]}function E4(e,t){return e[0]*t[1]-t[0]*e[1]}function cBe(e,t){return[e[0]+t[0],e[1]+t[1]]}function fBe(e,t){return[e[0]-t[0],e[1]-t[1]]}function hBe(e,t){return[e*t[0],e*t[1]]}function dBe(e,t){var n=e[0],r=WL(e),o=t[0],a=WL(t),s=E4(r,a),u=fBe(o,n),l=E4(u,a),c=l/s,f=cBe(n,hBe(c,r));return f}function pBe(e,t){var n=WL(e),r=WL(t);return E4(n,r)===0}function mBe(e,t){return pBe(e,t)?!1:dBe(e,t)}function gBe(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var o=ki(e),a=e.properties;switch(o){case"LineString":return Gte(e,t,r);case"MultiLineString":var s=[];return Da(e,function(u){s.push(Gte(u,t,r).geometry.coordinates)}),p_(s,a);default:throw new Error("geometry "+o+" is not supported")}}function Gte(e,t,n){var r=[],o=VL(t,n),a=St(e),s=[];return a.forEach(function(u,l){if(l!==a.length-1){var c=_Be(u,a[l+1],o);if(r.push(c),l>0){var f=r[l-1],h=mBe(c,f);h!==!1&&(f[1]=h,c[0]=h),s.push(f[0]),l===a.length-2&&(s.push(c[0]),s.push(c[1]))}a.length===2&&(s.push(c[0]),s.push(c[1]))}}),Vi(s,e.properties)}function _Be(e,t,n){var r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),o=e[0]+n*(t[1]-e[1])/r,a=t[0]+n*(t[1]-e[1])/r,s=e[1]+n*(e[0]-t[0])/r,u=t[1]+n*(e[0]-t[0])/r;return[[o,s],[a,u]]}function tV(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],a=n[0]-t[0],s=n[1]-t[1];return Math.sign(r*s-a*o)}function yBe(e,t){var n=e.geometry.coordinates.map(function(s){return s[0]}),r=e.geometry.coordinates.map(function(s){return s[1]}),o=t.geometry.coordinates.map(function(s){return s[0]}),a=t.geometry.coordinates.map(function(s){return s[1]});return Math.max(null,n)===Math.max(null,o)&&Math.max(null,r)===Math.max(null,a)&&Math.min(null,n)===Math.min(null,o)&&Math.min(null,r)===Math.min(null,a)}function Ute(e,t){return t.geometry.coordinates[0].every(function(n){return To(Yr(n),e)})}function vBe(e,t){return e[0]===t[0]&&e[1]===t[1]}var tm=function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};tm.buildId=function(t){return t.join(",")};tm.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(n){return n.from.id!==t.from.id})};tm.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(n){return n.to.id!==t.to.id})};tm.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1};tm.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(n,r){var o=n.to,a=r.to;if(o.coordinates[0]-t.coordinates[0]>=0&&a.coordinates[0]-t.coordinates[0]<0)return 1;if(o.coordinates[0]-t.coordinates[0]<0&&a.coordinates[0]-t.coordinates[0]>=0)return-1;if(o.coordinates[0]-t.coordinates[0]===0&&a.coordinates[0]-t.coordinates[0]===0)return o.coordinates[1]-t.coordinates[1]>=0||a.coordinates[1]-t.coordinates[1]>=0?o.coordinates[1]-a.coordinates[1]:a.coordinates[1]-o.coordinates[1];var s=tV(t.coordinates,o.coordinates,a.coordinates);if(s<0)return 1;if(s>0)return-1;var u=Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2),l=Math.pow(a.coordinates[0]-t.coordinates[0],2)+Math.pow(a.coordinates[1]-t.coordinates[1],2);return u-l}),this.outerEdgesSorted=!0)};tm.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges};tm.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]};tm.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var i_=function(t,n){this.from=t,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};i_.prototype.getSymetric=function(){return this.symetric||(this.symetric=new i_(this.to,this.from),this.symetric.symetric=this),this.symetric};i_.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)};i_.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id};i_.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"};i_.prototype.toLineString=function(){return Vi([this.from.coordinates,this.to.coordinates])};i_.prototype.compareTo=function(t){return tV(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var cc=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},xre={length:{configurable:!0}};cc.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0};cc.prototype.get=function(t){return this.edges[t]};xre.length.get=function(){return this.edges.length};cc.prototype.forEach=function(t){this.edges.forEach(t)};cc.prototype.map=function(t){return this.edges.map(t)};cc.prototype.some=function(t){return this.edges.some(t)};cc.prototype.isValid=function(){return!0};cc.prototype.isHole=function(){var t=this,n=this.edges.reduce(function(s,u,l){return u.from.coordinates[1]>t.edges[s].from.coordinates[1]&&(s=l),s},0),r=(n===0?this.length:n)-1,o=(n+1)%this.length,a=tV(this.edges[r].from.coordinates,this.edges[n].from.coordinates,this.edges[o].from.coordinates);return a===0?this.edges[r].from.coordinates[0]>this.edges[o].from.coordinates[0]:a>0};cc.prototype.toMultiPoint=function(){return oR(this.edges.map(function(t){return t.from.coordinates}))};cc.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(n){return n.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=ir([t])};cc.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=Jne(this.toPolygon())};cc.findEdgeRingContaining=function(t,n){var r=t.getEnvelope(),o,a;return n.forEach(function(s){var u=s.getEnvelope();if(a&&(o=a.getEnvelope()),!yBe(u,r)&&Ute(u,r)){var l=t.map(function(c){return c.from.coordinates}).find(function(c){return!s.some(function(f){return vBe(c,f.from.coordinates)})});l&&s.inside(Yr(l))&&(!a||Ute(o,u))&&(a=s)}}),a};cc.prototype.inside=function(t){return To(t,this.toPolygon())};Object.defineProperties(cc.prototype,xre);function CBe(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var bl=function(){this.edges=[],this.nodes={}};bl.fromGeoJson=function(t){CBe(t);var n=new bl;return Da(t,function(r){yA(r,"LineString","Graph::fromGeoJson"),sR(r,function(o,a){if(o){var s=n.getNode(o),u=n.getNode(a);n.addEdge(s,u)}return a})}),n};bl.prototype.getNode=function(t){var n=tm.buildId(t),r=this.nodes[n];return r||(r=this.nodes[n]=new tm(t)),r};bl.prototype.addEdge=function(t,n){var r=new i_(t,n),o=r.getSymetric();this.edges.push(r),this.edges.push(o)};bl.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(n){return t.nodes[n]}).forEach(function(n){return t._removeIfDangle(n)})};bl.prototype._removeIfDangle=function(t){var n=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map(function(o){return o.to});this.removeNode(t),r.forEach(function(o){return n._removeIfDangle(o)})}};bl.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(n){n.label===n.symetric.label&&(t.removeEdge(n.symetric),t.removeEdge(n))})};bl.prototype._computeNextCWEdges=function(t){var n=this;typeof t>"u"?Object.keys(this.nodes).forEach(function(r){return n._computeNextCWEdges(n.nodes[r])}):t.getOuterEdges().forEach(function(r,o){t.getOuterEdge((o===0?t.getOuterEdges().length:o)-1).symetric.next=r})};bl.prototype._computeNextCCWEdges=function(t,n){for(var r=t.getOuterEdges(),o,a,s=r.length-1;s>=0;--s){var u=r[s],l=u.symetric,c=void 0,f=void 0;u.label===n&&(c=u),l.label===n&&(f=l),!(!c||!f)&&(f&&(a=f),c&&(a&&(a.next=c,a=void 0),o||(o=c)))}a&&(a.next=o)};bl.prototype._findLabeledEdgeRings=function(){var t=[],n=0;return this.edges.forEach(function(r){if(!(r.label>=0)){t.push(r);var o=r;do o.label=n,o=o.next;while(!r.isEqual(o));n++}}),t};bl.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){t._findIntersectionNodes(r).forEach(function(o){t._computeNextCCWEdges(o,r.label)})});var n=[];return this.edges.forEach(function(r){r.ring||n.push(t._findEdgeRing(r))}),n};bl.prototype._findIntersectionNodes=function(t){var n=[],r=t,o=function(){var a=0;r.from.getOuterEdges().forEach(function(s){s.label===t.label&&++a}),a>1&&n.push(r.from),r=r.next};do o();while(!t.isEqual(r));return n};bl.prototype._findEdgeRing=function(t){var n=t,r=new cc;do r.push(n),n.ring=r,n=n.next;while(!t.isEqual(n));return r};bl.prototype.removeNode=function(t){var n=this;t.getOuterEdges().forEach(function(r){return n.removeEdge(r)}),t.innerEdges.forEach(function(r){return n.removeEdge(r)}),delete this.nodes[t.id]};bl.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(n){return!n.isEqual(t)}),t.deleteEdge()};function xBe(e){var t=bl.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var n=[],r=[];return t.getEdgeRings().filter(function(o){return o.isValid()}).forEach(function(o){o.isHole()?n.push(o):r.push(o)}),n.forEach(function(o){cc.findEdgeRingContaining(o,r)&&r.push(o)}),kt(r.map(function(o){return o.toPolygon()}))}function wBe(e,t){var n;return Da(e,function(r){Da(t,function(o){if(n===!1)return!1;n=EBe(r.geometry,o.geometry)})}),n}function EBe(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!bBe(e.coordinates,t.coordinates);case"LineString":return!Hte(t,e);case"Polygon":return!To(e,t)}break;case"LineString":switch(t.type){case"Point":return!Hte(e,t);case"LineString":return!TBe(e,t);case"Polygon":return!qte(t,e)}break;case"Polygon":switch(t.type){case"Point":return!To(t,e);case"LineString":return!qte(e,t);case"Polygon":return!SBe(t,e)}}}function Hte(e,t){for(var n=0;n<e.coordinates.length-1;n++)if(ABe(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function TBe(e,t){var n=Fg(e,t);return n.features.length>0}function qte(e,t){var n=Fg(t,UL(e));return n.features.length>0}function SBe(e,t){for(var n=0;n<e.coordinates[0].length;n++)if(To(e.coordinates[0][n],t))return!0;for(var r=0;r<t.coordinates[0].length;r++)if(To(t.coordinates[0][r],e))return!0;return!1}function ABe(e,t,n){var r=n[0]-e[0],o=n[1]-e[1],a=t[0]-e[0],s=t[1]-e[1],u=r*s-o*a;return u!==0?!1:Math.abs(a)>=Math.abs(s)?a>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:s>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function bBe(e,t){return e[0]===t[0]&&e[1]===t[1]}function IBe(e,t){var n=ki(e),r=ki(t),o=ic(e),a=ic(t),s=St(e),u=St(t);switch(n){case"Point":switch(r){case"Point":return nV(s,u);default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"Point":return DBe(o,a);case"MultiPoint":return PBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return Rc(a,o,{ignoreEndVertices:!0});case"LineString":return RBe(o,a);case"MultiPoint":return MBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return To(a,o,{ignoreBoundary:!0});case"LineString":return OBe(o,a);case"Polygon":return NBe(o,a);case"MultiPoint":return LBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function DBe(e,t){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(nV(e.coordinates[n],t.coordinates)){r=!0;break}return r}function PBe(e,t){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,o=0;o<e.coordinates.length;o++)if(nV(t.coordinates[n],e.coordinates[o])){r=!0;break}if(!r)return!1}return!0}function MBe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(Rc(t.coordinates[r],e,{ignoreEndVertices:!0})&&(n=!0),!Rc(t.coordinates[r],e))return!1;return!!n}function LBe(e,t){for(var n=0;n<t.coordinates.length;n++)if(!To(t.coordinates[n],e,{ignoreBoundary:!0}))return!1;return!0}function RBe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(Rc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!0})&&(n=!0),!Rc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!1}))return!1;return n}function OBe(e,t){var n=!1,r=0,o=Pa(e),a=Pa(t);if(!wre(o,a))return!1;for(r;r<t.coordinates.length-1;r++){var s=BBe(t.coordinates[r],t.coordinates[r+1]);if(To({type:"Point",coordinates:s},e,{ignoreBoundary:!0})){n=!0;break}}return n}function NBe(e,t){var n=Pa(e),r=Pa(t);if(!wre(n,r))return!1;for(var o=0;o<t.coordinates[0].length;o++)if(!To(t.coordinates[0][o],e))return!1;return!0}function wre(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function nV(e,t){return e[0]===t[0]&&e[1]===t[1]}function BBe(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function FBe(e,t){var n=ki(e),r=ki(t),o=ic(e),a=ic(t);switch(n){case"MultiPoint":switch(r){case"LineString":return Wte(o,a);case"Polygon":return Xte(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return Wte(a,o);case"LineString":return zBe(o,a);case"Polygon":return Yte(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return Xte(a,o);case"LineString":return Yte(a,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Wte(e,t){for(var n=!1,r=!1,o=e.coordinates.length,a=0;a<o&&!n&&!r;){for(var s=0;s<t.coordinates.length-1;s++){var u=!0;(s===0||s===t.coordinates.length-2)&&(u=!1),Ere(t.coordinates[s],t.coordinates[s+1],e.coordinates[a],u)?n=!0:r=!0}a++}return n&&r}function zBe(e,t){var n=Fg(e,t);if(n.features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var o=0;o<t.coordinates.length-1;o++){var a=!0;if((o===0||o===t.coordinates.length-2)&&(a=!1),Ere(e.coordinates[r],e.coordinates[r+1],t.coordinates[o],a))return!0}return!1}function Yte(e,t){var n=Fg(e,UL(t));return n.features.length>0}function Xte(e,t){for(var n=!1,r=!1,o=e.coordinates[0].length,a=0;a<o&&n&&r;)To(Yr(e.coordinates[0][a]),t)?n=!0:r=!0,a++;return r&&r}function Ere(e,t,n,r){var o=n[0]-e[0],a=n[1]-e[1],s=t[0]-e[0],u=t[1]-e[1],l=o*u-a*s;return l!==0?!1:r?Math.abs(s)>=Math.abs(u)?s>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:u>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]:Math.abs(s)>=Math.abs(u)?s>0?e[0]<n[0]&&n[0]<t[0]:t[0]<n[0]&&n[0]<e[0]:u>0?e[1]<n[1]&&n[1]<t[1]:t[1]<n[1]&&n[1]<e[1]}var T4=Bg(function(e,t){t=e.exports=typeof Object.keys=="function"?Object.keys:n,t.shim=n;function n(r){var o=[];for(var a in r)o.push(a);return o}}),T4t=T4.shim,YL=Bg(function(e,t){var n=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";t=e.exports=n?r:o,t.supported=r;function r(a){return Object.prototype.toString.call(a)=="[object Arguments]"}t.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}}),S4t=YL.supported,A4t=YL.unsupported,VBe=Bg(function(e){var t=Array.prototype.slice,n=e.exports=function(s,u,l){return l||(l={}),s===u?!0:s instanceof Date&&u instanceof Date?s.getTime()===u.getTime():!s||!u||typeof s!="object"&&typeof u!="object"?l.strict?s===u:s==u:a(s,u,l)};function r(s){return s==null}function o(s){return!(!s||typeof s!="object"||typeof s.length!="number"||typeof s.copy!="function"||typeof s.slice!="function"||s.length>0&&typeof s[0]!="number")}function a(s,u,l){var c,f;if(r(s)||r(u)||s.prototype!==u.prototype)return!1;if(YL(s))return YL(u)?(s=t.call(s),u=t.call(u),n(s,u,l)):!1;if(o(s)){if(!o(u)||s.length!==u.length)return!1;for(c=0;c<s.length;c++)if(s[c]!==u[c])return!1;return!0}try{var h=T4(s),d=T4(u)}catch{return!1}if(h.length!=d.length)return!1;for(h.sort(),d.sort(),c=h.length-1;c>=0;c--)if(h[c]!=d[c])return!1;for(c=h.length-1;c>=0;c--)if(f=h[c],!n(s[f],u[f],l))return!1;return typeof s==typeof u}}),um=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:kBe};um.prototype.compare=function(e,t){if(e.type!==t.type||!Tre(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(e.type.indexOf("Multi")===0){var n=this,r=jte(e),o=jte(t);return r.every(function(a){return this.some(function(s){return n.compare(a,s)})},o)}}return!1};function jte(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function Tre(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}um.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].toFixed(this.precision)!==t[n].toFixed(this.precision))return!1;return!0};um.prototype.compareLine=function(e,t,n,r){if(!Tre(e,t))return!1;var o=this.pseudoNode?e:this.removePseudo(e),a=this.pseudoNode?t:this.removePseudo(t);if(!(r&&!this.compareCoord(o[0],a[0])&&(a=this.fixStartIndex(a,o),!a))){var s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}};um.prototype.fixStartIndex=function(e,t){for(var n,r=-1,o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){r=o;break}return r>=0&&(n=[].concat(e.slice(r,e.length),e.slice(1,r+1))),n};um.prototype.comparePath=function(e,t){var n=this;return e.every(function(r,o){return n.compareCoord(r,this[o])},t)};um.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var n=e.coordinates.slice(1,e.coordinates.length),r=t.coordinates.slice(1,t.coordinates.length),o=this;return n.every(function(a){return this.some(function(s){return o.compareLine(a,s,1,!0)})},r)}else return!1};um.prototype.compareFeature=function(e,t){return e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t)?!1:this.compare(e.geometry,t.geometry)};um.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))};um.prototype.removePseudo=function(e){return e};function kBe(e,t){return VBe(e,t,{strict:!0})}var Sre=um;function Are(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=ki(e),r=ki(t);if(n!==r)throw new Error("features must be of the same type");if(n==="Point")throw new Error("Point geometry not supported");var o=new Sre({precision:6});if(o.compare(e,t))return!1;var a=0;switch(n){case"MultiPoint":var s=$p(e),u=$p(t);s.forEach(function(l){u.forEach(function(c){l[0]===c[0]&&l[1]===c[1]&&a++})});break;case"LineString":case"MultiLineString":xg(e,function(l){xg(t,function(c){yre(l,c).features.length&&a++})});break;case"Polygon":case"MultiPolygon":xg(e,function(l){xg(t,function(c){Fg(l,c).features.length&&a++})});break}return a>0}function GBe(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=ki(e),r=ki(t);if(n!==r)return!1;var o=new Sre({precision:6});return o.compare(Ag(e),Ag(t))}var UBe=Bg(function(e){function t(n,r,o,a){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,o,a)}t.prototype.run=function(n,r,o,a){this._init(n,r,o,a);for(var s=0;s<this._datasetLength;s++)if(this._visited[s]!==1){this._visited[s]=1;var u=this._regionQuery(s);if(u.length<this.minPts)this.noise.push(s);else{var l=this.clusters.length;this.clusters.push([]),this._addToCluster(s,l),this._expandCluster(l,u)}}return this.clusters},t.prototype._init=function(n,r,o,a){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),o&&(this.minPts=o),a&&(this.distance=a)},t.prototype._expandCluster=function(n,r){for(var o=0;o<r.length;o++){var a=r[o];if(this._visited[a]!==1){this._visited[a]=1;var s=this._regionQuery(a);s.length>=this.minPts&&(r=this._mergeArrays(r,s))}this._assigned[a]!==1&&this._addToCluster(a,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],o=0;o<this._datasetLength;o++){var a=this.distance(this.dataset[n],this.dataset[o]);a<this.epsilon&&r.push(o)}return r},t.prototype._mergeArrays=function(n,r){for(var o=r.length,a=0;a<o;a++){var s=r[a];n.indexOf(s)<0&&n.push(s)}return n},t.prototype._euclideanDistance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;)o+=(n[a]-r[a])*(n[a]-r[a]);return Math.sqrt(o)},e.exports&&(e.exports=t)}),HBe=Bg(function(e){function t(n,r,o){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,o)}t.prototype.init=function(n,r,o){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof o<"u"&&(this.distance=o)},t.prototype.run=function(n,r){this.init(n,r);for(var o=this.dataset.length,a=0;a<this.k;a++)this.centroids[a]=this.randomCentroid();for(var s=!0;s;){s=this.assign();for(var u=0;u<this.k;u++){for(var l=new Array(d),c=0,f=0;f<d;f++)l[f]=0;for(var h=0;h<o;h++){var d=this.dataset[h].length;if(u===this.assignments[h]){for(var f=0;f<d;f++)l[f]+=this.dataset[h][f];c++}}if(c>0){for(var f=0;f<d;f++)l[f]/=c;this.centroids[u]=l}else this.centroids[u]=this.randomCentroid(),s=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,o;do o=Math.round(Math.random()*n),r=this.dataset[o];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,o,a=0;a<r;a++)o=this.argmin(this.dataset[a],this.centroids,this.distance),o!=this.assignments[a]&&(this.assignments[a]=o,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,o=0;o<this.assignments.length;o++)r=this.assignments[o],typeof n[r]>"u"&&(n[r]=[]),n[r].push(o);return n},t.prototype.argmin=function(n,r,o){for(var a=Number.MAX_VALUE,s=0,u=r.length,l,c=0;c<u;c++)l=o(n,r[c]),l<a&&(a=l,s=c);return s},t.prototype.distance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;){var s=n[a]-r[a];o+=s*s}return Math.sqrt(o)},e.exports&&(e.exports=t)}),bre=Bg(function(e){function t(n,r,o){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,o)}t.prototype.insert=function(n,r){for(var o=this._queue.length,a=o;a--;){var s=this._priorities[a];this._sorting==="desc"?r>s&&(o=a):r<s&&(o=a)}this._insertAt(n,r,o)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var o=this._queue[r];if(n===o){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,o=this._queue.length;r<o;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,o){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var a=0;a<n.length;a++)this.insert(n[a],r[a])}o&&(this._sorting=o)},t.prototype._insertAt=function(n,r,o){this._queue.length===o?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(o,0,n),this._priorities.splice(o,0,r))},e.exports&&(e.exports=t)}),qBe=Bg(function(e){if(e.exports)var t=bre;function n(r,o,a,s){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,o,a,s)}n.prototype.run=function(r,o,a,s){this._init(r,o,a,s);for(var u=0,l=this.dataset.length;u<l;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var c=this.clusters.length-1;this._orderedList.push(u);var f=new t(null,null,"asc"),h=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,h,f),this._expandCluster(c,f))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],o=0,a=this._orderedList.length;o<a;o++){var s=this._orderedList[o],u=this._reachability[s];r.push([s,u])}return r},n.prototype._init=function(r,o,a,s){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}o&&(this.epsilon=o),a&&(this.minPts=a),s&&(this.distance=s)},n.prototype._updateQueue=function(r,o,a){var s=this;this._coreDistance=this._distanceToCore(r),o.forEach(function(u){if(s._processed[u]===void 0){var l=s.distance(s.dataset[r],s.dataset[u]),c=Math.max(s._coreDistance,l);s._reachability[u]===void 0?(s._reachability[u]=c,a.insert(u,c)):c<s._reachability[u]&&(s._reachability[u]=c,a.remove(u),a.insert(u,c))}})},n.prototype._expandCluster=function(r,o){for(var a=o.getElements(),s=0,u=a.length;s<u;s++){var l=a[s];if(this._processed[l]===void 0){var c=this._regionQuery(l);this._processed[l]=1,this.clusters[r].push(l),this._orderedList.push(l),this._distanceToCore(l)!==void 0&&(this._updateQueue(l,c,o),this._expandCluster(r,o))}}},n.prototype._distanceToCore=function(r){for(var o=this.epsilon,a=0;a<o;a++){var s=this._regionQuery(r,a);if(s.length>=this.minPts)return a}},n.prototype._regionQuery=function(r,o){o=o||this.epsilon;for(var a=[],s=0,u=this.dataset.length;s<u;s++)this.distance(this.dataset[r],this.dataset[s])<o&&a.push(s);return a},n.prototype._euclideanDistance=function(r,o){for(var a=0,s=Math.min(r.length,o.length);s--;)a+=(r[s]-o[s])*(r[s]-o[s]);return Math.sqrt(a)},e.exports&&(e.exports=n)}),YA=Bg(function(e){e.exports&&(e.exports={DBSCAN:UBe,KMEANS:HBe,OPTICS:qBe,PriorityQueue:bre})}),b4t=YA.DBSCAN,I4t=YA.KMEANS,D4t=YA.OPTICS,P4t=YA.PriorityQueue;function WBe(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.minPoints,o=n.units;if(qd(e,"Point","Input must contain Points"),t==null)throw new Error("maxDistance is required");if(!(Math.sign(t)>0))throw new Error("Invalid maxDistance");if(!(r==null||Math.sign(r)>0))throw new Error("Invalid minPoints");e=Su(e,!0),r=r||3;var a=new YA.DBSCAN,s=a.run($p(e),mv(t,o),r,di),u=-1;return s.forEach(function(l){u++,l.forEach(function(c){var f=e.features[c];f.properties||(f.properties={}),f.properties.cluster=u,f.properties.dbscan="core"})}),a.noise.forEach(function(l){var c=e.features[l];c.properties||(c.properties={}),c.properties.cluster?c.properties.dbscan="edge":c.properties.dbscan="noise"}),e}var rV={eudist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++){var u=(t[s]||0)-(n[s]||0);a+=u*u}return r?Math.sqrt(a):a},mandist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++)a+=Math.abs((t[s]||0)-(n[s]||0));return r?Math.sqrt(a):a},dist:function(t,n,r){var o=Math.abs(t-n);return r?o:o*o}},YBe=rV.eudist,XBe=rV.dist,Ire={kmrand:function(t,n){for(var r={},o=[],a=n<<2,s=t.length,u=t[0].length>0;o.length<n&&a-- >0;){var l=t[Math.floor(Math.random()*s)],c=u?l.join("_"):""+l;r[c]||(r[c]=!0,o.push(l))}if(o.length<n)throw new Error("Error initializating clusters");return o},kmpp:function(t,n){var r=t[0].length?YBe:XBe,o=[],a=t.length,s=t[0].length>0,u=t[Math.floor(Math.random()*a)],l=s?u.join("_"):""+u;for(o.push(u);o.length<n;){for(var c=[],f=o.length,h=0,d=[],p=0;p<a;p++){for(var _=1/0,y=0;y<f;y++){var v=r(t[p],o[y]);v<=_&&(_=v)}c[p]=_}for(var w=0;w<a;w++)h+=c[w];for(var C=0;C<a;C++)d[C]={i:C,v:t[C],pr:c[C]/h,cs:0};d.sort(function(D,P){return D.pr-P.pr}),d[0].cs=d[0].pr;for(var E=1;E<a;E++)d[E].cs=d[E-1].cs+d[E].pr;for(var S=Math.random(),A=0;A<a-1&&d[A++].cs<S;);o.push(d[A-1].v)}return o}},jBe=rV.eudist,KBe=Ire.kmrand,ZBe=Ire.kmpp,Kte=1e4;function Zte(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function QBe(e,t,n,r){var o=[],a=[],s=[],u=[],l=!1,c=r||Kte,f=e.length,h=e[0].length,d=h>0,p=[];if(n)n=="kmrand"?o=KBe(e,t):n=="kmpp"?o=ZBe(e,t):o=n;else for(var _={};o.length<t;){var y=Math.floor(Math.random()*f);_[y]||(_[y]=!0,o.push(e[y]))}do{Zte(t,0,p);for(var v=0;v<f;v++){for(var w=1/0,C=0,E=0;E<t;E++){var u=d?jBe(e[v],o[E]):Math.abs(e[v]-o[E]);u<=w&&(w=u,C=E)}s[v]=C,p[C]++}for(var S=[],a=[],A=0;A<t;A++)S[A]=d?Zte(h,0,S[A]):0,a[A]=o[A];if(d){for(var D=0;D<t;D++)o[D]=[];for(var P=0;P<f;P++)for(var M=s[P],b=S[M],O=e[P],m=0;m<h;m++)b[m]+=O[m];l=!0;for(var I=0;I<t;I++){for(var L=o[I],R=S[I],N=a[I],B=p[I],V=0;V<h;V++)L[V]=R[V]/B||0;if(l){for(var z=0;z<h;z++)if(N[z]!=L[z]){l=!1;break}}}}else{for(var U=0;U<f;U++){var Q=s[U];S[Q]+=e[U]}for(var ne=0;ne<t;ne++)o[ne]=S[ne]/p[ne]||0;l=!0;for(var se=0;se<t;se++)if(a[se]!=o[se]){l=!1;break}}l=l||--c<=0}while(!l);return{it:Kte-c,k:t,idxs:s,centroids:o}}var JBe=QBe;function $Be(e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.numberOfClusters,r=t.mutate;qd(e,"Point","Input must contain Points");var o=e.features.length;n=n||Math.round(Math.sqrt(o/2)),n>o&&(n=o),(r===!1||r===void 0)&&(e=Su(e,!0));var a=$p(e),s=a.slice(0,n),u=JBe(a,n,s),l={};return u.centroids.forEach(function(c,f){l[f]=c}),mi(e,function(c,f){var h=u.idxs[f];c.properties.cluster=h,c.properties.centroid=l[h]}),e}function eFe(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var n=Qte(e,"line1");if(n!=="LineString")throw new Error("line1 must be a LineString");var r=Qte(t,"line2");if(r!=="LineString")throw new Error("line2 must be a LineString");for(var o=_v(Ag(e)).features,a=_v(Ag(t)).features,s=0;s<o.length;s++){var u=o[s].geometry.coordinates;if(!a[s])break;var l=a[s].geometry.coordinates;if(!tFe(u,l))return!1}return!0}function tFe(e,t){var n=J0($0(e[0],e[1])),r=J0($0(t[0],t[1]));return n===r}function Qte(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function Jte(e){for(var t=e,n=[];t.parent;)n.unshift(t),t=t.parent;return n}function nFe(){return new Dre(function(e){return e.f})}var pR={search:function(e,t,n,r){e.cleanDirty(),r=r||{};var o=r.heuristic||pR.heuristics.manhattan,a=r.closest||!1,s=nFe(),u=t;for(t.h=o(t,n),s.push(t);s.size()>0;){var l=s.pop();if(l===n)return Jte(l);l.closed=!0;for(var c=e.neighbors(l),f=0,h=c.length;f<h;++f){var d=c[f];if(!(d.closed||d.isWall())){var p=l.g+d.getCost(l),_=d.visited;(!_||p<d.g)&&(d.visited=!0,d.parent=l,d.h=d.h||o(d,n),d.g=p,d.f=d.g+d.h,e.markDirty(d),a&&(d.h<u.h||d.h===u.h&&d.g<u.g)&&(u=d),_?s.rescoreElement(d):s.push(d))}}}return a?Jte(u):[]},heuristics:{manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},diagonal:function(e,t){var n=1,r=Math.sqrt(2),o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return n*(o+a)+(r-2*n)*Math.min(o,a)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function iw(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var n=0;n<e.length;n++){this.grid[n]=[];for(var r=0,o=e[n];r<o.length;r++){var a=new mR(n,r,o[r]);this.grid[n][r]=a,this.nodes.push(a)}}this.init()}iw.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)pR.cleanNode(this.nodes[e])};iw.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)pR.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};iw.prototype.markDirty=function(e){this.dirtyNodes.push(e)};iw.prototype.neighbors=function(e){var t=[],n=e.x,r=e.y,o=this.grid;return o[n-1]&&o[n-1][r]&&t.push(o[n-1][r]),o[n+1]&&o[n+1][r]&&t.push(o[n+1][r]),o[n]&&o[n][r-1]&&t.push(o[n][r-1]),o[n]&&o[n][r+1]&&t.push(o[n][r+1]),this.diagonal&&(o[n-1]&&o[n-1][r-1]&&t.push(o[n-1][r-1]),o[n+1]&&o[n+1][r-1]&&t.push(o[n+1][r-1]),o[n-1]&&o[n-1][r+1]&&t.push(o[n-1][r+1]),o[n+1]&&o[n+1][r+1]&&t.push(o[n+1][r+1])),t};iw.prototype.toString=function(){for(var e=[],t=this.grid,n,r,o,a,s=0,u=t.length;s<u;s++){for(n=[],r=t[s],o=0,a=r.length;o<a;o++)n.push(r[o].weight);e.push(n.join(" "))}return e.join(`
`)};function mR(e,t,n){this.x=e,this.y=t,this.weight=n}mR.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};mR.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};mR.prototype.isWall=function(){return this.weight===0};function Dre(e){this.content=[],this.scoreFunction=e}Dre.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r))this.content[n]=t,this.content[e]=r,e=n;else break}},bubbleUp:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,a=o-1,s=null,u;if(a<t){var l=this.content[a];u=this.scoreFunction(l),u<r&&(s=a)}if(o<t){var c=this.content[o],f=this.scoreFunction(c);f<(s===null?r:u)&&(s=o)}if(s!==null)this.content[e]=this.content[s],this.content[s]=n,e=s;else break}}};function rFe(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.resolution,o=n.minDistance,a=n.obstacles||kt([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(r&&!pi(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(o)throw new Error("options.minDistance is not yet implemented");var s=fo(e),u=fo(t);switch(e=Yr(s),t=Yr(u),ki(a)){case"FeatureCollection":if(a.features.length===0)return Vi([s,u]);break;case"Polygon":a=kt([ha(ic(a))]);break;default:throw new Error("invalid obstacles")}var l=a;l.features.push(e),l.features.push(t);var c=Pa(Cre(U4(Pa(l)),1.15));if(!r){var f=di([c[0],c[1]],[c[2],c[1]],n);r=f/100}l.features.pop(),l.features.pop();for(var h=c[0],d=c[1],p=c[2],_=c[3],y=r/di([h,d],[p,d],n),v=y*(p-h),w=r/di([h,d],[h,_],n),C=w*(_-d),E=p-h,S=_-d,A=Math.floor(E/v),D=Math.floor(S/C),P=(E-A*v)/2,M=(S-D*C)/2,b=[],O=[],m=[],I=[],L=1/0,R=1/0,N=_-M,B=0;N>=d;){for(var V=[],z=[],U=h+P,Q=0;U<=p;){var ne=Yr([U,N]),se=iFe(ne,a);V.push(se?0:1),z.push(U+"|"+N);var de=di(ne,e);!se&&de<L&&(L=de,m={x:Q,y:B});var pe=di(ne,t);!se&&pe<R&&(R=pe,I={x:Q,y:B}),U+=v,Q++}O.push(V),b.push(z),N-=C,B++}var ve=new iw(O,{diagonal:!0}),ft=ve.grid[m.y][m.x],pt=ve.grid[I.y][I.x],Xt=pR.search(ve,ft,pt),At=[s];return Xt.forEach(function(wt){var Rr=b[wt.x][wt.y].split("|");At.push([+Rr[0],+Rr[1]])}),At.push(u),Ag(Vi(At))}function iFe(e,t){for(var n=0;n<t.features.length;n++)if(To(e,t.features[n]))return!0;return!1}var $te=function(e){return function(){return e}};function oFe(e){return e[0]}function aFe(e){return e[1]}function XL(){this._=null}function gR(e){e.U=e.C=e.L=e.R=e.P=e.N=null}XL.prototype={constructor:XL,insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=ene(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(o=r.R,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(oA(this,n),e=n,n=e.U),n.C=!1,r.C=!0,aA(this,r))):(o=r.L,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(aA(this,n),e=n,n=e.U),n.C=!1,r.C=!0,oA(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,o=e.R,a,s;if(r?o?a=ene(o):a=r:a=o,t?t.L===e?t.L=a:t.R=a:this._=a,r&&o?(s=a.C,a.C=e.C,a.L=r,r.U=a,a!==o?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=o,o.U=a):(a.U=t,t=a,e=a.R)):(s=e.C,e=a),e&&(e.U=t),!s){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,oA(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,aA(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,oA(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,aA(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,oA(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,aA(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function oA(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function aA(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ene(e){for(;e.L;)e=e.L;return e}function mA(e,t,n,r){var o=[null,null],a=Sl.push(o)-1;return o.left=e,o.right=t,n&&jL(o,e,t,n),r&&jL(o,t,e,r),Cf[e.index].halfedges.push(a),Cf[t.index].halfedges.push(a),o}function sA(e,t,n){var r=[t,n];return r.left=e,r}function jL(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function sFe(e,t,n,r,o){var a=e[0],s=e[1],u=a[0],l=a[1],c=s[0],f=s[1],h=0,d=1,p=c-u,_=f-l,y;if(y=t-u,!(!p&&y>0)){if(y/=p,p<0){if(y<h)return;y<d&&(d=y)}else if(p>0){if(y>d)return;y>h&&(h=y)}if(y=r-u,!(!p&&y<0)){if(y/=p,p<0){if(y>d)return;y>h&&(h=y)}else if(p>0){if(y<h)return;y<d&&(d=y)}if(y=n-l,!(!_&&y>0)){if(y/=_,_<0){if(y<h)return;y<d&&(d=y)}else if(_>0){if(y>d)return;y>h&&(h=y)}if(y=o-l,!(!_&&y<0)){if(y/=_,_<0){if(y>d)return;y>h&&(h=y)}else if(_>0){if(y<h)return;y<d&&(d=y)}return!(h>0)&&!(d<1)||(h>0&&(e[0]=[u+h*p,l+h*_]),d<1&&(e[1]=[u+d*p,l+d*_])),!0}}}}}function uFe(e,t,n,r,o){var a=e[1];if(a)return!0;var s=e[0],u=e.left,l=e.right,c=u[0],f=u[1],h=l[0],d=l[1],p=(c+h)/2,_=(f+d)/2,y,v;if(d===f){if(p<t||p>=r)return;if(c>h){if(!s)s=[p,n];else if(s[1]>=o)return;a=[p,o]}else{if(!s)s=[p,o];else if(s[1]<n)return;a=[p,n]}}else if(y=(c-h)/(d-f),v=_-y*p,y<-1||y>1)if(c>h){if(!s)s=[(n-v)/y,n];else if(s[1]>=o)return;a=[(o-v)/y,o]}else{if(!s)s=[(o-v)/y,o];else if(s[1]<n)return;a=[(n-v)/y,n]}else if(f<d){if(!s)s=[t,y*t+v];else if(s[0]>=r)return;a=[r,y*r+v]}else{if(!s)s=[r,y*r+v];else if(s[0]<t)return;a=[t,y*t+v]}return e[0]=s,e[1]=a,!0}function lFe(e,t,n,r){for(var o=Sl.length,a;o--;)(!uFe(a=Sl[o],e,t,n,r)||!sFe(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>co||Math.abs(a[0][1]-a[1][1])>co))&&delete Sl[o]}function cFe(e){return Cf[e.index]={site:e,halfedges:[]}}function fFe(e,t){var n=e.site,r=t.left,o=t.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=t[1],o=t[0]):(r=t[0],o=t[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function Pre(e,t){return t[+(t.left!==e.site)]}function hFe(e,t){return t[+(t.left===e.site)]}function dFe(){for(var e=0,t=Cf.length,n,r,o,a;e<t;++e)if((n=Cf[e])&&(a=(r=n.halfedges).length)){var s=new Array(a),u=new Array(a);for(o=0;o<a;++o)s[o]=o,u[o]=fFe(n,Sl[r[o]]);for(s.sort(function(l,c){return u[c]-u[l]}),o=0;o<a;++o)u[o]=r[s[o]];for(o=0;o<a;++o)r[o]=u[o]}}function pFe(e,t,n,r){var o=Cf.length,a,s,u,l,c,f,h,d,p,_,y,v,w=!0;for(a=0;a<o;++a)if(s=Cf[a]){for(u=s.site,c=s.halfedges,l=c.length;l--;)Sl[c[l]]||c.splice(l,1);for(l=0,f=c.length;l<f;)_=hFe(s,Sl[c[l]]),y=_[0],v=_[1],h=Pre(s,Sl[c[++l%f]]),d=h[0],p=h[1],(Math.abs(y-d)>co||Math.abs(v-p)>co)&&(c.splice(l,0,Sl.push(sA(u,_,Math.abs(y-e)<co&&r-v>co?[e,Math.abs(d-e)<co?p:r]:Math.abs(v-r)<co&&n-y>co?[Math.abs(p-r)<co?d:n,r]:Math.abs(y-n)<co&&v-t>co?[n,Math.abs(d-n)<co?p:t]:Math.abs(v-t)<co&&y-e>co?[Math.abs(p-t)<co?d:e,t]:null))-1),++f);f&&(w=!1)}if(w){var C,E,S,A=1/0;for(a=0,w=null;a<o;++a)(s=Cf[a])&&(u=s.site,C=u[0]-e,E=u[1]-t,S=C*C+E*E,S<A&&(A=S,w=s));if(w){var D=[e,t],P=[e,r],M=[n,r],b=[n,t];w.halfedges.push(Sl.push(sA(u=w.site,D,P))-1,Sl.push(sA(u,P,M))-1,Sl.push(sA(u,M,b))-1,Sl.push(sA(u,b,D))-1)}}for(a=0;a<o;++a)(s=Cf[a])&&(s.halfedges.length||delete Cf[a])}var Mre=[],iV;function mFe(){gR(this),this.x=this.y=this.arc=this.site=this.cy=null}function I1(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,o=e.site,a=n.site;if(r!==a){var s=o[0],u=o[1],l=r[0]-s,c=r[1]-u,f=a[0]-s,h=a[1]-u,d=2*(l*h-c*f);if(!(d>=-CFe)){var p=l*l+c*c,_=f*f+h*h,y=(h*p-c*_)/d,v=(l*_-f*p)/d,w=Mre.pop()||new mFe;w.arc=e,w.site=o,w.x=y+s,w.y=(w.cy=v+u)+Math.sqrt(y*y+v*v),e.circle=w;for(var C=null,E=bA._;E;)if(w.y<E.y||w.y===E.y&&w.x<=E.x)if(E.L)E=E.L;else{C=E.P;break}else if(E.R)E=E.R;else{C=E;break}bA.insert(C,w),C||(iV=w)}}}}function P1(e){var t=e.circle;t&&(t.P||(iV=t.N),bA.remove(t),Mre.push(t),gR(t),e.circle=null)}var Lre=[];function gFe(){gR(this),this.edge=this.site=this.circle=null}function tne(e){var t=Lre.pop()||new gFe;return t.site=e,t}function u4(e){P1(e),M1.remove(e),Lre.push(e),gR(e)}function _Fe(e){var t=e.circle,n=t.x,r=t.cy,o=[n,r],a=e.P,s=e.N,u=[e];u4(e);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<co&&Math.abs(r-l.circle.cy)<co;)a=l.P,u.unshift(l),u4(l),l=a;u.unshift(l),P1(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<co&&Math.abs(r-c.circle.cy)<co;)s=c.N,u.push(c),u4(c),c=s;u.push(c),P1(c);var f=u.length,h;for(h=1;h<f;++h)c=u[h],l=u[h-1],jL(c.edge,l.site,c.site,o);l=u[0],c=u[f-1],c.edge=mA(l.site,c.site,null,o),I1(l),I1(c)}function yFe(e){for(var t=e[0],n=e[1],r,o,a,s,u=M1._;u;)if(a=Rre(u,n)-t,a>co)u=u.L;else if(s=t-vFe(u,n),s>co){if(!u.R){r=u;break}u=u.R}else{a>-co?(r=u.P,o=u):s>-co?(r=u,o=u.N):r=o=u;break}cFe(e);var l=tne(e);if(M1.insert(r,l),!(!r&&!o)){if(r===o){P1(r),o=tne(r.site),M1.insert(l,o),l.edge=o.edge=mA(r.site,l.site),I1(r),I1(o);return}if(!o){l.edge=mA(r.site,l.site);return}P1(r),P1(o);var c=r.site,f=c[0],h=c[1],d=e[0]-f,p=e[1]-h,_=o.site,y=_[0]-f,v=_[1]-h,w=2*(d*v-p*y),C=d*d+p*p,E=y*y+v*v,S=[(v*C-p*E)/w+f,(d*E-y*C)/w+h];jL(o.edge,c,_,S),l.edge=mA(c,e,null,S),o.edge=mA(e,_,null,S),I1(r),I1(o)}}function Rre(e,t){var n=e.site,r=n[0],o=n[1],a=o-t;if(!a)return r;var s=e.P;if(!s)return-1/0;n=s.site;var u=n[0],l=n[1],c=l-t;if(!c)return u;var f=u-r,h=1/a-1/c,d=f/c;return h?(-d+Math.sqrt(d*d-2*h*(f*f/(-2*c)-l+c/2+o-a/2)))/h+r:(r+u)/2}function vFe(e,t){var n=e.N;if(n)return Rre(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var co=1e-6,CFe=1e-12,M1,Cf,bA,Sl;function xFe(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function wFe(e,t){return t[1]-e[1]||t[0]-e[0]}function S4(e,t){var n=e.sort(wFe).pop(),r,o,a;for(Sl=[],Cf=new Array(e.length),M1=new XL,bA=new XL;;)if(a=iV,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==o)&&(yFe(n),r=n[0],o=n[1]),n=e.pop();else if(a)_Fe(a.arc);else break;if(dFe(),t){var s=+t[0][0],u=+t[0][1],l=+t[1][0],c=+t[1][1];lFe(s,u,l,c),pFe(s,u,l,c)}this.edges=Sl,this.cells=Cf,M1=bA=Sl=Cf=null}S4.prototype={constructor:S4,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return Pre(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(!!(u=(a=n.halfedges).length))for(var o=n.site,a,s=-1,u,l,c=t[a[u-1]],f=c.left===o?c.right:c.left;++s<u;)l=f,c=t[a[s]],f=c.left===o?c.right:c.left,l&&f&&r<l.index&&r<f.index&&xFe(o,l,f)<0&&e.push([o.data,l.data,f.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,o,a=r._found||0,s=r.cells.length,u;!(u=r.cells[a]);)if(++a>=s)return null;var l=e-u.site[0],c=t-u.site[1],f=l*l+c*c;do u=r.cells[o=a],a=null,u.halfedges.forEach(function(h){var d=r.edges[h],p=d.left;if(!((p===u.site||!p)&&!(p=d.right))){var _=e-p[0],y=t-p[1],v=_*_+y*y;v<f&&(f=v,a=p.index)}});while(a!==null);return r._found=o,n==null||f<=n*n?u.site:null}};var EFe=function(){var e=oFe,t=aFe,n=null;function r(o){return new S4(o.map(function(a,s){var u=[Math.round(e(a,s,o)/co)*co,Math.round(t(a,s,o)/co)*co];return u.index=s,u.data=a,u}),n)}return r.polygons=function(o){return r(o).polygons()},r.links=function(o){return r(o).links()},r.triangles=function(o){return r(o).triangles()},r.x=function(o){return arguments.length?(e=typeof o=="function"?o:$te(+o),r):e},r.y=function(o){return arguments.length?(t=typeof o=="function"?o:$te(+o),r):t},r.extent=function(o){return arguments.length?(n=o==null?null:[[+o[0][0],+o[0][1]],[+o[1][0],+o[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(o){return arguments.length?(n=o==null?null:[[0,0],[+o[0],+o[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r};function TFe(e){return e=e.slice(),e.push(e[0]),ir([e])}function SFe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return qd(e,"Point","points"),kt(EFe().x(function(r){return r.geometry.coordinates[0]}).y(function(r){return r.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(TFe))}function Ore(e,t,n,r){r=r||{};var o=r.steps||64,a=r.units||"kilometers",s=r.angle||0,u=r.pivot||e,l=r.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!yt(r))throw new Error("options must be an object");if(!pi(o))throw new Error("steps must be a number");if(!pi(s))throw new Error("angle must be a number");var c=fo(e);if(a==="degrees")var f=Ja(s);else t=O1(e,t,90,{units:a}),n=O1(e,n,0,{units:a}),t=fo(t)[0]-c[0],n=fo(n)[1]-c[1];for(var h=[],d=0;d<o;d+=1){var p=d*-360/o,_=t*n/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)*Math.pow(nne(p),2)),y=t*n/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)/Math.pow(nne(p),2));if(p<-90&&p>=-270&&(_=-_),p<-180&&p>=-360&&(y=-y),a==="degrees"){var v=_*Math.cos(f)+y*Math.sin(f),w=y*Math.cos(f)-_*Math.sin(f);_=v,y=w}h.push([_+c[0],y+c[1]])}return h.push(h[0]),a==="degrees"?ir([h],l):vre(ir([h],l),s,{pivot:u})}function nne(e){var t=e*Math.PI/180;return Math.tan(t)}function oV(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.properties,r=t.weight;if(!e)throw new Error("geojson is required");var o=0,a=0,s=0;return Hh(e,function(u,l,c){var f=c[r];if(f=f??1,!pi(f))throw new Error("weight value must be a number for feature index "+l);f=Number(f),f>0&&$a(u,function(h){o+=h[0]*f,a+=h[1]*f,s+=f})}),Yr([o/s,a/s],n)}function AFe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.counter||10;if(!pi(n))throw new Error("counter must be a number");var r=t.weight,o=oV(e,{weight:t.weight}),a=kt([]);return mi(e,function(s){a.features.push(gv(s,{weight:s.properties[r]}))}),a.properties={tolerance:t.tolerance,medianCandidates:[]},Nre(o.geometry.coordinates,[0,0],a,n)}function Nre(e,t,n,r){var o=n.properties.tolerance||.001,a=0,s=0,u=0,l=0;if(mi(n,function(h){var d=h.properties.weight,p=d??1;if(p=Number(p),!pi(p))throw new Error("weight value must be a number");if(p>0){l+=1;var _=p*di(h,e);_===0&&(_=1);var y=p/_;a+=h.geometry.coordinates[0]*y,s+=h.geometry.coordinates[1]*y,u+=y}}),l<1)throw new Error("no features to measure");var c=a/u,f=s/u;return l===1||r===0||Math.abs(c-t[0])<o&&Math.abs(f-t[1])<o?Yr([c,f],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,f]),Nre([c,f],e,n,r-1))}function bFe(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.steps||64,r=t.weight,o=t.properties||{};if(!pi(n))throw new Error("steps must be a number");if(!yt(o))throw new Error("properties must be a number");var a=$p(e).length,s=oV(e,{weight:r}),u=0,l=0,c=0;mi(e,function(P){var M=P.properties[r]||1,b=rne(St(P),St(s));u+=Math.pow(b.x,2)*M,l+=Math.pow(b.y,2)*M,c+=b.x*b.y*M});var f=u-l,h=Math.sqrt(Math.pow(f,2)+4*Math.pow(c,2)),d=2*c,p=Math.atan((f+h)/d),_=p*180/Math.PI,y=0,v=0,w=0;mi(e,function(P){var M=P.properties[r]||1,b=rne(St(P),St(s));y+=Math.pow(b.x*Math.cos(p)-b.y*Math.sin(p),2)*M,v+=Math.pow(b.x*Math.sin(p)+b.y*Math.cos(p),2)*M,w+=M});var C=Math.sqrt(2*y/w),E=Math.sqrt(2*v/w),S=Ore(s,C,E,{units:"degrees",angle:_,steps:n,properties:o}),A=h4(e,kt([S])),D={meanCenterCoordinates:St(s),semiMajorAxis:C,semiMinorAxis:E,numberOfFeatures:a,angle:_,percentageWithinEllipse:100*$p(A).length/a};return S.properties.standardDeviationalEllipse=D,S}function rne(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function XA(e){if(yt(e)&&(e=e.bbox),e&&!Array.isArray(e))throw new Error("bbox is invalid");return e?MFe(e):[DFe(),PFe()]}function Bre(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.bbox;e==null&&(e=1);for(var r=[],o=0;o<e;o++)r.push(Yr(XA(n)));return kt(r)}function Fre(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_radial_length;e==null&&(e=1),pi(r)||(r=10),pi(o)||(o=10);for(var a=[],s=0;s<e;s++){var u=[],l=Array.apply(null,new Array(r+1)).map(Math.random);l.forEach(c),l.forEach(f),u[u.length-1]=u[0],u=u.map(IFe(XA(n))),a.push(ir([u]))}function c(h,d,p){p[d]=d>0?h+p[d-1]:h}function f(h){h=h*2*Math.PI/l[l.length-1];var d=Math.random();u.push([d*o*Math.sin(h),d*o*Math.cos(h)])}return kt(a)}function zre(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_length,a=t.max_rotation;e==null&&(e=1),(!pi(r)||r<2)&&(r=10),pi(o)||(o=1e-4),pi(a)||(a=Math.PI/8);for(var s=[],u=0;u<e;u++){for(var l=XA(n),c=[l],f=0;f<r-1;f++){var h=f===0?Math.random()*2*Math.PI:Math.tan((c[f][1]-c[f-1][1])/(c[f][0]-c[f-1][0])),d=h+(Math.random()-.5)*a*2,p=Math.random()*o;c.push([c[f][0]+p*Math.cos(d),c[f][1]+p*Math.sin(d)])}s.push(Vi(c))}return kt(s)}function IFe(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function Vre(){return Math.random()-.5}function DFe(){return Vre()*360}function PFe(){return Vre()*180}function MFe(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var LFe=Object.freeze({randomPosition:XA,randomPoint:Bre,randomPolygon:Fre,randomLineString:zre});function kre(e,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var n=[];return mi(e,function(r){_R(r.properties,t)&&n.push(r)}),kt(n)}function aV(e,t,n){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var r=sV(e,t),o=Object.keys(r),a=0;a<o.length;a++){for(var s=o[a],u=r[s],l=[],c=0;c<u.length;c++)l.push(e.features[u[c]]);n(kt(l),s,a)}}function Gre(e,t,n,r){var o=r;return aV(e,t,function(a,s,u){u===0&&r===void 0?o=a:o=n(o,a,s,u)}),o}function sV(e,t){var n={};return mi(e,function(r,o){var a=r.properties||{};if(a.hasOwnProperty(t)){var s=a[t];n.hasOwnProperty(s)?n[s].push(o):n[s]=[o]}}),n}function _R(e,t){if(e===void 0)return!1;var n=typeof t;if(n==="number"||n==="string")return e.hasOwnProperty(t);if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(!_R(e,t[r]))return!1;return!0}else return uV(e,t)}function uV(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];if(e[o]!==t[o])return!1}return!0}function Ure(e,t){if(!t)return{};if(!t.length)return{};for(var n={},r=0;r<t.length;r++){var o=t[r];e.hasOwnProperty(o)&&(n[o]=e[o])}return n}var RFe=Object.freeze({getCluster:kre,clusterEach:aV,clusterReduce:Gre,createBins:sV,applyFilter:_R,propertiesContainsFilter:uV,filterProperties:Ure});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(a=a<0?Math.max(r+arguments[2],0):Math.min(a,r);o<a;)n[o]=t,++o;return n},writable:!0});Number.isFinite=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)};Number.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(e){return e!==e};Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var yv=function(){};yv.prototype.interfaces_=function(){return[]};yv.prototype.getClass=function(){return yv};yv.prototype.equalsWithTolerance=function(t,n,r){return Math.abs(t-n)<=r};var ho=function(){},Qt=function(){},Hre={MAX_VALUE:{configurable:!0}};Qt.isNaN=function(t){return Number.isNaN(t)};Qt.doubleToLongBits=function(t){return t};Qt.longBitsToDouble=function(t){return t};Qt.isInfinite=function(t){return!Number.isFinite(t)};Hre.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Qt,Hre);var Gc=function(){},yR=function(){},N1=function(){};function Uc(){}var ae=function e(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Pv={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ae.prototype.setOrdinate=function(t,n){switch(t){case ae.X:this.x=n;break;case ae.Y:this.y=n;break;case ae.Z:this.z=n;break;default:throw new ho("Invalid ordinate index: "+t)}};ae.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!yv.equalsWithTolerance(this.x,n.x,r)||!yv.equalsWithTolerance(this.y,n.y,r))}};ae.prototype.getOrdinate=function(t){switch(t){case ae.X:return this.x;case ae.Y:return this.y;case ae.Z:return this.z;default:}throw new ho("Invalid ordinate index: "+t)};ae.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Qt.isNaN(this.z))&&Qt.isNaN(t.z)};ae.prototype.equals=function(t){return t instanceof ae?this.equals2D(t):!1};ae.prototype.equalInZ=function(t,n){return yv.equalsWithTolerance(this.z,t.z,n)};ae.prototype.compareTo=function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};ae.prototype.clone=function(){};ae.prototype.copy=function(){return new ae(this)};ae.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};ae.prototype.distance3D=function(t){var n=this.x-t.x,r=this.y-t.y,o=this.z-t.z;return Math.sqrt(n*n+r*r+o*o)};ae.prototype.distance=function(t){var n=this.x-t.x,r=this.y-t.y;return Math.sqrt(n*n+r*r)};ae.prototype.hashCode=function(){var t=17;return t=37*t+ae.hashCode(this.x),t=37*t+ae.hashCode(this.y),t};ae.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};ae.prototype.interfaces_=function(){return[Gc,yR,Uc]};ae.prototype.getClass=function(){return ae};ae.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=Qt.doubleToLongBits(t);return Math.trunc((n^n)>>>32)}};Pv.DimensionalComparator.get=function(){return Eg};Pv.serialVersionUID.get=function(){return 6683108902428367e3};Pv.NULL_ORDINATE.get=function(){return Qt.NaN};Pv.X.get=function(){return 0};Pv.Y.get=function(){return 1};Pv.Z.get=function(){return 2};Object.defineProperties(ae,Pv);var Eg=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new ho("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Eg.prototype.compare=function(t,n){var r=t,o=n,a=Eg.compare(r.x,o.x);if(a!==0)return a;var s=Eg.compare(r.y,o.y);if(s!==0)return s;if(this._dimensionsToTest<=2)return 0;var u=Eg.compare(r.z,o.z);return u};Eg.prototype.interfaces_=function(){return[N1]};Eg.prototype.getClass=function(){return Eg};Eg.compare=function(t,n){return t<n?-1:t>n?1:Qt.isNaN(t)?Qt.isNaN(n)?0:-1:Qt.isNaN(n)?1:0};var B1=function(){};B1.prototype.create=function(){};B1.prototype.interfaces_=function(){return[]};B1.prototype.getClass=function(){return B1};var he=function(){},jA={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};he.prototype.interfaces_=function(){return[]};he.prototype.getClass=function(){return he};he.toLocationSymbol=function(t){switch(t){case he.EXTERIOR:return"e";case he.BOUNDARY:return"b";case he.INTERIOR:return"i";case he.NONE:return"-";default:}throw new ho("Unknown location value: "+t)};jA.INTERIOR.get=function(){return 0};jA.BOUNDARY.get=function(){return 1};jA.EXTERIOR.get=function(){return 2};jA.NONE.get=function(){return-1};Object.defineProperties(he,jA);var Ot=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},oc=function(){},qre={LOG_10:{configurable:!0}};oc.prototype.interfaces_=function(){return[]};oc.prototype.getClass=function(){return oc};oc.log10=function(t){var n=Math.log(t);return Qt.isInfinite(n)||Qt.isNaN(n)?n:n/oc.LOG_10};oc.min=function(t,n,r,o){var a=t;return n<a&&(a=n),r<a&&(a=r),o<a&&(a=o),a};oc.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],r=arguments[2];return t<n?n:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1],s=arguments[2];return o<a?a:o>s?s:o}};oc.wrap=function(t,n){return t<0?n- -t%n:t%n};oc.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2],o=t;return n>o&&(o=n),r>o&&(o=r),o}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=a;return s>c&&(c=s),u>c&&(c=u),l>c&&(c=l),c}};oc.average=function(t,n){return(t+n)/2};qre.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(oc,qre);var qh=function(t){this.str=t};qh.prototype.append=function(t){this.str+=t};qh.prototype.setCharAt=function(t,n){this.str=this.str.substr(0,t)+n+this.str.substr(t+1)};qh.prototype.toString=function(t){return this.str};var Rh=function(t){this.value=t};Rh.prototype.intValue=function(){return this.value};Rh.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};Rh.isNaN=function(t){return Number.isNaN(t)};var IA=function(){};IA.isWhitespace=function(t){return t<=32&&t>=0||t===127};IA.toUpperCase=function(t){return t.toUpperCase()};var ge=function e(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];e.call(this,e.parse(r))}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.init(o,a)}},Pf={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};ge.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};ge.prototype.extractSignificantDigits=function(t,n){var r=this.abs(),o=ge.magnitude(r._hi),a=ge.TEN.pow(o);r=r.divide(a),r.gt(ge.TEN)?(r=r.divide(ge.TEN),o+=1):r.lt(ge.ONE)&&(r=r.multiply(ge.TEN),o-=1);for(var s=o+1,u=new qh,l=ge.MAX_PRINT_DIGITS-1,c=0;c<=l;c++){t&&c===s&&u.append(".");var f=Math.trunc(r._hi);if(f<0)break;var h=!1,d=0;f>9?(h=!0,d="9"):d="0"+f,u.append(d),r=r.subtract(ge.valueOf(f)).multiply(ge.TEN),h&&r.selfAdd(ge.TEN);var p=!0,_=ge.magnitude(r._hi);if(_<0&&Math.abs(_)>=l-c&&(p=!1),!p)break}return n[0]=o,u.toString()};ge.prototype.sqr=function(){return this.multiply(this)};ge.prototype.doubleValue=function(){return this._hi+this._lo};ge.prototype.subtract=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};ge.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};ge.prototype.isZero=function(){return this._hi===0&&this._lo===0};ge.prototype.selfSubtract=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};ge.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};ge.prototype.min=function(t){return this.le(t)?this:t};ge.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null,h=null,d=null;return c=this._hi/r,f=ge.SPLIT*c,a=f-c,d=ge.SPLIT*r,a=f-a,s=c-a,u=d-r,h=c*r,u=d-u,l=r-u,d=a*u-h+a*l+s*u+s*l,f=(this._hi-h-d+this._lo-c*o)/r,d=c+f,this._hi=d,this._lo=c-d+f,this}};ge.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};ge.prototype.divide=function(){if(arguments[0]instanceof ge){var t=arguments[0],n=null,r=null,o=null,a=null,s=null,u=null,l=null,c=null;s=this._hi/t._hi,u=ge.SPLIT*s,n=u-s,c=ge.SPLIT*t._hi,n=u-n,r=s-n,o=c-t._hi,l=s*t._hi,o=c-o,a=t._hi-o,c=n*o-l+n*a+r*o+r*a,u=(this._hi-l-c+this._lo-s*t._lo)/t._hi,c=s+u;var f=c,h=s-c+u;return new ge(f,h)}else if(typeof arguments[0]=="number"){var d=arguments[0];return Qt.isNaN(d)?ge.createNaN():ge.copy(this).selfDivide(d,0)}};ge.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};ge.prototype.pow=function(t){if(t===0)return ge.valueOf(1);var n=new ge(this),r=ge.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2===1&&r.selfMultiply(n),o/=2,o>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r};ge.prototype.ceil=function(){if(this.isNaN())return ge.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new ge(t,n)};ge.prototype.compareTo=function(t){var n=t;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};ge.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};ge.prototype.setValue=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};ge.prototype.max=function(t){return this.ge(t)?this:t};ge.prototype.sqrt=function(){if(this.isZero())return ge.valueOf(0);if(this.isNegative())return ge.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=ge.valueOf(n),o=this.subtract(r.sqr()),a=o._hi*(t*.5);return r.add(a)};ge.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,o=null,a=null,s=null,u=null,l=null;return a=this._hi+n,u=a-this._hi,s=a-u,s=n-u+(this._hi-s),l=s+this._lo,r=a+l,o=l+(a-r),this._hi=r+o,this._lo=o+(r-this._hi),this}}else if(arguments.length===2){var c=arguments[0],f=arguments[1],h=null,d=null,p=null,_=null,y=null,v=null,w=null,C=null;y=this._hi+c,p=this._lo+f,w=y-this._hi,C=p-this._lo,v=y-w,_=p-C,v=c-w+(this._hi-v),_=f-C+(this._lo-_),w=v+p,h=y+w,d=w+(y-h),w=_+d;var E=h+w,S=w+(h-E);return this._hi=E,this._lo=S,this}};ge.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null;c=ge.SPLIT*this._hi,a=c-this._hi,f=ge.SPLIT*r,a=c-a,s=this._hi-a,u=f-r,c=this._hi*r,u=f-u,l=r-u,f=a*u-c+a*l+s*u+s*l+(this._hi*o+this._lo*r);var h=c+f;a=c-h;var d=f+a;return this._hi=h,this._lo=d,this}};ge.prototype.selfSqr=function(){return this.selfMultiply(this)};ge.prototype.floor=function(){if(this.isNaN())return ge.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new ge(t,n)};ge.prototype.negate=function(){return this.isNaN()?this:new ge(-this._hi,-this._lo)};ge.prototype.clone=function(){};ge.prototype.multiply=function(){if(arguments[0]instanceof ge){var t=arguments[0];return t.isNaN()?ge.createNaN():ge.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Qt.isNaN(n)?ge.createNaN():ge.copy(this).selfMultiply(n,0)}};ge.prototype.isNaN=function(){return Qt.isNaN(this._hi)};ge.prototype.intValue=function(){return Math.trunc(this._hi)};ge.prototype.toString=function(){var t=ge.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};ge.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),o=n[0]+1,a=r;if(r.charAt(0)===".")a="0"+r;else if(o<0)a="0."+ge.stringOfChar("0",-o)+r;else if(r.indexOf(".")===-1){var s=o-r.length,u=ge.stringOfChar("0",s);a=r+u+".0"}return this.isNegative()?"-"+a:a};ge.prototype.reciprocal=function(){var t=null,n=null,r=null,o=null,a=null,s=null,u=null,l=null;a=1/this._hi,s=ge.SPLIT*a,t=s-a,l=ge.SPLIT*this._hi,t=s-t,n=a-t,r=l-this._hi,u=a*this._hi,r=l-r,o=this._hi-r,l=t*r-u+t*o+n*r+n*o,s=(1-u-l-a*this._lo)/this._hi;var c=a+s,f=a-c+s;return new ge(c,f)};ge.prototype.toSciNotation=function(){if(this.isZero())return ge.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),o=ge.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var a="";r.length>1&&(a=r.substring(1));var s=r.charAt(0)+"."+a;return this.isNegative()?"-"+s+o:s+o};ge.prototype.abs=function(){return this.isNaN()?ge.NaN:this.isNegative()?this.negate():new ge(this)};ge.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};ge.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};ge.prototype.add=function(){if(arguments[0]instanceof ge){var t=arguments[0];return ge.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return ge.copy(this).selfAdd(n)}};ge.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof ge){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._hi=r,this._lo=o}};ge.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};ge.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};ge.prototype.trunc=function(){return this.isNaN()?ge.NaN:this.isPositive()?this.floor():this.ceil()};ge.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};ge.prototype.interfaces_=function(){return[Uc,Gc,yR]};ge.prototype.getClass=function(){return ge};ge.sqr=function(t){return ge.valueOf(t).selfMultiply(t)};ge.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return ge.parse(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new ge(n)}};ge.sqrt=function(t){return ge.valueOf(t).sqrt()};ge.parse=function(t){for(var n=0,r=t.length;IA.isWhitespace(t.charAt(n));)n++;var o=!1;if(n<r){var a=t.charAt(n);(a==="-"||a==="+")&&(n++,a==="-"&&(o=!0))}for(var s=new ge,u=0,l=0,c=0;!(n>=r);){var f=t.charAt(n);if(n++,IA.isDigit(f)){var h=f-"0";s.selfMultiply(ge.TEN),s.selfAdd(h),u++;continue}if(f==="."){l=u;continue}if(f==="e"||f==="E"){var d=t.substring(n);try{c=Rh.parseInt(d)}catch(w){throw w instanceof Error?new Error("Invalid exponent "+d+" in string "+t):w}finally{}break}throw new Error("Unexpected character '"+f+"' at position "+n+" in string "+t)}var p=s,_=u-l-c;if(_===0)p=s;else if(_>0){var y=ge.TEN.pow(_);p=s.divide(y)}else if(_<0){var v=ge.TEN.pow(-_);p=s.multiply(v)}return o?p.negate():p};ge.createNaN=function(){return new ge(Qt.NaN,Qt.NaN)};ge.copy=function(t){return new ge(t)};ge.magnitude=function(t){var n=Math.abs(t),r=Math.log(n)/Math.log(10),o=Math.trunc(Math.floor(r)),a=Math.pow(10,o);return a*10<=n&&(o+=1),o};ge.stringOfChar=function(t,n){for(var r=new qh,o=0;o<n;o++)r.append(t);return r.toString()};Pf.PI.get=function(){return new ge(3.141592653589793,12246467991473532e-32)};Pf.TWO_PI.get=function(){return new ge(6.283185307179586,24492935982947064e-32)};Pf.PI_2.get=function(){return new ge(1.5707963267948966,6123233995736766e-32)};Pf.E.get=function(){return new ge(2.718281828459045,14456468917292502e-32)};Pf.NaN.get=function(){return new ge(Qt.NaN,Qt.NaN)};Pf.EPS.get=function(){return 123259516440783e-46};Pf.SPLIT.get=function(){return 134217729};Pf.MAX_PRINT_DIGITS.get=function(){return 32};Pf.TEN.get=function(){return ge.valueOf(10)};Pf.ONE.get=function(){return ge.valueOf(1)};Pf.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Pf.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(ge,Pf);var ju=function(){},Wre={DP_SAFE_EPSILON:{configurable:!0}};ju.prototype.interfaces_=function(){return[]};ju.prototype.getClass=function(){return ju};ju.orientationIndex=function(t,n,r){var o=ju.orientationIndexFilter(t,n,r);if(o<=1)return o;var a=ge.valueOf(n.x).selfAdd(-t.x),s=ge.valueOf(n.y).selfAdd(-t.y),u=ge.valueOf(r.x).selfAdd(-n.x),l=ge.valueOf(r.y).selfAdd(-n.y);return a.selfMultiply(l).selfSubtract(s.selfMultiply(u)).signum()};ju.signOfDet2x2=function(t,n,r,o){var a=t.multiply(o).selfSubtract(n.multiply(r));return a.signum()};ju.intersection=function(t,n,r,o){var a=ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(ge.valueOf(n.x).selfSubtract(t.x)),s=ge.valueOf(o.x).selfSubtract(r.x).selfMultiply(ge.valueOf(n.y).selfSubtract(t.y)),u=a.subtract(s),l=ge.valueOf(o.x).selfSubtract(r.x).selfMultiply(ge.valueOf(t.y).selfSubtract(r.y)),c=ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(ge.valueOf(t.x).selfSubtract(r.x)),f=l.subtract(c),h=f.selfDivide(u).doubleValue(),d=ge.valueOf(t.x).selfAdd(ge.valueOf(n.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),p=ge.valueOf(n.x).selfSubtract(t.x).selfMultiply(ge.valueOf(t.y).selfSubtract(r.y)),_=ge.valueOf(n.y).selfSubtract(t.y).selfMultiply(ge.valueOf(t.x).selfSubtract(r.x)),y=p.subtract(_),v=y.selfDivide(u).doubleValue(),w=ge.valueOf(r.y).selfAdd(ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(v)).doubleValue();return new ae(d,w)};ju.orientationIndexFilter=function(t,n,r){var o=null,a=(t.x-r.x)*(n.y-r.y),s=(t.y-r.y)*(n.x-r.x),u=a-s;if(a>0){if(s<=0)return ju.signum(u);o=a+s}else if(a<0){if(s>=0)return ju.signum(u);o=-a-s}else return ju.signum(u);var l=ju.DP_SAFE_EPSILON*o;return u>=l||-u>=l?ju.signum(u):2};ju.signum=function(t){return t>0?1:t<0?-1:0};Wre.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(ju,Wre);var An=function(){},KA={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};KA.X.get=function(){return 0};KA.Y.get=function(){return 1};KA.Z.get=function(){return 2};KA.M.get=function(){return 3};An.prototype.setOrdinate=function(t,n,r){};An.prototype.size=function(){};An.prototype.getOrdinate=function(t,n){};An.prototype.getCoordinate=function(){};An.prototype.getCoordinateCopy=function(t){};An.prototype.getDimension=function(){};An.prototype.getX=function(t){};An.prototype.clone=function(){};An.prototype.expandEnvelope=function(t){};An.prototype.copy=function(){};An.prototype.getY=function(t){};An.prototype.toCoordinateArray=function(){};An.prototype.interfaces_=function(){return[yR]};An.prototype.getClass=function(){return An};Object.defineProperties(An,KA);var Yre=function(){},ow=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Yre),Ss=function(){};Ss.arraycopy=function(t,n,r,o,a){for(var s=0,u=n;u<n+a;u++)r[o+s]=t[u],s++};Ss.getProperty=function(t){return{"line.separator":`
`}[t]};var xf=function e(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var o=arguments[0],a=arguments[1];this.x=o.y*a.w-a.y*o.w,this.y=a.x*o.w-o.x*a.w,this.w=o.x*a.y-a.x*o.y}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var s=arguments[0],u=arguments[1];this.x=s.y-u.y,this.y=u.x-s.x,this.w=s.x*u.y-u.x*s.y}}else if(arguments.length===3){var l=arguments[0],c=arguments[1],f=arguments[2];this.x=l,this.y=c,this.w=f}else if(arguments.length===4){var h=arguments[0],d=arguments[1],p=arguments[2],_=arguments[3],y=h.y-d.y,v=d.x-h.x,w=h.x*d.y-d.x*h.y,C=p.y-_.y,E=_.x-p.x,S=p.x*_.y-_.x*p.y;this.x=v*S-E*w,this.y=C*w-y*S,this.w=y*E-C*v}};xf.prototype.getY=function(){var t=this.y/this.w;if(Qt.isNaN(t)||Qt.isInfinite(t))throw new ow;return t};xf.prototype.getX=function(){var t=this.x/this.w;if(Qt.isNaN(t)||Qt.isInfinite(t))throw new ow;return t};xf.prototype.getCoordinate=function(){var t=new ae;return t.x=this.getX(),t.y=this.getY(),t};xf.prototype.interfaces_=function(){return[]};xf.prototype.getClass=function(){return xf};xf.intersection=function(t,n,r,o){var a=t.y-n.y,s=n.x-t.x,u=t.x*n.y-n.x*t.y,l=r.y-o.y,c=o.x-r.x,f=r.x*o.y-o.x*r.y,h=s*f-c*u,d=l*u-a*f,p=a*c-l*s,_=h/p,y=d/p;if(Qt.isNaN(_)||Qt.isInfinite(_)||Qt.isNaN(y)||Qt.isInfinite(y))throw new ow;return new ae(_,y)};var ct=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];this.init(a,s,u,l)}},Xre={serialVersionUID:{configurable:!0}};ct.prototype.getArea=function(){return this.getWidth()*this.getHeight()};ct.prototype.equals=function(t){if(!(t instanceof ct))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};ct.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new ct;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new ct(n,o,r,a)};ct.prototype.isNull=function(){return this._maxx<this._minx};ct.prototype.getMaxX=function(){return this._maxx};ct.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof ct){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&o>=this._miny&&o<=this._maxy}};ct.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof ct){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof ae){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||o>this._maxy||o<this._miny)}};ct.prototype.getMinY=function(){return this._miny};ct.prototype.getMinX=function(){return this._minx};ct.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof ct){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=o,this._maxy=o):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}};ct.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t<n?t:n};ct.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};ct.prototype.compareTo=function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};ct.prototype.translate=function(t,n){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)};ct.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};ct.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};ct.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};ct.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n};ct.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};ct.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof ct){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof ae){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.covers(r,o)}};ct.prototype.centre=function(){return this.isNull()?null:new ae((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};ct.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof ct){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];a<s?(this._minx=a,this._maxx=s):(this._minx=s,this._maxx=a),u<l?(this._miny=u,this._maxy=l):(this._miny=l,this._maxy=u)}};ct.prototype.getMaxY=function(){return this._maxy};ct.prototype.distance=function(t){if(this.intersects(t))return 0;var n=0;this._maxx<t._minx?n=t._minx-this._maxx:this._minx>t._maxx&&(n=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};ct.prototype.hashCode=function(){var t=17;return t=37*t+ae.hashCode(this._minx),t=37*t+ae.hashCode(this._maxx),t=37*t+ae.hashCode(this._miny),t=37*t+ae.hashCode(this._maxy),t};ct.prototype.interfaces_=function(){return[Gc,Uc]};ct.prototype.getClass=function(){return ct};ct.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(t.x<n.x?t.x:n.x)&&r.x<=(t.x>n.x?t.x:n.x)&&r.y>=(t.y<n.y?t.y:n.y)&&r.y<=(t.y>n.y?t.y:n.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=Math.min(s.x,u.x),c=Math.max(s.x,u.x),f=Math.min(o.x,a.x),h=Math.max(o.x,a.x);return!(f>c||h<l||(l=Math.min(s.y,u.y),c=Math.max(s.y,u.y),f=Math.min(o.y,a.y),h=Math.max(o.y,a.y),f>c)||h<l)}};Xre.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(ct,Xre);var Ah={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},vR=function(t){this.geometryFactory=t||new mn};vR.prototype.read=function(t){var n,r,o;t=t.replace(/[\n\r]/g," ");var a=Ah.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(a=Ah.emptyTypeStr.exec(t),a[2]=void 0),a&&(r=a[1].toLowerCase(),o=a[2],D1[r]&&(n=D1[r].apply(this,[o]))),n===void 0)throw new Error("Could not parse WKT "+t);return n};vR.prototype.write=function(t){return this.extractGeometry(t)};vR.prototype.extractGeometry=function(t){var n=t.getGeometryType().toLowerCase();if(!jp[n])return null;var r=n.toUpperCase(),o;return t.isEmpty()?o=r+" EMPTY":o=r+"("+jp[n].apply(this,[t])+")",o};var jp={coordinate:function(t){return t.x+" "+t.y},point:function(t){return jp.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+jp.point.apply(n,[t._geometries[o]])+")");return r.join(",")},linestring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(jp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},linearring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(jp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},multilinestring:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+jp.linestring.apply(n,[t._geometries[o]])+")");return r.join(",")},polygon:function(t){var n=this,r=[];r.push("("+jp.linestring.apply(this,[t._shell])+")");for(var o=0,a=t._holes.length;o<a;++o)r.push("("+jp.linestring.apply(n,[t._holes[o]])+")");return r.join(",")},multipolygon:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+jp.polygon.apply(n,[t._geometries[o]])+")");return r.join(",")},geometrycollection:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push(n.extractGeometry(t._geometries[o]));return r.join(",")}},D1={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(Ah.spaces);return this.geometryFactory.createPoint(new ae(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,o=t.trim().split(","),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ah.trimParens,"$1"),a.push(D1.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(a)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Ah.spaces),r.push(new ae(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Ah.spaces),r.push(new ae(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,o=t.trim().split(Ah.parenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ah.trimParens,"$1"),a.push(D1.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(a)},polygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,o,a,s=t.trim().split(Ah.parenComma),u,l=[],c=0,f=s.length;c<f;++c)r=s[c].replace(Ah.trimParens,"$1"),o=D1.linestring.apply(n,[r]),a=n.geometryFactory.createLinearRing(o._points),c===0?u=a:l.push(a);return this.geometryFactory.createPolygon(u,l)},multipolygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,o=t.trim().split(Ah.doubleParenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ah.trimParens,"$1"),a.push(D1.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(t){var n=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),o=[],a=0,s=r.length;a<s;++a)o.push(n.read(r[a]));return this.geometryFactory.createGeometryCollection(o)}},Ef=function(t){this.parser=new vR(t)};Ef.prototype.write=function(t){return this.parser.write(t)};Ef.toLineString=function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"};var nm=function(e){function t(n){e.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),KL=function(e){function t(){if(e.call(this),arguments.length===0)e.call(this);else if(arguments.length===1){var n=arguments[0];e.call(this,n)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(nm),an=function(){};an.prototype.interfaces_=function(){return[]};an.prototype.getClass=function(){return an};an.shouldNeverReachHere=function(){if(arguments.length===0)an.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new KL("Should never reach here"+(t!==null?": "+t:""))}};an.isTrue=function(){var t,n;if(arguments.length===1)t=arguments[0],an.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],n=arguments[1],!t))throw n===null?new KL:new KL(n)};an.equals=function(){var t,n,r;if(arguments.length===2)t=arguments[0],n=arguments[1],an.equals(t,n,null);else if(arguments.length===3&&(t=arguments[0],n=arguments[1],r=arguments[2],!n.equals(t)))throw new KL("Expected "+t+" but encountered "+n+(r!==null?": "+r:""))};var So=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ae,this._intPt[1]=new ae,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Mv={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};So.prototype.getIndexAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intLineIndex[t][n]};So.prototype.getTopologySummary=function(){var t=new qh;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};So.prototype.computeIntersection=function(t,n,r,o){this._inputLines[0][0]=t,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,n,r,o)};So.prototype.getIntersectionNum=function(){return this._result};So.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);n>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};So.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};So.prototype.setPrecisionModel=function(t){this._precisionModel=t};So.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[n][0])||t._intPt[r].equals2D(t._inputLines[n][1])))return!0;return!1}};So.prototype.getIntersection=function(t){return this._intPt[t]};So.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};So.prototype.hasIntersection=function(){return this._result!==So.NO_INTERSECTION};So.prototype.getEdgeDistance=function(t,n){var r=So.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1]);return r};So.prototype.isCollinear=function(){return this._result===So.COLLINEAR_INTERSECTION};So.prototype.toString=function(){return Ef.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ef.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};So.prototype.getEndpoint=function(t,n){return this._inputLines[t][n]};So.prototype.isIntersection=function(t){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(t))return!0;return!1};So.prototype.getIntersectionAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][n]]};So.prototype.interfaces_=function(){return[]};So.prototype.getClass=function(){return So};So.computeEdgeDistance=function(t,n,r){var o=Math.abs(r.x-n.x),a=Math.abs(r.y-n.y),s=-1;if(t.equals(n))s=0;else if(t.equals(r))o>a?s=o:s=a;else{var u=Math.abs(t.x-n.x),l=Math.abs(t.y-n.y);o>a?s=u:s=l,s===0&&!t.equals(n)&&(s=Math.max(u,l))}return an.isTrue(!(s===0&&!t.equals(n)),"Bad distance calculation"),s};So.nonRobustComputeEdgeDistance=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=Math.sqrt(o*o+a*a);return an.isTrue(!(s===0&&!t.equals(n)),"Invalid distance calculation"),s};Mv.DONT_INTERSECT.get=function(){return 0};Mv.DO_INTERSECT.get=function(){return 1};Mv.COLLINEAR.get=function(){return 2};Mv.NO_INTERSECTION.get=function(){return 0};Mv.POINT_INTERSECTION.get=function(){return 1};Mv.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(So,Mv);var m_=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var o=new ct(this._inputLines[0][0],this._inputLines[0][1]),a=new ct(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(r)&&a.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];if(this._isProper=!1,ct.intersects(o,a,r)&&He.orientationIndex(o,a,r)===0&&He.orientationIndex(a,o,r)===0)return this._isProper=!0,(r.equals(o)||r.equals(a))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION}else return e.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,o,a,s,u){u.x=this.smallestInAbsValue(r.x,o.x,a.x,s.x),u.y=this.smallestInAbsValue(r.y,o.y,a.y,s.y),r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.safeHCoordinateIntersection=function(r,o,a,s){var u=null;try{u=xf.intersection(r,o,a,s)}catch(l){if(l instanceof ow)u=t.nearestEndpoint(r,o,a,s);else throw l}finally{}return u},t.prototype.intersection=function(r,o,a,s){var u=this.intersectionWithNormalization(r,o,a,s);return this.isInSegmentEnvelopes(u)||(u=new ae(t.nearestEndpoint(r,o,a,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u},t.prototype.smallestInAbsValue=function(r,o,a,s){var u=r,l=Math.abs(u);return Math.abs(o)<l&&(u=o,l=Math.abs(o)),Math.abs(a)<l&&(u=a,l=Math.abs(a)),Math.abs(s)<l&&(u=s),u},t.prototype.checkDD=function(r,o,a,s,u){var l=ju.intersection(r,o,a,s),c=this.isInSegmentEnvelopes(l);Ss.out.println("DD in env = "+c+"  --------------------- "+l),u.distance(l)>1e-4&&Ss.out.println("Distance = "+u.distance(l))},t.prototype.intersectionWithNormalization=function(r,o,a,s){var u=new ae(r),l=new ae(o),c=new ae(a),f=new ae(s),h=new ae;this.normalizeToEnvCentre(u,l,c,f,h);var d=this.safeHCoordinateIntersection(u,l,c,f);return d.x+=h.x,d.y+=h.y,d},t.prototype.computeCollinearIntersection=function(r,o,a,s){var u=ct.intersects(r,o,a),l=ct.intersects(r,o,s),c=ct.intersects(a,s,r),f=ct.intersects(a,s,o);return u&&l?(this._intPt[0]=a,this._intPt[1]=s,e.COLLINEAR_INTERSECTION):c&&f?(this._intPt[0]=r,this._intPt[1]=o,e.COLLINEAR_INTERSECTION):u&&c?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!l&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):u&&f?(this._intPt[0]=a,this._intPt[1]=o,a.equals(o)&&!l&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&c?(this._intPt[0]=s,this._intPt[1]=r,s.equals(r)&&!u&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&f?(this._intPt[0]=s,this._intPt[1]=o,s.equals(o)&&!u&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,o,a,s,u){var l=r.x<o.x?r.x:o.x,c=r.y<o.y?r.y:o.y,f=r.x>o.x?r.x:o.x,h=r.y>o.y?r.y:o.y,d=a.x<s.x?a.x:s.x,p=a.y<s.y?a.y:s.y,_=a.x>s.x?a.x:s.x,y=a.y>s.y?a.y:s.y,v=l>d?l:d,w=f<_?f:_,C=c>p?c:p,E=h<y?h:y,S=(v+w)/2,A=(C+E)/2;u.x=S,u.y=A,r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.computeIntersect=function(r,o,a,s){if(this._isProper=!1,!ct.intersects(r,o,a,s))return e.NO_INTERSECTION;var u=He.orientationIndex(r,o,a),l=He.orientationIndex(r,o,s);if(u>0&&l>0||u<0&&l<0)return e.NO_INTERSECTION;var c=He.orientationIndex(a,s,r),f=He.orientationIndex(a,s,o);if(c>0&&f>0||c<0&&f<0)return e.NO_INTERSECTION;var h=u===0&&l===0&&c===0&&f===0;return h?this.computeCollinearIntersection(r,o,a,s):(u===0||l===0||c===0||f===0?(this._isProper=!1,r.equals2D(a)||r.equals2D(s)?this._intPt[0]=r:o.equals2D(a)||o.equals2D(s)?this._intPt[0]=o:u===0?this._intPt[0]=new ae(a):l===0?this._intPt[0]=new ae(s):c===0?this._intPt[0]=new ae(r):f===0&&(this._intPt[0]=new ae(o))):(this._isProper=!0,this._intPt[0]=this.intersection(r,o,a,s)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,o,a,s){var u=r,l=He.distancePointLine(r,a,s),c=He.distancePointLine(o,a,s);return c<l&&(l=c,u=o),c=He.distancePointLine(a,r,o),c<l&&(l=c,u=a),c=He.distancePointLine(s,r,o),c<l&&(l=c,u=s),u},t}(So),vv=function(){};vv.prototype.interfaces_=function(){return[]};vv.prototype.getClass=function(){return vv};vv.orientationIndex=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=r.x-n.x,u=r.y-n.y;return vv.signOfDet2x2(o,a,s,u)};vv.signOfDet2x2=function(t,n,r,o){var a=null,s=null,u=null;if(a=1,t===0||o===0)return n===0||r===0?0:n>0?r>0?-a:a:r>0?a:-a;if(n===0||r===0)return o>0?t>0?a:-a:t>0?-a:a;if(n>0?o>0?n<=o||(a=-a,s=t,t=r,r=s,s=n,n=o,o=s):n<=-o?(a=-a,r=-r,o=-o):(s=t,t=-r,r=s,s=n,n=-o,o=s):o>0?-n<=o?(a=-a,t=-t,n=-n):(s=-t,t=r,r=s,s=-n,n=o,o=s):n>=o?(t=-t,n=-n,r=-r,o=-o):(a=-a,s=-t,t=-r,r=s,s=-n,n=-o,o=s),t>0)if(r>0){if(!(t<=r))return a}else return a;else{if(r>0)return-a;if(t>=r)a=-a,t=-t,r=-r;else return-a}for(;;){if(u=Math.floor(r/t),r=r-u*t,o=o-u*n,o<0)return-a;if(o>n)return a;if(t>r+r){if(n<o+o)return a}else{if(n>o+o)return-a;r=t-r,o=n-o,a=-a}if(o===0)return r===0?0:-a;if(r===0||(u=Math.floor(t/r),t=t-u*r,n=n-u*o,n<0))return a;if(n>o)return-a;if(r>t+t){if(o<n+n)return-a}else{if(o>n+n)return a;t=r-t,n=o-n,a=-a}if(n===0)return t===0?0:a;if(t===0)return-a}};var Mh=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Mh.prototype.countSegment=function(t,n){if(t.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&n.y===this._p.y){var r=t.x,o=n.x;return r>o&&(r=n.x,o=t.x),this._p.x>=r&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&t.y<=this._p.y){var a=t.x-this._p.x,s=t.y-this._p.y,u=n.x-this._p.x,l=n.y-this._p.y,c=vv.signOfDet2x2(a,s,u,l);if(c===0)return this._isPointOnSegment=!0,null;l<s&&(c=-c),c>0&&this._crossingCount++}};Mh.prototype.isPointInPolygon=function(){return this.getLocation()!==he.EXTERIOR};Mh.prototype.getLocation=function(){return this._isPointOnSegment?he.BOUNDARY:this._crossingCount%2===1?he.INTERIOR:he.EXTERIOR};Mh.prototype.isOnSegment=function(){return this._isPointOnSegment};Mh.prototype.interfaces_=function(){return[]};Mh.prototype.getClass=function(){return Mh};Mh.locatePointInRing=function(){if(arguments[0]instanceof ae&&Ot(arguments[1],An)){for(var t=arguments[0],n=arguments[1],r=new Mh(t),o=new ae,a=new ae,s=1;s<n.size();s++)if(n.getCoordinate(s,o),n.getCoordinate(s-1,a),r.countSegment(o,a),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof ae&&arguments[1]instanceof Array){for(var u=arguments[0],l=arguments[1],c=new Mh(u),f=1;f<l.length;f++){var h=l[f],d=l[f-1];if(c.countSegment(h,d),c.isOnSegment())return c.getLocation()}return c.getLocation()}};var He=function(){},Lv={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};He.prototype.interfaces_=function(){return[]};He.prototype.getClass=function(){return He};He.orientationIndex=function(t,n,r){return ju.orientationIndex(t,n,r)};He.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,r=t[0].x,o=1;o<t.length-1;o++){var a=t[o].x-r,s=t[o+1].y,u=t[o-1].y;n+=a*(u-s)}return n/2}else if(Ot(arguments[0],An)){var l=arguments[0],c=l.size();if(c<3)return 0;var f=new ae,h=new ae,d=new ae;l.getCoordinate(0,h),l.getCoordinate(1,d);var p=h.x;d.x-=p;for(var _=0,y=1;y<c-1;y++)f.y=h.y,h.x=d.x,h.y=d.y,l.getCoordinate(y+1,d),d.x-=p,_+=h.x*(f.y-d.y);return _/2}};He.distanceLineLine=function(t,n,r,o){if(t.equals(n))return He.distancePointLine(t,r,o);if(r.equals(o))return He.distancePointLine(o,t,n);var a=!1;if(!ct.intersects(t,n,r,o))a=!0;else{var s=(n.x-t.x)*(o.y-r.y)-(n.y-t.y)*(o.x-r.x);if(s===0)a=!0;else{var u=(t.y-r.y)*(o.x-r.x)-(t.x-r.x)*(o.y-r.y),l=(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y),c=l/s,f=u/s;(f<0||f>1||c<0||c>1)&&(a=!0)}}return a?oc.min(He.distancePointLine(t,r,o),He.distancePointLine(n,r,o),He.distancePointLine(r,t,n),He.distancePointLine(o,t,n)):0};He.isPointInRing=function(t,n){return He.locatePointInRing(t,n)!==he.EXTERIOR};He.computeLength=function(t){var n=t.size();if(n<=1)return 0;var r=0,o=new ae;t.getCoordinate(0,o);for(var a=o.x,s=o.y,u=1;u<n;u++){t.getCoordinate(u,o);var l=o.x,c=o.y,f=l-a,h=c-s;r+=Math.sqrt(f*f+h*h),a=l,s=c}return r};He.isCCW=function(t){var n=t.length-1;if(n<3)throw new ho("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],o=0,a=1;a<=n;a++){var s=t[a];s.y>r.y&&(r=s,o=a)}var u=o;do u=u-1,u<0&&(u=n);while(t[u].equals2D(r)&&u!==o);var l=o;do l=(l+1)%n;while(t[l].equals2D(r)&&l!==o);var c=t[u],f=t[l];if(c.equals2D(r)||f.equals2D(r)||c.equals2D(f))return!1;var h=He.computeOrientation(c,r,f),d=!1;return h===0?d=c.x>f.x:d=h>0,d};He.locatePointInRing=function(t,n){return Mh.locatePointInRing(t,n)};He.distancePointLinePerpendicular=function(t,n,r){var o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),a=((n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y))/o;return Math.abs(a)*Math.sqrt(o)};He.computeOrientation=function(t,n,r){return He.orientationIndex(t,n,r)};He.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new ho("Line array must contain at least one vertex");for(var r=t.distance(n[0]),o=0;o<n.length-1;o++){var a=He.distancePointLine(t,n[o],n[o+1]);a<r&&(r=a)}return r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];if(u.x===l.x&&u.y===l.y)return s.distance(u);var c=(l.x-u.x)*(l.x-u.x)+(l.y-u.y)*(l.y-u.y),f=((s.x-u.x)*(l.x-u.x)+(s.y-u.y)*(l.y-u.y))/c;if(f<=0)return s.distance(u);if(f>=1)return s.distance(l);var h=((u.y-s.y)*(l.x-u.x)-(u.x-s.x)*(l.y-u.y))/c;return Math.abs(h)*Math.sqrt(c)}};He.isOnLine=function(t,n){for(var r=new m_,o=1;o<n.length;o++){var a=n[o-1],s=n[o];if(r.computeIntersection(t,a,s),r.hasIntersection())return!0}return!1};Lv.CLOCKWISE.get=function(){return-1};Lv.RIGHT.get=function(){return He.CLOCKWISE};Lv.COUNTERCLOCKWISE.get=function(){return 1};Lv.LEFT.get=function(){return He.COUNTERCLOCKWISE};Lv.COLLINEAR.get=function(){return 0};Lv.STRAIGHT.get=function(){return He.COLLINEAR};Object.defineProperties(He,Lv);var rm=function(){};rm.prototype.filter=function(t){};rm.prototype.interfaces_=function(){return[]};rm.prototype.getClass=function(){return rm};var Mt=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Wd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Mt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Mt.SORTINDEX_GEOMETRYCOLLECTION};Mt.prototype.getFactory=function(){return this._factory};Mt.prototype.getGeometryN=function(t){return this};Mt.prototype.getArea=function(){return 0};Mt.prototype.isRectangle=function(){return!1};Mt.prototype.equals=function(){if(arguments[0]instanceof Mt){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof Mt))return!1;var r=n;return this.equalsExact(r)}};Mt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Mt.prototype.geometryChanged=function(){this.apply(Mt.geometryChangedFilter)};Mt.prototype.geometryChangedAction=function(){this._envelope=null};Mt.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Mt.prototype.getLength=function(){return 0};Mt.prototype.getNumGeometries=function(){return 1};Mt.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,o)}};Mt.prototype.getUserData=function(){return this._userData};Mt.prototype.getSRID=function(){return this._SRID};Mt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Mt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Mt.SORTINDEX_GEOMETRYCOLLECTION)throw new ho("This method does not support GeometryCollection arguments")};Mt.prototype.equal=function(t,n,r){return r===0?t.equals(n):t.distance(n)<=r};Mt.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Mt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Mt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new ct(this._envelope)};Mt.prototype.setSRID=function(t){this._SRID=t};Mt.prototype.setUserData=function(t){this._userData=t};Mt.prototype.compare=function(t,n){for(var r=t.iterator(),o=n.iterator();r.hasNext()&&o.hasNext();){var a=r.next(),s=o.next(),u=a.compareTo(s);if(u!==0)return u}return r.hasNext()?1:o.hasNext()?-1:0};Mt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Mt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Mt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Mt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Mt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Mt.SORTINDEX_MULTIPOLYGON};Mt.prototype.interfaces_=function(){return[yR,Gc,Uc]};Mt.prototype.getClass=function(){return Mt};Mt.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1};Mt.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1};Wd.serialVersionUID.get=function(){return 8763622679187377e3};Wd.SORTINDEX_POINT.get=function(){return 0};Wd.SORTINDEX_MULTIPOINT.get=function(){return 1};Wd.SORTINDEX_LINESTRING.get=function(){return 2};Wd.SORTINDEX_LINEARRING.get=function(){return 3};Wd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Wd.SORTINDEX_POLYGON.get=function(){return 5};Wd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Wd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Wd.geometryChangedFilter.get=function(){return lV};Object.defineProperties(Mt,Wd);var lV=function(){};lV.interfaces_=function(){return[rm]};lV.filter=function(t){t.geometryChangedAction()};var Nd=function(){};Nd.prototype.filter=function(t){};Nd.prototype.interfaces_=function(){return[]};Nd.prototype.getClass=function(){return Nd};var zc=function(){},lm={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};zc.prototype.isInBoundary=function(t){};zc.prototype.interfaces_=function(){return[]};zc.prototype.getClass=function(){return zc};lm.Mod2BoundaryNodeRule.get=function(){return F1};lm.EndPointBoundaryNodeRule.get=function(){return z1};lm.MultiValentEndPointBoundaryNodeRule.get=function(){return V1};lm.MonoValentEndPointBoundaryNodeRule.get=function(){return k1};lm.MOD2_BOUNDARY_RULE.get=function(){return new F1};lm.ENDPOINT_BOUNDARY_RULE.get=function(){return new z1};lm.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new V1};lm.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new k1};lm.OGC_SFS_BOUNDARY_RULE.get=function(){return zc.MOD2_BOUNDARY_RULE};Object.defineProperties(zc,lm);var F1=function(){};F1.prototype.isInBoundary=function(t){return t%2===1};F1.prototype.interfaces_=function(){return[zc]};F1.prototype.getClass=function(){return F1};var z1=function(){};z1.prototype.isInBoundary=function(t){return t>0};z1.prototype.interfaces_=function(){return[zc]};z1.prototype.getClass=function(){return z1};var V1=function(){};V1.prototype.isInBoundary=function(t){return t>1};V1.prototype.interfaces_=function(){return[zc]};V1.prototype.getClass=function(){return V1};var k1=function(){};k1.prototype.isInBoundary=function(t){return t===1};k1.prototype.interfaces_=function(){return[zc]};k1.prototype.getClass=function(){return k1};var ba=function(){};ba.prototype.add=function(){};ba.prototype.addAll=function(){};ba.prototype.isEmpty=function(){};ba.prototype.iterator=function(){};ba.prototype.size=function(){};ba.prototype.toArray=function(){};ba.prototype.remove=function(){};var OFe=function(e){function t(r){e.call(this),this.message=r||""}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error),aw=function(){};aw.prototype.hasNext=function(){};aw.prototype.next=function(){};aw.prototype.remove=function(){};var wf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(ba);function sw(e){this.message=e||""}sw.prototype=new Error;sw.prototype.name="NoSuchElementException";var Fe=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof ba&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,ba]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.set=function(r,o){var a=this.array_[r];return this.array_[r]=o,a},t.prototype.iterator=function(){return new NFe(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new OFe;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.remove=function(r){for(var o=this,a=!1,s=0,u=this.array_.length;s<u;s++)if(o.array_[s]===r){o.array_.splice(s,1),a=!0;break}return a},t}(wf),NFe=function(e){function t(n){e.call(this),this.arrayList_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new sw;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(aw),ZA=function(e){function t(){if(e.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.ensureCapacity(o.length),this.add(o,a)}}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(o){return this.get(o)},t.prototype.addAll=function(){var o=this;if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=!1,l=a.iterator();l.hasNext();)o.add(l.next(),s),u=!0;return u}else return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var o=this,a=e.prototype.clone.call(this),s=0;s<this.size();s++)a.add(s,o.get(s).copy());return a},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var o=this;if(arguments.length===1){var a=arguments[0];e.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1];return this.add(s,u,!0),!0}else if(arguments[0]instanceof ae&&typeof arguments[1]=="boolean"){var l=arguments[0],c=arguments[1];if(!c&&this.size()>=1){var f=this.get(this.size()-1);if(f.equals2D(l))return null}e.prototype.add.call(this,l)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var h=arguments[0],d=arguments[1];return this.add(h,d),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],_=arguments[1],y=arguments[2];if(y)for(var v=0;v<p.length;v++)o.add(p[v],_);else for(var w=p.length-1;w>=0;w--)o.add(p[w],_);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2];if(!S){var A=this.size();if(A>0){if(C>0){var D=this.get(C-1);if(D.equals2D(E))return null}if(C<A){var P=this.get(C);if(P.equals2D(E))return null}}}e.prototype.add.call(this,C,E)}}else if(arguments.length===4){var M=arguments[0],b=arguments[1],O=arguments[2],m=arguments[3],I=1;O>m&&(I=-1);for(var L=O;L!==m;L+=I)o.add(M[L],b);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new ae(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,n),t}(Fe),gn=function(){},CR={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};CR.ForwardComparator.get=function(){return DA};CR.BidirectionalComparator.get=function(){return G1};CR.coordArrayType.get=function(){return new Array(0).fill(null)};gn.prototype.interfaces_=function(){return[]};gn.prototype.getClass=function(){return gn};gn.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};gn.ptNotInList=function(t,n){for(var r=0;r<t.length;r++){var o=t[r];if(gn.indexOf(o,n)<0)return o}return null};gn.scroll=function(t,n){var r=gn.indexOf(n,t);if(r<0)return null;var o=new Array(t.length).fill(null);Ss.arraycopy(t,r,o,0,t.length-r),Ss.arraycopy(t,0,o,t.length-r,r),Ss.arraycopy(o,0,t,0,t.length)};gn.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(o===a)return!0;if(o===null||a===null||o.length!==a.length)return!1;for(var u=0;u<o.length;u++)if(s.compare(o[u],a[u])!==0)return!1;return!0}};gn.intersection=function(t,n){for(var r=new ZA,o=0;o<t.length;o++)n.intersects(t[o])&&r.add(t[o],!0);return r.toCoordinateArray()};gn.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1};gn.removeRepeatedPoints=function(t){if(!gn.hasRepeatedPoints(t))return t;var n=new ZA(t,!1);return n.toCoordinateArray()};gn.reverse=function(t){for(var n=t.length-1,r=Math.trunc(n/2),o=0;o<=r;o++){var a=t[o];t[o]=t[n-o],t[n-o]=a}};gn.removeNull=function(t){for(var n=0,r=0;r<t.length;r++)t[r]!==null&&n++;var o=new Array(n).fill(null);if(n===0)return o;for(var a=0,s=0;s<t.length;s++)t[s]!==null&&(o[a++]=t[s]);return o};gn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),r=0;r<t.length;r++)n[r]=new ae(t[r]);return n}else if(arguments.length===5)for(var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=arguments[4],c=0;c<l;c++)s[u+c]=new ae(o[a+c])};gn.isEqualReversed=function(t,n){for(var r=0;r<t.length;r++){var o=t[r],a=n[t.length-r-1];if(o.compareTo(a)!==0)return!1}return!0};gn.envelope=function(t){for(var n=new ct,r=0;r<t.length;r++)n.expandToInclude(t[r]);return n};gn.toCoordinateArray=function(t){return t.toArray(gn.coordArrayType)};gn.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]};gn.indexOf=function(t,n){for(var r=0;r<n.length;r++)if(t.equals(n[r]))return r;return-1};gn.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var r=t.length-1-n,o=t[n].compareTo(t[r]);if(o!==0)return o}return 1};gn.compare=function(t,n){for(var r=0;r<t.length&&r<n.length;){var o=t[r].compareTo(n[r]);if(o!==0)return o;r++}return r<n.length?-1:r<t.length?1:0};gn.minCoordinate=function(t){for(var n=null,r=0;r<t.length;r++)(n===null||n.compareTo(t[r])>0)&&(n=t[r]);return n};gn.extract=function(t,n,r){n=oc.clamp(n,0,t.length),r=oc.clamp(r,-1,t.length);var o=r-n+1;r<0&&(o=0),n>=t.length&&(o=0),r<n&&(o=0);var a=new Array(o).fill(null);if(o===0)return a;for(var s=0,u=n;u<=r;u++)a[s++]=t[u];return a};Object.defineProperties(gn,CR);var DA=function(){};DA.prototype.compare=function(t,n){var r=t,o=n;return gn.compare(r,o)};DA.prototype.interfaces_=function(){return[N1]};DA.prototype.getClass=function(){return DA};var G1=function(){};G1.prototype.compare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;var a=gn.compare(r,o),s=gn.isEqualReversed(r,o);return s?0:a};G1.prototype.OLDcompare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;for(var a=gn.increasingDirection(r),s=gn.increasingDirection(o),u=a>0?0:r.length-1,l=s>0?0:r.length-1,c=0;c<r.length;c++){var f=r[u].compareTo(o[l]);if(f!==0)return f;u+=a,l+=s}return 0};G1.prototype.interfaces_=function(){return[N1]};G1.prototype.getClass=function(){return G1};var Rv=function(){};Rv.prototype.get=function(){};Rv.prototype.put=function(){};Rv.prototype.size=function(){};Rv.prototype.values=function(){};Rv.prototype.entrySet=function(){};var BFe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Rv);function QA(e){this.message=e||""}QA.prototype=new Error;QA.prototype.name="OperationNotSupported";function xR(){}xR.prototype=new ba;xR.prototype.contains=function(){};var cV=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof ba&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var o=this,a=0,s=this.array_.length;a<s;a++){var u=o.array_[a];if(u===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.iterator=function(){return new FFe(this)},t}(xR),FFe=function(e){function t(n){e.call(this),this.hashSet_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new sw;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new QA},t}(aw),Zp=0,Q0=1;function ine(e){return e===null?Zp:e.color}function Yi(e){return e===null?null:e.parent}function Xp(e,t){e!==null&&(e.color=t)}function l4(e){return e===null?null:e.left}function one(e){return e===null?null:e.right}function Ws(){this.root_=null,this.size_=0}Ws.prototype=new BFe;Ws.prototype.get=function(e){for(var t=this.root_;t!==null;){var n=e.compareTo(t.key);if(n<0)t=t.left;else if(n>0)t=t.right;else return t.value}return null};Ws.prototype.put=function(e,t){if(this.root_===null)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:Zp,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,o;do if(r=n,o=e.compareTo(n.key),o<0)n=n.left;else if(o>0)n=n.right;else{var a=n.value;return n.value=t,a}while(n!==null);var s={key:e,left:null,right:null,value:t,parent:r,color:Zp,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null};Ws.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=Q0;e!=null&&e!==this.root_&&e.parent.color===Q0;)if(Yi(e)===l4(Yi(Yi(e)))){var n=one(Yi(Yi(e)));ine(n)===Q0?(Xp(Yi(e),Zp),Xp(n,Zp),Xp(Yi(Yi(e)),Q0),e=Yi(Yi(e))):(e===one(Yi(e))&&(e=Yi(e),t.rotateLeft(e)),Xp(Yi(e),Zp),Xp(Yi(Yi(e)),Q0),t.rotateRight(Yi(Yi(e))))}else{var r=l4(Yi(Yi(e)));ine(r)===Q0?(Xp(Yi(e),Zp),Xp(r,Zp),Xp(Yi(Yi(e)),Q0),e=Yi(Yi(e))):(e===l4(Yi(e))&&(e=Yi(e),t.rotateRight(e)),Xp(Yi(e),Zp),Xp(Yi(Yi(e)),Q0),t.rotateLeft(Yi(Yi(e))))}this.root_.color=Zp};Ws.prototype.values=function(){var e=new Fe,t=this.getFirstEntry();if(t!==null)for(e.add(t.value);(t=Ws.successor(t))!==null;)e.add(t.value);return e};Ws.prototype.entrySet=function(){var e=new cV,t=this.getFirstEntry();if(t!==null)for(e.add(t);(t=Ws.successor(t))!==null;)e.add(t);return e};Ws.prototype.rotateLeft=function(e){if(e!=null){var t=e.right;e.right=t.left,t.left!=null&&(t.left.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}};Ws.prototype.rotateRight=function(e){if(e!=null){var t=e.left;e.left=t.right,t.right!=null&&(t.right.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}};Ws.prototype.getFirstEntry=function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e};Ws.successor=function(e){if(e===null)return null;if(e.right!==null){for(var t=e.right;t.left!==null;)t=t.left;return t}else{for(var n=e.parent,r=e;n!==null&&r===n.right;)r=n,n=n.parent;return n}};Ws.prototype.size=function(){return this.size_};var PA=function(){};PA.prototype.interfaces_=function(){return[]};PA.prototype.getClass=function(){return PA};function jre(){}jre.prototype=new xR;function Oh(){this.array_=[],arguments[0]instanceof ba&&this.addAll(arguments[0])}Oh.prototype=new jre;Oh.prototype.contains=function(e){for(var t=this,n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===0)return!0}return!1};Oh.prototype.add=function(e){var t=this;if(this.contains(e))return!1;for(var n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===1)return t.array_.splice(n,0,e),!0}return this.array_.push(e),!0};Oh.prototype.addAll=function(e){for(var t=this,n=e.iterator();n.hasNext();)t.add(n.next());return!0};Oh.prototype.remove=function(e){throw new QA};Oh.prototype.size=function(){return this.array_.length};Oh.prototype.isEmpty=function(){return this.array_.length===0};Oh.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};Oh.prototype.iterator=function(){return new wR(this)};var wR=function(e){this.treeSet_=e,this.position_=0};wR.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new sw;return this.treeSet_.array_[this.position_++]};wR.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};wR.prototype.remove=function(){throw new QA};var t_=function(){};t_.sort=function(){var t=arguments[0],n,r,o,a;if(arguments.length===1)a=function(u,l){return u.compareTo(l)},t.sort(a);else if(arguments.length===2)o=arguments[1],a=function(u,l){return o.compare(u,l)},t.sort(a);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),o=arguments[3],a=function(u,l){return o.compare(u,l)},r.sort(a),s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])};t_.asList=function(t){for(var n=new Fe,r=0,o=t.length;r<o;r++)n.add(t[r]);return n};var qr=function(){},Mf={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Mf.P.get=function(){return 0};Mf.L.get=function(){return 1};Mf.A.get=function(){return 2};Mf.FALSE.get=function(){return-1};Mf.TRUE.get=function(){return-2};Mf.DONTCARE.get=function(){return-3};Mf.SYM_FALSE.get=function(){return"F"};Mf.SYM_TRUE.get=function(){return"T"};Mf.SYM_DONTCARE.get=function(){return"*"};Mf.SYM_P.get=function(){return"0"};Mf.SYM_L.get=function(){return"1"};Mf.SYM_A.get=function(){return"2"};qr.prototype.interfaces_=function(){return[]};qr.prototype.getClass=function(){return qr};qr.toDimensionSymbol=function(t){switch(t){case qr.FALSE:return qr.SYM_FALSE;case qr.TRUE:return qr.SYM_TRUE;case qr.DONTCARE:return qr.SYM_DONTCARE;case qr.P:return qr.SYM_P;case qr.L:return qr.SYM_L;case qr.A:return qr.SYM_A;default:}throw new ho("Unknown dimension value: "+t)};qr.toDimensionValue=function(t){switch(IA.toUpperCase(t)){case qr.SYM_FALSE:return qr.FALSE;case qr.SYM_TRUE:return qr.TRUE;case qr.SYM_DONTCARE:return qr.DONTCARE;case qr.SYM_P:return qr.P;case qr.SYM_L:return qr.L;case qr.SYM_A:return qr.A;default:}throw new ho("Unknown dimension symbol: "+t)};Object.defineProperties(qr,Mf);var Nh=function(){};Nh.prototype.filter=function(t){};Nh.prototype.interfaces_=function(){return[]};Nh.prototype.getClass=function(){return Nh};var Tf=function(){};Tf.prototype.filter=function(t,n){};Tf.prototype.isDone=function(){};Tf.prototype.isGeometryChanged=function(){};Tf.prototype.interfaces_=function(){return[]};Tf.prototype.getClass=function(){return Tf};var Au=function(e){function t(r,o){if(e.call(this,o),this._geometries=r||[],e.hasNullElements(this._geometries))throw new ho("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var o=this,a=new ct,s=0;s<this._geometries.length;s++)a.expandToInclude(o._geometries[s].getEnvelopeInternal());return a},t.prototype.getGeometryN=function(o){return this._geometries[o]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var o=this,a=new Array(this.getNumPoints()).fill(null),s=-1,u=0;u<this._geometries.length;u++)for(var l=o._geometries[u].getCoordinates(),c=0;c<l.length;c++)s++,a[s]=l[c];return a},t.prototype.getArea=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getArea();return a},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._geometries.length!==u._geometries.length)return!1;for(var l=0;l<this._geometries.length;l++)if(!o._geometries[l].equalsExact(u._geometries[l],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<this._geometries.length;a++)o._geometries[a].normalize();t_.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var o=this,a=qr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getBoundaryDimension());return a},t.prototype.getDimension=function(){for(var o=this,a=qr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getDimension());return a},t.prototype.getLength=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getNumPoints();return a},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createGeometryCollection(s)},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=new Oh(t_.asList(this._geometries)),u=new Oh(t_.asList(a._geometries));return this.compare(s,u)}else if(arguments.length===2){for(var l=arguments[0],c=arguments[1],f=l,h=this.getNumGeometries(),d=f.getNumGeometries(),p=0;p<h&&p<d;){var _=o.getGeometryN(p),y=f.getGeometryN(p),v=_.compareToSameClass(y,c);if(v!==0)return v;p++}return p<h?1:p<d?-1:0}},t.prototype.apply=function(){var o=this;if(Ot(arguments[0],Nd))for(var a=arguments[0],s=0;s<this._geometries.length;s++)o._geometries[s].apply(a);else if(Ot(arguments[0],Tf)){var u=arguments[0];if(this._geometries.length===0)return null;for(var l=0;l<this._geometries.length&&(o._geometries[l].apply(u),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Ot(arguments[0],Nh)){var c=arguments[0];c.filter(this);for(var f=0;f<this._geometries.length;f++)o._geometries[f].apply(c)}else if(Ot(arguments[0],rm)){var h=arguments[0];h.filter(this);for(var d=0;d<this._geometries.length;d++)o._geometries[d].apply(h)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),an.shouldNeverReachHere(),null},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var s=0;s<this._geometries.length;s++)a._geometries[s]=o._geometries[s].clone();return a},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.isEmpty=function(){for(var o=this,a=0;a<this._geometries.length;a++)if(!o._geometries[a].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,n),t}(Mt),o_=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Mt.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?qr.FALSE:0},t.prototype.isClosed=function(){var o=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!o._geometries[a].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[a-1-u]=o._geometries[u].reverse();return this.getFactory().createMultiLineString(s)},t.prototype.getBoundary=function(){return new Nc(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[PA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,n),t}(Au),Nc=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],n=zc.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};Nc.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};Nc.prototype.getBoundary=function(){return this._geom instanceof Oo?this.boundaryLineString(this._geom):this._geom instanceof o_?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Nc.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this._bnRule.isInBoundary(2);return n?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Nc.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Nc.prototype.computeBoundaryCoordinates=function(t){var n=this,r=new Fe;this._endpointMap=new Ws;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);a.getNumPoints()!==0&&(n.addEndpoint(a.getCoordinateN(0)),n.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var s=this._endpointMap.entrySet().iterator();s.hasNext();){var u=s.next(),l=u.getValue(),c=l.count;n._bnRule.isInBoundary(c)&&r.add(u.getKey())}return gn.toCoordinateArray(r)};Nc.prototype.addEndpoint=function(t){var n=this._endpointMap.get(t);n===null&&(n=new ZL,this._endpointMap.put(t,n)),n.count++};Nc.prototype.interfaces_=function(){return[]};Nc.prototype.getClass=function(){return Nc};Nc.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new Nc(t);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new Nc(r,o);return a.getBoundary()}};var ZL=function(){this.count=null};ZL.prototype.interfaces_=function(){return[]};ZL.prototype.getClass=function(){return ZL};function zFe(){}function VFe(){}var kFe=function(){};function GFe(){}function UFe(){}function HFe(){}var Bc=function(){},fV={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Bc.prototype.interfaces_=function(){return[]};Bc.prototype.getClass=function(){return Bc};Bc.chars=function(t,n){for(var r=new Array(n).fill(null),o=0;o<n;o++)r[o]=t;return String(r)};Bc.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new GFe,r=new zFe(n);return t.printStackTrace(r),n.toString()}else if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s="",u=new VFe(Bc.getStackTrace(o)),l=new HFe(u),c=0;c<a;c++)try{s+=l.readLine()+Bc.NEWLINE}catch(f){if(f instanceof UFe)an.shouldNeverReachHere();else throw f}finally{}return s}};Bc.split=function(t,n){for(var r=n.length,o=new Fe,a=""+t,s=a.indexOf(n);s>=0;){var u=a.substring(0,s);o.add(u),a=a.substring(s+r),s=a.indexOf(n)}a.length>0&&o.add(a);for(var l=new Array(o.size()).fill(null),c=0;c<l.length;c++)l[c]=o.get(c);return l};Bc.toString=function(){if(arguments.length===1){var t=arguments[0];return Bc.SIMPLE_ORDINATE_FORMAT.format(t)}};Bc.spaces=function(t){return Bc.chars(" ",t)};fV.NEWLINE.get=function(){return Ss.getProperty("line.separator")};fV.SIMPLE_ORDINATE_FORMAT.get=function(){return new kFe("0.#")};Object.defineProperties(Bc,fV);var Zo=function(){};Zo.prototype.interfaces_=function(){return[]};Zo.prototype.getClass=function(){return Zo};Zo.copyCoord=function(t,n,r,o){for(var a=Math.min(t.getDimension(),r.getDimension()),s=0;s<a;s++)r.setOrdinate(o,s,t.getOrdinate(n,s))};Zo.isRing=function(t){var n=t.size();return n===0?!0:n<=3?!1:t.getOrdinate(0,An.X)===t.getOrdinate(n-1,An.X)&&t.getOrdinate(0,An.Y)===t.getOrdinate(n-1,An.Y)};Zo.isEqual=function(t,n){var r=t.size(),o=n.size();if(r!==o)return!1;for(var a=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)for(var u=0;u<a;u++){var l=t.getOrdinate(s,u),c=n.getOrdinate(s,u);if(t.getOrdinate(s,u)!==n.getOrdinate(s,u)&&!(Qt.isNaN(l)&&Qt.isNaN(c)))return!1}return!0};Zo.extend=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();if(Zo.copy(n,0,o,0,a),a>0)for(var s=a;s<r;s++)Zo.copy(n,a-1,o,s,1);return o};Zo.reverse=function(t){for(var n=t.size()-1,r=Math.trunc(n/2),o=0;o<=r;o++)Zo.swap(t,o,n-o)};Zo.swap=function(t,n,r){if(n===r)return null;for(var o=0;o<t.getDimension();o++){var a=t.getOrdinate(n,o);t.setOrdinate(n,o,t.getOrdinate(r,o)),t.setOrdinate(r,o,a)}};Zo.copy=function(t,n,r,o,a){for(var s=0;s<a;s++)Zo.copyCoord(t,n+s,r,o+s)};Zo.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var r=t.getDimension(),o=new qh;o.append("(");for(var a=0;a<n;a++){a>0&&o.append(" ");for(var s=0;s<r;s++)s>0&&o.append(","),o.append(Bc.toString(t.getOrdinate(a,s)))}return o.append(")"),o.toString()}};Zo.ensureValidRing=function(t,n){var r=n.size();if(r===0)return n;if(r<=3)return Zo.createClosedRing(t,n,4);var o=n.getOrdinate(0,An.X)===n.getOrdinate(r-1,An.X)&&n.getOrdinate(0,An.Y)===n.getOrdinate(r-1,An.Y);return o?n:Zo.createClosedRing(t,n,r+1)};Zo.createClosedRing=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();Zo.copy(n,0,o,0,a);for(var s=a;s<r;s++)Zo.copy(n,0,o,s,1);return o};var Oo=function(e){function t(r,o){e.call(this,o),this._points=null,this.init(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new ct:this._points.expandEnvelope(new ct)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._points.size()!==u._points.size())return!1;for(var l=0;l<this._points.size();l++)if(!o.equal(o._points.getCoordinate(l),u._points.getCoordinate(l),s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<Math.trunc(this._points.size()/2);a++){var s=o._points.size()-1-a;if(!o._points.getCoordinate(a).equals(o._points.getCoordinate(s)))return o._points.getCoordinate(a).compareTo(o._points.getCoordinate(s))>0&&Zo.reverse(o._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?qr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return He.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var o=this._points.copy();Zo.reverse(o);var a=this.getFactory().createLineString(o);return a},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){for(var a=arguments[0],s=a,u=0,l=0;u<this._points.size()&&l<s._points.size();){var c=o._points.getCoordinate(u).compareTo(s._points.getCoordinate(l));if(c!==0)return c;u++,l++}return u<this._points.size()?1:l<s._points.size()?-1:0}else if(arguments.length===2){var f=arguments[0],h=arguments[1],d=f;return h.compare(this._points,d._points)}},t.prototype.apply=function(){var o=this;if(Ot(arguments[0],Nd))for(var a=arguments[0],s=0;s<this._points.size();s++)a.filter(o._points.getCoordinate(s));else if(Ot(arguments[0],Tf)){var u=arguments[0];if(this._points.size()===0)return null;for(var l=0;l<this._points.size()&&(u.filter(o._points,l),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Ot(arguments[0],Nh)){var c=arguments[0];c.filter(this)}else if(Ot(arguments[0],rm)){var f=arguments[0];f.filter(this)}},t.prototype.getBoundary=function(){return new Nc(this).getBoundary()},t.prototype.isEquivalentClass=function(o){return o instanceof t},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._points=this._points.clone(),o},t.prototype.getCoordinateN=function(o){return this._points.getCoordinate(o)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(o){if(o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),o.size()===1)throw new ho("Invalid number of points in LineString (found "+o.size()+" - must be 0 or >= 2)");this._points=o},t.prototype.isCoordinate=function(o){for(var a=this,s=0;s<this._points.size();s++)if(a._points.getCoordinate(s).equals(o))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(o){return this.getFactory().createPoint(this._points.getCoordinate(o))},t.prototype.interfaces_=function(){return[PA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,n),t}(Mt),MA=function(){};MA.prototype.interfaces_=function(){return[]};MA.prototype.getClass=function(){return MA};var Il=function(e){function t(r,o){e.call(this,o),this._coordinates=r||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new ct;var o=new ct;return o.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),o},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?this.isEmpty()&&o.isEmpty()?!0:this.isEmpty()!==o.isEmpty()?!1:this.equal(o.getCoordinate(),this.getCoordinate(),a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return qr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var o=arguments[0],a=o;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var s=arguments[0],u=arguments[1],l=s;return u.compare(this._coordinates,l._coordinates)}},t.prototype.apply=function(){if(Ot(arguments[0],Nd)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this.getCoordinate())}else if(Ot(arguments[0],Tf)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Ot(arguments[0],Nh)){var s=arguments[0];s.filter(this)}else if(Ot(arguments[0],rm)){var u=arguments[0];u.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._coordinates=this._coordinates.clone(),o},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(o){o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),an.isTrue(o.size()<=1),this._coordinates=o},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[MA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,n),t}(Mt),bg=function(){};bg.prototype.interfaces_=function(){return[]};bg.prototype.getClass=function(){return bg};var Ma=function(e){function t(r,o,a){if(e.call(this,a),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),o===null&&(o=[]),e.hasNullElements(o))throw new ho("holes must not contain null elements");if(r.isEmpty()&&e.hasNonEmptyElements(o))throw new ho("shell is empty but holes are not");this._shell=r,this._holes=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var o=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),s=-1,u=this._shell.getCoordinates(),l=0;l<u.length;l++)s++,a[s]=u[l];for(var c=0;c<this._holes.length;c++)for(var f=o._holes[c].getCoordinates(),h=0;h<f.length;h++)s++,a[s]=f[h];return a},t.prototype.getArea=function(){var o=this,a=0;a+=Math.abs(He.signedArea(this._shell.getCoordinateSequence()));for(var s=0;s<this._holes.length;s++)a-=Math.abs(He.signedArea(o._holes[s].getCoordinateSequence()));return a},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var o=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),s=0;s<5;s++){var u=o.getX(s);if(!(u===a.getMinX()||u===a.getMaxX()))return!1;var l=o.getY(s);if(!(l===a.getMinY()||l===a.getMaxY()))return!1}for(var c=o.getX(0),f=o.getY(0),h=1;h<=4;h++){var d=o.getX(h),p=o.getY(h),_=d!==c,y=p!==f;if(_===y)return!1;c=d,f=p}return!0},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a,l=this._shell,c=u._shell;if(!l.equalsExact(c,s)||this._holes.length!==u._holes.length)return!1;for(var f=0;f<this._holes.length;f++)if(!o._holes[f].equalsExact(u._holes[f],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var o=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)o.normalize(o._holes[a],!1);t_.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],u=arguments[1];if(s.isEmpty())return null;var l=new Array(s.getCoordinates().length-1).fill(null);Ss.arraycopy(s.getCoordinates(),0,l,0,l.length);var c=gn.minCoordinate(s.getCoordinates());gn.scroll(l,c),Ss.arraycopy(l,0,s.getCoordinates(),0,l.length),s.getCoordinates()[l.length]=l[0],He.isCCW(s.getCoordinates())===u&&gn.reverse(s.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var o=this,a=0;a+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)a+=o._holes[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)a+=o._holes[s].getNumPoints();return a},t.prototype.reverse=function(){var o=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].copy().reverse();return a},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=this._shell,u=a._shell;return s.compareToSameClass(u)}else if(arguments.length===2){var l=arguments[0],c=arguments[1],f=l,h=this._shell,d=f._shell,p=h.compareToSameClass(d,c);if(p!==0)return p;for(var _=this.getNumInteriorRing(),y=f.getNumInteriorRing(),v=0;v<_&&v<y;){var w=o.getInteriorRingN(v),C=f.getInteriorRingN(v),E=w.compareToSameClass(C,c);if(E!==0)return E;v++}return v<_?1:v<y?-1:0}},t.prototype.apply=function(o){var a=this;if(Ot(o,Nd)){this._shell.apply(o);for(var s=0;s<this._holes.length;s++)a._holes[s].apply(o)}else if(Ot(o,Tf)){if(this._shell.apply(o),!o.isDone())for(var u=0;u<this._holes.length&&(a._holes[u].apply(o),!o.isDone());u++);o.isGeometryChanged()&&this.geometryChanged()}else if(Ot(o,Nh))o.filter(this);else if(Ot(o,rm)){o.filter(this),this._shell.apply(o);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(o)}},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var s=0;s<this._holes.length;s++)a[s+1]=o._holes[s];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].clone();return a},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var o=this,a=this._shell.copy(),s=new Array(this._holes.length).fill(null),u=0;u<s.length;u++)s[u]=o._holes[u].copy();return new t(a,s,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(o){return this._holes[o]},t.prototype.interfaces_=function(){return[bg]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,n),t}(Mt),U1=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Mt.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._geometries[o].getCoordinate()}else return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return qr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[MA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,n),t}(Au),Bd=function(e){function t(r,o){r instanceof ae&&o instanceof mn&&(r=o.getCoordinateSequenceFactory().create(r)),e.call(this,r,o),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Mt.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return qr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var o=this._points.copy();Zo.reverse(o);var a=this.getFactory().createLinearRing(o);return a},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new ho("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new ho("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,n),t}(Oo),Rd=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Mt.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createMultiPolygon(s)},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new Fe,s=0;s<this._geometries.length;s++)for(var u=o._geometries[s],l=u.getBoundary(),c=0;c<l.getNumGeometries();c++)a.add(l.getGeometryN(c));var f=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(f))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[bg]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,n),t}(Au),Vc=function(t){this._factory=t||null,this._isUserDataCopied=!1},ER={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Vc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};Vc.prototype.edit=function(t,n){if(t===null)return null;var r=this.editInternal(t,n);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};Vc.prototype.editInternal=function(t,n){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Au?this.editGeometryCollection(t,n):t instanceof Ma?this.editPolygon(t,n):t instanceof Il?n.edit(t,this._factory):t instanceof Oo?n.edit(t,this._factory):(an.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};Vc.prototype.editGeometryCollection=function(t,n){for(var r=this,o=n.edit(t,this._factory),a=new Fe,s=0;s<o.getNumGeometries();s++){var u=r.edit(o.getGeometryN(s),n);u===null||u.isEmpty()||a.add(u)}return o.getClass()===U1?this._factory.createMultiPoint(a.toArray([])):o.getClass()===o_?this._factory.createMultiLineString(a.toArray([])):o.getClass()===Rd?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};Vc.prototype.editPolygon=function(t,n){var r=this,o=n.edit(t,this._factory);if(o===null&&(o=this._factory.createPolygon(null)),o.isEmpty())return o;var a=this.edit(o.getExteriorRing(),n);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var s=new Fe,u=0;u<o.getNumInteriorRing();u++){var l=r.edit(o.getInteriorRingN(u),n);l===null||l.isEmpty()||s.add(l)}return this._factory.createPolygon(a,s.toArray([]))};Vc.prototype.interfaces_=function(){return[]};Vc.prototype.getClass=function(){return Vc};Vc.GeometryEditorOperation=function(){};ER.NoOpGeometryOperation.get=function(){return LA};ER.CoordinateOperation.get=function(){return RA};ER.CoordinateSequenceOperation.get=function(){return OA};Object.defineProperties(Vc,ER);var LA=function(){};LA.prototype.edit=function(t,n){return t};LA.prototype.interfaces_=function(){return[Vc.GeometryEditorOperation]};LA.prototype.getClass=function(){return LA};var RA=function(){};RA.prototype.edit=function(t,n){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof Bd?n.createLinearRing(r):t instanceof Oo?n.createLineString(r):t instanceof Il?r.length>0?n.createPoint(r[0]):n.createPoint():t};RA.prototype.interfaces_=function(){return[Vc.GeometryEditorOperation]};RA.prototype.getClass=function(){return RA};var OA=function(){};OA.prototype.edit=function(t,n){return t instanceof Bd?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Oo?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Il?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t};OA.prototype.interfaces_=function(){return[Vc.GeometryEditorOperation]};OA.prototype.getClass=function(){return OA};var jo=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)t._coordinates[r]=new ae}else if(Ot(arguments[0],An)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._coordinates=new Array(o.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)t._coordinates[a]=o.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],u=arguments[1];this._coordinates=s,this._dimension=u,s===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],c=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=c;for(var f=0;f<l;f++)t._coordinates[f]=new ae}}},Kre={serialVersionUID:{configurable:!0}};jo.prototype.setOrdinate=function(t,n,r){switch(n){case An.X:this._coordinates[t].x=r;break;case An.Y:this._coordinates[t].y=r;break;case An.Z:this._coordinates[t].z=r;break;default:throw new ho("invalid ordinateIndex")}};jo.prototype.size=function(){return this._coordinates.length};jo.prototype.getOrdinate=function(t,n){switch(n){case An.X:return this._coordinates[t].x;case An.Y:return this._coordinates[t].y;case An.Z:return this._coordinates[t].z;default:}return Qt.NaN};jo.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};jo.prototype.getCoordinateCopy=function(t){return new ae(this._coordinates[t])};jo.prototype.getDimension=function(){return this._dimension};jo.prototype.getX=function(t){return this._coordinates[t].x};jo.prototype.clone=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].clone();return new jo(n,this._dimension)};jo.prototype.expandEnvelope=function(t){for(var n=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(n._coordinates[r]);return t};jo.prototype.copy=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].copy();return new jo(n,this._dimension)};jo.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var n=new qh(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(t._coordinates[r]);return n.append(")"),n.toString()}else return"()"};jo.prototype.getY=function(t){return this._coordinates[t].y};jo.prototype.toCoordinateArray=function(){return this._coordinates};jo.prototype.interfaces_=function(){return[An,Uc]};jo.prototype.getClass=function(){return jo};Kre.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(jo,Kre);var Fd=function(){},hV={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Fd.prototype.readResolve=function(){return Fd.instance()};Fd.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new jo(t)}else if(Ot(arguments[0],An)){var n=arguments[0];return new jo(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return o>3&&(o=3),o<2?new jo(r):new jo(r,o)}};Fd.prototype.interfaces_=function(){return[B1,Uc]};Fd.prototype.getClass=function(){return Fd};Fd.instance=function(){return Fd.instanceObject};hV.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};hV.instanceObject.get=function(){return new Fd};Object.defineProperties(Fd,hV);var Zre=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,o){return this.map_.set(r,o),o},t.prototype.values=function(){for(var r=new Fe,o=this.map_.values(),a=o.next();!a.done;)r.add(a.value),a=o.next();return r},t.prototype.entrySet=function(){var r=new cV;return this.map_.entries().forEach(function(o){return r.add(o)}),r},t.prototype.size=function(){return this.map_.size()},t}(Rv),Xr=function e(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Bh){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},dV={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Xr.prototype.equals=function(t){if(!(t instanceof Xr))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale};Xr.prototype.compareTo=function(t){var n=t,r=this.getMaximumSignificantDigits(),o=n.getMaximumSignificantDigits();return new Rh(r).compareTo(new Rh(o))};Xr.prototype.getScale=function(){return this._scale};Xr.prototype.isFloating=function(){return this._modelType===Xr.FLOATING||this._modelType===Xr.FLOATING_SINGLE};Xr.prototype.getType=function(){return this._modelType};Xr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Xr.FLOATING?t="Floating":this._modelType===Xr.FLOATING_SINGLE?t="Floating-Single":this._modelType===Xr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};Xr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Qt.isNaN(t))return t;if(this._modelType===Xr.FLOATING_SINGLE){var n=t;return n}return this._modelType===Xr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof ae){var r=arguments[0];if(this._modelType===Xr.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Xr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Xr.FLOATING?t=16:this._modelType===Xr.FLOATING_SINGLE?t=6:this._modelType===Xr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};Xr.prototype.setScale=function(t){this._scale=Math.abs(t)};Xr.prototype.interfaces_=function(){return[Uc,Gc]};Xr.prototype.getClass=function(){return Xr};Xr.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n};dV.serialVersionUID.get=function(){return 7777263578777804e3};dV.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Xr,dV);var Bh=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},pV={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Bh.prototype.readResolve=function(){return Bh.nameToTypeMap.get(this._name)};Bh.prototype.toString=function(){return this._name};Bh.prototype.interfaces_=function(){return[Uc]};Bh.prototype.getClass=function(){return Bh};pV.serialVersionUID.get=function(){return-552860263173159e4};pV.nameToTypeMap.get=function(){return new Zre};Object.defineProperties(Bh,pV);Xr.Type=Bh;Xr.FIXED=new Bh("FIXED");Xr.FLOATING=new Bh("FLOATING");Xr.FLOATING_SINGLE=new Bh("FLOATING SINGLE");var mn=function e(){this._precisionModel=new Xr,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Ot(arguments[0],B1)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Xr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Qre={serialVersionUID:{configurable:!0}};mn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new ae(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new ae(t.getMinX(),t.getMinY()),new ae(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new ae(t.getMinX(),t.getMinY()),new ae(t.getMinX(),t.getMaxY()),new ae(t.getMaxX(),t.getMaxY()),new ae(t.getMaxX(),t.getMinY()),new ae(t.getMinX(),t.getMinY())]),null)};mn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new Oo(this.getCoordinateSequenceFactory().create(t),this);if(Ot(t,An))return new Oo(t,this)}else return new Oo(this.getCoordinateSequenceFactory().create([]),this)};mn.prototype.createMultiLineString=function(){if(arguments.length===0)return new o_(null,this);if(arguments.length===1){var t=arguments[0];return new o_(t,this)}};mn.prototype.buildGeometry=function(t){for(var n=null,r=!1,o=!1,a=t.iterator();a.hasNext();){var s=a.next(),u=s.getClass();n===null&&(n=u),u!==n&&(r=!0),s.isGeometryCollectionOrDerived()&&(o=!0)}if(n===null)return this.createGeometryCollection();if(r||o)return this.createGeometryCollection(mn.toGeometryArray(t));var l=t.iterator().next(),c=t.size()>1;if(c){if(l instanceof Ma)return this.createMultiPolygon(mn.toPolygonArray(t));if(l instanceof Oo)return this.createMultiLineString(mn.toLineStringArray(t));if(l instanceof Il)return this.createMultiPoint(mn.toPointArray(t));an.shouldNeverReachHere("Unhandled class: "+l.getClass().getName())}return l};mn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};mn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Ot(arguments[0],An)){var n=arguments[0];return new Il(n,this)}}};mn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};mn.prototype.createPolygon=function(){if(arguments.length===0)return new Ma(null,null,this);if(arguments.length===1){if(Ot(arguments[0],An)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof Bd){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return new Ma(o,a,this)}};mn.prototype.getSRID=function(){return this._SRID};mn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Au(null,this);if(arguments.length===1){var t=arguments[0];return new Au(t,this)}};mn.prototype.createGeometry=function(t){var n=new Vc(this);return n.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};mn.prototype.getPrecisionModel=function(){return this._precisionModel};mn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Ot(arguments[0],An)){var n=arguments[0];return new Bd(n,this)}}};mn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new Rd(null,this);if(arguments.length===1){var t=arguments[0];return new Rd(t,this)}};mn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new U1(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new U1(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(Ot(arguments[0],An)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(o.size()).fill(null),s=0;s<o.size();s++){var u=t.getCoordinateSequenceFactory().create(1,o.getDimension());Zo.copy(o,s,u,0,1),a[s]=t.createPoint(u)}return this.createMultiPoint(a)}}};mn.prototype.interfaces_=function(){return[Uc]};mn.prototype.getClass=function(){return mn};mn.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.getDefaultCoordinateSequenceFactory=function(){return Fd.instance()};mn.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};mn.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)};Qre.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(mn,Qre);var qFe=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],TR=function(t){this.geometryFactory=t||new mn};TR.prototype.read=function(t){var n;typeof t=="string"?n=JSON.parse(t):n=t;var r=n.type;if(!bh[r])throw new Error("Unknown GeoJSON type: "+n.type);return qFe.indexOf(r)!==-1?bh[r].apply(this,[n.coordinates]):r==="GeometryCollection"?bh[r].apply(this,[n.geometries]):bh[r].apply(this,[n])};TR.prototype.write=function(t){var n=t.getGeometryType();if(!Kp[n])throw new Error("Geometry is not supported");return Kp[n].apply(this,[t])};var bh={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var r=e.geometry.type;if(!bh[r])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=bh.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t=this,n={};if(e.features){n.features=[];for(var r=0;r<e.features.length;++r)n.features.push(t.read(e.features[r]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push(new ae(r[0],r[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new ae(e[0],e[1]),new ae(e[2],e[1]),new ae(e[2],e[3]),new ae(e[0],e[3]),new ae(e[0],e[1])])},Point:function(e){var t=new ae(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(bh.Point.apply(t,[e[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var t=bh.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(bh.LineString.apply(t,[e[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var t=this,n=bh.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(n),o=[],a=1;a<e.length;++a){var s=e[a],u=bh.coordinates.apply(t,[s]),l=t.geometryFactory.createLinearRing(u);o.push(l)}return this.geometryFactory.createPolygon(r,o)},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(bh.Polygon.apply(t,[o]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(t.read(o))}return this.geometryFactory.createGeometryCollection(n)}},Kp={coordinate:function(e){return[e.x,e.y]},Point:function(e){var t=Kp.coordinate.apply(this,[e.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Kp.Point.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var t=this,n=[],r=e.getCoordinates(),o=0;o<r.length;++o){var a=r[o];n.push(Kp.coordinate.apply(t,[a]))}return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Kp.LineString.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var t=this,n=[],r=Kp.LineString.apply(this,[e._shell]);n.push(r.coordinates);for(var o=0;o<e._holes.length;++o){var a=e._holes[o],s=Kp.LineString.apply(t,[a]);n.push(s.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Kp.Polygon.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=o.getGeometryType();n.push(Kp[a].apply(t,[o]))}return{type:"GeometryCollection",geometries:n}}},uw=function(t){this.geometryFactory=t||new mn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new TR(this.geometryFactory)};uw.prototype.read=function(t){var n=this.parser.read(t);return this.precisionModel.getType()===Xr.FIXED&&this.reducePrecision(n),n};uw.prototype.reducePrecision=function(t){var n=this,r,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,o=t.points.length;r<o;r++)n.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,o=t.geometries.length;r<o;r++)n.reducePrecision(t.geometries[r])};var JA=function(){this.parser=new TR(this.geometryFactory)};JA.prototype.write=function(t){return this.parser.write(t)};var Me=function(){},SR={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Me.prototype.interfaces_=function(){return[]};Me.prototype.getClass=function(){return Me};Me.opposite=function(t){return t===Me.LEFT?Me.RIGHT:t===Me.RIGHT?Me.LEFT:t};SR.ON.get=function(){return 0};SR.LEFT.get=function(){return 1};SR.RIGHT.get=function(){return 2};Object.defineProperties(Me,SR);function AR(e){this.message=e||""}AR.prototype=new Error;AR.prototype.name="EmptyStackException";function Wh(){this.array_=[]}Wh.prototype=new wf;Wh.prototype.add=function(e){return this.array_.push(e),!0};Wh.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]};Wh.prototype.push=function(e){return this.array_.push(e),e};Wh.prototype.pop=function(e){if(this.array_.length===0)throw new AR;return this.array_.pop()};Wh.prototype.peek=function(){if(this.array_.length===0)throw new AR;return this.array_[this.array_.length-1]};Wh.prototype.empty=function(){return this.array_.length===0};Wh.prototype.isEmpty=function(){return this.empty()};Wh.prototype.search=function(e){return this.array_.indexOf(e)};Wh.prototype.size=function(){return this.array_.length};Wh.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};var Fh=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Fh.prototype.getCoordinate=function(){return this._minCoord};Fh.prototype.getRightmostSide=function(t,n){var r=this.getRightmostSideOfSegment(t,n);return r<0&&(r=this.getRightmostSideOfSegment(t,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};Fh.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();an.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this._minIndex-1],r=t[this._minIndex+1],o=He.computeOrientation(this._minCoord,r,n),a=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&o===He.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&o===He.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};Fh.prototype.getRightmostSideOfSegment=function(t,n){var r=t.getEdge(),o=r.getCoordinates();if(n<0||n+1>=o.length||o[n].y===o[n+1].y)return-1;var a=Me.LEFT;return o[n].y<o[n+1].y&&(a=Me.RIGHT),a};Fh.prototype.getEdge=function(){return this._orientedDe};Fh.prototype.checkForRightmostCoordinate=function(t){for(var n=this,r=t.getEdge().getCoordinates(),o=0;o<r.length-1;o++)(n._minCoord===null||r[o].x>n._minCoord.x)&&(n._minDe=t,n._minIndex=o,n._minCoord=r[o])};Fh.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),n=t.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Fh.prototype.findEdge=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();!o.isForward()||n.checkForRightmostCoordinate(o)}an.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Me.LEFT&&(this._orientedDe=this._minDe.getSym())};Fh.prototype.interfaces_=function(){return[]};Fh.prototype.getClass=function(){return Fh};var im=function(e){function t(n,r){e.call(this,t.msgWithCoord(n,r)),this.pt=r?new ae(r):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,o){return o?r:r+" [ "+o+" ]"},t}(nm),bR=function(){this.array_=[]};bR.prototype.addLast=function(t){this.array_.push(t)};bR.prototype.removeFirst=function(){return this.array_.shift()};bR.prototype.isEmpty=function(){return this.array_.length===0};var bu=function(){this._finder=null,this._dirEdgeList=new Fe,this._nodes=new Fe,this._rightMostCoord=null,this._env=null,this._finder=new Fh};bu.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}};bu.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};bu.prototype.computeNodeDepth=function(t){for(var n=this,r=null,o=t.getEdges().iterator();o.hasNext();){var a=o.next();if(a.isVisited()||a.getSym().isVisited()){r=a;break}}if(r===null)throw new im("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var s=t.getEdges().iterator();s.hasNext();){var u=s.next();u.setVisited(!0),n.copySymDepths(u)}};bu.prototype.computeDepth=function(t){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(Me.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)};bu.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};bu.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Me.RIGHT)>=1&&n.getDepth(Me.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};bu.prototype.computeDepths=function(t){var n=this,r=new cV,o=new bR,a=t.getNode();for(o.addLast(a),r.add(a),t.setVisited(!0);!o.isEmpty();){var s=o.removeFirst();r.add(s),n.computeNodeDepth(s);for(var u=s.getEdges().iterator();u.hasNext();){var l=u.next(),c=l.getSym();if(!c.isVisited()){var f=c.getNode();r.contains(f)||(o.addLast(f),r.add(f))}}}};bu.prototype.compareTo=function(t){var n=t;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};bu.prototype.getEnvelope=function(){if(this._env===null){for(var t=new ct,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),o=r.getEdge().getCoordinates(),a=0;a<o.length-1;a++)t.expandToInclude(o[a]);this._env=t}return this._env};bu.prototype.addReachable=function(t){var n=this,r=new Wh;for(r.add(t);!r.empty();){var o=r.pop();n.add(o,r)}};bu.prototype.copySymDepths=function(t){var n=t.getSym();n.setDepth(Me.LEFT,t.getDepth(Me.RIGHT)),n.setDepth(Me.RIGHT,t.getDepth(Me.LEFT))};bu.prototype.add=function(t,n){var r=this;t.setVisited(!0),this._nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var a=o.next();r._dirEdgeList.add(a);var s=a.getSym(),u=s.getNode();u.isVisited()||n.push(u)}};bu.prototype.getNodes=function(){return this._nodes};bu.prototype.getDirectedEdges=function(){return this._dirEdgeList};bu.prototype.interfaces_=function(){return[Gc]};bu.prototype.getClass=function(){return bu};var Xi=function e(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Me.ON]=r}else if(arguments[0]instanceof e){var o=arguments[0];if(this.init(o.location.length),o!==null)for(var a=0;a<this.location.length;a++)t.location[a]=o.location[a]}}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.init(3),this.location[Me.ON]=s,this.location[Me.LEFT]=u,this.location[Me.RIGHT]=l}};Xi.prototype.setAllLocations=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=t};Xi.prototype.isNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]!==he.NONE)return!1;return!0};Xi.prototype.setAllLocationsIfNull=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===he.NONE&&(n.location[r]=t)};Xi.prototype.isLine=function(){return this.location.length===1};Xi.prototype.merge=function(t){var n=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[Me.ON]=this.location[Me.ON],r[Me.LEFT]=he.NONE,r[Me.RIGHT]=he.NONE,this.location=r}for(var o=0;o<this.location.length;o++)n.location[o]===he.NONE&&o<t.location.length&&(n.location[o]=t.location[o])};Xi.prototype.getLocations=function(){return this.location};Xi.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Me.LEFT];this.location[Me.LEFT]=this.location[Me.RIGHT],this.location[Me.RIGHT]=t};Xi.prototype.toString=function(){var t=new qh;return this.location.length>1&&t.append(he.toLocationSymbol(this.location[Me.LEFT])),t.append(he.toLocationSymbol(this.location[Me.ON])),this.location.length>1&&t.append(he.toLocationSymbol(this.location[Me.RIGHT])),t.toString()};Xi.prototype.setLocations=function(t,n,r){this.location[Me.ON]=t,this.location[Me.LEFT]=n,this.location[Me.RIGHT]=r};Xi.prototype.get=function(t){return t<this.location.length?this.location[t]:he.NONE};Xi.prototype.isArea=function(){return this.location.length>1};Xi.prototype.isAnyNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]===he.NONE)return!0;return!1};Xi.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Me.ON,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};Xi.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(he.NONE)};Xi.prototype.isEqualOnSide=function(t,n){return this.location[n]===t.location[n]};Xi.prototype.allPositionsEqual=function(t){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==t)return!1;return!0};Xi.prototype.interfaces_=function(){return[]};Xi.prototype.getClass=function(){return Xi};var oi=function e(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Xi(t),this.elt[1]=new Xi(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new Xi(n.elt[0]),this.elt[1]=new Xi(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.elt[0]=new Xi(he.NONE),this.elt[1]=new Xi(he.NONE),this.elt[r].setLocation(o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this.elt[0]=new Xi(a,s,u),this.elt[1]=new Xi(a,s,u)}else if(arguments.length===4){var l=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3];this.elt[0]=new Xi(he.NONE,he.NONE,he.NONE),this.elt[1]=new Xi(he.NONE,he.NONE,he.NONE),this.elt[l].setLocations(c,f,h)}};oi.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};oi.prototype.setAllLocations=function(t,n){this.elt[t].setAllLocations(n)};oi.prototype.isNull=function(t){return this.elt[t].isNull()};oi.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};oi.prototype.isLine=function(t){return this.elt[t].isLine()};oi.prototype.merge=function(t){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&t.elt[r]!==null?n.elt[r]=new Xi(t.elt[r]):n.elt[r].merge(t.elt[r])};oi.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};oi.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Me.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};oi.prototype.toString=function(){var t=new qh;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};oi.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};oi.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};oi.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Me.ON,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this.elt[r].setLocation(o,a)}};oi.prototype.isEqualOnSide=function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)};oi.prototype.allPositionsEqual=function(t,n){return this.elt[t].allPositionsEqual(n)};oi.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Xi(this.elt[t].location[0]))};oi.prototype.interfaces_=function(){return[]};oi.prototype.getClass=function(){return oi};oi.toLineLabel=function(t){for(var n=new oi(he.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n};var da=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Fe,this._pts=new Fe,this._label=new oi(he.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Fe,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()};da.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=He.isCCW(this._ring.getCoordinates())};da.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};da.prototype.computePoints=function(t){var n=this;this._startDe=t;var r=t,o=!0;do{if(r===null)throw new im("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new im("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var a=r.getLabel();an.isTrue(a.isArea()),n.mergeLabel(a),n.addPoints(r.getEdge(),r.isForward(),o),o=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};da.prototype.getLinearRing=function(){return this._ring};da.prototype.getCoordinate=function(t){return this._pts.get(t)};da.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),o=r.getEdges().getOutgoingDegree(t);o>t._maxNodeDegree&&(t._maxNodeDegree=o),n=t.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};da.prototype.addPoints=function(t,n,r){var o=this,a=t.getCoordinates();if(n){var s=1;r&&(s=0);for(var u=s;u<a.length;u++)o._pts.add(a[u])}else{var l=a.length-2;r&&(l=a.length-1);for(var c=l;c>=0;c--)o._pts.add(a[c])}};da.prototype.isHole=function(){return this._isHole};da.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};da.prototype.containsPoint=function(t){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(t)||!He.isPointInRing(t,n.getCoordinates()))return!1;for(var o=this._holes.iterator();o.hasNext();){var a=o.next();if(a.containsPoint(t))return!1}return!0};da.prototype.addHole=function(t){this._holes.add(t)};da.prototype.isShell=function(){return this._shell===null};da.prototype.getLabel=function(){return this._label};da.prototype.getEdges=function(){return this._edges};da.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};da.prototype.getShell=function(){return this._shell};da.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=n.getLocation(r,Me.RIGHT);if(o===he.NONE)return null;if(this._label.getLocation(r)===he.NONE)return this._label.setLocation(r,o),null}};da.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};da.prototype.toPolygon=function(t){for(var n=this,r=new Array(this._holes.size()).fill(null),o=0;o<this._holes.size();o++)r[o]=n._holes.get(o).getLinearRing();var a=t.createPolygon(this.getLinearRing(),r);return a};da.prototype.interfaces_=function(){return[]};da.prototype.getClass=function(){return da};var WFe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,o){r.setMinEdgeRing(o)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(da),YFe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,o=new Fe,a=this._startDe;do{if(a.getMinEdgeRing()===null){var s=new WFe(a,r._geometryFactory);o.add(s)}a=a.getNext()}while(a!==this._startDe);return o},t.prototype.setEdgeRing=function(r,o){r.setEdgeRing(o)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,o=this._startDe;do{var a=o.getNode();a.getEdges().linkMinimalDirectedEdges(r),o=o.getNext()}while(o!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(da),ac=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};ac.prototype.setVisited=function(t){this._isVisited=t};ac.prototype.setInResult=function(t){this._isInResult=t};ac.prototype.isCovered=function(){return this._isCovered};ac.prototype.isCoveredSet=function(){return this._isCoveredSet};ac.prototype.setLabel=function(t){this._label=t};ac.prototype.getLabel=function(){return this._label};ac.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};ac.prototype.updateIM=function(t){an.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};ac.prototype.isInResult=function(){return this._isInResult};ac.prototype.isVisited=function(){return this._isVisited};ac.prototype.interfaces_=function(){return[]};ac.prototype.getClass=function(){return ac};var IR=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new oi(0,he.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var o=r.next();if(o.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,o){var a=he.NONE;if(a=this._label.getLocation(o),!r.isNull(o)){var s=r.getLocation(o);a!==he.BOUNDARY&&(a=s)}return a},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];this._label===null?this._label=new oi(r,o):this._label.setLocation(r,o)}else return e.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var o=arguments[0];this.mergeLabel(o._label)}else if(arguments[0]instanceof oi)for(var a=arguments[0],s=0;s<2;s++){var u=r.computeMergedLocation(a,s),l=r._label.getLocation(s);l===he.NONE&&r._label.setLocation(s,u)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var o=he.NONE;this._label!==null&&(o=this._label.getLocation(r));var a=null;switch(o){case he.BOUNDARY:a=he.INTERIOR;break;case he.INTERIOR:a=he.BOUNDARY;break;default:a=he.BOUNDARY;break}this._label.setLocation(r,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ac),zh=function(){this.nodeMap=new Ws,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};zh.prototype.find=function(t){return this.nodeMap.get(t)};zh.prototype.addNode=function(){if(arguments[0]instanceof ae){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}else if(arguments[0]instanceof IR){var r=arguments[0],o=this.nodeMap.get(r.getCoordinate());return o===null?(this.nodeMap.put(r.getCoordinate(),r),r):(o.mergeLabel(r),o)}};zh.prototype.print=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};zh.prototype.iterator=function(){return this.nodeMap.values().iterator()};zh.prototype.values=function(){return this.nodeMap.values()};zh.prototype.getBoundaryNodes=function(t){for(var n=new Fe,r=this.iterator();r.hasNext();){var o=r.next();o.getLabel().getLocation(t)===he.BOUNDARY&&n.add(o)}return n};zh.prototype.add=function(t){var n=t.getCoordinate(),r=this.addNode(n);r.add(t)};zh.prototype.interfaces_=function(){return[]};zh.prototype.getClass=function(){return zh};var Pi=function(){},$A={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Pi.prototype.interfaces_=function(){return[]};Pi.prototype.getClass=function(){return Pi};Pi.isNorthern=function(t){return t===Pi.NE||t===Pi.NW};Pi.isOpposite=function(t,n){if(t===n)return!1;var r=(t-n+4)%4;return r===2};Pi.commonHalfPlane=function(t,n){if(t===n)return t;var r=(t-n+4)%4;if(r===2)return-1;var o=t<n?t:n,a=t>n?t:n;return o===0&&a===3?3:o};Pi.isInHalfPlane=function(t,n){return n===Pi.SE?t===Pi.SE||t===Pi.SW:t===n||t===n+1};Pi.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new ho("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?Pi.NE:Pi.SE:n>=0?Pi.NW:Pi.SW}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var r=arguments[0],o=arguments[1];if(o.x===r.x&&o.y===r.y)throw new ho("Cannot compute the quadrant for two identical points "+r);return o.x>=r.x?o.y>=r.y?Pi.NE:Pi.SE:o.y>=r.y?Pi.NW:Pi.SW}};$A.NE.get=function(){return 0};$A.NW.get=function(){return 1};$A.SW.get=function(){return 2};$A.SE.get=function(){return 3};Object.defineProperties(Pi,$A);var Ys=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=null;this._edge=n,this.init(r,o),this._label=a}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this._edge=s,this.init(u,l),this._label=c}};Ys.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:He.computeOrientation(t._p0,t._p1,this._p1)};Ys.prototype.getDy=function(){return this._dy};Ys.prototype.getCoordinate=function(){return this._p0};Ys.prototype.setNode=function(t){this._node=t};Ys.prototype.print=function(t){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),o=r.lastIndexOf("."),a=r.substring(o+1);t.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Ys.prototype.compareTo=function(t){var n=t;return this.compareDirection(n)};Ys.prototype.getDirectedCoordinate=function(){return this._p1};Ys.prototype.getDx=function(){return this._dx};Ys.prototype.getLabel=function(){return this._label};Ys.prototype.getEdge=function(){return this._edge};Ys.prototype.getQuadrant=function(){return this._quadrant};Ys.prototype.getNode=function(){return this._node};Ys.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),o=n.substring(r+1);return"  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Ys.prototype.computeLabel=function(t){};Ys.prototype.init=function(t,n){this._p0=t,this._p1=n,this._dx=n.x-t.x,this._dy=n.y-t.y,this._quadrant=Pi.quadrant(this._dx,this._dy),an.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Ys.prototype.interfaces_=function(){return[Gc]};Ys.prototype.getClass=function(){return Ys};var A4=function(e){function t(){var n=arguments[0],r=arguments[1];if(e.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var o=n.getNumPoints()-1;this.init(n.getCoordinate(o),n.getCoordinate(o-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new oi(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,o){if(this._depth[r]!==-999&&this._depth[r]!==o)throw new im("assigned depths do not match",this.getCoordinate());this._depth[r]=o},t.prototype.isInteriorAreaEdge=function(){for(var r=this,o=!0,a=0;a<2;a++)r._label.isArea(a)&&r._label.getLocation(a,Me.LEFT)===he.INTERIOR&&r._label.getLocation(a,Me.RIGHT)===he.INTERIOR||(o=!1);return o},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){e.prototype.print.call(this,r),r.print(" "+this._depth[Me.LEFT]+"/"+this._depth[Me.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,he.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,he.EXTERIOR);return r&&o&&a},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,o){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var s=1;r===Me.LEFT&&(s=-1);var u=Me.opposite(r),l=a*s,c=o+l;this.setDepth(r,o),this.setDepth(u,c)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,o){return r===he.EXTERIOR&&o===he.INTERIOR?1:r===he.INTERIOR&&o===he.EXTERIOR?-1:0},t}(Ys),H1=function(){};H1.prototype.createNode=function(t){return new IR(t,null)};H1.prototype.interfaces_=function(){return[]};H1.prototype.getClass=function(){return H1};var Ao=function(){if(this._edges=new Fe,this._nodes=null,this._edgeEndList=new Fe,arguments.length===0)this._nodes=new zh(new H1);else if(arguments.length===1){var t=arguments[0];this._nodes=new zh(t)}};Ao.prototype.printEdges=function(t){var n=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var o=n._edges.get(r);o.print(t),o.eiList.print(t)}};Ao.prototype.find=function(t){return this._nodes.find(t)};Ao.prototype.addNode=function(){if(arguments[0]instanceof IR){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof ae){var n=arguments[0];return this._nodes.addNode(n)}};Ao.prototype.getNodeIterator=function(){return this._nodes.iterator()};Ao.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}};Ao.prototype.debugPrintln=function(t){Ss.out.println(t)};Ao.prototype.isBoundaryNode=function(t,n){var r=this._nodes.find(n);if(r===null)return!1;var o=r.getLabel();return o!==null&&o.getLocation(t)===he.BOUNDARY};Ao.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}};Ao.prototype.matchInSameDirection=function(t,n,r,o){return t.equals(r)?He.computeOrientation(t,n,o)===He.COLLINEAR&&Pi.quadrant(t,n)===Pi.quadrant(r,o):!1};Ao.prototype.getEdgeEnds=function(){return this._edgeEndList};Ao.prototype.debugPrint=function(t){Ss.out.print(t)};Ao.prototype.getEdgeIterator=function(){return this._edges.iterator()};Ao.prototype.findEdgeInSameDirection=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(r.matchInSameDirection(t,n,s[0],s[1])||r.matchInSameDirection(t,n,s[s.length-1],s[s.length-2]))return a}return null};Ao.prototype.insertEdge=function(t){this._edges.add(t)};Ao.prototype.findEdgeEnd=function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===t)return r}return null};Ao.prototype.addEdges=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();n._edges.add(o);var a=new A4(o,!0),s=new A4(o,!1);a.setSym(s),s.setSym(a),n.add(a),n.add(s)}};Ao.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};Ao.prototype.getNodes=function(){return this._nodes.values()};Ao.prototype.findEdge=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(t.equals(s[0])&&n.equals(s[1]))return a}return null};Ao.prototype.interfaces_=function(){return[]};Ao.prototype.getClass=function(){return Ao};Ao.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var Dl=function(){this._geometryFactory=null,this._shellList=new Fe;var t=arguments[0];this._geometryFactory=t};Dl.prototype.sortShellsAndHoles=function(t,n,r){for(var o=t.iterator();o.hasNext();){var a=o.next();a.isHole()?r.add(a):n.add(a)}};Dl.prototype.computePolygons=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=a.toPolygon(n._geometryFactory);r.add(s)}return r};Dl.prototype.placeFreeHoles=function(t,n){for(var r=this,o=n.iterator();o.hasNext();){var a=o.next();if(a.getShell()===null){var s=r.findEdgeRingContaining(a,t);if(s===null)throw new im("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(s)}}};Dl.prototype.buildMinimalEdgeRings=function(t,n,r){for(var o=this,a=new Fe,s=t.iterator();s.hasNext();){var u=s.next();if(u.getMaxNodeDegree()>2){u.linkDirectedEdgesForMinimalEdgeRings();var l=u.buildMinimalRings(),c=o.findShell(l);c!==null?(o.placePolygonHoles(c,l),n.add(c)):r.addAll(l)}else a.add(u)}return a};Dl.prototype.containsPoint=function(t){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(t))return!0}return!1};Dl.prototype.buildMaximalEdgeRings=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var s=new YFe(a,n._geometryFactory);r.add(s),s.setInResult()}}return r};Dl.prototype.placePolygonHoles=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next();o.isHole()&&o.setShell(t)}};Dl.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};Dl.prototype.findEdgeRingContaining=function(t,n){for(var r=t.getLinearRing(),o=r.getEnvelopeInternal(),a=r.getCoordinateN(0),s=null,u=null,l=n.iterator();l.hasNext();){var c=l.next(),f=c.getLinearRing(),h=f.getEnvelopeInternal();s!==null&&(u=s.getLinearRing().getEnvelopeInternal());var d=!1;h.contains(o)&&He.isPointInRing(a,f.getCoordinates())&&(d=!0),d&&(s===null||u.contains(h))&&(s=c)}return s};Dl.prototype.findShell=function(t){for(var n=0,r=null,o=t.iterator();o.hasNext();){var a=o.next();a.isHole()||(r=a,n++)}return an.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};Dl.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];Ao.linkResultDirectedEdges(r);var o=this.buildMaximalEdgeRings(n),a=new Fe,s=this.buildMinimalEdgeRings(o,this._shellList,a);this.sortShellsAndHoles(s,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};Dl.prototype.interfaces_=function(){return[]};Dl.prototype.getClass=function(){return Dl};var q1=function(){};q1.prototype.getBounds=function(){};q1.prototype.interfaces_=function(){return[]};q1.prototype.getClass=function(){return q1};var Sf=function(){this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n};Sf.prototype.getItem=function(){return this._item};Sf.prototype.getBounds=function(){return this._bounds};Sf.prototype.interfaces_=function(){return[q1,Uc]};Sf.prototype.getClass=function(){return Sf};var om=function(){this._size=null,this._items=null,this._size=0,this._items=new Fe,this._items.add(null)};om.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};om.prototype.size=function(){return this._size};om.prototype.reorder=function(t){for(var n=this,r=null,o=this._items.get(t);t*2<=this._size&&(r=t*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(o)<0);t=r)n._items.set(t,n._items.get(r));this._items.set(t,o)};om.prototype.clear=function(){this._size=0,this._items.clear()};om.prototype.isEmpty=function(){return this._size===0};om.prototype.add=function(t){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,t)};om.prototype.interfaces_=function(){return[]};om.prototype.getClass=function(){return om};var Ig=function(){};Ig.prototype.visitItem=function(t){};Ig.prototype.interfaces_=function(){return[]};Ig.prototype.getClass=function(){return Ig};var Cv=function(){};Cv.prototype.insert=function(t,n){};Cv.prototype.remove=function(t,n){};Cv.prototype.query=function(){};Cv.prototype.interfaces_=function(){return[]};Cv.prototype.getClass=function(){return Cv};var Ia=function(){if(this._childBoundables=new Fe,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},Jre={serialVersionUID:{configurable:!0}};Ia.prototype.getLevel=function(){return this._level};Ia.prototype.size=function(){return this._childBoundables.size()};Ia.prototype.getChildBoundables=function(){return this._childBoundables};Ia.prototype.addChildBoundable=function(t){an.isTrue(this._bounds===null),this._childBoundables.add(t)};Ia.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Ia.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Ia.prototype.interfaces_=function(){return[q1,Uc]};Ia.prototype.getClass=function(){return Ia};Jre.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Ia,Jre);var Af=function(){};Af.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};Af.min=function(t){return Af.sort(t),t.get(0)};Af.sort=function(t,n){var r=t.toArray();n?t_.sort(r,n):t_.sort(r);for(var o=t.iterator(),a=0,s=r.length;a<s;a++)o.next(),o.set(r[a])};Af.singletonList=function(t){var n=new Fe;return n.add(t),n};var ca=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};ca.prototype.expandToQueue=function(t,n){var r=ca.isComposite(this._boundable1),o=ca.isComposite(this._boundable2);if(r&&o)return ca.area(this._boundable1)>ca.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,t,n),null;if(o)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new ho("neither boundable is composite")};ca.prototype.isLeaves=function(){return!(ca.isComposite(this._boundable1)||ca.isComposite(this._boundable2))};ca.prototype.compareTo=function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0};ca.prototype.expand=function(t,n,r,o){for(var a=this,s=t.getChildBoundables(),u=s.iterator();u.hasNext();){var l=u.next(),c=new ca(l,n,a._itemDistance);c.getDistance()<o&&r.add(c)}};ca.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};ca.prototype.getDistance=function(){return this._distance};ca.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};ca.prototype.interfaces_=function(){return[Gc]};ca.prototype.getClass=function(){return ca};ca.area=function(t){return t.getBounds().getArea()};ca.isComposite=function(t){return t instanceof Ia};var es=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Fe,this._nodeCapacity=null,arguments.length===0){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var n=arguments[0];an.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},DR={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};es.prototype.getNodeCapacity=function(){return this._nodeCapacity};es.prototype.lastNode=function(t){return t.get(t.size()-1)};es.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Ia?r+=t.size(a):a instanceof Sf&&(r+=1)}return r}};es.prototype.removeItem=function(t,n){for(var r=null,o=t.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Sf&&a.getItem()===n&&(r=a)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};es.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new Fe:n}else if(arguments.length===1){for(var r=arguments[0],o=new Fe,a=r.getChildBoundables().iterator();a.hasNext();){var s=a.next();if(s instanceof Ia){var u=t.itemsTree(s);u!==null&&o.add(u)}else s instanceof Sf?o.add(s.getItem()):an.shouldNeverReachHere()}return o.size()<=0?null:o}};es.prototype.insert=function(t,n){an.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Sf(t,n))};es.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var n=arguments[0],r=new Fe;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(an.isTrue(o>-2),a.getLevel()===o)return s.add(a),null;for(var u=a.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof Ia?t.boundablesAtLevel(o,l,s):(an.isTrue(l instanceof Sf),o===-1&&s.add(l))}return null}};es.prototype.query=function(){var t=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new Fe;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var o=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,a)}else if(arguments.length===3){if(Ot(arguments[2],Ig)&&arguments[0]instanceof Object&&arguments[1]instanceof Ia)for(var s=arguments[0],u=arguments[1],l=arguments[2],c=u.getChildBoundables(),f=0;f<c.size();f++){var h=c.get(f);!t.getIntersectsOp().intersects(h.getBounds(),s)||(h instanceof Ia?t.query(s,h,l):h instanceof Sf?l.visitItem(h.getItem()):an.shouldNeverReachHere())}else if(Ot(arguments[2],wf)&&arguments[0]instanceof Object&&arguments[1]instanceof Ia)for(var d=arguments[0],p=arguments[1],_=arguments[2],y=p.getChildBoundables(),v=0;v<y.size();v++){var w=y.get(v);!t.getIntersectsOp().intersects(w.getBounds(),d)||(w instanceof Ia?t.query(d,w,_):w instanceof Sf?_.add(w.getItem()):an.shouldNeverReachHere())}}};es.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};es.prototype.getRoot=function(){return this.build(),this._root};es.prototype.remove=function(){var t=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=this.removeItem(a,s);if(u)return!0;for(var l=null,c=a.getChildBoundables().iterator();c.hasNext();){var f=c.next();if(!!t.getIntersectsOp().intersects(f.getBounds(),o)&&f instanceof Ia&&(u=t.remove(o,f,s),u)){l=f;break}}return l!==null&&l.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(l),u}};es.prototype.createHigherLevels=function(t,n){an.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};es.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();if(a instanceof Ia){var s=t.depth(a);s>r&&(r=s)}}return r+1}};es.prototype.createParentBoundables=function(t,n){var r=this;an.isTrue(!t.isEmpty());var o=new Fe;o.add(this.createNode(n));var a=new Fe(t);Af.sort(a,this.getComparator());for(var s=a.iterator();s.hasNext();){var u=s.next();r.lastNode(o).getChildBoundables().size()===r.getNodeCapacity()&&o.add(r.createNode(n)),r.lastNode(o).addChildBoundable(u)}return o};es.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};es.prototype.interfaces_=function(){return[Uc]};es.prototype.getClass=function(){return es};es.compareDoubles=function(t,n){return t>n?1:t<n?-1:0};DR.IntersectsOp.get=function(){return XFe};DR.serialVersionUID.get=function(){return-3886435814360241e3};DR.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(es,DR);var XFe=function(){},W1=function(){};W1.prototype.distance=function(t,n){};W1.prototype.interfaces_=function(){return[]};W1.prototype.getClass=function(){return W1};var $re=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(o,a){var s=this;an.isTrue(o.length>0);for(var u=new Fe,l=0;l<o.length;l++)u.addAll(s.createParentBoundablesFromVerticalSlice(o[l],a));return u},t.prototype.createNode=function(o){return new ane(o)},t.prototype.size=function(){return arguments.length===0?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];if(o.isNull())return null;e.prototype.insert.call(this,o,a)}else return e.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(o,a){for(var s=Math.trunc(Math.ceil(o.size()/a)),u=new Array(a).fill(null),l=o.iterator(),c=0;c<a;c++){u[c]=new Fe;for(var f=0;l.hasNext()&&f<s;){var h=l.next();u[c].add(h),f++}}return u},t.prototype.query=function(){if(arguments.length===1){var o=arguments[0];return e.prototype.query.call(this,o)}else if(arguments.length===2){var a=arguments[0],s=arguments[1];e.prototype.query.call(this,a,s)}else if(arguments.length===3){if(Ot(arguments[2],Ig)&&arguments[0]instanceof Object&&arguments[1]instanceof Ia){var u=arguments[0],l=arguments[1],c=arguments[2];e.prototype.query.call(this,u,l,c)}else if(Ot(arguments[2],wf)&&arguments[0]instanceof Object&&arguments[1]instanceof Ia){var f=arguments[0],h=arguments[1],d=arguments[2];e.prototype.query.call(this,f,h,d)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(o,a){return e.prototype.createParentBoundables.call(this,o,a)},t.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return e.prototype.remove.call(this,o,a)}else return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(o,a){an.isTrue(!o.isEmpty());var s=Math.trunc(Math.ceil(o.size()/this.getNodeCapacity())),u=new Fe(o);Af.sort(u,t.xComparator);var l=this.verticalSlices(u,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(l,a)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Ot(arguments[0],W1)){var o=arguments[0],a=new ca(this.getRoot(),this.getRoot(),o);return this.nearestNeighbour(a)}else if(arguments[0]instanceof ca){var s=arguments[0];return this.nearestNeighbour(s,Qt.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Ot(arguments[1],W1)){var u=arguments[0],l=arguments[1],c=new ca(this.getRoot(),u.getRoot(),l);return this.nearestNeighbour(c)}else if(arguments[0]instanceof ca&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=h,p=null,_=new om;for(_.add(f);!_.isEmpty()&&d>0;){var y=_.poll(),v=y.getDistance();if(v>=d)break;y.isLeaves()?(d=v,p=y):y.expandToQueue(_,d)}return[p.getBoundable(0).getItem(),p.getBoundable(1).getItem()]}}else if(arguments.length===3){var w=arguments[0],C=arguments[1],E=arguments[2],S=new Sf(w,C),A=new ca(this.getRoot(),S,E);return this.nearestNeighbour(A)[0]}},t.prototype.interfaces_=function(){return[Cv,Uc]},t.prototype.getClass=function(){return t},t.centreX=function(o){return t.avg(o.getMinX(),o.getMaxX())},t.avg=function(o,a){return(o+a)/2},t.centreY=function(o){return t.avg(o.getMinY(),o.getMaxY())},n.STRtreeNode.get=function(){return ane},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[N1]},compare:function(r,o){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(o.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[N1]},compare:function(r,o){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(o.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(r,o){return r.intersects(o)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,n),t}(es),ane=function(e){function t(){var n=arguments[0];e.call(this,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,o=this.getChildBoundables().iterator();o.hasNext();){var a=o.next();r===null?r=new ct(a.getBounds()):r.expandToInclude(a.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ia),Yu=function(){};Yu.prototype.interfaces_=function(){return[]};Yu.prototype.getClass=function(){return Yu};Yu.relativeSign=function(t,n){return t<n?-1:t>n?1:0};Yu.compare=function(t,n,r){if(n.equals2D(r))return 0;var o=Yu.relativeSign(n.x,r.x),a=Yu.relativeSign(n.y,r.y);switch(t){case 0:return Yu.compareValue(o,a);case 1:return Yu.compareValue(a,o);case 2:return Yu.compareValue(a,-o);case 3:return Yu.compareValue(-o,a);case 4:return Yu.compareValue(-o,-a);case 5:return Yu.compareValue(-a,-o);case 6:return Yu.compareValue(-a,o);case 7:return Yu.compareValue(o,-a);default:}return an.shouldNeverReachHere("invalid octant value"),0};Yu.compareValue=function(t,n){return t<0?-1:t>0?1:n<0?-1:n>0?1:0};var Dg=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._segString=t,this.coord=new ae(n),this.segmentIndex=r,this._segmentOctant=o,this._isInterior=!n.equals2D(t.getCoordinate(r))};Dg.prototype.getCoordinate=function(){return this.coord};Dg.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Dg.prototype.compareTo=function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Yu.compare(this._segmentOctant,this.coord,n.coord)};Dg.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Dg.prototype.isInterior=function(){return this._isInterior};Dg.prototype.interfaces_=function(){return[Gc]};Dg.prototype.getClass=function(){return Dg};var Iu=function(){this._nodeMap=new Ws,this._edge=null;var t=arguments[0];this._edge=t};Iu.prototype.getSplitCoordinates=function(){var t=this,n=new ZA;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next();t.addEdgeCoordinates(o,a,n),o=a}return n.toCoordinateArray()};Iu.prototype.addCollapsedNodes=function(){var t=this,n=new Fe;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var o=r.next().intValue();t.add(t._edge.getCoordinate(o),o)}};Iu.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Iu.prototype.findCollapsesFromExistingVertices=function(t){for(var n=this,r=0;r<this._edge.size()-2;r++){var o=n._edge.getCoordinate(r),a=n._edge.getCoordinate(r+2);o.equals2D(a)&&t.add(new Rh(r+1))}};Iu.prototype.addEdgeCoordinates=function(t,n,r){var o=this,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);r.add(new ae(t.coord),!1);for(var u=t.segmentIndex+1;u<=n.segmentIndex;u++)r.add(o._edge.getCoordinate(u));s&&r.add(new ae(n.coord))};Iu.prototype.iterator=function(){return this._nodeMap.values().iterator()};Iu.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};Iu.prototype.findCollapseIndex=function(t,n,r){if(!t.coord.equals2D(n.coord))return!1;var o=n.segmentIndex-t.segmentIndex;return n.isInterior()||o--,o===1?(r[0]=t.segmentIndex+1,!0):!1};Iu.prototype.findCollapsesFromInsertedNodes=function(t){for(var n=this,r=new Array(1).fill(null),o=this.iterator(),a=o.next();o.hasNext();){var s=o.next(),u=n.findCollapseIndex(a,s,r);u&&t.add(new Rh(r[0])),a=s}};Iu.prototype.getEdge=function(){return this._edge};Iu.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};Iu.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new ae(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r._edge.getCoordinate(c);return s&&(u[l]=new ae(n.coord)),new Qo(u,this._edge.getData())};Iu.prototype.add=function(t,n){var r=new Dg(this._edge,t,n,this._edge.getSegmentOctant(n)),o=this._nodeMap.get(r);return o!==null?(an.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(r,r),r)};Iu.prototype.checkSplitEdgesCorrectness=function(t){var n=this._edge.getCoordinates(),r=t.get(0),o=r.getCoordinate(0);if(!o.equals2D(n[0]))throw new nm("bad split edge start point at "+o);var a=t.get(t.size()-1),s=a.getCoordinates(),u=s[s.length-1];if(!u.equals2D(n[n.length-1]))throw new nm("bad split edge end point at "+u)};Iu.prototype.interfaces_=function(){return[]};Iu.prototype.getClass=function(){return Iu};var xv=function(){};xv.prototype.interfaces_=function(){return[]};xv.prototype.getClass=function(){return xv};xv.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new ho("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),o=Math.abs(n);return t>=0?n>=0?r>=o?0:1:r>=o?7:6:n>=0?r>=o?3:2:r>=o?4:5}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var a=arguments[0],s=arguments[1],u=s.x-a.x,l=s.y-a.y;if(u===0&&l===0)throw new ho("Cannot compute the octant for two identical points "+a);return xv.octant(u,l)}};var zd=function(){};zd.prototype.getCoordinates=function(){};zd.prototype.size=function(){};zd.prototype.getCoordinate=function(t){};zd.prototype.isClosed=function(){};zd.prototype.setData=function(t){};zd.prototype.getData=function(){};zd.prototype.interfaces_=function(){return[]};zd.prototype.getClass=function(){return zd};var NA=function(){};NA.prototype.addIntersection=function(t,n){};NA.prototype.interfaces_=function(){return[zd]};NA.prototype.getClass=function(){return NA};var Qo=function(){this._nodeList=new Iu(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};Qo.prototype.getCoordinates=function(){return this._pts};Qo.prototype.size=function(){return this._pts.length};Qo.prototype.getCoordinate=function(t){return this._pts[t]};Qo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Qo.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};Qo.prototype.setData=function(t){this._data=t};Qo.prototype.safeOctant=function(t,n){return t.equals2D(n)?0:xv.octant(t,n)};Qo.prototype.getData=function(){return this._data};Qo.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[3],s=new ae(r.getIntersection(a));this.addIntersection(s,o)}};Qo.prototype.toString=function(){return Ef.toLineString(new jo(this._pts))};Qo.prototype.getNodeList=function(){return this._nodeList};Qo.prototype.addIntersectionNode=function(t,n){var r=n,o=r+1;if(o<this._pts.length){var a=this._pts[o];t.equals2D(a)&&(r=o)}var s=this._nodeList.add(t,r);return s};Qo.prototype.addIntersections=function(t,n,r){for(var o=this,a=0;a<t.getIntersectionNum();a++)o.addIntersection(t,n,r,a)};Qo.prototype.interfaces_=function(){return[NA]};Qo.prototype.getClass=function(){return Qo};Qo.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new Fe;return Qo.getNodedSubstrings(t,n),n}else if(arguments.length===2)for(var r=arguments[0],o=arguments[1],a=r.iterator();a.hasNext();){var s=a.next();s.getNodeList().addSplitEdges(o)}};var dt=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new ae,this.p1=new ae;else if(arguments.length===1){var t=arguments[0];this.p0=new ae(t.p0),this.p1=new ae(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3];this.p0=new ae(n,r),this.p1=new ae(o,a)}},eie={serialVersionUID:{configurable:!0}};dt.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};dt.prototype.orientationIndex=function(){if(arguments[0]instanceof dt){var t=arguments[0],n=He.orientationIndex(this.p0,this.p1,t.p0),r=He.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof ae){var o=arguments[0];return He.orientationIndex(this.p0,this.p1,o)}};dt.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};dt.prototype.isVertical=function(){return this.p0.x===this.p1.x};dt.prototype.equals=function(t){if(!(t instanceof dt))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};dt.prototype.intersection=function(t){var n=new m_;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null};dt.prototype.project=function(){if(arguments[0]instanceof ae){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new ae(t);var n=this.projectionFactor(t),r=new ae;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof dt){var o=arguments[0],a=this.projectionFactor(o.p0),s=this.projectionFactor(o.p1);if(a>=1&&s>=1||a<=0&&s<=0)return null;var u=this.project(o.p0);a<0&&(u=this.p0),a>1&&(u=this.p1);var l=this.project(o.p1);return s<0&&(l=this.p0),s>1&&(l=this.p1),new dt(u,l)}};dt.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};dt.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};dt.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};dt.prototype.distancePerpendicular=function(t){return He.distancePointLinePerpendicular(t,this.p0,this.p1)};dt.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};dt.prototype.midPoint=function(){return dt.midPoint(this.p0,this.p1)};dt.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,o=n*n+r*r;if(o<=0)return Qt.NaN;var a=((t.x-this.p0.x)*n+(t.y-this.p0.y)*r)/o;return a};dt.prototype.closestPoints=function(t){var n=this.intersection(t);if(n!==null)return[n,n];var r=new Array(2).fill(null),o=Qt.MAX_VALUE,a=null,s=this.closestPoint(t.p0);o=s.distance(t.p0),r[0]=s,r[1]=t.p0;var u=this.closestPoint(t.p1);a=u.distance(t.p1),a<o&&(o=a,r[0]=u,r[1]=t.p1);var l=t.closestPoint(this.p0);a=l.distance(this.p0),a<o&&(o=a,r[0]=this.p0,r[1]=l);var c=t.closestPoint(this.p1);return a=c.distance(this.p1),a<o&&(o=a,r[0]=this.p1,r[1]=c),r};dt.prototype.closestPoint=function(t){var n=this.projectionFactor(t);if(n>0&&n<1)return this.project(t);var r=this.p0.distance(t),o=this.p1.distance(t);return r<o?this.p0:this.p1};dt.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};dt.prototype.getLength=function(){return this.p0.distance(this.p1)};dt.prototype.compareTo=function(t){var n=t,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};dt.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};dt.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};dt.prototype.lineIntersection=function(t){try{var n=xf.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(r){if(!(r instanceof ow))throw r}finally{}return null};dt.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};dt.prototype.pointAlongOffset=function(t,n){var r=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,u=Math.sqrt(a*a+s*s),l=0,c=0;if(n!==0){if(u<=0)throw new Error("Cannot compute offset from zero-length line segment");l=n*a/u,c=n*s/u}var f=r-c,h=o+l,d=new ae(f,h);return d};dt.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};dt.prototype.segmentFraction=function(t){var n=this.projectionFactor(t);return n<0?n=0:(n>1||Qt.isNaN(n))&&(n=1),n};dt.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};dt.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};dt.prototype.distance=function(){if(arguments[0]instanceof dt){var t=arguments[0];return He.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof ae){var n=arguments[0];return He.distancePointLine(n,this.p0,this.p1)}};dt.prototype.pointAlong=function(t){var n=new ae;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n};dt.prototype.hashCode=function(){var t=Qt.doubleToLongBits(this.p0.x);t^=Qt.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(t)^Math.trunc(t>>32),r=Qt.doubleToLongBits(this.p1.x);r^=Qt.doubleToLongBits(this.p1.y)*31;var o=Math.trunc(r)^Math.trunc(r>>32);return n^o};dt.prototype.interfaces_=function(){return[Gc,Uc]};dt.prototype.getClass=function(){return dt};dt.midPoint=function(t,n){return new ae((t.x+n.x)/2,(t.y+n.y)/2)};eie.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(dt,eie);var BA=function(){this.tempEnv1=new ct,this.tempEnv2=new ct,this._overlapSeg1=new dt,this._overlapSeg2=new dt};BA.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];t.getLineSegment(n,this._overlapSeg1),r.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};BA.prototype.interfaces_=function(){return[]};BA.prototype.getClass=function(){return BA};var Pl=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._pts=t,this._start=n,this._end=r,this._context=o};Pl.prototype.getLineSegment=function(t,n){n.p0=this._pts[t],n.p1=this._pts[t+1]};Pl.prototype.computeSelect=function(t,n,r,o){var a=this._pts[n],s=this._pts[r];if(o.tempEnv1.init(a,s),r-n===1)return o.select(this,n),null;if(!t.intersects(o.tempEnv1))return null;var u=Math.trunc((n+r)/2);n<u&&this.computeSelect(t,n,u,o),u<r&&this.computeSelect(t,u,r,o)};Pl.prototype.getCoordinates=function(){for(var t=this,n=new Array(this._end-this._start+1).fill(null),r=0,o=this._start;o<=this._end;o++)n[r++]=t._pts[o];return n};Pl.prototype.computeOverlaps=function(t,n){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,n)};Pl.prototype.setId=function(t){this._id=t};Pl.prototype.select=function(t,n){this.computeSelect(t,this._start,this._end,n)};Pl.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],n=this._pts[this._end];this._env=new ct(t,n)}return this._env};Pl.prototype.getEndIndex=function(){return this._end};Pl.prototype.getStartIndex=function(){return this._start};Pl.prototype.getContext=function(){return this._context};Pl.prototype.getId=function(){return this._id};Pl.prototype.computeOverlapsInternal=function(t,n,r,o,a,s){var u=this._pts[t],l=this._pts[n],c=r._pts[o],f=r._pts[a];if(n-t===1&&a-o===1)return s.overlap(this,t,r,o),null;if(s.tempEnv1.init(u,l),s.tempEnv2.init(c,f),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((t+n)/2),d=Math.trunc((o+a)/2);t<h&&(o<d&&this.computeOverlapsInternal(t,h,r,o,d,s),d<a&&this.computeOverlapsInternal(t,h,r,d,a,s)),h<n&&(o<d&&this.computeOverlapsInternal(h,n,r,o,d,s),d<a&&this.computeOverlapsInternal(h,n,r,d,a,s))};Pl.prototype.interfaces_=function(){return[]};Pl.prototype.getClass=function(){return Pl};var Lh=function(){};Lh.prototype.interfaces_=function(){return[]};Lh.prototype.getClass=function(){return Lh};Lh.getChainStartIndices=function(t){var n=0,r=new Fe;r.add(new Rh(n));do{var o=Lh.findChainEnd(t,n);r.add(new Rh(o)),n=o}while(n<t.length-1);var a=Lh.toIntArray(r);return a};Lh.findChainEnd=function(t,n){for(var r=n;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var o=Pi.quadrant(t[r],t[r+1]),a=n+1;a<t.length;){if(!t[a-1].equals2D(t[a])){var s=Pi.quadrant(t[a-1],t[a]);if(s!==o)break}a++}return a-1};Lh.getChains=function(){if(arguments.length===1){var t=arguments[0];return Lh.getChains(t,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],o=new Fe,a=Lh.getChainStartIndices(n),s=0;s<a.length-1;s++){var u=new Pl(n,a[s],a[s+1],r);o.add(u)}return o}};Lh.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var a_=function(){};a_.prototype.computeNodes=function(t){};a_.prototype.getNodedSubstrings=function(){};a_.prototype.interfaces_=function(){return[]};a_.prototype.getClass=function(){return a_};var FA=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};FA.prototype.setSegmentIntersector=function(t){this._segInt=t};FA.prototype.interfaces_=function(){return[a_]};FA.prototype.getClass=function(){return FA};var mV=function(e){function t(r){r?e.call(this,r):e.call(this),this._monoChains=new Fe,this._index=new $re,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Qo.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(o){for(var a=this,s=Lh.getChains(o.getCoordinates(),o),u=s.iterator();u.hasNext();){var l=u.next();l.setId(a._idCounter++),a._index.insert(l.getEnvelope(),l),a._monoChains.add(l)}},t.prototype.computeNodes=function(o){var a=this;this._nodedSegStrings=o;for(var s=o.iterator();s.hasNext();)a.add(s.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var o=this,a=new sne(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var u=s.next(),l=o._index.query(u.getEnvelope()),c=l.iterator();c.hasNext();){var f=c.next();if(f.getId()>u.getId()&&(u.computeOverlaps(f,a),o._nOverlaps++),o._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return sne},Object.defineProperties(t,n),t}(FA),sne=function(e){function t(){e.call(this),this._si=null;var n=arguments[0];this._si=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=r.getContext(),l=a.getContext();this._si.processIntersections(u,o,l,s)}else return e.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(BA),Wr=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(a),this.setJoinStyle(s),this.setMitreLimit(u)}}},cm={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Wr.prototype.getEndCapStyle=function(){return this._endCapStyle};Wr.prototype.isSingleSided=function(){return this._isSingleSided};Wr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=Wr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Wr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Wr.JOIN_ROUND&&(this._quadrantSegments=Wr.DEFAULT_QUADRANT_SEGMENTS)};Wr.prototype.getJoinStyle=function(){return this._joinStyle};Wr.prototype.setJoinStyle=function(t){this._joinStyle=t};Wr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};Wr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Wr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Wr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};Wr.prototype.getMitreLimit=function(){return this._mitreLimit};Wr.prototype.setMitreLimit=function(t){this._mitreLimit=t};Wr.prototype.setSingleSided=function(t){this._isSingleSided=t};Wr.prototype.interfaces_=function(){return[]};Wr.prototype.getClass=function(){return Wr};Wr.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)};cm.CAP_ROUND.get=function(){return 1};cm.CAP_FLAT.get=function(){return 2};cm.CAP_SQUARE.get=function(){return 3};cm.JOIN_ROUND.get=function(){return 1};cm.JOIN_MITRE.get=function(){return 2};cm.JOIN_BEVEL.get=function(){return 3};cm.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};cm.DEFAULT_MITRE_LIMIT.get=function(){return 5};cm.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Wr,cm);var No=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=He.COUNTERCLOCKWISE,this._inputLine=t||null},eb={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};No.prototype.isDeletable=function(t,n,r,o){var a=this._inputLine[t],s=this._inputLine[n],u=this._inputLine[r];return!this.isConcave(a,s,u)||!this.isShallow(a,s,u,o)?!1:this.isShallowSampled(a,s,t,r,o)};No.prototype.deleteShallowConcavities=function(){for(var t=this,n=1,r=this.findNextNonDeletedIndex(n),o=this.findNextNonDeletedIndex(r),a=!1;o<this._inputLine.length;){var s=!1;t.isDeletable(n,r,o,t._distanceTol)&&(t._isDeleted[r]=No.DELETE,s=!0,a=!0),s?n=o:n=r,r=t.findNextNonDeletedIndex(n),o=t.findNextNonDeletedIndex(r)}return a};No.prototype.isShallowConcavity=function(t,n,r,o){var a=He.computeOrientation(t,n,r),s=a===this._angleOrientation;if(!s)return!1;var u=He.distancePointLine(n,t,r);return u<o};No.prototype.isShallowSampled=function(t,n,r,o,a){var s=this,u=Math.trunc((o-r)/No.NUM_PTS_TO_CHECK);u<=0&&(u=1);for(var l=r;l<o;l+=u)if(!s.isShallow(t,n,s._inputLine[l],a))return!1;return!0};No.prototype.isConcave=function(t,n,r){var o=He.computeOrientation(t,n,r),a=o===this._angleOrientation;return a};No.prototype.simplify=function(t){var n=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=He.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};No.prototype.findNextNonDeletedIndex=function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===No.DELETE;)n++;return n};No.prototype.isShallow=function(t,n,r,o){var a=He.distancePointLine(n,t,r);return a<o};No.prototype.collapseLine=function(){for(var t=this,n=new ZA,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==No.DELETE&&n.add(t._inputLine[r]);return n.toCoordinateArray()};No.prototype.interfaces_=function(){return[]};No.prototype.getClass=function(){return No};No.simplify=function(t,n){var r=new No(t);return r.simplify(n)};eb.INIT.get=function(){return 0};eb.DELETE.get=function(){return 1};eb.KEEP.get=function(){return 1};eb.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(No,eb);var sc=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Fe},tie={COORDINATE_ARRAY_TYPE:{configurable:!0}};sc.prototype.getCoordinates=function(){var t=this._ptList.toArray(sc.COORDINATE_ARRAY_TYPE);return t};sc.prototype.setPrecisionModel=function(t){this._precisionModel=t};sc.prototype.addPt=function(t){var n=new ae(t);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};sc.prototype.revere=function(){};sc.prototype.addPts=function(t,n){var r=this;if(n)for(var o=0;o<t.length;o++)r.addPt(t[o]);else for(var a=t.length-1;a>=0;a--)r.addPt(t[a])};sc.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=t.distance(n);return r<this._minimimVertexDistance};sc.prototype.toString=function(){var t=new mn,n=t.createLineString(this.getCoordinates());return n.toString()};sc.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new ae(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(t.equals(n))return null;this._ptList.add(t)};sc.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};sc.prototype.interfaces_=function(){return[]};sc.prototype.getClass=function(){return sc};tie.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(sc,tie);var wn=function(){},Ov={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};wn.prototype.interfaces_=function(){return[]};wn.prototype.getClass=function(){return wn};wn.toDegrees=function(t){return t*180/Math.PI};wn.normalize=function(t){for(;t>Math.PI;)t-=wn.PI_TIMES_2;for(;t<=-Math.PI;)t+=wn.PI_TIMES_2;return t};wn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=r.x-n.x,a=r.y-n.y;return Math.atan2(a,o)}};wn.isAcute=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l>0};wn.isObtuse=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l<0};wn.interiorAngle=function(t,n,r){var o=wn.angle(n,t),a=wn.angle(n,r);return Math.abs(a-o)};wn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=wn.PI_TIMES_2;t>=wn.PI_TIMES_2&&(t=0)}else{for(;t>=wn.PI_TIMES_2;)t-=wn.PI_TIMES_2;t<0&&(t=0)}return t};wn.angleBetween=function(t,n,r){var o=wn.angle(n,t),a=wn.angle(n,r);return wn.diff(o,a)};wn.diff=function(t,n){var r=null;return t<n?r=n-t:r=t-n,r>Math.PI&&(r=2*Math.PI-r),r};wn.toRadians=function(t){return t*Math.PI/180};wn.getTurn=function(t,n){var r=Math.sin(n-t);return r>0?wn.COUNTERCLOCKWISE:r<0?wn.CLOCKWISE:wn.NONE};wn.angleBetweenOriented=function(t,n,r){var o=wn.angle(n,t),a=wn.angle(n,r),s=a-o;return s<=-Math.PI?s+wn.PI_TIMES_2:s>Math.PI?s-wn.PI_TIMES_2:s};Ov.PI_TIMES_2.get=function(){return 2*Math.PI};Ov.PI_OVER_2.get=function(){return Math.PI/2};Ov.PI_OVER_4.get=function(){return Math.PI/4};Ov.COUNTERCLOCKWISE.get=function(){return He.COUNTERCLOCKWISE};Ov.CLOCKWISE.get=function(){return He.CLOCKWISE};Ov.NONE.get=function(){return He.COLLINEAR};Object.defineProperties(wn,Ov);var ro=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dt,this._seg1=new dt,this._offset0=new dt,this._offset1=new dt,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new m_,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Wr.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},tb={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};ro.prototype.addNextSegment=function(t,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=He.computeOrientation(this._s0,this._s1,this._s2),o=r===He.CLOCKWISE&&this._side===Me.LEFT||r===He.COUNTERCLOCKWISE&&this._side===Me.RIGHT;r===0?this.addCollinear(n):o?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};ro.prototype.addLineEndCap=function(t,n){var r=new dt(t,n),o=new dt;this.computeOffsetSegment(r,Me.LEFT,this._distance,o);var a=new dt;this.computeOffsetSegment(r,Me.RIGHT,this._distance,a);var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s);switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(n,l+Math.PI/2,l-Math.PI/2,He.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case Wr.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(a.p1);break;case Wr.CAP_SQUARE:var c=new ae;c.x=Math.abs(this._distance)*Math.cos(l),c.y=Math.abs(this._distance)*Math.sin(l);var f=new ae(o.p1.x+c.x,o.p1.y+c.y),h=new ae(a.p1.x+c.x,a.p1.y+c.y);this._segList.addPt(f),this._segList.addPt(h);break;default:}};ro.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};ro.prototype.addMitreJoin=function(t,n,r,o){var a=!0,s=null;try{s=xf.intersection(n.p0,n.p1,r.p0,r.p1);var u=o<=0?1:s.distance(t)/Math.abs(o);u>this._bufParams.getMitreLimit()&&(a=!1)}catch(l){if(l instanceof ow)s=new ae(0,0),a=!1;else throw l}finally{}a?this._segList.addPt(s):this.addLimitedMitreJoin(n,r,o,this._bufParams.getMitreLimit())};ro.prototype.addFilletCorner=function(t,n,r,o,a){var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s),c=r.x-t.x,f=r.y-t.y,h=Math.atan2(f,c);o===He.CLOCKWISE?l<=h&&(l+=2*Math.PI):l>=h&&(l-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(t,l,h,o,a),this._segList.addPt(r)};ro.prototype.addOutsideTurn=function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*ro.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};ro.prototype.createSquare=function(t){this._segList.addPt(new ae(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new ae(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new ae(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new ae(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};ro.prototype.addSegments=function(t,n){this._segList.addPts(t,n)};ro.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};ro.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};ro.prototype.initSideSegments=function(t,n,r){this._s1=t,this._s2=n,this._side=r,this._seg1.setCoordinates(t,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};ro.prototype.addLimitedMitreJoin=function(t,n,r,o){var a=this._seg0.p1,s=wn.angle(a,this._seg0.p0),u=wn.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),l=u/2,c=wn.normalize(s+l),f=wn.normalize(c+Math.PI),h=o*r,d=h*Math.abs(Math.sin(l)),p=r-d,_=a.x+h*Math.cos(f),y=a.y+h*Math.sin(f),v=new ae(_,y),w=new dt(a,v),C=w.pointAlongOffset(1,p),E=w.pointAlongOffset(1,-p);this._side===Me.LEFT?(this._segList.addPt(C),this._segList.addPt(E)):(this._segList.addPt(E),this._segList.addPt(C))};ro.prototype.computeOffsetSegment=function(t,n,r,o){var a=n===Me.LEFT?1:-1,s=t.p1.x-t.p0.x,u=t.p1.y-t.p0.y,l=Math.sqrt(s*s+u*u),c=a*r*s/l,f=a*r*u/l;o.p0.x=t.p0.x-f,o.p0.y=t.p0.y+c,o.p1.x=t.p1.x-f,o.p1.y=t.p1.y+c};ro.prototype.addFilletArc=function(t,n,r,o,a){var s=this,u=o===He.CLOCKWISE?-1:1,l=Math.abs(n-r),c=Math.trunc(l/this._filletAngleQuantum+.5);if(c<1)return null;for(var f=0,h=l/c,d=f,p=new ae;d<l;){var _=n+u*d;p.x=t.x+a*Math.cos(_),p.y=t.y+a*Math.sin(_),s._segList.addPt(p),d+=h}};ro.prototype.addInsideTurn=function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*ro.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new ae((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var o=new ae((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};ro.prototype.createCircle=function(t){var n=new ae(t.x+this._distance,t.y);this._segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};ro.prototype.addBevelJoin=function(t,n){this._segList.addPt(t.p1),this._segList.addPt(n.p0)};ro.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new sc,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*ro.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};ro.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,He.CLOCKWISE,this._distance))};ro.prototype.closeRing=function(){this._segList.closeRing()};ro.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};ro.prototype.interfaces_=function(){return[]};ro.prototype.getClass=function(){return ro};tb.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};tb.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};tb.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};tb.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(ro,tb);var Ku=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n};Ku.prototype.getOffsetCurve=function(t,n){if(this._distance=n,n===0)return null;var r=n<0,o=Math.abs(n),a=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],a):this.computeOffsetCurve(t,r,a);var s=a.getCoordinates();return r&&gn.reverse(s),s};Ku.prototype.computeSingleSidedBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){r.addSegments(t,!0);var a=No.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Me.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{r.addSegments(t,!1);var l=No.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Me.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment(),r.closeRing()};Ku.prototype.computeRingBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);n===Me.RIGHT&&(o=-o);var a=No.simplify(t,o),s=a.length-1;r.initSideSegments(a[s-1],a[0],n);for(var u=1;u<=s;u++){var l=u!==1;r.addNextSegment(a[u],l)}r.closeRing()};Ku.prototype.computeLineBufferCurve=function(t,n){var r=this.simplifyTolerance(this._distance),o=No.simplify(t,r),a=o.length-1;n.initSideSegments(o[0],o[1],Me.LEFT);for(var s=2;s<=a;s++)n.addNextSegment(o[s],!0);n.addLastSegment(),n.addLineEndCap(o[a-1],o[a]);var u=No.simplify(t,-r),l=u.length-1;n.initSideSegments(u[l],u[l-1],Me.LEFT);for(var c=l-2;c>=0;c--)n.addNextSegment(u[c],!0);n.addLastSegment(),n.addLineEndCap(u[1],u[0]),n.closeRing()};Ku.prototype.computePointCurve=function(t,n){switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:n.createCircle(t);break;case Wr.CAP_SQUARE:n.createSquare(t);break;default:}};Ku.prototype.getLineCurve=function(t,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),o=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var a=n<0;this.computeSingleSidedBufferCurve(t,a,o)}else this.computeLineBufferCurve(t,o);var s=o.getCoordinates();return s};Ku.prototype.getBufferParameters=function(){return this._bufParams};Ku.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};Ku.prototype.getRingCurve=function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return Ku.copyCoordinates(t);var o=this.getSegGen(r);return this.computeRingBufferCurve(t,n,o),o.getCoordinates()};Ku.prototype.computeOffsetCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){var a=No.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Me.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{var l=No.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Me.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment()};Ku.prototype.getSegGen=function(t){return new ro(this._precisionModel,this._bufParams,t)};Ku.prototype.interfaces_=function(){return[]};Ku.prototype.getClass=function(){return Ku};Ku.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),r=0;r<n.length;r++)n[r]=new ae(t[r]);return n};var wv=function(){this._subgraphs=null,this._seg=new dt,this._cga=new He;var t=arguments[0];this._subgraphs=t},nie={DepthSegment:{configurable:!0}};wv.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=new Fe,o=this._subgraphs.iterator();o.hasNext();){var a=o.next(),s=a.getEnvelope();n.y<s.getMinY()||n.y>s.getMaxY()||t.findStabbedSegments(n,a.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(Ot(arguments[2],wf)&&arguments[0]instanceof ae&&arguments[1]instanceof A4)for(var u=arguments[0],l=arguments[1],c=arguments[2],f=l.getEdge().getCoordinates(),h=0;h<f.length-1;h++){t._seg.p0=f[h],t._seg.p1=f[h+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var d=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(d<u.x)&&!t._seg.isHorizontal()&&!(u.y<t._seg.p0.y||u.y>t._seg.p1.y)&&He.computeOrientation(t._seg.p0,t._seg.p1,u)!==He.RIGHT){var p=l.getDepth(Me.LEFT);t._seg.p0.equals(f[h])||(p=l.getDepth(Me.RIGHT));var _=new s_(t._seg,p);c.add(_)}}else if(Ot(arguments[2],wf)&&arguments[0]instanceof ae&&Ot(arguments[1],wf))for(var y=arguments[0],v=arguments[1],w=arguments[2],C=v.iterator();C.hasNext();){var E=C.next();!E.isForward()||t.findStabbedSegments(y,E,w)}}};wv.prototype.getDepth=function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var r=Af.min(n);return r._leftDepth};wv.prototype.interfaces_=function(){return[]};wv.prototype.getClass=function(){return wv};nie.DepthSegment.get=function(){return s_};Object.defineProperties(wv,nie);var s_=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new dt(t),this._leftDepth=n};s_.prototype.compareTo=function(t){var n=t;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};s_.prototype.compareX=function(t,n){var r=t.p0.compareTo(n.p0);return r!==0?r:t.p1.compareTo(n.p1)};s_.prototype.toString=function(){return this._upwardSeg.toString()};s_.prototype.interfaces_=function(){return[Gc]};s_.prototype.getClass=function(){return s_};var jr=function(t,n,r){this.p0=t||null,this.p1=n||null,this.p2=r||null};jr.prototype.area=function(){return jr.area(this.p0,this.p1,this.p2)};jr.prototype.signedArea=function(){return jr.signedArea(this.p0,this.p1,this.p2)};jr.prototype.interpolateZ=function(t){if(t===null)throw new ho("Supplied point is null.");return jr.interpolateZ(t,this.p0,this.p1,this.p2)};jr.prototype.longestSideLength=function(){return jr.longestSideLength(this.p0,this.p1,this.p2)};jr.prototype.isAcute=function(){return jr.isAcute(this.p0,this.p1,this.p2)};jr.prototype.circumcentre=function(){return jr.circumcentre(this.p0,this.p1,this.p2)};jr.prototype.area3D=function(){return jr.area3D(this.p0,this.p1,this.p2)};jr.prototype.centroid=function(){return jr.centroid(this.p0,this.p1,this.p2)};jr.prototype.inCentre=function(){return jr.inCentre(this.p0,this.p1,this.p2)};jr.prototype.interfaces_=function(){return[]};jr.prototype.getClass=function(){return jr};jr.area=function(t,n,r){return Math.abs(((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2)};jr.signedArea=function(t,n,r){return((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2};jr.det=function(t,n,r,o){return t*o-n*r};jr.interpolateZ=function(t,n,r,o){var a=n.x,s=n.y,u=r.x-a,l=o.x-a,c=r.y-s,f=o.y-s,h=u*f-l*c,d=t.x-a,p=t.y-s,_=(f*d-l*p)/h,y=(-c*d+u*p)/h,v=n.z+_*(r.z-n.z)+y*(o.z-n.z);return v};jr.longestSideLength=function(t,n,r){var o=t.distance(n),a=n.distance(r),s=r.distance(t),u=o;return a>u&&(u=a),s>u&&(u=s),u};jr.isAcute=function(t,n,r){return!(!wn.isAcute(t,n,r)||!wn.isAcute(n,r,t)||!wn.isAcute(r,t,n))};jr.circumcentre=function(t,n,r){var o=r.x,a=r.y,s=t.x-o,u=t.y-a,l=n.x-o,c=n.y-a,f=2*jr.det(s,u,l,c),h=jr.det(u,s*s+u*u,c,l*l+c*c),d=jr.det(s,s*s+u*u,l,l*l+c*c),p=o-h/f,_=a+d/f;return new ae(p,_)};jr.perpendicularBisector=function(t,n){var r=n.x-t.x,o=n.y-t.y,a=new xf(t.x+r/2,t.y+o/2,1),s=new xf(t.x-o+r/2,t.y+r+o/2,1);return new xf(a,s)};jr.angleBisector=function(t,n,r){var o=n.distance(t),a=n.distance(r),s=o/(o+a),u=r.x-t.x,l=r.y-t.y,c=new ae(t.x+s*u,t.y+s*l);return c};jr.area3D=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=n.z-t.z,u=r.x-t.x,l=r.y-t.y,c=r.z-t.z,f=a*c-s*l,h=s*u-o*c,d=o*l-a*u,p=f*f+h*h+d*d,_=Math.sqrt(p)/2;return _};jr.centroid=function(t,n,r){var o=(t.x+n.x+r.x)/3,a=(t.y+n.y+r.y)/3;return new ae(o,a)};jr.inCentre=function(t,n,r){var o=n.distance(r),a=t.distance(r),s=t.distance(n),u=o+a+s,l=(o*t.x+a*n.x+s*r.x)/u,c=(o*t.y+a*n.y+s*r.y)/u;return new ae(l,c)};var kc=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=r};kc.prototype.addPoint=function(t){if(this._distance<=0)return null;var n=t.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,he.EXTERIOR,he.INTERIOR)};kc.prototype.addPolygon=function(t){var n=this,r=this._distance,o=Me.LEFT;this._distance<0&&(r=-this._distance,o=Me.RIGHT);var a=t.getExteriorRing(),s=gn.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&s.length<3)return null;this.addPolygonRing(s,r,o,he.EXTERIOR,he.INTERIOR);for(var u=0;u<t.getNumInteriorRing();u++){var l=t.getInteriorRingN(u),c=gn.removeRepeatedPoints(l.getCoordinates());n._distance>0&&n.isErodedCompletely(l,-n._distance)||n.addPolygonRing(c,r,Me.opposite(o),he.INTERIOR,he.EXTERIOR)}};kc.prototype.isTriangleErodedCompletely=function(t,n){var r=new jr(t[0],t[1],t[2]),o=r.inCentre(),a=He.distancePointLine(o,r.p0,r.p1);return a<Math.abs(n)};kc.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=gn.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,he.EXTERIOR,he.INTERIOR)};kc.prototype.addCurve=function(t,n,r){if(t===null||t.length<2)return null;var o=new Qo(t,new oi(0,he.BOUNDARY,n,r));this._curveList.add(o)};kc.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};kc.prototype.addPolygonRing=function(t,n,r,o,a){if(n===0&&t.length<Bd.MINIMUM_VALID_SIZE)return null;var s=o,u=a;t.length>=Bd.MINIMUM_VALID_SIZE&&He.isCCW(t)&&(s=a,u=o,r=Me.opposite(r));var l=this._curveBuilder.getRingCurve(t,r,n);this.addCurve(l,s,u)};kc.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ma?this.addPolygon(t):t instanceof Oo?this.addLineString(t):t instanceof Il?this.addPoint(t):t instanceof U1?this.addCollection(t):t instanceof o_?this.addCollection(t):t instanceof Rd?this.addCollection(t):t instanceof Au&&this.addCollection(t)};kc.prototype.isErodedCompletely=function(t,n){var r=t.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var o=t.getEnvelopeInternal(),a=Math.min(o.getHeight(),o.getWidth());return n<0&&2*Math.abs(n)>a};kc.prototype.addCollection=function(t){for(var n=this,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r);n.add(o)}};kc.prototype.interfaces_=function(){return[]};kc.prototype.getClass=function(){return kc};var Y1=function(){};Y1.prototype.locate=function(t){};Y1.prototype.interfaces_=function(){return[]};Y1.prototype.getClass=function(){return Y1};var Od=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Od.prototype.next=function(){if(this._atStart)return this._atStart=!1,Od.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new sw;var t=this._parent.getGeometryN(this._index++);return t instanceof Au?(this._subcollectionIterator=new Od(t),this._subcollectionIterator.next()):t};Od.prototype.remove=function(){throw new Error(this.getClass().getName())};Od.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};Od.prototype.interfaces_=function(){return[aw]};Od.prototype.getClass=function(){return Od};Od.isAtomic=function(t){return!(t instanceof Au)};var rc=function(){this._geom=null;var t=arguments[0];this._geom=t};rc.prototype.locate=function(t){return rc.locate(t,this._geom)};rc.prototype.interfaces_=function(){return[Y1]};rc.prototype.getClass=function(){return rc};rc.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?He.isPointInRing(t,n.getCoordinates()):!1};rc.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!rc.isPointInRing(t,r))return!1;for(var o=0;o<n.getNumInteriorRing();o++){var a=n.getInteriorRingN(o);if(rc.isPointInRing(t,a))return!1}return!0};rc.containsPoint=function(t,n){if(n instanceof Ma)return rc.containsPointInPolygon(t,n);if(n instanceof Au)for(var r=new Od(n);r.hasNext();){var o=r.next();if(o!==n&&rc.containsPoint(t,o))return!0}return!1};rc.locate=function(t,n){return n.isEmpty()?he.EXTERIOR:rc.containsPoint(t,n)?he.INTERIOR:he.EXTERIOR};var Xs=function(){this._edgeMap=new Ws,this._edgeList=null,this._ptInAreaLocation=[he.NONE,he.NONE]};Xs.prototype.getNextCW=function(t){this.getEdges();var n=this._edgeList.indexOf(t),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};Xs.prototype.propagateSideLabels=function(t){for(var n=he.NONE,r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.isArea(t)&&a.getLocation(t,Me.LEFT)!==he.NONE&&(n=a.getLocation(t,Me.LEFT))}if(n===he.NONE)return null;for(var s=n,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();if(c.getLocation(t,Me.ON)===he.NONE&&c.setLocation(t,Me.ON,s),c.isArea(t)){var f=c.getLocation(t,Me.LEFT),h=c.getLocation(t,Me.RIGHT);if(h!==he.NONE){if(h!==s)throw new im("side location conflict",l.getCoordinate());f===he.NONE&&an.shouldNeverReachHere("found single null side (at "+l.getCoordinate()+")"),s=f}else an.isTrue(c.getLocation(t,Me.LEFT)===he.NONE,"found single null side"),c.setLocation(t,Me.RIGHT,s),c.setLocation(t,Me.LEFT,s)}}};Xs.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()};Xs.prototype.print=function(t){Ss.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Xs.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Xs.prototype.checkAreaLabelsConsistent=function(t){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,o=n.get(r).getLabel(),a=o.getLocation(t,Me.LEFT);an.isTrue(a!==he.NONE,"Found unlabelled area edge");for(var s=a,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();an.isTrue(c.isArea(t),"Found non-area edge");var f=c.getLocation(t,Me.LEFT),h=c.getLocation(t,Me.RIGHT);if(f===h||h!==s)return!1;s=f}return!0};Xs.prototype.findIndex=function(t){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var o=n._edgeList.get(r);if(o===t)return r}return-1};Xs.prototype.iterator=function(){return this.getEdges().iterator()};Xs.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Fe(this._edgeMap.values())),this._edgeList};Xs.prototype.getLocation=function(t,n,r){return this._ptInAreaLocation[t]===he.NONE&&(this._ptInAreaLocation[t]=rc.locate(n,r[t].getGeometry())),this._ptInAreaLocation[t]};Xs.prototype.toString=function(){var t=new qh;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();t.append(r),t.append(`
`)}return t.toString()};Xs.prototype.computeEdgeEndLabels=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(t)}};Xs.prototype.computeLabelling=function(t){var n=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),u=0;u<2;u++)s.isLine(u)&&s.getLocation(u)===he.BOUNDARY&&(r[u]=!0);for(var l=this.iterator();l.hasNext();)for(var c=l.next(),f=c.getLabel(),h=0;h<2;h++)if(f.isAnyNull(h)){var d=he.NONE;if(r[h])d=he.EXTERIOR;else{var p=c.getCoordinate();d=n.getLocation(h,p,t)}f.setAllLocationsIfNull(h,d)}};Xs.prototype.getDegree=function(){return this._edgeMap.size()};Xs.prototype.insertEdgeEnd=function(t,n){this._edgeMap.put(t,n),this._edgeList=null};Xs.prototype.interfaces_=function(){return[]};Xs.prototype.getClass=function(){return Xs};var jFe=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var o=null,a=null,s=this._SCANNING_FOR_INCOMING,u=0;u<this._resultAreaEdgeList.size();u++){var l=r._resultAreaEdgeList.get(u),c=l.getSym();if(!!l.getLabel().isArea())switch(o===null&&l.isInResult()&&(o=l),s){case r._SCANNING_FOR_INCOMING:if(!c.isInResult())continue;a=c,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!l.isInResult())continue;a.setNext(l),s=r._SCANNING_FOR_INCOMING;break;default:}}if(s===this._LINKING_TO_OUTGOING){if(o===null)throw new im("no outgoing dirEdge found",this.getCoordinate());an.isTrue(o.isInResult(),"unable to link last incoming dirEdge"),a.setNext(o)}},t.prototype.insert=function(r){var o=r;this.insertEdgeEnd(o,o)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),o=r.size();if(o<1)return null;var a=r.get(0);if(o===1)return a;var s=r.get(o-1),u=a.getQuadrant(),l=s.getQuadrant();return Pi.isNorthern(u)&&Pi.isNorthern(l)?a:!Pi.isNorthern(u)&&!Pi.isNorthern(l)?s:a.getDy()!==0?a:s.getDy()!==0?s:(an.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){Ss.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var a=o.next();r.print("out "),a.print(r),r.println(),r.print("in "),a.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Fe;for(var o=this.iterator();o.hasNext();){var a=o.next();(a.isInResult()||a.getSym().isInResult())&&r._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.setAllLocationsIfNull(0,r.getLocation(0)),s.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var o=null,a=null,s=this._edgeList.size()-1;s>=0;s--){var u=r._edgeList.get(s),l=u.getSym();a===null&&(a=l),o!==null&&l.setNext(o),o=u}a.setNext(o)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var o=arguments[0],a=this.findIndex(o),s=o.getDepth(Me.LEFT),u=o.getDepth(Me.RIGHT),l=this.computeDepths(a+1,this._edgeList.size(),s),c=this.computeDepths(0,a,l);if(c!==u)throw new im("depth mismatch at "+o.getCoordinate())}else if(arguments.length===3){for(var f=arguments[0],h=arguments[1],d=arguments[2],p=d,_=f;_<h;_++){var y=r._edgeList.get(_);y.setEdgeDepths(Me.RIGHT,p),p=y.getDepth(Me.LEFT)}return p}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.merge(o.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var o=this,a=null,s=null,u=this._SCANNING_FOR_INCOMING,l=this._resultAreaEdgeList.size()-1;l>=0;l--){var c=o._resultAreaEdgeList.get(l),f=c.getSym();switch(a===null&&c.getEdgeRing()===r&&(a=c),u){case o._SCANNING_FOR_INCOMING:if(f.getEdgeRing()!==r)continue;s=f,u=o._LINKING_TO_OUTGOING;break;case o._LINKING_TO_OUTGOING:if(c.getEdgeRing()!==r)continue;s.setNextMin(c),u=o._SCANNING_FOR_INCOMING;break;default:}}u===this._LINKING_TO_OUTGOING&&(an.isTrue(a!==null,"found null for first outgoing dirEdge"),an.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),s.setNextMin(a))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,o=this.iterator();o.hasNext();){var a=o.next();a.isInResult()&&r++}return r}else if(arguments.length===1){for(var s=arguments[0],u=0,l=this.iterator();l.hasNext();){var c=l.next();c.getEdgeRing()===s&&u++}return u}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=he.NONE,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){r=he.INTERIOR;break}if(s.isInResult()){r=he.EXTERIOR;break}}}if(r===he.NONE)return null;for(var u=r,l=this.iterator();l.hasNext();){var c=l.next(),f=c.getSym();c.isLineEdge()?c.getEdge().setCovered(u===he.INTERIOR):(c.isInResult()&&(u=he.EXTERIOR),f.isInResult()&&(u=he.INTERIOR))}},t.prototype.computeLabelling=function(r){var o=this;e.prototype.computeLabelling.call(this,r),this._label=new oi(he.NONE);for(var a=this.iterator();a.hasNext();)for(var s=a.next(),u=s.getEdge(),l=u.getLabel(),c=0;c<2;c++){var f=l.getLocation(c);(f===he.INTERIOR||f===he.BOUNDARY)&&o._label.setLocation(c,he.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Xs),rie=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new IR(r,new jFe)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(H1),Pg=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};Pg.prototype.compareTo=function(t){var n=t,r=Pg.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};Pg.prototype.interfaces_=function(){return[Gc]};Pg.prototype.getClass=function(){return Pg};Pg.orientation=function(t){return gn.increasingDirection(t)===1};Pg.compareOriented=function(t,n,r,o){for(var a=n?1:-1,s=o?1:-1,u=n?t.length:-1,l=o?r.length:-1,c=n?0:t.length-1,f=o?0:r.length-1;;){var h=t[c].compareTo(r[f]);if(h!==0)return h;c+=a,f+=s;var d=c===u,p=f===l;if(d&&!p)return-1;if(!d&&p)return 1;if(d&&p)return 0}};var bf=function(){this._edges=new Fe,this._ocaMap=new Ws};bf.prototype.print=function(t){var n=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var o=n._edges.get(r);r>0&&t.print(","),t.print("(");for(var a=o.getCoordinates(),s=0;s<a.length;s++)s>0&&t.print(","),t.print(a[s].x+" "+a[s].y);t.println(")")}t.print(")  ")};bf.prototype.addAll=function(t){for(var n=this,r=t.iterator();r.hasNext();)n.add(r.next())};bf.prototype.findEdgeIndex=function(t){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(t))return r;return-1};bf.prototype.iterator=function(){return this._edges.iterator()};bf.prototype.getEdges=function(){return this._edges};bf.prototype.get=function(t){return this._edges.get(t)};bf.prototype.findEqualEdge=function(t){var n=new Pg(t.getCoordinates()),r=this._ocaMap.get(n);return r};bf.prototype.add=function(t){this._edges.add(t);var n=new Pg(t.getCoordinates());this._ocaMap.put(n,t)};bf.prototype.interfaces_=function(){return[]};bf.prototype.getClass=function(){return bf};var u_=function(){};u_.prototype.processIntersections=function(t,n,r,o){};u_.prototype.isDone=function(){};u_.prototype.interfaces_=function(){return[]};u_.prototype.getClass=function(){return u_};var uc=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};uc.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(uc.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.size()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};uc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};uc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};uc.prototype.getLineIntersector=function(){return this._li};uc.prototype.hasProperIntersection=function(){return this._hasProper};uc.prototype.processIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};uc.prototype.hasIntersection=function(){return this._hasIntersection};uc.prototype.isDone=function(){return!1};uc.prototype.hasInteriorIntersection=function(){return this._hasInterior};uc.prototype.interfaces_=function(){return[u_]};uc.prototype.getClass=function(){return uc};uc.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var Vh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],r=arguments[2];this.coord=new ae(t),this.segmentIndex=n,this.dist=r};Vh.prototype.getSegmentIndex=function(){return this.segmentIndex};Vh.prototype.getCoordinate=function(){return this.coord};Vh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};Vh.prototype.compareTo=function(t){var n=t;return this.compare(n.segmentIndex,n.dist)};Vh.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};Vh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Vh.prototype.getDistance=function(){return this.dist};Vh.prototype.compare=function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0};Vh.prototype.interfaces_=function(){return[Gc]};Vh.prototype.getClass=function(){return Vh};var Vd=function(){this._nodeMap=new Ws,this.edge=null;var t=arguments[0];this.edge=t};Vd.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Vd.prototype.iterator=function(){return this._nodeMap.values().iterator()};Vd.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};Vd.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};Vd.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this.edge.pts[n.segmentIndex],s=n.dist>0||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new ae(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r.edge.pts[c];return s&&(u[l]=n.coord),new QL(u,new oi(this.edge._label))};Vd.prototype.add=function(t,n,r){var o=new Vh(t,n,r),a=this._nodeMap.get(o);return a!==null?a:(this._nodeMap.put(o,o),o)};Vd.prototype.isIntersection=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(t))return!0}return!1};Vd.prototype.interfaces_=function(){return[]};Vd.prototype.getClass=function(){return Vd};var l_=function(){};l_.prototype.getChainStartIndices=function(t){var n=this,r=0,o=new Fe;o.add(new Rh(r));do{var a=n.findChainEnd(t,r);o.add(new Rh(a)),r=a}while(r<t.length-1);var s=l_.toIntArray(o);return s};l_.prototype.findChainEnd=function(t,n){for(var r=Pi.quadrant(t[n],t[n+1]),o=n+1;o<t.length;){var a=Pi.quadrant(t[o-1],t[o]);if(a!==r)break;o++}return o-1};l_.prototype.interfaces_=function(){return[]};l_.prototype.getClass=function(){return l_};l_.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var am=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new ct,this.env2=new ct;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new l_;this.startIndex=n.getChainStartIndices(this.pts)};am.prototype.getCoordinates=function(){return this.pts};am.prototype.getMaxX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n>r?n:r};am.prototype.getMinX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n<r?n:r};am.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[r],n.startIndex[r+1],o)}else if(arguments.length===6){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=arguments[4],f=arguments[5],h=this.pts[a],d=this.pts[s],p=u.pts[l],_=u.pts[c];if(s-a===1&&c-l===1)return f.addIntersections(this.e,a,u.e,l),null;if(this.env1.init(h,d),this.env2.init(p,_),!this.env1.intersects(this.env2))return null;var y=Math.trunc((a+s)/2),v=Math.trunc((l+c)/2);a<y&&(l<v&&this.computeIntersectsForChain(a,y,u,l,v,f),v<c&&this.computeIntersectsForChain(a,y,u,v,c,f)),y<s&&(l<v&&this.computeIntersectsForChain(y,s,u,l,v,f),v<c&&this.computeIntersectsForChain(y,s,u,v,c,f))}};am.prototype.getStartIndexes=function(){return this.startIndex};am.prototype.computeIntersects=function(t,n){for(var r=this,o=0;o<this.startIndex.length-1;o++)for(var a=0;a<t.startIndex.length-1;a++)r.computeIntersectsForChain(o,t,a,n)};am.prototype.interfaces_=function(){return[]};am.prototype.getClass=function(){return am};var Ts=function e(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)t._depth[n][r]=e.NULL_VALUE},iie={NULL_VALUE:{configurable:!0}};Ts.prototype.getDepth=function(t,n){return this._depth[t][n]};Ts.prototype.setDepth=function(t,n,r){this._depth[t][n]=r};Ts.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(t._depth[n][r]!==Ts.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var o=arguments[0];return this._depth[o][1]===Ts.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._depth[a][s]===Ts.NULL_VALUE}};Ts.prototype.normalize=function(){for(var t=this,n=0;n<2;n++)if(!t.isNull(n)){var r=t._depth[n][1];t._depth[n][2]<r&&(r=t._depth[n][2]),r<0&&(r=0);for(var o=1;o<3;o++){var a=0;t._depth[n][o]>r&&(a=1),t._depth[n][o]=a}}};Ts.prototype.getDelta=function(t){return this._depth[t][Me.RIGHT]-this._depth[t][Me.LEFT]};Ts.prototype.getLocation=function(t,n){return this._depth[t][n]<=0?he.EXTERIOR:he.INTERIOR};Ts.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};Ts.prototype.add=function(){var t=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var o=1;o<3;o++){var a=n.getLocation(r,o);(a===he.EXTERIOR||a===he.INTERIOR)&&(t.isNull(r,o)?t._depth[r][o]=Ts.depthAtLocation(a):t._depth[r][o]+=Ts.depthAtLocation(a))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];l===he.INTERIOR&&this._depth[s][u]++}};Ts.prototype.interfaces_=function(){return[]};Ts.prototype.getClass=function(){return Ts};Ts.depthAtLocation=function(t){return t===he.EXTERIOR?0:t===he.INTERIOR?1:Ts.NULL_VALUE};iie.NULL_VALUE.get=function(){return-1};Object.defineProperties(Ts,iie);var QL=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new Vd(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ts,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.pts=r,this._label=o}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var o=new t(r,oi.toLineLabel(this._label));return o},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var o=this;if(!(r instanceof t))return!1;var a=r;if(this.pts.length!==a.pts.length)return!1;for(var s=!0,u=!0,l=this.pts.length,c=0;c<this.pts.length;c++)if(o.pts[c].equals2D(a.pts[c])||(s=!1),o.pts[c].equals2D(a.pts[--l])||(u=!1),!s&&!u)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var o=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(o.pts[a].x+" "+o.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var o=this;r.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)r.print(o.pts[a]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new am(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new ct;for(var o=0;o<this.pts.length;o++)r._env.expandToInclude(r.pts[o])}return this._env},t.prototype.addIntersection=function(r,o,a,s){var u=new ae(r.getIntersection(s)),l=o,c=r.getEdgeDistance(a,s),f=l+1;if(f<this.pts.length){var h=this.pts[f];u.equals2D(h)&&(l=f,c=0)}this.eiList.add(u,l,c)},t.prototype.toString=function(){var r=this,o=new qh;o.append("edge "+this._name+": "),o.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&o.append(","),o.append(r.pts[a].x+" "+r.pts[a].y);return o.append(")  "+this._label+" "+this._depthDelta),o.toString()},t.prototype.isPointwiseEqual=function(r){var o=this;if(this.pts.length!==r.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!o.pts[a].equals2D(r.pts[a]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,o,a){for(var s=this,u=0;u<r.getIntersectionNum();u++)s.addIntersection(r,o,a,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];o.setAtLeastIfValid(r.getLocation(0,Me.ON),r.getLocation(1,Me.ON),1),r.isArea()&&(o.setAtLeastIfValid(r.getLocation(0,Me.LEFT),r.getLocation(1,Me.LEFT),2),o.setAtLeastIfValid(r.getLocation(0,Me.RIGHT),r.getLocation(1,Me.RIGHT),2))}else return e.prototype.updateIM.apply(this,arguments)},t}(ac),Tu=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new bf,this._bufParams=t||null};Tu.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};Tu.prototype.insertUniqueEdge=function(t){var n=this._edgeList.findEqualEdge(t);if(n!==null){var r=n.getLabel(),o=t.getLabel();n.isPointwiseEqual(t)||(o=new oi(t.getLabel()),o.flip()),r.merge(o);var a=Tu.depthDelta(o),s=n.getDepthDelta(),u=s+a;n.setDepthDelta(u)}else this._edgeList.add(t),t.setDepthDelta(Tu.depthDelta(t.getLabel()))};Tu.prototype.buildSubgraphs=function(t,n){for(var r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=a.getRightmostCoordinate(),u=new wv(r),l=u.getDepth(s);a.computeDepth(l),a.findResultEdges(),r.add(a),n.add(a.getDirectedEdges(),a.getNodes())}};Tu.prototype.createSubgraphs=function(t){for(var n=new Fe,r=t.getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isVisited()){var a=new bu;a.create(o),n.add(a)}}return Af.sort(n,Af.reverseOrder()),n};Tu.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};Tu.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var n=new mV,r=new m_;return r.setPrecisionModel(t),n.setSegmentIntersector(new uc(r)),n};Tu.prototype.buffer=function(t,n){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new Ku(r,this._bufParams),a=new kc(t,n,o),s=a.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,r),this._graph=new Ao(new rie),this._graph.addEdges(this._edgeList.getEdges());var u=this.createSubgraphs(this._graph),l=new Dl(this._geomFact);this.buildSubgraphs(u,l);var c=l.getPolygons();if(c.size()<=0)return this.createEmptyResultGeometry();var f=this._geomFact.buildGeometry(c);return f};Tu.prototype.computeNodedEdges=function(t,n){var r=this,o=this.getNoder(n);o.computeNodes(t);for(var a=o.getNodedSubstrings(),s=a.iterator();s.hasNext();){var u=s.next(),l=u.getCoordinates();if(!(l.length===2&&l[0].equals2D(l[1]))){var c=u.getData(),f=new QL(u.getCoordinates(),new oi(c));r.insertUniqueEdge(f)}}};Tu.prototype.setNoder=function(t){this._workingNoder=t};Tu.prototype.interfaces_=function(){return[]};Tu.prototype.getClass=function(){return Tu};Tu.depthDelta=function(t){var n=t.getLocation(0,Me.LEFT),r=t.getLocation(0,Me.RIGHT);return n===he.INTERIOR&&r===he.EXTERIOR?1:n===he.EXTERIOR&&r===he.INTERIOR?-1:0};Tu.convertSegStrings=function(t){for(var n=new mn,r=new Fe;t.hasNext();){var o=t.next(),a=n.createLineString(o.getCoordinates());r.add(a)}return n.buildGeometry(r)};var Mg=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._noder=r,this._scaleFactor=o,this._offsetX=a,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};Mg.prototype.rescale=function(){var t=this;if(Ot(arguments[0],ba))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.rescale(o.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],s=0;s<a.length;s++)a[s].x=a[s].x/t._scaleFactor+t._offsetX,a[s].y=a[s].y/t._scaleFactor+t._offsetY;a.length===2&&a[0].equals2D(a[1])&&Ss.out.println(a)}};Mg.prototype.scale=function(){var t=this;if(Ot(arguments[0],ba)){for(var n=arguments[0],r=new Fe,o=n.iterator();o.hasNext();){var a=o.next();r.add(new Qo(t.scale(a.getCoordinates()),a.getData()))}return r}else if(arguments[0]instanceof Array){for(var s=arguments[0],u=new Array(s.length).fill(null),l=0;l<s.length;l++)u[l]=new ae(Math.round((s[l].x-t._offsetX)*t._scaleFactor),Math.round((s[l].y-t._offsetY)*t._scaleFactor),s[l].z);var c=gn.removeRepeatedPoints(u);return c}};Mg.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Mg.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Mg.prototype.computeNodes=function(t){var n=t;this._isScaled&&(n=this.scale(t)),this._noder.computeNodes(n)};Mg.prototype.interfaces_=function(){return[a_]};Mg.prototype.getClass=function(){return Mg};var kh=function(){this._li=new m_,this._segStrings=null;var t=arguments[0];this._segStrings=t},oie={fact:{configurable:!0}};kh.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();t.checkEndPtVertexIntersections(o[0],t._segStrings),t.checkEndPtVertexIntersections(o[o.length-1],t._segStrings)}else if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=s.iterator();u.hasNext();)for(var l=u.next(),c=l.getCoordinates(),f=1;f<c.length-1;f++)if(c[f].equals(a))throw new nm("found endpt/interior pt intersection at index "+f+" :pt "+a)}};kh.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),o=this._segStrings.iterator();o.hasNext();){var a=o.next();t.checkInteriorIntersections(r,a)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],l=s.getCoordinates(),c=u.getCoordinates(),f=0;f<l.length-1;f++)for(var h=0;h<c.length-1;h++)t.checkInteriorIntersections(s,f,u,h);else if(arguments.length===4){var d=arguments[0],p=arguments[1],_=arguments[2],y=arguments[3];if(d===_&&p===y)return null;var v=d.getCoordinates()[p],w=d.getCoordinates()[p+1],C=_.getCoordinates()[y],E=_.getCoordinates()[y+1];if(this._li.computeIntersection(v,w,C,E),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,v,w)||this.hasInteriorIntersection(this._li,C,E)))throw new nm("found non-noded intersection at "+v+"-"+w+" and "+C+"-"+E)}};kh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};kh.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkCollapses(r)}else if(arguments.length===1)for(var o=arguments[0],a=o.getCoordinates(),s=0;s<a.length-2;s++)t.checkCollapse(a[s],a[s+1],a[s+2])};kh.prototype.hasInteriorIntersection=function(t,n,r){for(var o=0;o<t.getIntersectionNum();o++){var a=t.getIntersection(o);if(!(a.equals(n)||a.equals(r)))return!0}return!1};kh.prototype.checkCollapse=function(t,n,r){if(t.equals(r))throw new nm("found non-noded collapse at "+kh.fact.createLineString([t,n,r]))};kh.prototype.interfaces_=function(){return[]};kh.prototype.getClass=function(){return kh};oie.fact.get=function(){return new mn};Object.defineProperties(kh,oie);var Zu=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=r,n<=0)throw new ho("Scale factor must be non-zero");n!==1&&(this._pt=new ae(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new ae,this._p1Scaled=new ae),this.initCorners(this._pt)},aie={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Zu.prototype.intersectsScaled=function(t,n){var r=Math.min(t.x,n.x),o=Math.max(t.x,n.x),a=Math.min(t.y,n.y),s=Math.max(t.y,n.y),u=this._maxx<r||this._minx>o||this._maxy<a||this._miny>s;if(u)return!1;var l=this.intersectsToleranceSquare(t,n);return an.isTrue(!(u&&l),"Found bad envelope test"),l};Zu.prototype.initCorners=function(t){var n=.5;this._minx=t.x-n,this._maxx=t.x+n,this._miny=t.y-n,this._maxy=t.y+n,this._corner[0]=new ae(this._maxx,this._maxy),this._corner[1]=new ae(this._minx,this._maxy),this._corner[2]=new ae(this._minx,this._miny),this._corner[3]=new ae(this._maxx,this._miny)};Zu.prototype.intersects=function(t,n){return this._scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Zu.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};Zu.prototype.getCoordinate=function(){return this._originalPt};Zu.prototype.copyScaled=function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)};Zu.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=Zu.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ct(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};Zu.prototype.intersectsPixelClosure=function(t,n){return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Zu.prototype.intersectsToleranceSquare=function(t,n){var r=!1,o=!1;return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&o||t.equals(this._pt)||n.equals(this._pt))};Zu.prototype.addSnappedNode=function(t,n){var r=t.getCoordinate(n),o=t.getCoordinate(n+1);return this.intersects(r,o)?(t.addIntersection(this.getCoordinate(),n),!0):!1};Zu.prototype.interfaces_=function(){return[]};Zu.prototype.getClass=function(){return Zu};aie.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Zu,aie);var zA=function(){this.tempEnv1=new ct,this.selectedSegment=new dt};zA.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};zA.prototype.interfaces_=function(){return[]};zA.prototype.getClass=function(){return zA};var X1=function(){this._index=null;var t=arguments[0];this._index=t},sie={HotPixelSnapAction:{configurable:!0}};X1.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=n.getSafeEnvelope(),s=new uie(n,r,o);return this._index.query(a,{interfaces_:function(){return[Ig]},visitItem:function(u){var l=u;l.select(a,s)}}),s.isNodeAdded()}};X1.prototype.interfaces_=function(){return[]};X1.prototype.getClass=function(){return X1};sie.HotPixelSnapAction.get=function(){return uie};Object.defineProperties(X1,sie);var uie=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],o=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1],a=r.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&o===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,o)}else return e.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(zA),Ev=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Fe};Ev.prototype.processIntersections=function(t,n,r,o){var a=this;if(t===r&&n===o)return null;var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];if(this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var f=0;f<this._li.getIntersectionNum();f++)a._interiorIntersections.add(a._li.getIntersection(f));t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)}};Ev.prototype.isDone=function(){return!1};Ev.prototype.getInteriorIntersections=function(){return this._interiorIntersections};Ev.prototype.interfaces_=function(){return[u_]};Ev.prototype.getClass=function(){return Ev};var kd=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new m_,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};kd.prototype.checkCorrectness=function(t){var n=Qo.getNodedSubstrings(t),r=new kh(n);try{r.checkValid()}catch(o){if(o instanceof Yre)o.printStackTrace();else throw o}finally{}};kd.prototype.getNodedSubstrings=function(){return Qo.getNodedSubstrings(this._nodedSegStrings)};kd.prototype.snapRound=function(t,n){var r=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};kd.prototype.findInteriorIntersections=function(t,n){var r=new Ev(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};kd.prototype.computeVertexSnaps=function(){var t=this;if(Ot(arguments[0],ba))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.computeVertexSnaps(o)}else if(arguments[0]instanceof Qo)for(var a=arguments[0],s=a.getCoordinates(),u=0;u<s.length;u++){var l=new Zu(s[u],t._scaleFactor,t._li),c=t._pointSnapper.snap(l,a,u);c&&a.addIntersection(s[u],u)}};kd.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new mV,this._pointSnapper=new X1(this._noder.getIndex()),this.snapRound(t,this._li)};kd.prototype.computeIntersectionSnaps=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=new Zu(o,n._scaleFactor,n._li);n._pointSnapper.snap(a)}};kd.prototype.interfaces_=function(){return[a_]};kd.prototype.getClass=function(){return kd};var Es=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Wr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},lw={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Es.prototype.bufferFixedPrecision=function(t){var n=new Mg(new kd(new Xr(1)),t.getScale()),r=new Tu(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};Es.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var n=Es.MAX_PRECISION_DIGITS;n>=0;n--){try{t.bufferReducedPrecision(n)}catch(s){if(s instanceof im)t._saveException=s;else throw s}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],o=Es.precisionScaleFactor(this._argGeom,this._distance,r),a=new Xr(o);this.bufferFixedPrecision(a)}};Es.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Xr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};Es.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};Es.prototype.bufferOriginalPrecision=function(){try{var t=new Tu(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof nm)this._saveException=n;else throw n}finally{}};Es.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};Es.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};Es.prototype.interfaces_=function(){return[]};Es.prototype.getClass=function(){return Es};Es.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Es(t),o=r.getResultGeometry(n);return o}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Mt&&typeof arguments[1]=="number"){var a=arguments[0],s=arguments[1],u=arguments[2],l=new Es(a);l.setQuadrantSegments(u);var c=l.getResultGeometry(s);return c}else if(arguments[2]instanceof Wr&&arguments[0]instanceof Mt&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=arguments[2],p=new Es(f,d),_=p.getResultGeometry(h);return _}}else if(arguments.length===4){var y=arguments[0],v=arguments[1],w=arguments[2],C=arguments[3],E=new Es(y);E.setQuadrantSegments(w),E.setEndCapStyle(C);var S=E.getResultGeometry(v);return S}};Es.precisionScaleFactor=function(t,n,r){var o=t.getEnvelopeInternal(),a=oc.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY())),s=n>0?n:0,u=a+2*s,l=Math.trunc(Math.log(u)/Math.log(10)+1),c=r-l,f=Math.pow(10,c);return f};lw.CAP_ROUND.get=function(){return Wr.CAP_ROUND};lw.CAP_BUTT.get=function(){return Wr.CAP_FLAT};lw.CAP_FLAT.get=function(){return Wr.CAP_FLAT};lw.CAP_SQUARE.get=function(){return Wr.CAP_SQUARE};lw.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(Es,lw);var xu=function(){this._pt=[new ae,new ae],this._distance=Qt.NaN,this._isNull=!0};xu.prototype.getCoordinates=function(){return this._pt};xu.prototype.getCoordinate=function(t){return this._pt[t]};xu.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};xu.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};xu.prototype.getDistance=function(){return this._distance};xu.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};xu.prototype.interfaces_=function(){return[]};xu.prototype.getClass=function(){return xu};var Ld=function(){};Ld.prototype.interfaces_=function(){return[]};Ld.prototype.getClass=function(){return Ld};Ld.computeDistance=function(){if(arguments[2]instanceof xu&&arguments[0]instanceof Oo&&arguments[1]instanceof ae)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=t.getCoordinates(),a=new dt,s=0;s<o.length-1;s++){a.setCoordinates(o[s],o[s+1]);var u=a.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof xu&&arguments[0]instanceof Ma&&arguments[1]instanceof ae){var l=arguments[0],c=arguments[1],f=arguments[2];Ld.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)Ld.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof xu&&arguments[0]instanceof Mt&&arguments[1]instanceof ae){var d=arguments[0],p=arguments[1],_=arguments[2];if(d instanceof Oo)Ld.computeDistance(d,p,_);else if(d instanceof Ma)Ld.computeDistance(d,p,_);else if(d instanceof Au)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);Ld.computeDistance(w,p,_)}else _.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof xu&&arguments[0]instanceof dt&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var c_=function(t){this._maxPtDist=new xu,this._inputGeom=t||null},gV={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};c_.prototype.computeMaxMidpointDistance=function(t){var n=new Lg(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};c_.prototype.computeMaxVertexDistance=function(t){var n=new Tv(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};c_.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};c_.prototype.getDistancePoints=function(){return this._maxPtDist};c_.prototype.interfaces_=function(){return[]};c_.prototype.getClass=function(){return c_};gV.MaxPointDistanceFilter.get=function(){return Tv};gV.MaxMidpointDistanceFilter.get=function(){return Lg};Object.defineProperties(c_,gV);var Tv=function(t){this._maxPtDist=new xu,this._minPtDist=new xu,this._geom=t||null};Tv.prototype.filter=function(t){this._minPtDist.initialize(),Ld.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Tv.prototype.getMaxPointDistance=function(){return this._maxPtDist};Tv.prototype.interfaces_=function(){return[Nd]};Tv.prototype.getClass=function(){return Tv};var Lg=function(t){this._maxPtDist=new xu,this._minPtDist=new xu,this._geom=t||null};Lg.prototype.filter=function(t,n){if(n===0)return null;var r=t.getCoordinate(n-1),o=t.getCoordinate(n),a=new ae((r.x+o.x)/2,(r.y+o.y)/2);this._minPtDist.initialize(),Ld.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Lg.prototype.isDone=function(){return!1};Lg.prototype.isGeometryChanged=function(){return!1};Lg.prototype.getMaxPointDistance=function(){return this._maxPtDist};Lg.prototype.interfaces_=function(){return[Tf]};Lg.prototype.getClass=function(){return Lg};var Jp=function(t){this._comps=t||null};Jp.prototype.filter=function(t){t instanceof Ma&&this._comps.add(t)};Jp.prototype.interfaces_=function(){return[Nh]};Jp.prototype.getClass=function(){return Jp};Jp.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Jp.getPolygons(t,new Fe)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Ma?r.add(n):n instanceof Au&&n.apply(new Jp(r)),r}};var xs=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};xs.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Bd){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(n),null}t instanceof Oo&&this._lines.add(t)};xs.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};xs.prototype.interfaces_=function(){return[rm]};xs.prototype.getClass=function(){return xs};xs.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(xs.getLines(t))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(xs.getLines(n,r))}};xs.getLines=function(){if(arguments.length===1){var t=arguments[0];return xs.getLines(t,!1)}else if(arguments.length===2){if(Ot(arguments[0],ba)&&Ot(arguments[1],ba)){for(var n=arguments[0],r=arguments[1],o=n.iterator();o.hasNext();){var a=o.next();xs.getLines(a,r)}return r}else if(arguments[0]instanceof Mt&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1],l=new Fe;return s.apply(new xs(l,u)),l}else if(arguments[0]instanceof Mt&&Ot(arguments[1],ba)){var c=arguments[0],f=arguments[1];return c instanceof Oo?f.add(c):c.apply(new xs(f)),f}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Ot(arguments[0],ba)&&Ot(arguments[1],ba)){for(var h=arguments[0],d=arguments[1],p=arguments[2],_=h.iterator();_.hasNext();){var y=_.next();xs.getLines(y,d,p)}return d}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Mt&&Ot(arguments[1],ba)){var v=arguments[0],w=arguments[1],C=arguments[2];return v.apply(new xs(w,C)),w}}};var If=function(){if(this._boundaryRule=zc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new ho("Rule must be non-null");this._boundaryRule=t}}};If.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof ae&&arguments[1]instanceof Ma){var n=arguments[0],r=arguments[1];if(r.isEmpty())return he.EXTERIOR;var o=r.getExteriorRing(),a=this.locateInPolygonRing(n,o);if(a===he.EXTERIOR)return he.EXTERIOR;if(a===he.BOUNDARY)return he.BOUNDARY;for(var s=0;s<r.getNumInteriorRing();s++){var u=r.getInteriorRingN(s),l=t.locateInPolygonRing(n,u);if(l===he.INTERIOR)return he.EXTERIOR;if(l===he.BOUNDARY)return he.BOUNDARY}return he.INTERIOR}else if(arguments[0]instanceof ae&&arguments[1]instanceof Oo){var c=arguments[0],f=arguments[1];if(!f.getEnvelopeInternal().intersects(c))return he.EXTERIOR;var h=f.getCoordinates();return!f.isClosed()&&(c.equals(h[0])||c.equals(h[h.length-1]))?he.BOUNDARY:He.isOnLine(c,h)?he.INTERIOR:he.EXTERIOR}else if(arguments[0]instanceof ae&&arguments[1]instanceof Il){var d=arguments[0],p=arguments[1],_=p.getCoordinate();return _.equals2D(d)?he.INTERIOR:he.EXTERIOR}};If.prototype.locateInPolygonRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?He.locatePointInRing(t,n.getCoordinates()):he.EXTERIOR};If.prototype.intersects=function(t,n){return this.locate(t,n)!==he.EXTERIOR};If.prototype.updateLocationInfo=function(t){t===he.INTERIOR&&(this._isIn=!0),t===he.BOUNDARY&&this._numBoundaries++};If.prototype.computeLocation=function(t,n){var r=this;if(n instanceof Il&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof Oo)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Ma)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof o_)for(var o=n,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);r.updateLocationInfo(r.locateInternal(t,s))}else if(n instanceof Rd)for(var u=n,l=0;l<u.getNumGeometries();l++){var c=u.getGeometryN(l);r.updateLocationInfo(r.locateInternal(t,c))}else if(n instanceof Au)for(var f=new Od(n);f.hasNext();){var h=f.next();h!==n&&r.computeLocation(t,h)}};If.prototype.locate=function(t,n){return n.isEmpty()?he.EXTERIOR:n instanceof Oo?this.locateInternal(t,n):n instanceof Ma?this.locateInternal(t,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,n),this._boundaryRule.isInBoundary(this._numBoundaries)?he.BOUNDARY:this._numBoundaries>0||this._isIn?he.INTERIOR:he.EXTERIOR)};If.prototype.interfaces_=function(){return[]};If.prototype.getClass=function(){return If};var wu=function e(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._component=r,this._segIndex=o,this._pt=a}},lie={INSIDE_AREA:{configurable:!0}};wu.prototype.isInsideArea=function(){return this._segIndex===wu.INSIDE_AREA};wu.prototype.getCoordinate=function(){return this._pt};wu.prototype.getGeometryComponent=function(){return this._component};wu.prototype.getSegmentIndex=function(){return this._segIndex};wu.prototype.interfaces_=function(){return[]};wu.prototype.getClass=function(){return wu};lie.INSIDE_AREA.get=function(){return-1};Object.defineProperties(wu,lie);var Tg=function(t){this._pts=t||null};Tg.prototype.filter=function(t){t instanceof Il&&this._pts.add(t)};Tg.prototype.interfaces_=function(){return[Nh]};Tg.prototype.getClass=function(){return Tg};Tg.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof Il?Af.singletonList(t):Tg.getPoints(t,new Fe)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Il?r.add(n):n instanceof Au&&n.apply(new Tg(r)),r}};var Sv=function(){this._locations=null;var t=arguments[0];this._locations=t};Sv.prototype.filter=function(t){(t instanceof Il||t instanceof Oo||t instanceof Ma)&&this._locations.add(new wu(t,0,t.getCoordinate()))};Sv.prototype.interfaces_=function(){return[Nh]};Sv.prototype.getClass=function(){return Sv};Sv.getLocations=function(t){var n=new Fe;return t.apply(new Sv(n)),n};var As=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new If,this._minDistanceLocation=null,this._minDistance=Qt.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=o,this._terminateDistance=a}};As.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=1-r,s=Jp.getPolygons(this._geom[r]);if(s.size()>0){var u=Sv.getLocations(this._geom[a]);if(this.computeContainmentDistance(u,s,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=o[0],this._minDistanceLocation[r]=o[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Ot(arguments[0],wf)&&Ot(arguments[1],wf)){for(var l=arguments[0],c=arguments[1],f=arguments[2],h=0;h<l.size();h++)for(var d=l.get(h),p=0;p<c.size();p++)if(t.computeContainmentDistance(d,c.get(p),f),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof wu&&arguments[1]instanceof Ma){var _=arguments[0],y=arguments[1],v=arguments[2],w=_.getCoordinate();if(he.EXTERIOR!==this._ptLocator.locate(w,y))return this._minDistance=0,v[0]=_,v[1]=new wu(y,w),null}}};As.prototype.computeMinDistanceLinesPoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};As.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),n=xs.getLines(this._geom[0]),r=xs.getLines(this._geom[1]),o=Tg.getPoints(this._geom[0]),a=Tg.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,a,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(o,a,t),this.updateMinDistance(t,!1)};As.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};As.prototype.updateMinDistance=function(t,n){if(t[0]===null)return null;n?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};As.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};As.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Oo&&arguments[1]instanceof Il){var n=arguments[0],r=arguments[1],o=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var a=n.getCoordinates(),s=r.getCoordinate(),u=0;u<a.length-1;u++){var l=He.distancePointLine(s,a[u],a[u+1]);if(l<t._minDistance){t._minDistance=l;var c=new dt(a[u],a[u+1]),f=c.closestPoint(s);o[0]=new wu(n,u,f),o[1]=new wu(r,0,s)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Oo&&arguments[1]instanceof Oo){var h=arguments[0],d=arguments[1],p=arguments[2];if(h.getEnvelopeInternal().distance(d.getEnvelopeInternal())>this._minDistance)return null;for(var _=h.getCoordinates(),y=d.getCoordinates(),v=0;v<_.length-1;v++)for(var w=0;w<y.length-1;w++){var C=He.distanceLineLine(_[v],_[v+1],y[w],y[w+1]);if(C<t._minDistance){t._minDistance=C;var E=new dt(_[v],_[v+1]),S=new dt(y[w],y[w+1]),A=E.closestPoints(S);p[0]=new wu(h,v,A[0]),p[1]=new wu(d,w,A[1])}if(t._minDistance<=t._terminateDistance)return null}}}};As.prototype.computeMinDistancePoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u),c=s.getCoordinate().distance(l.getCoordinate());if(c<o._minDistance&&(o._minDistance=c,r[0]=new wu(s,0,s.getCoordinate()),r[1]=new wu(l,0,l.getCoordinate())),o._minDistance<=o._terminateDistance)return null}};As.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new ho("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};As.prototype.computeMinDistanceLines=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};As.prototype.interfaces_=function(){return[]};As.prototype.getClass=function(){return As};As.distance=function(t,n){var r=new As(t,n);return r.distance()};As.isWithinDistance=function(t,n,r){var o=new As(t,n,r);return o.distance()<=r};As.nearestPoints=function(t,n){var r=new As(t,n);return r.nearestPoints()};var qs=function(){this._pt=[new ae,new ae],this._distance=Qt.NaN,this._isNull=!0};qs.prototype.getCoordinates=function(){return this._pt};qs.prototype.getCoordinate=function(t){return this._pt[t]};qs.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};qs.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};qs.prototype.toString=function(){return Ef.toLineString(this._pt[0],this._pt[1])};qs.prototype.getDistance=function(){return this._distance};qs.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};qs.prototype.interfaces_=function(){return[]};qs.prototype.getClass=function(){return qs};var Dh=function(){};Dh.prototype.interfaces_=function(){return[]};Dh.prototype.getClass=function(){return Dh};Dh.computeDistance=function(){if(arguments[2]instanceof qs&&arguments[0]instanceof Oo&&arguments[1]instanceof ae)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=new dt,a=t.getCoordinates(),s=0;s<a.length-1;s++){o.setCoordinates(a[s],a[s+1]);var u=o.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof qs&&arguments[0]instanceof Ma&&arguments[1]instanceof ae){var l=arguments[0],c=arguments[1],f=arguments[2];Dh.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)Dh.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof qs&&arguments[0]instanceof Mt&&arguments[1]instanceof ae){var d=arguments[0],p=arguments[1],_=arguments[2];if(d instanceof Oo)Dh.computeDistance(d,p,_);else if(d instanceof Ma)Dh.computeDistance(d,p,_);else if(d instanceof Au)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);Dh.computeDistance(w,p,_)}else _.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof qs&&arguments[0]instanceof dt&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var Fc=function(){this._g0=null,this._g1=null,this._ptDist=new qs,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n},_V={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Fc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Fc.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new ho("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};Fc.prototype.compute=function(t,n){this.computeOrientedDistance(t,n,this._ptDist),this.computeOrientedDistance(n,t,this._ptDist)};Fc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Fc.prototype.computeOrientedDistance=function(t,n,r){var o=new Av(n);if(t.apply(o),r.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var a=new Rg(n,this._densifyFrac);t.apply(a),r.setMaximum(a.getMaxPointDistance())}};Fc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Fc.prototype.interfaces_=function(){return[]};Fc.prototype.getClass=function(){return Fc};Fc.distance=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Fc(t,n);return r.distance()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Fc(o,a);return u.setDensifyFraction(s),u.distance()}};_V.MaxPointDistanceFilter.get=function(){return Av};_V.MaxDensifiedByFractionDistanceFilter.get=function(){return Rg};Object.defineProperties(Fc,_V);var Av=function(){this._maxPtDist=new qs,this._minPtDist=new qs,this._euclideanDist=new Dh,this._geom=null;var t=arguments[0];this._geom=t};Av.prototype.filter=function(t){this._minPtDist.initialize(),Dh.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Av.prototype.getMaxPointDistance=function(){return this._maxPtDist};Av.prototype.interfaces_=function(){return[Nd]};Av.prototype.getClass=function(){return Av};var Rg=function(){this._maxPtDist=new qs,this._minPtDist=new qs,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))};Rg.prototype.filter=function(t,n){var r=this;if(n===0)return null;for(var o=t.getCoordinate(n-1),a=t.getCoordinate(n),s=(a.x-o.x)/this._numSubSegs,u=(a.y-o.y)/this._numSubSegs,l=0;l<this._numSubSegs;l++){var c=o.x+l*s,f=o.y+l*u,h=new ae(c,f);r._minPtDist.initialize(),Dh.computeDistance(r._geom,h,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Rg.prototype.isDone=function(){return!1};Rg.prototype.isGeometryChanged=function(){return!1};Rg.prototype.getMaxPointDistance=function(){return this._maxPtDist};Rg.prototype.interfaces_=function(){return[Tf]};Rg.prototype.getClass=function(){return Rg};var Al=function(t,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=r||null},yV={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Al.prototype.checkMaximumDistance=function(t,n,r){var o=new Fc(n,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var a=o.getCoordinates();this._errorLocation=a[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ef.toLineString(a[0],a[1])+")"}};Al.prototype.isValid=function(){var t=Math.abs(this._bufDistance),n=Al.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Al.VERBOSE&&Ss.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};Al.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ma||this._input instanceof Rd||this._input instanceof Au))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};Al.prototype.getErrorIndicator=function(){return this._errorIndicator};Al.prototype.checkMinimumDistance=function(t,n,r){var o=new As(t,n,r);if(this._minDistanceFound=o.distance(),this._minDistanceFound<r){this._isValid=!1;var a=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ef.toLineString(a[0],a[1])+" )"}};Al.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};Al.prototype.getErrorLocation=function(){return this._errorLocation};Al.prototype.getPolygonLines=function(t){for(var n=new Fe,r=new xs(n),o=Jp.getPolygons(t),a=o.iterator();a.hasNext();){var s=a.next();s.apply(r)}return t.getFactory().buildGeometry(n)};Al.prototype.getErrorMessage=function(){return this._errMsg};Al.prototype.interfaces_=function(){return[]};Al.prototype.getClass=function(){return Al};yV.VERBOSE.get=function(){return!1};yV.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Al,yV);var bs=function(t,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=r||null},vV={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};bs.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};bs.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*bs.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var n=new ct(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new ct(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};bs.prototype.checkDistance=function(){var t=new Al(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};bs.prototype.checkArea=function(){var t=this._input.getArea(),n=this._result.getArea();this._distance>0&&t>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};bs.prototype.checkPolygonal=function(){this._result instanceof Ma||this._result instanceof Rd||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};bs.prototype.getErrorIndicator=function(){return this._errorIndicator};bs.prototype.getErrorLocation=function(){return this._errorLocation};bs.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};bs.prototype.report=function(t){if(!bs.VERBOSE)return null;Ss.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};bs.prototype.getErrorMessage=function(){return this._errorMsg};bs.prototype.interfaces_=function(){return[]};bs.prototype.getClass=function(){return bs};bs.isValidMsg=function(t,n,r){var o=new bs(t,n,r);return o.isValid()?null:o.getErrorMessage()};bs.isValid=function(t,n,r){var o=new bs(t,n,r);return!!o.isValid()};vV.VERBOSE.get=function(){return!1};vV.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(bs,vV);var Gh=function(){this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};Gh.prototype.getCoordinates=function(){return this._pts};Gh.prototype.size=function(){return this._pts.length};Gh.prototype.getCoordinate=function(t){return this._pts[t]};Gh.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Gh.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:xv.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Gh.prototype.setData=function(t){this._data=t};Gh.prototype.getData=function(){return this._data};Gh.prototype.toString=function(){return Ef.toLineString(new jo(this._pts))};Gh.prototype.interfaces_=function(){return[zd]};Gh.prototype.getClass=function(){return Gh};var ts=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Fe,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};ts.prototype.getInteriorIntersection=function(){return this._interiorIntersection};ts.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};ts.prototype.getIntersectionSegments=function(){return this._intSegments};ts.prototype.count=function(){return this._intersectionCount};ts.prototype.getIntersections=function(){return this._intersections};ts.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};ts.prototype.setKeepIntersections=function(t){this._keepIntersections=t};ts.prototype.processIntersections=function(t,n,r,o){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&n===o)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(t,n)||this.isEndSegment(r,o);if(!a)return null}var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=u,this._intSegments[2]=l,this._intSegments[3]=c,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};ts.prototype.isEndSegment=function(t,n){return n===0||n>=t.size()-2};ts.prototype.hasIntersection=function(){return this._interiorIntersection!==null};ts.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};ts.prototype.interfaces_=function(){return[u_]};ts.prototype.getClass=function(){return ts};ts.createAllIntersectionsFinder=function(t){var n=new ts(t);return n.setFindAllIntersections(!0),n};ts.createAnyIntersectionFinder=function(t){return new ts(t)};ts.createIntersectionCounter=function(t){var n=new ts(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var Df=function(){this._li=new m_,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Df.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};Df.prototype.getIntersections=function(){return this._segInt.getIntersections()};Df.prototype.isValid=function(){return this.execute(),this._isValid};Df.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Df.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ts(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new mV;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};Df.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new im(this.getErrorMessage(),this._segInt.getInteriorIntersection())};Df.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ef.toLineString(t[0],t[1])+" and "+Ef.toLineString(t[2],t[3])};Df.prototype.interfaces_=function(){return[]};Df.prototype.getClass=function(){return Df};Df.computeIntersections=function(t){var n=new Df(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var f_=function e(){this._nv=null;var t=arguments[0];this._nv=new Df(e.toSegmentStrings(t))};f_.prototype.checkValid=function(){this._nv.checkValid()};f_.prototype.interfaces_=function(){return[]};f_.prototype.getClass=function(){return f_};f_.toSegmentStrings=function(t){for(var n=new Fe,r=t.iterator();r.hasNext();){var o=r.next();n.add(new Gh(o.getCoordinates(),o))}return n};f_.checkValid=function(t){var n=new f_(t);n.checkValid()};var bv=function(t){this._mapOp=t};bv.prototype.map=function(t){for(var n=this,r=new Fe,o=0;o<t.getNumGeometries();o++){var a=n._mapOp.map(t.getGeometryN(o));a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(mn.toGeometryArray(r))};bv.prototype.interfaces_=function(){return[]};bv.prototype.getClass=function(){return bv};bv.map=function(t,n){var r=new bv(n);return r.map(t)};var Uh=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Fe,this._resultLineList=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=r};Uh.prototype.collectLines=function(t){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var o=r.next();n.collectLineEdge(o,t,n._lineEdgesList),n.collectBoundaryTouchEdge(o,t,n._lineEdgesList)}};Uh.prototype.labelIsolatedLine=function(t,n){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(n));t.getLabel().setLocation(n,r)};Uh.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};Uh.prototype.collectLineEdge=function(t,n,r){var o=t.getLabel(),a=t.getEdge();t.isLineEdge()&&!t.isVisited()&&Zt.isResultOfOp(o,n)&&!a.isCovered()&&(r.add(a),t.setVisitedEdge(!0))};Uh.prototype.findCoveredLineEdges=function(){for(var t=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var o=this._op.getGraph().getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getEdge();if(a.isLineEdge()&&!s.isCoveredSet()){var u=t._op.isCoveredByA(a.getCoordinate());s.setCovered(u)}}};Uh.prototype.labelIsolatedLines=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();o.isIsolated()&&(a.isNull(0)?n.labelIsolatedLine(o,0):n.labelIsolatedLine(o,1))}};Uh.prototype.buildLines=function(t){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var o=r.next(),a=n._geometryFactory.createLineString(o.getCoordinates());n._resultLineList.add(a),o.setInResult(!0)}};Uh.prototype.collectBoundaryTouchEdge=function(t,n,r){var o=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;an.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),Zt.isResultOfOp(o,n)&&n===Zt.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};Uh.prototype.interfaces_=function(){return[]};Uh.prototype.getClass=function(){return Uh};var Iv=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Fe;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n};Iv.prototype.filterCoveredNodeToPoint=function(t){var n=t.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};Iv.prototype.extractNonCoveredResultNodes=function(t){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isInResult()&&!o.isIncidentEdgeInResult()&&(o.getEdges().getDegree()===0||t===Zt.INTERSECTION)){var a=o.getLabel();Zt.isResultOfOp(a,t)&&n.filterCoveredNodeToPoint(o)}}};Iv.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Iv.prototype.interfaces_=function(){return[]};Iv.prototype.getClass=function(){return Iv};var Qu=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Qu.prototype.transformPoint=function(t,n){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};Qu.prototype.transformPolygon=function(t,n){var r=this,o=!0,a=this.transformLinearRing(t.getExteriorRing(),t);(a===null||!(a instanceof Bd)||a.isEmpty())&&(o=!1);for(var s=new Fe,u=0;u<t.getNumInteriorRing();u++){var l=r.transformLinearRing(t.getInteriorRingN(u),t);l===null||l.isEmpty()||(l instanceof Bd||(o=!1),s.add(l))}if(o)return this._factory.createPolygon(a,s.toArray([]));var c=new Fe;return a!==null&&c.add(a),c.addAll(s),this._factory.buildGeometry(c)};Qu.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};Qu.prototype.getInputGeometry=function(){return this._inputGeom};Qu.prototype.transformMultiLineString=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformLineString(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Qu.prototype.transformCoordinates=function(t,n){return this.copy(t)};Qu.prototype.transformLineString=function(t,n){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};Qu.prototype.transformMultiPoint=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformPoint(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Qu.prototype.transformMultiPolygon=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformPolygon(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Qu.prototype.copy=function(t){return t.copy()};Qu.prototype.transformGeometryCollection=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transform(t.getGeometryN(a));s!==null&&(r._pruneEmptyGeometry&&s.isEmpty()||o.add(s))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(mn.toGeometryArray(o)):this._factory.buildGeometry(o)};Qu.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Il)return this.transformPoint(t,null);if(t instanceof U1)return this.transformMultiPoint(t,null);if(t instanceof Bd)return this.transformLinearRing(t,null);if(t instanceof Oo)return this.transformLineString(t,null);if(t instanceof o_)return this.transformMultiLineString(t,null);if(t instanceof Ma)return this.transformPolygon(t,null);if(t instanceof Rd)return this.transformMultiPolygon(t,null);if(t instanceof Au)return this.transformGeometryCollection(t,null);throw new ho("Unknown Geometry subtype: "+t.getClass().getName())};Qu.prototype.transformLinearRing=function(t,n){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var o=r.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};Qu.prototype.interfaces_=function(){return[]};Qu.prototype.getClass=function(){return Qu};var Gd=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new dt,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Oo&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],o=arguments[1];this._srcPts=r,this._isClosed=e.isClosed(r),this._snapTolerance=o}};Gd.prototype.snapVertices=function(t,n){for(var r=this,o=this._isClosed?t.size()-1:t.size(),a=0;a<o;a++){var s=t.get(a),u=r.findSnapForVertex(s,n);u!==null&&(t.set(a,new ae(u)),a===0&&r._isClosed&&t.set(t.size()-1,new ae(u)))}};Gd.prototype.findSnapForVertex=function(t,n){for(var r=this,o=0;o<n.length;o++){if(t.equals2D(n[o]))return null;if(t.distance(n[o])<r._snapTolerance)return n[o]}return null};Gd.prototype.snapTo=function(t){var n=new ZA(this._srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var r=n.toCoordinateArray();return r};Gd.prototype.snapSegments=function(t,n){var r=this;if(n.length===0)return null;var o=n.length;n[0].equals2D(n[n.length-1])&&(o=n.length-1);for(var a=0;a<o;a++){var s=n[a],u=r.findSegmentIndexToSnap(s,t);u>=0&&t.add(u+1,new ae(s),!1)}};Gd.prototype.findSegmentIndexToSnap=function(t,n){for(var r=this,o=Qt.MAX_VALUE,a=-1,s=0;s<n.size()-1;s++){if(r._seg.p0=n.get(s),r._seg.p1=n.get(s+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var u=r._seg.distance(t);u<r._snapTolerance&&u<o&&(o=u,a=s)}return a};Gd.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};Gd.prototype.interfaces_=function(){return[]};Gd.prototype.getClass=function(){return Gd};Gd.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var Ko=function(t){this._srcGeom=t||null},cie={SNAP_PRECISION_FACTOR:{configurable:!0}};Ko.prototype.snapTo=function(t,n){var r=this.extractTargetCoordinates(t),o=new fie(n,r);return o.transform(this._srcGeom)};Ko.prototype.snapToSelf=function(t,n){var r=this.extractTargetCoordinates(this._srcGeom),o=new fie(t,r,!0),a=o.transform(this._srcGeom),s=a;return n&&Ot(s,bg)&&(s=a.buffer(0)),s};Ko.prototype.computeSnapTolerance=function(t){var n=this.computeMinimumSegmentLength(t),r=n/10;return r};Ko.prototype.extractTargetCoordinates=function(t){for(var n=new Oh,r=t.getCoordinates(),o=0;o<r.length;o++)n.add(r[o]);return n.toArray(new Array(0).fill(null))};Ko.prototype.computeMinimumSegmentLength=function(t){for(var n=Qt.MAX_VALUE,r=0;r<t.length-1;r++){var o=t[r].distance(t[r+1]);o<n&&(n=o)}return n};Ko.prototype.interfaces_=function(){return[]};Ko.prototype.getClass=function(){return Ko};Ko.snap=function(t,n,r){var o=new Array(2).fill(null),a=new Ko(t);o[0]=a.snapTo(n,r);var s=new Ko(n);return o[1]=s.snapTo(o[0],r),o};Ko.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=Ko.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===Xr.FIXED){var o=1/r.getScale()*2/1.415;o>n&&(n=o)}return n}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return Math.min(Ko.computeOverlaySnapTolerance(a),Ko.computeOverlaySnapTolerance(s))}};Ko.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),o=r*Ko.SNAP_PRECISION_FACTOR;return o};Ko.snapToSelf=function(t,n,r){var o=new Ko(t);return o.snapToSelf(n,r)};cie.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Ko,cie);var fie=function(e){function t(n,r,o){e.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=o!==void 0?o:!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,o){var a=new Gd(r,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(o)},t.prototype.transformCoordinates=function(r,o){var a=r.toCoordinateArray(),s=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(s)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Qu),Cu=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Cu.prototype.getCommon=function(){return Qt.longBitsToDouble(this._commonBits)};Cu.prototype.add=function(t){var n=Qt.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=Cu.signExpBits(this._commonBits),this._isFirst=!1,null;var r=Cu.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Cu.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=Cu.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};Cu.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],n=Qt.longBitsToDouble(t),r=Qt.toBinaryString(t),o="0000000000000000000000000000000000000000000000000000000000000000"+r,a=o.substring(o.length-64),s=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+n+" ]";return s}};Cu.prototype.interfaces_=function(){return[]};Cu.prototype.getClass=function(){return Cu};Cu.getBit=function(t,n){var r=1<<n;return(t&r)!==0?1:0};Cu.signExpBits=function(t){return t>>52};Cu.zeroLowerBits=function(t,n){var r=(1<<n)-1,o=~r,a=t&o;return a};Cu.numCommonMostSigMantissaBits=function(t,n){for(var r=0,o=52;o>=0;o--){if(Cu.getBit(t,o)!==Cu.getBit(n,o))return r;r++}return 52};var Og=function(){this._commonCoord=null,this._ccFilter=new Dv},CV={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Og.prototype.addCommonBits=function(t){var n=new Ng(this._commonCoord);t.apply(n),t.geometryChanged()};Og.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var n=new ae(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new Ng(n);return t.apply(r),t.geometryChanged(),t};Og.prototype.getCommonCoordinate=function(){return this._commonCoord};Og.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Og.prototype.interfaces_=function(){return[]};Og.prototype.getClass=function(){return Og};CV.CommonCoordinateFilter.get=function(){return Dv};CV.Translater.get=function(){return Ng};Object.defineProperties(Og,CV);var Dv=function(){this._commonBitsX=new Cu,this._commonBitsY=new Cu};Dv.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};Dv.prototype.getCommonCoordinate=function(){return new ae(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Dv.prototype.interfaces_=function(){return[Nd]};Dv.prototype.getClass=function(){return Dv};var Ng=function(){this.trans=null;var t=arguments[0];this.trans=t};Ng.prototype.filter=function(t,n){var r=t.getOrdinate(n,0)+this.trans.x,o=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,r),t.setOrdinate(n,1,o)};Ng.prototype.isDone=function(){return!1};Ng.prototype.isGeometryChanged=function(){return!0};Ng.prototype.interfaces_=function(){return[Tf]};Ng.prototype.getClass=function(){return Ng};var ns=function(t,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()};ns.prototype.selfSnap=function(t){var n=new Ko(t),r=n.snapTo(t,this._snapTolerance);return r};ns.prototype.removeCommonBits=function(t){this._cbr=new Og,this._cbr.add(t[0]),this._cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t[0].copy()),n[1]=this._cbr.removeCommonBits(t[1].copy()),n};ns.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};ns.prototype.getResultGeometry=function(t){var n=this.snap(this._geom),r=Zt.overlayOp(n[0],n[1],t);return this.prepareResult(r)};ns.prototype.checkValid=function(t){t.isValid()||Ss.out.println("Snapped geometry is invalid")};ns.prototype.computeSnapTolerance=function(){this._snapTolerance=Ko.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};ns.prototype.snap=function(t){var n=this.removeCommonBits(t),r=Ko.snap(n[0],n[1],this._snapTolerance);return r};ns.prototype.interfaces_=function(){return[]};ns.prototype.getClass=function(){return ns};ns.overlayOp=function(t,n,r){var o=new ns(t,n);return o.getResultGeometry(r)};ns.union=function(t,n){return ns.overlayOp(t,n,Zt.UNION)};ns.intersection=function(t,n){return ns.overlayOp(t,n,Zt.INTERSECTION)};ns.symDifference=function(t,n){return ns.overlayOp(t,n,Zt.SYMDIFFERENCE)};ns.difference=function(t,n){return ns.overlayOp(t,n,Zt.DIFFERENCE)};var Du=function(t,n){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n};Du.prototype.getResultGeometry=function(t){var n=null,r=!1,o=null;try{n=Zt.overlayOp(this._geom[0],this._geom[1],t);var a=!0;a&&(r=!0)}catch(s){if(s instanceof nm)o=s;else throw s}finally{}if(!r)try{n=ns.overlayOp(this._geom[0],this._geom[1],t)}catch(s){throw s instanceof nm?o:s}finally{}return n};Du.prototype.interfaces_=function(){return[]};Du.prototype.getClass=function(){return Du};Du.overlayOp=function(t,n,r){var o=new Du(t,n);return o.getResultGeometry(r)};Du.union=function(t,n){return Du.overlayOp(t,n,Zt.UNION)};Du.intersection=function(t,n){return Du.overlayOp(t,n,Zt.INTERSECTION)};Du.symDifference=function(t,n){return Du.overlayOp(t,n,Zt.SYMDIFFERENCE)};Du.difference=function(t,n){return Du.overlayOp(t,n,Zt.DIFFERENCE)};var VA=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n};VA.prototype.computeIntersections=function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)};VA.prototype.interfaces_=function(){return[]};VA.prototype.getClass=function(){return VA};var Ml=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._eventType=e.INSERT,this._label=r,this._xValue=o,this._obj=a}},xV={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ml.prototype.isDelete=function(){return this._eventType===Ml.DELETE};Ml.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};Ml.prototype.getObject=function(){return this._obj};Ml.prototype.compareTo=function(t){var n=t;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};Ml.prototype.getInsertEvent=function(){return this._insertEvent};Ml.prototype.isInsert=function(){return this._eventType===Ml.INSERT};Ml.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};Ml.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};Ml.prototype.interfaces_=function(){return[Gc]};Ml.prototype.getClass=function(){return Ml};xV.INSERT.get=function(){return 1};xV.DELETE.get=function(){return 2};Object.defineProperties(Ml,xV);var JL=function(){};JL.prototype.interfaces_=function(){return[]};JL.prototype.getClass=function(){return JL};var Is=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=r};Is.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(Is.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.getNumPoints()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};Is.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Is.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};Is.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Is.prototype.isBoundaryPointInternal=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next(),a=o.getCoordinate();if(t.isIntersection(a))return!0}return!1};Is.prototype.hasProperIntersection=function(){return this._hasProper};Is.prototype.hasIntersection=function(){return this._hasIntersection};Is.prototype.isDone=function(){return this._isDone};Is.prototype.isBoundaryPoint=function(t,n){return n===null?!1:!!(this.isBoundaryPointInternal(t,n[0])||this.isBoundaryPointInternal(t,n[1]))};Is.prototype.setBoundaryNodes=function(t,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=n};Is.prototype.addIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Is.prototype.interfaces_=function(){return[]};Is.prototype.getClass=function(){return Is};Is.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var KFe=function(e){function t(){e.call(this),this.events=new Fe,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;Af.sort(this.events);for(var o=0;o<this.events.size();o++){var a=r.events.get(o);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(o)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var o=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var s=r.events.get(a);if(s.isInsert()&&r.processOverlaps(a,s.getDeleteEventIndex(),s,o),o.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Is&&Ot(arguments[0],wf)&&Ot(arguments[1],wf)){var u=arguments[0],l=arguments[1],c=arguments[2];this.addEdges(u,u),this.addEdges(l,l),this.computeIntersections(c)}else if(typeof arguments[2]=="boolean"&&Ot(arguments[0],wf)&&arguments[1]instanceof Is){var f=arguments[0],h=arguments[1],d=arguments[2];d?this.addEdges(f,null):this.addEdges(f),this.computeIntersections(h)}}},t.prototype.addEdge=function(r,o){for(var a=this,s=r.getMonotoneChainEdge(),u=s.getStartIndexes(),l=0;l<u.length-1;l++){var c=new VA(s,l),f=new Ml(o,s.getMinX(l),c);a.events.add(f),a.events.add(new Ml(s.getMaxX(l),f))}},t.prototype.processOverlaps=function(r,o,a,s){for(var u=this,l=a.getObject(),c=r;c<o;c++){var f=u.events.get(c);if(f.isInsert()){var h=f.getObject();a.isSameLabel(f)||(l.computeIntersections(h,s),u.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var o=arguments[0],a=o.iterator();a.hasNext();){var s=a.next();r.addEdge(s,s)}else if(arguments.length===2)for(var u=arguments[0],l=arguments[1],c=u.iterator();c.hasNext();){var f=c.next();r.addEdge(f,l)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(JL),Ud=function(){this._min=Qt.POSITIVE_INFINITY,this._max=Qt.NEGATIVE_INFINITY},hie={NodeComparator:{configurable:!0}};Ud.prototype.getMin=function(){return this._min};Ud.prototype.intersects=function(t,n){return!(this._min>n||this._max<t)};Ud.prototype.getMax=function(){return this._max};Ud.prototype.toString=function(){return Ef.toLineString(new ae(this._min,0),new ae(this._max,0))};Ud.prototype.interfaces_=function(){return[]};Ud.prototype.getClass=function(){return Ud};hie.NodeComparator.get=function(){return kA};Object.defineProperties(Ud,hie);var kA=function(){};kA.prototype.compare=function(t,n){var r=t,o=n,a=(r._min+r._max)/2,s=(o._min+o._max)/2;return a<s?-1:a>s?1:0};kA.prototype.interfaces_=function(){return[N1]};kA.prototype.getClass=function(){return kA};var ZFe=function(e){function t(){e.call(this),this._item=null;var n=arguments[0],r=arguments[1],o=arguments[2];this._min=n,this._max=r,this._item=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;a.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ud),QFe=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,o){this._min=Math.min(r._min,o._min),this._max=Math.max(r._max,o._max)},t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;this._node1!==null&&this._node1.query(r,o,a),this._node2!==null&&this._node2.query(r,o,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ud),Hd=function(){this._leaves=new Fe,this._root=null,this._level=0};Hd.prototype.buildTree=function(){var t=this;Af.sort(this._leaves,new Ud.NodeComparator);for(var n=this._leaves,r=null,o=new Fe;;){if(t.buildLevel(n,o),o.size()===1)return o.get(0);r=n,n=o,o=r}};Hd.prototype.insert=function(t,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new ZFe(t,n,r))};Hd.prototype.query=function(t,n,r){this.init(),this._root.query(t,n,r)};Hd.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Hd.prototype.printNode=function(t){Ss.out.println(Ef.toLineString(new ae(t._min,this._level),new ae(t._max,this._level)))};Hd.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Hd.prototype.buildLevel=function(t,n){this._level++,n.clear();for(var r=0;r<t.size();r+=2){var o=t.get(r),a=r+1<t.size()?t.get(r):null;if(a===null)n.add(o);else{var s=new QFe(t.get(r),t.get(r+1));n.add(s)}}};Hd.prototype.interfaces_=function(){return[]};Hd.prototype.getClass=function(){return Hd};var j1=function(){this._items=new Fe};j1.prototype.visitItem=function(t){this._items.add(t)};j1.prototype.getItems=function(){return this._items};j1.prototype.interfaces_=function(){return[Ig]};j1.prototype.getClass=function(){return j1};var K1=function(){this._index=null;var t=arguments[0];if(!Ot(t,bg))throw new ho("Argument must be Polygonal");this._index=new h_(t)},wV={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};K1.prototype.locate=function(t){var n=new Mh(t),r=new Z1(n);return this._index.query(t.y,t.y,r),n.getLocation()};K1.prototype.interfaces_=function(){return[Y1]};K1.prototype.getClass=function(){return K1};wV.SegmentVisitor.get=function(){return Z1};wV.IntervalIndexedGeometry.get=function(){return h_};Object.defineProperties(K1,wV);var Z1=function(){this._counter=null;var t=arguments[0];this._counter=t};Z1.prototype.visitItem=function(t){var n=t;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};Z1.prototype.interfaces_=function(){return[Ig]};Z1.prototype.getClass=function(){return Z1};var h_=function(){this._index=new Hd;var t=arguments[0];this.init(t)};h_.prototype.init=function(t){for(var n=this,r=xs.getLines(t),o=r.iterator();o.hasNext();){var a=o.next(),s=a.getCoordinates();n.addLine(s)}};h_.prototype.addLine=function(t){for(var n=this,r=1;r<t.length;r++){var o=new dt(t[r-1],t[r]),a=Math.min(o.p0.y,o.p1.y),s=Math.max(o.p0.y,o.p1.y);n._index.insert(a,s,o)}};h_.prototype.query=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new j1;return this._index.query(t,n,r),r.getItems()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this._index.query(o,a,s)}};h_.prototype.interfaces_=function(){return[]};h_.prototype.getClass=function(){return h_};var uA=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new Zre,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new If,arguments.length===2){var n=arguments[0],r=arguments[1],o=zc.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=o,r!==null&&this.add(r)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this._argIndex=a,this._parentGeom=s,this._boundaryNodeRule=u,s!==null&&this.add(s)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,o){var a=this._nodes.addNode(o),s=a.getLabel(),u=1,l=he.NONE;l=s.getLocation(r,Me.ON),l===he.BOUNDARY&&u++;var c=t.determineBoundary(this._boundaryNodeRule,u);s.setLocation(r,c)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.computeSelfNodes(r,o,!1)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2],l=new Is(a,!0,!1);l.setIsDoneIfProperInt(u);var c=this.createEdgeSetIntersector(),f=this._parentGeom instanceof Bd||this._parentGeom instanceof Ma||this._parentGeom instanceof Rd,h=s||!f;return c.computeIntersections(this._edges,l,h),this.addSelfIntersectionNodes(this._argIndex),l}},t.prototype.computeSplitEdges=function(r){for(var o=this._edges.iterator();o.hasNext();){var a=o.next();a.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,o,a){var s=new Is(o,a,!0);s.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var u=this.createEdgeSetIntersector();return u.computeIntersections(this._edges,r._edges,s),s},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof Il){var r=arguments[0],o=r.getCoordinate();this.insertPoint(this._argIndex,o,he.INTERIOR)}else if(arguments[0]instanceof ae){var a=arguments[0];this.insertPoint(this._argIndex,a,he.INTERIOR)}},t.prototype.addPolygon=function(r){var o=this;this.addPolygonRing(r.getExteriorRing(),he.EXTERIOR,he.INTERIOR);for(var a=0;a<r.getNumInteriorRing();a++){var s=r.getInteriorRingN(a);o.addPolygonRing(s,he.INTERIOR,he.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var o=r.getCoordinates();this.insertPoint(this._argIndex,o[0],he.BOUNDARY),this.insertPoint(this._argIndex,o[o.length-1],he.BOUNDARY)},t.prototype.addLineString=function(r){var o=gn.removeRepeatedPoints(r.getCoordinates());if(o.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var a=new QL(o,new oi(this._argIndex,he.INTERIOR));this._lineEdgeMap.put(r,a),this.insertEdge(a),an.isTrue(o.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,o[0]),this.insertBoundaryPoint(this._argIndex,o[o.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),o=new Array(r.size()).fill(null),a=0,s=r.iterator();s.hasNext();){var u=s.next();o[a++]=u.getCoordinate().copy()}return o},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,o,a){if(this.isBoundaryNode(r,o))return null;a===he.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,o):this.insertPoint(r,o,a)},t.prototype.addPolygonRing=function(r,o,a){if(r.isEmpty())return null;var s=gn.removeRepeatedPoints(r.getCoordinates());if(s.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var u=o,l=a;He.isCCW(s)&&(u=a,l=o);var c=new QL(s,new oi(this._argIndex,he.BOUNDARY,u,l));this._lineEdgeMap.put(r,c),this.insertEdge(c),this.insertPoint(this._argIndex,s[0],he.BOUNDARY)},t.prototype.insertPoint=function(r,o,a){var s=this._nodes.addNode(o),u=s.getLabel();u===null?s._label=new oi(r,a):u.setLocation(r,a)},t.prototype.createEdgeSetIntersector=function(){return new KFe},t.prototype.addSelfIntersectionNodes=function(r){for(var o=this,a=this._edges.iterator();a.hasNext();)for(var s=a.next(),u=s.getLabel().getLocation(r),l=s.eiList.iterator();l.hasNext();){var c=l.next();o.addSelfIntersectionNode(r,c.coord,u)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof Rd&&(this._useBoundaryDeterminationRule=!1),r instanceof Ma)this.addPolygon(r);else if(r instanceof Oo)this.addLineString(r);else if(r instanceof Il)this.addPoint(r);else if(r instanceof U1)this.addCollection(r);else if(r instanceof o_)this.addCollection(r);else if(r instanceof Rd)this.addCollection(r);else if(r instanceof Au)this.addCollection(r);else throw new Error(r.getClass().getName())}else return e.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var o=this,a=0;a<r.getNumGeometries();a++){var s=r.getGeometryN(a);o.add(s)}},t.prototype.locate=function(r){return Ot(this._parentGeom,bg)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new K1(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,o){return r.isInBoundary(o)?he.BOUNDARY:he.INTERIOR},t}(Ao),Q1=function(){if(this._li=new m_,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new uA(0,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=zc.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new uA(0,n,o),this._arg[1]=new uA(1,r,o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];a.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new uA(0,a,u),this._arg[1]=new uA(1,s,u)}};Q1.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};Q1.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};Q1.prototype.interfaces_=function(){return[]};Q1.prototype.getClass=function(){return Q1};var n_=function(){};n_.prototype.interfaces_=function(){return[]};n_.prototype.getClass=function(){return n_};n_.map=function(){if(arguments[0]instanceof Mt&&Ot(arguments[1],n_.MapOp)){for(var t=arguments[0],n=arguments[1],r=new Fe,o=0;o<t.getNumGeometries();o++){var a=n.map(t.getGeometryN(o));a!==null&&r.add(a)}return t.getFactory().buildGeometry(r)}else if(Ot(arguments[0],ba)&&Ot(arguments[1],n_.MapOp)){for(var s=arguments[0],u=arguments[1],l=new Fe,c=s.iterator();c.hasNext();){var f=c.next(),h=u.map(f);h!==null&&l.add(h)}return l}};n_.MapOp=function(){};var Zt=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r),this._ptLocator=new If,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new bf,this._resultPolyList=new Fe,this._resultLineList=new Fe,this._resultPointList=new Fe,this._graph=new Ao(new rie),this._geomFact=n.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var o=this._edgeList.findEqualEdge(r);if(o!==null){var a=o.getLabel(),s=r.getLabel();o.isPointwiseEqual(r)||(s=new oi(r.getLabel()),s.flip());var u=o.getDepth();u.isNull()&&u.add(a),u.add(s),a.merge(s)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var o=r.next(),a=o.getSym();o.isInResult()&&a.isInResult()&&(o.setInResult(!1),a.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,o,a,s){var u=new Fe;return u.addAll(r),u.addAll(o),u.addAll(a),u.isEmpty()?t.createEmptyResult(s,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(u)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next();o.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,o){for(var a=this,s=o.iterator();s.hasNext();){var u=s.next(),l=a._ptLocator.locate(r,u);if(l!==he.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new Fe,o=this._edgeList.iterator();o.hasNext();){var a=o.next();a.isCollapsed()&&(o.remove(),r.add(a.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next(),a=o.getEdges().getLabel();o.getLabel().merge(a)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var o=this,a=r.iterator();a.hasNext();){var s=a.next();o.insertUniqueEdge(s)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var o=new Fe;this._arg[0].computeSplitEdges(o),this._arg[1].computeSplitEdges(o),this.insertUniqueEdges(o),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),f_.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var a=new Dl(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var s=new Uh(this,this._geomFact,this._ptLocator);this._resultLineList=s.build(r);var u=new Iv(this,this._geomFact,this._ptLocator);this._resultPointList=u.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,o){var a=this._ptLocator.locate(r.getCoordinate(),this._arg[o].getGeometry());r.getLabel().setLocation(o,a)},t.prototype.copyPoints=function(r){for(var o=this,a=this._arg[r].getNodeIterator();a.hasNext();){var s=a.next(),u=o._graph.addNode(s.getCoordinate());u.setLabel(r,s.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var o=this._graph.getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.isArea()&&!a.isInteriorAreaEdge()&&t.isResultOfOp(s.getLocation(0,Me.RIGHT),s.getLocation(1,Me.RIGHT),r)&&a.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var o=r.next(),a=o.getLabel(),s=o.getDepth();if(!s.isNull()){s.normalize();for(var u=0;u<2;u++)!a.isNull(u)&&a.isArea()&&!s.isNull(u)&&(s.getDelta(u)===0?a.toLine(u):(an.isTrue(!s.isNull(u,Me.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(u,Me.LEFT,s.getLocation(u,Me.LEFT)),an.isTrue(!s.isNull(u,Me.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(u,Me.RIGHT,s.getLocation(u,Me.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next();a.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();a.isIsolated()&&(s.isNull(0)?r.labelIncompleteNode(a,0):r.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(s)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Q1);Zt.overlayOp=function(e,t,n){var r=new Zt(e,t),o=r.getResultGeometry(n);return o};Zt.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return Zt.createEmptyResult(Zt.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return bv.map(e,{interfaces_:function(){return[n_.MapOp]},map:function(r){return r.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Du.overlayOp(e,t,Zt.INTERSECTION)};Zt.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return Zt.createEmptyResult(Zt.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Du.overlayOp(e,t,Zt.SYMDIFFERENCE)};Zt.resultDimension=function(e,t,n){var r=t.getDimension(),o=n.getDimension(),a=-1;switch(e){case Zt.INTERSECTION:a=Math.min(r,o);break;case Zt.UNION:a=Math.max(r,o);break;case Zt.DIFFERENCE:a=r;break;case Zt.SYMDIFFERENCE:a=Math.max(r,o);break;default:}return a};Zt.createEmptyResult=function(e,t,n,r){var o=null;switch(Zt.resultDimension(e,t,n)){case-1:o=r.createGeometryCollection(new Array(0).fill(null));break;case 0:o=r.createPoint();break;case 1:o=r.createLineString();break;case 2:o=r.createPolygon();break;default:}return o};Zt.difference=function(e,t){return e.isEmpty()?Zt.createEmptyResult(Zt.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Du.overlayOp(e,t,Zt.DIFFERENCE))};Zt.isResultOfOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=e.getLocation(0),r=e.getLocation(1);return Zt.isResultOfOp(n,r,t)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];switch(o===he.BOUNDARY&&(o=he.INTERIOR),a===he.BOUNDARY&&(a=he.INTERIOR),s){case Zt.INTERSECTION:return o===he.INTERIOR&&a===he.INTERIOR;case Zt.UNION:return o===he.INTERIOR||a===he.INTERIOR;case Zt.DIFFERENCE:return o===he.INTERIOR&&a!==he.INTERIOR;case Zt.SYMDIFFERENCE:return o===he.INTERIOR&&a!==he.INTERIOR||o!==he.INTERIOR&&a===he.INTERIOR;default:}return!1}};Zt.INTERSECTION=1;Zt.UNION=2;Zt.DIFFERENCE=3;Zt.SYMDIFFERENCE=4;var Sg=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new If,this._seg=new dt;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)};Sg.prototype.isWithinToleranceOfBoundary=function(t){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var o=n._linework.getGeometryN(r),a=o.getCoordinateSequence(),s=0;s<a.size()-1;s++){a.getCoordinate(s,n._seg.p0),a.getCoordinate(s+1,n._seg.p1);var u=n._seg.distance(t);if(u<=n._boundaryDistanceTolerance)return!0}return!1};Sg.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?he.BOUNDARY:this._ptLocator.locate(t,this._g)};Sg.prototype.extractLinework=function(t){var n=new J1;t.apply(n);var r=n.getLinework(),o=mn.toLineStringArray(r);return t.getFactory().createMultiLineString(o)};Sg.prototype.interfaces_=function(){return[]};Sg.prototype.getClass=function(){return Sg};var J1=function(){this._linework=null,this._linework=new Fe};J1.prototype.getLinework=function(){return this._linework};J1.prototype.filter=function(t){var n=this;if(t instanceof Ma){var r=t;this._linework.add(r.getExteriorRing());for(var o=0;o<r.getNumInteriorRing();o++)n._linework.add(r.getInteriorRingN(o))}};J1.prototype.interfaces_=function(){return[Nh]};J1.prototype.getClass=function(){return J1};var d_=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};d_.prototype.extractPoints=function(t,n,r){for(var o=this,a=t.getCoordinates(),s=0;s<a.length-1;s++)o.computeOffsetPoints(a[s],a[s+1],n,r)};d_.prototype.setSidesToGenerate=function(t,n){this._doLeft=t,this._doRight=n};d_.prototype.getPoints=function(t){for(var n=this,r=new Fe,o=xs.getLines(this._g),a=o.iterator();a.hasNext();){var s=a.next();n.extractPoints(s,t,r)}return r};d_.prototype.computeOffsetPoints=function(t,n,r,o){var a=n.x-t.x,s=n.y-t.y,u=Math.sqrt(a*a+s*s),l=r*a/u,c=r*s/u,f=(n.x+t.x)/2,h=(n.y+t.y)/2;if(this._doLeft){var d=new ae(f-c,h+l);o.add(d)}if(this._doRight){var p=new ae(f+c,h-l);o.add(p)}};d_.prototype.interfaces_=function(){return[]};d_.prototype.getClass=function(){return d_};var lc=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,r],this._locFinder=[new Sg(this._geom[0],this._boundaryDistanceTolerance),new Sg(this._geom[1],this._boundaryDistanceTolerance),new Sg(this._geom[2],this._boundaryDistanceTolerance)]},die={TOLERANCE:{configurable:!0}};lc.prototype.reportResult=function(t,n,r){Ss.out.println("Overlay result invalid - A:"+he.toLocationSymbol(n[0])+" B:"+he.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+he.toLocationSymbol(n[2]))};lc.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(t);return n};lc.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var o=t._testCoords.get(r);if(!t.checkValid(n,o))return t._invalidLocation=o,!1}return!0}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),lc.hasLocation(this._location,he.BOUNDARY)?!0:this.isValidResult(a,this._location)}};lc.prototype.addTestPts=function(t){var n=new d_(t);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};lc.prototype.isValidResult=function(t,n){var r=Zt.isResultOfOp(n[0],n[1],t),o=n[2]===he.INTERIOR,a=!(r^o);return a||this.reportResult(t,n,r),a};lc.prototype.getInvalidLocation=function(){return this._invalidLocation};lc.prototype.interfaces_=function(){return[]};lc.prototype.getClass=function(){return lc};lc.hasLocation=function(t,n){for(var r=0;r<3;r++)if(t[r]===n)return!0;return!1};lc.computeBoundaryDistanceTolerance=function(t,n){return Math.min(Ko.computeSizeBasedSnapTolerance(t),Ko.computeSizeBasedSnapTolerance(n))};lc.isValid=function(t,n,r,o){var a=new lc(t,n,o);return a.isValid(r)};die.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(lc,die);var tc=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};tc.prototype.extractElements=function(t,n){var r=this;if(t===null)return null;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);r._skipEmpty&&a.isEmpty()||n.add(a)}};tc.prototype.combine=function(){for(var t=this,n=new Fe,r=this._inputGeoms.iterator();r.hasNext();){var o=r.next();t.extractElements(o,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};tc.prototype.interfaces_=function(){return[]};tc.prototype.getClass=function(){return tc};tc.combine=function(){if(arguments.length===1){var t=arguments[0],n=new tc(t);return n.combine()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new tc(tc.createList(r,o));return a.combine()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2],c=new tc(tc.createList(s,u,l));return c.combine()}};tc.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};tc.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Fe;return r.add(t),r.add(n),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Fe;return u.add(o),u.add(a),u.add(s),u}};var fa=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new Fe)},pie={STRTREE_NODE_CAPACITY:{configurable:!0}};fa.prototype.reduceToGeometries=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=null;Ot(a,wf)?s=n.unionTree(a):a instanceof Mt&&(s=a),r.add(s)}return r};fa.prototype.extractByEnvelope=function(t,n,r){for(var o=new Fe,a=0;a<n.getNumGeometries();a++){var s=n.getGeometryN(a);s.getEnvelopeInternal().intersects(t)?o.add(s):r.add(s)}return this._geomFactory.buildGeometry(o)};fa.prototype.unionOptimized=function(t,n){var r=t.getEnvelopeInternal(),o=n.getEnvelopeInternal();if(!r.intersects(o)){var a=tc.combine(t,n);return a}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var s=r.intersection(o);return this.unionUsingEnvelopeIntersection(t,n,s)};fa.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new $re(fa.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var o=t.itemsTree(),a=this.unionTree(o);return a};fa.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2];if(o-r<=1){var a=fa.getGeometry(n,r);return this.unionSafe(a,null)}else{if(o-r===2)return this.unionSafe(fa.getGeometry(n,r),fa.getGeometry(n,r+1));var s=Math.trunc((o+r)/2),u=this.binaryUnion(n,r,s),l=this.binaryUnion(n,s,o);return this.unionSafe(u,l)}}};fa.prototype.repeatedUnion=function(t){for(var n=null,r=t.iterator();r.hasNext();){var o=r.next();n===null?n=o.copy():n=n.union(o)}return n};fa.prototype.unionSafe=function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)};fa.prototype.unionActual=function(t,n){return fa.restrictToPolygons(t.union(n))};fa.prototype.unionTree=function(t){var n=this.reduceToGeometries(t),r=this.binaryUnion(n);return r};fa.prototype.unionUsingEnvelopeIntersection=function(t,n,r){var o=new Fe,a=this.extractByEnvelope(r,t,o),s=this.extractByEnvelope(r,n,o),u=this.unionActual(a,s);o.add(u);var l=tc.combine(o);return l};fa.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),r=n.buildGeometry(t),o=r.buffer(0);return o}else if(arguments.length===2){var a=arguments[0],s=arguments[1],u=a.getFactory(),l=u.createGeometryCollection([a,s]),c=l.buffer(0);return c}};fa.prototype.interfaces_=function(){return[]};fa.prototype.getClass=function(){return fa};fa.restrictToPolygons=function(t){if(Ot(t,bg))return t;var n=Jp.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(mn.toPolygonArray(n))};fa.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)};fa.union=function(t){var n=new fa(t);return n.union()};pie.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(fa,pie);var GA=function(){};GA.prototype.interfaces_=function(){return[]};GA.prototype.getClass=function(){return GA};GA.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return Zt.createEmptyResult(Zt.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),Du.overlayOp(t,n,Zt.UNION)};function JFe(e,t){var n=ic(e),r=ic(t),o=e.properties||{};if(n=une(n),r=une(r),!n)return null;if(!r)return ha(n,o);var a=new uw,s=a.read(n),u=a.read(r),l=Zt.difference(s,u);if(l.isEmpty())return null;var c=new JA,f=c.write(l);return ha(f,o)}function une(e){switch(e.type){case"Polygon":return TA(e)>1?e:null;case"MultiPolygon":var t=[];if(Da(e,function(n){TA(n)>1&&t.push(n.geometry.coordinates)}),t.length)return{type:"MultiPolygon",coordinates:t}}}var g_=function(){return new $L};function $L(){this.reset()}$L.prototype={constructor:$L,reset:function(){this.s=this.t=0},add:function(e){lne(IL,e,this.t),lne(this,IL.s,this.s),this.s?this.t+=IL.t:this.s=IL.t},valueOf:function(){return this.s}};var IL=new $L;function lne(e,t,n){var r=e.s=t+n,o=r-t,a=r-o;e.t=t-a+(n-o)}var Ro=1e-6,Mi=Math.PI,Oc=Mi/2,cne=Mi/4,sm=Mi*2,Ih=180/Mi,Gs=Mi/180,Eu=Math.abs,EV=Math.atan,UA=Math.atan2,ws=Math.cos,mie=Math.exp,gie=Math.log,Hs=Math.sin,PR=Math.sqrt,_ie=Math.tan;function $Fe(e){return e>1?0:e<-1?Mi:Math.acos(e)}function HA(e){return e>1?Oc:e<-1?-Oc:Math.asin(e)}function gA(){}function eR(e,t){e&&hne.hasOwnProperty(e.type)&&hne[e.type](e,t)}var fne={Feature:function(e,t){eR(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,o=n.length;++r<o;)eR(n[r].geometry,t)}},hne={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){b4(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)b4(n[r],t,0)},Polygon:function(e,t){dne(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)dne(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,o=n.length;++r<o;)eR(n[r],t)}};function b4(e,t,n){var r=-1,o=e.length-n,a;for(t.lineStart();++r<o;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function dne(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)b4(e[n],t,1);t.polygonEnd()}var eze=function(e,t){e&&fne.hasOwnProperty(e.type)?fne[e.type](e,t):eR(e,t)},M4t=g_(),L4t=g_();function I4(e){return[UA(e[1],e[0]),HA(e[2])]}function $1(e){var t=e[0],n=e[1],r=ws(n);return[r*ws(t),r*Hs(t),Hs(n)]}function DL(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function tR(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function c4(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function PL(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function D4(e){var t=PR(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var R4t=g_(),yie=function(e,t){function n(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,o){return r=t.invert(r,o),r&&e.invert(r[0],r[1])}),n};function P4(e,t){return[e>Mi?e-sm:e<-Mi?e+sm:e,t]}P4.invert=P4;function vie(e,t,n){return(e%=sm)?t||n?yie(mne(e),gne(t,n)):mne(e):t||n?gne(t,n):P4}function pne(e){return function(t,n){return t+=e,[t>Mi?t-sm:t<-Mi?t+sm:t,n]}}function mne(e){var t=pne(e);return t.invert=pne(-e),t}function gne(e,t){var n=ws(e),r=Hs(e),o=ws(t),a=Hs(t);function s(u,l){var c=ws(l),f=ws(u)*c,h=Hs(u)*c,d=Hs(l),p=d*n+f*r;return[UA(h*o-p*a,f*n-d*r),HA(p*o+h*a)]}return s.invert=function(u,l){var c=ws(l),f=ws(u)*c,h=Hs(u)*c,d=Hs(l),p=d*o-h*a;return[UA(h*o+d*a,f*n+p*r),HA(p*n-f*r)]},s}var tze=function(e){e=vie(e[0]*Gs,e[1]*Gs,e.length>2?e[2]*Gs:0);function t(n){return n=e(n[0]*Gs,n[1]*Gs),n[0]*=Ih,n[1]*=Ih,n}return t.invert=function(n){return n=e.invert(n[0]*Gs,n[1]*Gs),n[0]*=Ih,n[1]*=Ih,n},t};function nze(e,t,n,r,o,a){if(!!n){var s=ws(t),u=Hs(t),l=r*n;o==null?(o=t+r*sm,a=t-l/2):(o=_ne(s,o),a=_ne(s,a),(r>0?o<a:o>a)&&(o+=r*sm));for(var c,f=o;r>0?f>a:f<a;f-=l)c=I4([s,-u*ws(f),-u*Hs(f)]),e.point(c[0],c[1])}}function _ne(e,t){t=$1(t),t[0]-=e,D4(t);var n=$Fe(-t[1]);return((-t[2]<0?-n:n)+sm-Ro)%sm}var Cie=function(){var e=[],t;return{point:function(n,r){t.push([n,r])},lineStart:function(){e.push(t=[])},lineEnd:gA,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},rze=function(e,t,n,r,o,a){var s=e[0],u=e[1],l=t[0],c=t[1],f=0,h=1,d=l-s,p=c-u,_;if(_=n-s,!(!d&&_>0)){if(_/=d,d<0){if(_<f)return;_<h&&(h=_)}else if(d>0){if(_>h)return;_>f&&(f=_)}if(_=o-s,!(!d&&_<0)){if(_/=d,d<0){if(_>h)return;_>f&&(f=_)}else if(d>0){if(_<f)return;_<h&&(h=_)}if(_=r-u,!(!p&&_>0)){if(_/=p,p<0){if(_<f)return;_<h&&(h=_)}else if(p>0){if(_>h)return;_>f&&(f=_)}if(_=a-u,!(!p&&_<0)){if(_/=p,p<0){if(_>h)return;_>f&&(f=_)}else if(p>0){if(_<f)return;_<h&&(h=_)}return f>0&&(e[0]=s+f*d,e[1]=u+f*p),h<1&&(t[0]=s+h*d,t[1]=u+h*p),!0}}}}},BL=function(e,t){return Eu(e[0]-t[0])<Ro&&Eu(e[1]-t[1])<Ro};function ML(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var xie=function(e,t,n,r,o){var a=[],s=[],u,l;if(e.forEach(function(_){if(!((y=_.length-1)<=0)){var y,v=_[0],w=_[y],C;if(BL(v,w)){for(o.lineStart(),u=0;u<y;++u)o.point((v=_[u])[0],v[1]);o.lineEnd();return}a.push(C=new ML(v,_,null,!0)),s.push(C.o=new ML(v,null,C,!1)),a.push(C=new ML(w,_,null,!1)),s.push(C.o=new ML(w,null,C,!0))}}),!!a.length){for(s.sort(t),yne(a),yne(s),u=0,l=s.length;u<l;++u)s[u].e=n=!n;for(var c=a[0],f,h;;){for(var d=c,p=!0;d.v;)if((d=d.n)===c)return;f=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(u=0,l=f.length;u<l;++u)o.point((h=f[u])[0],h[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(f=d.p.z,u=f.length-1;u>=0;--u)o.point((h=f[u])[0],h[1]);else r(d.x,d.p.x,-1,o);d=d.p}d=d.o,f=d.z,p=!p}while(!d.v);o.lineEnd()}}};function yne(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],o;++n<t;)r.n=o=e[n],o.p=r,r=o;r.n=o=e[0],o.p=r}}var wie=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},ize=function(e){return e.length===1&&(e=oze(e)),{left:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)<0?r=a+1:o=a}return r},right:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)>0?o=a:r=a+1}return r}}};function oze(e){return function(t,n){return wie(e(t),n)}}var O4t=ize(wie),Eie=function(e){for(var t=e.length,n,r=-1,o=0,a,s;++r<t;)o+=e[r].length;for(a=new Array(o);--t>=0;)for(s=e[t],n=s.length;--n>=0;)a[--o]=s[n];return a},_A=1e9,LL=-_A;function aze(e,t,n,r){function o(c,f){return e<=c&&c<=n&&t<=f&&f<=r}function a(c,f,h,d){var p=0,_=0;if(c==null||(p=s(c,h))!==(_=s(f,h))||l(c,f)<0^h>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+h+4)%4)!==_);else d.point(f[0],f[1])}function s(c,f){return Eu(c[0]-e)<Ro?f>0?0:3:Eu(c[0]-n)<Ro?f>0?2:1:Eu(c[1]-t)<Ro?f>0?1:0:f>0?3:2}function u(c,f){return l(c.x,f.x)}function l(c,f){var h=s(c,1),d=s(f,1);return h!==d?h-d:h===0?f[1]-c[1]:h===1?c[0]-f[0]:h===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,h=Cie(),d,p,_,y,v,w,C,E,S,A,D,P={point:M,lineStart:I,lineEnd:L,polygonStart:O,polygonEnd:m};function M(N,B){o(N,B)&&f.point(N,B)}function b(){for(var N=0,B=0,V=p.length;B<V;++B)for(var z=p[B],U=1,Q=z.length,ne=z[0],se,de,pe=ne[0],ve=ne[1];U<Q;++U)se=pe,de=ve,ne=z[U],pe=ne[0],ve=ne[1],de<=r?ve>r&&(pe-se)*(r-de)>(ve-de)*(e-se)&&++N:ve<=r&&(pe-se)*(r-de)<(ve-de)*(e-se)&&--N;return N}function O(){f=h,d=[],p=[],D=!0}function m(){var N=b(),B=D&&N,V=(d=Eie(d)).length;(B||V)&&(c.polygonStart(),B&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),V&&xie(d,u,N,a,c),c.polygonEnd()),f=c,d=p=_=null}function I(){P.point=R,p&&p.push(_=[]),A=!0,S=!1,C=E=NaN}function L(){d&&(R(y,v),w&&S&&h.rejoin(),d.push(h.result())),P.point=M,S&&f.lineEnd()}function R(N,B){var V=o(N,B);if(p&&_.push([N,B]),A)y=N,v=B,w=V,A=!1,V&&(f.lineStart(),f.point(N,B));else if(V&&S)f.point(N,B);else{var z=[C=Math.max(LL,Math.min(_A,C)),E=Math.max(LL,Math.min(_A,E))],U=[N=Math.max(LL,Math.min(_A,N)),B=Math.max(LL,Math.min(_A,B))];rze(z,U,e,t,n,r)?(S||(f.lineStart(),f.point(z[0],z[1])),f.point(U[0],U[1]),V||f.lineEnd(),D=!1):V&&(f.lineStart(),f.point(N,B),D=!1)}C=N,E=B,S=V}return P}}var f4=g_(),sze=function(e,t){var n=t[0],r=t[1],o=[Hs(n),-ws(n),0],a=0,s=0;f4.reset();for(var u=0,l=e.length;u<l;++u)if(!!(f=(c=e[u]).length))for(var c,f,h=c[f-1],d=h[0],p=h[1]/2+cne,_=Hs(p),y=ws(p),v=0;v<f;++v,d=C,_=S,y=A,h=w){var w=c[v],C=w[0],E=w[1]/2+cne,S=Hs(E),A=ws(E),D=C-d,P=D>=0?1:-1,M=P*D,b=M>Mi,O=_*S;if(f4.add(UA(O*P*Hs(M),y*A+O*ws(M))),a+=b?D+P*sm:D,b^d>=n^C>=n){var m=tR($1(h),$1(w));D4(m);var I=tR(o,m);D4(I);var L=(b^D>=0?-1:1)*HA(I[2]);(r>L||r===L&&(m[0]||m[1]))&&(s+=b^D>=0?1:-1)}}return(a<-Ro||a<Ro&&f4<-Ro)^s&1},N4t=g_(),vne=function(e){return e},B4t=g_(),F4t=g_(),ew=1/0,nR=ew,qA=-ew,rR=qA,Cne={point:uze,lineStart:gA,lineEnd:gA,polygonStart:gA,polygonEnd:gA,result:function(){var e=[[ew,nR],[qA,rR]];return qA=rR=-(nR=ew=1/0),e}};function uze(e,t){e<ew&&(ew=e),e>qA&&(qA=e),t<nR&&(nR=t),t>rR&&(rR=t)}var z4t=g_(),Tie=function(e,t,n,r){return function(o,a){var s=t(a),u=o.invert(r[0],r[1]),l=Cie(),c=t(l),f=!1,h,d,p,_={point:y,lineStart:w,lineEnd:C,polygonStart:function(){_.point=E,_.lineStart=S,_.lineEnd=A,d=[],h=[]},polygonEnd:function(){_.point=y,_.lineStart=w,_.lineEnd=C,d=Eie(d);var D=sze(h,u);d.length?(f||(a.polygonStart(),f=!0),xie(d,cze,D,n,a)):D&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),d=h=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function y(D,P){var M=o(D,P);e(D=M[0],P=M[1])&&a.point(D,P)}function v(D,P){var M=o(D,P);s.point(M[0],M[1])}function w(){_.point=v,s.lineStart()}function C(){_.point=y,s.lineEnd()}function E(D,P){p.push([D,P]);var M=o(D,P);c.point(M[0],M[1])}function S(){c.lineStart(),p=[]}function A(){E(p[0][0],p[0][1]),c.lineEnd();var D=c.clean(),P=l.result(),M,b=P.length,O,m,I;if(p.pop(),h.push(p),p=null,!!b){if(D&1){if(m=P[0],(O=m.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),M=0;M<O;++M)a.point((I=m[M])[0],I[1]);a.lineEnd()}return}b>1&&D&2&&P.push(P.pop().concat(P.shift())),d.push(P.filter(lze))}}return _}};function lze(e){return e.length>1}function cze(e,t){return((e=e.x)[0]<0?e[1]-Oc-Ro:Oc-e[1])-((t=t.x)[0]<0?t[1]-Oc-Ro:Oc-t[1])}var xne=Tie(function(){return!0},fze,dze,[-Mi,-Oc]);function fze(e){var t=NaN,n=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(a,s){var u=a>0?Mi:-Mi,l=Eu(a-t);Eu(l-Mi)<Ro?(e.point(t,n=(n+s)/2>0?Oc:-Oc),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(a,n),o=0):r!==u&&l>=Mi&&(Eu(t-r)<Ro&&(t-=r*Ro),Eu(a-u)<Ro&&(a-=u*Ro),n=hze(t,n,a,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),o=0),e.point(t=a,n=s),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-o}}}function hze(e,t,n,r){var o,a,s=Hs(e-n);return Eu(s)>Ro?EV((Hs(t)*(a=ws(r))*Hs(n)-Hs(r)*(o=ws(t))*Hs(e))/(o*a*s)):(t+r)/2}function dze(e,t,n,r){var o;if(e==null)o=n*Oc,r.point(-Mi,o),r.point(0,o),r.point(Mi,o),r.point(Mi,0),r.point(Mi,-o),r.point(0,-o),r.point(-Mi,-o),r.point(-Mi,0),r.point(-Mi,o);else if(Eu(e[0]-t[0])>Ro){var a=e[0]<t[0]?Mi:-Mi;o=n*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}var pze=function(e,t){var n=ws(e),r=n>0,o=Eu(n)>Ro;function a(f,h,d,p){nze(p,e,t,d,f,h)}function s(f,h){return ws(f)*ws(h)>n}function u(f){var h,d,p,_,y;return{lineStart:function(){_=p=!1,y=1},point:function(v,w){var C=[v,w],E,S=s(v,w),A=r?S?0:c(v,w):S?c(v+(v<0?Mi:-Mi),w):0;if(!h&&(_=p=S)&&f.lineStart(),S!==p&&(E=l(h,C),(!E||BL(h,E)||BL(C,E))&&(C[0]+=Ro,C[1]+=Ro,S=s(C[0],C[1]))),S!==p)y=0,S?(f.lineStart(),E=l(C,h),f.point(E[0],E[1])):(E=l(h,C),f.point(E[0],E[1]),f.lineEnd()),h=E;else if(o&&h&&r^S){var D;!(A&d)&&(D=l(C,h,!0))&&(y=0,r?(f.lineStart(),f.point(D[0][0],D[0][1]),f.point(D[1][0],D[1][1]),f.lineEnd()):(f.point(D[1][0],D[1][1]),f.lineEnd(),f.lineStart(),f.point(D[0][0],D[0][1])))}S&&(!h||!BL(h,C))&&f.point(C[0],C[1]),h=C,p=S,d=A},lineEnd:function(){p&&f.lineEnd(),h=null},clean:function(){return y|(_&&p)<<1}}}function l(f,h,d){var p=$1(f),_=$1(h),y=[1,0,0],v=tR(p,_),w=DL(v,v),C=v[0],E=w-C*C;if(!E)return!d&&f;var S=n*w/E,A=-n*C/E,D=tR(y,v),P=PL(y,S),M=PL(v,A);c4(P,M);var b=D,O=DL(P,b),m=DL(b,b),I=O*O-m*(DL(P,P)-1);if(!(I<0)){var L=PR(I),R=PL(b,(-O-L)/m);if(c4(R,P),R=I4(R),!d)return R;var N=f[0],B=h[0],V=f[1],z=h[1],U;B<N&&(U=N,N=B,B=U);var Q=B-N,ne=Eu(Q-Mi)<Ro,se=ne||Q<Ro;if(!ne&&z<V&&(U=V,V=z,z=U),se?ne?V+z>0^R[1]<(Eu(R[0]-N)<Ro?V:z):V<=R[1]&&R[1]<=z:Q>Mi^(N<=R[0]&&R[0]<=B)){var de=PL(b,(-O+L)/m);return c4(de,P),[R,I4(de)]}}}function c(f,h){var d=r?e:Mi-e,p=0;return f<-d?p|=1:f>d&&(p|=2),h<-d?p|=4:h>d&&(p|=8),p}return Tie(s,u,a,r?[0,-e]:[-Mi,e-Mi])};function Sie(e){return function(t){var n=new M4;for(var r in e)n[r]=e[r];return n.stream=t,n}}function M4(){}M4.prototype={constructor:M4,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Aie(e,t,n){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),eze(n,e.stream(Cne));var s=Cne.result(),u=Math.min(r/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),l=+t[0][0]+(r-u*(s[1][0]+s[0][0]))/2,c=+t[0][1]+(o-u*(s[1][1]+s[0][1]))/2;return a!=null&&e.clipExtent(a),e.scale(u*150).translate([l,c])}function mze(e,t,n){return Aie(e,[[0,0],t],n)}var wne=16,gze=ws(30*Gs),Ene=function(e,t){return+t?yze(e,t):_ze(e)};function _ze(e){return Sie({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function yze(e,t){function n(r,o,a,s,u,l,c,f,h,d,p,_,y,v){var w=c-r,C=f-o,E=w*w+C*C;if(E>4*t&&y--){var S=s+d,A=u+p,D=l+_,P=PR(S*S+A*A+D*D),M=HA(D/=P),b=Eu(Eu(D)-1)<Ro||Eu(a-h)<Ro?(a+h)/2:UA(A,S),O=e(b,M),m=O[0],I=O[1],L=m-r,R=I-o,N=C*L-w*R;(N*N/E>t||Eu((w*L+C*R)/E-.5)>.3||s*d+u*p+l*_<gze)&&(n(r,o,a,s,u,l,m,I,b,S/=P,A/=P,D,y,v),v.point(m,I),n(m,I,b,S,A,D,c,f,h,d,p,_,y,v))}}return function(r){var o,a,s,u,l,c,f,h,d,p,_,y,v={point:w,lineStart:C,lineEnd:S,polygonStart:function(){r.polygonStart(),v.lineStart=A},polygonEnd:function(){r.polygonEnd(),v.lineStart=C}};function w(M,b){M=e(M,b),r.point(M[0],M[1])}function C(){h=NaN,v.point=E,r.lineStart()}function E(M,b){var O=$1([M,b]),m=e(M,b);n(h,d,f,p,_,y,h=m[0],d=m[1],f=M,p=O[0],_=O[1],y=O[2],wne,r),r.point(h,d)}function S(){v.point=w,r.lineEnd()}function A(){C(),v.point=D,v.lineEnd=P}function D(M,b){E(o=M,b),a=h,s=d,u=p,l=_,c=y,v.point=E}function P(){n(h,d,f,p,_,y,a,s,o,u,l,c,wne,r),v.lineEnd=S,S()}return v}}var vze=Sie({point:function(e,t){this.stream.point(e*Gs,t*Gs)}});function Cze(e){return xze(function(){return e})()}function xze(e){var t,n=150,r=480,o=250,a,s,u=0,l=0,c=0,f=0,h=0,d,p,_=null,y=xne,v=null,w,C,E,S=vne,A=.5,D=Ene(m,A),P,M;function b(R){return R=p(R[0]*Gs,R[1]*Gs),[R[0]*n+a,s-R[1]*n]}function O(R){return R=p.invert((R[0]-a)/n,(s-R[1])/n),R&&[R[0]*Ih,R[1]*Ih]}function m(R,N){return R=t(R,N),[R[0]*n+a,s-R[1]*n]}b.stream=function(R){return P&&M===R?P:P=vze(y(d,D(S(M=R))))},b.clipAngle=function(R){return arguments.length?(y=+R?pze(_=R*Gs,6*Gs):(_=null,xne),L()):_*Ih},b.clipExtent=function(R){return arguments.length?(S=R==null?(v=w=C=E=null,vne):aze(v=+R[0][0],w=+R[0][1],C=+R[1][0],E=+R[1][1]),L()):v==null?null:[[v,w],[C,E]]},b.scale=function(R){return arguments.length?(n=+R,I()):n},b.translate=function(R){return arguments.length?(r=+R[0],o=+R[1],I()):[r,o]},b.center=function(R){return arguments.length?(u=R[0]%360*Gs,l=R[1]%360*Gs,I()):[u*Ih,l*Ih]},b.rotate=function(R){return arguments.length?(c=R[0]%360*Gs,f=R[1]%360*Gs,h=R.length>2?R[2]%360*Gs:0,I()):[c*Ih,f*Ih,h*Ih]},b.precision=function(R){return arguments.length?(D=Ene(m,A=R*R),L()):PR(A)},b.fitExtent=function(R,N){return Aie(b,R,N)},b.fitSize=function(R,N){return mze(b,R,N)};function I(){p=yie(d=vie(c,f,h),t);var R=t(u,l);return a=r-R[0]*n,s=o+R[1]*n,L()}function L(){return P=M=null,b}return function(){return t=e.apply(this,arguments),b.invert=t.invert&&O,I()}}function bie(e,t){return[e,gie(_ie((Oc+t)/2))]}bie.invert=function(e,t){return[e,2*EV(mie(t))-Oc]};function wze(e){var t=Cze(e),n=t.center,r=t.scale,o=t.translate,a=t.clipExtent,s=null,u,l,c;t.scale=function(h){return arguments.length?(r(h),f()):r()},t.translate=function(h){return arguments.length?(o(h),f()):o()},t.center=function(h){return arguments.length?(n(h),f()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=u=l=c=null:(s=+h[0][0],u=+h[0][1],l=+h[1][0],c=+h[1][1]),f()):s==null?null:[[s,u],[l,c]]};function f(){var h=Mi*r(),d=t(tze(t.rotate()).invert([0,0]));return a(s==null?[[d[0]-h,d[1]-h],[d[0]+h,d[1]+h]]:e===bie?[[Math.max(d[0]-h,s),u],[Math.min(d[0]+h,l),c]]:[[s,Math.max(d[1]-h,u)],[l,Math.min(d[1]+h,c)]])}return f()}function Iie(e,t){return[gie(_ie((Oc+t)/2)),-e]}Iie.invert=function(e,t){return[-t,2*EV(mie(e))-Oc]};var Eze=function(){var e=wze(Iie),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)};function Tze(e,t,n){n=n||{};var r=n.units,o=n.steps||64;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");o=o||64,r=r||"kilometers";var a=[];switch(e.type){case"GeometryCollection":return Hh(e,function(s){var u=FL(s,t,r,o);u&&a.push(u)}),kt(a);case"FeatureCollection":return mi(e,function(s){var u=FL(s,t,r,o);u&&mi(u,function(l){l&&a.push(l)})}),kt(a)}return FL(e,t,r,o)}function FL(e,t,n,r){var o=e.properties||{},a=e.type==="Feature"?e.geometry:e;if(a.type==="GeometryCollection"){var s=[];return Hh(e,function(v){var w=FL(v,t,n,r);w&&s.push(w)}),kt(s)}var u,l=Pa(e),c=l[1]>50&&l[3]>50;c?u={type:a.type,coordinates:Pie(a.coordinates,Tne(a))}:u=e_(a);var f=new uw,h=f.read(u),d=L1(pv(t,n),"meters"),p=Es.bufferOp(h,d),_=new JA;if(p=_.write(p),!Die(p.coordinates)){var y;return c?y={type:p.type,coordinates:Mie(p.coordinates,Tne(a))}:y=dR(p),y.geometry?y:ha(y,o)}}function Die(e){return Array.isArray(e[0])?Die(e[0]):isNaN(e[0])}function Pie(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return Pie(n,t)})}function Mie(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return Mie(n,t)})}function Tne(e){var t=cR(e).geometry.coordinates.reverse(),n=t.map(function(r){return-r});return Eze().center(t).rotate(n).scale(Cs)}function TV(){for(var e=new uw,t=e.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)t=GA.union(t,e.read(JSON.stringify(arguments[n].geometry)));var r=new JA;return t=r.write(t),{type:"Feature",geometry:t,properties:arguments[0].properties}}function tw(e,t){var n=ic(e),r=ic(t);if(Ag(A1(r,{precision:4})).coordinates[0].length<4||Ag(A1(n,{precision:4})).coordinates[0].length<4)return null;var o=new uw,a=o.read(A1(n)),s=o.read(A1(r)),u=Zt.intersection(a,s);if(u.isEmpty())return null;var l=new JA,c=l.write(u);return ha(c)}/**
 * @license get-closest https://github.com/cosmosio/get-closest
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2017 Olivier Scherrer <pode.fr@gmail.com>
 */function Sze(e,t,n){var r,o;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(a,s){var u=n(a,e);u>=0&&(typeof o>"u"||u<o)&&(o=u,r=s)}),r}function Aze(e,t){return Sze(e,t,function(n,r){return n-r})}function bze(e,t){if(t=t||{},!yt(t))throw new Error("options is invalid");var n=t.propertyName;qd(e,"Polygon","dissolve");var r=Su(e),o=r.features,a=[];o.forEach(function(f,h){f.properties.origIndexPosition=h});var s=WA();s.load(r);for(var u in o){var l=o[u],c=!1;if(s.search(l).features.forEach(function(f){l=o[u];var h=f.properties.origIndexPosition;if(a.length>0&&h!==0)if(h>a[a.length-1])h=h-a.length;else{var d=Aze(h,a);d!==0&&(h=h-d)}if(h!==+u){var p=o[h];!p||!l||n!==void 0&&p.properties[n]!==l.properties[n]||!Are(l,p)||!Ize(l,p)||(o[u]=TV(l,p),a.push(f.properties.origIndexPosition),a.sort(function(_,y){return _-y}),s.remove(f),o.splice(h,1),l.properties.origIndexPosition=u,s.remove(l,function(_,y){return _.properties.origIndexPosition===y.properties.origIndexPosition}),c=!0)}}),c){if(!l)continue;l.properties.origIndexPosition=u,s.insert(l),u--}}return o.forEach(function(f){delete f.properties.origIndexPosition,delete f.bbox}),r}function Ize(e,t){var n=Vi($p(e)),r=Vi($p(t)),o=Fg(n,r).features;return o.length>0}function Lie(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.properties||{},o=n.triangles,a=n.mask;if(t==null)throw new Error("cellSide is required");if(!pi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(a&&["Polygon","MultiPolygon"].indexOf(ki(a))===-1)throw new Error("options.mask must be a (Multi)Polygon");var s=e[0],u=e[1],l=e[2],c=e[3],f=(u+c)/2,h=(s+l)/2,d=t*2/di([s,f],[l,f],n),p=d*(l-s),_=t*2/di([h,u],[h,c],n),y=_*(c-u),v=p/2,w=v*2,C=Math.sqrt(3)/2*y,E=l-s,S=c-u,A=3/4*w,D=C,P=(E-w)/(w-v/2),M=Math.floor(P),b=(M*A-v/2-E)/2-v/2+A/2,O=Math.floor((S-C)/C),m=(S-O*C)/2,I=O*C-S>C/2;I&&(m-=C/4);for(var L=[],R=[],N=0;N<6;N++){var B=2*Math.PI/6*N;L.push(Math.cos(B)),R.push(Math.sin(B))}for(var V=[],z=0;z<=M;z++)for(var U=0;U<=O;U++){var Q=z%2===1;if(!(U===0&&Q)&&!(U===0&&I)){var ne=z*A+s-b,se=U*D+u+m;if(Q&&(se-=C/2),o===!0)Pze([ne,se],p/2,y/2,r,L,R).forEach(function(pe){a?tw(a,pe)&&V.push(pe):V.push(pe)});else{var de=Dze([ne,se],p/2,y/2,r,L,R);a?tw(a,de)&&V.push(de):V.push(de)}}}return kt(V)}function Dze(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=e[0]+t*o[u],c=e[1]+n*a[u];s.push([l,c])}return s.push(s[0].slice()),ir([s],r)}function Pze(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=[];l.push(e),l.push([e[0]+t*o[u],e[1]+n*a[u]]),l.push([e[0]+t*o[(u+1)%6],e[1]+n*a[(u+1)%6]]),l.push(e),s.push(ir([l],r))}return s}function Mze(e,t){var n=Oze(t),r=Rze(e),o=r[0],a=r[1];o=Sne(o),a=Sne(a);var s=Lze(n,o,a);return s}function Lze(e,t,n){var r=[];return r.push(e.geometry.coordinates[0]),Da(t,function(o){r.push(o.geometry.coordinates[0])}),Da(n,function(o){r.push(o.geometry.coordinates[0])}),ir(r)}function Rze(e){var t=[],n=[];return Da(e,function(r){var o=r.geometry.coordinates,a=o[0],s=o.slice(1);t.push(ir([a])),s.forEach(function(u){n.push(ir([u]))})}),[kt(t),kt(n)]}function Oze(e){var t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],n=e&&e.geometry.coordinates||t;return ir(n)}function Sne(e){if(e.features.length<=1)return e;var t=Nze(e),n=[],r={};return Da(e,function(o,a){if(r[a])return!0;for(t.remove({index:a},Ane),r[a]=!0;;){var s=Pa(o),u=t.search({minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]});if(u.length>0){var l=u.map(function(c){return r[c.index]=!0,t.remove({index:c.index},Ane),c.geojson});l.push(o),o=TV.apply(this,l)}if(u.length===0)break}n.push(o)}),kt(n)}function Ane(e,t){return e.index===t.index}function Nze(e){var t=R1(),n=[];return Da(e,function(r,o){var a=Pa(r);n.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],geojson:r,index:o})}),t.load(n),t}function Rie(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!pi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(ki(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/di([s,u],[l,u],n),h=f*(l-s),d=t/di([s,u],[s,c],n),p=d*(c-u),_=l-s,y=c-u,v=Math.floor(_/h),w=Math.floor(y/p),C=(_-v*h)/2,E=(y-w*p)/2,S=s+C,A=0;A<v;A++){for(var D=u+E,P=0;P<w;P++){var M=ir([[[S,D],[S,D+p],[S+h,D+p],[S+h,D],[S,D]]],r);o?tw(o,M)&&a.push(M):a.push(M),D+=p}S+=h}return kt(a)}function Oie(e,t,n){if(n=n||{},!yt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!pi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(ki(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=t/di([e[0],e[1]],[e[2],e[1]],n),u=s*(e[2]-e[0]),l=t/di([e[0],e[1]],[e[0],e[3]],n),c=l*(e[3]-e[1]),f=0,h=e[0];h<=e[2];){for(var d=0,p=e[1];p<=e[3];){var _=null,y=null;f%2===0&&d%2===0?(_=ir([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=ir([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)):f%2===0&&d%2===1?(_=ir([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r),y=ir([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r)):d%2===0&&f%2===1?(_=ir([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r),y=ir([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r)):d%2===1&&f%2===1&&(_=ir([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=ir([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)),o?(tw(o,_)&&a.push(_),tw(o,y)&&a.push(y)):(a.push(_),a.push(y)),p+=c,d++}f++,h+=u}return kt(a)}function Bze(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.gridType,o=n.property,a=n.weight;if(!e)throw new Error("points is required");if(qd(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(a!==void 0&&typeof a!="number")throw new Error("weight must be a number");o=o||"elevation",r=r||"square",a=a||1;var s=Pa(e),u;switch(r){case"point":case"points":u=dre(s,t,n);break;case"square":case"squares":u=Rie(s,t,n);break;case"hex":case"hexes":u=Lie(s,t,n);break;case"triangle":case"triangles":u=Oie(s,t,n);break;default:throw new Error("invalid gridType")}var l=[];return mi(u,function(c){var f=0,h=0;mi(e,function(p){var _=r==="point"?c:gv(c),y=di(_,p,n),v;if(o!==void 0&&(v=p.properties[o]),v===void 0&&(v=p.geometry.coordinates[2]),v===void 0)throw new Error("zValue is missing");y===0&&(f=v);var w=1/Math.pow(y,a);h+=w,f+=w*v});var d=Su(c);d.properties[o]=f/h,l.push(d)}),kt(l)}var cw={projection:E2e,random:LFe,clusters:RFe,helpers:dOe,invariant:mOe,meta:pOe,isolines:EOe,convex:qne,pointsWithinPolygon:h4,concave:MNe,collect:RNe,flip:ONe,simplify:GNe,bezierSpline:ite,tag:qNe,sample:WNe,envelope:Jne,square:$ne,circle:H4,midpoint:jNe,center:cR,centerOfMass:ere,centroid:gv,combine:KNe,distance:di,explode:q4,bbox:Pa,tesselate:f2e,bboxPolygon:U4,booleanPointInPolygon:To,nearestPoint:v4,nearestPointOnLine:wg,nearestPointToLine:b2e,planepoint:D2e,tin:Wne,bearing:Qp,destination:em,kinks:P2e,pointOnFeature:mte,area:TA,along:R2e,length:C4,lineSlice:O2e,lineSliceAlong:lre,pointGrid:dre,truncate:A1,flatten:W2e,lineIntersect:Fg,lineChunk:Y2e,unkinkPolygon:$2e,greatCircle:e3e,lineSegment:_v,lineSplit:t3e,lineArc:gre,polygonToLine:UL,lineToPolygon:bte,bboxClip:i3e,lineOverlap:yre,sector:s3e,rhumbBearing:$0,rhumbDistance:hR,rhumbDestination:O1,polygonTangents:l3e,rewind:h3e,isobands:tBe,transformRotate:vre,transformScale:Cre,transformTranslate:lBe,lineOffset:gBe,polygonize:xBe,booleanDisjoint:wBe,booleanContains:IBe,booleanCrosses:FBe,booleanClockwise:qL,booleanOverlap:Are,booleanPointOnLine:Rc,booleanEqual:GBe,booleanWithin:cre,clone:Su,cleanCoords:Ag,clustersDbscan:WBe,clustersKmeans:$Be,pointToLineDistance:sre,booleanParallel:eFe,shortestPath:rFe,voronoi:SFe,ellipse:Ore,centerMean:oV,centerMedian:AFe,standardDeviationalEllipse:bFe,difference:JFe,buffer:Tze,union:TV,intersect:tw,dissolve:bze,hexGrid:Lie,mask:Mze,squareGrid:Rie,triangleGrid:Oie,interpolate:Bze,pointOnSurface:mte,polygonToLineString:UL,lineStringToPolygon:bte,inside:To,within:h4,bezier:ite,nearest:v4,pointOnLine:wg,lineDistance:C4,radians2degrees:r_,degrees2radians:Ja,distanceToDegrees:VL,distanceToRadians:pv,radiansToDistance:L1,bearingToAngle:J0,convertDistance:mv,toMercator:e_,toWgs84:dR,randomPosition:XA,randomPoint:Bre,randomPolygon:Fre,randomLineString:zre,getCluster:kre,clusterEach:aV,clusterReduce:Gre,createBins:sV,applyFilter:_R,propertiesContainsFilter:uV,filterProperties:Ure,earthRadius:Cs,factors:iR,unitsFactors:bne,areaFactors:zL,feature:ha,geometry:Ine,point:Yr,points:Dne,polygon:ir,polygons:Pne,lineString:Vi,lineStrings:Mne,featureCollection:kt,multiLineString:p_,multiPoint:oR,multiPolygon:nw,geometryCollection:L4,round:Lne,radiansToLength:L1,lengthToRadians:pv,lengthToDegrees:VL,bearingToAzimuth:J0,radiansToDegrees:r_,degreesToRadians:Ja,convertLength:mv,convertArea:Rne,isNumber:pi,isObject:yt,validateBBox:rw,validateId:aR,getCoord:fo,getCoords:St,containsNumber:uR,geojsonType:Bne,featureOf:yA,collectionOf:qd,getGeom:ic,getGeomType:Fne,getType:ki,coordEach:$a,coordReduce:sR,propEach:R4,propReduce:One,featureEach:mi,featureReduce:O4,coordAll:$p,geomEach:Hh,geomReduce:N4,flattenEach:Da,flattenReduce:Nne,segmentEach:xg,segmentReduce:B4,lineEach:F4,lineReduce:z4};function nb(e){this.mtManager=e.mtManager,this.viewer=e.viewer,this.mtArray=[],this.handler=new Cesium.ScreenSpaceEventHandler,this.drawPrimitives=new CC({viewer:this.viewer}),this.index=1}nb.prototype.getByCircle=function(e,u){var n=!1,r=!0;this.mtArray=[];var o=[],a=this,s=this.index++,u=Cesium.defaultValue(u,1e4);this.handler.setInputAction(function(l){if(r){var c=a.viewer.scene.pickPosition(l.position);if(o.length<1&&(n=!0,o.push(c)),o.length==2){n=!1,r=!1,o[1]=c;for(var f=Cesium.Cartesian3.distance(o[0],o[1]),h=a.mtManager.curTimeMovingTargets,d=0;d<h.length;d++){var p=h[d],_=Cesium.Cartesian3.distance(o[0],p.position);_<=f&&a.mtArray.push(p)}e&&e(a.mtArray),Nv(a,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Nv(a,Cesium.ScreenSpaceEventType.LEFT_CLICK)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(l){if(n){var c=a.viewer.scene.pickPosition(l.endPosition);o[1]=c,a.drawPrimitives.drawCircle({positions:o,id:s,height:u})}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};nb.prototype.getByRectangle=function(e,u){var n=void 0,r=!0;this.mtArray=[];var o=this.index++,a=[],s=this,u=Cesium.defaultValue(u,1e4);this.handler.setInputAction(function(l){if(r){var c=s.viewer.scene.pickPosition(l.position);a.length<1&&(n=!0,a.push(c)),a.length==2&&(n=!1,r=!1,a[1]=c,s.mtArray=Nie(s,o),e&&e(s.mtArray),Nv(s,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Nv(s,Cesium.ScreenSpaceEventType.LEFT_CLICK))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(l){if(n){var c=s.viewer.scene.pickPosition(l.endPosition);a[1]=c,s.drawPrimitives.drawRectangle({positions:a,id:o,height:u})}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};nb.prototype.getByPolygon=function(e,l){var n=!0,r=!0;this.mtArray=[];var o=this.index++,a=[],s=this,u=5,l=Cesium.defaultValue(l,1e4);this.handler.setInputAction(function(c){if(n){var f=s.viewer.scene.pickPosition(c.position);g(f)&&(a.push(f),a.length==3&&s.drawPrimitives.drawPolygon({positions:a,id:o,height:l}))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(c){var f=s.viewer.scene.pickPosition(c.position);f&&r&&(n=!1,r=!1,a.push(f),s.mtArray=Nie(s,o),e&&e(s.mtArray),Nv(s,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Nv(s,Cesium.ScreenSpaceEventType.LEFT_CLICK),Nv(s,Cesium.ScreenSpaceEventType.RIGHT_CLICK))},Cesium.ScreenSpaceEventType.RIGHT_CLICK)};nb.prototype.removeAllEntity=function(){this.drawPrimitives._draw.removeAllEntity()};function Nv(e,t){e.handler.getInputAction(t)&&e.handler.removeInputAction(t)}function SV(e){var t=[],n=Cesium.Ellipsoid.WGS84,r=n.cartesianToCartographic(e),o=Cesium.Math.toDegrees(r.latitude),a=Cesium.Math.toDegrees(r.longitude),s=r.height;return t.push(a),t.push(o),t.push(s),t}function Nie(e,t){for(var n=e.mtManager.curTimeMovingTargets,r=e.viewer.entities.getById(t),o=r._polygon.hierarchy.getValue(Cesium.JulianDate.fromDate(new Date)),a=[],s=0;s<o.positions.length;s++){var u=SV(o.positions[s]);a.push([u[0],u[1]])}u=SV(o.positions[0]),a.push([u[0],u[1]]);for(var l=cw.polygon([a]),s=0;s<n.length;s++){var c=n[s],u=SV(c.position),f=cw.point([u[0],u[1]]);cw.booleanPointInPolygon(f,l)&&e.mtArray.push(c)}return e.mtArray}var Bie=nb;function AV(e){e=T(e,1),this._radius=T(e,1)}Object.defineProperties(AV.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}});AV.prototype.emit=function(e){let t=F.randomBetween(0,F.TWO_PI),n=F.randomBetween(0,this._radius),r=n*Math.cos(t),o=n*Math.sin(t),a=0;e.position=x.fromElements(r,o,a,e.position),e.velocity=x.clone(x.UNIT_Z,e.velocity)};var Fie=AV;var Fze=new X(1,1);function bV(e){e=T(e,T.EMPTY_OBJECT),this.mass=T(e.mass,1),this.position=x.clone(T(e.position,x.ZERO)),this.velocity=x.clone(T(e.velocity,x.ZERO)),this.life=T(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=K.clone(T(e.startColor,K.WHITE)),this.endColor=K.clone(T(e.endColor,K.WHITE)),this.startScale=T(e.startScale,1),this.endScale=T(e.endScale,1),this.imageSize=X.clone(T(e.imageSize,Fze)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(bV.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var zie=new x;bV.prototype.update=function(e,t){return x.multiplyByScalar(this.velocity,e,zie),x.add(this.position,zie,this.position),g(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var IV=bV;var Vie=new X(1,1);function rb(e){e=T(e,T.EMPTY_OBJECT),this.show=T(e.show,!0),this.updateCallback=e.updateCallback,this.loop=T(e.loop,!0),this.image=T(e.image,void 0);let t=e.emitter;g(t)||(t=new Fie(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=G.clone(T(e.modelMatrix,G.IDENTITY)),this._emitterModelMatrix=G.clone(T(e.emitterModelMatrix,G.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new G,this._startColor=K.clone(T(e.color,T(e.startColor,K.WHITE))),this._endColor=K.clone(T(e.color,T(e.endColor,K.WHITE))),this._startScale=T(e.scale,T(e.startScale,1)),this._endScale=T(e.scale,T(e.endScale,1)),this._emissionRate=T(e.emissionRate,5),this._minimumSpeed=T(e.speed,T(e.minimumSpeed,1)),this._maximumSpeed=T(e.speed,T(e.maximumSpeed,1)),this._minimumParticleLife=T(e.particleLife,T(e.minimumParticleLife,5)),this._maximumParticleLife=T(e.particleLife,T(e.maximumParticleLife,5)),this._minimumMass=T(e.mass,T(e.minimumMass,1)),this._maximumMass=T(e.mass,T(e.maximumMass,1)),this._minimumImageSize=X.clone(T(e.imageSize,T(e.minimumImageSize,Vie))),this._maximumImageSize=X.clone(T(e.imageSize,T(e.maximumImageSize,Vie))),this._sizeInMeters=T(e.sizeInMeters,!1),this._lifetime=T(e.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new xe,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}Object.defineProperties(rb.prototype,{emitter:{get:function(){return this._emitter},set:function(e){this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!G.equals(this._modelMatrix,e),G.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!G.equals(this._emitterModelMatrix,e),G.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){K.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){K.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});function zze(e){let t=e._emissionRate,n=e._maximumParticleLife,r=0,o=e._bursts;if(g(o)){let h=o.length;for(let d=0;d<h;++d)r+=o[d].maximum}let a=e._billboardCollection,s=e.image,u=Math.ceil(t*n+r),l=e._particles,c=e._particlePool,f=Math.max(u-l.length-c.length,0);for(let h=0;h<f;++h){let d=new IV;d._billboard=a.add({image:s}),c.push(d)}e._particleEstimate=u}function Vze(e){let t=e._particlePool.pop();return g(t)||(t=new IV),t}function kze(e,t){e._particlePool.push(t)}function Gze(e){let t=e._particles,n=e._particlePool,r=e._billboardCollection,o=t.length,a=n.length,s=e._particleEstimate,u=a-Math.max(s-o-a,0);for(let l=u;l<a;++l){let c=n[l];r.remove(c._billboard)}n.length=u}function Uze(e){g(e._billboard)&&(e._billboard.show=!1)}function kie(e,t){let n=t._billboard;g(n)||(n=t._billboard=e._billboardCollection.add({image:t.image})),n.width=t.imageSize.x,n.height=t.imageSize.y,n.position=t.position,n.sizeInMeters=e.sizeInMeters,n.show=!0;let r=F.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),o=F.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),a=F.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),s=F.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);n.color=new K(r,o,a,s),n.scale=F.lerp(t.startScale,t.endScale,t.normalizedAge)}function Hze(e,t){t.startColor=K.clone(e._startColor,t.startColor),t.endColor=K.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=F.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=F.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=F.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=F.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;let n=F.randomBetween(e._minimumSpeed,e._maximumSpeed);x.multiplyByScalar(t.velocity,n,t.velocity),e._particles.push(t)}function qze(e,t){if(e._isComplete)return 0;t=F.mod(t,e._lifetime);let n=t*e._emissionRate,r=Math.floor(n);if(e._carryOver+=n-r,e._carryOver>1&&(r++,e._carryOver-=1),g(e.bursts)){let o=e.bursts.length;for(let a=0;a<o;a++){let s=e.bursts[a],u=e._currentTime;g(s)&&!s._complete&&u>s.time&&(r+=F.randomBetween(s.minimum,s.maximum),s._complete=!0)}}return r}var MR=new x;rb.prototype.update=function(e){if(!this.show)return;g(this._billboardCollection)||(this._billboardCollection=new ig),this._updateParticlePool&&(zze(this),this._updateParticlePool=!1);let t=0;this._previousTime&&(t=ce.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);let n=this._particles,r=this._emitter,o=this.updateCallback,a,s,u=n.length;for(a=0;a<u;++a)s=n[a],s.update(t,o)?kie(this,s):(Uze(s),kze(this,s),n[a]=n[u-1],--a,--u);n.length=u;let l=qze(this,t);if(l>0&&g(r)){this._matrixDirty&&(this._combinedMatrix=G.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);let c=this._combinedMatrix;for(a=0;a<l;a++)s=Vze(this),this._emitter.emit(s),x.add(s.position,s.velocity,MR),G.multiplyByPoint(c,MR,MR),s.position=G.multiplyByPoint(c,s.position,s.position),x.subtract(MR,s.position,s.velocity),x.normalize(s.velocity,s.velocity),Hze(this,s),kie(this,s)}if(this._billboardCollection.update(e),this._previousTime=ce.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=F.mod(this._currentTime,this._lifetime),this.bursts){let c=this.bursts.length;for(a=0;a<c;a++)this.bursts[a]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120===0&&Gze(this)};rb.prototype.isDestroyed=function(){return!1};rb.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),st(this)};var Gie=rb;function Uie(e){e=T(e,T.EMPTY_OBJECT),this.time=T(e.time,0),this.minimum=T(e.minimum,0),this.maximum=T(e.maximum,50),this._complete=!1}Object.defineProperties(Uie.prototype,{complete:{get:function(){return this._complete}}});var Hie=Uie;var Wze=F.toRadians(30);function DV(e){this._angle=T(e,Wze)}Object.defineProperties(DV.prototype,{angle:{get:function(){return this._angle},set:function(e){this._angle=e}}});DV.prototype.emit=function(e){let t=Math.tan(this._angle),n=F.randomBetween(0,F.TWO_PI),r=F.randomBetween(0,t),o=r*Math.cos(n),a=r*Math.sin(n),s=1;e.velocity=x.fromElements(o,a,s,e.velocity),x.normalize(e.velocity,e.velocity),e.position=x.clone(x.ZERO,e.position)};var qie=DV;function Yze(e,t){this.viewer=e,this.dataMgr=t.dataMgr,this.mtMgr=t.mtMgr,this.trainingClock=t.trainingClock,this.dataMgr.addReceiveDataListener("addDrop",l);let n=[],r=this,o=r.viewer.scene,a=0,s;function u(){if(!g(s)){s=document.createElement("canvas"),s.width=20,s.height=20;let f=s.getContext("2d");f.beginPath(),f.arc(8,8,8,0,Math.TWO_PI,!0),f.closePath(),f.fillStyle="rgb(255,174,3)",f.fill()}return s}setInterval(function(){let f=r.trainingClock.tick(),h=ce.toDate(f).getTime(),d=r.trainingClock.multiplier,p=2.5-d;if(p<.5&&(p=.5),h-a!==1e3&&c(n,h),n.length!==0)for(let y=0;y<n.length;y++){let v=n[y].info;if(n[y].status===!0&&v.header.datTime<=h-1e3){let w=r.mtMgr.ev_MTFlightDatas.get(v.header.sID);if(w!==void 0&&w.curTimeAttitude!==void 0&&w.curTimeAttitude.position!==void 0){let C=new Cn.eastNorthUpToFixedFrame(w.curTimeAttitude.position),E=new x(0,0,0),S=new X(1,1),A=new G,D=[new Hie({time:p,minimum:25,maximum:25},{time:50,minimum:25,maximum:25})];_(D,A,C,E,S,w)}n[y].status=!1}}function _(y,v,w,C,E,S){let A=te.fromHeadingPitchRoll(new qc(Math.toRadians(-S.curTimeAttitude.headingPitchRoll.roll),Math.PI/2+Math.toRadians(S.curTimeAttitude.headingPitchRoll.heading),Math.PI/2+Math.toRadians(-S.curTimeAttitude.headingPitchRoll.pitch))),D=G.fromRotationTranslation(A,C,v);function P(b,O){let m=b.position,I=x.normalize(m,new x);x.multiplyByScalar(I,O,I),b.velocity=x.add(b.velocity,I,b.velocity)}let M=new Gie({image:u(),startScale:10,endColor:K.WHITE.withAlpha(0),particleLife:5,speed:900,imageSize:E,emissionRate:0,emitter:new qie(Math.toRadians(30)),bursts:y,lifetime:5,sizeInMeters:!1,updateCallback:P,modelMatrix:w,emitterModelMatrix:D});o.primitives.add(M),setTimeout(function(){o.primitives.remove(M)},5e3)}a=h},1e3);function l(f){if(Array.isArray(f))for(let h=0;h<f.length;h++){let d={info:f[h],status:!0};n.push(d)}}function c(f,h){if(f.length!==0)for(let d=0;d<f.length;d++){let p=f[d];p.info.header.datTime>h&&(p.status=!0)}}}var LR=Yze;function zg(e,t){this.viewer=e,this.dis=1e3,this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.mtMgr=t.mtMgr}zg.prototype.RadarBeam=function(e){let t=this,n=t.dis,r={geometry:new Cesium.CylinderGeometry({length:n,topRadius:n/30,bottomRadius:1e-4,showTop:!1})},o=new Cesium.GeometryInstance({geometry:r.geometry}),a=new Cesium.MaterialAppearance({flat:!0,translucent:!0,material:new Cesium.Material({fabric:{type:"Color",uniforms:{color:new Cesium.Color(1,1,0,.5)}}})});t.viewer.scene.primitives.add(new Cesium.Primitive({releaseGeometryInstances:!1,geometryInstances:o,appearance:a,modelMatrix:Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(99.7892,40.4014,4500)),new Cesium.Cartesian3(0,0,800),new Cesium.Matrix4),name:e,show:!1}),0)};zg.prototype.lidarRadar=function(e,t,n){let r=this;r.viewer.entities.add({id:e,polyline:{positions:new Cesium.CallbackProperty(function(){let o=r.mtMgr.ev_MTFlightDatas.get(t);if(o===void 0||o.curTimeAttitude===void 0||o.curTimeAttitude.position===void 0)return;let a=jze(o,n);if(o!==void 0&&o.curTimeAttitude.fLat!==void 0){let s=[];return s.push(o.curTimeAttitude.position),s.push(a),s}},!1),width:1,material:Cesium.Color.YELLOW,clampToGround:!1}})};zg.prototype.getPrimitive=function(e){let t=this,n=t.viewer.scene.primitives.length;for(let r=0;r<n;++r){let o=t.viewer.scene.primitives.get(r);if(o.name===e)return o}};zg.prototype.sendModelMatrix=function(e,t,n){let r=n.position,o=t.tgtDis,a=n.headingPitchRoll,s=new Cesium.Matrix3.fromRotationY(Cesium.Cesium.Math.toRadians(90)),u=new Cesium.HeadingPitchRoll(a.heading,a.pitch,a.roll),l=this.transformFunc(r,void 0,new Cesium.Matrix4),c=Cesium.Quaternion.fromHeadingPitchRoll(u,new Cesium.Quaternion),f=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),c,new Cesium.Cartesian3(1,1,1)),h=Cesium.Matrix4.multiply(l,f,new Cesium.Matrix4),d=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Cesium.Math.toRadians(t.tgtAzimuth),Cesium.Cesium.Math.toRadians(t.tgtPitch),0),new Cesium.Quaternion),p=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),d,new Cesium.Cartesian3(1,1,1));h=Cesium.Matrix4.multiply(h,p,new Cesium.Matrix4);let _=new Cesium.Cartesian3(o,0,0);Cesium.Matrix4.multiplyByPoint(h,_,_),t.targetPos=_;let y=o/1e3,v=Cesium.Matrix4.fromRotationTranslation(s);Cesium.Matrix4.multiply(h,v,h);let w=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(y,y,y));Cesium.Matrix4.multiply(h,w,h);let C=Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,this.dis/2));return Cesium.Matrix4.multiply(h,C,h),h};zg.prototype.getEntity=function(e){return this.viewer.entities.getById(e)};zg.prototype.MisToPlane=function(e,t){return Xze(this.viewer,e,t)};zg.prototype.MisModelMatrix=function(e,t){let r=Cesium.Cartesian3.distance(e,t)/1110.7735888652096,o=Cesium.Cartesian3.midpoint(t,e,new Cesium.Cartesian3),a=new Cesium.Matrix4.fromScale(new Cesium.Cartesian3(r,r,r)),s=Wie(e,t),u=Yie(s);u.pitch=u.pitch+Cesium.Math.PI/2*3;let l=Cesium.Transforms.headingPitchRollToFixedFrame(o,u,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4);return Cesium.Matrix4.multiply(l,a,l),l};zg.prototype.MisModelMatrixCaptureState=function(e,t,n){let r=t%90,o=parseInt(t/90),a=n.curTimeAttitude.headingPitchRoll,s=this.transformFunc(e,void 0,new Cesium.Matrix4),u=Cesium.Quaternion.fromHeadingPitchRoll(a,new Cesium.Quaternion),l=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),u,new Cesium.Cartesian3(1,1,1)),c=Cesium.Matrix4.multiply(s,l,new Cesium.Matrix4),f=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(-45+r),0,0),new Cesium.Quaternion);o%2!==0&&(f=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(45-r),0,0),new Cesium.Quaternion));let h=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),f,new Cesium.Cartesian3(1,1,1));c=Cesium.Matrix4.multiply(c,h,new Cesium.Matrix4);let d=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(90)),p=Cesium.Matrix4.fromRotationTranslation(d);Cesium.Matrix4.multiply(c,p,c);let _=new Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,1110.7735888652096/2));return Cesium.Matrix4.multiply(c,_,c),c};function Xze(e,t,n){let r=new Cesium.Cartesian3.fromDegrees(99.7892,40.4114,2e3),o=new Cesium.Cartesian3.fromDegrees(99.7892,40.4014,2e3),a=Cesium.Cartesian3.midpoint(o,r,new Cesium.Cartesian3),s=Cesium.Cartesian3.distance(r,o),u=Wie(r,o),l=Yie(u);l.pitch=l.pitch+Cesium.Math.PI/2*3;let c=Cesium.Transforms.headingPitchRollToFixedFrame(a,l,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4),f={geometry:new Cesium.CylinderGeometry({length:s,topRadius:s/40,bottomRadius:0,showTop:!1}),id:t},h=`uniform vec4 color;
uniform float repeat;
uniform float offset;
uniform float thickness;
czm_material czm_getMaterial(czm_materialInput materialInput){
czm_material material = czm_getDefaultMaterial(materialInput);
float sp = 1.0/repeat;
vec2 st = materialInput.st;
float dis = distance(st, vec2(0.5));
float m = mod(dis + offset, sp);
float a = step(sp*(1.0-thickness), m);
material.diffuse = color.rgb;
material.alpha = a * color.a;
return material;}`,d=new Cesium.Material({fabric:{uniforms:{color:new Cesium.Color(0,1,0,1),repeat:30,offset:0,thickness:.15},source:h},translucent:!0}),p=new Cesium.MaterialAppearance({material:d,faceForward:!1,closed:!1}),_=e.scene.primitives.add(new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance(f),appearance:p,releaseGeometryInstances:!1,modelMatrix:c,name:`${t}_radar`})),y={sid:t};return e.scene.preUpdate.addEventListener(function(){let w=_.appearance.material.uniforms.offset;w-=.001,w>1&&(w=0),_.appearance.material.uniforms.offset=w},y),_}function Wie(e,t){let n=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),r=Cesium.Cartesian3.normalize(n,new Cesium.Cartesian3),o=Cesium.Transforms.rotationMatrixFromPositionVelocity(e,r,Cesium.Ellipsoid.WGS84),a=Cesium.Quaternion.fromRotationMatrix(o),s=Cesium.Matrix4.fromRotationTranslation(o,e),u=Cesium.HeadingPitchRoll.fromQuaternion(a);return s}function Yie(e){return Cesium.Transforms.fixedFrameToHeadingPitchRoll(e)}function jze(e,t){let n=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),r=e.curTimeAttitude.position,o=t.fDistance,a=e.curTimeAttitude.headingPitchRoll,s=new Cesium.HeadingPitchRoll(a.heading,a.pitch,a.roll),u=n(r,void 0,new Cesium.Matrix4),l=Cesium.Quaternion.fromHeadingPitchRoll(s,new Cesium.Quaternion),c=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),l,new Cesium.Cartesian3(1,1,1)),f=Cesium.Matrix4.multiply(u,c,new Cesium.Matrix4),h=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(t.irmslAzimuth),Cesium.Math.toRadians(t.irmslPitch),0),new Cesium.Quaternion),d=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),h,new Cesium.Cartesian3(1,1,1));f=Cesium.Matrix4.multiply(f,d,new Cesium.Matrix4);let p=new Cesium.Cartesian3(o,0,0);return Cesium.Matrix4.multiplyByPoint(f,p,p),p}var RR=zg;function OR(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._scale=Cesium.defaultValue(e.scale,3),this._color=Cesium.defaultValue(e.color,new Cesium.Color(255/255,255/255,255/255,1)),this._fieldAngle=Cesium.defaultValue(e.fieldAngle,60),this.aspectRatio=7,this.lastResetScaleTime=new Date().getTime(),this.scaleMatrix3=[];for(var t=0;t<8;t++)this.scaleMatrix3.push(new Cesium.Matrix3);this.instances=[],this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this._center=new Cesium.Cartesian3,this._dynamic=Cesium.defaultValue(e.dynamic,!1),this.lightningTexture=void 0,this.lightningImage=void 0;var n=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1}),uniformMap:{u_lightningImage:function(){return n.lightningTexture},u_lightningColor:function(){return n._color}}}),Cesium.Resource.createIfNeeded(Cesium.buildModuleUrl("Assets/EMExtensions/PolitTraningApp/images/Lightnings.png")).fetchImage().then(function(r){n.lightningImage=r})}Object.defineProperties(OR.prototype,{color:{get:function(){return this._color},set:function(e){this._color=e}},scale:{get:function(){return this._scale},set:function(e){this._scale=e}},fieldAngle:{get:function(){return this._fieldAngle},set:function(e){this._fieldAngle=e}}});OR.prototype.resetInstances=function(e){this.instances=e,this.blUpdateVAO=!0};OR.prototype.update=function(e){var t=e.context,n=this._command;if(Cesium.defined(this.lightningImage)&&!Cesium.defined(this.lightningTexture)&&(this.lightningTexture=new Cesium.Texture({context:t,source:this.lightningImage,sampler:new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})})),!!Cesium.defined(this.lightningTexture)){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Jze(),fragmentShaderSource:$ze()})),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=Kze(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)){var r=e.commandList;r.push(n)}this.blUpdateVAO=!1}};function Kze(e,t){for(var n=Qze(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=12,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1}},u=t.instances.length,l=new Uint8Array(u),c=0;c<u;++c)l[c]=t.instances[c].jamDir;s.a_jamDir={index:0,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:l,usage:Cesium.BufferUsage.STATIC_DRAW}),componentsPerAttribute:1,componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1},t4e(t);var f=e4e(t),h=0,d=[];return d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.position),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.dirType),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:1,normalize:!1}),s.czm_modelMatrixRow0.index=h++,d.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=h++,d.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=h++,d.push(s.czm_modelMatrixRow2),s.a_jamDir.index=h++,d.push(s.a_jamDir),new Cesium.VertexArray({context:e,attributes:d,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:f.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var Zze=new G;function Qze(e){var t=e.instances,n=t.length,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix;s.push(new Cesium.Cartesian3(l[12],l[13],l[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(s);for(var u=0;u<n;++u){var l=t[u].modelMatrix,c=Cesium.Matrix4.clone(l,Zze);c[12]=c[12]-e.boundingSphere.center.x-r.x,c[13]=c[13]-e.boundingSphere.center.y-r.y,c[14]=c[14]-e.boundingSphere.center.z-r.z;var f=u*o;a[f+0]=c[0],a[f+1]=c[4],a[f+2]=c[8],a[f+3]=c[12],a[f+4]=c[1],a[f+5]=c[5],a[f+6]=c[9],a[f+7]=c[13],a[f+8]=c[2],a[f+9]=c[6],a[f+10]=c[10],a[f+11]=c[14]}return a}function Jze(){var e=`attribute vec3 position;
attribute vec2 st;
attribute float dirType; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute float a_jamDir; 
varying vec2   v_textureCoordinates;
varying float  v_dirType;
varying float  v_discard;
void main()
{
    v_textureCoordinates = st; 
    v_dirType = dirType; 
    float Dir_RightBack = 0.0;
    float Dir_LeftBack = 0.0;
    float Dir_RightFront = 0.0;
    float Dir_LeftFront = 0.0;
    float tempValue = a_jamDir;
    Dir_RightBack = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue = floor(tempValue*0.5);
    Dir_LeftBack = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue =  floor(tempValue*0.5);
    Dir_RightFront = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue =   floor(tempValue*0.5);
    Dir_LeftFront = tempValue >0.0 ? 1.0 : 0.0;  
    v_discard = 1.0;
    float absDirType = abs(dirType);
    if(absDirType > 0.0 && absDirType<2.0 && Dir_RightBack > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 1.0 && absDirType<3.0 && Dir_LeftBack > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 3.0 && absDirType<5.0 && Dir_RightFront > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 7.0 && absDirType<9.0 && Dir_LeftFront > 0.0){
       v_discard = 0.0;
    }
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function $ze(){var e=`varying vec2  v_textureCoordinates;
varying float  v_dirType;
varying float  v_discard;
uniform sampler2D  u_lightningImage;
uniform vec4  u_lightningColor;
void main()
{
    vec4 colour = texture2D(u_lightningImage, v_textureCoordinates); 
    if(v_discard > 0.0 ){;
       discard;  
    };
    if(v_dirType < 0.0 ){;
       colour.a *= 0.3;  
    };
    if(colour.a >= 0.0001 ){
      colour.rgb = u_lightningColor.rgb; 
    }
    gl_FragColor = colour;
}
`;return e}var ee=new x;function e4e(e){var t=e.color,n=e.fieldAngle,r=e.aspectRatio,o=0,a=10,s=10,u=32,l=new Float32Array(u*3),c=new Float32Array(u*2),f=new Float32Array(u),h=Math.sin(Cesium.Math.toRadians(n*.5)),d=Math.cos(Cesium.Math.toRadians(n*.5)),p=Math.sin(Cesium.Math.toRadians(o)),_=new Array(4);_[0]=new Cesium.Cartesian3(0,h,0),_[1]=new Cesium.Cartesian3(r*d,d+r*h,(d+r*h)*p),_[2]=new Cesium.Cartesian3(h+r*d,r*h,r*h*p),_[3]=new Cesium.Cartesian3(h,0,0);var y=new Array(4);y[0]=new Cesium.Cartesian3(a,0,0),y[1]=new Cesium.Cartesian3(-s,0,0),y[2]=new Cesium.Cartesian3(a,0,0),y[3]=new Cesium.Cartesian3(-s,0,0);var v=0,w=0,C=0;ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],_[0],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],_[1],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],_[2],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],_[3],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],_[0],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],_[1],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],_[2],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],_[3],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],_[0],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],_[1],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],_[2],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],_[3],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],_[0],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],_[1],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],_[2],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],_[3],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],_[0],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],_[1],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],_[2],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],_[3],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],_[0],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],_[1],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],_[2],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],_[3],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],_[0],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],_[1],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],_[2],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],_[3],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],_[0],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],_[1],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],_[2],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],_[3],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=1,c[C++]=0;for(var E=8*6,S=Cesium.IndexDatatype.createTypedArray(u,E),A=0;A<8;A++)S[A*6]=A*4+0,S[A*6+1]=A*4+1,S[A*6+2]=A*4+2,S[A*6+3]=A*4+0,S[A*6+4]=A*4+2,S[A*6+5]=A*4+3;return{position:l,st:c,dirType:f,indices:S}}function t4e(e){var t=e.scale,n=new Date().getTime();if(n-e.lastResetScaleTime>200){var r=Math.random()*100,o=r%t*2/3+t/3;r=Math.random()*100;var a=r%t*2/3+t/3;r=Math.random()*100;var s=r%t*2/3+t/3;r=Math.random()*100;var u=r%t*2/3+t/3;e.scaleMatrix3.length==8&&(Cesium.Matrix3.fromScale(new Cesium.Cartesian3(o,o,o),e.scaleMatrix3[0]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-s,s,s),e.scaleMatrix3[1]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(a,-a,a),e.scaleMatrix3[2]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-u,-u,u),e.scaleMatrix3[3]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(a,a,a),e.scaleMatrix3[4]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-u,u,u),e.scaleMatrix3[5]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(o,-o,o),e.scaleMatrix3[6]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-s,-s,s),e.scaleMatrix3[7])),e.lastResetScaleTime=n}}var NR=OR;function Yd(e,t){if(this.options=t,this.viewer=e,!!Cesium.defined(this.viewer)&&(this.scene=this.viewer.scene,this.trainingClock=Cesium.defaultValue(t.trainingClock,void 0),this.dataMgr=Cesium.defaultValue(t.dataMgr,void 0),this.mtMgr=Cesium.defaultValue(t.mtMgr,void 0),!(!Cesium.defined(this.scene)||!Cesium.defined(this.mtMgr)))){this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.ev_radarJamDirCollection=new NR({scale:6}),this.ev_paRadarBeam=new RR(this.viewer,this.options),this.ev_mtRadarTargetDatas=new Cesium.AssociativeArray,this.ev_mtRadarWMDatas=new Cesium.AssociativeArray,this.ev_mtRadarJamDirDatas=new Cesium.AssociativeArray,this.ev_mtIrstWMDatas=new Cesium.AssociativeArray,this.ev_mtMisRadar=new Cesium.AssociativeArray,this.ev_mtSdrStateRadar=new Cesium.AssociativeArray,this._planeSectorRadarColor=new Cesium.Color(58/255,213/255,252/255,60/255),this._planeSectorRadarVisible=!0,this._undergroundSectorRadarColor=new Cesium.Color(0/255,85/255,255/255,60/255),this._planePARadarColor=new Cesium.Color(.18,.75,.49,.6),this._undergroundPARadarColor=new Cesium.Color(.4,0,0,.6),this.ev_simpleConeRadars=new QP(this.options),this.conePARadarTypes=[];var n=this;n.receiveRadarTargetsListenerFunc=function(r){if(Array.isArray(r)){for(var o=0;o<r.length-1;o++)Math.abs(r[o].header.datTime-r[o+1].header.datTime)<500&&(r.splice(o,1),o--);for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarTargetDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarTargetDatas.set(a.header.sID,[a])}}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_TARGET,n.receiveRadarTargetsListenerFunc),n.receiveRadarWMListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarWMDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarWMDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_RDR_STATE,n.receiveRadarWMListenerFunc),n.receiveRadarJamDirListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarJamDirDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarJamDirDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_EWS_STA,n.receiveRadarJamDirListenerFunc),n.receiveIRSTWMListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtIrstWMDatas.get(a.header.sID);s?s.push(a):n.ev_mtIrstWMDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_IRMSL_STATE,n.receiveIRSTWMListenerFunc),n.receiveSdrStateRadarListenerFunc=function(r){if(Array.isArray(r)){for(var o=0;o<r.length-1;o++)Math.abs(r[o].header.datTime-r[o+1].header.datTime)<500&&(r.splice(o,1),o--);for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtSdrStateRadar.get(a.header.sID);s?s.push(a):n.ev_mtSdrStateRadar.set(a.header.sID,[a])}}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_RAD_STATE,n.receiveSdrStateRadarListenerFunc),n.scene.primitives.add(n)}}Object.defineProperties(Yd.prototype,{planePARadarColor:{get:function(){return this._planePARadarColor},set:function(e){this._planePARadarColor=e}},undergroundPARadarColor:{get:function(){return this._undergroundPARadarColor},set:function(e){this._undergroundPARadarColor=e}},planeSectorRadarColor:{get:function(){return this._planeSectorRadarColor},set:function(e){this._planeSectorRadarColor=e}},planeSectorRadarVisible:{get:function(){return this._planeSectorRadarVisible},set:function(){this._planeSectorRadarVisible?this._planeSectorRadarVisible=!1:this._planeSectorRadarVisible=!0}},undergroundSectorRadarColor:{get:function(){return this._undergroundSectorRadarColor},set:function(e){this._undergroundSectorRadarColor=e}}});var n4e=new G,__=[],BR=[],fw=[];Yd.prototype.prePassesUpdate=function(e){if(e.mode==Cesium.SceneMode.SCENE3D){var t=new Date().getTime();if(Cesium.defined(this.trainingClock)){var n=this.trainingClock.tick();t=Cesium.JulianDate.toDate(n).getTime(),t=this.mtMgr.lastTrainingTimeMsec}var r=o4e(this,t),o=s4e(this,t),a=a4e(this,t),s=u4e(this,t),u=r4e(this,t),l=i4e(this,t);BR=[],this.conePARadarTypes=[];for(var c in u._hash){var f=u.get(c),h=l.get(c),d=this.mtMgr.ev_MTFlightDatas.get(f.header.sID);if(d){if(d.sectorRadarVisible=!1,f.openState==1&&f.radiaState==1){var p=!1,_=!1;if(!Cesium.defined(h)||Cesium.defined(h.showSector)&&h.showSector)p=!0;else for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch===0?p=!0:_=!0}if(!_&&p)d.sectorRadarVisible=this._planeSectorRadarVisible,d.sectorRadarColor=this._planeSectorRadarColor;else if(_){var C=h.nearestTimeAttitude;C.position=d.curTimeAttitude.position;for(var E=h.header.datTime,y=h.tgtInfo,w,v=0;v<y.length&&v<h.tgtNum;v++)if(w=y[v],w.tgtSensor==0||w.tgtSensor==2){var S=c+"_"+v;Cesium.defined(C.position)&&this.conePARadarTypes.push({name:S,show:!0,color:this.planePARadarColor,modelMatrix:this.calcPARadarModelMatrix(w,C,this.ev_simpleConeRadars.cylinderLength)})}}}else if(f.openState==0||f.radiaState==0){if(h!==void 0)for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch}}else if(f.openState==1&&f.interceptState==1&&h!=null)for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];w.tgtSensor==1}}}var A=[];for(var c in r._hash){var D=r.get(c),d=this.mtMgr.ev_MTFlightDatas.get(D.header.sID);if(d){var P=d.curTimeAttitude.position,M=Cesium.defined(d.curTimeAttitude.scale)?d.curTimeAttitude.scale:1,b=Cesium.defined(d.curTimeAttitude.visible)?d.curTimeAttitude.visible:!1;if(b&&D.ewsDir>0){var O=new Cesium.HeadingPitchRoll(d.curTimeAttitude.headingPitchRoll.heading,d.curTimeAttitude.headingPitchRoll.pitch,d.curTimeAttitude.headingPitchRoll.roll),m=this.transformFunc(P,void 0,n4e),I=Cesium.Quaternion.fromHeadingPitchRoll(O,new Cesium.Quaternion),L=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),I,new Cesium.Cartesian3(M,M,M));m=Cesium.Matrix4.multiply(m,L,new Cesium.Matrix4),A.push({modelMatrix:m,jamDir:D.ewsDir})}}}this.ev_radarJamDirCollection&&this.ev_radarJamDirCollection.resetInstances(A);for(var c in o._hash){var R=o.get(c),d=this.mtMgr.ev_MTFlightDatas.get(R.header.sID);if(d){var N=d.curTimeAttitude.specialAttributes,S=c+"_liderRadar";if(Cesium.defined(N.decoyDrop)&&N.decoyDrop==1){var B=__.indexOf(S);if(B===-1)__.push(S),this.ev_paRadarBeam.lidarRadar(S,c,R);else{var V=this.ev_paRadarBeam.getEntity(S);V!=null&&(V.show=!0),BR.push(S)}}else if(Cesium.defined(N.decoyDrop)&&N.decoyDrop==0){var V=this.ev_paRadarBeam.getEntity(S);V!=null&&(V.show=!1)}}}for(var c in a._hash){var z=a.get(c),U=c;if(z.header.datTime-t<-1e3){var Q=this.ev_paRadarBeam.getPrimitive(U+"_radar");Q!=null&&(Q.show=!1)}else if(z.captureState!=0){var Q=this.ev_paRadarBeam.getPrimitive(U+"_radar");if(Q==null){var Q=this.ev_paRadarBeam.MisToPlane(U);Q.show=!0,__.push(U+"_radar");var ne={sid:U,count:0};fw.push(ne)}else if(Q!=null){BR.push(U+"_radar");for(var v=0;v<fw.length;v++){var w=fw[v];w.sid==U&&w.count++}if(this.mtMgr.ev_MTFlightDatas.get(U)!=null&&this.mtMgr.ev_MTFlightDatas.get(z.targetID)!=null){for(var se=void 0,de=U.split("_")[0],pe=0;pe<this.mtMgr.ev_MTFlightDatas.length;pe++){var d=this.mtMgr.ev_MTFlightDatas.values[pe];if(typeof d.uId=="string"){var ve=d.uId.split("_");if(ve.length==3&&ve[0]===de&&ve[2]==="5"){se=this.mtMgr.ev_MTFlightDatas.values[pe].curTimeAttitude;break}}}if(Cesium.defined(se)){var ft=this.mtMgr.ev_MTFlightDatas.get(U).curTimeAttitude.position,pt=this.mtMgr.ev_MTFlightDatas.get(z.targetID).curTimeAttitude.position,Xt=se.nRedOrBlue;if(pt!=null&&ft!=null){var At=this.ev_paRadarBeam.MisModelMatrix(ft,pt);if(z.captureState==2){for(var wt=0,v=0;v<fw.length;v++){var w=fw[v];w.sid==U&&(wt=w.count)}At=this.ev_paRadarBeam.MisModelMatrixCaptureState(ft,wt,this.mtMgr.ev_MTFlightDatas.get(U)),Q.modelMatrix=At,Q.show=!0,Xt==0?Q.appearance.material.uniforms.color=new Cesium.Color(1,0,0,1):Xt==1&&(Q.appearance.material.uniforms.color=new Cesium.Color(0,0,1,1))}else z.captureState==1&&(Q.modelMatrix=At,Xt==0?Q.appearance.material.uniforms.color=new Cesium.Color(1,0,0,1):Xt==1&&(Q.appearance.material.uniforms.color=new Cesium.Color(0,0,1,1)),Q.show=!0)}}}}}else if(z.captureState==0){var Q=this.ev_paRadarBeam.getPrimitive(U+"_radar");if(Q!=null)Q.show=!1;else if(Q==null){var Q=this.ev_paRadarBeam.MisToPlane(U);Q.show=!1,__.push(U+"_radar");var ne={sid:U,count:0};fw.push(ne)}}}for(var c in s._hash){var Rr=!1,gi=!1,$i=s.get(c),h=l.get(c);if(h==null){for(var ut in l._hash)if(c==ut.split("_")[0]){h=l.get(ut);break}}if(h!=null){var y=h.tgtInfo;if($i.openState==1)for(var v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch===0?(Rr=!1,gi=!0):(Rr=!0,gi=!1)}else $i.openState==0&&(gi=!1,Rr=!1)}if(gi){var ai=this.mtMgr.ev_MTFlightDatas.get(ut);ai!=null&&(ai.sectorRadarVisible=!0)}else if(Rr){var ai=this.mtMgr.ev_MTFlightDatas.get(ut);ai!=null&&(ai.sectorRadarVisible=!0);var C=h.nearestTimeAttitude,E=h.header.datTime,y=h.tgtInfo,w;if(C!=null&&C.fAlt!=null){for(var v=0;v<y.length&&v<h.tgtNum;v++)if(w=y[v],w.tgtSensor==0||w.tgtSensor==2){var S=c+"_"+v;Cesium.defined(C.position)&&this.conePARadarTypes.push({name:S,show:!0,color:this.undergroundPARadarColor,modelMatrix:this.calcPARadarModelMatrix(w,C,this.ev_simpleConeRadars.cylinderLength,new Cesium.Cartesian3(1,.6,.6))})}}}}this.ev_simpleConeRadars.recreateVertexArrays(this.conePARadarTypes,e);for(var v=0;v<__.length;v++){var B=BR.indexOf(__[v]);if(B===-1){var Q=this.ev_paRadarBeam.getPrimitive(__[v]);Q!=null&&(Q.show=!1);var V=this.ev_paRadarBeam.getEntity(__[v]);V!=null&&(V.show=!1)}}}};Yd.prototype.update=function(e){e.mode==Cesium.SceneMode.SCENE3D&&(this.ev_radarJamDirCollection&&this.ev_radarJamDirCollection.update(e),this.ev_simpleConeRadars&&this.ev_simpleConeRadars.update(e))};Yd.prototype.removeAllRadarDatas=function(){this.ev_mtRadarTargetDatas.removeAll(),this.ev_mtRadarWMDatas.removeAll(),this.ev_mtRadarJamDirDatas.removeAll(),this.ev_mtMisRadar.removeAll()};Yd.prototype.addRadarWMDatas=function(e,t,n){n=Cesium.defaultValue(n,Fr.ADD);var r=this.ev_mtRadarTargetDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarTargetDatas.set(e,[]),r=this.ev_mtRadarTargetDatas.get(e)),n==Fr.ADD?this.ev_mtRadarTargetDatas._hash[e]=r.concat(t):n==Fr.REPLACE&&(r=[],this.ev_mtRadarTargetDatas._hash[e]=r.concat(t))};Yd.prototype.addRadarWMDatas=function(e,t,n){n=Cesium.defaultValue(n,Fr.ADD);var r=this.ev_mtRadarWMDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarWMDatas.set(e,[]),r=this.ev_mtRadarWMDatas.get(e)),n==Fr.ADD?this.ev_mtRadarWMDatas._hash[e]=r.concat(t):n==Fr.REPLACE&&(r=[],this.ev_mtRadarWMDatas._hash[e]=r.concat(t))};Yd.prototype.addRadarJamDirDatas=function(e,t,n){n=Cesium.defaultValue(n,Fr.ADD);var r=this.ev_mtRadarJamDirDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarJamDirDatas.set(e,[]),r=this.ev_mtRadarJamDirDatas.get(e)),n==Fr.ADD?this.ev_mtRadarJamDirDatas._hash[e]=r.concat(t):n==Fr.REPLACE&&(r=[],this.ev_mtRadarJamDirDatas._hash[e]=r.concat(t))};wh.prototype.addev_mtMisRadar=function(e,t,n){};function r4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarWMDatas._hash){var o=e.ev_mtRadarWMDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function i4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarTargetDatas._hash){var o=e.ev_mtRadarTargetDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a in e.mtMgr.ev_dataMgr.idchUnderRaderList._hash)r==a&&(r=e.mtMgr.ev_dataMgr.idchUnderRaderList.get(a));var s=e.mtMgr.ev_MTFlightDatas.get(r);if(s)for(var u=o[0].header,l=u,c=1;c<o.length;c++){if(l=o[c].header,t>=u.datTime&&t<=l.datTime){l.datTime-u.datTime>=2e3?o[c-1].showSector=!0:l.datTime-u.datTime<2e3&&l.datTime-u.datTime>0&&(o[c-1].showSector=!1,Cesium.defined(o[c-1].nearestTimeAttitude)?Math.abs(o[c-1].header.datTime-o[c-1].nearestTimeAttitude.realTime)>=Math.abs(o[c-1].header.datTime-t)&&(o[c-1].nearestTimeAttitude=s.curTimeAttitude):o[c-1].nearestTimeAttitude=s.curTimeAttitude,Cesium.defined(o[c].nearestTimeAttitude)?Math.abs(o[c].header.datTime-o[c].nearestTimeAttitude.realTime)>=Math.abs(o[c].header.datTime-t)&&(o[c].nearestTimeAttitude=s.curTimeAttitude):o[c].nearestTimeAttitude=s.curTimeAttitude),n.set(r,o[c-1]),c-2>0&&o.splice(0,c-1);break}u=l}}}return n}function o4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarJamDirDatas._hash){var o=e.ev_mtRadarJamDirDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function a4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.mtMgr.ev_MTFlightDatas._hash){var o=e.mtMgr.ev_MTFlightDatas.get(r);if(o.curTimeAttitude.position!=null&&o.mtType==32){var a=e.dataMgr.splitTwo(t,o);n.set(r,a)}}return n}function s4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtIrstWMDatas._hash){var o=e.ev_mtIrstWMDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function u4e(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtSdrStateRadar._hash){var o=e.ev_mtSdrStateRadar.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}Yd.prototype.calcPARadarModelMatrix=function(e,t,n,r){var o=t.position,a=e.tgtDis,s=t.headingPitchRoll,C=Cesium.defaultValue(r,new Cesium.Cartesian3(1,1,1)),u=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(90)),l=new Cesium.HeadingPitchRoll(s.heading,s.pitch,s.roll),c=this.transformFunc(o,void 0,new Cesium.Matrix4),f=Cesium.Quaternion.fromHeadingPitchRoll(l,new Cesium.Quaternion),h=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),f,new Cesium.Cartesian3(1,1,1)),d=Cesium.Matrix4.multiply(c,h,new Cesium.Matrix4),p=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(e.tgtAzimuth),Cesium.Math.toRadians(e.tgtPitch),0),new Cesium.Quaternion),_=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),p,C);d=Cesium.Matrix4.multiply(d,_,new Cesium.Matrix4);var y=new Cesium.Cartesian3(a,0,0);Cesium.Matrix4.multiplyByPoint(d,y,y),e.targetPos=y;var v=a/1e3,w=Cesium.Matrix4.fromRotationTranslation(u);Cesium.Matrix4.multiply(d,w,d);var C=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(v,v,v));Cesium.Matrix4.multiply(d,C,d);var E=Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,n/2));return Cesium.Matrix4.multiply(d,E,d),d};Yd.prototype.isDestroyed=function(){return!1};Yd.prototype.destroy=function(){this.ev_mtRadarTargetDatas.removeAll(),this.ev_mtRadarWMDatas.removeAll(),this.ev_mtRadarJamDirDatas.removeAll();var e=this._scene.primitives.destroyPrimitives;return this._scene.primitives.destroyPrimitives=!1,this._scene.primitives.remove(this),this._scene.primitives.destroyPrimitives=e,Cesium.defined(this.ev_radarJamDirCollection)&&this.ev_radarJamDirCollection.destroy(),Cesium.defined(this.ev_simpleConeRadars)&&this.ev_simpleConeRadars.destroy(),Cesium.destroyObject(this)};var FR=Yd;function l4e(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.ev_dataMgr))throw new Cesium.DeveloperError("ev_dataMgr is empty!.");this.ev_dataMgr=e.ev_dataMgr,this.ev_MTUpdateProperties=new Cesium.AssociativeArray,this.trainingClock=e.trainingClock;var t=this;t.updatePropertiesFunc=function(n){if(t.cur_time=Cesium.JulianDate.toDate(t.trainingClock.currentTime).getTime(),n instanceof Array)for(var r=0;r<n.length;r++){var o=n[r];if(o.mtType==2){var a=t.ev_dataMgr.parseflight.get(o.uId),s=t.ev_dataMgr.initial_parseflight.get(o.uId);if(Cesium.defined(a)){var u=c4e(t.cur_time,a,s,t.ev_dataMgr);if(u)for(var l in u)l!="SIZE"&&l!="header"&&(o.specialAttributes[l]=u[l])}}}}}function c4e(e,t,n,r){var o=r.splitTwo(e,t);if(typeof o.remain_oil_amount=="number"){var a=n.remain_oil_amount-o.remain_oil_amount;o.remain_oil_amount=o.remain_oil_amount+" / "+a}return o}var zR=l4e;function Yh(e){var t=e.viewer,n=e.xmlObj;this.viewer=t,this.timeId=void 0,this.sliderWidth=0,this.wsUrl=e.wsUrl,this.callback=e.callback,this.trajStart=new Cesium.AssociativeArray,this.realDistance=new Cesium.AssociativeArray,this._maxTaskConcurrency=Cesium.defaultValue(5,e._maxTaskConcurrency);var r=this,o=e.workName;this.worker=new Cesium.TaskProcessor(o,this._maxTaskConcurrency),this.datSource=e.datSource,this.promise=this.worker.scheduleTask({url:r.wsUrl,datSource:r.datSource}),this.worker._worker.onmessage=function(a){var s=a.data;if(!Cesium.defined(s.id)&&s.length!=0){var u=Number(s[0]),l=Number(s[1]),c={startTime:new Date(u),endTime:new Date(l)};r.trainingClock=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(c.startTime),currentTime:Cesium.JulianDate.fromDate(c.startTime),stopTime:Cesium.JulianDate.fromDate(c.endTime),clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,clockRange:Cesium.ClockRange.CLAMPED}),r.ev_dataMgr=new zI({worker:r.worker,xmlUrl:n,datSource:r.datSource,trainingClock:r.trainingClock}),r.ev_mtMgr=new wh({viewer:t,ev_dataMgr:r.ev_dataMgr,trainingClock:r.trainingClock,useInstancedColor:!0}),r.ev_mtMgr.graduatedColors.set(0,{modelColor:new Cesium.Color(1,0,0,1),modelIconColor:new Cesium.Color(1,0,0,1),modelLabelTextColor:new Cesium.Color(1,0,0,1),modelLabelPullWireColor:new Cesium.Color(1,0,0,1),traceRibbonColor:new Cesium.Color(1,0,0,.8),traceLineColor:new Cesium.Color(1,0,0,.8),traceBarColor:new Cesium.Color(1,0,0,.8)}),r.ev_mtMgr.graduatedColors.set(1,{modelColor:new Cesium.Color(0,0,1,1),modelIconColor:new Cesium.Color(0,0,1,1),modelLabelTextColor:new Cesium.Color(0,0,1,1),modelLabelPullWireColor:new Cesium.Color(0,0,1,1),traceRibbonColor:new Cesium.Color(0,0,1,.8),traceLineColor:new Cesium.Color(0,0,1,.8),traceBarColor:new Cesium.Color(0,0,1,.8)}),r.ev_mtMgr.graduatedColors.set(2,{modelColor:new Cesium.Color(0,1,1,1),modelIconColor:new Cesium.Color(0,1,1,1),modelLabelTextColor:new Cesium.Color(0,1,1,1),modelLabelPullWireColor:new Cesium.Color(0,1,1,1),traceRibbonColor:new Cesium.Color(0,1,1,1),traceLineColor:new Cesium.Color(0,1,1,1),traceBarColor:new Cesium.Color(0,1,1,1)});var f=new Eh({});f.addDisplayFieldPara("\u5D4C\u8BADID:","uId"),f.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),f.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),f.addDisplayFieldPara("\u536B\u661F\u9AD8\u5EA6:","fAlt",2),f.addDisplayFieldPara("\u673A\u578B:","modelType"),f.addDisplayFieldPara("\u98DE\u673A\u4EE3\u53F7:","name"),f.addDisplayFieldPara("\u98DE\u884C\u5458\u4EE3\u5B57:","name"),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,f);var f=new Eh({showBackground:!1});f.addDisplayFieldPara("\u76EE\u6807:","targetID"),f.addDisplayFieldPara("\u7C7B\u578B:","weaponType"),f.addDisplayFieldPara("\u5F39\u76EE\u8DDD\u79BB:","mslDistance",2),f.addDisplayFieldPara("\u901F\u5EA6:","vel",2),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_WPN_TRAJ,f);var f=new Eh({});f.addDisplayFieldPara("\u5047\u9635\u5730\u7F16\u53F7:","fakeCampID"),f.addDisplayFieldPara("\u8425\u5730\u7C7B\u578B:","campType"),f.addDisplayFieldPara("\u88C5\u5907\u7C7B\u578B:","equipmentType"),f.addDisplayFieldPara("\u88C5\u5907\u7F16\u53F7ID:","equipmentID"),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,f),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_GTSPI,{minimumPixelSize:30}),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_TSPI,{minimumPixelSize:30}),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_WPN_TRAJ,{minimumPixelSize:20}),r.ev_mtUpdateProperties=new zR({ev_dataMgr:r.ev_dataMgr,trainingClock:r.trainingClock}),r.ev_mtMgr.preUpdateRenderMovingTargetFunc=r.ev_mtUpdateProperties.updatePropertiesFunc,r.ev_special=new LR(t,{dataMgr:r.ev_dataMgr,mtMgr:r.ev_mtMgr,trainingClock:r.trainingClock}),r.ev_mtSensorMgr=new FR(t,{dataMgr:r.ev_dataMgr,mtMgr:r.ev_mtMgr,trainingClock:r.trainingClock}),r.ev_DrawConnectionLines=new VI(t,{mtMgr:r.ev_mtMgr}),r.callback()}}}Object.defineProperties(Yh.prototype,{});Yh.prototype.startPlay=function(){if(!this.trainingClock.shouldAnimate){this.trainingClock.shouldAnimate=!0,this.trainingClock.tick();var e=Cesium.JulianDate.toDate(this.trainingClock.currentTime);this.ev_dataMgr.startSend()}};Yh.prototype.pausePlay=function(){this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!1,this.trainingClock.tick())};Yh.prototype.stopPlay=function(){};Yh.prototype.resetTimeLine=function(e,t){this.trainingClock.startTime=e,this.trainingClock.startTime=t,this.trainingClock.clockStep=Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,this.trainingClock.clockRange=Cesium.ClockRange.CLAMPED,this.trainingClock.tick()};Yh.prototype.resetCurrentTime=function(e){this.trainingClock.currentTime=e,this.trainingClock.tick()};Yh.prototype.resetTimeRate=function(t){var t=Number(t);this.trainingClock.multiplier=t};Yh.prototype.playBack=function(e){for(var t in this.ev_dataMgr.sendArr._hash){var n=this.ev_dataMgr.sendArr._hash[t].findIndex(function(u){return u.header.datTime>=e-100});this.ev_dataMgr.index.set(t,n)}for(var t in this.ev_dataMgr.trajData._hash){var r=this.ev_dataMgr.trajData._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.trajIndex.set(t,r)}this.ev_dataMgr.gtspiIndex=this.ev_dataMgr.gtspiData.findIndex(function(u){return u.header.datTime>=e});for(var t in this.ev_dataMgr.radarTargetMap._hash){var o=this.ev_dataMgr.radarTargetMap._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.radarIndex.set(t,o)}for(var t in this.ev_dataMgr.sdrState._hash){var a=this.ev_dataMgr.sdrState._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.sdrIndex.set(t,a)}for(var t in this.ev_dataMgr.ewsData._hash){var s=this.ev_dataMgr.ewsData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.ewsIndex.set(t,s)}this.ev_dataMgr.irsmIndex=this.ev_dataMgr.irsmData.findIndex(function(u){return u.header.datTime>=e}),this.ev_mtSensorMgr.removeAllRadarDatas(),this.ev_dataMgr.sendRadarMV=!0,this.ev_dataMgr.preTime=e,e=new Date(Number(e)),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_dataMgr.dataOperated=Fr.REPLACE,this.ev_dataMgr.trajOperated=Fr.REPLACE,this.ev_mtMgr.dataOperated=Fr.REPLACE};Yh.prototype.forward=function(e){for(var t in this.ev_dataMgr.sendArr._hash){var n=this.ev_dataMgr.sendArr._hash[t].findIndex(function(u){return u.header.datTime>=e-1200});n!=-1?this.ev_dataMgr.index.set(t,n):this.ev_dataMgr.index.set(t,this.ev_dataMgr.sendArr._hash[t].length)}for(var t in this.ev_dataMgr.trajData._hash){var r=this.ev_dataMgr.trajData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.trajIndex.set(t,r)}this.ev_dataMgr.gtspiIndex=this.ev_dataMgr.gtspiData.findIndex(function(u){return u.header.datTime>=e});for(var t in this.ev_dataMgr.radarTargetMap._hash){var o=this.ev_dataMgr.radarTargetMap._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.radarIndex.set(t,o)}for(var t in this.ev_dataMgr.sdrState._hash){var a=this.ev_dataMgr.sdrState._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.sdrIndex.set(t,a)}for(var t in this.ev_dataMgr.ewsData._hash){var s=this.ev_dataMgr.ewsData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.ewsIndex.set(t,s)}this.ev_dataMgr.irsmIndex=this.ev_dataMgr.irsmData.findIndex(function(u){return u.header.datTime>=e}),this.ev_mtSensorMgr.removeAllRadarDatas(),this.ev_dataMgr.sendRadarMV=!0,this.ev_dataMgr.preTime=e,e=new Date(Number(e)),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_dataMgr.dataOperated=Fr.REPLACE,this.ev_dataMgr.trajOperated=Fr.REPLACE,this.ev_mtMgr.dataOperated=Fr.REPLACE};Yh.prototype.reset=function(e){this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!1,this.trainingClock.tick()),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_mtMgr.removeAllMovingTargets()};Yh.prototype.playLineRun=function(){};var Xie=Yh;function ib(e){this.viewer=e.viewer,this.sTime=Cesium.defaultValue(e.sTime,new Date().getTime());var t=Cesium.defaultValue(e.timeSpace,180);this.eTime=Cesium.defaultValue(e.eTime,new Date(this.sTime+t).getTime()),this.trainingClock=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(new Date(this.sTime)),currentTime:Cesium.JulianDate.fromDate(new Date(this.sTime)),stopTime:Cesium.JulianDate.fromDate(new Date(this.eTime)),clockStep:Cesium.defaultValue(e.clockStep,Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER),clockRange:Cesium.defaultValue(e.clockRange,Cesium.ClockRange.UNBOUNDED)}),this.idIndex=0,this.modelType=0,this.timeId=[],this.rectSector=void 0,this.ev_mtMgr=new wh({viewer:this.viewer,ev_dataMgr:this,trainingClock:this.trainingClock,useInstancedColor:Cesium.defaultValue(e.useInstancedColor,!1),retainOutdatedData:Cesium.defaultValue(e.retainOutdatedData,!1),blShowOutdated:Cesium.defaultValue(e.retainOutdatedData,!1)});let n=e.ev_mtLabelConfiTable;if(n!=null){let r=n.font;this.ev_mtLabelConfiTable=new Eh({font:r});let o=n.displayFieldPara,a=this;for(let s in o)typeof o[s]=="string"?a.ev_mtLabelConfiTable.addDisplayFieldPara(s,o[s]):a.ev_mtLabelConfiTable.addDisplayFieldPara(s,o[s][0],Number(o[s][1]));this.ev_mtMgr.ev_MTLabelConfigurationTables.set(Number(n.mtType),this.ev_mtLabelConfiTable)}}ib.prototype.transmission=function(e){var t=this,n=Cesium.defaultValue(e.startlon,120);this.modelType++;var r=this.modelType,o=Cesium.defaultValue(e.lonStep,.2),a=Cesium.defaultValue(e.startlat,30),s=Cesium.defaultValue(e.latStep,.2),u=Cesium.defaultValue(e.altitude,1e4),l=Cesium.defaultValue(e.startroll,0),c=Cesium.defaultValue(e.modelUri,Cesium.buildModuleUrl("Assets/EMExtensions/gltf/J10C.gltf")),f=Cesium.defaultValue(e.modelIconUri,"../images/Flight_1.png"),h=Cesium.defaultValue(e.row,5),d=Cesium.defaultValue(e.scale,200),p=Cesium.defaultValue(e.column,5),_=Cesium.defaultValue(e.name,"plane"),y=Cesium.defaultValue(e.timeStep,1e3),v=Cesium.defaultValue(e.considerTerrain,!1),w=Cesium.defaultValue(e.sectorRadarVisible,!1),C=Cesium.defaultValue(e.openSectorPyramid,!1),E=e.sectorColor,S=Cesium.defaultValue(e.forwardDis,0),A=Cesium.defaultValue(e.radius,100);let D=[];for(var P=0;P<h;P++)for(var M=n+P*o,b=0;b<p;b++){var O=_+this.idIndex++,m=new Bu({uId:O,mtType:Re.NET_MSG_TSPI,name:_,modelType:r,modelUri:Cesium.buildModuleUrl(c),modelIconUri:Cesium.buildModuleUrl(f),modelIconDisplayDistance:new Cesium.DistanceDisplayCondition(5e5,5e7),modelIconScale:.5,scale:d,specialAttributes:{},ribbonVisible:!1,forwardOffset:-10,upOffset:5,traceTimeDuration:30,sectorRadarVisible:w}),I=a+b*s,L=0;m.addTimeAttitude({realTime:t.sTime,fLon:M,fLat:I,fAlt:u,position:Cesium.Cartesian3.fromDegrees(M,I,u),nRedOrBlue:0,headingPitchRoll:new Cesium.HeadingPitchRoll(0,0,0)}),D.push({lon:M,lat:I,rollDeg:L,mtFlightData:m})}setInterval(function(){var R=new Date().getTime();R+=2e3;for(var N=0;N<D.length;N++){if(D[N].lat+=.05,D[N].rollDeg=L,D[N].mtFlightData.timeAttitudeCollection=[],v){var B=t.viewer.scene.globe.getHeight(Cesium.Cartographic.fromDegrees(D[N].lon,D[N].lat));u=Cesium.defined(B)?B:u}D[N].mtFlightData.addTimeAttitude({realTime:R,fLon:D[N].lon,fLat:D[N].lat,fAlt:u,position:Cesium.Cartesian3.fromDegrees(D[N].lon,D[N].lat,u),nRedOrBlue:0,headingPitchRoll:new Cesium.HeadingPitchRoll(0,0,Cesium.Math.toRadians(D[N].rollDeg))}),t.ev_mtMgr.addMovingTargetTimeAttitude(D[N].mtFlightData.uId,D[N].mtFlightData)}},y),C&&(this.rectSector=new Mx({openSectorPyramid:!0,forwardDis:S,radius:A}),this.viewer.scene.primitives.add(this.rectSector),t.viewer.scene.preRender.addEventListener(function(){var R=t.ev_mtMgr.curTimeMovingTargets.filter(function(V){return V.name=="plane"});if(R.length!=0){for(var N=[],B=0;B<R.length;B++)N.push({position:R[B].position,scale:new Cesium.Cartesian3(R[B].scale,R[B].scale,R[B].scale),headingPitchRoll:new Cesium.HeadingPitchRoll(0,-1.57,0),color:E||R[B].sectorRadarColor});t.rectSector.resetRadarByPositionProperty(N)}})),this.trainingClock&&!this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!0,this.trainingClock.tick())};ib.prototype.transDataByXml=function(e){let t=e.mtData.movingTargetFlightData,n=this;if(t.length>0){for(let s=0;s<t.length;s++){let u=t[s],l=u.timeAttitudeCollection,c=new Bu({uId:u.uId,mtType:Number(u.mtType),name:u.name,modelType:u.modelType,modelUri:Cesium.buildModuleUrl(u.modelUri),modelIconUri:Cesium.buildModuleUrl(u.modelIconUri),modelIconDisplayDistance:new Cesium.DistanceDisplayCondition(Number(u.modelIconDisplayDistance[0],u.modelIconDisplayDistance[1])),modelIconScale:u.modelIconScale,scale:Number(u.scale),specialAttributes:u.specialAttributes,ribbonVisible:JSON.parse(u.ribbonVisible),forwardOffset:Number(u.forwardOffset),upOffset:Number(u.upOffset),traceTimeDuration:Number(u.traceTimeDuration),sectorRadarVisible:JSON.parse(u.sectorRadarVisible),wallVisible:JSON.parse(u.wallVisible),lineVisible:JSON.parse(u.lineVisible)});for(let f=0;f<l.length;f++){let h=l[f];c.addTimeAttitude({realTime:Number(h.realTime),fLon:Number(h.fLon),fLat:Number(h.fLat),fAlt:Number(h.fAlt),position:new Cesium.Cartesian3(Number(h.position.x),Number(h.position.y),Number(h.position.z)),nRedOrBlue:h.nRedOrBlue,headingPitchRoll:new Cesium.HeadingPitchRoll(Number(h.headingPitchRoll.heading),Number(h.headingPitchRoll.pitch),Number(h.headingPitchRoll.roll))})}n.ev_mtMgr.addMovingTargetTimeAttitude(u.uId,c),n.ev_mtMgr.enableSilhouette(Cesium.Color.BLUE,u.uId)}this.trainingClock&&!this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!0,this.trainingClock.tick())}let r=e.paRadar;if(Cesium.defined(r)&&r instanceof Array)for(let s=0;s<r.length;s++){let u=r[s].position;new Zg({viewer:this.viewer,position:new Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),radius:Number(r[s].radius),xHalfAngle:Number(r[s].xHalfAngle),yHalfAngle:Number(r[s].yHalfAngle)})}let o=e.gltfModel;if(o&&o instanceof Array)for(let s=0;s<o.length;s++){let u=o[s].position,l=o[s].model;this.viewer.entities.add({position:new Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),model:{uri:Cesium.buildModuleUrl(l.uri),scale:Number(l.scale)}})}let a=e.mechanicalRadar;if(a&&a instanceof Array)for(let s=0;s<a.length;s++){let u=a[s].position,l=a[s].filePath;new Qg({viewer:this.viewer,position:Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),showScan:Number(a[s].showScan),scanSpeed:Number(a[s].scanSpeed),filePath:Cesium.buildModuleUrl(a[s].filePath),radius:Number(a[s].radius),isDepthTest:Number(a[s].isDepthTest)})}};ib.prototype.addRadarPyramid=function(e){let t=this.ev_mtMgr.ev_MTFlightDatas._array;for(let r=0;r<t.length;r++){let o=t[r].uId;var n=e.entities.add({id:o+"py",position:new Cesium.Cartesian3.fromDegrees(117,31.5,1e3),cylinder:{length:1e4,topRadius:0,bottomRadius:5e3,slices:4,material:Cesium.Color.RED}})}};ib.prototype.addReceiveDataListener=function(){};var jie=ib;var HR={};ik(HR,{bbox:()=>kR,feature:()=>Qie,merge:()=>$ie,mergeArcs:()=>MV,mesh:()=>Jie,meshArcs:()=>PV,neighbors:()=>eoe,quantize:()=>toe,transform:()=>hw,untransform:()=>UR});function VR(e){return e}function hw(e){if(e==null)return VR;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f);for(h[0]=(t+=u[0])*r+a,h[1]=(n+=u[1])*o+s;c<f;)h[c]=u[c],++c;return h}}function kR(e){var t=hw(e.transform),n,r=1/0,o=r,a=-r,s=-r;function u(c){c=t(c),c[0]<r&&(r=c[0]),c[0]>a&&(a=c[0]),c[1]<o&&(o=c[1]),c[1]>s&&(s=c[1])}function l(c){switch(c.type){case"GeometryCollection":c.geometries.forEach(l);break;case"Point":u(c.coordinates);break;case"MultiPoint":c.coordinates.forEach(u);break}}e.arcs.forEach(function(c){for(var f=-1,h=c.length,d;++f<h;)d=t(c[f],f),d[0]<r&&(r=d[0]),d[0]>a&&(a=d[0]),d[1]<o&&(o=d[1]),d[1]>s&&(s=d[1])});for(n in e.objects)l(e.objects[n]);return[r,o,a,s]}function Kie(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n}function Qie(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Zie(e,n)})}:Zie(e,t)}function Zie(e,t){var n=t.id,r=t.bbox,o=t.properties==null?{}:t.properties,a=dw(e,t);return n==null&&r==null?{type:"Feature",properties:o,geometry:a}:r==null?{type:"Feature",id:n,properties:o,geometry:a}:{type:"Feature",id:n,bbox:r,properties:o,geometry:a}}function dw(e,t){var n=hw(e.transform),r=e.arcs;function o(f,h){h.length&&h.pop();for(var d=r[f<0?~f:f],p=0,_=d.length;p<_;++p)h.push(n(d[p],p));f<0&&Kie(h,_)}function a(f){return n(f)}function s(f){for(var h=[],d=0,p=f.length;d<p;++d)o(f[d],h);return h.length<2&&h.push(h[0]),h}function u(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function l(f){return f.map(u)}function c(f){var h=f.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":d=a(f.coordinates);break;case"MultiPoint":d=f.coordinates.map(a);break;case"LineString":d=s(f.arcs);break;case"MultiLineString":d=f.arcs.map(s);break;case"Polygon":d=l(f.arcs);break;case"MultiPolygon":d=f.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(t)}function GR(e,t){var n={},r={},o={},a=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=t[++s],t[s]=c,t[f]=d)}),t.forEach(function(c){var f=u(c),h=f[0],d=f[1],p,_;if(p=o[h])if(delete o[p.end],p.push(c),p.end=d,_=r[d]){delete r[_.start];var y=_===p?p:p.concat(_);r[y.start=p.start]=o[y.end=_.end]=y}else r[p.start]=o[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(c),p.start=h,_=o[h]){delete o[_.end];var v=_===p?p:_.concat(p);r[v.start=_.start]=o[v.end=p.end]=v}else r[p.start]=o[p.end]=p;else p=[c],r[p.start=h]=o[p.end=d]=p});function u(c){var f=e.arcs[c<0?~c:c],h=f[0],d;return e.transform?(d=[0,0],f.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=f[f.length-1],c<0?[d,h]:[h,d]}function l(c,f){for(var h in c){var d=c[h];delete f[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),a.push(d)}}return l(o,r),l(r,o),t.forEach(function(c){n[c<0?~c:c]||a.push([c])}),a}function Jie(e){return dw(e,PV.apply(this,arguments))}function PV(e,t,n){var r,o,a;if(arguments.length>1)r=f4e(e,t,n);else for(o=0,r=new Array(a=e.arcs.length);o<a;++o)r[o]=o;return{type:"MultiLineString",arcs:GR(e,r)}}function f4e(e,t,n){var r=[],o=[],a;function s(h){var d=h<0?~h:h;(o[d]||(o[d]=[])).push({i:h,g:a})}function u(h){h.forEach(s)}function l(h){h.forEach(u)}function c(h){h.forEach(l)}function f(h){switch(a=h,h.type){case"GeometryCollection":h.geometries.forEach(f);break;case"LineString":u(h.arcs);break;case"MultiLineString":case"Polygon":l(h.arcs);break;case"MultiPolygon":c(h.arcs);break}}return f(t),o.forEach(n==null?function(h){r.push(h[0].i)}:function(h){n(h[0].g,h[h.length-1].g)&&r.push(h[0].i)}),r}function h4e(e){for(var t=-1,n=e.length,r,o=e[n-1],a=0;++t<n;)r=o,o=e[t],a+=r[0]*o[1]-r[1]*o[0];return Math.abs(a)}function $ie(e){return dw(e,MV.apply(this,arguments))}function MV(e,t){var n={},r=[],o=[];t.forEach(a);function a(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(a);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(c){c.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),r.push(l)}function u(l){return h4e(dw(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return r.forEach(function(l){if(!l._){var c=[],f=[l];for(l._=1,o.push(c);l=f.pop();)c.push(l),l.forEach(function(h){h.forEach(function(d){n[d<0?~d:d].forEach(function(p){p._||(p._=1,f.push(p))})})})}}),r.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:o.map(function(l){var c=[],f;if(l.forEach(function(y){y.forEach(function(v){v.forEach(function(w){n[w<0?~w:w].length<2&&c.push(w)})})}),c=GR(e,c),(f=c.length)>1)for(var h=1,d=u(c[0]),p,_;h<f;++h)(p=u(c[h]))>d&&(_=c[0],c[0]=c[h],c[h]=_,d=p);return c}).filter(function(l){return l.length>0})}}function LV(e,t){for(var n=0,r=e.length;n<r;){var o=n+r>>>1;e[o]<t?n=o+1:r=o}return n}function eoe(e){var t={},n=e.map(function(){return[]});function r(y,v){y.forEach(function(w){w<0&&(w=~w);var C=t[w];C?C.push(v):t[w]=[v]})}function o(y,v){y.forEach(function(w){r(w,v)})}function a(y,v){y.type==="GeometryCollection"?y.geometries.forEach(function(w){a(w,v)}):y.type in s&&s[y.type](y.arcs,v)}var s={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(y,v){y.forEach(function(w){o(w,v)})}};e.forEach(a);for(var u in t)for(var l=t[u],c=l.length,f=0;f<c;++f)for(var h=f+1;h<c;++h){var d=l[f],p=l[h],_;(_=n[d])[u=LV(_,p)]!==p&&_.splice(u,0,p),(_=n[p])[u=LV(_,d)]!==d&&_.splice(u,0,d)}return n}function UR(e){if(e==null)return VR;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f),d=Math.round((u[0]-a)/r),p=Math.round((u[1]-s)/o);for(h[0]=d-t,t=d,h[1]=p-n,n=p;c<f;)h[c]=u[c],++c;return h}}function toe(e,t){if(e.transform)throw new Error("already quantized");if(!t||!t.scale){if(!((s=Math.floor(t))>=2))throw new Error("n must be \u22652");l=e.bbox||kR(e);var n=l[0],r=l[1],o=l[2],a=l[3],s;t={scale:[o-n?(o-n)/(s-1):1,a-r?(a-r)/(s-1):1],translate:[n,r]}}else l=e.bbox;var u=UR(t),l,c,f=e.objects,h={};function d(y){return u(y)}function p(y){var v;switch(y.type){case"GeometryCollection":v={type:"GeometryCollection",geometries:y.geometries.map(p)};break;case"Point":v={type:"Point",coordinates:d(y.coordinates)};break;case"MultiPoint":v={type:"MultiPoint",coordinates:y.coordinates.map(d)};break;default:return y}return y.id!=null&&(v.id=y.id),y.bbox!=null&&(v.bbox=y.bbox),y.properties!=null&&(v.properties=y.properties),v}function _(y){var v=0,w=1,C=y.length,E,S=new Array(C);for(S[0]=u(y[0],0);++v<C;)((E=u(y[v],v))[0]||E[1])&&(S[w++]=E);return w===1&&(S[w++]=[0,0]),S.length=w,S}for(c in f)h[c]=p(f[c]);return{type:"Topology",bbox:l,transform:t,objects:h,arcs:e.arcs.map(_)}}function y_(e){this.olMap=e.olMap,this.index=void 0,this.activeLayer={},this.clickDraw=void 0,this.style=void 0}y_.prototype.addClickDraw=function(e,t){let n=e.geometryType,r=e.vectorLayerId,o=this.getLayer(r),a=this;this.setClassStyle({fillColor:"rgba(0, 192, 51, 0.4)",strokeColor:"rgba(0, 192, 51, 1)",strokeWidth:1,imageRadius:4,imageColor:"rgba(0, 192, 51, 1)"}),this.olMap.removeInteraction(this.clickDraw),s(n,o);function s(u,l){let c=u,f=l;if(c!=="None"){let h,d;c==="Square"&&(c="Circle",h=ol.interaction.Draw.createRegularPolygon(4)),c==="Rectangle"&&(c="Circle",h=ol.interaction.Draw.createBox()),a.clickDraw=new ol.interaction.Draw({source:f,type:c,geometryFunction:h,maxPoints:d}),a.olMap.addInteraction(a.clickDraw)}else f.clear()}a.clickDraw.on("drawend",function(u){if(u.feature.setStyle(a.style),a.olMap.updateSize(),t&&typeof t=="function"){let l=[];u.feature.getGeometry().getCoordinates()?l=u.feature.getGeometry().getCoordinates():u.feature.getGeometry().getFlatCoordinates().forEach(function(f,h){h%2===0&&(l[Math.floor(h/2)]=[]),l[Math.floor(h/2)].push(f)}),t({feature:u.feature,positions:l})}})};y_.prototype.addDataDraw=function(e,t){let n=e.geometryType,r=e.positions,o=e.vectorLayerId,a=this.getLayer(o),s=e.id;if(this.index!==s.split("_")[1]*1)this.index=s.split("_")[1]*1;else{let c=a.getFeatureById(s);a.removeFeature(c)}let u;switch(n){case"Point":u=new ol.Feature({geometry:new ol.geom.Point(r)}),u.setId(s);break;case"LineString":u=new ol.Feature({geometry:new ol.geom.LineString(r)}),u.setId(s);break;case"Polygon":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Square":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Rectangle":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Circle":{let c=r[0],f=this.getRadius(r[2]);console.log(f),u=new ol.Feature({geometry:new ol.geom.Circle(c,f)}),u.setId(s);break}case"Ellipse":{let c=r[0],f=r[3]/1e5,h=r[4]/1e5,d=new ol.geom.Circle(c,f),p=ol.geom.Polygon.fromCircle(d,64);p.scale(1,h/f),u=new ol.Feature({geometry:p});let _=new ol.style.Style({fill:new ol.style.Fill({color:"#01fe01"}),stroke:new ol.style.Stroke({color:"#ff0000",lineCap:"round",width:0})});u.setStyle(_),u.setId(s);break}default:break}a.getFeatureById(u.getId())&&a.removeFeature(HR),a.addFeature(u),t(u)};y_.prototype.setClassStyle=function(e){let t=e.fillColor||"#00bf00",n=e.strokeColor||"#00c033",r=e.strokeWidth||2,o=e.imageRadius||6,a=e.imageColor||"#00c033";this.style=new ol.style.Style({fill:new ol.style.Fill({color:t}),stroke:new ol.style.Stroke({color:n,width:r}),image:new ol.style.Circle({radius:o,fill:new ol.style.Fill({color:a})})})};y_.prototype.getAuxAniStyle=function(e){return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0, 192, 51, 0.2"}),stroke:new ol.style.Stroke({color:"#00c033",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})})};y_.prototype.getLayer=function(e){let t=this.olMap.getAllLayers();for(let n=0;n<t.length;n++)if(t[n].get("layerId")===e)return t[n].getSource()};y_.prototype.deleteFeature=function(e,t,n){let r=this.getLayer(t),o=r.getFeatureById(n);r.removeFeature(o)};y_.prototype.getRadius=function(e){let t=this.olMap.getView().getProjection().getMetersPerUnit();return e/t};var qR=y_;function pw(e){this.olMap=e.olMap,this.olManagerMap=void 0;let t=this;this.olFeatures=new Proxy({size:0},{set:function(n,r,o){if(r!=="size"){let a;return o.getId()?a=o.getId():(a=t.createGuid(),o.setId(a)),t.olManagerMap.get(window.activeGroup).get(window.activeLayerId).features.push(a),n[a]=o,n.size=n.size+1,!0}return!0}})}pw.prototype.initMap=function(){this.olManagerMap=void 0,this.olManagerMap=new Map,this.addGroup("defaultGroup"),window.activeGroup="defaultGroup",window.olManagerMap=this.olManagerMap};pw.prototype.addGroup=function(e){let t=new Map;this.olManagerMap.set(e,t)};pw.prototype.addLayer=function(e,t){let n={features:[]};this.olManagerMap.get(e).set(t,n)};pw.prototype.addFeature=function(e){this.olFeatures.feature=e};pw.prototype.createGuid=Ci;var WR=pw;function YR(e){this.olMap=e.olMap,this.ev_OlDrawPrimitives=new qR({olMap:this.olMap}),this.ev_OlPriManager=new WR({olMap:this.olMap}),window.activeGroup=void 0,window.activeLayerId=void 0,this.olFeaturesCopy=void 0}YR.prototype.clickDraw=function(e,t){if(e==="Ellipse")return;(!window.activeLayerId||!window.activeGroup)&&this.drawInit();let n=window.activeLayerId,r=this;this.ev_OlDrawPrimitives.addClickDraw({geometryType:e,vectorLayerId:n},function(o){console.log(o);let a=o.feature,s=o.positions;r.ev_OlPriManager.addFeature(a),t({positions2D:s,id:a.getId()})})};YR.prototype.dataDraw=function(e){(!window.activeLayerId||!window.activeGroup)&&this.drawInit();let t=e.geometryType,n=e.positions,r=e.id,o=window.activeLayerId,a=this;this.ev_OlDrawPrimitives.addDataDraw({geometryType:t,vectorLayerId:o,positions:n,id:r},function(s){a.ev_OlPriManager.addFeature(s)})};YR.prototype.drawInit=function(){this.ev_OlPriManager.initMap();let e=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(188, 0, 0,0.4)"}),stroke:new ol.style.Stroke({color:"rgba(188, 0, 0,1)",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})})}),t="defaultLayer";e.set("layerId",t),this.olMap.addLayer(e),this.ev_OlPriManager.addLayer("defaultGroup",t),window.activeLayerId=t};var noe=YR;function ob(e){this.viewer=e.viewer,this.mapId="OlMap",this.mapDiv=void 0,this.brotherDiv=void 0,this.olMap=void 0,this.isActive=!1,this.isIn2DMapFlag=!1,this.flag=!0;let t=this;this._changeCenterListener=function(){if(t.isIn2DMapFlag){let n=t.olMap.getView().calculateExtent();t.viewer.camera.setView({destination:hn.fromDegrees(n[0],n[1],n[2],n[3])})}},this._getViewCameraRectrange=function(){let n=t.viewer.camera.computeViewRectangle(),r=n.west/Math.PI*180,o=n.north/Math.PI*180,a=n.east/Math.PI*180,s=n.south/Math.PI*180;if(!t.isIn2DMapFlag)if(o>87&&s<-87){let u=t._getCenterPosition(t.viewer);t.olMap.getView().setZoom(0),t.olMap.getView().setCenter([u.lon,u.lat])}else{if(r>a){let u=r;r=a,a=u}t.olMap.getView().fit([r,s,a,o])}},this._mouseMoveEvent=function(n){t.isIn2DMapFlag=t.isMouseIn2DMap(n.pageX,n.pageY)},this.isMouseIn2DMap=function(n,r){let o=t.mapDiv.offsetTop,a=o+t.mapDiv.clientHeight,s=t.mapDiv.offsetLeft,u=s+t.mapDiv.clientWidth;return!(n<s||n>u||r<o||r>a)},this._getCenterPosition=function(n){let r=n.camera.pickEllipsoid(new X(n.canvas.clientWidth/2,n.canvas.clientHeight/2)),o=Ge.WGS84.cartesianToCartographic(r),a=o.longitude*180/Math.PI,s=o.latitude*180/Math.PI;return{lon:a,lat:s}}}ob.prototype.create2DMap=function(e){let t=e.brotherDivId,n=e.around||"left",r=e.scale,o=this;a(),s(),this.set2DMapSize(r);function a(){o.mapDiv=document.createElement("div"),o.mapDiv.setAttribute("id",o.mapId),o.mapDiv.style.width="0%",o.mapDiv.style.height="100%",o.mapDiv.style.position="relative",o.brotherDiv=document.getElementById(t),n==="left"?o.brotherDiv.parentNode.insertBefore(o.mapDiv,o.brotherDiv):n==="right"?o.brotherDiv.parentNode.insertBefore(o.brotherDiv,o.mapDiv):console.error("around default")}function s(){let u=new ol.layer.Tile({source:new ol.source.OSM});o.olMap=new ol.Map({layers:[u],target:o.mapId,view:new ol.View({center:[91.1,30.41],zoom:4,projection:"EPSG:4326",maxZoom:22})}),o.olMap.updateSize(),window.olMap=o.olMap;let l=document.createElement("canvas");d4e(l);let c=document.createElement("div"),f=new Image;f.src=l.toDataURL("image/png");let h="padding: 256px 512px;  border-radius: 16px;  background-color: rgba(0, 0, 0, 0.5); position: relative; background-image:url(";c.style=`${h+f.src});`;let d=new ol.Overlay({id:"licenseOverlayEleID",positioning:"center-center",position:o.olMap.getView().getCenter(),element:c}),p=function(){d.setPosition(o.olMap.getView().getCenter())};if(o.viewer.scene.licensePromise){let _=!1;o.olMap.getOverlays().forEach(function(y){y.getId()==="licenseOverlayEleID"&&(_=!0)}),_||(o.olMap.addOverlay(d),o.olMap.getView().addChangeListener("center",p)),o.viewer.scene.licensePromise.promise.then(function(){o.olMap.getView().removeChangeListener("center",p),o.olMap.removeOverlay(d)},function(){})}}return this.olMap};ob.prototype.set2DMapSize=function(e){if(!e&&e!==0)this.brotherDiv.parentNode.style.display="flex",this.mapDiv.style.width="100%",this.brotherDiv.style.width="0%",this.olMap.updateSize();else{let t=`${e}%`,n=`${100-e}%`;this.mapDiv.style.width=t,this.brotherDiv.style.width=n,this.olMap.updateSize()}};ob.prototype.enable2DAnd3DLinkage=function(){this.mapDiv.style.visibility="visible",this.olMap.getView().on("change:center",this._changeCenterListener),this.olMap.updateSize(),this.mapDiv.parentElement.addEventListener("mousemove",this._mouseMoveEvent),this.viewer.scene.preRender.addEventListener(this._getViewCameraRectrange)};ob.prototype.disable2DAnd3DLinkage=function(){this.olMap.getView().un("change:center",this._changeCenterListener),this.viewer.scene.preRender.removeEventListener(this._getViewCameraRectrange),this.mapDiv.parentElement.removeEventListener("mousemove",this._mouseMoveEvent)};function v_(e){if(!e)return;let t=e.split("\\u"),n="";for(let r=0;r<t.length;r++){let o=t[r];o.length>0&&(n+=String.fromCharCode(parseInt(o,16).toString(10)))}return n}function d4e(e){e.style.width="512px",e.style.height="256px",e.width=512*2,e.height=256*2;let t=e.getContext("2d");t.scale(2,2),t.fillStyle="rgba(127,127,127,0)",t.font="bold 26px Arial",t.fillStyle="white";let n="\\u45\\u56\\u2d\\u47\\u6c\\u6f\\u62\\u65\\u20\\u57\\u65\\u62\\u47\\u4c\\u20\\u56\\u32\\u2e\\u30";t.fillText(v_(n),23,80),t.font="14px SimHei",n="\\u5317\\u4eac\\u56fd\\u9065\\u65b0\\u5929\\u5730\\u4fe1\\u606f\\u6280\\u672f\\u6709\\u9650\\u516c\\u53f8",t.fillText(v_(n),23,147),t.font="14px Arial",n="\\u28\\u43\\u6f\\u70\\u79\\u52\\u69\\u67\\u68\\u74\\u29\\u32\\u30\\u31\\u33\\u2d\\u32\\u30\\u32\\u32\\u7248\\u6743\\u6240\\u6709",t.fillText(v_(n),23,172),n="\\u68\\u74\\u74\\u70\\u3a\\u2f\\u2f\\u77\\u77\\u77\\u2e\\u65\\u76\\u2d\\u69\\u6d\\u61\\u67\\u65\\u2e\\u63\\u6f\\u6d",t.fillText(v_(n),23,197),n="\\u38\\u36\\u2d\\u31\\u30\\u2d\\u36\\u34\\u38\\u37\\u36\\u36\\u35\\u35",t.fillText(v_(n),23,222),t.fillStyle="red",t.font="24px SimHei",n="\\u672a\\u6388\\u6743\\u7248\\u672c",t.fillText(v_(n),360,80),t.font="14px SimHei",n="\\u8bf7\\u8054\\u7cfb\\u5382\\u5546\\u8d2d\\u4e70",t.fillText(v_(n),385,197),n="\\u6b63\\u5f0f\\u7248\\u6388\\u6743",t.fillText(v_(n),410,222)}var roe=ob;function RV(e){if(!g(e))throw new Le("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!g(e.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!g(e.startPoint))throw new Le("\u7BA1\u9053\u5F00\u59CB\u5750\u6807\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!g(e.endPoint))throw new Le("\u7BA1\u9053\u7ED3\u675F\u5750\u6807\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(g(e.geos)&&g(e.radiusArray)&&e.geos.length!==e.radiusArray.length)throw new Le("\u7BA1\u9053\u70B9\u7684\u6570\u91CF\u548C\u534A\u5F84\u6570\u91CF\u4E0D\u4E00\u81F4\u3002");this._viewer=e.viewer,this.color=T(e.color,new K(1,0,0,1)),this.show=T(e.show,!0),this._center=new x,this.startPoint=e.startPoint,this.endPoint=e.endPoint,this.minH=T(e.minH,0),this.maxH=T(e.maxH,2e3),this.countRdii=T(e.countRdii,1),this.lineCount=T(e.lineCount,36),this.radius=T(e.radius,500),this.radiusArray=T(e.radiusArray,[]),this.radii=T(e.radii,1),this.keyPts=[],this.geos=T(e.geos,[]),this.geos.length===0&&m4e(this.startPoint,this.endPoint,this.minH,this.maxH,200,this.geos);for(let t=0;t<this.geos.length;++t){let n={};n.geo=this.geos[t],this.radiusArray.length===0?n.R=this.radius:n.R=this.radiusArray[t],n.r=n.R*this.radii,this.keyPts.push(n)}this.center=x.ZERO,this.keyPts.length>0&&(this.center=this.keyPts[0].geo),this._command=new $t({owner:this,pass:en.OPAQUE,primitiveType:sn.LINES,renderState:fn.fromCache({blending:ka.ALPHA_BLEND,depthTest:{enabled:!0,func:s0.LESS_OR_EQUAL},depthMask:!1})}),this._viewer.scene.primitives.add(this)}RV.prototype.update=function(e){let t=e.mode,n=e.context;if(!this.show||t!==Ne.SCENE3D)return;if(this._boundingSphere=new Ee(x.ZERO,this.radius),g(this._modelMatrix)||(this._modelMatrix=Cn.eastNorthUpToFixedFrame(this.startPoint)),g(this._command.shaderProgram)||(this._command.shaderProgram=wi.fromCache({context:n,vertexShaderSource:y4e(),fragmentShaderSource:v4e()})),!g(this._command.vertexArray)){let a=p4e(this);this._command.vertexArray=g4e(this,n,a)}let r=e.commandList;e.passes.render&&r.push(this._command)};RV.prototype.remove=function(){let e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._viewer.scene.primitives.contains(this)){let t=this._viewer.scene.primitives._primitives.indexOf(this);t!==-1&&(this._viewer.scene.primitives._primitives.splice(t,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return st(this)};function p4e(e){let t=e.lineCount,n=360/t,r=[],o=[];for(let v=0;v<e.keyPts.length;v++){let w=e.keyPts[v].geo;r.push(w)}for(let v=0;v<e.keyPts.length;v++){let w=e.keyPts[v].R,C=e.keyPts[v].r,E=Cn.eastNorthUpToFixedFrame(r[v]),S=new je;if(v===0){let M=G.multiplyByPoint(G.inverse(E,new G),r[1],new x),b=G.multiplyByPoint(G.inverse(E,new G),r[0],new x),O=x.subtract(M,b);S=aoe(x.UNIT_Y,O,new je)}else{let M=G.multiplyByPoint(G.inverse(E,new G),r[v],new x),b=G.multiplyByPoint(G.inverse(E,new G),r[v-1],new x),O=x.subtract(M,b);S=aoe(x.UNIT_Y,O,new je)}let A=te.fromQuaternion(S,new te),D=[];for(let M=0;M<t+1;M++){let b=Math.toRadians(M*n),O=new x(C*Math.cos(b),0,w*Math.sin(b)),m=te.multiplyByVector(A,O,new x),I=G.multiplyByPoint(E,m,new x);D.push(I)}let P=new x(0,0,0);P=te.multiplyByVector(A,P,new x),P=G.multiplyByPoint(E,P,new x),D.push(P),o.push(D)}let a=e.color,s=o.length*(t+1),u=o.length*t*4,l=Or.createTypedArray(s,u),c=new Float64Array(s*3),f=new Uint8Array(s*4),h=0,d=0,p=0,_,y;e.countRdii===0?_=o.length:(y=(o.length-1)/(o.length*e.countRdii-1),_=0);for(let v=0;v<o.length;v++){for(let w=0;w<t+1;w++){let C=x.subtract(o[v][w],e.center);c[h++]=C.x,c[h++]=C.y,c[h++]=C.z,f[d++]=K.floatToByte(a.red),f[d++]=K.floatToByte(a.green),f[d++]=K.floatToByte(a.blue),f[d++]=K.floatToByte(a.alpha),w<t&&((v>=_||v===o.length-1&&e.countRdii!==0)&&(l[p++]=v*(t+1)+w,l[p++]=v*(t+1)+w+1),v<o.length-1&&(l[p++]=v*(t+1)+w,l[p++]=v*(t+1)+w+(t+1)))}v>=_&&(_+=y)}return{position:c,color:f,indices:l}}function m4e(e,t,n,r,o,a){if(o<2)return;let s=le.fromCartesian(e,Ge.WGS84),u=Math.toDegrees(s.longitude),l=Math.toDegrees(s.latitude),c=le.fromCartesian(t,Ge.WGS84),f=Math.toDegrees(c.longitude),h=Math.toDegrees(c.latitude),d=ioe(l,u,h,f,.5),p=ooe(l,u,d.latitude,d.longitude),_;p>0&&(_=(n-r)/(p*p));for(let y=0;y<o;y++){let v=ioe(l,u,h,f,y/(o-1));p=ooe(v.latitude,v.longitude,d.latitude,d.longitude);let w=_*p*p+r,C=x.fromDegrees(v.longitude,v.latitude,w);a.push(C)}}function ioe(e,t,n,r,o){let a,s;if(Math.abs(o)<1e-6)return a=e,s=t,{latitude:e,longitude:t};let u=x.fromDegrees(t,e);u=x.normalize(u);let l=x.fromDegrees(r,n);l=x.normalize(l);let c=Math.acos(x.dot(u,l));if(isNaN(c))return a=e,s=t,{latitude:e,longitude:t};let f=x.cross(u,l,new x);if(isNaN(f.x)||isNaN(f.y)||isNaN(f.z))return a=e,s=t,{latitude:e,longitude:t};f=x.normalize(f,new x);let h=je.fromAxisAngle(f,c*o),d=te.fromQuaternion(h,new te),p=te.multiplyByVector(d,u,new x);p=x.normalize(p);let _=le.fromCartesian(p,Ge.WGS84);return a=Math.toDegrees(_.latitude),s=Math.toDegrees(_.longitude),{latitude:a,longitude:s}}function ooe(e,t,n,r){let o=Math.toRadians(e),a=Math.toRadians(t),s=Math.toRadians(n),u=Math.toRadians(r);return Math.acos(Math.cos(o)*Math.cos(s)*Math.cos(a-u)+Math.sin(o)*Math.sin(s))}function aoe(e,t,n){if(e instanceof x&&e instanceof x){g(n)||(n=new je(je.IDENTITY));let r=e.clone(),o=t.clone();r=x.normalize(r,r),o=x.normalize(o,o);let a=x.dot(r,o,void 0);if(a>=1)return n;if(a<1e-6-1){let s=new x;s=x.cross(x.UNIT_X,e,s),x.magnitudeSquared(s)<1e-6*1e-6&&(s=x.cross(x.UNIT_Y,e,s)),s=x.normalize(s,s),n=je.fromAxisAngle(s,Math.toRadians(Math.PI),n)}else{let s=Math.sqrt((1+a)*2),u=1/s,l=new x;l=x.cross(r,o,l),n.x=l.x*u,n.y=l.y*u,n.z=l.z*u,n.w=s*.5,n=je.normalize(n,n)}return n}}function g4e(e,t,n){let r=_4e(e),o=Ui.createVertexBuffer({context:t,typedArray:r,usage:We.STATIC_DRAW}),a=12,s=ie.getSizeInBytes(ie.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Ui.createVertexBuffer({context:t,typedArray:ie.createTypedArray(ie.FLOAT,new Float64Array(n.position.buffer)),usage:We.STATIC_DRAW}),componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:Ui.createVertexBuffer({context:t,typedArray:ie.createTypedArray(ie.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:We.STATIC_DRAW}),componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new $h({context:t,attributes:c,indexBuffer:Ui.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:We.STATIC_DRAW,indexDatatype:Or.UNSIGNED_SHORT})})}function _4e(e){let t=e._center,n=12,r=e._vertexBufferTypedArray;g(r)||(r=new Float32Array(n));let o=[],a=e._modelMatrix,s=G.fromTranslation(G.getTranslation(a,new x));return s[12]-=t.x,s[13]-=t.y,s[14]-=t.z,o.push(new x(s[12],s[13],s[14])),r[0]=s[0],r[1]=s[4],r[2]=s[8],r[3]=s[12],r[4]=s[1],r[5]=s[5],r[6]=s[9],r[7]=s[13],r[8]=s[2],r[9]=s[6],r[10]=s[10],r[11]=s[14],r}function y4e(){return`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model*  vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`}function v4e(){return`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`}var soe=RV;function C_(e,t,n,r,o,a,s){this.provider=e,this.message=t,this.x=n,this.y=r,this.level=o,this.timesRetried=T(a,0),this.retry=!1,this.error=s}C_.reportError=function(e,t,n,r,o,a,s,u){let l=e;return g(e)?(l.provider=t,l.message=r,l.x=o,l.y=a,l.level=s,l.retry=!1,l.error=u,++l.timesRetried):l=new C_(t,r,o,a,s,0,u),n&&n.numberOfListeners>0&&n.raiseEvent(l),l};C_.handleError=function(e,t,n,r,o,a,s,u,l){ul("TileProviderError.handleError","TileProviderError.handleError was deprecated in CesiumJS 1.96 and will be removed in 1.97. Use TileProviderError.reportError instead.");let c=C_.reportError(e,t,n,r,o,a,s,l);return c.retry&&g(u)&&u(),c};C_.reportSuccess=function(e){g(e)&&(e.timesRetried=-1)};C_.handleSuccess=function(e){ul("TileProviderError.handleSuccess","TileProviderError.handleSuccess was deprecated in CesiumJS 1.96 and will be removed in 1.97. Use TileProviderError.reportSuccess instead."),C_.reportSuccess(e)};var OV=C_;function mw(){this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,Le.throwInstantiationError()}Object.defineProperties(mw.prototype,{ready:{get:Le.throwInstantiationError},readyPromise:{get:Le.throwInstantiationError},rectangle:{get:Le.throwInstantiationError},tileWidth:{get:Le.throwInstantiationError},tileHeight:{get:Le.throwInstantiationError},maximumLevel:{get:Le.throwInstantiationError},minimumLevel:{get:Le.throwInstantiationError},tilingScheme:{get:Le.throwInstantiationError},tileDiscardPolicy:{get:Le.throwInstantiationError},errorEvent:{get:Le.throwInstantiationError},credit:{get:Le.throwInstantiationError},proxy:{get:Le.throwInstantiationError},hasAlphaChannel:{get:Le.throwInstantiationError}});mw.prototype.getTileCredits=function(e,t,n){Le.throwInstantiationError()};mw.prototype.requestImage=function(e,t,n,r){Le.throwInstantiationError()};mw.prototype.pickFeatures=function(e,t,n,r,o){Le.throwInstantiationError()};var C4e=/\.ktx2$/i;mw.loadImage=function(e,t){let n=vt.createIfNeeded(t);return C4e.test(n.url)?Lm(n):g(e)&&g(e.tileDiscardPolicy)?n.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}):n.fetchImage({preferImageBitmap:!0,flipY:!0})};var uoe=mw;function ab(e){e=T(e,T.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let t=vt.createIfNeeded(e.url),n=T(e.rectangle,hn.MAX_VALUE),r=new kI({rectangle:n,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=r,this._resource=t,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new xe,this._ready=!1;let o=e.credit;typeof o=="string"&&(o=new AS(o)),this._credit=o;let a=this,s;function u(f){return a._image=f,a._tileWidth=f.width,a._tileHeight=f.height,a._ready=!0,OV.reportSuccess(a._errorEvent),Promise.resolve(!0)}function l(f){let h=`Failed to load image ${t.url}.`;return s=OV.reportError(s,a,a._errorEvent,h,0,0,0),s.retry?c():Promise.reject(new at(h))}function c(){return uoe.loadImage(null,t).then(u).catch(l)}this._readyPromise=c()}Object.defineProperties(ab.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});ab.prototype.getTileCredits=function(e,t,n){};ab.prototype.requestImage=function(e,t,n,r){if(!!g(this._image))return Promise.resolve(this._image)};ab.prototype.pickFeatures=function(e,t,n,r,o){};var loe=ab;function x4e(e,t){t.stats===!1?(e.globe.imageryLayers.length!==0?e.globe.imageryLayers.get(0).alpha=1:e.globe.imageryLayers.addImageryProvider(new loe({url:t.url})),t.color!==void 0&&(e.globe.baseColor=t.color)):t.stats===!0?(e.globe.imageryLayers.removeAll(),e.globe.baseColor=t.color):(e.globe.imageryLayers.get(0).alpha=0,e.globe.baseColor=t.color)}var coe=x4e;function sb(e){this.viewer=e,this.pyramidList=new Ga,this.polygonList=void 0,this.position=void 0,this.yawAngle=void 0}sb.prototype.addPyramid=function(e){let t=this;t.positionCallback=e.position,t.polygonList=e.polygonList;let n=e.id,r=[],o=w4e({viewer:t.viewer,color:e.color,Large_angle:e.Large_angle,small_angle:e.small_angle,len:e.len,positionCallback:e.position,id:e.id,pitch_angle:e.pitch_angle});r.push(o),t.pyramidList.set(n,r)};sb.prototype.removepyramid=function(e){let t=this,n=t.pyramidList.get(e);for(let r=0;r<n.length;r++)t.viewer.entities.remove(n[r]);t.pyramidList.remove(e),t.pyramidListCoor.remove(e),t.pyramidListCoorChange.remove(e),t.underPolygonCoor.remove(e),t.underPolygonCoorChange.remove(e)};sb.prototype.removeAll=function(){let e=this;for(let t in e.pyramidList._hash)for(let n=0;n<e.pyramidList.get(t).length;n++)e.viewer.entities.remove(e.pyramidList.get(t)[n]),n--;e.pyramidListCoor.removeAll(),e.pyramidListCoorChange.removeAll(),e.underPolygonCoor.removeAll(),e.underPolygonCoorChange.removeAll()};sb.prototype.updatepyramid=function(){};function XR(e,t,n,r,o){let a=Cn.eastNorthUpToFixedFrame(e),s=new te.fromRotationZ(F.toRadians(n)),u=te.fromRotationY(F.toRadians(r)),l=te.multiply(s,u,new te),c=G.fromRotationTranslation(l),f=new qc(o.x,o.y,o.z),h=je.fromHeadingPitchRoll(f,new je),d=G.fromTranslationQuaternionRotationScale(new x(0,0,0),h,new x(1,1,1));return G.multiply(d,c,c),G.multiply(a,c,a),G.multiplyByPoint(a,new x(t,0,0),new x)}function w4e(e){let t=e.viewer,n=e.color,r=e.id,o=e.small_angle,a=e.len,s=e.positionCallback,u=e.pitch_angle;return t.entities.add({name:r,polygon:{hierarchy:new tu(function(){let c=s.getValue().position,f=s.getValue().hpr,h=[c],d=[];if(c!==void 0){for(let p=0;p<4;p++){let _;p===0?_=XR(c,a,o,u,f):p===1?_=XR(c,a,180-o,u,f):p===2?_=XR(c,a,180+o,u,f):_=XR(c,a,360-o,u,f),h.push(_);let y=E4e(c,_,t);y!==void 0&&d.push(y)}if(d.length===4)return{positions:d}}},!1),material:n,clampToGround:!0}})}function E4e(e,t,n){let r=new x,o=x.normalize(x.subtract(t,e,r),r),a=new H_(e,o);return n.scene.globe.pickWorldCoordinates(a,n.scene,new x)}var foe=sb;function _w(e){this.geometry=void 0,this.blUpdateVAO=!1,this.originColor=new Cesium.Color(0,1,0,1),this.outdatedColor=new Cesium.Color(1,0,0,1),this._curMillisecTime=9466848e5,this.boundingSphere=void 0,this._mode=void 0;var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL}}),uniformMap:{u_originColor:function(){return t.originColor},u_outdatedColor:function(){return t.outdatedColor},u_curMillisecTime:function(){var n=Math.floor(t._curMillisecTime/1e6),r=t._curMillisecTime%1e6;return new Cesium.Cartesian2(n,r)}}})}Object.defineProperties(_w.prototype,{curMillisecTime:{get:function(){return this._curMillisecTime},set:function(e){this._curMillisecTime=e}}});var hoe=new le,NV=new ti,gw=new x;_w.prototype.recreateVertexArrays=function(e,t){this._mode=t.mode;var n=t.mapProjection,r=n.ellipsoid.maximumRadius*Cesium.Math.PI,o=e.length,a=0,s=0,u=[];if(e instanceof Array&&o>0){for(var l=0;l<o;l++)Cesium.defined(e[l])&&e[l].length>1&&(a+=(e[l].length-1)*2,s+=e[l].length,u.push(e[l]));for(var c=Cesium.IndexDatatype.createTypedArray(s,a),f=new Float32Array(s*3),h=new Float32Array(s*3),d=new Float32Array(s*2),p=void 0,_=0,y=0,v=0;v<u.length;v++){for(var w=0;w<u[v].length;w++){var C=u[v][w],E=void 0;w<u[v].length-1&&(c[_++]=y+w,c[_++]=y+w+1,E=u[v][w+1]);var S=C.position;if(this._mode==Cesium.SceneMode.SCENE2D){if(S=n.project(n.ellipsoid.cartesianToCartographic(C.position,hoe)),S.z=0,Cesium.defined(E)){var A=n.project(n.ellipsoid.cartesianToCartographic(E.position,hoe));(S.x>0&&A.x<0||S.x<0&&A.x>0)&&(c[_-1]=y+w)}Cesium.defined(p)?(gw=Cesium.Cartesian3.fromElements(S.z,S.x,S.y,gw),p=Cesium.BoundingSphere.expand(p,gw)):(gw=Cesium.Cartesian3.fromElements(S.z,S.x,S.y,gw),p=new Cesium.BoundingSphere(gw,200))}else Cesium.defined(p)?p=Cesium.BoundingSphere.expand(p,C.position):p=new Cesium.BoundingSphere(C.position,200);Cesium.EncodedCartesian3.fromCartesian(S,NV);var D=NV.high,P=NV.low;f[(y+w)*3]=D.x,f[(y+w)*3+1]=D.y,f[(y+w)*3+2]=D.z,h[(y+w)*3]=P.x,h[(y+w)*3+1]=P.y,h[(y+w)*3+2]=P.z,d[(y+w)*2]=Math.floor(C.millisecTime/1e6),d[(y+w)*2+1]=C.millisecTime%1e6}y+=u[v].length}this.traceMesh={position3DHigh:f,position3DLow:h,st:d,indices:c},Cesium.defined(p)&&(this.boundingSphere=p.clone()),this.blUpdateVAO=!0}else this.traceMesh=void 0,this.blUpdateVAO=!0};_w.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&this.blUpdateVAO&&n.vertexArray.destroy(),this.blUpdateVAO&&Cesium.defined(this.traceMesh)){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.traceMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.traceMesh.position3DHigh.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:T4e(),fragmentShaderSource:S4e()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};_w.prototype.isDestroyed=function(){return!1};_w.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function T4e(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec2 st;
uniform vec4 u_originColor; 
uniform vec4 u_outdatedColor; 
uniform vec2 u_curMillisecTime; 
varying vec4  v_colour;
const float SHIFT_LEFT16 = 65536.0;
void main()
{
    v_colour = u_originColor; 
    if(st.x < u_curMillisecTime.x ||(st.x <= u_curMillisecTime.x && st.y <= u_curMillisecTime.y)){
       v_colour = u_outdatedColor; 
    }
vec4 p;
if(czm_morphTime == 1.0){
  p = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
}else if(czm_morphTime == 0.0){
  p = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
}else{
  p = czm_columbusViewMorph(
  czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
  czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
  czm_morphTime);
}
  vec4 positionEC = czm_modelViewRelativeToEye * p;
  vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC); 
  vec4 positionWC = vec4(positionWindow.xy, -positionWindow.z, 1.0) * (czm_projection * positionEC).w;;
  gl_Position = czm_viewportOrthographic * positionWC;
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function S4e(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var doe=_w;function BV(e){let t=this;this.ip=T(e.ip,"127.0.0.1:8080"),this._url=`http://${this.ip}/earthview/services/v/soap/networkservice/10000`,this._resource=new vt({url:t._url,headers:{"Content-Type":"text/plain;charset=UTF-8"}})}BV.prototype.getRoutePositions=function(e,t,n,r){let o=e,a=A4e(t),s=b4e(n),u=`<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/">
            <Body>
                <networkAnalystEx xmlns="http://network.web.services.server.earthview/">
                    <servicename xmlns="">${o}</servicename>${a}${s}</networkAnalystEx>
            </Body>
        </Envelope>`,l=`http://${this.ip}/earthview/services/v/soap/networkservice/10000`,c=this._resource.clone();c.url=l,c.post(u,{responseType:"text",overrideMimeType:"text/plain"}).then(function(f){let d=new DOMParser().parseFromString(f,"text/xml").getElementsByTagName("return"),p=[],_=JSON.parse(Array.from(d)[0].firstChild.nodeValue);Object.hasOwnProperty.call(_,"message")&&_.message==="ok"&&Object.getOwnPropertyNames(_.route).length&&Object.values(_.route).map(function(v){let C=v.line.match(/\(([^)]*)\)/);p=p.concat(C[1].replace(/ /g,",").split(",").map(function(E){return parseFloat(E)}))}),r&&r(p)}).catch(function(f){console.log(f)})};function A4e(e){let t="";for(let n=0;n<e.length;n++)t+='<stops xmlns="">Point(',t+=Math.toDegrees(e[n].longitude),t+=" ",t+=Math.toDegrees(e[n].latitude),t+=")</stops>";return t}function b4e(e){let t="";for(let n=0;n<e.length;n++)t+='<barriers xmlns="">Point(',t+=Math.toDegrees(e[n].longitude),t+=" ",t+=Math.toDegrees(e[n].latitude),t+=")</barriers>";return t}BV.prototype.queryPlaceName=function(e,t,n,r){let o=JSON.stringify({mapName:e,layerName:t,queryFileds:"*",cliped:"false",start:1,maxFeatures:1e3,filter:{type:"And",condition:[{queryType:"PropertyIsLike",propertyName:"NAME",value:n}]}}),a=`http://${this.ip}/earthview/services/${e}/MapService/WFS?service=${e}&request=getFeatureByJson`,s=this._resource.clone();s.url=a,s.post(o,{responseType:"text",overrideMimeType:"text/plain"}).then(function(u){r&&r(JSON.parse(u).result)}).catch(function(u){console.log(u)})};var poe=BV;function I4e(e,t){let n={msgType:-1,sID:0,planeType:0,datTime:0,satTime:0,msgLen:0},r=T(t,0);return n.msgType=e.getUint16(r,!0),n.sID=e.getUint16(r+2,!0),n.planeType=e.getUint32(r+4,!0),n.datTime=moe(e,r+8),n.satTime=moe(e,r+16),n.msgLen=e.getUint16(r+24,!0),n}function moe(e,t){let n=e.getUint32(t,!0),r=e.getUint32(t+4,!0),o=n+Math.pow(2,32)*r;return Number.isSafeInteger(o)||console.warn(o,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),o}var cn=I4e;function D4e(e,t){this.SIZE=96,this.header=cn(e,t);let n=T(t,0),r=26+n;this.delayFlag=e.getUint8(r,!0),r+=1;let o=[];for(let l=0;l<7;l++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Zl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a;let u="";for(let l=0;l<10;l++)u=u+String.fromCharCode(e.getInt8(r,!0)),r+=1;u=u.replace(/\u0000/g,""),this.chFighterName=u,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fRoll=e.getFloat32(r,!0),r+=4,this.fPitch=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.decoyDrop=e.getUint8(r,!0),r+=1,this.enginePower=e.getUint8(r,!0),r+=1,this.trainPro=e.getUint8(r,!0),r+=1,this.height=e.getFloat32(r,!0),r+=4,this.vel_east=e.getFloat32(r,!0),r+=4,this.vel_north=e.getFloat32(r,!0),r+=4,this.vel_up=e.getFloat32(r,!0)}var yw=D4e;function P4e(e,t){this.SIZE=35,this.header=cn(e,t);let n=T(t,0),r=26+n;this.nMissileID=e.getUint32(r,!0),r+=4,this.chWeaponType=e.getInt32(r,!0),r+=4,this.dropMslNum=e.getUint8(r,!0)}var vw=P4e;function M4e(e,t){this.SIZE=50,this.header=cn(e,t);let n=T(t,0),r=26+n;this.nMissileID=e.getUint32(r,!0),r+=4,this.chWeaponType=e.getInt32(r,!0),r+=4,this.fDistance=e.getFloat32(r,!0),r+=4,this.nTgtID=e.getUint16(r,!0),r+=2,this.nResult=e.getUint8(r,!0),r+=1,this.stopReason=e.getUint8(r,!0);let o=[];for(let a=0;a<4;a++)o.push(e.getInt8(r,!0)),r+=1;this.gTgtType=o,o=[];for(let a=0;a<4;a++)o.push(e.getInt8(r,!0)),r+=1;this.gTgtID=o}var Cw=M4e;function L4e(e,t){this.SIZE=77,this.header=cn(e,t);let n=T(t,0),r=26+n;this.targetID=e.getUint16(r,!0),r+=2,this.weaponID=e.getUint32(r,!0),r+=4,this.weaponType=e.getInt32(r,!0),r+=4,this.engineState=e.getUint8(r,!0),r+=1,this.captureState=e.getUint8(r,!0),r+=1,this.mslLongitude=e.getFloat64(r,!0),r+=8,this.mslLatitude=e.getFloat64(r,!0),r+=8,this.mslAltitude=e.getFloat32(r,!0),r+=4,this.mslCourse=e.getFloat32(r,!0),r+=4,this.mslPitch=e.getFloat32(r,!0),r+=4,this.vel=e.getFloat32(r,!0),r+=4,this.mslDistance=e.getFloat32(r,!0),r+=4,this.targetTspiValid=e.getUint8(r,!0),r+=1,this.ipk=e.getUint8(r,!0),r+=1,this.noKkkReason=e.getUint8(r,!0)}var xw=L4e;function R4e(e,t){this.SIZE=58,this.header=cn(e,t);let n=T(t,0),r=26+n;this.fakeCampID=e.getUint8(r,!0),r+=1,this.campType=e.getInt32(r,!0),r+=4,this.equipmentType=e.getInt8(r,!0),r+=1,this.equipmentID=e.getInt8(r,!0),r+=1,this.gTspiState=e.getInt8(r,!0),r+=1,this.northAngle=e.getFloat32(r,!0),r+=4,this.gTspiAlt=e.getFloat32(r,!0),r+=4,this.gTspiLon=e.getFloat64(r,!0),r+=8,this.gTspiLat=e.getFloat64(r,!0)}var ww=R4e;function O4e(e,t){this.SIZE=39,this.header=cn(e,t);let n=T(t,0),r=26+n,o=[];for(let u=0;u<7;u++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Zl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a,o="";for(let u=0;u<10;u++)o=o+String.fromCharCode(e.getInt8(r,!0)),r+=1;this.chFighterName=o,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.remainMslNum=e.getUint8(r,!0),r+=1,this.remainChannelNum=e.getUint8(r,!0),r+=1,this.selfReliveFlag=e.getUint8(r,!0),r+=1,this.resetMslCountFlag=e.getUint8(r,!0),r+=1,this.trainMode=e.getUint8(r,!0)}var Ew=O4e;function N4e(e,t){this.SIZE=95,this.header=cn(e,t);let n=T(t,0),r=26+n,o=[];for(let l=0;l<7;l++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Zl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a;let u="";for(let l=0;l<10;l++)u=u+String.fromCharCode(e.getInt8(r,!0)),r+=1;this.chFighterName=u,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fRoll=e.getFloat32(r,!0),r+=4,this.fPitch=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.decoyDrop=e.getUint8(r,!0),r+=1,this.enginePower=e.getUint8(r,!0),r+=1,this.trainPro=e.getUint8(r,!0),r+=1,this.height=e.getFloat32(r,!0),r+=4,this.vel_east=e.getFloat32(r,!0),r+=4,this.vel_north=e.getFloat32(r,!0),r+=4,this.vel_up=e.getFloat32(r,!0)}var Tw=N4e;function B4e(e,t){this.SIZE=38,this.header=cn(e,t);let n=T(t,0),r=26+n;this.irmslAzimuth=e.getFloat32(r,!0),r+=4,this.irmslPitch=e.getFloat32(r,!0),r+=4,this.fDistance=e.getFloat32(r,!0)}var Sw=B4e;function F4e(e,t){this.SIZE=139,this.header=new cn(e,t);let n=T(t,0),r=26+n;this.tgtNum=e.getUint8(r,!0),r+=1,this.tgtInfo=[];for(let o=0;o<8;o++)this.tgtInfo.push({tgtNTS:0,tgtSensor:0,tgtAzimuth:0,tgtPitch:0,tgtDis:0});for(let o=0;o<8;o++)this.tgtInfo[o].tgtNTS=e.getUint8(r,!0),r+=1,this.tgtInfo[o].tgtSensor=e.getUint8(r,!0),r+=1,this.tgtInfo[o].tgtAzimuth=e.getFloat32(r,!0),r+=4,this.tgtInfo[o].tgtPitch=e.getFloat32(r,!0),r+=4,this.tgtInfo[o].tgtDis=e.getFloat32(r,!0),o<7&&(r+=4)}var Aw=F4e;function z4e(e,t){this.SIZE=29,this.header=new cn(e,t);let n=T(t,0),r=26+n;this.workMode=e.getInt8(r,!0),r+=1,this.openState=e.getInt8(r,!0),r+=1,this.radiaState=e.getInt8(r,!0)}var bw=z4e;function V4e(e,t){this.SIZE=57,this.header=cn(e,t);let n=T(t,0),r=26+n;this.true_AOA=e.getFloat32(r,!0),r+=4,this.mach=e.getFloat32(r,!0),r+=4,this.normalAccel=e.getFloat32(r,!0),r+=4,this.trainMode=e.getUint8(r,!0),r+=1,this.cal_air_speed=e.getFloat32(r,!0),r+=4,this.baro_ref_alt=e.getFloat32(r,!0),r+=4,this.wireless_alt=e.getFloat32(r,!0),r+=4,this.remain_oil_amount=e.getFloat32(r,!0),r+=4,this.s2=e.getUint8(r,!0),r+=1,this.s3=e.getUint8(r,!0)}var Iw=V4e;function k4e(e,t){this.SIZE=38,this.header=cn(e,t);let n=T(t,0),r=26+n;this.mslType=e.getInt32(r,!0),r+=4,this.fHalfAngle=e.getFloat32(r,!0),r+=4,this.fMaxDistance=e.getFloat32(r,!0)}var Dw=k4e;function G4e(e,t){this.SIZE=29,this.header=cn(e,t);let n=T(t,0),r=26+n;this.workMode=e.getInt8(r,!0),r+=1,this.openState=e.getInt8(r,!0),r+=1,this.interceptState=e.getInt8(r,!0)}var Pw=G4e;function U4e(e,t){this.SIZE=27,this.header=cn(e,t);let n=T(t,0),r=26+n;this.ewsDir=e.getUint8(r,!0)}var Mw=U4e;function H4e(e,t){this.SIZE=27,I3_NET_COMMAND.header=cn(e,t);let n=T(t,0),r=26+n;I3_NET_COMMAND.state=e.getUint8(r,!0)}var Lw=H4e;function q4e(e,t){this.SIZE=35,this.header=cn(e,t);let n=T(t,0),r=26+n;this.campType=e.getInt32(r,!0),r+=4,this.equipmentType=e.getUint8(r,!0),r+=1,this.equipmentID=e.getUint8(r,!0),r+=1,this.openState=e.getUint8(r,!0),r+=1,this.antennaDirection=e.getUint16(r,!0)}var Rw=q4e;function W4e(e,t){this.SIZE=10,this.header=cn(e,t);let n=T(t,0),r=26+n;this.uiAlarmType=e.getUint16(r,!0),this.uiPlaneID=new Array(3),this.ucMeetType=new Array(3),this.uiMeetTimeLinear=new Array(3),this.uiMeetTimeSprial=new Array(3);for(let o=0;o<3;o++)this.uiPlaneID[o]=e.getUint16(r,!0),r+=2,this.ucMeetType[o]=e.getUint8(r,!0),r+=1,this.uiMeetTimeLinear[o]=e.getUint32(r,!0),r+=4,this.uiMeetTimeSprial[o]=e.getUint32(r,!0)}var Ow=W4e;function Y4e(e,t){this.SIZE=72,this.header=cn(e,t);let n=T(t,0),r=26+n,o=[];for(let a=0;a<7;a++)o.push(e.getInt8(r,!0)),r+=1;this.chFlyUser=o,o=[];for(let a=0;a<10;a++)o.push(e.getInt8(r,!0)),r+=1;this.chFighterName=o,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.fVel=e.getFloat32(r,!0)}var Nw=Y4e;function Bw(e,t){if(!g(e))throw new Le("wsserver undefined!");this.url=e,this.startPlay=0,this.callbackFunc=t,this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this)}Bw.prototype.onOpen=function(e){this.websocket.binaryType="arraybuffer",console.log("Connection open ..."),this.doSend(e)};Bw.prototype.doSend=function(e){this.websocket.send(e)};Bw.prototype.onMessage=function(e){let t=0,n=this,r=e.data;if(n.dataI3NSArr=[],n.dataRTSN=[],n.dataRTKN=[],n.dataTRAJ=[],n.dataGTSPI=[],n.dataIrsm=[],n.radarTarget=[],n.RadarWM=[],n.IRSTworkMode=[],n.dataEWS=[],n.LargePlane=[],n.SafetyAlarm=[],n.CombatPower=[],n.StaticTarget=[],n.flightState=[],n.SDRState=[],e.data instanceof ArrayBuffer){for(;t<r.byteLength;){let o=X4e(e.data,t);t+=10;let a=o.nLen,s=new DataView(r,t,a),l=new cn(s,0).msgType,c,f;switch(l){case Re.NET_MSG_TSPI:a===95?c=new Tw(s):a===96&&(c=new yw(s)),n.dataI3NSArr.push(c);break;case Re.NET_MSG_FIGHTER:{let h=new Iw(s);n.flightState.push(h);break}case Re.NET_MSG_RTSN:{let h=new vw(s);n.dataRTSN.push(h);break}case Re.NET_MSG_MISSILEPARAM:f=new Dw(s);break;case Re.NET_MSG_RTKN:f=new Cw(s),n.dataRTKN.push(f);break;case Re.NET_MSG_WPN_TRAJ:f=new xw(s),n.dataTRAJ.push(f);break;case Re.NET_MSG_RDR_STATE:f=new bw(s),n.RadarWM.push(f);break;case Re.NET_MSG_TARGET:f=new Aw(s),n.radarTarget.push(f);break;case Re.NET_MSG_IRST:f=new Pw(s),n.IRSTworkMode.push(f);break;case Re.NET_MSG_IRMSL_STATE:f=new Sw(s),n.dataIrsm.push(f);break;case Re.NET_MSG_EWS_STA:f=new Mw(s),n.dataEWS.push(f);break;case Re.NET_MSG_START_STOP:f=new Lw(s),console.log(f);break;case Re.NET_MSG_GTSPI:f=new ww(s),n.dataGTSPI.push(f);break;case Re.NET_MSG_RAD_STATE:f=new Rw(s),n.SDRState.push(f);break;case Re.NET_MSG_COMBATPOWER:f=new Ew(s),n.CombatPower.push(f);break;case Re.NET_MSG_SAFETYALARM:f=new Ow(s),n.SafetyAlarm.push(f);break;case Re.NET_MSG_LARGE_PLANE:f=new Nw(s),n.LargePlane.push(f);break}t+=a}n.dataI3NSArr.length!==0&&n.callbackFunc(n.dataI3NSArr),n.dataRTKN.length!==0&&n.callbackFunc(n.dataRTKN),n.dataRTSN.length!==0&&n.callbackFunc(n.dataRTSN),n.dataGTSPI.length!==0&&n.callbackFunc(n.dataGTSPI),n.dataTRAJ.length!==0&&n.callbackFunc(n.dataTRAJ),n.dataIrsm.length!==0&&n.callbackFunc(n.dataIrsm),n.radarTarget.length!==0&&n.callbackFunc(n.radarTarget),n.RadarWM.length!==0&&n.callbackFunc(n.RadarWM),n.IRSTworkMode.length!==0&&n.callbackFunc(n.IRSTworkMode),n.dataEWS.length!==0&&n.callbackFunc(n.dataEWS),n.LargePlane.length!==0&&n.callbackFunc(n.LargePlane),n.SafetyAlarm.length!==0&&n.callbackFunc(n.SafetyAlarm),n.CombatPower.length!==0&&n.callbackFunc(n.CombatPower),n.StaticTarget.length!==0&&n.callbackFunc(n.StaticTarget),n.flightState.length!==0&&n.callbackFunc(n.flightState),n.SDRState.length!==0&&n.callbackFunc(n.SDRState)}else n.callbackFunc(e.data)};function X4e(e,t){let n=new DataView(e);return{time:n.getBigInt64(t,!0),nLen:n.getUint8(t+8,!0)}}Bw.prototype.onClose=function(){console.log("DISCONNECTED")};Bw.prototype.onError=function(e){console.log("websocket error")};var goe=Bw;function Fw(e,t,n){if(!g(e))throw new Le("wsserver undefined!");this.url=e,this.datSource=t,this.startPlay=0,this.callbackFunc=n,this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this)}Fw.prototype.onOpen=function(e){this.websocket.binaryType="arraybuffer",console.log("Connection open ...");let t=JSON.stringify({type:0,fileName:this.datSource});this.doSend(t)};Fw.prototype.doSend=function(e){this.websocket.send(e)};Fw.prototype.onMessage=function(e){let n=this,r=JSON.parse(e.data);if(n.dataI3NSArr=[],n.dataRTSN=[],n.dataRTKN=[],n.dataTRAJ=[],n.dataGTSPI=[],n.dataIrsm=[],n.radarTarget=[],n.RadarWM=[],n.IRSTworkMode=[],n.dataEWS=[],n.LargePlane=[],n.SafetyAlarm=[],n.CombatPower=[],n.StaticTarget=[],n.flightState=[],n.SDRState=[],r.uint8Array instanceof Array){let o=r.uint8Array;for(let a=0;a<o.length;a++){let u=new Uint8Array(o[a]).buffer,c=j4e(u).nLen,f=new DataView(u),d=new cn(f,10).msgType,p,_;switch(d){case Re.NET_MSG_TSPI:c===95?p=new Tw(f,10):c===96&&(p=new yw(f,10)),n.dataI3NSArr.push(p);break;case Re.NET_MSG_FIGHTER:{let y=new Iw(f,10);n.flightState.push(y);break}case Re.NET_MSG_RTSN:{let y=new vw(f,10);n.dataRTSN.push(y);break}case Re.NET_MSG_MISSILEPARAM:_=new Dw(f,10);break;case Re.NET_MSG_RTKN:_=new Cw(f,10),n.dataRTKN.push(_);break;case Re.NET_MSG_WPN_TRAJ:_=new xw(f,10),n.dataTRAJ.push(_);break;case Re.NET_MSG_RDR_STATE:_=new bw(f,10),n.RadarWM.push(_);break;case Re.NET_MSG_TARGET:_=new Aw(f,10),n.radarTarget.push(_);break;case Re.NET_MSG_IRST:_=new Pw(f,10),n.IRSTworkMode.push(_);break;case Re.NET_MSG_IRMSL_STATE:_=new Sw(f,10),n.dataIrsm.push(_);break;case Re.NET_MSG_EWS_STA:_=new Mw(f,10),n.dataEWS.push(_);break;case Re.NET_MSG_START_STOP:_=new Lw(f,10),console.log(_);break;case Re.NET_MSG_GTSPI:_=new ww(f,10),n.dataGTSPI.push(_);break;case Re.NET_MSG_RAD_STATE:_=new Rw(f,10),n.SDRState.push(_);break;case Re.NET_MSG_COMBATPOWER:_=new Ew(f,10),n.CombatPower.push(_);break;case Re.NET_MSG_SAFETYALARM:_=new Ow(f,10),n.SafetyAlarm.push(_);break;case Re.NET_MSG_LARGE_PLANE:_=new Nw(f,10),n.LargePlane.push(_);break}}n.dataI3NSArr.length!==0&&n.callbackFunc(n.dataI3NSArr),n.dataRTKN.length!==0&&n.callbackFunc(n.dataRTKN),n.dataRTSN.length!==0&&n.callbackFunc(n.dataRTSN),n.dataGTSPI.length!==0&&n.callbackFunc(n.dataGTSPI),n.dataTRAJ.length!==0&&n.callbackFunc(n.dataTRAJ),n.dataIrsm.length!==0&&n.callbackFunc(n.dataIrsm),n.radarTarget.length!==0&&n.callbackFunc(n.radarTarget),n.RadarWM.length!==0&&n.callbackFunc(n.RadarWM),n.IRSTworkMode.length!==0&&n.callbackFunc(n.IRSTworkMode),n.dataEWS.length!==0&&n.callbackFunc(n.dataEWS),n.LargePlane.length!==0&&n.callbackFunc(n.LargePlane),n.SafetyAlarm.length!==0&&n.callbackFunc(n.SafetyAlarm),n.CombatPower.length!==0&&n.callbackFunc(n.CombatPower),n.StaticTarget.length!==0&&n.callbackFunc(n.StaticTarget),n.flightState.length!==0&&n.callbackFunc(n.flightState),n.SDRState.length!==0&&n.callbackFunc(n.SDRState)}else n.callbackFunc(r)};function j4e(e){let t=new DataView(e);return{time:t.getBigInt64(0,!0),nLen:t.getUint8(8,!0)}}Fw.prototype.onClose=function(){console.log("DISCONNECTED")};Fw.prototype.onError=function(e){console.log("websocket error")};var _oe=Fw;function K4e(e,t){this.SIZE=27,this.header=cn(e,t);let n=T(t,0),r=26+n;this.CMD_TYPE=e.getUint8(r,!0)}var yoe=K4e;function Z4e(e,t){this.SIZE=81,this.header=cn(e,t);let n=T(t,0),r=26+n,o=[];for(let a=0;a<10;a++)o.push(String.fromCharCode(e.getInt8(r,!0))),r+=1;this.tgtName=o,this.nTgtID=e.getUint16(r,!0),r+=4,this.nTgtType=e.getUint8(r,!0),r+=1,this.lfLon=e.getFloat64(r,!0),r+=8,this.lfLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat64(r,!0),r+=8,this.fTgtLength=e.getFloat32(r,!0),r+=4,this.fTgtWidth=e.getFloat32(r,!0),r+=4,this.fTgtHeight=e.getFloat32(r,!0),r+=4,this.cMslNum=e.getUint8(r,!0),r+=1,this.cIsCenter=e.getUint8(r,!0),r+=1,this.cCenterNum=e.getUint8(r,!0),r+=1,this.cMatchPriority=e.getUint8(r,!0)}var voe=Z4e;var Q4e={Dir_None:0,Dir_RightBack:1,Dir_LeftBack:2,Dir_RightFront:4,Dir_LeftFront:8},Coe=Object.freeze(Q4e);var J4e="1.96";return Foe($4e);})();
