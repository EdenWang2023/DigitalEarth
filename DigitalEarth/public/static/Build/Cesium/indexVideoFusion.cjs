/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.96
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

var yh=Object.create;var Pi=Object.defineProperty;var gh=Object.getOwnPropertyDescriptor;var Ch=Object.getOwnPropertyNames;var vh=Object.getPrototypeOf,Eh=Object.prototype.hasOwnProperty;var Ho=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Th=(e,t)=>{for(var n in t)Pi(e,n,{get:t[n],enumerable:!0})},Ya=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ch(t))!Eh.call(e,i)&&i!==n&&Pi(e,i,{get:()=>t[i],enumerable:!(o=gh(t,i))||o.enumerable});return e};var Xa=(e,t,n)=>(n=e!=null?yh(vh(e)):{},Ya(t||!e||!e.__esModule?Pi(n,"default",{value:e,enumerable:!0}):n,e)),bh=e=>Ya(Pi({},"__esModule",{value:!0}),e);var Ja=Ho((Rv,Qa)=>{var yn=function(e){e==null&&(e=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};yn.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};yn.prototype.init_by_array=function(e,t){var n,o,i;for(this.init_seed(19650218),n=1,o=0,i=this.N>t?this.N:t;i;i--){var r=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((r&4294901760)>>>16)*1664525<<16)+(r&65535)*1664525)+e[o]+o,this.mt[n]>>>=0,n++,o++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),o>=t&&(o=0)}for(i=this.N-1;i;i--){var r=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((r&4294901760)>>>16)*1566083941<<16)+(r&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648};yn.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[e&1];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[e&1];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0};yn.prototype.random_int31=function(){return this.random_int()>>>1};yn.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};yn.prototype.random=function(){return this.random_int()*(1/4294967296)};yn.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};yn.prototype.random_long=function(){var e=this.random_int()>>>5,t=this.random_int()>>>6;return(e*67108864+t)*(1/9007199254740992)};Qa.exports=yn});var Gc=Ho((Ro,Po)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */(function(e){var t=typeof Ro=="object"&&Ro&&!Ro.nodeType&&Ro,n=typeof Po=="object"&&Po&&!Po.nodeType&&Po,o=typeof global=="object"&&global;(o.global===o||o.window===o||o.self===o)&&(e=o);var i,r=2147483647,s=36,a=1,c=26,u=38,d=700,m=72,p=128,_="-",g=/^xn--/,v=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=s-a,x=Math.floor,P=String.fromCharCode,z;function L(M){throw new RangeError(S[M])}function B(M,q){for(var te=M.length,de=[];te--;)de[te]=q(M[te]);return de}function F(M,q){var te=M.split("@"),de="";te.length>1&&(de=te[0]+"@",M=te[1]),M=M.replace(b,".");var he=M.split("."),Ce=B(he,q).join(".");return de+Ce}function N(M){for(var q=[],te=0,de=M.length,he,Ce;te<de;)he=M.charCodeAt(te++),he>=55296&&he<=56319&&te<de?(Ce=M.charCodeAt(te++),(Ce&64512)==56320?q.push(((he&1023)<<10)+(Ce&1023)+65536):(q.push(he),te--)):q.push(he);return q}function I(M){return B(M,function(q){var te="";return q>65535&&(q-=65536,te+=P(q>>>10&1023|55296),q=56320|q&1023),te+=P(q),te}).join("")}function U(M){return M-48<10?M-22:M-65<26?M-65:M-97<26?M-97:s}function h(M,q){return M+22+75*(M<26)-((q!=0)<<5)}function C(M,q,te){var de=0;for(M=te?x(M/d):M>>1,M+=x(M/q);M>A*c>>1;de+=s)M=x(M/A);return x(de+(A+1)*M/(M+u))}function T(M){var q=[],te=M.length,de,he=0,Ce=p,ye=m,Se,Ie,Ne,Me,ke,_e,dt,St,Nt;for(Se=M.lastIndexOf(_),Se<0&&(Se=0),Ie=0;Ie<Se;++Ie)M.charCodeAt(Ie)>=128&&L("not-basic"),q.push(M.charCodeAt(Ie));for(Ne=Se>0?Se+1:0;Ne<te;){for(Me=he,ke=1,_e=s;Ne>=te&&L("invalid-input"),dt=U(M.charCodeAt(Ne++)),(dt>=s||dt>x((r-he)/ke))&&L("overflow"),he+=dt*ke,St=_e<=ye?a:_e>=ye+c?c:_e-ye,!(dt<St);_e+=s)Nt=s-St,ke>x(r/Nt)&&L("overflow"),ke*=Nt;de=q.length+1,ye=C(he-Me,de,Me==0),x(he/de)>r-Ce&&L("overflow"),Ce+=x(he/de),he%=de,q.splice(he++,0,Ce)}return I(q)}function R(M){var q,te,de,he,Ce,ye,Se,Ie,Ne,Me,ke,_e=[],dt,St,Nt,pn;for(M=N(M),dt=M.length,q=p,te=0,Ce=m,ye=0;ye<dt;++ye)ke=M[ye],ke<128&&_e.push(P(ke));for(de=he=_e.length,he&&_e.push(_);de<dt;){for(Se=r,ye=0;ye<dt;++ye)ke=M[ye],ke>=q&&ke<Se&&(Se=ke);for(St=de+1,Se-q>x((r-te)/St)&&L("overflow"),te+=(Se-q)*St,q=Se,ye=0;ye<dt;++ye)if(ke=M[ye],ke<q&&++te>r&&L("overflow"),ke==q){for(Ie=te,Ne=s;Me=Ne<=Ce?a:Ne>=Ce+c?c:Ne-Ce,!(Ie<Me);Ne+=s)pn=Ie-Me,Nt=s-Me,_e.push(P(h(Me+pn%Nt,0))),Ie=x(pn/Nt);_e.push(P(h(Ie,0))),Ce=C(te,St,de==he),te=0,++de}++te,++q}return _e.join("")}function D(M){return F(M,function(q){return g.test(q)?T(q.slice(4).toLowerCase()):q})}function k(M){return F(M,function(q){return v.test(q)?"xn--"+R(q):q})}if(i={version:"1.3.2",ucs2:{decode:N,encode:I},decode:T,encode:R,toASCII:k,toUnicode:D},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return i});else if(t&&n)if(Po.exports==t)n.exports=i;else for(z in i)i.hasOwnProperty(z)&&(t[z]=i[z]);else e.punycode=i})(Ro)});var Hc=Ho((jc,or)=>{/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof or=="object"&&or.exports?or.exports=t():typeof define=="function"&&define.amd?define(t):e.IPv6=t(e)})(jc,function(e){"use strict";var t=e&&e.IPv6;function n(i){var r=i.toLowerCase(),s=r.split(":"),a=s.length,c=8;s[0]===""&&s[1]===""&&s[2]===""?(s.shift(),s.shift()):s[0]===""&&s[1]===""?s.shift():s[a-1]===""&&s[a-2]===""&&s.pop(),a=s.length,s[a-1].indexOf(".")!==-1&&(c=7);var u;for(u=0;u<a&&s[u]!=="";u++);if(u<c)for(s.splice(u,1,"0000");s.length<c;)s.splice(u,0,"0000");for(var d,m=0;m<c;m++){d=s[m].split("");for(var p=0;p<3&&(d[0]==="0"&&d.length>1);p++)d.splice(0,1);s[m]=d.join("")}var _=-1,g=0,v=0,b=-1,S=!1;for(m=0;m<c;m++)S?s[m]==="0"?v+=1:(S=!1,v>g&&(_=b,g=v)):s[m]==="0"&&(S=!0,b=m,v=1);v>g&&(_=b,g=v),g>1&&s.splice(_,g,""),a=s.length;var A="";for(s[0]===""&&(A=":"),m=0;m<a&&(A+=s[m],m!==a-1);m++)A+=":";return s[a-1]===""&&(A+=":"),A}function o(){return e.IPv6===this&&(e.IPv6=t),this}return{best:n,noConflict:o}})});var Wc=Ho((qc,ir)=>{/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof ir=="object"&&ir.exports?ir.exports=t():typeof define=="function"&&define.amd?define(t):e.SecondLevelDomains=t(e)})(qc,function(e){"use strict";var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(o){var i=o.lastIndexOf(".");if(i<=0||i>=o.length-1)return!1;var r=o.lastIndexOf(".",i-1);if(r<=0||r>=i-1)return!1;var s=n.list[o.slice(i+1)];return s?s.indexOf(" "+o.slice(r+1,i)+" ")>=0:!1},is:function(o){var i=o.lastIndexOf(".");if(i<=0||i>=o.length-1)return!1;var r=o.lastIndexOf(".",i-1);if(r>=0)return!1;var s=n.list[o.slice(i+1)];return s?s.indexOf(" "+o.slice(0,i)+" ")>=0:!1},get:function(o){var i=o.lastIndexOf(".");if(i<=0||i>=o.length-1)return null;var r=o.lastIndexOf(".",i-1);if(r<=0||r>=i-1)return null;var s=n.list[o.slice(i+1)];return!s||s.indexOf(" "+o.slice(r+1,i)+" ")<0?null:o.slice(r+1)},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n})});var Xc=Ho((Yc,rr)=>{/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof rr=="object"&&rr.exports?rr.exports=t(Gc(),Hc(),Wc()):typeof define=="function"&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)})(Yc,function(e,t,n,o){"use strict";var i=o&&o.URI;function r(h,C){var T=arguments.length>=1,R=arguments.length>=2;if(!(this instanceof r))return T?R?new r(h,C):new r(h):new r;if(h===void 0){if(T)throw new TypeError("undefined is not a valid argument for URI");typeof location<"u"?h=location.href+"":h=""}if(h===null&&T)throw new TypeError("null is not a valid argument for URI");return this.href(h),C!==void 0?this.absoluteTo(C):this}function s(h){return/^[0-9]+$/.test(h)}r.version="1.19.11";var a=r.prototype,c=Object.prototype.hasOwnProperty;function u(h){return h.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function d(h){return h===void 0?"Undefined":String(Object.prototype.toString.call(h)).slice(8,-1)}function m(h){return d(h)==="Array"}function p(h,C){var T={},R,D;if(d(C)==="RegExp")T=null;else if(m(C))for(R=0,D=C.length;R<D;R++)T[C[R]]=!0;else T[C]=!0;for(R=0,D=h.length;R<D;R++){var k=T&&T[h[R]]!==void 0||!T&&C.test(h[R]);k&&(h.splice(R,1),D--,R--)}return h}function _(h,C){var T,R;if(m(C)){for(T=0,R=C.length;T<R;T++)if(!_(h,C[T]))return!1;return!0}var D=d(C);for(T=0,R=h.length;T<R;T++)if(D==="RegExp"){if(typeof h[T]=="string"&&h[T].match(C))return!0}else if(h[T]===C)return!0;return!1}function g(h,C){if(!m(h)||!m(C)||h.length!==C.length)return!1;h.sort(),C.sort();for(var T=0,R=h.length;T<R;T++)if(h[T]!==C[T])return!1;return!0}function v(h){var C=/^\/+|\/+$/g;return h.replace(C,"")}r._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:r.preventInvalidHostname,duplicateQueryParameters:r.duplicateQueryParameters,escapeQuerySpace:r.escapeQuerySpace}},r.preventInvalidHostname=!1,r.duplicateQueryParameters=!1,r.escapeQuerySpace=!0,r.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,r.idn_expression=/[^a-z0-9\._-]/i,r.punycode_expression=/(xn--)/i,r.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,r.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig,r.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},r.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,r.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,r.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},r.hostProtocols=["http","https"],r.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,r.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},r.getDomAttribute=function(h){if(!(!h||!h.nodeName)){var C=h.nodeName.toLowerCase();if(!(C==="input"&&h.type!=="image"))return r.domAttributes[C]}};function b(h){return escape(h)}function S(h){return encodeURIComponent(h).replace(/[!'()*]/g,b).replace(/\*/g,"%2A")}r.encode=S,r.decode=decodeURIComponent,r.iso8859=function(){r.encode=escape,r.decode=unescape},r.unicode=function(){r.encode=S,r.decode=decodeURIComponent},r.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},r.encodeQuery=function(h,C){var T=r.encode(h+"");return C===void 0&&(C=r.escapeQuerySpace),C?T.replace(/%20/g,"+"):T},r.decodeQuery=function(h,C){h+="",C===void 0&&(C=r.escapeQuerySpace);try{return r.decode(C?h.replace(/\+/g,"%20"):h)}catch{return h}};var A={encode:"encode",decode:"decode"},x,P=function(h,C){return function(T){try{return r[C](T+"").replace(r.characters[h][C].expression,function(R){return r.characters[h][C].map[R]})}catch{return T}}};for(x in A)r[x+"PathSegment"]=P("pathname",A[x]),r[x+"UrnPathSegment"]=P("urnpath",A[x]);var z=function(h,C,T){return function(R){var D;T?D=function(te){return r[C](r[T](te))}:D=r[C];for(var k=(R+"").split(h),M=0,q=k.length;M<q;M++)k[M]=D(k[M]);return k.join(h)}};r.decodePath=z("/","decodePathSegment"),r.decodeUrnPath=z(":","decodeUrnPathSegment"),r.recodePath=z("/","encodePathSegment","decode"),r.recodeUrnPath=z(":","encodeUrnPathSegment","decode"),r.encodeReserved=P("reserved","encode"),r.parse=function(h,C){var T;return C||(C={preventInvalidHostname:r.preventInvalidHostname}),h=h.replace(r.leading_whitespace_expression,""),h=h.replace(r.ascii_tab_whitespace,""),T=h.indexOf("#"),T>-1&&(C.fragment=h.substring(T+1)||null,h=h.substring(0,T)),T=h.indexOf("?"),T>-1&&(C.query=h.substring(T+1)||null,h=h.substring(0,T)),h=h.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://"),h=h.replace(/^[/\\]{2,}/i,"//"),h.substring(0,2)==="//"?(C.protocol=null,h=h.substring(2),h=r.parseAuthority(h,C)):(T=h.indexOf(":"),T>-1&&(C.protocol=h.substring(0,T)||null,C.protocol&&!C.protocol.match(r.protocol_expression)?C.protocol=void 0:h.substring(T+1,T+3).replace(/\\/g,"/")==="//"?(h=h.substring(T+3),h=r.parseAuthority(h,C)):(h=h.substring(T+1),C.urn=!0))),C.path=h,C},r.parseHost=function(h,C){h||(h=""),h=h.replace(/\\/g,"/");var T=h.indexOf("/"),R,D;if(T===-1&&(T=h.length),h.charAt(0)==="[")R=h.indexOf("]"),C.hostname=h.substring(1,R)||null,C.port=h.substring(R+2,T)||null,C.port==="/"&&(C.port=null);else{var k=h.indexOf(":"),M=h.indexOf("/"),q=h.indexOf(":",k+1);q!==-1&&(M===-1||q<M)?(C.hostname=h.substring(0,T)||null,C.port=null):(D=h.substring(0,T).split(":"),C.hostname=D[0]||null,C.port=D[1]||null)}return C.hostname&&h.substring(T).charAt(0)!=="/"&&(T++,h="/"+h),C.preventInvalidHostname&&r.ensureValidHostname(C.hostname,C.protocol),C.port&&r.ensureValidPort(C.port),h.substring(T)||"/"},r.parseAuthority=function(h,C){return h=r.parseUserinfo(h,C),r.parseHost(h,C)},r.parseUserinfo=function(h,C){var T=h,R=h.indexOf("\\");R!==-1&&(h=h.replace(/\\/g,"/"));var D=h.indexOf("/"),k=h.lastIndexOf("@",D>-1?D:h.length-1),M;return k>-1&&(D===-1||k<D)?(M=h.substring(0,k).split(":"),C.username=M[0]?r.decode(M[0]):null,M.shift(),C.password=M[0]?r.decode(M.join(":")):null,h=T.substring(k+1)):(C.username=null,C.password=null),h},r.parseQuery=function(h,C){if(!h)return{};if(h=h.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!h)return{};for(var T={},R=h.split("&"),D=R.length,k,M,q,te=0;te<D;te++)k=R[te].split("="),M=r.decodeQuery(k.shift(),C),q=k.length?r.decodeQuery(k.join("="),C):null,M!=="__proto__"&&(c.call(T,M)?((typeof T[M]=="string"||T[M]===null)&&(T[M]=[T[M]]),T[M].push(q)):T[M]=q);return T},r.build=function(h){var C="",T=!1;return h.protocol&&(C+=h.protocol+":"),!h.urn&&(C||h.hostname)&&(C+="//",T=!0),C+=r.buildAuthority(h)||"",typeof h.path=="string"&&(h.path.charAt(0)!=="/"&&T&&(C+="/"),C+=h.path),typeof h.query=="string"&&h.query&&(C+="?"+h.query),typeof h.fragment=="string"&&h.fragment&&(C+="#"+h.fragment),C},r.buildHost=function(h){var C="";if(h.hostname)r.ip6_expression.test(h.hostname)?C+="["+h.hostname+"]":C+=h.hostname;else return"";return h.port&&(C+=":"+h.port),C},r.buildAuthority=function(h){return r.buildUserinfo(h)+r.buildHost(h)},r.buildUserinfo=function(h){var C="";return h.username&&(C+=r.encode(h.username)),h.password&&(C+=":"+r.encode(h.password)),C&&(C+="@"),C},r.buildQuery=function(h,C,T){var R="",D,k,M,q;for(k in h)if(k!=="__proto__"&&c.call(h,k))if(m(h[k]))for(D={},M=0,q=h[k].length;M<q;M++)h[k][M]!==void 0&&D[h[k][M]+""]===void 0&&(R+="&"+r.buildQueryParameter(k,h[k][M],T),C!==!0&&(D[h[k][M]+""]=!0));else h[k]!==void 0&&(R+="&"+r.buildQueryParameter(k,h[k],T));return R.substring(1)},r.buildQueryParameter=function(h,C,T){return r.encodeQuery(h,T)+(C!==null?"="+r.encodeQuery(C,T):"")},r.addQuery=function(h,C,T){if(typeof C=="object")for(var R in C)c.call(C,R)&&r.addQuery(h,R,C[R]);else if(typeof C=="string"){if(h[C]===void 0){h[C]=T;return}else typeof h[C]=="string"&&(h[C]=[h[C]]);m(T)||(T=[T]),h[C]=(h[C]||[]).concat(T)}else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")},r.setQuery=function(h,C,T){if(typeof C=="object")for(var R in C)c.call(C,R)&&r.setQuery(h,R,C[R]);else if(typeof C=="string")h[C]=T===void 0?null:T;else throw new TypeError("URI.setQuery() accepts an object, string as the name parameter")},r.removeQuery=function(h,C,T){var R,D,k;if(m(C))for(R=0,D=C.length;R<D;R++)h[C[R]]=void 0;else if(d(C)==="RegExp")for(k in h)C.test(k)&&(h[k]=void 0);else if(typeof C=="object")for(k in C)c.call(C,k)&&r.removeQuery(h,k,C[k]);else if(typeof C=="string")T!==void 0?d(T)==="RegExp"?!m(h[C])&&T.test(h[C])?h[C]=void 0:h[C]=p(h[C],T):h[C]===String(T)&&(!m(T)||T.length===1)?h[C]=void 0:m(h[C])&&(h[C]=p(h[C],T)):h[C]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")},r.hasQuery=function(h,C,T,R){switch(d(C)){case"String":break;case"RegExp":for(var D in h)if(c.call(h,D)&&C.test(D)&&(T===void 0||r.hasQuery(h,D,T)))return!0;return!1;case"Object":for(var k in C)if(c.call(C,k)&&!r.hasQuery(h,k,C[k]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(d(T)){case"Undefined":return C in h;case"Boolean":var M=Boolean(m(h[C])?h[C].length:h[C]);return T===M;case"Function":return!!T(h[C],C,h);case"Array":if(!m(h[C]))return!1;var q=R?_:g;return q(h[C],T);case"RegExp":return m(h[C])?R?_(h[C],T):!1:Boolean(h[C]&&h[C].match(T));case"Number":T=String(T);case"String":return m(h[C])?R?_(h[C],T):!1:h[C]===T;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},r.joinPaths=function(){for(var h=[],C=[],T=0,R=0;R<arguments.length;R++){var D=new r(arguments[R]);h.push(D);for(var k=D.segment(),M=0;M<k.length;M++)typeof k[M]=="string"&&C.push(k[M]),k[M]&&T++}if(!C.length||!T)return new r("");var q=new r("").segment(C);return(h[0].path()===""||h[0].path().slice(0,1)==="/")&&q.path("/"+q.path()),q.normalize()},r.commonPath=function(h,C){var T=Math.min(h.length,C.length),R;for(R=0;R<T;R++)if(h.charAt(R)!==C.charAt(R)){R--;break}return R<1?h.charAt(0)===C.charAt(0)&&h.charAt(0)==="/"?"/":"":((h.charAt(R)!=="/"||C.charAt(R)!=="/")&&(R=h.substring(0,R).lastIndexOf("/")),h.substring(0,R+1))},r.withinString=function(h,C,T){T||(T={});var R=T.start||r.findUri.start,D=T.end||r.findUri.end,k=T.trim||r.findUri.trim,M=T.parens||r.findUri.parens,q=/[a-z0-9-]=["']?$/i;for(R.lastIndex=0;;){var te=R.exec(h);if(!te)break;var de=te.index;if(T.ignoreHtml){var he=h.slice(Math.max(de-3,0),de);if(he&&q.test(he))continue}for(var Ce=de+h.slice(de).search(D),ye=h.slice(de,Ce),Se=-1;;){var Ie=M.exec(ye);if(!Ie)break;var Ne=Ie.index+Ie[0].length;Se=Math.max(Se,Ne)}if(Se>-1?ye=ye.slice(0,Se)+ye.slice(Se).replace(k,""):ye=ye.replace(k,""),!(ye.length<=te[0].length)&&!(T.ignore&&T.ignore.test(ye))){Ce=de+ye.length;var Me=C(ye,de,Ce,h);if(Me===void 0){R.lastIndex=Ce;continue}Me=String(Me),h=h.slice(0,de)+Me+h.slice(Ce),R.lastIndex=de+Me.length}}return R.lastIndex=0,h},r.ensureValidHostname=function(h,C){var T=!!h,R=!!C,D=!1;if(R&&(D=_(r.hostProtocols,C)),D&&!T)throw new TypeError("Hostname cannot be empty, if protocol is "+C);if(h&&h.match(r.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+h+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(h).match(r.invalid_hostname_characters))throw new TypeError('Hostname "'+h+'" contains characters other than [A-Z0-9.-:_]')}},r.ensureValidPort=function(h){if(!!h){var C=Number(h);if(!(s(C)&&C>0&&C<65536))throw new TypeError('Port "'+h+'" is not a valid port')}},r.noConflict=function(h){if(h){var C={URI:this.noConflict()};return o.URITemplate&&typeof o.URITemplate.noConflict=="function"&&(C.URITemplate=o.URITemplate.noConflict()),o.IPv6&&typeof o.IPv6.noConflict=="function"&&(C.IPv6=o.IPv6.noConflict()),o.SecondLevelDomains&&typeof o.SecondLevelDomains.noConflict=="function"&&(C.SecondLevelDomains=o.SecondLevelDomains.noConflict()),C}else o.URI===this&&(o.URI=i);return this},a.build=function(h){return h===!0?this._deferred_build=!0:(h===void 0||this._deferred_build)&&(this._string=r.build(this._parts),this._deferred_build=!1),this},a.clone=function(){return new r(this)},a.valueOf=a.toString=function(){return this.build(!1)._string};function L(h){return function(C,T){return C===void 0?this._parts[h]||"":(this._parts[h]=C||null,this.build(!T),this)}}function B(h,C){return function(T,R){return T===void 0?this._parts[h]||"":(T!==null&&(T=T+"",T.charAt(0)===C&&(T=T.substring(1))),this._parts[h]=T,this.build(!R),this)}}a.protocol=L("protocol"),a.username=L("username"),a.password=L("password"),a.hostname=L("hostname"),a.port=L("port"),a.query=B("query","?"),a.fragment=B("fragment","#"),a.search=function(h,C){var T=this.query(h,C);return typeof T=="string"&&T.length?"?"+T:T},a.hash=function(h,C){var T=this.fragment(h,C);return typeof T=="string"&&T.length?"#"+T:T},a.pathname=function(h,C){if(h===void 0||h===!0){var T=this._parts.path||(this._parts.hostname?"/":"");return h?(this._parts.urn?r.decodeUrnPath:r.decodePath)(T):T}else return this._parts.urn?this._parts.path=h?r.recodeUrnPath(h):"":this._parts.path=h?r.recodePath(h):"/",this.build(!C),this},a.path=a.pathname,a.href=function(h,C){var T;if(h===void 0)return this.toString();this._string="",this._parts=r._parts();var R=h instanceof r,D=typeof h=="object"&&(h.hostname||h.path||h.pathname);if(h.nodeName){var k=r.getDomAttribute(h);h=h[k]||"",D=!1}if(!R&&D&&h.pathname!==void 0&&(h=h.toString()),typeof h=="string"||h instanceof String)this._parts=r.parse(String(h),this._parts);else if(R||D){var M=R?h._parts:h;for(T in M)T!=="query"&&c.call(this._parts,T)&&(this._parts[T]=M[T]);M.query&&this.query(M.query,!1)}else throw new TypeError("invalid input");return this.build(!C),this},a.is=function(h){var C=!1,T=!1,R=!1,D=!1,k=!1,M=!1,q=!1,te=!this._parts.urn;switch(this._parts.hostname&&(te=!1,T=r.ip4_expression.test(this._parts.hostname),R=r.ip6_expression.test(this._parts.hostname),C=T||R,D=!C,k=D&&n&&n.has(this._parts.hostname),M=D&&r.idn_expression.test(this._parts.hostname),q=D&&r.punycode_expression.test(this._parts.hostname)),h.toLowerCase()){case"relative":return te;case"absolute":return!te;case"domain":case"name":return D;case"sld":return k;case"ip":return C;case"ip4":case"ipv4":case"inet4":return T;case"ip6":case"ipv6":case"inet6":return R;case"idn":return M;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return q}return null};var F=a.protocol,N=a.port,I=a.hostname;a.protocol=function(h,C){if(h&&(h=h.replace(/:(\/\/)?$/,""),!h.match(r.protocol_expression)))throw new TypeError('Protocol "'+h+`" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]`);return F.call(this,h,C)},a.scheme=a.protocol,a.port=function(h,C){return this._parts.urn?h===void 0?"":this:(h!==void 0&&(h===0&&(h=null),h&&(h+="",h.charAt(0)===":"&&(h=h.substring(1)),r.ensureValidPort(h))),N.call(this,h,C))},a.hostname=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h!==void 0){var T={preventInvalidHostname:this._parts.preventInvalidHostname},R=r.parseHost(h,T);if(R!=="/")throw new TypeError('Hostname "'+h+'" contains characters other than [A-Z0-9.-]');h=T.hostname,this._parts.preventInvalidHostname&&r.ensureValidHostname(h,this._parts.protocol)}return I.call(this,h,C)},a.origin=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0){var T=this.protocol(),R=this.authority();return R?(T?T+"://":"")+this.authority():""}else{var D=r(h);return this.protocol(D.protocol()).authority(D.authority()).build(!C),this}},a.host=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0)return this._parts.hostname?r.buildHost(this._parts):"";var T=r.parseHost(h,this._parts);if(T!=="/")throw new TypeError('Hostname "'+h+'" contains characters other than [A-Z0-9.-]');return this.build(!C),this},a.authority=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0)return this._parts.hostname?r.buildAuthority(this._parts):"";var T=r.parseAuthority(h,this._parts);if(T!=="/")throw new TypeError('Hostname "'+h+'" contains characters other than [A-Z0-9.-]');return this.build(!C),this},a.userinfo=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0){var T=r.buildUserinfo(this._parts);return T&&T.substring(0,T.length-1)}else return h[h.length-1]!=="@"&&(h+="@"),r.parseUserinfo(h,this._parts),this.build(!C),this},a.resource=function(h,C){var T;return h===void 0?this.path()+this.search()+this.hash():(T=r.parse(h),this._parts.path=T.path,this._parts.query=T.query,this._parts.fragment=T.fragment,this.build(!C),this)},a.subdomain=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0){if(!this._parts.hostname||this.is("IP"))return"";var T=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,T)||""}else{var R=this._parts.hostname.length-this.domain().length,D=this._parts.hostname.substring(0,R),k=new RegExp("^"+u(D));if(h&&h.charAt(h.length-1)!=="."&&(h+="."),h.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");return h&&r.ensureValidHostname(h,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(k,h),this.build(!C),this}},a.domain=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(typeof h=="boolean"&&(C=h,h=void 0),h===void 0){if(!this._parts.hostname||this.is("IP"))return"";var T=this._parts.hostname.match(/\./g);if(T&&T.length<2)return this._parts.hostname;var R=this._parts.hostname.length-this.tld(C).length-1;return R=this._parts.hostname.lastIndexOf(".",R-1)+1,this._parts.hostname.substring(R)||""}else{if(!h)throw new TypeError("cannot set domain empty");if(h.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");if(r.ensureValidHostname(h,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=h;else{var D=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(D,h)}return this.build(!C),this}},a.tld=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(typeof h=="boolean"&&(C=h,h=void 0),h===void 0){if(!this._parts.hostname||this.is("IP"))return"";var T=this._parts.hostname.lastIndexOf("."),R=this._parts.hostname.substring(T+1);return C!==!0&&n&&n.list[R.toLowerCase()]&&n.get(this._parts.hostname)||R}else{var D;if(h)if(h.match(/[^a-zA-Z0-9-]/))if(n&&n.is(h))D=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(D,h);else throw new TypeError('TLD "'+h+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");D=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(D,h)}else throw new TypeError("cannot set TLD empty");return this.build(!C),this}},a.directory=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0||h===!0){if(!this._parts.path&&!this._parts.hostname)return"";if(this._parts.path==="/")return"/";var T=this._parts.path.length-this.filename().length-1,R=this._parts.path.substring(0,T)||(this._parts.hostname?"/":"");return h?r.decodePath(R):R}else{var D=this._parts.path.length-this.filename().length,k=this._parts.path.substring(0,D),M=new RegExp("^"+u(k));return this.is("relative")||(h||(h="/"),h.charAt(0)!=="/"&&(h="/"+h)),h&&h.charAt(h.length-1)!=="/"&&(h+="/"),h=r.recodePath(h),this._parts.path=this._parts.path.replace(M,h),this.build(!C),this}},a.filename=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(typeof h!="string"){if(!this._parts.path||this._parts.path==="/")return"";var T=this._parts.path.lastIndexOf("/"),R=this._parts.path.substring(T+1);return h?r.decodePathSegment(R):R}else{var D=!1;h.charAt(0)==="/"&&(h=h.substring(1)),h.match(/\.?\//)&&(D=!0);var k=new RegExp(u(this.filename())+"$");return h=r.recodePath(h),this._parts.path=this._parts.path.replace(k,h),D?this.normalizePath(C):this.build(!C),this}},a.suffix=function(h,C){if(this._parts.urn)return h===void 0?"":this;if(h===void 0||h===!0){if(!this._parts.path||this._parts.path==="/")return"";var T=this.filename(),R=T.lastIndexOf("."),D,k;return R===-1?"":(D=T.substring(R+1),k=/^[a-z0-9%]+$/i.test(D)?D:"",h?r.decodePathSegment(k):k)}else{h.charAt(0)==="."&&(h=h.substring(1));var M=this.suffix(),q;if(M)h?q=new RegExp(u(M)+"$"):q=new RegExp(u("."+M)+"$");else{if(!h)return this;this._parts.path+="."+r.recodePath(h)}return q&&(h=r.recodePath(h),this._parts.path=this._parts.path.replace(q,h)),this.build(!C),this}},a.segment=function(h,C,T){var R=this._parts.urn?":":"/",D=this.path(),k=D.substring(0,1)==="/",M=D.split(R);if(h!==void 0&&typeof h!="number"&&(T=C,C=h,h=void 0),h!==void 0&&typeof h!="number")throw new Error('Bad segment "'+h+'", must be 0-based integer');if(k&&M.shift(),h<0&&(h=Math.max(M.length+h,0)),C===void 0)return h===void 0?M:M[h];if(h===null||M[h]===void 0)if(m(C)){M=[];for(var q=0,te=C.length;q<te;q++)!C[q].length&&(!M.length||!M[M.length-1].length)||(M.length&&!M[M.length-1].length&&M.pop(),M.push(v(C[q])))}else(C||typeof C=="string")&&(C=v(C),M[M.length-1]===""?M[M.length-1]=C:M.push(C));else C?M[h]=v(C):M.splice(h,1);return k&&M.unshift(""),this.path(M.join(R),T)},a.segmentCoded=function(h,C,T){var R,D,k;if(typeof h!="number"&&(T=C,C=h,h=void 0),C===void 0){if(R=this.segment(h,C,T),!m(R))R=R!==void 0?r.decode(R):void 0;else for(D=0,k=R.length;D<k;D++)R[D]=r.decode(R[D]);return R}if(!m(C))C=typeof C=="string"||C instanceof String?r.encode(C):C;else for(D=0,k=C.length;D<k;D++)C[D]=r.encode(C[D]);return this.segment(h,C,T)};var U=a.query;return a.query=function(h,C){if(h===!0)return r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof h=="function"){var T=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace),R=h.call(this,T);return this._parts.query=r.buildQuery(R||T,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!C),this}else return h!==void 0&&typeof h!="string"?(this._parts.query=r.buildQuery(h,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!C),this):U.call(this,h,C)},a.setQuery=function(h,C,T){var R=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof h=="string"||h instanceof String)R[h]=C!==void 0?C:null;else if(typeof h=="object")for(var D in h)c.call(h,D)&&(R[D]=h[D]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");return this._parts.query=r.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof h!="string"&&(T=C),this.build(!T),this},a.addQuery=function(h,C,T){var R=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.addQuery(R,h,C===void 0?null:C),this._parts.query=r.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof h!="string"&&(T=C),this.build(!T),this},a.removeQuery=function(h,C,T){var R=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.removeQuery(R,h,C),this._parts.query=r.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof h!="string"&&(T=C),this.build(!T),this},a.hasQuery=function(h,C,T){var R=r.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return r.hasQuery(R,h,C,T)},a.setSearch=a.setQuery,a.addSearch=a.addQuery,a.removeSearch=a.removeQuery,a.hasSearch=a.hasQuery,a.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},a.normalizeProtocol=function(h){return typeof this._parts.protocol=="string"&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!h)),this},a.normalizeHostname=function(h){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!h)),this},a.normalizePort=function(h){return typeof this._parts.protocol=="string"&&this._parts.port===r.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!h)),this},a.normalizePath=function(h){var C=this._parts.path;if(!C)return this;if(this._parts.urn)return this._parts.path=r.recodeUrnPath(this._parts.path),this.build(!h),this;if(this._parts.path==="/")return this;C=r.recodePath(C);var T,R="",D,k;for(C.charAt(0)!=="/"&&(T=!0,C="/"+C),(C.slice(-3)==="/.."||C.slice(-2)==="/.")&&(C+="/"),C=C.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),T&&(R=C.substring(1).match(/^(\.\.\/)+/)||"",R&&(R=R[0]));D=C.search(/\/\.\.(\/|$)/),D!==-1;){if(D===0){C=C.substring(3);continue}k=C.substring(0,D).lastIndexOf("/"),k===-1&&(k=D),C=C.substring(0,k)+C.substring(D+3)}return T&&this.is("relative")&&(C=R+C.substring(1)),this._parts.path=C,this.build(!h),this},a.normalizePathname=a.normalizePath,a.normalizeQuery=function(h){return typeof this._parts.query=="string"&&(this._parts.query.length?this.query(r.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!h)),this},a.normalizeFragment=function(h){return this._parts.fragment||(this._parts.fragment=null,this.build(!h)),this},a.normalizeSearch=a.normalizeQuery,a.normalizeHash=a.normalizeFragment,a.iso8859=function(){var h=r.encode,C=r.decode;r.encode=escape,r.decode=decodeURIComponent;try{this.normalize()}finally{r.encode=h,r.decode=C}return this},a.unicode=function(){var h=r.encode,C=r.decode;r.encode=S,r.decode=unescape;try{this.normalize()}finally{r.encode=h,r.decode=C}return this},a.readable=function(){var h=this.clone();h.username("").password("").normalize();var C="";if(h._parts.protocol&&(C+=h._parts.protocol+"://"),h._parts.hostname&&(h.is("punycode")&&e?(C+=e.toUnicode(h._parts.hostname),h._parts.port&&(C+=":"+h._parts.port)):C+=h.host()),h._parts.hostname&&h._parts.path&&h._parts.path.charAt(0)!=="/"&&(C+="/"),C+=h.path(!0),h._parts.query){for(var T="",R=0,D=h._parts.query.split("&"),k=D.length;R<k;R++){var M=(D[R]||"").split("=");T+="&"+r.decodeQuery(M[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),M[1]!==void 0&&(T+="="+r.decodeQuery(M[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}C+="?"+T.substring(1)}return C+=r.decodeQuery(h.hash(),!0),C},a.absoluteTo=function(h){var C=this.clone(),T=["protocol","username","password","hostname","port"],R,D,k;if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(h instanceof r||(h=new r(h)),C._parts.protocol||(C._parts.protocol=h._parts.protocol,this._parts.hostname))return C;for(D=0;k=T[D];D++)C._parts[k]=h._parts[k];return C._parts.path?(C._parts.path.substring(-2)===".."&&(C._parts.path+="/"),C.path().charAt(0)!=="/"&&(R=h.directory(),R=R||(h.path().indexOf("/")===0?"/":""),C._parts.path=(R?R+"/":"")+C._parts.path,C.normalizePath())):(C._parts.path=h._parts.path,C._parts.query||(C._parts.query=h._parts.query)),C.build(),C},a.relativeTo=function(h){var C=this.clone().normalize(),T,R,D,k,M;if(C._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(h=new r(h).normalize(),T=C._parts,R=h._parts,k=C.path(),M=h.path(),k.charAt(0)!=="/")throw new Error("URI is already relative");if(M.charAt(0)!=="/")throw new Error("Cannot calculate a URI relative to another relative URI");if(T.protocol===R.protocol&&(T.protocol=null),T.username!==R.username||T.password!==R.password||T.protocol!==null||T.username!==null||T.password!==null)return C.build();if(T.hostname===R.hostname&&T.port===R.port)T.hostname=null,T.port=null;else return C.build();if(k===M)return T.path="",C.build();if(D=r.commonPath(k,M),!D)return C.build();var q=R.path.substring(D.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return T.path=q+T.path.substring(D.length)||"./",C.build()},a.equals=function(h){var C=this.clone(),T=new r(h),R={},D={},k={},M,q,te;if(C.normalize(),T.normalize(),C.toString()===T.toString())return!0;if(M=C.query(),q=T.query(),C.query(""),T.query(""),C.toString()!==T.toString()||M.length!==q.length)return!1;R=r.parseQuery(M,this._parts.escapeQuerySpace),D=r.parseQuery(q,this._parts.escapeQuerySpace);for(te in R)if(c.call(R,te)){if(m(R[te])){if(!g(R[te],D[te]))return!1}else if(R[te]!==D[te])return!1;k[te]=!0}for(te in D)if(c.call(D,te)&&!k[te])return!1;return!0},a.preventInvalidHostname=function(h){return this._parts.preventInvalidHostname=!!h,this},a.duplicateQueryParameters=function(h){return this._parts.duplicateQueryParameters=!!h,this},a.escapeQuerySpace=function(h){return this._parts.escapeQuerySpace=!!h,this},r})});var QC={};Th(QC,{EV_Editor:()=>qr,EV_ProjectionPlane:()=>In,EV_VideoFusion:()=>yo,EV_VideoFusionEditor:()=>mh,EV_VideoLayer:()=>Wo,EV_VideoProjection:()=>_n,EV_VideoProjectionFS:()=>Mi,EV_VideoProjectionManager:()=>zi,EV_VideoProjectionPlane:()=>Ii,EV_VideoSynchronizerEx:()=>Oi,EV_WSPlayer:()=>Mn,VERSION:()=>ZC,VideoFusionMixin:()=>Ka});module.exports=bh(QC);function Tt(e){this._owner=e.owner,this._leftClip=0,this._rightClip=1,this._topClipLine1=new Cesium.Cartesian4(0,1,1,1),this._topClipLine2=new Cesium.Cartesian4(0,1,1,1),this._topClipLine3=new Cesium.Cartesian4(0,1,1,1),this._topClipLine4=new Cesium.Cartesian4(0,1,1,1),this._bottomClipLine1=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine2=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine3=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine4=new Cesium.Cartesian4(0,0,1,0),this._points=[],this._originalPoints=[],this._indices=void 0,this._modelMatrix=void 0,this.boundingSphere=new Cesium.BoundingSphere,this._command=void 0,this._positionDirty=!1,this._pickId=null,e.plane&&this._parse(e.plane);let t=this;this._uniformMap={u_texture:function(){return t._owner._texture},u_hsv:function(){return t._owner.videoHsv},k1:function(){return t._owner._distortion.x},k2:function(){return t._owner._distortion.y},textureSize:function(){return t._owner._textureSize},u_alpha:function(){return t._owner._alpha*t._owner.videoAlphaRate},u_projectionCameraViewMatrix:function(){return t._owner.getProjectionCameraViewMatrix()},u_projectionCameraProjectionMatrix:function(){return t._owner.videoCamera.frustum.projectionMatrix},u_leftClip:function(){return t._leftClip},u_rightClip:function(){return t._rightClip},u_topClipLine1:function(){return t._topClipLine1},u_topClipLine2:function(){return t._topClipLine2},u_topClipLine3:function(){return t._topClipLine3},u_topClipLine4:function(){return t._topClipLine4},u_bottomClipLine1:function(){return t._bottomClipLine1},u_bottomClipLine2:function(){return t._bottomClipLine2},u_bottomClipLine3:function(){return t._bottomClipLine3},u_bottomClipLine4:function(){return t._bottomClipLine4},u_pickColor:function(){return t._pickId.color}}}Tt.prototype.update=function(e){this._positionDirty&&(this._command&&this._destroyCommand(),this._createCommand(e.context),this._positionDirty=!1),e.commandList.push(this._command)};Tt.prototype._parse=function(e){this._indices=e.pop();for(let t=0;t<e.length;++t){let n=e[t],o=Cesium.Cartesian3.fromDegrees(n[0],n[1],n[2]);if(this._points.push(o),n.length>3){let i=n[3];i>-1&&(this._originalPoints[i]=o)}else this._originalPoints.push(o)}this._positionDirty=!0,this._owner.boundingSphereDirty=!0};Tt.prototype._createGeometry=function(e,t){let n=e.length,o=new Float64Array(n*3),i=0;for(let a=0;a<n;++a){let c=e[a];o[i++]=c.x,o[i++]=c.y,o[i++]=c.z}let r=new Uint8Array(t),s=new Cesium.GeometryAttributes;return s.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:o}),new Cesium.Geometry({attributes:s,indices:r,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(o)})};Tt.prototype.addPoint=function(e,t){Cesium.defined(t)?this._originalPoints.splice(t,0,e):this._originalPoints.push(e),this._positionDirty=!0,this._owner.boundingSphereDirty=!0};Tt.prototype.deletePointByIndex=function(e){this._originalPoints.splice(e,1),this._positionDirty=!0,this._owner.boundingSphereDirty=!0};Tt.prototype.setPoint=function(e,t){this._originalPoints.splice(t,1,e),this._positionDirty=!0};Tt.prototype._createCommand=function(e){let t=this._originalPoints,n=t.length;if(n<3)return;let o=this._computeCenter(t),i,r=[];for(let p=0;p<n;++p)i=Cesium.Cartesian3.subtract(t[p],o,new Cesium.Cartesian3),r.push(i);let s=Cesium.Matrix4.fromTranslation(o),a=this._computeIndices(t),c=this._createGeometry(r,a),u=Cesium.GeometryPipeline.createAttributeLocations(c),d=Cesium.VertexArray.fromGeometry({context:e,geometry:c,attributeLocations:u,bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),m=Cesium.ShaderProgram.fromCache({context:e,vertexShaderSource:this._owner._v,fragmentShaderSource:this._owner._f,attributeLocations:u});this._pickId||this._createPickId(e),this._command=new Cesium.DrawCommand({owner:this,vertexArray:d,modelMatrix:s,boundingVolume:Cesium.BoundingSphere.transform(c.boundingSphere,s,this.boundingSphere),shaderProgram:m,uniformMap:this._uniformMap,renderState:this._owner._renderState,pass:Cesium.Pass.OPAQUE,pickId:"u_pickColor"})};Tt.prototype._createPickId=function(e){this._pickId=e.createPickId({primitive:this})};Tt.prototype._computeCenter=function(e,t){t||(t=new Cesium.Cartesian3);let n=e.length;for(let o=0;o<n;++o){let i=e[o];t.x+=i.x,t.y+=i.y,t.z+=i.z}return t.x/=n,t.y/=n,t.z/=n,t};Tt.prototype._computePlaneNormal=function(e,t){let n=e.length,o=e[n-1],i,r,s=Cesium.Cartesian3.subtract(o,e[0],new Cesium.Cartesian3),a=new Cesium.Cartesian3,c=[];for(let d=0;d<n;++d)i=e[d],r=d===n-1?e[0]:e[d+1],a=Cesium.Cartesian3.subtract(r,i,a),c.push(Cesium.Cartesian3.cross(s,a,new Cesium.Cartesian3)),o=i,s=Cesium.Cartesian3.negate(a,s);t||(t=new Cesium.Cartesian3);let u=c.length;for(let d=0;d<u;++d){let m=c[d];t.x+=m.x,t.y+=m.y,t.z+=m.z}return t.x/=u,t.y/=u,t.z/=u,Cesium.Cartesian3.normalize(t,t)};Tt.prototype._computeIndices=function(e){let t=this._computeCenter(e),n=this._computePlaneNormal(e),o=Cesium.Plane.fromPointNormal(t,n),i=new Cesium.Ray(null,n),r=Cesium.Cartographic.fromCartesian(t);r.longitude+=Cesium.Math.toRadians(1e-5),r=Cesium.Cartographic.toCartesian(r),i.origin=r;let s=Cesium.IntersectionTests.rayPlane(i,o);s||(Cesium.Cartesian3.negate(i.direction,i.direction),s=Cesium.IntersectionTests.rayPlane(i,o));let a=Cesium.Cartesian3.subtract(s,t,r);Cesium.Cartesian3.normalize(a,a);let c=Cesium.Cartesian3.cross(n,a,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(c,c);let u=[];for(let d=0;d<e.length;++d){i.origin=e[d];let m=Cesium.IntersectionTests.rayPlane(i,o);if(m||(Cesium.Cartesian3.negate(i.direction,i.direction),m=Cesium.IntersectionTests.rayPlane(i,o)),m){let p=Cesium.Cartesian3.subtract(m,t,m),_=Cesium.Cartesian3.dot(a,p),g=Cesium.Cartesian3.dot(c,p);u.push(new Cesium.Cartesian2(_,g))}else throw new Cesium.Error("\u89C6\u9891\u6295\u5F71\u5E73\u9762\u9876\u70B9\u6C42\u4EA4\u5931\u8D25!")}return this._indices=Cesium.PolygonPipeline.triangulate(u),this._indices};Tt.prototype.getConfiguration=function(){let e=this._originalPoints;if(e.length===0)return null;let t=this._owner._viewer.scene.globe.ellipsoid,n=[];for(let o=0;o<e.length;++o){let i=t.cartesianToCartographic(e[o]);n.push([Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude),i.height])}return n.push(this._indices),n};Tt.prototype.destroy=function(){this._destroyCommand(),this._pickId=this._pickId&&this._pickId.destroy()};Tt.prototype._destroyCommand=function(){let e=this._command;e&&(e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram&&e.shaderProgram.destroy()),this._command=null};var In=Tt;function Yn(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=e.clock,this.element=e.element,this.epoch=Cesium.defaultValue(e.epoch,Cesium.Iso8601.MINIMUM_VALUE),this.tolerance=Cesium.defaultValue(e.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}Object.defineProperties(Yn.prototype,{clock:{get:function(){return this._clock},set:function(e){let t=this._clock;t!==e&&(Cesium.defined(t)&&(this._clockSubscription(),this._clockSubscription=void 0),Cesium.defined(e)&&(this._clockSubscription=e.onTick.addEventListener(Yn.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){let t=this._element;t!==e&&(Cesium.defined(t)&&t.removeEventListener("seeked",this._seekFunction,!1),Cesium.defined(e)&&(this._seeking=!1,this._seekFunction=Ah(this),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}});Yn.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,Cesium.destroyObject(this)};Yn.prototype.isDestroyed=function(){return!1};Yn.prototype._trySetPlaybackRate=function(e){if(this._lastPlaybackRate===e.multiplier)return;let t=this._element;try{t.playbackRate=e.multiplier}catch{t.playbackRate=0}this._lastPlaybackRate=e.multiplier};Yn.prototype._onTick=function(e){let t=this._element;if(!Cesium.defined(t)||t.readyState<2)return;let n=t.paused,o=e.shouldAnimate;if(o===n&&(o?t.play():t.pause()),this._seeking||this._firstTickAfterSeek){this._firstTickAfterSeek=!1;return}this._trySetPlaybackRate(e);let i=new Date().getTime()/1e3,r=t.duration,s,a=t.currentTime;t.loop?(i=i%r,i<0&&(i=r-i),s=i):i>r?s=r:i<0?s=0:s=i;let c=o?Cesium.defaultValue(this.tolerance,1):.001;Math.abs(s-a)>c&&(this._seeking=!0,t.currentTime=s)};function Ah(e){return function(){e._seeking=!1,e._firstTickAfterSeek=!0}}var Oi=Yn;function ze(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.videoElement))throw new Cesium.DeveloperError("options.videoElement\u524D\u7AEFvideo\u5BB9\u5668\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originLon))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u7ECF\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originLat))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u7EAC\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originHeight))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u9AD8\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(this._videoElement=e.videoElement,!(this._videoElement instanceof HTMLVideoElement))throw new Cesium.DeveloperError("options.videoElement\u5E76\u4E0D\u662F\u89C6\u9891\u5BB9\u5668\u3002");this._videoReadyPromise=Cesium.defer(),this._show=Cesium.defaultValue(e.show,!0),this._alpha=Cesium.defaultValue(e.videoAlpha,1),this.videoAlphaRate=1,this._videoVisiableAngle=45,this._videoGradientAngle=30,this._cameraDirty=!0,this._viewer=e.viewer,this._originLon=e.originLon,this._originLat=e.originLat,this._originHeight=e.originHeight,this._wsplayer=e.wsplayer,this._wsplayerType=e.wsplayerType,this._wsplayerGBAddress=e.wsplayerGBAddress,this._pitch=Cesium.defaultValue(e.pitch,0),this._heading=Cesium.defaultValue(e.heading,0),this._roll=Cesium.defaultValue(e.roll,0),this._viewPoint=e.viewPoint,this._fov=Cesium.defaultValue(e.fov,60),this._visibleDistance=Cesium.defaultValue(e.visibleDistance,100),this._slice=100,this._lineEnabled=Cesium.defaultValue(e.lineEnabled,!1),this._name=e.name,this._layer=e.layer,this._aspectRatio=void 0,this._projectionMode=0,this._lines=[],this.videoCamera=void 0,this._adjustModeEnabled=!1,this._oldCameraPosition=void 0,this._oldHeading=void 0,this._oldPitch=void 0,this._oldRoll=void 0,this._oldFov=void 0,this._oldAspectRatio=void 0,this._scene=this._viewer.scene,this._hdr=this._scene._hdr,this._scene._hdr=!1,this.videoHsv=Cesium.defaultValue(e.hsvParam,new Cesium.Cartesian3),this._distortion=Cesium.defaultValue(e.distortion,new Cesium.Cartesian2),this._textureSize=Cesium.defaultValue(e.textureSize,new Cesium.Cartesian2),this._lInfo=void 0,this._visibleDistance=Cesium.defaultValue(e.visibleDistance,100),this._projectionCameraViewMatrix=new Cesium.Matrix4,this._backCull=Cesium.defaultValue(e.backCull,!1),this._v=void 0,this._f=void 0,this._renderState=void 0,this._planes=[],this.boundingSphere=new Cesium.BoundingSphere,this._boundingSphereDirty=!1,e.projection&&this._createProjectionPlanes(e.projection),this._videoElement instanceof HTMLVideoElement&&(this.incompatibleConsole(),this._viewer.clock.shouldAnimate=!0,this._synchronizer=new Oi({clock:this._viewer.clock,element:this._videoElement})),this._createVertexShaderSource(),this._createFragmentShaderSource(),this._createRenderState(),this._viewer.scene.primitives.add(this),this._changed=new Cesium.Event,this._cameraPromise=Cesium.defer()}Object.defineProperties(ze.prototype,{name:{get:function(){return this._name}},videoAlpha:{get:function(){return this._alpha},set:function(e){this._alpha=e}},changed:{get:function(){return this._changed}},cameraPromise:{get:function(){return this._cameraPromise.promise}},projectionMode:{get:function(){return this._projectionMode}},boundingSphereDirty:{get:function(){return this._boundingSphereDirty},set:function(e){this._boundingSphereDirty=e}},visibleDistance:{get:function(){return this._visibleDistance},set:function(e){this._visibleDistance=e}}});ze.prototype.update=function(e){if(!this._show||e.mode!==Cesium.SceneMode.SCENE3D)return;let t=e.context;if(this._context=t,this._boundingSphereDirty&&(this._computeBoundingSphere(),this._boundingSphereDirty=!1),!this.boundingSphere.center.equals(Cesium.Cartesian3.ZERO)){let n=Cesium.Cartesian3.distance(e.camera.position,this.boundingSphere.center);if(n-=this.boundingSphere.radius,n>this._visibleDistance){this._wsplayer&&this._wsplayer.socketConnect&&this._wsplayer.stop();return}}if(this._checkVideoCameraAngle(),this.videoAlphaRate!==0&&(this._wsplayer&&!this._wsplayer.socketConnect&&(this._wsplayerType==="rtsp"?this._wsplayer.openws():this._wsplayerType==="gb"&&(this._wsplayer.openws(),this._wsplayer.playGB(),this._wsplayer.playGBDevice(this._wsplayerGBAddress))),this._videoElement.readyState>=2&&!this._videoElement.paused&&(Cesium.defined(this._texture)?this._texture.copyFrom({source:this._videoElement}):(this._createTexture(t),this._textureSize.x=this._texture.width,this._textureSize.y=this._texture.height,this._videoReadyPromise.resolve(this))),!!Cesium.defined(this._texture))){this._cameraDirty&&(this._createProjectionCamera(),this._cameraDirty=!1),this._updateProjectionCameraViewMatrix();for(let n=0;n<this._planes.length;++n)this._planes[n].update(e)}};ze.prototype._checkVideoCameraAngle=function(){if(!this.videoCamera)return;let e=Cesium.Cartesian3.angleBetween(this._viewer.camera.directionWC,this.videoCamera.directionWC);e=Cesium.Math.toDegrees(e),e>this._videoVisiableAngle+this._videoGradientAngle?this.videoAlphaRate=0:e<this._videoVisiableAngle?this.videoAlphaRate=1:this.videoAlphaRate=1-(e-this._videoVisiableAngle)/this._videoGradientAngle};ze.prototype._createProjectionPlanes=function(e){for(let t=0;t<e.length;++t){let n=new In({owner:this,plane:e[t]});this._planes.push(n)}};ze.prototype._createProjectionPlane=function(e){let t=new In({owner:this,plane:e});return this._planes.push(t),t};ze.prototype._createRenderState=function(){this._renderState=Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:this._backCull,face:Cesium.CullFace.BACK},depthTest:{enabled:!0}})};ze.prototype._updateProjectionCameraViewMatrix=function(){if(!!this.videoCamera)return Cesium.Matrix4.multiply(this.videoCamera.viewMatrix,this._viewer.scene.camera.inverseViewMatrix,this._projectionCameraViewMatrix)};ze.prototype.getProjectionCameraViewMatrix=function(){return this._projectionCameraViewMatrix};ze.prototype._createVertexShaderSource=function(){let e=`attribute vec3 position;
varying vec3 v_positionEC;
void main()
{
    gl_Position = czm_modelViewProjection * vec4(position, 1.0);
    v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;
}
`;this._v=new Cesium.ShaderSource({sources:[e]})};ze.prototype._createFragmentShaderSource=function(){let e=`uniform float u_leftClip;
uniform float u_rightClip;
uniform vec4 u_topClipLine1;
uniform vec4 u_topClipLine2;
uniform vec4 u_topClipLine3;
uniform vec4 u_topClipLine4;
uniform vec4 u_bottomClipLine1;
uniform vec4 u_bottomClipLine2;
uniform vec4 u_bottomClipLine3;
uniform vec4 u_bottomClipLine4;
uniform float u_alpha;
uniform vec3 u_hsv;
uniform mat4 u_projectionCameraViewMatrix;
uniform mat4 u_projectionCameraProjectionMatrix;
uniform sampler2D u_texture;
uniform float k1;
uniform float k2;
uniform vec2 textureSize;
varying vec3 v_positionEC;
uniform vec4 u_pickColor;
vec3 rgb2hsv(vec3 c)
{
    vec4 K = vec4(0.0, -1.0/3.0, 2.0/3.0, -1.0);
    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));
    float d = q.x - min(q.w, q.y);
    float e = 1.0e-10;
    return vec3(abs(q.z + (q.w - q.y)/(6.0*d+e)), d/(q.x + e), q.x);
}

vec3 hsv2rgb(vec3 c)
{
    vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

void main()
{
    vec4 pixelCoord = u_projectionCameraProjectionMatrix * u_projectionCameraViewMatrix * vec4(v_positionEC, 1.0);
    pixelCoord = pixelCoord / pixelCoord.w;
    vec2 texCoord = vec2(0.5, 0.5) + pixelCoord.xy * 0.5;
    float maxWidthHeight = textureSize.x;
    float percent = textureSize.y / textureSize.x;
    vec2 centerUV = vec2((textureSize.x / 2.0) / maxWidthHeight, (textureSize.y / 2.0) / maxWidthHeight);
    vec2 currentUV = vec2(texCoord.x, texCoord.y * percent);
    float length_2 = (currentUV.x - centerUV.x) * (currentUV.x - centerUV.x) + (currentUV.y - centerUV.y) * (currentUV.y - centerUV.y);
    float length_4 = length_2 * length_2;
    texCoord.x = (currentUV.x - centerUV.x) / (k1 * length_2 + k2 * length_4 + 1.0) + centerUV.x;
    texCoord.y = (currentUV.y - centerUV.y) / (k1 * length_2 + k2 * length_4 + 1.0) + centerUV.y;
    texCoord.y = texCoord.y / percent;
    if(texCoord.x < u_leftClip)
    {
       discard;
    }
    if(texCoord.x > u_rightClip)
    {
       discard;
    }
    float kTop1 = (u_topClipLine1.w - u_topClipLine1.y) / (u_topClipLine1.z - u_topClipLine1.x);
    float aTop1 = -1.0 * kTop1;
    float bTop1 = 1.0;
    float cTop1 = kTop1 * u_topClipLine1.x - u_topClipLine1.y;
    float rTop1 = dot(vec3(aTop1, bTop1, cTop1), vec3(texCoord, 1.0));
    if(rTop1 > 0.0)
    {
       discard;
    }
    float kTop2 = (u_topClipLine2.w - u_topClipLine2.y) / (u_topClipLine2.z - u_topClipLine2.x);
    float aTop2 = -1.0 * kTop2;
    float bTop2 = 1.0;
    float cTop2 = kTop2 * u_topClipLine2.x - u_topClipLine2.y;
    float rTop2 = dot(vec3(aTop2, bTop2, cTop2), vec3(texCoord, 1.0));
    if(rTop2 > 0.0)
    {
       discard;
    }
    float kTop3 = (u_topClipLine3.w - u_topClipLine3.y) / (u_topClipLine3.z - u_topClipLine3.x);
    float aTop3 = -1.0 * kTop3;
    float bTop3 = 1.0;
    float cTop3 = kTop3 * u_topClipLine3.x - u_topClipLine3.y;
    float rTop3 = dot(vec3(aTop3, bTop3, cTop3), vec3(texCoord, 1.0));
    if(rTop3 > 0.0)
    {
       discard;
    }
    float kTop4 = (u_topClipLine4.w - u_topClipLine4.y) / (u_topClipLine4.z - u_topClipLine4.x);
    float aTop4 = -1.0 * kTop4;
    float bTop4 = 1.0;
    float cTop4 = kTop4 * u_topClipLine4.x - u_topClipLine4.y;
    float rTop4 = dot(vec3(aTop4, bTop4, cTop4), vec3(texCoord, 1.0));
    if(rTop4 > 0.0)
    {
       discard;
    }
    float kBottom1 = (u_bottomClipLine1.w - u_bottomClipLine1.y) / (u_bottomClipLine1.z - u_bottomClipLine1.x);
    float aBottom1 = -1.0 * kBottom1;
    float bBottom1 = 1.0;
    float cBottom1 = kBottom1 * u_bottomClipLine1.x - u_bottomClipLine1.y;
    float rBottom1 = dot(vec3(aBottom1, bBottom1, cBottom1), vec3(texCoord, 1.0));
    if(rBottom1 < 0.0)
    {
       discard;
    }
    float kBottom2 = (u_bottomClipLine2.w - u_bottomClipLine2.y) / (u_bottomClipLine2.z - u_bottomClipLine2.x);
    float aBottom2 = -1.0 * kBottom2;
    float bBottom2 = 1.0;
    float cBottom2 = kBottom2 * u_bottomClipLine2.x - u_bottomClipLine2.y;
    float rBottom2 = dot(vec3(aBottom2, bBottom2, cBottom2), vec3(texCoord, 1.0));
    if(rBottom2 < 0.0)
    {
       discard;
    }
    float kBottom3 = (u_bottomClipLine3.w - u_bottomClipLine3.y) / (u_bottomClipLine3.z - u_bottomClipLine3.x);
    float aBottom3 = -1.0 * kBottom3;
    float bBottom3 = 1.0;
    float cBottom3 = kBottom3 * u_bottomClipLine3.x - u_bottomClipLine3.y;
    float rBottom3 = dot(vec3(aBottom3, bBottom3, cBottom3), vec3(texCoord, 1.0));
    if(rBottom3 < 0.0)
    {
       discard;
    }
    float kBottom4 = (u_bottomClipLine4.w - u_bottomClipLine4.y) / (u_bottomClipLine4.z - u_bottomClipLine4.x);
    float aBottom4 = -1.0 * kBottom4;
    float bBottom4 = 1.0;
    float cBottom4 = kBottom4 * u_bottomClipLine4.x - u_bottomClipLine4.y;
    float rBottom4 = dot(vec3(aBottom4, bBottom4, cBottom4), vec3(texCoord, 1.0));
    if(rBottom4 < 0.0)
    {
       discard;
    }
    vec4 color = texture2D(u_texture, texCoord);
    vec3 rgb = color.xyz;
    vec3 hsv = rgb2hsv(rgb);
    hsv += u_hsv;
    rgb = hsv2rgb(hsv);
    rgb = clamp(rgb, 0.0, 1.0);
    color.xyz = rgb;
    color.a = u_alpha;
    gl_FragColor = color;
}
`;this._f=new Cesium.ShaderSource({sources:[e]})};ze.prototype._createTexture=function(e){this._texture=new Cesium.Texture({context:e,source:this._videoElement,sampler:new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})})};ze.prototype.updateParameter=function(e){Cesium.defined(e.originLon)&&(this._originLon=e.originLon),Cesium.defined(e.originLat)&&(this._originLat=e.originLat),Cesium.defined(e.originHeight)&&(this._originHeight=e.originHeight),Cesium.defined(e.pitch)&&(this._pitch=e.pitch),Cesium.defined(e.heading)&&(this._heading=e.heading),Cesium.defined(e.roll)&&(this._roll=e.roll),Cesium.defined(e.fov)&&(this._fov=e.fov),Cesium.defined(e.hsvParam)&&(this.videoHsv=e.hsvParam),Cesium.defined(e.distortion)&&(this._distortion=e.distortion),Cesium.defined(e.alpha)&&(this._alpha=e.alpha),Cesium.defined(e.lineEnabled)&&(this._lineEnabled=e.lineEnabled),this._cameraDirty=!0};ze.prototype.setDistortion=function(e){this._distortion=e};ze.prototype.setCameraFov=function(e){this._fov=e,this.videoCamera&&(this.videoCamera.frustum.fov=Cesium.Math.toRadians(e))};ze.prototype._createProjectionCamera=function(){if(!this._texture)return;this.videoCamera||(this.videoCamera=new Cesium.Camera(this._viewer.scene));let e=this.videoCamera.frustum;e.fov=Cesium.Math.toRadians(this._fov),e.aspectRatio=this._aspectRatio=this._texture._width/this._texture._height,e.near=.01,e.far=1e3,e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2,e.top=e.near*Math.tan(.5*e._fovy),e.bottom=-e.top,e.right=e.aspectRatio*e.top,e.left=-e.right;let t=Cesium.Cartesian3.fromDegrees(this._originLon,this._originLat,this._originHeight);this.videoCamera.setView({destination:t,orientation:{heading:Cesium.Math.toRadians(this._heading),pitch:Cesium.Math.toRadians(this._pitch),roll:Cesium.Math.toRadians(this._roll)}}),this._adjustModeEnabled&&(this._viewer.scene.camera.setView({destination:t,orientation:{heading:Cesium.Math.toRadians(this._heading),pitch:Cesium.Math.toRadians(this._pitch),roll:Cesium.Math.toRadians(this._roll)}}),this._viewer.scene.camera.frustum.fov=Cesium.Math.toRadians(this._fov),this._viewer.scene.camera.frustum.aspectRatio=this._aspectRatio),this._cameraPromise.resolve(this.videoCamera)};ze.prototype.setVideoCameraPosition=function(e,t){let n=this.videoCamera;if(!n)return;let o=Cesium.Cartesian3.subtract(this._viewPoint,e,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(o,o);let i=n.roll;n.setView({destination:e,orientation:{direction:o,up:n.up}}),n.setView({orientation:{heading:n.heading,pitch:n.pitch,roll:i}});let r=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(e);this._originLon=Cesium.Math.toDegrees(r.longitude),this._originLat=Cesium.Math.toDegrees(r.latitude),this._originHeight=r.height,this._videoCameraPos=e,this._videoCameraPostureChanged=!0,Cesium.defaultValue(t,!0)&&this._changed.raiseEvent()};ze.prototype.setCameraViewPoint=function(e,t){if(this._viewPoint=e,!this.videoCamera)return;let n=this.videoCamera,o=n.roll,i=Cesium.Cartesian3.subtract(e,n.positionWC,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(i,i),n.setView({orientation:{direction:i,up:n.upWC}}),n.setView({orientation:{heading:n.heading,pitch:n.pitch,roll:o}}),this._heading=Cesium.Math.toDegrees(n.heading),this._pitch=Cesium.Math.toDegrees(n.pitch),this._roll=Cesium.Math.toDegrees(n.roll),this._videoCameraPostureChanged=!0,Cesium.defaultValue(t,!0)&&this._changed.raiseEvent()};ze.prototype.enterAdjustMode=function(){if(this._adjustModeEnabled)return;this._adjustModeEnabled=!0;let e=this._viewer.scene.camera;this._oldHeading=e.heading,this._oldPitch=e.pitch,this._oldRoll=e.roll,this._oldFov=e.frustum.fov,this._oldAspectRatio=e.frustum.aspectRatio,this._oldCameraPosition=e.positionWC.clone(),this.updateParameter({})};ze.prototype.exitAdjustMode=function(){if(!this._adjustModeEnabled)return;this._adjustModeEnabled=!1;let e=this._viewer.scene.camera;e.setView({destination:this._oldCameraPosition,orientation:{heading:this._oldHeading,pitch:this._oldPitch,roll:this._oldRoll}}),e.frustum.fov=this._oldFov,e.frustum.aspectRatio=this._oldAspectRatio};ze.videoStatus=void 0;ze.prototype.removeLines=function(){if(!!this._lineEnabled){for(let e=0;e<this._lines.length;e++)this._viewer.entities.remove(this._lines[e]);this._lines.length=0}};ze.prototype.addLines=function(e){if(!this._lineEnabled||e.length===0)return;let t,n=new Cesium.Cartesian3;for(let o=0;o<e.length;o++)n.x=n.x+e[o].x,n.y=n.y+e[o].y,n.z=n.z+e[o].z,o!==e.length-1?t=this._viewer.entities.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights([e[o].x,e[o].y,e[o].z,e[o+1].x,e[o+1].y,e[o+1].z]),width:1,material:Cesium.Color.BLUE,arcType:Cesium.ArcType.NONE}}):t=this._viewer.entities.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights([e[o].x,e[o].y,e[o].z,e[0].x,e[0].y,e[0].z]),width:1,material:Cesium.Color.BLUE,arcType:Cesium.ArcType.NONE}}),this._lines.push(t);n.x=n.x/e.length,n.y=n.y/e.length,n.z=n.z/e.length,t=this._viewer.entities.add({polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights([n.x,n.y,n.z,this._originLon,this._originLat,this._originHeight]),width:1,material:Cesium.Color.RED,arcType:Cesium.ArcType.NONE}}),this._lines.push(t)};ze.prototype.incompatibleConsole=function(){let e=this;this._viewer.scene.renderError.addEventListener(function(){e._videoElement.paused||e._videoElement.pause(),e._viewer.cesiumWidget._showRenderLoopErrors&&e._viewer.cesiumWidget.showErrorPanel("This browser does not support cross-origin WebGL video textures.","","")})};ze.prototype.getConfiguration=function(){let e={},t=this._wsplayer;t?t.mSipID?e.gb=t.mSipID:t.mRtspurl&&(e.url=t.mRtspurl):e.file=this._fileName,e.alpha=this.videoAlpha,e.distortion=[this._distortion.x,this._distortion.y],e.hsv=[this.videoHsv.x,this.videoHsv.y,this.videoHsv.z];let n={position:[this._originLon,this._originLat,this._originHeight],orientation:[this._heading,this._pitch,this._roll],fov:Number(this._fov.toFixed(1))};if(this._viewPoint){let i=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(this._viewPoint);i&&(n.visitPoint=[Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(i.latitude),i.height])}let o=[];for(let i=0;i<this._planes.length;++i){let r=this._planes[i].getConfiguration();r&&o.push(r)}return{name:this._name,type:this._projectionMode,visibleDistance:this._visibleDistance,video:e,camera:n,projection:o}};ze.prototype._computeBoundingSphere=function(){let e=[];for(let t=0;t<this._planes.length;++t){let n=this._planes[t]._originalPoints;for(let o=0;o<n.length;++o)e.push(n[o])}this.boundingSphere=Cesium.BoundingSphere.fromPoints(e,this.boundingSphere)};ze.prototype.destroy=function(){if(this._scene._hdr=this._hdr,this.removeLines(),this._viewer.scene.primitives.contains(this)){let e=this._viewer.scene.primitives._primitives.indexOf(this);e!==-1&&(this._viewer.scene.primitives._primitives.splice(e,1),delete this._external._composites[this._viewer.scene.primitives._guid])}for(let e=0;e<this._planes.length;e++)this._planes[e].destroy();this._planes.length=0,this._texture&&(this._texture.destroy(),this._texture=void 0),this._synchronizer&&(this._synchronizer.destroy(),this._synchronizer=void 0),this._wsplayer&&(this._wsplayer.stop(),this._wsplayer=null)};var yo=ze;function $(e){this.wsserverurl=e.wsserver,this.mRtspurl=e.rtspurl,this.layer=e.layer,this.mMediaplayer=e.mediaplayer,this.websocket=void 0,this.ByteArray(),this.needRecv=!0,this.mimestr=void 0,this.mediaReady=!1,this.sourceReady=!1,this.wsConnected=!1,this.mediaSource=void 0,this.playMode="",this.elementPaused=!1,this.mforwardAddress=void 0,this.needFast=!1,this.faultTime=2,this.startTime=void 0,this.stopTime=void 0,this.lastCurrentTime=0,this.sameTimes=0,this.supportstr=void 0,this.mCanvas=void 0,this.mMouseBind=!1,this.mSipID=void 0,this.sourceBuffer=void 0,this.cacheTime=4,this.socketConnect=!1,this.isMainStream=e.isMainStream,this.protocol=e.protocol,this.ptzType=e.ptzType?e.ptzType:"Degree",this.curPan=e.pan?e.pan:0,this.curTilt=e.tilt?e.tilt:0,this.curZoom=e.zoom?e.zoom:1,this.panMin=0,this.panMax=0,this.tiltMin=0,this.tiltMax=0,this.zoomMin=1,this.zoomMax=1,this.updataCount=25,this.NeedUpdateVideo=!0,this.showLastFrame=!1,this.userQuit=!1,this.mMediaplayer&&(this.mMediaplayer.addEventListener("canplay",this.onCanPlay.bind(this)),this.mMediaplayer.addEventListener("pause",this.onPause.bind(this)),this.mMediaplayer.addEventListener("error",this.onPlayError.bind(this))),document.addEventListener("webkitvisibilitychange",function(t){t.target.webkitHidden||this.onCanPlay()}.bind(this),!1)}var qo=0;$.prototype.openws=function(){if(this.mRtspurl!==""&&this.mMediaplayer&&this.mRtspurl.indexOf("rtsp")===-1&&this.mRtspurl.indexOf("rtmp")===-1&&this.mRtspurl.indexOf("http")===-1){this.mMediaplayer.src=this.mRtspurl,this.mMediaplayer.type="video/mp4";return}this.socketConnect||(qo>16&&console.warn(`Too many video connections\uFF1A${qo}`),this.socketConnect=!0,this.needRecv=!0,this.websocket=new WebSocket(this.wsserverurl),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this),qo++)};$.prototype.updateVideo=function(){this.NeedUpdateVideo=!0,this.updataCount=10};$.prototype.setCacheTime=function(e){if(e<=0||e>=50){console.log("the cache value is invalid. must 0<v<50");return}this.cacheTime=e};$.prototype.onWsConnectReslut=function(e){};$.prototype.onAlarm=function(e){};$.prototype.onVideoReady=function(){};$.prototype.onVideoClosed=function(e){};$.prototype.onHistoryTracks=function(e){};$.prototype.onLastestTracks=function(e){};$.prototype.onIdentify=function(e){};$.prototype.onDeviceMessage=function(e){};$.prototype.onGBDeviceList=function(e){};$.prototype.onMousePosition=function(e){};$.prototype.onPerformance=function(e){};$.prototype.onRender=function(e){};$.prototype.onPtzInfo=function(e,t,n){};$.prototype.reConnect=function(){this.socketConnect=!1,this.onWsConnectReslut("CLOSED"),this.userQuit?(this.stop(),this.wsConnected=!1):(qo--,this.wsConnected=!1,this.websocket=void 0,this.openws())};$.prototype.onError=function(e){this.onWsConnectReslut("ERROR"),this.websocket.close()};$.prototype.onOpen=function(e){console.log("socket open"),this.wsConnected=!0,this.onWsConnectReslut("SUCCESS"),this.retry()};$.prototype.onClose=function(e){console.log("socket close"),this.reConnect()};$.prototype.doSend=function(e){if(!(!this.wsConnected||this.websocket===void 0||!this.socketConnect))if(this.websocket.binaryType="arraybuffer",this.websocket.readyState===WebSocket.OPEN)this.websocket.send(JSON.stringify(e));else{let t=this;setTimeout(function(){t.doSend(e)},2e3)}};$.prototype.onMessage=function(e){if(typeof e.data=="string"){let t=e.data,n=JSON.parse(t);n.messageType==="AVC_INFO"?(this.mimestr=n.data,this.needRecv=!0,this.initMediaSource(this.mimestr)):n.messageType==="DEVICE_MESSAGE"?this.onDeviceMessage(n.data):n.messageType==="PTZ"?this.layer&&this.layer.ev_VideoProjectionManager&&this.layer.ev_VideoProjectionManager.updateVideoCamera(this.mMediaplayer.id,n.pan,n.tilt,n.zoom):n.messageType==="HISTORY_TRACKS"?this.onHistoryTracks(n.data):n.messageType==="LASTEST_TRACKS"?this.onLastestTracks(n.data):n.messageType==="INDENTIFY"?this.onIdentify(n.data):n.messageType==="GB_DEVICE_LIST"?this.onGBDeviceList(n.data):n.messageType==="ALARM"?this.onAlarm(n.data):n.messageType==="MOUSE_POSITION"?this.onMousePosition(n.data):n.messageType==="SERVER_PERFORMANCE"?this.onPerformance(n.data):n.messageType==="PTZ_INFO"&&(this.curPan=n.pan,this.curTilt=n.tilt,this.curZoom=n.zoom,n.panMax!==void 0&&n.tiltMax!==void 0&&(this.panMin=n.panMin,this.panMax=n.panMax,this.tiltMin=n.tiltMin,this.tiltMax=n.tiltMax,this.zoomMin=n.zoomMin,this.zoomMax=n.zoomMax),this.onPtzInfo(n.pan,n.tilt,n.zoom),this.panMax<=1&&(this.ptzType="Unit"),this.layer&&this.layer.ev_VideoProjectionManager&&this.layer.ev_VideoProjectionManager.updateVideoCamera(this.mMediaplayer.id,this.curPan,this.curTilt,this.curZoom)),t=null}else if(this.needRecv&&!(this.mediaReady&&!this.NeedUpdateVideo)){let t=new Uint8Array(e.data);this.push(t),t=null,this.loadvideo(),this.onRender(),this.mediaReady&&(this.updataCount--,this.updataCount<0&&(this.NeedUpdateVideo=!1,this.updataCount=0))}e=null};$.prototype.sendConnectType=function(e){this.doSend({messageType:"CONNECT_TYPE",connect_type:e,client_type:"WEB"})};$.prototype.sendDeviceInfo=function(){let e={messageType:"ADDRESS",url:this.mRtspurl};this.isMainStream!==void 0&&(e.isMainStream=this.isMainStream),this.protocol!==void 0&&(e.protocol=this.protocol),this.doSend(e)};$.prototype.play=function(){if(this.playMode="PLAY_REAL",this.mRtspurl===""||this.mRtspurl===null){console.log(`mRtspurl: ${this.mRtspurl}  is illegal!`);return}this.sendConnectType("VIDEO"),this.sendDeviceInfo(),this.playReal()};$.prototype.playForward=function(e){this.mforwardAddress=e,this.playMode="PLAY_FORWARD",this.sendConnectType("FORWARD"),this.doSend({messageType:"FORWARD_ADDRESS",forward_address:this.mforwardAddress,url:this.mRtspurl})};$.prototype.playGlobe=function(){this.playMode="GLOBE_FUSION",this.sendConnectType("GLOBE")};$.prototype.playGB=function(){this.playMode="GB",this.sendConnectType("GB")};$.prototype.getGBDeviceList=function(){this.doSend({messageType:"GET_GB_DEVICE_LIST"})};$.prototype.playGBDevice=function(e){this.mSipID=e,this.doSend({messageType:"PLAY_GB_VIDEO",sipID:e})};$.prototype.stopPlayGBDevice=function(e){this.mSipID=void 0,this.doSend({messageType:"STOP_PLAY_GB_VIDEO",sipID:e})};$.prototype.redirectUrl=function(e){this.mimestr!==void 0&&(this.mediaSource&&this.mediaSource.readyState==="open"&&(this.mediaSource.removeSourceBuffer(this.sourceBuffer),this.mediaSource.endOfStream(),this.mediaSource.removeEventListener("sourceopen",this.onMediaSourceOpen)),URL.revokeObjectURL(this.mMediaplayer.src),this.mMediaplayer.src=void 0,this.mediaSource=void 0,this.sourceBuffer=void 0,this.sourceReady=!1,this.mimestr=void 0,this.mediaReady=!1),this.playMode==="GB"?(this.playGB(),this.playGBDevice(e)):(this.mRtspurl=e,this.play()),this.doSend({messageType:"SOURCE_READY"})};$.prototype.queryPerformance=function(){this.doSend({messageType:"QUERY_PERFORMANCE"})};$.prototype.keepLastFrame=function(e){this.showLastFrame=e};$.prototype.initMediaSource=function(e){this.mediaSource===void 0&&(this.mimestr=e,this.supportstr=`video/mp4; codecs="${this.mimestr}"`,console.log("recv decode format:",this.supportstr),MediaSource.isTypeSupported(this.supportstr)||(console.log(`${this.supportstr} is unsupported MIME type or codec,please check the video data`),this.mimestr="avc1.64002a",this.supportstr=`video/mp4; codecs="${this.mimestr}"`,console.log(`try to use the default:${this.supportstr}`)),this.mediaSource=new MediaSource,this.mediaSource.addEventListener("sourceopen",this.onMediaSourceOpen.bind(this),!1),this.mediaSource.addEventListener("sourceclose",this.onSourceClose.bind(this),!1),this.mediaSource.addEventListener("sourceended",this.onSourceEnded.bind(this),!1),this.mMediaplayer.src=URL.createObjectURL(this.mediaSource),this.sourceReady=!1,this.needRecv=!0)};$.prototype.onSourceClose=function(e){this.onVideoClosed(e)};$.prototype.onSourceEnded=function(e){};$.prototype.onPlayError=function(e){this.sourceReady=!1,this.retry()};$.prototype.retry=function(){!this.needRecv||!this.wsConnected||!this.mMediaplayer||(console.log(`retry ${this.mSipID} ${this.mRtspurl}`),this.releaseElementSource(),this.ByteArray(),this.playMode==="PLAY_REAL"?this.play():this.playMode==="PLAYBACK"||this.playMode==="START_PLAYBACK_RETRY"?(this.sendConnectType("VIDEO"),this.sendDeviceInfo(),this.startPlayBackByTime(this.startTime,this.stopTime)):this.playMode==="GLOBE_FUSION"?this.playGlobe():this.playMode==="GB"?(this.playGB(),this.mSipID===void 0?this.getGBDeviceList():this.playGBDevice(this.mSipID)):this.playMode==="PLAY_FORWARD"?this.playForward(this.mforwardAddress):this.playMode===""?this.mRtspurl!==""&&this.mRtspurl!==null&&this.play():this.stopPlay())};$.prototype.onCanPlay=function(){this.elementPaused&&(this.elementPaused=!1)};$.prototype.onSeeked=function(){console.log("onSeeked")};$.prototype.onPause=function(){this.elementPaused||(this.elementPaused=!0,this.mediaReady),this.mediaReady&&this.mMediaplayer.play()};$.prototype.onMediaSourceOpen=function(e){this.mediaSource!==void 0&&(this.mediaSource.removeEventListener("sourceopen",this.onMediaSourceOpen),this.sourceBuffer===void 0&&(this.sourceBuffer=this.mediaSource.addSourceBuffer(this.supportstr),this.sourceBuffer.addEventListener("updateend",this.onUpdateEnd.bind(this),!1),this.sourceBuffer.addEventListener("abort",this.onSourceBufferAbort.bind(this),!1),this.sourceBuffer.addEventListener("error",this.onSourceBufferError.bind(this),!1),this.sourceReady=!0,this.mediaReady=!1,this.doSend({messageType:"SOURCE_READY"})))};$.prototype.onSourceBufferError=function(e){this.sourceReady=!1};$.prototype.onSourceBufferAbort=function(e){this.sourceReady=!1};$.prototype.onUpdateEnd=function(e){if(!!this.needRecv&&(this.mMediaplayer.readyState===4&&this.sourceBuffer&&!this.sourceBuffer.updating&&!this.mediaReady&&(this.onVideoReady(),console.log("start draw video"),this.mediaSource.endOfStream(),this.mMediaplayer.play(),this.mediaReady=!0,this.getPTZInfo()),this.mediaReady)){let t=this.mMediaplayer.duration-this.mMediaplayer.currentTime;if(t>this.faultTime&&(this.needFast=!0),this.needFast&&(this.mMediaplayer.playbackRate=1.2),t<.5&&this.needFast&&(this.needFast=!1,this.mMediaplayer.playbackRate=1),this.lastCurrentTime===this.mMediaplayer.currentTime){if(this.sameTimes>=30){let n=this.mMediaplayer.duration-2;n>this.mMediaplayer.currentTime&&(this.mMediaplayer.currentTime=n,this.mMediaplayer.playbackRate=1),this.sameTimes=0}this.sameTimes++}else this.lastCurrentTime=this.mMediaplayer.currentTime,this.sameTimes=0}};$.prototype.releaseElementSource=function(){this.needRecv=!1,this.ByteArray(),this.mediaReady=!1,this.sourceReady=!1,this.elementPaused=!1,this.updataCount=10,this.NeedUpdateVideo=!0,this.sourceBuffer&&this.mediaSource.readyState==="open"&&this.sourceBuffer.abort(),this.sourceBuffer&&(this.sourceBuffer.removeEventListener("updateend",this.onUpdateEnd),this.sourceBuffer.removeEventListener("abort",this.onSourceBufferAbort),this.sourceBuffer.removeEventListener("error",this.onSourceBufferError),this.mediaSource&&this.mediaSource.readyState==="open"&&this.mediaSource.removeSourceBuffer(this.sourceBuffer)),this.mediaSource&&(this.mediaSource.removeEventListener("sourceopen",this.onMediaSourceOpen),this.mediaSource.removeEventListener("sourceclose",this.onSourceClose),this.mediaSource.removeEventListener("sourceended",this.onSourceEnded)),this.mediaSource=void 0,this.sourceBuffer=void 0,this.mMediaplayer&&this.mMediaplayer.src&&(URL.revokeObjectURL(this.mMediaplayer.src),this.mMediaplayer.removeAttribute("src"),this.showLastFrame||this.mMediaplayer.load())};$.prototype.stop=function(){this.userQuit=!0,this.wsConnected&&(console.log(`stop ${this.mSipID} ${this.mRtspurl}`),this.needRecv=!1,this.ByteArray(),this.mediaReady=!1,this.sourceReady=!1,this.elementPaused=!1,this.updataCount=10,this.NeedUpdateVideo=!0,this.mCanvas&&(this.clearDrawing(),this.mCanvas=void 0),this.websocket&&(this.stopPlay(),this.websocket.close(),this.websocket=void 0,this.socketConnect=!1,this.wsConnected=!1),this.releaseElementSource(),qo--)};$.prototype.loadvideo=function(){if(this.length===0||!this.sourceReady||this.sourceBuffer===void 0)return!1;let e=null;try{if(!this.sourceBuffer.updating&&this.sourceBuffer.buffered!==void 0)return this.sourceBuffer.buffered.length&&this.sourceBuffer.buffered.end(0)-this.sourceBuffer.buffered.start(0)>1*this.cacheTime*2?(this.sourceBuffer.remove(0,this.sourceBuffer.buffered.end(0)-this.cacheTime),e=null,!1):(e=new Uint8Array(this.length),this.readBytes(e)&&this.sourceBuffer.appendBuffer(e),this.ByteArray(),e=null,!0)}catch(t){console.log(t),this.ByteArray(),e=null,this.sourceBuffer.remove(0,this.sourceBuffer.buffered.end(0)),this.retry()}return e=null,!1};$.prototype.ByteArray=function(){this.list=[],this.length=0};$.prototype.push=function(e){this.list.push(e),this.length+=e.length};$.prototype.readBytes=function(e){let t=e.length;if(e.length<=0)return!1;let n=0;for(;n<t;){if(this.list.length<=0){e=e.subarray(0,n);break}let o=this.list.shift(),i=o.length,r=t-n;if(i>=r){let s=o.subarray(0,r);if(e.set(s,n),n+=s.length,r<i){let a=o.subarray(r,i);this.list.unshift(a)}s=null,o=null;break}else e.set(o,n),n+=i;o=null}return this.length-=e.length,n!==0};$.prototype.canvasSwitch=function(e){e===!0?this.mCanvas===void 0&&(this.mCanvas=document.createElement("canvas"),this.mCanvas.width=this.mMediaplayer.clientWidth,this.mCanvas.height=this.mMediaplayer.clientHeight,this.mCanvas.style.position="absolute",this.mMediaplayer.style.position==="absolute"||(this.mCanvas.style.left="0",this.mCanvas.style.top="0",this.mCanvas.style.bottom="0",this.mCanvas.style.right="0"),this.mCanvas.style.zIndex=2,this.mMediaplayer.parentNode.appendChild(this.mCanvas),this.mMouseBind&&this.bindMouse(this.mMouseBind)):(this.mCanvas&&this.clearDrawing(),this.mCanvas=void 0)};$.prototype.drawIdentifyMsg=function(e){if(this.mCanvas===void 0)return;let t=this.mCanvas.getContext("2d");t.clearRect(0,0,this.mCanvas.width,this.mCanvas.height);let n=this.mCanvas.width/this.mMediaplayer.videoWidth,o=this.mCanvas.height/this.mMediaplayer.videoHeight;for(let i=0;i<e.length;i++){let r=e[i];t.strokeStyle="red",t.lineWidth=2,t.strokeRect(r.boundingRect[0]*n,r.boundingRect[1]*o,r.boundingRect[2]*n,r.boundingRect[3]*o),t.fillStyle="yellow",t.fillRect(r.boundingRect[0]*n,(r.boundingRect[1]-27)*o,120*n,25*o),t.fillStyle="black",t.font="bold 15px arial",t.fillText(`${r.trackId}:${r.name}`,r.boundingRect[0]*n,(r.boundingRect[1]-5)*o)}};$.prototype.drawHistoryTracks=function(e){if(this.mCanvas===void 0)return;let t=this.mCanvas.getContext("2d");t.fillStyle="blue";let n=this.mCanvas.width/this.mMediaplayer.videoWidth,o=this.mCanvas.height/this.mMediaplayer.videoHeight;for(let i=0;i<e.length;i++){let r=e[i].tracks;for(let s=0;s<r.length;s++){let a=r[s];t.beginPath(),t.arc(a[0]*n,a[1]*o,2,0,6.28),t.fill()}}};$.prototype.clearDrawing=function(){if(this.mCanvas===void 0)return;this.mCanvas.getContext("2d").clearRect(0,0,this.mCanvas.width,this.mCanvas.height),console.log("clear drawing")};$.prototype.detect=function(e){this.canvasSwitch(e),this.doSend({messageType:"IDENTIFY",action:"SWITCH",data:e}),this.clearDrawing()};$.prototype.setIdentifyTarget=function(e){this.doSend({messageType:"IDENTIFY",action:"IDENTIFY_TARGET",data:e})};$.prototype.setTrackRect=function(e,t,n,o,i){this.doSend({messageType:"IDENTIFY",action:"IDENTIFY_TRACKS",btrackall:e,rectX:t,rectY:n,rectW:o,rectH:i})};$.prototype.setModePara=function(e,t,n){this.doSend({messageType:"IDENTIFY",action:"MODEPARA",detectMode:e,confidenceThreshold:t,nmsThreshold:n})};$.prototype.set3DTrakMode=function(e){this.doSend({messageType:"IDENTIFY",action:"3DTRAKMODE",data:e})};$.prototype.setShow3dTrack=function(e){this.doSend({messageType:"IDENTIFY",action:"SHOW3DTRACK",data:e})};$.prototype.setShow2dTrack=function(e){this.doSend({messageType:"IDENTIFY",action:"SHOW2DTRACK",data:e})};$.prototype.globeGoto=function(e,t){this.doSend({messageType:"GOTO",longitude:e,latitude:t})};$.prototype.globeGotoCameras=function(e){this.doSend({messageType:"GOTO",cameraNames:e})};$.prototype.playReal=function(){this.playMode="PLAY_REAL",this.doSend({messageType:"PLAY_REAL"})};$.prototype.findfile=function(e,t){this.playMode="FIND_FILE",this.doSend({messageType:"FIND_FILE",startTime:e,stopTime:t})};$.prototype.startPlayBackByTime=function(e,t){this.playMode="PLAYBACK",this.startTime=e,this.stopTime=t,this.doSend({messageType:"PLAYBACK",startTime:e,stopTime:t}),this.mMediaplayer&&this.mediaReady&&(this.mMediaplayer.currentTime=this.mMediaplayer.duration,this.mMediaplayer.play(),this.recoverWS())};$.prototype.startPlayBackRetry=function(){this.playMode="START_PLAYBACK_RETRY",this.doSend({messageType:this.playMode})};$.prototype.playBackFast=function(){this.doSend({messageType:"PLAYBACK_FAST"})};$.prototype.playBackSlow=function(){this.doSend({messageType:"PLAYBACK_SLOW"})};$.prototype.playBackNormal=function(){this.doSend({messageType:"PLAYBACK_NORMAL"})};$.prototype.playBackPause=function(){this.doSend({messageType:"PLAYBACK_PAUSE"}),this.mMediaplayer&&this.mMediaplayer.pause()};$.prototype.playBackReStart=function(){this.doSend({messageType:"PLAYBACK_RESTART"}),this.mMediaplayer&&(this.mMediaplayer.play(),this.recoverWS())};$.prototype.pauseWS=function(){this.doSend({messageType:"PAUSE_SOCKET"})};$.prototype.recoverWS=function(){this.doSend({messageType:"RECOVER_SOCKET"})};$.prototype.stopPlay=function(){this.doSend({messageType:"STOP"})};$.prototype.controlPTZ=function(e,t,n){this.doSend({messageType:"PTZ_CONTROL",command:e,bStop:t,speed:n})};$.prototype.setPTZPosition=function(e,t,n){e=Number(e),t=Number(t),n=Number(n),this.doSend({messageType:"SET_PTZ_POSITION",pan:e,tilt:t,zoom:n})};$.prototype.getPTZInfo=function(){this.doSend({messageType:"GET_PTZ_INFO"})};$.prototype.getGBDeivceList=function(){};$.prototype.useAlarm=function(e){this.doSend({messageType:"SET_ALARM",use:e})};$.prototype.controlGateway=function(e,t){this.doSend({messageType:"GATEWAY_CONTROL",index:e,command:t})};$.prototype.bindMouse=function(e){this.mMouseBind=e,e?(this.mMediaplayer.onmousemove=this.mouseMove.bind(this),this.mMediaplayer.onmousedown=this.mouseDown.bind(this),this.mMediaplayer.onmouseup=this.mouseUp.bind(this),this.mMediaplayer.onmousewheel=this.mouseWheel.bind(this),this.mCanvas&&(this.mCanvas.onmousemove=this.mouseMove.bind(this),this.mCanvas.onmousedown=this.mouseDown.bind(this),this.mCanvas.onmouseup=this.mouseUp.bind(this),this.mCanvas.onmousewheel=this.mouseWheel.bind(this))):(this.mMediaplayer.onmousemove=null,this.mMediaplayer.onmousedown=null,this.mMediaplayer.onmouseup=null,this.mMediaplayer.onmousewheel=null,this.mCanvas&&(this.mCanvas.onmousemove=null,this.mCanvas.onmousedown=null,this.mCanvas.onmouseup=null,this.mCanvas.onmousewheel=null))};$.prototype.calculatePosition=function(e){if(this.mMediaplayer===void 0||!this.needRecv||this.mMediaplayer.videoHeight===0||this.mMediaplayer.videoWidth===0)return null;let t=this.mMediaplayer.offsetHeight/this.mMediaplayer.videoHeight,n=this.mMediaplayer.offsetWidth/this.mMediaplayer.videoWidth,o=t<n?t:n,i=this.mMediaplayer.offsetWidth/2-this.mMediaplayer.videoWidth*o/2,r=this.mMediaplayer.offsetWidth/2+this.mMediaplayer.videoWidth*o/2,s=this.mMediaplayer.offsetHeight/2-this.mMediaplayer.videoHeight*o/2,a=this.mMediaplayer.offsetHeight/2+this.mMediaplayer.videoHeight*o/2,c=this.mMediaplayer.getBoundingClientRect(),u=e.clientX-c.left,d=e.clientY-c.top;if(u<i||u>r||d<s||d>a)return null;let m=new Array;m[0]=(u-i)*this.mMediaplayer.videoWidth/(r-i),m[1]=(d-s)*this.mMediaplayer.videoHeight/(a-s);let p=e.button;return p===0?p=1:p===1&&(p=4),m[2]=p,m};$.prototype.mouseMove=function(e){let t=this.calculatePosition(e);if(t===null)return!1;this.doSend({messageType:"MOUSE_EVENT",mouseAction:"MOUSE_MOVE",mouseX:t[0],mouseY:t[1]})};$.prototype.mouseDown=function(e){let t=this.calculatePosition(e);return t===null||this.doSend({messageType:"MOUSE_EVENT",mouseAction:"MOUSE_PRESS",mouseX:t[0],mouseY:t[1],mouseButton:t[2]}),!1};$.prototype.mouseUp=function(e){let t=this.calculatePosition(e);return t===null||this.doSend({messageType:"MOUSE_EVENT",mouseAction:"MOUSE_RELEASE",mouseX:t[0],mouseY:t[1],mouseButton:t[2]}),!1};$.prototype.mouseWheel=function(e){return this.calculatePosition(e)===null||this.doSend({messageType:"MOUSE_EVENT",mouseAction:"MOUSE_WHEEL",delta:e.wheelDelta,orientation:2}),!1};$.prototype.mousePosition=function(e){let t=this.calculatePosition(e);return t===null||this.doSend({messageType:"MOUSE_EVENT",mouseAction:"MOUSE_POSITION",mouseX:t[0],mouseY:t[1]}),!1};$.prototype.panUnit2Degree=function(e){return e*180+180};$.prototype.tiltUnit2Degree=function(e){return e*90};$.prototype.panDegree2Unit=function(e){return e/180-1};$.prototype.tiltDegree2Unit=function(e){return e/90};var Mn=$;function xh(e){this._leftClip=Cesium.defaultValue(0,0),this._rightClip=Cesium.defaultValue(1,1),this._topClipLine1=new Cesium.Cartesian4(0,1,1,1),this._topClipLine2=new Cesium.Cartesian4(0,1,1,1),this._topClipLine3=new Cesium.Cartesian4(0,1,1,1),this._topClipLine4=new Cesium.Cartesian4(0,1,1,1),this._bottomClipLine1=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine2=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine3=new Cesium.Cartesian4(0,0,1,0),this._bottomClipLine4=new Cesium.Cartesian4(0,0,1,0),this._pointsList=[],this._initialPointsList=[],this._indicesList=[],this._centerPostion=new Cesium.Cartesian3;for(let t=0;t<e.length;t++)try{let n=e[t];if(t===e.length-1)for(let o=0;o<n.length;o++)this._indicesList.push(n[o]);else if(this._centerPostion.x=this._centerPostion.x+n[0],this._centerPostion.y=this._centerPostion.y+n[1],this._centerPostion.z=this._centerPostion.z+n[2],this._pointsList.push(new Cesium.Cartesian3(n[0],n[1],n[2])),n[3]>=0){let o=this._initialPointsList.length;for(let i=0;i<e.length-1;i++)if(e[i][3]===o){this._initialPointsList.push(new Cesium.Cartesian3(e[i][0],e[i][1],e[i][2]));break}}}catch(n){console.error(n.message)}this._centerPostion.x=this._centerPostion.x/(e.length-1),this._centerPostion.y=this._centerPostion.y/(e.length-1),this._centerPostion.z=this._centerPostion.z/(e.length-1)}function Zr(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.framebuffer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.framebuffer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.coordinates))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.projection\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.ev_CommonProjectionPlane=new xh(e.coordinates),this._show=Cesium.defaultValue(e.show,!0),this._planeColor=Cesium.defaultValue(e.planeColor,new Cesium.Color),this._viewer=e.viewer,this.framebuffer=e.framebuffer;let t=`attribute vec3 position;
void main()
{
    gl_Position = czm_modelViewProjection * vec4(position, 1.0);
}
`,n=`uniform vec4 u_color;
void main()
{
    gl_FragColor = u_color;
}
`;this._vsSource=new Cesium.ShaderSource({sources:[t]}),this._fsSource=new Cesium.ShaderSource({sources:[n]});let o=Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!0,face:Cesium.CullFace.BACK},depthTest:{enabled:!1}}),i=this;i._drawCommand=new Cesium.DrawCommand({owner:i,pass:Cesium.Pass.OPAQUE,renderState:o,framebuffer:e.framebuffer,uniformMap:{u_color:function(){return i._planeColor}}}),this._viewer.scene.primitives.add(this)}Zr.prototype.update=function(e){let t=e.context,n=e.commandList;if(!Cesium.defined(this._drawCommand.vertexArray)){let o=wh(this,this.ev_CommonProjectionPlane._pointsList,this.ev_CommonProjectionPlane._centerPostion,this.ev_CommonProjectionPlane._indicesList);if(o){let i=Cesium.GeometryPipeline.createAttributeLocations(o);this._drawCommand.vertexArray=Cesium.VertexArray.fromGeometry({context:t,geometry:o,attributeLocations:i,bufferUsage:Cesium.BufferUsage.STATIC_DRAW});let r=Cesium.Cartesian3.fromDegrees(this.ev_CommonProjectionPlane._centerPostion.x,this.ev_CommonProjectionPlane._centerPostion.y,this.ev_CommonProjectionPlane._centerPostion.z);this._drawCommand.modelMatrix=Cesium.Matrix4.fromTranslation(r),this._drawCommand.boundingVolume=Cesium.BoundingSphere.transform(o.boundingSphere,this._drawCommand.modelMatrix,this._drawCommand.boundingVolume),Cesium.defined(this._drawCommand.shaderProgram)||(this._drawCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:this._vsSource,fragmentShaderSource:this._fsSource,attributeLocations:i}))}}Cesium.defined(this._drawCommand)&&(this._drawCommand.framebuffer=this.framebuffer,n.push(this._drawCommand))};function wh(e,t,n,o){if(t.length===0||o.length===0)return;n=Cesium.Cartesian3.fromDegrees(n.x,n.y,n.z);let i=t.length*3,r=new Float64Array(i),s=o.length,a=Cesium.IndexDatatype.createTypedArray(i,s),c=0;for(let p=0;p<t.length;p++){let _=new Cesium.Cartesian3,g=Cesium.Cartesian3.fromDegrees(t[p].x,t[p].y,t[p].z);Cesium.Cartesian3.subtract(g,n,_),r[c++]=_.x,r[c++]=_.y,r[c++]=_.z}let u=0;for(let p=0;p<o.length;p++)a[u++]=o[p];let d=new Cesium.GeometryAttributes;d.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:r});let m=Cesium.BoundingSphere.fromVertices(r);return new Cesium.Geometry({attributes:d,indices:a,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:m})}Zr.prototype.destroy=function(){return Cesium.destroyObject(this)};var Ii=Zr;var Mi=`varying vec2 v_textureCoordinates;
uniform sampler2D colorTexture;
uniform sampler2D depthTexture;
uniform vec3 u_relativePos;
uniform mat4 u_sceneInverseViewRelative;
uniform sampler2D u_videoColorTexture;
uniform sampler2D u_videoCameraDepthTexture;
uniform mat4 u_videoViewProjectionRelative;
uniform mat4 u_videoInverseViewRelative;
uniform float u_log2FarDepthFromNearPlusOneInVideo;
uniform vec2 u_videoFrustum;
uniform vec4 u_videoViewport;
uniform mat4 u_videoViewportTransformation; 
uniform mat4 u_videoInverseProjection; 
uniform vec4 u_videoFrustumPlanes;
uniform float u_depthType;
uniform float u_alpha;
uniform vec3 u_hsv;
uniform sampler2D u_clipPlaneColorTexture;
uniform vec4 u_clipPlaneColor;
uniform float u_projectMode;
uniform vec4 u_pureColor;
uniform float k1;
uniform float k2;
uniform float textureWidth;
uniform float textureHeight;
uniform vec2 u_videoTextureClipLUPos;
uniform vec2 u_videoTextureClipLBPos;
uniform vec2 u_videoTextureClipRBPos;
uniform vec2 u_videoTextureClipRUPos;
uniform float u_distanceError;

vec3 clipToRelativeWorld(float u,float v)
{
vec2 uv = vec2(u,v);
float depth = czm_unpackDepth(texture2D(depthTexture, uv));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(uv*czm_viewport.zw, depth);
vec4 worldCoordinate4 = u_sceneInverseViewRelative * eyeCoordinate;
vec3 worldPosition = worldCoordinate4.xyz / worldCoordinate4.w;
return worldPosition;
}
vec4 windowToEyeCoordinatesInVideo2(vec4 fragmentCoordinate)
{
    float x = 2.0 * (fragmentCoordinate.x - u_videoViewport.x) / u_videoViewport.z - 1.0;
    float y = 2.0 * (fragmentCoordinate.y - u_videoViewport.y) / u_videoViewport.w - 1.0;
    float z = (fragmentCoordinate.z - u_videoViewportTransformation[3][2]) / u_videoViewportTransformation[2][2];
    vec4 q = vec4(x, y, z, 1.0);
    q = q/fragmentCoordinate.w;
    if (!(u_videoInverseProjection == mat4(0.0))) 
    {
        q = u_videoInverseProjection * q;
    }
    else
    {
        float top = u_videoFrustumPlanes.x;
        float bottom = u_videoFrustumPlanes.y;
        float left = u_videoFrustumPlanes.z;
        float right = u_videoFrustumPlanes.w;
        float near = u_videoFrustum.x;
        float far = u_videoFrustum.y;
        q.x = (q.x * (right - left) + left + right) * 0.5;
        q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
        q.z = (q.z * (near - far) - near - far) * 0.5;
        q.w = 1.0;
    }
    return q;
}
vec4 windowToEyeCoordinatesInVideo(vec2 fragmentCoordinateXY, float depthOrLogDepth) 
{
  #ifdef LOG_DEPTH
  float near = u_videoFrustum.x;
  float far = u_videoFrustum.y;
  float log2Depth = depthOrLogDepth * u_log2FarDepthFromNearPlusOneInVideo;
  float depthFromNear = pow(2.0, log2Depth) - 1.0;
  float depthFromCamera = depthFromNear + near;
  vec4 windowCoord = vec4(fragmentCoordinateXY, far * float(1.0 - near / depthFromCamera) / float(far - near), 1.0);
  vec4 eyeCoordinate = windowToEyeCoordinatesInVideo2(windowCoord);
  eyeCoordinate.w = 1.0 / depthFromCamera; 
  return eyeCoordinate;
  #else
  vec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);
  vec4 eyeCoordinate = windowToEyeCoordinatesInVideo2(windowCoord);
  #endif
  return eyeCoordinate;
}
vec3 videoCameraClipToRelativeWorld(float u,float v) 
{
  vec2 uv = vec2(u,v);
  float depth = czm_unpackDepth(texture2D(u_videoCameraDepthTexture, uv));
  vec4 eyeCoordinate = windowToEyeCoordinatesInVideo(uv*u_videoViewport.zw, depth);
  vec4 worldCoordinate4 = u_videoInverseViewRelative * eyeCoordinate;
  vec3 worldPosition = worldCoordinate4.xyz / worldCoordinate4.w;
  return worldPosition;
}
vec3 rgb2hsv(vec3 c)
{
vec4 K = vec4(0.0, -1.0/3.0, 2.0/3.0, -1.0);
vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y)/(6.0*d+e)), d/(q.x + e), q.x);
}
vec3 hsv2rgb(vec3 c)
{
vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
void main(void){
float depth = czm_unpackDepth(texture2D(depthTexture, v_textureCoordinates));
gl_FragColor = texture2D(colorTexture, v_textureCoordinates);
vec4 clipColor = texture2D(u_clipPlaneColorTexture, v_textureCoordinates);
#ifdef CZM_SELECTED_FEATURE
float padx = czm_pixelRatio / czm_viewport.z;
float pady = czm_pixelRatio / czm_viewport.w;
if(czm_selected(vec2(padx, pady))){
return;
}
#endif
if(depth>0.0){
vec3 worldPos = clipToRelativeWorld(v_textureCoordinates.x, v_textureCoordinates.y);
vec4 realWorldPos = vec4(worldPos.x + u_relativePos.x, worldPos.y + u_relativePos.y, worldPos.z + u_relativePos.z, 1.0);
vec4 projectPtInVideo = u_videoViewProjectionRelative * realWorldPos;
projectPtInVideo = projectPtInVideo/projectPtInVideo.w;
if(projectPtInVideo.x >=-1.0 && projectPtInVideo.x <= 1.0
&& projectPtInVideo.y >=-1.0 && projectPtInVideo.y <= 1.0
&& projectPtInVideo.z >=0.0 && projectPtInVideo.z <= 1.0){
vec2 texCoord = vec2(0.5, 0.5) + projectPtInVideo.xy * 0.5;
//Inverse calculation of world coordinates relative to the video camera. added by zak 2021.2.19 
if(u_depthType>2.5 && u_depthType<3.5){
   vec3 worldPtInVideoCamera = videoCameraClipToRelativeWorld(texCoord.x, texCoord.y);   
   float dis = distance(realWorldPos.xyz, worldPtInVideoCamera);
   if(dis > u_distanceError){
  	  return;
   }
}
float maxWidthHeight = textureWidth;
float percent = textureHeight / textureWidth;
vec2 centerUV = vec2((textureWidth / 2.0) / maxWidthHeight, (textureHeight / 2.0) / maxWidthHeight);
vec2 currentUV = vec2(texCoord.x, texCoord.y * percent);
float length_2 = (currentUV.x - centerUV.x) * (currentUV.x - centerUV.x) + (currentUV.y - centerUV.y) * (currentUV.y - centerUV.y);
float length_4 = length_2 * length_2;
texCoord.x = (currentUV.x - centerUV.x) / (k1 * length_2 + k2 * length_4 + 1.0) + centerUV.x;
texCoord.y = (currentUV.y - centerUV.y) / (k1 * length_2 + k2 * length_4 + 1.0) + centerUV.y;
texCoord.y = texCoord.y / percent;
bool intersect = false;
if (((u_videoTextureClipLBPos.y>texCoord.y) != (u_videoTextureClipRBPos.y>texCoord.y)) &&(texCoord.x < 
    (u_videoTextureClipRBPos.x-u_videoTextureClipLBPos.x) * (texCoord.y-u_videoTextureClipLBPos.y) / (u_videoTextureClipRBPos.y-u_videoTextureClipLBPos.y) + u_videoTextureClipLBPos.x)){
      intersect = !intersect;
}
if (((u_videoTextureClipLUPos.y>texCoord.y) != (u_videoTextureClipLBPos.y>texCoord.y)) &&(texCoord.x < 
    (u_videoTextureClipLBPos.x-u_videoTextureClipLUPos.x) * (texCoord.y-u_videoTextureClipLUPos.y) / (u_videoTextureClipLBPos.y-u_videoTextureClipLUPos.y) + u_videoTextureClipLUPos.x)){
      intersect = !intersect;
}
if (((u_videoTextureClipRUPos.y>texCoord.y) != (u_videoTextureClipLUPos.y>texCoord.y)) &&(texCoord.x < 
    (u_videoTextureClipLUPos.x-u_videoTextureClipRUPos.x) * (texCoord.y-u_videoTextureClipRUPos.y) / (u_videoTextureClipLUPos.y-u_videoTextureClipRUPos.y) + u_videoTextureClipRUPos.x)){
      intersect = !intersect;
}
if (((u_videoTextureClipRBPos.y>texCoord.y) != (u_videoTextureClipRUPos.y>texCoord.y)) &&(texCoord.x < 
    (u_videoTextureClipRUPos.x-u_videoTextureClipRBPos.x) * (texCoord.y-u_videoTextureClipRBPos.y) / (u_videoTextureClipRUPos.y-u_videoTextureClipRBPos.y) + u_videoTextureClipRBPos.x)){
      intersect = !intersect;
}
if(!intersect){
  return;
}
vec4 videoColor = texture2D(u_videoColorTexture, texCoord);
vec3 rgb = videoColor.xyz;
vec3 hsv = rgb2hsv(rgb);
hsv += u_hsv;
rgb = hsv2rgb(hsv);
rgb = clamp(rgb, 0.0, 1.0);
videoColor.xyz = rgb;
if(u_projectMode>0.5 && u_projectMode<1.5){
gl_FragColor = (1.0 - u_alpha) * gl_FragColor + u_alpha * videoColor;
}else if(u_projectMode>1.5 && u_projectMode<2.5){
if(czm_equalsEpsilon(u_clipPlaneColor.r, clipColor.r, 0.001) && czm_equalsEpsilon(u_clipPlaneColor.g, clipColor.g, 0.001) &&
czm_equalsEpsilon(u_clipPlaneColor.b, clipColor.b, 0.001)){
gl_FragColor = (1.0 - u_alpha) * gl_FragColor + u_alpha * videoColor;
  }
}else if(u_projectMode>2.5 && u_projectMode<3.5){
gl_FragColor = (1.0 - u_alpha) * gl_FragColor + u_alpha * videoColor;
}
  }
}
}
`;function Ke(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.videoElement))throw new Cesium.DeveloperError("\u524D\u7AEFvideo\u5BB9\u5668\u7684ID\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originLon))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u7ECF\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originLat))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u7EAC\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.originHeight))throw new Cesium.DeveloperError("\u89C2\u5BDF\u70B9\u9AD8\u5EA6\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.clipPlaneFramebuffer))throw new Cesium.DeveloperError("\u88C1\u526A\u9762\u5E27\u7F13\u5B58\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.width)||!Cesium.defined(e.height))throw new Cesium.DeveloperError("\u89C6\u9891\u5BBD\u5EA6\u6216\u9AD8\u5EA6\u6CA1\u6709\u5B9A\u4E49\u3002");if(this._videoElement=e.videoElement,!this._videoElement||!(this._videoElement instanceof HTMLVideoElement||this._videoElement instanceof HTMLCanvasElement||this._videoElement instanceof HTMLImageElement))throw new Cesium.DeveloperError("options.videoElement\u5E76\u4E0D\u662F\u89C6\u9891\u5BB9\u5668\u3002");this._videoElement.paused&&this._videoElement.play(),this._projectMode=Cesium.defaultValue(e.projectMode,1),this._depthType=Cesium.defaultValue(e.depthType,0),this._show=Cesium.defaultValue(e.show,!0),this._name=Cesium.defaultValue(e.name,Cesium.createGuid()),this._wsplayer=e.wsplayer,this._wsplayerType=e.wsplayerType,this._wsplayerGBAddress=e.wsplayerGBAddress,this._ptzReverse=Cesium.defaultValue(e.ptzReverse,new Cesium.Cartesian2(0,0)),this._ptzDelay=Cesium.defaultValue(e.ptzDelay,300),this._follow=!1,this._pureColor=Cesium.defaultValue(e.pureColor,new Cesium.Color(1,1,1,1)),this._viewer=e.viewer,this._scene=this._viewer.scene,this._mainCamera=this._scene.camera,this._delayTimerArray=[],this._readyState=0,this._projectionMode=1,this._mainCameraFrontPos=Cesium.Cartesian3.clone(this._mainCamera.position);let t=this._viewer.canvas,n=this._scene._frameState.context;if(!Cesium.defined(n))throw new Cesium.DeveloperError("_scene._frameState.context\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(this.clipPlaneColor=Cesium.defaultValue(e.clipPlaneColor,new Cesium.Color(1,0,0,1)),this.clipPlaneFramebuffer=e.clipPlaneFramebuffer,this.clipPlaneTexture=e.clipPlaneTexture,this.projectionPlanes=[],Cesium.defined(e.projection))for(let o=0;o<e.projection.length;o++)this.projectionPlanes.push(new Ii({viewer:this._viewer,framebuffer:this.clipPlaneFramebuffer,coordinates:e.projection[o],planeColor:this.clipPlaneColor,canvas:t}));else this.projectionPlanes.push(n.defaultTexture);if(this._filterPrimitives=Cesium.defaultValue(e.filterPrimitives,void 0),this._cachedFilterFeatures=Cesium.defaultValue(e.cachedFilterFeatures,void 0),this._width=e.width,this._height=e.height,this._originLon=e.originLon,this._originLat=e.originLat,this._originHeight=e.originHeight,this._pitch=Cesium.defaultValue(e.pitch,0),this._heading=Cesium.defaultValue(e.heading,0),this._roll=Cesium.defaultValue(e.roll,0),this._fov=Cesium.defaultValue(e.fov,60),this._videoCameraPos=Cesium.Cartesian3.fromDegrees(this._originLon,this._originLat,this._originHeight),this.videoAlpha=Cesium.defaultValue(e.videoAlpha,1),this.videoAlphaRate=1,this._videoVisiableAngle=45,this._videoGradientAngle=30,this.isEditMode=Cesium.defaultValue(e.isEditMode,!1),this.videoHsv=Cesium.defaultValue(e.hsvParam,new Cesium.Cartesian3),this.videoCamera=void 0,this.videoViewport=new Cesium.BoundingRectangle(0,0,t.width,t.height),this.videoView=void 0,this.videoUniform={videoInverseViewRelative:new Cesium.Matrix4,log2FarDepthFromNearPlusOneInVideo:0,videoFrustum:new Cesium.Cartesian2,videoViewport:new Cesium.Cartesian4,videoViewportTransformation:new Cesium.Matrix4,videoInverseProjection:new Cesium.Matrix4,videoFrustumPlanes:new Cesium.Cartesian4},this._videoTexture=void 0,this._videoStage=void 0,this._panPos=Cesium.defaultValue(e.pan,0),this._tiltPos=Cesium.defaultValue(e.tilt,0),this._zoomPos=Cesium.defaultValue(e.zoom,1),this._ptzType=Cesium.defaultValue(e.ptzType,"Degree"),this._ptzZoomRatio=Cesium.defaultValue(e.ptzZoomRatio,1),this._panCurrent=0,this._tiltCurrent=0,this._zoomCurrent=0,this._nearClip=Cesium.defaultValue(e.nearClip,.01),this._farClip=Cesium.defaultValue(e.farClip,100),this._distanceError=Cesium.defaultValue(e.distanceError,.1),this._distortion=Cesium.defaultValue(e.distortion,new Cesium.Cartesian2(0,0)),this._visibleDistance=Cesium.defaultValue(e.visibleDistance,1e3),this._layer=e.layer,this._viewPoint=e.viewPoint,e.clipPoints){let o=e.clipPoints;this._videoTextureClipLUPos=new Cesium.Cartesian2(o[0],o[1]),this._videoTextureClipLBPos=new Cesium.Cartesian2(o[2],o[3]),this._videoTextureClipRUPos=new Cesium.Cartesian2(o[4],o[5]),this._videoTextureClipRBPos=new Cesium.Cartesian2(o[6],o[7])}else this._videoTextureClipLUPos=new Cesium.Cartesian2(0,1),this._videoTextureClipLBPos=new Cesium.Cartesian2(0,0),this._videoTextureClipRUPos=new Cesium.Cartesian2(1,1),this._videoTextureClipRBPos=new Cesium.Cartesian2(1,0);this.delayPan="",this.delayTilt="",this.delayZoom="",this.targetPosition=new Cesium.Cartesian3,this.targetOrientation=new Cesium.Cartesian3,this.targetZoom=1,this._boundingSphere=new Cesium.BoundingSphere,this._videoCameraPostureChanged=!1,this._changed=new Cesium.Event,this._cameraPromise=Cesium.defer()}Object.defineProperties(Ke.prototype,{videoStage:{get:function(){return this._videoStage}},name:{get:function(){return this._name}},show:{get:function(){return this._show},set:function(e){this._show=e,this._videoStage&&(this._videoStage.enabled=e),this._wsplayer&&(this._wsplayer.needRecv=e)}},boundingSphere:{get:function(){return this._computeBoundingSphere()}},changed:{get:function(){return this._changed}},distanceError:{get:function(){return this._distanceError},set:function(e){if(e<=0)throw new Cesium.DeveloperError("invalid distanceError value.");this._distanceError=e}},visibleDistance:{get:function(){return this._visibleDistance},set:function(e){this._visibleDistance=e}},cameraPromise:{get:function(){return this._cameraPromise.promise}},projectionMode:{get:function(){return this._projectionMode}}});function $a(e){let t=e._scene._frameState;if(!!Cesium.defined(t)&&(!(e._videoElement instanceof HTMLVideoElement)||e._videoElement.readyState>=2))return new Cesium.Texture({context:t.context,source:e._videoElement,sampler:new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})})}function Sh(e){let t=Cesium.Cartesian3.fromDegrees(e._originLon,e._originLat,e._originHeight),n=new Cesium.Camera(e._viewer.scene);n._name=`vCamera_${e._name}`,e.videoView=new Cesium.View(e._viewer.scene,n,e.videoViewport),e.videoView._name=`vView_${e._name}`,n.setView({destination:t,orientation:{heading:Cesium.Math.toRadians(e._heading),pitch:Cesium.Math.toRadians(e._pitch),roll:Cesium.Math.toRadians(e._roll)}});let o=n.frustum;return o.fov=Cesium.Math.toRadians(e._fov),o.aspectRatio=e._videoTexture._width/e._videoTexture._height,o.near=e._nearClip,o.far=e._farClip,o._fovy=o.aspectRatio<=1?o.fov:Math.atan(Math.tan(o.fov*.5)/o.aspectRatio)*2,o.top=o.near*Math.tan(.5*o._fovy),o.bottom=-o.top,o.right=o.aspectRatio*o.top,o.left=-o.right,n}function Rh(e,t,n){let o=n.viewport,i=o.width,r=o.height,s=e.videoView._name;e.videoView=Cesium.defined(e.videoView)&&e.videoView.destroy(),e.videoViewport=new Cesium.BoundingRectangle(0,0,i,r),e.videoView=new Cesium.View(t,e.videoCamera,e.videoViewport),e.videoView._name=s,e._width=i,e._height=r,t.view=e.videoView;let a=e.videoView.passState;a.viewport=Cesium.BoundingRectangle.clone(e.videoViewport,a.viewport),a=t.view.passState,t.jobScheduler.disableThisFrame(),Ph(t);let c=t.frameState,u=c.context.uniformState;c.invertClassification=!1,c.passes.pick=!1,u.update(c),t.updateAndExecuteRttCommands(a,new Cesium.Color(0,0,0,1))}function Ph(e){let t=e.frameState,n=e.camera;t.camera=n,t.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),t.useLogDepth=e._logDepthBuffer&&!(n.frustum instanceof Cesium.OrthographicFrustum||n.frustum instanceof Cesium.OrthographicOffCenterFrustum)}function Oh(e,t){if(Ih(e,t),e.videoAlphaRate===0)return;let n=e._scene,o=n.view;if(e._depthType>2.5&&e._depthType<3.5&&(!e._mainCameraFrontPos.equals(o.camera.position)||e._videoCameraPostureChanged)&&e.show){let i=new Cesium.PostProcessStageCollection;i.fxaa.enabled=!1;let r=n.postProcessStages;if(n.postProcessStages=i,Rh(e,n,o),Cesium.defined(e.videoView)&&Cesium.defined(e.videoView.passState.context.uniformState)){let s=e.videoView.passState.context.uniformState;e.videoUniform.videoInverseViewRelative=Cesium.Matrix4.setTranslation(s.inverseView,new Cesium.Cartesian3,new Cesium.Matrix4),e.videoUniform.log2FarDepthFromNearPlusOneInVideo=s.log2FarDepthFromNearPlusOne,e.videoUniform.videoFrustum=Cesium.Cartesian2.clone(s.currentFrustum),e.videoUniform.videoViewport=new Cesium.Cartesian4(s.viewport.x,s.viewport.y,s.viewport.width,s.viewport.height),e.videoUniform.videoViewportTransformation=Cesium.Matrix4.clone(s.viewportTransformation),e.videoUniform.videoInverseProjection=Cesium.Matrix4.clone(s.inverseProjection),e.videoUniform.videoFrustumPlanes=Cesium.Cartesian4.clone(s.frustumPlanes)}e._scene.view=o,e._scene.postProcessStages=r,i=void 0,e._mainCameraFrontPos=Cesium.Cartesian3.clone(o.camera.position)}e._videoCameraPostureChanged=!1}function Ih(e,t){if(e._videoStage.selected=[],e._filterPrimitives.cesium3DTileNames.length===0&&e._filterPrimitives.cesium3DTileIds.length===0&&e._filterPrimitives.entityIds.length===0){e._cachedFilterFeatures._features=[];return}if(Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._frameNumber===t.frameNumber){e._videoStage.selected=e._cachedFilterFeatures._features;return}else Cesium.defined(e._cachedFilterFeatures)&&(e._cachedFilterFeatures._frameNumber=t.frameNumber,e._cachedFilterFeatures._features=[]);let o=e._scene._primitives;for(let u=0;u<o.length;u++){let d=o.get(u);if(d instanceof Cesium.Cesium3DTileset){if(!d.ready)continue;if(d.asset.tilesetVersion.indexOf("lodmodel")>-1){let p=d._selectedTiles;for(let _=0;_<p.length;_++){let g=p[_].content;if(g instanceof Cesium.Batched3DModel3DTileContent||g instanceof Cesium.Instanced3DModel3DTileContent){g.featuresLength>0&&g.getFeature(0);let v=g.batchTable,b=g._features;for(let A=0;A<g.featuresLength;A++)(e._filterPrimitives.cesium3DTileIds.indexOf(v._properties.id[A])>-1||e._filterPrimitives.cesium3DTileNames.indexOf(v._properties.name[A])>-1)&&(e._videoStage.selected.push(b[A]),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(b[A]));let S=g._model.ev_E3MInternalInstance.modelInstanceCollections;for(let A=0;A<S.length;A++){g._model.ev_E3MInternalInstance.getFeature(S[A],0);let x=S[A].batchTable,P=S[A]._features;for(let z=0;z<S[A].featuresLength;z++)(e._filterPrimitives.cesium3DTileIds.indexOf(x._properties.id[z])>-1||e._filterPrimitives.cesium3DTileNames.indexOf(x._properties.name[z])>-1)&&(e._videoStage.selected.push(P[z]),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(P[z]))}}else if(g instanceof Cesium.Composite3DTileContent){let v=g.innerContents;for(let b=0;b<v.length;b++)if(v[b]instanceof Cesium.Batched3DModel3DTileContent||v[b]instanceof Cesium.Instanced3DModel3DTileContent){v[b].featuresLength>0&&v[b].getFeature(0);let S=v[b].batchTable,A=v[b]._features;for(let P=0;P<v[b].featuresLength;P++)(e._filterPrimitives.cesium3DTileIds.indexOf(S._properties.id[P])>-1||e._filterPrimitives.cesium3DTileNames.indexOf(S._properties.name[P])>-1)&&(e._videoStage.selected.push(A[P]),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(A[P]));let x=v[b]._model.ev_E3MInternalInstance.modelInstanceCollections;for(let P=0;P<x.length;P++){v[b]._model.ev_E3MInternalInstance.getFeature(x[P],0);let z=x[P].batchTable,L=x[P]._features;for(let B=0;B<x[P].featuresLength;B++)(e._filterPrimitives.cesium3DTileIds.indexOf(z._properties.id[B])>-1||e._filterPrimitives.cesium3DTileNames.indexOf(z._properties.name[B])>-1)&&(e._videoStage.selected.push(L[B]),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(L[B]))}}}}}}else if(d instanceof Cesium.Model)Cesium.defined(d.id)&&d.id instanceof Cesium.Entity&&e._filterPrimitives.entityIds.indexOf(d.id.id)>-1&&(e._videoStage.selected.push(d),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(d));else if(d instanceof Cesium.PrimitiveCollection)for(let m=0;m<d.length;m++){let p=d.get(m);if(p instanceof Cesium.PrimitiveCollection)for(let _=0;_<p.length;_++){let g=p.get(_);if(Cesium.defined(g._instanceIds))for(let v=0;v<g._instanceIds.length;v++){let b=g._instanceIds[v];e._filterPrimitives.entityIds.indexOf(b.id)>-1&&(e._videoStage.selected.push(g),Cesium.defined(e._cachedFilterFeatures)&&e._cachedFilterFeatures._features.push(g))}}else console.log("filterProjectedFeatures PrimitiveCollection is empty!")}}var i=e._viewer.entities;if(i instanceof Cesium.EntityCollection)for(var r=0;r<i.values.length;r++){var s=i.values[r];if(s instanceof Cesium.Entity){var a=s;if(e._filterPrimitives.entityIds.indexOf(a.id)>-1){var c=e._scene.context._pickObjects;for(let u in c){let d=c[u];Cesium.defined(d.id)&&Cesium.defined(d.id.id)&&d.id.id===a.id&&e._videoStage.selected.push(d.primitive)}}}}}Ke.prototype.checkPlay=function(){if(!this._show)return this._wsplayer&&this._wsplayer.socketConnect&&this._wsplayer.stop(),!1;if(this._checkVideoCameraAngle(),this.videoAlphaRate===0)return!1;let e=this._mainCamera.positionWC;return Cesium.Cartesian3.distance(e,this._videoCameraPos)>this._visibleDistance?(this._wsplayer&&this._wsplayer.socketConnect&&this._wsplayer.stop(),!1):(this._wsplayer&&!this._wsplayer.socketConnect&&(this._wsplayerType==="rtsp"?this._wsplayer.openws():this._wsplayerType==="gb"&&(this._wsplayer.openws(),this._wsplayer.playGB(),this._wsplayer.playGBDevice(this._wsplayerGBAddress))),!0)};Ke.prototype.preRender=function(){if(!!this.checkPlay()&&(this._videoElement.readyState>=1&&!this._videoElement.paused&&Cesium.defined(this._videoTexture)&&(!(this._videoElement instanceof HTMLVideoElement)&&(this._videoTexture._height!==this._videoElement.videoHeight||this._videoTexture._width!==this._videoElement.videoWidth)?(this._videoTexture.destroy(),$a(this)):(1.96<1.84?this._videoTexture.copyFrom(this._videoElement):this._videoTexture.copyFrom({source:this._videoElement}),this._wsplayer&&this._wsplayer.updateVideo())),this._videoElement.readyState>=2&&this._readyState<2)){this._readyState=this._videoElement.readyState,this._videoTexture=$a(this),this.videoCamera=Sh(this),this._cameraPromise.resolve(this.videoCamera);let e=Cesium.Matrix4.setTranslation(this.videoCamera.viewMatrix,new Cesium.Cartesian3,new Cesium.Matrix4);this.videoViewProjectionMat4=Cesium.Matrix4.multiply(this.videoCamera.frustum.projectionMatrix,e,new Cesium.Matrix4);let t=this;this._videoStage=new Cesium.PostProcessStage({name:`VideoP_${t._name}`,fragmentShader:Mi,uniforms:{u_videoColorTexture:function(){return t._videoTexture},u_depthType:function(){return t._depthType},u_videoCameraDepthTexture:function(){return Cesium.defined(t.videoView.globeDepth.depthStencilTexture)?t.videoView.globeDepth.depthStencilTexture:t._scene.view.globeDepth.depthStencilTexture},u_videoViewProjectionRelative:function(){let n=Cesium.Matrix4.setTranslation(t.videoCamera.viewMatrix,new Cesium.Cartesian3,new Cesium.Matrix4);return t.videoViewProjectionMat4=Cesium.Matrix4.multiply(t.videoCamera.frustum.projectionMatrix,n,new Cesium.Matrix4),t.videoViewProjectionMat4},u_videoInverseViewRelative:function(){return t.videoUniform.videoInverseViewRelative},u_log2FarDepthFromNearPlusOneInVideo:function(){return t.videoUniform.log2FarDepthFromNearPlusOneInVideo},u_videoFrustum:function(){return t.videoUniform.videoFrustum},u_videoViewport:function(){return t.videoUniform.videoViewport},u_videoViewportTransformation:function(){return t.videoUniform.videoViewportTransformation},u_videoInverseProjection:function(){return t.videoUniform.videoInverseProjection},u_videoFrustumPlanes:function(){return t.videoUniform.videoFrustumPlanes},u_relativePos:function(){return Cesium.defined(t._mainCamera)&&Cesium.defined(t.videoCamera)?Cesium.Cartesian3.subtract(t._mainCamera.positionWC,t.videoCamera.positionWC,new Cesium.Cartesian3):new Cesium.Cartesian3},u_sceneInverseViewRelative:function(){let n=Cesium.Matrix4.setTranslation(t._mainCamera.viewMatrix,new Cesium.Cartesian3,new Cesium.Matrix4);return Cesium.Matrix4.inverse(n,new Cesium.Matrix4)},u_alpha:function(){return t.videoAlpha*t.videoAlphaRate},u_hsv:function(){return t.videoHsv},u_clipPlaneColorTexture:function(){return t.clipPlaneTexture},u_clipPlaneColor:function(){return t.clipPlaneColor},u_projectMode:function(){return t._projectMode},u_pureColor:function(){return t._pureColor},k1:function(){return t._distortion.x},k2:function(){return t._distortion.y},textureWidth:function(){return Cesium.defined(t._videoTexture)?t._videoTexture.width:0},textureHeight:function(){return Cesium.defined(t._videoTexture)?t._videoTexture.height:0},u_videoTextureClipLUPos:function(){return t._videoTextureClipLUPos},u_videoTextureClipLBPos:function(){return t._videoTextureClipLBPos},u_videoTextureClipRBPos:function(){return t._videoTextureClipRBPos},u_videoTextureClipRUPos:function(){return t._videoTextureClipRUPos},u_distanceError:function(){return t._distanceError}},type:this,preUpdateFunction:Oh}),this._viewer.scene.postProcessStages.add(this._videoStage),this._videoStage.enabled=!0,this._computeBoundingSphere()}};Ke.prototype.updateClipPlaneFramebuffer=function(e,t){this.clipPlaneFramebuffer=e,this.clipPlaneTexture=t;for(let n=0;n<this.projectionPlanes.length;n++)this.projectionPlanes[n].framebuffer=e};Ke.prototype._checkVideoCameraAngle=function(){if(!this.videoCamera)return;let e=Cesium.Cartesian3.angleBetween(this._mainCamera.directionWC,this.videoCamera.directionWC);e=Cesium.Math.toDegrees(e),e>this._videoVisiableAngle+this._videoGradientAngle?this.videoAlphaRate=0:e<this._videoVisiableAngle?this.videoAlphaRate=1:this.videoAlphaRate=1-(e-this._videoVisiableAngle)/this._videoGradientAngle};function Mh(e,t,n,o){if(e._delayTimerArray.length!==0&&(clearTimeout(e._delayTimerArray[0]),e._delayTimerArray.shift()),!e.videoCamera)return;let i=parseFloat(t),r=parseFloat(n),s=parseFloat(o),a=1e-5;if(Math.abs(i-e.panCurrent)<a&&Math.abs(r-e.tiltCurrent)<a&&Math.abs(s-e.zoomCurrent)<a)return;e.panCurrent=i,e.tiltCurrent=r,e.zoomCurrent=s;let c=e._heading+(i-e._panPos),u=e._pitch-(r-e._tiltPos);e.videoCamera.setView({orientation:{heading:Cesium.Math.toRadians(c),pitch:Cesium.Math.toRadians(u),roll:Cesium.Math.toRadians(e._roll)}});let d=e.videoCamera.frustum;d.fov=Cesium.Math.toRadians(e._fov*Math.sqrt(e._zoomPos/e.zoomCurrent)),d.aspectRatio=e._videoTexture._width/e._videoTexture._height,d.near=e._nearClip,d.far=e._farClip,d._fovy=d.aspectRatio<=1?d.fov:Math.atan(Math.tan(d.fov*.5)/d.aspectRatio)*2,d._fovy=d._fovy*Math.sqrt(e._zoomPos/e.zoomCurrent),d.top=d.near*Math.tan(.5*d._fovy),d.bottom=-d.top,d.right=d.aspectRatio*d.top,d.left=-d.right,e.followCamera(),e._computeBoundingSphere()}Ke.prototype.setVideoCameraPosition=function(e,t){if(!this.videoCamera)return;let n=Cesium.Cartesian3.subtract(this._viewPoint,e,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(n,n);let o=this.videoCamera.roll;this.videoCamera.setView({destination:e,orientation:{direction:n,up:this.videoCamera.up}}),this.videoCamera.setView({orientation:{heading:this.videoCamera.heading,pitch:this.videoCamera.pitch,roll:o}});let i=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(e);this._originLon=Cesium.Math.toDegrees(i.longitude),this._originLat=Cesium.Math.toDegrees(i.latitude),this._originHeight=i.height,this._videoCameraPos=e,this._videoCameraPostureChanged=!0,this._computeBoundingSphere(),t=Cesium.defaultValue(t,!0),t&&this._changed.raiseEvent()};Ke.prototype.setCameraOrientation=function(e,t){!this.videoCamera||(this.videoCamera.setView({orientation:{direction:e,up:t}}),this._heading=Cesium.Math.toDegrees(this.videoCamera.heading),this._pitch=Cesium.Math.toDegrees(this.videoCamera.pitch),this._roll=Cesium.Math.toDegrees(this.videoCamera.roll),this._videoCameraPostureChanged=!0,this._computeBoundingSphere(),this._changed.raiseEvent())};Ke.prototype.setCameraHeadingPitchRoll=function(e,t,n){!this.videoCamera||(this._heading=Cesium.Math.toDegrees(e),this._pitch=Cesium.Math.toDegrees(t),this._roll=Cesium.Math.toDegrees(n),this.videoCamera.setView({orientation:{heading:e,pitch:t,roll:n}}),this._videoCameraPostureChanged=!0,this._computeBoundingSphere(),this._changed.raiseEvent())};Ke.prototype.setCameraViewPoint=function(e,t){if(this._viewPoint=e,!this.videoCamera)return;let n=this.videoCamera.roll,o=Cesium.Cartesian3.subtract(e,this.videoCamera.positionWC,new Cesium.Cartesian3);Cesium.Cartesian3.normalize(o,o),this.videoCamera.setView({orientation:{direction:o,up:this.videoCamera.upWC}}),this.videoCamera.setView({orientation:{heading:this.videoCamera.heading,pitch:this.videoCamera.pitch,roll:n}}),this._heading=Cesium.Math.toDegrees(this.videoCamera.heading),this._pitch=Cesium.Math.toDegrees(this.videoCamera.pitch),this._roll=Cesium.Math.toDegrees(this.videoCamera.roll),this._videoCameraPostureChanged=!0,this._computeBoundingSphere(),Cesium.defaultValue(t,!0)&&this._changed.raiseEvent()};Ke.prototype.setCameraFov=function(e){this._fov=e,this.videoCamera&&(this.videoCamera.frustum.fov=Cesium.Math.toRadians(e))};Ke.prototype.setNearClip=function(e){e<=0||e>=this._farClip||(this._nearClip=e,this.videoCamera&&(this.videoCamera.frustum.near=e))};Ke.prototype.setFarClip=function(e){e<=this._nearClip||(this._farClip=e,this.videoCamera&&(this.videoCamera.frustum.far=e,this._computeBoundingSphere()))};Ke.prototype.setDistortion=function(e){this._distortion=e};Ke.prototype.updateParameter=function(e){let t=Cesium.Cartesian3.fromDegrees(e.originLon,e.originLat,e.originHeight);this.setVideoCameraPosition(t,!1),this.setCameraHeadingPitchRoll(e.heading,e.pitch,e.roll),Cesium.defined(e.fov)&&this.setCameraFov(e.fov),Cesium.defined(e.alpha)&&(this.videoAlpha=e.alpha),Cesium.defined(e.videoHsv)&&(this.videoHsv=e.videoHsv.clone()),Cesium.defined(e.distortion)&&(this._distortion=e.distortion.clone())};Ke.prototype.delayAdjustVideoCamera=function(e,t,n,o){if(n=(this._ptzZoomRatio-1)*n+1,!this.videoCamera||this.delayPan===e&&this.delayTilt===t&&this.delayZoom===n)return;this.delayPan=e,this.delayTilt=t,this.delayZoom=n;let i=this,r=setTimeout(function(){let s=e,a=t,c=n;i._ptzType==="Unit"&&(s=i._wsplayer.panUnit2Degree(e),a=i._wsplayer.tiltUnit2Degree(t),c=n),Mh(i,s,a,c)},o);this._delayTimerArray.push(r)};Ke.prototype.setPTZViewPoint=function(e){if(!this.videoCamera||!this._wsplayer)return;let t=new Cesium.Cartesian4(e.x,e.y,e.z,1);Cesium.Matrix4.multiplyByVector(this.videoCamera.viewMatrix,t,t),Cesium.Cartesian3.normalize(t,t);let n=Math.asin(t.y),o=Math.asin(t.x/Math.cos(n)),i=this.panCurrent+o*180/Math.PI,r=this.tiltCurrent-n*180/Math.PI;i>360?i=i-360:i<0&&(i=i+360),this._wsplayer.ptzType==="Degree"?this._wsplayer.setPTZPosition(i,r,this.zoomCurrent):this._wsplayer.ptzType==="Unit"&&(this.zoomCurrent=0,this._wsplayer.setPTZPosition(this._wsplayer.panDegree2Unit(i),this._wsplayer.tiltDegree2Unit(r),this.zoomCurrent))};Ke.prototype.followCamera=function(){let e=this;if(!e.videoCamera||!e._follow||!e._wsplayer)return;let t=e.videoCamera.position,n=e.videoCamera.heading,o=e.videoCamera.pitch,i=e.videoCamera.roll,r=1e-8;if(Math.abs(t.x-this.targetPosition.x)<r&&Math.abs(t.y-this.targetPosition.y)<r&&Math.abs(t.z-this.targetPosition.z)<r&&Math.abs(n-this.targetOrientation.x)<r&&Math.abs(this.targetOrientation.y-o)<r&&Math.abs(this.targetOrientation.z-i)<r&&Math.abs(this.targetZoom-e.zoomCurrent)<r)return;let s=new Cesium.Ray(e.videoCamera.position,e.videoCamera.direction),a=e._viewer.scene.pickFromRay(s),c=t;if(a&&a.position){let u=Cesium.Cartesian3.distance(e.videoCamera.position,a.position);this.targetZoom=e.zoomCurrent,u=u*(1-1/e.zoomCurrent),c=Cesium.Ray.getPoint(s,u,new Cesium.Cartesian3)}this.targetPosition=c,this.targetOrientation.x=n,this.targetOrientation.y=o,this.targetOrientation.z=i,e._viewer.camera.setView({destination:c,orientation:{heading:this.targetOrientation.x,pitch:this.targetOrientation.y,roll:this.targetOrientation.z}})};Ke.prototype.incompatibleConsole=function(){let e=this;this._viewer.scene.renderError.addEventListener(function(){e._viewer.cesiumWidget.showErrorPanel("This browser does not support cross-origin WebGL video textures.","","")})};Ke.prototype._computeBoundingSphere=function(){if(!this.videoCamera)return this._boundingSphere;let e=this.videoCamera.frustum.far*.5,t=Cesium.Cartesian3.multiplyComponents(this.videoCamera.direction,new Cesium.Cartesian3(e,e,e),new Cesium.Cartesian3);return this._boundingSphere.center=Cesium.Cartesian3.add(this.videoCamera.positionWC,t,this._boundingSphere.center),this._boundingSphere.radius=e,this._boundingSphere};Ke.prototype.getConfiguration=function(){let e={},t=this._wsplayer;t?(t.mSipID?e.gb=t.mSipID:t.mRtspurl&&(e.url=t.mRtspurl),e.protocol=t.protocol):e.file=this._fileName,e.alpha=this.videoAlpha,e.distortion=[this._distortion.x,this._distortion.y],e.hsv=[this.videoHsv.x,this.videoHsv.y,this.videoHsv.z],e.depthType=this._depthType,e.clipPoints=[this._videoTextureClipLUPos.x,this._videoTextureClipLUPos.y,this._videoTextureClipLBPos.x,this._videoTextureClipLBPos.y,this._videoTextureClipRUPos.x,this._videoTextureClipRUPos.y,this._videoTextureClipRBPos.x,this._videoTextureClipRBPos.y],e.nearClip=this._nearClip,e.farClip=this._farClip,e.distanceError=this._distanceError;let n={position:[this._originLon,this._originLat,this._originHeight],orientation:[this._heading,this._pitch,this._roll],fov:this._fov};if(this._viewPoint){let o=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(this._viewPoint);o&&(n.visitPoint=[Cesium.Math.toDegrees(o.longitude),Cesium.Math.toDegrees(o.latitude),o.height])}return t&&(n.ptzType=t.ptzType,n.ptz=[t.curPan,t.curTilt,t.curZoom]),{name:this._name,type:this._projectionMode,visibleDistance:this._visibleDistance,video:e,camera:n}};Ke.prototype.destroy=function(){this._scene.postProcessStages.remove(this._videoStage),this._wsplayer&&(this._wsplayer.stop(),this._wsplayer=null);for(let e=0;e<this.projectionPlanes.length;e++)this.projectionPlanes[e]!==this._scene._frameState.context.defaultTexture&&this.projectionPlanes[e].destroy();return this._videoTexture!==void 0&&(this._videoTexture.destroy(),this._videoTexture=void 0),this.projectionPlanes=[],Cesium.destroyObject(this)};var _n=Ke;function zh(){this._frameNumber=-1,this._features=[]}function Rt(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this._scene=this._viewer.scene,this._sceneCamera=this._scene.camera;let t=this._viewer.canvas,n=this._scene._frameState.context;if(this._width=t.width,this._height=t.height,!Cesium.defined(n))throw new Cesium.DeveloperError("_scene._frameState.context\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._videoProjections=[],this.clipPlaneTexture=new Cesium.Texture({context:n,width:this._width,height:this._height,pixelFormat:Cesium.PixelFormat.RGBA,sampler:Cesium.Sampler.NEAREST}),this.framebuffer=new Cesium.Framebuffer({context:n,colorTextures:[this.clipPlaneTexture],destroyAttachments:!1}),this._clearCommand=new Cesium.ClearCommand({color:new Cesium.Color(0,0,0,0),framebuffer:this.framebuffer,depth:1,owner:this}),this._viewer.scene.preRender.addEventListener(this.preRender,this),this._cachedFilterFeatures=new zh,this._filterPrimitives={cesium3DTileIds:[],cesium3DTileNames:[],entityIds:[]}}Object.defineProperties(Rt.prototype,{filterPrimitives:{get:function(){return this._filterPrimitives}}});Rt.prototype.createVideoProjection=function(e){let t=this._videoProjections.length+1;e.clipPlaneFramebuffer=this.framebuffer,e.clipPlaneColor=Cesium.Color.fromRgba(t),e.clipPlaneColor.alpha=1,e.clipPlaneTexture=this.clipPlaneTexture,e.pureColor=new Cesium.Color(0,1,0,1),e.filterPrimitives=this.filterPrimitives,e.cachedFilterFeatures=this._cachedFilterFeatures,e.width=this._width,e.height=this._height;let n=new _n(e);return this._videoProjections.push(n),n};Rt.prototype.updateVideoCamera=function(e,t,n,o){for(let i=0;i<this._videoProjections.length;i++){let r=this._videoProjections[i];if(r._videoElement.id===e){r.delayAdjustVideoCamera(t,n,o,r._ptzDelay);return}}};Rt.prototype.preRender=function(e){let t=e.frameState.context,n=t.canvas;if(n.width!==this._width||n.height!==this._height){this._width=n.width,this._height=n.height,this.framebuffer=this.framebuffer&&this.framebuffer.destroy(),this.clipPlaneTexture=new Cesium.Texture({context:t,width:this._width,height:this._height,pixelFormat:Cesium.PixelFormat.RGBA,sampler:Cesium.Sampler.NEAREST}),this.framebuffer=new Cesium.Framebuffer({context:t,colorTextures:[this.clipPlaneTexture],destroyAttachments:!1}),this._clearCommand.framebuffer=this.framebuffer;for(let o=0;o<this._videoProjections.length;o++)this._videoProjections[o].updateClipPlaneFramebuffer(this.framebuffer,this.clipPlaneTexture)}for(let o=0;o<this._videoProjections.length;o++)this._videoProjections[o].videoCamera&&(Cesium.Cartesian3.distance(this._videoProjections[o].videoCamera.positionWC,e.view.camera.positionWC)>this._videoProjections[o].visibleDistance||e.view.camera.frustum._offCenterFrustum._cullingVolume.computeVisibility(this._videoProjections[o]._boundingSphere)===Cesium.Intersect.OUTSIDE?this._videoProjections[o].show=!1:this._videoProjections[o].show=!0),this._videoProjections[o].preRender();this._clearCommand.execute(t)};Rt.prototype.addFilter3DTileId=function(e){this.filterPrimitives.cesium3DTileIds.indexOf(e)===-1&&this.filterPrimitives.cesium3DTileIds.push(e)};Rt.prototype.removeFilter3DTileId=function(e){this.filterPrimitives.cesium3DTileIds.splice(this.filterPrimitives.cesium3DTileIds.indexOf(e),1)};Rt.prototype.addFilter3DTileName=function(e){this.filterPrimitives.cesium3DTileNames.indexOf(e)===-1&&this.filterPrimitives.cesium3DTileNames.push(e)};Rt.prototype.removeFilter3DTileName=function(e){this.filterPrimitives.cesium3DTileNames.splice(this.filterPrimitives.cesium3DTileNames.indexOf(e),1)};Rt.prototype.addFilterEntity=function(e){Cesium.defined(e)&&this.filterPrimitives.entityIds.indexOf(e.id)===-1&&this.filterPrimitives.entityIds.push(e.id)};Rt.prototype.removeFilterEntity=function(e){Cesium.defined(e)&&this.filterPrimitives.entityIds.splice(this.filterPrimitives.entityIds.indexOf(e.id),1)};Rt.prototype.getComponentsInVideoCamera=function(e,t){let n,o=this._videoProjections.length;for(let r=0;r<o;r++)if(e===this._videoProjections[r].name){n=this._videoProjections[r];break}let i=[];if(Cesium.defined(n)){let r=n.videoCamera,s=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC);i=t.getComponentsInCullingVolume(s)}return i};Rt.prototype.remove=function(e){for(let t=0,n=this._videoProjections.length;t<n;++t)if(this._videoProjections[t]===e){this._videoProjections.splice(t,1);break}};Rt.prototype.destroy=function(){this._scene.preRender.removeEventListener(this.preRender,this),this.framebuffer=this.framebuffer&&this.framebuffer.destroy(),this.clipPlaneTexture=this.clipPlaneTexture&&this.clipPlaneTexture.destroy(),this.framebuffer=void 0,this.clipPlaneTexture=void 0,this._videoProjections=[]};var zi=Rt;function bt(e){if(!e)throw new Cesium.DeveloperError("options is required.");if(this._readyPromise=Cesium.defer(),this._videoModelArray=[],this._videoPlaneArray=[],this._videoProjectionArray=[],this._jsmpegPlayerArray=[],this._visibleDistance=Cesium.defaultValue(e.visibleDistance,500),this._show=!0,this._name=e.name,this._boundingSphere=new Cesium.BoundingSphere,this._added=new Cesium.Event,this._changed=new Cesium.Event,this._viewer=e.viewer,this._name=e.name,this.wsServe=e.wsServer,this.ev_VideoProjectionManager=new zi({viewer:e.viewer}),Cesium.defined(e.videoJsonFile)){let t=this,n=e.videoJsonFile;if(typeof n=="object")setTimeout(function(){t._init(n,e.videoCatalog)},0);else if(typeof n=="string")if(/\.json$/.test(n)){let o=Cesium.Resource.createIfNeeded(n),i=e.videoCatalog;!i&&n.lastIndexOf("/")!==-1&&(i=n.substring(0,n.lastIndexOf("/")+1)),o.fetchJson().then(function(r){t._init(r,i)}).catch(function(s){console.warn(`\u83B7\u53D6\u89C6\u9891json\u6587\u4EF6\u5931\u8D25\uFF1A${s.message}`)})}else setTimeout(function(){t._init(JSON.parse(n),e.videoCatalog)},0);else throw new Cesium.DeveloperError("options.videoJsonFile is invalid.")}}Object.defineProperties(bt.prototype,{readyPromise:{get:function(){return this._readyPromise.promise}},videoFusionArray:{get:function(){return this._videoProjectionArray}},visibleDistance:{get:function(){return this._visibleDistance},set:function(e){this._visibleDistance=e}},name:{get:function(){return this._name},set:function(e){this._name=e}},show:{get:function(){return this._show},set:function(e){this._show=e;for(let t=0;t<this._videoProjectionArray.length;t++)this._videoProjectionArray[t]._show=e}},boundingSphere:{get:function(){return this._updateBoundingSphere()}},added:{get:function(){return this._added}},changed:{get:function(){return this._changed}}});bt.prototype._init=function(e,t){if(Cesium.defined(e.layerName)&&(this._name=e.layerName),this.wsServe=e.wsserver,Cesium.defined(e.boundingSphere)){let o=e.boundingSphere,i=new Cesium.Cartesian3(o[0],o[1],o[2]);this._boundingSphere=new Cesium.BoundingSphere(i,o[3])}let n=e.data;for(let o=0;o<n.length;o++){let i=n[o],r={};r.viewer=this._viewer,r.originLon=i.camera.position[0],r.originLat=i.camera.position[1],r.originHeight=i.camera.position[2],r.heading=i.camera.orientation[0],r.pitch=i.camera.orientation[1],r.roll=i.camera.orientation[2],r.fov=i.camera.fov,i.video.hsv&&(r.hsvParam=new Cesium.Cartesian3(i.video.hsv[0],i.video.hsv[1],i.video.hsv[2])),i.video.distortion&&(r.distortion=new Cesium.Cartesian2(i.video.distortion[0],i.video.distortion[1])),i.video.alpha&&(r.videoAlpha=i.video.alpha),r.ptzReverse=new Cesium.Cartesian2(0,0),i.camera.ptzReverse&&(r.ptzReverse.x=i.camera.ptzReverse[0],r.ptzReverse.y=i.camera.ptzReverse[1]),r.ptzDelay=300,i.camera.ptzReverse&&(r.ptzDelay=i.camera.ptzDelay);let s=i.camera.visitPoint;s&&(r.viewPoint=Cesium.Cartesian3.fromDegrees(s[0],s[1],s[2]));let a=document.createElement("video");a.id=`v${new Date().getTime()+Math.floor(Math.random()*1e3)}`,r.videoElementID=a.id,a.muted=!0,a.autoplay=!0,a.setAttribute("crossorigin","anonymous"),a.style.display="none",document.body.appendChild(a),r.videoElement=a,r.wsplayerType="",r.wsplayerGBAddress="";let c;if(Cesium.defined(i.video.file)){a.loop=!0;let d=i.video.file;c=d,/^http[s]?:\/\//.test(d)||(d=t+d),a.src=d,a.play()}else if(Cesium.defined(i.video.url)){let d=new Mn({layer:this,wsserver:e.wsserver,rtspurl:i.video.url,mediaplayer:a,isMainStream:i.video.isMainStream,protocol:i.video.protocol,pan:i.camera.ptz?i.camera.ptz[0]:void 0,tilt:i.camera.ptz?i.camera.ptz[1]:void 0,zoom:i.camera.ptz?i.camera.ptz[2]:void 0,ptzType:i.camera.ptzType});r.wsplayerType="rtsp",r.wsplayer=d}else if(i.video.gb){let d=new Mn({layer:this,wsserver:e.wsserver,rtspurl:"",mediaplayer:a,isMainStream:i.video.isMainStream,protocol:i.video.protocol,pan:i.camera.ptz?i.camera.ptz[0]:void 0,tilt:i.camera.ptz?i.camera.ptz[1]:void 0,zoom:i.camera.ptz?i.camera.ptz[2]:void 0,ptzType:i.camera.ptzType});r.wsplayerType="gb",r.wsplayerGBAddress=i.video.gb,r.wsplayer=d}i.camera.ptz&&r.wsplayer&&(r.ptzType=i.camera.ptzType,r.ptzZoomRatio=i.camera.ptzZoomRatio,r.wsplayer.ptzType==="Degree"?(r.pan=i.camera.ptz[0],r.tilt=i.camera.ptz[1],r.zoom=i.camera.ptz[2]):r.wsplayer.ptzType==="Unit"&&(r.pan=r.wsplayer.panUnit2Degree(i.camera.ptz[0]),r.tilt=r.wsplayer.tiltUnit2Degree(i.camera.ptz[1]),r.zoom=i.camera.ptz[2])),i.projection&&(r.projection=i.projection),i.name&&(r.name=i.name),i.video.nearClip&&(r.nearClip=i.video.nearClip),i.video.farClip&&(r.farClip=i.video.farClip),r.layer=this,r.depthType=0,Cesium.defined(i.video)&&Cesium.defined(i.video.depthType)&&(r.depthType=i.video.depthType),r.visibleDistance=i.visibleDistance||i.video.viewDistanceFar;let u=null;i.type&&i.type>0?(r.projectMode=i.type,r.clipPoints=i.video.clipPoints,r.distanceError=i.video.distanceError,u=this.ev_VideoProjectionManager.createVideoProjection(r),this._videoModelArray.push(u)):(u=new yo(r),this._videoPlaneArray.push(u)),u._fileName=c,this._videoProjectionArray.push(u),this._added.raiseEvent(u)}this._readyPromise.resolve(!0)};bt.prototype.addVideoModelProjection=function(e){let t=this.ev_VideoProjectionManager.createVideoProjection(e);return this._videoModelArray.push(t),this._videoProjectionArray.push(t),this._added.raiseEvent(t),t};bt.prototype.addVideoPlaneProjection=function(e){let t=new yo(e);return this._videoPlaneArray.push(t),this._videoProjectionArray.push(t),this._added.raiseEvent(t),t};bt.prototype.getProjectionByName=function(e){for(let t=0;t<this._videoProjectionArray.length;++t)if(this._videoProjectionArray[t]._name===e)return this._videoProjectionArray[t]};bt.prototype.getPositionFromVideoCoordinates=function(e,t,n){let o=new Cesium.Cartesian3;for(let i=0;i<this._videoProjectionArray.length;++i)if(this._videoProjectionArray[i]._name===e){if(this._videoProjectionArray[i]._videoElement.videoWidth===0||this._videoProjectionArray[i]._videoElement.videoHeight===0)return o;let r=this._videoProjectionArray[i]._originLon,s=this._videoProjectionArray[i]._originLat,a=this._videoProjectionArray[i]._originHeight,c=this._videoProjectionArray[i].videoCamera;if(!c)return null;let u=Cesium.Cartesian3.fromDegrees(r,s,a),d=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(u,d),(t>1||n>1)&&(t=t/this._videoProjectionArray[i]._videoElement.videoWidth,n=n/this._videoProjectionArray[i]._videoElement.videoHeight,t=t*2-1,n=n*2-1);let m=Cesium.Matrix4.setTranslation(c.viewMatrix,new Cesium.Cartesian3,new Cesium.Matrix4),p=Cesium.Matrix4.multiply(c.frustum.projectionMatrix,m,new Cesium.Matrix4),_=Cesium.Matrix4.inverse(p,new Cesium.Matrix4),g=new Cesium.Cartesian4(t,n,100,1);Cesium.Matrix4.multiplyByVector(_,g,g);let v=new Cesium.Ray(u,g),b=this._viewer.scene.pickFromRay(v);if(b&&b.position)o=b.position;else return o=void 0,o;let A=this._viewer.scene.globe.ellipsoid.cartesianToCartographic(o);return o.x=Cesium.Math.toDegrees(A.longitude),o.y=Cesium.Math.toDegrees(A.latitude),o.z=A.height,o}};bt.prototype.getVideoCoordinatesFromPosition=function(e,t){let n=new Cesium.Cartesian2,o=Cesium.Cartesian3.fromDegrees(t.x,t.y,t.z);for(let i=0;i<this._videoProjectionArray.length;++i)if(this._videoProjectionArray[i]._name===e){if(this._videoProjectionArray[i]._videoElement.videoWidth===0||this._videoProjectionArray[i]._videoElement.videoHeight===0)return n;let r=this._videoProjectionArray[i]._originLon,s=this._videoProjectionArray[i]._originLat,a=this._videoProjectionArray[i]._originHeight,c=this._videoProjectionArray[i].videoCamera;if(!c)return null;let u=Cesium.Cartesian3.fromDegrees(r,s,a),d=Cesium.Cartesian3.subtract(o,u,new Cesium.Cartesian3),m=new Cesium.Cartesian4(d.x,d.y,d.z,1),p=Cesium.Matrix4.setTranslation(c.viewMatrix,new Cesium.Cartesian3,new Cesium.Matrix4),_=Cesium.Matrix4.multiply(c.frustum.projectionMatrix,p,new Cesium.Matrix4);return Cesium.Matrix4.multiplyByVector(_,m,m),n.x=m.x/m.w,n.x=(n.x+1)/2*this._videoProjectionArray[i]._videoElement.videoWidth,n.y=m.y/m.w,n.y=(n.y+1)/2*this._videoProjectionArray[i]._videoElement.videoHeight,n}return n};bt.prototype.getProjections=function(){return this._videoProjectionArray};bt.prototype.getPlaneProjections=function(){return this._videoPlaneArray};bt.prototype.getModelProjections=function(){return this._videoModelArray};bt.prototype.getJsonData=function(){let e=this.boundingSphere,t={layerName:this._name,wsserver:this.wsServe,boundingSphere:[e.center.x,e.center.y,e.center.z,e.radius],data:[]},n=this._videoProjectionArray;for(let o=0;o<n.length;++o){let i=n[o].getConfiguration();i&&t.data.push(i)}return t};bt.prototype._updateBoundingSphere=function(){let e=[];for(let t=0;t<this._videoProjectionArray.length;++t){let o=this._videoProjectionArray[t].videoCamera;if(!o)return this._boundingSphere;e.push(o.positionWC)}return this._boundingSphere=Cesium.BoundingSphere.fromPoints(e,this._boundingSphere),this._boundingSphere.radius+=100,this._boundingSphere};bt.prototype.remove=function(e){if(e instanceof _n){for(let t=0,n=this._videoModelArray.length;t<n;++t)if(this._videoModelArray[t]===e){this._videoModelArray.splice(t,1);break}this.ev_VideoProjectionManager.remove(e)}else if(e instanceof yo){for(let t=0,n=this._videoPlaneArray.length;t<n;++t)if(this._videoPlaneArray[t]===e){this._videoPlaneArray.splice(t,1);break}}else return;for(let t=0,n=this._videoProjectionArray.length;t<n;++t)if(this._videoProjectionArray[t]===e){this._videoProjectionArray.splice(t,1),e.destroy();break}};bt.prototype.destroy=function(){this.ev_VideoProjectionManager!==null&&(this.ev_VideoProjectionManager.destroy(),this.ev_VideoProjectionManager=null);for(let e=0;e<this._videoProjectionArray.length;++e){let t=this._videoProjectionArray[e];this._viewer.scene.primitives.remove(t)}for(let e=0;e<this._videoProjectionArray.length;e++)document.body.removeChild(this._videoProjectionArray[e]._videoElement),this._videoProjectionArray[e].destroy();this._videoModelArray.length=0,this._videoPlaneArray.length=0,this._videoProjectionArray.length=0,this._added=null,this._changed=null,this._viewer=null};var Wo=bt;var Ge={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(Ge,{maximumCombinedTextureImageUnits:{get:function(){return Ge._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return Ge._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return Ge._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return Ge._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return Ge._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return Ge._maximumTextureSize}},maximumVaryingVectors:{get:function(){return Ge._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return Ge._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return Ge._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return Ge._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return Ge._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return Ge._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return Ge._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return Ge._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return Ge._maximumViewportWidth}},maximumViewportHeight:{get:function(){return Ge._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return Ge._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return Ge._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return Ge._maximumColorAttachments}},maximumSamples:{get:function(){return Ge._maximumSamples}},highpFloatSupported:{get:function(){return Ge._highpFloatSupported}},highpIntSupported:{get:function(){return Ge._highpIntSupported}}});var Re=Ge;function Dh(e,t){Re._maximumCombinedTextureImageUnits=Cesium.ContextLimits._maximumCombinedTextureImageUnits,Re._maximumCubeMapSize=Cesium.ContextLimits._maximumCubeMapSize,Re._maximumFragmentUniformVectors=Cesium.ContextLimits._maximumFragmentUniformVectors,Re._maximumTextureImageUnits=Cesium.ContextLimits._maximumTextureImageUnits,Re._maximumRenderbufferSize=Cesium.ContextLimits._maximumRenderbufferSize,Re._maximumTextureSize=Cesium.ContextLimits._maximumTextureSize,Re._maximumVertexAttributes=Cesium.ContextLimits._maximumVertexAttributes,Re._maximumVertexTextureImageUnits=Cesium.ContextLimits._maximumVertexTextureImageUnits,Re._maximumVertexUniformVectors=Cesium.ContextLimits._maximumVertexUniformVectors,Re._minimumAliasedLineWidth=Cesium.ContextLimits._minimumAliasedLineWidth,Re._maximumAliasedLineWidth=Cesium.ContextLimits._maximumAliasedLineWidth,Re._minimumAliasedPointSize=Cesium.ContextLimits._minimumAliasedPointSize,Re._maximumAliasedPointSize=Cesium.ContextLimits._maximumAliasedPointSize,Re._maximumViewportWidth=Cesium.ContextLimits._maximumViewportWidth,Re._maximumViewportHeight=Cesium.ContextLimits._maximumViewportHeight,Re._highpFloatSupported=Cesium.ContextLimits._highpFloatSupported,Re._highpIntSupported=Cesium.ContextLimits._highpIntSupported,Re._maximumTextureFilterAnisotropy=Cesium.ContextLimits._maximumTextureFilterAnisotropy,Re._maximumDrawBuffers=Cesium.ContextLimits._maximumDrawBuffers,Re._maximumColorAttachments=Cesium.ContextLimits._maximumColorAttachments}var Ka=Dh;function Nh(e){return e!=null}var f=Nh;function Xn(e){this.name="DeveloperError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}f(Object.create)&&(Xn.prototype=Object.create(Error.prototype),Xn.prototype.constructor=Xn);Xn.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return f(this.stack)&&(e+=`
${this.stack.toString()}`),e};Xn.throwInstantiationError=function(){throw new Xn("This function defines an interface and should not be called directly.")};var ot=Xn;var tt={};tt.typeOf={};function Lh(e){return`${e} is required, actual value was undefined`}function go(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}tt.defined=function(e,t){if(!f(t))throw new ot(Lh(e))};tt.typeOf.func=function(e,t){if(typeof t!="function")throw new ot(go(typeof t,"function",e))};tt.typeOf.string=function(e,t){if(typeof t!="string")throw new ot(go(typeof t,"string",e))};tt.typeOf.number=function(e,t){if(typeof t!="number")throw new ot(go(typeof t,"number",e))};tt.typeOf.number.lessThan=function(e,t,n){if(tt.typeOf.number(e,t),t>=n)throw new ot(`Expected ${e} to be less than ${n}, actual value was ${t}`)};tt.typeOf.number.lessThanOrEquals=function(e,t,n){if(tt.typeOf.number(e,t),t>n)throw new ot(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)};tt.typeOf.number.greaterThan=function(e,t,n){if(tt.typeOf.number(e,t),t<=n)throw new ot(`Expected ${e} to be greater than ${n}, actual value was ${t}`)};tt.typeOf.number.greaterThanOrEquals=function(e,t,n){if(tt.typeOf.number(e,t),t<n)throw new ot(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)};tt.typeOf.object=function(e,t){if(typeof t!="object")throw new ot(go(typeof t,"object",e))};tt.typeOf.bool=function(e,t){if(typeof t!="boolean")throw new ot(go(typeof t,"boolean",e))};tt.typeOf.bigint=function(e,t){if(typeof t!="bigint")throw new ot(go(typeof t,"bigint",e))};tt.typeOf.number.equals=function(e,t,n,o){if(tt.typeOf.number(e,n),tt.typeOf.number(t,o),n!==o)throw new ot(`${e} must be equal to ${t}, the actual values are ${n} and ${o}`)};var zn=tt;function Za(e,t){return e??t}Za.EMPTY_OBJECT=Object.freeze({});var y=Za;var Di=Xa(Ja(),1);var W={};W.EPSILON1=.1;W.EPSILON2=.01;W.EPSILON3=.001;W.EPSILON4=1e-4;W.EPSILON5=1e-5;W.EPSILON6=1e-6;W.EPSILON7=1e-7;W.EPSILON8=1e-8;W.EPSILON9=1e-9;W.EPSILON10=1e-10;W.EPSILON11=1e-11;W.EPSILON12=1e-12;W.EPSILON13=1e-13;W.EPSILON14=1e-14;W.EPSILON15=1e-15;W.EPSILON16=1e-16;W.EPSILON17=1e-17;W.EPSILON18=1e-18;W.EPSILON19=1e-19;W.EPSILON20=1e-20;W.EPSILON21=1e-21;W.GRAVITATIONALPARAMETER=3986004418e5;W.SOLAR_RADIUS=6955e5;W.LUNAR_RADIUS=1737400;W.SIXTY_FOUR_KILOBYTES=64*1024;W.FOUR_GIGABYTES=4*1024*1024*1024;W.sign=y(Math.sign,function(t){return t=+t,t===0||t!==t?t:t>0?1:-1});W.signNotZero=function(e){return e<0?-1:1};W.toSNorm=function(e,t){return t=y(t,255),Math.round((W.clamp(e,-1,1)*.5+.5)*t)};W.fromSNorm=function(e,t){return t=y(t,255),W.clamp(e,0,t)/t*2-1};W.normalize=function(e,t,n){return n=Math.max(n-t,0),n===0?0:W.clamp((e-t)/n,0,1)};W.sinh=y(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2});W.cosh=y(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2});W.lerp=function(e,t,n){return(1-n)*e+n*t};W.PI=Math.PI;W.ONE_OVER_PI=1/Math.PI;W.PI_OVER_TWO=Math.PI/2;W.PI_OVER_THREE=Math.PI/3;W.PI_OVER_FOUR=Math.PI/4;W.PI_OVER_SIX=Math.PI/6;W.THREE_PI_OVER_TWO=3*Math.PI/2;W.TWO_PI=2*Math.PI;W.ONE_OVER_TWO_PI=1/(2*Math.PI);W.RADIANS_PER_DEGREE=Math.PI/180;W.DEGREES_PER_RADIAN=180/Math.PI;W.RADIANS_PER_ARCSECOND=W.RADIANS_PER_DEGREE/3600;W.toRadians=function(e){return e*W.RADIANS_PER_DEGREE};W.toDegrees=function(e){return e*W.DEGREES_PER_RADIAN};W.convertLongitudeRange=function(e){let t=W.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n};W.clampToLatitudeRange=function(e){return W.clamp(e,-1*W.PI_OVER_TWO,W.PI_OVER_TWO)};W.negativePiToPi=function(e){return e>=-W.PI&&e<=W.PI?e:W.zeroToTwoPi(e+W.PI)-W.PI};W.zeroToTwoPi=function(e){if(e>=0&&e<=W.TWO_PI)return e;let t=W.mod(e,W.TWO_PI);return Math.abs(t)<W.EPSILON14&&Math.abs(e)>W.EPSILON14?W.TWO_PI:t};W.mod=function(e,t){return W.sign(e)===W.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t};W.equalsEpsilon=function(e,t,n,o){n=y(n,0),o=y(o,n);let i=Math.abs(e-t);return i<=o||i<=n*Math.max(Math.abs(e),Math.abs(t))};W.lessThan=function(e,t,n){return e-t<-n};W.lessThanOrEquals=function(e,t,n){return e-t<n};W.greaterThan=function(e,t,n){return e-t>n};W.greaterThanOrEquals=function(e,t,n){return e-t>-n};var Ni=[1];W.factorial=function(e){let t=Ni.length;if(e>=t){let n=Ni[t-1];for(let o=t;o<=e;o++){let i=n*o;Ni.push(i),n=i}}return Ni[e]};W.incrementWrap=function(e,t,n){return n=y(n,0),++e,e>t&&(e=n),e};W.isPowerOfTwo=function(e){return e!==0&&(e&e-1)===0};W.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e,e};W.previousPowerOfTwo=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e|=e>>32,e=(e>>>0)-(e>>>1),e};W.clamp=function(e,t,n){return e<t?t:e>n?n:e};var ec=new Di.default;W.setRandomNumberSeed=function(e){ec=new Di.default(e)};W.nextRandomNumber=function(){return ec.random()};W.randomBetween=function(e,t){return W.nextRandomNumber()*(t-e)+e};W.acosClamped=function(e){return Math.acos(W.clamp(e,-1,1))};W.asinClamped=function(e){return Math.asin(W.clamp(e,-1,1))};W.chordLength=function(e,t){return 2*t*Math.sin(e*.5)};W.logBase=function(e,t){return Math.log(e)/Math.log(t)};W.cbrt=y(Math.cbrt,function(t){let n=Math.pow(Math.abs(t),.3333333333333333);return t<0?-n:n});W.log2=y(Math.log2,function(t){return Math.log(t)*Math.LOG2E});W.fog=function(e,t){let n=e*t;return 1-Math.exp(-(n*n))};W.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)};W.fastApproximateAtan2=function(e,t){let n,o=Math.abs(e);n=Math.abs(t);let i=Math.max(o,n);n=Math.min(o,n);let r=n/i;return o=W.fastApproximateAtan(r),o=Math.abs(t)>Math.abs(e)?W.PI_OVER_TWO-o:o,o=e<0?W.PI-o:o,o=t<0?-o:o,o};var O=W;function G(e,t,n){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0)}G.fromSpherical=function(e,t){f(t)||(t=new G);let n=e.clock,o=e.cone,i=y(e.magnitude,1),r=i*Math.sin(o);return t.x=r*Math.cos(n),t.y=r*Math.sin(n),t.z=i*Math.cos(o),t};G.fromElements=function(e,t,n,o){return f(o)?(o.x=e,o.y=t,o.z=n,o):new G(e,t,n)};G.clone=function(e,t){if(!!f(e))return f(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new G(e.x,e.y,e.z)};G.fromCartesian4=G.clone;G.packedLength=3;G.pack=function(e,t,n){return n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t};G.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new G),n.x=e[t++],n.y=e[t++],n.z=e[t],n};G.packArray=function(e,t){let n=e.length,o=n*3;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)G.pack(e[i],t,i*3);return t};G.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/3:t=new Array(n/3);for(let o=0;o<n;o+=3){let i=o/3;t[i]=G.unpack(e,o,t[i])}return t};G.fromArray=G.unpack;G.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)};G.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)};G.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n};G.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n};G.clamp=function(e,t,n,o){let i=O.clamp(e.x,t.x,n.x),r=O.clamp(e.y,t.y,n.y),s=O.clamp(e.z,t.z,n.z);return o.x=i,o.y=r,o.z=s,o};G.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z};G.magnitude=function(e){return Math.sqrt(G.magnitudeSquared(e))};var Fi=new G;G.distance=function(e,t){return G.subtract(e,t,Fi),G.magnitude(Fi)};G.distanceSquared=function(e,t){return G.subtract(e,t,Fi),G.magnitudeSquared(Fi)};G.normalize=function(e,t){let n=G.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t};G.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z};G.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n};G.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n};G.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n};G.subtract=function(e,t,n){return f(n)||(n=new G),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n};G.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n};G.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n};G.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t};G.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var tc=new G;G.lerp=function(e,t,n,o){return G.multiplyByScalar(t,n,tc),o=G.multiplyByScalar(e,1-n,o),G.add(tc,o,o)};var Li=new G,Qr=new G;G.angleBetween=function(e,t){G.normalize(e,Li),G.normalize(t,Qr);let n=G.dot(Li,Qr),o=G.magnitude(G.cross(Li,Qr,Li));return Math.atan2(o,n)};var Fh=new G;G.mostOrthogonalAxis=function(e,t){let n=G.normalize(e,Fh);return G.abs(n,n),n.x<=n.y?n.x<=n.z?t=G.clone(G.UNIT_X,t):t=G.clone(G.UNIT_Z,t):n.y<=n.z?t=G.clone(G.UNIT_Y,t):t=G.clone(G.UNIT_Z,t),t};G.projectVector=function(e,t,n){let o=G.dot(e,t)/G.dot(t,t);return G.multiplyByScalar(t,o,n)};G.equals=function(e,t){return e===t||f(e)&&f(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};G.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]};G.equalsEpsilon=function(e,t,n,o){return e===t||f(e)&&f(t)&&O.equalsEpsilon(e.x,t.x,n,o)&&O.equalsEpsilon(e.y,t.y,n,o)&&O.equalsEpsilon(e.z,t.z,n,o)};G.cross=function(e,t,n){let o=e.x,i=e.y,r=e.z,s=t.x,a=t.y,c=t.z,u=i*c-r*a,d=r*s-o*c,m=o*a-i*s;return n.x=u,n.y=d,n.z=m,n};G.midpoint=function(e,t,n){return n.x=(e.x+t.x)*.5,n.y=(e.y+t.y)*.5,n.z=(e.z+t.z)*.5,n};G.fromDegrees=function(e,t,n,o,i){return e=O.toRadians(e),t=O.toRadians(t),G.fromRadians(e,t,n,o,i)};var Ut=new G,Co=new G;G.wgs84RadiiSquared=new G(6378137*6378137,6378137*6378137,6356752314245179e-9*6356752314245179e-9);G.fromRadians=function(e,t,n,o,i){n=y(n,0);let r=f(o)?o.radiiSquared:this.wgs84RadiiSquared,s=Math.cos(t);Ut.x=s*Math.cos(e),Ut.y=s*Math.sin(e),Ut.z=Math.sin(t),Ut=G.normalize(Ut,Ut),G.multiplyComponents(r,Ut,Co);let a=Math.sqrt(G.dot(Ut,Co));return Co=G.divideByScalar(Co,a,Co),Ut=G.multiplyByScalar(Ut,n,Ut),f(i)||(i=new G),G.add(Co,Ut,i)};G.fromDegreesArray=function(e,t,n){let o=e.length;f(n)?n.length=o/2:n=new Array(o/2);for(let i=0;i<o;i+=2){let r=e[i],s=e[i+1],a=i/2;n[a]=G.fromDegrees(r,s,0,t,n[a])}return n};G.fromRadiansArray=function(e,t,n){let o=e.length;f(n)?n.length=o/2:n=new Array(o/2);for(let i=0;i<o;i+=2){let r=e[i],s=e[i+1],a=i/2;n[a]=G.fromRadians(r,s,0,t,n[a])}return n};G.fromDegreesArrayHeights=function(e,t,n){let o=e.length;f(n)?n.length=o/3:n=new Array(o/3);for(let i=0;i<o;i+=3){let r=e[i],s=e[i+1],a=e[i+2],c=i/3;n[c]=G.fromDegrees(r,s,a,t,n[c])}return n};G.fromRadiansArrayHeights=function(e,t,n){let o=e.length;f(n)?n.length=o/3:n=new Array(o/3);for(let i=0;i<o;i+=3){let r=e[i],s=e[i+1],a=e[i+2],c=i/3;n[c]=G.fromRadians(r,s,a,t,n[c])}return n};G.ZERO=Object.freeze(new G(0,0,0));G.ONE=Object.freeze(new G(1,1,1));G.UNIT_X=Object.freeze(new G(1,0,0));G.UNIT_Y=Object.freeze(new G(0,1,0));G.UNIT_Z=Object.freeze(new G(0,0,1));G.prototype.clone=function(e){return G.clone(this,e)};G.prototype.equals=function(e){return G.equals(this,e)};G.prototype.equalsEpsilon=function(e,t,n){return G.equalsEpsilon(this,e,t,n)};G.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var l=G;var Dn,Ye={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},Pt={};Object.defineProperties(Pt,{element:{get:function(){if(!!Pt.supportsFullscreen())return document[Ye.fullscreenElement]}},changeEventName:{get:function(){if(!!Pt.supportsFullscreen())return Ye.fullscreenchange}},errorEventName:{get:function(){if(!!Pt.supportsFullscreen())return Ye.fullscreenerror}},enabled:{get:function(){if(!!Pt.supportsFullscreen())return document[Ye.fullscreenEnabled]}},fullscreen:{get:function(){if(!!Pt.supportsFullscreen())return Pt.element!==null}}});Pt.supportsFullscreen=function(){if(f(Dn))return Dn;Dn=!1;let e=document.body;if(typeof e.requestFullscreen=="function")return Ye.requestFullscreen="requestFullscreen",Ye.exitFullscreen="exitFullscreen",Ye.fullscreenEnabled="fullscreenEnabled",Ye.fullscreenElement="fullscreenElement",Ye.fullscreenchange="fullscreenchange",Ye.fullscreenerror="fullscreenerror",Dn=!0,Dn;let t=["webkit","moz","o","ms","khtml"],n;for(let o=0,i=t.length;o<i;++o){let r=t[o];n=`${r}RequestFullscreen`,typeof e[n]=="function"?(Ye.requestFullscreen=n,Dn=!0):(n=`${r}RequestFullScreen`,typeof e[n]=="function"&&(Ye.requestFullscreen=n,Dn=!0)),n=`${r}ExitFullscreen`,typeof document[n]=="function"?Ye.exitFullscreen=n:(n=`${r}CancelFullScreen`,typeof document[n]=="function"&&(Ye.exitFullscreen=n)),n=`${r}FullscreenEnabled`,document[n]!==void 0?Ye.fullscreenEnabled=n:(n=`${r}FullScreenEnabled`,document[n]!==void 0&&(Ye.fullscreenEnabled=n)),n=`${r}FullscreenElement`,document[n]!==void 0?Ye.fullscreenElement=n:(n=`${r}FullScreenElement`,document[n]!==void 0&&(Ye.fullscreenElement=n)),n=`${r}fullscreenchange`,document[`on${n}`]!==void 0&&(r==="ms"&&(n="MSFullscreenChange"),Ye.fullscreenchange=n),n=`${r}fullscreenerror`,document[`on${n}`]!==void 0&&(r==="ms"&&(n="MSFullscreenError"),Ye.fullscreenerror=n)}return Dn};Pt.requestFullscreen=function(e,t){!Pt.supportsFullscreen()||e[Ye.requestFullscreen]({vrDisplay:t})};Pt.exitFullscreen=function(){!Pt.supportsFullscreen()||document[Ye.exitFullscreen]()};Pt._names=Ye;var nc=Pt;var _t;typeof navigator<"u"?_t=navigator:_t={};function $n(e){let t=e.split(".");for(let n=0,o=t.length;n<o;++n)t[n]=parseInt(t[n],10);return t}var Bi,oc;function is(){if(!f(Bi)&&(Bi=!1,!Hi())){let e=/ Chrome\/([\.0-9]+)/.exec(_t.userAgent);e!==null&&(Bi=!0,oc=$n(e[1]))}return Bi}function Bh(){return is()&&oc}var Ui,ic;function rc(){if(!f(Ui)&&(Ui=!1,!is()&&!Hi()&&/ Safari\/[\.0-9]+/.test(_t.userAgent))){let e=/ Version\/([\.0-9]+)/.exec(_t.userAgent);e!==null&&(Ui=!0,ic=$n(e[1]))}return Ui}function Uh(){return rc()&&ic}var Vi,ns;function sc(){if(!f(Vi)){Vi=!1;let e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(_t.userAgent);e!==null&&(Vi=!0,ns=$n(e[1]),ns.isNightly=!!e[2])}return Vi}function Vh(){return sc()&&ns}var Yo,os;function ac(){if(!f(Yo)){Yo=!1;let e;_t.appName==="Microsoft Internet Explorer"?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(_t.userAgent),e!==null&&(Yo=!0,os=$n(e[1]))):_t.appName==="Netscape"&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(_t.userAgent),e!==null&&(Yo=!0,os=$n(e[1])))}return Yo}function kh(){return ac()&&os}var ki,cc;function Hi(){if(!f(ki)){ki=!1;let e=/ Edg\/([\.0-9]+)/.exec(_t.userAgent);e!==null&&(ki=!0,cc=$n(e[1]))}return ki}function Gh(){return Hi()&&cc}var Gi,uc;function rs(){if(!f(Gi)){Gi=!1;let e=/Firefox\/([\.0-9]+)/.exec(_t.userAgent);e!==null&&(Gi=!0,uc=$n(e[1]))}return Gi}var Jr;function jh(){return f(Jr)||(Jr=/Windows/i.test(_t.appVersion)),Jr}var es;function Hh(){return f(es)||(es=navigator.platform==="iPhone"||navigator.platform==="iPod"||navigator.platform==="iPad"),es}function qh(){return rs()&&uc}var ts;function Wh(){return f(ts)||(ts=!rs()&&typeof PointerEvent<"u"&&(!f(_t.pointerEnabled)||_t.pointerEnabled)),ts}var fc,ji;function lc(){if(!f(ji)){let e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let t=e.style.imageRendering;ji=f(t)&&t!=="",ji&&(fc=t)}return ji}function Yh(){return lc()?fc:void 0}function At(){return At._result}At._promise=void 0;At._result=void 0;At.initialize=function(){return f(At._promise)||(At._promise=new Promise(e=>{let t=new Image;t.onload=function(){At._result=t.width>0&&t.height>0,e(At._result)},t.onerror=function(){At._result=!1,e(At._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),At._promise};Object.defineProperties(At,{initialized:{get:function(){return f(At._result)}}});var vo=[];typeof ArrayBuffer<"u"&&(vo.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray<"u"&&vo.push(Uint8ClampedArray),typeof Uint8ClampedArray<"u"&&vo.push(Uint8ClampedArray),typeof BigInt64Array<"u"&&vo.push(BigInt64Array),typeof BigUint64Array<"u"&&vo.push(BigUint64Array));var tn={isChrome:is,chromeVersion:Bh,isSafari:rc,safariVersion:Uh,isWebkit:sc,webkitVersion:Vh,isInternetExplorer:ac,internetExplorerVersion:kh,isEdge:Hi,edgeVersion:Gh,isFirefox:rs,firefoxVersion:qh,isWindows:jh,isIPadOrIOS:Hh,hardwareConcurrency:y(_t.hardwareConcurrency,3),supportsPointerEvents:Wh,supportsImageRenderingPixelated:lc,supportsWebP:At,imageRenderingValue:Yh,typedArrayTypes:vo};tn.supportsBasis=function(e){return tn.supportsWebAssembly()&&e.context.supportsBasis};tn.supportsFullscreen=function(){return nc.supportsFullscreen()};tn.supportsTypedArrays=function(){return typeof ArrayBuffer<"u"};tn.supportsBigInt64Array=function(){return typeof BigInt64Array<"u"};tn.supportsBigUint64Array=function(){return typeof BigUint64Array<"u"};tn.supportsBigInt=function(){return typeof BigInt<"u"};tn.supportsWebWorkers=function(){return typeof Worker<"u"};tn.supportsWebAssembly=function(){return typeof WebAssembly<"u"};var Wt=tn;function ss(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n*6<1?e+(t-e)*6*n:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}function E(e,t,n,o){this.red=y(e,1),this.green=y(t,1),this.blue=y(n,1),this.alpha=y(o,1)}E.fromCartesian4=function(e,t){return f(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new E(e.x,e.y,e.z,e.w)};E.fromBytes=function(e,t,n,o,i){return e=E.byteToFloat(y(e,255)),t=E.byteToFloat(y(t,255)),n=E.byteToFloat(y(n,255)),o=E.byteToFloat(y(o,255)),f(i)?(i.red=e,i.green=t,i.blue=n,i.alpha=o,i):new E(e,t,n,o)};E.fromAlpha=function(e,t,n){return f(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=t,n):new E(e.red,e.green,e.blue,t)};var as,cs,gn;Wt.supportsTypedArrays()&&(as=new ArrayBuffer(4),cs=new Uint32Array(as),gn=new Uint8Array(as));E.fromRgba=function(e,t){return cs[0]=e,E.fromBytes(gn[0],gn[1],gn[2],gn[3],t)};E.fromHsl=function(e,t,n,o,i){e=y(e,0)%1,t=y(t,0),n=y(n,0),o=y(o,1);let r=n,s=n,a=n;if(t!==0){let c;n<.5?c=n*(1+t):c=n+t-n*t;let u=2*n-c;r=ss(u,c,e+1/3),s=ss(u,c,e),a=ss(u,c,e-1/3)}return f(i)?(i.red=r,i.green=s,i.blue=a,i.alpha=o,i):new E(r,s,a,o)};E.fromRandom=function(e,t){e=y(e,y.EMPTY_OBJECT);let n=e.red;if(!f(n)){let s=y(e.minimumRed,0),a=y(e.maximumRed,1);n=s+O.nextRandomNumber()*(a-s)}let o=e.green;if(!f(o)){let s=y(e.minimumGreen,0),a=y(e.maximumGreen,1);o=s+O.nextRandomNumber()*(a-s)}let i=e.blue;if(!f(i)){let s=y(e.minimumBlue,0),a=y(e.maximumBlue,1);i=s+O.nextRandomNumber()*(a-s)}let r=e.alpha;if(!f(r)){let s=y(e.minimumAlpha,0),a=y(e.maximumAlpha,1);r=s+O.nextRandomNumber()*(a-s)}return f(t)?(t.red=n,t.green=o,t.blue=i,t.alpha=r,t):new E(n,o,i,r)};var Xh=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,$h=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,Kh=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,Zh=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;E.fromCssColorString=function(e,t){f(t)||(t=new E),e=e.replace(/\s/g,"");let n=E[e.toUpperCase()];if(f(n))return E.clone(n,t),t;let o=Xh.exec(e);return o!==null?(t.red=parseInt(o[1],16)/15,t.green=parseInt(o[2],16)/15,t.blue=parseInt(o[3],16)/15,t.alpha=parseInt(y(o[4],"f"),16)/15,t):(o=$h.exec(e),o!==null?(t.red=parseInt(o[1],16)/255,t.green=parseInt(o[2],16)/255,t.blue=parseInt(o[3],16)/255,t.alpha=parseInt(y(o[4],"ff"),16)/255,t):(o=Kh.exec(e),o!==null?(t.red=parseFloat(o[1])/(o[1].substr(-1)==="%"?100:255),t.green=parseFloat(o[2])/(o[2].substr(-1)==="%"?100:255),t.blue=parseFloat(o[3])/(o[3].substr(-1)==="%"?100:255),t.alpha=parseFloat(y(o[4],"1.0")),t):(o=Zh.exec(e),o!==null?E.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(y(o[4],"1.0")),t):(t=void 0,t))))};E.packedLength=4;E.pack=function(e,t,n){return n=y(n,0),t[n++]=e.red,t[n++]=e.green,t[n++]=e.blue,t[n]=e.alpha,t};E.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new E),n.red=e[t++],n.green=e[t++],n.blue=e[t++],n.alpha=e[t],n};E.byteToFloat=function(e){return e/255};E.floatToByte=function(e){return e===1?255:e*256|0};E.clone=function(e,t){if(!!f(e))return f(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new E(e.red,e.green,e.blue,e.alpha)};E.equals=function(e,t){return e===t||f(e)&&f(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha};E.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]};E.prototype.clone=function(e){return E.clone(this,e)};E.prototype.equals=function(e){return E.equals(this,e)};E.prototype.equalsEpsilon=function(e,t){return this===e||f(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t};E.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`};E.prototype.toCssColorString=function(){let e=E.floatToByte(this.red),t=E.floatToByte(this.green),n=E.floatToByte(this.blue);return this.alpha===1?`rgb(${e},${t},${n})`:`rgba(${e},${t},${n},${this.alpha})`};E.prototype.toCssHexString=function(){let e=E.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=E.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let n=E.floatToByte(this.blue).toString(16);if(n.length<2&&(n=`0${n}`),this.alpha<1){let o=E.floatToByte(this.alpha).toString(16);return o.length<2&&(o=`0${o}`),`#${e}${t}${n}${o}`}return`#${e}${t}${n}`};E.prototype.toBytes=function(e){let t=E.floatToByte(this.red),n=E.floatToByte(this.green),o=E.floatToByte(this.blue),i=E.floatToByte(this.alpha);return f(e)?(e[0]=t,e[1]=n,e[2]=o,e[3]=i,e):[t,n,o,i]};E.prototype.toRgba=function(){return gn[0]=E.floatToByte(this.red),gn[1]=E.floatToByte(this.green),gn[2]=E.floatToByte(this.blue),gn[3]=E.floatToByte(this.alpha),cs[0]};E.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t};E.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t};E.prototype.withAlpha=function(e,t){return E.fromAlpha(this,e,t)};E.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n};E.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n};E.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n};E.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n};E.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n};E.lerp=function(e,t,n,o){return o.red=O.lerp(e.red,t.red,n),o.green=O.lerp(e.green,t.green,n),o.blue=O.lerp(e.blue,t.blue,n),o.alpha=O.lerp(e.alpha,t.alpha,n),o};E.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n};E.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n};E.ALICEBLUE=Object.freeze(E.fromCssColorString("#F0F8FF"));E.ANTIQUEWHITE=Object.freeze(E.fromCssColorString("#FAEBD7"));E.AQUA=Object.freeze(E.fromCssColorString("#00FFFF"));E.AQUAMARINE=Object.freeze(E.fromCssColorString("#7FFFD4"));E.AZURE=Object.freeze(E.fromCssColorString("#F0FFFF"));E.BEIGE=Object.freeze(E.fromCssColorString("#F5F5DC"));E.BISQUE=Object.freeze(E.fromCssColorString("#FFE4C4"));E.BLACK=Object.freeze(E.fromCssColorString("#000000"));E.BLANCHEDALMOND=Object.freeze(E.fromCssColorString("#FFEBCD"));E.BLUE=Object.freeze(E.fromCssColorString("#0000FF"));E.BLUEVIOLET=Object.freeze(E.fromCssColorString("#8A2BE2"));E.BROWN=Object.freeze(E.fromCssColorString("#A52A2A"));E.BURLYWOOD=Object.freeze(E.fromCssColorString("#DEB887"));E.CADETBLUE=Object.freeze(E.fromCssColorString("#5F9EA0"));E.CHARTREUSE=Object.freeze(E.fromCssColorString("#7FFF00"));E.CHOCOLATE=Object.freeze(E.fromCssColorString("#D2691E"));E.CORAL=Object.freeze(E.fromCssColorString("#FF7F50"));E.CORNFLOWERBLUE=Object.freeze(E.fromCssColorString("#6495ED"));E.CORNSILK=Object.freeze(E.fromCssColorString("#FFF8DC"));E.CRIMSON=Object.freeze(E.fromCssColorString("#DC143C"));E.CYAN=Object.freeze(E.fromCssColorString("#00FFFF"));E.DARKBLUE=Object.freeze(E.fromCssColorString("#00008B"));E.DARKCYAN=Object.freeze(E.fromCssColorString("#008B8B"));E.DARKGOLDENROD=Object.freeze(E.fromCssColorString("#B8860B"));E.DARKGRAY=Object.freeze(E.fromCssColorString("#A9A9A9"));E.DARKGREEN=Object.freeze(E.fromCssColorString("#006400"));E.DARKGREY=E.DARKGRAY;E.DARKKHAKI=Object.freeze(E.fromCssColorString("#BDB76B"));E.DARKMAGENTA=Object.freeze(E.fromCssColorString("#8B008B"));E.DARKOLIVEGREEN=Object.freeze(E.fromCssColorString("#556B2F"));E.DARKORANGE=Object.freeze(E.fromCssColorString("#FF8C00"));E.DARKORCHID=Object.freeze(E.fromCssColorString("#9932CC"));E.DARKRED=Object.freeze(E.fromCssColorString("#8B0000"));E.DARKSALMON=Object.freeze(E.fromCssColorString("#E9967A"));E.DARKSEAGREEN=Object.freeze(E.fromCssColorString("#8FBC8F"));E.DARKSLATEBLUE=Object.freeze(E.fromCssColorString("#483D8B"));E.DARKSLATEGRAY=Object.freeze(E.fromCssColorString("#2F4F4F"));E.DARKSLATEGREY=E.DARKSLATEGRAY;E.DARKTURQUOISE=Object.freeze(E.fromCssColorString("#00CED1"));E.DARKVIOLET=Object.freeze(E.fromCssColorString("#9400D3"));E.DEEPPINK=Object.freeze(E.fromCssColorString("#FF1493"));E.DEEPSKYBLUE=Object.freeze(E.fromCssColorString("#00BFFF"));E.DIMGRAY=Object.freeze(E.fromCssColorString("#696969"));E.DIMGREY=E.DIMGRAY;E.DODGERBLUE=Object.freeze(E.fromCssColorString("#1E90FF"));E.FIREBRICK=Object.freeze(E.fromCssColorString("#B22222"));E.FLORALWHITE=Object.freeze(E.fromCssColorString("#FFFAF0"));E.FORESTGREEN=Object.freeze(E.fromCssColorString("#228B22"));E.FUCHSIA=Object.freeze(E.fromCssColorString("#FF00FF"));E.GAINSBORO=Object.freeze(E.fromCssColorString("#DCDCDC"));E.GHOSTWHITE=Object.freeze(E.fromCssColorString("#F8F8FF"));E.GOLD=Object.freeze(E.fromCssColorString("#FFD700"));E.GOLDENROD=Object.freeze(E.fromCssColorString("#DAA520"));E.GRAY=Object.freeze(E.fromCssColorString("#808080"));E.GREEN=Object.freeze(E.fromCssColorString("#008000"));E.GREENYELLOW=Object.freeze(E.fromCssColorString("#ADFF2F"));E.GREY=E.GRAY;E.HONEYDEW=Object.freeze(E.fromCssColorString("#F0FFF0"));E.HOTPINK=Object.freeze(E.fromCssColorString("#FF69B4"));E.INDIANRED=Object.freeze(E.fromCssColorString("#CD5C5C"));E.INDIGO=Object.freeze(E.fromCssColorString("#4B0082"));E.IVORY=Object.freeze(E.fromCssColorString("#FFFFF0"));E.KHAKI=Object.freeze(E.fromCssColorString("#F0E68C"));E.LAVENDER=Object.freeze(E.fromCssColorString("#E6E6FA"));E.LAVENDAR_BLUSH=Object.freeze(E.fromCssColorString("#FFF0F5"));E.LAWNGREEN=Object.freeze(E.fromCssColorString("#7CFC00"));E.LEMONCHIFFON=Object.freeze(E.fromCssColorString("#FFFACD"));E.LIGHTBLUE=Object.freeze(E.fromCssColorString("#ADD8E6"));E.LIGHTCORAL=Object.freeze(E.fromCssColorString("#F08080"));E.LIGHTCYAN=Object.freeze(E.fromCssColorString("#E0FFFF"));E.LIGHTGOLDENRODYELLOW=Object.freeze(E.fromCssColorString("#FAFAD2"));E.LIGHTGRAY=Object.freeze(E.fromCssColorString("#D3D3D3"));E.LIGHTGREEN=Object.freeze(E.fromCssColorString("#90EE90"));E.LIGHTGREY=E.LIGHTGRAY;E.LIGHTPINK=Object.freeze(E.fromCssColorString("#FFB6C1"));E.LIGHTSEAGREEN=Object.freeze(E.fromCssColorString("#20B2AA"));E.LIGHTSKYBLUE=Object.freeze(E.fromCssColorString("#87CEFA"));E.LIGHTSLATEGRAY=Object.freeze(E.fromCssColorString("#778899"));E.LIGHTSLATEGREY=E.LIGHTSLATEGRAY;E.LIGHTSTEELBLUE=Object.freeze(E.fromCssColorString("#B0C4DE"));E.LIGHTYELLOW=Object.freeze(E.fromCssColorString("#FFFFE0"));E.LIME=Object.freeze(E.fromCssColorString("#00FF00"));E.LIMEGREEN=Object.freeze(E.fromCssColorString("#32CD32"));E.LINEN=Object.freeze(E.fromCssColorString("#FAF0E6"));E.MAGENTA=Object.freeze(E.fromCssColorString("#FF00FF"));E.MAROON=Object.freeze(E.fromCssColorString("#800000"));E.MEDIUMAQUAMARINE=Object.freeze(E.fromCssColorString("#66CDAA"));E.MEDIUMBLUE=Object.freeze(E.fromCssColorString("#0000CD"));E.MEDIUMORCHID=Object.freeze(E.fromCssColorString("#BA55D3"));E.MEDIUMPURPLE=Object.freeze(E.fromCssColorString("#9370DB"));E.MEDIUMSEAGREEN=Object.freeze(E.fromCssColorString("#3CB371"));E.MEDIUMSLATEBLUE=Object.freeze(E.fromCssColorString("#7B68EE"));E.MEDIUMSPRINGGREEN=Object.freeze(E.fromCssColorString("#00FA9A"));E.MEDIUMTURQUOISE=Object.freeze(E.fromCssColorString("#48D1CC"));E.MEDIUMVIOLETRED=Object.freeze(E.fromCssColorString("#C71585"));E.MIDNIGHTBLUE=Object.freeze(E.fromCssColorString("#191970"));E.MINTCREAM=Object.freeze(E.fromCssColorString("#F5FFFA"));E.MISTYROSE=Object.freeze(E.fromCssColorString("#FFE4E1"));E.MOCCASIN=Object.freeze(E.fromCssColorString("#FFE4B5"));E.NAVAJOWHITE=Object.freeze(E.fromCssColorString("#FFDEAD"));E.NAVY=Object.freeze(E.fromCssColorString("#000080"));E.OLDLACE=Object.freeze(E.fromCssColorString("#FDF5E6"));E.OLIVE=Object.freeze(E.fromCssColorString("#808000"));E.OLIVEDRAB=Object.freeze(E.fromCssColorString("#6B8E23"));E.ORANGE=Object.freeze(E.fromCssColorString("#FFA500"));E.ORANGERED=Object.freeze(E.fromCssColorString("#FF4500"));E.ORCHID=Object.freeze(E.fromCssColorString("#DA70D6"));E.PALEGOLDENROD=Object.freeze(E.fromCssColorString("#EEE8AA"));E.PALEGREEN=Object.freeze(E.fromCssColorString("#98FB98"));E.PALETURQUOISE=Object.freeze(E.fromCssColorString("#AFEEEE"));E.PALEVIOLETRED=Object.freeze(E.fromCssColorString("#DB7093"));E.PAPAYAWHIP=Object.freeze(E.fromCssColorString("#FFEFD5"));E.PEACHPUFF=Object.freeze(E.fromCssColorString("#FFDAB9"));E.PERU=Object.freeze(E.fromCssColorString("#CD853F"));E.PINK=Object.freeze(E.fromCssColorString("#FFC0CB"));E.PLUM=Object.freeze(E.fromCssColorString("#DDA0DD"));E.POWDERBLUE=Object.freeze(E.fromCssColorString("#B0E0E6"));E.PURPLE=Object.freeze(E.fromCssColorString("#800080"));E.RED=Object.freeze(E.fromCssColorString("#FF0000"));E.ROSYBROWN=Object.freeze(E.fromCssColorString("#BC8F8F"));E.ROYALBLUE=Object.freeze(E.fromCssColorString("#4169E1"));E.SADDLEBROWN=Object.freeze(E.fromCssColorString("#8B4513"));E.SALMON=Object.freeze(E.fromCssColorString("#FA8072"));E.SANDYBROWN=Object.freeze(E.fromCssColorString("#F4A460"));E.SEAGREEN=Object.freeze(E.fromCssColorString("#2E8B57"));E.SEASHELL=Object.freeze(E.fromCssColorString("#FFF5EE"));E.SIENNA=Object.freeze(E.fromCssColorString("#A0522D"));E.SILVER=Object.freeze(E.fromCssColorString("#C0C0C0"));E.SKYBLUE=Object.freeze(E.fromCssColorString("#87CEEB"));E.SLATEBLUE=Object.freeze(E.fromCssColorString("#6A5ACD"));E.SLATEGRAY=Object.freeze(E.fromCssColorString("#708090"));E.SLATEGREY=E.SLATEGRAY;E.SNOW=Object.freeze(E.fromCssColorString("#FFFAFA"));E.SPRINGGREEN=Object.freeze(E.fromCssColorString("#00FF7F"));E.STEELBLUE=Object.freeze(E.fromCssColorString("#4682B4"));E.TAN=Object.freeze(E.fromCssColorString("#D2B48C"));E.TEAL=Object.freeze(E.fromCssColorString("#008080"));E.THISTLE=Object.freeze(E.fromCssColorString("#D8BFD8"));E.TOMATO=Object.freeze(E.fromCssColorString("#FF6347"));E.TURQUOISE=Object.freeze(E.fromCssColorString("#40E0D0"));E.VIOLET=Object.freeze(E.fromCssColorString("#EE82EE"));E.WHEAT=Object.freeze(E.fromCssColorString("#F5DEB3"));E.WHITE=Object.freeze(E.fromCssColorString("#FFFFFF"));E.WHITESMOKE=Object.freeze(E.fromCssColorString("#F5F5F5"));E.YELLOW=Object.freeze(E.fromCssColorString("#FFFF00"));E.YELLOWGREEN=Object.freeze(E.fromCssColorString("#9ACD32"));E.TRANSPARENT=Object.freeze(new E(0,0,0,0));var Be=E;var Qh={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},w=Object.freeze(Qh);var ue={BYTE:w.BYTE,UNSIGNED_BYTE:w.UNSIGNED_BYTE,SHORT:w.SHORT,UNSIGNED_SHORT:w.UNSIGNED_SHORT,INT:w.INT,UNSIGNED_INT:w.UNSIGNED_INT,FLOAT:w.FLOAT,DOUBLE:w.DOUBLE};ue.getSizeInBytes=function(e){switch(e){case ue.BYTE:return Int8Array.BYTES_PER_ELEMENT;case ue.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ue.SHORT:return Int16Array.BYTES_PER_ELEMENT;case ue.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ue.INT:return Int32Array.BYTES_PER_ELEMENT;case ue.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case ue.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case ue.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}};ue.fromTypedArray=function(e){if(e instanceof Int8Array)return ue.BYTE;if(e instanceof Uint8Array)return ue.UNSIGNED_BYTE;if(e instanceof Int16Array)return ue.SHORT;if(e instanceof Uint16Array)return ue.UNSIGNED_SHORT;if(e instanceof Int32Array)return ue.INT;if(e instanceof Uint32Array)return ue.UNSIGNED_INT;if(e instanceof Float32Array)return ue.FLOAT;if(e instanceof Float64Array)return ue.DOUBLE};ue.validate=function(e){return f(e)&&(e===ue.BYTE||e===ue.UNSIGNED_BYTE||e===ue.SHORT||e===ue.UNSIGNED_SHORT||e===ue.INT||e===ue.UNSIGNED_INT||e===ue.FLOAT||e===ue.DOUBLE)};ue.createTypedArray=function(e,t){switch(e){case ue.BYTE:return new Int8Array(t);case ue.UNSIGNED_BYTE:return new Uint8Array(t);case ue.SHORT:return new Int16Array(t);case ue.UNSIGNED_SHORT:return new Uint16Array(t);case ue.INT:return new Int32Array(t);case ue.UNSIGNED_INT:return new Uint32Array(t);case ue.FLOAT:return new Float32Array(t);case ue.DOUBLE:return new Float64Array(t)}};ue.createArrayBufferView=function(e,t,n,o){switch(n=y(n,0),o=y(o,(t.byteLength-n)/ue.getSizeInBytes(e)),e){case ue.BYTE:return new Int8Array(t,n,o);case ue.UNSIGNED_BYTE:return new Uint8Array(t,n,o);case ue.SHORT:return new Int16Array(t,n,o);case ue.UNSIGNED_SHORT:return new Uint16Array(t,n,o);case ue.INT:return new Int32Array(t,n,o);case ue.UNSIGNED_INT:return new Uint32Array(t,n,o);case ue.FLOAT:return new Float32Array(t,n,o);case ue.DOUBLE:return new Float64Array(t,n,o)}};ue.fromName=function(e){switch(e){case"BYTE":return ue.BYTE;case"UNSIGNED_BYTE":return ue.UNSIGNED_BYTE;case"SHORT":return ue.SHORT;case"UNSIGNED_SHORT":return ue.UNSIGNED_SHORT;case"INT":return ue.INT;case"UNSIGNED_INT":return ue.UNSIGNED_INT;case"FLOAT":return ue.FLOAT;case"DOUBLE":return ue.DOUBLE}};var re=Object.freeze(ue);function Eo(e,t,n,o){e=y(e,1),t=y(t,1),n=y(n,1),o=y(o,1),this.value=new Uint8Array([Be.floatToByte(e),Be.floatToByte(t),Be.floatToByte(n),Be.floatToByte(o)])}Object.defineProperties(Eo.prototype,{componentDatatype:{get:function(){return re.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}});Eo.fromColor=function(e){return new Eo(e.red,e.green,e.blue,e.alpha)};Eo.toValue=function(e,t){return f(t)?e.toBytes(t):new Uint8Array(e.toBytes())};Eo.equals=function(e,t){return e===t||f(e)&&f(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var qi=Eo;function K(e,t,n,o){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0),this.w=y(o,0)}K.fromElements=function(e,t,n,o,i){return f(i)?(i.x=e,i.y=t,i.z=n,i.w=o,i):new K(e,t,n,o)};K.fromColor=function(e,t){return f(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new K(e.red,e.green,e.blue,e.alpha)};K.clone=function(e,t){if(!!f(e))return f(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new K(e.x,e.y,e.z,e.w)};K.packedLength=4;K.pack=function(e,t,n){return n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};K.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new K),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n};K.packArray=function(e,t){let n=e.length,o=n*4;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)K.pack(e[i],t,i*4);return t};K.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/4:t=new Array(n/4);for(let o=0;o<n;o+=4){let i=o/4;t[i]=K.unpack(e,o,t[i])}return t};K.fromArray=K.unpack;K.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)};K.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)};K.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n};K.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n};K.clamp=function(e,t,n,o){let i=O.clamp(e.x,t.x,n.x),r=O.clamp(e.y,t.y,n.y),s=O.clamp(e.z,t.z,n.z),a=O.clamp(e.w,t.w,n.w);return o.x=i,o.y=r,o.z=s,o.w=a,o};K.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};K.magnitude=function(e){return Math.sqrt(K.magnitudeSquared(e))};var Wi=new K;K.distance=function(e,t){return K.subtract(e,t,Wi),K.magnitude(Wi)};K.distanceSquared=function(e,t){return K.subtract(e,t,Wi),K.magnitudeSquared(Wi)};K.normalize=function(e,t){let n=K.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t};K.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};K.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n};K.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n};K.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};K.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};K.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};K.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};K.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};K.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var dc=new K;K.lerp=function(e,t,n,o){return K.multiplyByScalar(t,n,dc),o=K.multiplyByScalar(e,1-n,o),K.add(dc,o,o)};var Jh=new K;K.mostOrthogonalAxis=function(e,t){let n=K.normalize(e,Jh);return K.abs(n,n),n.x<=n.y?n.x<=n.z?n.x<=n.w?t=K.clone(K.UNIT_X,t):t=K.clone(K.UNIT_W,t):n.z<=n.w?t=K.clone(K.UNIT_Z,t):t=K.clone(K.UNIT_W,t):n.y<=n.z?n.y<=n.w?t=K.clone(K.UNIT_Y,t):t=K.clone(K.UNIT_W,t):n.z<=n.w?t=K.clone(K.UNIT_Z,t):t=K.clone(K.UNIT_W,t),t};K.equals=function(e,t){return e===t||f(e)&&f(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};K.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]};K.equalsEpsilon=function(e,t,n,o){return e===t||f(e)&&f(t)&&O.equalsEpsilon(e.x,t.x,n,o)&&O.equalsEpsilon(e.y,t.y,n,o)&&O.equalsEpsilon(e.z,t.z,n,o)&&O.equalsEpsilon(e.w,t.w,n,o)};K.ZERO=Object.freeze(new K(0,0,0,0));K.ONE=Object.freeze(new K(1,1,1,1));K.UNIT_X=Object.freeze(new K(1,0,0,0));K.UNIT_Y=Object.freeze(new K(0,1,0,0));K.UNIT_Z=Object.freeze(new K(0,0,1,0));K.UNIT_W=Object.freeze(new K(0,0,0,1));K.prototype.clone=function(e){return K.clone(this,e)};K.prototype.equals=function(e){return K.equals(this,e)};K.prototype.equalsEpsilon=function(e,t,n){return K.equalsEpsilon(this,e,t,n)};K.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var us=new Float32Array(1),yt=new Uint8Array(us.buffer),ep=new Uint32Array([287454020]),tp=new Uint8Array(ep.buffer),mc=tp[0]===68;K.packFloat=function(e,t){return f(t)||(t=new K),us[0]=e,mc?(t.x=yt[0],t.y=yt[1],t.z=yt[2],t.w=yt[3]):(t.x=yt[3],t.y=yt[2],t.z=yt[1],t.w=yt[0]),t};K.unpackFloat=function(e){return mc?(yt[0]=e.x,yt[1]=e.y,yt[2]=e.z,yt[3]=e.w):(yt[0]=e.w,yt[1]=e.z,yt[2]=e.y,yt[3]=e.x),us[0]};var se=K;function j(e,t,n,o,i,r,s,a,c){this[0]=y(e,0),this[1]=y(o,0),this[2]=y(s,0),this[3]=y(t,0),this[4]=y(i,0),this[5]=y(a,0),this[6]=y(n,0),this[7]=y(r,0),this[8]=y(c,0)}j.packedLength=9;j.pack=function(e,t,n){return n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t};j.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new j),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n};j.packArray=function(e,t){let n=e.length,o=n*9;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)j.pack(e[i],t,i*9);return t};j.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/9:t=new Array(n/9);for(let o=0;o<n;o+=9){let i=o/9;t[i]=j.unpack(e,o,t[i])}return t};j.clone=function(e,t){if(!!f(e))return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new j(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])};j.fromArray=j.unpack;j.fromColumnMajorArray=function(e,t){return j.clone(e,t)};j.fromRowMajorArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new j(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};j.fromQuaternion=function(e,t){let n=e.x*e.x,o=e.x*e.y,i=e.x*e.z,r=e.x*e.w,s=e.y*e.y,a=e.y*e.z,c=e.y*e.w,u=e.z*e.z,d=e.z*e.w,m=e.w*e.w,p=n-s-u+m,_=2*(o-d),g=2*(i+c),v=2*(o+d),b=-n+s-u+m,S=2*(a-r),A=2*(i-c),x=2*(a+r),P=-n-s+u+m;return f(t)?(t[0]=p,t[1]=v,t[2]=A,t[3]=_,t[4]=b,t[5]=x,t[6]=g,t[7]=S,t[8]=P,t):new j(p,_,g,v,b,S,A,x,P)};j.fromHeadingPitchRoll=function(e,t){let n=Math.cos(-e.pitch),o=Math.cos(-e.heading),i=Math.cos(e.roll),r=Math.sin(-e.pitch),s=Math.sin(-e.heading),a=Math.sin(e.roll),c=n*o,u=-i*s+a*r*o,d=a*s+i*r*o,m=n*s,p=i*o+a*r*s,_=-a*o+i*r*s,g=-r,v=a*n,b=i*n;return f(t)?(t[0]=c,t[1]=m,t[2]=g,t[3]=u,t[4]=p,t[5]=v,t[6]=d,t[7]=_,t[8]=b,t):new j(c,u,d,m,p,_,g,v,b)};j.fromScale=function(e,t){return f(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new j(e.x,0,0,0,e.y,0,0,0,e.z)};j.fromUniformScale=function(e,t){return f(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new j(e,0,0,0,e,0,0,0,e)};j.fromCrossProduct=function(e,t){return f(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new j(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)};j.fromRotationX=function(e,t){let n=Math.cos(e),o=Math.sin(e);return f(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=o,t[6]=0,t[7]=-o,t[8]=n,t):new j(1,0,0,0,n,-o,0,o,n)};j.fromRotationY=function(e,t){let n=Math.cos(e),o=Math.sin(e);return f(t)?(t[0]=n,t[1]=0,t[2]=-o,t[3]=0,t[4]=1,t[5]=0,t[6]=o,t[7]=0,t[8]=n,t):new j(n,0,o,0,1,0,-o,0,n)};j.fromRotationZ=function(e,t){let n=Math.cos(e),o=Math.sin(e);return f(t)?(t[0]=n,t[1]=o,t[2]=0,t[3]=-o,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new j(n,-o,0,o,n,0,0,0,1)};j.toArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]};j.getElementIndex=function(e,t){return e*3+t};j.getColumn=function(e,t,n){let o=t*3,i=e[o],r=e[o+1],s=e[o+2];return n.x=i,n.y=r,n.z=s,n};j.setColumn=function(e,t,n,o){o=j.clone(e,o);let i=t*3;return o[i]=n.x,o[i+1]=n.y,o[i+2]=n.z,o};j.getRow=function(e,t,n){let o=e[t],i=e[t+3],r=e[t+6];return n.x=o,n.y=i,n.z=r,n};j.setRow=function(e,t,n,o){return o=j.clone(e,o),o[t]=n.x,o[t+3]=n.y,o[t+6]=n.z,o};var np=new l;j.setScale=function(e,t,n){let o=j.getScale(e,np),i=t.x/o.x,r=t.y/o.y,s=t.z/o.z;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*r,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var op=new l;j.setUniformScale=function(e,t,n){let o=j.getScale(e,op),i=t/o.x,r=t/o.y,s=t/o.z;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*r,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var fs=new l;j.getScale=function(e,t){return t.x=l.magnitude(l.fromElements(e[0],e[1],e[2],fs)),t.y=l.magnitude(l.fromElements(e[3],e[4],e[5],fs)),t.z=l.magnitude(l.fromElements(e[6],e[7],e[8],fs)),t};var hc=new l;j.getMaximumScale=function(e){return j.getScale(e,hc),l.maximumComponent(hc)};var ip=new l;j.setRotation=function(e,t,n){let o=j.getScale(e,ip);return n[0]=t[0]*o.x,n[1]=t[1]*o.x,n[2]=t[2]*o.x,n[3]=t[3]*o.y,n[4]=t[4]*o.y,n[5]=t[5]*o.y,n[6]=t[6]*o.z,n[7]=t[7]*o.z,n[8]=t[8]*o.z,n};var rp=new l;j.getRotation=function(e,t){let n=j.getScale(e,rp);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t};j.multiply=function(e,t,n){let o=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],i=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],r=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],c=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],u=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],d=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],m=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=o,n[1]=i,n[2]=r,n[3]=s,n[4]=a,n[5]=c,n[6]=u,n[7]=d,n[8]=m,n};j.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n};j.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n};j.multiplyByVector=function(e,t,n){let o=t.x,i=t.y,r=t.z,s=e[0]*o+e[3]*i+e[6]*r,a=e[1]*o+e[4]*i+e[7]*r,c=e[2]*o+e[5]*i+e[8]*r;return n.x=s,n.y=a,n.z=c,n};j.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};j.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n};j.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};j.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t};j.transpose=function(e,t){let n=e[0],o=e[3],i=e[6],r=e[1],s=e[4],a=e[7],c=e[2],u=e[5],d=e[8];return t[0]=n,t[1]=o,t[2]=i,t[3]=r,t[4]=s,t[5]=a,t[6]=c,t[7]=u,t[8]=d,t};function sp(e){let t=0;for(let n=0;n<9;++n){let o=e[n];t+=o*o}return Math.sqrt(t)}var ls=[1,0,0],ds=[2,2,1];function ap(e){let t=0;for(let n=0;n<3;++n){let o=e[j.getElementIndex(ds[n],ls[n])];t+=2*o*o}return Math.sqrt(t)}function cp(e,t){let n=O.EPSILON15,o=0,i=1;for(let u=0;u<3;++u){let d=Math.abs(e[j.getElementIndex(ds[u],ls[u])]);d>o&&(i=u,o=d)}let r=1,s=0,a=ls[i],c=ds[i];if(Math.abs(e[j.getElementIndex(c,a)])>n){let u=e[j.getElementIndex(c,c)],d=e[j.getElementIndex(a,a)],m=e[j.getElementIndex(c,a)],p=(u-d)/2/m,_;p<0?_=-1/(-p+Math.sqrt(1+p*p)):_=1/(p+Math.sqrt(1+p*p)),r=1/Math.sqrt(1+_*_),s=_*r}return t=j.clone(j.IDENTITY,t),t[j.getElementIndex(a,a)]=t[j.getElementIndex(c,c)]=r,t[j.getElementIndex(c,a)]=s,t[j.getElementIndex(a,c)]=-s,t}var Yi=new j,pc=new j;j.computeEigenDecomposition=function(e,t){let n=O.EPSILON20,o=10,i=0,r=0;f(t)||(t={});let s=t.unitary=j.clone(j.IDENTITY,t.unitary),a=t.diagonal=j.clone(e,t.diagonal),c=n*sp(a);for(;r<o&&ap(a)>c;)cp(a,Yi),j.transpose(Yi,pc),j.multiply(a,Yi,a),j.multiply(pc,a,a),j.multiply(s,Yi,s),++i>2&&(++r,i=0);return t};j.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t};j.determinant=function(e){let t=e[0],n=e[3],o=e[6],i=e[1],r=e[4],s=e[7],a=e[2],c=e[5],u=e[8];return t*(r*u-c*s)+i*(c*o-n*u)+a*(n*s-r*o)};j.inverse=function(e,t){let n=e[0],o=e[1],i=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],d=e[8],m=j.determinant(e);t[0]=s*d-u*a,t[1]=u*i-o*d,t[2]=o*a-s*i,t[3]=c*a-r*d,t[4]=n*d-c*i,t[5]=r*i-n*a,t[6]=r*u-c*s,t[7]=c*o-n*u,t[8]=n*s-r*o;let p=1/m;return j.multiplyByScalar(t,p,t)};var up=new j;j.inverseTranspose=function(e,t){return j.inverse(j.transpose(e,up),t)};j.equals=function(e,t){return e===t||f(e)&&f(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};j.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n};j.IDENTITY=Object.freeze(new j(1,0,0,0,1,0,0,0,1));j.ZERO=Object.freeze(new j(0,0,0,0,0,0,0,0,0));j.COLUMN0ROW0=0;j.COLUMN0ROW1=1;j.COLUMN0ROW2=2;j.COLUMN1ROW0=3;j.COLUMN1ROW1=4;j.COLUMN1ROW2=5;j.COLUMN2ROW0=6;j.COLUMN2ROW1=7;j.COLUMN2ROW2=8;Object.defineProperties(j.prototype,{length:{get:function(){return j.packedLength}}});j.prototype.clone=function(e){return j.clone(this,e)};j.prototype.equals=function(e){return j.equals(this,e)};j.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]};j.prototype.equalsEpsilon=function(e,t){return j.equalsEpsilon(this,e,t)};j.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})
(${this[1]}, ${this[4]}, ${this[7]})
(${this[2]}, ${this[5]}, ${this[8]})`};var Z=j;function Xo(e){this.name="RuntimeError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}f(Object.create)&&(Xo.prototype=Object.create(Error.prototype),Xo.prototype.constructor=Xo);Xo.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return f(this.stack)&&(e+=`
${this.stack.toString()}`),e};var je=Xo;function V(e,t,n,o,i,r,s,a,c,u,d,m,p,_,g,v){this[0]=y(e,0),this[1]=y(i,0),this[2]=y(c,0),this[3]=y(p,0),this[4]=y(t,0),this[5]=y(r,0),this[6]=y(u,0),this[7]=y(_,0),this[8]=y(n,0),this[9]=y(s,0),this[10]=y(d,0),this[11]=y(g,0),this[12]=y(o,0),this[13]=y(a,0),this[14]=y(m,0),this[15]=y(v,0)}V.packedLength=16;V.computeReflection=function(e,t,n,o,i){return f(i)||(i=new V),i[0]=1-2*e*e,i[1]=-2*e*t,i[2]=-2*e*n,i[3]=0,i[4]=-2*t*e,i[5]=1-2*t*t,i[6]=-2*t*n,i[7]=0,i[8]=-2*n*e,i[9]=-2*n*t,i[10]=1-2*n*n,i[11]=0,i[12]=-2*o*e,i[13]=-2*o*t,i[14]=-2*o*n,i[15]=1,i};V.computeObliquePerspective=function(e,t,n){let o=V.inverse(n,new V),i=V.inverseTranspose(t,new V),r=V.multiplyByVector(i,e,new se),s=new se(_c(r.x),_c(r.y),1,1),a=V.multiplyByVector(o,s,new se),c=2/se.dot(r,a),u=[r.x*c,r.y*c,r.z*c+1,r.w*c];return new V(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],u[0],u[1],u[2],u[3],n[3],n[7],n[11],n[15])};function _c(e){return e>0?1:e<0?-1:0}V.pack=function(e,t,n){return n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t};V.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new V),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n};V.packArray=function(e,t){let n=e.length,o=n*16;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)V.pack(e[i],t,i*16);return t};V.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/16:t=new Array(n/16);for(let o=0;o<n;o+=16){let i=o/16;t[i]=V.unpack(e,o,t[i])}return t};V.clone=function(e,t){if(!!f(e))return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new V(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])};V.fromArray=V.unpack;V.fromColumnMajorArray=function(e,t){return V.clone(e,t)};V.fromRowMajorArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new V(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])};V.fromRotationTranslation=function(e,t,n){return t=y(t,l.ZERO),f(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new V(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)};V.fromTranslationQuaternionRotationScale=function(e,t,n,o){f(o)||(o=new V);let i=n.x,r=n.y,s=n.z,a=t.x*t.x,c=t.x*t.y,u=t.x*t.z,d=t.x*t.w,m=t.y*t.y,p=t.y*t.z,_=t.y*t.w,g=t.z*t.z,v=t.z*t.w,b=t.w*t.w,S=a-m-g+b,A=2*(c-v),x=2*(u+_),P=2*(c+v),z=-a+m-g+b,L=2*(p-d),B=2*(u-_),F=2*(p+d),N=-a-m+g+b;return o[0]=S*i,o[1]=P*i,o[2]=B*i,o[3]=0,o[4]=A*r,o[5]=z*r,o[6]=F*r,o[7]=0,o[8]=x*s,o[9]=L*s,o[10]=N*s,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,o};V.fromTranslationRotationScale=function(e,t){return V.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};V.fromTranslation=function(e,t){return V.fromRotationTranslation(Z.IDENTITY,e,t)};V.fromScale=function(e,t){return f(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new V(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)};V.fromUniformScale=function(e,t){return f(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new V(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};V.fromRotation=function(e,t){return f(t)||(t=new V),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var To=new l,bo=new l,$o=new l;V.fromCamera=function(e,t){let n=e.position,o=e.direction,i=e.up;l.normalize(o,To),l.normalize(l.cross(To,i,bo),bo),l.normalize(l.cross(bo,To,$o),$o);let r=bo.x,s=bo.y,a=bo.z,c=To.x,u=To.y,d=To.z,m=$o.x,p=$o.y,_=$o.z,g=n.x,v=n.y,b=n.z,S=r*-g+s*-v+a*-b,A=m*-g+p*-v+_*-b,x=c*g+u*v+d*b;return f(t)?(t[0]=r,t[1]=m,t[2]=-c,t[3]=0,t[4]=s,t[5]=p,t[6]=-u,t[7]=0,t[8]=a,t[9]=_,t[10]=-d,t[11]=0,t[12]=S,t[13]=A,t[14]=x,t[15]=1,t):new V(r,s,a,S,m,p,_,A,-c,-u,-d,x,0,0,0,1)};V.computePerspectiveFieldOfView=function(e,t,n,o,i){let r=Math.tan(e*.5),s=1/r,a=s/t,c=(o+n)/(n-o),u=2*o*n/(n-o);return i[0]=a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=c,i[11]=-1,i[12]=0,i[13]=0,i[14]=u,i[15]=0,i};V.computeOrthographicOffCenter=function(e,t,n,o,i,r,s){let a=1/(t-e),c=1/(o-n),u=1/(r-i),d=-(t+e)*a,m=-(o+n)*c,p=-(r+i)*u;return a*=2,c*=2,u*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=u,s[11]=0,s[12]=d,s[13]=m,s[14]=p,s[15]=1,s};V.computePerspectiveOffCenter=function(e,t,n,o,i,r,s){let a=2*i/(t-e),c=2*i/(o-n),u=(t+e)/(t-e),d=(o+n)/(o-n),m=-(r+i)/(r-i),p=-1,_=-2*r*i/(r-i);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=u,s[9]=d,s[10]=m,s[11]=p,s[12]=0,s[13]=0,s[14]=_,s[15]=0,s};V.computeInfinitePerspectiveOffCenter=function(e,t,n,o,i,r){let s=2*i/(t-e),a=2*i/(o-n),c=(t+e)/(t-e),u=(o+n)/(o-n),d=-1,m=-1,p=-2*i;return r[0]=s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=c,r[9]=u,r[10]=d,r[11]=m,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r};V.computeViewportTransformation=function(e,t,n,o){f(o)||(o=new V),e=y(e,y.EMPTY_OBJECT);let i=y(e.x,0),r=y(e.y,0),s=y(e.width,0),a=y(e.height,0);t=y(t,0),n=y(n,1);let c=s*.5,u=a*.5,d=(n-t)*.5,m=c,p=u,_=d,g=i+c,v=r+u,b=t+d,S=1;return o[0]=m,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=p,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=_,o[11]=0,o[12]=g,o[13]=v,o[14]=b,o[15]=S,o};V.computeView=function(e,t,n,o,i){return i[0]=o.x,i[1]=n.x,i[2]=-t.x,i[3]=0,i[4]=o.y,i[5]=n.y,i[6]=-t.y,i[7]=0,i[8]=o.z,i[9]=n.z,i[10]=-t.z,i[11]=0,i[12]=-l.dot(o,e),i[13]=-l.dot(n,e),i[14]=l.dot(t,e),i[15]=1,i};V.toArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]};V.getElementIndex=function(e,t){return e*4+t};V.getColumn=function(e,t,n){let o=t*4,i=e[o],r=e[o+1],s=e[o+2],a=e[o+3];return n.x=i,n.y=r,n.z=s,n.w=a,n};V.setColumn=function(e,t,n,o){o=V.clone(e,o);let i=t*4;return o[i]=n.x,o[i+1]=n.y,o[i+2]=n.z,o[i+3]=n.w,o};V.getRow=function(e,t,n){let o=e[t],i=e[t+4],r=e[t+8],s=e[t+12];return n.x=o,n.y=i,n.z=r,n.w=s,n};V.setRow=function(e,t,n,o){return o=V.clone(e,o),o[t]=n.x,o[t+4]=n.y,o[t+8]=n.z,o[t+12]=n.w,o};V.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};var fp=new l;V.setScale=function(e,t,n){let o=V.getScale(e,fp),i=t.x/o.x,r=t.y/o.y,s=t.z/o.z;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3],n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var lp=new l;V.setUniformScale=function(e,t,n){let o=V.getScale(e,lp),i=t/o.x,r=t/o.y,s=t/o.z;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3],n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var ms=new l;V.getScale=function(e,t){return t.x=l.magnitude(l.fromElements(e[0],e[1],e[2],ms)),t.y=l.magnitude(l.fromElements(e[4],e[5],e[6],ms)),t.z=l.magnitude(l.fromElements(e[8],e[9],e[10],ms)),t};var yc=new l;V.getMaximumScale=function(e){return V.getScale(e,yc),l.maximumComponent(yc)};var dp=new l;V.setRotation=function(e,t,n){let o=V.getScale(e,dp);return n[0]=t[0]*o.x,n[1]=t[1]*o.x,n[2]=t[2]*o.x,n[3]=e[3],n[4]=t[3]*o.y,n[5]=t[4]*o.y,n[6]=t[5]*o.y,n[7]=e[7],n[8]=t[6]*o.z,n[9]=t[7]*o.z,n[10]=t[8]*o.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var mp=new l;V.getRotation=function(e,t){let n=V.getScale(e,mp);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t};V.multiply=function(e,t,n){let o=e[0],i=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],d=e[7],m=e[8],p=e[9],_=e[10],g=e[11],v=e[12],b=e[13],S=e[14],A=e[15],x=t[0],P=t[1],z=t[2],L=t[3],B=t[4],F=t[5],N=t[6],I=t[7],U=t[8],h=t[9],C=t[10],T=t[11],R=t[12],D=t[13],k=t[14],M=t[15],q=o*x+a*P+m*z+v*L,te=i*x+c*P+p*z+b*L,de=r*x+u*P+_*z+S*L,he=s*x+d*P+g*z+A*L,Ce=o*B+a*F+m*N+v*I,ye=i*B+c*F+p*N+b*I,Se=r*B+u*F+_*N+S*I,Ie=s*B+d*F+g*N+A*I,Ne=o*U+a*h+m*C+v*T,Me=i*U+c*h+p*C+b*T,ke=r*U+u*h+_*C+S*T,_e=s*U+d*h+g*C+A*T,dt=o*R+a*D+m*k+v*M,St=i*R+c*D+p*k+b*M,Nt=r*R+u*D+_*k+S*M,pn=s*R+d*D+g*k+A*M;return n[0]=q,n[1]=te,n[2]=de,n[3]=he,n[4]=Ce,n[5]=ye,n[6]=Se,n[7]=Ie,n[8]=Ne,n[9]=Me,n[10]=ke,n[11]=_e,n[12]=dt,n[13]=St,n[14]=Nt,n[15]=pn,n};V.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n};V.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n};V.multiplyTransformation=function(e,t,n){let o=e[0],i=e[1],r=e[2],s=e[4],a=e[5],c=e[6],u=e[8],d=e[9],m=e[10],p=e[12],_=e[13],g=e[14],v=t[0],b=t[1],S=t[2],A=t[4],x=t[5],P=t[6],z=t[8],L=t[9],B=t[10],F=t[12],N=t[13],I=t[14],U=o*v+s*b+u*S,h=i*v+a*b+d*S,C=r*v+c*b+m*S,T=o*A+s*x+u*P,R=i*A+a*x+d*P,D=r*A+c*x+m*P,k=o*z+s*L+u*B,M=i*z+a*L+d*B,q=r*z+c*L+m*B,te=o*F+s*N+u*I+p,de=i*F+a*N+d*I+_,he=r*F+c*N+m*I+g;return n[0]=U,n[1]=h,n[2]=C,n[3]=0,n[4]=T,n[5]=R,n[6]=D,n[7]=0,n[8]=k,n[9]=M,n[10]=q,n[11]=0,n[12]=te,n[13]=de,n[14]=he,n[15]=1,n};V.multiplyByMatrix3=function(e,t,n){let o=e[0],i=e[1],r=e[2],s=e[4],a=e[5],c=e[6],u=e[8],d=e[9],m=e[10],p=t[0],_=t[1],g=t[2],v=t[3],b=t[4],S=t[5],A=t[6],x=t[7],P=t[8],z=o*p+s*_+u*g,L=i*p+a*_+d*g,B=r*p+c*_+m*g,F=o*v+s*b+u*S,N=i*v+a*b+d*S,I=r*v+c*b+m*S,U=o*A+s*x+u*P,h=i*A+a*x+d*P,C=r*A+c*x+m*P;return n[0]=z,n[1]=L,n[2]=B,n[3]=0,n[4]=F,n[5]=N,n[6]=I,n[7]=0,n[8]=U,n[9]=h,n[10]=C,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};V.multiplyByTranslation=function(e,t,n){let o=t.x,i=t.y,r=t.z,s=o*e[0]+i*e[4]+r*e[8]+e[12],a=o*e[1]+i*e[5]+r*e[9]+e[13],c=o*e[2]+i*e[6]+r*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=a,n[14]=c,n[15]=e[15],n};V.multiplyByScale=function(e,t,n){let o=t.x,i=t.y,r=t.z;return o===1&&i===1&&r===1?V.clone(e,n):(n[0]=o*e[0],n[1]=o*e[1],n[2]=o*e[2],n[3]=e[3],n[4]=i*e[4],n[5]=i*e[5],n[6]=i*e[6],n[7]=e[7],n[8]=r*e[8],n[9]=r*e[9],n[10]=r*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)};V.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};V.multiplyByVector=function(e,t,n){let o=t.x,i=t.y,r=t.z,s=t.w,a=e[0]*o+e[4]*i+e[8]*r+e[12]*s,c=e[1]*o+e[5]*i+e[9]*r+e[13]*s,u=e[2]*o+e[6]*i+e[10]*r+e[14]*s,d=e[3]*o+e[7]*i+e[11]*r+e[15]*s;return n.x=a,n.y=c,n.z=u,n.w=d,n};V.multiplyByPointAsVector=function(e,t,n){let o=t.x,i=t.y,r=t.z,s=e[0]*o+e[4]*i+e[8]*r,a=e[1]*o+e[5]*i+e[9]*r,c=e[2]*o+e[6]*i+e[10]*r;return n.x=s,n.y=a,n.z=c,n};V.multiplyByPoint=function(e,t,n){let o=t.x,i=t.y,r=t.z,s=e[0]*o+e[4]*i+e[8]*r+e[12],a=e[1]*o+e[5]*i+e[9]*r+e[13],c=e[2]*o+e[6]*i+e[10]*r+e[14];return n.x=s,n.y=a,n.z=c,n};V.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n};V.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t};V.transpose=function(e,t){let n=e[1],o=e[2],i=e[3],r=e[6],s=e[7],a=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=r,t[10]=e[10],t[11]=e[14],t[12]=i,t[13]=s,t[14]=a,t[15]=e[15],t};V.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t};V.equals=function(e,t){return e===t||f(e)&&f(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};V.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n};V.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t};V.getMatrix3=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var hp=new Z,pp=new Z,_p=new se,yp=new se(0,0,0,1);V.inverse=function(e,t){let n=e[0],o=e[4],i=e[8],r=e[12],s=e[1],a=e[5],c=e[9],u=e[13],d=e[2],m=e[6],p=e[10],_=e[14],g=e[3],v=e[7],b=e[11],S=e[15],A=p*S,x=_*b,P=m*S,z=_*v,L=m*b,B=p*v,F=d*S,N=_*g,I=d*b,U=p*g,h=d*v,C=m*g,T=A*a+z*c+L*u-(x*a+P*c+B*u),R=x*s+F*c+U*u-(A*s+N*c+I*u),D=P*s+N*a+h*u-(z*s+F*a+C*u),k=B*s+I*a+C*c-(L*s+U*a+h*c),M=x*o+P*i+B*r-(A*o+z*i+L*r),q=A*n+N*i+I*r-(x*n+F*i+U*r),te=z*n+F*o+C*r-(P*n+N*o+h*r),de=L*n+U*o+h*i-(B*n+I*o+C*i);A=i*u,x=r*c,P=o*u,z=r*a,L=o*c,B=i*a,F=n*u,N=r*s,I=n*c,U=i*s,h=n*a,C=o*s;let he=A*v+z*b+L*S-(x*v+P*b+B*S),Ce=x*g+F*b+U*S-(A*g+N*b+I*S),ye=P*g+N*v+h*S-(z*g+F*v+C*S),Se=B*g+I*v+C*b-(L*g+U*v+h*b),Ie=P*p+B*_+x*m-(L*_+A*m+z*p),Ne=I*_+A*d+N*p-(F*p+U*_+x*d),Me=F*m+C*_+z*d-(h*_+P*d+N*m),ke=h*p+L*d+U*m-(I*m+C*p+B*d),_e=n*T+o*R+i*D+r*k;if(Math.abs(_e)<O.EPSILON21){if(Z.equalsEpsilon(V.getMatrix3(e,hp),pp,O.EPSILON7)&&se.equals(V.getRow(e,3,_p),yp))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new je("matrix is not invertible because its determinate is zero.")}return _e=1/_e,t[0]=T*_e,t[1]=R*_e,t[2]=D*_e,t[3]=k*_e,t[4]=M*_e,t[5]=q*_e,t[6]=te*_e,t[7]=de*_e,t[8]=he*_e,t[9]=Ce*_e,t[10]=ye*_e,t[11]=Se*_e,t[12]=Ie*_e,t[13]=Ne*_e,t[14]=Me*_e,t[15]=ke*_e,t};V.inverseTransformation=function(e,t){let n=e[0],o=e[1],i=e[2],r=e[4],s=e[5],a=e[6],c=e[8],u=e[9],d=e[10],m=e[12],p=e[13],_=e[14],g=-n*m-o*p-i*_,v=-r*m-s*p-a*_,b=-c*m-u*p-d*_;return t[0]=n,t[1]=r,t[2]=c,t[3]=0,t[4]=o,t[5]=s,t[6]=u,t[7]=0,t[8]=i,t[9]=a,t[10]=d,t[11]=0,t[12]=g,t[13]=v,t[14]=b,t[15]=1,t};var gp=new V;V.inverseTranspose=function(e,t){return V.inverse(V.transpose(e,gp),t)};V.IDENTITY=Object.freeze(new V(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));V.ZERO=Object.freeze(new V(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));V.COLUMN0ROW0=0;V.COLUMN0ROW1=1;V.COLUMN0ROW2=2;V.COLUMN0ROW3=3;V.COLUMN1ROW0=4;V.COLUMN1ROW1=5;V.COLUMN1ROW2=6;V.COLUMN1ROW3=7;V.COLUMN2ROW0=8;V.COLUMN2ROW1=9;V.COLUMN2ROW2=10;V.COLUMN2ROW3=11;V.COLUMN3ROW0=12;V.COLUMN3ROW1=13;V.COLUMN3ROW2=14;V.COLUMN3ROW3=15;Object.defineProperties(V.prototype,{length:{get:function(){return V.packedLength}}});V.prototype.clone=function(e){return V.clone(this,e)};V.prototype.equals=function(e){return V.equals(this,e)};V.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]};V.prototype.equalsEpsilon=function(e,t){return V.equalsEpsilon(this,e,t)};V.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})
(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})
(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})
(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var X=V;function Cp(e){e=y(e,y.EMPTY_OBJECT),this.geometry=e.geometry,this.modelMatrix=X.clone(y(e.modelMatrix,X.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=y(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var Kn=Cp;function Je(e){e=y(e,y.EMPTY_OBJECT),this.position=y(e.position,!1),this.normal=y(e.normal,!1),this.st=y(e.st,!1),this.bitangent=y(e.bitangent,!1),this.tangent=y(e.tangent,!1),this.color=y(e.color,!1)}Je.POSITION_ONLY=Object.freeze(new Je({position:!0}));Je.POSITION_AND_NORMAL=Object.freeze(new Je({position:!0,normal:!0}));Je.POSITION_NORMAL_AND_ST=Object.freeze(new Je({position:!0,normal:!0,st:!0}));Je.POSITION_AND_ST=Object.freeze(new Je({position:!0,st:!0}));Je.POSITION_AND_COLOR=Object.freeze(new Je({position:!0,color:!0}));Je.ALL=Object.freeze(new Je({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0}));Je.DEFAULT=Je.POSITION_NORMAL_AND_ST;Je.packedLength=6;Je.pack=function(e,t,n){return n=y(n,0),t[n++]=e.position?1:0,t[n++]=e.normal?1:0,t[n++]=e.st?1:0,t[n++]=e.tangent?1:0,t[n++]=e.bitangent?1:0,t[n]=e.color?1:0,t};Je.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new Je),n.position=e[t++]===1,n.normal=e[t++]===1,n.st=e[t++]===1,n.tangent=e[t++]===1,n.bitangent=e[t++]===1,n.color=e[t]===1,n};Je.clone=function(e,t){if(!!f(e))return f(t)||(t=new Je),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var gt=Je;var gc=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
vec4 color = czm_gammaCorrect(v_color);
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
}
`;var Cc=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec4 color;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var vc=`varying vec4 v_color;
void main()
{
gl_FragColor = czm_gammaCorrect(v_color);
}
`;var Ec=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function Tc(e,t){if(e===null||typeof e!="object")return e;t=y(t,!1);let n=new e.constructor;for(let o in e)if(e.hasOwnProperty(o)){let i=e[o];t&&(i=Tc(i,t)),n[o]=i}return n}var Vt=Tc;function bc(e,t,n){n=y(n,!1);let o={},i=f(e),r=f(t),s,a,c;if(i)for(s in e)e.hasOwnProperty(s)&&(a=e[s],r&&n&&typeof a=="object"&&t.hasOwnProperty(s)?(c=t[s],typeof c=="object"?o[s]=bc(a,c,n):o[s]=a):o[s]=a);if(r)for(s in t)t.hasOwnProperty(s)&&!o.hasOwnProperty(s)&&(c=t[s],o[s]=c);return o}var Ot=bc;var vp={ADD:w.FUNC_ADD,SUBTRACT:w.FUNC_SUBTRACT,REVERSE_SUBTRACT:w.FUNC_REVERSE_SUBTRACT,MIN:w.MIN,MAX:w.MAX},Zn=Object.freeze(vp);var Ep={ZERO:w.ZERO,ONE:w.ONE,SOURCE_COLOR:w.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:w.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:w.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:w.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:w.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:w.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:w.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:w.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:w.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:w.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:w.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:w.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:w.SRC_ALPHA_SATURATE},Lt=Object.freeze(Ep);var Tp={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Zn.ADD,equationAlpha:Zn.ADD,functionSourceRgb:Lt.SOURCE_ALPHA,functionSourceAlpha:Lt.ONE,functionDestinationRgb:Lt.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Lt.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Zn.ADD,equationAlpha:Zn.ADD,functionSourceRgb:Lt.ONE,functionSourceAlpha:Lt.ONE,functionDestinationRgb:Lt.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Lt.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:Zn.ADD,equationAlpha:Zn.ADD,functionSourceRgb:Lt.SOURCE_ALPHA,functionSourceAlpha:Lt.ONE,functionDestinationRgb:Lt.ONE,functionDestinationAlpha:Lt.ONE})},hs=Object.freeze(Tp);var bp={FRONT:w.FRONT,BACK:w.BACK,FRONT_AND_BACK:w.FRONT_AND_BACK},Qn=Object.freeze(bp);function Ao(e){e=y(e,y.EMPTY_OBJECT),this.material=e.material,this.translucent=y(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=y(e.closed,!1)}Object.defineProperties(Ao.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});Ao.prototype.getFragmentShaderSource=function(){let e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),f(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join(`
`)};Ao.prototype.isTranslucent=function(){return f(this.material)&&this.material.isTranslucent()||!f(this.material)&&this.translucent};Ao.prototype.getRenderState=function(){let e=this.isTranslucent(),t=Vt(this.renderState,!1);return e?(t.depthMask=!1,t.blending=hs.ALPHA_BLEND):t.depthMask=!0,t};Ao.getDefaultRenderState=function(e,t,n){let o={depthTest:{enabled:!0}};return e&&(o.depthMask=!1,o.blending=hs.ALPHA_BLEND),t&&(o.cull={enabled:!0,face:Qn.BACK}),f(n)&&(o=Ot(n,o,!0)),o};var Ko=Ao;function Cn(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),n=y(e.closed,!1),o=y(e.flat,!1),i=o?Ec:Cc,r=o?vc:gc,s=o?Cn.FLAT_VERTEX_FORMAT:Cn.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=y(e.vertexShaderSource,i),this._fragmentShaderSource=y(e.fragmentShaderSource,r),this._renderState=Ko.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=s,this._flat=o,this._faceForward=y(e.faceForward,!n)}Object.defineProperties(Cn.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});Cn.VERTEX_FORMAT=gt.POSITION_AND_NORMAL;Cn.FLAT_VERTEX_FORMAT=gt.POSITION_ONLY;Cn.prototype.getFragmentShaderSource=Ko.prototype.getFragmentShaderSource;Cn.prototype.isTranslucent=Ko.prototype.isTranslucent;Cn.prototype.getRenderState=Ko.prototype.getRenderState;var Ac=Cn;var Ap=new l,xp=new l;function wp(e,t,n,o,i){let r=e.x,s=e.y,a=e.z,c=t.x,u=t.y,d=t.z,m=r*r*c*c,p=s*s*u*u,_=a*a*d*d,g=m+p+_,v=Math.sqrt(1/g),b=l.multiplyByScalar(e,v,Ap);if(g<o)return isFinite(v)?l.clone(b,i):void 0;let S=n.x,A=n.y,x=n.z,P=xp;P.x=b.x*S*2,P.y=b.y*A*2,P.z=b.z*x*2;let z=(1-v)*l.magnitude(e)/(.5*l.magnitude(P)),L=0,B,F,N,I,U,h,C,T,R,D,k;do{z-=L,N=1/(1+z*S),I=1/(1+z*A),U=1/(1+z*x),h=N*N,C=I*I,T=U*U,R=h*N,D=C*I,k=T*U,B=m*h+p*C+_*T-1,F=m*R*S+p*D*A+_*k*x;let M=-2*F;L=B/M}while(Math.abs(B)>O.EPSILON12);return f(i)?(i.x=r*N,i.y=s*I,i.z=a*U,i):new l(r*N,s*I,a*U)}var Xi=wp;function Xe(e,t,n){this.longitude=y(e,0),this.latitude=y(t,0),this.height=y(n,0)}Xe.fromRadians=function(e,t,n,o){return n=y(n,0),f(o)?(o.longitude=e,o.latitude=t,o.height=n,o):new Xe(e,t,n)};Xe.fromDegrees=function(e,t,n,o){return e=O.toRadians(e),t=O.toRadians(t),Xe.fromRadians(e,t,n,o)};var Sp=new l,Rp=new l,Pp=new l;Xe.wgs84OneOverRadii=new l(1/6378137,1/6378137,1/6356752314245179e-9);Xe.wgs84OneOverRadiiSquared=new l(1/(6378137*6378137),1/(6378137*6378137),1/(6356752314245179e-9*6356752314245179e-9));var Op=O.EPSILON1;Xe.fromCartesian=function(e,t,n){let o=f(t)?t.oneOverRadii:this.wgs84OneOverRadii,i=f(t)?t.oneOverRadiiSquared:this.wgs84OneOverRadiiSquared,r=f(t)?t._centerToleranceSquared:Op,s=Xi(e,o,i,r,Rp);if(!f(s))return;let a=l.multiplyComponents(s,i,Sp);a=l.normalize(a,a);let c=l.subtract(e,s,Pp),u=Math.atan2(a.y,a.x),d=Math.asin(a.z),m=O.sign(l.dot(c,e))*l.magnitude(c);return f(n)?(n.longitude=u,n.latitude=d,n.height=m,n):new Xe(u,d,m)};Xe.toCartesian=function(e,t,n){return l.fromRadians(e.longitude,e.latitude,e.height,t,n)};Xe.clone=function(e,t){if(!!f(e))return f(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new Xe(e.longitude,e.latitude,e.height)};Xe.equals=function(e,t){return e===t||f(e)&&f(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};Xe.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n};Xe.ZERO=Object.freeze(new Xe(0,0,0));Xe.prototype.clone=function(e){return Xe.clone(this,e)};Xe.prototype.equals=function(e){return Xe.equals(this,e)};Xe.prototype.equalsEpsilon=function(e,t){return Xe.equalsEpsilon(this,e,t)};Xe.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var ve=Xe;function wc(e,t,n,o){t=y(t,0),n=y(n,0),o=y(o,0),e._radii=new l(t,n,o),e._radiiSquared=new l(t*t,n*n,o*o),e._radiiToTheFourth=new l(t*t*t*t,n*n*n*n,o*o*o*o),e._oneOverRadii=new l(t===0?0:1/t,n===0?0:1/n,o===0?0:1/o),e._oneOverRadiiSquared=new l(t===0?0:1/(t*t),n===0?0:1/(n*n),o===0?0:1/(o*o)),e._minimumRadius=Math.min(t,n,o),e._maximumRadius=Math.max(t,n,o),e._centerToleranceSquared=O.EPSILON1,e._radiiSquared.z!==0&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function Te(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,wc(this,e,t,n)}Object.defineProperties(Te.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});Te.clone=function(e,t){if(!f(e))return;let n=e._radii;return f(t)?(l.clone(n,t._radii),l.clone(e._radiiSquared,t._radiiSquared),l.clone(e._radiiToTheFourth,t._radiiToTheFourth),l.clone(e._oneOverRadii,t._oneOverRadii),l.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new Te(n.x,n.y,n.z)};Te.fromCartesian3=function(e,t){return f(t)||(t=new Te),f(e)&&wc(t,e.x,e.y,e.z),t};Te.WGS84=Object.freeze(new Te(6378137,6378137,6356752314245179e-9));Te.UNIT_SPHERE=Object.freeze(new Te(1,1,1));Te.MOON=Object.freeze(new Te(O.LUNAR_RADIUS,O.LUNAR_RADIUS,O.LUNAR_RADIUS));Te.prototype.clone=function(e){return Te.clone(this,e)};Te.packedLength=l.packedLength;Te.pack=function(e,t,n){return n=y(n,0),l.pack(e._radii,t,n),t};Te.unpack=function(e,t,n){t=y(t,0);let o=l.unpack(e,t);return Te.fromCartesian3(o,n)};Te.prototype.geocentricSurfaceNormal=l.normalize;Te.prototype.geodeticSurfaceNormalCartographic=function(e,t){let n=e.longitude,o=e.latitude,i=Math.cos(o),r=i*Math.cos(n),s=i*Math.sin(n),a=Math.sin(o);return f(t)||(t=new l),t.x=r,t.y=s,t.z=a,l.normalize(t,t)};Te.prototype.geodeticSurfaceNormal=function(e,t){if(!l.equalsEpsilon(e,l.ZERO,O.EPSILON14))return f(t)||(t=new l),t=l.multiplyComponents(e,this._oneOverRadiiSquared,t),l.normalize(t,t)};var Ip=new l,Mp=new l;Te.prototype.cartographicToCartesian=function(e,t){let n=Ip,o=Mp;this.geodeticSurfaceNormalCartographic(e,n),l.multiplyComponents(this._radiiSquared,n,o);let i=Math.sqrt(l.dot(n,o));return l.divideByScalar(o,i,o),l.multiplyByScalar(n,e.height,n),f(t)||(t=new l),l.add(o,n,t)};Te.prototype.cartographicArrayToCartesianArray=function(e,t){let n=e.length;f(t)?t.length=n:t=new Array(n);for(let o=0;o<n;o++)t[o]=this.cartographicToCartesian(e[o],t[o]);return t};var zp=new l,Dp=new l,Np=new l;Te.prototype.cartesianToCartographic=function(e,t){let n=this.scaleToGeodeticSurface(e,Dp);if(!f(n))return;let o=this.geodeticSurfaceNormal(n,zp),i=l.subtract(e,n,Np),r=Math.atan2(o.y,o.x),s=Math.asin(o.z),a=O.sign(l.dot(i,e))*l.magnitude(i);return f(t)?(t.longitude=r,t.latitude=s,t.height=a,t):new ve(r,s,a)};Te.prototype.cartesianArrayToCartographicArray=function(e,t){let n=e.length;f(t)?t.length=n:t=new Array(n);for(let o=0;o<n;++o)t[o]=this.cartesianToCartographic(e[o],t[o]);return t};Te.prototype.scaleToGeodeticSurface=function(e,t){return Xi(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};Te.prototype.scaleToGeocentricSurface=function(e,t){f(t)||(t=new l);let n=e.x,o=e.y,i=e.z,r=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*r.x+o*o*r.y+i*i*r.z);return l.multiplyByScalar(e,s,t)};Te.prototype.transformPositionToScaledSpace=function(e,t){return f(t)||(t=new l),l.multiplyComponents(e,this._oneOverRadii,t)};Te.prototype.transformPositionFromScaledSpace=function(e,t){return f(t)||(t=new l),l.multiplyComponents(e,this._radii,t)};Te.prototype.equals=function(e){return this===e||f(e)&&l.equals(this._radii,e._radii)};Te.prototype.toString=function(){return this._radii.toString()};Te.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){t=y(t,0);let o=this._squaredXOverSquaredZ;if(f(n)||(n=new l),n.x=0,n.y=0,n.z=e.z*(1-o),!(Math.abs(n.z)>=this._radii.z-t))return n};var Lp=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],Fp=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function xc(e,t,n){let o=.5*(t+e),i=.5*(t-e),r=0;for(let s=0;s<5;s++){let a=i*Lp[s];r+=Fp[s]*(n(o+a)+n(o-a))}return r*=i,r}Te.prototype.surfaceArea=function(e){let t=e.west,n=e.east,o=e.south,i=e.north;for(;n<t;)n+=O.TWO_PI;let r=this._radiiSquared,s=r.x,a=r.y,c=r.z,u=s*a;return xc(o,i,function(d){let m=Math.cos(d),p=Math.sin(d);return Math.cos(d)*xc(t,n,function(_){let g=Math.cos(_),v=Math.sin(_);return Math.sqrt(u*p*p+c*(a*g*g+s*v*v)*m*m)})})};var xt=Te;function $i(e){this._ellipsoid=y(e,xt.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties($i.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});$i.prototype.project=function(e,t){let n=this._semimajorAxis,o=e.longitude*n,i=e.latitude*n,r=e.height;return f(t)?(t.x=o,t.y=i,t.z=r,t):new l(o,i,r)};$i.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,o=e.x*n,i=e.y*n,r=e.z;return f(t)?(t.longitude=o,t.latitude=i,t.height=r,t):new ve(o,i,r)};var nn=$i;var Bp={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Yt=Object.freeze(Bp);function Up(e,t){this.start=y(e,0),this.stop=y(t,0)}var Nn=Up;function me(e,t,n,o){this.west=y(e,0),this.south=y(t,0),this.east=y(n,0),this.north=y(o,0)}Object.defineProperties(me.prototype,{width:{get:function(){return me.computeWidth(this)}},height:{get:function(){return me.computeHeight(this)}}});me.packedLength=4;me.pack=function(e,t,n){return n=y(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t};me.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new me),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n};me.computeWidth=function(e){let t=e.east,n=e.west;return t<n&&(t+=O.TWO_PI),t-n};me.computeHeight=function(e){return e.north-e.south};me.fromDegrees=function(e,t,n,o,i){return e=O.toRadians(y(e,0)),t=O.toRadians(y(t,0)),n=O.toRadians(y(n,0)),o=O.toRadians(y(o,0)),f(i)?(i.west=e,i.south=t,i.east=n,i.north=o,i):new me(e,t,n,o)};me.fromRadians=function(e,t,n,o,i){return f(i)?(i.west=y(e,0),i.south=y(t,0),i.east=y(n,0),i.north=y(o,0),i):new me(e,t,n,o)};me.fromCartographicArray=function(e,t){let n=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(let c=0,u=e.length;c<u;c++){let d=e[c];n=Math.min(n,d.longitude),o=Math.max(o,d.longitude),s=Math.min(s,d.latitude),a=Math.max(a,d.latitude);let m=d.longitude>=0?d.longitude:d.longitude+O.TWO_PI;i=Math.min(i,m),r=Math.max(r,m)}return o-n>r-i&&(n=i,o=r,o>O.PI&&(o=o-O.TWO_PI),n>O.PI&&(n=n-O.TWO_PI)),f(t)?(t.west=n,t.south=s,t.east=o,t.north=a,t):new me(n,s,o,a)};me.fromCartesianArray=function(e,t,n){t=y(t,xt.WGS84);let o=Number.MAX_VALUE,i=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let u=0,d=e.length;u<d;u++){let m=t.cartesianToCartographic(e[u]);o=Math.min(o,m.longitude),i=Math.max(i,m.longitude),a=Math.min(a,m.latitude),c=Math.max(c,m.latitude);let p=m.longitude>=0?m.longitude:m.longitude+O.TWO_PI;r=Math.min(r,p),s=Math.max(s,p)}return i-o>s-r&&(o=r,i=s,i>O.PI&&(i=i-O.TWO_PI),o>O.PI&&(o=o-O.TWO_PI)),f(n)?(n.west=o,n.south=a,n.east=i,n.north=c,n):new me(o,a,i,c)};me.clone=function(e,t){if(!!f(e))return f(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new me(e.west,e.south,e.east,e.north)};me.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n};me.prototype.clone=function(e){return me.clone(this,e)};me.prototype.equals=function(e){return me.equals(this,e)};me.equals=function(e,t){return e===t||f(e)&&f(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};me.prototype.equalsEpsilon=function(e,t){return me.equalsEpsilon(this,e,t)};me.validate=function(e){};me.southwest=function(e,t){return f(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new ve(e.west,e.south)};me.northwest=function(e,t){return f(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new ve(e.west,e.north)};me.northeast=function(e,t){return f(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new ve(e.east,e.north)};me.southeast=function(e,t){return f(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new ve(e.east,e.south)};me.center=function(e,t){let n=e.east,o=e.west;n<o&&(n+=O.TWO_PI);let i=O.negativePiToPi((o+n)*.5),r=(e.south+e.north)*.5;return f(t)?(t.longitude=i,t.latitude=r,t.height=0,t):new ve(i,r)};me.intersection=function(e,t,n){let o=e.east,i=e.west,r=t.east,s=t.west;o<i&&r>0?o+=O.TWO_PI:r<s&&o>0&&(r+=O.TWO_PI),o<i&&s<0?s+=O.TWO_PI:r<s&&i<0&&(i+=O.TWO_PI);let a=O.negativePiToPi(Math.max(i,s)),c=O.negativePiToPi(Math.min(o,r));if((e.west<e.east||t.west<t.east)&&c<=a)return;let u=Math.max(e.south,t.south),d=Math.min(e.north,t.north);if(!(u>=d))return f(n)?(n.west=a,n.south=u,n.east=c,n.north=d,n):new me(a,u,c,d)};me.simpleIntersection=function(e,t,n){let o=Math.max(e.west,t.west),i=Math.max(e.south,t.south),r=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(i>=s||o>=r))return f(n)?(n.west=o,n.south=i,n.east=r,n.north=s,n):new me(o,i,r,s)};me.union=function(e,t,n){f(n)||(n=new me);let o=e.east,i=e.west,r=t.east,s=t.west;o<i&&r>0?o+=O.TWO_PI:r<s&&o>0&&(r+=O.TWO_PI),o<i&&s<0?s+=O.TWO_PI:r<s&&i<0&&(i+=O.TWO_PI);let a=O.negativePiToPi(Math.min(i,s)),c=O.negativePiToPi(Math.max(o,r));return n.west=a,n.south=Math.min(e.south,t.south),n.east=c,n.north=Math.max(e.north,t.north),n};me.expand=function(e,t,n){return f(n)||(n=new me),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n};me.contains=function(e,t){let n=t.longitude,o=t.latitude,i=e.west,r=e.east;return r<i&&(r+=O.TWO_PI,n<0&&(n+=O.TWO_PI)),(n>i||O.equalsEpsilon(n,i,O.EPSILON14))&&(n<r||O.equalsEpsilon(n,r,O.EPSILON14))&&o>=e.south&&o<=e.north};var Vp=new ve;me.subsample=function(e,t,n,o){t=y(t,xt.WGS84),n=y(n,0),f(o)||(o=[]);let i=0,r=e.north,s=e.south,a=e.east,c=e.west,u=Vp;u.height=n,u.longitude=c,u.latitude=r,o[i]=t.cartographicToCartesian(u,o[i]),i++,u.longitude=a,o[i]=t.cartographicToCartesian(u,o[i]),i++,u.latitude=s,o[i]=t.cartographicToCartesian(u,o[i]),i++,u.longitude=c,o[i]=t.cartographicToCartesian(u,o[i]),i++,r<0?u.latitude=r:s>0?u.latitude=s:u.latitude=0;for(let d=1;d<8;++d)u.longitude=-Math.PI+d*O.PI_OVER_TWO,me.contains(e,u)&&(o[i]=t.cartographicToCartesian(u,o[i]),i++);return u.latitude===0&&(u.longitude=c,o[i]=t.cartographicToCartesian(u,o[i]),i++,u.longitude=a,o[i]=t.cartographicToCartesian(u,o[i]),i++),o.length=i,o};me.subsection=function(e,t,n,o,i,r){if(f(r)||(r=new me),e.west<=e.east){let a=e.east-e.west;r.west=e.west+t*a,r.east=e.west+o*a}else{let a=O.TWO_PI+e.east-e.west;r.west=O.negativePiToPi(e.west+t*a),r.east=O.negativePiToPi(e.west+o*a)}let s=e.north-e.south;return r.south=e.south+n*s,r.north=e.south+i*s,t===1&&(r.west=e.east),o===1&&(r.east=e.east),n===1&&(r.south=e.north),i===1&&(r.north=e.north),r};me.MAX_VALUE=Object.freeze(new me(-Math.PI,-O.PI_OVER_TWO,Math.PI,O.PI_OVER_TWO));var vn=me;function ce(e,t){this.center=l.clone(y(e,l.ZERO)),this.radius=y(t,0)}var ys=new l,gs=new l,Cs=new l,vs=new l,Es=new l,Ts=new l,bs=new l,st=new l,As=new l,xs=new l,ws=new l,Ss=new l,kp=4/3*O.PI;ce.fromPoints=function(e,t){if(f(t)||(t=new ce),!f(e)||e.length===0)return t.center=l.clone(l.ZERO,t.center),t.radius=0,t;let n=l.clone(e[0],bs),o=l.clone(n,ys),i=l.clone(n,gs),r=l.clone(n,Cs),s=l.clone(n,vs),a=l.clone(n,Es),c=l.clone(n,Ts),u=e.length,d;for(d=1;d<u;d++){l.clone(e[d],n);let F=n.x,N=n.y,I=n.z;F<o.x&&l.clone(n,o),F>s.x&&l.clone(n,s),N<i.y&&l.clone(n,i),N>a.y&&l.clone(n,a),I<r.z&&l.clone(n,r),I>c.z&&l.clone(n,c)}let m=l.magnitudeSquared(l.subtract(s,o,st)),p=l.magnitudeSquared(l.subtract(a,i,st)),_=l.magnitudeSquared(l.subtract(c,r,st)),g=o,v=s,b=m;p>b&&(b=p,g=i,v=a),_>b&&(b=_,g=r,v=c);let S=As;S.x=(g.x+v.x)*.5,S.y=(g.y+v.y)*.5,S.z=(g.z+v.z)*.5;let A=l.magnitudeSquared(l.subtract(v,S,st)),x=Math.sqrt(A),P=xs;P.x=o.x,P.y=i.y,P.z=r.z;let z=ws;z.x=s.x,z.y=a.y,z.z=c.z;let L=l.midpoint(P,z,Ss),B=0;for(d=0;d<u;d++){l.clone(e[d],n);let F=l.magnitude(l.subtract(n,L,st));F>B&&(B=F);let N=l.magnitudeSquared(l.subtract(n,S,st));if(N>A){let I=Math.sqrt(N);x=(x+I)*.5,A=x*x;let U=I-x;S.x=(x*S.x+U*n.x)/I,S.y=(x*S.y+U*n.y)/I,S.z=(x*S.z+U*n.z)/I}}return x<B?(l.clone(S,t.center),t.radius=x):(l.clone(L,t.center),t.radius=B),t};var Gp=new nn,jp=new l,Hp=new l,ps=new ve,_s=new ve;ce.fromRectangle2D=function(e,t,n){return ce.fromRectangleWithHeights2D(e,t,0,0,n)};ce.fromRectangleWithHeights2D=function(e,t,n,o,i){if(f(i)||(i=new ce),!f(e))return i.center=l.clone(l.ZERO,i.center),i.radius=0,i;t=y(t,Gp),vn.southwest(e,ps),ps.height=n,vn.northeast(e,_s),_s.height=o;let r=t.project(ps,jp),s=t.project(_s,Hp),a=s.x-r.x,c=s.y-r.y,u=s.z-r.z;i.radius=Math.sqrt(a*a+c*c+u*u)*.5;let d=i.center;return d.x=r.x+a*.5,d.y=r.y+c*.5,d.z=r.z+u*.5,i};var qp=[];ce.fromRectangle3D=function(e,t,n,o){if(t=y(t,xt.WGS84),n=y(n,0),f(o)||(o=new ce),!f(e))return o.center=l.clone(l.ZERO,o.center),o.radius=0,o;let i=vn.subsample(e,t,n,qp);return ce.fromPoints(i,o)};ce.fromVertices=function(e,t,n,o){if(f(o)||(o=new ce),!f(e)||e.length===0)return o.center=l.clone(l.ZERO,o.center),o.radius=0,o;t=y(t,l.ZERO),n=y(n,3);let i=bs;i.x=e[0]+t.x,i.y=e[1]+t.y,i.z=e[2]+t.z;let r=l.clone(i,ys),s=l.clone(i,gs),a=l.clone(i,Cs),c=l.clone(i,vs),u=l.clone(i,Es),d=l.clone(i,Ts),m=e.length,p;for(p=0;p<m;p+=n){let I=e[p]+t.x,U=e[p+1]+t.y,h=e[p+2]+t.z;i.x=I,i.y=U,i.z=h,I<r.x&&l.clone(i,r),I>c.x&&l.clone(i,c),U<s.y&&l.clone(i,s),U>u.y&&l.clone(i,u),h<a.z&&l.clone(i,a),h>d.z&&l.clone(i,d)}let _=l.magnitudeSquared(l.subtract(c,r,st)),g=l.magnitudeSquared(l.subtract(u,s,st)),v=l.magnitudeSquared(l.subtract(d,a,st)),b=r,S=c,A=_;g>A&&(A=g,b=s,S=u),v>A&&(A=v,b=a,S=d);let x=As;x.x=(b.x+S.x)*.5,x.y=(b.y+S.y)*.5,x.z=(b.z+S.z)*.5;let P=l.magnitudeSquared(l.subtract(S,x,st)),z=Math.sqrt(P),L=xs;L.x=r.x,L.y=s.y,L.z=a.z;let B=ws;B.x=c.x,B.y=u.y,B.z=d.z;let F=l.midpoint(L,B,Ss),N=0;for(p=0;p<m;p+=n){i.x=e[p]+t.x,i.y=e[p+1]+t.y,i.z=e[p+2]+t.z;let I=l.magnitude(l.subtract(i,F,st));I>N&&(N=I);let U=l.magnitudeSquared(l.subtract(i,x,st));if(U>P){let h=Math.sqrt(U);z=(z+h)*.5,P=z*z;let C=h-z;x.x=(z*x.x+C*i.x)/h,x.y=(z*x.y+C*i.y)/h,x.z=(z*x.z+C*i.z)/h}}return z<N?(l.clone(x,o.center),o.radius=z):(l.clone(F,o.center),o.radius=N),o};ce.fromEncodedCartesianVertices=function(e,t,n){if(f(n)||(n=new ce),!f(e)||!f(t)||e.length!==t.length||e.length===0)return n.center=l.clone(l.ZERO,n.center),n.radius=0,n;let o=bs;o.x=e[0]+t[0],o.y=e[1]+t[1],o.z=e[2]+t[2];let i=l.clone(o,ys),r=l.clone(o,gs),s=l.clone(o,Cs),a=l.clone(o,vs),c=l.clone(o,Es),u=l.clone(o,Ts),d=e.length,m;for(m=0;m<d;m+=3){let N=e[m]+t[m],I=e[m+1]+t[m+1],U=e[m+2]+t[m+2];o.x=N,o.y=I,o.z=U,N<i.x&&l.clone(o,i),N>a.x&&l.clone(o,a),I<r.y&&l.clone(o,r),I>c.y&&l.clone(o,c),U<s.z&&l.clone(o,s),U>u.z&&l.clone(o,u)}let p=l.magnitudeSquared(l.subtract(a,i,st)),_=l.magnitudeSquared(l.subtract(c,r,st)),g=l.magnitudeSquared(l.subtract(u,s,st)),v=i,b=a,S=p;_>S&&(S=_,v=r,b=c),g>S&&(S=g,v=s,b=u);let A=As;A.x=(v.x+b.x)*.5,A.y=(v.y+b.y)*.5,A.z=(v.z+b.z)*.5;let x=l.magnitudeSquared(l.subtract(b,A,st)),P=Math.sqrt(x),z=xs;z.x=i.x,z.y=r.y,z.z=s.z;let L=ws;L.x=a.x,L.y=c.y,L.z=u.z;let B=l.midpoint(z,L,Ss),F=0;for(m=0;m<d;m+=3){o.x=e[m]+t[m],o.y=e[m+1]+t[m+1],o.z=e[m+2]+t[m+2];let N=l.magnitude(l.subtract(o,B,st));N>F&&(F=N);let I=l.magnitudeSquared(l.subtract(o,A,st));if(I>x){let U=Math.sqrt(I);P=(P+U)*.5,x=P*P;let h=U-P;A.x=(P*A.x+h*o.x)/U,A.y=(P*A.y+h*o.y)/U,A.z=(P*A.z+h*o.z)/U}}return P<F?(l.clone(A,n.center),n.radius=P):(l.clone(B,n.center),n.radius=F),n};ce.fromCornerPoints=function(e,t,n){f(n)||(n=new ce);let o=l.midpoint(e,t,n.center);return n.radius=l.distance(o,t),n};ce.fromEllipsoid=function(e,t){return f(t)||(t=new ce),l.clone(l.ZERO,t.center),t.radius=e.maximumRadius,t};var Wp=new l;ce.fromBoundingSpheres=function(e,t){if(f(t)||(t=new ce),!f(e)||e.length===0)return t.center=l.clone(l.ZERO,t.center),t.radius=0,t;let n=e.length;if(n===1)return ce.clone(e[0],t);if(n===2)return ce.union(e[0],e[1],t);let o=[],i;for(i=0;i<n;i++)o.push(e[i].center);t=ce.fromPoints(o,t);let r=t.center,s=t.radius;for(i=0;i<n;i++){let a=e[i];s=Math.max(s,l.distance(r,a.center,Wp)+a.radius)}return t.radius=s,t};var Yp=new l,Xp=new l,$p=new l;ce.fromOrientedBoundingBox=function(e,t){f(t)||(t=new ce);let n=e.halfAxes,o=Z.getColumn(n,0,Yp),i=Z.getColumn(n,1,Xp),r=Z.getColumn(n,2,$p);return l.add(o,i,o),l.add(o,r,o),t.center=l.clone(e.center,t.center),t.radius=l.magnitude(o),t};var Kp=new l,Zp=new l;ce.fromTransformation=function(e,t){f(t)||(t=new ce);let n=X.getTranslation(e,Kp),o=X.getScale(e,Zp),i=.5*l.magnitude(o);return t.center=l.clone(n,t.center),t.radius=i,t};ce.clone=function(e,t){if(!!f(e))return f(t)?(t.center=l.clone(e.center,t.center),t.radius=e.radius,t):new ce(e.center,e.radius)};ce.packedLength=4;ce.pack=function(e,t,n){n=y(n,0);let o=e.center;return t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n]=e.radius,t};ce.unpack=function(e,t,n){t=y(t,0),f(n)||(n=new ce);let o=n.center;return o.x=e[t++],o.y=e[t++],o.z=e[t++],n.radius=e[t],n};var Qp=new l,Jp=new l;ce.union=function(e,t,n){f(n)||(n=new ce);let o=e.center,i=e.radius,r=t.center,s=t.radius,a=l.subtract(r,o,Qp),c=l.magnitude(a);if(i>=c+s)return e.clone(n),n;if(s>=c+i)return t.clone(n),n;let u=(i+c+s)*.5,d=l.multiplyByScalar(a,(-i+u)/c,Jp);return l.add(d,o,d),l.clone(d,n.center),n.radius=u,n};var e0=new l;ce.expand=function(e,t,n){n=ce.clone(e,n);let o=l.magnitude(l.subtract(t,n.center,e0));return o>n.radius&&(n.radius=o),n};ce.intersectPlane=function(e,t){let n=e.center,o=e.radius,i=t.normal,r=l.dot(i,n)+t.distance;return r<-o?Yt.OUTSIDE:r<o?Yt.INTERSECTING:Yt.INSIDE};ce.transform=function(e,t,n){return f(n)||(n=new ce),n.center=X.multiplyByPoint(t,e.center,n.center),n.radius=X.getMaximumScale(t)*e.radius,n};var t0=new l;ce.distanceSquaredTo=function(e,t){let n=l.subtract(e.center,t,t0),o=l.magnitude(n)-e.radius;return o<=0?0:o*o};ce.transformWithoutScale=function(e,t,n){return f(n)||(n=new ce),n.center=X.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var n0=new l;ce.computePlaneDistances=function(e,t,n,o){f(o)||(o=new Nn);let i=l.subtract(e.center,t,n0),r=l.dot(n,i);return o.start=r-e.radius,o.stop=r+e.radius,o};var Sc=new l,o0=new l,i0=new l,r0=new l,s0=new l,a0=new ve,Rc=new Array(8);for(let e=0;e<8;++e)Rc[e]=new l;var c0=new nn;ce.projectTo2D=function(e,t,n){t=y(t,c0);let o=t.ellipsoid,i=e.center,r=e.radius,s;l.equals(i,l.ZERO)?s=l.clone(l.UNIT_X,Sc):s=o.geodeticSurfaceNormal(i,Sc);let a=l.cross(l.UNIT_Z,s,o0);l.normalize(a,a);let c=l.cross(s,a,i0);l.normalize(c,c),l.multiplyByScalar(s,r,s),l.multiplyByScalar(c,r,c),l.multiplyByScalar(a,r,a);let u=l.negate(c,s0),d=l.negate(a,r0),m=Rc,p=m[0];l.add(s,c,p),l.add(p,a,p),p=m[1],l.add(s,c,p),l.add(p,d,p),p=m[2],l.add(s,u,p),l.add(p,d,p),p=m[3],l.add(s,u,p),l.add(p,a,p),l.negate(s,s),p=m[4],l.add(s,c,p),l.add(p,a,p),p=m[5],l.add(s,c,p),l.add(p,d,p),p=m[6],l.add(s,u,p),l.add(p,d,p),p=m[7],l.add(s,u,p),l.add(p,a,p);let _=m.length;for(let S=0;S<_;++S){let A=m[S];l.add(i,A,A);let x=o.cartesianToCartographic(A,a0);t.project(x,A)}n=ce.fromPoints(m,n),i=n.center;let g=i.x,v=i.y,b=i.z;return i.x=b,i.y=g,i.z=v,n};ce.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)};ce.equals=function(e,t){return e===t||f(e)&&f(t)&&l.equals(e.center,t.center)&&e.radius===t.radius};ce.prototype.intersectPlane=function(e){return ce.intersectPlane(this,e)};ce.prototype.distanceSquaredTo=function(e){return ce.distanceSquaredTo(this,e)};ce.prototype.computePlaneDistances=function(e,t,n){return ce.computePlaneDistances(this,e,t,n)};ce.prototype.isOccluded=function(e){return ce.isOccluded(this,e)};ce.prototype.equals=function(e){return ce.equals(this,e)};ce.prototype.clone=function(e){return ce.clone(this,e)};ce.prototype.volume=function(){let e=this.radius;return kp*e*e*e};var le=ce;function ee(e,t){this.x=y(e,0),this.y=y(t,0)}ee.fromElements=function(e,t,n){return f(n)?(n.x=e,n.y=t,n):new ee(e,t)};ee.clone=function(e,t){if(!!f(e))return f(t)?(t.x=e.x,t.y=e.y,t):new ee(e.x,e.y)};ee.fromCartesian3=ee.clone;ee.fromCartesian4=ee.clone;ee.packedLength=2;ee.pack=function(e,t,n){return n=y(n,0),t[n++]=e.x,t[n]=e.y,t};ee.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new ee),n.x=e[t++],n.y=e[t],n};ee.packArray=function(e,t){let n=e.length,o=n*2;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)ee.pack(e[i],t,i*2);return t};ee.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/2:t=new Array(n/2);for(let o=0;o<n;o+=2){let i=o/2;t[i]=ee.unpack(e,o,t[i])}return t};ee.fromArray=ee.unpack;ee.maximumComponent=function(e){return Math.max(e.x,e.y)};ee.minimumComponent=function(e){return Math.min(e.x,e.y)};ee.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n};ee.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n};ee.clamp=function(e,t,n,o){let i=O.clamp(e.x,t.x,n.x),r=O.clamp(e.y,t.y,n.y);return o.x=i,o.y=r,o};ee.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y};ee.magnitude=function(e){return Math.sqrt(ee.magnitudeSquared(e))};var Ki=new ee;ee.distance=function(e,t){return ee.subtract(e,t,Ki),ee.magnitude(Ki)};ee.distanceSquared=function(e,t){return ee.subtract(e,t,Ki),ee.magnitudeSquared(Ki)};ee.normalize=function(e,t){let n=ee.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t};ee.dot=function(e,t){return e.x*t.x+e.y*t.y};ee.cross=function(e,t){return e.x*t.y-e.y*t.x};ee.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n};ee.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n};ee.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n};ee.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n};ee.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n};ee.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n};ee.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t};ee.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var Pc=new ee;ee.lerp=function(e,t,n,o){return ee.multiplyByScalar(t,n,Pc),o=ee.multiplyByScalar(e,1-n,o),ee.add(Pc,o,o)};var Oc=new ee,Ic=new ee;ee.angleBetween=function(e,t){return ee.normalize(e,Oc),ee.normalize(t,Ic),O.acosClamped(ee.dot(Oc,Ic))};var u0=new ee;ee.mostOrthogonalAxis=function(e,t){let n=ee.normalize(e,u0);return ee.abs(n,n),n.x<=n.y?t=ee.clone(ee.UNIT_X,t):t=ee.clone(ee.UNIT_Y,t),t};ee.equals=function(e,t){return e===t||f(e)&&f(t)&&e.x===t.x&&e.y===t.y};ee.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]};ee.equalsEpsilon=function(e,t,n,o){return e===t||f(e)&&f(t)&&O.equalsEpsilon(e.x,t.x,n,o)&&O.equalsEpsilon(e.y,t.y,n,o)};ee.ZERO=Object.freeze(new ee(0,0));ee.ONE=Object.freeze(new ee(1,1));ee.UNIT_X=Object.freeze(new ee(1,0));ee.UNIT_Y=Object.freeze(new ee(0,1));ee.prototype.clone=function(e){return ee.clone(this,e)};ee.prototype.equals=function(e){return ee.equals(this,e)};ee.prototype.equalsEpsilon=function(e,t,n){return ee.equalsEpsilon(this,e,t,n)};ee.prototype.toString=function(){return`(${this.x}, ${this.y})`};var ne=ee;function f0(){return!0}function l0(e,t){t=y(t,"This object was destroyed, i.e., destroy() was called.");function n(){}for(let o in e)typeof e[o]=="function"&&(e[o]=n);e.isDestroyed=f0}var It=l0;function on(){this.high=l.clone(l.ZERO),this.low=l.clone(l.ZERO)}on.encode=function(e,t){f(t)||(t={high:0,low:0});let n;return e>=0?(n=Math.floor(e/65536)*65536,t.high=n,t.low=e-n):(n=Math.floor(-e/65536)*65536,t.high=-n,t.low=e+n),t};var En={high:0,low:0};on.fromCartesian=function(e,t){f(t)||(t=new on);let n=t.high,o=t.low;return on.encode(e.x,En),n.x=En.high,o.x=En.low,on.encode(e.y,En),n.y=En.high,o.y=En.low,on.encode(e.z,En),n.z=En.high,o.z=En.low,t};var Rs=new on;on.writeElements=function(e,t,n){on.fromCartesian(e,Rs);let o=Rs.high,i=Rs.low;t[n]=o.x,t[n+1]=o.y,t[n+2]=o.z,t[n+3]=i.x,t[n+4]=i.y,t[n+5]=i.z};var xo=on;var d0={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},Jn=Object.freeze(d0);function ie(e,t,n,o){this[0]=y(e,0),this[1]=y(n,0),this[2]=y(t,0),this[3]=y(o,0)}ie.packedLength=4;ie.pack=function(e,t,n){return n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t};ie.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new ie),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n};ie.packArray=function(e,t){let n=e.length,o=n*4;f(t)?!Array.isArray(t)&&t.length!==o||t.length!==o&&(t.length=o):t=new Array(o);for(let i=0;i<n;++i)ie.pack(e[i],t,i*4);return t};ie.unpackArray=function(e,t){let n=e.length;f(t)?t.length=n/4:t=new Array(n/4);for(let o=0;o<n;o+=4){let i=o/4;t[i]=ie.unpack(e,o,t[i])}return t};ie.clone=function(e,t){if(!!f(e))return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new ie(e[0],e[2],e[1],e[3])};ie.fromArray=ie.unpack;ie.fromColumnMajorArray=function(e,t){return ie.clone(e,t)};ie.fromRowMajorArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new ie(e[0],e[1],e[2],e[3])};ie.fromScale=function(e,t){return f(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new ie(e.x,0,0,e.y)};ie.fromUniformScale=function(e,t){return f(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new ie(e,0,0,e)};ie.fromRotation=function(e,t){let n=Math.cos(e),o=Math.sin(e);return f(t)?(t[0]=n,t[1]=o,t[2]=-o,t[3]=n,t):new ie(n,-o,o,n)};ie.toArray=function(e,t){return f(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]};ie.getElementIndex=function(e,t){return e*2+t};ie.getColumn=function(e,t,n){let o=t*2,i=e[o],r=e[o+1];return n.x=i,n.y=r,n};ie.setColumn=function(e,t,n,o){o=ie.clone(e,o);let i=t*2;return o[i]=n.x,o[i+1]=n.y,o};ie.getRow=function(e,t,n){let o=e[t],i=e[t+2];return n.x=o,n.y=i,n};ie.setRow=function(e,t,n,o){return o=ie.clone(e,o),o[t]=n.x,o[t+2]=n.y,o};var m0=new ne;ie.setScale=function(e,t,n){let o=ie.getScale(e,m0),i=t.x/o.x,r=t.y/o.y;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*r,n[3]=e[3]*r,n};var h0=new ne;ie.setUniformScale=function(e,t,n){let o=ie.getScale(e,h0),i=t/o.x,r=t/o.y;return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*r,n[3]=e[3]*r,n};var Mc=new ne;ie.getScale=function(e,t){return t.x=ne.magnitude(ne.fromElements(e[0],e[1],Mc)),t.y=ne.magnitude(ne.fromElements(e[2],e[3],Mc)),t};var zc=new ne;ie.getMaximumScale=function(e){return ie.getScale(e,zc),ne.maximumComponent(zc)};var p0=new ne;ie.setRotation=function(e,t,n){let o=ie.getScale(e,p0);return n[0]=t[0]*o.x,n[1]=t[1]*o.x,n[2]=t[2]*o.y,n[3]=t[3]*o.y,n};var _0=new ne;ie.getRotation=function(e,t){let n=ie.getScale(e,_0);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t};ie.multiply=function(e,t,n){let o=e[0]*t[0]+e[2]*t[1],i=e[0]*t[2]+e[2]*t[3],r=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=o,n[1]=r,n[2]=i,n[3]=s,n};ie.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n};ie.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n};ie.multiplyByVector=function(e,t,n){let o=e[0]*t.x+e[2]*t.y,i=e[1]*t.x+e[3]*t.y;return n.x=o,n.y=i,n};ie.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};ie.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n};ie.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};ie.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t};ie.transpose=function(e,t){let n=e[0],o=e[2],i=e[1],r=e[3];return t[0]=n,t[1]=o,t[2]=i,t[3]=r,t};ie.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t};ie.equals=function(e,t){return e===t||f(e)&&f(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};ie.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]};ie.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n};ie.IDENTITY=Object.freeze(new ie(1,0,0,1));ie.ZERO=Object.freeze(new ie(0,0,0,0));ie.COLUMN0ROW0=0;ie.COLUMN0ROW1=1;ie.COLUMN1ROW0=2;ie.COLUMN1ROW1=3;Object.defineProperties(ie.prototype,{length:{get:function(){return ie.packedLength}}});ie.prototype.clone=function(e){return ie.clone(this,e)};ie.prototype.equals=function(e){return ie.equals(this,e)};ie.prototype.equalsEpsilon=function(e,t){return ie.equalsEpsilon(this,e,t)};ie.prototype.toString=function(){return`(${this[0]}, ${this[2]})
(${this[1]}, ${this[3]})`};var Mt=ie;var mt={POINTS:w.POINTS,LINES:w.LINES,LINE_LOOP:w.LINE_LOOP,LINE_STRIP:w.LINE_STRIP,TRIANGLES:w.TRIANGLES,TRIANGLE_STRIP:w.TRIANGLE_STRIP,TRIANGLE_FAN:w.TRIANGLE_FAN};mt.isLines=function(e){return e===mt.LINES||e===mt.LINE_LOOP||e===mt.LINE_STRIP};mt.isTriangles=function(e){return e===mt.TRIANGLES||e===mt.TRIANGLE_STRIP||e===mt.TRIANGLE_FAN};mt.validate=function(e){return e===mt.POINTS||e===mt.LINES||e===mt.LINE_LOOP||e===mt.LINE_STRIP||e===mt.TRIANGLES||e===mt.TRIANGLE_STRIP||e===mt.TRIANGLE_FAN};var Oe=Object.freeze(mt);function H(e,t,n,o){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0),this.w=y(o,0)}var Zo=new l;H.fromAxisAngle=function(e,t,n){let o=t/2,i=Math.sin(o);Zo=l.normalize(e,Zo);let r=Zo.x*i,s=Zo.y*i,a=Zo.z*i,c=Math.cos(o);return f(n)?(n.x=r,n.y=s,n.z=a,n.w=c,n):new H(r,s,a,c)};var y0=[1,2,0],g0=new Array(3);H.fromRotationMatrix=function(e,t){let n,o,i,r,s,a=e[Z.COLUMN0ROW0],c=e[Z.COLUMN1ROW1],u=e[Z.COLUMN2ROW2],d=a+c+u;if(d>0)n=Math.sqrt(d+1),s=.5*n,n=.5/n,o=(e[Z.COLUMN1ROW2]-e[Z.COLUMN2ROW1])*n,i=(e[Z.COLUMN2ROW0]-e[Z.COLUMN0ROW2])*n,r=(e[Z.COLUMN0ROW1]-e[Z.COLUMN1ROW0])*n;else{let m=y0,p=0;c>a&&(p=1),u>a&&u>c&&(p=2);let _=m[p],g=m[_];n=Math.sqrt(e[Z.getElementIndex(p,p)]-e[Z.getElementIndex(_,_)]-e[Z.getElementIndex(g,g)]+1);let v=g0;v[p]=.5*n,n=.5/n,s=(e[Z.getElementIndex(g,_)]-e[Z.getElementIndex(_,g)])*n,v[_]=(e[Z.getElementIndex(_,p)]+e[Z.getElementIndex(p,_)])*n,v[g]=(e[Z.getElementIndex(g,p)]+e[Z.getElementIndex(p,g)])*n,o=-v[0],i=-v[1],r=-v[2]}return f(t)?(t.x=o,t.y=i,t.z=r,t.w=s,t):new H(o,i,r,s)};var Dc=new H,Nc=new H,Ps=new H,Lc=new H;H.fromHeadingPitchRoll=function(e,t){return Lc=H.fromAxisAngle(l.UNIT_X,e.roll,Dc),Ps=H.fromAxisAngle(l.UNIT_Y,-e.pitch,t),t=H.multiply(Ps,Lc,Ps),Nc=H.fromAxisAngle(l.UNIT_Z,-e.heading,Dc),H.multiply(Nc,t,t)};var Zi=new l,Os=new l,Xt=new H,Fc=new H,Qi=new H;H.packedLength=4;H.pack=function(e,t,n){return n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};H.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new H),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n};H.packedInterpolationLength=3;H.convertPackedArrayForInterpolation=function(e,t,n,o){H.unpack(e,n*4,Qi),H.conjugate(Qi,Qi);for(let i=0,r=n-t+1;i<r;i++){let s=i*3;H.unpack(e,(t+i)*4,Xt),H.multiply(Xt,Qi,Xt),Xt.w<0&&H.negate(Xt,Xt),H.computeAxis(Xt,Zi);let a=H.computeAngle(Xt);f(o)||(o=[]),o[s]=Zi.x*a,o[s+1]=Zi.y*a,o[s+2]=Zi.z*a}};H.unpackInterpolationResult=function(e,t,n,o,i){f(i)||(i=new H),l.fromArray(e,0,Os);let r=l.magnitude(Os);return H.unpack(t,o*4,Fc),r===0?H.clone(H.IDENTITY,Xt):H.fromAxisAngle(Os,r,Xt),H.multiply(Xt,Fc,i)};H.clone=function(e,t){if(!!f(e))return f(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new H(e.x,e.y,e.z,e.w)};H.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t};H.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};H.magnitude=function(e){return Math.sqrt(H.magnitudeSquared(e))};H.normalize=function(e,t){let n=1/H.magnitude(e),o=e.x*n,i=e.y*n,r=e.z*n,s=e.w*n;return t.x=o,t.y=i,t.z=r,t.w=s,t};H.inverse=function(e,t){let n=H.magnitudeSquared(e);return t=H.conjugate(e,t),H.multiplyByScalar(t,1/n,t)};H.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};H.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};H.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};H.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};H.multiply=function(e,t,n){let o=e.x,i=e.y,r=e.z,s=e.w,a=t.x,c=t.y,u=t.z,d=t.w,m=s*a+o*d+i*u-r*c,p=s*c-o*u+i*d+r*a,_=s*u+o*c-i*a+r*d,g=s*d-o*a-i*c-r*u;return n.x=m,n.y=p,n.z=_,n.w=g,n};H.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};H.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};H.computeAxis=function(e,t){let n=e.w;if(Math.abs(n-1)<O.EPSILON6)return t.x=t.y=t.z=0,t;let o=1/Math.sqrt(1-n*n);return t.x=e.x*o,t.y=e.y*o,t.z=e.z*o,t};H.computeAngle=function(e){return Math.abs(e.w-1)<O.EPSILON6?0:2*Math.acos(e.w)};var Is=new H;H.lerp=function(e,t,n,o){return Is=H.multiplyByScalar(t,n,Is),o=H.multiplyByScalar(e,1-n,o),H.add(Is,o,o)};var Bc=new H,Ms=new H,zs=new H;H.slerp=function(e,t,n,o){let i=H.dot(e,t),r=t;if(i<0&&(i=-i,r=Bc=H.negate(t,Bc)),1-i<O.EPSILON6)return H.lerp(e,r,n,o);let s=Math.acos(i);return Ms=H.multiplyByScalar(e,Math.sin((1-n)*s),Ms),zs=H.multiplyByScalar(r,Math.sin(n*s),zs),o=H.add(Ms,zs,o),H.multiplyByScalar(o,1/Math.sin(s),o)};H.log=function(e,t){let n=O.acosClamped(e.w),o=0;return n!==0&&(o=n/Math.sin(n)),l.multiplyByScalar(e,o,t)};H.exp=function(e,t){let n=l.magnitude(e),o=0;return n!==0&&(o=Math.sin(n)/n),t.x=e.x*o,t.y=e.y*o,t.z=e.z*o,t.w=Math.cos(n),t};var C0=new l,v0=new l,Qo=new H,wo=new H;H.computeInnerQuadrangle=function(e,t,n,o){let i=H.conjugate(t,Qo);H.multiply(i,n,wo);let r=H.log(wo,C0);H.multiply(i,e,wo);let s=H.log(wo,v0);return l.add(r,s,r),l.multiplyByScalar(r,.25,r),l.negate(r,r),H.exp(r,Qo),H.multiply(t,Qo,o)};H.squad=function(e,t,n,o,i,r){let s=H.slerp(e,t,i,Qo),a=H.slerp(n,o,i,wo);return H.slerp(s,a,2*i*(1-i),r)};var E0=new H,Uc=1.9011074535173003,Ji=Wt.supportsTypedArrays()?new Float32Array(8):[],er=Wt.supportsTypedArrays()?new Float32Array(8):[],Tn=Wt.supportsTypedArrays()?new Float32Array(8):[],bn=Wt.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){let t=e+1,n=2*t+1;Ji[e]=1/(t*n),er[e]=t/n}Ji[7]=Uc/(8*17);er[7]=Uc*8/17;H.fastSlerp=function(e,t,n,o){let i=H.dot(e,t),r;i>=0?r=1:(r=-1,i=-i);let s=i-1,a=1-n,c=n*n,u=a*a;for(let _=7;_>=0;--_)Tn[_]=(Ji[_]*c-er[_])*s,bn[_]=(Ji[_]*u-er[_])*s;let d=r*n*(1+Tn[0]*(1+Tn[1]*(1+Tn[2]*(1+Tn[3]*(1+Tn[4]*(1+Tn[5]*(1+Tn[6]*(1+Tn[7])))))))),m=a*(1+bn[0]*(1+bn[1]*(1+bn[2]*(1+bn[3]*(1+bn[4]*(1+bn[5]*(1+bn[6]*(1+bn[7])))))))),p=H.multiplyByScalar(e,m,E0);return H.multiplyByScalar(t,d,o),H.add(p,o,o)};H.fastSquad=function(e,t,n,o,i,r){let s=H.fastSlerp(e,t,i,Qo),a=H.fastSlerp(n,o,i,wo);return H.fastSlerp(s,a,2*i*(1-i),r)};H.equals=function(e,t){return e===t||f(e)&&f(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};H.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n};H.ZERO=Object.freeze(new H(0,0,0,0));H.IDENTITY=Object.freeze(new H(0,0,0,1));H.prototype.clone=function(e){return H.clone(this,e)};H.prototype.equals=function(e){return H.equals(this,e)};H.prototype.equalsEpsilon=function(e,t){return H.equalsEpsilon(this,e,t)};H.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var rn=H;function T0(e,t,n){let o=0,i=e.length-1,r,s;for(;o<=i;){if(r=~~((o+i)/2),s=n(e[r],t),s<0){o=r+1;continue}if(s>0){i=r-1;continue}return r}return~(i+1)}var eo=T0;function b0(e,t,n,o,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=o,this.ut1MinusUtc=i}var Jo=b0;function A0(e,t,n,o,i,r,s,a){this.year=e,this.month=t,this.day=n,this.hour=o,this.minute=i,this.second=r,this.millisecond=s,this.isLeapSecond=a}var Ds=A0;function x0(e){return e%4===0&&e%100!==0||e%400===0}var Ns=x0;function w0(e,t){this.julianDate=e,this.offset=t}var we=w0;var S0={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:24000005e-1},De=Object.freeze(S0);var R0={UTC:0,TAI:1},pe=Object.freeze(R0);var kc=new Ds,Ls=[31,28,31,30,31,30,31,31,30,31,30,31],Fs=29;function Bs(e,t){return J.compare(e.julianDate,t.julianDate)}var So=new we;function nr(e){So.julianDate=e;let t=J.leapSeconds,n=eo(t,So,Bs);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let o=t[n].offset;n>0&&J.secondsDifference(t[n].julianDate,e)>o&&(n--,o=t[n].offset),J.addSeconds(e,o,e)}function Vc(e,t){So.julianDate=e;let n=J.leapSeconds,o=eo(n,So,Bs);if(o<0&&(o=~o),o===0)return J.addSeconds(e,-n[0].offset,t);if(o>=n.length)return J.addSeconds(e,-n[o-1].offset,t);let i=J.secondsDifference(n[o].julianDate,e);if(i===0)return J.addSeconds(e,-n[o].offset,t);if(!(i<=1))return J.addSeconds(e,-n[--o].offset,t)}function Ln(e,t,n){let o=t/De.SECONDS_PER_DAY|0;return e+=o,t-=De.SECONDS_PER_DAY*o,t<0&&(e--,t+=De.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function Us(e,t,n,o,i,r,s){let a=(t-14)/12|0,c=e+4800+a,u=(1461*c/4|0)+(367*(t-2-12*a)/12|0)-(3*((c+100)/100|0)/4|0)+n-32075;o=o-12,o<0&&(o+=24);let d=r+(o*De.SECONDS_PER_HOUR+i*De.SECONDS_PER_MINUTE+s*De.SECONDS_PER_MILLISECOND);return d>=43200&&(u-=1),[u,d]}var P0=/^(\d{4})$/,O0=/^(\d{4})-(\d{2})$/,I0=/^(\d{4})-?(\d{3})$/,M0=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,z0=/^(\d{4})-?(\d{2})-?(\d{2})$/,Vs=/([Z+\-])?(\d{2})?:?(\d{2})?$/,D0=/^(\d{2})(\.\d+)?/.source+Vs.source,N0=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Vs.source,L0=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Vs.source;function J(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=y(e,0),t=y(t,0),n=y(n,pe.UTC);let o=e|0;t=t+(e-o)*De.SECONDS_PER_DAY,Ln(o,t,this),n===pe.UTC&&nr(this)}J.fromGregorianDate=function(e,t){let n=Us(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return f(t)?(Ln(n[0],n[1],t),nr(t),t):new J(n[0],n[1],pe.UTC)};J.fromDate=function(e,t){let n=Us(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return f(t)?(Ln(n[0],n[1],t),nr(t),t):new J(n[0],n[1],pe.UTC)};J.fromIso8601=function(e,t){e=e.replace(",",".");let n=e.split("T"),o,i=1,r=1,s=0,a=0,c=0,u=0,d=n[0],m=n[1],p,_;if(n=d.match(z0),n!==null)o=+n[1],i=+n[2],r=+n[3];else if(n=d.match(O0),n!==null)o=+n[1],i=+n[2];else if(n=d.match(P0),n!==null)o=+n[1];else{let S;if(n=d.match(I0),n!==null)o=+n[1],S=+n[2],_=Ns(o);else if(n=d.match(M0),n!==null){o=+n[1];let A=+n[2],x=+n[3]||0,P=new Date(Date.UTC(o,0,4));S=A*7+x-P.getUTCDay()-3}p=new Date(Date.UTC(o,0,1)),p.setUTCDate(S),i=p.getUTCMonth()+1,r=p.getUTCDate()}_=Ns(o);let g;if(f(m)){n=m.match(L0),n!==null?(s=+n[1],a=+n[2],c=+n[3],u=+(n[4]||0)*1e3,g=5):(n=m.match(N0),n!==null?(s=+n[1],a=+n[2],c=+(n[3]||0)*60,g=4):(n=m.match(D0),n!==null&&(s=+n[1],a=+(n[2]||0)*60,g=3)));let S=n[g],A=+n[g+1],x=+(n[g+2]||0);switch(S){case"+":s=s-A,a=a-x;break;case"-":s=s+A,a=a+x;break;case"Z":break;default:a=a+new Date(Date.UTC(o,i-1,r,s,a)).getTimezoneOffset();break}}let v=c===60;for(v&&c--;a>=60;)a-=60,s++;for(;s>=24;)s-=24,r++;for(p=_&&i===2?Fs:Ls[i-1];r>p;)r-=p,i++,i>12&&(i-=12,o++),p=_&&i===2?Fs:Ls[i-1];for(;a<0;)a+=60,s--;for(;s<0;)s+=24,r--;for(;r<1;)i--,i<1&&(i+=12,o--),p=_&&i===2?Fs:Ls[i-1],r+=p;let b=Us(o,i,r,s,a,c,u);return f(t)?(Ln(b[0],b[1],t),nr(t)):t=new J(b[0],b[1],pe.UTC),v&&J.addSeconds(t,1,t),t};J.now=function(e){return J.fromDate(new Date,e)};var tr=new J(0,0,pe.TAI);J.toGregorianDate=function(e,t){let n=!1,o=Vc(e,tr);f(o)||(J.addSeconds(e,-1,tr),o=Vc(tr,tr),n=!0);let i=o.dayNumber,r=o.secondsOfDay;r>=43200&&(i+=1);let s=i+68569|0,a=4*s/146097|0;s=s-((146097*a+3)/4|0)|0;let c=4e3*(s+1)/1461001|0;s=s-(1461*c/4|0)+31|0;let u=80*s/2447|0,d=s-(2447*u/80|0)|0;s=u/11|0;let m=u+2-12*s|0,p=100*(a-49)+c+s|0,_=r/De.SECONDS_PER_HOUR|0,g=r-_*De.SECONDS_PER_HOUR,v=g/De.SECONDS_PER_MINUTE|0;g=g-v*De.SECONDS_PER_MINUTE;let b=g|0,S=(g-b)/De.SECONDS_PER_MILLISECOND;return _+=12,_>23&&(_-=24),n&&(b+=1),f(t)?(t.year=p,t.month=m,t.day=d,t.hour=_,t.minute=v,t.second=b,t.millisecond=S,t.isLeapSecond=n,t):new Ds(p,m,d,_,v,b,S,n)};J.toDate=function(e){let t=J.toGregorianDate(e,kc),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))};J.toIso8601=function(e,t){let n=J.toGregorianDate(e,kc),o=n.year,i=n.month,r=n.day,s=n.hour,a=n.minute,c=n.second,u=n.millisecond;o===1e4&&i===1&&r===1&&s===0&&a===0&&c===0&&u===0&&(o=9999,i=12,r=31,s=24);let d;return!f(t)&&u!==0?(d=(u*.01).toString().replace(".",""),`${o.toString().padStart(4,"0")}-${i.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${d}Z`):!f(t)||t===0?`${o.toString().padStart(4,"0")}-${i.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}Z`:(d=(u*.01).toFixed(t).replace(".","").slice(0,t),`${o.toString().padStart(4,"0")}-${i.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${d}Z`)};J.clone=function(e,t){if(!!f(e))return f(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new J(e.dayNumber,e.secondsOfDay,pe.TAI)};J.compare=function(e,t){let n=e.dayNumber-t.dayNumber;return n!==0?n:e.secondsOfDay-t.secondsOfDay};J.equals=function(e,t){return e===t||f(e)&&f(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};J.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||f(e)&&f(t)&&Math.abs(J.secondsDifference(e,t))<=n};J.totalDays=function(e){return e.dayNumber+e.secondsOfDay/De.SECONDS_PER_DAY};J.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*De.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)};J.daysDifference=function(e,t){let n=e.dayNumber-t.dayNumber,o=(e.secondsOfDay-t.secondsOfDay)/De.SECONDS_PER_DAY;return n+o};J.computeTaiMinusUtc=function(e){So.julianDate=e;let t=J.leapSeconds,n=eo(t,So,Bs);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset};J.addSeconds=function(e,t,n){return Ln(e.dayNumber,e.secondsOfDay+t,n)};J.addMinutes=function(e,t,n){let o=e.secondsOfDay+t*De.SECONDS_PER_MINUTE;return Ln(e.dayNumber,o,n)};J.addHours=function(e,t,n){let o=e.secondsOfDay+t*De.SECONDS_PER_HOUR;return Ln(e.dayNumber,o,n)};J.addDays=function(e,t,n){let o=e.dayNumber+t;return Ln(o,e.secondsOfDay,n)};J.lessThan=function(e,t){return J.compare(e,t)<0};J.lessThanOrEquals=function(e,t){return J.compare(e,t)<=0};J.greaterThan=function(e,t){return J.compare(e,t)>0};J.greaterThanOrEquals=function(e,t){return J.compare(e,t)>=0};J.prototype.clone=function(e){return J.clone(this,e)};J.prototype.equals=function(e){return J.equals(this,e)};J.prototype.equalsEpsilon=function(e,t){return J.equalsEpsilon(this,e,t)};J.prototype.toString=function(){return J.toIso8601(this)};J.leapSeconds=[new we(new J(2441317,43210,pe.TAI),10),new we(new J(2441499,43211,pe.TAI),11),new we(new J(2441683,43212,pe.TAI),12),new we(new J(2442048,43213,pe.TAI),13),new we(new J(2442413,43214,pe.TAI),14),new we(new J(2442778,43215,pe.TAI),15),new we(new J(2443144,43216,pe.TAI),16),new we(new J(2443509,43217,pe.TAI),17),new we(new J(2443874,43218,pe.TAI),18),new we(new J(2444239,43219,pe.TAI),19),new we(new J(2444786,43220,pe.TAI),20),new we(new J(2445151,43221,pe.TAI),21),new we(new J(2445516,43222,pe.TAI),22),new we(new J(2446247,43223,pe.TAI),23),new we(new J(2447161,43224,pe.TAI),24),new we(new J(2447892,43225,pe.TAI),25),new we(new J(2448257,43226,pe.TAI),26),new we(new J(2448804,43227,pe.TAI),27),new we(new J(2449169,43228,pe.TAI),28),new we(new J(2449534,43229,pe.TAI),29),new we(new J(2450083,43230,pe.TAI),30),new we(new J(2450630,43231,pe.TAI),31),new we(new J(2451179,43232,pe.TAI),32),new we(new J(2453736,43233,pe.TAI),33),new we(new J(2454832,43234,pe.TAI),34),new we(new J(2456109,43235,pe.TAI),35),new we(new J(2457204,43236,pe.TAI),36),new we(new J(2457754,43237,pe.TAI),37)];var at=J;var Ze=Xa(Xc(),1);function F0(e){return(e.length===0||e[e.length-1]!=="/")&&(e=`${e}/`),e}var $c=F0;function B0(){let e,t,n=new Promise(function(o,i){e=o,t=i});return{resolve:e,reject:t,promise:n}}var $t=B0;function ks(e,t){let n;return typeof document<"u"&&(n=document),ks._implementation(e,t,n)}ks._implementation=function(e,t,n){if(!f(t)){if(typeof n>"u")return e;t=y(n.baseURI,n.location.href)}let o=new Ze.default(e);return o.scheme()!==""?o.toString():o.absoluteTo(t).toString()};var sr=ks;function U0(e,t){let n="",o=e.lastIndexOf("/");return o!==-1&&(n=e.substring(0,o+1)),t&&(e=new Ze.default(e),e.query().length!==0&&(n+=`?${e.query()}`),e.fragment().length!==0&&(n+=`#${e.fragment()}`)),n}var Kc=U0;function V0(e){let t=new Ze.default(e);t.normalize();let n=t.path(),o=n.lastIndexOf("/");return o!==-1&&(n=n.substr(o+1)),o=n.lastIndexOf("."),o===-1?n="":n=n.substr(o+1),n}var Zc=V0;var Qc={};function k0(e,t,n){f(t)||(t=e.width),f(n)||(n=e.height);let o=Qc[t];f(o)||(o={},Qc[t]=o);let i=o[n];if(!f(i)){let r=document.createElement("canvas");r.width=t,r.height=n,i=r.getContext("2d"),i.globalCompositeOperation="copy",o[n]=i}return i.drawImage(e,0,0,t,n),i.getImageData(0,0,t,n).data}var Gs=k0;var G0=/^blob:/i;function j0(e){return G0.test(e)}var ar=j0;var sn;function H0(e){f(sn)||(sn=document.createElement("a")),sn.href=window.location.href;let t=sn.host,n=sn.protocol;return sn.href=e,sn.href=sn.href,n!==sn.protocol||t!==sn.host}var cr=H0;var q0=/^data:/i;function W0(e){return q0.test(e)}var ur=W0;function Y0(e){let t=document.createElement("script");return t.async=!0,t.src=e,new Promise((n,o)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");let i=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,i.removeChild(t),n()},t.onerror=function(r){o(r)},i.appendChild(t)})}var Jc=Y0;function X0(e){let t="";for(let n in e)if(e.hasOwnProperty(n)){let o=e[n],i=`${encodeURIComponent(n)}=`;if(Array.isArray(o))for(let r=0,s=o.length;r<s;++r)t+=`${i+encodeURIComponent(o[r])}&`;else t+=`${i+encodeURIComponent(o)}&`}return t=t.slice(0,-1),t}var eu=X0;function $0(e){let t={};if(e==="")return t;let n=e.replace(/\+/g,"%20").split(/[&;]/);for(let o=0,i=n.length;o<i;++o){let r=n[o].split("="),s=decodeURIComponent(r[0]),a=r[1];f(a)?a=decodeURIComponent(a):a="";let c=t[s];typeof c=="string"?t[s]=[c,a]:Array.isArray(c)?c.push(a):t[s]=a}return t}var tu=$0;var K0={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},He=Object.freeze(K0);var Z0={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},nu=Object.freeze(Z0);function fr(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.throttleByServer,!1),n=y(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=y(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=y(e.type,nu.OTHER),this.serverKey=void 0,this.state=He.UNISSUED,this.deferred=void 0,this.cancelled=!1}fr.prototype.cancel=function(){this.cancelled=!0};fr.prototype.clone=function(e){return f(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new fr(this)};var ou=fr;function Q0(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let o=0;o<n.length;++o){let i=n[o],r=i.indexOf(": ");if(r>0){let s=i.substring(0,r),a=i.substring(r+2);t[s]=a}}return t}var iu=Q0;function ru(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,typeof this.responseHeaders=="string"&&(this.responseHeaders=iu(this.responseHeaders))}ru.prototype.toString=function(){let e="Request has failed.";return f(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e};var ei=ru;function ti(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}Object.defineProperties(ti.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});ti.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);let n=this;return function(){n.removeEventListener(e,t)}};ti.prototype.removeEventListener=function(e,t){let n=this._listeners,o=this._scopes,i=-1;for(let r=0;r<n.length;r++)if(n[r]===e&&o[r]===t){i=r;break}return i!==-1?(this._insideRaiseEvent?(this._toRemove.push(i),n[i]=void 0,o[i]=void 0):(n.splice(i,1),o.splice(i,1)),!0):!1};function J0(e,t){return t-e}ti.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let e,t=this._listeners,n=this._scopes,o=t.length;for(e=0;e<o;e++){let r=t[e];f(r)&&t[e].apply(n[e],arguments)}let i=this._toRemove;if(o=i.length,o>0){for(i.sort(J0),e=0;e<o;e++){let r=i[e];t.splice(r,1),n.splice(r,1)}i.length=0}this._insideRaiseEvent=!1};var lr=ti;function to(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}Object.defineProperties(to.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){let t=this._length;if(e<t){let n=this._array;for(let o=e;o<t;++o)n[o]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}});function js(e,t,n){let o=e[t];e[t]=e[n],e[n]=o}to.prototype.reserve=function(e){e=y(e,this._length),this._array.length=e};to.prototype.heapify=function(e){e=y(e,0);let t=this._length,n=this._comparator,o=this._array,i=-1,r=!0;for(;r;){let s=2*(e+1),a=s-1;a<t&&n(o[a],o[e])<0?i=a:i=e,s<t&&n(o[s],o[i])<0&&(i=s),i!==e?(js(o,i,e),e=i):r=!1}};to.prototype.resort=function(){let e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)};to.prototype.insert=function(e){let t=this._array,n=this._comparator,o=this._maximumLength,i=this._length++;for(i<t.length?t[i]=e:t.push(e);i!==0;){let s=Math.floor((i-1)/2);if(n(t[i],t[s])<0)js(t,i,s),i=s;else break}let r;return f(o)&&this._length>o&&(r=t[o],this._length=o),r};to.prototype.pop=function(e){if(e=y(e,0),this._length===0)return;let t=this._array,n=t[e];return js(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};var su=to;function e_(e,t){return e.priority-t.priority}var be={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},Oo=20,Ct=new su({comparator:e_});Ct.maximumLength=Oo;Ct.reserve(Oo);var an=[],An={},t_=typeof document<"u"?new Ze.default(document.location.href):new Ze.default,dr=new lr;function Le(){}Le.maximumRequests=50;Le.maximumRequestsPerServer=6;Le.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18};Le.throttleRequests=!0;Le.debugShowStatistics=!1;Le.requestCompletedEvent=dr;Object.defineProperties(Le,{statistics:{get:function(){return be}},priorityHeapLength:{get:function(){return Oo},set:function(e){if(e<Oo)for(;Ct.length>e;){let t=Ct.pop();no(t)}Oo=e,Ct.maximumLength=e,Ct.reserve(e)}}});function au(e){f(e.priorityFunction)&&(e.priority=e.priorityFunction())}Le.serverHasOpenSlots=function(e,t){t=y(t,1);let n=y(Le.requestsByServer[e],Le.maximumRequestsPerServer);return An[e]+t<=n};Le.heapHasOpenSlots=function(e){return Ct.length+e<=Oo};function cu(e){return e.state===He.UNISSUED&&(e.state=He.ISSUED,e.deferred=$t()),e.deferred.promise}function n_(e){return function(t){if(e.state===He.CANCELLED)return;let n=e.deferred;--be.numberOfActiveRequests,--An[e.serverKey],dr.raiseEvent(),e.state=He.RECEIVED,e.deferred=void 0,n.resolve(t)}}function o_(e){return function(t){e.state!==He.CANCELLED&&(++be.numberOfFailedRequests,--be.numberOfActiveRequests,--An[e.serverKey],dr.raiseEvent(t),e.state=He.FAILED,e.deferred.reject(t))}}function uu(e){let t=cu(e);return e.state=He.ACTIVE,an.push(e),++be.numberOfActiveRequests,++be.numberOfActiveRequestsEver,++An[e.serverKey],e.requestFunction().then(n_(e)).catch(o_(e)),t}function no(e){let t=e.state===He.ACTIVE;if(e.state=He.CANCELLED,++be.numberOfCancelledRequests,f(e.deferred)){let n=e.deferred;e.deferred=void 0,n.reject()}t&&(--be.numberOfActiveRequests,--An[e.serverKey],++be.numberOfCancelledActiveRequests),f(e.cancelFunction)&&e.cancelFunction()}Le.update=function(){let e,t,n=0,o=an.length;for(e=0;e<o;++e){if(t=an[e],t.cancelled&&no(t),t.state!==He.ACTIVE){++n;continue}n>0&&(an[e-n]=t)}an.length-=n;let i=Ct.internalArray,r=Ct.length;for(e=0;e<r;++e)au(i[e]);Ct.resort();let s=Math.max(Le.maximumRequests-an.length,0),a=0;for(;a<s&&Ct.length>0;){if(t=Ct.pop(),t.cancelled){no(t);continue}if(t.throttleByServer&&!Le.serverHasOpenSlots(t.serverKey)){no(t);continue}uu(t),++a}i_()};Le.getServerKey=function(e){let t=new Ze.default(e);t.scheme()===""&&(t=new Ze.default(e).absoluteTo(t_),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${t.scheme()==="https"?"443":"80"}`);let o=An[n];return f(o)||(An[n]=0),n};Le.request=function(e){if(ur(e.url)||ar(e.url))return dr.raiseEvent(),e.state=He.RECEIVED,e.requestFunction();if(++be.numberOfAttemptedRequests,f(e.serverKey)||(e.serverKey=Le.getServerKey(e.url)),Le.throttleRequests&&e.throttleByServer&&!Le.serverHasOpenSlots(e.serverKey))return;if(!Le.throttleRequests||!e.throttle)return uu(e);if(an.length>=Le.maximumRequests)return;au(e);let t=Ct.insert(e);if(f(t)){if(t===e)return;no(t)}return cu(e)};function i_(){!Le.debugShowStatistics||(be.numberOfActiveRequests===0&&be.lastNumberOfActiveRequests>0&&(be.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${be.numberOfAttemptedRequests}`),be.numberOfAttemptedRequests=0),be.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${be.numberOfCancelledRequests}`),be.numberOfCancelledRequests=0),be.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${be.numberOfCancelledActiveRequests}`),be.numberOfCancelledActiveRequests=0),be.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${be.numberOfFailedRequests}`),be.numberOfFailedRequests=0)),be.lastNumberOfActiveRequests=be.numberOfActiveRequests)}Le.clearForSpecs=function(){for(;Ct.length>0;){let t=Ct.pop();no(t)}let e=an.length;for(let t=0;t<e;++t)no(an[t]);an.length=0,An={},be.numberOfAttemptedRequests=0,be.numberOfActiveRequests=0,be.numberOfCancelledRequests=0,be.numberOfCancelledActiveRequests=0,be.numberOfFailedRequests=0,be.numberOfActiveRequestsEver=0,be.lastNumberOfActiveRequests=0};Le.numberOfActiveRequestsByServer=function(e){return An[e]};Le.requestHeap=Ct;var mr=Le;var ni={},Io={};ni.add=function(e,t){let n=`${e.toLowerCase()}:${t}`;f(Io[n])||(Io[n]=!0)};ni.remove=function(e,t){let n=`${e.toLowerCase()}:${t}`;f(Io[n])&&delete Io[n]};function r_(e){let t=new Ze.default(e);t.normalize();let n=t.authority();if(n.length!==0){if(t.authority(n),n.indexOf("@")!==-1&&(n=n.split("@")[1]),n.indexOf(":")===-1){let o=t.scheme();if(o.length===0&&(o=window.location.protocol,o=o.substring(0,o.length-1)),o==="http")n+=":80";else if(o==="https")n+=":443";else return}return n}}ni.contains=function(e){let t=r_(e);return!!(f(t)&&f(Io[t]))};ni.clear=function(){Io={}};var Hs=ni;var du=function(){try{let e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob",e.responseType==="blob"}catch{return!1}}();function s_(e){return typeof e=="string"&&(e.indexOf("earthview")!==-1||e.indexOf("EV_WebService")!==-1)}function Ws(e,t,n,o){let i=e.query(),r;if(s_(e.path())&&(r=oo(Q._evServerQueryParam,r,!1)),!f(i)||i.length===0)return t._queryParameters=oo(t._queryParameters,r,!1);if(i.indexOf("=")===-1){let s={};s[i]=void 0,r=s}else{let s=tu(i);r=oo(s,r,!1)}n?t._queryParameters=oo(r,t._queryParameters,o):t._queryParameters=r,e.search("")}function a_(e,t){let n=t._queryParameters,o=Object.keys(n);o.length===1&&!f(n[o[0]])?e.search(o[0]):e.search(eu(n))}function cn(e,t){return f(e)?f(e.clone)?e.clone():Vt(e):t}function Ys(e){if(e.state===He.ISSUED||e.state===He.ACTIVE)throw new je("The Resource is already being fetched.");e.state=He.UNISSUED,e.deferred=void 0}function oo(e,t,n){if(!n)return Ot(e,t);let o=Vt(e,!0);for(let i in t)if(t.hasOwnProperty(i)){let r=o[i],s=t[i];f(r)?(Array.isArray(r)||(r=o[i]=[r]),o[i]=r.concat(s)):o[i]=Array.isArray(s)?s.slice():s}return o}function Q(e){e=y(e,y.EMPTY_OBJECT),typeof e=="string"&&(e={url:e}),this._url=void 0,this._templateValues=cn(e.templateValues,{}),this._queryParameters=cn(e.queryParameters,{}),this.headers=cn(e.headers,{}),this.request=y(e.request,new ou),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=y(e.retryAttempts,0),this._retryCount=0;let t=new Ze.default(e.url);Ws(t,this,!0,!0),t.fragment(""),this._url=t.toString()}Q.createIfNeeded=function(e){return e instanceof Q?e.getDerivedResource({request:e.request}):typeof e!="string"?e:new Q({url:e})};var Mo;Q.supportsImageBitmapOptions=function(){if(f(Mo))return Mo;if(typeof createImageBitmap!="function")return Mo=Promise.resolve(!1),Mo;let e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC";return Mo=Q.fetchBlob({url:e}).then(function(t){let n={imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"};return Promise.all([createImageBitmap(t,n),createImageBitmap(t)])}).then(function(t){let n=Gs(t[0]),o=Gs(t[1]);return n[1]!==o[1]}).catch(function(){return!1}),Mo};Object.defineProperties(Q,{isBlobSupported:{get:function(){return du}}});Object.defineProperties(Q.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){let t=new Ze.default(e);Ws(t,this,!1),t.fragment(""),this._url=t.toString()}},extension:{get:function(){return Zc(this._url)}},isDataUri:{get:function(){return ur(this._url)}},isBlobUri:{get:function(){return ar(this._url)}},isCrossOriginUrl:{get:function(){return cr(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}});Q.prototype.toString=function(){return this.getUrlComponent(!0,!0)};Q.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=new Ze.default(this._url);e&&a_(n,this);let o=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),i=this._templateValues;return o=o.replace(/{(.*?)}/g,function(r,s){let a=i[s];return f(a)?encodeURIComponent(a):r}),t&&f(this.proxy)&&(o=this.proxy.getURL(o)),o};Q.prototype.setQueryParameters=function(e,t){t?this._queryParameters=oo(this._queryParameters,e,!1):this._queryParameters=oo(e,this._queryParameters,!1)};Q.prototype.appendQueryParameters=function(e){this._queryParameters=oo(e,this._queryParameters,!0)};Q.prototype.setTemplateValues=function(e,t){t?this._templateValues=Ot(this._templateValues,e):this._templateValues=Ot(e,this._templateValues)};Q.prototype.getDerivedResource=function(e){let t=this.clone();if(t._retryCount=0,f(e.url)){let n=new Ze.default(e.url),o=y(e.preserveQueryParameters,!1);Ws(n,t,!0,o),n.fragment(""),n.scheme()!==""?t._url=n.toString():t._url=n.absoluteTo(new Ze.default(sr(this._url))).toString()}return f(e.queryParameters)&&(t._queryParameters=Ot(e.queryParameters,t._queryParameters)),f(e.templateValues)&&(t._templateValues=Ot(e.templateValues,t.templateValues)),f(e.headers)&&(t.headers=Ot(e.headers,t.headers)),f(e.proxy)&&(t.proxy=e.proxy),f(e.request)&&(t.request=e.request),f(e.retryCallback)&&(t.retryCallback=e.retryCallback),f(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t};Q.prototype.retryOnError=function(e){let t=this.retryCallback;if(typeof t!="function"||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let n=this;return Promise.resolve(t(this,e)).then(function(o){return++n._retryCount,o})};Q.prototype.clone=function(e){return f(e)||(e=new Q({url:this._url})),e._url=this._url,e._queryParameters=Vt(this._queryParameters),e._templateValues=Vt(this._templateValues),e.headers=Vt(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e};Q.prototype.getBaseUri=function(e){return Kc(this.getUrlComponent(e),e)};Q.prototype.appendForwardSlash=function(){this._url=$c(this._url)};Q.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})};Q.fetchArrayBuffer=function(e){return new Q(e).fetchArrayBuffer()};Q.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})};Q.fetchBlob=function(e){return new Q(e).fetchBlob()};Q.prototype.fetchImage=function(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.preferImageBitmap,!1),n=y(e.preferBlob,!1),o=y(e.flipY,!1),i=y(e.skipColorSpaceConversion,!1);if(Ys(this.request),!du||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return qs({resource:this,flipY:o,skipColorSpaceConversion:i,preferImageBitmap:t});let r=this.fetchBlob();if(!f(r))return;let s,a,c,u;return Q.supportsImageBitmapOptions().then(function(d){return s=d,a=s&&t,r}).then(function(d){if(!f(d))return;if(u=d,a)return Q.createImageBitmapFromBlob(d,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:i});let m=window.URL.createObjectURL(d);return c=new Q({url:m}),qs({resource:c,flipY:o,skipColorSpaceConversion:i,preferImageBitmap:!1})}).then(function(d){if(!!f(d))return d.blob=u,a||window.URL.revokeObjectURL(c.url),d}).catch(function(d){return f(c)&&window.URL.revokeObjectURL(c.url),d.blob=u,Promise.reject(d)})};function qs(e){let t=e.resource,n=e.flipY,o=e.skipColorSpaceConversion,i=e.preferImageBitmap,r=t.request;r.url=t.url,r.requestFunction=function(){let a=!1;!t.isDataUri&&!t.isBlobUri&&(a=t.isCrossOriginUrl);let c=$t();return Q._Implementations.createImage(r,a,c,n,o,i),c.promise};let s=mr.request(r);if(!!f(s))return s.catch(function(a){return r.state!==He.FAILED?Promise.reject(a):t.retryOnError(a).then(function(c){return c?(r.state=He.UNISSUED,r.deferred=void 0,qs({resource:t,flipY:n,skipColorSpaceConversion:o,preferImageBitmap:i})):Promise.reject(a)})})}Q.fetchImage=function(e){return new Q(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})};Q.prototype.fetchText=function(){return this.fetch({responseType:"text"})};Q.fetchText=function(e){return new Q(e).fetchText()};Q.prototype.fetchJson=function(){let e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(!!f(e))return e.then(function(t){if(!!f(t))return JSON.parse(t)})};Q.fetchJson=function(e){return new Q(e).fetchJson()};Q.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})};Q.fetchXML=function(e){return new Q(e).fetchXML()};Q.prototype.fetchJsonp=function(e){e=y(e,"callback"),Ys(this.request);let t;do t=`loadJsonp${O.nextRandomNumber().toString().substring(2,8)}`;while(f(window[t]));return mu(this,e,t)};function mu(e,t,n){let o={};o[t]=n,e.setQueryParameters(o);let i=e.request;i.url=e.url,i.requestFunction=function(){let s=$t();return window[n]=function(a){s.resolve(a);try{delete window[n]}catch{window[n]=void 0}},Q._Implementations.loadAndExecuteScript(e.url,n,s),s.promise};let r=mr.request(i);if(!!f(r))return r.catch(function(s){return i.state!==He.FAILED?Promise.reject(s):e.retryOnError(s).then(function(a){return a?(i.state=He.UNISSUED,i.deferred=void 0,mu(e,t,n)):Promise.reject(s)})})}Q.fetchJsonp=function(e){return new Q(e).fetchJsonp(e.callbackParameterName)};Q.prototype._makeRequest=function(e){let t=this;Ys(t.request);let n=t.request;n.url=t.url,n.requestFunction=function(){let i=e.responseType,r=Ot(e.headers,t.headers),s=e.overrideMimeType,a=e.method,c=e.data,u=$t(),d=Q._Implementations.loadWithXhr(t.url,i,a,c,r,u,s);return f(d)&&f(d.abort)&&(n.cancelFunction=function(){d.abort()}),u.promise};let o=mr.request(n);if(!!f(o))return o.then(function(i){return n.cancelFunction=void 0,i}).catch(function(i){return n.cancelFunction=void 0,n.state!==He.FAILED?Promise.reject(i):t.retryOnError(i).then(function(r){return r?(n.state=He.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(i)})})};var c_=/^data:(.*?)(;base64)?,(.*)$/;function hr(e,t){let n=decodeURIComponent(t);return e?atob(n):n}function fu(e,t){let n=hr(e,t),o=new ArrayBuffer(n.length),i=new Uint8Array(o);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return o}function u_(e,t){t=y(t,"");let n=e[1],o=!!e[2],i=e[3],r,s;switch(t){case"":case"text":return hr(o,i);case"arraybuffer":return fu(o,i);case"blob":return r=fu(o,i),new Blob([r],{type:n});case"document":return s=new DOMParser,s.parseFromString(hr(o,i),n);case"json":return JSON.parse(hr(o,i));default:}}Q.prototype.fetch=function(e){return e=cn(e,{}),e.method="GET",this._makeRequest(e)};Q.fetch=function(e){return new Q(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q.prototype.delete=function(e){return e=cn(e,{}),e.method="DELETE",this._makeRequest(e)};Q.delete=function(e){return new Q(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})};Q.prototype.head=function(e){return e=cn(e,{}),e.method="HEAD",this._makeRequest(e)};Q.head=function(e){return new Q(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q.prototype.options=function(e){return e=cn(e,{}),e.method="OPTIONS",this._makeRequest(e)};Q.options=function(e){return new Q(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q.prototype.post=function(e,t){return zn.defined("data",e),t=cn(t,{}),t.method="POST",t.data=e,this._makeRequest(t)};Q.post=function(e){return new Q(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q.prototype.put=function(e,t){return zn.defined("data",e),t=cn(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)};Q.put=function(e){return new Q(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q.prototype.patch=function(e,t){return zn.defined("data",e),t=cn(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)};Q.patch=function(e){return new Q(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Q._Implementations={};Q._Implementations.loadImageElement=function(e,t,n){let o=new Image;o.onload=function(){o.naturalWidth===0&&o.naturalHeight===0&&o.width===0&&o.height===0&&(o.width=300,o.height=150),n.resolve(o)},o.onerror=function(i){n.reject(i)},t&&(Hs.contains(e)?o.crossOrigin="use-credentials":o.crossOrigin=""),o.src=e};Q._Implementations.createImage=function(e,t,n,o,i,r){let s=e.url;Q.supportsImageBitmapOptions().then(function(a){if(!(a&&r)){Q._Implementations.loadImageElement(s,t,n);return}let c="blob",u="GET",d=$t(),m=Q._Implementations.loadWithXhr(s,c,u,void 0,void 0,d,void 0,void 0,void 0);return f(m)&&f(m.abort)&&(e.cancelFunction=function(){m.abort()}),d.promise.then(function(p){if(!f(p)){n.reject(new je(`Successfully retrieved ${s} but it contained no content.`));return}return Q.createImageBitmapFromBlob(p,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:i})}).then(function(p){n.resolve(p)})}).catch(function(a){n.reject(a)})};Q.createImageBitmapFromBlob=function(e,t){return zn.defined("options",t),zn.typeOf.bool("options.flipY",t.flipY),zn.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),zn.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};function lu(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function f_(e,t,n,o,i,r,s){let a=require("url").parse(e),c=a.protocol==="https:"?require("https"):require("http"),u=require("zlib"),d={protocol:a.protocol,hostname:a.hostname,port:a.port,path:a.path,query:a.query,method:n,headers:i};c.request(d).on("response",function(m){if(m.statusCode<200||m.statusCode>=300){r.reject(new ei(m.statusCode,m,m.headers));return}let p=[];m.on("data",function(_){p.push(_)}),m.on("end",function(){let _=Buffer.concat(p);m.headers["content-encoding"]==="gzip"?u.gunzip(_,function(g,v){g?r.reject(new je("Error decompressing response.")):r.resolve(lu(v,t))}):r.resolve(lu(_,t))})}).on("error",function(m){r.reject(new ei)}).end()}var l_=typeof XMLHttpRequest>"u";Q._Implementations.loadWithXhr=function(e,t,n,o,i,r,s){let a=c_.exec(e);if(a!==null){r.resolve(u_(a,t));return}if(l_){f_(e,t,n,o,i,r,s);return}let c=new XMLHttpRequest;if(Hs.contains(e)&&(c.withCredentials=!0),c.open(n,e,!0),f(s)&&f(c.overrideMimeType)&&c.overrideMimeType(s),f(i))for(let d in i)i.hasOwnProperty(d)&&c.setRequestHeader(d,i[d]);f(t)&&(c.responseType=t);let u=!1;return typeof e=="string"&&(u=e.indexOf("file://")===0||typeof window<"u"&&window.location.origin==="file://"),c.onload=function(){if((c.status<200||c.status>=300)&&!(u&&c.status===0)){r.reject(new ei(c.status,c.response,c.getAllResponseHeaders()));return}let d=c.response,m=c.responseType;if(n==="HEAD"||n==="OPTIONS"){let _=c.getAllResponseHeaders().trim().split(/[\r\n]+/),g={};_.forEach(function(v){let b=v.split(": "),S=b.shift();g[S]=b.join(": ")}),r.resolve(g);return}if(c.status===204)r.resolve();else if(f(d)&&(!f(t)||m===t))r.resolve(d);else if(t==="json"&&typeof d=="string")try{r.resolve(JSON.parse(d))}catch(p){r.reject(p)}else(m===""||m==="document")&&f(c.responseXML)&&c.responseXML.hasChildNodes()?r.resolve(c.responseXML):(m===""||m==="text")&&f(c.responseText)?r.resolve(c.responseText):r.reject(new je("Invalid XMLHttpRequest response type."))},c.onerror=function(d){r.reject(new ei)},c.send(o),c};Q._Implementations.loadAndExecuteScript=function(e,t,n){return Jc(e,t).catch(function(o){n.reject(o)})};Q._DefaultImplementations={};Q._DefaultImplementations.createImage=Q._Implementations.createImage;Q._DefaultImplementations.loadWithXhr=Q._Implementations.loadWithXhr;Q._DefaultImplementations.loadAndExecuteScript=Q._Implementations.loadAndExecuteScript;Q.DEFAULT=Object.freeze(new Q({url:typeof document>"u"?"":document.location.href.split("?")[0]}));var un=Q;function pr(e){if(e=y(e,y.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=y(e.addNewLeapSeconds,!0),f(e.data))Xs(this,e.data);else if(f(e.url)){let t=un.createIfNeeded(e.url),n=this;this._downloadPromise=t.fetchJson().then(function(o){Xs(n,o)}).catch(function(){n._dataError=`An error occurred while retrieving the EOP data from the URL ${t.url}.`})}else Xs(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}pr.NONE=Object.freeze({getPromiseToLoad:function(){return Promise.resolve()},compute:function(e,t){return f(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Jo(0,0,0,0,0),t}});pr.prototype.getPromiseToLoad=function(){return Promise.resolve(this._downloadPromise)};pr.prototype.compute=function(e,t){if(!f(this._samples)){if(f(this._dataError))throw new je(this._dataError);return}if(f(t)||(t=new Jo(0,0,0,0,0)),this._samples.length===0)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;let n=this._dates,o=this._lastIndex,i=0,r=0;if(f(o)){let a=n[o],c=n[o+1],u=at.lessThanOrEquals(a,e),d=!f(c),m=d||at.greaterThanOrEquals(c,e);if(u&&m)return i=o,!d&&c.equals(e)&&++i,r=i+1,pu(this,n,this._samples,e,i,r,t),t}let s=eo(n,e,at.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,i=s,r=s):(r=~s,i=r-1,i<0&&(i=0)),this._lastIndex=i,pu(this,n,this._samples,e,i,r,t),t};function d_(e,t){return at.compare(e.julianDate,t)}function Xs(e,t){if(!f(t.columnNames)){e._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!f(t.samples)){e._dataError="Error in loaded EOP data: The samples property is required.";return}let n=t.columnNames.indexOf("modifiedJulianDateUtc"),o=t.columnNames.indexOf("xPoleWanderRadians"),i=t.columnNames.indexOf("yPoleWanderRadians"),r=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),a=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),c=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||o<0||i<0||r<0||s<0||a<0||c<0){e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}let u=e._samples=t.samples,d=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=o,e._yPoleWanderRadiansColumn=i,e._ut1MinusUtcSecondsColumn=r,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=a,e._taiMinusUtcSecondsColumn=c,e._columnCount=t.columnNames.length,e._lastIndex=void 0;let m,p=e._addNewLeapSeconds;for(let _=0,g=u.length;_<g;_+=e._columnCount){let v=u[_+n],b=u[_+c],S=v+De.MODIFIED_JULIAN_DATE_DIFFERENCE,A=new at(S,b,pe.TAI);if(d.push(A),p){if(b!==m&&f(m)){let x=at.leapSeconds,P=eo(x,A,d_);if(P<0){let z=new we(A,b);x.splice(~P,0,z)}}m=b}}}function hu(e,t,n,o,i){let r=n*o;i.xPoleWander=t[r+e._xPoleWanderRadiansColumn],i.yPoleWander=t[r+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[r+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[r+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[r+e._ut1MinusUtcSecondsColumn]}function oi(e,t,n){return t+e*(n-t)}function pu(e,t,n,o,i,r,s){let a=e._columnCount;if(r>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;let c=t[i],u=t[r];if(c.equals(u)||o.equals(c))return hu(e,n,i,a,s),s;if(o.equals(u))return hu(e,n,r,a,s),s;let d=at.secondsDifference(o,c)/at.secondsDifference(u,c),m=i*a,p=r*a,_=n[m+e._ut1MinusUtcSecondsColumn],g=n[p+e._ut1MinusUtcSecondsColumn],v=g-_;if(v>.5||v<-.5){let b=n[m+e._taiMinusUtcSecondsColumn],S=n[p+e._taiMinusUtcSecondsColumn];b!==S&&(u.equals(o)?_=g:g-=S-b)}return s.xPoleWander=oi(d,n[m+e._xPoleWanderRadiansColumn],n[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=oi(d,n[m+e._yPoleWanderRadiansColumn],n[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=oi(d,n[m+e._xCelestialPoleOffsetRadiansColumn],n[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=oi(d,n[m+e._yCelestialPoleOffsetRadiansColumn],n[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=oi(d,_,g),s}var _u=pr;function vt(e,t,n){this.heading=y(e,0),this.pitch=y(t,0),this.roll=y(n,0)}vt.fromQuaternion=function(e,t){f(t)||(t=new vt);let n=2*(e.w*e.y-e.z*e.x),o=1-2*(e.x*e.x+e.y*e.y),i=2*(e.w*e.x+e.y*e.z),r=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,r),t.roll=Math.atan2(i,o),t.pitch=-O.asinClamped(n),t};vt.fromDegrees=function(e,t,n,o){return f(o)||(o=new vt),o.heading=e*O.RADIANS_PER_DEGREE,o.pitch=t*O.RADIANS_PER_DEGREE,o.roll=n*O.RADIANS_PER_DEGREE,o};vt.clone=function(e,t){if(!!f(e))return f(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new vt(e.heading,e.pitch,e.roll)};vt.equals=function(e,t){return e===t||f(e)&&f(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll};vt.equalsEpsilon=function(e,t,n,o){return e===t||f(e)&&f(t)&&O.equalsEpsilon(e.heading,t.heading,n,o)&&O.equalsEpsilon(e.pitch,t.pitch,n,o)&&O.equalsEpsilon(e.roll,t.roll,n,o)};vt.prototype.clone=function(e){return vt.clone(this,e)};vt.prototype.equals=function(e){return vt.equals(this,e)};vt.prototype.equalsEpsilon=function(e,t,n){return vt.equalsEpsilon(this,e,t,n)};vt.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var $s=vt;var yu=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;function m_(){let e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){let o=e[t].getAttribute("src"),i=yu.exec(o);if(i!==null)return i[1]}}var zo;function gu(e){return typeof document>"u"?e:(f(zo)||(zo=document.createElement("a")),zo.href=e,zo.href=zo.href,zo.href)}var io;function Cu(){if(f(io))return io;let e;return typeof CESIUM_BASE_URL<"u"?e=CESIUM_BASE_URL:typeof define=="object"&&f(define.amd)&&!define.amd.toUrlUndefined&&f(require.toUrl)?e=sr("..",ro("Core/buildModuleUrl.js")):e=m_(),io=new un({url:gu(e)}),io.appendForwardSlash(),io}function h_(e){return gu(require.toUrl(`../${e}`))}function vu(e){return Cu().getDerivedResource({url:e}).url}var _r;function ro(e){return f(_r)||(typeof define=="object"&&f(define.amd)&&!define.amd.toUrlUndefined&&f(require.toUrl)?_r=h_:_r=vu),_r(e)}ro._cesiumScriptRegex=yu;ro._buildModuleUrlFromBaseUrl=vu;ro._clearBaseResource=function(){io=void 0};ro.setBaseUrl=function(e){io=un.DEFAULT.getDerivedResource({url:e})};ro.getCesiumBaseUrl=Cu;var xn=ro;function p_(e,t,n){this.x=e,this.y=t,this.s=n}var yr=p_;function Qs(e){e=y(e,y.EMPTY_OBJECT),this._xysFileUrlTemplate=un.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=y(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=y(e.sampleZeroJulianEphemerisDate,24423965e-1),this._sampleZeroDateTT=new at(this._sampleZeroJulianEphemerisDate,0,pe.TAI),this._stepSizeDays=y(e.stepSizeDays,1),this._samplesPerXysFile=y(e.samplesPerXysFile,1e3),this._totalSamples=y(e.totalSamples,27426),this._samples=new Array(this._totalSamples*3),this._chunkDownloadsInProgress=[];let t=this._interpolationOrder,n=this._denominators=new Array(t+1),o=this._xTable=new Array(t+1),i=Math.pow(this._stepSizeDays,t);for(let r=0;r<=t;++r){n[r]=i,o[r]=r*this._stepSizeDays;for(let s=0;s<=t;++s)s!==r&&(n[r]*=r-s);n[r]=1/n[r]}this._work=new Array(t+1),this._coef=new Array(t+1)}var __=new at(0,0,pe.TAI);function Ks(e,t,n){let o=__;return o.dayNumber=t,o.secondsOfDay=n,at.daysDifference(o,e._sampleZeroDateTT)}Qs.prototype.preload=function(e,t,n,o){let i=Ks(this,e,t),r=Ks(this,n,o),s=i/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let a=r/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;a>=this._totalSamples&&(a=this._totalSamples-1);let c=s/this._samplesPerXysFile|0,u=a/this._samplesPerXysFile|0,d=[];for(let m=c;m<=u;++m)d.push(Zs(this,m));return Promise.all(d)};Qs.prototype.computeXysRadians=function(e,t,n){let o=Ks(this,e,t);if(o<0)return;let i=o/this._stepSizeDays|0;if(i>=this._totalSamples)return;let r=this._interpolationOrder,s=i-(r/2|0);s<0&&(s=0);let a=s+r;a>=this._totalSamples&&(a=this._totalSamples-1,s=a-r,s<0&&(s=0));let c=!1,u=this._samples;if(f(u[s*3])||(Zs(this,s/this._samplesPerXysFile|0),c=!0),f(u[a*3])||(Zs(this,a/this._samplesPerXysFile|0),c=!0),c)return;f(n)?(n.x=0,n.y=0,n.s=0):n=new yr(0,0,0);let d=o-s*this._stepSizeDays,m=this._work,p=this._denominators,_=this._coef,g=this._xTable,v,b;for(v=0;v<=r;++v)m[v]=d-g[v];for(v=0;v<=r;++v){for(_[v]=1,b=0;b<=r;++b)b!==v&&(_[v]*=m[b]);_[v]*=p[v];let S=(s+v)*3;n.x+=_[v]*u[S++],n.y+=_[v]*u[S++],n.s+=_[v]*u[S]}return n};function Zs(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n,o=e._xysFileUrlTemplate;f(o)?n=o.getDerivedResource({templateValues:{0:t}}):n=new un({url:xn(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});let i=n.fetchJson().then(function(r){e._chunkDownloadsInProgress[t]=!1;let s=e._samples,a=r.samples,c=t*e._samplesPerXysFile*3;for(let u=0,d=a.length;u<d;++u)s[c+u]=a[u]});return e._chunkDownloadsInProgress[t]=i,i}var Eu=Qs;var Ee={},Js={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Do={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},ea={},zt={east:new l,north:new l,up:new l,west:new l,south:new l,down:new l},Fn=new l,Bn=new l,Un=new l;Ee.localFrameToFixedFrameGenerator=function(e,t){if(!Js.hasOwnProperty(e)||!Js[e].hasOwnProperty(t))throw new ot("firstAxis and secondAxis must be east, north, up, west, south or down.");let n=Js[e][t],o,i=e+t;return f(ea[i])?o=ea[i]:(o=function(r,s,a){if(f(a)||(a=new X),l.equalsEpsilon(r,l.ZERO,O.EPSILON14))l.unpack(Do[e],0,Fn),l.unpack(Do[t],0,Bn),l.unpack(Do[n],0,Un);else if(O.equalsEpsilon(r.x,0,O.EPSILON14)&&O.equalsEpsilon(r.y,0,O.EPSILON14)){let c=O.sign(r.z);l.unpack(Do[e],0,Fn),e!=="east"&&e!=="west"&&l.multiplyByScalar(Fn,c,Fn),l.unpack(Do[t],0,Bn),t!=="east"&&t!=="west"&&l.multiplyByScalar(Bn,c,Bn),l.unpack(Do[n],0,Un),n!=="east"&&n!=="west"&&l.multiplyByScalar(Un,c,Un)}else{s=y(s,xt.WGS84),s.geodeticSurfaceNormal(r,zt.up);let c=zt.up,u=zt.east;u.x=-r.y,u.y=r.x,u.z=0,l.normalize(u,zt.east),l.cross(c,u,zt.north),l.multiplyByScalar(zt.up,-1,zt.down),l.multiplyByScalar(zt.east,-1,zt.west),l.multiplyByScalar(zt.north,-1,zt.south),Fn=zt[e],Bn=zt[t],Un=zt[n]}return a[0]=Fn.x,a[1]=Fn.y,a[2]=Fn.z,a[3]=0,a[4]=Bn.x,a[5]=Bn.y,a[6]=Bn.z,a[7]=0,a[8]=Un.x,a[9]=Un.y,a[10]=Un.z,a[11]=0,a[12]=r.x,a[13]=r.y,a[14]=r.z,a[15]=1,a},ea[i]=o),o};Ee.eastNorthUpToFixedFrame=Ee.localFrameToFixedFrameGenerator("east","north");Ee.northEastDownToFixedFrame=Ee.localFrameToFixedFrameGenerator("north","east");Ee.northUpEastToFixedFrame=Ee.localFrameToFixedFrameGenerator("north","up");Ee.northWestUpToFixedFrame=Ee.localFrameToFixedFrameGenerator("north","west");var y_=new rn,g_=new l(1,1,1),C_=new X;Ee.headingPitchRollToFixedFrame=function(e,t,n,o,i){o=y(o,Ee.eastNorthUpToFixedFrame);let r=rn.fromHeadingPitchRoll(t,y_),s=X.fromTranslationQuaternionRotationScale(l.ZERO,r,g_,C_);return i=o(e,n,i),X.multiply(i,s,i)};var v_=new X,E_=new Z;Ee.headingPitchRollQuaternion=function(e,t,n,o,i){let r=Ee.headingPitchRollToFixedFrame(e,t,n,o,v_),s=X.getMatrix3(r,E_);return rn.fromRotationMatrix(s,i)};var T_=new l(1,1,1),b_=new l,Tu=new X,A_=new X,x_=new Z,w_=new rn;Ee.fixedFrameToHeadingPitchRoll=function(e,t,n,o){t=y(t,xt.WGS84),n=y(n,Ee.eastNorthUpToFixedFrame),f(o)||(o=new $s);let i=X.getTranslation(e,b_);if(l.equals(i,l.ZERO))return o.heading=0,o.pitch=0,o.roll=0,o;let r=X.inverseTransformation(n(i,t,Tu),Tu),s=X.setScale(e,T_,A_);s=X.setTranslation(s,l.ZERO,s),r=X.multiply(r,s,r);let a=rn.fromRotationMatrix(X.getMatrix3(r,x_),w_);return a=rn.normalize(a,a),$s.fromQuaternion(a,o)};var S_=6*3600+41*60+50.54841,R_=8640184812866e-6,P_=.093104,O_=-62e-7,I_=11772758384668e-32,M_=72921158553e-15,z_=O.TWO_PI/86400,gr=new at;Ee.computeTemeToPseudoFixedMatrix=function(e,t){gr=at.addSeconds(e,-at.computeTaiMinusUtc(e),gr);let n=gr.dayNumber,o=gr.secondsOfDay,i,r=n-2451545;o>=43200?i=(r+.5)/De.DAYS_PER_JULIAN_CENTURY:i=(r-.5)/De.DAYS_PER_JULIAN_CENTURY;let a=(S_+i*(R_+i*(P_+i*O_)))*z_%O.TWO_PI,c=M_+I_*(n-24515455e-1),u=(o+De.SECONDS_PER_DAY*.5)%De.SECONDS_PER_DAY,d=a+c*u,m=Math.cos(d),p=Math.sin(d);return f(t)?(t[0]=m,t[1]=-p,t[2]=0,t[3]=p,t[4]=m,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Z(m,p,0,-p,m,0,0,0,1)};Ee.iau2006XysData=new Eu;Ee.earthOrientationParameters=_u.NONE;var oa=32.184,D_=2451545;Ee.preloadIcrfFixed=function(e){let t=e.start.dayNumber,n=e.start.secondsOfDay+oa,o=e.stop.dayNumber,i=e.stop.secondsOfDay+oa,r=Ee.iau2006XysData.preload(t,n,o,i),s=Ee.earthOrientationParameters.getPromiseToLoad();return Promise.all([r,s])};Ee.computeIcrfToFixedMatrix=function(e,t){f(t)||(t=new Z);let n=Ee.computeFixedToIcrfMatrix(e,t);if(!!f(n))return Z.transpose(n,t)};var N_=new yr(0,0,0),L_=new Jo(0,0,0,0,0,0),ta=new Z,na=new Z;Ee.computeFixedToIcrfMatrix=function(e,t){f(t)||(t=new Z);let n=Ee.earthOrientationParameters.compute(e,L_);if(!f(n))return;let o=e.dayNumber,i=e.secondsOfDay+oa,r=Ee.iau2006XysData.computeXysRadians(o,i,N_);if(!f(r))return;let s=r.x+n.xPoleOffset,a=r.y+n.yPoleOffset,c=1/(1+Math.sqrt(1-s*s-a*a)),u=ta;u[0]=1-c*s*s,u[3]=-c*s*a,u[6]=s,u[1]=-c*s*a,u[4]=1-c*a*a,u[7]=a,u[2]=-s,u[5]=-a,u[8]=1-c*(s*s+a*a);let d=Z.fromRotationZ(-r.s,na),m=Z.multiply(u,d,ta),p=e.dayNumber,_=e.secondsOfDay-at.computeTaiMinusUtc(e)+n.ut1MinusUtc,g=p-2451545,v=_/De.SECONDS_PER_DAY,b=.779057273264+v+.00273781191135448*(g+v);b=b%1*O.TWO_PI;let S=Z.fromRotationZ(b,na),A=Z.multiply(m,S,ta),x=Math.cos(n.xPoleWander),P=Math.cos(n.yPoleWander),z=Math.sin(n.xPoleWander),L=Math.sin(n.yPoleWander),B=o-D_+i/De.SECONDS_PER_DAY;B/=36525;let F=-47e-6*B*O.RADIANS_PER_DEGREE/3600,N=Math.cos(F),I=Math.sin(F),U=na;return U[0]=x*N,U[1]=x*I,U[2]=z,U[3]=-P*I+L*z*N,U[4]=P*N+L*z*I,U[5]=-L*x,U[6]=-L*I-P*z*N,U[7]=L*N-P*z*I,U[8]=P*x,Z.multiply(A,U,t)};var F_=new se;Ee.pointToWindowCoordinates=function(e,t,n,o){return o=Ee.pointToGLWindowCoordinates(e,t,n,o),o.y=2*t[5]-o.y,o};Ee.pointToGLWindowCoordinates=function(e,t,n,o){f(o)||(o=new ne);let i=F_;return X.multiplyByVector(e,se.fromElements(n.x,n.y,n.z,1,i),i),se.multiplyByScalar(i,1/i.w,i),X.multiplyByVector(t,i,i),ne.fromCartesian4(i,o)};var B_=new l,U_=new l,V_=new l;Ee.rotationMatrixFromPositionVelocity=function(e,t,n,o){let i=y(n,xt.WGS84).geodeticSurfaceNormal(e,B_),r=l.cross(t,i,U_);l.equalsEpsilon(r,l.ZERO,O.EPSILON6)&&(r=l.clone(l.UNIT_X,r));let s=l.cross(r,t,V_);return l.normalize(s,s),l.cross(t,s,r),l.negate(r,r),l.normalize(r,r),f(o)||(o=new Z),o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=r.x,o[4]=r.y,o[5]=r.z,o[6]=s.x,o[7]=s.y,o[8]=s.z,o};var bu=new X(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),Au=new ve,xu=new l,k_=new l,G_=new Z,ia=new X,wu=new X;Ee.basisTo2D=function(e,t,n){let o=X.getTranslation(t,k_),i=e.ellipsoid,r=i.cartesianToCartographic(o,Au),s=e.project(r,xu);l.fromElements(s.z,s.x,s.y,s);let a=Ee.eastNorthUpToFixedFrame(o,i,ia),c=X.inverseTransformation(a,wu),u=X.getMatrix3(t,G_),d=X.multiplyByMatrix3(c,u,n);return X.multiply(bu,d,n),X.setTranslation(n,s,n),n};Ee.wgs84To2DModelMatrix=function(e,t,n){let o=e.ellipsoid,i=Ee.eastNorthUpToFixedFrame(t,o,ia),r=X.inverseTransformation(i,wu),s=o.cartesianToCartographic(t,Au),a=e.project(s,xu);l.fromElements(a.z,a.x,a.y,a);let c=X.fromTranslation(a,ia);return X.multiply(bu,r,n),X.multiply(c,n,n),n};var Su=Ee;function ra(e){e=y(e,y.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=y(e.primitiveType,Oe.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=y(e.geometryType,Jn.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}ra.computeNumberOfVertices=function(e){let t=-1;for(let n in e.attributes)if(e.attributes.hasOwnProperty(n)&&f(e.attributes[n])&&f(e.attributes[n].values)){let o=e.attributes[n];t=o.values.length/o.componentsPerAttribute}return t};var j_=new ve,H_=new l,Ru=new X,q_=[new ve,new ve,new ve],W_=[new ne,new ne,new ne],Y_=[new ne,new ne,new ne],X_=new l,$_=new rn,K_=new X,Z_=new Mt;ra._textureCoordinateRotationPoints=function(e,t,n,o){let i,r=vn.center(o,j_),s=ve.toCartesian(r,n,H_),a=Su.eastNorthUpToFixedFrame(s,n,Ru),c=X.inverse(a,Ru),u=W_,d=q_;d[0].longitude=o.west,d[0].latitude=o.south,d[1].longitude=o.west,d[1].latitude=o.north,d[2].longitude=o.east,d[2].latitude=o.south;let m=X_;for(i=0;i<3;i++)ve.toCartesian(d[i],n,m),m=X.multiplyByPointAsVector(c,m,m),u[i].x=m.x,u[i].y=m.y;let p=rn.fromAxisAngle(l.UNIT_Z,-t,$_),_=Z.fromQuaternion(p,K_),g=e.length,v=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(i=0;i<g;i++)m=X.multiplyByPointAsVector(c,e[i],m),m=Z.multiplyByVector(_,m,m),v=Math.min(v,m.x),b=Math.min(b,m.y),S=Math.max(S,m.x),A=Math.max(A,m.y);let x=Mt.fromRotation(t,Z_),P=Y_;P[0].x=v,P[0].y=b,P[1].x=v,P[1].y=A,P[2].x=S,P[2].y=b;let z=u[0],L=u[2].x-z.x,B=u[1].y-z.y;for(i=0;i<3;i++){let h=P[i];Mt.multiplyByVector(x,h,h),h.x=(h.x-z.x)/L,h.y=(h.y-z.y)/B}let F=P[0],N=P[1],I=P[2],U=new Array(6);return ne.pack(F,U),ne.pack(N,U,2),ne.pack(I,U,4),U};var Fe=ra;function Q_(e){e=y(e,y.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=y(e.normalize,!1),this.values=e.values}var Ue=Q_;function J_(e){e=y(e,y.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}var No=J_;var ey={NONE:0,TOP:1,ALL:2},ii=Object.freeze(ey);function it(e,t){this.normal=l.clone(e),this.distance=t}it.fromPointNormal=function(e,t,n){let o=-l.dot(t,e);return f(n)?(l.clone(t,n.normal),n.distance=o,n):new it(t,o)};var ty=new l;it.fromCartesian4=function(e,t){let n=l.fromCartesian4(e,ty),o=e.w;return f(t)?(l.clone(n,t.normal),t.distance=o,t):new it(n,o)};it.getPointDistance=function(e,t){return l.dot(e.normal,t)+e.distance};var ny=new l;it.projectPointOntoPlane=function(e,t,n){f(n)||(n=new l);let o=it.getPointDistance(e,t),i=l.multiplyByScalar(e.normal,o,ny);return l.subtract(t,i,n)};var oy=new X,iy=new se,ry=new l;it.transform=function(e,t,n){let o=e.normal,i=e.distance,r=X.inverseTranspose(t,oy),s=se.fromElements(o.x,o.y,o.z,i,iy);s=X.multiplyByVector(r,s,s);let a=l.fromCartesian4(s,ry);return s=se.divideByScalar(s,l.magnitude(a),s),it.fromCartesian4(s,n)};it.clone=function(e,t){return f(t)?(l.clone(e.normal,t.normal),t.distance=e.distance,t):new it(e.normal,e.distance)};it.equals=function(e,t){return e.distance===t.distance&&l.equals(e.normal,t.normal)};it.ORIGIN_XY_PLANE=Object.freeze(new it(l.UNIT_Z,0));it.ORIGIN_YZ_PLANE=Object.freeze(new it(l.UNIT_X,0));it.ORIGIN_ZX_PLANE=Object.freeze(new it(l.UNIT_Y,0));var ri=it;function sy(e,t){let n=[],o=e.length,i=0;for(;i<o;){let r=Math.ceil((o-i)/t--);n.push(e.slice(i,i+r)),i+=r}return n}var Pu=sy;function Ou(){if(!f(ht._canTransferArrayBuffer)){let e=new Worker(Mu("Workers/transferTypedArrayTest.js"));e.postMessage=y(e.webkitPostMessage,e.postMessage);let t=99,n=new Int8Array([t]);try{e.postMessage({array:n},[n.buffer])}catch{return ht._canTransferArrayBuffer=!1,ht._canTransferArrayBuffer}let o=$t();e.onmessage=function(i){let r=i.data.array,s=f(r)&&r[0]===t;o.resolve(s),e.terminate(),ht._canTransferArrayBuffer=s},ht._canTransferArrayBuffer=o.promise}return ht._canTransferArrayBuffer}var aa=new lr;function Iu(e,t){--e._activeTasks;let n=t.id;if(!f(n))return;let o=e._deferreds,i=o[n];if(f(t.error)){let r=t.error;r.name==="RuntimeError"?(r=new je(t.error.message),r.stack=t.error.stack):r.name==="DeveloperError"&&(r=new ot(t.error.message),r.stack=t.error.stack),aa.raiseEvent(r),i.reject(r)}else aa.raiseEvent(),i.resolve(t.result);delete o[n]}function Mu(e){let t=xn(e);if(cr(t)){let n=`importScripts("${t}");`,o;try{o=new Blob([n],{type:"application/javascript"})}catch{let s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,a=new s;a.append(n),o=a.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(o)}return t}var sa;function ay(){return f(sa)||(sa=Mu("Workers/cesiumWorkerBootstrapper.js")),sa}function zu(e){let t=new Worker(ay());t.postMessage=y(t.webkitPostMessage,t.postMessage);let n={loaderConfig:{paths:{Workers:xn("Workers")},baseUrl:xn.getCesiumBaseUrl().url},workerModule:e._workerPath};return t.postMessage(n),t.onmessage=function(o){Iu(e,o.data)},t}function cy(e,t){let n={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Wt.supportsWebAssembly()){if(!f(t.fallbackModulePath))throw new je(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return n.modulePath=xn(t.fallbackModulePath),Promise.resolve(n)}return n.modulePath=xn(t.modulePath),n.wasmBinaryFile=xn(t.wasmBinaryFile),un.fetchArrayBuffer({url:n.wasmBinaryFile}).then(function(o){return n.wasmBinary=o,n})}function ht(e,t){let n=new Ze.default(e);this._workerPath=n.scheme().length!==0&&n.fragment().length===0?e:ht._workerModulePrefix+e,this._maximumActiveTasks=y(t,Number.POSITIVE_INFINITY),this._activeTasks=0,this._deferreds={},this._nextID=0}var uy=[];ht.prototype.scheduleTask=function(e,t){if(f(this._worker)||(this._worker=zu(this)),this._activeTasks>=this._maximumActiveTasks)return;++this._activeTasks;let n=this;return Promise.resolve(Ou()).then(function(o){f(t)?o||(t.length=0):t=uy;let i=n._nextID++,r=$t();return n._deferreds[i]=r,n._worker.postMessage({id:i,parameters:e,canTransferArrayBuffer:o},t),r.promise})};ht.prototype.initWebAssemblyModule=function(e){f(this._worker)||(this._worker=zu(this));let t=$t(),n=this,o=this._worker;return cy(this,e).then(function(i){return Promise.resolve(Ou()).then(function(r){let s,a=i.wasmBinary;f(a)&&r&&(s=[a]),o.onmessage=function(c){o.onmessage=function(u){Iu(n,u.data)},t.resolve(c.data)},o.postMessage({webAssemblyConfig:i},s)})}),t.promise};ht.prototype.isDestroyed=function(){return!1};ht.prototype.destroy=function(){return f(this._worker)&&this._worker.terminate(),It(this)};ht.taskCompletedEvent=aa;ht._defaultWorkerModulePrefix="Workers/";ht._workerModulePrefix=ht._defaultWorkerModulePrefix;ht._canTransferArrayBuffer=void 0;var ca=ht;var Cr={STREAM_DRAW:w.STREAM_DRAW,STATIC_DRAW:w.STATIC_DRAW,DYNAMIC_DRAW:w.DYNAMIC_DRAW,validate:function(e){return e===Cr.STREAM_DRAW||e===Cr.STATIC_DRAW||e===Cr.DYNAMIC_DRAW}},vr=Object.freeze(Cr);var qe={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function si(e){e=y(e,y.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._modelMatrix=e.modelMatrix,this._primitiveType=y(e.primitiveType,Oe.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=y(e.offset,0),this._instanceCount=y(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._owner=e.owner,this._debugOverlappingFrustums=0,this._pickId=e.pickId,this._flags=0,this.cull=y(e.cull,!0),this.occlude=y(e.occlude,!0),this.executeInClosestFrustum=y(e.executeInClosestFrustum,!1),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.castShadows=y(e.castShadows,!1),this.receiveShadows=y(e.receiveShadows,!1),this.pickOnly=y(e.pickOnly,!1),this.depthForTranslucentClassification=y(e.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function Et(e,t){return(e._flags&t)===t}function Vn(e,t,n){n?e._flags|=t:e._flags&=~t}Object.defineProperties(si.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return Et(this,qe.CULL)},set:function(e){Et(this,qe.CULL)!==e&&(Vn(this,qe.CULL,e),this.dirty=!0)}},occlude:{get:function(){return Et(this,qe.OCCLUDE)},set:function(e){Et(this,qe.OCCLUDE)!==e&&(Vn(this,qe.OCCLUDE,e),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return Et(this,qe.CAST_SHADOWS)},set:function(e){Et(this,qe.CAST_SHADOWS)!==e&&(Vn(this,qe.CAST_SHADOWS,e),this.dirty=!0)}},receiveShadows:{get:function(){return Et(this,qe.RECEIVE_SHADOWS)},set:function(e){Et(this,qe.RECEIVE_SHADOWS)!==e&&(Vn(this,qe.RECEIVE_SHADOWS,e),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return Et(this,qe.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(e){Et(this,qe.EXECUTE_IN_CLOSEST_FRUSTUM)!==e&&(Vn(this,qe.EXECUTE_IN_CLOSEST_FRUSTUM,e),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return Et(this,qe.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(e){Et(this,qe.DEBUG_SHOW_BOUNDING_VOLUME)!==e&&(Vn(this,qe.DEBUG_SHOW_BOUNDING_VOLUME,e),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickOnly:{get:function(){return Et(this,qe.PICK_ONLY)},set:function(e){Et(this,qe.PICK_ONLY)!==e&&(Vn(this,qe.PICK_ONLY,e),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return Et(this,qe.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(e){Et(this,qe.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==e&&(Vn(this,qe.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,e),this.dirty=!0)}}});si.shallowClone=function(e,t){if(!!f(e))return f(t)||(t=new si),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._owner=e._owner,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._pickId=e._pickId,t._flags=e._flags,t.dirty=!0,t.lastDirtyTime=0,t};si.prototype.execute=function(e,t){e.draw(this,t)};var ai=si;var fy={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,NUMBER_OF_PASSES:10},ua=Object.freeze(fy);function $e(e,t,n,o){this.x=y(e,0),this.y=y(t,0),this.width=y(n,0),this.height=y(o,0)}$e.packedLength=4;$e.pack=function(e,t,n){return n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.width,t[n]=e.height,t};$e.unpack=function(e,t,n){return t=y(t,0),f(n)||(n=new $e),n.x=e[t++],n.y=e[t++],n.width=e[t++],n.height=e[t],n};$e.fromPoints=function(e,t){if(f(t)||(t=new $e),!f(e)||e.length===0)return t.x=0,t.y=0,t.width=0,t.height=0,t;let n=e.length,o=e[0].x,i=e[0].y,r=e[0].x,s=e[0].y;for(let a=1;a<n;a++){let c=e[a],u=c.x,d=c.y;o=Math.min(u,o),r=Math.max(u,r),i=Math.min(d,i),s=Math.max(d,s)}return t.x=o,t.y=i,t.width=r-o,t.height=s-i,t};var ly=new nn,dy=new ve,my=new ve;$e.fromRectangle=function(e,t,n){if(f(n)||(n=new $e),!f(e))return n.x=0,n.y=0,n.width=0,n.height=0,n;t=y(t,ly);let o=t.project(vn.southwest(e,dy)),i=t.project(vn.northeast(e,my));return ne.subtract(i,o,i),n.x=o.x,n.y=o.y,n.width=i.x,n.height=i.y,n};$e.clone=function(e,t){if(!!f(e))return f(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new $e(e.x,e.y,e.width,e.height)};$e.union=function(e,t,n){f(n)||(n=new $e);let o=Math.min(e.x,t.x),i=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=o,n.y=i,n.width=r-o,n.height=s-i,n};$e.expand=function(e,t,n){n=$e.clone(e,n);let o=t.x-n.x,i=t.y-n.y;return o>n.width?n.width=o:o<0&&(n.width-=o,n.x=t.x),i>n.height?n.height=i:i<0&&(n.height-=i,n.y=t.y),n};$e.intersect=function(e,t){let n=e.x,o=e.y,i=t.x,r=t.y;return n>i+t.width||n+e.width<i||o+e.height<r||o>r+t.height?Yt.OUTSIDE:Yt.INTERSECTING};$e.equals=function(e,t){return e===t||f(e)&&f(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};$e.prototype.clone=function(e){return $e.clone(this,e)};$e.prototype.intersect=function(e){return $e.intersect(this,e)};$e.prototype.equals=function(e){return $e.equals(this,e)};var Lo=$e;var Er={CLOCKWISE:w.CW,COUNTER_CLOCKWISE:w.CCW};Er.validate=function(e){return e===Er.CLOCKWISE||e===Er.COUNTER_CLOCKWISE};var Du=Object.freeze(Er);function ln(e){let t=y(e,y.EMPTY_OBJECT),n=y(t.cull,y.EMPTY_OBJECT),o=y(t.polygonOffset,y.EMPTY_OBJECT),i=y(t.scissorTest,y.EMPTY_OBJECT),r=y(i.rectangle,y.EMPTY_OBJECT),s=y(t.depthRange,y.EMPTY_OBJECT),a=y(t.depthTest,y.EMPTY_OBJECT),c=y(t.colorMask,y.EMPTY_OBJECT),u=y(t.blending,y.EMPTY_OBJECT),d=y(u.color,y.EMPTY_OBJECT),m=y(t.stencilTest,y.EMPTY_OBJECT),p=y(m.frontOperation,y.EMPTY_OBJECT),_=y(m.backOperation,y.EMPTY_OBJECT),g=y(t.sampleCoverage,y.EMPTY_OBJECT),v=t.viewport;this.frontFace=y(t.frontFace,Du.COUNTER_CLOCKWISE),this.cull={enabled:y(n.enabled,!1),face:y(n.face,w.BACK)},this.lineWidth=y(t.lineWidth,1),this.polygonOffset={enabled:y(o.enabled,!1),factor:y(o.factor,0),units:y(o.units,0)},this.scissorTest={enabled:y(i.enabled,!1),rectangle:Lo.clone(r)},this.depthRange={near:y(s.near,0),far:y(s.far,1)},this.depthTest={enabled:y(a.enabled,!1),func:y(a.func,w.LESS)},this.colorMask={red:y(c.red,!0),green:y(c.green,!0),blue:y(c.blue,!0),alpha:y(c.alpha,!0)},this.depthMask=y(t.depthMask,!0),this.stencilMask=y(t.stencilMask,-1),this.blending={enabled:y(u.enabled,!1),color:new Be(y(d.red,0),y(d.green,0),y(d.blue,0),y(d.alpha,0)),equationRgb:y(u.equationRgb,w.FUNC_ADD),equationAlpha:y(u.equationAlpha,w.FUNC_ADD),functionSourceRgb:y(u.functionSourceRgb,w.ONE),functionSourceAlpha:y(u.functionSourceAlpha,w.ONE),functionDestinationRgb:y(u.functionDestinationRgb,w.ZERO),functionDestinationAlpha:y(u.functionDestinationAlpha,w.ZERO)},this.stencilTest={enabled:y(m.enabled,!1),frontFunction:y(m.frontFunction,w.ALWAYS),backFunction:y(m.backFunction,w.ALWAYS),reference:y(m.reference,0),mask:y(m.mask,-1),frontOperation:{fail:y(p.fail,w.KEEP),zFail:y(p.zFail,w.KEEP),zPass:y(p.zPass,w.KEEP)},backOperation:{fail:y(_.fail,w.KEEP),zFail:y(_.zFail,w.KEEP),zPass:y(_.zPass,w.KEEP)}},this.sampleCoverage={enabled:y(g.enabled,!1),value:y(g.value,1),invert:y(g.invert,!1)},this.viewport=f(v)?new Lo(v.x,v.y,v.width,v.height):void 0,this.id=0,this._applyFunctions=[]}var hy=0,fn={};ln.fromCache=function(e){let t=JSON.stringify(e),n=fn[t];if(f(n))return++n.referenceCount,n.state;let o=new ln(e),i=JSON.stringify(o);return n=fn[i],f(n)||(o.id=hy++,n={referenceCount:0,state:o},fn[i]=n),++n.referenceCount,fn[t]={referenceCount:1,state:n.state},n.state};ln.removeFromCache=function(e){let t=new ln(e),n=JSON.stringify(t),o=fn[n],i=JSON.stringify(e),r=fn[i];f(r)&&(--r.referenceCount,r.referenceCount===0&&(delete fn[i],f(o)&&--o.referenceCount)),f(o)&&o.referenceCount===0&&delete fn[n]};ln.getCache=function(){return fn};ln.clearCache=function(){fn={}};function so(e,t,n){n?e.enable(t):e.disable(t)}function Nu(e,t){e.frontFace(t.frontFace)}function Lu(e,t){let n=t.cull,o=n.enabled;so(e,e.CULL_FACE,o),o&&e.cullFace(n.face)}function Fu(e,t){e.lineWidth(t.lineWidth)}function Bu(e,t){let n=t.polygonOffset,o=n.enabled;so(e,e.POLYGON_OFFSET_FILL,o),o&&e.polygonOffset(n.factor,n.units)}function Uu(e,t,n){let o=t.scissorTest,i=f(n.scissorTest)?n.scissorTest.enabled:o.enabled;if(so(e,e.SCISSOR_TEST,i),i){let r=f(n.scissorTest)?n.scissorTest.rectangle:o.rectangle;e.scissor(r.x,r.y,r.width,r.height)}}function Vu(e,t){let n=t.depthRange;e.depthRange(n.near,n.far)}function ku(e,t){let n=t.depthTest,o=n.enabled;so(e,e.DEPTH_TEST,o),o&&e.depthFunc(n.func)}function Gu(e,t){let n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function ju(e,t){e.depthMask(t.depthMask)}function Hu(e,t){e.stencilMask(t.stencilMask)}function py(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function qu(e,t,n){let o=t.blending,i=f(n.blendingEnabled)?n.blendingEnabled:o.enabled;so(e,e.BLEND,i),i&&(py(e,o.color),e.blendEquationSeparate(o.equationRgb,o.equationAlpha),e.blendFuncSeparate(o.functionSourceRgb,o.functionDestinationRgb,o.functionSourceAlpha,o.functionDestinationAlpha))}function Wu(e,t){let n=t.stencilTest,o=n.enabled;if(so(e,e.STENCIL_TEST,o),o){let i=n.frontFunction,r=n.backFunction,s=n.reference,a=n.mask;e.stencilFunc(i,s,a),e.stencilFuncSeparate(e.BACK,r,s,a),e.stencilFuncSeparate(e.FRONT,i,s,a);let c=n.frontOperation,u=c.fail,d=c.zFail,m=c.zPass;e.stencilOpSeparate(e.FRONT,u,d,m);let p=n.backOperation,_=p.fail,g=p.zFail,v=p.zPass;e.stencilOpSeparate(e.BACK,_,g,v)}}function Yu(e,t){let n=t.sampleCoverage,o=n.enabled;so(e,e.SAMPLE_COVERAGE,o),o&&e.sampleCoverage(n.value,n.invert)}var _y=new Lo;function Xu(e,t,n){let o=y(t.viewport,n.viewport);f(o)||(o=_y,o.width=n.context.drawingBufferWidth,o.height=n.context.drawingBufferHeight),n.context.uniformState.viewport=o,e.viewport(o.x,o.y,o.width,o.height)}ln.apply=function(e,t,n){Nu(e,t),Lu(e,t),Fu(e,t),Bu(e,t),Vu(e,t),ku(e,t),Gu(e,t),ju(e,t),Hu(e,t),Wu(e,t),Yu(e,t),Uu(e,t,n),qu(e,t,n),Xu(e,t,n)};function yy(e,t){let n=[];return e.frontFace!==t.frontFace&&n.push(Nu),(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face)&&n.push(Lu),e.lineWidth!==t.lineWidth&&n.push(Fu),(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units)&&n.push(Bu),(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far)&&n.push(Vu),(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func)&&n.push(ku),(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha)&&n.push(Gu),e.depthMask!==t.depthMask&&n.push(ju),e.stencilMask!==t.stencilMask&&n.push(Hu),(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass)&&n.push(Wu),(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert)&&n.push(Yu),n}ln.partialApply=function(e,t,n,o,i,r){if(t!==n){let d=n._applyFunctions[t.id];f(d)||(d=yy(t,n),n._applyFunctions[t.id]=d);let m=d.length;for(let p=0;p<m;++p)d[p](e,n)}let s=f(o.scissorTest)?o.scissorTest:t.scissorTest,a=f(i.scissorTest)?i.scissorTest:n.scissorTest;(s!==a||r)&&Uu(e,n,i);let c=f(o.blendingEnabled)?o.blendingEnabled:t.blending.enabled,u=f(i.blendingEnabled)?i.blendingEnabled:n.blending.enabled;(c!==u||u&&t.blending!==n.blending)&&qu(e,n,i),(t!==n||o!==i||o.context!==i.context)&&Xu(e,n,i)};ln.getState=function(e){return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:Lo.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:Be.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:f(e.viewport)?Lo.clone(e.viewport):void 0}};var ao=ln;var gy=new l;function oe(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var ct={};ct[w.FLOAT]="float";ct[w.FLOAT_VEC2]="vec2";ct[w.FLOAT_VEC3]="vec3";ct[w.FLOAT_VEC4]="vec4";ct[w.INT]="int";ct[w.INT_VEC2]="ivec2";ct[w.INT_VEC3]="ivec3";ct[w.INT_VEC4]="ivec4";ct[w.BOOL]="bool";ct[w.BOOL_VEC2]="bvec2";ct[w.BOOL_VEC3]="bvec3";ct[w.BOOL_VEC4]="bvec4";ct[w.FLOAT_MAT2]="mat2";ct[w.FLOAT_MAT3]="mat3";ct[w.FLOAT_MAT4]="mat4";ct[w.SAMPLER_2D]="sampler2D";ct[w.SAMPLER_CUBE]="samplerCube";oe.prototype.getDeclaration=function(e){let t=`uniform ${ct[this._datatype]} ${e}`,n=this._size;return n===1?t+=";":t+=`[${n.toString()}];`,t};var Cy={czm_viewport:new oe({size:1,datatype:w.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new oe({size:1,datatype:w.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new oe({size:1,datatype:w.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.eyeHeight}}),czm_eyeHeight2D:new oe({size:1,datatype:w.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new oe({size:1,datatype:w.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new oe({size:1,datatype:w.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new oe({size:1,datatype:w.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_farDepthFromNearPlusOne:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_lightDirectionEC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.lightDirectionEC}}),czm_lightDirectionWC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.lightDirectionWC}}),czm_lightColor:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.lightColor}}),czm_lightColorHdr:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return X.getTranslation(e.inverseView,gy)}}),czm_frameNumber:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new oe({size:1,datatype:w.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new oe({size:1,datatype:w.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new oe({size:1,datatype:w.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new oe({size:1,datatype:w.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new oe({size:1,datatype:w.FLOAT_VEC2,getValue:function(e){return e.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new oe({size:9,datatype:w.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new oe({size:1,datatype:w.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_pixelRatio:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.pixelRatio}}),czm_fogDensity:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.fogDensity}}),czm_splitPosition:new oe({size:1,datatype:w.FLOAT_VEC2,getValue:function(e){return e.splitPosition}}),czm_geometricToleranceOverMeter:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new oe({size:1,datatype:w.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new oe({size:1,datatype:w.FLOAT,getValue:function(e){return e.gamma}}),czm_ellipsoidRadii:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new oe({size:1,datatype:w.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.oneOverRadii}})},Fo=Cy;function vy(e,t,n,o){switch(t.type){case e.FLOAT:return new $u(e,t,n,o);case e.FLOAT_VEC2:return new Ku(e,t,n,o);case e.FLOAT_VEC3:return new Zu(e,t,n,o);case e.FLOAT_VEC4:return new Qu(e,t,n,o);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new fa(e,t,n,o);case e.INT:case e.BOOL:return new Ju(e,t,n,o);case e.INT_VEC2:case e.BOOL_VEC2:return new ef(e,t,n,o);case e.INT_VEC3:case e.BOOL_VEC3:return new tf(e,t,n,o);case e.INT_VEC4:case e.BOOL_VEC4:return new nf(e,t,n,o);case e.FLOAT_MAT2:return new of(e,t,n,o);case e.FLOAT_MAT3:return new rf(e,t,n,o);case e.FLOAT_MAT4:return new sf(e,t,n,o);default:throw new je(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function $u(e,t,n,o){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=o}$u.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))};function Ku(e,t,n,o){this.name=n,this.value=void 0,this._value=new ne,this._gl=e,this._location=o}Ku.prototype.set=function(){let e=this.value;ne.equals(e,this._value)||(ne.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))};function Zu(e,t,n,o){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=o}Zu.prototype.set=function(){let e=this.value;f(e.red)?Be.equals(e,this._value)||(this._value=Be.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):f(e.x)&&(l.equals(e,this._value)||(this._value=l.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))};function Qu(e,t,n,o){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=o}Qu.prototype.set=function(){let e=this.value;f(e.red)?Be.equals(e,this._value)||(this._value=Be.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):f(e.x)&&(se.equals(e,this._value)||(this._value=se.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))};function fa(e,t,n,o){this.name=n,this.value=void 0,this._gl=e,this._location=o,this.textureUnitIndex=void 0}fa.prototype.set=function(){let e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);let t=this.value;e.bindTexture(t._target,t._texture)};fa.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1};function Ju(e,t,n,o){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=o}Ju.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))};function ef(e,t,n,o){this.name=n,this.value=void 0,this._value=new ne,this._gl=e,this._location=o}ef.prototype.set=function(){let e=this.value;ne.equals(e,this._value)||(ne.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))};function tf(e,t,n,o){this.name=n,this.value=void 0,this._value=new l,this._gl=e,this._location=o}tf.prototype.set=function(){let e=this.value;l.equals(e,this._value)||(l.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))};function nf(e,t,n,o){this.name=n,this.value=void 0,this._value=new se,this._gl=e,this._location=o}nf.prototype.set=function(){let e=this.value;se.equals(e,this._value)||(se.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var Ey=new Float32Array(4);function of(e,t,n,o){this.name=n,this.value=void 0,this._value=new Mt,this._gl=e,this._location=o}of.prototype.set=function(){if(!Mt.equalsArray(this.value,this._value,0)){Mt.clone(this.value,this._value);let e=Mt.toArray(this.value,Ey);this._gl.uniformMatrix2fv(this._location,!1,e)}};var Ty=new Float32Array(9);function rf(e,t,n,o){this.name=n,this.value=void 0,this._value=new Z,this._gl=e,this._location=o}rf.prototype.set=function(){if(!Z.equalsArray(this.value,this._value,0)){Z.clone(this.value,this._value);let e=Z.toArray(this.value,Ty);this._gl.uniformMatrix3fv(this._location,!1,e)}};var by=new Float32Array(16);function sf(e,t,n,o){this.name=n,this.value=void 0,this._value=new X,this._gl=e,this._location=o}sf.prototype.set=function(){if(!X.equalsArray(this.value,this._value,0)){X.clone(this.value,this._value);let e=X.toArray(this.value,by);this._gl.uniformMatrix4fv(this._location,!1,e)}};var af=vy;function Ay(e,t,n,o){switch(t.type){case e.FLOAT:return new cf(e,t,n,o);case e.FLOAT_VEC2:return new uf(e,t,n,o);case e.FLOAT_VEC3:return new ff(e,t,n,o);case e.FLOAT_VEC4:return new lf(e,t,n,o);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new la(e,t,n,o);case e.INT:case e.BOOL:return new df(e,t,n,o);case e.INT_VEC2:case e.BOOL_VEC2:return new mf(e,t,n,o);case e.INT_VEC3:case e.BOOL_VEC3:return new hf(e,t,n,o);case e.INT_VEC4:case e.BOOL_VEC4:return new pf(e,t,n,o);case e.FLOAT_MAT2:return new _f(e,t,n,o);case e.FLOAT_MAT3:return new yf(e,t,n,o);case e.FLOAT_MAT4:return new gf(e,t,n,o);default:throw new je(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function cf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._location=o[0]}cf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1;for(let i=0;i<t;++i){let r=e[i];r!==n[i]&&(n[i]=r,o=!0)}o&&this._gl.uniform1fv(this._location,n)};function uf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*2),this._gl=e,this._location=o[0]}uf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];ne.equalsArray(s,n,i)||(ne.pack(s,n,i),o=!0),i+=2}o&&this._gl.uniform2fv(this._location,n)};function ff(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*3),this._gl=e,this._location=o[0]}ff.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];f(s.red)?(s.red!==n[i]||s.green!==n[i+1]||s.blue!==n[i+2])&&(n[i]=s.red,n[i+1]=s.green,n[i+2]=s.blue,o=!0):f(s.x)&&(l.equalsArray(s,n,i)||(l.pack(s,n,i),o=!0)),i+=3}o&&this._gl.uniform3fv(this._location,n)};function lf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*4),this._gl=e,this._location=o[0]}lf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];f(s.red)?Be.equalsArray(s,n,i)||(Be.pack(s,n,i),o=!0):f(s.x)&&(se.equalsArray(s,n,i)||(se.pack(s,n,i),o=!0)),i+=4}o&&this._gl.uniform4fv(this._location,n)};function la(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._locations=o,this.textureUnitIndex=void 0}la.prototype.set=function(){let e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,o=n.length;for(let i=0;i<o;++i){let r=n[i];e.activeTexture(t+i),e.bindTexture(r._target,r._texture)}};la.prototype._setSampler=function(e){this.textureUnitIndex=e;let t=this._locations,n=t.length;for(let o=0;o<n;++o){let i=e+o;this._gl.uniform1i(t[o],i)}return e+n};function df(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i),this._gl=e,this._location=o[0]}df.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1;for(let i=0;i<t;++i){let r=e[i];r!==n[i]&&(n[i]=r,o=!0)}o&&this._gl.uniform1iv(this._location,n)};function mf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i*2),this._gl=e,this._location=o[0]}mf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];ne.equalsArray(s,n,i)||(ne.pack(s,n,i),o=!0),i+=2}o&&this._gl.uniform2iv(this._location,n)};function hf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i*3),this._gl=e,this._location=o[0]}hf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];l.equalsArray(s,n,i)||(l.pack(s,n,i),o=!0),i+=3}o&&this._gl.uniform3iv(this._location,n)};function pf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i*4),this._gl=e,this._location=o[0]}pf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];se.equalsArray(s,n,i)||(se.pack(s,n,i),o=!0),i+=4}o&&this._gl.uniform4iv(this._location,n)};function _f(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*4),this._gl=e,this._location=o[0]}_f.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];Mt.equalsArray(s,n,i)||(Mt.pack(s,n,i),o=!0),i+=4}o&&this._gl.uniformMatrix2fv(this._location,!1,n)};function yf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*9),this._gl=e,this._location=o[0]}yf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];Z.equalsArray(s,n,i)||(Z.pack(s,n,i),o=!0),i+=9}o&&this._gl.uniformMatrix3fv(this._location,!1,n)};function gf(e,t,n,o){let i=o.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i*16),this._gl=e,this._location=o[0]}gf.prototype.set=function(){let e=this.value,t=e.length,n=this._value,o=!1,i=0;for(let r=0;r<t;++r){let s=e[r];X.equalsArray(s,n,i)||(X.pack(s,n,i),o=!0),i+=16}o&&this._gl.uniformMatrix4fv(this._location,!1,n)};var Cf=Ay;var xy=0;function wn(e){let t=e.vertexShaderText,n=e.fragmentShaderText;typeof spector<"u"&&(t=t.replace(/^#line/gm,"//#line"),n=n.replace(/^#line/gm,"//#line"));let o=wy(t,n);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=o.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=o.fragmentShaderText,this.id=xy++}wn.fromCache=function(e){return e=y(e,y.EMPTY_OBJECT),e.context.shaderCache.getShaderProgram(e)};wn.replaceCache=function(e){return e=y(e,y.EMPTY_OBJECT),e.context.shaderCache.replaceShaderProgram(e)};Object.defineProperties(wn.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return Tr(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return Tr(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return Tr(this),this._uniformsByName}}});function vf(e){let t=[],n=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(f(n)){let o=n.length;for(let i=0;i<o;i++){let r=n[i].trim(),s=r.slice(r.lastIndexOf(" ")+1);t.push(s)}}return t}function wy(e,t){let n={};if(!Re.highpFloatSupported||!Re.highpIntSupported){let o,i,r,s,a=vf(e),c=vf(t),u=a.length,d=c.length;for(o=0;o<u;o++)for(i=0;i<d;i++)if(a[o]===c[i]){r=a[o],s=`czm_mediump_${r}`;let m=new RegExp(`${r}\\b`,"g");t=t.replace(m,s),n[s]=r}}return{fragmentShaderText:t,duplicateUniformNames:n}}var kt="[Cesium WebGL] ";function Sy(e,t){let n=t._vertexShaderText,o=t._fragmentShaderText,i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,n),e.compileShader(i);let r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,o),e.compileShader(r);let s=e.createProgram();e.attachShader(s,i),e.attachShader(s,r),e.deleteShader(i),e.deleteShader(r);let a=t._attributeLocations;if(f(a))for(let d in a)a.hasOwnProperty(d)&&e.bindAttribLocation(s,a[d],d);e.linkProgram(s);let c;if(!e.getProgramParameter(s,e.LINK_STATUS)){let d=t._debugShaders;if(!e.getShaderParameter(r,e.COMPILE_STATUS)){if(c=e.getShaderInfoLog(r),console.error(`${kt}Fragment shader compile log: ${c}`),f(d)){let m=d.getTranslatedShaderSource(r);console.error(m!==""?`${kt}Translated fragment shader source:
${m}`:`${kt}Fragment shader translation failed.`)}throw e.deleteProgram(s),new je(`Fragment shader failed to compile.  Compile log: ${c}`)}if(!e.getShaderParameter(i,e.COMPILE_STATUS)){if(c=e.getShaderInfoLog(i),console.error(`${kt}Vertex shader compile log: ${c}`),f(d)){let m=d.getTranslatedShaderSource(i);console.error(m!==""?`${kt}Translated vertex shader source:
${m}`:`${kt}Vertex shader translation failed.`)}throw e.deleteProgram(s),new je(`Vertex shader failed to compile.  Compile log: ${c}`)}throw c=e.getProgramInfoLog(s),console.error(`${kt}Shader program link log: ${c}`),f(d)&&(console.error(`${kt}Translated vertex shader source:
${d.getTranslatedShaderSource(i)}`),console.error(`${kt}Translated fragment shader source:
${d.getTranslatedShaderSource(r)}`)),e.deleteProgram(s),new je(`Program failed to link.  Link log: ${c}`)}let u=t._logShaderCompilation;return u&&(c=e.getShaderInfoLog(i),f(c)&&c.length>0&&console.log(`${kt}Vertex shader compile log: ${c}`)),u&&(c=e.getShaderInfoLog(r),f(c)&&c.length>0&&console.log(`${kt}Fragment shader compile log: ${c}`)),u&&(c=e.getProgramInfoLog(s),f(c)&&c.length>0&&console.log(`${kt}Shader program link log: ${c}`)),s}function Ry(e,t,n){let o={};for(let i=0;i<n;++i){let r=e.getActiveAttrib(t,i),s=e.getAttribLocation(t,r.name);o[r.name]={name:r.name,type:r.type,index:s}}return o}function Py(e,t){let n={},o=[],i=[],r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<r;++s){let a=e.getActiveUniform(t,s),c="[0]",u=a.name.indexOf(c,a.name.length-c.length)!==-1?a.name.slice(0,a.name.length-3):a.name;if(u.indexOf("gl_")!==0)if(a.name.indexOf("[")<0){let d=e.getUniformLocation(t,u);if(d!==null){let m=af(e,a,u,d);n[u]=m,o.push(m),m._setSampler&&i.push(m)}}else{let d,m,p,_,g=u.indexOf("[");if(g>=0){if(d=n[u.slice(0,g)],!f(d))continue;m=d._locations,m.length<=1&&(p=d.value,_=e.getUniformLocation(t,u),_!==null&&(m.push(_),p.push(e.getUniform(t,_))))}else{m=[];for(let v=0;v<a.size;++v)_=e.getUniformLocation(t,`${u}[${v}]`),_!==null&&m.push(_);d=Cf(e,a,u,m),n[u]=d,o.push(d),d._setSampler&&i.push(d)}}}return{uniformsByName:n,uniforms:o,samplerUniforms:i}}function Oy(e,t){let n=[],o=[];for(let i in t)if(t.hasOwnProperty(i)){let r=t[i],s=i,a=e._duplicateUniformNames[s];f(a)&&(r.name=a,s=a);let c=Fo[s];f(c)?n.push({uniform:r,automaticUniform:c}):o.push(r)}return{automaticUniforms:n,manualUniforms:o}}function Iy(e,t,n){e.useProgram(t);let o=0,i=n.length;for(let r=0;r<i;++r)o=n[r]._setSampler(o);return e.useProgram(null),o}function Tr(e){f(e._program)||Ef(e)}function Ef(e){let t=e._program,n=e._gl,o=Sy(n,e,e._debugShaders),i=n.getProgramParameter(o,n.ACTIVE_ATTRIBUTES),r=Py(n,o),s=Oy(e,r.uniformsByName);e._program=o,e._numberOfVertexAttributes=i,e._vertexAttributes=Ry(n,o,i),e._uniformsByName=r.uniformsByName,e._uniforms=r.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=Iy(n,o,r.samplerUniforms),t&&e._gl.deleteProgram(t),typeof spector<"u"&&(e._program.__SPECTOR_rebuildProgram=function(a,c,u,d){let m=e._vertexShaderText,p=e._fragmentShaderText,_=/ ! = /g;e._vertexShaderText=a.replace(_," != "),e._fragmentShaderText=c.replace(_," != ");try{Ef(e),u(e._program)}catch(g){e._vertexShaderText=m,e._fragmentShaderText=p;let b=/(?:Compile|Link) error: ([^]*)/.exec(g.message);d(b?b[1]:g.message)}})}wn.prototype._bind=function(){Tr(this),this._gl.useProgram(this._program)};wn.prototype._setUniforms=function(e,t,n){let o,i;if(f(e)){let a=this._manualUniforms;for(o=a.length,i=0;i<o;++i){let c=a[i];c.value=e[c.name]()}}let r=this._automaticUniforms;for(o=r.length,i=0;i<o;++i){let a=r[i];a.uniform.value=a.automaticUniform.getValue(t)}let s=this._uniforms;for(o=s.length,i=0;i<o;++i)s[i].set();if(n){let a=this._gl,c=this._program;a.validateProgram(c)}};wn.prototype.isDestroyed=function(){return!1};wn.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)};wn.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),It(this)};var da=wn;function My(e,t){let n=/#define OUTPUT_DECLARATION/,o=e.split(`
`);if(/#version 300 es/g.test(e))return e;let i=-1,r,s;for(r=0;r<o.length;++r)if(s=o[r],n.test(s)){i=r;break}if(i===-1)throw new ot("Could not find a #define OUTPUT_DECLARATION!");let a=[];for(r=0;r<10;r++){let v=`gl_FragData\\[${r}\\]`,b=`czm_out${r}`;new RegExp(v,"g").test(e)&&(Tf(b,a),dn(v,b,o),o.splice(i,0,`layout(location = ${r}) out vec4 ${b};`),i+=1)}let c="czm_fragColor";Dy("gl_FragColor",o)&&(Tf(c,a),dn("gl_FragColor",c,o),o.splice(i,0,"layout(location = 0) out vec4 czm_fragColor;"),i+=1);let u=Ly(a,o),d={};for(r=0;r<o.length;r++){s=o[r];for(let v in u)u.hasOwnProperty(v)&&new RegExp(`(layout)[^]+(out)[^]+(${v})[^]+`,"g").test(s)&&(d[s]=v)}for(let v in d)if(d.hasOwnProperty(v)){let b=d[v],S=o.indexOf(v),A=u[b],x=A.length;for(let P=0;P<x;P++)o.splice(S,0,A[P]);S+=x+1;for(let P=x-1;P>=0;P--)o.splice(S,0,`#endif //${A[P]}`)}let m="WEBGL_2",p=`#define ${m}`,_="#version 300 es",g=!1;for(r=0;r<o.length;r++)if(/#version/.test(o[r])){o[r]=_,g=!0;break}return g||o.splice(0,0,_),o.splice(1,0,p),ma("EXT_draw_buffers",m,o),ma("EXT_frag_depth",m,o),ma("OES_standard_derivatives",m,o),dn("texture2D","texture",o),dn("texture3D","texture",o),dn("textureCube","texture",o),dn("gl_FragDepthEXT","gl_FragDepth",o),t?dn("varying","in",o):(dn("attribute","in",o),dn("varying","out",o)),Ny(o)}function dn(e,t,n){let o=`(^|[^\\w])(${e})($|[^\\w])`,i=new RegExp(o,"g"),r=n.length;for(let s=0;s<r;++s){let a=n[s];n[s]=a.replace(i,`$1${t}$3`)}}function zy(e,t,n){let o=n.length;for(let i=0;i<o;++i){let r=n[i];n[i]=r.replace(e,t)}}function Dy(e,t){let n=`(^|[^\\w])(${e})($|[^\\w])`,o=new RegExp(n,"g"),i=t.length;for(let r=0;r<i;++r){let s=t[r];if(o.test(s))return!0}return!1}function Ny(e){let t="",n=e.length;for(let o=0;o<n;++o)t+=`${e[o]}
`;return t}function Tf(e,t){t.indexOf(e)===-1&&t.push(e)}function Ly(e,t){let n={},o=e.length,i=[];for(let r=0;r<t.length;++r){let s=t[r],a=/(#ifdef|#if)/g.test(s),c=/#else/g.test(s),u=/#endif/g.test(s);if(a)i.push(s);else if(c){let m=i[i.length-1].replace("ifdef","ifndef");/if/g.test(m)&&(m=m.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),i.pop(),i.push(m)}else if(u)i.pop();else if(!/layout/g.test(s))for(let d=0;d<o;++d){let m=e[d];s.indexOf(m)!==-1&&(f(n[m])?n[m]=n[m].filter(function(p){return i.indexOf(p)>=0}):n[m]=i.slice())}}return n}function ma(e,t,n){let o=`#extension\\s+GL_${e}\\s+:\\s+[a-zA-Z0-9]+\\s*$`;zy(new RegExp(o,"g"),"",n),dn(`GL_${e}`,t,n)}var bf=My;var Af=`const float czm_degreesPerRadian = 57.29577951308232;
`;var xf=`const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);
`;var wf=`const float czm_epsilon1 = 0.1;
`;var Sf=`const float czm_epsilon2 = 0.01;
`;var Rf=`const float czm_epsilon3 = 0.001;
`;var Pf=`const float czm_epsilon4 = 0.0001;
`;var Of=`const float czm_epsilon5 = 0.00001;
`;var If=`const float czm_epsilon6 = 0.000001;
`;var Mf=`const float czm_epsilon7 = 0.0000001;
`;var zf=`const float czm_infinity = 5906376272000.0;
`;var Df=`const float czm_oneOverPi = 0.3183098861837907;
`;var Nf=`const float czm_oneOverTwoPi = 0.15915494309189535;
`;var Lf=`const float czm_passCesium3DTile = 4.0;
`;var Ff=`const float czm_passCesium3DTileClassification = 5.0;
`;var Bf=`const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;
`;var Uf=`const float czm_passClassification = 7.0;
`;var Vf=`const float czm_passCompute = 1.0;
`;var kf=`const float czm_passEnvironment = 0.0;
`;var Gf=`const float czm_passGlobe = 2.0;
`;var jf=`const float czm_passOpaque = 7.0;
`;var Hf=`const float czm_passOverlay = 9.0;
`;var qf=`const float czm_passTerrainClassification = 3.0;
`;var Wf=`const float czm_passTranslucent = 8.0;
`;var Yf=`const float czm_pi = 3.141592653589793;
`;var Xf=`const float czm_piOverFour = 0.7853981633974483;
`;var $f=`const float czm_piOverSix = 0.5235987755982988;
`;var Kf=`const float czm_piOverThree = 1.0471975511965976;
`;var Zf=`const float czm_piOverTwo = 1.5707963267948966;
`;var Qf=`const float czm_radiansPerDegree = 0.017453292519943295;
`;var Jf=`const float czm_sceneMode2D = 2.0;
`;var el=`const float czm_sceneMode3D = 3.0;
`;var tl=`const float czm_sceneModeColumbusView = 1.0;
`;var nl=`const float czm_sceneModeMorphing = 0.0;
`;var ol=`const float czm_solarRadius = 695500000.0;
`;var il=`const float czm_threePiOver2 = 4.71238898038469;
`;var rl=`const float czm_twoPi = 6.283185307179586;
`;var sl=`const float czm_webMercatorMaxLatitude = 1.4844222297453324;
`;var al=`struct czm_depthRangeStruct
{
float near;
float far;
};
`;var cl=`struct czm_material
{
vec3 diffuse;
float specular;
float shininess;
vec3 normal;
vec3 emission;
float alpha;
};
`;var ul=`struct czm_materialInput
{
float s;
vec2 st;
vec3 str;
vec3 normalEC;
mat3 tangentToEyeMatrix;
vec3 positionToEyeEC;
float height;
float slope;
float aspect;
};
`;var fl=`struct czm_modelMaterial {
vec3 diffuse;
float alpha;
vec3 specular;
float roughness;
vec3 normalEC;
float occlusion;
vec3 emissive;
};
`;var ll=`struct czm_modelVertexOutput {
vec3 positionMC;
float pointSize;
};
`;var dl=`struct czm_pbrParameters
{
vec3 diffuseColor;
float roughness;
vec3 f0;
};
`;var ml=`struct czm_ray
{
vec3 origin;
vec3 direction;
};
`;var hl=`struct czm_raySegment
{
float start;
float stop;
};
const czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);
const czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);
`;var pl=`struct czm_shadowParameters
{
#ifdef USE_CUBE_MAP_SHADOW
vec3 texCoords;
#else
vec2 texCoords;
#endif
float depthBias;
float depth;
float nDotL;
vec2 texelStepSize;
float normalShadingSmooth;
float darkness;
};
`;var _l=`vec3 czm_acesTonemapping(vec3 color) {
float g = 0.985;
float a = 0.065;
float b = 0.0001;
float c = 0.433;
float d = 0.238;
color = (color * (color + a) - b) / (color * (g * color + c) + d);
color = clamp(color, 0.0, 1.0);
return color;
}
`;var yl=`float czm_alphaWeight(float a)
{
float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));
}
`;var gl=`vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)
{
float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);
float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);
val1 = val1 * (1.0 - val2);
val1 = val1 * val1 * (3.0 - (2.0 * val1));
val1 = pow(val1, 0.5);
vec4 midColor = (color1 + color2) * 0.5;
return mix(midColor, currentColor, val1);
}
vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)
{
return czm_antialias(color1, color2, currentColor, dist, 0.1);
}
`;var Cl=`vec2 czm_approximateSphericalCoordinates(vec3 normal) {
float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);
float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);
return vec2(latitudeApproximation, longitudeApproximation);
}
`;var vl=`bool czm_backFacing()
{
return gl_FrontFacing == false;
}
`;var El=`float czm_branchFreeTernary(bool comparison, float a, float b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
`;var Tl=`vec4 czm_cascadeColor(vec4 weights)
{
return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +
vec4(0.0, 1.0, 0.0, 1.0) * weights.y +
vec4(0.0, 0.0, 1.0, 1.0) * weights.z +
vec4(1.0, 0.0, 1.0, 1.0) * weights.w;
}
`;var bl=`uniform vec4 shadowMap_cascadeDistances;
float czm_cascadeDistance(vec4 weights)
{
return dot(shadowMap_cascadeDistances, weights);
}
`;var Al=`uniform mat4 shadowMap_cascadeMatrices[4];
mat4 czm_cascadeMatrix(vec4 weights)
{
return shadowMap_cascadeMatrices[0] * weights.x +
shadowMap_cascadeMatrices[1] * weights.y +
shadowMap_cascadeMatrices[2] * weights.z +
shadowMap_cascadeMatrices[3] * weights.w;
}
`;var xl=`uniform vec4 shadowMap_cascadeSplits[2];
vec4 czm_cascadeWeights(float depthEye)
{
vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));
vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);
return near * far;
}
`;var wl=`vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)
{
vec3 p = mix(position2D.xyz, position3D.xyz, time);
return vec4(p, 1.0);
}
`;var Sl=`vec4 czm_computePosition();
`;var Rl=`vec2 cordic(float angle)
{
vec2 vector = vec2(6.0725293500888267e-1, 0.0);
float sense = (angle < 0.0) ? -1.0 : 1.0;
mat2 rotation = mat2(1.0, sense, -sense, 1.0);
vector = rotation * vector;
angle -= sense * 7.8539816339744828e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
float factor = sense * 5.0e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.6364760900080609e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.5e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4497866312686414e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.25e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2435499454676144e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.25e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.2418809995957350e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.125e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.1239833430268277e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.5625e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5623728620476831e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.8125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.8123410601011111e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.90625e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.9062301319669718e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.953125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9531225164788188e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.765625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.7656218955931946e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.8828125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.8828121119489829e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.44140625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4414062014936177e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.220703125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2207031189367021e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.103515625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.1035156174208773e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.0517578125e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.0517578115526096e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.52587890625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5258789061315762e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.62939453125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.6293945311019700e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.814697265625e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.8146972656064961e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.9073486328125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9073486328101870e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.5367431640625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.5367431640596084e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.76837158203125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.7683715820308884e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.384185791015625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.3841857910155797e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.1920928955078125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
return vector;
}
vec2 czm_cosineAndSine(float angle)
{
if (angle < -czm_piOverTwo || angle > czm_piOverTwo)
{
if (angle < 0.0)
{
return -cordic(angle + czm_pi);
}
else
{
return -cordic(angle - czm_pi);
}
}
else
{
return cordic(angle);
}
}
`;var Pl=`vec2 czm_decompressTextureCoordinates(float encoded)
{
float temp = encoded / 4096.0;
float xZeroTo4095 = floor(temp);
float stx = xZeroTo4095 / 4095.0;
float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;
return vec2(stx, sty);
}
`;var Ol=`czm_pbrParameters czm_defaultPbrMaterial()
{
czm_pbrParameters results;
results.diffuseColor = vec3(1.0);
results.roughness = 1.0;
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
results.f0 = REFLECTANCE_DIELECTRIC;
return results;
}
`;var Il=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
vec4 czm_depthClamp(vec4 coords)
{
#ifndef LOG_DEPTH
#ifdef GL_EXT_frag_depth
v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;
coords.z = 0.0;
#else
coords.z = min(coords.z, coords.w);
#endif
#endif
return coords;
}
`;var Ml=`mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)
{
vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));
vec3 tangentEC = normalize(czm_normal3D * tangentMC);
vec3 bitangentEC = normalize(cross(normalEC, tangentEC));
return mat3(
tangentEC.x,   tangentEC.y,   tangentEC.z,
bitangentEC.x, bitangentEC.y, bitangentEC.z,
normalEC.x,    normalEC.y,    normalEC.z);
}
`;var zl=`bool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)
{
vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;
return (dot(scaled, scaled) <= 1.0);
}
`;var Dl=`vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)
{
return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);
}
`;var Nl=`bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec4(epsilon)));
}
bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec3(epsilon)));
}
bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec2(epsilon)));
}
bool czm_equalsEpsilon(float left, float right, float epsilon) {
return (abs(left - right) <= epsilon);
}
`;var Ll=`vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)
{
vec4 p = positionEC;
vec4 zEyeOffset = normalize(p) * eyeOffset.z;
p.xy += eyeOffset.xy + zEyeOffset.xy;
p.z += zEyeOffset.z;
return p;
}
`;var Fl=`vec4 czm_eyeToWindowCoordinates(vec4 positionEC)
{
vec4 q = czm_projection * positionEC;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var Bl=`float czm_fastApproximateAtan(float x) {
return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);
}
float czm_fastApproximateAtan(float x, float y) {
float t = abs(x);
float opposite = abs(y);
float adjacent = max(t, opposite);
opposite = min(t, opposite);
t = czm_fastApproximateAtan(opposite / adjacent);
t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);
t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);
t = czm_branchFreeTernary(y < 0.0, -t, t);
return t;
}
`;var Ul=`vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-(scalar * scalar));
return mix(color, fogColor, fog);
}
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));
return mix(color, fogColor, fog);
}
`;var Vl=`vec3 czm_gammaCorrect(vec3 color) {
#ifdef HDR
color = pow(color, vec3(czm_gamma));
#endif
return color;
}
vec4 czm_gammaCorrect(vec4 color) {
#ifdef HDR
color.rgb = pow(color.rgb, vec3(czm_gamma));
#endif
return color;
}
`;var kl=`vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)
{
return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);
}
`;var Gl=`czm_material czm_getDefaultMaterial(czm_materialInput materialInput)
{
czm_material material;
material.diffuse = vec3(0.0);
material.specular = 0.0;
material.shininess = 1.0;
material.normal = materialInput.normalEC;
material.emission = vec3(0.0);
material.alpha = 1.0;
return material;
}
`;var jl=`float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)
{
return max(dot(lightDirectionEC, normalEC), 0.0);
}
`;var Hl=`float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)
{
vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);
float specular = max(dot(toReflectedLight, toEyeEC), 0.0);
return pow(specular, max(shininess, czm_epsilon2));
}
`;var ql=`vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)
{
float cosAngle = cos(angleInRadians);
float sinAngle = sin(angleInRadians);
vec2 s0 = vec2(1.0/17.0, 0.0);
vec2 s1 = vec2(-1.0/29.0, 0.0);
vec2 s2 = vec2(1.0/101.0, 1.0/59.0);
vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);
s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));
s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));
s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));
s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));
vec2 uv0 = (uv/103.0) + (time * s0);
vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);
vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);
vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);
uv0 = fract(uv0);
uv1 = fract(uv1);
uv2 = fract(uv2);
uv3 = fract(uv3);
vec4 noise = (texture2D(normalMap, uv0)) +
(texture2D(normalMap, uv1)) +
(texture2D(normalMap, uv2)) +
(texture2D(normalMap, uv3));
return ((noise / 4.0) - 0.5) * 2.0;
}
`;var Wl=`const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 czm_HSBToRGB(vec3 hsb)
{
vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);
return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);
}
`;var Yl=`vec3 hueToRGB(float hue)
{
float r = abs(hue * 6.0 - 3.0) - 1.0;
float g = 2.0 - abs(hue * 6.0 - 2.0);
float b = 2.0 - abs(hue * 6.0 - 4.0);
return clamp(vec3(r, g, b), 0.0, 1.0);
}
vec3 czm_HSLToRGB(vec3 hsl)
{
vec3 rgb = hueToRGB(hsl.x);
float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;
return (rgb - 0.5) * c + hsl.z;
}
`;var Xl=`vec3 czm_hue(vec3 rgb, float adjustment)
{
const mat3 toYIQ = mat3(0.299,     0.587,     0.114,
0.595716, -0.274453, -0.321263,
0.211456, -0.522591,  0.311135);
const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,
1.0, -0.2721, -0.6474,
1.0, -1.107,   1.7046);
vec3 yiq = toYIQ * rgb;
float hue = atan(yiq.z, yiq.y) + adjustment;
float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);
vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));
return toRGB * color;
}
`;var $l=`vec3 czm_inverseGamma(vec3 color) {
return pow(color, vec3(1.0 / czm_gamma));
}
`;var Kl=`bool czm_isEmpty(czm_raySegment interval)
{
return (interval.stop < 0.0);
}
`;var Zl=`bool czm_isFull(czm_raySegment interval)
{
return (interval.start == 0.0 && interval.stop == czm_infinity);
}
`;var Ql=`float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)
{
float sinLatitude = sin(latitude);
float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));
return (mercatorY - southMercatorY) * oneOverMercatorHeight;
}
`;var Jl=`vec3 czm_linearToSrgb(vec3 linearIn)
{
return pow(linearIn, vec3(1.0/2.2));
}
vec4 czm_linearToSrgb(vec4 linearIn)
{
vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));
return vec4(srgbOut, linearIn.a);
}
`;var ed=`float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {
return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);
}
`;var td=`float czm_luminance(vec3 rgb)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
return dot(rgb, W);
}
`;var nd=`float czm_metersPerPixel(vec4 positionEC, float pixelRatio)
{
float width = czm_viewport.z;
float height = czm_viewport.w;
float pixelWidth;
float pixelHeight;
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)
{
float frustumWidth = right - left;
float frustumHeight = top - bottom;
pixelWidth = frustumWidth / width;
pixelHeight = frustumHeight / height;
}
else
{
float distanceToPixel = -positionEC.z;
float inverseNear = 1.0 / czm_currentFrustum.x;
float tanTheta = top * inverseNear;
pixelHeight = 2.0 * distanceToPixel * tanTheta / height;
tanTheta = right * inverseNear;
pixelWidth = 2.0 * distanceToPixel * tanTheta / width;
}
return max(pixelWidth, pixelHeight) * pixelRatio;
}
float czm_metersPerPixel(vec4 positionEC)
{
return czm_metersPerPixel(positionEC, czm_pixelRatio);
}
`;var od=`vec4 czm_modelToWindowCoordinates(vec4 position)
{
vec4 q = czm_modelViewProjection * position;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var id=`vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 target = left * right;
float leftLuminance = dot(left, W);
float rightLuminance = dot(right, W);
float targetLuminance = dot(target, W);
return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;
}
`;var rd=`float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)
{
float valueAtMin = nearFarScalar.y;
float valueAtMax = nearFarScalar.w;
float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;
float farDistanceSq = nearFarScalar.z * nearFarScalar.z;
float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);
t = pow(clamp(t, 0.0, 1.0), 0.2);
return mix(valueAtMin, valueAtMax, t);
}
`;var sd=`vec3 czm_octDecode(vec2 encoded, float range)
{
if (encoded.x == 0.0 && encoded.y == 0.0) {
return vec3(0.0, 0.0, 0.0);
}
encoded = encoded / range * 2.0 - 1.0;
vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));
if (v.z < 0.0)
{
v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);
}
return normalize(v);
}
vec3 czm_octDecode(vec2 encoded)
{
return czm_octDecode(encoded, 255.0);
}
vec3 czm_octDecode(float encoded)
{
float temp = encoded / 256.0;
float x = floor(temp);
float y = (temp - x) * 256.0;
return czm_octDecode(vec2(x, y));
}
void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)
{
float temp = encoded.x / 65536.0;
float x = floor(temp);
float encodedFloat1 = (temp - x) * 65536.0;
temp = encoded.y / 65536.0;
float y = floor(temp);
float encodedFloat2 = (temp - y) * 65536.0;
vector1 = czm_octDecode(encodedFloat1);
vector2 = czm_octDecode(encodedFloat2);
vector3 = czm_octDecode(vec2(x, y));
}
`;var ad=`vec4 czm_packDepth(float depth)
{
vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;
enc = fract(enc);
enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
return enc;
}
`;var cd=`vec3 lambertianDiffuse(vec3 diffuseColor)
{
return diffuseColor / czm_pi;
}
vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)
{
return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}
float smithVisibilityG1(float NdotV, float roughness)
{
float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
return NdotV / (NdotV * (1.0 - k) + k);
}
float smithVisibilityGGX(float roughness, float NdotL, float NdotV)
{
return (
smithVisibilityG1(NdotL, roughness) *
smithVisibilityG1(NdotV, roughness)
);
}
float GGX(float roughness, float NdotH)
{
float roughnessSquared = roughness * roughness;
float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
return roughnessSquared / (czm_pi * f * f);
}
vec3 czm_pbrLighting(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
)
{
vec3 v = -normalize(positionEC);
vec3 l = normalize(lightDirectionEC);
vec3 h = normalize(v + l);
vec3 n = normalEC;
float NdotL = clamp(dot(n, l), 0.001, 1.0);
float NdotV = abs(dot(n, v)) + 0.001;
float NdotH = clamp(dot(n, h), 0.0, 1.0);
float LdotH = clamp(dot(l, h), 0.0, 1.0);
float VdotH = clamp(dot(v, h), 0.0, 1.0);
vec3 f0 = pbrParameters.f0;
float reflectance = max(max(f0.r, f0.g), f0.b);
vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
vec3 F = fresnelSchlick2(f0, f90, VdotH);
float alpha = pbrParameters.roughness;
float G = smithVisibilityGGX(alpha, NdotL, NdotV);
float D = GGX(alpha, NdotH);
vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
vec3 diffuseColor = pbrParameters.diffuseColor;
vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
return (diffuseContribution + specularContribution) * NdotL * lightColorHdr;
}
`;var ud=`czm_pbrParameters czm_pbrMetallicRoughnessMaterial(
vec3 baseColor,
float metallic,
float roughness
)
{
czm_pbrParameters results;
roughness = clamp(roughness, 0.0, 1.0);
results.roughness = roughness * roughness;
metallic = clamp(metallic, 0.0, 1.0);
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
vec3 f0 = mix(REFLECTANCE_DIELECTRIC, baseColor, metallic);
results.f0 = f0;
results.diffuseColor = baseColor * (1.0 - f0) * (1.0 - metallic);
return results;
}
`;var fd=`czm_pbrParameters czm_pbrSpecularGlossinessMaterial(
vec3 diffuse,
vec3 specular,
float glossiness
)
{
czm_pbrParameters results;
float roughness = 1.0 - glossiness;
results.roughness = roughness * roughness;
results.diffuseColor = diffuse * (1.0 - max(max(specular.r, specular.g), specular.b));
results.f0 = specular;
return results;
}
`;var ld=`float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)
{
return czm_getLambertDiffuse(lightDirectionEC, material.normal);
}
float czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)
{
return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);
}
vec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);
}
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_phong(vec3 toEye, czm_material material)
{
return czm_phong(toEye, material,czm_lightDirectionEC);
}
vec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 ambient = vec3(0.0);
vec3 color = ambient + material.emission;
color += material.diffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
`;var dd=`float czm_planeDistance(vec4 plane, vec3 point) {
return (dot(plane.xyz, point) + plane.w);
}
float czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {
return (dot(planeNormal, point) + planeDistance);
}
`;var md=`vec3 czm_pointAlongRay(czm_ray ray, float time)
{
return ray.origin + (time * ray.direction);
}
`;var hd=`czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)
{
vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;
vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;
q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;
float q2 = dot(q, q);
float qw = dot(q, w);
if (q2 > 1.0)
{
if (qw >= 0.0)
{
return czm_emptyRaySegment;
}
else
{
float qw2 = qw * qw;
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
if (qw2 < product)
{
return czm_emptyRaySegment;
}
else if (qw2 > product)
{
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
float root0 = temp / w2;
float root1 = difference / temp;
if (root0 < root1)
{
czm_raySegment i = czm_raySegment(root0, root1);
return i;
}
else
{
czm_raySegment i = czm_raySegment(root1, root0);
return i;
}
}
else
{
float root = sqrt(difference / w2);
czm_raySegment i = czm_raySegment(root, root);
return i;
}
}
}
else if (q2 < 1.0)
{
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
czm_raySegment i = czm_raySegment(0.0, temp / w2);
return i;
}
else
{
if (qw < 0.0)
{
float w2 = dot(w, w);
czm_raySegment i = czm_raySegment(0.0, -qw / w2);
return i;
}
else
{
return czm_emptyRaySegment;
}
}
}
`;var pd=`czm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)
{
vec3 o = ray.origin;
vec3 d = ray.direction;
vec3 oc = o - center;
float a = dot(d, d);
float b = 2.0 * dot(d, oc);
float c = dot(oc, oc) - (radius * radius);
float det = (b * b) - (4.0 * a * c);
if (det < 0.0) {
return czm_emptyRaySegment;
}
float sqrtDet = sqrt(det);
float t0 = (-b - sqrtDet) / (2.0 * a);
float t1 = (-b + sqrtDet) / (2.0 * a);
czm_raySegment result = czm_raySegment(t0, t1);
return result;
}
`;var _d=`float czm_readDepth(sampler2D depthTexture, vec2 texCoords)
{
return czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);
}
`;var yd=`float czm_readNonPerspective(float value, float oneOverW) {
return value * oneOverW;
}
vec2 czm_readNonPerspective(vec2 value, float oneOverW) {
return value * oneOverW;
}
vec3 czm_readNonPerspective(vec3 value, float oneOverW) {
return value * oneOverW;
}
vec4 czm_readNonPerspective(vec4 value, float oneOverW) {
return value * oneOverW;
}
`;var gd=`float czm_reverseLogDepth(float logZ)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
return far * (1.0 - near / (depthFromNear + near)) / (far - near);
#endif
return logZ;
}
`;var Cd=`const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec3 czm_RGBToHSB(vec3 rgb)
{
vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));
vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));
float d = q.x - min(q.w, q.y);
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);
}
`;var vd=`vec3 RGBtoHCV(vec3 rgb)
{
vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);
vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);
float c = q.x - min(q.w, q.y);
float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);
return vec3(h, c, q.x);
}
vec3 czm_RGBToHSL(vec3 rgb)
{
vec3 hcv = RGBtoHCV(rgb);
float l = hcv.z - hcv.y * 0.5;
float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);
return vec3(hcv.x, s, l);
}
`;var Ed=`vec3 czm_RGBToXYZ(vec3 rgb)
{
const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,
0.3576, 0.7152, 0.1192,
0.1805, 0.0722, 0.9505);
vec3 xyz = RGB2XYZ * rgb;
vec3 Yxy;
Yxy.r = xyz.g;
float temp = dot(vec3(1.0), xyz);
Yxy.gb = xyz.rg / temp;
return Yxy;
}
`;var Td=`void czm_rollerShutter(vec2 coord,vec4 region)
{
vec2 st = coord / czm_viewport.zw;
if(st.x < region.x || st.x > region.z){
discard;
}
if(st.y < region.y || st.y > region.w){
discard;
}
}
`;var bd=`float czm_round(float value) {
return floor(value + 0.5);
}
vec2 czm_round(vec2 value) {
return floor(value + 0.5);
}
vec3 czm_round(vec3 value) {
return floor(value + 0.5);
}
vec4 czm_round(vec4 value) {
return floor(value + 0.5);
}
`;var Ad=`vec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)
{
direction /= dot(vec3(1.0), abs(direction));
vec2 rev = abs(direction.zx) - vec2(1.0);
vec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,
direction.z < 0.0 ? rev.y : -rev.y);
vec2 uv = direction.y < 0.0 ? neg : direction.xz;
vec2 coord = 0.5 * uv + vec2(0.5);
vec2 pixel = 1.0 / textureSize;
if (lod > 0.0)
{
float scale = 1.0 / pow(2.0, lod);
float offset = ((textureSize.y + 1.0) / textureSize.x);
coord.x *= offset;
coord *= scale;
coord.x += offset + pixel.x;
coord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;
}
else
{
coord.x *= (textureSize.y / textureSize.x);
}
#ifndef OES_texture_float_linear
vec3 color1 = texture2D(projectedMap, coord + vec2(0.0, pixel.y)).rgb;
vec3 color2 = texture2D(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;
vec3 color3 = texture2D(projectedMap, coord + pixel).rgb;
vec3 color4 = texture2D(projectedMap, coord).rgb;
vec2 texturePosition = coord * textureSize;
float fu = fract(texturePosition.x);
float fv = fract(texturePosition.y);
vec3 average1 = mix(color4, color2, fu);
vec3 average2 = mix(color1, color3, fu);
vec3 color = mix(average1, average2, fv);
#else
vec3 color = texture2D(projectedMap, coord).rgb;
#endif
return color;
}
vec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {
float currentLod = floor(lod + 0.5);
float nextLod = min(currentLod + 1.0, maxLod);
vec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);
vec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);
return mix(colorNextLod, colorCurrentLod, nextLod - lod);
}
`;var xd=`vec3 czm_saturation(vec3 rgb, float adjustment)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 intensity = vec3(dot(rgb, W));
return mix(intensity, rgb, adjustment);
}
`;var wd=`float czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)
{
return czm_unpackDepth(textureCube(shadowMap, d));
}
float czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)
{
#ifdef USE_SHADOW_DEPTH_TEXTURE
return texture2D(shadowMap, uv).r;
#else
return czm_unpackDepth(texture2D(shadowMap, uv));
#endif
}
float czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
float czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
`;var Sd=`float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)
{
#ifdef USE_NORMAL_SHADING
#ifdef USE_NORMAL_SHADING_SMOOTH
float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);
#else
float strength = step(0.0, nDotL);
#endif
visibility *= strength;
#endif
visibility = max(visibility, darkness);
return visibility;
}
#ifdef USE_CUBE_MAP_SHADOW
float czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec3 uvw = shadowParameters.texCoords;
depth -= depthBias;
float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#else
float czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec2 uv = shadowParameters.texCoords;
depth -= depthBias;
#ifdef USE_SOFT_SHADOWS
vec2 texelStepSize = shadowParameters.texelStepSize;
float radius = 1.0;
float dx0 = -texelStepSize.x * radius;
float dy0 = -texelStepSize.y * radius;
float dx1 = texelStepSize.x * radius;
float dy1 = texelStepSize.y * radius;
float visibility = (
czm_shadowDepthCompare(shadowMap, uv, depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)
) * (1.0 / 9.0);
#else
float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);
#endif
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#endif
`;var Rd=`float czm_signNotZero(float value)
{
return value >= 0.0 ? 1.0 : -1.0;
}
vec2 czm_signNotZero(vec2 value)
{
return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));
}
vec3 czm_signNotZero(vec3 value)
{
return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));
}
vec4 czm_signNotZero(vec4 value)
{
return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));
}
`;var Pd=`vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])
{
vec3 L00 = coefficients[0];
vec3 L1_1 = coefficients[1];
vec3 L10 = coefficients[2];
vec3 L11 = coefficients[3];
vec3 L2_2 = coefficients[4];
vec3 L2_1 = coefficients[5];
vec3 L20 = coefficients[6];
vec3 L21 = coefficients[7];
vec3 L22 = coefficients[8];
float x = normal.x;
float y = normal.y;
float z = normal.z;
return
L00
+ L1_1 * y
+ L10 * z
+ L11 * x
+ L2_2 * (y * x)
+ L2_1 * (y * z)
+ L20 * (3.0 * z * z - 1.0)
+ L21 * (z * x)
+ L22 * (x * x - y * y);
}
`;var Od=`vec3 czm_srgbToLinear(vec3 srgbIn)
{
return pow(srgbIn, vec3(2.2));
}
vec4 czm_srgbToLinear(vec4 srgbIn)
{
vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
return vec4(linearOut, srgbIn.a);
}
`;var Id=`mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)
{
vec3 normal = normalize(normalEC);
vec3 tangent = normalize(tangentEC);
vec3 bitangent = normalize(bitangentEC);
return mat3(tangent.x  , tangent.y  , tangent.z,
bitangent.x, bitangent.y, bitangent.z,
normal.x   , normal.y   , normal.z);
}
`;var Md=`vec4 czm_transformPlane(vec4 plane, mat4 transform) {
vec4 transformedPlane = transform * plane;
float normalMagnitude = length(transformedPlane.xyz);
return transformedPlane / normalMagnitude;
}
`;var zd=`vec4 czm_transformPlaneOld(vec4 clippingPlane, mat4 transform) {
vec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);
vec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;
vec4 transformedPlane;
transformedPlane.xyz = transformedDirection;
transformedPlane.w = -dot(transformedDirection, transformedPosition);
return transformedPlane;
}
`;var Dd=`vec4 czm_translateRelativeToEye(vec3 high, vec3 low)
{
vec3 highDifference = high - czm_encodedCameraPositionMCHigh;
vec3 lowDifference = low - czm_encodedCameraPositionMCLow;
return vec4(highDifference + lowDifference, 1.0);
}
`;var Nd=`vec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);
}
diffuse = clamp(diffuse, 0.0, 1.0);
float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_translucentPhong(vec3 toEye, czm_material material)
{
return czm_translucentPhong(toEye, material, czm_lightDirectionEC);
}
`;var Ld=`mat2 czm_transpose(mat2 matrix)
{
return mat2(
matrix[0][0], matrix[1][0],
matrix[0][1], matrix[1][1]);
}
mat3 czm_transpose(mat3 matrix)
{
return mat3(
matrix[0][0], matrix[1][0], matrix[2][0],
matrix[0][1], matrix[1][1], matrix[2][1],
matrix[0][2], matrix[1][2], matrix[2][2]);
}
mat4 czm_transpose(mat4 matrix)
{
return mat4(
matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],
matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],
matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],
matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);
}
`;var Fd=`float czm_unpackDepth(vec4 packedDepth)
{
return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));
}
`;var Bd=`float czm_unpackFloat(vec4 packedFloat)
{
packedFloat = floor(packedFloat * 255.0 + 0.5);
float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;
float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;
if (exponent == -127.0)
{
return 0.0;
}
float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);
float result = sign * exp2(exponent - 23.0) * mantissa;
return result;
}
`;var Ud=`int czm_unpackUint(float packedValue) {
float rounded = czm_round(packedValue * 255.0);
return int(rounded);
}
int czm_unpackUint(vec2 packedValue) {
vec2 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec2(1.0, 256.0)));
}
int czm_unpackUint(vec3 packedValue) {
vec3 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));
}
int czm_unpackUint(vec4 packedValue) {
vec4 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));
}
`;var Vd=`float czm_valueTransform(float offset, float scale, float value) {
return scale * value + offset;
}
vec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {
return scale * value + offset;
}
vec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {
return scale * value + offset;
}
vec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {
return scale * value + offset;
}
mat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {
return matrixCompMult(scale, value) + offset;
}
mat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {
return matrixCompMult(scale, value) + offset;
}
mat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {
return matrixCompMult(scale, value) + offset;
}
`;var kd=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef SHADOW_MAP
varying vec3 v_logPositionEC;
#endif
#endif
vec4 czm_updatePositionDepth(vec4 coords) {
#if defined(LOG_DEPTH)
#ifdef SHADOW_MAP
vec3 logPositionEC = (czm_inverseProjection * coords).xyz;
v_logPositionEC = logPositionEC;
#endif
coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;
#endif
return coords;
}
void czm_vertexLogDepth()
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;
gl_Position = czm_updatePositionDepth(gl_Position);
#endif
}
void czm_vertexLogDepth(vec4 clipCoords)
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;
czm_updatePositionDepth(clipCoords);
#endif
}
`;var Gd=`vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)
{
float x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;
float y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;
float z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
vec4 q = vec4(x, y, z, 1.0);
q /= fragmentCoordinate.w;
if (!(czm_inverseProjection == mat4(0.0)))
{
q = czm_inverseProjection * q;
}
else
{
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
q.x = (q.x * (right - left) + left + right) * 0.5;
q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
q.z = (q.z * (near - far) - near - far) * 0.5;
q.w = 1.0;
}
return q;
}
vec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
float depthFromCamera = depthFromNear + near;
vec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
eyeCoordinate.w = 1.0 / depthFromCamera;
return eyeCoordinate;
#else
vec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
#endif
return eyeCoordinate;
}
`;var jd=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
void czm_writeDepthClamp()
{
#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
gl_FragDepthEXT = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);
#endif
}
`;var Hd=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef POLYGON_OFFSET
uniform vec2 u_polygonOffset;
#endif
#endif
void czm_writeLogDepth(float depth)
{
#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH)
if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {
discard;
}
#ifdef POLYGON_OFFSET
float factor = u_polygonOffset[0];
float units = u_polygonOffset[1];
#ifdef GL_OES_standard_derivatives
float x = dFdx(depth);
float y = dFdy(depth);
float m = sqrt(x * x + y * y);
depth += m * factor;
#endif
#endif
gl_FragDepthEXT = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;
#ifdef POLYGON_OFFSET
gl_FragDepthEXT += czm_epsilon7 * units;
#endif
#endif
}
void czm_writeLogDepth() {
#ifdef LOG_DEPTH
czm_writeLogDepth(v_depthFromNearPlusOne);
#endif
}
`;var qd=`float czm_writeNonPerspective(float value, float w) {
return value * w;
}
vec2 czm_writeNonPerspective(vec2 value, float w) {
return value * w;
}
vec3 czm_writeNonPerspective(vec3 value, float w) {
return value * w;
}
vec4 czm_writeNonPerspective(vec4 value, float w) {
return value * w;
}
`;var Wd=`vec3 czm_XYZToRGB(vec3 Yxy)
{
const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,
-1.5371,  1.8760, -0.2040,
-0.4985,  0.0416,  1.0572);
vec3 xyz;
xyz.r = Yxy.r * Yxy.g / Yxy.b;
xyz.g = Yxy.r;
xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;
return XYZ2RGB * xyz;
}
`;var br={czm_degreesPerRadian:Af,czm_depthRange:xf,czm_epsilon1:wf,czm_epsilon2:Sf,czm_epsilon3:Rf,czm_epsilon4:Pf,czm_epsilon5:Of,czm_epsilon6:If,czm_epsilon7:Mf,czm_infinity:zf,czm_oneOverPi:Df,czm_oneOverTwoPi:Nf,czm_passCesium3DTile:Lf,czm_passCesium3DTileClassification:Ff,czm_passCesium3DTileClassificationIgnoreShow:Bf,czm_passClassification:Uf,czm_passCompute:Vf,czm_passEnvironment:kf,czm_passGlobe:Gf,czm_passOpaque:jf,czm_passOverlay:Hf,czm_passTerrainClassification:qf,czm_passTranslucent:Wf,czm_pi:Yf,czm_piOverFour:Xf,czm_piOverSix:$f,czm_piOverThree:Kf,czm_piOverTwo:Zf,czm_radiansPerDegree:Qf,czm_sceneMode2D:Jf,czm_sceneMode3D:el,czm_sceneModeColumbusView:tl,czm_sceneModeMorphing:nl,czm_solarRadius:ol,czm_threePiOver2:il,czm_twoPi:rl,czm_webMercatorMaxLatitude:sl,czm_depthRangeStruct:al,czm_material:cl,czm_materialInput:ul,czm_modelMaterial:fl,czm_modelVertexOutput:ll,czm_pbrParameters:dl,czm_ray:ml,czm_raySegment:hl,czm_shadowParameters:pl,czm_acesTonemapping:_l,czm_alphaWeight:yl,czm_antialias:gl,czm_approximateSphericalCoordinates:Cl,czm_backFacing:vl,czm_branchFreeTernary:El,czm_cascadeColor:Tl,czm_cascadeDistance:bl,czm_cascadeMatrix:Al,czm_cascadeWeights:xl,czm_columbusViewMorph:wl,czm_computePosition:Sl,czm_cosineAndSine:Rl,czm_decompressTextureCoordinates:Pl,czm_defaultPbrMaterial:Ol,czm_depthClamp:Il,czm_eastNorthUpToEyeCoordinates:Ml,czm_ellipsoidContainsPoint:zl,czm_ellipsoidWgs84TextureCoordinates:Dl,czm_equalsEpsilon:Nl,czm_eyeOffset:Ll,czm_eyeToWindowCoordinates:Fl,czm_fastApproximateAtan:Bl,czm_fog:Ul,czm_gammaCorrect:Vl,czm_geodeticSurfaceNormal:kl,czm_getDefaultMaterial:Gl,czm_getLambertDiffuse:jl,czm_getSpecular:Hl,czm_getWaterNoise:ql,czm_HSBToRGB:Wl,czm_HSLToRGB:Yl,czm_hue:Xl,czm_inverseGamma:$l,czm_isEmpty:Kl,czm_isFull:Zl,czm_latitudeToWebMercatorFraction:Ql,czm_linearToSrgb:Jl,czm_lineDistance:ed,czm_luminance:td,czm_metersPerPixel:nd,czm_modelToWindowCoordinates:od,czm_multiplyWithColorBalance:id,czm_nearFarScalar:rd,czm_octDecode:sd,czm_packDepth:ad,czm_pbrLighting:cd,czm_pbrMetallicRoughnessMaterial:ud,czm_pbrSpecularGlossinessMaterial:fd,czm_phong:ld,czm_planeDistance:dd,czm_pointAlongRay:md,czm_rayEllipsoidIntersectionInterval:hd,czm_raySphereIntersectionInterval:pd,czm_readDepth:_d,czm_readNonPerspective:yd,czm_reverseLogDepth:gd,czm_RGBToHSB:Cd,czm_RGBToHSL:vd,czm_RGBToXYZ:Ed,czm_rollerShutter:Td,czm_round:bd,czm_sampleOctahedralProjection:Ad,czm_saturation:xd,czm_shadowDepthCompare:wd,czm_shadowVisibility:Sd,czm_signNotZero:Rd,czm_sphericalHarmonics:Pd,czm_srgbToLinear:Od,czm_tangentToEyeSpaceMatrix:Id,czm_transformPlane:Md,czm_transformPlaneOld:zd,czm_translateRelativeToEye:Dd,czm_translucentPhong:Nd,czm_transpose:Ld,czm_unpackDepth:Fd,czm_unpackFloat:Bd,czm_unpackUint:Ud,czm_valueTransform:Vd,czm_vertexLogDepth:kd,czm_windowToEyeCoordinates:Gd,czm_writeDepthClamp:jd,czm_writeLogDepth:Hd,czm_writeNonPerspective:qd,czm_XYZToRGB:Wd};function Yd(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(t){let n=t.match(/\n/gm).length,o="";for(let i=0;i<n;++i)o+=`
`;return o})}function Xd(e,t,n){let o;for(let i=0;i<n.length;++i)n[i].name===e&&(o=n[i]);return f(o)||(t=Yd(t),o={name:e,glslSource:t,dependsOn:[],requiredBy:[],evaluated:!1},n.push(o)),o}function $d(e,t){if(e.evaluated)return;e.evaluated=!0;let n=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);f(n)&&n!==null&&(n=n.filter(function(o,i){return n.indexOf(o)===i}),n.forEach(function(o){if(o!==e.name&&ut._czmBuiltinsAndUniforms.hasOwnProperty(o)){let i=Xd(o,ut._czmBuiltinsAndUniforms[o],t);e.dependsOn.push(i),i.requiredBy.push(e),$d(i,t)}}))}function Fy(e){let t=[],n=[];for(;e.length>0;){let i=e.pop();n.push(i),i.requiredBy.length===0&&t.push(i)}for(;t.length>0;){let i=t.shift();e.push(i);for(let r=0;r<i.dependsOn.length;++r){let s=i.dependsOn[r],a=s.requiredBy.indexOf(i);s.requiredBy.splice(a,1),s.requiredBy.length===0&&t.push(s)}}let o=[];for(let i=0;i<n.length;++i)n[i].requiredBy.length!==0&&o.push(n[i])}function By(e){let t=[],n=Xd("main",e,t);$d(n,t),Fy(t);let o="";for(let i=t.length-1;i>=0;--i)o=`${o+t[i].glslSource}
`;return o.replace(n.glslSource,"")}function Kd(e,t,n){let o,i,r="",s=e.sources;if(f(s))for(o=0,i=s.length;o<i;++o)r+=`
#line 0
${s[o]}`;r=Yd(r);let a;r=r.replace(/#version\s+(.*?)\n/gm,function(_,g){return a=g,`
`});let c=[];r=r.replace(/#extension.*\n/gm,function(_){return c.push(_),`
`}),r=r.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let u=e.pickColorQualifier;f(u)&&(r=ut.createPickFragmentShaderSource(r,u));let d="";f(a)&&(d=`#version ${a}
`);let m=c.length;for(o=0;o<m;o++)d+=c[o];t&&(d+=`#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    precision highp int;
#else
    precision mediump float;
    precision mediump int;
    #define highp mediump
#endif

`);let p=e.defines;if(f(p))for(o=0,i=p.length;o<i;++o){let _=p[o];_.length!==0&&(d+=`#define ${_}
`)}return n.webgl2&&(d+=`#define OUTPUT_DECLARATION

`),n.textureFloatLinear&&(d+=`#define OES_texture_float_linear

`),n.floatingPointTexture&&(d+=`#define OES_texture_float

`),e.includeBuiltIns&&(d+=By(r)),d+=`
#line 0
`,d+=r,n.webgl2&&(d=bf(d,t,!0)),d}function ut(e){e=y(e,y.EMPTY_OBJECT);let t=e.pickColorQualifier;this.defines=f(e.defines)?e.defines.slice(0):[],this.sources=f(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=y(e.includeBuiltIns,!0)}ut.prototype.clone=function(){return new ut({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};ut.replaceMain=function(e,t){return t=`void ${t}()`,e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};ut.prototype.createCombinedVertexShader=function(e){return Kd(this,!1,e)};ut.prototype.createCombinedFragmentShader=function(e){return Kd(this,!0,e)};ut._czmBuiltinsAndUniforms={};for(let e in br)br.hasOwnProperty(e)&&(ut._czmBuiltinsAndUniforms[e]=br[e]);for(let e in Fo)if(Fo.hasOwnProperty(e)){let t=Fo[e];typeof t.getDeclaration=="function"&&(ut._czmBuiltinsAndUniforms[e]=t.getDeclaration(e))}ut.createPickVertexShaderSource=function(e){return`${ut.replaceMain(e,"czm_old_main")}
attribute vec4 pickColor; 
varying vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    czm_pickColor = pickColor; 
}`};ut.createPickFragmentShaderSource=function(e,t){let n=ut.replaceMain(e,"czm_old_main"),o=`${t} vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    if (gl_FragColor.a == 0.0) { 
       discard; 
    } 
    gl_FragColor = czm_pickColor; 
}`;return`${n}
${o}`};function Uy(e,t){let n=e.defines,o=n.length;for(let i=0;i<o;++i)if(n[i]===t)return!0;return!1}function Zd(e,t){let n=e.sources,o=n.length;for(let i=0;i<o;++i)if(n[i].indexOf(t)!==-1)return!0;return!1}function Qd(e,t){let n=t.length;for(let o=0;o<n;++o){let i=t[o];if(Zd(e,i))return i}}var Vy=["v_normalEC","v_normal"];ut.findNormalVarying=function(e){return Zd(e,"#ifdef HAS_NORMALS")?Uy(e,"HAS_NORMALS")?"v_normalEC":void 0:Qd(e,Vy)};var ky=["v_positionEC"];ut.findPositionVarying=function(e){return Qd(e,ky)};var co=ut;var rt={UNSIGNED_BYTE:w.UNSIGNED_BYTE,UNSIGNED_SHORT:w.UNSIGNED_SHORT,UNSIGNED_INT:w.UNSIGNED_INT};rt.getSizeInBytes=function(e){switch(e){case rt.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case rt.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case rt.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}};rt.fromSizeInBytes=function(e){switch(e){case 2:return rt.UNSIGNED_SHORT;case 4:return rt.UNSIGNED_INT;case 1:return rt.UNSIGNED_BYTE}};rt.validate=function(e){return f(e)&&(e===rt.UNSIGNED_BYTE||e===rt.UNSIGNED_SHORT||e===rt.UNSIGNED_INT)};rt.createTypedArray=function(e,t){return e>=O.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)};rt.createTypedArrayFromArrayBuffer=function(e,t,n,o){return e>=O.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,o):new Uint16Array(t,n,o)};rt.fromTypedArray=function(e){if(e instanceof Uint8Array)return rt.UNSIGNED_BYTE;if(e instanceof Uint16Array)return rt.UNSIGNED_SHORT;if(e instanceof Uint32Array)return rt.UNSIGNED_INT};var Qe=Object.freeze(rt);function Gy(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var Ar=Gy;function Gt(e){e=y(e,y.EMPTY_OBJECT);let t=e.context._gl,n=e.bufferTarget,o=e.typedArray,i=e.sizeInBytes,r=e.usage,s=f(o);s&&(i=o.byteLength);let a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,s?o:i,r),t.bindBuffer(n,null),this._id=Ar(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=i,this._usage=r,this._buffer=a,this.vertexArrayDestroyable=!0}Gt.createVertexBuffer=function(e){return new Gt({context:e.context,bufferTarget:w.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};Gt.createIndexBuffer=function(e){let t=e.context,n=e.indexDatatype,o=Qe.getSizeInBytes(n),i=new Gt({context:t,bufferTarget:w.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),r=i.sizeInBytes/o;return Object.defineProperties(i,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return o}},numberOfIndices:{get:function(){return r}}}),i};Object.defineProperties(Gt.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});Gt.prototype._getBuffer=function(){return this._buffer};Gt.prototype.copyFromArrayView=function(e,t){t=y(t,0);let n=this._gl,o=this._bufferTarget;n.bindBuffer(o,this._buffer),n.bufferSubData(o,t,e),n.bindBuffer(o,null)};Gt.prototype.copyFromBuffer=function(e,t,n,o){let i=w.COPY_READ_BUFFER,r=w.COPY_WRITE_BUFFER,s=this._gl;s.bindBuffer(r,this._buffer),s.bindBuffer(i,e._buffer),s.copyBufferSubData(i,r,t,n,o),s.bindBuffer(r,null),s.bindBuffer(i,null)};Gt.prototype.getBufferData=function(e,t,n,o){t=y(t,0),n=y(n,0);let i=this._gl,r=w.COPY_READ_BUFFER;i.bindBuffer(r,this._buffer),i.getBufferSubData(r,t,e,n,o),i.bindBuffer(r,null)};Gt.prototype.isDestroyed=function(){return!1};Gt.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),It(this)};var ci=Gt;function jy(e,t,n,o){let i=f(t.vertexBuffer),r=f(t.value),s=t.value?t.value.length:t.componentsPerAttribute,a={index:y(t.index,n),enabled:y(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:r?t.value.slice(0):void 0,componentsPerAttribute:s,componentDatatype:y(t.componentDatatype,re.FLOAT),normalize:y(t.normalize,!1),offsetInBytes:y(t.offsetInBytes,0),strideInBytes:y(t.strideInBytes,0),instanceDivisor:y(t.instanceDivisor,0)};if(i)a.vertexAttrib=function(c){let u=this.index;c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),c.vertexAttribPointer(u,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),c.enableVertexAttribArray(u),this.instanceDivisor>0&&(o.glVertexAttribDivisor(u,this.instanceDivisor),o._vertexAttribDivisors[u]=this.instanceDivisor,o._previousDrawInstanced=!0)},a.disableVertexAttribArray=function(c){c.disableVertexAttribArray(this.index),this.instanceDivisor>0&&o.glVertexAttribDivisor(n,0)};else{switch(a.componentsPerAttribute){case 1:a.vertexAttrib=function(c){c.vertexAttrib1fv(this.index,this.value)};break;case 2:a.vertexAttrib=function(c){c.vertexAttrib2fv(this.index,this.value)};break;case 3:a.vertexAttrib=function(c){c.vertexAttrib3fv(this.index,this.value)};break;case 4:a.vertexAttrib=function(c){c.vertexAttrib4fv(this.index,this.value)};break}a.disableVertexAttribArray=function(c){}}e.push(a)}function em(e,t,n){for(let o=0;o<t.length;++o){let i=t[o];i.enabled&&i.vertexAttrib(e)}f(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function Sn(e){e=y(e,y.EMPTY_OBJECT);let t=e.context,n=t._gl,o=e.attributes,i=e.indexBuffer,r,s=[],a=1,c=!1,u=!1,d=o.length;for(r=0;r<d;++r)jy(s,o[r],r,t);for(d=s.length,r=0;r<d;++r){let p=s[r];if(f(p.vertexBuffer)&&p.instanceDivisor===0){let _=p.strideInBytes||p.componentsPerAttribute*re.getSizeInBytes(p.componentDatatype);a=p.vertexBuffer.sizeInBytes/_;break}}for(r=0;r<d;++r)s[r].instanceDivisor>0&&(c=!0),f(s[r].value)&&(u=!0);let m;t.vertexArrayObject&&(m=t.glCreateVertexArray(),t.glBindVertexArray(m),em(n,s,i),t.glBindVertexArray(null)),this._numberOfVertices=a,this._hasInstancedAttributes=c,this._hasConstantAttributes=u,this._context=t,this._gl=n,this._vao=m,this._attributes=s,this._indexBuffer=i}function Jd(e){return e.values.length/e.componentsPerAttribute}function Hy(e){return re.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function qy(e){let t,n,o,i=[];for(n in e)e.hasOwnProperty(n)&&f(e[n])&&f(e[n].values)&&(i.push(n),e[n].componentDatatype===re.DOUBLE&&(e[n].componentDatatype=re.FLOAT,e[n].values=re.createTypedArray(re.FLOAT,e[n].values)));let r,s=i.length;if(s>0)for(r=Jd(e[i[0]]),t=1;t<s;++t){let u=Jd(e[i[t]]);if(u!==r)throw new je(`Each attribute list must have the same number of vertices.  Attribute ${i[t]} has a different number of vertices (${u.toString()}) than attribute ${i[0]} (${r.toString()}).`)}i.sort(function(u,d){return re.getSizeInBytes(e[d].componentDatatype)-re.getSizeInBytes(e[u].componentDatatype)});let a=0,c={};for(t=0;t<s;++t)n=i[t],o=e[n],c[n]=a,a+=Hy(o);if(a>0){let u=re.getSizeInBytes(e[i[0]].componentDatatype),d=a%u;d!==0&&(a+=u-d);let m=r*a,p=new ArrayBuffer(m),_={};for(t=0;t<s;++t){n=i[t];let g=re.getSizeInBytes(e[n].componentDatatype);_[n]={pointer:re.createTypedArray(e[n].componentDatatype,p),index:c[n]/g,strideInComponentType:a/g}}for(t=0;t<r;++t)for(let g=0;g<s;++g){n=i[g],o=e[n];let v=o.values,b=_[n],S=b.pointer,A=o.componentsPerAttribute;for(let x=0;x<A;++x)S[b.index+x]=v[t*A+x];b.index+=b.strideInComponentType}return{buffer:p,offsetsInBytes:c,vertexSizeInBytes:a}}}Sn.fromGeometry=function(e){e=y(e,y.EMPTY_OBJECT);let t=e.context,n=y(e.geometry,y.EMPTY_OBJECT),o=y(e.bufferUsage,vr.DYNAMIC_DRAW),i=y(e.attributeLocations,y.EMPTY_OBJECT),r=y(e.interleave,!1),s=e.vertexArrayAttributes,a,c,u,d=f(s)?s:[],m=n.attributes;if(r){let g=qy(m);if(f(g)){u=ci.createVertexBuffer({context:t,typedArray:g.buffer,usage:o});let v=g.offsetsInBytes,b=g.vertexSizeInBytes;for(a in m)m.hasOwnProperty(a)&&f(m[a])&&(c=m[a],f(c.values)?d.push({index:i[a],vertexBuffer:u,componentDatatype:c.componentDatatype,componentsPerAttribute:c.componentsPerAttribute,normalize:c.normalize,offsetInBytes:v[a],strideInBytes:b}):d.push({index:i[a],value:c.value,componentDatatype:c.componentDatatype,normalize:c.normalize}))}}else for(a in m)if(m.hasOwnProperty(a)&&f(m[a])){c=m[a];let g=c.componentDatatype;g===re.DOUBLE&&(g=re.FLOAT),u=void 0,f(c.values)&&(u=ci.createVertexBuffer({context:t,typedArray:re.createTypedArray(g,c.values),usage:o})),d.push({index:i[a],vertexBuffer:u,value:c.value,componentDatatype:g,componentsPerAttribute:c.componentsPerAttribute,normalize:c.normalize})}let p,_=n.indices;return f(_)&&(Fe.computeNumberOfVertices(n)>=O.SIXTY_FOUR_KILOBYTES&&t.elementIndexUint?p=ci.createIndexBuffer({context:t,typedArray:new Uint32Array(_),usage:o,indexDatatype:Qe.UNSIGNED_INT}):p=ci.createIndexBuffer({context:t,typedArray:new Uint16Array(_),usage:o,indexDatatype:Qe.UNSIGNED_SHORT})),new Sn({context:t,attributes:d,indexBuffer:p})};Object.defineProperties(Sn.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});Sn.prototype.getAttribute=function(e){return this._attributes[e]};function Wy(e){let t=e._context,n=e._hasInstancedAttributes;if(!n&&!t._previousDrawInstanced)return;t._previousDrawInstanced=n;let o=t._vertexAttribDivisors,i=e._attributes,r=Re.maximumVertexAttributes,s;if(n){let a=i.length;for(s=0;s<a;++s){let c=i[s];if(c.enabled){let u=c.instanceDivisor,d=c.index;u!==o[d]&&(t.glVertexAttribDivisor(d,u),o[d]=u)}}}else for(s=0;s<r;++s)o[s]>0&&(t.glVertexAttribDivisor(s,0),o[s]=0)}function Yy(e,t){let n=e._attributes,o=n.length;for(let i=0;i<o;++i){let r=n[i];r.enabled&&f(r.value)&&r.vertexAttrib(t)}}Sn.prototype._bind=function(){f(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&Wy(this),this._hasConstantAttributes&&Yy(this,this._gl)):em(this._gl,this._attributes,this._indexBuffer)};Sn.prototype._unBind=function(){if(f(this._vao))this._context.glBindVertexArray(null);else{let e=this._attributes,t=this._gl;for(let n=0;n<e.length;++n){let o=e[n];o.enabled&&o.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}};Sn.prototype.isDestroyed=function(){return!1};Sn.prototype.destroy=function(){let e=this._attributes;for(let n=0;n<e.length;++n){let o=e[n].vertexBuffer;f(o)&&!o.isDestroyed()&&o.vertexArrayDestroyable&&o.destroy()}let t=this._indexBuffer;return f(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),f(this._vao)&&this._context.glDeleteVertexArray(this._vao),It(this)};var tm=Sn;var ge={UNSIGNED_BYTE:w.UNSIGNED_BYTE,UNSIGNED_SHORT:w.UNSIGNED_SHORT,UNSIGNED_INT:w.UNSIGNED_INT,FLOAT:w.FLOAT,HALF_FLOAT:w.HALF_FLOAT_OES,UNSIGNED_INT_24_8:w.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:w.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:w.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:w.UNSIGNED_SHORT_5_6_5};ge.toWebGLConstant=function(e,t){switch(e){case ge.UNSIGNED_BYTE:return w.UNSIGNED_BYTE;case ge.UNSIGNED_SHORT:return w.UNSIGNED_SHORT;case ge.UNSIGNED_INT:return w.UNSIGNED_INT;case ge.FLOAT:return w.FLOAT;case ge.HALF_FLOAT:return t.webgl2?w.HALF_FLOAT:w.HALF_FLOAT_OES;case ge.UNSIGNED_INT_24_8:return w.UNSIGNED_INT_24_8;case ge.UNSIGNED_SHORT_4_4_4_4:return w.UNSIGNED_SHORT_4_4_4_4;case ge.UNSIGNED_SHORT_5_5_5_1:return w.UNSIGNED_SHORT_5_5_5_1;case ge.UNSIGNED_SHORT_5_6_5:return ge.UNSIGNED_SHORT_5_6_5}};ge.isPacked=function(e){return e===ge.UNSIGNED_INT_24_8||e===ge.UNSIGNED_SHORT_4_4_4_4||e===ge.UNSIGNED_SHORT_5_5_5_1||e===ge.UNSIGNED_SHORT_5_6_5};ge.sizeInBytes=function(e){switch(e){case ge.UNSIGNED_BYTE:return 1;case ge.UNSIGNED_SHORT:case ge.UNSIGNED_SHORT_4_4_4_4:case ge.UNSIGNED_SHORT_5_5_5_1:case ge.UNSIGNED_SHORT_5_6_5:case ge.HALF_FLOAT:return 2;case ge.UNSIGNED_INT:case ge.FLOAT:case ge.UNSIGNED_INT_24_8:return 4}};ge.validate=function(e){return e===ge.UNSIGNED_BYTE||e===ge.UNSIGNED_SHORT||e===ge.UNSIGNED_INT||e===ge.FLOAT||e===ge.HALF_FLOAT||e===ge.UNSIGNED_INT_24_8||e===ge.UNSIGNED_SHORT_4_4_4_4||e===ge.UNSIGNED_SHORT_5_5_5_1||e===ge.UNSIGNED_SHORT_5_6_5};var Ae=Object.freeze(ge);var Y={DEPTH_COMPONENT:w.DEPTH_COMPONENT,DEPTH_STENCIL:w.DEPTH_STENCIL,ALPHA:w.ALPHA,RGB:w.RGB,RGBA:w.RGBA,LUMINANCE:w.LUMINANCE,LUMINANCE_ALPHA:w.LUMINANCE_ALPHA,RGB_DXT1:w.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:w.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:w.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:w.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:w.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:w.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:w.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:w.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:w.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:w.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:w.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:w.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:w.COMPRESSED_RGBA_BPTC_UNORM};Y.componentsLength=function(e){switch(e){case Y.RGB:return 3;case Y.RGBA:return 4;case Y.LUMINANCE_ALPHA:return 2;case Y.ALPHA:case Y.LUMINANCE:return 1;default:return 1}};Y.validate=function(e){return e===Y.DEPTH_COMPONENT||e===Y.DEPTH_STENCIL||e===Y.ALPHA||e===Y.RGB||e===Y.RGBA||e===Y.LUMINANCE||e===Y.LUMINANCE_ALPHA||e===Y.RGB_DXT1||e===Y.RGBA_DXT1||e===Y.RGBA_DXT3||e===Y.RGBA_DXT5||e===Y.RGB_PVRTC_4BPPV1||e===Y.RGB_PVRTC_2BPPV1||e===Y.RGBA_PVRTC_4BPPV1||e===Y.RGBA_PVRTC_2BPPV1||e===Y.RGBA_ASTC||e===Y.RGB_ETC1||e===Y.RGB8_ETC2||e===Y.RGBA8_ETC2_EAC||e===Y.RGBA_BC7};Y.isColorFormat=function(e){return e===Y.ALPHA||e===Y.RGB||e===Y.RGBA||e===Y.LUMINANCE||e===Y.LUMINANCE_ALPHA};Y.isDepthFormat=function(e){return e===Y.DEPTH_COMPONENT||e===Y.DEPTH_STENCIL};Y.isCompressedFormat=function(e){return e===Y.RGB_DXT1||e===Y.RGBA_DXT1||e===Y.RGBA_DXT3||e===Y.RGBA_DXT5||e===Y.RGB_PVRTC_4BPPV1||e===Y.RGB_PVRTC_2BPPV1||e===Y.RGBA_PVRTC_4BPPV1||e===Y.RGBA_PVRTC_2BPPV1||e===Y.RGBA_ASTC||e===Y.RGB_ETC1||e===Y.RGB8_ETC2||e===Y.RGBA8_ETC2_EAC||e===Y.RGBA_BC7};Y.isDXTFormat=function(e){return e===Y.RGB_DXT1||e===Y.RGBA_DXT1||e===Y.RGBA_DXT3||e===Y.RGBA_DXT5};Y.isPVRTCFormat=function(e){return e===Y.RGB_PVRTC_4BPPV1||e===Y.RGB_PVRTC_2BPPV1||e===Y.RGBA_PVRTC_4BPPV1||e===Y.RGBA_PVRTC_2BPPV1};Y.isASTCFormat=function(e){return e===Y.RGBA_ASTC};Y.isETC1Format=function(e){return e===Y.RGB_ETC1};Y.isETC2Format=function(e){return e===Y.RGB8_ETC2||e===Y.RGBA8_ETC2_EAC};Y.isBC7Format=function(e){return e===Y.RGBA_BC7};Y.compressedTextureSizeInBytes=function(e,t,n){switch(e){case Y.RGB_DXT1:case Y.RGBA_DXT1:case Y.RGB_ETC1:case Y.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case Y.RGBA_DXT3:case Y.RGBA_DXT5:case Y.RGBA_ASTC:case Y.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case Y.RGB_PVRTC_4BPPV1:case Y.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case Y.RGB_PVRTC_2BPPV1:case Y.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);case Y.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(n/4)*16;default:return 0}};Y.textureSizeInBytes=function(e,t,n,o){let i=Y.componentsLength(e);return Ae.isPacked(t)&&(i=1),i*Ae.sizeInBytes(t)*n*o};Y.alignmentInBytes=function(e,t,n){let o=Y.textureSizeInBytes(e,t,n,1)%4;return o===0?4:o===2?2:1};Y.createTypedArray=function(e,t,n,o){let i,r=Ae.sizeInBytes(t);r===Uint8Array.BYTES_PER_ELEMENT?i=Uint8Array:r===Uint16Array.BYTES_PER_ELEMENT?i=Uint16Array:r===Float32Array.BYTES_PER_ELEMENT&&t===Ae.FLOAT?i=Float32Array:i=Uint32Array;let s=Y.componentsLength(e)*n*o;return new i(s)};Y.flipY=function(e,t,n,o,i){if(i===1)return e;let r=Y.createTypedArray(t,n,o,i),s=Y.componentsLength(t),a=o*s;for(let c=0;c<i;++c){let u=c*o*s,d=(i-c-1)*o*s;for(let m=0;m<a;++m)r[d+m]=e[u+m]}return r};Y.toInternalFormat=function(e,t,n){if(!n.webgl2)return e;if(e===Y.DEPTH_STENCIL)return w.DEPTH24_STENCIL8;if(e===Y.DEPTH_COMPONENT){if(t===Ae.UNSIGNED_SHORT)return w.DEPTH_COMPONENT16;if(t===Ae.UNSIGNED_INT)return w.DEPTH_COMPONENT24}if(t===Ae.FLOAT)switch(e){case Y.RGBA:return w.RGBA32F;case Y.RGB:return w.RGB32F;case Y.RG:return w.RG32F;case Y.R:return w.R32F}if(t===Ae.HALF_FLOAT)switch(e){case Y.RGBA:return w.RGBA16F;case Y.RGB:return w.RGB16F;case Y.RG:return w.RG16F;case Y.R:return w.R16F}return e};var ft=Object.freeze(Y);var xr={NEAREST:w.NEAREST,LINEAR:w.LINEAR};xr.validate=function(e){return e===xr.NEAREST||e===xr.LINEAR};var Bo=Object.freeze(xr);var kn={NEAREST:w.NEAREST,LINEAR:w.LINEAR,NEAREST_MIPMAP_NEAREST:w.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:w.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:w.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:w.LINEAR_MIPMAP_LINEAR};kn.validate=function(e){return e===kn.NEAREST||e===kn.LINEAR||e===kn.NEAREST_MIPMAP_NEAREST||e===kn.LINEAR_MIPMAP_NEAREST||e===kn.NEAREST_MIPMAP_LINEAR||e===kn.LINEAR_MIPMAP_LINEAR};var Kt=Object.freeze(kn);var wr={CLAMP_TO_EDGE:w.CLAMP_TO_EDGE,REPEAT:w.REPEAT,MIRRORED_REPEAT:w.MIRRORED_REPEAT,validate:function(e){return e===wr.CLAMP_TO_EDGE||e===wr.REPEAT||e===wr.MIRRORED_REPEAT}},ui=Object.freeze(wr);function fi(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.wrapS,ui.CLAMP_TO_EDGE),n=y(e.wrapT,ui.CLAMP_TO_EDGE),o=y(e.minificationFilter,Kt.LINEAR),i=y(e.magnificationFilter,Bo.LINEAR),r=f(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=t,this._wrapT=n,this._minificationFilter=o,this._magnificationFilter=i,this._maximumAnisotropy=r}Object.defineProperties(fi.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});fi.equals=function(e,t){return e===t||f(e)&&f(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy};fi.NEAREST=Object.freeze(new fi({wrapS:ui.CLAMP_TO_EDGE,wrapT:ui.CLAMP_TO_EDGE,minificationFilter:Kt.NEAREST,magnificationFilter:Bo.NEAREST}));var Sr=fi;var Rr={DONT_CARE:w.DONT_CARE,FASTEST:w.FASTEST,NICEST:w.NICEST,validate:function(e){return e===Rr.DONT_CARE||e===Rr.FASTEST||e===Rr.NICEST}},nm=Object.freeze(Rr);function Zt(e){e=y(e,y.EMPTY_OBJECT);let t=e.context,n=e.width,o=e.height,i=e.source;f(i)&&(f(n)||(n=y(i.videoWidth,i.width)),f(o)||(o=y(i.videoHeight,i.height)));let r=y(e.pixelFormat,ft.RGBA),s=y(e.pixelDatatype,Ae.UNSIGNED_BYTE),a=ft.toInternalFormat(r,s,t),c=ft.isCompressedFormat(a),u=e.preMultiplyAlpha||r===ft.RGB||r===ft.LUMINANCE,d=y(e.flipY,!0),m=y(e.skipColorSpaceConversion,!1),p=!0,_=t._gl,g=_.TEXTURE_2D,v=_.createTexture();_.activeTexture(_.TEXTURE0),_.bindTexture(g,v);let b=4;if(f(i)&&f(i.arrayBufferView)&&!c&&(b=ft.alignmentInBytes(r,s,n)),_.pixelStorei(_.UNPACK_ALIGNMENT,b),m?_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,_.NONE):_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,_.BROWSER_DEFAULT_WEBGL),f(i))if(f(i.arrayBufferView)){_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1);let A=i.arrayBufferView,x,P,z;if(c){if(_.compressedTexImage2D(g,0,a,n,o,0,A),f(i.mipLevels))for(P=n,z=o,x=0;x<i.mipLevels.length;++x)P=Math.floor(P/2)|0,P<1&&(P=1),z=Math.floor(z/2)|0,z<1&&(z=1),_.compressedTexImage2D(g,x+1,a,P,z,0,i.mipLevels[x])}else if(d&&(A=ft.flipY(A,r,s,n,o)),_.texImage2D(g,0,a,n,o,0,r,Ae.toWebGLConstant(s,t),A),f(i.mipLevels))for(P=n,z=o,x=0;x<i.mipLevels.length;++x)P=Math.floor(P/2)|0,P<1&&(P=1),z=Math.floor(z/2)|0,z<1&&(z=1),_.texImage2D(g,x+1,a,P,z,0,r,Ae.toWebGLConstant(s,t),i.mipLevels[x])}else f(i.framebuffer)?(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._bind(),_.copyTexImage2D(g,0,a,i.xOffset,i.yOffset,n,o,0),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._unBind()):(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,d),_.texImage2D(g,0,a,r,Ae.toWebGLConstant(s,t),i));else _.texImage2D(g,0,a,n,o,0,r,Ae.toWebGLConstant(s,t),null),p=!1;_.bindTexture(g,null);let S;c?S=ft.compressedTextureSizeInBytes(r,n,o):S=ft.textureSizeInBytes(r,s,n,o),this._id=Ar(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g,this._texture=v,this._internalFormat=a,this._pixelFormat=r,this._pixelDatatype=s,this._width=n,this._height=o,this._dimensions=new ne(n,o),this._hasMipmap=!1,this._sizeInBytes=S,this._preMultiplyAlpha=u,this._flipY=d,this._initialized=p,this._sampler=void 0,this.sampler=f(e.sampler)?e.sampler:new Sr}Zt.create=function(e){return new Zt(e)};Zt.fromFramebuffer=function(e){e=y(e,y.EMPTY_OBJECT);let t=e.context,n=t._gl,o=y(e.pixelFormat,ft.RGB),i=y(e.framebufferXOffset,0),r=y(e.framebufferYOffset,0),s=y(e.width,n.drawingBufferWidth),a=y(e.height,n.drawingBufferHeight),c=e.framebuffer;return new Zt({context:t,width:s,height:a,pixelFormat:o,source:{framebuffer:f(c)?c:t.defaultFramebuffer,xOffset:i,yOffset:r,width:s,height:a}})};Object.defineProperties(Zt.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,n=e.magnificationFilter,o=this._context,i=this._pixelFormat,r=this._pixelDatatype,s=t===Kt.NEAREST_MIPMAP_NEAREST||t===Kt.NEAREST_MIPMAP_LINEAR||t===Kt.LINEAR_MIPMAP_NEAREST||t===Kt.LINEAR_MIPMAP_LINEAR;(r===Ae.FLOAT&&!o.textureFloatLinear||r===Ae.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(t=s?Kt.NEAREST_MIPMAP_NEAREST:Kt.NEAREST,n=Bo.NEAREST),o.webgl2&&ft.isDepthFormat(i)&&(t=Kt.NEAREST,n=Bo.NEAREST);let a=o._gl,c=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(c,this._texture),a.texParameteri(c,a.TEXTURE_MIN_FILTER,t),a.texParameteri(c,a.TEXTURE_MAG_FILTER,n),a.texParameteri(c,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(c,a.TEXTURE_WRAP_T,e.wrapT),f(this._textureFilterAnisotropic)&&a.texParameteri(c,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(c,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});Zt.prototype.copyFrom=function(e){let t=y(e.xOffset,0),n=y(e.yOffset,0),o=e.source,i=this._context,r=i._gl,s=this._textureTarget;r.activeTexture(r.TEXTURE0),r.bindTexture(s,this._texture);let a=o.width,c=o.height,u=o.arrayBufferView,d=this._width,m=this._height,p=this._internalFormat,_=this._pixelFormat,g=this._pixelDatatype,v=this._preMultiplyAlpha,b=this._flipY,S=y(e.skipColorSpaceConversion,!1),A=4;f(u)&&(A=ft.alignmentInBytes(_,g,a)),r.pixelStorei(r.UNPACK_ALIGNMENT,A),S?r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE):r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.BROWSER_DEFAULT_WEBGL);let x=!1;if(!this._initialized){if(t===0&&n===0&&a===d&&c===m)f(u)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),b&&(u=ft.flipY(u,_,g,d,m)),r.texImage2D(s,0,p,d,m,0,_,Ae.toWebGLConstant(g,i),u)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,v),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,b),r.texImage2D(s,0,p,_,Ae.toWebGLConstant(g,i),o)),x=!0;else{r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let P=ft.createTypedArray(_,g,d,m);r.texImage2D(s,0,p,d,m,0,_,Ae.toWebGLConstant(g,i),P)}this._initialized=!0}x||(f(u)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),b&&(u=ft.flipY(u,_,g,a,c)),r.texSubImage2D(s,0,t,n,a,c,_,Ae.toWebGLConstant(g,i),u)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,v),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,b),r.texSubImage2D(s,0,t,n,_,Ae.toWebGLConstant(g,i),o))),r.bindTexture(s,null)};Zt.prototype.copyFromFramebuffer=function(e,t,n,o,i,r){e=y(e,0),t=y(t,0),n=y(n,0),o=y(o,0),i=y(i,this._width),r=y(r,this._height);let s=this._context._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture),s.copyTexSubImage2D(a,0,e,t,n,o,i,r),s.bindTexture(a,null),this._initialized=!0};Zt.prototype.generateMipmap=function(e){e=y(e,nm.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};Zt.prototype.isDestroyed=function(){return!1};Zt.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),It(this)};var om=Zt;function Rn(e,t,n){if(this._attributes=t,this._numberOfInstances=n,t.length===0)return;let o=Xy(t),i=e.floatingPointTexture,r=o===Ae.FLOAT&&!i,s=$y(t,r),a=Ky(s,t,r),c=Math.floor(Re.maximumTextureSize/a),u=Math.min(n,c),d=a*u,m=Math.ceil(n/u),p=1/d,_=p*.5,g=1/m,v=g*.5;this._textureDimensions=new ne(d,m),this._textureStep=new se(p,_,g,v),this._pixelDatatype=r?Ae.UNSIGNED_BYTE:o,this._packFloats=r,this._offsets=s,this._stride=a,this._texture=void 0;let b=4*d*m;this._batchValues=o===Ae.FLOAT&&!r?new Float32Array(b):new Uint8Array(b),this._batchValuesDirty=!1}Object.defineProperties(Rn.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function Xy(e){let t=!1,n=e.length;for(let o=0;o<n;++o)if(e[o].componentDatatype!==re.UNSIGNED_BYTE){t=!0;break}return t?Ae.FLOAT:Ae.UNSIGNED_BYTE}function rm(e,t){let n=e[t].componentsPerAttribute;return n===2?ne:n===3?l:n===4?se:Number}function $y(e,t){let n=new Array(e.length),o=0,i=e.length;for(let r=0;r<i;++r){let a=e[r].componentDatatype;n[r]=o,a!==re.UNSIGNED_BYTE&&t?o+=4:++o}return n}function Ky(e,t,n){let o=e.length,i=e[o-1];return t[o-1].componentDatatype!==re.UNSIGNED_BYTE&&n?i+4:i+1}var li=new se;function Zy(e,t,n){let o=se.unpack(e,t,li),i=se.unpackFloat(o);o=se.unpack(e,t+4,li);let r=se.unpackFloat(o);o=se.unpack(e,t+8,li);let s=se.unpackFloat(o);o=se.unpack(e,t+12,li);let a=se.unpackFloat(o);return se.fromElements(i,r,s,a,n)}function Qy(e,t,n){let o=se.packFloat(e.x,li);se.pack(o,t,n),o=se.packFloat(e.y,o),se.pack(o,t,n+4),o=se.packFloat(e.z,o),se.pack(o,t,n+8),o=se.packFloat(e.w,o),se.pack(o,t,n+12)}var im=new se;Rn.prototype.getBatchedAttribute=function(e,t,n){let o=this._attributes,i=this._offsets[t],r=this._stride,s=4*r*e+4*i,a;this._packFloats&&o[t].componentDatatype!==Ae.UNSIGNED_BYTE?a=Zy(this._batchValues,s,im):a=se.unpack(this._batchValues,s,im);let c=rm(o,t);return f(c.fromCartesian4)?c.fromCartesian4(a,n):f(c.clone)?c.clone(a,n):a.x};var Jy=[void 0,void 0,new ne,new l,new se],eg=new se;Rn.prototype.setBatchedAttribute=function(e,t,n){let o=this._attributes,i=Jy[o[t].componentsPerAttribute],r=this.getBatchedAttribute(e,t,i),s=rm(this._attributes,t);if(f(s.equals)?s.equals(r,n):r===n)return;let c=eg;c.x=f(n.x)?n.x:n,c.y=f(n.y)?n.y:0,c.z=f(n.z)?n.z:0,c.w=f(n.w)?n.w:0;let u=this._offsets[t],d=this._stride,m=4*d*e+4*u;this._packFloats&&o[t].componentDatatype!==Ae.UNSIGNED_BYTE?Qy(c,this._batchValues,m):se.pack(c,this._batchValues,m),this._batchValuesDirty=!0};function tg(e,t){let n=e._textureDimensions;e._texture=new om({context:t,pixelFormat:ft.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:Sr.NEAREST,flipY:!1})}function ng(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}Rn.prototype.update=function(e){f(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,f(this._texture)||tg(this,e.context),ng(this))};Rn.prototype.getUniformMapCallback=function(){let e=this;return function(t){return e._attributes.length===0?t:Ot(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}};function og(e){let t=e._stride;return e._textureDimensions.y===1?`uniform vec4 batchTextureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float numberOfAttributes = float(${t}); 
    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); 
} 
`:`uniform vec4 batchTextureStep; 
uniform vec2 batchTextureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float stepY = batchTextureStep.z; 
    float centerY = batchTextureStep.w; 
    float numberOfAttributes = float(${t}); 
    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); 
    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}function ig(e){return e===1?"float":`vec${e}`}function rg(e){return e===1?".x":e===2?".xy":e===3?".xyz":""}function sg(e,t){let o=e._attributes[t],i=o.componentsPerAttribute,r=o.functionName,s=ig(i),a=rg(i),c=e._offsets[t],u=`${s} ${r}(float batchId) 
{ 
    vec2 st = computeSt(batchId); 
    st.x += batchTextureStep.x * float(${c}); 
`;return e._packFloats&&o.componentDatatype!==Ae.UNSIGNED_BYTE?u+=`vec4 textureValue; 
textureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); 
textureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); 
textureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); 
textureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); 
`:u+=`    vec4 textureValue = texture2D(batchTexture, st); 
`,u+=`    ${s} value = textureValue${a}; 
`,e._pixelDatatype===Ae.UNSIGNED_BYTE&&o.componentDatatype===re.UNSIGNED_BYTE&&!o.normalize?u+=`value *= 255.0; 
`:e._pixelDatatype===Ae.FLOAT&&o.componentDatatype===re.UNSIGNED_BYTE&&o.normalize&&(u+=`value /= 255.0; 
`),u+=`    return value; 
} 
`,u}Rn.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(e.length===0)return function(o){return o};let t=`uniform highp sampler2D batchTexture; 
`;t+=`${og(this)}
`;let n=e.length;for(let o=0;o<n;++o)t+=sg(this,o);return function(o){let i=o.indexOf("void main"),r=o.substring(0,i),s=o.substring(i);return`${r}
${t}
${s}`}};Rn.prototype.isDestroyed=function(){return!1};Rn.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),It(this)};var sm=Rn;var ag={NEVER:w.NEVER,LESS:w.LESS,EQUAL:w.EQUAL,LESS_OR_EQUAL:w.LEQUAL,GREATER:w.GREATER,NOT_EQUAL:w.NOTEQUAL,GREATER_OR_EQUAL:w.GEQUAL,ALWAYS:w.ALWAYS},am=Object.freeze(ag);var xe={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};xe.getMathType=function(e){switch(e){case xe.SCALAR:return Number;case xe.VEC2:return ne;case xe.VEC3:return l;case xe.VEC4:return se;case xe.MAT2:return Mt;case xe.MAT3:return Z;case xe.MAT4:return X}};xe.getNumberOfComponents=function(e){switch(e){case xe.SCALAR:return 1;case xe.VEC2:return 2;case xe.VEC3:return 3;case xe.VEC4:case xe.MAT2:return 4;case xe.MAT3:return 9;case xe.MAT4:return 16}};xe.getAttributeLocationCount=function(e){switch(e){case xe.SCALAR:case xe.VEC2:case xe.VEC3:case xe.VEC4:return 1;case xe.MAT2:return 2;case xe.MAT3:return 3;case xe.MAT4:return 4}};xe.getGlslType=function(e){switch(e){case xe.SCALAR:return"float";case xe.VEC2:return"vec2";case xe.VEC3:return"vec3";case xe.VEC4:return"vec4";case xe.MAT2:return"mat2";case xe.MAT3:return"mat3";case xe.MAT4:return"mat4"}};var cm=Object.freeze(xe);var um=1/256,fm=256,Pe={};Pe.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let o=n.x,i=n.y;n.x=(1-Math.abs(i))*O.signNotZero(o),n.y=(1-Math.abs(o))*O.signNotZero(i)}return n.x=O.toSNorm(n.x,t),n.y=O.toSNorm(n.y,t),n};Pe.octEncode=function(e,t){return Pe.octEncodeInRange(e,255,t)};var di=new ne,lm=new Uint8Array(1);function Pr(e){return lm[0]=e,lm[0]}Pe.octEncodeToCartesian4=function(e,t){return Pe.octEncodeInRange(e,65535,di),t.x=Pr(di.x*um),t.y=Pr(di.x),t.z=Pr(di.y*um),t.w=Pr(di.y),t};Pe.octDecodeInRange=function(e,t,n,o){if(o.x=O.fromSNorm(e,n),o.y=O.fromSNorm(t,n),o.z=1-(Math.abs(o.x)+Math.abs(o.y)),o.z<0){let i=o.x;o.x=(1-Math.abs(o.y))*O.signNotZero(i),o.y=(1-Math.abs(i))*O.signNotZero(o.y)}return l.normalize(o,o)};Pe.octDecode=function(e,t,n){return Pe.octDecodeInRange(e,t,255,n)};Pe.octDecodeFromCartesian4=function(e,t){let n=e.x,o=e.y,i=e.z,r=e.w,s=n*fm+o,a=i*fm+r;return Pe.octDecodeInRange(s,a,65535,t)};Pe.octPackFloat=function(e){return 256*e.x+e.y};var pa=new ne;Pe.octEncodeFloat=function(e){return Pe.octEncode(e,pa),Pe.octPackFloat(pa)};Pe.octDecodeFloat=function(e,t){let n=e/256,o=Math.floor(n),i=(n-o)*256;return Pe.octDecode(o,i,t)};Pe.octPack=function(e,t,n,o){let i=Pe.octEncodeFloat(e),r=Pe.octEncodeFloat(t),s=Pe.octEncode(n,pa);return o.x=65536*s.x+i,o.y=65536*s.y+r,o};Pe.octUnpack=function(e,t,n,o){let i=e.x/65536,r=Math.floor(i),s=(i-r)*65536;i=e.y/65536;let a=Math.floor(i),c=(i-a)*65536;Pe.octDecodeFloat(s,t),Pe.octDecodeFloat(c,n),Pe.octDecode(r,a,o)};Pe.compressTextureCoordinates=function(e){let t=e.x*4095|0,n=e.y*4095|0;return 4096*t+n};Pe.decompressTextureCoordinates=function(e,t){let n=e/4096,o=Math.floor(n);return t.x=o/4095,t.y=(e-o*4096)/4095,t};function ha(e){return e>>1^-(e&1)}Pe.zigZagDeltaDecode=function(e,t,n){let o=e.length,i=0,r=0,s=0;for(let a=0;a<o;++a)i+=ha(e[a]),r+=ha(t[a]),e[a]=i,t[a]=r,f(n)&&(s+=ha(n[a]),n[a]=s)};Pe.dequantize=function(e,t,n,o){let i=cm.getNumberOfComponents(n),r;switch(t){case re.BYTE:r=127;break;case re.UNSIGNED_BYTE:r=255;break;case re.SHORT:r=32767;break;case re.UNSIGNED_SHORT:r=65535;break;case re.INT:r=2147483647;break;case re.UNSIGNED_INT:r=4294967295;break}let s=new Float32Array(o*i);for(let a=0;a<o;a++)for(let c=0;c<i;c++){let u=a*i+c;s[u]=Math.max(e[u]/r,-1)}return s};Pe.decodeRGB565=function(e,t){let n=e.length;f(t)||(t=new Float32Array(n*3));let o=(1<<5)-1,i=(1<<6)-1,r=1/31,s=1/63;for(let a=0;a<n;a++){let c=e[a],u=c>>11,d=c>>5&i,m=c&o,p=3*a;t[p]=u*r,t[p+1]=d*s,t[p+2]=m*r}return t};var uo=Pe;var dm=new l,mm=new l,hm=new l;function cg(e,t,n,o,i){f(i)||(i=new l);let r,s,a,c,u,d,m,p;if(f(t.z)){if(l.equalsEpsilon(e,t,O.EPSILON14))return l.clone(l.UNIT_X,i);if(l.equalsEpsilon(e,n,O.EPSILON14))return l.clone(l.UNIT_Y,i);if(l.equalsEpsilon(e,o,O.EPSILON14))return l.clone(l.UNIT_Z,i);r=l.subtract(n,t,dm),s=l.subtract(o,t,mm),a=l.subtract(e,t,hm),c=l.dot(r,r),u=l.dot(r,s),d=l.dot(r,a),m=l.dot(s,s),p=l.dot(s,a)}else{if(ne.equalsEpsilon(e,t,O.EPSILON14))return l.clone(l.UNIT_X,i);if(ne.equalsEpsilon(e,n,O.EPSILON14))return l.clone(l.UNIT_Y,i);if(ne.equalsEpsilon(e,o,O.EPSILON14))return l.clone(l.UNIT_Z,i);r=ne.subtract(n,t,dm),s=ne.subtract(o,t,mm),a=ne.subtract(e,t,hm),c=ne.dot(r,r),u=ne.dot(r,s),d=ne.dot(r,a),m=ne.dot(s,s),p=ne.dot(s,a)}i.y=m*d-u*p,i.z=c*p-u*d;let _=c*m-u*u;if(_!==0)return i.y/=_,i.z/=_,i.x=1-i.y-i.z,i}var pm=cg;var _a={};_a.computeDiscriminant=function(e,t,n){return t*t-4*e*n};function _m(e,t,n){let o=e+t;return O.sign(e)!==O.sign(t)&&Math.abs(o/Math.max(Math.abs(e),Math.abs(t)))<n?0:o}_a.computeRealRoots=function(e,t,n){let o;if(e===0)return t===0?[]:[-n/t];if(t===0){if(n===0)return[0,0];let c=Math.abs(n),u=Math.abs(e);if(c<u&&c/u<O.EPSILON14)return[0,0];if(c>u&&u/c<O.EPSILON14)return[];if(o=-n/e,o<0)return[];let d=Math.sqrt(o);return[-d,d]}else if(n===0)return o=-t/e,o<0?[o,0]:[0,o];let i=t*t,r=4*e*n,s=_m(i,-r,O.EPSILON14);if(s<0)return[];let a=-.5*_m(t,O.sign(t)*Math.sqrt(s),O.EPSILON14);return t>0?[a/e,n/a]:[n/a,a/e]};var jt=_a;var ga={};ga.computeDiscriminant=function(e,t,n,o){let i=e*e,r=t*t,s=n*n,a=o*o;return 18*e*t*n*o+r*s-27*i*a-4*(e*s*n+r*t*o)};function ya(e,t,n,o){let i=e,r=t/3,s=n/3,a=o,c=i*s,u=r*a,d=r*r,m=s*s,p=i*s-d,_=i*a-r*s,g=r*a-m,v=4*p*g-_*_,b,S;if(v<0){let de,he,Ce;d*u>=c*m?(de=i,he=p,Ce=-2*r*p+i*_):(de=a,he=g,Ce=-a*_+2*s*g);let Se=-(Ce<0?-1:1)*Math.abs(de)*Math.sqrt(-v);S=-Ce+Se;let Ie=S/2,Ne=Ie<0?-Math.pow(-Ie,1/3):Math.pow(Ie,1/3),Me=S===Se?-Ne:-he/Ne;return b=he<=0?Ne+Me:-Ce/(Ne*Ne+Me*Me+he),d*u>=c*m?[(b-r)/i]:[-a/(b+s)]}let A=p,x=-2*r*p+i*_,P=g,z=-a*_+2*s*g,L=Math.sqrt(v),B=Math.sqrt(3)/2,F=Math.abs(Math.atan2(i*L,-x)/3);b=2*Math.sqrt(-A);let N=Math.cos(F);S=b*N;let I=b*(-N/2-B*Math.sin(F)),U=S+I>2*r?S-r:I-r,h=i,C=U/h;F=Math.abs(Math.atan2(a*L,-z)/3),b=2*Math.sqrt(-P),N=Math.cos(F),S=b*N,I=b*(-N/2-B*Math.sin(F));let T=-a,R=S+I<2*s?S+s:I+s,D=T/R,k=h*R,M=-U*R-h*T,q=U*T,te=(s*M-r*q)/(-r*M+s*k);return C<=te?C<=D?te<=D?[C,te,D]:[C,D,te]:[D,C,te]:C<=D?[te,C,D]:te<=D?[te,D,C]:[D,te,C]}ga.computeRealRoots=function(e,t,n,o){let i,r;if(e===0)return jt.computeRealRoots(t,n,o);if(t===0){if(n===0){if(o===0)return[0,0,0];r=-o/e;let s=r<0?-Math.pow(-r,1/3):Math.pow(r,1/3);return[s,s,s]}else if(o===0)return i=jt.computeRealRoots(e,0,n),i.Length===0?[0]:[i[0],0,i[1]];return ya(e,0,n,o)}else{if(n===0)return o===0?(r=-t/e,r<0?[r,0,0]:[0,0,r]):ya(e,t,0,o);if(o===0)return i=jt.computeRealRoots(e,t,n),i.length===0?[0]:i[1]<=0?[i[0],i[1],0]:i[0]>=0?[0,i[0],i[1]]:[i[0],0,i[1]]}return ya(e,t,n,o)};var Or=ga;var Ca={};Ca.computeDiscriminant=function(e,t,n,o,i){let r=e*e,s=r*e,a=t*t,c=a*t,u=n*n,d=u*n,m=o*o,p=m*o,_=i*i,g=_*i;return a*u*m-4*c*p-4*e*d*m+18*e*t*n*p-27*r*m*m+256*s*g+i*(18*c*n*o-4*a*d+16*e*u*u-80*e*t*u*o-6*e*a*m+144*r*n*m)+_*(144*e*a*n-27*a*a-128*r*u-192*r*t*o)};function Qt(e,t,n,o){let i=e*e,r=t-3*i/8,s=n-t*e/2+i*e/8,a=o-n*e/4+t*i/16-3*i*i/256,c=Or.computeRealRoots(1,2*r,r*r-4*a,-s*s);if(c.length>0){let u=-e/4,d=c[c.length-1];if(Math.abs(d)<O.EPSILON14){let m=jt.computeRealRoots(1,r,a);if(m.length===2){let p=m[0],_=m[1],g;if(p>=0&&_>=0){let v=Math.sqrt(p),b=Math.sqrt(_);return[u-b,u-v,u+v,u+b]}else{if(p>=0&&_<0)return g=Math.sqrt(p),[u-g,u+g];if(p<0&&_>=0)return g=Math.sqrt(_),[u-g,u+g]}}return[]}else if(d>0){let m=Math.sqrt(d),p=(r+d-s/m)/2,_=(r+d+s/m)/2,g=jt.computeRealRoots(1,m,p),v=jt.computeRealRoots(1,-m,_);return g.length!==0?(g[0]+=u,g[1]+=u,v.length!==0?(v[0]+=u,v[1]+=u,g[1]<=v[0]?[g[0],g[1],v[0],v[1]]:v[1]<=g[0]?[v[0],v[1],g[0],g[1]]:g[0]>=v[0]&&g[1]<=v[1]?[v[0],g[0],g[1],v[1]]:v[0]>=g[0]&&v[1]<=g[1]?[g[0],v[0],v[1],g[1]]:g[0]>v[0]&&g[0]<v[1]?[v[0],g[0],v[1],g[1]]:[g[0],v[0],g[1],v[1]]):g):v.length!==0?(v[0]+=u,v[1]+=u,v):[]}}return[]}function mi(e,t,n,o){let i=n*n,r=t*t,s=e*e,a=-2*t,c=n*e+r-4*o,u=s*o-n*t*e+i,d=Or.computeRealRoots(1,a,c,u);if(d.length>0){let m=d[0],p=t-m,_=p*p,g=e/2,v=p/2,b=_-4*o,S=_+4*Math.abs(o),A=s-4*m,x=s+4*Math.abs(m),P,z;if(m<0||b*x<A*S){let h=Math.sqrt(A);P=h/2,z=h===0?0:(e*v-n)/h}else{let h=Math.sqrt(b);P=h===0?0:(e*v-n)/h,z=h/2}let L,B;g===0&&P===0?(L=0,B=0):O.sign(g)===O.sign(P)?(L=g+P,B=m/L):(B=g-P,L=m/B);let F,N;v===0&&z===0?(F=0,N=0):O.sign(v)===O.sign(z)?(F=v+z,N=o/F):(N=v-z,F=o/N);let I=jt.computeRealRoots(1,L,F),U=jt.computeRealRoots(1,B,N);if(I.length!==0)return U.length!==0?I[1]<=U[0]?[I[0],I[1],U[0],U[1]]:U[1]<=I[0]?[U[0],U[1],I[0],I[1]]:I[0]>=U[0]&&I[1]<=U[1]?[U[0],I[0],I[1],U[1]]:U[0]>=I[0]&&U[1]<=I[1]?[I[0],U[0],U[1],I[1]]:I[0]>U[0]&&I[0]<U[1]?[U[0],I[0],U[1],I[1]]:[I[0],U[0],I[1],U[1]]:I;if(U.length!==0)return U}return[]}Ca.computeRealRoots=function(e,t,n,o,i){if(Math.abs(e)<O.EPSILON15)return Or.computeRealRoots(t,n,o,i);let r=t/e,s=n/e,a=o/e,c=i/e,u=r<0?1:0;switch(u+=s<0?u+1:u,u+=a<0?u+1:u,u+=c<0?u+1:u,u){case 0:return Qt(r,s,a,c);case 1:return mi(r,s,a,c);case 2:return mi(r,s,a,c);case 3:return Qt(r,s,a,c);case 4:return Qt(r,s,a,c);case 5:return mi(r,s,a,c);case 6:return Qt(r,s,a,c);case 7:return Qt(r,s,a,c);case 8:return mi(r,s,a,c);case 9:return Qt(r,s,a,c);case 10:return Qt(r,s,a,c);case 11:return mi(r,s,a,c);case 12:return Qt(r,s,a,c);case 13:return Qt(r,s,a,c);case 14:return Qt(r,s,a,c);case 15:return Qt(r,s,a,c);default:return}};var ym=Ca;function Ir(e,t){t=l.clone(y(t,l.ZERO)),l.equals(t,l.ZERO)||l.normalize(t,t),this.origin=l.clone(y(e,l.ZERO)),this.direction=t}Ir.clone=function(e,t){if(!!f(e))return f(t)?(t.origin=l.clone(e.origin),t.direction=l.clone(e.direction),t):new Ir(e.origin,e.direction)};Ir.getPoint=function(e,t,n){return f(n)||(n=new l),n=l.multiplyByScalar(e.direction,t,n),l.add(e.origin,n,n)};var va=Ir;var Ve={};Ve.rayPlane=function(e,t,n){f(n)||(n=new l);let o=e.origin,i=e.direction,r=t.normal,s=l.dot(r,i);if(Math.abs(s)<O.EPSILON15)return;let a=(-t.distance-l.dot(r,o))/s;if(!(a<0))return n=l.multiplyByScalar(i,a,n),l.add(o,n,n)};var ug=new l,fg=new l,xm=new l,gm=new l,Cm=new l;Ve.rayTriangleParametric=function(e,t,n,o,i){i=y(i,!1);let r=e.origin,s=e.direction,a=l.subtract(n,t,ug),c=l.subtract(o,t,fg),u=l.cross(s,c,xm),d=l.dot(a,u),m,p,_,g,v;if(i){if(d<O.EPSILON6||(m=l.subtract(r,t,gm),_=l.dot(m,u),_<0||_>d)||(p=l.cross(m,a,Cm),g=l.dot(s,p),g<0||_+g>d))return;v=l.dot(c,p)/d}else{if(Math.abs(d)<O.EPSILON6)return;let b=1/d;if(m=l.subtract(r,t,gm),_=l.dot(m,u)*b,_<0||_>1||(p=l.cross(m,a,Cm),g=l.dot(s,p)*b,g<0||_+g>1))return;v=l.dot(c,p)*b}return v};Ve.rayTriangle=function(e,t,n,o,i,r){let s=Ve.rayTriangleParametric(e,t,n,o,i);if(!(!f(s)||s<0))return f(r)||(r=new l),l.multiplyByScalar(e.direction,s,r),l.add(e.origin,r,r)};var lg=new va;Ve.lineSegmentTriangle=function(e,t,n,o,i,r,s){let a=lg;l.clone(e,a.origin),l.subtract(t,e,a.direction),l.normalize(a.direction,a.direction);let c=Ve.rayTriangleParametric(a,n,o,i,r);if(!(!f(c)||c<0||c>l.distance(e,t)))return f(s)||(s=new l),l.multiplyByScalar(a.direction,c,s),l.add(a.origin,s,s)};function dg(e,t,n,o){let i=t*t-4*e*n;if(i<0)return;if(i>0){let s=1/(2*e),a=Math.sqrt(i),c=(-t+a)*s,u=(-t-a)*s;return c<u?(o.root0=c,o.root1=u):(o.root0=u,o.root1=c),o}let r=-t/(2*e);if(r!==0)return o.root0=o.root1=r,o}var mg={root0:0,root1:0};function wm(e,t,n){f(n)||(n=new Nn);let o=e.origin,i=e.direction,r=t.center,s=t.radius*t.radius,a=l.subtract(o,r,xm),c=l.dot(i,i),u=2*l.dot(i,a),d=l.magnitudeSquared(a)-s,m=dg(c,u,d,mg);if(!!f(m))return n.start=m.root0,n.stop=m.root1,n}Ve.raySphere=function(e,t,n){if(n=wm(e,t,n),!(!f(n)||n.stop<0))return n.start=Math.max(n.start,0),n};var hg=new va;Ve.lineSegmentSphere=function(e,t,n,o){let i=hg;l.clone(e,i.origin);let r=l.subtract(t,e,i.direction),s=l.magnitude(r);if(l.normalize(r,r),o=wm(i,n,o),!(!f(o)||o.stop<0||o.start>s))return o.start=Math.max(o.start,0),o.stop=Math.min(o.stop,s),o};var pg=new l,_g=new l;Ve.rayEllipsoid=function(e,t){let n=t.oneOverRadii,o=l.multiplyComponents(n,e.origin,pg),i=l.multiplyComponents(n,e.direction,_g),r=l.magnitudeSquared(o),s=l.dot(o,i),a,c,u,d,m;if(r>1){if(s>=0)return;let p=s*s;if(a=r-1,c=l.magnitudeSquared(i),u=c*a,p<u)return;if(p>u){d=s*s-u,m=-s+Math.sqrt(d);let g=m/c,v=a/m;return g<v?new Nn(g,v):{start:v,stop:g}}let _=Math.sqrt(a/c);return new Nn(_,_)}else if(r<1)return a=r-1,c=l.magnitudeSquared(i),u=c*a,d=s*s-u,m=-s+Math.sqrt(d),new Nn(0,m/c);if(s<0)return c=l.magnitudeSquared(i),new Nn(0,-s/c)};function fo(e,t,n){let o=e+t;return O.sign(e)!==O.sign(t)&&Math.abs(o/Math.max(Math.abs(e),Math.abs(t)))<n?0:o}function yg(e,t,n,o,i){let r=o*o,s=i*i,a=(e[Z.COLUMN1ROW1]-e[Z.COLUMN2ROW2])*s,c=i*(o*fo(e[Z.COLUMN1ROW0],e[Z.COLUMN0ROW1],O.EPSILON15)+t.y),u=e[Z.COLUMN0ROW0]*r+e[Z.COLUMN2ROW2]*s+o*t.x+n,d=s*fo(e[Z.COLUMN2ROW1],e[Z.COLUMN1ROW2],O.EPSILON15),m=i*(o*fo(e[Z.COLUMN2ROW0],e[Z.COLUMN0ROW2])+t.z),p,_=[];if(m===0&&d===0){if(p=jt.computeRealRoots(a,c,u),p.length===0)return _;let F=p[0],N=Math.sqrt(Math.max(1-F*F,0));if(_.push(new l(o,i*F,i*-N)),_.push(new l(o,i*F,i*N)),p.length===2){let I=p[1],U=Math.sqrt(Math.max(1-I*I,0));_.push(new l(o,i*I,i*-U)),_.push(new l(o,i*I,i*U))}return _}let g=m*m,v=d*d,b=a*a,S=m*d,A=b+v,x=2*(c*a+S),P=2*u*a+c*c-v+g,z=2*(u*c-S),L=u*u-g;if(A===0&&x===0&&P===0&&z===0)return _;p=ym.computeRealRoots(A,x,P,z,L);let B=p.length;if(B===0)return _;for(let F=0;F<B;++F){let N=p[F],I=N*N,U=Math.max(1-I,0),h=Math.sqrt(U),C;O.sign(a)===O.sign(u)?C=fo(a*I+u,c*N,O.EPSILON12):O.sign(u)===O.sign(c*N)?C=fo(a*I,c*N+u,O.EPSILON12):C=fo(a*I+c*N,u,O.EPSILON12);let T=fo(d*N,m,O.EPSILON15),R=C*T;R<0?_.push(new l(o,i*N,i*h)):R>0?_.push(new l(o,i*N,i*-h)):h!==0?(_.push(new l(o,i*N,i*-h)),_.push(new l(o,i*N,i*h)),++F):_.push(new l(o,i*N,i*h))}return _}var Ea=new l,vm=new l,Em=new l,Mr=new l,gg=new l,Cg=new Z,vg=new Z,Eg=new Z,Tg=new Z,bg=new Z,Tm=new Z,bm=new Z,Am=new l,Ag=new l,xg=new ve;Ve.grazingAltitudeLocation=function(e,t){let n=e.origin,o=e.direction;if(!l.equals(n,l.ZERO)){let L=t.geodeticSurfaceNormal(n,Ea);if(l.dot(o,L)>=0)return n}let i=f(this.rayEllipsoid(e,t)),r=t.transformPositionToScaledSpace(o,Ea),s=l.normalize(r,r),a=l.mostOrthogonalAxis(r,Mr),c=l.normalize(l.cross(a,s,vm),vm),u=l.normalize(l.cross(s,c,Em),Em),d=Cg;d[0]=s.x,d[1]=s.y,d[2]=s.z,d[3]=c.x,d[4]=c.y,d[5]=c.z,d[6]=u.x,d[7]=u.y,d[8]=u.z;let m=Z.transpose(d,vg),p=Z.fromScale(t.radii,Eg),_=Z.fromScale(t.oneOverRadii,Tg),g=bg;g[0]=0,g[1]=-o.z,g[2]=o.y,g[3]=o.z,g[4]=0,g[5]=-o.x,g[6]=-o.y,g[7]=o.x,g[8]=0;let v=Z.multiply(Z.multiply(m,_,Tm),g,Tm),b=Z.multiply(Z.multiply(v,p,bm),d,bm),S=Z.multiplyByVector(v,n,gg),A=yg(b,l.negate(S,Ea),0,0,1),x,P,z=A.length;if(z>0){let L=l.clone(l.ZERO,Ag),B=Number.NEGATIVE_INFINITY;for(let N=0;N<z;++N){x=Z.multiplyByVector(p,Z.multiplyByVector(d,A[N],Am),Am);let I=l.normalize(l.subtract(x,n,Mr),Mr),U=l.dot(I,o);U>B&&(B=U,L=l.clone(x,L))}let F=t.cartesianToCartographic(L,xg);return B=O.clamp(B,0,1),P=l.magnitude(l.subtract(L,n,Mr))*Math.sqrt(1-B*B),P=i?-P:P,F.height=P,t.cartographicToCartesian(F,new l)}};var wg=new l;Ve.lineSegmentPlane=function(e,t,n,o){f(o)||(o=new l);let i=l.subtract(t,e,wg),r=n.normal,s=l.dot(r,i);if(Math.abs(s)<O.EPSILON6)return;let a=l.dot(r,e),c=-(n.distance+a)/s;if(!(c<0||c>1))return l.multiplyByScalar(i,c,o),l.add(e,o,o),o};Ve.trianglePlaneIntersection=function(e,t,n,o){let i=o.normal,r=o.distance,s=l.dot(i,e)+r<0,a=l.dot(i,t)+r<0,c=l.dot(i,n)+r<0,u=0;u+=s?1:0,u+=a?1:0,u+=c?1:0;let d,m;if((u===1||u===2)&&(d=new l,m=new l),u===1){if(s)return Ve.lineSegmentPlane(e,t,o,d),Ve.lineSegmentPlane(e,n,o,m),{positions:[e,t,n,d,m],indices:[0,3,4,1,2,4,1,4,3]};if(a)return Ve.lineSegmentPlane(t,n,o,d),Ve.lineSegmentPlane(t,e,o,m),{positions:[e,t,n,d,m],indices:[1,3,4,2,0,4,2,4,3]};if(c)return Ve.lineSegmentPlane(n,e,o,d),Ve.lineSegmentPlane(n,t,o,m),{positions:[e,t,n,d,m],indices:[2,3,4,0,1,4,0,4,3]}}else if(u===2)if(s)if(a){if(!c)return Ve.lineSegmentPlane(e,n,o,d),Ve.lineSegmentPlane(t,n,o,m),{positions:[e,t,n,d,m],indices:[0,1,4,0,4,3,2,3,4]}}else return Ve.lineSegmentPlane(n,t,o,d),Ve.lineSegmentPlane(e,t,o,m),{positions:[e,t,n,d,m],indices:[2,0,4,2,4,3,1,3,4]};else return Ve.lineSegmentPlane(t,e,o,d),Ve.lineSegmentPlane(n,e,o,m),{positions:[e,t,n,d,m],indices:[1,2,4,1,4,3,0,3,4]}};var Ta=Ve;var ba={};ba.calculateACMR=function(e){e=y(e,y.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,o=y(e.cacheSize,24),i=t.length;if(!f(n)){n=0;let a=0,c=t[a];for(;a<i;)c>n&&(n=c),++a,c=t[a]}let r=[];for(let a=0;a<n+1;a++)r[a]=0;let s=o+1;for(let a=0;a<i;++a)s-r[t[a]]>o&&(r[t[a]]=s,++s);return(s-o+1)/(i/3)};ba.tipsify=function(e){e=y(e,y.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,o=y(e.cacheSize,24),i;function r(U,h,C,T){for(;h.length>=1;){let R=h[h.length-1];if(h.splice(h.length-1,1),U[R].numLiveTriangles>0)return R}for(;i<T;){if(U[i].numLiveTriangles>0)return++i,i-1;++i}return-1}function s(U,h,C,T,R,D,k){let M=-1,q,te=-1,de=0;for(;de<C.length;){let he=C[de];T[he].numLiveTriangles&&(q=0,R-T[he].timeStamp+2*T[he].numLiveTriangles<=h&&(q=R-T[he].timeStamp),(q>te||te===-1)&&(te=q,M=he)),++de}return M===-1?r(T,D,U,k):M}let a=t.length,c=0,u=0,d=t[u],m=a;if(f(n))c=n+1;else{for(;u<m;)d>c&&(c=d),++u,d=t[u];if(c===-1)return 0;++c}let p=[],_;for(_=0;_<c;_++)p[_]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};u=0;let g=0;for(;u<m;)p[t[u]].vertexTriangles.push(g),++p[t[u]].numLiveTriangles,p[t[u+1]].vertexTriangles.push(g),++p[t[u+1]].numLiveTriangles,p[t[u+2]].vertexTriangles.push(g),++p[t[u+2]].numLiveTriangles,++g,u+=3;let v=0,b=o+1;i=1;let S=[],A=[],x,P,z=0,L=[],B=a/3,F=[];for(_=0;_<B;_++)F[_]=!1;let N,I;for(;v!==-1;){S=[],P=p[v],I=P.vertexTriangles.length;for(let U=0;U<I;++U)if(g=P.vertexTriangles[U],!F[g]){F[g]=!0,u=g+g+g;for(let h=0;h<3;++h)N=t[u],S.push(N),A.push(N),L[z]=N,++z,x=p[N],--x.numLiveTriangles,b-x.timeStamp>o&&(x.timeStamp=b,++b),++u}v=s(t,o,S,p,b,A,c)}return L};var Sm=ba;var wt={};function Ur(e,t,n,o,i){e[t++]=n,e[t++]=o,e[t++]=o,e[t++]=i,e[t++]=i,e[t]=n}function Sg(e){let t=e.length,n=t/3*6,o=Qe.createTypedArray(t,n),i=0;for(let r=0;r<t;r+=3,i+=6)Ur(o,i,e[r],e[r+1],e[r+2]);return o}function Rg(e){let t=e.length;if(t>=3){let n=(t-2)*6,o=Qe.createTypedArray(t,n);Ur(o,0,e[0],e[1],e[2]);let i=6;for(let r=3;r<t;++r,i+=6)Ur(o,i,e[r-1],e[r],e[r-2]);return o}return new Uint16Array}function Pg(e){if(e.length>0){let t=e.length-1,n=(t-1)*6,o=Qe.createTypedArray(t,n),i=e[0],r=0;for(let s=1;s<t;++s,r+=6)Ur(o,r,i,e[s],e[s+1]);return o}return new Uint16Array}wt.toWireframe=function(e){let t=e.indices;if(f(t)){switch(e.primitiveType){case Oe.TRIANGLES:e.indices=Sg(t);break;case Oe.TRIANGLE_STRIP:e.indices=Rg(t);break;case Oe.TRIANGLE_FAN:e.indices=Pg(t);break}e.primitiveType=Oe.LINES}return e};wt.createLineSegmentsForVectors=function(e,t,n){t=y(t,"normal"),n=y(n,1e4);let o=e.attributes.position.values,i=e.attributes[t].values,r=o.length,s=new Float64Array(2*r),a=0;for(let d=0;d<r;d+=3)s[a++]=o[d],s[a++]=o[d+1],s[a++]=o[d+2],s[a++]=o[d]+i[d]*n,s[a++]=o[d+1]+i[d+1]*n,s[a++]=o[d+2]+i[d+2]*n;let c,u=e.boundingSphere;return f(u)&&(c=new le(u.center,u.radius+n)),new Fe({attributes:{position:new Ue({componentDatatype:re.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:Oe.LINES,boundingSphere:c})};wt.createAttributeLocations=function(e){let t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,o={},i=0,r,s=t.length;for(r=0;r<s;++r){let a=t[r];f(n[a])&&(o[a]=i++)}for(let a in n)n.hasOwnProperty(a)&&!f(o[a])&&(o[a]=i++);return o};wt.reorderForPreVertexCache=function(e){let t=Fe.computeNumberOfVertices(e),n=e.indices;if(f(n)){let o=new Int32Array(t);for(let p=0;p<t;p++)o[p]=-1;let i=n,r=i.length,s=Qe.createTypedArray(t,r),a=0,c=0,u=0,d;for(;a<r;)d=o[i[a]],d!==-1?s[c]=d:(d=i[a],o[d]=u,s[c]=u,++u),++a,++c;e.indices=s;let m=e.attributes;for(let p in m)if(m.hasOwnProperty(p)&&f(m[p])&&f(m[p].values)){let _=m[p],g=_.values,v=0,b=_.componentsPerAttribute,S=re.createTypedArray(_.componentDatatype,u*b);for(;v<t;){let A=o[v];if(A!==-1)for(let x=0;x<b;x++)S[b*A+x]=g[b*v+x];++v}_.values=S}}return e};wt.reorderForPostVertexCache=function(e,t){let n=e.indices;if(e.primitiveType===Oe.TRIANGLES&&f(n)){let o=n.length,i=0;for(let r=0;r<o;r++)n[r]>i&&(i=n[r]);e.indices=Sm.tipsify({indices:n,maximumIndex:i,cacheSize:t})}return e};function Rm(e){let t={};for(let n in e)if(e.hasOwnProperty(n)&&f(e[n])&&f(e[n].values)){let o=e[n];t[n]=new Ue({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return t}function Og(e,t,n){for(let o in t)if(t.hasOwnProperty(o)&&f(t[o])&&f(t[o].values)){let i=t[o];for(let r=0;r<i.componentsPerAttribute;++r)e[o].values.push(i.values[n*i.componentsPerAttribute+r])}}wt.fitToUnsignedShortIndices=function(e){let t=[],n=Fe.computeNumberOfVertices(e);if(f(e.indices)&&n>=O.SIXTY_FOUR_KILOBYTES){let o=[],i=[],r=0,s=Rm(e.attributes),a=e.indices,c=a.length,u;e.primitiveType===Oe.TRIANGLES?u=3:e.primitiveType===Oe.LINES?u=2:e.primitiveType===Oe.POINTS&&(u=1);for(let d=0;d<c;d+=u){for(let m=0;m<u;++m){let p=a[d+m],_=o[p];f(_)||(_=r++,o[p]=_,Og(s,e.attributes,p)),i.push(_)}r+u>=O.SIXTY_FOUR_KILOBYTES&&(t.push(new Fe({attributes:s,indices:i,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),o=[],i=[],r=0,s=Rm(e.attributes))}i.length!==0&&t.push(new Fe({attributes:s,indices:i,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var Pm=new l,Ig=new ve;wt.projectTo2D=function(e,t,n,o,i){let r=e.attributes[t];i=f(i)?i:new nn;let s=i.ellipsoid,a=r.values,c=new Float64Array(a.length),u=0;for(let d=0;d<a.length;d+=3){let m=l.fromArray(a,d,Pm),p=s.cartesianToCartographic(m,Ig),_=i.project(p,Pm);c[u++]=_.x,c[u++]=_.y,c[u++]=_.z}return e.attributes[n]=r,e.attributes[o]=new Ue({componentDatatype:re.DOUBLE,componentsPerAttribute:3,values:c}),delete e.attributes[t],e};var Aa={high:0,low:0};wt.encodeAttribute=function(e,t,n,o){let i=e.attributes[t],r=i.values,s=r.length,a=new Float32Array(s),c=new Float32Array(s);for(let d=0;d<s;++d)xo.encode(r[d],Aa),a[d]=Aa.high,c[d]=Aa.low;let u=i.componentsPerAttribute;return e.attributes[n]=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:u,values:a}),e.attributes[o]=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:u,values:c}),delete e.attributes[t],e};var en=new l;function xa(e,t){if(f(t)){let n=t.values,o=n.length;for(let i=0;i<o;i+=3)l.unpack(n,i,en),X.multiplyByPoint(e,en,en),l.pack(en,n,i)}}function wa(e,t){if(f(t)){let n=t.values,o=n.length;for(let i=0;i<o;i+=3)l.unpack(n,i,en),Z.multiplyByVector(e,en,en),en=l.normalize(en,en),l.pack(en,n,i)}}var zr=new X,Dr=new Z;wt.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(X.equals(t,X.IDENTITY))return e;let n=e.geometry.attributes;xa(t,n.position),xa(t,n.prevPosition),xa(t,n.nextPosition),(f(n.normal)||f(n.tangent)||f(n.bitangent))&&(X.inverse(t,zr),X.transpose(zr,zr),X.getMatrix3(zr,Dr),wa(Dr,n.normal),wa(Dr,n.tangent),wa(Dr,n.bitangent));let o=e.geometry.boundingSphere;return f(o)&&(e.geometry.boundingSphere=le.transform(o,t,o)),e.modelMatrix=X.clone(X.IDENTITY),e};function Mg(e,t){let n=e.length,o={},i=e[0][t].attributes,r;for(r in i)if(i.hasOwnProperty(r)&&f(i[r])&&f(i[r].values)){let s=i[r],a=s.values.length,c=!0;for(let u=1;u<n;++u){let d=e[u][t].attributes[r];if(!f(d)||s.componentDatatype!==d.componentDatatype||s.componentsPerAttribute!==d.componentsPerAttribute||s.normalize!==d.normalize){c=!1;break}a+=d.values.length}c&&(o[r]=new Ue({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:re.createTypedArray(s.componentDatatype,a)}))}return o}var zg=new l;function Sa(e,t){let n=e.length,o,i,r,s,a=e[0].modelMatrix,c=f(e[0][t].indices),u=e[0][t].primitiveType,d=Mg(e,t),m,p,_;for(o in d)if(d.hasOwnProperty(o))for(m=d[o].values,s=0,i=0;i<n;++i)for(p=e[i][t].attributes[o].values,_=p.length,r=0;r<_;++r)m[s++]=p[r];let g;if(c){let A=0;for(i=0;i<n;++i)A+=e[i][t].indices.length;let x=Fe.computeNumberOfVertices(new Fe({attributes:d,primitiveType:Oe.POINTS})),P=Qe.createTypedArray(x,A),z=0,L=0;for(i=0;i<n;++i){let B=e[i][t].indices,F=B.length;for(s=0;s<F;++s)P[z++]=L+B[s];L+=Fe.computeNumberOfVertices(e[i][t])}g=P}let v=new l,b=0,S;for(i=0;i<n;++i){if(S=e[i][t].boundingSphere,!f(S)){v=void 0;break}l.add(S.center,v,v)}if(f(v))for(l.divideByScalar(v,n,v),i=0;i<n;++i){S=e[i][t].boundingSphere;let A=l.magnitude(l.subtract(S.center,v,zg))+S.radius;A>b&&(b=A)}return new Fe({attributes:d,indices:g,primitiveType:u,boundingSphere:f(v)?new le(v,b):void 0})}wt.combineInstances=function(e){let t=[],n=[],o=e.length;for(let r=0;r<o;++r){let s=e[r];f(s.geometry)?t.push(s):f(s.westHemisphereGeometry)&&f(s.eastHemisphereGeometry)&&n.push(s)}let i=[];return t.length>0&&i.push(Sa(t,"geometry")),n.length>0&&(i.push(Sa(n,"westHemisphereGeometry")),i.push(Sa(n,"eastHemisphereGeometry"))),i};var Ht=new l,hi=new l,Uo=new l,Vo=new l;wt.computeNormal=function(e){let t=e.indices,n=e.attributes,o=n.position.values,i=n.position.values.length/3,r=t.length,s=new Array(i),a=new Array(r/3),c=new Array(r),u;for(u=0;u<i;u++)s[u]={indexOffset:0,count:0,currentCount:0};let d=0;for(u=0;u<r;u+=3){let g=t[u],v=t[u+1],b=t[u+2],S=g*3,A=v*3,x=b*3;hi.x=o[S],hi.y=o[S+1],hi.z=o[S+2],Uo.x=o[A],Uo.y=o[A+1],Uo.z=o[A+2],Vo.x=o[x],Vo.y=o[x+1],Vo.z=o[x+2],s[g].count++,s[v].count++,s[b].count++,l.subtract(Uo,hi,Uo),l.subtract(Vo,hi,Vo),a[d]=l.cross(Uo,Vo,new l),d++}let m=0;for(u=0;u<i;u++)s[u].indexOffset+=m,m+=s[u].count;d=0;let p;for(u=0;u<r;u+=3){p=s[t[u]];let g=p.indexOffset+p.currentCount;c[g]=d,p.currentCount++,p=s[t[u+1]],g=p.indexOffset+p.currentCount,c[g]=d,p.currentCount++,p=s[t[u+2]],g=p.indexOffset+p.currentCount,c[g]=d,p.currentCount++,d++}let _=new Float32Array(i*3);for(u=0;u<i;u++){let g=u*3;if(p=s[u],l.clone(l.ZERO,Ht),p.count>0){for(d=0;d<p.count;d++)l.add(Ht,a[c[p.indexOffset+d]],Ht);l.equalsEpsilon(l.ZERO,Ht,O.EPSILON10)&&l.clone(a[c[p.indexOffset]],Ht)}l.equalsEpsilon(l.ZERO,Ht,O.EPSILON10)&&(Ht.z=1),l.normalize(Ht,Ht),_[g]=Ht.x,_[g+1]=Ht.y,_[g+2]=Ht.z}return e.attributes.normal=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:_}),e};var Dg=new l,Om=new l,Ng=new l;wt.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,o=e.attributes.position.values,i=e.attributes.normal.values,r=e.attributes.st.values,s=e.attributes.position.values.length/3,a=n.length,c=new Array(s*3),u;for(u=0;u<c.length;u++)c[u]=0;let d,m,p;for(u=0;u<a;u+=3){let v=n[u],b=n[u+1],S=n[u+2];d=v*3,m=b*3,p=S*3;let A=v*2,x=b*2,P=S*2,z=o[d],L=o[d+1],B=o[d+2],F=r[A],N=r[A+1],I=r[x+1]-N,U=r[P+1]-N,h=1/((r[x]-F)*U-(r[P]-F)*I),C=(U*(o[m]-z)-I*(o[p]-z))*h,T=(U*(o[m+1]-L)-I*(o[p+1]-L))*h,R=(U*(o[m+2]-B)-I*(o[p+2]-B))*h;c[d]+=C,c[d+1]+=T,c[d+2]+=R,c[m]+=C,c[m+1]+=T,c[m+2]+=R,c[p]+=C,c[p+1]+=T,c[p+2]+=R}let _=new Float32Array(s*3),g=new Float32Array(s*3);for(u=0;u<s;u++){d=u*3,m=d+1,p=d+2;let v=l.fromArray(i,d,Dg),b=l.fromArray(c,d,Ng),S=l.dot(v,b);l.multiplyByScalar(v,S,Om),l.normalize(l.subtract(b,Om,b),b),_[d]=b.x,_[m]=b.y,_[p]=b.z,l.normalize(l.cross(v,b,b),b),g[d]=b.x,g[m]=b.y,g[p]=b.z}return e.attributes.tangent=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:_}),e.attributes.bitangent=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:g}),e};var pi=new ne,Jt=new l,Im=new l,Mm=new l,Nr=new ne;wt.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,o;if(f(t)){let L=t.values;o=L.length/3;let B=new Float32Array(o*2),F=0;for(n=0;n<o;++n){if(l.fromArray(L,n*3,Jt),l.equals(Jt,l.ZERO)){F+=2;continue}Nr=uo.octEncodeInRange(Jt,65535,Nr),B[F++]=Nr.x,B[F++]=Nr.y}return e.attributes.compressedAttributes=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:2,values:B}),delete e.attributes.extrudeDirection,e}let i=e.attributes.normal,r=e.attributes.st,s=f(i),a=f(r);if(!s&&!a)return e;let c=e.attributes.tangent,u=e.attributes.bitangent,d=f(c),m=f(u),p,_,g,v;s&&(p=i.values),a&&(_=r.values),d&&(g=c.values),m&&(v=u.values),o=(s?p.length:_.length)/(s?3:2);let A=o,x=a&&s?2:1;x+=d||m?1:0,A*=x;let P=new Float32Array(A),z=0;for(n=0;n<o;++n){a&&(ne.fromArray(_,n*2,pi),P[z++]=uo.compressTextureCoordinates(pi));let L=n*3;s&&f(g)&&f(v)?(l.fromArray(p,L,Jt),l.fromArray(g,L,Im),l.fromArray(v,L,Mm),uo.octPack(Jt,Im,Mm,pi),P[z++]=pi.x,P[z++]=pi.y):(s&&(l.fromArray(p,L,Jt),P[z++]=uo.octEncodeFloat(Jt)),d&&(l.fromArray(g,L,Jt),P[z++]=uo.octEncodeFloat(Jt)),m&&(l.fromArray(v,L,Jt),P[z++]=uo.octEncodeFloat(Jt)))}return e.attributes.compressedAttributes=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:x,values:P}),s&&delete e.attributes.normal,a&&delete e.attributes.st,m&&delete e.attributes.bitangent,d&&delete e.attributes.tangent,e};function Lg(e){if(f(e.indices))return e;let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,t);for(let o=0;o<t;++o)n[o]=o;return e.indices=n,e}function Fg(e){let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let o=3;for(let i=3;i<t;++i)n[o++]=i-1,n[o++]=0,n[o++]=i;return e.indices=n,e.primitiveType=Oe.TRIANGLES,e}function Bg(e){let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let o=6;for(let i=3;i<t-1;i+=2)n[o++]=i,n[o++]=i-1,n[o++]=i+1,i+2<t&&(n[o++]=i,n[o++]=i+1,n[o++]=i+2);return e.indices=n,e.primitiveType=Oe.TRIANGLES,e}function Ug(e){if(f(e.indices))return e;let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,t);for(let o=0;o<t;++o)n[o]=o;return e.indices=n,e}function Vg(e){let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let o=2;for(let i=2;i<t;++i)n[o++]=i-1,n[o++]=i;return e.indices=n,e.primitiveType=Oe.LINES,e}function kg(e){let t=Fe.computeNumberOfVertices(e),n=Qe.createTypedArray(t,t*2);n[0]=0,n[1]=1;let o=2;for(let i=2;i<t;++i)n[o++]=i-1,n[o++]=i;return n[o++]=t-1,n[o]=0,e.indices=n,e.primitiveType=Oe.LINES,e}function Gg(e){switch(e.primitiveType){case Oe.TRIANGLE_FAN:return Fg(e);case Oe.TRIANGLE_STRIP:return Bg(e);case Oe.TRIANGLES:return Lg(e);case Oe.LINE_STRIP:return Vg(e);case Oe.LINE_LOOP:return kg(e);case Oe.LINES:return Ug(e)}return e}function Gn(e,t){Math.abs(e.y)<O.EPSILON6&&(t?e.y=-O.EPSILON6:e.y=O.EPSILON6)}function jg(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){Gn(e,e.y<0),Gn(t,t.y<0),Gn(n,n.y<0);return}let o=Math.abs(e.y),i=Math.abs(t.y),r=Math.abs(n.y),s;o>i?o>r?s=O.sign(e.y):s=O.sign(n.y):i>r?s=O.sign(t.y):s=O.sign(n.y);let a=s<0;Gn(e,a),Gn(t,a),Gn(n,a)}var zm=new l;function qt(e,t,n,o){l.add(e,l.multiplyByScalar(l.subtract(t,e,zm),e.y/(e.y-t.y),zm),n),l.clone(n,o),Gn(n,!0),Gn(o,!1)}var lo=new l,mo=new l,ho=new l,po=new l,Ra={positions:new Array(7),indices:new Array(3*3)};function Hg(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;jg(e,t,n);let o=e.y<0,i=t.y<0,r=n.y<0,s=0;s+=o?1:0,s+=i?1:0,s+=r?1:0;let a=Ra.indices;s===1?(a[1]=3,a[2]=4,a[5]=6,a[7]=6,a[8]=5,o?(qt(e,t,lo,ho),qt(e,n,mo,po),a[0]=0,a[3]=1,a[4]=2,a[6]=1):i?(qt(t,n,lo,ho),qt(t,e,mo,po),a[0]=1,a[3]=2,a[4]=0,a[6]=2):r&&(qt(n,e,lo,ho),qt(n,t,mo,po),a[0]=2,a[3]=0,a[4]=1,a[6]=0)):s===2&&(a[2]=4,a[4]=4,a[5]=3,a[7]=5,a[8]=6,o?i?r||(qt(n,e,lo,ho),qt(n,t,mo,po),a[0]=0,a[1]=1,a[3]=0,a[6]=2):(qt(t,n,lo,ho),qt(t,e,mo,po),a[0]=2,a[1]=0,a[3]=2,a[6]=1):(qt(e,t,lo,ho),qt(e,n,mo,po),a[0]=1,a[1]=2,a[3]=1,a[6]=0));let c=Ra.positions;return c[0]=e,c[1]=t,c[2]=n,c.length=3,(s===1||s===2)&&(c[3]=lo,c[4]=mo,c[5]=ho,c[6]=po,c.length=7),Ra}function Dm(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let i in n)if(n.hasOwnProperty(i)&&f(n[i])&&f(n[i].values)){let r=n[i];r.values=re.createTypedArray(r.componentDatatype,r.values)}let o=Fe.computeNumberOfVertices(e);return e.indices=Qe.createTypedArray(o,e.indices),t&&(e.boundingSphere=le.fromVertices(n.position.values)),e}function Go(e){let t=e.attributes,n={};for(let o in t)if(t.hasOwnProperty(o)&&f(t[o])&&f(t[o].values)){let i=t[o];n[o]=new Ue({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return new Fe({attributes:n,indices:[],primitiveType:e.primitiveType})}function Ma(e,t,n){let o=f(e.geometry.boundingSphere);t=Dm(t,o),n=Dm(n,o),f(n)&&!f(t)?e.geometry=n:!f(n)&&f(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function za(e,t){let n=new e,o=new e,i=new e;return function(r,s,a,c,u,d,m,p){let _=e.fromArray(u,r*t,n),g=e.fromArray(u,s*t,o),v=e.fromArray(u,a*t,i);e.multiplyByScalar(_,c.x,_),e.multiplyByScalar(g,c.y,g),e.multiplyByScalar(v,c.z,v);let b=e.add(_,g,_);e.add(b,v,b),p&&e.normalize(b,b),e.pack(b,d,m*t)}}var qg=za(se,4),Br=za(l,3),Vm=za(ne,2),Wg=function(e,t,n,o,i,r,s){let a=i[e]*o.x,c=i[t]*o.y,u=i[n]*o.z;r[s]=a+c+u>O.EPSILON6?1:0},_i=new l,Pa=new l,Oa=new l,Yg=new l;function Lr(e,t,n,o,i,r,s,a,c,u,d,m,p,_,g,v){if(!f(r)&&!f(s)&&!f(a)&&!f(c)&&!f(u)&&_===0)return;let b=l.fromArray(i,e*3,_i),S=l.fromArray(i,t*3,Pa),A=l.fromArray(i,n*3,Oa),x=pm(o,b,S,A,Yg);if(!!f(x)){if(f(r)&&Br(e,t,n,x,r,m.normal.values,v,!0),f(u)){let P=l.fromArray(u,e*3,_i),z=l.fromArray(u,t*3,Pa),L=l.fromArray(u,n*3,Oa);l.multiplyByScalar(P,x.x,P),l.multiplyByScalar(z,x.y,z),l.multiplyByScalar(L,x.z,L);let B;!l.equals(P,l.ZERO)||!l.equals(z,l.ZERO)||!l.equals(L,l.ZERO)?(B=l.add(P,z,P),l.add(B,L,B),l.normalize(B,B)):(B=_i,B.x=0,B.y=0,B.z=0),l.pack(B,m.extrudeDirection.values,v*3)}if(f(d)&&Wg(e,t,n,x,d,m.applyOffset.values,v),f(s)&&Br(e,t,n,x,s,m.tangent.values,v,!0),f(a)&&Br(e,t,n,x,a,m.bitangent.values,v,!0),f(c)&&Vm(e,t,n,x,c,m.st.values,v),_>0)for(let P=0;P<_;P++){let z=p[P];Xg(e,t,n,x,v,g[z],m[z])}}}function Xg(e,t,n,o,i,r,s){let a=r.componentsPerAttribute,c=r.values,u=s.values;switch(a){case 4:qg(e,t,n,o,c,u,i,!1);break;case 3:Br(e,t,n,o,c,u,i,!1);break;case 2:Vm(e,t,n,o,c,u,i,!1);break;default:u[i]=c[e]*o.x+c[t]*o.y+c[n]*o.z}}function mn(e,t,n,o,i,r){let s=e.position.values.length/3;if(i!==-1){let a=o[i],c=n[a];return c===-1?(n[a]=s,e.position.values.push(r.x,r.y,r.z),t.push(s),s):(t.push(c),c)}return e.position.values.push(r.x,r.y,r.z),t.push(s),s}var $g={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function Nm(e){let t=e.geometry,n=t.attributes,o=n.position.values,i=f(n.normal)?n.normal.values:void 0,r=f(n.bitangent)?n.bitangent.values:void 0,s=f(n.tangent)?n.tangent.values:void 0,a=f(n.st)?n.st.values:void 0,c=f(n.extrudeDirection)?n.extrudeDirection.values:void 0,u=f(n.applyOffset)?n.applyOffset.values:void 0,d=t.indices,m=[];for(let B in n)n.hasOwnProperty(B)&&!$g[B]&&f(n[B])&&m.push(B);let p=m.length,_=Go(t),g=Go(t),v,b,S,A,x,P=[];P.length=o.length/3;let z=[];for(z.length=o.length/3,x=0;x<P.length;++x)P[x]=-1,z[x]=-1;let L=d.length;for(x=0;x<L;x+=3){let B=d[x],F=d[x+1],N=d[x+2],I=l.fromArray(o,B*3),U=l.fromArray(o,F*3),h=l.fromArray(o,N*3),C=Hg(I,U,h);if(f(C)&&C.positions.length>3){let T=C.positions,R=C.indices,D=R.length;for(let k=0;k<D;++k){let M=R[k],q=T[M];q.y<0?(v=g.attributes,b=g.indices,S=P):(v=_.attributes,b=_.indices,S=z),A=mn(v,b,S,d,M<3?x+M:-1,q),Lr(B,F,N,q,o,i,s,r,a,c,u,v,m,p,n,A)}}else f(C)&&(I=C.positions[0],U=C.positions[1],h=C.positions[2]),I.y<0?(v=g.attributes,b=g.indices,S=P):(v=_.attributes,b=_.indices,S=z),A=mn(v,b,S,d,x,I),Lr(B,F,N,I,o,i,s,r,a,c,u,v,m,p,n,A),A=mn(v,b,S,d,x+1,U),Lr(B,F,N,U,o,i,s,r,a,c,u,v,m,p,n,A),A=mn(v,b,S,d,x+2,h),Lr(B,F,N,h,o,i,s,r,a,c,u,v,m,p,n,A)}Ma(e,g,_)}var km=ri.fromPointNormal(l.ZERO,l.UNIT_Y),Kg=new l,Zg=new l;function ko(e,t,n,o,i,r,s){if(!f(s))return;let a=l.fromArray(o,e*3,_i);l.equalsEpsilon(a,n,O.EPSILON10)?r.applyOffset.values[i]=s[e]:r.applyOffset.values[i]=s[t]}function Lm(e){let t=e.geometry,n=t.attributes,o=n.position.values,i=f(n.applyOffset)?n.applyOffset.values:void 0,r=t.indices,s=Go(t),a=Go(t),c,u=r.length,d=[];d.length=o.length/3;let m=[];for(m.length=o.length/3,c=0;c<d.length;++c)d[c]=-1,m[c]=-1;for(c=0;c<u;c+=2){let p=r[c],_=r[c+1],g=l.fromArray(o,p*3,_i),v=l.fromArray(o,_*3,Pa),b;Math.abs(g.y)<O.EPSILON6&&(g.y<0?g.y=-O.EPSILON6:g.y=O.EPSILON6),Math.abs(v.y)<O.EPSILON6&&(v.y<0?v.y=-O.EPSILON6:v.y=O.EPSILON6);let S=s.attributes,A=s.indices,x=m,P=a.attributes,z=a.indices,L=d,B=Ta.lineSegmentPlane(g,v,km,Oa);if(f(B)){let F=l.multiplyByScalar(l.UNIT_Y,5*O.EPSILON9,Kg);g.y<0&&(l.negate(F,F),S=a.attributes,A=a.indices,x=d,P=s.attributes,z=s.indices,L=m);let N=l.add(B,F,Zg);b=mn(S,A,x,r,c,g),ko(p,_,g,o,b,S,i),b=mn(S,A,x,r,-1,N),ko(p,_,N,o,b,S,i),l.negate(F,F),l.add(B,F,N),b=mn(P,z,L,r,-1,N),ko(p,_,N,o,b,P,i),b=mn(P,z,L,r,c+1,v),ko(p,_,v,o,b,P,i)}else{let F,N,I;g.y<0?(F=a.attributes,N=a.indices,I=d):(F=s.attributes,N=s.indices,I=m),b=mn(F,N,I,r,c,g),ko(p,_,g,o,b,F,i),b=mn(F,N,I,r,c+1,v),ko(p,_,v,o,b,F,i)}}Ma(e,a,s)}var Fm=new ne,Qg=new ne,Gm=new l,jm=new l,Ia=new l,Jg=new l,eC=new l,tC=new l,Bm=new se;function Um(e){let t=e.attributes,n=t.position.values,o=t.prevPosition.values,i=t.nextPosition.values,r=n.length;for(let s=0;s<r;s+=3){let a=l.unpack(n,s,Gm);if(a.x>0)continue;let c=l.unpack(o,s,jm);(a.y<0&&c.y>0||a.y>0&&c.y<0)&&(s-3>0?(o[s]=n[s-3],o[s+1]=n[s-2],o[s+2]=n[s-1]):l.pack(a,o,s));let u=l.unpack(i,s,Ia);(a.y<0&&u.y>0||a.y>0&&u.y<0)&&(s+3<r?(i[s]=n[s+3],i[s+1]=n[s+4],i[s+2]=n[s+5]):l.pack(a,i,s))}}var nC=5*O.EPSILON9,Fr=O.EPSILON6;function oC(e){let t=e.geometry,n=t.attributes,o=n.position.values,i=n.prevPosition.values,r=n.nextPosition.values,s=n.expandAndWidth.values,a=f(n.st)?n.st.values:void 0,c=f(n.color)?n.color.values:void 0,u=Go(t),d=Go(t),m,p,_,g=!1,v=o.length/3;for(m=0;m<v;m+=4){let b=m,S=m+2,A=l.fromArray(o,b*3,Gm),x=l.fromArray(o,S*3,jm);if(Math.abs(A.y)<Fr)for(A.y=Fr*(x.y<0?-1:1),o[m*3+1]=A.y,o[(m+1)*3+1]=A.y,p=b*3;p<b*3+4*3;p+=3)i[p]=o[m*3],i[p+1]=o[m*3+1],i[p+2]=o[m*3+2];if(Math.abs(x.y)<Fr)for(x.y=Fr*(A.y<0?-1:1),o[(m+2)*3+1]=x.y,o[(m+3)*3+1]=x.y,p=b*3;p<b*3+4*3;p+=3)r[p]=o[(m+2)*3],r[p+1]=o[(m+2)*3+1],r[p+2]=o[(m+2)*3+2];let P=u.attributes,z=u.indices,L=d.attributes,B=d.indices,F=Ta.lineSegmentPlane(A,x,km,Jg);if(f(F)){g=!0;let N=l.multiplyByScalar(l.UNIT_Y,nC,eC);A.y<0&&(l.negate(N,N),P=d.attributes,z=d.indices,L=u.attributes,B=u.indices);let I=l.add(F,N,tC);P.position.values.push(A.x,A.y,A.z,A.x,A.y,A.z),P.position.values.push(I.x,I.y,I.z),P.position.values.push(I.x,I.y,I.z),P.prevPosition.values.push(i[b*3],i[b*3+1],i[b*3+2]),P.prevPosition.values.push(i[b*3+3],i[b*3+4],i[b*3+5]),P.prevPosition.values.push(A.x,A.y,A.z,A.x,A.y,A.z),P.nextPosition.values.push(I.x,I.y,I.z),P.nextPosition.values.push(I.x,I.y,I.z),P.nextPosition.values.push(I.x,I.y,I.z),P.nextPosition.values.push(I.x,I.y,I.z),l.negate(N,N),l.add(F,N,I),L.position.values.push(I.x,I.y,I.z),L.position.values.push(I.x,I.y,I.z),L.position.values.push(x.x,x.y,x.z,x.x,x.y,x.z),L.prevPosition.values.push(I.x,I.y,I.z),L.prevPosition.values.push(I.x,I.y,I.z),L.prevPosition.values.push(I.x,I.y,I.z),L.prevPosition.values.push(I.x,I.y,I.z),L.nextPosition.values.push(x.x,x.y,x.z,x.x,x.y,x.z),L.nextPosition.values.push(r[S*3],r[S*3+1],r[S*3+2]),L.nextPosition.values.push(r[S*3+3],r[S*3+4],r[S*3+5]);let U=ne.fromArray(s,b*2,Fm),h=Math.abs(U.y);P.expandAndWidth.values.push(-1,h,1,h),P.expandAndWidth.values.push(-1,-h,1,-h),L.expandAndWidth.values.push(-1,h,1,h),L.expandAndWidth.values.push(-1,-h,1,-h);let C=l.magnitudeSquared(l.subtract(F,A,Ia));if(C/=l.magnitudeSquared(l.subtract(x,A,Ia)),f(c)){let T=se.fromArray(c,b*4,Bm),R=se.fromArray(c,S*4,Bm),D=O.lerp(T.x,R.x,C),k=O.lerp(T.y,R.y,C),M=O.lerp(T.z,R.z,C),q=O.lerp(T.w,R.w,C);for(p=b*4;p<b*4+2*4;++p)P.color.values.push(c[p]);for(P.color.values.push(D,k,M,q),P.color.values.push(D,k,M,q),L.color.values.push(D,k,M,q),L.color.values.push(D,k,M,q),p=S*4;p<S*4+2*4;++p)L.color.values.push(c[p])}if(f(a)){let T=ne.fromArray(a,b*2,Fm),R=ne.fromArray(a,(m+3)*2,Qg),D=O.lerp(T.x,R.x,C);for(p=b*2;p<b*2+2*2;++p)P.st.values.push(a[p]);for(P.st.values.push(D,T.y),P.st.values.push(D,R.y),L.st.values.push(D,T.y),L.st.values.push(D,R.y),p=S*2;p<S*2+2*2;++p)L.st.values.push(a[p])}_=P.position.values.length/3-4,z.push(_,_+2,_+1),z.push(_+1,_+2,_+3),_=L.position.values.length/3-4,B.push(_,_+2,_+1),B.push(_+1,_+2,_+3)}else{let N,I;for(A.y<0?(N=d.attributes,I=d.indices):(N=u.attributes,I=u.indices),N.position.values.push(A.x,A.y,A.z),N.position.values.push(A.x,A.y,A.z),N.position.values.push(x.x,x.y,x.z),N.position.values.push(x.x,x.y,x.z),p=m*3;p<m*3+4*3;++p)N.prevPosition.values.push(i[p]),N.nextPosition.values.push(r[p]);for(p=m*2;p<m*2+4*2;++p)N.expandAndWidth.values.push(s[p]),f(a)&&N.st.values.push(a[p]);if(f(c))for(p=m*4;p<m*4+4*4;++p)N.color.values.push(c[p]);_=N.position.values.length/3-4,I.push(_,_+2,_+1),I.push(_+1,_+2,_+3)}}g&&(Um(d),Um(u)),Ma(e,d,u)}wt.splitLongitude=function(e){let t=e.geometry,n=t.boundingSphere;if(f(n)&&(n.center.x-n.radius>0||le.intersectPlane(n,ri.ORIGIN_ZX_PLANE)!==Yt.INTERSECTING))return e;if(t.geometryType!==Jn.NONE)switch(t.geometryType){case Jn.POLYLINES:oC(e);break;case Jn.TRIANGLES:Nm(e);break;case Jn.LINES:Lm(e);break}else Gg(t),t.primitiveType===Oe.TRIANGLES?Nm(e):t.primitiveType===Oe.LINES&&Lm(e);return e};var pt=wt;function yi(e,t,n){e=y(e,0),t=y(t,0),n=y(n,0),this.value=new Float32Array([e,t,n])}Object.defineProperties(yi.prototype,{componentDatatype:{get:function(){return re.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}});yi.fromCartesian3=function(e){return new yi(e.x,e.y,e.z)};yi.toValue=function(e,t){return f(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var Hm=yi;function Dt(e){this._ellipsoid=y(e,xt.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(Dt.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});Dt.mercatorAngleToGeodeticLatitude=function(e){return O.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};Dt.geodeticLatitudeToMercatorAngle=function(e){e>Dt.MaximumLatitude?e=Dt.MaximumLatitude:e<-Dt.MaximumLatitude&&(e=-Dt.MaximumLatitude);let t=Math.sin(e);return .5*Math.log((1+t)/(1-t))};Dt.MaximumLatitude=Dt.mercatorAngleToGeodeticLatitude(Math.PI);Dt.prototype.project=function(e,t){let n=this._semimajorAxis,o=e.longitude*n,i=Dt.geodeticLatitudeToMercatorAngle(e.latitude)*n,r=e.height;return f(t)?(t.x=o,t.y=i,t.z=r,t):new l(o,i,r)};Dt.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,o=e.x*n,i=Dt.mercatorAngleToGeodeticLatitude(e.y*n),r=e.z;return f(t)?(t.longitude=o,t.latitude=i,t.height=r,t):new ve(o,i,r)};var qm=Dt;function iC(e,t,n){let o=!n,i=e.length,r;if(!o&&i>1){let s=e[0].modelMatrix;for(r=1;r<i;++r)if(!X.equals(s,e[r].modelMatrix)){o=!0;break}}if(o)for(r=0;r<i;++r)f(e[r].geometry)&&pt.transformToWorldCoordinates(e[r]);else X.multiplyTransformation(t,e[0].modelMatrix,t)}function Da(e,t){let n=e.attributes,o=n.position,i=o.values.length/o.componentsPerAttribute;n.batchId=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:1,values:new Float32Array(i)});let r=n.batchId.values;for(let s=0;s<i;++s)r[s]=t}function rC(e){let t=e.length;for(let n=0;n<t;++n){let o=e[n];f(o.geometry)?Da(o.geometry,n):f(o.westHemisphereGeometry)&&f(o.eastHemisphereGeometry)&&(Da(o.westHemisphereGeometry,n),Da(o.eastHemisphereGeometry,n))}}function sC(e){let t=e.instances,n=e.projection,o=e.elementIndexUintSupported,i=e.scene3DOnly,r=e.vertexCacheOptimize,s=e.compressVertices,a=e.modelMatrix,c,u,d,m=t.length;for(c=0;c<m;++c)if(f(t[c].geometry)){d=t[c].geometry.primitiveType;break}if(iC(t,a,i),!i)for(c=0;c<m;++c)f(t[c].geometry)&&pt.splitLongitude(t[c]);if(rC(t),r)for(c=0;c<m;++c){let _=t[c];f(_.geometry)?(pt.reorderForPostVertexCache(_.geometry),pt.reorderForPreVertexCache(_.geometry)):f(_.westHemisphereGeometry)&&f(_.eastHemisphereGeometry)&&(pt.reorderForPostVertexCache(_.westHemisphereGeometry),pt.reorderForPreVertexCache(_.westHemisphereGeometry),pt.reorderForPostVertexCache(_.eastHemisphereGeometry),pt.reorderForPreVertexCache(_.eastHemisphereGeometry))}let p=pt.combineInstances(t);for(m=p.length,c=0;c<m;++c){u=p[c];let _=u.attributes;if(i)for(let g in _)_.hasOwnProperty(g)&&_[g].componentDatatype===re.DOUBLE&&pt.encodeAttribute(u,g,`${g}3DHigh`,`${g}3DLow`);else for(let g in _)if(_.hasOwnProperty(g)&&_[g].componentDatatype===re.DOUBLE){let v=`${g}3D`,b=`${g}2D`;pt.projectTo2D(u,g,v,b,n),f(u.boundingSphere)&&g==="position"&&(u.boundingSphereCV=le.fromVertices(u.attributes.position2D.values)),pt.encodeAttribute(u,v,`${v}High`,`${v}Low`),pt.encodeAttribute(u,b,`${b}High`,`${b}Low`)}s&&pt.compressVertices(u)}if(!o){let _=[];for(m=p.length,c=0;c<m;++c)u=p[c],_=_.concat(pt.fitToUnsignedShortIndices(u));p=_}return p}function Na(e,t,n,o){let i,r,s,a=o.length-1;if(a>=0){let u=o[a];i=u.offset+u.count,s=u.index,r=n[s].indices.length}else i=0,s=0,r=n[s].indices.length;let c=e.length;for(let u=0;u<c;++u){let m=e[u][t];if(!f(m))continue;let p=m.indices.length;i+p>r&&(i=0,r=n[++s].indices.length),o.push({index:s,offset:i,count:p}),i+=p}}function aC(e,t){let n=[];return Na(e,"geometry",t,n),Na(e,"westHemisphereGeometry",t,n),Na(e,"eastHemisphereGeometry",t,n),n}var Pn={};Pn.combineGeometry=function(e){let t,n,o=e.instances,i=o.length,r,s,a=!1;i>0&&(t=sC(e),t.length>0&&(n=pt.createAttributeLocations(t[0]),e.createPickOffsets&&(r=aC(o,t))),f(o[0].attributes)&&f(o[0].attributes.offset)&&(s=new Array(i),a=!0));let c=new Array(i),u=new Array(i);for(let d=0;d<i;++d){let m=o[d],p=m.geometry;f(p)&&(c[d]=p.boundingSphere,u[d]=p.boundingSphereCV,a&&(s[d]=m.geometry.offsetAttribute));let _=m.eastHemisphereGeometry,g=m.westHemisphereGeometry;f(_)&&f(g)&&(f(_.boundingSphere)&&f(g.boundingSphere)&&(c[d]=le.union(_.boundingSphere,g.boundingSphere)),f(_.boundingSphereCV)&&f(g.boundingSphereCV)&&(u[d]=le.union(_.boundingSphereCV,g.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:r,offsetInstanceExtend:s,boundingSpheres:c,boundingSpheresCV:u}};function cC(e,t){let n=e.attributes;for(let o in n)if(n.hasOwnProperty(o)){let i=n[o];f(i)&&f(i.values)&&t.push(i.values.buffer)}f(e.indices)&&t.push(e.indices.buffer)}function uC(e,t){let n=e.length;for(let o=0;o<n;++o)cC(e[o],t)}function fC(e){let t=1,n=e.length;for(let o=0;o<n;o++){let i=e[o];if(++t,!f(i))continue;let r=i.attributes;t+=7+2*le.packedLength+(f(i.indices)?i.indices.length:0);for(let s in r)if(r.hasOwnProperty(s)&&f(r[s])){let a=r[s];t+=5+a.values.length}}return t}Pn.packCreateGeometryResults=function(e,t){let n=new Float64Array(fC(e)),o=[],i={},r=e.length,s=0;n[s++]=r;for(let a=0;a<r;a++){let c=e[a],u=f(c);if(n[s++]=u?1:0,!u)continue;n[s++]=c.primitiveType,n[s++]=c.geometryType,n[s++]=y(c.offsetAttribute,-1);let d=f(c.boundingSphere)?1:0;n[s++]=d,d&&le.pack(c.boundingSphere,n,s),s+=le.packedLength;let m=f(c.boundingSphereCV)?1:0;n[s++]=m,m&&le.pack(c.boundingSphereCV,n,s),s+=le.packedLength;let p=c.attributes,_=[];for(let v in p)p.hasOwnProperty(v)&&f(p[v])&&(_.push(v),f(i[v])||(i[v]=o.length,o.push(v)));n[s++]=_.length;for(let v=0;v<_.length;v++){let b=_[v],S=p[b];n[s++]=i[b],n[s++]=S.componentDatatype,n[s++]=S.componentsPerAttribute,n[s++]=S.normalize?1:0,n[s++]=S.values.length,n.set(S.values,s),s+=S.values.length}let g=f(c.indices)?c.indices.length:0;n[s++]=g,g>0&&(n.set(c.indices,s),s+=g)}return t.push(n.buffer),{stringTable:o,packedData:n}};Pn.unpackCreateGeometryResults=function(e){let t=e.stringTable,n=e.packedData,o,i=new Array(n[0]),r=0,s=1;for(;s<n.length;){if(!(n[s++]===1)){i[r++]=void 0;continue}let c=n[s++],u=n[s++],d=n[s++];d===-1&&(d=void 0);let m,p;n[s++]===1&&(m=le.unpack(n,s)),s+=le.packedLength,n[s++]===1&&(p=le.unpack(n,s)),s+=le.packedLength;let v,b,S,A=new No,x=n[s++];for(o=0;o<x;o++){let z=t[n[s++]],L=n[s++];S=n[s++];let B=n[s++]!==0;v=n[s++],b=re.createTypedArray(L,v);for(let F=0;F<v;F++)b[F]=n[s++];A[z]=new Ue({componentDatatype:L,componentsPerAttribute:S,normalize:B,values:b})}let P;if(v=n[s++],v>0){let z=b.length/S;for(P=Qe.createTypedArray(z,v),o=0;o<v;o++)P[o]=n[s++]}i[r++]=new Fe({primitiveType:c,geometryType:u,boundingSphere:m,boundingSphereCV:p,indices:P,attributes:A,offsetAttribute:d})}return i};function lC(e,t){let n=e.length,o=new Float64Array(1+n*19),i=0;o[i++]=n;for(let r=0;r<n;r++){let s=e[r];if(X.pack(s.modelMatrix,o,i),i+=X.packedLength,f(s.attributes)&&f(s.attributes.offset)){let a=s.attributes.offset.value;o[i]=a[0],o[i+1]=a[1],o[i+2]=a[2]}i+=3}return t.push(o.buffer),o}function dC(e){let t=e,n=new Array(t[0]),o=0,i=1;for(;i<t.length;){let r=X.unpack(t,i),s;i+=X.packedLength,f(t[i])&&(s={offset:new Hm(t[i],t[i+1],t[i+2])}),i+=3,n[o++]={modelMatrix:r,attributes:s}}return n}Pn.packCombineGeometryParameters=function(e,t){let n=e.createGeometryResults,o=n.length;for(let i=0;i<o;i++)t.push(n[i].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:lC(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof nn,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};Pn.unpackCombineGeometryParameters=function(e){let t=dC(e.packedInstances),n=e.createGeometryResults,o=n.length,i=0;for(let a=0;a<o;a++){let c=Pn.unpackCreateGeometryResults(n[a]),u=c.length;for(let d=0;d<u;d++){let m=c[d],p=t[i];p.geometry=m,++i}}let r=xt.clone(e.ellipsoid),s=e.isGeographic?new nn(r):new qm(r);return{instances:t,ellipsoid:r,projection:s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:X.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function Wm(e){let t=e.length,n=1+(le.packedLength+1)*t,o=new Float32Array(n),i=0;o[i++]=t;for(let r=0;r<t;++r){let s=e[r];f(s)?(o[i++]=1,le.pack(e[r],o,i)):o[i++]=0,i+=le.packedLength}return o}function Ym(e){let t=new Array(e[0]),n=0,o=1;for(;o<e.length;)e[o++]===1&&(t[n]=le.unpack(e,o)),++n,o+=le.packedLength;return t}Pn.packCombineGeometryResults=function(e,t){f(e.geometries)&&uC(e.geometries,t);let n=Wm(e.boundingSpheres),o=Wm(e.boundingSpheresCV);return t.push(n.buffer,o.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:o}};Pn.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:Ym(e.boundingSpheres),boundingSpheresCV:Ym(e.boundingSpheresCV)}};var Vr=Pn;var mC={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},et=Object.freeze(mC);var kr={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};kr.getMorphTime=function(e){return e===kr.SCENE3D?1:e===kr.MORPHING?void 0:0};var gi=Object.freeze(kr);var Ft={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};Ft.NUMBER_OF_SHADOW_MODES=4;Ft.castShadows=function(e){return e===Ft.ENABLED||e===Ft.CAST_ONLY};Ft.receiveShadows=function(e){return e===Ft.ENABLED||e===Ft.RECEIVE_ONLY};Ft.fromCastReceive=function(e,t){return e&&t?Ft.ENABLED:e?Ft.CAST_ONLY:t?Ft.RECEIVE_ONLY:Ft.DISABLED};var Gr=Object.freeze(Ft);function We(e){e=y(e,y.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=X.clone(y(e.modelMatrix,X.IDENTITY)),this._modelMatrix=new X,this.show=y(e.show,!0),this._vertexCacheOptimize=y(e.vertexCacheOptimize,!1),this._interleave=y(e.interleave,!1),this._releaseGeometryInstances=y(e.releaseGeometryInstances,!0),this._allowPicking=y(e.allowPicking,!0),this._asynchronous=y(e.asynchronous,!0),this._compressVertices=y(e.compressVertices,!0),this.cull=y(e.cull,!0),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=y(e.shadows,Gr.DISABLED),this._translucent=void 0,this._state=et.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1;let t=this;this._readyPromise=new Promise((n,o)=>{t._completeLoad=(i,r,s)=>{this._error=s,this._state=r,i.afterRender.push(function(){t._ready=t._state===et.COMPLETE||t._state===et.FAILED,f(s)?o(s):n(t)})}}),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(We.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},pickIds:{get:function(){return this._pickIds}}});function hC(e){let t=e.length,n=[],o=e[0].attributes,i;for(i in o)if(o.hasOwnProperty(i)&&f(o[i])){let r=o[i],s=!0;for(let a=1;a<t;++a){let c=e[a].attributes[i];if(!f(c)||r.componentDatatype!==c.componentDatatype||r.componentsPerAttribute!==c.componentsPerAttribute||r.normalize!==c.normalize){s=!1;break}}s&&n.push(i)}return n}var pC=new ne,_C=new l,nh=new se;function oh(e){let t=e.length;if(t===1)return e[0];if(t===2)return ne.unpack(e,0,pC);if(t===3)return l.unpack(e,0,_C);if(t===4)return se.unpack(e,0,nh)}function yC(e,t){let n=e.geometryInstances,o=Array.isArray(n)?n:[n],i=o.length;if(i===0)return;let r=hC(o),s=r.length,a=[],c={},u={},d,p=o[0].attributes,_,g,v;for(_=0;_<s;++_)g=r[_],v=p[g],c[g]=_,a.push({functionName:`czm_batchTable_${g}`,componentDatatype:v.componentDatatype,componentsPerAttribute:v.componentsPerAttribute,normalize:v.normalize});r.indexOf("distanceDisplayCondition")!==-1&&(a.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:re.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:re.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:re.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:re.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:re.FLOAT,componentsPerAttribute:1}),u.center3DHigh=a.length-5,u.center3DLow=a.length-4,u.center2DHigh=a.length-3,u.center2DLow=a.length-2,u.radius=a.length-1),r.indexOf("offset")!==-1&&(a.push({functionName:"czm_batchTable_offset2D",componentDatatype:re.FLOAT,componentsPerAttribute:3}),d=a.length-1),a.push({functionName:"czm_batchTable_pickColor",componentDatatype:re.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let b=a.length,S=new sm(t,a,i);for(_=0;_<i;++_){let A=o[_];p=A.attributes;for(let B=0;B<s;++B){g=r[B],v=p[g];let F=oh(v.value),N=c[g];S.setBatchedAttribute(_,N,F)}let x={primitive:y(A.pickPrimitive,e)};f(A.id)&&(x.id=A.id);let P=t.createPickId(x);e._pickIds.push(P);let z=P.color,L=nh;L.x=Be.floatToByte(z.red),L.y=Be.floatToByte(z.green),L.z=Be.floatToByte(z.blue),L.w=Be.floatToByte(z.alpha),S.setBatchedAttribute(_,b-1,L)}e._batchTable=S,e._batchTableAttributeIndices=c,e._batchTableBoundingSphereAttributeIndices=u,e._batchTableOffsetAttribute2DIndex=d}function gC(e){let t;return Array.isArray(e.values)?t=e.values.slice(0):t=new e.values.constructor(e.values),new Ue({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function CC(e){let t=e.attributes,n=new No;for(let i in t)t.hasOwnProperty(i)&&f(t[i])&&(n[i]=gC(t[i]));let o;if(f(e.indices)){let i=e.indices;Array.isArray(i)?o=i.slice(0):o=new i.constructor(i)}return new Fe({attributes:n,indices:o,primitiveType:e.primitiveType,boundingSphere:le.clone(e.boundingSphere)})}function vC(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:X.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var EC=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;We._modifyShaderPosition=function(e,t,n){let o,i="",r="",s="";for(;(o=EC.exec(t))!==null;){let a=o[1],c=`vec4 czm_compute${a[0].toUpperCase()}${a.substr(1)}()`;c!=="vec4 czm_computePosition()"&&(i+=`${c};
`),f(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),i+=`uniform mat4 u_modifiedModelView;
`,r+=`attribute vec4 position;
`,s+=`${c}
{
    return u_modifiedModelView * position;
}

`,t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?s+=`${c}
{
    return czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow);
}

`:(r+=`attribute vec3 ${a}2DHigh;
attribute vec3 ${a}2DLow;
`,s+=`${c}
{
    vec4 p;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy),
                czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow),
                czm_morphTime);
    }
    return p;
}

`)}return[i,r,t,s].join(`
`)};We._appendShowToShader=function(e,t){return f(e._batchTableAttributeIndices.show)?`${co.replaceMain(t,"czm_non_show_main")}
void main() 
{ 
    czm_non_show_main(); 
    gl_Position *= czm_batchTable_show(batchId); 
}`:t};We._updateColorAttribute=function(e,t,n){if(!f(e._batchTableAttributeIndices.color)&&!f(e._batchTableAttributeIndices.depthFailColor)||t.search(/attribute\s+vec4\s+color;/g)===-1)return t;let o=t;return o=o.replace(/attribute\s+vec4\s+color;/g,""),n?o=o.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):o=o.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),o};function Xm(e){return`${co.replaceMain(e,"czm_non_pick_main")}
varying vec4 v_pickColor; 
void main() 
{ 
    czm_non_pick_main(); 
    v_pickColor = czm_batchTable_pickColor(batchId); 
}`}function $m(e){return`varying vec4 v_pickColor;
${e}`}We._updatePickColorAttribute=function(e){let t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t};We._appendOffsetToShader=function(e,t){if(!f(e._batchTableAttributeIndices.offset))return t;let n=`attribute float batchId;
`;n+="attribute float applyOffset;";let o=t.replace(/attribute\s+float\s+batchId;/g,n),i=`vec4 $1 = czm_computePosition();
`;return i+=`    if (czm_sceneMode == czm_sceneMode3D)
`,i+=`    {
`,i+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",i+=`    }
`,i+=`    else
`,i+=`    {
`,i+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",i+=`    }
`,o=o.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,i),o};We._appendDistanceDisplayConditionToShader=function(e,t,n){if(!f(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let o=co.replaceMain(t,"czm_non_distanceDisplayCondition_main"),i=`void main() 
{ 
    czm_non_distanceDisplayCondition_main(); 
    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);
    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);
    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);
    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);
`;return n?i+=`    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
`:i+=`    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);
    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);
    vec4 centerRTE;
    if (czm_morphTime == 1.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);
    }
    else
    {
        centerRTE = czm_columbusViewMorph(
                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),
                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),
                czm_morphTime);
    }
`,i+=`    float radiusSq = boundingSphereRadius * boundingSphereRadius; 
    float distanceSq; 
    if (czm_sceneMode == czm_sceneMode2D) 
    { 
        distanceSq = czm_eyeHeight2D.y - radiusSq; 
    } 
    else 
    { 
        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; 
    } 
    distanceSq = max(distanceSq, 0.0); 
    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; 
    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; 
    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; 
    gl_Position *= show; 
}`,`${o}
${i}`};function Km(e,t){if(!e.compressVertices)return t;let n=t.search(/attribute\s+vec3\s+normal;/g)!==-1,o=t.search(/attribute\s+vec2\s+st;/g)!==-1;if(!n&&!o)return t;let i=t.search(/attribute\s+vec3\s+tangent;/g)!==-1,r=t.search(/attribute\s+vec3\s+bitangent;/g)!==-1,s=o&&n?2:1;s+=i||r?1:0;let a=s>1?`vec${s}`:"float",c="compressedAttributes",u=`attribute ${a} ${c};`,d="",m="";o&&(d+=`vec2 st;
`,m+=`    st = czm_decompressTextureCoordinates(${s>1?`${c}.x`:c});
`),n&&i&&r?(d+=`vec3 normal;
vec3 tangent;
vec3 bitangent;
`,m+=`    czm_octDecode(${c}.${o?"yz":"xy"}, normal, tangent, bitangent);
`):(n&&(d+=`vec3 normal;
`,m+=`    normal = czm_octDecode(${c}${s>1?`.${o?"y":"x"}`:""});
`),i&&(d+=`vec3 tangent;
`,m+=`    tangent = czm_octDecode(${c}.${o&&n?"z":"y"});
`),r&&(d+=`vec3 bitangent;
`,m+=`    bitangent = czm_octDecode(${c}.${o&&n?"z":"y"});
`));let p=t;p=p.replace(/attribute\s+vec3\s+normal;/g,""),p=p.replace(/attribute\s+vec2\s+st;/g,""),p=p.replace(/attribute\s+vec3\s+tangent;/g,""),p=p.replace(/attribute\s+vec3\s+bitangent;/g,""),p=co.replaceMain(p,"czm_non_compressed_main");let _=`void main() 
{ 
${m}    czm_non_compressed_main(); 
}`;return[u,d,p,_].join(`
`)}function TC(e){let t=co.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
    gl_Position = czm_depthClamp(gl_Position);}
`,t}function bC(e){let t=co.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
#if defined(GL_EXT_frag_depth)
    #if defined(LOG_DEPTH)
        czm_writeLogDepth();
    #else
        czm_writeDepthClamp();
    #endif
#endif
}
`,t=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
${t}`,t}function Zm(e,t){let n=e.vertexAttributes}function AC(e,t){return function(){return e[t]}}var La=Math.max(Wt.hardwareConcurrency-1,1),jr,xC=new ca("combineGeometry");function wC(e,t){let n,o,i,r,s=e._instanceIds;if(e._state===et.READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let a=e._numberOfInstances=n.length,c=[],u=[];for(i=0;i<a;++i)o=n[i].geometry,s.push(n[i].id),u.push({moduleName:o._workerName,geometry:o});if(!f(jr))for(jr=new Array(La),i=0;i<La;i++)jr[i]=new ca("createGeometry");let d;for(u=Pu(u,La),i=0;i<u.length;i++){let m=0,p=u[i],_=p.length;for(r=0;r<_;++r)d=p[r],o=d.geometry,f(o.constructor.pack)&&(d.offset=m,m+=y(o.constructor.packedLength,o.packedLength));let g;if(m>0){let v=new Float64Array(m);for(g=[v.buffer],r=0;r<_;++r)d=p[r],o=d.geometry,f(o.constructor.pack)&&(o.constructor.pack(o,v,d.offset),d.geometry=v)}c.push(jr[i].scheduleTask({subTasks:u[i]},g))}e._state=et.CREATING,Promise.all(c).then(function(m){e._createGeometryResults=m,e._state=et.CREATED}).catch(function(m){vi(e,t,et.FAILED,m)})}else if(e._state===et.CREATED){let a=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let c=t.scene3DOnly,u=t.mapProjection,d=xC.scheduleTask(Vr.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:u.ellipsoid,projection:u,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:c,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},a),a);e._createGeometryResults=void 0,e._state=et.COMBINING,Promise.resolve(d).then(function(m){let p=Vr.unpackCombineGeometryResults(m);e._geometries=p.geometries,e._attributeLocations=p.attributeLocations,e.modelMatrix=X.clone(p.modelMatrix,e.modelMatrix),e._pickOffsets=p.pickOffsets,e._offsetInstanceExtend=p.offsetInstanceExtend,e._instanceBoundingSpheres=p.boundingSpheres,e._instanceBoundingSpheresCV=p.boundingSpheresCV,f(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=et.COMBINED):vi(e,t,et.FAILED,void 0)}).catch(function(m){vi(e,t,et.FAILED,m)})}}function SC(e,t){let n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],o=e._numberOfInstances=n.length,i=new Array(o),r=e._instanceIds,s,a,c=0;for(a=0;a<o;a++){s=n[a];let p=s.geometry,_;f(p.attributes)&&f(p.primitiveType)?_=CC(p):_=p.constructor.createGeometry(p),i[c++]=vC(s,_),r.push(s.id)}i.length=c;let u=t.scene3DOnly,d=t.mapProjection,m=Vr.combineGeometry({instances:i,ellipsoid:d.ellipsoid,projection:d,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:u,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=m.geometries,e._attributeLocations=m.attributeLocations,e.modelMatrix=X.clone(m.modelMatrix,e.modelMatrix),e._pickOffsets=m.pickOffsets,e._offsetInstanceExtend=m.offsetInstanceExtend,e._instanceBoundingSpheres=m.boundingSpheres,e._instanceBoundingSpheresCV=m.boundingSpheresCV,f(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=et.COMBINED):vi(e,t,et.FAILED,void 0)}function RC(e,t){let n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!f(n)){e._recomputeBoundingSpheres=!1;return}let o,i=e._offsetInstanceExtend,r=e._instanceBoundingSpheres,s=r.length,a=e._tempBoundingSpheres;if(!f(a)){for(a=new Array(s),o=0;o<s;o++)a[o]=new le;e._tempBoundingSpheres=a}for(o=0;o<s;++o){let v=a[o],b=e._batchTable.getBatchedAttribute(o,n,new l);v=r[o].clone(v),ah(v,b,i[o])}let c=[],u=[],d=[];for(o=0;o<s;++o){let v=a[o];v.center.x-v.radius>0||le.intersectPlane(v,ri.ORIGIN_ZX_PLANE)!==Yt.INTERSECTING?c.push(v):(u.push(v),d.push(v))}let m=c[0],p=d[0],_=u[0];for(o=1;o<c.length;o++)m=le.union(m,c[o]);for(o=1;o<d.length;o++)p=le.union(p,d[o]);for(o=1;o<u.length;o++)_=le.union(_,u[o]);let g=[];for(f(m)&&g.push(m),f(p)&&g.push(p),f(_)&&g.push(_),o=0;o<g.length;o++){let v=g[o].clone(e._boundingSpheres[o]);e._boundingSpheres[o]=v,e._boundingSphereCV[o]=le.projectTo2D(v,t.mapProjection,e._boundingSphereCV[o])}We._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}var Qm=new xo,ih=new ve,rh=new l,sh=new le;function PC(e,t){if(!f(e._batchTableAttributeIndices.distanceDisplayCondition)||e._batchTableBoundingSpheresUpdated)return;let o=e._batchTableBoundingSphereAttributeIndices,i=o.center3DHigh,r=o.center3DLow,s=o.center2DHigh,a=o.center2DLow,c=o.radius,u=t.mapProjection,d=u.ellipsoid,m=e._batchTable,p=e._instanceBoundingSpheres,_=p.length;for(let g=0;g<_;++g){let v=p[g];if(!f(v))continue;let b=e.modelMatrix;f(b)&&(v=le.transform(v,b,sh));let S=v.center,A=v.radius,x=xo.fromCartesian(S,Qm);if(m.setBatchedAttribute(g,i,x.high),m.setBatchedAttribute(g,r,x.low),!t.scene3DOnly){let P=d.cartesianToCartographic(S,ih),z=u.project(P,rh);x=xo.fromCartesian(z,Qm),m.setBatchedAttribute(g,s,x.high),m.setBatchedAttribute(g,a,x.low)}m.setBatchedAttribute(g,c,A)}e._batchTableBoundingSpheresUpdated=!0}var Fa=new l,OC=new l;function Jm(e,t){if(!f(e._batchTableAttributeIndices.offset)||e._batchTableOffsetsUpdated||t.scene3DOnly)return;let o=e._batchTableOffsetAttribute2DIndex,i=t.mapProjection,r=i.ellipsoid,s=e._batchTable,a=e._instanceBoundingSpheres,c=a.length;for(let u=0;u<c;++u){let d=a[u];if(!f(d))continue;let m=s.getBatchedAttribute(u,e._batchTableAttributeIndices.offset);if(l.equals(m,l.ZERO)){s.setBatchedAttribute(u,o,l.ZERO);continue}let p=e.modelMatrix;f(p)&&(d=le.transform(d,p,sh));let _=d.center;_=r.scaleToGeodeticSurface(_,OC);let g=r.cartesianToCartographic(_,ih),v=i.project(g,rh),b=l.add(m,_,Fa);g=r.cartesianToCartographic(b,g);let S=i.project(g,Fa),A=l.subtract(S,v,Fa),x=A.x;A.x=A.z,A.z=A.y,A.y=x,s.setBatchedAttribute(u,o,A)}e._batchTableOffsetsUpdated=!0}function IC(e,t){let n=e._attributeLocations,o=e._geometries,i=t.scene3DOnly,r=t.context,s=[],a=o.length;for(let c=0;c<a;++c){let u=o[c];if(s.push(tm.fromGeometry({context:r,geometry:u,attributeLocations:n,bufferUsage:vr.STATIC_DRAW,interleave:e._interleave})),f(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,u);else if(e._boundingSpheres.push(le.clone(u.boundingSphere)),e._boundingSphereWC.push(new le),!i){let d=u.boundingSphereCV.center,m=d.x,p=d.y,_=d.z;d.x=_,d.y=m,d.z=p,e._boundingSphereCV.push(le.clone(u.boundingSphereCV)),e._boundingSphere2D.push(new le),e._boundingSphereMorph.push(new le)}}e._va=s,e._primitiveType=o[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,vi(e,t,et.COMPLETE,void 0)}function MC(e,t,n,o){let i=n.getRenderState(),r;o?(r=Vt(i,!1),r.cull={enabled:!0,face:Qn.BACK},e._frontFaceRS=ao.fromCache(r),r.cull.face=Qn.FRONT,e._backFaceRS=ao.fromCache(r)):(e._frontFaceRS=ao.fromCache(i),e._backFaceRS=e._frontFaceRS),r=Vt(i,!1),f(e._depthFailAppearance)&&(r.depthTest.enabled=!1),f(e._depthFailAppearance)&&(i=e._depthFailAppearance.getRenderState(),r=Vt(i,!1),r.depthTest.func=am.GREATER,o?(r.cull={enabled:!0,face:Qn.BACK},e._frontFaceDepthFailRS=ao.fromCache(r),r.cull.face=Qn.FRONT,e._backFaceDepthFailRS=ao.fromCache(r)):(e._frontFaceDepthFailRS=ao.fromCache(r),e._backFaceDepthFailRS=e._frontFaceRS))}function zC(e,t,n){let o=t.context,i=e._attributeLocations,r=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);r=We._appendOffsetToShader(e,r),r=We._appendShowToShader(e,r),r=We._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Xm(r),r=We._updateColorAttribute(e,r,!1),r=Km(e,r),r=We._modifyShaderPosition(e,r,t.scene3DOnly);let s=n.getFragmentShaderSource();s=$m(s),e._sp=da.replaceCache({context:o,shaderProgram:e._sp,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i}),Zm(e._sp,i),f(e._depthFailAppearance)&&(r=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),r=We._appendShowToShader(e,r),r=We._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Xm(r),r=We._updateColorAttribute(e,r,!0),r=Km(e,r),r=We._modifyShaderPosition(e,r,t.scene3DOnly),r=TC(r),s=e._depthFailAppearance.getFragmentShaderSource(),s=$m(s),s=bC(s),e._spDepthFail=da.replaceCache({context:o,shaderProgram:e._spDepthFail,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i}),Zm(e._spDepthFail,i))}var Ci=new X,eh=new l;function th(e,t,n,o){let i=f(n)?n._uniforms:void 0,r={},s=t.uniforms;if(f(s))for(let c in s)s.hasOwnProperty(c)&&(r[c]=AC(s,c));let a=Ot(r,i);return a=e._batchTable.getUniformMapCallback()(a),f(e.rtcCenter)&&(a.u_modifiedModelView=function(){let c=o.context.uniformState.view;return X.multiply(c,e._modelMatrix,Ci),X.multiplyByPoint(Ci,e.rtcCenter,eh),X.setTranslation(Ci,eh,Ci),Ci}),a}function DC(e,t,n,o,i,r,s,a){let c=th(e,t,n,a),u;f(e._depthFailAppearance)&&(u=th(e,e._depthFailAppearance,e._depthFailAppearance.material,a));let d=o?ua.TRANSLUCENT:ua.OPAQUE,m=i?2:1;m*=f(e._depthFailAppearance)?2:1,r.length=e._va.length*m;let p=r.length,_=0;for(let g=0;g<p;++g){let v;i&&(v=r[g],f(v)||(v=r[g]=new ai({owner:e,primitiveType:e._primitiveType})),v.vertexArray=e._va[_],v.renderState=e._backFaceRS,v.shaderProgram=e._sp,v.uniformMap=c,v.pass=d,++g),v=r[g],f(v)||(v=r[g]=new ai({owner:e,primitiveType:e._primitiveType})),v.vertexArray=e._va[_],v.renderState=e._frontFaceRS,v.shaderProgram=e._sp,v.uniformMap=c,v.pass=d,f(e._depthFailAppearance)&&(i&&(++g,v=r[g],f(v)||(v=r[g]=new ai({owner:e,primitiveType:e._primitiveType})),v.vertexArray=e._va[_],v.renderState=e._backFaceDepthFailRS,v.shaderProgram=e._spDepthFail,v.uniformMap=u,v.pass=d),++g,v=r[g],f(v)||(v=r[g]=new ai({owner:e,primitiveType:e._primitiveType})),v.vertexArray=e._va[_],v.renderState=e._frontFaceDepthFailRS,v.shaderProgram=e._spDepthFail,v.uniformMap=u,v.pass=d),++_}}We._updateBoundingVolumes=function(e,t,n,o){let i,r,s;if(o||!X.equals(n,e._modelMatrix))for(X.clone(n,e._modelMatrix),r=e._boundingSpheres.length,i=0;i<r;++i)s=e._boundingSpheres[i],f(s)&&(e._boundingSphereWC[i]=le.transform(s,n,e._boundingSphereWC[i]),t.scene3DOnly||(e._boundingSphere2D[i]=le.clone(e._boundingSphereCV[i],e._boundingSphere2D[i]),e._boundingSphere2D[i].center.x=0,e._boundingSphereMorph[i]=le.union(e._boundingSphereWC[i],e._boundingSphereCV[i])));let a=e.appearance.pixelSize;if(f(a))for(r=e._boundingSpheres.length,i=0;i<r;++i){s=e._boundingSpheres[i];let c=e._boundingSphereWC[i],d=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*a;c.radius=s.radius+d}};function NC(e,t,n,o,i,r,s,a){We._updateBoundingVolumes(e,t,i);let c;t.mode===gi.SCENE3D?c=e._boundingSphereWC:t.mode===gi.COLUMBUS_VIEW?c=e._boundingSphereCV:t.mode===gi.SCENE2D&&f(e._boundingSphere2D)?c=e._boundingSphere2D:f(e._boundingSphereMorph)&&(c=e._boundingSphereMorph);let u=t.commandList,d=t.passes;if(d.render||d.pick){let m=e.allowPicking,p=Gr.castShadows(e.shadows),_=Gr.receiveShadows(e.shadows),g=n.length,v=a?2:1;v*=f(e._depthFailAppearance)?2:1;for(let b=0;b<g;++b){let S=Math.floor(b/v),A=n[b];A.modelMatrix=i,A.boundingVolume=c[S],A.cull=r,A.debugShowBoundingVolume=s,A.castShadows=p,A.receiveShadows=_,m?A.pickId="v_pickColor":A.pickId=void 0,u.push(A)}}}We.prototype.update=function(e){if(!f(this.geometryInstances)&&this._va.length===0||f(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&this.geometryInstances.length===0||!f(this.appearance)||e.mode!==gi.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(f(this._error))throw this._error;if(this._state===et.FAILED)return;let t=e.context;if(f(this._batchTable)||yC(this,t),this._batchTable.attributes.length>0){if(Re.maximumVertexTextureImageUnits===0)throw new je("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==et.COMPLETE&&this._state!==et.COMBINED&&(this.asynchronous?wC(this,e):SC(this,e)),this._state===et.COMBINED&&(PC(this,e),Jm(this,e),IC(this,e)),!this.show||this._state!==et.COMPLETE)return;this._batchTableOffsetsUpdated||Jm(this,e),this._recomputeBoundingSpheres&&RC(this,e);let n=this.appearance,o=n.material,i=!1,r=!1;this._appearance!==n?(this._appearance=n,this._material=o,i=!0,r=!0):this._material!==o&&(this._material=o,r=!0);let s=this.depthFailAppearance,a=f(s)?s.material:void 0;this._depthFailAppearance!==s?(this._depthFailAppearance=s,this._depthFailMaterial=a,i=!0,r=!0):this._depthFailMaterial!==a&&(this._depthFailMaterial=a,r=!0);let c=this._appearance.isTranslucent();this._translucent!==c&&(this._translucent=c,i=!0),f(this._material)&&this._material.update(t);let u=n.closed&&c;i&&y(this._createRenderStatesFunction,MC)(this,t,n,u),r&&y(this._createShaderProgramFunction,zC)(this,e,n),(i||r)&&y(this._createCommandsFunction,DC)(this,n,o,c,u,this._colorCommands,this._pickCommands,e),y(this._updateAndQueueCommandsFunction,NC)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,u)};var LC=new le,FC=new le;function ah(e,t,n){if(n===ii.TOP){let o=le.clone(e,LC),i=le.clone(e,FC);i.center=l.add(i.center,t,i.center),e=le.union(o,i,e)}else n===ii.ALL&&(e.center=l.add(e.center,t,e.center));return e}function BC(e,t,n){return function(){let o=e.getBatchedAttribute(t,n),i=e.attributes[n],r=i.componentsPerAttribute,s=re.createTypedArray(i.componentDatatype,r);return f(o.constructor.pack)?o.constructor.pack(o,s,0):s[0]=o,s}}function UC(e,t,n,o,i){return function(r){let s=oh(r);e.setBatchedAttribute(t,n,s),i==="offset"&&(o._recomputeBoundingSpheres=!0,o._batchTableOffsetsUpdated=!1)}}var VC=new l;function kC(e,t,n){t.boundingSphere={get:function(){let o=e._instanceBoundingSpheres[n];if(f(o)){o=o.clone();let i=e.modelMatrix,r=t.offset;f(r)&&ah(o,l.fromArray(r.get(),0,VC),e._offsetInstanceExtend[n]),f(i)&&(o=le.transform(o,i))}return o}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function GC(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}We.prototype.getGeometryInstanceAttributes=function(e){let t=-1,n=this._lastPerInstanceAttributeIndex,o=this._instanceIds,i=o.length;for(let u=0;u<i;++u){let d=(n+u)%i;if(e===o[d]){t=d;break}}if(t===-1)return;let r=this._perInstanceAttributeCache[t];if(f(r))return r;let s=this._batchTable,a=this._batchTableAttributeIndices;r={};let c={};for(let u in a)if(a.hasOwnProperty(u)){let d=a[u];c[u]={get:BC(s,t,d),set:UC(s,t,d,this,u)}}return kC(this,c,t),GC(this,c,t),Object.defineProperties(r,c),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=r,r};We.prototype.isDestroyed=function(){return!1};We.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;let o=this._pickIds;for(e=o.length,t=0;t<e;++t)o[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,It(this)};function vi(e,t,n,o){e._completeLoad(t,n,o)}var ch=We;var uh={};uh.computePositions=function(e,t,n,o,i){let r=e*.5,s=-r,a=o+o,c=i?2*a:a,u=new Float64Array(c*3),d,m=0,p=0,_=i?a*3:0,g=i?(a+o)*3:o*3;for(d=0;d<o;d++){let v=d/o*O.TWO_PI,b=Math.cos(v),S=Math.sin(v),A=b*n,x=S*n,P=b*t,z=S*t;u[p+_]=A,u[p+_+1]=x,u[p+_+2]=s,u[p+g]=P,u[p+g+1]=z,u[p+g+2]=r,p+=3,i&&(u[m++]=A,u[m++]=x,u[m++]=s,u[m++]=P,u[m++]=z,u[m++]=r)}return u};var fh=uh;var Ba=new ne,jC=new l,HC=new l,qC=new l,WC=new l;function On(e){e=y(e,y.EMPTY_OBJECT);let t=e.length,n=e.topRadius,o=e.bottomRadius,i=y(e.vertexFormat,gt.DEFAULT),r=y(e.slices,128);this._length=t,this._topRadius=n,this._bottomRadius=o,this._vertexFormat=gt.clone(i),this._slices=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}On.packedLength=gt.packedLength+5;On.pack=function(e,t,n){return n=y(n,0),gt.pack(e._vertexFormat,t,n),n+=gt.packedLength,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n]=y(e._offsetAttribute,-1),t};var lh=new gt,jo={vertexFormat:lh,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};On.unpack=function(e,t,n){t=y(t,0);let o=gt.unpack(e,t,lh);t+=gt.packedLength;let i=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return f(n)?(n._vertexFormat=gt.clone(o,n._vertexFormat),n._length=i,n._topRadius=r,n._bottomRadius=s,n._slices=a,n._offsetAttribute=c===-1?void 0:c,n):(jo.length=i,jo.topRadius=r,jo.bottomRadius=s,jo.slices=a,jo.offsetAttribute=c===-1?void 0:c,new On(jo))};On.createGeometry=function(e){let t=e._length,n=e._topRadius,o=e._bottomRadius,i=e._vertexFormat,r=e._slices;if(t<=0||n<0||o<0||n===0&&o===0)return;let s=r+r,a=r+s,c=s+s,u=fh.computePositions(t,n,o,r,!0),d=i.st?new Float32Array(c*2):void 0,m=i.normal?new Float32Array(c*3):void 0,p=i.tangent?new Float32Array(c*3):void 0,_=i.bitangent?new Float32Array(c*3):void 0,g,v=i.normal||i.tangent||i.bitangent;if(v){let B=i.tangent||i.bitangent,F=0,N=0,I=0,U=Math.atan2(o-n,t),h=jC;h.z=Math.sin(U);let C=Math.cos(U),T=qC,R=HC;for(g=0;g<r;g++){let D=g/r*O.TWO_PI,k=C*Math.cos(D),M=C*Math.sin(D);v&&(h.x=k,h.y=M,B&&(T=l.normalize(l.cross(l.UNIT_Z,h,T),T)),i.normal&&(m[F++]=h.x,m[F++]=h.y,m[F++]=h.z,m[F++]=h.x,m[F++]=h.y,m[F++]=h.z),i.tangent&&(p[N++]=T.x,p[N++]=T.y,p[N++]=T.z,p[N++]=T.x,p[N++]=T.y,p[N++]=T.z),i.bitangent&&(R=l.normalize(l.cross(h,T,R),R),_[I++]=R.x,_[I++]=R.y,_[I++]=R.z,_[I++]=R.x,_[I++]=R.y,_[I++]=R.z))}for(g=0;g<r;g++)i.normal&&(m[F++]=0,m[F++]=0,m[F++]=-1),i.tangent&&(p[N++]=1,p[N++]=0,p[N++]=0),i.bitangent&&(_[I++]=0,_[I++]=-1,_[I++]=0);for(g=0;g<r;g++)i.normal&&(m[F++]=0,m[F++]=0,m[F++]=1),i.tangent&&(p[N++]=1,p[N++]=0,p[N++]=0),i.bitangent&&(_[I++]=0,_[I++]=1,_[I++]=0)}let b=12*r-12,S=Qe.createTypedArray(c,b),A=0,x=0;for(g=0;g<r-1;g++)S[A++]=x,S[A++]=x+2,S[A++]=x+3,S[A++]=x,S[A++]=x+3,S[A++]=x+1,x+=2;for(S[A++]=s-2,S[A++]=0,S[A++]=1,S[A++]=s-2,S[A++]=1,S[A++]=s-1,g=1;g<r-1;g++)S[A++]=s+g+1,S[A++]=s+g,S[A++]=s;for(g=1;g<r-1;g++)S[A++]=a,S[A++]=a+g,S[A++]=a+g+1;let P=0;if(i.st){let B=Math.max(n,o);for(g=0;g<c;g++){let F=l.fromArray(u,g*3,WC);d[P++]=(F.x+B)/(2*B),d[P++]=(F.y+B)/(2*B)}}let z=new No;i.position&&(z.position=new Ue({componentDatatype:re.DOUBLE,componentsPerAttribute:3,values:u})),i.normal&&(z.normal=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:m})),i.tangent&&(z.tangent=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:p})),i.bitangent&&(z.bitangent=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:3,values:_})),i.st&&(z.st=new Ue({componentDatatype:re.FLOAT,componentsPerAttribute:2,values:d})),Ba.x=t*.5,Ba.y=Math.max(o,n);let L=new le(l.ZERO,ne.magnitude(Ba));if(f(e._offsetAttribute)){t=u.length;let B=e._offsetAttribute===ii.NONE?0:1,F=new Uint8Array(t/3).fill(B);z.applyOffset=new Ue({componentDatatype:re.UNSIGNED_BYTE,componentsPerAttribute:1,values:F})}return new Fe({attributes:z,indices:S,primitiveType:Oe.TRIANGLES,boundingSphere:L,offsetAttribute:e._offsetAttribute})};var Ua;On.getUnitCylinder=function(){return f(Ua)||(Ua=On.createGeometry(new On({topRadius:1,bottomRadius:1,length:1,vertexFormat:gt.POSITION_ONLY}))),Ua};var Va=On;var YC=Be.RED,XC=Be.GREEN,$C=Be.BLUE;function Hr(e){this._length=e.length,this._modelMatrix=e.modelMatrix,this._radius=e.radius,this._xAxisColor=y(e.xAxisColor,YC),this._yAxisColor=y(e.yAxisColor,XC),this._zAxisColor=y(e.zAxisColor,$C),this._init()}Hr.prototype._init=function(){this._bodyRadius=this._radius?this._radius:this._length*.015,this._headRadius=this._bodyRadius*2,this._headLength=this._headRadius*2,this._bodyLength=this._length-this._headLength,this._bodyLength<0&&(this._bodyLength=0);let e=1;this._xAxisAttr={color:qi.fromColor(this._xAxisColor.withAlpha(e))},this._yAxisAttr={color:qi.fromColor(this._yAxisColor.withAlpha(e))},this._zAxisAttr={color:qi.fromColor(this._zAxisColor.withAlpha(e))},this._primitive=this._createPrimitive()};Hr.prototype._createPrimitive=function(){let e=gt.POSITION_ONLY,t=new Va({length:this._headLength,topRadius:0,bottomRadius:this._headRadius,vertexFormat:e}),n=new Va({length:this._bodyLength,topRadius:this._bodyRadius,bottomRadius:this._bodyRadius,vertexFormat:e}),o=this._bodyLength/2,i=this._bodyLength+this._headLength/2,r=new l(o,0,0),s=new l(i,0,0),a=new l(0,o,0),c=new l(0,i,0),u=new l(0,0,o),d=new l(0,0,i),m=Z.fromRotationY(Math.toRadians(90)),p=Z.fromRotationX(Math.toRadians(-90)),_=X.fromRotationTranslation(m,r),g=X.fromRotationTranslation(m,s),v=X.fromRotationTranslation(p,a),b=X.fromRotationTranslation(p,c),S=X.fromTranslation(u),A=X.fromTranslation(d),x=[],P=[],z=[],L=new Kn({geometry:n,modelMatrix:_,attributes:this._xAxisAttr,id:{isEvCoordAxis:!0,instances:x,vector:new l(1,0,0),normal:l.UNIT_Z},pickPrimitive:this}),B=new Kn({geometry:t,modelMatrix:g,attributes:this._xAxisAttr,id:{isEvCoordAxis:!0,instances:x,vector:new l(1,0,0),normal:l.UNIT_Z},pickPrimitive:this}),F=new Kn({geometry:n,modelMatrix:v,attributes:this._yAxisAttr,id:{isEvCoordAxis:!0,instances:P,vector:new l(0,1,0),normal:l.UNIT_Z},pickPrimitive:this}),N=new Kn({geometry:t,modelMatrix:b,attributes:this._yAxisAttr,id:{isEvCoordAxis:!0,instances:P,vector:new l(0,1,0),normal:l.UNIT_Z},pickPrimitive:this}),I=new Kn({geometry:n,modelMatrix:S,attributes:this._zAxisAttr,id:{isEvCoordAxis:!0,instances:z,vector:new l(0,0,1),normal:l.UNIT_X},pickPrimitive:this}),U=new Kn({geometry:t,modelMatrix:A,attributes:this._zAxisAttr,id:{isEvCoordAxis:!0,instances:z,vector:new l(0,0,1),normal:l.UNIT_X},pickPrimitive:this});return x.push(L,B),P.push(F,N),z.push(I,U),new ch({geometryInstances:[L,B,F,N,I,U],modelMatrix:this._modelMatrix,appearance:new Ac({flat:!0,translucent:!1,renderState:{}}),cull:!0})};Hr.prototype.update=function(e){this._primitive.update(e)};var dh=Hr;function nt(e){this._viewer=e.viewer,this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._editObject=null,this._editing=!1,this._positionPrimitive=null,this._positionPlane=null,this._highlightColor=null,this._editingColor=new Cesium.Color(1,0,0,.8),this._editingAxis=null,this._positionChanged=new Cesium.Event,this._modelMatrixChanged=new Cesium.Event,this._createPositionPrimitive({position:Cesium.Cartesian3.ZERO,size:Cesium.defaultValue(e.size,20)})}Object.defineProperties(nt.prototype,{modelMatrixChanged:{get:function(){return this._modelMatrixChanged}},positionChanged:{get:function(){return this._positionChanged}},coordAxis:{get:function(){return this._modelMatrixPrimitive}}});nt.prototype.startEdit=function(){this.editPosition(),this._editing=!0};nt.prototype.stopEdit=function(){this.hideCoordAxis(),this._handler._inputEvents={},this._editing=!1,this._editObject=null};nt.prototype._preventCameraOperation=function(){this._viewer.scene.screenSpaceCameraController.enableInputs=!1};nt.prototype._renewCameraOperation=function(){this._viewer.scene.screenSpaceCameraController.enableInputs=!0};nt.prototype._setEditAction=function(){};nt.prototype.editPosition=function(e){let t=this,n=0,o=20,i=null,r=new Cesium.Ray,s=!1;this.setPosition(e),this._handler.setInputAction(function(a){let c=t._viewer.scene.pick(a.position);!c||c.id===t._positionPrimitive&&(s=!0,t._preventCameraOperation(),t.hideCoordAxis(),t._createPositionPlane())},Cesium.ScreenSpaceEventType.LEFT_DOWN),this._handler.setInputAction(function(a){if(s){let c=performance.now();if(c-n<o)return;n=c,t._viewer.camera.getPickRay(a.endPosition,r);let u=Cesium.IntersectionTests.rayPlane(r,t._positionPlane);if(!u)return;i=u,t._positionChanged.raiseEvent(u)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this._handler.setInputAction(function(){s&&(t.setPosition(i),t._renewCameraOperation(),i=null,s=!1)},Cesium.ScreenSpaceEventType.LEFT_UP)};nt.prototype._setTranslation=function(e){let t=this._modelMatrixPrimitive._primitive.modelMatrix,n=Cesium.Matrix4.getTranslation(t,new Cesium.Cartesian3);n=Cesium.Cartesian3.add(n,e,n),Cesium.Matrix4.setTranslation(t,n,t),n=Cesium.Matrix4.getTranslation(this._modelMatrixPrimitive._primitive.modelMatrix,new Cesium.Cartesian3),this._positionChanged.raiseEvent(n),this._modelMatrixChanged.raiseEvent(this._modelMatrixPrimitive._primitive.modelMatrix)};nt.prototype._createModelMatrixPrimitive=function(e){let t=e.position,n=e.length,o=e.radius,i;t?i=Cesium.Transforms.eastNorthUpToFixedFrame(t):i=Cesium.Matrix4.IDENTITY,this._modelMatrixPrimitive=new dh({length:n,radius:o,modelMatrix:i}),this._viewer.scene.primitives.add(this._modelMatrixPrimitive._primitive)};nt.prototype._createPositionPrimitive=function(e){let t=e.position,n=e.size;this._positionPrimitive=this._viewer.entities.add({position:t,point:{pixelSize:n,color:Cesium.Color.CYAN,disableDepthTestDistance:1e3}})};nt.prototype._createPositionPlane=function(){let e=this._positionPrimitive.position._value,t=Cesium.Cartesian3.magnitude(e),n=Cesium.Cartesian3.normalize(e,new Cesium.Cartesian3);this._positionPlane=new Cesium.Plane(n,-t)};nt.prototype._removeModelMatrixPrimitive=function(){!this._positionPrimitive||(this._viewer.entities.remove(this._positionPrimitive),this._positionPrimitive=null)};nt.prototype._setEditingColor=function(){!this._editObject||(this._highlightColor=this._editObject.color,this._editObject.color=this._editingColor)};nt.prototype._removeEditingColor=function(){!this._editObject||(this._editObject.color=this._highlightColor)};nt.prototype._computeAxisDirection=function(e){if(!this._modelMatrixPrimitive)return;let t=this._modelMatrixPrimitive._primitive.modelMatrix,n=Cesium.Matrix4.multiplyByPoint(t,e,new Cesium.Cartesian3),o=Cesium.Matrix4.getTranslation(t,new Cesium.Cartesian3),i=Cesium.Cartesian3.subtract(n,o,new Cesium.Cartesian3);return i=Cesium.Cartesian3.normalize(i,i),i};nt.prototype._getAxisPlane=function(){if(!(this._modelMatrixPrimitive&&this._editingAxis))return;let e=this._modelMatrixPrimitive._primitive.modelMatrix;if(!e)return;let t=this._editingAxis.id.vector.clone();t=Cesium.Matrix4.multiplyByPoint(e,t,t);let n=Cesium.Matrix4.getTranslation(e,new Cesium.Cartesian3);t=Cesium.Cartesian3.subtract(t,n,t);let o=Cesium.Cartesian3.cross(t,this._viewer.camera.rightWC,t);o=Cesium.Cartesian3.normalize(o,o),Cesium.Cartesian3.angleBetween(o,n)>Math.PI_OVER_TWO&&(o=Cesium.Cartesian3.negate(o,o));let r=Cesium.Cartesian3.dot(o,n);return r=-r,new Cesium.Plane(o,r)};nt.prototype.showCoordAxis=function(){!this._positionPrimitive||(this._positionPrimitive.show=!0)};nt.prototype.hideCoordAxis=function(){!this._positionPrimitive||(this._positionPrimitive.show=!1)};nt.prototype.setPosition=function(e){this._positionPrimitive.position.setValue(e.clone()),this._positionPrimitive.show||this.showCoordAxis()};var qr=nt;var ka=.01;function ae(e){this.viewer=e.viewer,this._container=KC(e.container),this._handlerForCreate=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),this._handlerForOrientation=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),this._planeHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),this._editor=new qr({viewer:this.viewer,axisLength:e.axisLength,axisRadius:e.axisRadius}),this._editor.positionChanged.addEventListener(this._onPositionChanged,this),this._videoLayer=null,this._editObject=null,this._videoCameraAxis=null,this._cameraFrustumPrimitive=null,this._cameraPrimitives=[],this._isEditPosition=!1,this._isEditOrientation=!1,this._addedVideo=new Cesium.Event,this._editObjectChanged=new Cesium.Event,this._changed=new Cesium.Event,this._viewPointPlane=null,this._viewPointRay=new Cesium.Ray,this._editing=!1,this._showCameraFrustrum=!0,Cesium.defaultValue(e.createUI,!1)&&(this.top=Cesium.defaultValue(e.top,"0px"),this.left=Cesium.defaultValue(e.left,"0px"),this._styleElement=null,this._UIElement=null,this._createUI(Cesium.defaultValue(e.cssFileUrl,"../css/videoFusionEditor.css")))}Object.defineProperties(ae.prototype,{addedVideo:{get:function(){return this._addedVideo}},editObjectChanged:{get:function(){return this._editObjectChanged}},changed:{get:function(){return this._changed}},editObject:{get:function(){return this._editObject}}});ae.prototype.stopEdit=function(){this._editing=!1,this._editor.stopEdit(),this._videoCameraViewPoint&&(this._videoCameraViewPoint.show=!1),this._cameraFrustumPrimitive&&(this._cameraFrustumPrimitive.show=!1)};ae.prototype.createVideoLayer=function(e){return this._videoLayer=new Wo({viewer:this.viewer,name:e.name,visibleDistance:e.visibleDistance,wsServer:e.wsServer}),this._videoLayer.added.addEventListener(function(t){this._addedVideo.raiseEvent(t),this._setEditObject(t),t.isEditMode=!0},this),this._videoLayer};ae.prototype.loadVideoLayer=function(e){return this._videoLayer=new Wo({viewer:this.viewer,videoJsonFile:e.url}),this._videoLayer.added.addEventListener(function(t){t.isEditMode=!0,this._setEditObject(t),this._addedVideo.raiseEvent(t)},this),this._videoLayer};ae.prototype.createVideoModelProjection=function(e){e.projectionType=1,this._createVideoProjection(e)};ae.prototype.createVideoPlaneProjection=function(e){e.projectionType=0,this._createVideoProjection(e)};ae.prototype._createVideoProjection=function(e){let t=e.name,n=e.url,o=Cesium.defaultValue(e.offsetHeight,1),i=Cesium.defaultValue(e.farClip,50),r=this,s=!0,a=null,c=document.createElement("video");c.muted=!0,c.loop=!0,c.setAttribute("crossorigin","anonymous"),c.autoplay=!0,c.style.display="none",c.id=`v${new Date().getTime()+Math.floor(Math.random()*1e3)}`,document.body.appendChild(c);let u,d="",m;if(/^rtsp:\/\//.test(n))u=new Mn({layer:this._videoLayer,wsserver:this._videoLayer.wsServe,rtspurl:n,mediaplayer:c,protocol:e.protocol}),u.openws(),d="rtsp";else if(/\./.test(n)){c.src=n;let p=n.split("/");m=p[p.length-1]}else{let p=new Mn({layer:this._videoLayer,wsserver:this._videoLayer.wsServe,rtspurl:"",mediaplayer:c,protocol:e.protocol});p.openws(),p.playGB(),p.playGBDevice(n),d="gb"}e.wsplayer=u,this._handlerForCreate.setInputAction(function(p){let _=r.viewer.scene.pickPosition(p.position);!_||(s?(_=r._changeHeight(_,o),e.projectionType===0?a=r._createVideoPlaneProjection({name:t,url:n,position:_,videoElement:c,wsplayer:u}):e.projectionType===1&&(a=r._createVideoModelProjection({name:t,url:n,position:_,videoElement:c,wsplayer:u,farClip:i,wsplayerType:d})),r._editing=!0,r._setEditObject(a)):(a._fileName=m,r._handlerForCreate.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),r._handlerForCreate.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE)),s=!1)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this._handlerForCreate.setInputAction(function(p){if(s)return;let _=r.viewer.scene.pickPosition(p.endPosition);!_||r._setVideoCameraViewPoint(_)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};ae.prototype._createVideoModelProjection=function(e){let t=e.name,n=e.videoElement,o=e.position;o=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(o);let i=this.viewer.camera,r=Cesium.Math.toDegrees(o.longitude),s=Cesium.Math.toDegrees(o.latitude),a=Cesium.Math.toDegrees(i.heading),c=Cesium.Math.toDegrees(i.pitch),u=Cesium.Math.toDegrees(i.roll);return this._videoLayer.addVideoModelProjection({name:t,viewer:this.viewer,layer:this._videoLayer,videoElement:n,originLon:r,originLat:s,originHeight:o.height,heading:a,pitch:c,roll:u,farClip:e.farClip,wsplayer:e.wsplayer,isEditMode:!0,wsplayerType:e.wsplayerType})};ae.prototype._createVideoPlaneProjection=function(e){let t=e.position;t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(t);let n=Cesium.Math.toDegrees(t.longitude),o=Cesium.Math.toDegrees(t.latitude),i=this.viewer.camera,r=Cesium.Math.toDegrees(i.heading),s=Cesium.Math.toDegrees(i.pitch),a=Cesium.Math.toDegrees(i.roll);return this._videoLayer.addVideoPlaneProjection({viewer:this.viewer,name:e.name,videoElement:e.videoElement,layer:this._videoLayer,originLon:n,originLat:o,originHeight:t.height,heading:r,pitch:s,roll:a,wsplayer:e.wsplayer})};var lt=null,jn=[],Wr=null,hn=null;ae.prototype.createProjectionPlane=function(){!(this._editObject&&this._editObject._projectionMode===0)||(hn=this._editObject._createProjectionPlane(),lt=hn._originalPoints,this._editProjectionPlane())};ae.prototype._editProjectionPlane=function(){let e=!1,t=null,n=null,o,i=Cesium.Color.YELLOW,r=new Cesium.Color(0,1,0,.8),s=null,a=new Cesium.Ray,c=this;this._planeHandler.setInputAction(function(m){let p=c.viewer.scene.pick(m.position);if(p){let _=jn.indexOf(p.id);if(_!==-1){e=!0,t=p.id,o=_,t.show=!1,c._editor._preventCameraOperation();let g=lt[_],v=Cesium.Cartesian3.normalize(g,new Cesium.Cartesian3);s=Cesium.Plane.fromPointNormal(g,v),a.origin=c.viewer.camera.positionWC}}},Cesium.ScreenSpaceEventType.LEFT_DOWN),this._planeHandler.setInputAction(function(m){t&&(t.show=!0,t=null),c._editor._renewCameraOperation(),e=!1},Cesium.ScreenSpaceEventType.LEFT_UP),this._planeHandler.setInputAction(function(m){let p=c.viewer.scene.pick(m.position);if(p&&p.primitive instanceof In)return c._setEditProjectionPlane(p.primitive);let _=c.viewer.scene.pickPosition(m.position);!_||(_=c._changeHeight(_,.01),hn.addPoint(_),c._addVertexEntity(_),c._createProjectionPlaneOutline())},Cesium.ScreenSpaceEventType.LEFT_CLICK),this._planeHandler.setInputAction(function(m){let p=c.viewer.scene.pick(m.position);if(p){let _=jn.indexOf(p.id);_!==-1&&(hn.deletePointByIndex(_),c.viewer.entities.remove(p.id),jn.splice(_,1))}},Cesium.ScreenSpaceEventType.RIGHT_CLICK);let u=!1;this._planeHandler.setInputAction(function(m){if(e){let p=c.viewer.scene.pickPosition(m.endPosition);if(!p)return;let _=Cesium.Cartesian3.subtract(p,a.origin,p);if(a.direction=_,p=Cesium.IntersectionTests.rayPlane(a,s,p),!p)return;hn.setPoint(p,o),lt[o]=p,t.position.setValue(p)}else{let p=c.viewer.scene.pick(m.endPosition);o=p?jn.indexOf(p.id):-1,o!==-1?(n&&(n.point.color=i),p.id.point.color=r,n=p.id,c._editor._preventCameraOperation(),u=!0,t=p.id):n&&(n.point.color=i,n=null,c._editor._renewCameraOperation(),u=!1)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this._planeHandler.setInputAction(d,Cesium.ScreenSpaceEventType.WHEEL),this._planeHandler.setInputAction(d,Cesium.ScreenSpaceEventType.WHEEL,Cesium.KeyboardEventModifier.CTRL);function d(m){if(!u)return;let p=lt[o],_=c.viewer.scene.globe.ellipsoid.cartesianToCartographic(p);_.height+=m/100*ka,p=c.viewer.scene.globe.ellipsoid.cartographicToCartesian(_,p),hn.setPoint(p,o),n.position.setValue(p)}};ae.prototype.setProjectionPlaneVertexHeightStep=function(e){e>0&&(ka=e)};ae.prototype.getProjectionPlaneVertexHeightStep=function(){return ka};ae.prototype.stopProjectionPlane=function(){for(let e=0;e<jn.length;++e)this.viewer.entities.remove(jn[e]);this.viewer.entities.remove(Wr),lt=null,jn.length=0,Wr=null,hn=null,this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOWN),this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_UP),this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK),this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),this._planeHandler.removeInputAction(Cesium.ScreenSpaceEventType.WHEEL)};ae.prototype.adjustProjectionPlane=function(){let e=this;this._planeHandler.setInputAction(function(t){let n=e.viewer.scene.pick(t.position);if(!!n&&n.primitive instanceof In){if(e._setEditObject(n.primitive._owner),hn=n.primitive,lt=n.primitive._originalPoints,lt.length>0){for(let o=0;o<lt.length;++o)e._addVertexEntity(lt[o]);e._createProjectionPlaneOutline()}e._editProjectionPlane()}},Cesium.ScreenSpaceEventType.LEFT_CLICK)};ae.prototype._setEditProjectionPlane=function(e){if(hn&&this.stopProjectionPlane(),this._setEditObject(e._owner),hn=e,lt=e._originalPoints,lt.length>0){for(let t=0;t<lt.length;++t)this._addVertexEntity(lt[t]);this._createProjectionPlaneOutline()}this._editProjectionPlane()};ae.prototype._addVertexEntity=function(e){let t=this.viewer.entities.add({position:e,point:{pixelSize:10,color:Cesium.Color.YELLOW,disableDepthTestDistance:1e3}});jn.push(t)};ae.prototype._createProjectionPlaneOutline=function(){!Wr&&lt.length>1&&(Wr=this.viewer.entities.add({polyline:{positions:new Cesium.CallbackProperty(function(){return lt.length===2?lt:lt.concat(lt[0])},!1),width:3,arcType:Cesium.ArcType.NONE,material:Cesium.Color.YELLOW}}))};ae.prototype.remove=function(){this._videoLayer.remove(this._editObject),this._editObject=null};ae.prototype.editVideoCameraPosition=function(){this._editing=!0,this._isEditPosition=!0,this._isEditOrientation=!1,this._removeVideoCameraOrientationAction(),this._videoCameraViewPoint&&(this._videoCameraViewPoint.show=!1),this._editObject&&this._editObject.videoCamera&&(this._createCameraFrustumPrimitive(this._editObject.videoCamera),this._editor.editPosition(this._editObject.videoCamera.positionWC))};ae.prototype.editVideoCameraOrientation=function(){if(this._editing=!0,this._isEditPosition=!1,this._isEditOrientation=!0,!this._editObject)return;this._editor.hideCoordAxis(),this._videoCameraViewPoint?(this._videoCameraViewPoint.position.setValue(this._editObject._viewPoint),this._videoCameraViewPoint.show||(this._videoCameraViewPoint.show=!0)):this._createVideoCameraViewPoint(),this._editObject._viewPoint&&this._setCameraViewPointPlane(this._editObject._viewPoint);let e=this,t=!1;this._handlerForOrientation.setInputAction(function(o){let i=e.viewer.scene.pick(o.position);!i||i.id===e._videoCameraViewPoint&&(t=!0,e._editor._preventCameraOperation(),e._videoCameraViewPoint.show=!1)},Cesium.ScreenSpaceEventType.LEFT_DOWN),this._handlerForOrientation.setInputAction(function(o){if(!t||(e._viewPointRay=e.viewer.camera.getPickRay(o.endPosition),!e._viewPointRay))return;let i=Cesium.IntersectionTests.rayPlane(e._viewPointRay,e._viewPointPlane);e._videoCameraViewPoint.position.setValue(i.clone()),e._setVideoCameraViewPoint(i)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this._handlerForOrientation.setInputAction(function(o){t=!1,e._editor._renewCameraOperation(),e._videoCameraViewPoint.show=!0},Cesium.ScreenSpaceEventType.LEFT_UP);let n=this._editObject.videoCamera;!n||this._createCameraFrustumPrimitive(n)};ae.prototype._removeVideoCameraOrientationAction=function(){this._handlerForOrientation.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOWN),this._handlerForOrientation.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_UP),this._handlerForOrientation.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE)};ae.prototype._createCameraFrustumPrimitive=function(e){this._cameraFrustumPrimitive?this._cameraFrustumPrimitive._camera=e:this._cameraFrustumPrimitive=this.viewer.scene.primitives.add(new Cesium.DebugCameraPrimitive({show:this._showCameraFrustrum,camera:e,depthTest:!1,allowPicking:!1}))};ae.prototype._createVideoCameraViewPoint=function(){if(!this._editObject)return;let e=this._editObject._viewPoint.clone();!e||(this._videoCameraViewPoint=this.viewer.entities.add({position:e,point:{pixelSize:20,color:Cesium.Color.CYAN,disableDepthTestDistance:1e3}}))};ae.prototype._setVideoCameraViewPoint=function(e){!this._editObject||this._editObject.setCameraViewPoint(e)};ae.prototype._onPositionChanged=function(e){this._editObject.setVideoCameraPosition(e)};ae.prototype._changeHeight=function(e,t){let n=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e);return n.height+=t,this.viewer.scene.globe.ellipsoid.cartographicToCartesian(n,e)};ae.prototype._setEditObject=function(e){if(e===this._editObject)return;this._editObject&&this._editObject.changed.removeEventListener(this._onEditChanged,this),e.changed.addEventListener(this._onEditChanged,this),this._editObject=e,this._editObjectChanged.raiseEvent(e),e.projectionMode!==0&&this.stopProjectionPlane();let t=this;e.cameraPromise.then(function(n){t._editing&&t._createCameraFrustumPrimitive(n),t._isEditPosition?t.editVideoCameraPosition():t._isEditOrientation&&t.editVideoCameraOrientation()})};ae.prototype._onEditChanged=function(){this._changed.raiseEvent(this._editObject)};ae.prototype.setEditObjectByName=function(e){let t=this._videoLayer.getProjectionByName(e);if(!t)throw new Error(`\u4E0D\u5B58\u5728\u540D\u79F0\u4E3A \u2018${e}\u2019 \u7684\u89C6\u9891\u6295\u5F71\u5BF9\u8C61\uFF01`);this._setEditObject(t)};ae.prototype.viewToEditVideo=function(){if(!this._editObject)return;let e=this._editObject;if(e.videoCamera){let t=e.videoCamera.positionWC;this.viewer.camera.setView({destination:t,orientation:{heading:e.videoCamera.heading,pitch:e.videoCamera.pitch}}),e._videoCameraPostureChanged=!0}else{let t=Cesium.Cartographic.fromDegrees(e._originLon,e._originLat,e._originHeight);this.viewer.camera.setView({destination:this.viewer.scene.globe.ellipsoid.cartographicToCartesian(t),orientation:{heading:Cesium.Math.toRadians(e._heading),pitch:Cesium.Math.toRadians(e._pitch)}})}};ae.prototype.getJson=function(e){return e=Cesium.defaultValue(e,2),JSON.stringify(this._videoLayer.getJsonData(),void 0,e)};ae.prototype.createConfigurationFile=function(e){e=Cesium.defaultValue(e,{});let t=Cesium.defaultValue(e.fileName,"\u89C6\u9891\u878D\u5408\u914D\u7F6E\u6587\u4EF6"),n=this.getJson(e.space),o=new Blob([n],{type:"text/json"}),i=document.createElement("a");i.download=`${t}.json`,i.href=URL.createObjectURL(o);let r=new MouseEvent("click");i.dispatchEvent(r)};ae.prototype._createUI=function(e){let t=document.createElement("style");t.textContent=`@import url(${e});`,this._container.ownerDocument.head.appendChild(t),this._styleElement=t;let n=document.createElement("table");n.id="videoFusionEditor",n.innerHTML='        <div class="inlineColumn">\u89C6\u9891\u878D\u5408\u7F16\u8F91\u5668</div>        <!-- \u521D\u59CB\u754C\u9762 -->        <div id="homeUI" class="UI">            <div class="inlineColumn">                <input type="button" id="addVideoLayerBtn" class="menuBtn" value="\u65B0\u5EFA\u89C6\u9891\u56FE\u5C42">                <input type="button" id="loadVideoLayerBtn" class="menuBtn" value="\u52A0\u8F7D\u89C6\u9891\u56FE\u5C42">                <input type="button" id="editVideoLayerBtn" class="menuBtn" value="\u7EE7\u7EED\u7F16\u8F91" style="display: none;">            </div>        </div>        <!-- \u89C6\u9891\u56FE\u5C42\u8F93\u5165\u754C\u9762 -->        <div id="videoLayerUI" style="display: none;"  class="UI">            <div class="inlineColumn">                <div class="columnHead"><span>\u56FE\u5C42\u540D\u79F0</span></div>                <div class="columnBody"><input id="videoLayerName" class="videoInfoInput" placeholder="\u8BF7\u547D\u540D\u8BE5\u56FE\u5C42"></div>            </div>            <div class="inlineColumn">                <div class="columnHead"><span>\u670D\u52A1\u5730\u5740</span></div>                <div class="columnBody"><input id="videoLayerServer" class="videoInfoInput" placeholder="\u8BF7\u8F93\u5165\u89C6\u9891\u670D\u52A1\u5730\u5740"></div>            </div>            <div class="inlineColumn">                <div class="columnHead"><span>\u53EF\u89C6\u8DDD\u79BB</span></div>                <div class="columnBody"><input id="videoLayerVisibleDistance" class="videoInfoInput" value="1000"></div>            </div>            <div class="inlineColumn">                <input type="button" id="createVideoLayer" class="menuBtn confirmBtn" value="\u521B\u5EFA\u89C6\u9891\u56FE\u5C42">            </div>        </div>        <!-- \u52A0\u8F7D\u89C6\u9891\u56FE\u5C42\u754C\u9762 -->    <div id="loadVideoLayerUI" style="display: none;" class="UI">        <div>                <span class="nameForInput">\u914D\u7F6E\u6587\u4EF6\uFF1A</span>                <!-- <input type="file" accept="application/json" id="configFile" style ="width: 80px;height:35px;font-size:15px"> -->        </div>        <div class="inlineColumn">                <input id="configFile" class="videoInfoInput" placeholder="\u8BF7\u8F93\u5165\u914D\u7F6E\u6587\u4EF6\u5730\u5740">        </div>        <div class="inlineColumn">                <input type="button" id="loadVideoLayer" class="menuBtn" value="\u786E\u5B9A">        </div>    </div>        <!-- \u89C6\u9891\u8F93\u5165\u754C\u9762 -->        <div id="videoProjectionUI" style="display: none;" class="UI">            <div id="videoProjectionMenuUI">                <div class="inlineColumn">                    <input id="addVideoModelProjection" class="menuBtn" type="button" value="\u6DFB\u52A0\u6A21\u578B\u6295\u5F71">                    <input id="addVideoPlaneProjection" class="menuBtn disableBtn" type="button" value="\u6DFB\u52A0\u5E73\u9762\u6295\u5F71" disabled>                </div>            </div>            <div id="videoModelProjectionUI"  style="display: none;">                <div class="inlineColumn">                    <div class="columnHead"><span>\u89C6\u9891\u540D\u79F0</span></div>                    <div class="columnBody"><input id="videoName" class="videoInfoInput" placeholder="\u8BF7\u547D\u540D\u8BE5\u89C6\u9891"></div>                </div>                <div class="inlineColumn">                    <div class="columnHead"><span>\u89C6\u9891\u5730\u5740</span></div>                    <div class="columnBody"><input id="videoUrl" class="videoInfoInput" placeholder="\u8BF7\u8F93\u5165\u89C6\u9891\u5730\u5740,\u4E0D\u80FD\u4E3A\u7A7A\uFF01" validationMessage="\u89C6\u9891\u5730\u5740,\u4E0D\u80FD\u4E3A\u7A7A\uFF01" required></div>                </div>                <div class="inlineColumn">                    <input id="createVideoModelProjection" class="menuBtn confirmBtn" type="button" value="&nbsp;\u786E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5B9A&nbsp;">                </div>                <div>                    <p class="hint">\u64CD\u4F5C\u63D0\u793A\uFF1A\u70B9\u51FB\u786E\u5B9A\u540E\uFF0C\u5728\u573A\u666F\u4E2D\u5355\u51FB\u9009\u53D6\u89C6\u9891\u76F8\u673A\u4F4D\u7F6E\uFF0C\u968F\u540E\u79FB\u52A8\u9F20\u6807\u8C03\u6574\u59FF\u6001\uFF0C\u518D\u6B21\u5355\u51FB\u786E\u8BA4\u59FF\u6001\u3002</p>                </div>            </div>        </div>        <!-- \u89C6\u9891\u6295\u5F71\u53C2\u6570\u7F16\u8F91\u754C\u9762 -->        <div  id="detailInfo" style="display: none;" class="UI">            <div class="inlineColumn">                <div class="columnHead">\u89C6\u9891\u5217\u8868</div>                <div class="columnBody"><select class="form-control" id="videoname"></select></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u76F8\u673A\u9AD8\u5EA6</div>                <div class="columnBody"><input type="number" id="originHeight"  class="regulatearc" min="0" max="10000" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u89C6\u70B9\u9AD8\u5EA6</div>                <div class="columnBody"><input type="number" id="viewPointHeight"  class="regulatearc" min="0" max="10000" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u7FFB\u6EDA\u89D2\u5EA6</div>                <div class="columnBody"><input type="number" id="roll"  class="regulatearc" min="-180" max="180" value="0"  step="0.1"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="rollv" min="-180" max="180" value="0" step="0.1"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u5F20\u5F00\u89D2\u5EA6</div>                <div class="columnBody"><input type="number" id="fov"  class="regulatearc" min="0" max="180" value="0" step="0.1"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="fovv" min="0" max="180" value="0" step="0.1"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u900F&nbsp;\u660E&nbsp;\u5EA6&nbsp;</div>                <div class="columnBody"><input type="number" id="alpha"  class="regulatearc" min="0" max="1" value="1" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="alphav" min="0" max="1" value="1" step="0.01"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u8FD1\u88C1\u526A\u9762</div>                <div class="columnBody"><input type="number" id="near"  class="regulatearc" min="0.01" max="100" value="1" step="0.1"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="nearv" min="0.01" max="100" value="1" step="0.1"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u8FDC\u88C1\u526A\u9762</div>                <div class="columnBody"><input type="number" id="far"  class="regulatearc" min="1" max="100" value="10" step="0.1"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="farv" min="1" max="100" value="10" step="0.1"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u7578&nbsp;\u53D8&nbsp;k1</div>                <div class="columnBody"><input type="number" id="k1"  class="regulatearc" min="-1" max="1" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="k1v" min="-1" max="1" step="0.01" value="0"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u7578&nbsp;\u53D8&nbsp;k2</div>                <div class="columnBody"><input type="number" id="k2"  class="regulatearc" min="-1" max="1" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="k2v" min="-1" max="1" step="0.01" value="0"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u8272&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u76F8</div>                <div class="columnBody"><input type="number" id="hue"  class="regulatearc" min="-1.0" max="1.0" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="huev" min="-1.0" max="1.0" step="0.01" value="0"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u9971&nbsp;\u548C&nbsp;\u5EA6&nbsp;</div>                <div class="columnBody"><input type="number" id="saturation"  class="regulatearc" min="-1.0" max="1.0" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="saturationv" min="-1.0" max="1.0" step="0.01" value="0"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u660E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5EA6</div>                <div class="columnBody"><input type="number" id="val"  class="regulatearc" min="-1.0" max="1.0" value="0" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="rangeInput"><input type="range" class="regulatearcr" id="valv" min="-1.0" max="1.0" step="0.01" value="0"/></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u8DDD\u79BB\u8BEF\u5DEE</div>                <div class="columnBody"><input type="number" id="distanceError"  class="regulatearc" min="0.01" max="1" value="0.1" step="0.01"></div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u5DE6\u4E0A\u88C1\u526A</div>                <div class="columnBody">                    <input type="range" class="regulatearcr" id="leftUpX" min="0" max="1" step="0.01" value="0"/>                    <input type="range" class="regulatearcr" id="leftUpY" min="0" max="1" step="0.01" value="1"/>                </div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u5DE6\u4E0B\u88C1\u526A</div>                <div class="columnBody">                    <input type="range" class="regulatearcr" id="leftDownX" min="0" max="1" step="0.01" value="0"/>                    <input type="range" class="regulatearcr" id="leftDownY" min="0" max="1" step="0.01" value="0"/>                </div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u53F3\u4E0A\u88C1\u526A</div>                <div class="columnBody">                    <input type="range" class="regulatearcr" id="rightUpX" min="0" max="1" step="0.01" value="1"/>                    <input type="range" class="regulatearcr" id="rightUpY" min="0" max="1" step="0.01" value="1"/>                </div>            </div>            <div class="inlineColumn">                <div class="columnHead">\u53F3\u4E0B\u88C1\u526A</div>                <div class="columnBody">                    <input type="range" class="regulatearcr" id="rightDownX" min="0" max="1" step="0.01" value="1"/>                    <input type="range" class="regulatearcr" id="rightDownY" min="0" max="1" step="0.01" value="0"/>                </div>            </div>            <div class="inlineColumn">                <div>                    <label class="checkboxText">                        \u6A21\u578B\u906E\u6321<input type="checkbox" id="depthType" checked/>                    </label>                </div>                <div>                    <label class="checkboxText">                        \u663E\u793A\u8F85\u52A9\u7EBF<input type="checkbox" id="showFrustrum" checked/>                    </label>                </div>            </div>            <div class="inlineColumn">                <div colspan="3" class="inlineColumn">                    <input type="button" id="addVideo" class="menuBtn" value="\u6DFB\u52A0\u89C6\u9891">                    <input type="button" id="editPosition" class="menuBtn" value="\u7F16\u8F91\u4F4D\u7F6E">                    <input type="button" id="locationBtn" class="menuBtn" value="\u5230&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8BBF">                </div>            </div>            <div class="inlineColumn">                <div colspan="3" class="inlineColumn">                    <input type="button" id="delectVideo" class="menuBtn" value="\u5220\u9664\u89C6\u9891">                    <input type="button" id="editOrientation" class="menuBtn"  value="\u7F16\u8F91\u89C6\u70B9">                    <input type="button" id="createJson" class="menuBtn" value="\u5BFC\u51FA\u914D\u7F6E">                    <!-- <input type="button" id="stopEdit" class="menuBtn" value="\u7ED3\u675F\u7F16\u8F91"> -->                </div>            </div>            <div class="inlineColumn">                <div colspan="3" class="inlineColumn">                    <input type="button" id="toMainCamera" class="menuBtn" value="\u5230\u4E3B\u76F8\u673A">                    <input type="button" id="stopEdit" class="menuBtn" value="\u7ED3\u675F\u7F16\u8F91">                </div>            </div>        </div>    ',n.style.top=this.top,n.style.left=this.left,this._container.appendChild(n),this._UIElement=n;let o=this,i=document.getElementById("homeUI"),r=document.getElementById("videoLayerUI"),s=document.getElementById("loadVideoLayerUI"),a=document.getElementById("videoProjectionUI"),c=document.getElementById("videoProjectionMenuUI"),u=document.getElementById("videoModelProjectionUI"),d=document.getElementById("detailInfo"),m=document.getElementById("videoname"),p=document.getElementById("addVideoLayerBtn"),_=document.getElementById("loadVideoLayerBtn"),g=document.getElementById("editVideoLayerBtn"),v=document.getElementById("stopEdit"),b=document.getElementById("addVideo"),S=document.getElementById("delectVideo"),A=document.getElementById("editPosition"),x=document.getElementById("editOrientation"),P=document.getElementById("createVideoLayer"),z=document.getElementById("loadVideoLayer"),L=document.getElementById("configFile"),B=document.getElementById("addVideoModelProjection"),F=document.getElementById("addVideoPlaneProjection"),N=document.getElementById("videoName"),I=document.getElementById("videoUrl"),U=document.getElementById("createVideoModelProjection"),h=document.getElementById("locationBtn"),C=document.getElementById("createJson"),T=document.getElementById("toMainCamera");this.addedVideo.addEventListener(function(fe){let Bt=new Option(fe.name);m.add(Bt),m.selectedIndex=m.length-1,$r(fe)}),this.changed.addEventListener(function(fe){$r(fe)}),this.editObjectChanged.addEventListener(function(fe){$r(fe)});function R(){i.style.display="block",r.style.display="none",s.style.display="none",a.style.display="none",d.style.display="none",o._videoLayer&&(g.style.display="block")}function D(){i.style.display="none",r.style.display="block",s.style.display="none",a.style.display="none",d.style.display="none"}function k(){i.style.display="none",r.style.display="none",s.style.display="block",a.style.display="none",d.style.display="none"}function M(){i.style.display="none",r.style.display="none",s.style.display="none",a.style.display="block",c.style.display="block",u.style.display="none",d.style.display="none"}function q(){i.style.display="none",r.style.display="none",s.style.display="none",a.style.display="none",d.style.display="block"}p.onclick=function(){D()},_.onclick=function(){k()},g.onclick=function(){q()},P.onclick=function(){M();let fe=document.getElementById("videoLayerName").value,Bt=document.getElementById("videoLayerServer").value,_o=Number(document.getElementById("videoLayerVisibleDistance").value);o.createVideoLayer({name:fe,wsServer:Bt,visibleDistance:_o})},z.onclick=function(){let fe=L.value;if(fe===""){L.placeholder="\u914D\u7F6E\u6587\u4EF6\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A\uFF01";return}o.loadVideoLayer({url:fe}),q()},B.onclick=function(){c.style.display="none",u.style.display="block"},F.onclick=function(){},U.onclick=function(){let fe=I.value;if(fe===""){I.placeholder="\u89C6\u9891\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A\uFF01";return}o.createVideoModelProjection({name:N.value,url:fe,farClip:30}),q()},m.onchange=function(){o.setEditObjectByName(this.value)},b.onclick=function(){M()},A.onclick=function(){o.editVideoCameraPosition()},x.onclick=function(){o.editVideoCameraOrientation()},h.onclick=function(){o.viewToEditVideo()},C.onclick=function(){o.createConfigurationFile({fileName:"\u8D35\u9633\u56FD\u9645\u673A\u573A\u89C6\u9891\u878D\u5408"})},v.onclick=function(){o.stopEdit(),R()},S.onclick=function(){layui.use(["layer"],function(){let fe=layui.layer;fe.confirm(`\u60A8\u786E\u5B9A\u5220\u9664\u201C${o.editObject.name}\u201D\u5417\uFF1F`,{title:"\u89C6\u9891\u878D\u5408\u7F16\u8F91\u5668"},function(Bt){fe.close(Bt),o.remove();let _o=m.selectedIndex;m.options.remove(_o),m.length!==0&&(m.length>_o?m.selectedIndex=_o:m.selectedIndex=_o-1,o.setEditObjectByName(m.value))})})},T.onclick=function(){o.setToMainCamera()};let te=document.getElementById("originHeight"),de=document.getElementById("viewPointHeight"),he=document.getElementById("roll"),Ce=document.getElementById("rollv"),ye=document.getElementById("fov"),Se=document.getElementById("fovv"),Ie=document.getElementById("near"),Ne=document.getElementById("nearv"),Me=document.getElementById("far"),ke=document.getElementById("farv"),_e=document.getElementById("k1"),dt=document.getElementById("k1v"),St=document.getElementById("k2"),Nt=document.getElementById("k2v"),pn=document.getElementById("alpha"),Yr=document.getElementById("alphav"),Hn=document.getElementById("hue"),Ga=document.getElementById("huev"),qn=document.getElementById("saturation"),ja=document.getElementById("saturationv"),Wn=document.getElementById("val"),Ha=document.getElementById("valv"),qa=document.getElementById("distanceError"),Ei=document.getElementById("leftUpX"),Ti=document.getElementById("leftUpY"),bi=document.getElementById("leftDownX"),Ai=document.getElementById("leftDownY"),xi=document.getElementById("rightUpX"),wi=document.getElementById("rightUpY"),Si=document.getElementById("rightDownX"),Ri=document.getElementById("rightDownY"),Xr=document.getElementById("depthType"),hh=document.getElementById("showFrustrum");te.oninput=function(){o.setCameraHeight(this.valueAsNumber)},de.oninput=function(){o.setCameraViewPointHeight(this.valueAsNumber)},he.oninput=function(){let fe=this.valueAsNumber;Ce.value=fe,fe=Kr(fe),o.setCameraRoll(fe)},Ce.oninput=function(){he.value=this.valueAsNumber;let fe=Kr(this.valueAsNumber);o.setCameraRoll(fe)},ye.oninput=function(){Se.value=this.value,o.setFov(this.valueAsNumber)},Se.oninput=function(){ye.value=this.value,o.setFov(this.valueAsNumber)},Ie.oninput=function(){Ne.value=this.value,o.setNear(this.valueAsNumber)},Ne.oninput=function(){Ie.value=this.value,o.setNear(this.valueAsNumber)},Me.oninput=function(){ke.value=this.value,o.setFar(this.valueAsNumber)},ke.oninput=function(){Me.value=this.value,o.setFar(this.valueAsNumber)},_e.oninput=function(){dt.value=this.value,o.setDistortionK1(this.valueAsNumber)},dt.oninput=function(){_e.value=this.value,o.setDistortionK1(this.valueAsNumber)},St.oninput=function(){Nt.value=this.value,o.setDistortionK2(this.valueAsNumber)},Nt.oninput=function(){St.value=this.value,o.setDistortionK2(this.valueAsNumber)},pn.oninput=function(){Yr.value=this.value,o.setAlpha(this.valueAsNumber)},Yr.oninput=function(){pn.value=this.value,o.setAlpha(this.valueAsNumber)},Hn.oninput=function(){Ga.value=this.value,o.setHSV(this.valueAsNumber,qn.valueAsNumber,Wn.valueAsNumber)},Ga.oninput=function(){Hn.value=this.value,o.setHSV(this.valueAsNumber,qn.valueAsNumber,Wn.valueAsNumber)},qn.oninput=function(){ja.value=this.value,o.setHSV(Hn.valueAsNumber,this.valueAsNumber,Wn.valueAsNumber)},ja.oninput=function(){qn.value=this.value,o.setHSV(Hn.valueAsNumber,this.valueAsNumber,Wn.valueAsNumber)},Wn.oninput=function(){Ha.value=this.value,o.setHSV(Hn.valueAsNumber,qn.valueAsNumber,this.valueAsNumber)},Ha.oninput=function(){Wn.value=this.value,o.setHSV(Hn.valueAsNumber,qn.valueAsNumber,this.valueAsNumber)},qa.oninput=function(){o.setDistanceError(this.valueAsNumber)},Ei.oninput=function(){o.setVideoLeftUpClipPoint(Ei.valueAsNumber,Ti.valueAsNumber)},Ti.oninput=function(){o.setVideoLeftUpClipPoint(Ei.valueAsNumber,Ti.valueAsNumber)},bi.oninput=function(){o.setVideoLeftDownClipPoint(bi.valueAsNumber,Ai.valueAsNumber)},Ai.oninput=function(){o.setVideoLeftDownClipPoint(bi.valueAsNumber,Ai.valueAsNumber)},xi.oninput=function(){o.setVideoRightUpClipPoint(xi.valueAsNumber,wi.valueAsNumber)},wi.oninput=function(){o.setVideoRightUpClipPoint(xi.valueAsNumber,wi.valueAsNumber)},Si.oninput=function(){o.setVideoRightDownClipPoint(Si.valueAsNumber,Ri.valueAsNumber)},Ri.oninput=function(){o.setVideoRightDownClipPoint(Si.valueAsNumber,Ri.valueAsNumber)},Xr.onchange=function(){this.checked?o.setVideoDepthType(3):o.setVideoDepthType(0)},hh.onchange=function(){o.setVideoCameraFrustumVisibility(this.checked)};function $r(fe){te.value=fe._originHeight.toFixed(2),de.value=o.getCameraViewPointHeight().toFixed(2),he.value=Ce.value=Kr(fe._roll.toFixed(1)),ye.value=Se.value=fe._fov,Ie.value=Ne.value=fe._nearClip,Me.value=ke.value=fe._farClip,_e.value=dt.value=fe._distortion.x,St.value=Nt.value=fe._distortion.y,pn.value=Yr.value=fe.videoAlpha;let Bt=fe.videoHsv;Hn.value=Bt.x,qn.value=Bt.y,Wn.value=Bt.z,qa.value=fe._distanceError,Ei.value=fe._videoTextureClipLUPos.x,Ti.value=fe._videoTextureClipLUPos.y,bi.value=fe._videoTextureClipLBPos.x,Ai.value=fe._videoTextureClipLBPos.y,xi.value=fe._videoTextureClipRUPos.x,wi.value=fe._videoTextureClipRUPos.y,Si.value=fe._videoTextureClipRBPos.x,Ri.value=fe._videoTextureClipRBPos.y,fe._depthType===0?Xr.checked=!1:fe._depthType===3&&(Xr.checked=!0)}let Wa=document.getElementsByClassName("menuBtn");for(let fe=0;fe<Wa.length;++fe){let Bt=Wa[fe];Bt.onmouseenter=ph,Bt.onmouseout=_h}function ph(){this.style.backgroundColor="#a6c9e7"}function _h(){this.style.backgroundColor=""}function Kr(fe){return fe<0?fe+=360:fe>180&&(fe-=360),fe}};ae.prototype.showUI=function(){if(!this._UIElement)throw new Error("\u89C6\u9891\u878D\u5408\u7F16\u8F91\u5668\u754C\u9762\u672A\u521B\u5EFA\uFF01");this._UIElement.style.display="block"};ae.prototype.hideUI=function(){if(!this._UIElement)throw new Error("\u89C6\u9891\u878D\u5408\u7F16\u8F91\u5668\u754C\u9762\u672A\u521B\u5EFA\uFF01");this._UIElement.style.display="none"};ae.prototype.setPosition=function(e){!e||(this._editObject.setVideoCameraPosition(e.clone(),!1),this._editor.setPosition(e.clone()))};ae.prototype.setOrientation=function(e,t,n){this._editObject.setCameraHeadingPitchRoll(e,t,n)};ae.prototype.setFov=function(e){this._editObject.setCameraFov(e)};ae.prototype.setAlpha=function(e){this._editObject.videoAlpha=e};ae.prototype.setHSV=function(e,t,n){let o=this._editObject.videoHsv;o.x=e,o.y=t,o.z=n};ae.prototype.setNear=function(e){e<=0||this._editObject instanceof _n&&this._editObject.setNearClip(e)};ae.prototype.setFar=function(e){e<=0||this._editObject instanceof _n&&this._editObject.setFarClip(e)};ae.prototype.setDistortion=function(e){this._editObject.setDistortion(e)};ae.prototype.setDistortionK1=function(e){this._editObject._distortion.x=e};ae.prototype.setDistortionK2=function(e){this._editObject._distortion.y=e};ae.prototype.setCameraRoll=function(e){let t=this._editObject.videoCamera;!t||t.setView({orientation:{heading:t.heading,pitch:t.pitch,roll:Cesium.Math.toRadians(e)}})};ae.prototype.setCameraHeight=function(e){let t=this._editor._positionPrimitive.position._value,n=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(t);!n||(n.height=e,this.viewer.scene.globe.ellipsoid.cartographicToCartesian(n,t),this._editObject.setVideoCameraPosition(t.clone(),!1))};ae.prototype.setCameraViewPointHeight=function(e){let t=this._editObject._viewPoint,n=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(t);n.height=e,this.viewer.scene.globe.ellipsoid.cartographicToCartesian(n,t),this._setCameraViewPointPlane(t),this._editObject.setCameraViewPoint(t,!1),this._videoCameraViewPoint&&this._videoCameraViewPoint.position.setValue(t.clone())};ae.prototype.getCameraViewPointHeight=function(){return this._editObject&&this._editObject._viewPoint?this.viewer.scene.globe.ellipsoid.cartesianToCartographic(this._editObject._viewPoint).height:0};ae.prototype._setCameraViewPointPlane=function(e){let t=Cesium.Cartesian3.normalize(e,new Cesium.Cartesian3),n=Cesium.Cartesian3.magnitude(e);n=-n,this._viewPointPlane?(this._viewPointPlane.normal=t,this._viewPointPlane.distance=n):this._viewPointPlane=new Cesium.Plane(t,n)};ae.prototype.setVideoLeftUpClipPoint=function(e,t){this._editObject._videoTextureClipLUPos.x=e,this._editObject._videoTextureClipLUPos.y=t};ae.prototype.setVideoLeftDownClipPoint=function(e,t){this._editObject._videoTextureClipLBPos.x=e,this._editObject._videoTextureClipLBPos.y=t};ae.prototype.setVideoRightUpClipPoint=function(e,t){this._editObject._videoTextureClipRUPos.x=e,this._editObject._videoTextureClipRUPos.y=t};ae.prototype.setVideoRightDownClipPoint=function(e,t){this._editObject._videoTextureClipRBPos.x=e,this._editObject._videoTextureClipRBPos.y=t};ae.prototype.setVideoDepthType=function(e){!this._editObject||(this._editObject._depthType=e)};ae.prototype.setVideoCameraFrustumVisibility=function(e){this._showCameraFrustrum=e,this._cameraFrustumPrimitive&&(this._cameraFrustumPrimitive.show=e)};ae.prototype.setToMainCamera=function(){!(this._editObject&&this._editObject.videoCamera)||this._editObject.setVideoCameraPosition(this.viewer.camera.positionWC)};ae.prototype.setDistanceError=function(e){!this._editObject||(this._editObject.distanceError=e)};ae.prototype.setVisibleDistance=function(e){!this._editObject||(this._editObject.visibleDistance=e)};ae.prototype.setProtocol=function(e){!this._editObject&&this._editObject._wsplayer||(this._editObject._wsplayer.protocol=e)};ae.prototype.destroy=function(){};function KC(e){return typeof e=="string"?e=document.getElementById(e):e===void 0&&(e=document.body),e}var mh=ae;var ZC="1.96";0&&(module.exports={EV_Editor,EV_ProjectionPlane,EV_VideoFusion,EV_VideoFusionEditor,EV_VideoLayer,EV_VideoProjection,EV_VideoProjectionFS,EV_VideoProjectionManager,EV_VideoProjectionPlane,EV_VideoSynchronizerEx,EV_WSPlayer,VERSION,VideoFusionMixin});
