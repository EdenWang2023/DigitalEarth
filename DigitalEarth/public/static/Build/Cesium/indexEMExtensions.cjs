/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.96
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

var zie=Object.create;var eb=Object.defineProperty;var Vie=Object.getOwnPropertyDescriptor;var kie=Object.getOwnPropertyNames;var Gie=Object.getPrototypeOf,Uie=Object.prototype.hasOwnProperty;var Xh=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Hie=(e,t)=>{for(var n in t)eb(e,n,{get:t[n],enumerable:!0})},gV=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of kie(t))!Uie.call(e,o)&&o!==n&&eb(e,o,{get:()=>t[o],enumerable:!(r=Vie(t,o))||r.enumerable});return e};var Vg=(e,t,n)=>(n=e!=null?zie(Gie(e)):{},gV(t||!e||!e.__esModule?eb(n,"default",{value:e,enumerable:!0}):n,e)),qie=e=>gV(eb({},"__esModule",{value:!0}),e);var yV=Xh((Gv,Uv)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */(function(e){var t=typeof Gv=="object"&&Gv&&!Gv.nodeType&&Gv,n=typeof Uv=="object"&&Uv&&!Uv.nodeType&&Uv,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(e=r);var o,a=2147483647,s=36,u=1,l=26,c=38,f=700,h=72,d=128,p="-",g=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=s-u,E=Math.floor,S=String.fromCharCode,A;function D(F){throw new RangeError(w[F])}function P(F,k){for(var Z=F.length,te=[];Z--;)te[Z]=k(F[Z]);return te}function M(F,k){var Z=F.split("@"),te="";Z.length>1&&(te=Z[0]+"@",F=Z[1]),F=F.replace(v,".");var oe=F.split("."),ue=P(oe,k).join(".");return te+ue}function I(F){for(var k=[],Z=0,te=F.length,oe,ue;Z<te;)oe=F.charCodeAt(Z++),oe>=55296&&oe<=56319&&Z<te?(ue=F.charCodeAt(Z++),(ue&64512)==56320?k.push(((oe&1023)<<10)+(ue&1023)+65536):(k.push(oe),Z--)):k.push(oe);return k}function O(F){return P(F,function(k){var Z="";return k>65535&&(k-=65536,Z+=S(k>>>10&1023|55296),k=56320|k&1023),Z+=S(k),Z}).join("")}function m(F){return F-48<10?F-22:F-65<26?F-65:F-97<26?F-97:s}function b(F,k){return F+22+75*(F<26)-((k!=0)<<5)}function L(F,k,Z){var te=0;for(F=Z?E(F/f):F>>1,F+=E(F/k);F>C*l>>1;te+=s)F=E(F/C);return E(te+(C+1)*F/(F+c))}function R(F){var k=[],Z=F.length,te,oe=0,ue=d,pe=h,me,st,ht,jt,Ct,bt,mn,Tn,zi;for(me=F.lastIndexOf(p),me<0&&(me=0),st=0;st<me;++st)F.charCodeAt(st)>=128&&D("not-basic"),k.push(F.charCodeAt(st));for(ht=me>0?me+1:0;ht<Z;){for(jt=oe,Ct=1,bt=s;ht>=Z&&D("invalid-input"),mn=m(F.charCodeAt(ht++)),(mn>=s||mn>E((a-oe)/Ct))&&D("overflow"),oe+=mn*Ct,Tn=bt<=pe?u:bt>=pe+l?l:bt-pe,!(mn<Tn);bt+=s)zi=s-Tn,Ct>E(a/zi)&&D("overflow"),Ct*=zi;te=k.length+1,pe=L(oe-jt,te,jt==0),E(oe/te)>a-ue&&D("overflow"),ue+=E(oe/te),oe%=te,k.splice(oe++,0,ue)}return O(k)}function N(F){var k,Z,te,oe,ue,pe,me,st,ht,jt,Ct,bt=[],mn,Tn,zi,at;for(F=I(F),mn=F.length,k=d,Z=0,ue=h,pe=0;pe<mn;++pe)Ct=F[pe],Ct<128&&bt.push(S(Ct));for(te=oe=bt.length,oe&&bt.push(p);te<mn;){for(me=a,pe=0;pe<mn;++pe)Ct=F[pe],Ct>=k&&Ct<me&&(me=Ct);for(Tn=te+1,me-k>E((a-Z)/Tn)&&D("overflow"),Z+=(me-k)*Tn,k=me,pe=0;pe<mn;++pe)if(Ct=F[pe],Ct<k&&++Z>a&&D("overflow"),Ct==k){for(st=Z,ht=s;jt=ht<=ue?u:ht>=ue+l?l:ht-ue,!(st<jt);ht+=s)at=st-jt,zi=s-jt,bt.push(S(b(jt+at%zi,0))),st=E(at/zi);bt.push(S(b(st,0))),ue=L(Z,Tn,te==oe),Z=0,++te}++Z,++k}return bt.join("")}function B(F){return M(F,function(k){return g.test(k)?R(k.slice(4).toLowerCase()):k})}function G(F){return M(F,function(k){return y.test(k)?"xn--"+N(k):k})}if(o={version:"1.3.2",ucs2:{decode:I,encode:O},decode:R,encode:N,toASCII:G,toUnicode:B},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return o});else if(t&&n)if(Uv.exports==t)n.exports=o;else for(A in o)o.hasOwnProperty(A)&&(t[A]=o[A]);else e.punycode=o})(Gv)});var CV=Xh((vV,tb)=>{/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof tb=="object"&&tb.exports?tb.exports=t():typeof define=="function"&&define.amd?define(t):e.IPv6=t(e)})(vV,function(e){"use strict";var t=e&&e.IPv6;function n(o){var a=o.toLowerCase(),s=a.split(":"),u=s.length,l=8;s[0]===""&&s[1]===""&&s[2]===""?(s.shift(),s.shift()):s[0]===""&&s[1]===""?s.shift():s[u-1]===""&&s[u-2]===""&&s.pop(),u=s.length,s[u-1].indexOf(".")!==-1&&(l=7);var c;for(c=0;c<u&&s[c]!=="";c++);if(c<l)for(s.splice(c,1,"0000");s.length<l;)s.splice(c,0,"0000");for(var f,h=0;h<l;h++){f=s[h].split("");for(var d=0;d<3&&(f[0]==="0"&&f.length>1);d++)f.splice(0,1);s[h]=f.join("")}var p=-1,g=0,y=0,v=-1,w=!1;for(h=0;h<l;h++)w?s[h]==="0"?y+=1:(w=!1,y>g&&(p=v,g=y)):s[h]==="0"&&(w=!0,v=h,y=1);y>g&&(p=v,g=y),g>1&&s.splice(p,g,""),u=s.length;var C="";for(s[0]===""&&(C=":"),h=0;h<u&&(C+=s[h],h!==u-1);h++)C+=":";return s[u-1]===""&&(C+=":"),C}function r(){return e.IPv6===this&&(e.IPv6=t),this}return{best:n,noConflict:r}})});var wV=Xh((xV,nb)=>{/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof nb=="object"&&nb.exports?nb.exports=t():typeof define=="function"&&define.amd?define(t):e.SecondLevelDomains=t(e)})(xV,function(e){"use strict";var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return!1;var a=r.lastIndexOf(".",o-1);if(a<=0||a>=o-1)return!1;var s=n.list[r.slice(o+1)];return s?s.indexOf(" "+r.slice(a+1,o)+" ")>=0:!1},is:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return!1;var a=r.lastIndexOf(".",o-1);if(a>=0)return!1;var s=n.list[r.slice(o+1)];return s?s.indexOf(" "+r.slice(0,o)+" ")>=0:!1},get:function(r){var o=r.lastIndexOf(".");if(o<=0||o>=r.length-1)return null;var a=r.lastIndexOf(".",o-1);if(a<=0||a>=o-1)return null;var s=n.list[r.slice(o+1)];return!s||s.indexOf(" "+r.slice(a+1,o)+" ")<0?null:r.slice(a+1)},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n})});var TV=Xh((EV,rb)=>{/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(e,t){"use strict";typeof rb=="object"&&rb.exports?rb.exports=t(yV(),CV(),wV()):typeof define=="function"&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)})(EV,function(e,t,n,r){"use strict";var o=r&&r.URI;function a(b,L){var R=arguments.length>=1,N=arguments.length>=2;if(!(this instanceof a))return R?N?new a(b,L):new a(b):new a;if(b===void 0){if(R)throw new TypeError("undefined is not a valid argument for URI");typeof location<"u"?b=location.href+"":b=""}if(b===null&&R)throw new TypeError("null is not a valid argument for URI");return this.href(b),L!==void 0?this.absoluteTo(L):this}function s(b){return/^[0-9]+$/.test(b)}a.version="1.19.11";var u=a.prototype,l=Object.prototype.hasOwnProperty;function c(b){return b.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function f(b){return b===void 0?"Undefined":String(Object.prototype.toString.call(b)).slice(8,-1)}function h(b){return f(b)==="Array"}function d(b,L){var R={},N,B;if(f(L)==="RegExp")R=null;else if(h(L))for(N=0,B=L.length;N<B;N++)R[L[N]]=!0;else R[L]=!0;for(N=0,B=b.length;N<B;N++){var G=R&&R[b[N]]!==void 0||!R&&L.test(b[N]);G&&(b.splice(N,1),B--,N--)}return b}function p(b,L){var R,N;if(h(L)){for(R=0,N=L.length;R<N;R++)if(!p(b,L[R]))return!1;return!0}var B=f(L);for(R=0,N=b.length;R<N;R++)if(B==="RegExp"){if(typeof b[R]=="string"&&b[R].match(L))return!0}else if(b[R]===L)return!0;return!1}function g(b,L){if(!h(b)||!h(L)||b.length!==L.length)return!1;b.sort(),L.sort();for(var R=0,N=b.length;R<N;R++)if(b[R]!==L[R])return!1;return!0}function y(b){var L=/^\/+|\/+$/g;return b.replace(L,"")}a._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:a.preventInvalidHostname,duplicateQueryParameters:a.duplicateQueryParameters,escapeQuerySpace:a.escapeQuerySpace}},a.preventInvalidHostname=!1,a.duplicateQueryParameters=!1,a.escapeQuerySpace=!0,a.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,a.idn_expression=/[^a-z0-9\._-]/i,a.punycode_expression=/(xn--)/i,a.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,a.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,a.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig,a.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},a.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,a.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},a.hostProtocols=["http","https"],a.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,a.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},a.getDomAttribute=function(b){if(!(!b||!b.nodeName)){var L=b.nodeName.toLowerCase();if(!(L==="input"&&b.type!=="image"))return a.domAttributes[L]}};function v(b){return escape(b)}function w(b){return encodeURIComponent(b).replace(/[!'()*]/g,v).replace(/\*/g,"%2A")}a.encode=w,a.decode=decodeURIComponent,a.iso8859=function(){a.encode=escape,a.decode=unescape},a.unicode=function(){a.encode=w,a.decode=decodeURIComponent},a.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},a.encodeQuery=function(b,L){var R=a.encode(b+"");return L===void 0&&(L=a.escapeQuerySpace),L?R.replace(/%20/g,"+"):R},a.decodeQuery=function(b,L){b+="",L===void 0&&(L=a.escapeQuerySpace);try{return a.decode(L?b.replace(/\+/g,"%20"):b)}catch{return b}};var C={encode:"encode",decode:"decode"},E,S=function(b,L){return function(R){try{return a[L](R+"").replace(a.characters[b][L].expression,function(N){return a.characters[b][L].map[N]})}catch{return R}}};for(E in C)a[E+"PathSegment"]=S("pathname",C[E]),a[E+"UrnPathSegment"]=S("urnpath",C[E]);var A=function(b,L,R){return function(N){var B;R?B=function(Z){return a[L](a[R](Z))}:B=a[L];for(var G=(N+"").split(b),F=0,k=G.length;F<k;F++)G[F]=B(G[F]);return G.join(b)}};a.decodePath=A("/","decodePathSegment"),a.decodeUrnPath=A(":","decodeUrnPathSegment"),a.recodePath=A("/","encodePathSegment","decode"),a.recodeUrnPath=A(":","encodeUrnPathSegment","decode"),a.encodeReserved=S("reserved","encode"),a.parse=function(b,L){var R;return L||(L={preventInvalidHostname:a.preventInvalidHostname}),b=b.replace(a.leading_whitespace_expression,""),b=b.replace(a.ascii_tab_whitespace,""),R=b.indexOf("#"),R>-1&&(L.fragment=b.substring(R+1)||null,b=b.substring(0,R)),R=b.indexOf("?"),R>-1&&(L.query=b.substring(R+1)||null,b=b.substring(0,R)),b=b.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://"),b=b.replace(/^[/\\]{2,}/i,"//"),b.substring(0,2)==="//"?(L.protocol=null,b=b.substring(2),b=a.parseAuthority(b,L)):(R=b.indexOf(":"),R>-1&&(L.protocol=b.substring(0,R)||null,L.protocol&&!L.protocol.match(a.protocol_expression)?L.protocol=void 0:b.substring(R+1,R+3).replace(/\\/g,"/")==="//"?(b=b.substring(R+3),b=a.parseAuthority(b,L)):(b=b.substring(R+1),L.urn=!0))),L.path=b,L},a.parseHost=function(b,L){b||(b=""),b=b.replace(/\\/g,"/");var R=b.indexOf("/"),N,B;if(R===-1&&(R=b.length),b.charAt(0)==="[")N=b.indexOf("]"),L.hostname=b.substring(1,N)||null,L.port=b.substring(N+2,R)||null,L.port==="/"&&(L.port=null);else{var G=b.indexOf(":"),F=b.indexOf("/"),k=b.indexOf(":",G+1);k!==-1&&(F===-1||k<F)?(L.hostname=b.substring(0,R)||null,L.port=null):(B=b.substring(0,R).split(":"),L.hostname=B[0]||null,L.port=B[1]||null)}return L.hostname&&b.substring(R).charAt(0)!=="/"&&(R++,b="/"+b),L.preventInvalidHostname&&a.ensureValidHostname(L.hostname,L.protocol),L.port&&a.ensureValidPort(L.port),b.substring(R)||"/"},a.parseAuthority=function(b,L){return b=a.parseUserinfo(b,L),a.parseHost(b,L)},a.parseUserinfo=function(b,L){var R=b,N=b.indexOf("\\");N!==-1&&(b=b.replace(/\\/g,"/"));var B=b.indexOf("/"),G=b.lastIndexOf("@",B>-1?B:b.length-1),F;return G>-1&&(B===-1||G<B)?(F=b.substring(0,G).split(":"),L.username=F[0]?a.decode(F[0]):null,F.shift(),L.password=F[0]?a.decode(F.join(":")):null,b=R.substring(G+1)):(L.username=null,L.password=null),b},a.parseQuery=function(b,L){if(!b)return{};if(b=b.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!b)return{};for(var R={},N=b.split("&"),B=N.length,G,F,k,Z=0;Z<B;Z++)G=N[Z].split("="),F=a.decodeQuery(G.shift(),L),k=G.length?a.decodeQuery(G.join("="),L):null,F!=="__proto__"&&(l.call(R,F)?((typeof R[F]=="string"||R[F]===null)&&(R[F]=[R[F]]),R[F].push(k)):R[F]=k);return R},a.build=function(b){var L="",R=!1;return b.protocol&&(L+=b.protocol+":"),!b.urn&&(L||b.hostname)&&(L+="//",R=!0),L+=a.buildAuthority(b)||"",typeof b.path=="string"&&(b.path.charAt(0)!=="/"&&R&&(L+="/"),L+=b.path),typeof b.query=="string"&&b.query&&(L+="?"+b.query),typeof b.fragment=="string"&&b.fragment&&(L+="#"+b.fragment),L},a.buildHost=function(b){var L="";if(b.hostname)a.ip6_expression.test(b.hostname)?L+="["+b.hostname+"]":L+=b.hostname;else return"";return b.port&&(L+=":"+b.port),L},a.buildAuthority=function(b){return a.buildUserinfo(b)+a.buildHost(b)},a.buildUserinfo=function(b){var L="";return b.username&&(L+=a.encode(b.username)),b.password&&(L+=":"+a.encode(b.password)),L&&(L+="@"),L},a.buildQuery=function(b,L,R){var N="",B,G,F,k;for(G in b)if(G!=="__proto__"&&l.call(b,G))if(h(b[G]))for(B={},F=0,k=b[G].length;F<k;F++)b[G][F]!==void 0&&B[b[G][F]+""]===void 0&&(N+="&"+a.buildQueryParameter(G,b[G][F],R),L!==!0&&(B[b[G][F]+""]=!0));else b[G]!==void 0&&(N+="&"+a.buildQueryParameter(G,b[G],R));return N.substring(1)},a.buildQueryParameter=function(b,L,R){return a.encodeQuery(b,R)+(L!==null?"="+a.encodeQuery(L,R):"")},a.addQuery=function(b,L,R){if(typeof L=="object")for(var N in L)l.call(L,N)&&a.addQuery(b,N,L[N]);else if(typeof L=="string"){if(b[L]===void 0){b[L]=R;return}else typeof b[L]=="string"&&(b[L]=[b[L]]);h(R)||(R=[R]),b[L]=(b[L]||[]).concat(R)}else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")},a.setQuery=function(b,L,R){if(typeof L=="object")for(var N in L)l.call(L,N)&&a.setQuery(b,N,L[N]);else if(typeof L=="string")b[L]=R===void 0?null:R;else throw new TypeError("URI.setQuery() accepts an object, string as the name parameter")},a.removeQuery=function(b,L,R){var N,B,G;if(h(L))for(N=0,B=L.length;N<B;N++)b[L[N]]=void 0;else if(f(L)==="RegExp")for(G in b)L.test(G)&&(b[G]=void 0);else if(typeof L=="object")for(G in L)l.call(L,G)&&a.removeQuery(b,G,L[G]);else if(typeof L=="string")R!==void 0?f(R)==="RegExp"?!h(b[L])&&R.test(b[L])?b[L]=void 0:b[L]=d(b[L],R):b[L]===String(R)&&(!h(R)||R.length===1)?b[L]=void 0:h(b[L])&&(b[L]=d(b[L],R)):b[L]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")},a.hasQuery=function(b,L,R,N){switch(f(L)){case"String":break;case"RegExp":for(var B in b)if(l.call(b,B)&&L.test(B)&&(R===void 0||a.hasQuery(b,B,R)))return!0;return!1;case"Object":for(var G in L)if(l.call(L,G)&&!a.hasQuery(b,G,L[G]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(f(R)){case"Undefined":return L in b;case"Boolean":var F=Boolean(h(b[L])?b[L].length:b[L]);return R===F;case"Function":return!!R(b[L],L,b);case"Array":if(!h(b[L]))return!1;var k=N?p:g;return k(b[L],R);case"RegExp":return h(b[L])?N?p(b[L],R):!1:Boolean(b[L]&&b[L].match(R));case"Number":R=String(R);case"String":return h(b[L])?N?p(b[L],R):!1:b[L]===R;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},a.joinPaths=function(){for(var b=[],L=[],R=0,N=0;N<arguments.length;N++){var B=new a(arguments[N]);b.push(B);for(var G=B.segment(),F=0;F<G.length;F++)typeof G[F]=="string"&&L.push(G[F]),G[F]&&R++}if(!L.length||!R)return new a("");var k=new a("").segment(L);return(b[0].path()===""||b[0].path().slice(0,1)==="/")&&k.path("/"+k.path()),k.normalize()},a.commonPath=function(b,L){var R=Math.min(b.length,L.length),N;for(N=0;N<R;N++)if(b.charAt(N)!==L.charAt(N)){N--;break}return N<1?b.charAt(0)===L.charAt(0)&&b.charAt(0)==="/"?"/":"":((b.charAt(N)!=="/"||L.charAt(N)!=="/")&&(N=b.substring(0,N).lastIndexOf("/")),b.substring(0,N+1))},a.withinString=function(b,L,R){R||(R={});var N=R.start||a.findUri.start,B=R.end||a.findUri.end,G=R.trim||a.findUri.trim,F=R.parens||a.findUri.parens,k=/[a-z0-9-]=["']?$/i;for(N.lastIndex=0;;){var Z=N.exec(b);if(!Z)break;var te=Z.index;if(R.ignoreHtml){var oe=b.slice(Math.max(te-3,0),te);if(oe&&k.test(oe))continue}for(var ue=te+b.slice(te).search(B),pe=b.slice(te,ue),me=-1;;){var st=F.exec(pe);if(!st)break;var ht=st.index+st[0].length;me=Math.max(me,ht)}if(me>-1?pe=pe.slice(0,me)+pe.slice(me).replace(G,""):pe=pe.replace(G,""),!(pe.length<=Z[0].length)&&!(R.ignore&&R.ignore.test(pe))){ue=te+pe.length;var jt=L(pe,te,ue,b);if(jt===void 0){N.lastIndex=ue;continue}jt=String(jt),b=b.slice(0,te)+jt+b.slice(ue),N.lastIndex=te+jt.length}}return N.lastIndex=0,b},a.ensureValidHostname=function(b,L){var R=!!b,N=!!L,B=!1;if(N&&(B=p(a.hostProtocols,L)),B&&!R)throw new TypeError("Hostname cannot be empty, if protocol is "+L);if(b&&b.match(a.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(b).match(a.invalid_hostname_characters))throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-:_]')}},a.ensureValidPort=function(b){if(!!b){var L=Number(b);if(!(s(L)&&L>0&&L<65536))throw new TypeError('Port "'+b+'" is not a valid port')}},a.noConflict=function(b){if(b){var L={URI:this.noConflict()};return r.URITemplate&&typeof r.URITemplate.noConflict=="function"&&(L.URITemplate=r.URITemplate.noConflict()),r.IPv6&&typeof r.IPv6.noConflict=="function"&&(L.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&typeof r.SecondLevelDomains.noConflict=="function"&&(L.SecondLevelDomains=r.SecondLevelDomains.noConflict()),L}else r.URI===this&&(r.URI=o);return this},u.build=function(b){return b===!0?this._deferred_build=!0:(b===void 0||this._deferred_build)&&(this._string=a.build(this._parts),this._deferred_build=!1),this},u.clone=function(){return new a(this)},u.valueOf=u.toString=function(){return this.build(!1)._string};function D(b){return function(L,R){return L===void 0?this._parts[b]||"":(this._parts[b]=L||null,this.build(!R),this)}}function P(b,L){return function(R,N){return R===void 0?this._parts[b]||"":(R!==null&&(R=R+"",R.charAt(0)===L&&(R=R.substring(1))),this._parts[b]=R,this.build(!N),this)}}u.protocol=D("protocol"),u.username=D("username"),u.password=D("password"),u.hostname=D("hostname"),u.port=D("port"),u.query=P("query","?"),u.fragment=P("fragment","#"),u.search=function(b,L){var R=this.query(b,L);return typeof R=="string"&&R.length?"?"+R:R},u.hash=function(b,L){var R=this.fragment(b,L);return typeof R=="string"&&R.length?"#"+R:R},u.pathname=function(b,L){if(b===void 0||b===!0){var R=this._parts.path||(this._parts.hostname?"/":"");return b?(this._parts.urn?a.decodeUrnPath:a.decodePath)(R):R}else return this._parts.urn?this._parts.path=b?a.recodeUrnPath(b):"":this._parts.path=b?a.recodePath(b):"/",this.build(!L),this},u.path=u.pathname,u.href=function(b,L){var R;if(b===void 0)return this.toString();this._string="",this._parts=a._parts();var N=b instanceof a,B=typeof b=="object"&&(b.hostname||b.path||b.pathname);if(b.nodeName){var G=a.getDomAttribute(b);b=b[G]||"",B=!1}if(!N&&B&&b.pathname!==void 0&&(b=b.toString()),typeof b=="string"||b instanceof String)this._parts=a.parse(String(b),this._parts);else if(N||B){var F=N?b._parts:b;for(R in F)R!=="query"&&l.call(this._parts,R)&&(this._parts[R]=F[R]);F.query&&this.query(F.query,!1)}else throw new TypeError("invalid input");return this.build(!L),this},u.is=function(b){var L=!1,R=!1,N=!1,B=!1,G=!1,F=!1,k=!1,Z=!this._parts.urn;switch(this._parts.hostname&&(Z=!1,R=a.ip4_expression.test(this._parts.hostname),N=a.ip6_expression.test(this._parts.hostname),L=R||N,B=!L,G=B&&n&&n.has(this._parts.hostname),F=B&&a.idn_expression.test(this._parts.hostname),k=B&&a.punycode_expression.test(this._parts.hostname)),b.toLowerCase()){case"relative":return Z;case"absolute":return!Z;case"domain":case"name":return B;case"sld":return G;case"ip":return L;case"ip4":case"ipv4":case"inet4":return R;case"ip6":case"ipv6":case"inet6":return N;case"idn":return F;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return k}return null};var M=u.protocol,I=u.port,O=u.hostname;u.protocol=function(b,L){if(b&&(b=b.replace(/:(\/\/)?$/,""),!b.match(a.protocol_expression)))throw new TypeError('Protocol "'+b+`" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]`);return M.call(this,b,L)},u.scheme=u.protocol,u.port=function(b,L){return this._parts.urn?b===void 0?"":this:(b!==void 0&&(b===0&&(b=null),b&&(b+="",b.charAt(0)===":"&&(b=b.substring(1)),a.ensureValidPort(b))),I.call(this,b,L))},u.hostname=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b!==void 0){var R={preventInvalidHostname:this._parts.preventInvalidHostname},N=a.parseHost(b,R);if(N!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');b=R.hostname,this._parts.preventInvalidHostname&&a.ensureValidHostname(b,this._parts.protocol)}return O.call(this,b,L)},u.origin=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){var R=this.protocol(),N=this.authority();return N?(R?R+"://":"")+this.authority():""}else{var B=a(b);return this.protocol(B.protocol()).authority(B.authority()).build(!L),this}},u.host=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0)return this._parts.hostname?a.buildHost(this._parts):"";var R=a.parseHost(b,this._parts);if(R!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');return this.build(!L),this},u.authority=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0)return this._parts.hostname?a.buildAuthority(this._parts):"";var R=a.parseAuthority(b,this._parts);if(R!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');return this.build(!L),this},u.userinfo=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){var R=a.buildUserinfo(this._parts);return R&&R.substring(0,R.length-1)}else return b[b.length-1]!=="@"&&(b+="@"),a.parseUserinfo(b,this._parts),this.build(!L),this},u.resource=function(b,L){var R;return b===void 0?this.path()+this.search()+this.hash():(R=a.parse(b),this._parts.path=R.path,this._parts.query=R.query,this._parts.fragment=R.fragment,this.build(!L),this)},u.subdomain=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,R)||""}else{var N=this._parts.hostname.length-this.domain().length,B=this._parts.hostname.substring(0,N),G=new RegExp("^"+c(B));if(b&&b.charAt(b.length-1)!=="."&&(b+="."),b.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");return b&&a.ensureValidHostname(b,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(G,b),this.build(!L),this}},u.domain=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(typeof b=="boolean"&&(L=b,b=void 0),b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.match(/\./g);if(R&&R.length<2)return this._parts.hostname;var N=this._parts.hostname.length-this.tld(L).length-1;return N=this._parts.hostname.lastIndexOf(".",N-1)+1,this._parts.hostname.substring(N)||""}else{if(!b)throw new TypeError("cannot set domain empty");if(b.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");if(a.ensureValidHostname(b,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=b;else{var B=new RegExp(c(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(B,b)}return this.build(!L),this}},u.tld=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(typeof b=="boolean"&&(L=b,b=void 0),b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var R=this._parts.hostname.lastIndexOf("."),N=this._parts.hostname.substring(R+1);return L!==!0&&n&&n.list[N.toLowerCase()]&&n.get(this._parts.hostname)||N}else{var B;if(b)if(b.match(/[^a-zA-Z0-9-]/))if(n&&n.is(b))B=new RegExp(c(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(B,b);else throw new TypeError('TLD "'+b+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");B=new RegExp(c(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(B,b)}else throw new TypeError("cannot set TLD empty");return this.build(!L),this}},u.directory=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0||b===!0){if(!this._parts.path&&!this._parts.hostname)return"";if(this._parts.path==="/")return"/";var R=this._parts.path.length-this.filename().length-1,N=this._parts.path.substring(0,R)||(this._parts.hostname?"/":"");return b?a.decodePath(N):N}else{var B=this._parts.path.length-this.filename().length,G=this._parts.path.substring(0,B),F=new RegExp("^"+c(G));return this.is("relative")||(b||(b="/"),b.charAt(0)!=="/"&&(b="/"+b)),b&&b.charAt(b.length-1)!=="/"&&(b+="/"),b=a.recodePath(b),this._parts.path=this._parts.path.replace(F,b),this.build(!L),this}},u.filename=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(typeof b!="string"){if(!this._parts.path||this._parts.path==="/")return"";var R=this._parts.path.lastIndexOf("/"),N=this._parts.path.substring(R+1);return b?a.decodePathSegment(N):N}else{var B=!1;b.charAt(0)==="/"&&(b=b.substring(1)),b.match(/\.?\//)&&(B=!0);var G=new RegExp(c(this.filename())+"$");return b=a.recodePath(b),this._parts.path=this._parts.path.replace(G,b),B?this.normalizePath(L):this.build(!L),this}},u.suffix=function(b,L){if(this._parts.urn)return b===void 0?"":this;if(b===void 0||b===!0){if(!this._parts.path||this._parts.path==="/")return"";var R=this.filename(),N=R.lastIndexOf("."),B,G;return N===-1?"":(B=R.substring(N+1),G=/^[a-z0-9%]+$/i.test(B)?B:"",b?a.decodePathSegment(G):G)}else{b.charAt(0)==="."&&(b=b.substring(1));var F=this.suffix(),k;if(F)b?k=new RegExp(c(F)+"$"):k=new RegExp(c("."+F)+"$");else{if(!b)return this;this._parts.path+="."+a.recodePath(b)}return k&&(b=a.recodePath(b),this._parts.path=this._parts.path.replace(k,b)),this.build(!L),this}},u.segment=function(b,L,R){var N=this._parts.urn?":":"/",B=this.path(),G=B.substring(0,1)==="/",F=B.split(N);if(b!==void 0&&typeof b!="number"&&(R=L,L=b,b=void 0),b!==void 0&&typeof b!="number")throw new Error('Bad segment "'+b+'", must be 0-based integer');if(G&&F.shift(),b<0&&(b=Math.max(F.length+b,0)),L===void 0)return b===void 0?F:F[b];if(b===null||F[b]===void 0)if(h(L)){F=[];for(var k=0,Z=L.length;k<Z;k++)!L[k].length&&(!F.length||!F[F.length-1].length)||(F.length&&!F[F.length-1].length&&F.pop(),F.push(y(L[k])))}else(L||typeof L=="string")&&(L=y(L),F[F.length-1]===""?F[F.length-1]=L:F.push(L));else L?F[b]=y(L):F.splice(b,1);return G&&F.unshift(""),this.path(F.join(N),R)},u.segmentCoded=function(b,L,R){var N,B,G;if(typeof b!="number"&&(R=L,L=b,b=void 0),L===void 0){if(N=this.segment(b,L,R),!h(N))N=N!==void 0?a.decode(N):void 0;else for(B=0,G=N.length;B<G;B++)N[B]=a.decode(N[B]);return N}if(!h(L))L=typeof L=="string"||L instanceof String?a.encode(L):L;else for(B=0,G=L.length;B<G;B++)L[B]=a.encode(L[B]);return this.segment(b,L,R)};var m=u.query;return u.query=function(b,L){if(b===!0)return a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof b=="function"){var R=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace),N=b.call(this,R);return this._parts.query=a.buildQuery(N||R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!L),this}else return b!==void 0&&typeof b!="string"?(this._parts.query=a.buildQuery(b,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!L),this):m.call(this,b,L)},u.setQuery=function(b,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof b=="string"||b instanceof String)N[b]=L!==void 0?L:null;else if(typeof b=="object")for(var B in b)l.call(b,B)&&(N[B]=b[B]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");return this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(R=L),this.build(!R),this},u.addQuery=function(b,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.addQuery(N,b,L===void 0?null:L),this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(R=L),this.build(!R),this},u.removeQuery=function(b,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.removeQuery(N,b,L),this._parts.query=a.buildQuery(N,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(R=L),this.build(!R),this},u.hasQuery=function(b,L,R){var N=a.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return a.hasQuery(N,b,L,R)},u.setSearch=u.setQuery,u.addSearch=u.addQuery,u.removeSearch=u.removeQuery,u.hasSearch=u.hasQuery,u.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},u.normalizeProtocol=function(b){return typeof this._parts.protocol=="string"&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!b)),this},u.normalizeHostname=function(b){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!b)),this},u.normalizePort=function(b){return typeof this._parts.protocol=="string"&&this._parts.port===a.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!b)),this},u.normalizePath=function(b){var L=this._parts.path;if(!L)return this;if(this._parts.urn)return this._parts.path=a.recodeUrnPath(this._parts.path),this.build(!b),this;if(this._parts.path==="/")return this;L=a.recodePath(L);var R,N="",B,G;for(L.charAt(0)!=="/"&&(R=!0,L="/"+L),(L.slice(-3)==="/.."||L.slice(-2)==="/.")&&(L+="/"),L=L.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),R&&(N=L.substring(1).match(/^(\.\.\/)+/)||"",N&&(N=N[0]));B=L.search(/\/\.\.(\/|$)/),B!==-1;){if(B===0){L=L.substring(3);continue}G=L.substring(0,B).lastIndexOf("/"),G===-1&&(G=B),L=L.substring(0,G)+L.substring(B+3)}return R&&this.is("relative")&&(L=N+L.substring(1)),this._parts.path=L,this.build(!b),this},u.normalizePathname=u.normalizePath,u.normalizeQuery=function(b){return typeof this._parts.query=="string"&&(this._parts.query.length?this.query(a.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!b)),this},u.normalizeFragment=function(b){return this._parts.fragment||(this._parts.fragment=null,this.build(!b)),this},u.normalizeSearch=u.normalizeQuery,u.normalizeHash=u.normalizeFragment,u.iso8859=function(){var b=a.encode,L=a.decode;a.encode=escape,a.decode=decodeURIComponent;try{this.normalize()}finally{a.encode=b,a.decode=L}return this},u.unicode=function(){var b=a.encode,L=a.decode;a.encode=w,a.decode=unescape;try{this.normalize()}finally{a.encode=b,a.decode=L}return this},u.readable=function(){var b=this.clone();b.username("").password("").normalize();var L="";if(b._parts.protocol&&(L+=b._parts.protocol+"://"),b._parts.hostname&&(b.is("punycode")&&e?(L+=e.toUnicode(b._parts.hostname),b._parts.port&&(L+=":"+b._parts.port)):L+=b.host()),b._parts.hostname&&b._parts.path&&b._parts.path.charAt(0)!=="/"&&(L+="/"),L+=b.path(!0),b._parts.query){for(var R="",N=0,B=b._parts.query.split("&"),G=B.length;N<G;N++){var F=(B[N]||"").split("=");R+="&"+a.decodeQuery(F[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),F[1]!==void 0&&(R+="="+a.decodeQuery(F[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}L+="?"+R.substring(1)}return L+=a.decodeQuery(b.hash(),!0),L},u.absoluteTo=function(b){var L=this.clone(),R=["protocol","username","password","hostname","port"],N,B,G;if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(b instanceof a||(b=new a(b)),L._parts.protocol||(L._parts.protocol=b._parts.protocol,this._parts.hostname))return L;for(B=0;G=R[B];B++)L._parts[G]=b._parts[G];return L._parts.path?(L._parts.path.substring(-2)===".."&&(L._parts.path+="/"),L.path().charAt(0)!=="/"&&(N=b.directory(),N=N||(b.path().indexOf("/")===0?"/":""),L._parts.path=(N?N+"/":"")+L._parts.path,L.normalizePath())):(L._parts.path=b._parts.path,L._parts.query||(L._parts.query=b._parts.query)),L.build(),L},u.relativeTo=function(b){var L=this.clone().normalize(),R,N,B,G,F;if(L._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(b=new a(b).normalize(),R=L._parts,N=b._parts,G=L.path(),F=b.path(),G.charAt(0)!=="/")throw new Error("URI is already relative");if(F.charAt(0)!=="/")throw new Error("Cannot calculate a URI relative to another relative URI");if(R.protocol===N.protocol&&(R.protocol=null),R.username!==N.username||R.password!==N.password||R.protocol!==null||R.username!==null||R.password!==null)return L.build();if(R.hostname===N.hostname&&R.port===N.port)R.hostname=null,R.port=null;else return L.build();if(G===F)return R.path="",L.build();if(B=a.commonPath(G,F),!B)return L.build();var k=N.path.substring(B.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return R.path=k+R.path.substring(B.length)||"./",L.build()},u.equals=function(b){var L=this.clone(),R=new a(b),N={},B={},G={},F,k,Z;if(L.normalize(),R.normalize(),L.toString()===R.toString())return!0;if(F=L.query(),k=R.query(),L.query(""),R.query(""),L.toString()!==R.toString()||F.length!==k.length)return!1;N=a.parseQuery(F,this._parts.escapeQuerySpace),B=a.parseQuery(k,this._parts.escapeQuerySpace);for(Z in N)if(l.call(N,Z)){if(h(N[Z])){if(!g(N[Z],B[Z]))return!1}else if(N[Z]!==B[Z])return!1;G[Z]=!0}for(Z in B)if(l.call(B,Z)&&!G[Z])return!1;return!0},u.preventInvalidHostname=function(b){return this._parts.preventInvalidHostname=!!b,this},u.duplicateQueryParameters=function(b){return this._parts.duplicateQueryParameters=!!b,this},u.escapeQuerySpace=function(b){return this._parts.escapeQuerySpace=!!b,this},a})});var OV=Xh((AVe,RV)=>{var dm=function(e){e==null&&(e=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};dm.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};dm.prototype.init_by_array=function(e,t){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>t?this.N:t;o;o--){var a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((a&4294901760)>>>16)*1664525<<16)+(a&65535)*1664525)+e[r]+r,this.mt[n]>>>=0,n++,r++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(o=this.N-1;o;o--){var a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((a&4294901760)>>>16)*1566083941<<16)+(a&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648};dm.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[e&1];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[e&1];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0};dm.prototype.random_int31=function(){return this.random_int()>>>1};dm.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};dm.prototype.random=function(){return this.random_int()*(1/4294967296)};dm.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};dm.prototype.random_long=function(){var e=this.random_int()>>>5,t=this.random_int()>>>6;return(e*67108864+t)*(1/9007199254740992)};RV.exports=dm});var sK=Xh((qvt,aK)=>{"use strict";aK.exports=kEe;var nS=1e20;function kEe(e,t){t||(t={});var n=t.cutoff==null?.25:t.cutoff,r=t.radius==null?8:t.radius,o=t.channel||0,a,s,u,l,c,f,h,d,p,g,y;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");a=t.width,s=t.height,l=e,t.stride?f=t.stride:f=Math.floor(e.length/a/s)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(d=e,h=d.getContext("2d"),a=d.width,s=d.height,p=h.getImageData(0,0,a,s),l=p.data,f=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(d=e.canvas,h=e,a=d.width,s=d.height,p=h.getImageData(0,0,a,s),l=p.data,f=4):window.ImageData&&e instanceof window.ImageData&&(p=e,a=e.width,s=e.height,l=p.data,f=4);if(u=Math.max(a,s),window.Uint8ClampedArray&&l instanceof window.Uint8ClampedArray||window.Uint8Array&&l instanceof window.Uint8Array)for(c=l,l=Array(a*s),g=0,y=Math.floor(c.length/f);g<y;g++)l[g]=c[g*f+o]/255;else if(f!==1)throw Error("Raw data can have only 1 value per pixel");var v=Array(a*s),w=Array(a*s),C=Array(u),E=Array(u),S=Array(u+1),A=Array(u);for(g=0,y=a*s;g<y;g++){var D=l[g];v[g]=D===1?0:D===0?nS:Math.pow(Math.max(0,.5-D),2),w[g]=D===1?nS:D===0?0:Math.pow(Math.max(0,D-.5),2)}iK(v,a,s,C,E,A,S),iK(w,a,s,C,E,A,S);var P=window.Float32Array?new Float32Array(a*s):new Array(a*s);for(g=0,y=a*s;g<y;g++)P[g]=Math.min(Math.max(1-((v[g]-w[g])/r+n),0),1);return P}function iK(e,t,n,r,o,a,s){for(var u=0;u<t;u++){for(var l=0;l<n;l++)r[l]=e[l*t+u];for(oK(r,o,a,s,n),l=0;l<n;l++)e[l*t+u]=o[l]}for(l=0;l<n;l++){for(u=0;u<t;u++)r[u]=e[l*t+u];for(oK(r,o,a,s,t),u=0;u<t;u++)e[l*t+u]=Math.sqrt(o[u])}}function oK(e,t,n,r,o){n[0]=0,r[0]=-nS,r[1]=+nS;for(var a=1,s=0;a<o;a++){for(var u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);u<=r[s];)s--,u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);s++,n[s]=a,r[s]=u,r[s+1]=+nS}for(a=0,s=0;a<o;a++){for(;r[s+1]<a;)s++;t[a]=(a-n[s])*(a-n[s])+e[n[s]]}}});var uK=Xh((Yvt,qP)=>{function GEe(){var e=0,t=1,n=2,r=3,o=4,a=5,s=6,u=7,l=8,c=9,f=10,h=11,d=12,p=13,g=14,y=15,v=16,w=17,C=0,E=1,S=2,A=3,D=4;function P(m,b){return 55296<=m.charCodeAt(b)&&m.charCodeAt(b)<=56319&&56320<=m.charCodeAt(b+1)&&m.charCodeAt(b+1)<=57343}function M(m,b){b===void 0&&(b=0);var L=m.charCodeAt(b);if(55296<=L&&L<=56319&&b<m.length-1){var R=L,N=m.charCodeAt(b+1);return 56320<=N&&N<=57343?(R-55296)*1024+(N-56320)+65536:R}if(56320<=L&&L<=57343&&b>=1){var R=m.charCodeAt(b-1),N=L;return 55296<=R&&R<=56319?(R-55296)*1024+(N-56320)+65536:N}return L}function I(m,b,L){var R=[m].concat(b).concat([L]),N=R[R.length-2],B=L,G=R.lastIndexOf(g);if(G>1&&R.slice(1,G).every(function(Z){return Z==r})&&[r,p,w].indexOf(m)==-1)return S;var F=R.lastIndexOf(o);if(F>0&&R.slice(1,F).every(function(Z){return Z==o})&&[d,o].indexOf(N)==-1)return R.filter(function(Z){return Z==o}).length%2==1?A:D;if(N==e&&B==t)return C;if(N==n||N==e||N==t)return B==g&&b.every(function(Z){return Z==r})?S:E;if(B==n||B==e||B==t)return E;if(N==s&&(B==s||B==u||B==c||B==f))return C;if((N==c||N==u)&&(B==u||B==l))return C;if((N==f||N==l)&&B==l)return C;if(B==r||B==y)return C;if(B==a)return C;if(N==d)return C;var k=R.indexOf(r)!=-1?R.lastIndexOf(r)-1:R.length-2;return[p,w].indexOf(R[k])!=-1&&R.slice(k+1,-1).every(function(Z){return Z==r})&&B==g||N==y&&[v,w].indexOf(B)!=-1?C:b.indexOf(o)!=-1?S:N==o&&B==o?C:E}this.nextBreak=function(m,b){if(b===void 0&&(b=0),b<0)return 0;if(b>=m.length-1)return m.length;for(var L=O(M(m,b)),R=[],N=b+1;N<m.length;N++)if(!P(m,N-1)){var B=O(M(m,N));if(I(L,R,B))return N;R.push(B)}return m.length},this.splitGraphemes=function(m){for(var b=[],L=0,R;(R=this.nextBreak(m,L))<m.length;)b.push(m.slice(L,R)),L=R;return L<m.length&&b.push(m.slice(L)),b},this.iterateGraphemes=function(m){var b=0,L={next:function(){var R,N;return(N=this.nextBreak(m,b))<m.length?(R=m.slice(b,N),b=N,{value:R,done:!1}):b<m.length?(R=m.slice(b),b=m.length,{value:R,done:!1}):{value:void 0,done:!0}}.bind(this)};return typeof Symbol<"u"&&Symbol.iterator&&(L[Symbol.iterator]=function(){return L}),L},this.countGraphemes=function(m){for(var b=0,L=0,R;(R=this.nextBreak(m,L))<m.length;)L=R,b++;return L<m.length&&b++,b};function O(m){return 1536<=m&&m<=1541||m==1757||m==1807||m==2274||m==3406||m==69821||70082<=m&&m<=70083||m==72250||72326<=m&&m<=72329||m==73030?d:m==13?e:m==10?t:0<=m&&m<=9||11<=m&&m<=12||14<=m&&m<=31||127<=m&&m<=159||m==173||m==1564||m==6158||m==8203||8206<=m&&m<=8207||m==8232||m==8233||8234<=m&&m<=8238||8288<=m&&m<=8292||m==8293||8294<=m&&m<=8303||55296<=m&&m<=57343||m==65279||65520<=m&&m<=65528||65529<=m&&m<=65531||113824<=m&&m<=113827||119155<=m&&m<=119162||m==917504||m==917505||917506<=m&&m<=917535||917632<=m&&m<=917759||918e3<=m&&m<=921599?n:768<=m&&m<=879||1155<=m&&m<=1159||1160<=m&&m<=1161||1425<=m&&m<=1469||m==1471||1473<=m&&m<=1474||1476<=m&&m<=1477||m==1479||1552<=m&&m<=1562||1611<=m&&m<=1631||m==1648||1750<=m&&m<=1756||1759<=m&&m<=1764||1767<=m&&m<=1768||1770<=m&&m<=1773||m==1809||1840<=m&&m<=1866||1958<=m&&m<=1968||2027<=m&&m<=2035||2070<=m&&m<=2073||2075<=m&&m<=2083||2085<=m&&m<=2087||2089<=m&&m<=2093||2137<=m&&m<=2139||2260<=m&&m<=2273||2275<=m&&m<=2306||m==2362||m==2364||2369<=m&&m<=2376||m==2381||2385<=m&&m<=2391||2402<=m&&m<=2403||m==2433||m==2492||m==2494||2497<=m&&m<=2500||m==2509||m==2519||2530<=m&&m<=2531||2561<=m&&m<=2562||m==2620||2625<=m&&m<=2626||2631<=m&&m<=2632||2635<=m&&m<=2637||m==2641||2672<=m&&m<=2673||m==2677||2689<=m&&m<=2690||m==2748||2753<=m&&m<=2757||2759<=m&&m<=2760||m==2765||2786<=m&&m<=2787||2810<=m&&m<=2815||m==2817||m==2876||m==2878||m==2879||2881<=m&&m<=2884||m==2893||m==2902||m==2903||2914<=m&&m<=2915||m==2946||m==3006||m==3008||m==3021||m==3031||m==3072||3134<=m&&m<=3136||3142<=m&&m<=3144||3146<=m&&m<=3149||3157<=m&&m<=3158||3170<=m&&m<=3171||m==3201||m==3260||m==3263||m==3266||m==3270||3276<=m&&m<=3277||3285<=m&&m<=3286||3298<=m&&m<=3299||3328<=m&&m<=3329||3387<=m&&m<=3388||m==3390||3393<=m&&m<=3396||m==3405||m==3415||3426<=m&&m<=3427||m==3530||m==3535||3538<=m&&m<=3540||m==3542||m==3551||m==3633||3636<=m&&m<=3642||3655<=m&&m<=3662||m==3761||3764<=m&&m<=3769||3771<=m&&m<=3772||3784<=m&&m<=3789||3864<=m&&m<=3865||m==3893||m==3895||m==3897||3953<=m&&m<=3966||3968<=m&&m<=3972||3974<=m&&m<=3975||3981<=m&&m<=3991||3993<=m&&m<=4028||m==4038||4141<=m&&m<=4144||4146<=m&&m<=4151||4153<=m&&m<=4154||4157<=m&&m<=4158||4184<=m&&m<=4185||4190<=m&&m<=4192||4209<=m&&m<=4212||m==4226||4229<=m&&m<=4230||m==4237||m==4253||4957<=m&&m<=4959||5906<=m&&m<=5908||5938<=m&&m<=5940||5970<=m&&m<=5971||6002<=m&&m<=6003||6068<=m&&m<=6069||6071<=m&&m<=6077||m==6086||6089<=m&&m<=6099||m==6109||6155<=m&&m<=6157||6277<=m&&m<=6278||m==6313||6432<=m&&m<=6434||6439<=m&&m<=6440||m==6450||6457<=m&&m<=6459||6679<=m&&m<=6680||m==6683||m==6742||6744<=m&&m<=6750||m==6752||m==6754||6757<=m&&m<=6764||6771<=m&&m<=6780||m==6783||6832<=m&&m<=6845||m==6846||6912<=m&&m<=6915||m==6964||6966<=m&&m<=6970||m==6972||m==6978||7019<=m&&m<=7027||7040<=m&&m<=7041||7074<=m&&m<=7077||7080<=m&&m<=7081||7083<=m&&m<=7085||m==7142||7144<=m&&m<=7145||m==7149||7151<=m&&m<=7153||7212<=m&&m<=7219||7222<=m&&m<=7223||7376<=m&&m<=7378||7380<=m&&m<=7392||7394<=m&&m<=7400||m==7405||m==7412||7416<=m&&m<=7417||7616<=m&&m<=7673||7675<=m&&m<=7679||m==8204||8400<=m&&m<=8412||8413<=m&&m<=8416||m==8417||8418<=m&&m<=8420||8421<=m&&m<=8432||11503<=m&&m<=11505||m==11647||11744<=m&&m<=11775||12330<=m&&m<=12333||12334<=m&&m<=12335||12441<=m&&m<=12442||m==42607||42608<=m&&m<=42610||42612<=m&&m<=42621||42654<=m&&m<=42655||42736<=m&&m<=42737||m==43010||m==43014||m==43019||43045<=m&&m<=43046||43204<=m&&m<=43205||43232<=m&&m<=43249||43302<=m&&m<=43309||43335<=m&&m<=43345||43392<=m&&m<=43394||m==43443||43446<=m&&m<=43449||m==43452||m==43493||43561<=m&&m<=43566||43569<=m&&m<=43570||43573<=m&&m<=43574||m==43587||m==43596||m==43644||m==43696||43698<=m&&m<=43700||43703<=m&&m<=43704||43710<=m&&m<=43711||m==43713||43756<=m&&m<=43757||m==43766||m==44005||m==44008||m==44013||m==64286||65024<=m&&m<=65039||65056<=m&&m<=65071||65438<=m&&m<=65439||m==66045||m==66272||66422<=m&&m<=66426||68097<=m&&m<=68099||68101<=m&&m<=68102||68108<=m&&m<=68111||68152<=m&&m<=68154||m==68159||68325<=m&&m<=68326||m==69633||69688<=m&&m<=69702||69759<=m&&m<=69761||69811<=m&&m<=69814||69817<=m&&m<=69818||69888<=m&&m<=69890||69927<=m&&m<=69931||69933<=m&&m<=69940||m==70003||70016<=m&&m<=70017||70070<=m&&m<=70078||70090<=m&&m<=70092||70191<=m&&m<=70193||m==70196||70198<=m&&m<=70199||m==70206||m==70367||70371<=m&&m<=70378||70400<=m&&m<=70401||m==70460||m==70462||m==70464||m==70487||70502<=m&&m<=70508||70512<=m&&m<=70516||70712<=m&&m<=70719||70722<=m&&m<=70724||m==70726||m==70832||70835<=m&&m<=70840||m==70842||m==70845||70847<=m&&m<=70848||70850<=m&&m<=70851||m==71087||71090<=m&&m<=71093||71100<=m&&m<=71101||71103<=m&&m<=71104||71132<=m&&m<=71133||71219<=m&&m<=71226||m==71229||71231<=m&&m<=71232||m==71339||m==71341||71344<=m&&m<=71349||m==71351||71453<=m&&m<=71455||71458<=m&&m<=71461||71463<=m&&m<=71467||72193<=m&&m<=72198||72201<=m&&m<=72202||72243<=m&&m<=72248||72251<=m&&m<=72254||m==72263||72273<=m&&m<=72278||72281<=m&&m<=72283||72330<=m&&m<=72342||72344<=m&&m<=72345||72752<=m&&m<=72758||72760<=m&&m<=72765||m==72767||72850<=m&&m<=72871||72874<=m&&m<=72880||72882<=m&&m<=72883||72885<=m&&m<=72886||73009<=m&&m<=73014||m==73018||73020<=m&&m<=73021||73023<=m&&m<=73029||m==73031||92912<=m&&m<=92916||92976<=m&&m<=92982||94095<=m&&m<=94098||113821<=m&&m<=113822||m==119141||119143<=m&&m<=119145||119150<=m&&m<=119154||119163<=m&&m<=119170||119173<=m&&m<=119179||119210<=m&&m<=119213||119362<=m&&m<=119364||121344<=m&&m<=121398||121403<=m&&m<=121452||m==121461||m==121476||121499<=m&&m<=121503||121505<=m&&m<=121519||122880<=m&&m<=122886||122888<=m&&m<=122904||122907<=m&&m<=122913||122915<=m&&m<=122916||122918<=m&&m<=122922||125136<=m&&m<=125142||125252<=m&&m<=125258||917536<=m&&m<=917631||917760<=m&&m<=917999?r:127462<=m&&m<=127487?o:m==2307||m==2363||2366<=m&&m<=2368||2377<=m&&m<=2380||2382<=m&&m<=2383||2434<=m&&m<=2435||2495<=m&&m<=2496||2503<=m&&m<=2504||2507<=m&&m<=2508||m==2563||2622<=m&&m<=2624||m==2691||2750<=m&&m<=2752||m==2761||2763<=m&&m<=2764||2818<=m&&m<=2819||m==2880||2887<=m&&m<=2888||2891<=m&&m<=2892||m==3007||3009<=m&&m<=3010||3014<=m&&m<=3016||3018<=m&&m<=3020||3073<=m&&m<=3075||3137<=m&&m<=3140||3202<=m&&m<=3203||m==3262||3264<=m&&m<=3265||3267<=m&&m<=3268||3271<=m&&m<=3272||3274<=m&&m<=3275||3330<=m&&m<=3331||3391<=m&&m<=3392||3398<=m&&m<=3400||3402<=m&&m<=3404||3458<=m&&m<=3459||3536<=m&&m<=3537||3544<=m&&m<=3550||3570<=m&&m<=3571||m==3635||m==3763||3902<=m&&m<=3903||m==3967||m==4145||4155<=m&&m<=4156||4182<=m&&m<=4183||m==4228||m==6070||6078<=m&&m<=6085||6087<=m&&m<=6088||6435<=m&&m<=6438||6441<=m&&m<=6443||6448<=m&&m<=6449||6451<=m&&m<=6456||6681<=m&&m<=6682||m==6741||m==6743||6765<=m&&m<=6770||m==6916||m==6965||m==6971||6973<=m&&m<=6977||6979<=m&&m<=6980||m==7042||m==7073||7078<=m&&m<=7079||m==7082||m==7143||7146<=m&&m<=7148||m==7150||7154<=m&&m<=7155||7204<=m&&m<=7211||7220<=m&&m<=7221||m==7393||7410<=m&&m<=7411||m==7415||43043<=m&&m<=43044||m==43047||43136<=m&&m<=43137||43188<=m&&m<=43203||43346<=m&&m<=43347||m==43395||43444<=m&&m<=43445||43450<=m&&m<=43451||43453<=m&&m<=43456||43567<=m&&m<=43568||43571<=m&&m<=43572||m==43597||m==43755||43758<=m&&m<=43759||m==43765||44003<=m&&m<=44004||44006<=m&&m<=44007||44009<=m&&m<=44010||m==44012||m==69632||m==69634||m==69762||69808<=m&&m<=69810||69815<=m&&m<=69816||m==69932||m==70018||70067<=m&&m<=70069||70079<=m&&m<=70080||70188<=m&&m<=70190||70194<=m&&m<=70195||m==70197||70368<=m&&m<=70370||70402<=m&&m<=70403||m==70463||70465<=m&&m<=70468||70471<=m&&m<=70472||70475<=m&&m<=70477||70498<=m&&m<=70499||70709<=m&&m<=70711||70720<=m&&m<=70721||m==70725||70833<=m&&m<=70834||m==70841||70843<=m&&m<=70844||m==70846||m==70849||71088<=m&&m<=71089||71096<=m&&m<=71099||m==71102||71216<=m&&m<=71218||71227<=m&&m<=71228||m==71230||m==71340||71342<=m&&m<=71343||m==71350||71456<=m&&m<=71457||m==71462||72199<=m&&m<=72200||m==72249||72279<=m&&m<=72280||m==72343||m==72751||m==72766||m==72873||m==72881||m==72884||94033<=m&&m<=94078||m==119142||m==119149?a:4352<=m&&m<=4447||43360<=m&&m<=43388?s:4448<=m&&m<=4519||55216<=m&&m<=55238?u:4520<=m&&m<=4607||55243<=m&&m<=55291?l:m==44032||m==44060||m==44088||m==44116||m==44144||m==44172||m==44200||m==44228||m==44256||m==44284||m==44312||m==44340||m==44368||m==44396||m==44424||m==44452||m==44480||m==44508||m==44536||m==44564||m==44592||m==44620||m==44648||m==44676||m==44704||m==44732||m==44760||m==44788||m==44816||m==44844||m==44872||m==44900||m==44928||m==44956||m==44984||m==45012||m==45040||m==45068||m==45096||m==45124||m==45152||m==45180||m==45208||m==45236||m==45264||m==45292||m==45320||m==45348||m==45376||m==45404||m==45432||m==45460||m==45488||m==45516||m==45544||m==45572||m==45600||m==45628||m==45656||m==45684||m==45712||m==45740||m==45768||m==45796||m==45824||m==45852||m==45880||m==45908||m==45936||m==45964||m==45992||m==46020||m==46048||m==46076||m==46104||m==46132||m==46160||m==46188||m==46216||m==46244||m==46272||m==46300||m==46328||m==46356||m==46384||m==46412||m==46440||m==46468||m==46496||m==46524||m==46552||m==46580||m==46608||m==46636||m==46664||m==46692||m==46720||m==46748||m==46776||m==46804||m==46832||m==46860||m==46888||m==46916||m==46944||m==46972||m==47e3||m==47028||m==47056||m==47084||m==47112||m==47140||m==47168||m==47196||m==47224||m==47252||m==47280||m==47308||m==47336||m==47364||m==47392||m==47420||m==47448||m==47476||m==47504||m==47532||m==47560||m==47588||m==47616||m==47644||m==47672||m==47700||m==47728||m==47756||m==47784||m==47812||m==47840||m==47868||m==47896||m==47924||m==47952||m==47980||m==48008||m==48036||m==48064||m==48092||m==48120||m==48148||m==48176||m==48204||m==48232||m==48260||m==48288||m==48316||m==48344||m==48372||m==48400||m==48428||m==48456||m==48484||m==48512||m==48540||m==48568||m==48596||m==48624||m==48652||m==48680||m==48708||m==48736||m==48764||m==48792||m==48820||m==48848||m==48876||m==48904||m==48932||m==48960||m==48988||m==49016||m==49044||m==49072||m==49100||m==49128||m==49156||m==49184||m==49212||m==49240||m==49268||m==49296||m==49324||m==49352||m==49380||m==49408||m==49436||m==49464||m==49492||m==49520||m==49548||m==49576||m==49604||m==49632||m==49660||m==49688||m==49716||m==49744||m==49772||m==49800||m==49828||m==49856||m==49884||m==49912||m==49940||m==49968||m==49996||m==50024||m==50052||m==50080||m==50108||m==50136||m==50164||m==50192||m==50220||m==50248||m==50276||m==50304||m==50332||m==50360||m==50388||m==50416||m==50444||m==50472||m==50500||m==50528||m==50556||m==50584||m==50612||m==50640||m==50668||m==50696||m==50724||m==50752||m==50780||m==50808||m==50836||m==50864||m==50892||m==50920||m==50948||m==50976||m==51004||m==51032||m==51060||m==51088||m==51116||m==51144||m==51172||m==51200||m==51228||m==51256||m==51284||m==51312||m==51340||m==51368||m==51396||m==51424||m==51452||m==51480||m==51508||m==51536||m==51564||m==51592||m==51620||m==51648||m==51676||m==51704||m==51732||m==51760||m==51788||m==51816||m==51844||m==51872||m==51900||m==51928||m==51956||m==51984||m==52012||m==52040||m==52068||m==52096||m==52124||m==52152||m==52180||m==52208||m==52236||m==52264||m==52292||m==52320||m==52348||m==52376||m==52404||m==52432||m==52460||m==52488||m==52516||m==52544||m==52572||m==52600||m==52628||m==52656||m==52684||m==52712||m==52740||m==52768||m==52796||m==52824||m==52852||m==52880||m==52908||m==52936||m==52964||m==52992||m==53020||m==53048||m==53076||m==53104||m==53132||m==53160||m==53188||m==53216||m==53244||m==53272||m==53300||m==53328||m==53356||m==53384||m==53412||m==53440||m==53468||m==53496||m==53524||m==53552||m==53580||m==53608||m==53636||m==53664||m==53692||m==53720||m==53748||m==53776||m==53804||m==53832||m==53860||m==53888||m==53916||m==53944||m==53972||m==54e3||m==54028||m==54056||m==54084||m==54112||m==54140||m==54168||m==54196||m==54224||m==54252||m==54280||m==54308||m==54336||m==54364||m==54392||m==54420||m==54448||m==54476||m==54504||m==54532||m==54560||m==54588||m==54616||m==54644||m==54672||m==54700||m==54728||m==54756||m==54784||m==54812||m==54840||m==54868||m==54896||m==54924||m==54952||m==54980||m==55008||m==55036||m==55064||m==55092||m==55120||m==55148||m==55176?c:44033<=m&&m<=44059||44061<=m&&m<=44087||44089<=m&&m<=44115||44117<=m&&m<=44143||44145<=m&&m<=44171||44173<=m&&m<=44199||44201<=m&&m<=44227||44229<=m&&m<=44255||44257<=m&&m<=44283||44285<=m&&m<=44311||44313<=m&&m<=44339||44341<=m&&m<=44367||44369<=m&&m<=44395||44397<=m&&m<=44423||44425<=m&&m<=44451||44453<=m&&m<=44479||44481<=m&&m<=44507||44509<=m&&m<=44535||44537<=m&&m<=44563||44565<=m&&m<=44591||44593<=m&&m<=44619||44621<=m&&m<=44647||44649<=m&&m<=44675||44677<=m&&m<=44703||44705<=m&&m<=44731||44733<=m&&m<=44759||44761<=m&&m<=44787||44789<=m&&m<=44815||44817<=m&&m<=44843||44845<=m&&m<=44871||44873<=m&&m<=44899||44901<=m&&m<=44927||44929<=m&&m<=44955||44957<=m&&m<=44983||44985<=m&&m<=45011||45013<=m&&m<=45039||45041<=m&&m<=45067||45069<=m&&m<=45095||45097<=m&&m<=45123||45125<=m&&m<=45151||45153<=m&&m<=45179||45181<=m&&m<=45207||45209<=m&&m<=45235||45237<=m&&m<=45263||45265<=m&&m<=45291||45293<=m&&m<=45319||45321<=m&&m<=45347||45349<=m&&m<=45375||45377<=m&&m<=45403||45405<=m&&m<=45431||45433<=m&&m<=45459||45461<=m&&m<=45487||45489<=m&&m<=45515||45517<=m&&m<=45543||45545<=m&&m<=45571||45573<=m&&m<=45599||45601<=m&&m<=45627||45629<=m&&m<=45655||45657<=m&&m<=45683||45685<=m&&m<=45711||45713<=m&&m<=45739||45741<=m&&m<=45767||45769<=m&&m<=45795||45797<=m&&m<=45823||45825<=m&&m<=45851||45853<=m&&m<=45879||45881<=m&&m<=45907||45909<=m&&m<=45935||45937<=m&&m<=45963||45965<=m&&m<=45991||45993<=m&&m<=46019||46021<=m&&m<=46047||46049<=m&&m<=46075||46077<=m&&m<=46103||46105<=m&&m<=46131||46133<=m&&m<=46159||46161<=m&&m<=46187||46189<=m&&m<=46215||46217<=m&&m<=46243||46245<=m&&m<=46271||46273<=m&&m<=46299||46301<=m&&m<=46327||46329<=m&&m<=46355||46357<=m&&m<=46383||46385<=m&&m<=46411||46413<=m&&m<=46439||46441<=m&&m<=46467||46469<=m&&m<=46495||46497<=m&&m<=46523||46525<=m&&m<=46551||46553<=m&&m<=46579||46581<=m&&m<=46607||46609<=m&&m<=46635||46637<=m&&m<=46663||46665<=m&&m<=46691||46693<=m&&m<=46719||46721<=m&&m<=46747||46749<=m&&m<=46775||46777<=m&&m<=46803||46805<=m&&m<=46831||46833<=m&&m<=46859||46861<=m&&m<=46887||46889<=m&&m<=46915||46917<=m&&m<=46943||46945<=m&&m<=46971||46973<=m&&m<=46999||47001<=m&&m<=47027||47029<=m&&m<=47055||47057<=m&&m<=47083||47085<=m&&m<=47111||47113<=m&&m<=47139||47141<=m&&m<=47167||47169<=m&&m<=47195||47197<=m&&m<=47223||47225<=m&&m<=47251||47253<=m&&m<=47279||47281<=m&&m<=47307||47309<=m&&m<=47335||47337<=m&&m<=47363||47365<=m&&m<=47391||47393<=m&&m<=47419||47421<=m&&m<=47447||47449<=m&&m<=47475||47477<=m&&m<=47503||47505<=m&&m<=47531||47533<=m&&m<=47559||47561<=m&&m<=47587||47589<=m&&m<=47615||47617<=m&&m<=47643||47645<=m&&m<=47671||47673<=m&&m<=47699||47701<=m&&m<=47727||47729<=m&&m<=47755||47757<=m&&m<=47783||47785<=m&&m<=47811||47813<=m&&m<=47839||47841<=m&&m<=47867||47869<=m&&m<=47895||47897<=m&&m<=47923||47925<=m&&m<=47951||47953<=m&&m<=47979||47981<=m&&m<=48007||48009<=m&&m<=48035||48037<=m&&m<=48063||48065<=m&&m<=48091||48093<=m&&m<=48119||48121<=m&&m<=48147||48149<=m&&m<=48175||48177<=m&&m<=48203||48205<=m&&m<=48231||48233<=m&&m<=48259||48261<=m&&m<=48287||48289<=m&&m<=48315||48317<=m&&m<=48343||48345<=m&&m<=48371||48373<=m&&m<=48399||48401<=m&&m<=48427||48429<=m&&m<=48455||48457<=m&&m<=48483||48485<=m&&m<=48511||48513<=m&&m<=48539||48541<=m&&m<=48567||48569<=m&&m<=48595||48597<=m&&m<=48623||48625<=m&&m<=48651||48653<=m&&m<=48679||48681<=m&&m<=48707||48709<=m&&m<=48735||48737<=m&&m<=48763||48765<=m&&m<=48791||48793<=m&&m<=48819||48821<=m&&m<=48847||48849<=m&&m<=48875||48877<=m&&m<=48903||48905<=m&&m<=48931||48933<=m&&m<=48959||48961<=m&&m<=48987||48989<=m&&m<=49015||49017<=m&&m<=49043||49045<=m&&m<=49071||49073<=m&&m<=49099||49101<=m&&m<=49127||49129<=m&&m<=49155||49157<=m&&m<=49183||49185<=m&&m<=49211||49213<=m&&m<=49239||49241<=m&&m<=49267||49269<=m&&m<=49295||49297<=m&&m<=49323||49325<=m&&m<=49351||49353<=m&&m<=49379||49381<=m&&m<=49407||49409<=m&&m<=49435||49437<=m&&m<=49463||49465<=m&&m<=49491||49493<=m&&m<=49519||49521<=m&&m<=49547||49549<=m&&m<=49575||49577<=m&&m<=49603||49605<=m&&m<=49631||49633<=m&&m<=49659||49661<=m&&m<=49687||49689<=m&&m<=49715||49717<=m&&m<=49743||49745<=m&&m<=49771||49773<=m&&m<=49799||49801<=m&&m<=49827||49829<=m&&m<=49855||49857<=m&&m<=49883||49885<=m&&m<=49911||49913<=m&&m<=49939||49941<=m&&m<=49967||49969<=m&&m<=49995||49997<=m&&m<=50023||50025<=m&&m<=50051||50053<=m&&m<=50079||50081<=m&&m<=50107||50109<=m&&m<=50135||50137<=m&&m<=50163||50165<=m&&m<=50191||50193<=m&&m<=50219||50221<=m&&m<=50247||50249<=m&&m<=50275||50277<=m&&m<=50303||50305<=m&&m<=50331||50333<=m&&m<=50359||50361<=m&&m<=50387||50389<=m&&m<=50415||50417<=m&&m<=50443||50445<=m&&m<=50471||50473<=m&&m<=50499||50501<=m&&m<=50527||50529<=m&&m<=50555||50557<=m&&m<=50583||50585<=m&&m<=50611||50613<=m&&m<=50639||50641<=m&&m<=50667||50669<=m&&m<=50695||50697<=m&&m<=50723||50725<=m&&m<=50751||50753<=m&&m<=50779||50781<=m&&m<=50807||50809<=m&&m<=50835||50837<=m&&m<=50863||50865<=m&&m<=50891||50893<=m&&m<=50919||50921<=m&&m<=50947||50949<=m&&m<=50975||50977<=m&&m<=51003||51005<=m&&m<=51031||51033<=m&&m<=51059||51061<=m&&m<=51087||51089<=m&&m<=51115||51117<=m&&m<=51143||51145<=m&&m<=51171||51173<=m&&m<=51199||51201<=m&&m<=51227||51229<=m&&m<=51255||51257<=m&&m<=51283||51285<=m&&m<=51311||51313<=m&&m<=51339||51341<=m&&m<=51367||51369<=m&&m<=51395||51397<=m&&m<=51423||51425<=m&&m<=51451||51453<=m&&m<=51479||51481<=m&&m<=51507||51509<=m&&m<=51535||51537<=m&&m<=51563||51565<=m&&m<=51591||51593<=m&&m<=51619||51621<=m&&m<=51647||51649<=m&&m<=51675||51677<=m&&m<=51703||51705<=m&&m<=51731||51733<=m&&m<=51759||51761<=m&&m<=51787||51789<=m&&m<=51815||51817<=m&&m<=51843||51845<=m&&m<=51871||51873<=m&&m<=51899||51901<=m&&m<=51927||51929<=m&&m<=51955||51957<=m&&m<=51983||51985<=m&&m<=52011||52013<=m&&m<=52039||52041<=m&&m<=52067||52069<=m&&m<=52095||52097<=m&&m<=52123||52125<=m&&m<=52151||52153<=m&&m<=52179||52181<=m&&m<=52207||52209<=m&&m<=52235||52237<=m&&m<=52263||52265<=m&&m<=52291||52293<=m&&m<=52319||52321<=m&&m<=52347||52349<=m&&m<=52375||52377<=m&&m<=52403||52405<=m&&m<=52431||52433<=m&&m<=52459||52461<=m&&m<=52487||52489<=m&&m<=52515||52517<=m&&m<=52543||52545<=m&&m<=52571||52573<=m&&m<=52599||52601<=m&&m<=52627||52629<=m&&m<=52655||52657<=m&&m<=52683||52685<=m&&m<=52711||52713<=m&&m<=52739||52741<=m&&m<=52767||52769<=m&&m<=52795||52797<=m&&m<=52823||52825<=m&&m<=52851||52853<=m&&m<=52879||52881<=m&&m<=52907||52909<=m&&m<=52935||52937<=m&&m<=52963||52965<=m&&m<=52991||52993<=m&&m<=53019||53021<=m&&m<=53047||53049<=m&&m<=53075||53077<=m&&m<=53103||53105<=m&&m<=53131||53133<=m&&m<=53159||53161<=m&&m<=53187||53189<=m&&m<=53215||53217<=m&&m<=53243||53245<=m&&m<=53271||53273<=m&&m<=53299||53301<=m&&m<=53327||53329<=m&&m<=53355||53357<=m&&m<=53383||53385<=m&&m<=53411||53413<=m&&m<=53439||53441<=m&&m<=53467||53469<=m&&m<=53495||53497<=m&&m<=53523||53525<=m&&m<=53551||53553<=m&&m<=53579||53581<=m&&m<=53607||53609<=m&&m<=53635||53637<=m&&m<=53663||53665<=m&&m<=53691||53693<=m&&m<=53719||53721<=m&&m<=53747||53749<=m&&m<=53775||53777<=m&&m<=53803||53805<=m&&m<=53831||53833<=m&&m<=53859||53861<=m&&m<=53887||53889<=m&&m<=53915||53917<=m&&m<=53943||53945<=m&&m<=53971||53973<=m&&m<=53999||54001<=m&&m<=54027||54029<=m&&m<=54055||54057<=m&&m<=54083||54085<=m&&m<=54111||54113<=m&&m<=54139||54141<=m&&m<=54167||54169<=m&&m<=54195||54197<=m&&m<=54223||54225<=m&&m<=54251||54253<=m&&m<=54279||54281<=m&&m<=54307||54309<=m&&m<=54335||54337<=m&&m<=54363||54365<=m&&m<=54391||54393<=m&&m<=54419||54421<=m&&m<=54447||54449<=m&&m<=54475||54477<=m&&m<=54503||54505<=m&&m<=54531||54533<=m&&m<=54559||54561<=m&&m<=54587||54589<=m&&m<=54615||54617<=m&&m<=54643||54645<=m&&m<=54671||54673<=m&&m<=54699||54701<=m&&m<=54727||54729<=m&&m<=54755||54757<=m&&m<=54783||54785<=m&&m<=54811||54813<=m&&m<=54839||54841<=m&&m<=54867||54869<=m&&m<=54895||54897<=m&&m<=54923||54925<=m&&m<=54951||54953<=m&&m<=54979||54981<=m&&m<=55007||55009<=m&&m<=55035||55037<=m&&m<=55063||55065<=m&&m<=55091||55093<=m&&m<=55119||55121<=m&&m<=55147||55149<=m&&m<=55175||55177<=m&&m<=55203?f:m==9757||m==9977||9994<=m&&m<=9997||m==127877||127938<=m&&m<=127940||m==127943||127946<=m&&m<=127948||128066<=m&&m<=128067||128070<=m&&m<=128080||m==128110||128112<=m&&m<=128120||m==128124||128129<=m&&m<=128131||128133<=m&&m<=128135||m==128170||128372<=m&&m<=128373||m==128378||m==128400||128405<=m&&m<=128406||128581<=m&&m<=128583||128587<=m&&m<=128591||m==128675||128692<=m&&m<=128694||m==128704||m==128716||129304<=m&&m<=129308||129310<=m&&m<=129311||m==129318||129328<=m&&m<=129337||129341<=m&&m<=129342||129489<=m&&m<=129501?p:127995<=m&&m<=127999?g:m==8205?y:m==9792||m==9794||9877<=m&&m<=9878||m==9992||m==10084||m==127752||m==127806||m==127859||m==127891||m==127908||m==127912||m==127979||m==127981||m==128139||128187<=m&&m<=128188||m==128295||m==128300||m==128488||m==128640||m==128658?v:128102<=m&&m<=128105?w:h}return this}typeof qP<"u"&&qP.exports&&(qP.exports=GEe)});var IK=Xh((zB,VB)=>{(function(e,t){typeof zB=="object"&&typeof VB<"u"?VB.exports=t():typeof define=="function"&&define.amd?define(t):e.KDBush=t()})(zB,function(){"use strict";function e(f,h,d,p,g,y){if(!(g-p<=d)){var v=p+g>>1;t(f,h,v,p,g,y%2),e(f,h,d,p,v-1,y+1),e(f,h,d,v+1,g,y+1)}}function t(f,h,d,p,g,y){for(;g>p;){if(g-p>600){var v=g-p+1,w=d-p+1,C=Math.log(v),E=.5*Math.exp(2*C/3),S=.5*Math.sqrt(C*E*(v-E)/v)*(w-v/2<0?-1:1),A=Math.max(p,Math.floor(d-w*E/v+S)),D=Math.min(g,Math.floor(d+(v-w)*E/v+S));t(f,h,d,A,D,y)}var P=h[2*d+y],M=p,I=g;for(n(f,h,p,d),h[2*g+y]>P&&n(f,h,p,g);M<I;){for(n(f,h,M,I),M++,I--;h[2*M+y]<P;)M++;for(;h[2*I+y]>P;)I--}h[2*p+y]===P?n(f,h,p,I):(I++,n(f,h,I,g)),I<=d&&(p=I+1),d<=I&&(g=I-1)}}function n(f,h,d,p){r(f,d,p),r(h,2*d,2*p),r(h,2*d+1,2*p+1)}function r(f,h,d){var p=f[h];f[h]=f[d],f[d]=p}function o(f,h,d,p,g,y,v){for(var w=[0,f.length-1,0],C=[],E,S;w.length;){var A=w.pop(),D=w.pop(),P=w.pop();if(D-P<=v){for(var M=P;M<=D;M++)E=h[2*M],S=h[2*M+1],E>=d&&E<=g&&S>=p&&S<=y&&C.push(f[M]);continue}var I=Math.floor((P+D)/2);E=h[2*I],S=h[2*I+1],E>=d&&E<=g&&S>=p&&S<=y&&C.push(f[I]);var O=(A+1)%2;(A===0?d<=E:p<=S)&&(w.push(P),w.push(I-1),w.push(O)),(A===0?g>=E:y>=S)&&(w.push(I+1),w.push(D),w.push(O))}return C}function a(f,h,d,p,g,y){for(var v=[0,f.length-1,0],w=[],C=g*g;v.length;){var E=v.pop(),S=v.pop(),A=v.pop();if(S-A<=y){for(var D=A;D<=S;D++)s(h[2*D],h[2*D+1],d,p)<=C&&w.push(f[D]);continue}var P=Math.floor((A+S)/2),M=h[2*P],I=h[2*P+1];s(M,I,d,p)<=C&&w.push(f[P]);var O=(E+1)%2;(E===0?d-g<=M:p-g<=I)&&(v.push(A),v.push(P-1),v.push(O)),(E===0?d+g>=M:p+g>=I)&&(v.push(P+1),v.push(S),v.push(O))}return w}function s(f,h,d,p){var g=f-d,y=h-p;return g*g+y*y}var u=function(f){return f[0]},l=function(f){return f[1]},c=function(h,d,p,g,y){d===void 0&&(d=u),p===void 0&&(p=l),g===void 0&&(g=64),y===void 0&&(y=Float64Array),this.nodeSize=g,this.points=h;for(var v=h.length<65536?Uint16Array:Uint32Array,w=this.ids=new v(h.length),C=this.coords=new y(h.length*2),E=0;E<h.length;E++)w[E]=E,C[2*E]=d(h[E]),C[2*E+1]=p(h[E]);e(w,C,g,0,w.length-1,0)};return c.prototype.range=function(h,d,p,g){return o(this.ids,this.coords,h,d,p,g,this.nodeSize)},c.prototype.within=function(h,d,p){return a(this.ids,this.coords,h,d,p,this.nodeSize)},c})});var yZ=Xh((CSt,_Z)=>{"use strict";/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */function H0(e){return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H0(e)}function cF(e,t){return cF=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},cF(e,t)}function dSe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aM(e,t,n){return dSe()?aM=Reflect.construct:aM=function(o,a,s){var u=[null];u.push.apply(u,a);var l=Function.bind.apply(o,u),c=new l;return s&&cF(c,s.prototype),c},aM.apply(null,arguments)}function Sd(e){return pSe(e)||mSe(e)||gSe(e)||_Se()}function pSe(e){if(Array.isArray(e))return fF(e)}function mSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gSe(e,t){if(!!e){if(typeof e=="string")return fF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fF(e,t)}}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _Se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ySe=Object.hasOwnProperty,lZ=Object.setPrototypeOf,vSe=Object.isFrozen,CSe=Object.getPrototypeOf,xSe=Object.getOwnPropertyDescriptor,Wl=Object.freeze,Bp=Object.seal,wSe=Object.create,mZ=typeof Reflect<"u"&&Reflect,uM=mZ.apply,hF=mZ.construct;uM||(uM=function(t,n,r){return t.apply(n,r)});Wl||(Wl=function(t){return t});Bp||(Bp=function(t){return t});hF||(hF=function(t,n){return aM(t,Sd(n))});var ESe=Ad(Array.prototype.forEach),cZ=Ad(Array.prototype.pop),hS=Ad(Array.prototype.push),sM=Ad(String.prototype.toLowerCase),TSe=Ad(String.prototype.match),U0=Ad(String.prototype.replace),SSe=Ad(String.prototype.indexOf),ASe=Ad(String.prototype.trim),ql=Ad(RegExp.prototype.test),oF=bSe(TypeError);function Ad(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return uM(e,t,r)}}function bSe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hF(e,n)}}function Pr(e,t,n){n=n||sM,lZ&&lZ(e,null);for(var r=t.length;r--;){var o=t[r];if(typeof o=="string"){var a=n(o);a!==o&&(vSe(t)||(t[r]=a),o=a)}e[o]=!0}return e}function Gy(e){var t=wSe(null),n;for(n in e)uM(ySe,e,[n])&&(t[n]=e[n]);return t}function iM(e,t){for(;e!==null;){var n=xSe(e,t);if(n){if(n.get)return Ad(n.get);if(typeof n.value=="function")return Ad(n.value)}e=CSe(e)}function r(o){return console.warn("fallback value for",o),null}return r}var fZ=Wl(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),aF=Wl(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),sF=Wl(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ISe=Wl(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uF=Wl(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),DSe=Wl(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hZ=Wl(["#text"]),dZ=Wl(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),lF=Wl(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),pZ=Wl(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oM=Wl(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),PSe=Bp(/\{\{[\w\W]*|[\w\W]*\}\}/gm),MSe=Bp(/<%[\w\W]*|[\w\W]*%>/gm),LSe=Bp(/^data-[\-\w.\u00B7-\uFFFF]/),RSe=Bp(/^aria-[\-\w]+$/),OSe=Bp(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),NSe=Bp(/^(?:\w+script|data):/i),BSe=Bp(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FSe=Bp(/^html$/i),zSe=function(){return typeof window>"u"?null:window},VSe=function(t,n){if(H0(t)!=="object"||typeof t.createPolicy!="function")return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var a="dompurify"+(r?"#"+r:"");try{return t.createPolicy(a,{createHTML:function(u){return u},createScriptURL:function(u){return u}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function gZ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zSe(),t=function(le){return gZ(le)};if(t.version="2.4.0",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,r=e.document,o=e.DocumentFragment,a=e.HTMLTemplateElement,s=e.Node,u=e.Element,l=e.NodeFilter,c=e.NamedNodeMap,f=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,h=e.HTMLFormElement,d=e.DOMParser,p=e.trustedTypes,g=u.prototype,y=iM(g,"cloneNode"),v=iM(g,"nextSibling"),w=iM(g,"childNodes"),C=iM(g,"parentNode");if(typeof a=="function"){var E=r.createElement("template");E.content&&E.content.ownerDocument&&(r=E.content.ownerDocument)}var S=VSe(p,n),A=S?S.createHTML(""):"",D=r,P=D.implementation,M=D.createNodeIterator,I=D.createDocumentFragment,O=D.getElementsByTagName,m=n.importNode,b={};try{b=Gy(r).documentMode?r.documentMode:{}}catch{}var L={};t.isSupported=typeof C=="function"&&P&&typeof P.createHTMLDocument<"u"&&b!==9;var R=PSe,N=MSe,B=LSe,G=RSe,F=NSe,k=BSe,Z=OSe,te=null,oe=Pr({},[].concat(Sd(fZ),Sd(aF),Sd(sF),Sd(uF),Sd(hZ))),ue=null,pe=Pr({},[].concat(Sd(dZ),Sd(lF),Sd(pZ),Sd(oM))),me=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),st=null,ht=null,jt=!0,Ct=!0,bt=!1,mn=!1,Tn=!1,zi=!1,at=!1,Sn=!1,fa=!1,Tu=!1,Gh=!0,Uh=!1,KA="user-content-",Fv=!0,Wd=!1,Bg={},Sf=null,lm=Pr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),x_=null,w_=Pr({},["audio","video","img","source","image","track"]),Fg=null,ZA=Pr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Dw="http://www.w3.org/1998/Math/MathML",E_="http://www.w3.org/2000/svg",ac="http://www.w3.org/1999/xhtml",cm=ac,Hh=!1,fm,QA=["application/xhtml+xml","text/html"],qh="text/html",to,Yu=null,Wh=r.createElement("form"),JA=function(le){return le instanceof RegExp||le instanceof Function},zv=function(le){Yu&&Yu===le||((!le||H0(le)!=="object")&&(le={}),le=Gy(le),fm=QA.indexOf(le.PARSER_MEDIA_TYPE)===-1?fm=qh:fm=le.PARSER_MEDIA_TYPE,to=fm==="application/xhtml+xml"?function(ze){return ze}:sM,te="ALLOWED_TAGS"in le?Pr({},le.ALLOWED_TAGS,to):oe,ue="ALLOWED_ATTR"in le?Pr({},le.ALLOWED_ATTR,to):pe,Fg="ADD_URI_SAFE_ATTR"in le?Pr(Gy(ZA),le.ADD_URI_SAFE_ATTR,to):ZA,x_="ADD_DATA_URI_TAGS"in le?Pr(Gy(w_),le.ADD_DATA_URI_TAGS,to):w_,Sf="FORBID_CONTENTS"in le?Pr({},le.FORBID_CONTENTS,to):lm,st="FORBID_TAGS"in le?Pr({},le.FORBID_TAGS,to):{},ht="FORBID_ATTR"in le?Pr({},le.FORBID_ATTR,to):{},Bg="USE_PROFILES"in le?le.USE_PROFILES:!1,jt=le.ALLOW_ARIA_ATTR!==!1,Ct=le.ALLOW_DATA_ATTR!==!1,bt=le.ALLOW_UNKNOWN_PROTOCOLS||!1,mn=le.SAFE_FOR_TEMPLATES||!1,Tn=le.WHOLE_DOCUMENT||!1,Sn=le.RETURN_DOM||!1,fa=le.RETURN_DOM_FRAGMENT||!1,Tu=le.RETURN_TRUSTED_TYPE||!1,at=le.FORCE_BODY||!1,Gh=le.SANITIZE_DOM!==!1,Uh=le.SANITIZE_NAMED_PROPS||!1,Fv=le.KEEP_CONTENT!==!1,Wd=le.IN_PLACE||!1,Z=le.ALLOWED_URI_REGEXP||Z,cm=le.NAMESPACE||ac,le.CUSTOM_ELEMENT_HANDLING&&JA(le.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(me.tagNameCheck=le.CUSTOM_ELEMENT_HANDLING.tagNameCheck),le.CUSTOM_ELEMENT_HANDLING&&JA(le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(me.attributeNameCheck=le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),le.CUSTOM_ELEMENT_HANDLING&&typeof le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(me.allowCustomizedBuiltInElements=le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),mn&&(Ct=!1),fa&&(Sn=!0),Bg&&(te=Pr({},Sd(hZ)),ue=[],Bg.html===!0&&(Pr(te,fZ),Pr(ue,dZ)),Bg.svg===!0&&(Pr(te,aF),Pr(ue,lF),Pr(ue,oM)),Bg.svgFilters===!0&&(Pr(te,sF),Pr(ue,lF),Pr(ue,oM)),Bg.mathMl===!0&&(Pr(te,uF),Pr(ue,pZ),Pr(ue,oM))),le.ADD_TAGS&&(te===oe&&(te=Gy(te)),Pr(te,le.ADD_TAGS,to)),le.ADD_ATTR&&(ue===pe&&(ue=Gy(ue)),Pr(ue,le.ADD_ATTR,to)),le.ADD_URI_SAFE_ATTR&&Pr(Fg,le.ADD_URI_SAFE_ATTR,to),le.FORBID_CONTENTS&&(Sf===lm&&(Sf=Gy(Sf)),Pr(Sf,le.FORBID_CONTENTS,to)),Fv&&(te["#text"]=!0),Tn&&Pr(te,["html","head","body"]),te.table&&(Pr(te,["tbody"]),delete st.tbody),Wl&&Wl(le),Yu=le)},Vv=Pr({},["mi","mo","mn","ms","mtext"]),kv=Pr({},["foreignobject","desc","title","annotation-xml"]),Yh=Pr({},["title","style","font","a","script"]),no=Pr({},aF);Pr(no,sF),Pr(no,ISe);var Yd=Pr({},uF);Pr(Yd,DSe);var T_=function(le){var ze=C(le);(!ze||!ze.tagName)&&(ze={namespaceURI:ac,tagName:"template"});var rt=sM(le.tagName),Vi=sM(ze.tagName);return le.namespaceURI===E_?ze.namespaceURI===ac?rt==="svg":ze.namespaceURI===Dw?rt==="svg"&&(Vi==="annotation-xml"||Vv[Vi]):Boolean(no[rt]):le.namespaceURI===Dw?ze.namespaceURI===ac?rt==="math":ze.namespaceURI===E_?rt==="math"&&kv[Vi]:Boolean(Yd[rt]):le.namespaceURI===ac?ze.namespaceURI===E_&&!kv[Vi]||ze.namespaceURI===Dw&&!Vv[Vi]?!1:!Yd[rt]&&(Yh[rt]||!no[rt]):!1},Af=function(le){hS(t.removed,{element:le});try{le.parentNode.removeChild(le)}catch{try{le.outerHTML=A}catch{le.remove()}}},zg=function(le,ze){try{hS(t.removed,{attribute:ze.getAttributeNode(le),from:ze})}catch{hS(t.removed,{attribute:null,from:ze})}if(ze.removeAttribute(le),le==="is"&&!ue[le])if(Sn||fa)try{Af(ze)}catch{}else try{ze.setAttribute(le,"")}catch{}},Xd=function(le){var ze,rt;if(at)le="<remove></remove>"+le;else{var Vi=TSe(le,/^[\r\n\t ]+/);rt=Vi&&Vi[0]}fm==="application/xhtml+xml"&&(le='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+le+"</body></html>");var sc=S?S.createHTML(le):le;if(cm===ac)try{ze=new d().parseFromString(sc,fm)}catch{}if(!ze||!ze.documentElement){ze=P.createDocument(cm,"template",null);try{ze.documentElement.innerHTML=Hh?"":sc}catch{}}var Xu=ze.body||ze.documentElement;return le&&rt&&Xu.insertBefore(r.createTextNode(rt),Xu.childNodes[0]||null),cm===ac?O.call(ze,Tn?"html":"body")[0]:Tn?ze.documentElement:Xu},cV=function(le){return M.call(le.ownerDocument||le,le,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Bie=function(le){return le instanceof h&&(typeof le.nodeName!="string"||typeof le.textContent!="string"||typeof le.removeChild!="function"||!(le.attributes instanceof f)||typeof le.removeAttribute!="function"||typeof le.setAttribute!="function"||typeof le.namespaceURI!="string"||typeof le.insertBefore!="function")},Pw=function(le){return H0(s)==="object"?le instanceof s:le&&H0(le)==="object"&&typeof le.nodeType=="number"&&typeof le.nodeName=="string"},hm=function(le,ze,rt){!L[le]||ESe(L[le],function(Vi){Vi.call(t,ze,rt,Yu)})},fV=function(le){var ze;if(hm("beforeSanitizeElements",le,null),Bie(le)||ql(/[\u0080-\uFFFF]/,le.nodeName))return Af(le),!0;var rt=to(le.nodeName);if(hm("uponSanitizeElement",le,{tagName:rt,allowedTags:te}),le.hasChildNodes()&&!Pw(le.firstElementChild)&&(!Pw(le.content)||!Pw(le.content.firstElementChild))&&ql(/<[/\w]/g,le.innerHTML)&&ql(/<[/\w]/g,le.textContent)||rt==="select"&&ql(/<template/i,le.innerHTML))return Af(le),!0;if(!te[rt]||st[rt]){if(!st[rt]&&dV(rt)&&(me.tagNameCheck instanceof RegExp&&ql(me.tagNameCheck,rt)||me.tagNameCheck instanceof Function&&me.tagNameCheck(rt)))return!1;if(Fv&&!Sf[rt]){var Vi=C(le)||le.parentNode,sc=w(le)||le.childNodes;if(sc&&Vi)for(var Xu=sc.length,Su=Xu-1;Su>=0;--Su)Vi.insertBefore(y(sc[Su],!0),v(le))}return Af(le),!0}return le instanceof u&&!T_(le)||(rt==="noscript"||rt==="noembed")&&ql(/<\/no(script|embed)/i,le.innerHTML)?(Af(le),!0):(mn&&le.nodeType===3&&(ze=le.textContent,ze=U0(ze,R," "),ze=U0(ze,N," "),le.textContent!==ze&&(hS(t.removed,{element:le.cloneNode()}),le.textContent=ze)),hm("afterSanitizeElements",le,null),!1)},hV=function(le,ze,rt){if(Gh&&(ze==="id"||ze==="name")&&(rt in r||rt in Wh))return!1;if(!(Ct&&!ht[ze]&&ql(B,ze))){if(!(jt&&ql(G,ze))){if(!ue[ze]||ht[ze]){if(!(dV(le)&&(me.tagNameCheck instanceof RegExp&&ql(me.tagNameCheck,le)||me.tagNameCheck instanceof Function&&me.tagNameCheck(le))&&(me.attributeNameCheck instanceof RegExp&&ql(me.attributeNameCheck,ze)||me.attributeNameCheck instanceof Function&&me.attributeNameCheck(ze))||ze==="is"&&me.allowCustomizedBuiltInElements&&(me.tagNameCheck instanceof RegExp&&ql(me.tagNameCheck,rt)||me.tagNameCheck instanceof Function&&me.tagNameCheck(rt))))return!1}else if(!Fg[ze]){if(!ql(Z,U0(rt,k,""))){if(!((ze==="src"||ze==="xlink:href"||ze==="href")&&le!=="script"&&SSe(rt,"data:")===0&&x_[le])){if(!(bt&&!ql(F,U0(rt,k,"")))){if(rt)return!1}}}}}}return!0},dV=function(le){return le.indexOf("-")>0},pV=function(le){var ze,rt,Vi,sc;hm("beforeSanitizeAttributes",le,null);var Xu=le.attributes;if(!!Xu){var Su={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ue};for(sc=Xu.length;sc--;){ze=Xu[sc];var $A=ze,ju=$A.name,OR=$A.namespaceURI;if(rt=ju==="value"?ze.value:ASe(ze.value),Vi=to(ju),Su.attrName=Vi,Su.attrValue=rt,Su.keepAttr=!0,Su.forceKeepAttr=void 0,hm("uponSanitizeAttribute",le,Su),rt=Su.attrValue,!Su.forceKeepAttr&&(zg(ju,le),!!Su.keepAttr)){if(ql(/\/>/i,rt)){zg(ju,le);continue}mn&&(rt=U0(rt,R," "),rt=U0(rt,N," "));var mV=to(le.nodeName);if(!!hV(mV,Vi,rt)){if(Uh&&(Vi==="id"||Vi==="name")&&(zg(ju,le),rt=KA+rt),S&&H0(p)==="object"&&typeof p.getAttributeType=="function"&&!OR)switch(p.getAttributeType(mV,Vi)){case"TrustedHTML":rt=S.createHTML(rt);break;case"TrustedScriptURL":rt=S.createScriptURL(rt);break}try{OR?le.setAttributeNS(OR,ju,rt):le.setAttribute(ju,rt),cZ(t.removed)}catch{}}}}hm("afterSanitizeAttributes",le,null)}},Fie=function Rt(le){var ze,rt=cV(le);for(hm("beforeSanitizeShadowDOM",le,null);ze=rt.nextNode();)hm("uponSanitizeShadowNode",ze,null),!fV(ze)&&(ze.content instanceof o&&Rt(ze.content),pV(ze));hm("afterSanitizeShadowDOM",le,null)};return t.sanitize=function(Rt){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze,rt,Vi,sc,Xu;if(Hh=!Rt,Hh&&(Rt="<!-->"),typeof Rt!="string"&&!Pw(Rt)){if(typeof Rt.toString!="function")throw oF("toString is not a function");if(Rt=Rt.toString(),typeof Rt!="string")throw oF("dirty is not a string, aborting")}if(!t.isSupported){if(H0(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof Rt=="string")return e.toStaticHTML(Rt);if(Pw(Rt))return e.toStaticHTML(Rt.outerHTML)}return Rt}if(zi||zv(le),t.removed=[],typeof Rt=="string"&&(Wd=!1),Wd){if(Rt.nodeName){var Su=to(Rt.nodeName);if(!te[Su]||st[Su])throw oF("root node is forbidden and cannot be sanitized in-place")}}else if(Rt instanceof s)ze=Xd("<!---->"),rt=ze.ownerDocument.importNode(Rt,!0),rt.nodeType===1&&rt.nodeName==="BODY"||rt.nodeName==="HTML"?ze=rt:ze.appendChild(rt);else{if(!Sn&&!mn&&!Tn&&Rt.indexOf("<")===-1)return S&&Tu?S.createHTML(Rt):Rt;if(ze=Xd(Rt),!ze)return Sn?null:Tu?A:""}ze&&at&&Af(ze.firstChild);for(var $A=cV(Wd?Rt:ze);Vi=$A.nextNode();)Vi.nodeType===3&&Vi===sc||fV(Vi)||(Vi.content instanceof o&&Fie(Vi.content),pV(Vi),sc=Vi);if(sc=null,Wd)return Rt;if(Sn){if(fa)for(Xu=I.call(ze.ownerDocument);ze.firstChild;)Xu.appendChild(ze.firstChild);else Xu=ze;return ue.shadowroot&&(Xu=m.call(n,Xu,!0)),Xu}var ju=Tn?ze.outerHTML:ze.innerHTML;return Tn&&te["!doctype"]&&ze.ownerDocument&&ze.ownerDocument.doctype&&ze.ownerDocument.doctype.name&&ql(FSe,ze.ownerDocument.doctype.name)&&(ju="<!DOCTYPE "+ze.ownerDocument.doctype.name+`>
`+ju),mn&&(ju=U0(ju,R," "),ju=U0(ju,N," ")),S&&Tu?S.createHTML(ju):ju},t.setConfig=function(Rt){zv(Rt),zi=!0},t.clearConfig=function(){Yu=null,zi=!1},t.isValidAttribute=function(Rt,le,ze){Yu||zv({});var rt=to(Rt),Vi=to(le);return hV(rt,Vi,ze)},t.addHook=function(Rt,le){typeof le=="function"&&(L[Rt]=L[Rt]||[],hS(L[Rt],le))},t.removeHook=function(Rt){if(L[Rt])return cZ(L[Rt])},t.removeHooks=function(Rt){L[Rt]&&(L[Rt]=[])},t.removeAllHooks=function(){L={}},t}var kSe=gZ();_Z.exports=kSe});var S$=Xh((ABt,cz)=>{"use strict";cz.exports=ZM;cz.exports.default=ZM;function ZM(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=w$(e,0,o,n,!0),s=[];if(!a||a.next===a.prev)return s;var u,l,c,f,h,d,p;if(r&&(a=LLe(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var g=n;g<o;g+=n)h=e[g],d=e[g+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?32767/p:0}return BS(a,s,n,u,l,p,0),s}function w$(e,t,n,r,o){var a,s;if(o===lz(e,t,n,r)>0)for(a=t;a<n;a+=r)s=x$(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=x$(a,e[a],e[a+1],s);return s&&QM(s,s.next)&&(zS(s),s=s.next),s}function tv(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(QM(n,n.next)||Ta(n.prev,n,n.next)===0)){if(zS(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function BS(e,t,n,r,o,a,s){if(!!e){!s&&a&&FLe(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?DLe(e,r,o,a):ILe(e)){t.push(l.i/n|0),t.push(e.i/n|0),t.push(c.i/n|0),zS(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=PLe(tv(e),t,n),BS(e,t,n,r,o,a,2)):s===2&&MLe(e,t,n,r,o,a):BS(tv(e),t,n,r,o,a,1);break}}}}function ILe(e){var t=e.prev,n=e,r=e.next;if(Ta(t,n,r)>=0)return!1;for(var o=t.x,a=n.x,s=r.x,u=t.y,l=n.y,c=r.y,f=o<a?o<s?o:s:a<s?a:s,h=u<l?u<c?u:c:l<c?l:c,d=o>a?o>s?o:s:a>s?a:s,p=u>l?u>c?u:c:l>c?l:c,g=r.next;g!==t;){if(g.x>=f&&g.x<=d&&g.y>=h&&g.y<=p&&ox(o,u,a,l,s,c,g.x,g.y)&&Ta(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function DLe(e,t,n,r){var o=e.prev,a=e,s=e.next;if(Ta(o,a,s)>=0)return!1;for(var u=o.x,l=a.x,c=s.x,f=o.y,h=a.y,d=s.y,p=u<l?u<c?u:c:l<c?l:c,g=f<h?f<d?f:d:h<d?h:d,y=u>l?u>c?u:c:l>c?l:c,v=f>h?f>d?f:d:h>d?h:d,w=sz(p,g,t,n,r),C=sz(y,v,t,n,r),E=e.prevZ,S=e.nextZ;E&&E.z>=w&&S&&S.z<=C;){if(E.x>=p&&E.x<=y&&E.y>=g&&E.y<=v&&E!==o&&E!==s&&ox(u,f,l,h,c,d,E.x,E.y)&&Ta(E.prev,E,E.next)>=0||(E=E.prevZ,S.x>=p&&S.x<=y&&S.y>=g&&S.y<=v&&S!==o&&S!==s&&ox(u,f,l,h,c,d,S.x,S.y)&&Ta(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;E&&E.z>=w;){if(E.x>=p&&E.x<=y&&E.y>=g&&E.y<=v&&E!==o&&E!==s&&ox(u,f,l,h,c,d,E.x,E.y)&&Ta(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;S&&S.z<=C;){if(S.x>=p&&S.x<=y&&S.y>=g&&S.y<=v&&S!==o&&S!==s&&ox(u,f,l,h,c,d,S.x,S.y)&&Ta(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function PLe(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!QM(o,a)&&E$(o,r,r.next,a)&&FS(o,a)&&FS(a,o)&&(t.push(o.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),zS(r),zS(r.next),r=e=a),r=r.next}while(r!==e);return tv(r)}function MLe(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&kLe(s,u)){var l=T$(s,u);s=tv(s,s.next),l=tv(l,l.next),BS(s,t,n,r,o,a,0),BS(l,t,n,r,o,a,0);return}u=u.next}s=s.next}while(s!==e)}function LLe(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=w$(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(VLe(c));for(o.sort(RLe),a=0;a<o.length;a++)n=OLe(o[a],n);return n}function RLe(e,t){return e.x-t.x}function OLe(e,t){var n=NLe(e,t);if(!n)return t;var r=T$(n,e);return tv(r,r.next),tv(n,n.next)}function NLe(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a&&(a=u,s=n.x<n.next.x?n:n.next,u===r))return s}n=n.next}while(n!==t);if(!s)return null;var l=s,c=s.x,f=s.y,h=1/0,d;n=s;do r>=n.x&&n.x>=c&&r!==n.x&&ox(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),FS(n,e)&&(d<h||d===h&&(n.x>s.x||n.x===s.x&&BLe(s,n)))&&(s=n,h=d)),n=n.next;while(n!==l);return s}function BLe(e,t){return Ta(e.prev,e,t.prev)<0&&Ta(t.next,e,e.next)<0}function FLe(e,t,n,r){var o=e;do o.z===0&&(o.z=sz(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,zLe(o)}function zLe(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function sz(e,t,n,r,o){return e=(e-n)*o|0,t=(t-r)*o|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function VLe(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function ox(e,t,n,r,o,a,s,u){return(o-s)*(t-u)>=(e-s)*(a-u)&&(e-s)*(r-u)>=(n-s)*(t-u)&&(n-s)*(a-u)>=(o-s)*(r-u)}function kLe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!GLe(e,t)&&(FS(e,t)&&FS(t,e)&&ULe(e,t)&&(Ta(e.prev,e,t.prev)||Ta(e,t.prev,t))||QM(e,t)&&Ta(e.prev,e,e.next)>0&&Ta(t.prev,t,t.next)>0)}function Ta(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function QM(e,t){return e.x===t.x&&e.y===t.y}function E$(e,t,n,r){var o=KM(Ta(e,t,n)),a=KM(Ta(e,t,r)),s=KM(Ta(n,r,e)),u=KM(Ta(n,r,t));return!!(o!==a&&s!==u||o===0&&jM(e,n,t)||a===0&&jM(e,r,t)||s===0&&jM(n,e,r)||u===0&&jM(n,t,r))}function jM(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function KM(e){return e>0?1:e<0?-1:0}function GLe(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&E$(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function FS(e,t){return Ta(e.prev,e,e.next)<0?Ta(e,t,e.next)>=0&&Ta(e,e.prev,t)>=0:Ta(e,t,e.prev)<0||Ta(e,e.next,t)<0}function ULe(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function T$(e,t){var n=new uz(e.i,e.x,e.y),r=new uz(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function x$(e,t,n,r){var o=new uz(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function zS(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function uz(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ZM.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(lz(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(lz(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,g=r[u+2]*n;h+=Math.abs((e[d]-e[g])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[g+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function lz(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}ZM.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}});var mie=Xh((DR,pie)=>{(function(e,t){typeof DR=="object"&&typeof pie<"u"?t(DR):typeof define=="function"&&define.amd?define(["exports"],t):(e=e||self,t(e.topojson=e.topojson||{}))})(DR,function(e){"use strict";function t(E){return E}function n(E){if(E==null)return t;var S,A,D=E.scale[0],P=E.scale[1],M=E.translate[0],I=E.translate[1];return function(O,m){m||(S=A=0);var b=2,L=O.length,R=new Array(L);for(R[0]=(S+=O[0])*D+M,R[1]=(A+=O[1])*P+I;b<L;)R[b]=O[b],++b;return R}}function r(E){var S=n(E.transform),A,D=1/0,P=D,M=-D,I=-D;function O(b){b=S(b),b[0]<D&&(D=b[0]),b[0]>M&&(M=b[0]),b[1]<P&&(P=b[1]),b[1]>I&&(I=b[1])}function m(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(m);break;case"Point":O(b.coordinates);break;case"MultiPoint":b.coordinates.forEach(O);break}}E.arcs.forEach(function(b){for(var L=-1,R=b.length,N;++L<R;)N=S(b[L],L),N[0]<D&&(D=N[0]),N[0]>M&&(M=N[0]),N[1]<P&&(P=N[1]),N[1]>I&&(I=N[1])});for(A in E.objects)m(E.objects[A]);return[D,P,M,I]}function o(E,S){for(var A,D=E.length,P=D-S;P<--D;)A=E[P],E[P++]=E[D],E[D]=A}function a(E,S){return typeof S=="string"&&(S=E.objects[S]),S.type==="GeometryCollection"?{type:"FeatureCollection",features:S.geometries.map(function(A){return s(E,A)})}:s(E,S)}function s(E,S){var A=S.id,D=S.bbox,P=S.properties==null?{}:S.properties,M=u(E,S);return A==null&&D==null?{type:"Feature",properties:P,geometry:M}:D==null?{type:"Feature",id:A,properties:P,geometry:M}:{type:"Feature",id:A,bbox:D,properties:P,geometry:M}}function u(E,S){var A=n(E.transform),D=E.arcs;function P(L,R){R.length&&R.pop();for(var N=D[L<0?~L:L],B=0,G=N.length;B<G;++B)R.push(A(N[B],B));L<0&&o(R,G)}function M(L){return A(L)}function I(L){for(var R=[],N=0,B=L.length;N<B;++N)P(L[N],R);return R.length<2&&R.push(R[0]),R}function O(L){for(var R=I(L);R.length<4;)R.push(R[0]);return R}function m(L){return L.map(O)}function b(L){var R=L.type,N;switch(R){case"GeometryCollection":return{type:R,geometries:L.geometries.map(b)};case"Point":N=M(L.coordinates);break;case"MultiPoint":N=L.coordinates.map(M);break;case"LineString":N=I(L.arcs);break;case"MultiLineString":N=L.arcs.map(I);break;case"Polygon":N=m(L.arcs);break;case"MultiPolygon":N=L.arcs.map(m);break;default:return null}return{type:R,coordinates:N}}return b(S)}function l(E,S){var A={},D={},P={},M=[],I=-1;S.forEach(function(b,L){var R=E.arcs[b<0?~b:b],N;R.length<3&&!R[1][0]&&!R[1][1]&&(N=S[++I],S[I]=b,S[L]=N)}),S.forEach(function(b){var L=O(b),R=L[0],N=L[1],B,G;if(B=P[R])if(delete P[B.end],B.push(b),B.end=N,G=D[N]){delete D[G.start];var F=G===B?B:B.concat(G);D[F.start=B.start]=P[F.end=G.end]=F}else D[B.start]=P[B.end]=B;else if(B=D[N])if(delete D[B.start],B.unshift(b),B.start=R,G=P[R]){delete P[G.end];var k=G===B?B:G.concat(B);D[k.start=G.start]=P[k.end=B.end]=k}else D[B.start]=P[B.end]=B;else B=[b],D[B.start=R]=P[B.end=N]=B});function O(b){var L=E.arcs[b<0?~b:b],R=L[0],N;return E.transform?(N=[0,0],L.forEach(function(B){N[0]+=B[0],N[1]+=B[1]})):N=L[L.length-1],b<0?[N,R]:[R,N]}function m(b,L){for(var R in b){var N=b[R];delete L[N.start],delete N.start,delete N.end,N.forEach(function(B){A[B<0?~B:B]=1}),M.push(N)}}return m(P,D),m(D,P),S.forEach(function(b){A[b<0?~b:b]||M.push([b])}),M}function c(E){return u(E,f.apply(this,arguments))}function f(E,S,A){var D,P,M;if(arguments.length>1)D=h(E,S,A);else for(P=0,D=new Array(M=E.arcs.length);P<M;++P)D[P]=P;return{type:"MultiLineString",arcs:l(E,D)}}function h(E,S,A){var D=[],P=[],M;function I(R){var N=R<0?~R:R;(P[N]||(P[N]=[])).push({i:R,g:M})}function O(R){R.forEach(I)}function m(R){R.forEach(O)}function b(R){R.forEach(m)}function L(R){switch(M=R,R.type){case"GeometryCollection":R.geometries.forEach(L);break;case"LineString":O(R.arcs);break;case"MultiLineString":case"Polygon":m(R.arcs);break;case"MultiPolygon":b(R.arcs);break}}return L(S),P.forEach(A==null?function(R){D.push(R[0].i)}:function(R){A(R[0].g,R[R.length-1].g)&&D.push(R[0].i)}),D}function d(E){for(var S=-1,A=E.length,D,P=E[A-1],M=0;++S<A;)D=P,P=E[S],M+=D[0]*P[1]-D[1]*P[0];return Math.abs(M)}function p(E){return u(E,g.apply(this,arguments))}function g(E,S){var A={},D=[],P=[];S.forEach(M);function M(m){switch(m.type){case"GeometryCollection":m.geometries.forEach(M);break;case"Polygon":I(m.arcs);break;case"MultiPolygon":m.arcs.forEach(I);break}}function I(m){m.forEach(function(b){b.forEach(function(L){(A[L=L<0?~L:L]||(A[L]=[])).push(m)})}),D.push(m)}function O(m){return d(u(E,{type:"Polygon",arcs:[m]}).coordinates[0])}return D.forEach(function(m){if(!m._){var b=[],L=[m];for(m._=1,P.push(b);m=L.pop();)b.push(m),m.forEach(function(R){R.forEach(function(N){A[N<0?~N:N].forEach(function(B){B._||(B._=1,L.push(B))})})})}}),D.forEach(function(m){delete m._}),{type:"MultiPolygon",arcs:P.map(function(m){var b=[],L;if(m.forEach(function(F){F.forEach(function(k){k.forEach(function(Z){A[Z<0?~Z:Z].length<2&&b.push(Z)})})}),b=l(E,b),(L=b.length)>1)for(var R=1,N=O(b[0]),B,G;R<L;++R)(B=O(b[R]))>N&&(G=b[0],b[0]=b[R],b[R]=G,N=B);return b}).filter(function(m){return m.length>0})}}function y(E,S){for(var A=0,D=E.length;A<D;){var P=A+D>>>1;E[P]<S?A=P+1:D=P}return A}function v(E){var S={},A=E.map(function(){return[]});function D(F,k){F.forEach(function(Z){Z<0&&(Z=~Z);var te=S[Z];te?te.push(k):S[Z]=[k]})}function P(F,k){F.forEach(function(Z){D(Z,k)})}function M(F,k){F.type==="GeometryCollection"?F.geometries.forEach(function(Z){M(Z,k)}):F.type in I&&I[F.type](F.arcs,k)}var I={LineString:D,MultiLineString:P,Polygon:P,MultiPolygon:function(F,k){F.forEach(function(Z){P(Z,k)})}};E.forEach(M);for(var O in S)for(var m=S[O],b=m.length,L=0;L<b;++L)for(var R=L+1;R<b;++R){var N=m[L],B=m[R],G;(G=A[N])[O=y(G,B)]!==B&&G.splice(O,0,B),(G=A[B])[O=y(G,N)]!==N&&G.splice(O,0,N)}return A}function w(E){if(E==null)return t;var S,A,D=E.scale[0],P=E.scale[1],M=E.translate[0],I=E.translate[1];return function(O,m){m||(S=A=0);var b=2,L=O.length,R=new Array(L),N=Math.round((O[0]-M)/D),B=Math.round((O[1]-I)/P);for(R[0]=N-S,S=N,R[1]=B-A,A=B;b<L;)R[b]=O[b],++b;return R}}function C(E,S){if(E.transform)throw new Error("already quantized");if(!S||!S.scale){if(!((I=Math.floor(S))>=2))throw new Error("n must be \u22652");m=E.bbox||r(E);var A=m[0],D=m[1],P=m[2],M=m[3],I;S={scale:[P-A?(P-A)/(I-1):1,M-D?(M-D)/(I-1):1],translate:[A,D]}}else m=E.bbox;var O=w(S),m,b,L=E.objects,R={};function N(F){return O(F)}function B(F){var k;switch(F.type){case"GeometryCollection":k={type:"GeometryCollection",geometries:F.geometries.map(B)};break;case"Point":k={type:"Point",coordinates:N(F.coordinates)};break;case"MultiPoint":k={type:"MultiPoint",coordinates:F.coordinates.map(N)};break;default:return F}return F.id!=null&&(k.id=F.id),F.bbox!=null&&(k.bbox=F.bbox),F.properties!=null&&(k.properties=F.properties),k}function G(F){var k=0,Z=1,te=F.length,oe,ue=new Array(te);for(ue[0]=O(F[0],0);++k<te;)((oe=O(F[k],k))[0]||oe[1])&&(ue[Z++]=oe);return Z===1&&(ue[Z++]=[0,0]),ue.length=Z,ue}for(b in L)R[b]=B(L[b]);return{type:"Topology",bbox:m,transform:S,objects:R,arcs:E.arcs.map(G)}}e.bbox=r,e.feature=a,e.merge=p,e.mergeArcs=g,e.mesh=c,e.meshArcs=f,e.neighbors=v,e.quantize=C,e.transform=n,e.untransform=w,Object.defineProperty(e,"__esModule",{value:!0})})});var P4e={};Hie(P4e,{EMExtensionsMixin:()=>_V,EV_AirSpace:()=>ek,EV_AnnulusPrimitive:()=>pb,EV_Billboard:()=>Xi,EV_BillboardCollection:()=>Zw,EV_ColorHandle:()=>o6,EV_CoodTransfrom:()=>u6,EV_CsDrawHelper:()=>W6,EV_Curve:()=>rI,EV_CustomCylider:()=>Y6,EV_CustomizedPARadar:()=>fC,EV_DataOperated:()=>Br,EV_DatagramManager:()=>wI,EV_DrawConnectionLines:()=>EI,EV_DrawCoordinates:()=>Z6,EV_DrawHandler:()=>oW,EV_DrawMilGeometry:()=>dI,EV_DrawPrimitives:()=>dC,EV_DrawType:()=>td,EV_FanRing:()=>uC,EV_Gif:()=>mD,EV_GifCollection:()=>aW,EV_Graphic:()=>cW,EV_GraphicAnalysis:()=>oj,EV_Instanced3DCylinder:()=>NP,EV_Instanced3DSector:()=>T1,EV_LabelPullWireCollection:()=>BP,EV_LineInstance:()=>sI,EV_LoadMTData:()=>_$,EV_Locking:()=>DM,EV_MTCesium3DTileBatchTable:()=>TS,EV_MTDataTransmission:()=>die,EV_MTInstanced3DModelContent:()=>Id,EV_MTLabelConfigurationTable:()=>_h,EV_MTLightningCollection:()=>SR,EV_MTModel:()=>wS,EV_MTModelInstance:()=>CM,EV_MTModelInstanceCollection:()=>xM,EV_MechanicalRadar:()=>Kg,EV_MilStd2DLinePrimitive:()=>C$,EV_MilStd2DMarkerPrimitive:()=>YM,EV_MilStd2DRenderManager:()=>XM,EV_MilStd3DLinePrimitive:()=>rL,EV_MilStd3DMarkerPrimitive:()=>iL,EV_MilStd3DRenderManager:()=>oL,EV_MilStdActionDeduce:()=>eee,EV_MilStdAnchorCollection:()=>ov,EV_MilStdDeduceGroup:()=>aL,EV_MilStdDeduceManager:()=>sL,EV_MilStdDrawHelper:()=>aee,EV_MilStdLayerManager:()=>uL,EV_MilStdLineSymbol:()=>dx,EV_MilStdMarkerSymbol:()=>px,EV_MilStdSelectionBoxHandle:()=>see,EV_MilitaryPlottingService:()=>WM,EV_MovingTarget:()=>rE,EV_MovingTargetAnalysis:()=>tie,EV_MovingTargetBoundingBoxCollection:()=>SM,EV_MovingTargetFlightControl:()=>hie,EV_MovingTargetFlightData:()=>Pu,EV_MovingTargetManager:()=>gh,EV_MovingTargetRibbonCollection:()=>cC,EV_MovingTargetSensorManager:()=>bR,EV_MovingTargetTrace:()=>xI,EV_MovingTargetTraceBarCollection:()=>TM,EV_MovingTargetTraceLineCollection:()=>AM,EV_MovingTargetTraceWallCollection:()=>EM,EV_MovingTargetUpdateProperties:()=>IR,EV_MovingTargetVisualizer:()=>bM,EV_MsgType:()=>Re,EV_OlDrawHelper:()=>_ie,EV_OlDrawPrimitives:()=>PR,EV_OlMapControl:()=>yie,EV_OlPriManager:()=>MR,EV_PARadarBeam:()=>ER,EV_ParseArrayRadar:()=>sC,EV_ParseCombatPower:()=>pw,EV_ParseCommand:()=>Rie,EV_ParseEWS:()=>ww,EV_ParseFlight:()=>vw,EV_ParseGTspi:()=>dw,EV_ParseHeader:()=>sn,EV_ParseI3NS:()=>lw,EV_ParseI3NS_Deprecated:()=>mw,EV_ParseIRSTworkMode:()=>xw,EV_ParseIrsmState:()=>gw,EV_ParseLargePlane:()=>Aw,EV_ParseParam:()=>Cw,EV_ParseRTKN:()=>fw,EV_ParseRTSN:()=>cw,EV_ParseRadarTarget:()=>_w,EV_ParseRadarWM:()=>yw,EV_ParseSDRState:()=>Tw,EV_ParseSafetyAlarm:()=>Sw,EV_ParseStartStop:()=>Ew,EV_ParseStaticTarget:()=>Oie,EV_ParseTRAJ:()=>hw,EV_PipeObject:()=>wie,EV_PolylineVolumeGeometry:()=>iv,EV_PolylineVolumeGeometryLibrary:()=>US,EV_PureColor:()=>Sie,EV_Pyramid:()=>Aie,EV_RadarJamDirection:()=>Nie,EV_Receive:()=>vI,EV_SatelliteTraceLineCollection:()=>Iie,EV_ScreenEventAggregator:()=>pD,EV_ScreenEventType:()=>U_,EV_SeviceAnalysis:()=>Die,EV_Special:()=>wR,EV_TargetRing:()=>uI,EV_TerrainShade:()=>cI,EV_TraceType:()=>Hi,EV_VehicleRadar:()=>jg,EV_WSGetMessage:()=>Mie,EV_WSGetMessageJava:()=>Lie,EV_loadKTX:()=>FP,MT_CzmlDataSource:()=>LM,VERSION:()=>D4e,turf:()=>rw});module.exports=qie(P4e);var Ko={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(Ko,{maximumCombinedTextureImageUnits:{get:function(){return Ko._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return Ko._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return Ko._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return Ko._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return Ko._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return Ko._maximumTextureSize}},maximumVaryingVectors:{get:function(){return Ko._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return Ko._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return Ko._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return Ko._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return Ko._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return Ko._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return Ko._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return Ko._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return Ko._maximumViewportWidth}},maximumViewportHeight:{get:function(){return Ko._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return Ko._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return Ko._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return Ko._maximumColorAttachments}},maximumSamples:{get:function(){return Ko._maximumSamples}},highpFloatSupported:{get:function(){return Ko._highpFloatSupported}},highpIntSupported:{get:function(){return Ko._highpIntSupported}}});var Kt=Ko;function Wie(e,t){Kt._maximumCombinedTextureImageUnits=Cesium.ContextLimits._maximumCombinedTextureImageUnits,Kt._maximumCubeMapSize=Cesium.ContextLimits._maximumCubeMapSize,Kt._maximumFragmentUniformVectors=Cesium.ContextLimits._maximumFragmentUniformVectors,Kt._maximumTextureImageUnits=Cesium.ContextLimits._maximumTextureImageUnits,Kt._maximumRenderbufferSize=Cesium.ContextLimits._maximumRenderbufferSize,Kt._maximumTextureSize=Cesium.ContextLimits._maximumTextureSize,Kt._maximumVertexAttributes=Cesium.ContextLimits._maximumVertexAttributes,Kt._maximumVertexTextureImageUnits=Cesium.ContextLimits._maximumVertexTextureImageUnits,Kt._maximumVertexUniformVectors=Cesium.ContextLimits._maximumVertexUniformVectors,Kt._minimumAliasedLineWidth=Cesium.ContextLimits._minimumAliasedLineWidth,Kt._maximumAliasedLineWidth=Cesium.ContextLimits._maximumAliasedLineWidth,Kt._minimumAliasedPointSize=Cesium.ContextLimits._minimumAliasedPointSize,Kt._maximumAliasedPointSize=Cesium.ContextLimits._maximumAliasedPointSize,Kt._maximumViewportWidth=Cesium.ContextLimits._maximumViewportWidth,Kt._maximumViewportHeight=Cesium.ContextLimits._maximumViewportHeight,Kt._highpFloatSupported=Cesium.ContextLimits._highpFloatSupported,Kt._highpIntSupported=Cesium.ContextLimits._highpIntSupported,Kt._maximumTextureFilterAnisotropy=Cesium.ContextLimits._maximumTextureFilterAnisotropy,Kt._maximumDrawBuffers=Cesium.ContextLimits._maximumDrawBuffers,Kt._maximumColorAttachments=Cesium.ContextLimits._maximumColorAttachments}var _V=Wie;function Yie(e){return e!=null}var _=Yie;function S_(e){this.name="DeveloperError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}_(Object.create)&&(S_.prototype=Object.create(Error.prototype),S_.prototype.constructor=S_);S_.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return _(this.stack)&&(e+=`
${this.stack.toString()}`),e};S_.throwInstantiationError=function(){throw new S_("This function defines an interface and should not be called directly.")};var Le=S_;var Qi=Vg(TV(),1);function SV(e,t){return e??t}SV.EMPTY_OBJECT=Object.freeze({});var T=SV;function NR(e,t){let n;return typeof document<"u"&&(n=document),NR._implementation(e,t,n)}NR._implementation=function(e,t,n){if(!_(t)){if(typeof n>"u")return e;t=T(n.baseURI,n.location.href)}let r=new Qi.default(e);return r.scheme()!==""?r.toString():r.absoluteTo(t).toString()};var A_=NR;function Xie(e){return(e.length===0||e[e.length-1]!=="/")&&(e=`${e}/`),e}var AV=Xie;var ts={};ts.typeOf={};function jie(e){return`${e} is required, actual value was undefined`}function Hv(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}ts.defined=function(e,t){if(!_(t))throw new Le(jie(e))};ts.typeOf.func=function(e,t){if(typeof t!="function")throw new Le(Hv(typeof t,"function",e))};ts.typeOf.string=function(e,t){if(typeof t!="string")throw new Le(Hv(typeof t,"string",e))};ts.typeOf.number=function(e,t){if(typeof t!="number")throw new Le(Hv(typeof t,"number",e))};ts.typeOf.number.lessThan=function(e,t,n){if(ts.typeOf.number(e,t),t>=n)throw new Le(`Expected ${e} to be less than ${n}, actual value was ${t}`)};ts.typeOf.number.lessThanOrEquals=function(e,t,n){if(ts.typeOf.number(e,t),t>n)throw new Le(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)};ts.typeOf.number.greaterThan=function(e,t,n){if(ts.typeOf.number(e,t),t<=n)throw new Le(`Expected ${e} to be greater than ${n}, actual value was ${t}`)};ts.typeOf.number.greaterThanOrEquals=function(e,t,n){if(ts.typeOf.number(e,t),t<n)throw new Le(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)};ts.typeOf.object=function(e,t){if(typeof t!="object")throw new Le(Hv(typeof t,"object",e))};ts.typeOf.bool=function(e,t){if(typeof t!="boolean")throw new Le(Hv(typeof t,"boolean",e))};ts.typeOf.bigint=function(e,t){if(typeof t!="bigint")throw new Le(Hv(typeof t,"bigint",e))};ts.typeOf.number.equals=function(e,t,n,r){if(ts.typeOf.number(e,n),ts.typeOf.number(t,r),n!==r)throw new Le(`${e} must be equal to ${t}, the actual values are ${n} and ${r}`)};var Ss=ts;function bV(e,t){if(e===null||typeof e!="object")return e;t=T(t,!1);let n=new e.constructor;for(let r in e)if(e.hasOwnProperty(r)){let o=e[r];t&&(o=bV(o,t)),n[r]=o}return n}var kt=bV;function IV(e,t,n){n=T(n,!1);let r={},o=_(e),a=_(t),s,u,l;if(o)for(s in e)e.hasOwnProperty(s)&&(u=e[s],a&&n&&typeof u=="object"&&t.hasOwnProperty(s)?(l=t[s],typeof l=="object"?r[s]=IV(u,l,n):r[s]=u):r[s]=u);if(a)for(s in t)t.hasOwnProperty(s)&&!r.hasOwnProperty(s)&&(l=t[s],r[s]=l);return r}var Yi=IV;function Kie(){let e,t,n=new Promise(function(r,o){e=r,t=o});return{resolve:e,reject:t,promise:n}}var Ro=Kie;function Zie(e,t){let n="",r=e.lastIndexOf("/");return r!==-1&&(n=e.substring(0,r+1)),t&&(e=new Qi.default(e),e.query().length!==0&&(n+=`?${e.query()}`),e.fragment().length!==0&&(n+=`#${e.fragment()}`)),n}var DV=Zie;function Qie(e){let t=new Qi.default(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return r!==-1&&(n=n.substr(r+1)),r=n.lastIndexOf("."),r===-1?n="":n=n.substr(r+1),n}var PV=Qie;var MV={};function Jie(e,t,n){_(t)||(t=e.width),_(n)||(n=e.height);let r=MV[t];_(r)||(r={},MV[t]=r);let o=r[n];if(!_(o)){let a=document.createElement("canvas");a.width=t,a.height=n,o=a.getContext("2d"),o.globalCompositeOperation="copy",r[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}var BR=Jie;var $ie=/^blob:/i;function eoe(e){return $ie.test(e)}var ib=eoe;var jd;function toe(e){_(jd)||(jd=document.createElement("a")),jd.href=window.location.href;let t=jd.host,n=jd.protocol;return jd.href=e,jd.href=jd.href,n!==jd.protocol||t!==jd.host}var ob=toe;var noe=/^data:/i;function roe(e){return noe.test(e)}var ab=roe;function ioe(e){let t=document.createElement("script");return t.async=!0,t.src=e,new Promise((n,r)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");let o=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,o.removeChild(t),n()},t.onerror=function(a){r(a)},o.appendChild(t)})}var LV=ioe;var sb=Vg(OV(),1);var Ie={};Ie.EPSILON1=.1;Ie.EPSILON2=.01;Ie.EPSILON3=.001;Ie.EPSILON4=1e-4;Ie.EPSILON5=1e-5;Ie.EPSILON6=1e-6;Ie.EPSILON7=1e-7;Ie.EPSILON8=1e-8;Ie.EPSILON9=1e-9;Ie.EPSILON10=1e-10;Ie.EPSILON11=1e-11;Ie.EPSILON12=1e-12;Ie.EPSILON13=1e-13;Ie.EPSILON14=1e-14;Ie.EPSILON15=1e-15;Ie.EPSILON16=1e-16;Ie.EPSILON17=1e-17;Ie.EPSILON18=1e-18;Ie.EPSILON19=1e-19;Ie.EPSILON20=1e-20;Ie.EPSILON21=1e-21;Ie.GRAVITATIONALPARAMETER=3986004418e5;Ie.SOLAR_RADIUS=6955e5;Ie.LUNAR_RADIUS=1737400;Ie.SIXTY_FOUR_KILOBYTES=64*1024;Ie.FOUR_GIGABYTES=4*1024*1024*1024;Ie.sign=T(Math.sign,function(t){return t=+t,t===0||t!==t?t:t>0?1:-1});Ie.signNotZero=function(e){return e<0?-1:1};Ie.toSNorm=function(e,t){return t=T(t,255),Math.round((Ie.clamp(e,-1,1)*.5+.5)*t)};Ie.fromSNorm=function(e,t){return t=T(t,255),Ie.clamp(e,0,t)/t*2-1};Ie.normalize=function(e,t,n){return n=Math.max(n-t,0),n===0?0:Ie.clamp((e-t)/n,0,1)};Ie.sinh=T(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2});Ie.cosh=T(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2});Ie.lerp=function(e,t,n){return(1-n)*e+n*t};Ie.PI=Math.PI;Ie.ONE_OVER_PI=1/Math.PI;Ie.PI_OVER_TWO=Math.PI/2;Ie.PI_OVER_THREE=Math.PI/3;Ie.PI_OVER_FOUR=Math.PI/4;Ie.PI_OVER_SIX=Math.PI/6;Ie.THREE_PI_OVER_TWO=3*Math.PI/2;Ie.TWO_PI=2*Math.PI;Ie.ONE_OVER_TWO_PI=1/(2*Math.PI);Ie.RADIANS_PER_DEGREE=Math.PI/180;Ie.DEGREES_PER_RADIAN=180/Math.PI;Ie.RADIANS_PER_ARCSECOND=Ie.RADIANS_PER_DEGREE/3600;Ie.toRadians=function(e){return e*Ie.RADIANS_PER_DEGREE};Ie.toDegrees=function(e){return e*Ie.DEGREES_PER_RADIAN};Ie.convertLongitudeRange=function(e){let t=Ie.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n};Ie.clampToLatitudeRange=function(e){return Ie.clamp(e,-1*Ie.PI_OVER_TWO,Ie.PI_OVER_TWO)};Ie.negativePiToPi=function(e){return e>=-Ie.PI&&e<=Ie.PI?e:Ie.zeroToTwoPi(e+Ie.PI)-Ie.PI};Ie.zeroToTwoPi=function(e){if(e>=0&&e<=Ie.TWO_PI)return e;let t=Ie.mod(e,Ie.TWO_PI);return Math.abs(t)<Ie.EPSILON14&&Math.abs(e)>Ie.EPSILON14?Ie.TWO_PI:t};Ie.mod=function(e,t){return Ie.sign(e)===Ie.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t};Ie.equalsEpsilon=function(e,t,n,r){n=T(n,0),r=T(r,n);let o=Math.abs(e-t);return o<=r||o<=n*Math.max(Math.abs(e),Math.abs(t))};Ie.lessThan=function(e,t,n){return e-t<-n};Ie.lessThanOrEquals=function(e,t,n){return e-t<n};Ie.greaterThan=function(e,t,n){return e-t>n};Ie.greaterThanOrEquals=function(e,t,n){return e-t>-n};var ub=[1];Ie.factorial=function(e){let t=ub.length;if(e>=t){let n=ub[t-1];for(let r=t;r<=e;r++){let o=n*r;ub.push(o),n=o}}return ub[e]};Ie.incrementWrap=function(e,t,n){return n=T(n,0),++e,e>t&&(e=n),e};Ie.isPowerOfTwo=function(e){return e!==0&&(e&e-1)===0};Ie.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e,e};Ie.previousPowerOfTwo=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e|=e>>32,e=(e>>>0)-(e>>>1),e};Ie.clamp=function(e,t,n){return e<t?t:e>n?n:e};var NV=new sb.default;Ie.setRandomNumberSeed=function(e){NV=new sb.default(e)};Ie.nextRandomNumber=function(){return NV.random()};Ie.randomBetween=function(e,t){return Ie.nextRandomNumber()*(t-e)+e};Ie.acosClamped=function(e){return Math.acos(Ie.clamp(e,-1,1))};Ie.asinClamped=function(e){return Math.asin(Ie.clamp(e,-1,1))};Ie.chordLength=function(e,t){return 2*t*Math.sin(e*.5)};Ie.logBase=function(e,t){return Math.log(e)/Math.log(t)};Ie.cbrt=T(Math.cbrt,function(t){let n=Math.pow(Math.abs(t),.3333333333333333);return t<0?-n:n});Ie.log2=T(Math.log2,function(t){return Math.log(t)*Math.LOG2E});Ie.fog=function(e,t){let n=e*t;return 1-Math.exp(-(n*n))};Ie.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)};Ie.fastApproximateAtan2=function(e,t){let n,r=Math.abs(e);n=Math.abs(t);let o=Math.max(r,n);n=Math.min(r,n);let a=n/o;return r=Ie.fastApproximateAtan(a),r=Math.abs(t)>Math.abs(e)?Ie.PI_OVER_TWO-r:r,r=e<0?Ie.PI-r:r,r=t<0?-r:r,r};var z=Ie;function ooe(e){let t="";for(let n in e)if(e.hasOwnProperty(n)){let r=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(r))for(let a=0,s=r.length;a<s;++a)t+=`${o+encodeURIComponent(r[a])}&`;else t+=`${o+encodeURIComponent(r)}&`}return t=t.slice(0,-1),t}var BV=ooe;function aoe(e){let t={};if(e==="")return t;let n=e.replace(/\+/g,"%20").split(/[&;]/);for(let r=0,o=n.length;r<o;++r){let a=n[r].split("="),s=decodeURIComponent(a[0]),u=a[1];_(u)?u=decodeURIComponent(u):u="";let l=t[s];typeof l=="string"?t[s]=[l,u]:Array.isArray(l)?l.push(u):t[s]=u}return t}var FV=aoe;var soe={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},Zo=Object.freeze(soe);var uoe={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},zV=Object.freeze(uoe);function lb(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.throttleByServer,!1),n=T(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=T(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=T(e.type,zV.OTHER),this.serverKey=void 0,this.state=Zo.UNISSUED,this.deferred=void 0,this.cancelled=!1}lb.prototype.cancel=function(){this.cancelled=!0};lb.prototype.clone=function(e){return _(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new lb(this)};var VV=lb;function loe(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let r=0;r<n.length;++r){let o=n[r],a=o.indexOf(": ");if(a>0){let s=o.substring(0,a),u=o.substring(a+2);t[s]=u}}return t}var kV=loe;function GV(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,typeof this.responseHeaders=="string"&&(this.responseHeaders=kV(this.responseHeaders))}GV.prototype.toString=function(){let e="Request has failed.";return _(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e};var Mw=GV;function Lw(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}Object.defineProperties(Lw.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});Lw.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);let n=this;return function(){n.removeEventListener(e,t)}};Lw.prototype.removeEventListener=function(e,t){let n=this._listeners,r=this._scopes,o=-1;for(let a=0;a<n.length;a++)if(n[a]===e&&r[a]===t){o=a;break}return o!==-1?(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,r[o]=void 0):(n.splice(o,1),r.splice(o,1)),!0):!1};function coe(e,t){return t-e}Lw.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let e,t=this._listeners,n=this._scopes,r=t.length;for(e=0;e<r;e++){let a=t[e];_(a)&&t[e].apply(n[e],arguments)}let o=this._toRemove;if(r=o.length,r>0){for(o.sort(coe),e=0;e<r;e++){let a=o[e];t.splice(a,1),n.splice(a,1)}o.length=0}this._insideRaiseEvent=!1};var xe=Lw;function b_(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}Object.defineProperties(b_.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){let t=this._length;if(e<t){let n=this._array;for(let r=e;r<t;++r)n[r]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}});function FR(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}b_.prototype.reserve=function(e){e=T(e,this._length),this._array.length=e};b_.prototype.heapify=function(e){e=T(e,0);let t=this._length,n=this._comparator,r=this._array,o=-1,a=!0;for(;a;){let s=2*(e+1),u=s-1;u<t&&n(r[u],r[e])<0?o=u:o=e,s<t&&n(r[s],r[o])<0&&(o=s),o!==e?(FR(r,o,e),e=o):a=!1}};b_.prototype.resort=function(){let e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)};b_.prototype.insert=function(e){let t=this._array,n=this._comparator,r=this._maximumLength,o=this._length++;for(o<t.length?t[o]=e:t.push(e);o!==0;){let s=Math.floor((o-1)/2);if(n(t[o],t[s])<0)FR(t,o,s),o=s;else break}let a;return _(r)&&this._length>r&&(a=t[r],this._length=r),a};b_.prototype.pop=function(e){if(e=T(e,0),this._length===0)return;let t=this._array,n=t[e];return FR(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};var UV=b_;function foe(e,t){return e.priority-t.priority}var pi={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},qv=20,Ku=new UV({comparator:foe});Ku.maximumLength=qv;Ku.reserve(qv);var Kd=[],pm={},hoe=typeof document<"u"?new Qi.default(document.location.href):new Qi.default,cb=new xe;function To(){}To.maximumRequests=50;To.maximumRequestsPerServer=6;To.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18};To.throttleRequests=!0;To.debugShowStatistics=!1;To.requestCompletedEvent=cb;Object.defineProperties(To,{statistics:{get:function(){return pi}},priorityHeapLength:{get:function(){return qv},set:function(e){if(e<qv)for(;Ku.length>e;){let t=Ku.pop();I_(t)}qv=e,Ku.maximumLength=e,Ku.reserve(e)}}});function HV(e){_(e.priorityFunction)&&(e.priority=e.priorityFunction())}To.serverHasOpenSlots=function(e,t){t=T(t,1);let n=T(To.requestsByServer[e],To.maximumRequestsPerServer);return pm[e]+t<=n};To.heapHasOpenSlots=function(e){return Ku.length+e<=qv};function qV(e){return e.state===Zo.UNISSUED&&(e.state=Zo.ISSUED,e.deferred=Ro()),e.deferred.promise}function doe(e){return function(t){if(e.state===Zo.CANCELLED)return;let n=e.deferred;--pi.numberOfActiveRequests,--pm[e.serverKey],cb.raiseEvent(),e.state=Zo.RECEIVED,e.deferred=void 0,n.resolve(t)}}function poe(e){return function(t){e.state!==Zo.CANCELLED&&(++pi.numberOfFailedRequests,--pi.numberOfActiveRequests,--pm[e.serverKey],cb.raiseEvent(t),e.state=Zo.FAILED,e.deferred.reject(t))}}function WV(e){let t=qV(e);return e.state=Zo.ACTIVE,Kd.push(e),++pi.numberOfActiveRequests,++pi.numberOfActiveRequestsEver,++pm[e.serverKey],e.requestFunction().then(doe(e)).catch(poe(e)),t}function I_(e){let t=e.state===Zo.ACTIVE;if(e.state=Zo.CANCELLED,++pi.numberOfCancelledRequests,_(e.deferred)){let n=e.deferred;e.deferred=void 0,n.reject()}t&&(--pi.numberOfActiveRequests,--pm[e.serverKey],++pi.numberOfCancelledActiveRequests),_(e.cancelFunction)&&e.cancelFunction()}To.update=function(){let e,t,n=0,r=Kd.length;for(e=0;e<r;++e){if(t=Kd[e],t.cancelled&&I_(t),t.state!==Zo.ACTIVE){++n;continue}n>0&&(Kd[e-n]=t)}Kd.length-=n;let o=Ku.internalArray,a=Ku.length;for(e=0;e<a;++e)HV(o[e]);Ku.resort();let s=Math.max(To.maximumRequests-Kd.length,0),u=0;for(;u<s&&Ku.length>0;){if(t=Ku.pop(),t.cancelled){I_(t);continue}if(t.throttleByServer&&!To.serverHasOpenSlots(t.serverKey)){I_(t);continue}WV(t),++u}moe()};To.getServerKey=function(e){let t=new Qi.default(e);t.scheme()===""&&(t=new Qi.default(e).absoluteTo(hoe),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${t.scheme()==="https"?"443":"80"}`);let r=pm[n];return _(r)||(pm[n]=0),n};To.request=function(e){if(ab(e.url)||ib(e.url))return cb.raiseEvent(),e.state=Zo.RECEIVED,e.requestFunction();if(++pi.numberOfAttemptedRequests,_(e.serverKey)||(e.serverKey=To.getServerKey(e.url)),To.throttleRequests&&e.throttleByServer&&!To.serverHasOpenSlots(e.serverKey))return;if(!To.throttleRequests||!e.throttle)return WV(e);if(Kd.length>=To.maximumRequests)return;HV(e);let t=Ku.insert(e);if(_(t)){if(t===e)return;I_(t)}return qV(e)};function moe(){!To.debugShowStatistics||(pi.numberOfActiveRequests===0&&pi.lastNumberOfActiveRequests>0&&(pi.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${pi.numberOfAttemptedRequests}`),pi.numberOfAttemptedRequests=0),pi.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${pi.numberOfCancelledRequests}`),pi.numberOfCancelledRequests=0),pi.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${pi.numberOfCancelledActiveRequests}`),pi.numberOfCancelledActiveRequests=0),pi.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${pi.numberOfFailedRequests}`),pi.numberOfFailedRequests=0)),pi.lastNumberOfActiveRequests=pi.numberOfActiveRequests)}To.clearForSpecs=function(){for(;Ku.length>0;){let t=Ku.pop();I_(t)}let e=Kd.length;for(let t=0;t<e;++t)I_(Kd[t]);Kd.length=0,pm={},pi.numberOfAttemptedRequests=0,pi.numberOfActiveRequests=0,pi.numberOfCancelledRequests=0,pi.numberOfCancelledActiveRequests=0,pi.numberOfFailedRequests=0,pi.numberOfActiveRequestsEver=0,pi.lastNumberOfActiveRequests=0};To.numberOfActiveRequestsByServer=function(e){return pm[e]};To.requestHeap=Ku;var fb=To;function Rw(e){this.name="RuntimeError",this.message=e;let t;try{throw new Error}catch(n){t=n.stack}this.stack=t}_(Object.create)&&(Rw.prototype=Object.create(Error.prototype),Rw.prototype.constructor=Rw);Rw.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return _(this.stack)&&(e+=`
${this.stack.toString()}`),e};var it=Rw;var Ow={},Wv={};Ow.add=function(e,t){let n=`${e.toLowerCase()}:${t}`;_(Wv[n])||(Wv[n]=!0)};Ow.remove=function(e,t){let n=`${e.toLowerCase()}:${t}`;_(Wv[n])&&delete Wv[n]};function goe(e){let t=new Qi.default(e);t.normalize();let n=t.authority();if(n.length!==0){if(t.authority(n),n.indexOf("@")!==-1&&(n=n.split("@")[1]),n.indexOf(":")===-1){let r=t.scheme();if(r.length===0&&(r=window.location.protocol,r=r.substring(0,r.length-1)),r==="http")n+=":80";else if(r==="https")n+=":443";else return}return n}}Ow.contains=function(e){let t=goe(e);return!!(_(t)&&_(Wv[t]))};Ow.clear=function(){Wv={}};var zR=Ow;var jV=function(){try{let e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob",e.responseType==="blob"}catch{return!1}}();function _oe(e){return typeof e=="string"&&(e.indexOf("earthview")!==-1||e.indexOf("EV_WebService")!==-1)}function kR(e,t,n,r){let o=e.query(),a;if(_oe(e.path())&&(a=D_(Ve._evServerQueryParam,a,!1)),!_(o)||o.length===0)return t._queryParameters=D_(t._queryParameters,a,!1);if(o.indexOf("=")===-1){let s={};s[o]=void 0,a=s}else{let s=FV(o);a=D_(s,a,!1)}n?t._queryParameters=D_(a,t._queryParameters,r):t._queryParameters=a,e.search("")}function yoe(e,t){let n=t._queryParameters,r=Object.keys(n);r.length===1&&!_(n[r[0]])?e.search(r[0]):e.search(BV(n))}function Zd(e,t){return _(e)?_(e.clone)?e.clone():kt(e):t}function GR(e){if(e.state===Zo.ISSUED||e.state===Zo.ACTIVE)throw new it("The Resource is already being fetched.");e.state=Zo.UNISSUED,e.deferred=void 0}function D_(e,t,n){if(!n)return Yi(e,t);let r=kt(e,!0);for(let o in t)if(t.hasOwnProperty(o)){let a=r[o],s=t[o];_(a)?(Array.isArray(a)||(a=r[o]=[a]),r[o]=a.concat(s)):r[o]=Array.isArray(s)?s.slice():s}return r}function Ve(e){e=T(e,T.EMPTY_OBJECT),typeof e=="string"&&(e={url:e}),this._url=void 0,this._templateValues=Zd(e.templateValues,{}),this._queryParameters=Zd(e.queryParameters,{}),this.headers=Zd(e.headers,{}),this.request=T(e.request,new VV),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=T(e.retryAttempts,0),this._retryCount=0;let t=new Qi.default(e.url);kR(t,this,!0,!0),t.fragment(""),this._url=t.toString()}Ve.createIfNeeded=function(e){return e instanceof Ve?e.getDerivedResource({request:e.request}):typeof e!="string"?e:new Ve({url:e})};var Yv;Ve.supportsImageBitmapOptions=function(){if(_(Yv))return Yv;if(typeof createImageBitmap!="function")return Yv=Promise.resolve(!1),Yv;let e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC";return Yv=Ve.fetchBlob({url:e}).then(function(t){let n={imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"};return Promise.all([createImageBitmap(t,n),createImageBitmap(t)])}).then(function(t){let n=BR(t[0]),r=BR(t[1]);return n[1]!==r[1]}).catch(function(){return!1}),Yv};Object.defineProperties(Ve,{isBlobSupported:{get:function(){return jV}}});Object.defineProperties(Ve.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){let t=new Qi.default(e);kR(t,this,!1),t.fragment(""),this._url=t.toString()}},extension:{get:function(){return PV(this._url)}},isDataUri:{get:function(){return ab(this._url)}},isBlobUri:{get:function(){return ib(this._url)}},isCrossOriginUrl:{get:function(){return ob(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}});Ve.prototype.toString=function(){return this.getUrlComponent(!0,!0)};Ve.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=new Qi.default(this._url);e&&yoe(n,this);let r=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),o=this._templateValues;return r=r.replace(/{(.*?)}/g,function(a,s){let u=o[s];return _(u)?encodeURIComponent(u):a}),t&&_(this.proxy)&&(r=this.proxy.getURL(r)),r};Ve.prototype.setQueryParameters=function(e,t){t?this._queryParameters=D_(this._queryParameters,e,!1):this._queryParameters=D_(e,this._queryParameters,!1)};Ve.prototype.appendQueryParameters=function(e){this._queryParameters=D_(e,this._queryParameters,!0)};Ve.prototype.setTemplateValues=function(e,t){t?this._templateValues=Yi(this._templateValues,e):this._templateValues=Yi(e,this._templateValues)};Ve.prototype.getDerivedResource=function(e){let t=this.clone();if(t._retryCount=0,_(e.url)){let n=new Qi.default(e.url),r=T(e.preserveQueryParameters,!1);kR(n,t,!0,r),n.fragment(""),n.scheme()!==""?t._url=n.toString():t._url=n.absoluteTo(new Qi.default(A_(this._url))).toString()}return _(e.queryParameters)&&(t._queryParameters=Yi(e.queryParameters,t._queryParameters)),_(e.templateValues)&&(t._templateValues=Yi(e.templateValues,t.templateValues)),_(e.headers)&&(t.headers=Yi(e.headers,t.headers)),_(e.proxy)&&(t.proxy=e.proxy),_(e.request)&&(t.request=e.request),_(e.retryCallback)&&(t.retryCallback=e.retryCallback),_(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t};Ve.prototype.retryOnError=function(e){let t=this.retryCallback;if(typeof t!="function"||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let n=this;return Promise.resolve(t(this,e)).then(function(r){return++n._retryCount,r})};Ve.prototype.clone=function(e){return _(e)||(e=new Ve({url:this._url})),e._url=this._url,e._queryParameters=kt(this._queryParameters),e._templateValues=kt(this._templateValues),e.headers=kt(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e};Ve.prototype.getBaseUri=function(e){return DV(this.getUrlComponent(e),e)};Ve.prototype.appendForwardSlash=function(){this._url=AV(this._url)};Ve.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})};Ve.fetchArrayBuffer=function(e){return new Ve(e).fetchArrayBuffer()};Ve.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})};Ve.fetchBlob=function(e){return new Ve(e).fetchBlob()};Ve.prototype.fetchImage=function(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.preferImageBitmap,!1),n=T(e.preferBlob,!1),r=T(e.flipY,!1),o=T(e.skipColorSpaceConversion,!1);if(GR(this.request),!jV||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return VR({resource:this,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:t});let a=this.fetchBlob();if(!_(a))return;let s,u,l,c;return Ve.supportsImageBitmapOptions().then(function(f){return s=f,u=s&&t,a}).then(function(f){if(!_(f))return;if(c=f,u)return Ve.createImageBitmapFromBlob(f,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});let h=window.URL.createObjectURL(f);return l=new Ve({url:h}),VR({resource:l,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:!1})}).then(function(f){if(!!_(f))return f.blob=c,u||window.URL.revokeObjectURL(l.url),f}).catch(function(f){return _(l)&&window.URL.revokeObjectURL(l.url),f.blob=c,Promise.reject(f)})};function VR(e){let t=e.resource,n=e.flipY,r=e.skipColorSpaceConversion,o=e.preferImageBitmap,a=t.request;a.url=t.url,a.requestFunction=function(){let u=!1;!t.isDataUri&&!t.isBlobUri&&(u=t.isCrossOriginUrl);let l=Ro();return Ve._Implementations.createImage(a,u,l,n,r,o),l.promise};let s=fb.request(a);if(!!_(s))return s.catch(function(u){return a.state!==Zo.FAILED?Promise.reject(u):t.retryOnError(u).then(function(l){return l?(a.state=Zo.UNISSUED,a.deferred=void 0,VR({resource:t,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:o})):Promise.reject(u)})})}Ve.fetchImage=function(e){return new Ve(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})};Ve.prototype.fetchText=function(){return this.fetch({responseType:"text"})};Ve.fetchText=function(e){return new Ve(e).fetchText()};Ve.prototype.fetchJson=function(){let e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(!!_(e))return e.then(function(t){if(!!_(t))return JSON.parse(t)})};Ve.fetchJson=function(e){return new Ve(e).fetchJson()};Ve.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})};Ve.fetchXML=function(e){return new Ve(e).fetchXML()};Ve.prototype.fetchJsonp=function(e){e=T(e,"callback"),GR(this.request);let t;do t=`loadJsonp${z.nextRandomNumber().toString().substring(2,8)}`;while(_(window[t]));return KV(this,e,t)};function KV(e,t,n){let r={};r[t]=n,e.setQueryParameters(r);let o=e.request;o.url=e.url,o.requestFunction=function(){let s=Ro();return window[n]=function(u){s.resolve(u);try{delete window[n]}catch{window[n]=void 0}},Ve._Implementations.loadAndExecuteScript(e.url,n,s),s.promise};let a=fb.request(o);if(!!_(a))return a.catch(function(s){return o.state!==Zo.FAILED?Promise.reject(s):e.retryOnError(s).then(function(u){return u?(o.state=Zo.UNISSUED,o.deferred=void 0,KV(e,t,n)):Promise.reject(s)})})}Ve.fetchJsonp=function(e){return new Ve(e).fetchJsonp(e.callbackParameterName)};Ve.prototype._makeRequest=function(e){let t=this;GR(t.request);let n=t.request;n.url=t.url,n.requestFunction=function(){let o=e.responseType,a=Yi(e.headers,t.headers),s=e.overrideMimeType,u=e.method,l=e.data,c=Ro(),f=Ve._Implementations.loadWithXhr(t.url,o,u,l,a,c,s);return _(f)&&_(f.abort)&&(n.cancelFunction=function(){f.abort()}),c.promise};let r=fb.request(n);if(!!_(r))return r.then(function(o){return n.cancelFunction=void 0,o}).catch(function(o){return n.cancelFunction=void 0,n.state!==Zo.FAILED?Promise.reject(o):t.retryOnError(o).then(function(a){return a?(n.state=Zo.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(o)})})};var voe=/^data:(.*?)(;base64)?,(.*)$/;function hb(e,t){let n=decodeURIComponent(t);return e?atob(n):n}function YV(e,t){let n=hb(e,t),r=new ArrayBuffer(n.length),o=new Uint8Array(r);for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return r}function Coe(e,t){t=T(t,"");let n=e[1],r=!!e[2],o=e[3],a,s;switch(t){case"":case"text":return hb(r,o);case"arraybuffer":return YV(r,o);case"blob":return a=YV(r,o),new Blob([a],{type:n});case"document":return s=new DOMParser,s.parseFromString(hb(r,o),n);case"json":return JSON.parse(hb(r,o));default:}}Ve.prototype.fetch=function(e){return e=Zd(e,{}),e.method="GET",this._makeRequest(e)};Ve.fetch=function(e){return new Ve(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.delete=function(e){return e=Zd(e,{}),e.method="DELETE",this._makeRequest(e)};Ve.delete=function(e){return new Ve(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})};Ve.prototype.head=function(e){return e=Zd(e,{}),e.method="HEAD",this._makeRequest(e)};Ve.head=function(e){return new Ve(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.options=function(e){return e=Zd(e,{}),e.method="OPTIONS",this._makeRequest(e)};Ve.options=function(e){return new Ve(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.post=function(e,t){return Ss.defined("data",e),t=Zd(t,{}),t.method="POST",t.data=e,this._makeRequest(t)};Ve.post=function(e){return new Ve(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.put=function(e,t){return Ss.defined("data",e),t=Zd(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)};Ve.put=function(e){return new Ve(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve.prototype.patch=function(e,t){return Ss.defined("data",e),t=Zd(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)};Ve.patch=function(e){return new Ve(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})};Ve._Implementations={};Ve._Implementations.loadImageElement=function(e,t,n){let r=new Image;r.onload=function(){r.naturalWidth===0&&r.naturalHeight===0&&r.width===0&&r.height===0&&(r.width=300,r.height=150),n.resolve(r)},r.onerror=function(o){n.reject(o)},t&&(zR.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e};Ve._Implementations.createImage=function(e,t,n,r,o,a){let s=e.url;Ve.supportsImageBitmapOptions().then(function(u){if(!(u&&a)){Ve._Implementations.loadImageElement(s,t,n);return}let l="blob",c="GET",f=Ro(),h=Ve._Implementations.loadWithXhr(s,l,c,void 0,void 0,f,void 0,void 0,void 0);return _(h)&&_(h.abort)&&(e.cancelFunction=function(){h.abort()}),f.promise.then(function(d){if(!_(d)){n.reject(new it(`Successfully retrieved ${s} but it contained no content.`));return}return Ve.createImageBitmapFromBlob(d,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o})}).then(function(d){n.resolve(d)})}).catch(function(u){n.reject(u)})};Ve.createImageBitmapFromBlob=function(e,t){return Ss.defined("options",t),Ss.typeOf.bool("options.flipY",t.flipY),Ss.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),Ss.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};function XV(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function xoe(e,t,n,r,o,a,s){let u=require("url").parse(e),l=u.protocol==="https:"?require("https"):require("http"),c=require("zlib"),f={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:n,headers:o};l.request(f).on("response",function(h){if(h.statusCode<200||h.statusCode>=300){a.reject(new Mw(h.statusCode,h,h.headers));return}let d=[];h.on("data",function(p){d.push(p)}),h.on("end",function(){let p=Buffer.concat(d);h.headers["content-encoding"]==="gzip"?c.gunzip(p,function(g,y){g?a.reject(new it("Error decompressing response.")):a.resolve(XV(y,t))}):a.resolve(XV(p,t))})}).on("error",function(h){a.reject(new Mw)}).end()}var woe=typeof XMLHttpRequest>"u";Ve._Implementations.loadWithXhr=function(e,t,n,r,o,a,s){let u=voe.exec(e);if(u!==null){a.resolve(Coe(u,t));return}if(woe){xoe(e,t,n,r,o,a,s);return}let l=new XMLHttpRequest;if(zR.contains(e)&&(l.withCredentials=!0),l.open(n,e,!0),_(s)&&_(l.overrideMimeType)&&l.overrideMimeType(s),_(o))for(let f in o)o.hasOwnProperty(f)&&l.setRequestHeader(f,o[f]);_(t)&&(l.responseType=t);let c=!1;return typeof e=="string"&&(c=e.indexOf("file://")===0||typeof window<"u"&&window.location.origin==="file://"),l.onload=function(){if((l.status<200||l.status>=300)&&!(c&&l.status===0)){a.reject(new Mw(l.status,l.response,l.getAllResponseHeaders()));return}let f=l.response,h=l.responseType;if(n==="HEAD"||n==="OPTIONS"){let p=l.getAllResponseHeaders().trim().split(/[\r\n]+/),g={};p.forEach(function(y){let v=y.split(": "),w=v.shift();g[w]=v.join(": ")}),a.resolve(g);return}if(l.status===204)a.resolve();else if(_(f)&&(!_(t)||h===t))a.resolve(f);else if(t==="json"&&typeof f=="string")try{a.resolve(JSON.parse(f))}catch(d){a.reject(d)}else(h===""||h==="document")&&_(l.responseXML)&&l.responseXML.hasChildNodes()?a.resolve(l.responseXML):(h===""||h==="text")&&_(l.responseText)?a.resolve(l.responseText):a.reject(new it("Invalid XMLHttpRequest response type."))},l.onerror=function(f){a.reject(new Mw)},l.send(r),l};Ve._Implementations.loadAndExecuteScript=function(e,t,n){return LV(e,t).catch(function(r){n.reject(r)})};Ve._DefaultImplementations={};Ve._DefaultImplementations.createImage=Ve._Implementations.createImage;Ve._DefaultImplementations.loadWithXhr=Ve._Implementations.loadWithXhr;Ve._DefaultImplementations.loadAndExecuteScript=Ve._Implementations.loadAndExecuteScript;Ve.DEFAULT=Object.freeze(new Ve({url:typeof document>"u"?"":document.location.href.split("?")[0]}));var _t=Ve;var ZV=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;function Eoe(){let e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){let r=e[t].getAttribute("src"),o=ZV.exec(r);if(o!==null)return o[1]}}var Xv;function QV(e){return typeof document>"u"?e:(_(Xv)||(Xv=document.createElement("a")),Xv.href=e,Xv.href=Xv.href,Xv.href)}var P_;function JV(){if(_(P_))return P_;let e;return typeof CESIUM_BASE_URL<"u"?e=CESIUM_BASE_URL:typeof define=="object"&&_(define.amd)&&!define.amd.toUrlUndefined&&_(require.toUrl)?e=A_("..",M_("Core/buildModuleUrl.js")):e=Eoe(),P_=new _t({url:QV(e)}),P_.appendForwardSlash(),P_}function Toe(e){return QV(require.toUrl(`../${e}`))}function $V(e){return JV().getDerivedResource({url:e}).url}var db;function M_(e){return _(db)||(typeof define=="object"&&_(define.amd)&&!define.amd.toUrlUndefined&&_(require.toUrl)?db=Toe:db=$V),db(e)}M_._cesiumScriptRegex=ZV;M_._buildModuleUrlFromBaseUrl=$V;M_._clearBaseResource=function(){P_=void 0};M_.setBaseUrl=function(e){P_=_t.DEFAULT.getDerivedResource({url:e})};M_.getCesiumBaseUrl=JV;var Pa=M_;function bf(e){this.airport=new Cesium.AssociativeArray,this.airspace=[],this.bigAirSpace=[],this.viewer=e.viewer}bf.prototype.addAirSpace=function(e){let t=this,n=e.name,r=Cesium.defaultValue(new Cesium.Color(e.r,e.g,e.b),new Cesium.Color(1,1,1)),o=e.coor,a=e.id,s=t.viewer.entities.add({id:a,corridor:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(o),outline:!0,width:1,outlineColor:r,material:r,extrudedHeight:300,extrudedHeightReference:Cesium.HeightReference.RELATIVE_TO_GROUND}}),u=[],l=new Cesium.BoundingRectangle;for(let f=0;f<o.length;f=f+3){let h=new Cesium.Cartesian2(o[f],o[f+1]);u.push(h)}Cesium.BoundingRectangle.fromPoints(u,l);let c=new Cesium.Cartesian2(l.x+l.width/2,l.y+l.height/2);s.center=c,t.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(c.x,c.y),label:new Cesium.LabelGraphics({text:n,translucencyByDistance:new Cesium.NearFarScalar(1500,1,9e6,0),scaleByDistance:new Cesium.NearFarScalar(1500,3,9e5,0),disableDepthTestDistance:Number.POSITIVE_INFINITY}),id:a+"_001"}),s.labelID=a+"_001",t.airspace.push(s)};bf.prototype.removeAirSpaceById=function(e){let t=this,n=t.viewer.entities.getById(e);if(n!=null){let r=t.viewer.entities.getById(n.labelID);n.show=!1,r.show=!1,t.viewer.entities.remove(n),t.viewer.entities.remove(r),t.airspace=t.airspace.filter(function(o){return o.id!=e})}};bf.prototype.removeAirSpaceByName=function(e){};bf.prototype.removeAll=function(){let e=this;e.airspace.forEach(function(t){let n=e.viewer.entities.getById(t.labelID);e.viewer.entities.remove(n),e.viewer.entities.remove(t)})};bf.prototype.updateAirSpace=function(e){let t=this,n=t.viewer.entities.getById(e.id);if(n!=null){if(e.type=="label"){let r=t.viewer.entities.getById(n.labelID);r.label.text=e.name}}else if(e.type=="position")n.corridor.positions=e.position;else if(e==null||e.type==null)return"\u4F20\u5165\u53C2\u6570\u4E0D\u6B63\u786E"};bf.prototype.getAirSpaceById=function(e){return this.viewer.entities.getById(e)};bf.prototype.addBigAirSpace=function(e){let t=this,n=new Cesium.Color(e.color.r,e.color.g,e.color.b);for(let r=0;r<e.coor.length-4;r=r+2)e.coor[r]==e.coor[r+2]&&e.coor[r+1]==e.coor[r+3]&&(r+=2),t.viewer.entities.add({corridor:{positions:Cesium.Cartesian3.fromDegreesArray([e.coor[r],e.coor[r+1],e.coor[r+2],e.coor[r+3]]),outline:!0,width:1,outlineColor:n,material:n,extrudedHeight:10,extrudedHeightReference:Cesium.HeightReference.RELATIVE_TO_GROUND},name:e.name,id:"wall"+r});t.bigAirSpace.push({name:e.name,count:e.coor.length/3})};bf.prototype.removeBigAirSpaceByName=function(e){for(let t=0;t<this.viewer.entities._values.length;t++){let n=this.viewer.entities._values[t];n.name==e&&(this.viewer.entities.remove(n),t--)}this.bigAirSpace=[]};bf.prototype.addAirport=function(e){let t=parseFloat(e.lon),n=parseFloat(e.lat),r=parseFloat(e.alt),o=e.name,a=e.angle,s=Cesium.defaultValue(e.icon,"Assets/EMExtensions/PolitTraningApp/images/Airport.png"),u=e.id;this.airport.set(u,e);let l=this,c=l.viewer.scene,f=.1;if(Cesium.defined(l.primitive))return;let h=new Cesium.GeometryInstance({geometry:new Cesium.EllipseGeometry({center:Cesium.Cartesian3.fromDegrees(t,n),semiMinorAxis:f,semiMajorAxis:f,height:r,stRotation:Cesium.Math.toRadians(a),vertexFormat:Cesium.VertexFormat.POSITION_AND_ST})}),d=new Cesium.Primitive({geometryInstances:h,appearance:new Cesium.MaterialAppearance({material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:Pa("Assets/EMExtensions/PolitTraningApp/images/Airport.png")}}}),flat:!0})});d.id=u,c.primitives.add(d),l.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t,n,r),label:{text:o,pixelOffset:new Cesium.Cartesian2(32,-5),fillColor:Cesium.Color.ORANGE,scale:.75},id:u+"001"});let p=l.airport.get(u);p.labelID=u+"001";let g=Cesium.Cartesian3.fromDegrees(t,n,r),y=Cesium.Matrix4.clone(d.modelMatrix);function v(A){let D=Cesium.Matrix4.fromArray(y),P=Cesium.Matrix4.getMatrix3(D,new Cesium.Matrix3),M=Cesium.Matrix3.inverse(P,new Cesium.Matrix3),I=Cesium.Matrix4.getTranslation(D,new Cesium.Cartesian3),O=Cesium.Transforms.eastNorthUpToFixedFrame(g),m=Cesium.Matrix4.getMatrix3(O,new Cesium.Matrix3),b=Cesium.Matrix4.getTranslation(O,new Cesium.Cartesian3),L=Cesium.Cartesian3.subtract(I,b,new Cesium.Cartesian3);L=Cesium.Matrix4.fromTranslation(L,new Cesium.Matrix4);let R=Cesium.Matrix3.multiply(M,m,new Cesium.Matrix3);R=Cesium.Matrix3.inverse(R,new Cesium.Matrix3),R=Cesium.Matrix4.fromRotationTranslation(R);let N=Cesium.Matrix4.fromRotationTranslation(A);Cesium.Matrix4.multiply(O,N,O),Cesium.Matrix4.multiply(O,R,O),Cesium.Matrix4.multiply(O,L,O),d.modelMatrix=O}let w=new Cesium.BoundingSphere;function C(A,D){return w.center=g,w.radius=D,A.camera.getPixelSize(w,A.context.drawingBufferWidth,A.context.drawingBufferHeight)}let E=1,S=l.viewer.scene.preRender.addEventListener(function(){let A=c._frameState,D=A.context,P=Math.max(D.drawingBufferWidth,D.drawingBufferHeight),M=C(A,f),I=1/M;Math.min(I*(2*f),P)<32&&(E=32*M/(2*f));let m=Cesium.Matrix3.fromScale(new Cesium.Cartesian3(E,E,E));v(m)})};bf.prototype.removeAirport=function(e){let t=this;for(let r=0;r<t.viewer.scene.primitives.length;++r){let o=t.viewer.scene.primitives.get(r);if(o.id!=null&&o.id===e){t.viewer.scene.primitives.remove(o);break}}let n=t.viewer.entities.getById(e+"001");t.viewer.entities.remove(n),t.airport.set(e,"")};bf.prototype.getAirPort=function(e){let t=this,n=t.viewer.scene.primitives.length;for(let r=0;r<n;++r){let o=t.viewer.scene.primitives.get(r);if(o.id===e)return o}};var ek=bf;function Nw(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.startYaw=Cesium.defaultValue(e.startYaw,0),this.endYaw=Cesium.defaultValue(e.endYaw,360),this.innerRadius=Cesium.defaultValue(e.innerRadius,5300),this._innerRadius=void 0,this.outerRadius=Cesium.defaultValue(e.outerRadius,15200),this._outerRadius=void 0,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._attributeLocations=void 0,this._allCommands=[],this.instance=Cesium.defaultValue(e.instance,void 0),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({depthTest:!0})}),this._scene.primitives.add(this)}Nw.prototype.update=function(e){this._allCommands.length=0;var t=e.context,n=this;this.outerRadius instanceof Cesium.CallbackProperty?this._outerRadius=this.outerRadius.getValue(e.time):this._outerRadius=this.outerRadius,this.innerRadius instanceof Cesium.CallbackProperty?this._innerRadius=this.innerRadius.getValue(e.time):this._innerRadius=this.innerRadius,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix);var r=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,r,this._modelMatrix),this._fillCommand.uniformMap={v_colour:function(){return n.fillColor}};var o=this.createFillMesh();this._fillVA=tk(this,t,o),this._outlineCommand.uniformMap={v_colour:function(){return n.lineColor}};var a=this.createOutlineMesh();this._outlineVA=tk(this,t,a),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:nk(),fragmentShaderSource:rk()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:nk(),fragmentShaderSource:rk()})),this._fillCommand.vertexArray=this._fillVA,this._outlineCommand.vertexArray=this._outlineVA,this.renderStyle!=2&&this._allCommands.push(this._fillCommand),this.renderStyle!=1&&this._allCommands.push(this._outlineCommand);var s=e.commandList,u=e.passes,l=this._allCommands;if(this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,u.render&&this._show)for(var c=0,f=l.length;c<f;c++){var h=l[c];s.push(h)}};Nw.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._scene.primitives._guid])}};function tk(e,t,n){var r=Soe(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Soe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}Nw.prototype.createFillMesh=function(){for(var e=10,t=(this.endYaw-this.startYaw)/e,n=(this.endYaw-this.startYaw)/e,r=new Float64Array((n+1)*(t+1)*3),o=(n+1)*(t+1)*6,a=this._outerRadius,s=this._innerRadius,u=0,l=0,c=Cesium.IndexDatatype.createTypedArray((n+1)*(t+1),o),f=0;f<=n;f+=1)for(var h=f*10,d=[],p=ik(h,d,s,a),g=0;g<p.positions.length;g++)r[u++]=p.positions[g].x,r[u++]=p.positions[g].y,r[u++]=p.positions[g].z;for(var y=0;y<n;y++)for(var v=0;v<t;v++)c[l++]=y*37+v,c[l++]=y*37+v+37,c[l++]=y*37+v+1,c[l++]=y*37+v+1,c[l++]=y*37+v+37,c[l++]=y*37+v+38;return{position:r,indices:c}};Nw.prototype.createOutlineMesh=function(){for(var e=10,t=(this.endYaw-this.startYaw)/e,n=(this.endYaw-this.startYaw)/e,r=new Float64Array((n+1)*(t+1)*3),o=(n+1)*(t+1)*6,a=this._outerRadius,s=this._innerRadius,u=0,l=0,c=Cesium.IndexDatatype.createTypedArray((n+1)*(t+1),o),f=0;f<=n;f+=1)for(var h=f*10,d=[],p=ik(h,d,s,a),g=0;g<p.positions.length;g++)r[u++]=p.positions[g].x,r[u++]=p.positions[g].y,r[u++]=p.positions[g].z;for(var y=0;y<n+1;y++)for(var v=0;v<t;v++)c[l++]=y*37+v,c[l++]=y*37+v+1,y<(n+1)*(t+1)/(n+1)-1&&(c[l++]=y*(n+1)+v,c[l++]=y*(n+1)+v+37);return{position:r,indices:c}};function ik(e,t,n,r){for(var o=new Cesium.Cartesian3(-r,0,0),a=[],s=0;s<=360;s+=10){var u=new Cesium.Cartesian3,l=Cesium.Math.toRadians(s);u.x=n*Math.cos(l)+o.x,u.y=n*Math.sin(l)+o.y,u.z=o.z,a.push(u)}var c=new Cesium.Quaternion;c=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,-Cesium.Math.toRadians(e),new Cesium.Quaternion);for(var f=Cesium.Matrix3.fromQuaternion(c,new Cesium.Matrix3),h=0;h<a.length;h++){var d=Cesium.Matrix3.multiplyByVector(f,a[h],new Cesium.Cartesian3);t.push(d)}return{positions:t}}function nk(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function rk(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var pb=Nw;function qe(e,t){this.x=T(e,0),this.y=T(t,0)}qe.fromElements=function(e,t,n){return _(n)?(n.x=e,n.y=t,n):new qe(e,t)};qe.clone=function(e,t){if(!!_(e))return _(t)?(t.x=e.x,t.y=e.y,t):new qe(e.x,e.y)};qe.fromCartesian3=qe.clone;qe.fromCartesian4=qe.clone;qe.packedLength=2;qe.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n]=e.y,t};qe.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new qe),n.x=e[t++],n.y=e[t],n};qe.packArray=function(e,t){let n=e.length,r=n*2;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)qe.pack(e[o],t,o*2);return t};qe.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/2:t=new Array(n/2);for(let r=0;r<n;r+=2){let o=r/2;t[o]=qe.unpack(e,r,t[o])}return t};qe.fromArray=qe.unpack;qe.maximumComponent=function(e){return Math.max(e.x,e.y)};qe.minimumComponent=function(e){return Math.min(e.x,e.y)};qe.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n};qe.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n};qe.clamp=function(e,t,n,r){let o=z.clamp(e.x,t.x,n.x),a=z.clamp(e.y,t.y,n.y);return r.x=o,r.y=a,r};qe.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y};qe.magnitude=function(e){return Math.sqrt(qe.magnitudeSquared(e))};var mb=new qe;qe.distance=function(e,t){return qe.subtract(e,t,mb),qe.magnitude(mb)};qe.distanceSquared=function(e,t){return qe.subtract(e,t,mb),qe.magnitudeSquared(mb)};qe.normalize=function(e,t){let n=qe.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t};qe.dot=function(e,t){return e.x*t.x+e.y*t.y};qe.cross=function(e,t){return e.x*t.y-e.y*t.x};qe.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n};qe.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n};qe.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n};qe.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n};qe.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n};qe.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n};qe.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t};qe.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var ok=new qe;qe.lerp=function(e,t,n,r){return qe.multiplyByScalar(t,n,ok),r=qe.multiplyByScalar(e,1-n,r),qe.add(ok,r,r)};var ak=new qe,sk=new qe;qe.angleBetween=function(e,t){return qe.normalize(e,ak),qe.normalize(t,sk),z.acosClamped(qe.dot(ak,sk))};var Aoe=new qe;qe.mostOrthogonalAxis=function(e,t){let n=qe.normalize(e,Aoe);return qe.abs(n,n),n.x<=n.y?t=qe.clone(qe.UNIT_X,t):t=qe.clone(qe.UNIT_Y,t),t};qe.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y};qe.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]};qe.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&z.equalsEpsilon(e.x,t.x,n,r)&&z.equalsEpsilon(e.y,t.y,n,r)};qe.ZERO=Object.freeze(new qe(0,0));qe.ONE=Object.freeze(new qe(1,1));qe.UNIT_X=Object.freeze(new qe(1,0));qe.UNIT_Y=Object.freeze(new qe(0,1));qe.prototype.clone=function(e){return qe.clone(this,e)};qe.prototype.equals=function(e){return qe.equals(this,e)};qe.prototype.equalsEpsilon=function(e,t,n){return qe.equalsEpsilon(this,e,t,n)};qe.prototype.toString=function(){return`(${this.x}, ${this.y})`};var X=qe;function Te(e,t,n){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0)}Te.fromSpherical=function(e,t){_(t)||(t=new Te);let n=e.clock,r=e.cone,o=T(e.magnitude,1),a=o*Math.sin(r);return t.x=a*Math.cos(n),t.y=a*Math.sin(n),t.z=o*Math.cos(r),t};Te.fromElements=function(e,t,n,r){return _(r)?(r.x=e,r.y=t,r.z=n,r):new Te(e,t,n)};Te.clone=function(e,t){if(!!_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new Te(e.x,e.y,e.z)};Te.fromCartesian4=Te.clone;Te.packedLength=3;Te.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t};Te.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Te),n.x=e[t++],n.y=e[t++],n.z=e[t],n};Te.packArray=function(e,t){let n=e.length,r=n*3;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Te.pack(e[o],t,o*3);return t};Te.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/3:t=new Array(n/3);for(let r=0;r<n;r+=3){let o=r/3;t[o]=Te.unpack(e,r,t[o])}return t};Te.fromArray=Te.unpack;Te.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)};Te.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)};Te.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n};Te.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n};Te.clamp=function(e,t,n,r){let o=z.clamp(e.x,t.x,n.x),a=z.clamp(e.y,t.y,n.y),s=z.clamp(e.z,t.z,n.z);return r.x=o,r.y=a,r.z=s,r};Te.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z};Te.magnitude=function(e){return Math.sqrt(Te.magnitudeSquared(e))};var _b=new Te;Te.distance=function(e,t){return Te.subtract(e,t,_b),Te.magnitude(_b)};Te.distanceSquared=function(e,t){return Te.subtract(e,t,_b),Te.magnitudeSquared(_b)};Te.normalize=function(e,t){let n=Te.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t};Te.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z};Te.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n};Te.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n};Te.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n};Te.subtract=function(e,t,n){return _(n)||(n=new Te),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n};Te.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n};Te.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n};Te.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t};Te.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var uk=new Te;Te.lerp=function(e,t,n,r){return Te.multiplyByScalar(t,n,uk),r=Te.multiplyByScalar(e,1-n,r),Te.add(uk,r,r)};var gb=new Te,UR=new Te;Te.angleBetween=function(e,t){Te.normalize(e,gb),Te.normalize(t,UR);let n=Te.dot(gb,UR),r=Te.magnitude(Te.cross(gb,UR,gb));return Math.atan2(r,n)};var boe=new Te;Te.mostOrthogonalAxis=function(e,t){let n=Te.normalize(e,boe);return Te.abs(n,n),n.x<=n.y?n.x<=n.z?t=Te.clone(Te.UNIT_X,t):t=Te.clone(Te.UNIT_Z,t):n.y<=n.z?t=Te.clone(Te.UNIT_Y,t):t=Te.clone(Te.UNIT_Z,t),t};Te.projectVector=function(e,t,n){let r=Te.dot(e,t)/Te.dot(t,t);return Te.multiplyByScalar(t,r,n)};Te.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z};Te.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]};Te.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&z.equalsEpsilon(e.x,t.x,n,r)&&z.equalsEpsilon(e.y,t.y,n,r)&&z.equalsEpsilon(e.z,t.z,n,r)};Te.cross=function(e,t,n){let r=e.x,o=e.y,a=e.z,s=t.x,u=t.y,l=t.z,c=o*l-a*u,f=a*s-r*l,h=r*u-o*s;return n.x=c,n.y=f,n.z=h,n};Te.midpoint=function(e,t,n){return n.x=(e.x+t.x)*.5,n.y=(e.y+t.y)*.5,n.z=(e.z+t.z)*.5,n};Te.fromDegrees=function(e,t,n,r,o){return e=z.toRadians(e),t=z.toRadians(t),Te.fromRadians(e,t,n,r,o)};var If=new Te,jv=new Te;Te.wgs84RadiiSquared=new Te(6378137*6378137,6378137*6378137,6356752314245179e-9*6356752314245179e-9);Te.fromRadians=function(e,t,n,r,o){n=T(n,0);let a=_(r)?r.radiiSquared:this.wgs84RadiiSquared,s=Math.cos(t);If.x=s*Math.cos(e),If.y=s*Math.sin(e),If.z=Math.sin(t),If=Te.normalize(If,If),Te.multiplyComponents(a,If,jv);let u=Math.sqrt(Te.dot(If,jv));return jv=Te.divideByScalar(jv,u,jv),If=Te.multiplyByScalar(If,n,If),_(o)||(o=new Te),Te.add(jv,If,o)};Te.fromDegreesArray=function(e,t,n){let r=e.length;_(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){let a=e[o],s=e[o+1],u=o/2;n[u]=Te.fromDegrees(a,s,0,t,n[u])}return n};Te.fromRadiansArray=function(e,t,n){let r=e.length;_(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){let a=e[o],s=e[o+1],u=o/2;n[u]=Te.fromRadians(a,s,0,t,n[u])}return n};Te.fromDegreesArrayHeights=function(e,t,n){let r=e.length;_(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){let a=e[o],s=e[o+1],u=e[o+2],l=o/3;n[l]=Te.fromDegrees(a,s,u,t,n[l])}return n};Te.fromRadiansArrayHeights=function(e,t,n){let r=e.length;_(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){let a=e[o],s=e[o+1],u=e[o+2],l=o/3;n[l]=Te.fromRadians(a,s,u,t,n[l])}return n};Te.ZERO=Object.freeze(new Te(0,0,0));Te.ONE=Object.freeze(new Te(1,1,1));Te.UNIT_X=Object.freeze(new Te(1,0,0));Te.UNIT_Y=Object.freeze(new Te(0,1,0));Te.UNIT_Z=Object.freeze(new Te(0,0,1));Te.prototype.clone=function(e){return Te.clone(this,e)};Te.prototype.equals=function(e){return Te.equals(this,e)};Te.prototype.equalsEpsilon=function(e,t,n){return Te.equalsEpsilon(this,e,t,n)};Te.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var x=Te;var Ioe=new x,Doe=new x;function Poe(e,t,n,r,o){let a=e.x,s=e.y,u=e.z,l=t.x,c=t.y,f=t.z,h=a*a*l*l,d=s*s*c*c,p=u*u*f*f,g=h+d+p,y=Math.sqrt(1/g),v=x.multiplyByScalar(e,y,Ioe);if(g<r)return isFinite(y)?x.clone(v,o):void 0;let w=n.x,C=n.y,E=n.z,S=Doe;S.x=v.x*w*2,S.y=v.y*C*2,S.z=v.z*E*2;let A=(1-y)*x.magnitude(e)/(.5*x.magnitude(S)),D=0,P,M,I,O,m,b,L,R,N,B,G;do{A-=D,I=1/(1+A*w),O=1/(1+A*C),m=1/(1+A*E),b=I*I,L=O*O,R=m*m,N=b*I,B=L*O,G=R*m,P=h*b+d*L+p*R-1,M=h*N*w+d*B*C+p*G*E;let F=-2*M;D=P/F}while(Math.abs(P)>z.EPSILON12);return _(o)?(o.x=a*I,o.y=s*O,o.z=u*m,o):new x(a*I,s*O,u*m)}var yb=Poe;function ha(e,t,n){this.longitude=T(e,0),this.latitude=T(t,0),this.height=T(n,0)}ha.fromRadians=function(e,t,n,r){return n=T(n,0),_(r)?(r.longitude=e,r.latitude=t,r.height=n,r):new ha(e,t,n)};ha.fromDegrees=function(e,t,n,r){return e=z.toRadians(e),t=z.toRadians(t),ha.fromRadians(e,t,n,r)};var Moe=new x,Loe=new x,Roe=new x;ha.wgs84OneOverRadii=new x(1/6378137,1/6378137,1/6356752314245179e-9);ha.wgs84OneOverRadiiSquared=new x(1/(6378137*6378137),1/(6378137*6378137),1/(6356752314245179e-9*6356752314245179e-9));var Ooe=z.EPSILON1;ha.fromCartesian=function(e,t,n){let r=_(t)?t.oneOverRadii:this.wgs84OneOverRadii,o=_(t)?t.oneOverRadiiSquared:this.wgs84OneOverRadiiSquared,a=_(t)?t._centerToleranceSquared:Ooe,s=yb(e,r,o,a,Loe);if(!_(s))return;let u=x.multiplyComponents(s,o,Moe);u=x.normalize(u,u);let l=x.subtract(e,s,Roe),c=Math.atan2(u.y,u.x),f=Math.asin(u.z),h=z.sign(x.dot(l,e))*x.magnitude(l);return _(n)?(n.longitude=c,n.latitude=f,n.height=h,n):new ha(c,f,h)};ha.toCartesian=function(e,t,n){return x.fromRadians(e.longitude,e.latitude,e.height,t,n)};ha.clone=function(e,t){if(!!_(e))return _(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new ha(e.longitude,e.latitude,e.height)};ha.equals=function(e,t){return e===t||_(e)&&_(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height};ha.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n};ha.ZERO=Object.freeze(new ha(0,0,0));ha.prototype.clone=function(e){return ha.clone(this,e)};ha.prototype.equals=function(e){return ha.equals(this,e)};ha.prototype.equalsEpsilon=function(e,t){return ha.equalsEpsilon(this,e,t)};ha.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var ce=ha;function ck(e,t,n,r){t=T(t,0),n=T(n,0),r=T(r,0),e._radii=new x(t,n,r),e._radiiSquared=new x(t*t,n*n,r*r),e._radiiToTheFourth=new x(t*t*t*t,n*n*n*n,r*r*r*r),e._oneOverRadii=new x(t===0?0:1/t,n===0?0:1/n,r===0?0:1/r),e._oneOverRadiiSquared=new x(t===0?0:1/(t*t),n===0?0:1/(n*n),r===0?0:1/(r*r)),e._minimumRadius=Math.min(t,n,r),e._maximumRadius=Math.max(t,n,r),e._centerToleranceSquared=z.EPSILON1,e._radiiSquared.z!==0&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function mi(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,ck(this,e,t,n)}Object.defineProperties(mi.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});mi.clone=function(e,t){if(!_(e))return;let n=e._radii;return _(t)?(x.clone(n,t._radii),x.clone(e._radiiSquared,t._radiiSquared),x.clone(e._radiiToTheFourth,t._radiiToTheFourth),x.clone(e._oneOverRadii,t._oneOverRadii),x.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new mi(n.x,n.y,n.z)};mi.fromCartesian3=function(e,t){return _(t)||(t=new mi),_(e)&&ck(t,e.x,e.y,e.z),t};mi.WGS84=Object.freeze(new mi(6378137,6378137,6356752314245179e-9));mi.UNIT_SPHERE=Object.freeze(new mi(1,1,1));mi.MOON=Object.freeze(new mi(z.LUNAR_RADIUS,z.LUNAR_RADIUS,z.LUNAR_RADIUS));mi.prototype.clone=function(e){return mi.clone(this,e)};mi.packedLength=x.packedLength;mi.pack=function(e,t,n){return n=T(n,0),x.pack(e._radii,t,n),t};mi.unpack=function(e,t,n){t=T(t,0);let r=x.unpack(e,t);return mi.fromCartesian3(r,n)};mi.prototype.geocentricSurfaceNormal=x.normalize;mi.prototype.geodeticSurfaceNormalCartographic=function(e,t){let n=e.longitude,r=e.latitude,o=Math.cos(r),a=o*Math.cos(n),s=o*Math.sin(n),u=Math.sin(r);return _(t)||(t=new x),t.x=a,t.y=s,t.z=u,x.normalize(t,t)};mi.prototype.geodeticSurfaceNormal=function(e,t){if(!x.equalsEpsilon(e,x.ZERO,z.EPSILON14))return _(t)||(t=new x),t=x.multiplyComponents(e,this._oneOverRadiiSquared,t),x.normalize(t,t)};var Noe=new x,Boe=new x;mi.prototype.cartographicToCartesian=function(e,t){let n=Noe,r=Boe;this.geodeticSurfaceNormalCartographic(e,n),x.multiplyComponents(this._radiiSquared,n,r);let o=Math.sqrt(x.dot(n,r));return x.divideByScalar(r,o,r),x.multiplyByScalar(n,e.height,n),_(t)||(t=new x),x.add(r,n,t)};mi.prototype.cartographicArrayToCartesianArray=function(e,t){let n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};var Foe=new x,zoe=new x,Voe=new x;mi.prototype.cartesianToCartographic=function(e,t){let n=this.scaleToGeodeticSurface(e,zoe);if(!_(n))return;let r=this.geodeticSurfaceNormal(n,Foe),o=x.subtract(e,n,Voe),a=Math.atan2(r.y,r.x),s=Math.asin(r.z),u=z.sign(x.dot(o,e))*x.magnitude(o);return _(t)?(t.longitude=a,t.latitude=s,t.height=u,t):new ce(a,s,u)};mi.prototype.cartesianArrayToCartographicArray=function(e,t){let n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t};mi.prototype.scaleToGeodeticSurface=function(e,t){return yb(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)};mi.prototype.scaleToGeocentricSurface=function(e,t){_(t)||(t=new x);let n=e.x,r=e.y,o=e.z,a=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*a.x+r*r*a.y+o*o*a.z);return x.multiplyByScalar(e,s,t)};mi.prototype.transformPositionToScaledSpace=function(e,t){return _(t)||(t=new x),x.multiplyComponents(e,this._oneOverRadii,t)};mi.prototype.transformPositionFromScaledSpace=function(e,t){return _(t)||(t=new x),x.multiplyComponents(e,this._radii,t)};mi.prototype.equals=function(e){return this===e||_(e)&&x.equals(this._radii,e._radii)};mi.prototype.toString=function(){return this._radii.toString()};mi.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){t=T(t,0);let r=this._squaredXOverSquaredZ;if(_(n)||(n=new x),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-t))return n};var koe=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],Goe=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function lk(e,t,n){let r=.5*(t+e),o=.5*(t-e),a=0;for(let s=0;s<5;s++){let u=o*koe[s];a+=Goe[s]*(n(r+u)+n(r-u))}return a*=o,a}mi.prototype.surfaceArea=function(e){let t=e.west,n=e.east,r=e.south,o=e.north;for(;n<t;)n+=z.TWO_PI;let a=this._radiiSquared,s=a.x,u=a.y,l=a.z,c=s*u;return lk(r,o,function(f){let h=Math.cos(f),d=Math.sin(f);return Math.cos(f)*lk(t,n,function(p){let g=Math.cos(p),y=Math.sin(p);return Math.sqrt(c*d*d+l*(u*g*g+s*y*y)*h*h)})})};var Ge=mi;function vb(e){this._ellipsoid=T(e,Ge.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(vb.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});vb.prototype.project=function(e,t){let n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,a=e.height;return _(t)?(t.x=r,t.y=o,t.z=a,t):new x(r,o,a)};vb.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,r=e.x*n,o=e.y*n,a=e.z;return _(t)?(t.longitude=r,t.latitude=o,t.height=a,t):new ce(r,o,a)};var uc=vb;var Uoe={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},gi=Object.freeze(Uoe);function $t(e,t,n,r){this.west=T(e,0),this.south=T(t,0),this.east=T(n,0),this.north=T(r,0)}Object.defineProperties($t.prototype,{width:{get:function(){return $t.computeWidth(this)}},height:{get:function(){return $t.computeHeight(this)}}});$t.packedLength=4;$t.pack=function(e,t,n){return n=T(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t};$t.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new $t),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n};$t.computeWidth=function(e){let t=e.east,n=e.west;return t<n&&(t+=z.TWO_PI),t-n};$t.computeHeight=function(e){return e.north-e.south};$t.fromDegrees=function(e,t,n,r,o){return e=z.toRadians(T(e,0)),t=z.toRadians(T(t,0)),n=z.toRadians(T(n,0)),r=z.toRadians(T(r,0)),_(o)?(o.west=e,o.south=t,o.east=n,o.north=r,o):new $t(e,t,n,r)};$t.fromRadians=function(e,t,n,r,o){return _(o)?(o.west=T(e,0),o.south=T(t,0),o.east=T(n,0),o.north=T(r,0),o):new $t(e,t,n,r)};$t.fromCartographicArray=function(e,t){let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let l=0,c=e.length;l<c;l++){let f=e[l];n=Math.min(n,f.longitude),r=Math.max(r,f.longitude),s=Math.min(s,f.latitude),u=Math.max(u,f.latitude);let h=f.longitude>=0?f.longitude:f.longitude+z.TWO_PI;o=Math.min(o,h),a=Math.max(a,h)}return r-n>a-o&&(n=o,r=a,r>z.PI&&(r=r-z.TWO_PI),n>z.PI&&(n=n-z.TWO_PI)),_(t)?(t.west=n,t.south=s,t.east=r,t.north=u,t):new $t(n,s,r,u)};$t.fromCartesianArray=function(e,t,n){t=T(t,Ge.WGS84);let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,s=-Number.MAX_VALUE,u=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(let c=0,f=e.length;c<f;c++){let h=t.cartesianToCartographic(e[c]);r=Math.min(r,h.longitude),o=Math.max(o,h.longitude),u=Math.min(u,h.latitude),l=Math.max(l,h.latitude);let d=h.longitude>=0?h.longitude:h.longitude+z.TWO_PI;a=Math.min(a,d),s=Math.max(s,d)}return o-r>s-a&&(r=a,o=s,o>z.PI&&(o=o-z.TWO_PI),r>z.PI&&(r=r-z.TWO_PI)),_(n)?(n.west=r,n.south=u,n.east=o,n.north=l,n):new $t(r,u,o,l)};$t.clone=function(e,t){if(!!_(e))return _(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new $t(e.west,e.south,e.east,e.north)};$t.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n};$t.prototype.clone=function(e){return $t.clone(this,e)};$t.prototype.equals=function(e){return $t.equals(this,e)};$t.equals=function(e,t){return e===t||_(e)&&_(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north};$t.prototype.equalsEpsilon=function(e,t){return $t.equalsEpsilon(this,e,t)};$t.validate=function(e){};$t.southwest=function(e,t){return _(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new ce(e.west,e.south)};$t.northwest=function(e,t){return _(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new ce(e.west,e.north)};$t.northeast=function(e,t){return _(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new ce(e.east,e.north)};$t.southeast=function(e,t){return _(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new ce(e.east,e.south)};$t.center=function(e,t){let n=e.east,r=e.west;n<r&&(n+=z.TWO_PI);let o=z.negativePiToPi((r+n)*.5),a=(e.south+e.north)*.5;return _(t)?(t.longitude=o,t.latitude=a,t.height=0,t):new ce(o,a)};$t.intersection=function(e,t,n){let r=e.east,o=e.west,a=t.east,s=t.west;r<o&&a>0?r+=z.TWO_PI:a<s&&r>0&&(a+=z.TWO_PI),r<o&&s<0?s+=z.TWO_PI:a<s&&o<0&&(o+=z.TWO_PI);let u=z.negativePiToPi(Math.max(o,s)),l=z.negativePiToPi(Math.min(r,a));if((e.west<e.east||t.west<t.east)&&l<=u)return;let c=Math.max(e.south,t.south),f=Math.min(e.north,t.north);if(!(c>=f))return _(n)?(n.west=u,n.south=c,n.east=l,n.north=f,n):new $t(u,c,l,f)};$t.simpleIntersection=function(e,t,n){let r=Math.max(e.west,t.west),o=Math.max(e.south,t.south),a=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||r>=a))return _(n)?(n.west=r,n.south=o,n.east=a,n.north=s,n):new $t(r,o,a,s)};$t.union=function(e,t,n){_(n)||(n=new $t);let r=e.east,o=e.west,a=t.east,s=t.west;r<o&&a>0?r+=z.TWO_PI:a<s&&r>0&&(a+=z.TWO_PI),r<o&&s<0?s+=z.TWO_PI:a<s&&o<0&&(o+=z.TWO_PI);let u=z.negativePiToPi(Math.min(o,s)),l=z.negativePiToPi(Math.max(r,a));return n.west=u,n.south=Math.min(e.south,t.south),n.east=l,n.north=Math.max(e.north,t.north),n};$t.expand=function(e,t,n){return _(n)||(n=new $t),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n};$t.contains=function(e,t){let n=t.longitude,r=t.latitude,o=e.west,a=e.east;return a<o&&(a+=z.TWO_PI,n<0&&(n+=z.TWO_PI)),(n>o||z.equalsEpsilon(n,o,z.EPSILON14))&&(n<a||z.equalsEpsilon(n,a,z.EPSILON14))&&r>=e.south&&r<=e.north};var Hoe=new ce;$t.subsample=function(e,t,n,r){t=T(t,Ge.WGS84),n=T(n,0),_(r)||(r=[]);let o=0,a=e.north,s=e.south,u=e.east,l=e.west,c=Hoe;c.height=n,c.longitude=l,c.latitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=l,r[o]=t.cartographicToCartesian(c,r[o]),o++,a<0?c.latitude=a:s>0?c.latitude=s:c.latitude=0;for(let f=1;f<8;++f)c.longitude=-Math.PI+f*z.PI_OVER_TWO,$t.contains(e,c)&&(r[o]=t.cartographicToCartesian(c,r[o]),o++);return c.latitude===0&&(c.longitude=l,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++),r.length=o,r};$t.subsection=function(e,t,n,r,o,a){if(_(a)||(a=new $t),e.west<=e.east){let u=e.east-e.west;a.west=e.west+t*u,a.east=e.west+r*u}else{let u=z.TWO_PI+e.east-e.west;a.west=z.negativePiToPi(e.west+t*u),a.east=z.negativePiToPi(e.west+r*u)}let s=e.north-e.south;return a.south=e.south+n*s,a.north=e.south+o*s,t===1&&(a.west=e.east),r===1&&(a.east=e.east),n===1&&(a.south=e.north),o===1&&(a.north=e.north),a};$t.MAX_VALUE=Object.freeze(new $t(-Math.PI,-z.PI_OVER_TWO,Math.PI,z.PI_OVER_TWO));var ln=$t;function da(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.width=T(n,0),this.height=T(r,0)}da.packedLength=4;da.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.width,t[n]=e.height,t};da.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new da),n.x=e[t++],n.y=e[t++],n.width=e[t++],n.height=e[t],n};da.fromPoints=function(e,t){if(_(t)||(t=new da),!_(e)||e.length===0)return t.x=0,t.y=0,t.width=0,t.height=0,t;let n=e.length,r=e[0].x,o=e[0].y,a=e[0].x,s=e[0].y;for(let u=1;u<n;u++){let l=e[u],c=l.x,f=l.y;r=Math.min(c,r),a=Math.max(c,a),o=Math.min(f,o),s=Math.max(f,s)}return t.x=r,t.y=o,t.width=a-r,t.height=s-o,t};var qoe=new uc,Woe=new ce,Yoe=new ce;da.fromRectangle=function(e,t,n){if(_(n)||(n=new da),!_(e))return n.x=0,n.y=0,n.width=0,n.height=0,n;t=T(t,qoe);let r=t.project(ln.southwest(e,Woe)),o=t.project(ln.northeast(e,Yoe));return X.subtract(o,r,o),n.x=r.x,n.y=r.y,n.width=o.x,n.height=o.y,n};da.clone=function(e,t){if(!!_(e))return _(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new da(e.x,e.y,e.width,e.height)};da.union=function(e,t,n){_(n)||(n=new da);let r=Math.min(e.x,t.x),o=Math.min(e.y,t.y),a=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=r,n.y=o,n.width=a-r,n.height=s-o,n};da.expand=function(e,t,n){n=da.clone(e,n);let r=t.x-n.x,o=t.y-n.y;return r>n.width?n.width=r:r<0&&(n.width-=r,n.x=t.x),o>n.height?n.height=o:o<0&&(n.height-=o,n.y=t.y),n};da.intersect=function(e,t){let n=e.x,r=e.y,o=t.x,a=t.y;return n>o+t.width||n+e.width<o||r+e.height<a||r>a+t.height?gi.OUTSIDE:gi.INTERSECTING};da.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height};da.prototype.clone=function(e){return da.clone(this,e)};da.prototype.intersect=function(e){return da.intersect(this,e)};da.prototype.equals=function(e){return da.equals(this,e)};var en=da;function Oe(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0),this.w=T(r,0)}Oe.fromElements=function(e,t,n,r,o){return _(o)?(o.x=e,o.y=t,o.z=n,o.w=r,o):new Oe(e,t,n,r)};Oe.fromColor=function(e,t){return _(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new Oe(e.red,e.green,e.blue,e.alpha)};Oe.clone=function(e,t){if(!!_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new Oe(e.x,e.y,e.z,e.w)};Oe.packedLength=4;Oe.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};Oe.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Oe),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n};Oe.packArray=function(e,t){let n=e.length,r=n*4;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Oe.pack(e[o],t,o*4);return t};Oe.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){let o=r/4;t[o]=Oe.unpack(e,r,t[o])}return t};Oe.fromArray=Oe.unpack;Oe.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)};Oe.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)};Oe.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n};Oe.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n};Oe.clamp=function(e,t,n,r){let o=z.clamp(e.x,t.x,n.x),a=z.clamp(e.y,t.y,n.y),s=z.clamp(e.z,t.z,n.z),u=z.clamp(e.w,t.w,n.w);return r.x=o,r.y=a,r.z=s,r.w=u,r};Oe.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};Oe.magnitude=function(e){return Math.sqrt(Oe.magnitudeSquared(e))};var Cb=new Oe;Oe.distance=function(e,t){return Oe.subtract(e,t,Cb),Oe.magnitude(Cb)};Oe.distanceSquared=function(e,t){return Oe.subtract(e,t,Cb),Oe.magnitudeSquared(Cb)};Oe.normalize=function(e,t){let n=Oe.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t};Oe.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};Oe.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n};Oe.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n};Oe.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};Oe.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};Oe.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};Oe.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};Oe.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};Oe.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var fk=new Oe;Oe.lerp=function(e,t,n,r){return Oe.multiplyByScalar(t,n,fk),r=Oe.multiplyByScalar(e,1-n,r),Oe.add(fk,r,r)};var Xoe=new Oe;Oe.mostOrthogonalAxis=function(e,t){let n=Oe.normalize(e,Xoe);return Oe.abs(n,n),n.x<=n.y?n.x<=n.z?n.x<=n.w?t=Oe.clone(Oe.UNIT_X,t):t=Oe.clone(Oe.UNIT_W,t):n.z<=n.w?t=Oe.clone(Oe.UNIT_Z,t):t=Oe.clone(Oe.UNIT_W,t):n.y<=n.z?n.y<=n.w?t=Oe.clone(Oe.UNIT_Y,t):t=Oe.clone(Oe.UNIT_W,t):n.z<=n.w?t=Oe.clone(Oe.UNIT_Z,t):t=Oe.clone(Oe.UNIT_W,t),t};Oe.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};Oe.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]};Oe.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&z.equalsEpsilon(e.x,t.x,n,r)&&z.equalsEpsilon(e.y,t.y,n,r)&&z.equalsEpsilon(e.z,t.z,n,r)&&z.equalsEpsilon(e.w,t.w,n,r)};Oe.ZERO=Object.freeze(new Oe(0,0,0,0));Oe.ONE=Object.freeze(new Oe(1,1,1,1));Oe.UNIT_X=Object.freeze(new Oe(1,0,0,0));Oe.UNIT_Y=Object.freeze(new Oe(0,1,0,0));Oe.UNIT_Z=Object.freeze(new Oe(0,0,1,0));Oe.UNIT_W=Object.freeze(new Oe(0,0,0,1));Oe.prototype.clone=function(e){return Oe.clone(this,e)};Oe.prototype.equals=function(e){return Oe.equals(this,e)};Oe.prototype.equalsEpsilon=function(e,t,n){return Oe.equalsEpsilon(this,e,t,n)};Oe.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var HR=new Float32Array(1),Zu=new Uint8Array(HR.buffer),joe=new Uint32Array([287454020]),Koe=new Uint8Array(joe.buffer),hk=Koe[0]===68;Oe.packFloat=function(e,t){return _(t)||(t=new Oe),HR[0]=e,hk?(t.x=Zu[0],t.y=Zu[1],t.z=Zu[2],t.w=Zu[3]):(t.x=Zu[3],t.y=Zu[2],t.z=Zu[1],t.w=Zu[0]),t};Oe.unpackFloat=function(e){return hk?(Zu[0]=e.x,Zu[1]=e.y,Zu[2]=e.z,Zu[3]=e.w):(Zu[0]=e.w,Zu[1]=e.z,Zu[2]=e.y,Zu[3]=e.x),HR[0]};var Se=Oe;var kg,pa={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},lc={};Object.defineProperties(lc,{element:{get:function(){if(!!lc.supportsFullscreen())return document[pa.fullscreenElement]}},changeEventName:{get:function(){if(!!lc.supportsFullscreen())return pa.fullscreenchange}},errorEventName:{get:function(){if(!!lc.supportsFullscreen())return pa.fullscreenerror}},enabled:{get:function(){if(!!lc.supportsFullscreen())return document[pa.fullscreenEnabled]}},fullscreen:{get:function(){if(!!lc.supportsFullscreen())return lc.element!==null}}});lc.supportsFullscreen=function(){if(_(kg))return kg;kg=!1;let e=document.body;if(typeof e.requestFullscreen=="function")return pa.requestFullscreen="requestFullscreen",pa.exitFullscreen="exitFullscreen",pa.fullscreenEnabled="fullscreenEnabled",pa.fullscreenElement="fullscreenElement",pa.fullscreenchange="fullscreenchange",pa.fullscreenerror="fullscreenerror",kg=!0,kg;let t=["webkit","moz","o","ms","khtml"],n;for(let r=0,o=t.length;r<o;++r){let a=t[r];n=`${a}RequestFullscreen`,typeof e[n]=="function"?(pa.requestFullscreen=n,kg=!0):(n=`${a}RequestFullScreen`,typeof e[n]=="function"&&(pa.requestFullscreen=n,kg=!0)),n=`${a}ExitFullscreen`,typeof document[n]=="function"?pa.exitFullscreen=n:(n=`${a}CancelFullScreen`,typeof document[n]=="function"&&(pa.exitFullscreen=n)),n=`${a}FullscreenEnabled`,document[n]!==void 0?pa.fullscreenEnabled=n:(n=`${a}FullScreenEnabled`,document[n]!==void 0&&(pa.fullscreenEnabled=n)),n=`${a}FullscreenElement`,document[n]!==void 0?pa.fullscreenElement=n:(n=`${a}FullScreenElement`,document[n]!==void 0&&(pa.fullscreenElement=n)),n=`${a}fullscreenchange`,document[`on${n}`]!==void 0&&(a==="ms"&&(n="MSFullscreenChange"),pa.fullscreenchange=n),n=`${a}fullscreenerror`,document[`on${n}`]!==void 0&&(a==="ms"&&(n="MSFullscreenError"),pa.fullscreenerror=n)}return kg};lc.requestFullscreen=function(e,t){!lc.supportsFullscreen()||e[pa.requestFullscreen]({vrDisplay:t})};lc.exitFullscreen=function(){!lc.supportsFullscreen()||document[pa.exitFullscreen]()};lc._names=pa;var dk=lc;var Qu;typeof navigator<"u"?Qu=navigator:Qu={};function L_(e){let t=e.split(".");for(let n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}var xb,pk;function KR(){if(!_(xb)&&(xb=!1,!bb())){let e=/ Chrome\/([\.0-9]+)/.exec(Qu.userAgent);e!==null&&(xb=!0,pk=L_(e[1]))}return xb}function Zoe(){return KR()&&pk}var wb,mk;function gk(){if(!_(wb)&&(wb=!1,!KR()&&!bb()&&/ Safari\/[\.0-9]+/.test(Qu.userAgent))){let e=/ Version\/([\.0-9]+)/.exec(Qu.userAgent);e!==null&&(wb=!0,mk=L_(e[1]))}return wb}function Qoe(){return gk()&&mk}var Eb,XR;function _k(){if(!_(Eb)){Eb=!1;let e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Qu.userAgent);e!==null&&(Eb=!0,XR=L_(e[1]),XR.isNightly=!!e[2])}return Eb}function Joe(){return _k()&&XR}var Bw,jR;function yk(){if(!_(Bw)){Bw=!1;let e;Qu.appName==="Microsoft Internet Explorer"?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Qu.userAgent),e!==null&&(Bw=!0,jR=L_(e[1]))):Qu.appName==="Netscape"&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Qu.userAgent),e!==null&&(Bw=!0,jR=L_(e[1])))}return Bw}function $oe(){return yk()&&jR}var Tb,vk;function bb(){if(!_(Tb)){Tb=!1;let e=/ Edg\/([\.0-9]+)/.exec(Qu.userAgent);e!==null&&(Tb=!0,vk=L_(e[1]))}return Tb}function eae(){return bb()&&vk}var Sb,Ck;function ZR(){if(!_(Sb)){Sb=!1;let e=/Firefox\/([\.0-9]+)/.exec(Qu.userAgent);e!==null&&(Sb=!0,Ck=L_(e[1]))}return Sb}var qR;function tae(){return _(qR)||(qR=/Windows/i.test(Qu.appVersion)),qR}var WR;function nae(){return _(WR)||(WR=navigator.platform==="iPhone"||navigator.platform==="iPod"||navigator.platform==="iPad"),WR}function rae(){return ZR()&&Ck}var YR;function iae(){return _(YR)||(YR=!ZR()&&typeof PointerEvent<"u"&&(!_(Qu.pointerEnabled)||Qu.pointerEnabled)),YR}var xk,Ab;function wk(){if(!_(Ab)){let e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let t=e.style.imageRendering;Ab=_(t)&&t!=="",Ab&&(xk=t)}return Ab}function oae(){return wk()?xk:void 0}function bl(){return bl._result}bl._promise=void 0;bl._result=void 0;bl.initialize=function(){return _(bl._promise)||(bl._promise=new Promise(e=>{let t=new Image;t.onload=function(){bl._result=t.width>0&&t.height>0,e(bl._result)},t.onerror=function(){bl._result=!1,e(bl._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),bl._promise};Object.defineProperties(bl,{initialized:{get:function(){return _(bl._result)}}});var Kv=[];typeof ArrayBuffer<"u"&&(Kv.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray<"u"&&Kv.push(Uint8ClampedArray),typeof Uint8ClampedArray<"u"&&Kv.push(Uint8ClampedArray),typeof BigInt64Array<"u"&&Kv.push(BigInt64Array),typeof BigUint64Array<"u"&&Kv.push(BigUint64Array));var Qd={isChrome:KR,chromeVersion:Zoe,isSafari:gk,safariVersion:Qoe,isWebkit:_k,webkitVersion:Joe,isInternetExplorer:yk,internetExplorerVersion:$oe,isEdge:bb,edgeVersion:eae,isFirefox:ZR,firefoxVersion:rae,isWindows:tae,isIPadOrIOS:nae,hardwareConcurrency:T(Qu.hardwareConcurrency,3),supportsPointerEvents:iae,supportsImageRenderingPixelated:wk,supportsWebP:bl,imageRenderingValue:oae,typedArrayTypes:Kv};Qd.supportsBasis=function(e){return Qd.supportsWebAssembly()&&e.context.supportsBasis};Qd.supportsFullscreen=function(){return dk.supportsFullscreen()};Qd.supportsTypedArrays=function(){return typeof ArrayBuffer<"u"};Qd.supportsBigInt64Array=function(){return typeof BigInt64Array<"u"};Qd.supportsBigUint64Array=function(){return typeof BigUint64Array<"u"};Qd.supportsBigInt=function(){return typeof BigInt<"u"};Qd.supportsWebWorkers=function(){return typeof Worker<"u"};Qd.supportsWebAssembly=function(){return typeof WebAssembly<"u"};var Qo=Qd;function QR(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n*6<1?e+(t-e)*6*n:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}function Y(e,t,n,r){this.red=T(e,1),this.green=T(t,1),this.blue=T(n,1),this.alpha=T(r,1)}Y.fromCartesian4=function(e,t){return _(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new Y(e.x,e.y,e.z,e.w)};Y.fromBytes=function(e,t,n,r,o){return e=Y.byteToFloat(T(e,255)),t=Y.byteToFloat(T(t,255)),n=Y.byteToFloat(T(n,255)),r=Y.byteToFloat(T(r,255)),_(o)?(o.red=e,o.green=t,o.blue=n,o.alpha=r,o):new Y(e,t,n,r)};Y.fromAlpha=function(e,t,n){return _(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=t,n):new Y(e.red,e.green,e.blue,t)};var JR,$R,mm;Qo.supportsTypedArrays()&&(JR=new ArrayBuffer(4),$R=new Uint32Array(JR),mm=new Uint8Array(JR));Y.fromRgba=function(e,t){return $R[0]=e,Y.fromBytes(mm[0],mm[1],mm[2],mm[3],t)};Y.fromHsl=function(e,t,n,r,o){e=T(e,0)%1,t=T(t,0),n=T(n,0),r=T(r,1);let a=n,s=n,u=n;if(t!==0){let l;n<.5?l=n*(1+t):l=n+t-n*t;let c=2*n-l;a=QR(c,l,e+1/3),s=QR(c,l,e),u=QR(c,l,e-1/3)}return _(o)?(o.red=a,o.green=s,o.blue=u,o.alpha=r,o):new Y(a,s,u,r)};Y.fromRandom=function(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.red;if(!_(n)){let s=T(e.minimumRed,0),u=T(e.maximumRed,1);n=s+z.nextRandomNumber()*(u-s)}let r=e.green;if(!_(r)){let s=T(e.minimumGreen,0),u=T(e.maximumGreen,1);r=s+z.nextRandomNumber()*(u-s)}let o=e.blue;if(!_(o)){let s=T(e.minimumBlue,0),u=T(e.maximumBlue,1);o=s+z.nextRandomNumber()*(u-s)}let a=e.alpha;if(!_(a)){let s=T(e.minimumAlpha,0),u=T(e.maximumAlpha,1);a=s+z.nextRandomNumber()*(u-s)}return _(t)?(t.red=n,t.green=r,t.blue=o,t.alpha=a,t):new Y(n,r,o,a)};var aae=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,sae=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,uae=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,lae=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;Y.fromCssColorString=function(e,t){_(t)||(t=new Y),e=e.replace(/\s/g,"");let n=Y[e.toUpperCase()];if(_(n))return Y.clone(n,t),t;let r=aae.exec(e);return r!==null?(t.red=parseInt(r[1],16)/15,t.green=parseInt(r[2],16)/15,t.blue=parseInt(r[3],16)/15,t.alpha=parseInt(T(r[4],"f"),16)/15,t):(r=sae.exec(e),r!==null?(t.red=parseInt(r[1],16)/255,t.green=parseInt(r[2],16)/255,t.blue=parseInt(r[3],16)/255,t.alpha=parseInt(T(r[4],"ff"),16)/255,t):(r=uae.exec(e),r!==null?(t.red=parseFloat(r[1])/(r[1].substr(-1)==="%"?100:255),t.green=parseFloat(r[2])/(r[2].substr(-1)==="%"?100:255),t.blue=parseFloat(r[3])/(r[3].substr(-1)==="%"?100:255),t.alpha=parseFloat(T(r[4],"1.0")),t):(r=lae.exec(e),r!==null?Y.fromHsl(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,parseFloat(T(r[4],"1.0")),t):(t=void 0,t))))};Y.packedLength=4;Y.pack=function(e,t,n){return n=T(n,0),t[n++]=e.red,t[n++]=e.green,t[n++]=e.blue,t[n]=e.alpha,t};Y.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Y),n.red=e[t++],n.green=e[t++],n.blue=e[t++],n.alpha=e[t],n};Y.byteToFloat=function(e){return e/255};Y.floatToByte=function(e){return e===1?255:e*256|0};Y.clone=function(e,t){if(!!_(e))return _(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new Y(e.red,e.green,e.blue,e.alpha)};Y.equals=function(e,t){return e===t||_(e)&&_(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha};Y.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]};Y.prototype.clone=function(e){return Y.clone(this,e)};Y.prototype.equals=function(e){return Y.equals(this,e)};Y.prototype.equalsEpsilon=function(e,t){return this===e||_(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t};Y.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`};Y.prototype.toCssColorString=function(){let e=Y.floatToByte(this.red),t=Y.floatToByte(this.green),n=Y.floatToByte(this.blue);return this.alpha===1?`rgb(${e},${t},${n})`:`rgba(${e},${t},${n},${this.alpha})`};Y.prototype.toCssHexString=function(){let e=Y.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=Y.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let n=Y.floatToByte(this.blue).toString(16);if(n.length<2&&(n=`0${n}`),this.alpha<1){let r=Y.floatToByte(this.alpha).toString(16);return r.length<2&&(r=`0${r}`),`#${e}${t}${n}${r}`}return`#${e}${t}${n}`};Y.prototype.toBytes=function(e){let t=Y.floatToByte(this.red),n=Y.floatToByte(this.green),r=Y.floatToByte(this.blue),o=Y.floatToByte(this.alpha);return _(e)?(e[0]=t,e[1]=n,e[2]=r,e[3]=o,e):[t,n,r,o]};Y.prototype.toRgba=function(){return mm[0]=Y.floatToByte(this.red),mm[1]=Y.floatToByte(this.green),mm[2]=Y.floatToByte(this.blue),mm[3]=Y.floatToByte(this.alpha),$R[0]};Y.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t};Y.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t};Y.prototype.withAlpha=function(e,t){return Y.fromAlpha(this,e,t)};Y.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n};Y.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n};Y.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n};Y.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n};Y.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n};Y.lerp=function(e,t,n,r){return r.red=z.lerp(e.red,t.red,n),r.green=z.lerp(e.green,t.green,n),r.blue=z.lerp(e.blue,t.blue,n),r.alpha=z.lerp(e.alpha,t.alpha,n),r};Y.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n};Y.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n};Y.ALICEBLUE=Object.freeze(Y.fromCssColorString("#F0F8FF"));Y.ANTIQUEWHITE=Object.freeze(Y.fromCssColorString("#FAEBD7"));Y.AQUA=Object.freeze(Y.fromCssColorString("#00FFFF"));Y.AQUAMARINE=Object.freeze(Y.fromCssColorString("#7FFFD4"));Y.AZURE=Object.freeze(Y.fromCssColorString("#F0FFFF"));Y.BEIGE=Object.freeze(Y.fromCssColorString("#F5F5DC"));Y.BISQUE=Object.freeze(Y.fromCssColorString("#FFE4C4"));Y.BLACK=Object.freeze(Y.fromCssColorString("#000000"));Y.BLANCHEDALMOND=Object.freeze(Y.fromCssColorString("#FFEBCD"));Y.BLUE=Object.freeze(Y.fromCssColorString("#0000FF"));Y.BLUEVIOLET=Object.freeze(Y.fromCssColorString("#8A2BE2"));Y.BROWN=Object.freeze(Y.fromCssColorString("#A52A2A"));Y.BURLYWOOD=Object.freeze(Y.fromCssColorString("#DEB887"));Y.CADETBLUE=Object.freeze(Y.fromCssColorString("#5F9EA0"));Y.CHARTREUSE=Object.freeze(Y.fromCssColorString("#7FFF00"));Y.CHOCOLATE=Object.freeze(Y.fromCssColorString("#D2691E"));Y.CORAL=Object.freeze(Y.fromCssColorString("#FF7F50"));Y.CORNFLOWERBLUE=Object.freeze(Y.fromCssColorString("#6495ED"));Y.CORNSILK=Object.freeze(Y.fromCssColorString("#FFF8DC"));Y.CRIMSON=Object.freeze(Y.fromCssColorString("#DC143C"));Y.CYAN=Object.freeze(Y.fromCssColorString("#00FFFF"));Y.DARKBLUE=Object.freeze(Y.fromCssColorString("#00008B"));Y.DARKCYAN=Object.freeze(Y.fromCssColorString("#008B8B"));Y.DARKGOLDENROD=Object.freeze(Y.fromCssColorString("#B8860B"));Y.DARKGRAY=Object.freeze(Y.fromCssColorString("#A9A9A9"));Y.DARKGREEN=Object.freeze(Y.fromCssColorString("#006400"));Y.DARKGREY=Y.DARKGRAY;Y.DARKKHAKI=Object.freeze(Y.fromCssColorString("#BDB76B"));Y.DARKMAGENTA=Object.freeze(Y.fromCssColorString("#8B008B"));Y.DARKOLIVEGREEN=Object.freeze(Y.fromCssColorString("#556B2F"));Y.DARKORANGE=Object.freeze(Y.fromCssColorString("#FF8C00"));Y.DARKORCHID=Object.freeze(Y.fromCssColorString("#9932CC"));Y.DARKRED=Object.freeze(Y.fromCssColorString("#8B0000"));Y.DARKSALMON=Object.freeze(Y.fromCssColorString("#E9967A"));Y.DARKSEAGREEN=Object.freeze(Y.fromCssColorString("#8FBC8F"));Y.DARKSLATEBLUE=Object.freeze(Y.fromCssColorString("#483D8B"));Y.DARKSLATEGRAY=Object.freeze(Y.fromCssColorString("#2F4F4F"));Y.DARKSLATEGREY=Y.DARKSLATEGRAY;Y.DARKTURQUOISE=Object.freeze(Y.fromCssColorString("#00CED1"));Y.DARKVIOLET=Object.freeze(Y.fromCssColorString("#9400D3"));Y.DEEPPINK=Object.freeze(Y.fromCssColorString("#FF1493"));Y.DEEPSKYBLUE=Object.freeze(Y.fromCssColorString("#00BFFF"));Y.DIMGRAY=Object.freeze(Y.fromCssColorString("#696969"));Y.DIMGREY=Y.DIMGRAY;Y.DODGERBLUE=Object.freeze(Y.fromCssColorString("#1E90FF"));Y.FIREBRICK=Object.freeze(Y.fromCssColorString("#B22222"));Y.FLORALWHITE=Object.freeze(Y.fromCssColorString("#FFFAF0"));Y.FORESTGREEN=Object.freeze(Y.fromCssColorString("#228B22"));Y.FUCHSIA=Object.freeze(Y.fromCssColorString("#FF00FF"));Y.GAINSBORO=Object.freeze(Y.fromCssColorString("#DCDCDC"));Y.GHOSTWHITE=Object.freeze(Y.fromCssColorString("#F8F8FF"));Y.GOLD=Object.freeze(Y.fromCssColorString("#FFD700"));Y.GOLDENROD=Object.freeze(Y.fromCssColorString("#DAA520"));Y.GRAY=Object.freeze(Y.fromCssColorString("#808080"));Y.GREEN=Object.freeze(Y.fromCssColorString("#008000"));Y.GREENYELLOW=Object.freeze(Y.fromCssColorString("#ADFF2F"));Y.GREY=Y.GRAY;Y.HONEYDEW=Object.freeze(Y.fromCssColorString("#F0FFF0"));Y.HOTPINK=Object.freeze(Y.fromCssColorString("#FF69B4"));Y.INDIANRED=Object.freeze(Y.fromCssColorString("#CD5C5C"));Y.INDIGO=Object.freeze(Y.fromCssColorString("#4B0082"));Y.IVORY=Object.freeze(Y.fromCssColorString("#FFFFF0"));Y.KHAKI=Object.freeze(Y.fromCssColorString("#F0E68C"));Y.LAVENDER=Object.freeze(Y.fromCssColorString("#E6E6FA"));Y.LAVENDAR_BLUSH=Object.freeze(Y.fromCssColorString("#FFF0F5"));Y.LAWNGREEN=Object.freeze(Y.fromCssColorString("#7CFC00"));Y.LEMONCHIFFON=Object.freeze(Y.fromCssColorString("#FFFACD"));Y.LIGHTBLUE=Object.freeze(Y.fromCssColorString("#ADD8E6"));Y.LIGHTCORAL=Object.freeze(Y.fromCssColorString("#F08080"));Y.LIGHTCYAN=Object.freeze(Y.fromCssColorString("#E0FFFF"));Y.LIGHTGOLDENRODYELLOW=Object.freeze(Y.fromCssColorString("#FAFAD2"));Y.LIGHTGRAY=Object.freeze(Y.fromCssColorString("#D3D3D3"));Y.LIGHTGREEN=Object.freeze(Y.fromCssColorString("#90EE90"));Y.LIGHTGREY=Y.LIGHTGRAY;Y.LIGHTPINK=Object.freeze(Y.fromCssColorString("#FFB6C1"));Y.LIGHTSEAGREEN=Object.freeze(Y.fromCssColorString("#20B2AA"));Y.LIGHTSKYBLUE=Object.freeze(Y.fromCssColorString("#87CEFA"));Y.LIGHTSLATEGRAY=Object.freeze(Y.fromCssColorString("#778899"));Y.LIGHTSLATEGREY=Y.LIGHTSLATEGRAY;Y.LIGHTSTEELBLUE=Object.freeze(Y.fromCssColorString("#B0C4DE"));Y.LIGHTYELLOW=Object.freeze(Y.fromCssColorString("#FFFFE0"));Y.LIME=Object.freeze(Y.fromCssColorString("#00FF00"));Y.LIMEGREEN=Object.freeze(Y.fromCssColorString("#32CD32"));Y.LINEN=Object.freeze(Y.fromCssColorString("#FAF0E6"));Y.MAGENTA=Object.freeze(Y.fromCssColorString("#FF00FF"));Y.MAROON=Object.freeze(Y.fromCssColorString("#800000"));Y.MEDIUMAQUAMARINE=Object.freeze(Y.fromCssColorString("#66CDAA"));Y.MEDIUMBLUE=Object.freeze(Y.fromCssColorString("#0000CD"));Y.MEDIUMORCHID=Object.freeze(Y.fromCssColorString("#BA55D3"));Y.MEDIUMPURPLE=Object.freeze(Y.fromCssColorString("#9370DB"));Y.MEDIUMSEAGREEN=Object.freeze(Y.fromCssColorString("#3CB371"));Y.MEDIUMSLATEBLUE=Object.freeze(Y.fromCssColorString("#7B68EE"));Y.MEDIUMSPRINGGREEN=Object.freeze(Y.fromCssColorString("#00FA9A"));Y.MEDIUMTURQUOISE=Object.freeze(Y.fromCssColorString("#48D1CC"));Y.MEDIUMVIOLETRED=Object.freeze(Y.fromCssColorString("#C71585"));Y.MIDNIGHTBLUE=Object.freeze(Y.fromCssColorString("#191970"));Y.MINTCREAM=Object.freeze(Y.fromCssColorString("#F5FFFA"));Y.MISTYROSE=Object.freeze(Y.fromCssColorString("#FFE4E1"));Y.MOCCASIN=Object.freeze(Y.fromCssColorString("#FFE4B5"));Y.NAVAJOWHITE=Object.freeze(Y.fromCssColorString("#FFDEAD"));Y.NAVY=Object.freeze(Y.fromCssColorString("#000080"));Y.OLDLACE=Object.freeze(Y.fromCssColorString("#FDF5E6"));Y.OLIVE=Object.freeze(Y.fromCssColorString("#808000"));Y.OLIVEDRAB=Object.freeze(Y.fromCssColorString("#6B8E23"));Y.ORANGE=Object.freeze(Y.fromCssColorString("#FFA500"));Y.ORANGERED=Object.freeze(Y.fromCssColorString("#FF4500"));Y.ORCHID=Object.freeze(Y.fromCssColorString("#DA70D6"));Y.PALEGOLDENROD=Object.freeze(Y.fromCssColorString("#EEE8AA"));Y.PALEGREEN=Object.freeze(Y.fromCssColorString("#98FB98"));Y.PALETURQUOISE=Object.freeze(Y.fromCssColorString("#AFEEEE"));Y.PALEVIOLETRED=Object.freeze(Y.fromCssColorString("#DB7093"));Y.PAPAYAWHIP=Object.freeze(Y.fromCssColorString("#FFEFD5"));Y.PEACHPUFF=Object.freeze(Y.fromCssColorString("#FFDAB9"));Y.PERU=Object.freeze(Y.fromCssColorString("#CD853F"));Y.PINK=Object.freeze(Y.fromCssColorString("#FFC0CB"));Y.PLUM=Object.freeze(Y.fromCssColorString("#DDA0DD"));Y.POWDERBLUE=Object.freeze(Y.fromCssColorString("#B0E0E6"));Y.PURPLE=Object.freeze(Y.fromCssColorString("#800080"));Y.RED=Object.freeze(Y.fromCssColorString("#FF0000"));Y.ROSYBROWN=Object.freeze(Y.fromCssColorString("#BC8F8F"));Y.ROYALBLUE=Object.freeze(Y.fromCssColorString("#4169E1"));Y.SADDLEBROWN=Object.freeze(Y.fromCssColorString("#8B4513"));Y.SALMON=Object.freeze(Y.fromCssColorString("#FA8072"));Y.SANDYBROWN=Object.freeze(Y.fromCssColorString("#F4A460"));Y.SEAGREEN=Object.freeze(Y.fromCssColorString("#2E8B57"));Y.SEASHELL=Object.freeze(Y.fromCssColorString("#FFF5EE"));Y.SIENNA=Object.freeze(Y.fromCssColorString("#A0522D"));Y.SILVER=Object.freeze(Y.fromCssColorString("#C0C0C0"));Y.SKYBLUE=Object.freeze(Y.fromCssColorString("#87CEEB"));Y.SLATEBLUE=Object.freeze(Y.fromCssColorString("#6A5ACD"));Y.SLATEGRAY=Object.freeze(Y.fromCssColorString("#708090"));Y.SLATEGREY=Y.SLATEGRAY;Y.SNOW=Object.freeze(Y.fromCssColorString("#FFFAFA"));Y.SPRINGGREEN=Object.freeze(Y.fromCssColorString("#00FF7F"));Y.STEELBLUE=Object.freeze(Y.fromCssColorString("#4682B4"));Y.TAN=Object.freeze(Y.fromCssColorString("#D2B48C"));Y.TEAL=Object.freeze(Y.fromCssColorString("#008080"));Y.THISTLE=Object.freeze(Y.fromCssColorString("#D8BFD8"));Y.TOMATO=Object.freeze(Y.fromCssColorString("#FF6347"));Y.TURQUOISE=Object.freeze(Y.fromCssColorString("#40E0D0"));Y.VIOLET=Object.freeze(Y.fromCssColorString("#EE82EE"));Y.WHEAT=Object.freeze(Y.fromCssColorString("#F5DEB3"));Y.WHITE=Object.freeze(Y.fromCssColorString("#FFFFFF"));Y.WHITESMOKE=Object.freeze(Y.fromCssColorString("#F5F5F5"));Y.YELLOW=Object.freeze(Y.fromCssColorString("#FFFF00"));Y.YELLOWGREEN=Object.freeze(Y.fromCssColorString("#9ACD32"));Y.TRANSPARENT=Object.freeze(new Y(0,0,0,0));var K=Y;function cae(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var _i=cae;function Bc(e,t){e=T(e,0),this._near=e,t=T(t,Number.MAX_VALUE),this._far=t}Object.defineProperties(Bc.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}});Bc.packedLength=2;Bc.pack=function(e,t,n){return n=T(n,0),t[n++]=e.near,t[n]=e.far,t};Bc.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Bc),n.near=e[t++],n.far=e[t],n};Bc.equals=function(e,t){return e===t||_(e)&&_(t)&&e.near===t.near&&e.far===t.far};Bc.clone=function(e,t){if(!!_(e))return _(t)||(t=new Bc),t.near=e.near,t.far=e.far,t};Bc.prototype.clone=function(e){return Bc.clone(this,e)};Bc.prototype.equals=function(e){return Bc.equals(this,e)};var gn=Bc;function Ae(e,t,n,r,o,a,s,u,l){this[0]=T(e,0),this[1]=T(r,0),this[2]=T(s,0),this[3]=T(t,0),this[4]=T(o,0),this[5]=T(u,0),this[6]=T(n,0),this[7]=T(a,0),this[8]=T(l,0)}Ae.packedLength=9;Ae.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t};Ae.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Ae),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n};Ae.packArray=function(e,t){let n=e.length,r=n*9;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)Ae.pack(e[o],t,o*9);return t};Ae.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/9:t=new Array(n/9);for(let r=0;r<n;r+=9){let o=r/9;t[o]=Ae.unpack(e,r,t[o])}return t};Ae.clone=function(e,t){if(!!_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new Ae(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])};Ae.fromArray=Ae.unpack;Ae.fromColumnMajorArray=function(e,t){return Ae.clone(e,t)};Ae.fromRowMajorArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new Ae(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};Ae.fromQuaternion=function(e,t){let n=e.x*e.x,r=e.x*e.y,o=e.x*e.z,a=e.x*e.w,s=e.y*e.y,u=e.y*e.z,l=e.y*e.w,c=e.z*e.z,f=e.z*e.w,h=e.w*e.w,d=n-s-c+h,p=2*(r-f),g=2*(o+l),y=2*(r+f),v=-n+s-c+h,w=2*(u-a),C=2*(o-l),E=2*(u+a),S=-n-s+c+h;return _(t)?(t[0]=d,t[1]=y,t[2]=C,t[3]=p,t[4]=v,t[5]=E,t[6]=g,t[7]=w,t[8]=S,t):new Ae(d,p,g,y,v,w,C,E,S)};Ae.fromHeadingPitchRoll=function(e,t){let n=Math.cos(-e.pitch),r=Math.cos(-e.heading),o=Math.cos(e.roll),a=Math.sin(-e.pitch),s=Math.sin(-e.heading),u=Math.sin(e.roll),l=n*r,c=-o*s+u*a*r,f=u*s+o*a*r,h=n*s,d=o*r+u*a*s,p=-u*r+o*a*s,g=-a,y=u*n,v=o*n;return _(t)?(t[0]=l,t[1]=h,t[2]=g,t[3]=c,t[4]=d,t[5]=y,t[6]=f,t[7]=p,t[8]=v,t):new Ae(l,c,f,h,d,p,g,y,v)};Ae.fromScale=function(e,t){return _(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new Ae(e.x,0,0,0,e.y,0,0,0,e.z)};Ae.fromUniformScale=function(e,t){return _(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new Ae(e,0,0,0,e,0,0,0,e)};Ae.fromCrossProduct=function(e,t){return _(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new Ae(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)};Ae.fromRotationX=function(e,t){let n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=r,t[6]=0,t[7]=-r,t[8]=n,t):new Ae(1,0,0,0,n,-r,0,r,n)};Ae.fromRotationY=function(e,t){let n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=1,t[5]=0,t[6]=r,t[7]=0,t[8]=n,t):new Ae(n,0,r,0,1,0,-r,0,n)};Ae.fromRotationZ=function(e,t){let n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Ae(n,-r,0,r,n,0,0,0,1)};Ae.toArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]};Ae.getElementIndex=function(e,t){return e*3+t};Ae.getColumn=function(e,t,n){let r=t*3,o=e[r],a=e[r+1],s=e[r+2];return n.x=o,n.y=a,n.z=s,n};Ae.setColumn=function(e,t,n,r){r=Ae.clone(e,r);let o=t*3;return r[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r};Ae.getRow=function(e,t,n){let r=e[t],o=e[t+3],a=e[t+6];return n.x=r,n.y=o,n.z=a,n};Ae.setRow=function(e,t,n,r){return r=Ae.clone(e,r),r[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};var fae=new x;Ae.setScale=function(e,t,n){let r=Ae.getScale(e,fae),o=t.x/r.x,a=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*a,n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var hae=new x;Ae.setUniformScale=function(e,t,n){let r=Ae.getScale(e,hae),o=t/r.x,a=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*a,n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};var eO=new x;Ae.getScale=function(e,t){return t.x=x.magnitude(x.fromElements(e[0],e[1],e[2],eO)),t.y=x.magnitude(x.fromElements(e[3],e[4],e[5],eO)),t.z=x.magnitude(x.fromElements(e[6],e[7],e[8],eO)),t};var Ek=new x;Ae.getMaximumScale=function(e){return Ae.getScale(e,Ek),x.maximumComponent(Ek)};var dae=new x;Ae.setRotation=function(e,t,n){let r=Ae.getScale(e,dae);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=t[3]*r.y,n[4]=t[4]*r.y,n[5]=t[5]*r.y,n[6]=t[6]*r.z,n[7]=t[7]*r.z,n[8]=t[8]*r.z,n};var pae=new x;Ae.getRotation=function(e,t){let n=Ae.getScale(e,pae);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t};Ae.multiply=function(e,t,n){let r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],a=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],u=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],l=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],f=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],h=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=o,n[2]=a,n[3]=s,n[4]=u,n[5]=l,n[6]=c,n[7]=f,n[8]=h,n};Ae.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n};Ae.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n};Ae.multiplyByVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[3]*o+e[6]*a,u=e[1]*r+e[4]*o+e[7]*a,l=e[2]*r+e[5]*o+e[8]*a;return n.x=s,n.y=u,n.z=l,n};Ae.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};Ae.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n};Ae.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n};Ae.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t};Ae.transpose=function(e,t){let n=e[0],r=e[3],o=e[6],a=e[1],s=e[4],u=e[7],l=e[2],c=e[5],f=e[8];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=f,t};function mae(e){let t=0;for(let n=0;n<9;++n){let r=e[n];t+=r*r}return Math.sqrt(t)}var tO=[1,0,0],nO=[2,2,1];function gae(e){let t=0;for(let n=0;n<3;++n){let r=e[Ae.getElementIndex(nO[n],tO[n])];t+=2*r*r}return Math.sqrt(t)}function _ae(e,t){let n=z.EPSILON15,r=0,o=1;for(let c=0;c<3;++c){let f=Math.abs(e[Ae.getElementIndex(nO[c],tO[c])]);f>r&&(o=c,r=f)}let a=1,s=0,u=tO[o],l=nO[o];if(Math.abs(e[Ae.getElementIndex(l,u)])>n){let c=e[Ae.getElementIndex(l,l)],f=e[Ae.getElementIndex(u,u)],h=e[Ae.getElementIndex(l,u)],d=(c-f)/2/h,p;d<0?p=-1/(-d+Math.sqrt(1+d*d)):p=1/(d+Math.sqrt(1+d*d)),a=1/Math.sqrt(1+p*p),s=p*a}return t=Ae.clone(Ae.IDENTITY,t),t[Ae.getElementIndex(u,u)]=t[Ae.getElementIndex(l,l)]=a,t[Ae.getElementIndex(l,u)]=s,t[Ae.getElementIndex(u,l)]=-s,t}var Ib=new Ae,Tk=new Ae;Ae.computeEigenDecomposition=function(e,t){let n=z.EPSILON20,r=10,o=0,a=0;_(t)||(t={});let s=t.unitary=Ae.clone(Ae.IDENTITY,t.unitary),u=t.diagonal=Ae.clone(e,t.diagonal),l=n*mae(u);for(;a<r&&gae(u)>l;)_ae(u,Ib),Ae.transpose(Ib,Tk),Ae.multiply(u,Ib,u),Ae.multiply(Tk,u,u),Ae.multiply(s,Ib,s),++o>2&&(++a,o=0);return t};Ae.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t};Ae.determinant=function(e){let t=e[0],n=e[3],r=e[6],o=e[1],a=e[4],s=e[7],u=e[2],l=e[5],c=e[8];return t*(a*c-l*s)+o*(l*r-n*c)+u*(n*s-a*r)};Ae.inverse=function(e,t){let n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=Ae.determinant(e);t[0]=s*f-c*u,t[1]=c*o-r*f,t[2]=r*u-s*o,t[3]=l*u-a*f,t[4]=n*f-l*o,t[5]=a*o-n*u,t[6]=a*c-l*s,t[7]=l*r-n*c,t[8]=n*s-a*r;let d=1/h;return Ae.multiplyByScalar(t,d,t)};var yae=new Ae;Ae.inverseTranspose=function(e,t){return Ae.inverse(Ae.transpose(e,yae),t)};Ae.equals=function(e,t){return e===t||_(e)&&_(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]};Ae.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n};Ae.IDENTITY=Object.freeze(new Ae(1,0,0,0,1,0,0,0,1));Ae.ZERO=Object.freeze(new Ae(0,0,0,0,0,0,0,0,0));Ae.COLUMN0ROW0=0;Ae.COLUMN0ROW1=1;Ae.COLUMN0ROW2=2;Ae.COLUMN1ROW0=3;Ae.COLUMN1ROW1=4;Ae.COLUMN1ROW2=5;Ae.COLUMN2ROW0=6;Ae.COLUMN2ROW1=7;Ae.COLUMN2ROW2=8;Object.defineProperties(Ae.prototype,{length:{get:function(){return Ae.packedLength}}});Ae.prototype.clone=function(e){return Ae.clone(this,e)};Ae.prototype.equals=function(e){return Ae.equals(this,e)};Ae.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]};Ae.prototype.equalsEpsilon=function(e,t){return Ae.equalsEpsilon(this,e,t)};Ae.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})
(${this[1]}, ${this[4]}, ${this[7]})
(${this[2]}, ${this[5]}, ${this[8]})`};var ne=Ae;function we(e,t,n,r,o,a,s,u,l,c,f,h,d,p,g,y){this[0]=T(e,0),this[1]=T(o,0),this[2]=T(l,0),this[3]=T(d,0),this[4]=T(t,0),this[5]=T(a,0),this[6]=T(c,0),this[7]=T(p,0),this[8]=T(n,0),this[9]=T(s,0),this[10]=T(f,0),this[11]=T(g,0),this[12]=T(r,0),this[13]=T(u,0),this[14]=T(h,0),this[15]=T(y,0)}we.packedLength=16;we.computeReflection=function(e,t,n,r,o){return _(o)||(o=new we),o[0]=1-2*e*e,o[1]=-2*e*t,o[2]=-2*e*n,o[3]=0,o[4]=-2*t*e,o[5]=1-2*t*t,o[6]=-2*t*n,o[7]=0,o[8]=-2*n*e,o[9]=-2*n*t,o[10]=1-2*n*n,o[11]=0,o[12]=-2*r*e,o[13]=-2*r*t,o[14]=-2*r*n,o[15]=1,o};we.computeObliquePerspective=function(e,t,n){let r=we.inverse(n,new we),o=we.inverseTranspose(t,new we),a=we.multiplyByVector(o,e,new Se),s=new Se(Sk(a.x),Sk(a.y),1,1),u=we.multiplyByVector(r,s,new Se),l=2/Se.dot(a,u),c=[a.x*l,a.y*l,a.z*l+1,a.w*l];return new we(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],c[0],c[1],c[2],c[3],n[3],n[7],n[11],n[15])};function Sk(e){return e>0?1:e<0?-1:0}we.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t};we.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new we),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n};we.packArray=function(e,t){let n=e.length,r=n*16;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)we.pack(e[o],t,o*16);return t};we.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/16:t=new Array(n/16);for(let r=0;r<n;r+=16){let o=r/16;t[o]=we.unpack(e,r,t[o])}return t};we.clone=function(e,t){if(!!_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new we(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])};we.fromArray=we.unpack;we.fromColumnMajorArray=function(e,t){return we.clone(e,t)};we.fromRowMajorArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new we(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])};we.fromRotationTranslation=function(e,t,n){return t=T(t,x.ZERO),_(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new we(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)};we.fromTranslationQuaternionRotationScale=function(e,t,n,r){_(r)||(r=new we);let o=n.x,a=n.y,s=n.z,u=t.x*t.x,l=t.x*t.y,c=t.x*t.z,f=t.x*t.w,h=t.y*t.y,d=t.y*t.z,p=t.y*t.w,g=t.z*t.z,y=t.z*t.w,v=t.w*t.w,w=u-h-g+v,C=2*(l-y),E=2*(c+p),S=2*(l+y),A=-u+h-g+v,D=2*(d-f),P=2*(c-p),M=2*(d+f),I=-u-h+g+v;return r[0]=w*o,r[1]=S*o,r[2]=P*o,r[3]=0,r[4]=C*a,r[5]=A*a,r[6]=M*a,r[7]=0,r[8]=E*s,r[9]=D*s,r[10]=I*s,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r};we.fromTranslationRotationScale=function(e,t){return we.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)};we.fromTranslation=function(e,t){return we.fromRotationTranslation(ne.IDENTITY,e,t)};we.fromScale=function(e,t){return _(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new we(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)};we.fromUniformScale=function(e,t){return _(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new we(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};we.fromRotation=function(e,t){return _(t)||(t=new we),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var Zv=new x,Qv=new x,Fw=new x;we.fromCamera=function(e,t){let n=e.position,r=e.direction,o=e.up;x.normalize(r,Zv),x.normalize(x.cross(Zv,o,Qv),Qv),x.normalize(x.cross(Qv,Zv,Fw),Fw);let a=Qv.x,s=Qv.y,u=Qv.z,l=Zv.x,c=Zv.y,f=Zv.z,h=Fw.x,d=Fw.y,p=Fw.z,g=n.x,y=n.y,v=n.z,w=a*-g+s*-y+u*-v,C=h*-g+d*-y+p*-v,E=l*g+c*y+f*v;return _(t)?(t[0]=a,t[1]=h,t[2]=-l,t[3]=0,t[4]=s,t[5]=d,t[6]=-c,t[7]=0,t[8]=u,t[9]=p,t[10]=-f,t[11]=0,t[12]=w,t[13]=C,t[14]=E,t[15]=1,t):new we(a,s,u,w,h,d,p,C,-l,-c,-f,E,0,0,0,1)};we.computePerspectiveFieldOfView=function(e,t,n,r,o){let a=Math.tan(e*.5),s=1/a,u=s/t,l=(r+n)/(n-r),c=2*r*n/(n-r);return o[0]=u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=l,o[11]=-1,o[12]=0,o[13]=0,o[14]=c,o[15]=0,o};we.computeOrthographicOffCenter=function(e,t,n,r,o,a,s){let u=1/(t-e),l=1/(r-n),c=1/(a-o),f=-(t+e)*u,h=-(r+n)*l,d=-(a+o)*c;return u*=2,l*=2,c*=-2,s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=c,s[11]=0,s[12]=f,s[13]=h,s[14]=d,s[15]=1,s};we.computePerspectiveOffCenter=function(e,t,n,r,o,a,s){let u=2*o/(t-e),l=2*o/(r-n),c=(t+e)/(t-e),f=(r+n)/(r-n),h=-(a+o)/(a-o),d=-1,p=-2*a*o/(a-o);return s[0]=u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=l,s[6]=0,s[7]=0,s[8]=c,s[9]=f,s[10]=h,s[11]=d,s[12]=0,s[13]=0,s[14]=p,s[15]=0,s};we.computeInfinitePerspectiveOffCenter=function(e,t,n,r,o,a){let s=2*o/(t-e),u=2*o/(r-n),l=(t+e)/(t-e),c=(r+n)/(r-n),f=-1,h=-1,d=-2*o;return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=l,a[9]=c,a[10]=f,a[11]=h,a[12]=0,a[13]=0,a[14]=d,a[15]=0,a};we.computeViewportTransformation=function(e,t,n,r){_(r)||(r=new we),e=T(e,T.EMPTY_OBJECT);let o=T(e.x,0),a=T(e.y,0),s=T(e.width,0),u=T(e.height,0);t=T(t,0),n=T(n,1);let l=s*.5,c=u*.5,f=(n-t)*.5,h=l,d=c,p=f,g=o+l,y=a+c,v=t+f,w=1;return r[0]=h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=d,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=p,r[11]=0,r[12]=g,r[13]=y,r[14]=v,r[15]=w,r};we.computeView=function(e,t,n,r,o){return o[0]=r.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-x.dot(r,e),o[13]=-x.dot(n,e),o[14]=x.dot(t,e),o[15]=1,o};we.toArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]};we.getElementIndex=function(e,t){return e*4+t};we.getColumn=function(e,t,n){let r=t*4,o=e[r],a=e[r+1],s=e[r+2],u=e[r+3];return n.x=o,n.y=a,n.z=s,n.w=u,n};we.setColumn=function(e,t,n,r){r=we.clone(e,r);let o=t*4;return r[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r};we.getRow=function(e,t,n){let r=e[t],o=e[t+4],a=e[t+8],s=e[t+12];return n.x=r,n.y=o,n.z=a,n.w=s,n};we.setRow=function(e,t,n,r){return r=we.clone(e,r),r[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r};we.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};var vae=new x;we.setScale=function(e,t,n){let r=we.getScale(e,vae),o=t.x/r.x,a=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*a,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var Cae=new x;we.setUniformScale=function(e,t,n){let r=we.getScale(e,Cae),o=t/r.x,a=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*a,n[5]=e[5]*a,n[6]=e[6]*a,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var rO=new x;we.getScale=function(e,t){return t.x=x.magnitude(x.fromElements(e[0],e[1],e[2],rO)),t.y=x.magnitude(x.fromElements(e[4],e[5],e[6],rO)),t.z=x.magnitude(x.fromElements(e[8],e[9],e[10],rO)),t};var Ak=new x;we.getMaximumScale=function(e){return we.getScale(e,Ak),x.maximumComponent(Ak)};var xae=new x;we.setRotation=function(e,t,n){let r=we.getScale(e,xae);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=e[3],n[4]=t[3]*r.y,n[5]=t[4]*r.y,n[6]=t[5]*r.y,n[7]=e[7],n[8]=t[6]*r.z,n[9]=t[7]*r.z,n[10]=t[8]*r.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};var wae=new x;we.getRotation=function(e,t){let n=we.getScale(e,wae);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t};we.multiply=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[3],u=e[4],l=e[5],c=e[6],f=e[7],h=e[8],d=e[9],p=e[10],g=e[11],y=e[12],v=e[13],w=e[14],C=e[15],E=t[0],S=t[1],A=t[2],D=t[3],P=t[4],M=t[5],I=t[6],O=t[7],m=t[8],b=t[9],L=t[10],R=t[11],N=t[12],B=t[13],G=t[14],F=t[15],k=r*E+u*S+h*A+y*D,Z=o*E+l*S+d*A+v*D,te=a*E+c*S+p*A+w*D,oe=s*E+f*S+g*A+C*D,ue=r*P+u*M+h*I+y*O,pe=o*P+l*M+d*I+v*O,me=a*P+c*M+p*I+w*O,st=s*P+f*M+g*I+C*O,ht=r*m+u*b+h*L+y*R,jt=o*m+l*b+d*L+v*R,Ct=a*m+c*b+p*L+w*R,bt=s*m+f*b+g*L+C*R,mn=r*N+u*B+h*G+y*F,Tn=o*N+l*B+d*G+v*F,zi=a*N+c*B+p*G+w*F,at=s*N+f*B+g*G+C*F;return n[0]=k,n[1]=Z,n[2]=te,n[3]=oe,n[4]=ue,n[5]=pe,n[6]=me,n[7]=st,n[8]=ht,n[9]=jt,n[10]=Ct,n[11]=bt,n[12]=mn,n[13]=Tn,n[14]=zi,n[15]=at,n};we.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n};we.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n};we.multiplyTransformation=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],f=e[9],h=e[10],d=e[12],p=e[13],g=e[14],y=t[0],v=t[1],w=t[2],C=t[4],E=t[5],S=t[6],A=t[8],D=t[9],P=t[10],M=t[12],I=t[13],O=t[14],m=r*y+s*v+c*w,b=o*y+u*v+f*w,L=a*y+l*v+h*w,R=r*C+s*E+c*S,N=o*C+u*E+f*S,B=a*C+l*E+h*S,G=r*A+s*D+c*P,F=o*A+u*D+f*P,k=a*A+l*D+h*P,Z=r*M+s*I+c*O+d,te=o*M+u*I+f*O+p,oe=a*M+l*I+h*O+g;return n[0]=m,n[1]=b,n[2]=L,n[3]=0,n[4]=R,n[5]=N,n[6]=B,n[7]=0,n[8]=G,n[9]=F,n[10]=k,n[11]=0,n[12]=Z,n[13]=te,n[14]=oe,n[15]=1,n};we.multiplyByMatrix3=function(e,t,n){let r=e[0],o=e[1],a=e[2],s=e[4],u=e[5],l=e[6],c=e[8],f=e[9],h=e[10],d=t[0],p=t[1],g=t[2],y=t[3],v=t[4],w=t[5],C=t[6],E=t[7],S=t[8],A=r*d+s*p+c*g,D=o*d+u*p+f*g,P=a*d+l*p+h*g,M=r*y+s*v+c*w,I=o*y+u*v+f*w,O=a*y+l*v+h*w,m=r*C+s*E+c*S,b=o*C+u*E+f*S,L=a*C+l*E+h*S;return n[0]=A,n[1]=D,n[2]=P,n[3]=0,n[4]=M,n[5]=I,n[6]=O,n[7]=0,n[8]=m,n[9]=b,n[10]=L,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};we.multiplyByTranslation=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=r*e[0]+o*e[4]+a*e[8]+e[12],u=r*e[1]+o*e[5]+a*e[9]+e[13],l=r*e[2]+o*e[6]+a*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=u,n[14]=l,n[15]=e[15],n};we.multiplyByScale=function(e,t,n){let r=t.x,o=t.y,a=t.z;return r===1&&o===1&&a===1?we.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=a*e[8],n[9]=a*e[9],n[10]=a*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)};we.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};we.multiplyByVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=t.w,u=e[0]*r+e[4]*o+e[8]*a+e[12]*s,l=e[1]*r+e[5]*o+e[9]*a+e[13]*s,c=e[2]*r+e[6]*o+e[10]*a+e[14]*s,f=e[3]*r+e[7]*o+e[11]*a+e[15]*s;return n.x=u,n.y=l,n.z=c,n.w=f,n};we.multiplyByPointAsVector=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[4]*o+e[8]*a,u=e[1]*r+e[5]*o+e[9]*a,l=e[2]*r+e[6]*o+e[10]*a;return n.x=s,n.y=u,n.z=l,n};we.multiplyByPoint=function(e,t,n){let r=t.x,o=t.y,a=t.z,s=e[0]*r+e[4]*o+e[8]*a+e[12],u=e[1]*r+e[5]*o+e[9]*a+e[13],l=e[2]*r+e[6]*o+e[10]*a+e[14];return n.x=s,n.y=u,n.z=l,n};we.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n};we.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t};we.transpose=function(e,t){let n=e[1],r=e[2],o=e[3],a=e[6],s=e[7],u=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=s,t[14]=u,t[15]=e[15],t};we.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t};we.equals=function(e,t){return e===t||_(e)&&_(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]};we.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n};we.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t};we.getMatrix3=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var Eae=new ne,Tae=new ne,Sae=new Se,Aae=new Se(0,0,0,1);we.inverse=function(e,t){let n=e[0],r=e[4],o=e[8],a=e[12],s=e[1],u=e[5],l=e[9],c=e[13],f=e[2],h=e[6],d=e[10],p=e[14],g=e[3],y=e[7],v=e[11],w=e[15],C=d*w,E=p*v,S=h*w,A=p*y,D=h*v,P=d*y,M=f*w,I=p*g,O=f*v,m=d*g,b=f*y,L=h*g,R=C*u+A*l+D*c-(E*u+S*l+P*c),N=E*s+M*l+m*c-(C*s+I*l+O*c),B=S*s+I*u+b*c-(A*s+M*u+L*c),G=P*s+O*u+L*l-(D*s+m*u+b*l),F=E*r+S*o+P*a-(C*r+A*o+D*a),k=C*n+I*o+O*a-(E*n+M*o+m*a),Z=A*n+M*r+L*a-(S*n+I*r+b*a),te=D*n+m*r+b*o-(P*n+O*r+L*o);C=o*c,E=a*l,S=r*c,A=a*u,D=r*l,P=o*u,M=n*c,I=a*s,O=n*l,m=o*s,b=n*u,L=r*s;let oe=C*y+A*v+D*w-(E*y+S*v+P*w),ue=E*g+M*v+m*w-(C*g+I*v+O*w),pe=S*g+I*y+b*w-(A*g+M*y+L*w),me=P*g+O*y+L*v-(D*g+m*y+b*v),st=S*d+P*p+E*h-(D*p+C*h+A*d),ht=O*p+C*f+I*d-(M*d+m*p+E*f),jt=M*h+L*p+A*f-(b*p+S*f+I*h),Ct=b*d+D*f+m*h-(O*h+L*d+P*f),bt=n*R+r*N+o*B+a*G;if(Math.abs(bt)<z.EPSILON21){if(ne.equalsEpsilon(we.getMatrix3(e,Eae),Tae,z.EPSILON7)&&Se.equals(we.getRow(e,3,Sae),Aae))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new it("matrix is not invertible because its determinate is zero.")}return bt=1/bt,t[0]=R*bt,t[1]=N*bt,t[2]=B*bt,t[3]=G*bt,t[4]=F*bt,t[5]=k*bt,t[6]=Z*bt,t[7]=te*bt,t[8]=oe*bt,t[9]=ue*bt,t[10]=pe*bt,t[11]=me*bt,t[12]=st*bt,t[13]=ht*bt,t[14]=jt*bt,t[15]=Ct*bt,t};we.inverseTransformation=function(e,t){let n=e[0],r=e[1],o=e[2],a=e[4],s=e[5],u=e[6],l=e[8],c=e[9],f=e[10],h=e[12],d=e[13],p=e[14],g=-n*h-r*d-o*p,y=-a*h-s*d-u*p,v=-l*h-c*d-f*p;return t[0]=n,t[1]=a,t[2]=l,t[3]=0,t[4]=r,t[5]=s,t[6]=c,t[7]=0,t[8]=o,t[9]=u,t[10]=f,t[11]=0,t[12]=g,t[13]=y,t[14]=v,t[15]=1,t};var bae=new we;we.inverseTranspose=function(e,t){return we.inverse(we.transpose(e,bae),t)};we.IDENTITY=Object.freeze(new we(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));we.ZERO=Object.freeze(new we(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));we.COLUMN0ROW0=0;we.COLUMN0ROW1=1;we.COLUMN0ROW2=2;we.COLUMN0ROW3=3;we.COLUMN1ROW0=4;we.COLUMN1ROW1=5;we.COLUMN1ROW2=6;we.COLUMN1ROW3=7;we.COLUMN2ROW0=8;we.COLUMN2ROW1=9;we.COLUMN2ROW2=10;we.COLUMN2ROW3=11;we.COLUMN3ROW0=12;we.COLUMN3ROW1=13;we.COLUMN3ROW2=14;we.COLUMN3ROW3=15;Object.defineProperties(we.prototype,{length:{get:function(){return we.packedLength}}});we.prototype.clone=function(e){return we.clone(this,e)};we.prototype.equals=function(e){return we.equals(this,e)};we.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]};we.prototype.equalsEpsilon=function(e,t){return we.equalsEpsilon(this,e,t)};we.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})
(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})
(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})
(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var U=we;function Df(e,t,n,r){this.near=T(e,0),this.nearValue=T(t,0),this.far=T(n,1),this.farValue=T(r,0)}Df.clone=function(e,t){if(!!_(e))return _(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new Df(e.near,e.nearValue,e.far,e.farValue)};Df.packedLength=4;Df.pack=function(e,t,n){return n=T(n,0),t[n++]=e.near,t[n++]=e.nearValue,t[n++]=e.far,t[n]=e.farValue,t};Df.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Df),n.near=e[t++],n.nearValue=e[t++],n.far=e[t++],n.farValue=e[t],n};Df.equals=function(e,t){return e===t||_(e)&&_(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue};Df.prototype.clone=function(e){return Df.clone(this,e)};Df.prototype.equals=function(e){return Df.equals(this,e)};var Tt=Df;var Iae={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2},Pt=Object.freeze(Iae);var Dae={CENTER:0,LEFT:1,RIGHT:-1},ho=Object.freeze(Dae);var Db={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};Db.getMorphTime=function(e){return e===Db.SCENE3D?1:e===Db.MORPHING?void 0:0};var Ne=Object.freeze(Db);function As(e,t){this.normal=x.clone(e),this.distance=t}As.fromPointNormal=function(e,t,n){let r=-x.dot(t,e);return _(n)?(x.clone(t,n.normal),n.distance=r,n):new As(t,r)};var Pae=new x;As.fromCartesian4=function(e,t){let n=x.fromCartesian4(e,Pae),r=e.w;return _(t)?(x.clone(n,t.normal),t.distance=r,t):new As(n,r)};As.getPointDistance=function(e,t){return x.dot(e.normal,t)+e.distance};var Mae=new x;As.projectPointOntoPlane=function(e,t,n){_(n)||(n=new x);let r=As.getPointDistance(e,t),o=x.multiplyByScalar(e.normal,r,Mae);return x.subtract(t,o,n)};var Lae=new U,Rae=new Se,Oae=new x;As.transform=function(e,t,n){let r=e.normal,o=e.distance,a=U.inverseTranspose(t,Lae),s=Se.fromElements(r.x,r.y,r.z,o,Rae);s=U.multiplyByVector(a,s,s);let u=x.fromCartesian4(s,Oae);return s=Se.divideByScalar(s,x.magnitude(u),s),As.fromCartesian4(s,n)};As.clone=function(e,t){return _(t)?(x.clone(e.normal,t.normal),t.distance=e.distance,t):new As(e.normal,e.distance)};As.equals=function(e,t){return e.distance===t.distance&&x.equals(e.normal,t.normal)};As.ORIGIN_XY_PLANE=Object.freeze(new As(x.UNIT_Z,0));As.ORIGIN_YZ_PLANE=Object.freeze(new As(x.UNIT_X,0));As.ORIGIN_ZX_PLANE=Object.freeze(new As(x.UNIT_Y,0));var oi=As;function Pf(e){this.planes=T(e,[])}var zw=[new x,new x,new x];x.clone(x.UNIT_X,zw[0]);x.clone(x.UNIT_Y,zw[1]);x.clone(x.UNIT_Z,zw[2]);var Gg=new x,Nae=new x,bk=new oi(new x(1,0,0),0);Pf.fromBoundingSphere=function(e,t){_(t)||(t=new Pf);let n=zw.length,r=t.planes;r.length=2*n;let o=e.center,a=e.radius,s=0;for(let u=0;u<n;++u){let l=zw[u],c=r[s],f=r[s+1];_(c)||(c=r[s]=new Se),_(f)||(f=r[s+1]=new Se),x.multiplyByScalar(l,-a,Gg),x.add(o,Gg,Gg),c.x=l.x,c.y=l.y,c.z=l.z,c.w=-x.dot(l,Gg),x.multiplyByScalar(l,a,Gg),x.add(o,Gg,Gg),f.x=-l.x,f.y=-l.y,f.z=-l.z,f.w=-x.dot(x.negate(l,Nae),Gg),s+=2}return t};Pf.prototype.computeVisibility=function(e){let t=this.planes,n=!1;for(let r=0,o=t.length;r<o;++r){let a=e.intersectPlane(oi.fromCartesian4(t[r],bk));if(a===gi.OUTSIDE)return gi.OUTSIDE;a===gi.INTERSECTING&&(n=!0)}return n?gi.INTERSECTING:gi.INSIDE};Pf.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===Pf.MASK_OUTSIDE||t===Pf.MASK_INSIDE)return t;let n=Pf.MASK_INSIDE,r=this.planes;for(let o=0,a=r.length;o<a;++o){let s=o<31?1<<o:0;if(o<31&&(t&s)===0)continue;let u=e.intersectPlane(oi.fromCartesian4(r[o],bk));if(u===gi.OUTSIDE)return Pf.MASK_OUTSIDE;u===gi.INTERSECTING&&(n|=s)}return n};Pf.MASK_OUTSIDE=4294967295;Pf.MASK_INSIDE=0;Pf.MASK_INDETERMINATE=2147483647;var Ik=Pf;function Jd(e){e=T(e,T.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=T(e.near,1),this._near=this.near,this.far=T(e.far,5e8),this._far=this.far,this._cullingVolume=new Ik,this._orthographicMatrix=new U}function Dk(e){(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far)&&(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=U.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}Object.defineProperties(Jd.prototype,{projectionMatrix:{get:function(){return Dk(this),this._orthographicMatrix}}});var Bae=new x,Fae=new x,zae=new x,iO=new x;Jd.prototype.computeCullingVolume=function(e,t,n){let r=this._cullingVolume.planes,o=this.top,a=this.bottom,s=this.right,u=this.left,l=this.near,c=this.far,f=x.cross(t,n,Bae);x.normalize(f,f);let h=Fae;x.multiplyByScalar(t,l,h),x.add(e,h,h);let d=zae;x.multiplyByScalar(f,u,d),x.add(h,d,d);let p=r[0];return _(p)||(p=r[0]=new Se),p.x=f.x,p.y=f.y,p.z=f.z,p.w=-x.dot(f,d),x.multiplyByScalar(f,s,d),x.add(h,d,d),p=r[1],_(p)||(p=r[1]=new Se),p.x=-f.x,p.y=-f.y,p.z=-f.z,p.w=-x.dot(x.negate(f,iO),d),x.multiplyByScalar(n,a,d),x.add(h,d,d),p=r[2],_(p)||(p=r[2]=new Se),p.x=n.x,p.y=n.y,p.z=n.z,p.w=-x.dot(n,d),x.multiplyByScalar(n,o,d),x.add(h,d,d),p=r[3],_(p)||(p=r[3]=new Se),p.x=-n.x,p.y=-n.y,p.z=-n.z,p.w=-x.dot(x.negate(n,iO),d),p=r[4],_(p)||(p=r[4]=new Se),p.x=t.x,p.y=t.y,p.z=t.z,p.w=-x.dot(t,h),x.multiplyByScalar(t,c,d),x.add(e,d,d),p=r[5],_(p)||(p=r[5]=new Se),p.x=-t.x,p.y=-t.y,p.z=-t.z,p.w=-x.dot(x.negate(t,iO),d),this._cullingVolume};Jd.prototype.getPixelDimensions=function(e,t,n,r,o){Dk(this);let a=this.right-this.left,s=this.top-this.bottom,u=r*a/e,l=r*s/t;return o.x=u,o.y=l,o};Jd.prototype.clone=function(e){return _(e)||(e=new Jd),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};Jd.prototype.equals=function(e){return _(e)&&e instanceof Jd&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};Jd.prototype.equalsEpsilon=function(e,t,n){return e===this||_(e)&&e instanceof Jd&&z.equalsEpsilon(this.right,e.right,t,n)&&z.equalsEpsilon(this.left,e.left,t,n)&&z.equalsEpsilon(this.top,e.top,t,n)&&z.equalsEpsilon(this.bottom,e.bottom,t,n)&&z.equalsEpsilon(this.near,e.near,t,n)&&z.equalsEpsilon(this.far,e.far,t,n)};var Pb=Jd;function cc(e){e=T(e,T.EMPTY_OBJECT),this._offCenterFrustum=new Pb,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=T(e.near,1),this._near=this.near,this.far=T(e.far,5e8),this._far=this.far}cc.packedLength=4;cc.pack=function(e,t,n){return n=T(n,0),t[n++]=e.width,t[n++]=e.aspectRatio,t[n++]=e.near,t[n]=e.far,t};cc.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new cc),n.width=e[t++],n.aspectRatio=e[t++],n.near=e[t++],n.far=e[t],n};function R_(e){let t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;let n=1/e.aspectRatio;t.right=e.width*.5,t.left=-t.right,t.top=n*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Object.defineProperties(cc.prototype,{projectionMatrix:{get:function(){return R_(this),this._offCenterFrustum.projectionMatrix}}});cc.prototype.computeCullingVolume=function(e,t,n){return R_(this),this._offCenterFrustum.computeCullingVolume(e,t,n)};cc.prototype.getPixelDimensions=function(e,t,n,r,o){return R_(this),this._offCenterFrustum.getPixelDimensions(e,t,n,r,o)};cc.prototype.clone=function(e){return _(e)||(e=new cc),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};cc.prototype.equals=function(e){return!_(e)||!(e instanceof cc)?!1:(R_(this),R_(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};cc.prototype.equalsEpsilon=function(e,t,n){return!_(e)||!(e instanceof cc)?!1:(R_(this),R_(e),z.equalsEpsilon(this.width,e.width,t,n)&&z.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,n)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,n))};var Pk=cc;function Vae(e,t,n){let r=0,o=e.length-1,a,s;for(;r<=o;){if(a=~~((r+o)/2),s=n(e[a],t),s<0){r=a+1;continue}if(s>0){o=a-1;continue}return a}return~(o+1)}var Au=Vae;function kae(e,t,n,r,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=o}var Vw=kae;function Gae(e,t,n,r,o,a,s,u){this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=o,this.second=a,this.millisecond=s,this.isLeapSecond=u}var Jv=Gae;function Uae(e){return e%4===0&&e%100!==0||e%400===0}var $v=Uae;function Hae(e,t){this.julianDate=e,this.offset=t}var Di=Hae;var qae={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:24000005e-1},po=Object.freeze(qae);var Wae={UTC:0,TAI:1},_n=Object.freeze(Wae);var Lk=new Jv,oO=[31,28,31,30,31,30,31,31,30,31,30,31],aO=29;function sO(e,t){return ke.compare(e.julianDate,t.julianDate)}var eC=new Di;function Lb(e){eC.julianDate=e;let t=ke.leapSeconds,n=Au(t,eC,sO);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let r=t[n].offset;n>0&&ke.secondsDifference(t[n].julianDate,e)>r&&(n--,r=t[n].offset),ke.addSeconds(e,r,e)}function Mk(e,t){eC.julianDate=e;let n=ke.leapSeconds,r=Au(n,eC,sO);if(r<0&&(r=~r),r===0)return ke.addSeconds(e,-n[0].offset,t);if(r>=n.length)return ke.addSeconds(e,-n[r-1].offset,t);let o=ke.secondsDifference(n[r].julianDate,e);if(o===0)return ke.addSeconds(e,-n[r].offset,t);if(!(o<=1))return ke.addSeconds(e,-n[--r].offset,t)}function Ug(e,t,n){let r=t/po.SECONDS_PER_DAY|0;return e+=r,t-=po.SECONDS_PER_DAY*r,t<0&&(e--,t+=po.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function uO(e,t,n,r,o,a,s){let u=(t-14)/12|0,l=e+4800+u,c=(1461*l/4|0)+(367*(t-2-12*u)/12|0)-(3*((l+100)/100|0)/4|0)+n-32075;r=r-12,r<0&&(r+=24);let f=a+(r*po.SECONDS_PER_HOUR+o*po.SECONDS_PER_MINUTE+s*po.SECONDS_PER_MILLISECOND);return f>=43200&&(c-=1),[c,f]}var Yae=/^(\d{4})$/,Xae=/^(\d{4})-(\d{2})$/,jae=/^(\d{4})-?(\d{3})$/,Kae=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Zae=/^(\d{4})-?(\d{2})-?(\d{2})$/,lO=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Qae=/^(\d{2})(\.\d+)?/.source+lO.source,Jae=/^(\d{2}):?(\d{2})(\.\d+)?/.source+lO.source,$ae=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+lO.source;function ke(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=T(e,0),t=T(t,0),n=T(n,_n.UTC);let r=e|0;t=t+(e-r)*po.SECONDS_PER_DAY,Ug(r,t,this),n===_n.UTC&&Lb(this)}ke.fromGregorianDate=function(e,t){let n=uO(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return _(t)?(Ug(n[0],n[1],t),Lb(t),t):new ke(n[0],n[1],_n.UTC)};ke.fromDate=function(e,t){let n=uO(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return _(t)?(Ug(n[0],n[1],t),Lb(t),t):new ke(n[0],n[1],_n.UTC)};ke.fromIso8601=function(e,t){e=e.replace(",",".");let n=e.split("T"),r,o=1,a=1,s=0,u=0,l=0,c=0,f=n[0],h=n[1],d,p;if(n=f.match(Zae),n!==null)r=+n[1],o=+n[2],a=+n[3];else if(n=f.match(Xae),n!==null)r=+n[1],o=+n[2];else if(n=f.match(Yae),n!==null)r=+n[1];else{let w;if(n=f.match(jae),n!==null)r=+n[1],w=+n[2],p=$v(r);else if(n=f.match(Kae),n!==null){r=+n[1];let C=+n[2],E=+n[3]||0,S=new Date(Date.UTC(r,0,4));w=C*7+E-S.getUTCDay()-3}d=new Date(Date.UTC(r,0,1)),d.setUTCDate(w),o=d.getUTCMonth()+1,a=d.getUTCDate()}p=$v(r);let g;if(_(h)){n=h.match($ae),n!==null?(s=+n[1],u=+n[2],l=+n[3],c=+(n[4]||0)*1e3,g=5):(n=h.match(Jae),n!==null?(s=+n[1],u=+n[2],l=+(n[3]||0)*60,g=4):(n=h.match(Qae),n!==null&&(s=+n[1],u=+(n[2]||0)*60,g=3)));let w=n[g],C=+n[g+1],E=+(n[g+2]||0);switch(w){case"+":s=s-C,u=u-E;break;case"-":s=s+C,u=u+E;break;case"Z":break;default:u=u+new Date(Date.UTC(r,o-1,a,s,u)).getTimezoneOffset();break}}let y=l===60;for(y&&l--;u>=60;)u-=60,s++;for(;s>=24;)s-=24,a++;for(d=p&&o===2?aO:oO[o-1];a>d;)a-=d,o++,o>12&&(o-=12,r++),d=p&&o===2?aO:oO[o-1];for(;u<0;)u+=60,s--;for(;s<0;)s+=24,a--;for(;a<1;)o--,o<1&&(o+=12,r--),d=p&&o===2?aO:oO[o-1],a+=d;let v=uO(r,o,a,s,u,l,c);return _(t)?(Ug(v[0],v[1],t),Lb(t)):t=new ke(v[0],v[1],_n.UTC),y&&ke.addSeconds(t,1,t),t};ke.now=function(e){return ke.fromDate(new Date,e)};var Mb=new ke(0,0,_n.TAI);ke.toGregorianDate=function(e,t){let n=!1,r=Mk(e,Mb);_(r)||(ke.addSeconds(e,-1,Mb),r=Mk(Mb,Mb),n=!0);let o=r.dayNumber,a=r.secondsOfDay;a>=43200&&(o+=1);let s=o+68569|0,u=4*s/146097|0;s=s-((146097*u+3)/4|0)|0;let l=4e3*(s+1)/1461001|0;s=s-(1461*l/4|0)+31|0;let c=80*s/2447|0,f=s-(2447*c/80|0)|0;s=c/11|0;let h=c+2-12*s|0,d=100*(u-49)+l+s|0,p=a/po.SECONDS_PER_HOUR|0,g=a-p*po.SECONDS_PER_HOUR,y=g/po.SECONDS_PER_MINUTE|0;g=g-y*po.SECONDS_PER_MINUTE;let v=g|0,w=(g-v)/po.SECONDS_PER_MILLISECOND;return p+=12,p>23&&(p-=24),n&&(v+=1),_(t)?(t.year=d,t.month=h,t.day=f,t.hour=p,t.minute=y,t.second=v,t.millisecond=w,t.isLeapSecond=n,t):new Jv(d,h,f,p,y,v,w,n)};ke.toDate=function(e){let t=ke.toGregorianDate(e,Lk),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))};ke.toIso8601=function(e,t){let n=ke.toGregorianDate(e,Lk),r=n.year,o=n.month,a=n.day,s=n.hour,u=n.minute,l=n.second,c=n.millisecond;r===1e4&&o===1&&a===1&&s===0&&u===0&&l===0&&c===0&&(r=9999,o=12,a=31,s=24);let f;return!_(t)&&c!==0?(f=(c*.01).toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${f}Z`):!_(t)||t===0?`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}Z`:(f=(c*.01).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${f}Z`)};ke.clone=function(e,t){if(!!_(e))return _(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new ke(e.dayNumber,e.secondsOfDay,_n.TAI)};ke.compare=function(e,t){let n=e.dayNumber-t.dayNumber;return n!==0?n:e.secondsOfDay-t.secondsOfDay};ke.equals=function(e,t){return e===t||_(e)&&_(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay};ke.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(ke.secondsDifference(e,t))<=n};ke.totalDays=function(e){return e.dayNumber+e.secondsOfDay/po.SECONDS_PER_DAY};ke.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*po.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)};ke.daysDifference=function(e,t){let n=e.dayNumber-t.dayNumber,r=(e.secondsOfDay-t.secondsOfDay)/po.SECONDS_PER_DAY;return n+r};ke.computeTaiMinusUtc=function(e){eC.julianDate=e;let t=ke.leapSeconds,n=Au(t,eC,sO);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset};ke.addSeconds=function(e,t,n){return Ug(e.dayNumber,e.secondsOfDay+t,n)};ke.addMinutes=function(e,t,n){let r=e.secondsOfDay+t*po.SECONDS_PER_MINUTE;return Ug(e.dayNumber,r,n)};ke.addHours=function(e,t,n){let r=e.secondsOfDay+t*po.SECONDS_PER_HOUR;return Ug(e.dayNumber,r,n)};ke.addDays=function(e,t,n){let r=e.dayNumber+t;return Ug(r,e.secondsOfDay,n)};ke.lessThan=function(e,t){return ke.compare(e,t)<0};ke.lessThanOrEquals=function(e,t){return ke.compare(e,t)<=0};ke.greaterThan=function(e,t){return ke.compare(e,t)>0};ke.greaterThanOrEquals=function(e,t){return ke.compare(e,t)>=0};ke.prototype.clone=function(e){return ke.clone(this,e)};ke.prototype.equals=function(e){return ke.equals(this,e)};ke.prototype.equalsEpsilon=function(e,t){return ke.equalsEpsilon(this,e,t)};ke.prototype.toString=function(){return ke.toIso8601(this)};ke.leapSeconds=[new Di(new ke(2441317,43210,_n.TAI),10),new Di(new ke(2441499,43211,_n.TAI),11),new Di(new ke(2441683,43212,_n.TAI),12),new Di(new ke(2442048,43213,_n.TAI),13),new Di(new ke(2442413,43214,_n.TAI),14),new Di(new ke(2442778,43215,_n.TAI),15),new Di(new ke(2443144,43216,_n.TAI),16),new Di(new ke(2443509,43217,_n.TAI),17),new Di(new ke(2443874,43218,_n.TAI),18),new Di(new ke(2444239,43219,_n.TAI),19),new Di(new ke(2444786,43220,_n.TAI),20),new Di(new ke(2445151,43221,_n.TAI),21),new Di(new ke(2445516,43222,_n.TAI),22),new Di(new ke(2446247,43223,_n.TAI),23),new Di(new ke(2447161,43224,_n.TAI),24),new Di(new ke(2447892,43225,_n.TAI),25),new Di(new ke(2448257,43226,_n.TAI),26),new Di(new ke(2448804,43227,_n.TAI),27),new Di(new ke(2449169,43228,_n.TAI),28),new Di(new ke(2449534,43229,_n.TAI),29),new Di(new ke(2450083,43230,_n.TAI),30),new Di(new ke(2450630,43231,_n.TAI),31),new Di(new ke(2451179,43232,_n.TAI),32),new Di(new ke(2453736,43233,_n.TAI),33),new Di(new ke(2454832,43234,_n.TAI),34),new Di(new ke(2456109,43235,_n.TAI),35),new Di(new ke(2457204,43236,_n.TAI),36),new Di(new ke(2457754,43237,_n.TAI),37)];var fe=ke;function Rb(e){if(e=T(e,T.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=T(e.addNewLeapSeconds,!0),_(e.data))cO(this,e.data);else if(_(e.url)){let t=_t.createIfNeeded(e.url),n=this;this._downloadPromise=t.fetchJson().then(function(r){cO(n,r)}).catch(function(){n._dataError=`An error occurred while retrieving the EOP data from the URL ${t.url}.`})}else cO(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}Rb.NONE=Object.freeze({getPromiseToLoad:function(){return Promise.resolve()},compute:function(e,t){return _(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Vw(0,0,0,0,0),t}});Rb.prototype.getPromiseToLoad=function(){return Promise.resolve(this._downloadPromise)};Rb.prototype.compute=function(e,t){if(!_(this._samples)){if(_(this._dataError))throw new it(this._dataError);return}if(_(t)||(t=new Vw(0,0,0,0,0)),this._samples.length===0)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;let n=this._dates,r=this._lastIndex,o=0,a=0;if(_(r)){let u=n[r],l=n[r+1],c=fe.lessThanOrEquals(u,e),f=!_(l),h=f||fe.greaterThanOrEquals(l,e);if(c&&h)return o=r,!f&&l.equals(e)&&++o,a=o+1,Ok(this,n,this._samples,e,o,a,t),t}let s=Au(n,e,fe.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,o=s,a=s):(a=~s,o=a-1,o<0&&(o=0)),this._lastIndex=o,Ok(this,n,this._samples,e,o,a,t),t};function ese(e,t){return fe.compare(e.julianDate,t)}function cO(e,t){if(!_(t.columnNames)){e._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!_(t.samples)){e._dataError="Error in loaded EOP data: The samples property is required.";return}let n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),a=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||o<0||a<0||s<0||u<0||l<0){e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}let c=e._samples=t.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=a,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=l,e._columnCount=t.columnNames.length,e._lastIndex=void 0;let h,d=e._addNewLeapSeconds;for(let p=0,g=c.length;p<g;p+=e._columnCount){let y=c[p+n],v=c[p+l],w=y+po.MODIFIED_JULIAN_DATE_DIFFERENCE,C=new fe(w,v,_n.TAI);if(f.push(C),d){if(v!==h&&_(h)){let E=fe.leapSeconds,S=Au(E,C,ese);if(S<0){let A=new Di(C,v);E.splice(~S,0,A)}}h=v}}}function Rk(e,t,n,r,o){let a=n*r;o.xPoleWander=t[a+e._xPoleWanderRadiansColumn],o.yPoleWander=t[a+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function kw(e,t,n){return t+e*(n-t)}function Ok(e,t,n,r,o,a,s){let u=e._columnCount;if(a>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;let l=t[o],c=t[a];if(l.equals(c)||r.equals(l))return Rk(e,n,o,u,s),s;if(r.equals(c))return Rk(e,n,a,u,s),s;let f=fe.secondsDifference(r,l)/fe.secondsDifference(c,l),h=o*u,d=a*u,p=n[h+e._ut1MinusUtcSecondsColumn],g=n[d+e._ut1MinusUtcSecondsColumn],y=g-p;if(y>.5||y<-.5){let v=n[h+e._taiMinusUtcSecondsColumn],w=n[d+e._taiMinusUtcSecondsColumn];v!==w&&(c.equals(r)?p=g:g-=w-v)}return s.xPoleWander=kw(f,n[h+e._xPoleWanderRadiansColumn],n[d+e._xPoleWanderRadiansColumn]),s.yPoleWander=kw(f,n[h+e._yPoleWanderRadiansColumn],n[d+e._yPoleWanderRadiansColumn]),s.xPoleOffset=kw(f,n[h+e._xCelestialPoleOffsetRadiansColumn],n[d+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=kw(f,n[h+e._yCelestialPoleOffsetRadiansColumn],n[d+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=kw(f,p,g),s}var Nk=Rb;function Ju(e,t,n){this.heading=T(e,0),this.pitch=T(t,0),this.roll=T(n,0)}Ju.fromQuaternion=function(e,t){_(t)||(t=new Ju);let n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),a=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,a),t.roll=Math.atan2(o,r),t.pitch=-z.asinClamped(n),t};Ju.fromDegrees=function(e,t,n,r){return _(r)||(r=new Ju),r.heading=e*z.RADIANS_PER_DEGREE,r.pitch=t*z.RADIANS_PER_DEGREE,r.roll=n*z.RADIANS_PER_DEGREE,r};Ju.clone=function(e,t){if(!!_(e))return _(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Ju(e.heading,e.pitch,e.roll)};Ju.equals=function(e,t){return e===t||_(e)&&_(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll};Ju.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&z.equalsEpsilon(e.heading,t.heading,n,r)&&z.equalsEpsilon(e.pitch,t.pitch,n,r)&&z.equalsEpsilon(e.roll,t.roll,n,r)};Ju.prototype.clone=function(e){return Ju.clone(this,e)};Ju.prototype.equals=function(e){return Ju.equals(this,e)};Ju.prototype.equalsEpsilon=function(e,t,n){return Ju.equalsEpsilon(this,e,t,n)};Ju.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var Fc=Ju;function tse(e,t,n){this.x=e,this.y=t,this.s=n}var Ob=tse;function dO(e){e=T(e,T.EMPTY_OBJECT),this._xysFileUrlTemplate=_t.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=T(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=T(e.sampleZeroJulianEphemerisDate,24423965e-1),this._sampleZeroDateTT=new fe(this._sampleZeroJulianEphemerisDate,0,_n.TAI),this._stepSizeDays=T(e.stepSizeDays,1),this._samplesPerXysFile=T(e.samplesPerXysFile,1e3),this._totalSamples=T(e.totalSamples,27426),this._samples=new Array(this._totalSamples*3),this._chunkDownloadsInProgress=[];let t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let a=0;a<=t;++a){n[a]=o,r[a]=a*this._stepSizeDays;for(let s=0;s<=t;++s)s!==a&&(n[a]*=a-s);n[a]=1/n[a]}this._work=new Array(t+1),this._coef=new Array(t+1)}var nse=new fe(0,0,_n.TAI);function fO(e,t,n){let r=nse;return r.dayNumber=t,r.secondsOfDay=n,fe.daysDifference(r,e._sampleZeroDateTT)}dO.prototype.preload=function(e,t,n,r){let o=fO(this,e,t),a=fO(this,n,r),s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let u=a/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);let l=s/this._samplesPerXysFile|0,c=u/this._samplesPerXysFile|0,f=[];for(let h=l;h<=c;++h)f.push(hO(this,h));return Promise.all(f)};dO.prototype.computeXysRadians=function(e,t,n){let r=fO(this,e,t);if(r<0)return;let o=r/this._stepSizeDays|0;if(o>=this._totalSamples)return;let a=this._interpolationOrder,s=o-(a/2|0);s<0&&(s=0);let u=s+a;u>=this._totalSamples&&(u=this._totalSamples-1,s=u-a,s<0&&(s=0));let l=!1,c=this._samples;if(_(c[s*3])||(hO(this,s/this._samplesPerXysFile|0),l=!0),_(c[u*3])||(hO(this,u/this._samplesPerXysFile|0),l=!0),l)return;_(n)?(n.x=0,n.y=0,n.s=0):n=new Ob(0,0,0);let f=r-s*this._stepSizeDays,h=this._work,d=this._denominators,p=this._coef,g=this._xTable,y,v;for(y=0;y<=a;++y)h[y]=f-g[y];for(y=0;y<=a;++y){for(p[y]=1,v=0;v<=a;++v)v!==y&&(p[y]*=h[v]);p[y]*=d[y];let w=(s+y)*3;n.x+=p[y]*c[w++],n.y+=p[y]*c[w++],n.s+=p[y]*c[w]}return n};function hO(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n,r=e._xysFileUrlTemplate;_(r)?n=r.getDerivedResource({templateValues:{0:t}}):n=new _t({url:Pa(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});let o=n.fetchJson().then(function(a){e._chunkDownloadsInProgress[t]=!1;let s=e._samples,u=a.samples,l=t*e._samplesPerXysFile*3;for(let c=0,f=u.length;c<f;++c)s[l+c]=u[c]});return e._chunkDownloadsInProgress[t]=o,o}var Bk=dO;function be(e,t,n,r){this.x=T(e,0),this.y=T(t,0),this.z=T(n,0),this.w=T(r,0)}var Gw=new x;be.fromAxisAngle=function(e,t,n){let r=t/2,o=Math.sin(r);Gw=x.normalize(e,Gw);let a=Gw.x*o,s=Gw.y*o,u=Gw.z*o,l=Math.cos(r);return _(n)?(n.x=a,n.y=s,n.z=u,n.w=l,n):new be(a,s,u,l)};var rse=[1,2,0],ise=new Array(3);be.fromRotationMatrix=function(e,t){let n,r,o,a,s,u=e[ne.COLUMN0ROW0],l=e[ne.COLUMN1ROW1],c=e[ne.COLUMN2ROW2],f=u+l+c;if(f>0)n=Math.sqrt(f+1),s=.5*n,n=.5/n,r=(e[ne.COLUMN1ROW2]-e[ne.COLUMN2ROW1])*n,o=(e[ne.COLUMN2ROW0]-e[ne.COLUMN0ROW2])*n,a=(e[ne.COLUMN0ROW1]-e[ne.COLUMN1ROW0])*n;else{let h=rse,d=0;l>u&&(d=1),c>u&&c>l&&(d=2);let p=h[d],g=h[p];n=Math.sqrt(e[ne.getElementIndex(d,d)]-e[ne.getElementIndex(p,p)]-e[ne.getElementIndex(g,g)]+1);let y=ise;y[d]=.5*n,n=.5/n,s=(e[ne.getElementIndex(g,p)]-e[ne.getElementIndex(p,g)])*n,y[p]=(e[ne.getElementIndex(p,d)]+e[ne.getElementIndex(d,p)])*n,y[g]=(e[ne.getElementIndex(g,d)]+e[ne.getElementIndex(d,g)])*n,r=-y[0],o=-y[1],a=-y[2]}return _(t)?(t.x=r,t.y=o,t.z=a,t.w=s,t):new be(r,o,a,s)};var Fk=new be,zk=new be,pO=new be,Vk=new be;be.fromHeadingPitchRoll=function(e,t){return Vk=be.fromAxisAngle(x.UNIT_X,e.roll,Fk),pO=be.fromAxisAngle(x.UNIT_Y,-e.pitch,t),t=be.multiply(pO,Vk,pO),zk=be.fromAxisAngle(x.UNIT_Z,-e.heading,Fk),be.multiply(zk,t,t)};var Nb=new x,mO=new x,jh=new be,kk=new be,Bb=new be;be.packedLength=4;be.pack=function(e,t,n){return n=T(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t};be.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new be),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n};be.packedInterpolationLength=3;be.convertPackedArrayForInterpolation=function(e,t,n,r){be.unpack(e,n*4,Bb),be.conjugate(Bb,Bb);for(let o=0,a=n-t+1;o<a;o++){let s=o*3;be.unpack(e,(t+o)*4,jh),be.multiply(jh,Bb,jh),jh.w<0&&be.negate(jh,jh),be.computeAxis(jh,Nb);let u=be.computeAngle(jh);_(r)||(r=[]),r[s]=Nb.x*u,r[s+1]=Nb.y*u,r[s+2]=Nb.z*u}};be.unpackInterpolationResult=function(e,t,n,r,o){_(o)||(o=new be),x.fromArray(e,0,mO);let a=x.magnitude(mO);return be.unpack(t,r*4,kk),a===0?be.clone(be.IDENTITY,jh):be.fromAxisAngle(mO,a,jh),be.multiply(jh,kk,o)};be.clone=function(e,t){if(!!_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new be(e.x,e.y,e.z,e.w)};be.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t};be.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w};be.magnitude=function(e){return Math.sqrt(be.magnitudeSquared(e))};be.normalize=function(e,t){let n=1/be.magnitude(e),r=e.x*n,o=e.y*n,a=e.z*n,s=e.w*n;return t.x=r,t.y=o,t.z=a,t.w=s,t};be.inverse=function(e,t){let n=be.magnitudeSquared(e);return t=be.conjugate(e,t),be.multiplyByScalar(t,1/n,t)};be.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n};be.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n};be.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t};be.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w};be.multiply=function(e,t,n){let r=e.x,o=e.y,a=e.z,s=e.w,u=t.x,l=t.y,c=t.z,f=t.w,h=s*u+r*f+o*c-a*l,d=s*l-r*c+o*f+a*u,p=s*c+r*l-o*u+a*f,g=s*f-r*u-o*l-a*c;return n.x=h,n.y=d,n.z=p,n.w=g,n};be.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n};be.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n};be.computeAxis=function(e,t){let n=e.w;if(Math.abs(n-1)<z.EPSILON6)return t.x=t.y=t.z=0,t;let r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t};be.computeAngle=function(e){return Math.abs(e.w-1)<z.EPSILON6?0:2*Math.acos(e.w)};var gO=new be;be.lerp=function(e,t,n,r){return gO=be.multiplyByScalar(t,n,gO),r=be.multiplyByScalar(e,1-n,r),be.add(gO,r,r)};var Gk=new be,_O=new be,yO=new be;be.slerp=function(e,t,n,r){let o=be.dot(e,t),a=t;if(o<0&&(o=-o,a=Gk=be.negate(t,Gk)),1-o<z.EPSILON6)return be.lerp(e,a,n,r);let s=Math.acos(o);return _O=be.multiplyByScalar(e,Math.sin((1-n)*s),_O),yO=be.multiplyByScalar(a,Math.sin(n*s),yO),r=be.add(_O,yO,r),be.multiplyByScalar(r,1/Math.sin(s),r)};be.log=function(e,t){let n=z.acosClamped(e.w),r=0;return n!==0&&(r=n/Math.sin(n)),x.multiplyByScalar(e,r,t)};be.exp=function(e,t){let n=x.magnitude(e),r=0;return n!==0&&(r=Math.sin(n)/n),t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t.w=Math.cos(n),t};var ose=new x,ase=new x,Uw=new be,tC=new be;be.computeInnerQuadrangle=function(e,t,n,r){let o=be.conjugate(t,Uw);be.multiply(o,n,tC);let a=be.log(tC,ose);be.multiply(o,e,tC);let s=be.log(tC,ase);return x.add(a,s,a),x.multiplyByScalar(a,.25,a),x.negate(a,a),be.exp(a,Uw),be.multiply(t,Uw,r)};be.squad=function(e,t,n,r,o,a){let s=be.slerp(e,t,o,Uw),u=be.slerp(n,r,o,tC);return be.slerp(s,u,2*o*(1-o),a)};var sse=new be,Uk=1.9011074535173003,Fb=Qo.supportsTypedArrays()?new Float32Array(8):[],zb=Qo.supportsTypedArrays()?new Float32Array(8):[],gm=Qo.supportsTypedArrays()?new Float32Array(8):[],_m=Qo.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){let t=e+1,n=2*t+1;Fb[e]=1/(t*n),zb[e]=t/n}Fb[7]=Uk/(8*17);zb[7]=Uk*8/17;be.fastSlerp=function(e,t,n,r){let o=be.dot(e,t),a;o>=0?a=1:(a=-1,o=-o);let s=o-1,u=1-n,l=n*n,c=u*u;for(let p=7;p>=0;--p)gm[p]=(Fb[p]*l-zb[p])*s,_m[p]=(Fb[p]*c-zb[p])*s;let f=a*n*(1+gm[0]*(1+gm[1]*(1+gm[2]*(1+gm[3]*(1+gm[4]*(1+gm[5]*(1+gm[6]*(1+gm[7])))))))),h=u*(1+_m[0]*(1+_m[1]*(1+_m[2]*(1+_m[3]*(1+_m[4]*(1+_m[5]*(1+_m[6]*(1+_m[7])))))))),d=be.multiplyByScalar(e,h,sse);return be.multiplyByScalar(t,f,r),be.add(d,r,r)};be.fastSquad=function(e,t,n,r,o,a){let s=be.fastSlerp(e,t,o,Uw),u=be.fastSlerp(n,r,o,tC);return be.fastSlerp(s,u,2*o*(1-o),a)};be.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w};be.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n};be.ZERO=Object.freeze(new be(0,0,0,0));be.IDENTITY=Object.freeze(new be(0,0,0,1));be.prototype.clone=function(e){return be.clone(this,e)};be.prototype.equals=function(e){return be.equals(this,e)};be.prototype.equalsEpsilon=function(e,t){return be.equalsEpsilon(this,e,t)};be.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var je=be;var $r={},vO={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},nC={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},CO={},fc={east:new x,north:new x,up:new x,west:new x,south:new x,down:new x},Hg=new x,qg=new x,Wg=new x;$r.localFrameToFixedFrameGenerator=function(e,t){if(!vO.hasOwnProperty(e)||!vO[e].hasOwnProperty(t))throw new Le("firstAxis and secondAxis must be east, north, up, west, south or down.");let n=vO[e][t],r,o=e+t;return _(CO[o])?r=CO[o]:(r=function(a,s,u){if(_(u)||(u=new U),x.equalsEpsilon(a,x.ZERO,z.EPSILON14))x.unpack(nC[e],0,Hg),x.unpack(nC[t],0,qg),x.unpack(nC[n],0,Wg);else if(z.equalsEpsilon(a.x,0,z.EPSILON14)&&z.equalsEpsilon(a.y,0,z.EPSILON14)){let l=z.sign(a.z);x.unpack(nC[e],0,Hg),e!=="east"&&e!=="west"&&x.multiplyByScalar(Hg,l,Hg),x.unpack(nC[t],0,qg),t!=="east"&&t!=="west"&&x.multiplyByScalar(qg,l,qg),x.unpack(nC[n],0,Wg),n!=="east"&&n!=="west"&&x.multiplyByScalar(Wg,l,Wg)}else{s=T(s,Ge.WGS84),s.geodeticSurfaceNormal(a,fc.up);let l=fc.up,c=fc.east;c.x=-a.y,c.y=a.x,c.z=0,x.normalize(c,fc.east),x.cross(l,c,fc.north),x.multiplyByScalar(fc.up,-1,fc.down),x.multiplyByScalar(fc.east,-1,fc.west),x.multiplyByScalar(fc.north,-1,fc.south),Hg=fc[e],qg=fc[t],Wg=fc[n]}return u[0]=Hg.x,u[1]=Hg.y,u[2]=Hg.z,u[3]=0,u[4]=qg.x,u[5]=qg.y,u[6]=qg.z,u[7]=0,u[8]=Wg.x,u[9]=Wg.y,u[10]=Wg.z,u[11]=0,u[12]=a.x,u[13]=a.y,u[14]=a.z,u[15]=1,u},CO[o]=r),r};$r.eastNorthUpToFixedFrame=$r.localFrameToFixedFrameGenerator("east","north");$r.northEastDownToFixedFrame=$r.localFrameToFixedFrameGenerator("north","east");$r.northUpEastToFixedFrame=$r.localFrameToFixedFrameGenerator("north","up");$r.northWestUpToFixedFrame=$r.localFrameToFixedFrameGenerator("north","west");var use=new je,lse=new x(1,1,1),cse=new U;$r.headingPitchRollToFixedFrame=function(e,t,n,r,o){r=T(r,$r.eastNorthUpToFixedFrame);let a=je.fromHeadingPitchRoll(t,use),s=U.fromTranslationQuaternionRotationScale(x.ZERO,a,lse,cse);return o=r(e,n,o),U.multiply(o,s,o)};var fse=new U,hse=new ne;$r.headingPitchRollQuaternion=function(e,t,n,r,o){let a=$r.headingPitchRollToFixedFrame(e,t,n,r,fse),s=U.getMatrix3(a,hse);return je.fromRotationMatrix(s,o)};var dse=new x(1,1,1),pse=new x,Hk=new U,mse=new U,gse=new ne,_se=new je;$r.fixedFrameToHeadingPitchRoll=function(e,t,n,r){t=T(t,Ge.WGS84),n=T(n,$r.eastNorthUpToFixedFrame),_(r)||(r=new Fc);let o=U.getTranslation(e,pse);if(x.equals(o,x.ZERO))return r.heading=0,r.pitch=0,r.roll=0,r;let a=U.inverseTransformation(n(o,t,Hk),Hk),s=U.setScale(e,dse,mse);s=U.setTranslation(s,x.ZERO,s),a=U.multiply(a,s,a);let u=je.fromRotationMatrix(U.getMatrix3(a,gse),_se);return u=je.normalize(u,u),Fc.fromQuaternion(u,r)};var yse=6*3600+41*60+50.54841,vse=8640184812866e-6,Cse=.093104,xse=-62e-7,wse=11772758384668e-32,Ese=72921158553e-15,Tse=z.TWO_PI/86400,Vb=new fe;$r.computeTemeToPseudoFixedMatrix=function(e,t){Vb=fe.addSeconds(e,-fe.computeTaiMinusUtc(e),Vb);let n=Vb.dayNumber,r=Vb.secondsOfDay,o,a=n-2451545;r>=43200?o=(a+.5)/po.DAYS_PER_JULIAN_CENTURY:o=(a-.5)/po.DAYS_PER_JULIAN_CENTURY;let u=(yse+o*(vse+o*(Cse+o*xse)))*Tse%z.TWO_PI,l=Ese+wse*(n-24515455e-1),c=(r+po.SECONDS_PER_DAY*.5)%po.SECONDS_PER_DAY,f=u+l*c,h=Math.cos(f),d=Math.sin(f);return _(t)?(t[0]=h,t[1]=-d,t[2]=0,t[3]=d,t[4]=h,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ne(h,d,0,-d,h,0,0,0,1)};$r.iau2006XysData=new Bk;$r.earthOrientationParameters=Nk.NONE;var EO=32.184,Sse=2451545;$r.preloadIcrfFixed=function(e){let t=e.start.dayNumber,n=e.start.secondsOfDay+EO,r=e.stop.dayNumber,o=e.stop.secondsOfDay+EO,a=$r.iau2006XysData.preload(t,n,r,o),s=$r.earthOrientationParameters.getPromiseToLoad();return Promise.all([a,s])};$r.computeIcrfToFixedMatrix=function(e,t){_(t)||(t=new ne);let n=$r.computeFixedToIcrfMatrix(e,t);if(!!_(n))return ne.transpose(n,t)};var Ase=new Ob(0,0,0),bse=new Vw(0,0,0,0,0,0),xO=new ne,wO=new ne;$r.computeFixedToIcrfMatrix=function(e,t){_(t)||(t=new ne);let n=$r.earthOrientationParameters.compute(e,bse);if(!_(n))return;let r=e.dayNumber,o=e.secondsOfDay+EO,a=$r.iau2006XysData.computeXysRadians(r,o,Ase);if(!_(a))return;let s=a.x+n.xPoleOffset,u=a.y+n.yPoleOffset,l=1/(1+Math.sqrt(1-s*s-u*u)),c=xO;c[0]=1-l*s*s,c[3]=-l*s*u,c[6]=s,c[1]=-l*s*u,c[4]=1-l*u*u,c[7]=u,c[2]=-s,c[5]=-u,c[8]=1-l*(s*s+u*u);let f=ne.fromRotationZ(-a.s,wO),h=ne.multiply(c,f,xO),d=e.dayNumber,p=e.secondsOfDay-fe.computeTaiMinusUtc(e)+n.ut1MinusUtc,g=d-2451545,y=p/po.SECONDS_PER_DAY,v=.779057273264+y+.00273781191135448*(g+y);v=v%1*z.TWO_PI;let w=ne.fromRotationZ(v,wO),C=ne.multiply(h,w,xO),E=Math.cos(n.xPoleWander),S=Math.cos(n.yPoleWander),A=Math.sin(n.xPoleWander),D=Math.sin(n.yPoleWander),P=r-Sse+o/po.SECONDS_PER_DAY;P/=36525;let M=-47e-6*P*z.RADIANS_PER_DEGREE/3600,I=Math.cos(M),O=Math.sin(M),m=wO;return m[0]=E*I,m[1]=E*O,m[2]=A,m[3]=-S*O+D*A*I,m[4]=S*I+D*A*O,m[5]=-D*E,m[6]=-D*O-S*A*I,m[7]=D*I-S*A*O,m[8]=S*E,ne.multiply(C,m,t)};var Ise=new Se;$r.pointToWindowCoordinates=function(e,t,n,r){return r=$r.pointToGLWindowCoordinates(e,t,n,r),r.y=2*t[5]-r.y,r};$r.pointToGLWindowCoordinates=function(e,t,n,r){_(r)||(r=new X);let o=Ise;return U.multiplyByVector(e,Se.fromElements(n.x,n.y,n.z,1,o),o),Se.multiplyByScalar(o,1/o.w,o),U.multiplyByVector(t,o,o),X.fromCartesian4(o,r)};var Dse=new x,Pse=new x,Mse=new x;$r.rotationMatrixFromPositionVelocity=function(e,t,n,r){let o=T(n,Ge.WGS84).geodeticSurfaceNormal(e,Dse),a=x.cross(t,o,Pse);x.equalsEpsilon(a,x.ZERO,z.EPSILON6)&&(a=x.clone(x.UNIT_X,a));let s=x.cross(a,t,Mse);return x.normalize(s,s),x.cross(t,s,a),x.negate(a,a),x.normalize(a,a),_(r)||(r=new ne),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=a.x,r[4]=a.y,r[5]=a.z,r[6]=s.x,r[7]=s.y,r[8]=s.z,r};var qk=new U(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),Wk=new ce,Yk=new x,Lse=new x,Rse=new ne,TO=new U,Xk=new U;$r.basisTo2D=function(e,t,n){let r=U.getTranslation(t,Lse),o=e.ellipsoid,a=o.cartesianToCartographic(r,Wk),s=e.project(a,Yk);x.fromElements(s.z,s.x,s.y,s);let u=$r.eastNorthUpToFixedFrame(r,o,TO),l=U.inverseTransformation(u,Xk),c=U.getMatrix3(t,Rse),f=U.multiplyByMatrix3(l,c,n);return U.multiply(qk,f,n),U.setTranslation(n,s,n),n};$r.wgs84To2DModelMatrix=function(e,t,n){let r=e.ellipsoid,o=$r.eastNorthUpToFixedFrame(t,r,TO),a=U.inverseTransformation(o,Xk),s=r.cartesianToCartographic(t,Wk),u=e.project(s,Yk);x.fromElements(u.z,u.x,u.y,u);let l=U.fromTranslation(u,TO);return U.multiply(qk,a,n),U.multiply(l,n,n),n};var yn=$r;var bu={},Ose=new Se(0,0,0,1),$u=new Se,Nse=new en,SO=new X,AO=new X;bu.wgs84ToWindowCoordinates=function(e,t,n){return bu.wgs84WithEyeOffsetToWindowCoordinates(e,t,x.ZERO,n)};var jk=new Se,Kk=new x;function Hw(e,t,n,r){let o=n.viewMatrix,a=U.multiplyByVector(o,Se.fromElements(e.x,e.y,e.z,1,jk),jk),s=x.multiplyComponents(t,x.normalize(a,Kk),Kk);return a.x+=t.x+s.x,a.y+=t.y+s.y,a.z+=s.z,U.multiplyByVector(n.frustum.projectionMatrix,a,r)}var Bse=new ce(Math.PI,z.PI_OVER_TWO),Fse=new x,zse=new x;bu.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,n,r){let o=e.frameState,a=bu.computeActualWgs84Position(o,t,Ose);if(!_(a))return;let s=e.canvas,u=Nse;u.x=0,u.y=0,u.width=s.clientWidth,u.height=s.clientHeight;let l=e.camera,c=!1;if(o.mode===Ne.SCENE2D){let f=e.mapProjection,h=Bse,d=f.project(h,Fse),p=x.clone(l.position,zse),g=l.frustum.clone(),y=U.computeViewportTransformation(u,0,1,new U),v=l.frustum.projectionMatrix,w=l.positionWC.y,C=x.fromElements(z.sign(w)*d.x-w,0,-l.positionWC.x),E=yn.pointToGLWindowCoordinates(v,y,C);if(w===0||E.x<=0||E.x>=s.clientWidth)c=!0;else{if(E.x>s.clientWidth*.5){u.width=E.x,l.frustum.right=d.x-w,$u=Hw(a,n,l,$u),bu.clipToGLWindowCoordinates(u,$u,SO),u.x+=E.x,l.position.x=-l.position.x;let S=l.frustum.right;l.frustum.right=-l.frustum.left,l.frustum.left=-S,$u=Hw(a,n,l,$u),bu.clipToGLWindowCoordinates(u,$u,AO)}else{u.x+=E.x,u.width-=E.x,l.frustum.left=-d.x-w,$u=Hw(a,n,l,$u),bu.clipToGLWindowCoordinates(u,$u,SO),u.x=u.x-u.width,l.position.x=-l.position.x;let S=l.frustum.left;l.frustum.left=-l.frustum.right,l.frustum.right=-S,$u=Hw(a,n,l,$u),bu.clipToGLWindowCoordinates(u,$u,AO)}x.clone(p,l.position),l.frustum=g.clone(),r=X.clone(SO,r),(r.x<0||r.x>s.clientWidth)&&(r.x=AO.x)}}if(o.mode!==Ne.SCENE2D||c){if($u=Hw(a,n,l,$u),$u.z<0&&!(l.frustum instanceof Pk)&&!(l.frustum instanceof Pb))return;r=bu.clipToGLWindowCoordinates(u,$u,r)}return r.y=s.clientHeight-r.y,r};bu.wgs84ToDrawingBufferCoordinates=function(e,t,n){if(n=bu.wgs84ToWindowCoordinates(e,t,n),!!_(n))return bu.transformWindowToDrawingBuffer(e,n,n)};var ym=new x,Vse=new ce;bu.computeActualWgs84Position=function(e,t,n){let r=e.mode;if(r===Ne.SCENE3D)return x.clone(t,n);let o=e.mapProjection,a=o.ellipsoid.cartesianToCartographic(t,Vse);if(!_(a))return;if(o.project(a,ym),r===Ne.COLUMBUS_VIEW)return x.fromElements(ym.z,ym.x,ym.y,n);if(r===Ne.SCENE2D)return x.fromElements(0,ym.x,ym.y,n);let s=e.morphTime;return x.fromElements(z.lerp(ym.z,t.x,s),z.lerp(ym.x,t.y,s),z.lerp(ym.y,t.z,s),n)};var Zk=new x,Qk=new x,Jk=new U;bu.clipToGLWindowCoordinates=function(e,t,n){return x.divideByScalar(t,t.w,Zk),U.computeViewportTransformation(e,0,1,Jk),U.multiplyByPoint(Jk,Zk,Qk),X.fromCartesian3(Qk,n)};bu.transformWindowToDrawingBuffer=function(e,t,n){let r=e.canvas,o=e.drawingBufferWidth/r.clientWidth,a=e.drawingBufferHeight/r.clientHeight;return X.fromElements(t.x*o,t.y*a,n)};var kse=new Se,$k=new Se;bu.drawingBufferToWgs84Coordinates=function(e,t,n,r){let a=e.context.uniformState,s=a.currentFrustum,u=s.x,l=s.y;if(e.frameState.useLogDepth){let p=n*a.log2FarDepthFromNearPlusOne,g=Math.pow(2,p)-1;n=l*(1-u/(g+u))/(l-u)}let c=e.view.passState.viewport,f=Se.clone(Se.UNIT_W,kse);f.x=(t.x-c.x)/c.width*2-1,f.y=(t.y-c.y)/c.height*2-1,f.z=n*2-1,f.w=1;let h,d=e.camera.frustum;if(!_(d.fovy))_(d._offCenterFrustum)&&(d=d._offCenterFrustum),h=$k,h.x=(f.x*(d.right-d.left)+d.left+d.right)*.5,h.y=(f.y*(d.top-d.bottom)+d.bottom+d.top)*.5,h.z=(f.z*(u-l)-u-l)*.5,h.w=1,h=U.multiplyByVector(a.inverseView,h,h);else{h=U.multiplyByVector(a.inverseViewProjection,f,$k);let p=1/h.w;x.multiplyByScalar(h,p,h)}return x.fromCartesian4(h,r)};var Mf=bu;var Gse={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1},an=Object.freeze(Gse);function An(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;_(n)&&(n=Tt.clone(n)),_(r)&&(r=Tt.clone(r)),_(o)&&(o=Tt.clone(o)),_(a)&&(a=gn.clone(a)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._translate=new X(0,0),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._heightReference=T(e.heightReference,Pt.NONE),this._verticalOrigin=T(e.verticalOrigin,an.CENTER),this._horizontalOrigin=T(e.horizontalOrigin,ho.CENTER),this._scale=T(e.scale,1),this._color=K.clone(T(e.color,K.WHITE)),this._rotation=T(e.rotation,0),this._alignedAxis=x.clone(T(e.alignedAxis,x.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=o,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._sizeInMeters=T(e.sizeInMeters,!1),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=T(e.collection,t),this._pickId=void 0,this._pickPrimitive=T(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;let s=e.image,u=e.imageId;_(s)&&(_(u)||(typeof s=="string"?u=s:_(s.src)?u=s.src:u=_i()),this._imageId=u,this._image=s),_(e.imageSubRegion)&&(this._imageId=u,this._imageSubRegion=e.imageSubRegion),_(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=Ne.SCENE3D,this._clusterShow=!0,this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,0),this._animation=T(e.animation,!1),this._updateClamping()}var e5=An.SHOW_INDEX=0,Gb=An.POSITION_INDEX=1,o5=An.PIXEL_OFFSET_INDEX=2,Use=An.EYE_OFFSET_INDEX=3,Hse=An.HORIZONTAL_ORIGIN_INDEX=4,qse=An.VERTICAL_ORIGIN_INDEX=5,Wse=An.SCALE_INDEX=6,Ub=An.IMAGE_INDEX_INDEX=7,t5=An.COLOR_INDEX=8,Yse=An.ROTATION_INDEX=9,Xse=An.ALIGNED_AXIS_INDEX=10,jse=An.SCALE_BY_DISTANCE_INDEX=11,Kse=An.TRANSLUCENCY_BY_DISTANCE_INDEX=12,Zse=An.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,Qse=An.DISTANCE_DISPLAY_CONDITION=14,Jse=An.DISABLE_DEPTH_DISTANCE=15;An.TEXTURE_COORDINATE_BOUNDS=16;var n5=An.SDF_INDEX=17;An.NUMBER_OF_PROPERTIES=18;function mo(e,t){let n=e._billboardCollection;_(n)&&(n._updateBillboard(e,t),e._dirty=!0)}Object.defineProperties(An.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,mo(this,e5))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),this._updateClamping(),mo(this,Gb))}},heightReference:{get:function(){return this._heightReference},set:function(e){let t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),mo(this,Gb))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;X.equals(t,e)||(X.clone(e,t),mo(this,o5))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;Tt.equals(t,e)||(this._scaleByDistance=Tt.clone(e,t),mo(this,jse))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;Tt.equals(t,e)||(this._translucencyByDistance=Tt.clone(e,t),mo(this,Kse))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;Tt.equals(t,e)||(this._pixelOffsetScaleByDistance=Tt.clone(e,t),mo(this,Zse))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;x.equals(t,e)||(x.clone(e,t),mo(this,Use))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,mo(this,Hse))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,mo(this,qse))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,mo(this,Wse))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),mo(this,t5))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,mo(this,Yse))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;x.equals(t,e)||(x.clone(e,t),mo(this,Xse))}},width:{get:function(){return T(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,mo(this,Ub))}},height:{get:function(){return T(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,mo(this,Ub))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,mo(this,t5))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){gn.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=gn.clone(e,this._distanceDisplayCondition),mo(this,Qse))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,mo(this,Jse))}},id:{get:function(){return this._id},set:function(e){this._id=e,_(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,_(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){_(e)?typeof e=="string"?this.setImage(e,e):e instanceof _t?this.setImage(e.url,e):_(e.src)?this.setImage(e.src,e):this.setImage(_i(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,mo(this,Ub))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition),mo(this,Gb)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,mo(this,e5))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),mo(this,n5))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,mo(this,n5))}},animation:{get:function(){return this._animation},set:function(e){this._animation!==e&&(this._animation=e)}}});An.prototype.getPickId=function(e){return _(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};An.prototype._updateClamping=function(){An._updateClamping(this._billboardCollection,this)};var qw=new ce,r5=new x;An._updateClamping=function(e,t){let n=e._scene;if(!_(n)||!_(n.globe))return;let r=n.globe,o=r.ellipsoid,a=r._surface,s=n.frameState.mode,u=s!==t._mode;if(t._mode=s,(t._heightReference===Pt.NONE||u)&&_(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===Pt.NONE||!_(t._position))return;let l=o.cartesianToCartographic(t._position);if(!_(l)){t._actualClampedPosition=void 0;return}_(t._removeCallbackFunc)&&t._removeCallbackFunc();function c(h){if(t._heightReference===Pt.RELATIVE_TO_GROUND)if(t._mode===Ne.SCENE3D){let d=o.cartesianToCartographic(h,qw);d.height+=l.height,o.cartographicToCartesian(d,h)}else h.x+=l.height;t._clampedPosition=x.clone(h,t._clampedPosition)}t._removeCallbackFunc=a.updateHeight(l,c),ce.clone(l,qw);let f=r.getHeight(l);_(f)&&(qw.height=f),o.cartographicToCartesian(qw,r5),c(r5)};An.prototype._loadImage=function(){let e=this._billboardCollection._textureAtlas,t=this._imageId,n=this._image,r=this._imageSubRegion,o,a=this;function s(u){if(a._imageId!==t||a._image!==n||!en.equals(a._imageSubRegion,r))return;let l=e.textureCoordinates[u];a._imageWidth=e.texture.width*l.width,a._imageHeight=e.texture.height*l.height,a._imageIndex=u,a._ready=!0,a._imageIndexPromise=void 0,mo(a,Ub)}if(_(n)){let u=e.getImageIndex(t);if(_(u)){s(u);return}o=e.addImage(t,n)}_(r)&&(o=e.addSubRegion(t,r)),this._imageIndexPromise=o,_(o)&&o.then(s).catch(function(u){console.error(`Error loading image for billboard: ${u}`),a._imageIndexPromise=void 0})};An.prototype._updateImage=function(){this._billboardCollection._textureAtlas.updateImage(this._imageIndex,this._image)};An.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,_(this._billboardCollection._textureAtlas)&&this._loadImage())};An.prototype.setImageSubRegion=function(e,t){this._imageId===e&&en.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=en.clone(t),_(this._billboardCollection._textureAtlas)&&this._loadImage())};An.prototype._setTranslate=function(e){let t=this._translate;X.equals(t,e)||(X.clone(e,t),mo(this,o5))};An.prototype._getActualPosition=function(){return _(this._clampedPosition)?this._clampedPosition:this._actualPosition};An.prototype._setActualPosition=function(e){_(this._clampedPosition)||x.clone(e,this._actualPosition),mo(this,Gb)};var i5=new Se;An._computeActualPosition=function(e,t,n,r){return _(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===Ne.SCENE3D?t:(U.multiplyByPoint(r,t,i5),Mf.computeActualWgs84Position(n,i5))};var a5=new x;An._computeScreenSpacePosition=function(e,t,n,r,o,a){let s=U.multiplyByPoint(e,t,a5),u=Mf.wgs84WithEyeOffsetToWindowCoordinates(o,s,n,a);if(!!_(u))return X.add(u,r,u),u};var kb=new X(0,0);An.prototype.computeScreenSpacePosition=function(e,t){let n=this._billboardCollection;_(t)||(t=new X),X.clone(this._pixelOffset,kb),X.add(kb,this._translate,kb);let r=n.modelMatrix,o=this._position;if(_(this._clampedPosition)&&(o=this._clampedPosition,e.mode!==Ne.SCENE3D)){let s=e.mapProjection,u=s.ellipsoid,l=s.unproject(o,qw);o=u.cartographicToCartesian(l,a5),r=U.IDENTITY}return An._computeScreenSpacePosition(r,o,this._eyeOffset,kb,e,t)};An.getScreenSpaceBoundingBox=function(e,t,n){let r=e.width,o=e.height,a=e.scale;r*=a,o*=a;let s=t.x;e.horizontalOrigin===ho.RIGHT?s-=r:e.horizontalOrigin===ho.CENTER&&(s-=r*.5);let u=t.y;return e.verticalOrigin===an.BOTTOM||e.verticalOrigin===an.BASELINE?u-=o:e.verticalOrigin===an.CENTER&&(u-=o*.5),_(n)||(n=new en),n.x=s,n.y=u,n.width=r,n.height=o,n};An.prototype.equals=function(e){return this===e||_(e)&&this._id===e._id&&x.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&en.equals(this._imageSubRegion,e._imageSubRegion)&&K.equals(this._color,e._color)&&X.equals(this._pixelOffset,e._pixelOffset)&&X.equals(this._translate,e._translate)&&x.equals(this._eyeOffset,e._eyeOffset)&&Tt.equals(this._scaleByDistance,e._scaleByDistance)&&Tt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Tt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&gn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};An.prototype._destroy=function(){_(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),_(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var Xi=An;var $se={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},V=Object.freeze($se);var Ot={BYTE:V.BYTE,UNSIGNED_BYTE:V.UNSIGNED_BYTE,SHORT:V.SHORT,UNSIGNED_SHORT:V.UNSIGNED_SHORT,INT:V.INT,UNSIGNED_INT:V.UNSIGNED_INT,FLOAT:V.FLOAT,DOUBLE:V.DOUBLE};Ot.getSizeInBytes=function(e){switch(e){case Ot.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Ot.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Ot.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Ot.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Ot.INT:return Int32Array.BYTES_PER_ELEMENT;case Ot.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Ot.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Ot.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}};Ot.fromTypedArray=function(e){if(e instanceof Int8Array)return Ot.BYTE;if(e instanceof Uint8Array)return Ot.UNSIGNED_BYTE;if(e instanceof Int16Array)return Ot.SHORT;if(e instanceof Uint16Array)return Ot.UNSIGNED_SHORT;if(e instanceof Int32Array)return Ot.INT;if(e instanceof Uint32Array)return Ot.UNSIGNED_INT;if(e instanceof Float32Array)return Ot.FLOAT;if(e instanceof Float64Array)return Ot.DOUBLE};Ot.validate=function(e){return _(e)&&(e===Ot.BYTE||e===Ot.UNSIGNED_BYTE||e===Ot.SHORT||e===Ot.UNSIGNED_SHORT||e===Ot.INT||e===Ot.UNSIGNED_INT||e===Ot.FLOAT||e===Ot.DOUBLE)};Ot.createTypedArray=function(e,t){switch(e){case Ot.BYTE:return new Int8Array(t);case Ot.UNSIGNED_BYTE:return new Uint8Array(t);case Ot.SHORT:return new Int16Array(t);case Ot.UNSIGNED_SHORT:return new Uint16Array(t);case Ot.INT:return new Int32Array(t);case Ot.UNSIGNED_INT:return new Uint32Array(t);case Ot.FLOAT:return new Float32Array(t);case Ot.DOUBLE:return new Float64Array(t)}};Ot.createArrayBufferView=function(e,t,n,r){switch(n=T(n,0),r=T(r,(t.byteLength-n)/Ot.getSizeInBytes(e)),e){case Ot.BYTE:return new Int8Array(t,n,r);case Ot.UNSIGNED_BYTE:return new Uint8Array(t,n,r);case Ot.SHORT:return new Int16Array(t,n,r);case Ot.UNSIGNED_SHORT:return new Uint16Array(t,n,r);case Ot.INT:return new Int32Array(t,n,r);case Ot.UNSIGNED_INT:return new Uint32Array(t,n,r);case Ot.FLOAT:return new Float32Array(t,n,r);case Ot.DOUBLE:return new Float64Array(t,n,r)}};Ot.fromName=function(e){switch(e){case"BYTE":return Ot.BYTE;case"UNSIGNED_BYTE":return Ot.UNSIGNED_BYTE;case"SHORT":return Ot.SHORT;case"UNSIGNED_SHORT":return Ot.UNSIGNED_SHORT;case"INT":return Ot.INT;case"UNSIGNED_INT":return Ot.UNSIGNED_INT;case"FLOAT":return Ot.FLOAT;case"DOUBLE":return Ot.DOUBLE}};var ie=Object.freeze(Ot);function $e(e,t,n,r){this[0]=T(e,0),this[1]=T(n,0),this[2]=T(t,0),this[3]=T(r,0)}$e.packedLength=4;$e.pack=function(e,t,n){return n=T(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t};$e.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new $e),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n};$e.packArray=function(e,t){let n=e.length,r=n*4;_(t)?!Array.isArray(t)&&t.length!==r||t.length!==r&&(t.length=r):t=new Array(r);for(let o=0;o<n;++o)$e.pack(e[o],t,o*4);return t};$e.unpackArray=function(e,t){let n=e.length;_(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){let o=r/4;t[o]=$e.unpack(e,r,t[o])}return t};$e.clone=function(e,t){if(!!_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new $e(e[0],e[2],e[1],e[3])};$e.fromArray=$e.unpack;$e.fromColumnMajorArray=function(e,t){return $e.clone(e,t)};$e.fromRowMajorArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new $e(e[0],e[1],e[2],e[3])};$e.fromScale=function(e,t){return _(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new $e(e.x,0,0,e.y)};$e.fromUniformScale=function(e,t){return _(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new $e(e,0,0,e)};$e.fromRotation=function(e,t){let n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t):new $e(n,-r,r,n)};$e.toArray=function(e,t){return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]};$e.getElementIndex=function(e,t){return e*2+t};$e.getColumn=function(e,t,n){let r=t*2,o=e[r],a=e[r+1];return n.x=o,n.y=a,n};$e.setColumn=function(e,t,n,r){r=$e.clone(e,r);let o=t*2;return r[o]=n.x,r[o+1]=n.y,r};$e.getRow=function(e,t,n){let r=e[t],o=e[t+2];return n.x=r,n.y=o,n};$e.setRow=function(e,t,n,r){return r=$e.clone(e,r),r[t]=n.x,r[t+2]=n.y,r};var eue=new X;$e.setScale=function(e,t,n){let r=$e.getScale(e,eue),o=t.x/r.x,a=t.y/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*a,n[3]=e[3]*a,n};var tue=new X;$e.setUniformScale=function(e,t,n){let r=$e.getScale(e,tue),o=t/r.x,a=t/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*a,n[3]=e[3]*a,n};var s5=new X;$e.getScale=function(e,t){return t.x=X.magnitude(X.fromElements(e[0],e[1],s5)),t.y=X.magnitude(X.fromElements(e[2],e[3],s5)),t};var u5=new X;$e.getMaximumScale=function(e){return $e.getScale(e,u5),X.maximumComponent(u5)};var nue=new X;$e.setRotation=function(e,t,n){let r=$e.getScale(e,nue);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.y,n[3]=t[3]*r.y,n};var rue=new X;$e.getRotation=function(e,t){let n=$e.getScale(e,rue);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t};$e.multiply=function(e,t,n){let r=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],a=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=a,n[2]=o,n[3]=s,n};$e.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n};$e.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n};$e.multiplyByVector=function(e,t,n){let r=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=o,n};$e.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};$e.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n};$e.multiplyByUniformScale=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n};$e.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t};$e.transpose=function(e,t){let n=e[0],r=e[2],o=e[1],a=e[3];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t};$e.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t};$e.equals=function(e,t){return e===t||_(e)&&_(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]};$e.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]};$e.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n};$e.IDENTITY=Object.freeze(new $e(1,0,0,1));$e.ZERO=Object.freeze(new $e(0,0,0,0));$e.COLUMN0ROW0=0;$e.COLUMN0ROW1=1;$e.COLUMN1ROW0=2;$e.COLUMN1ROW1=3;Object.defineProperties($e.prototype,{length:{get:function(){return $e.packedLength}}});$e.prototype.clone=function(e){return $e.clone(this,e)};$e.prototype.equals=function(e){return $e.equals(this,e)};$e.prototype.equalsEpsilon=function(e,t){return $e.equalsEpsilon(this,e,t)};$e.prototype.toString=function(){return`(${this[0]}, ${this[2]})
(${this[1]}, ${this[3]})`};var Ma=$e;var yi={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};yi.getMathType=function(e){switch(e){case yi.SCALAR:return Number;case yi.VEC2:return X;case yi.VEC3:return x;case yi.VEC4:return Se;case yi.MAT2:return Ma;case yi.MAT3:return ne;case yi.MAT4:return U}};yi.getNumberOfComponents=function(e){switch(e){case yi.SCALAR:return 1;case yi.VEC2:return 2;case yi.VEC3:return 3;case yi.VEC4:case yi.MAT2:return 4;case yi.MAT3:return 9;case yi.MAT4:return 16}};yi.getAttributeLocationCount=function(e){switch(e){case yi.SCALAR:case yi.VEC2:case yi.VEC3:case yi.VEC4:return 1;case yi.MAT2:return 2;case yi.MAT3:return 3;case yi.MAT4:return 4}};yi.getGlslType=function(e){switch(e){case yi.SCALAR:return"float";case yi.VEC2:return"vec2";case yi.VEC3:return"vec3";case yi.VEC4:return"vec4";case yi.MAT2:return"mat2";case yi.MAT3:return"mat3";case yi.MAT4:return"mat4"}};var zc=Object.freeze(yi);var l5=1/256,c5=256,ji={};ji.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let r=n.x,o=n.y;n.x=(1-Math.abs(o))*z.signNotZero(r),n.y=(1-Math.abs(r))*z.signNotZero(o)}return n.x=z.toSNorm(n.x,t),n.y=z.toSNorm(n.y,t),n};ji.octEncode=function(e,t){return ji.octEncodeInRange(e,255,t)};var Ww=new X,f5=new Uint8Array(1);function Hb(e){return f5[0]=e,f5[0]}ji.octEncodeToCartesian4=function(e,t){return ji.octEncodeInRange(e,65535,Ww),t.x=Hb(Ww.x*l5),t.y=Hb(Ww.x),t.z=Hb(Ww.y*l5),t.w=Hb(Ww.y),t};ji.octDecodeInRange=function(e,t,n,r){if(r.x=z.fromSNorm(e,n),r.y=z.fromSNorm(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){let o=r.x;r.x=(1-Math.abs(r.y))*z.signNotZero(o),r.y=(1-Math.abs(o))*z.signNotZero(r.y)}return x.normalize(r,r)};ji.octDecode=function(e,t,n){return ji.octDecodeInRange(e,t,255,n)};ji.octDecodeFromCartesian4=function(e,t){let n=e.x,r=e.y,o=e.z,a=e.w,s=n*c5+r,u=o*c5+a;return ji.octDecodeInRange(s,u,65535,t)};ji.octPackFloat=function(e){return 256*e.x+e.y};var IO=new X;ji.octEncodeFloat=function(e){return ji.octEncode(e,IO),ji.octPackFloat(IO)};ji.octDecodeFloat=function(e,t){let n=e/256,r=Math.floor(n),o=(n-r)*256;return ji.octDecode(r,o,t)};ji.octPack=function(e,t,n,r){let o=ji.octEncodeFloat(e),a=ji.octEncodeFloat(t),s=ji.octEncode(n,IO);return r.x=65536*s.x+o,r.y=65536*s.y+a,r};ji.octUnpack=function(e,t,n,r){let o=e.x/65536,a=Math.floor(o),s=(o-a)*65536;o=e.y/65536;let u=Math.floor(o),l=(o-u)*65536;ji.octDecodeFloat(s,t),ji.octDecodeFloat(l,n),ji.octDecode(a,u,r)};ji.compressTextureCoordinates=function(e){let t=e.x*4095|0,n=e.y*4095|0;return 4096*t+n};ji.decompressTextureCoordinates=function(e,t){let n=e/4096,r=Math.floor(n);return t.x=r/4095,t.y=(e-r*4096)/4095,t};function bO(e){return e>>1^-(e&1)}ji.zigZagDeltaDecode=function(e,t,n){let r=e.length,o=0,a=0,s=0;for(let u=0;u<r;++u)o+=bO(e[u]),a+=bO(t[u]),e[u]=o,t[u]=a,_(n)&&(s+=bO(n[u]),n[u]=s)};ji.dequantize=function(e,t,n,r){let o=zc.getNumberOfComponents(n),a;switch(t){case ie.BYTE:a=127;break;case ie.UNSIGNED_BYTE:a=255;break;case ie.SHORT:a=32767;break;case ie.UNSIGNED_SHORT:a=65535;break;case ie.INT:a=2147483647;break;case ie.UNSIGNED_INT:a=4294967295;break}let s=new Float32Array(r*o);for(let u=0;u<r;u++)for(let l=0;l<o;l++){let c=u*o+l;s[c]=Math.max(e[c]/a,-1)}return s};ji.decodeRGB565=function(e,t){let n=e.length;_(t)||(t=new Float32Array(n*3));let r=(1<<5)-1,o=(1<<6)-1,a=1/31,s=1/63;for(let u=0;u<n;u++){let l=e[u],c=l>>11,f=l>>5&o,h=l&r,d=3*u;t[d]=c*a,t[d+1]=f*s,t[d+2]=h*a}return t};var ma=ji;function iue(e,t){this.start=T(e,0),this.stop=T(t,0)}var $d=iue;function yt(e,t){this.center=x.clone(T(e,x.ZERO)),this.radius=T(t,0)}var MO=new x,LO=new x,RO=new x,OO=new x,NO=new x,BO=new x,FO=new x,qs=new x,zO=new x,VO=new x,kO=new x,GO=new x,oue=4/3*z.PI;yt.fromPoints=function(e,t){if(_(t)||(t=new yt),!_(e)||e.length===0)return t.center=x.clone(x.ZERO,t.center),t.radius=0,t;let n=x.clone(e[0],FO),r=x.clone(n,MO),o=x.clone(n,LO),a=x.clone(n,RO),s=x.clone(n,OO),u=x.clone(n,NO),l=x.clone(n,BO),c=e.length,f;for(f=1;f<c;f++){x.clone(e[f],n);let M=n.x,I=n.y,O=n.z;M<r.x&&x.clone(n,r),M>s.x&&x.clone(n,s),I<o.y&&x.clone(n,o),I>u.y&&x.clone(n,u),O<a.z&&x.clone(n,a),O>l.z&&x.clone(n,l)}let h=x.magnitudeSquared(x.subtract(s,r,qs)),d=x.magnitudeSquared(x.subtract(u,o,qs)),p=x.magnitudeSquared(x.subtract(l,a,qs)),g=r,y=s,v=h;d>v&&(v=d,g=o,y=u),p>v&&(v=p,g=a,y=l);let w=zO;w.x=(g.x+y.x)*.5,w.y=(g.y+y.y)*.5,w.z=(g.z+y.z)*.5;let C=x.magnitudeSquared(x.subtract(y,w,qs)),E=Math.sqrt(C),S=VO;S.x=r.x,S.y=o.y,S.z=a.z;let A=kO;A.x=s.x,A.y=u.y,A.z=l.z;let D=x.midpoint(S,A,GO),P=0;for(f=0;f<c;f++){x.clone(e[f],n);let M=x.magnitude(x.subtract(n,D,qs));M>P&&(P=M);let I=x.magnitudeSquared(x.subtract(n,w,qs));if(I>C){let O=Math.sqrt(I);E=(E+O)*.5,C=E*E;let m=O-E;w.x=(E*w.x+m*n.x)/O,w.y=(E*w.y+m*n.y)/O,w.z=(E*w.z+m*n.z)/O}}return E<P?(x.clone(w,t.center),t.radius=E):(x.clone(D,t.center),t.radius=P),t};var aue=new uc,sue=new x,uue=new x,DO=new ce,PO=new ce;yt.fromRectangle2D=function(e,t,n){return yt.fromRectangleWithHeights2D(e,t,0,0,n)};yt.fromRectangleWithHeights2D=function(e,t,n,r,o){if(_(o)||(o=new yt),!_(e))return o.center=x.clone(x.ZERO,o.center),o.radius=0,o;t=T(t,aue),ln.southwest(e,DO),DO.height=n,ln.northeast(e,PO),PO.height=r;let a=t.project(DO,sue),s=t.project(PO,uue),u=s.x-a.x,l=s.y-a.y,c=s.z-a.z;o.radius=Math.sqrt(u*u+l*l+c*c)*.5;let f=o.center;return f.x=a.x+u*.5,f.y=a.y+l*.5,f.z=a.z+c*.5,o};var lue=[];yt.fromRectangle3D=function(e,t,n,r){if(t=T(t,Ge.WGS84),n=T(n,0),_(r)||(r=new yt),!_(e))return r.center=x.clone(x.ZERO,r.center),r.radius=0,r;let o=ln.subsample(e,t,n,lue);return yt.fromPoints(o,r)};yt.fromVertices=function(e,t,n,r){if(_(r)||(r=new yt),!_(e)||e.length===0)return r.center=x.clone(x.ZERO,r.center),r.radius=0,r;t=T(t,x.ZERO),n=T(n,3);let o=FO;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;let a=x.clone(o,MO),s=x.clone(o,LO),u=x.clone(o,RO),l=x.clone(o,OO),c=x.clone(o,NO),f=x.clone(o,BO),h=e.length,d;for(d=0;d<h;d+=n){let O=e[d]+t.x,m=e[d+1]+t.y,b=e[d+2]+t.z;o.x=O,o.y=m,o.z=b,O<a.x&&x.clone(o,a),O>l.x&&x.clone(o,l),m<s.y&&x.clone(o,s),m>c.y&&x.clone(o,c),b<u.z&&x.clone(o,u),b>f.z&&x.clone(o,f)}let p=x.magnitudeSquared(x.subtract(l,a,qs)),g=x.magnitudeSquared(x.subtract(c,s,qs)),y=x.magnitudeSquared(x.subtract(f,u,qs)),v=a,w=l,C=p;g>C&&(C=g,v=s,w=c),y>C&&(C=y,v=u,w=f);let E=zO;E.x=(v.x+w.x)*.5,E.y=(v.y+w.y)*.5,E.z=(v.z+w.z)*.5;let S=x.magnitudeSquared(x.subtract(w,E,qs)),A=Math.sqrt(S),D=VO;D.x=a.x,D.y=s.y,D.z=u.z;let P=kO;P.x=l.x,P.y=c.y,P.z=f.z;let M=x.midpoint(D,P,GO),I=0;for(d=0;d<h;d+=n){o.x=e[d]+t.x,o.y=e[d+1]+t.y,o.z=e[d+2]+t.z;let O=x.magnitude(x.subtract(o,M,qs));O>I&&(I=O);let m=x.magnitudeSquared(x.subtract(o,E,qs));if(m>S){let b=Math.sqrt(m);A=(A+b)*.5,S=A*A;let L=b-A;E.x=(A*E.x+L*o.x)/b,E.y=(A*E.y+L*o.y)/b,E.z=(A*E.z+L*o.z)/b}}return A<I?(x.clone(E,r.center),r.radius=A):(x.clone(M,r.center),r.radius=I),r};yt.fromEncodedCartesianVertices=function(e,t,n){if(_(n)||(n=new yt),!_(e)||!_(t)||e.length!==t.length||e.length===0)return n.center=x.clone(x.ZERO,n.center),n.radius=0,n;let r=FO;r.x=e[0]+t[0],r.y=e[1]+t[1],r.z=e[2]+t[2];let o=x.clone(r,MO),a=x.clone(r,LO),s=x.clone(r,RO),u=x.clone(r,OO),l=x.clone(r,NO),c=x.clone(r,BO),f=e.length,h;for(h=0;h<f;h+=3){let I=e[h]+t[h],O=e[h+1]+t[h+1],m=e[h+2]+t[h+2];r.x=I,r.y=O,r.z=m,I<o.x&&x.clone(r,o),I>u.x&&x.clone(r,u),O<a.y&&x.clone(r,a),O>l.y&&x.clone(r,l),m<s.z&&x.clone(r,s),m>c.z&&x.clone(r,c)}let d=x.magnitudeSquared(x.subtract(u,o,qs)),p=x.magnitudeSquared(x.subtract(l,a,qs)),g=x.magnitudeSquared(x.subtract(c,s,qs)),y=o,v=u,w=d;p>w&&(w=p,y=a,v=l),g>w&&(w=g,y=s,v=c);let C=zO;C.x=(y.x+v.x)*.5,C.y=(y.y+v.y)*.5,C.z=(y.z+v.z)*.5;let E=x.magnitudeSquared(x.subtract(v,C,qs)),S=Math.sqrt(E),A=VO;A.x=o.x,A.y=a.y,A.z=s.z;let D=kO;D.x=u.x,D.y=l.y,D.z=c.z;let P=x.midpoint(A,D,GO),M=0;for(h=0;h<f;h+=3){r.x=e[h]+t[h],r.y=e[h+1]+t[h+1],r.z=e[h+2]+t[h+2];let I=x.magnitude(x.subtract(r,P,qs));I>M&&(M=I);let O=x.magnitudeSquared(x.subtract(r,C,qs));if(O>E){let m=Math.sqrt(O);S=(S+m)*.5,E=S*S;let b=m-S;C.x=(S*C.x+b*r.x)/m,C.y=(S*C.y+b*r.y)/m,C.z=(S*C.z+b*r.z)/m}}return S<M?(x.clone(C,n.center),n.radius=S):(x.clone(P,n.center),n.radius=M),n};yt.fromCornerPoints=function(e,t,n){_(n)||(n=new yt);let r=x.midpoint(e,t,n.center);return n.radius=x.distance(r,t),n};yt.fromEllipsoid=function(e,t){return _(t)||(t=new yt),x.clone(x.ZERO,t.center),t.radius=e.maximumRadius,t};var cue=new x;yt.fromBoundingSpheres=function(e,t){if(_(t)||(t=new yt),!_(e)||e.length===0)return t.center=x.clone(x.ZERO,t.center),t.radius=0,t;let n=e.length;if(n===1)return yt.clone(e[0],t);if(n===2)return yt.union(e[0],e[1],t);let r=[],o;for(o=0;o<n;o++)r.push(e[o].center);t=yt.fromPoints(r,t);let a=t.center,s=t.radius;for(o=0;o<n;o++){let u=e[o];s=Math.max(s,x.distance(a,u.center,cue)+u.radius)}return t.radius=s,t};var fue=new x,hue=new x,due=new x;yt.fromOrientedBoundingBox=function(e,t){_(t)||(t=new yt);let n=e.halfAxes,r=ne.getColumn(n,0,fue),o=ne.getColumn(n,1,hue),a=ne.getColumn(n,2,due);return x.add(r,o,r),x.add(r,a,r),t.center=x.clone(e.center,t.center),t.radius=x.magnitude(r),t};var pue=new x,mue=new x;yt.fromTransformation=function(e,t){_(t)||(t=new yt);let n=U.getTranslation(e,pue),r=U.getScale(e,mue),o=.5*x.magnitude(r);return t.center=x.clone(n,t.center),t.radius=o,t};yt.clone=function(e,t){if(!!_(e))return _(t)?(t.center=x.clone(e.center,t.center),t.radius=e.radius,t):new yt(e.center,e.radius)};yt.packedLength=4;yt.pack=function(e,t,n){n=T(n,0);let r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t};yt.unpack=function(e,t,n){t=T(t,0),_(n)||(n=new yt);let r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};var gue=new x,_ue=new x;yt.union=function(e,t,n){_(n)||(n=new yt);let r=e.center,o=e.radius,a=t.center,s=t.radius,u=x.subtract(a,r,gue),l=x.magnitude(u);if(o>=l+s)return e.clone(n),n;if(s>=l+o)return t.clone(n),n;let c=(o+l+s)*.5,f=x.multiplyByScalar(u,(-o+c)/l,_ue);return x.add(f,r,f),x.clone(f,n.center),n.radius=c,n};var yue=new x;yt.expand=function(e,t,n){n=yt.clone(e,n);let r=x.magnitude(x.subtract(t,n.center,yue));return r>n.radius&&(n.radius=r),n};yt.intersectPlane=function(e,t){let n=e.center,r=e.radius,o=t.normal,a=x.dot(o,n)+t.distance;return a<-r?gi.OUTSIDE:a<r?gi.INTERSECTING:gi.INSIDE};yt.transform=function(e,t,n){return _(n)||(n=new yt),n.center=U.multiplyByPoint(t,e.center,n.center),n.radius=U.getMaximumScale(t)*e.radius,n};var vue=new x;yt.distanceSquaredTo=function(e,t){let n=x.subtract(e.center,t,vue),r=x.magnitude(n)-e.radius;return r<=0?0:r*r};yt.transformWithoutScale=function(e,t,n){return _(n)||(n=new yt),n.center=U.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var Cue=new x;yt.computePlaneDistances=function(e,t,n,r){_(r)||(r=new $d);let o=x.subtract(e.center,t,Cue),a=x.dot(n,o);return r.start=a-e.radius,r.stop=a+e.radius,r};var h5=new x,xue=new x,wue=new x,Eue=new x,Tue=new x,Sue=new ce,d5=new Array(8);for(let e=0;e<8;++e)d5[e]=new x;var Aue=new uc;yt.projectTo2D=function(e,t,n){t=T(t,Aue);let r=t.ellipsoid,o=e.center,a=e.radius,s;x.equals(o,x.ZERO)?s=x.clone(x.UNIT_X,h5):s=r.geodeticSurfaceNormal(o,h5);let u=x.cross(x.UNIT_Z,s,xue);x.normalize(u,u);let l=x.cross(s,u,wue);x.normalize(l,l),x.multiplyByScalar(s,a,s),x.multiplyByScalar(l,a,l),x.multiplyByScalar(u,a,u);let c=x.negate(l,Tue),f=x.negate(u,Eue),h=d5,d=h[0];x.add(s,l,d),x.add(d,u,d),d=h[1],x.add(s,l,d),x.add(d,f,d),d=h[2],x.add(s,c,d),x.add(d,f,d),d=h[3],x.add(s,c,d),x.add(d,u,d),x.negate(s,s),d=h[4],x.add(s,l,d),x.add(d,u,d),d=h[5],x.add(s,l,d),x.add(d,f,d),d=h[6],x.add(s,c,d),x.add(d,f,d),d=h[7],x.add(s,c,d),x.add(d,u,d);let p=h.length;for(let w=0;w<p;++w){let C=h[w];x.add(o,C,C);let E=r.cartesianToCartographic(C,Sue);t.project(E,C)}n=yt.fromPoints(h,n),o=n.center;let g=o.x,y=o.y,v=o.z;return o.x=v,o.y=g,o.z=y,n};yt.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)};yt.equals=function(e,t){return e===t||_(e)&&_(t)&&x.equals(e.center,t.center)&&e.radius===t.radius};yt.prototype.intersectPlane=function(e){return yt.intersectPlane(this,e)};yt.prototype.distanceSquaredTo=function(e){return yt.distanceSquaredTo(this,e)};yt.prototype.computePlaneDistances=function(e,t,n){return yt.computePlaneDistances(this,e,t,n)};yt.prototype.isOccluded=function(e){return yt.isOccluded(this,e)};yt.prototype.equals=function(e){return yt.equals(this,e)};yt.prototype.clone=function(e){return yt.clone(this,e)};yt.prototype.volume=function(){let e=this.radius;return oue*e*e*e};var Ee=yt;function bue(){return!0}function Iue(e,t){t=T(t,"This object was destroyed, i.e., destroy() was called.");function n(){}for(let r in e)typeof e[r]=="function"&&(e[r]=n);e.isDestroyed=bue}var ot=Iue;function ep(){this.high=x.clone(x.ZERO),this.low=x.clone(x.ZERO)}ep.encode=function(e,t){_(t)||(t={high:0,low:0});let n;return e>=0?(n=Math.floor(e/65536)*65536,t.high=n,t.low=e-n):(n=Math.floor(-e/65536)*65536,t.high=-n,t.low=e+n),t};var vm={high:0,low:0};ep.fromCartesian=function(e,t){_(t)||(t=new ep);let n=t.high,r=t.low;return ep.encode(e.x,vm),n.x=vm.high,r.x=vm.low,ep.encode(e.y,vm),n.y=vm.high,r.y=vm.low,ep.encode(e.z,vm),n.z=vm.high,r.z=vm.low,t};var UO=new ep;ep.writeElements=function(e,t,n){ep.fromCartesian(e,UO);let r=UO.high,o=UO.low;t[n]=r.x,t[n+1]=r.y,t[n+2]=r.z,t[n+3]=o.x,t[n+4]=o.y,t[n+5]=o.z};var ei=ep;var bs={UNSIGNED_BYTE:V.UNSIGNED_BYTE,UNSIGNED_SHORT:V.UNSIGNED_SHORT,UNSIGNED_INT:V.UNSIGNED_INT};bs.getSizeInBytes=function(e){switch(e){case bs.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case bs.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case bs.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}};bs.fromSizeInBytes=function(e){switch(e){case 2:return bs.UNSIGNED_SHORT;case 4:return bs.UNSIGNED_INT;case 1:return bs.UNSIGNED_BYTE}};bs.validate=function(e){return _(e)&&(e===bs.UNSIGNED_BYTE||e===bs.UNSIGNED_SHORT||e===bs.UNSIGNED_INT)};bs.createTypedArray=function(e,t){return e>=z.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)};bs.createTypedArrayFromArrayBuffer=function(e,t,n,r){return e>=z.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,r):new Uint16Array(t,n,r)};bs.fromTypedArray=function(e){if(e instanceof Uint8Array)return bs.UNSIGNED_BYTE;if(e instanceof Uint16Array)return bs.UNSIGNED_SHORT;if(e instanceof Uint32Array)return bs.UNSIGNED_INT};var Rr=Object.freeze(bs);var qb={STREAM_DRAW:V.STREAM_DRAW,STATIC_DRAW:V.STATIC_DRAW,DYNAMIC_DRAW:V.DYNAMIC_DRAW,validate:function(e){return e===qb.STREAM_DRAW||e===qb.STATIC_DRAW||e===qb.DYNAMIC_DRAW}},We=Object.freeze(qb);function Lf(e){e=T(e,T.EMPTY_OBJECT);let t=e.context._gl,n=e.bufferTarget,r=e.typedArray,o=e.sizeInBytes,a=e.usage,s=_(r);s&&(o=r.byteLength);let u=t.createBuffer();t.bindBuffer(n,u),t.bufferData(n,s?r:o,a),t.bindBuffer(n,null),this._id=_i(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=a,this._buffer=u,this.vertexArrayDestroyable=!0}Lf.createVertexBuffer=function(e){return new Lf({context:e.context,bufferTarget:V.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})};Lf.createIndexBuffer=function(e){let t=e.context,n=e.indexDatatype,r=Rr.getSizeInBytes(n),o=new Lf({context:t,bufferTarget:V.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),a=o.sizeInBytes/r;return Object.defineProperties(o,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return r}},numberOfIndices:{get:function(){return a}}}),o};Object.defineProperties(Lf.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});Lf.prototype._getBuffer=function(){return this._buffer};Lf.prototype.copyFromArrayView=function(e,t){t=T(t,0);let n=this._gl,r=this._bufferTarget;n.bindBuffer(r,this._buffer),n.bufferSubData(r,t,e),n.bindBuffer(r,null)};Lf.prototype.copyFromBuffer=function(e,t,n,r){let o=V.COPY_READ_BUFFER,a=V.COPY_WRITE_BUFFER,s=this._gl;s.bindBuffer(a,this._buffer),s.bindBuffer(o,e._buffer),s.copyBufferSubData(o,a,t,n,r),s.bindBuffer(a,null),s.bindBuffer(o,null)};Lf.prototype.getBufferData=function(e,t,n,r){t=T(t,0),n=T(n,0);let o=this._gl,a=V.COPY_READ_BUFFER;o.bindBuffer(a,this._buffer),o.getBufferSubData(a,t,e,n,r),o.bindBuffer(a,null)};Lf.prototype.isDestroyed=function(){return!1};Lf.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),ot(this)};var ki=Lf;var Iu={POINTS:V.POINTS,LINES:V.LINES,LINE_LOOP:V.LINE_LOOP,LINE_STRIP:V.LINE_STRIP,TRIANGLES:V.TRIANGLES,TRIANGLE_STRIP:V.TRIANGLE_STRIP,TRIANGLE_FAN:V.TRIANGLE_FAN};Iu.isLines=function(e){return e===Iu.LINES||e===Iu.LINE_LOOP||e===Iu.LINE_STRIP};Iu.isTriangles=function(e){return e===Iu.TRIANGLES||e===Iu.TRIANGLE_STRIP||e===Iu.TRIANGLE_FAN};Iu.validate=function(e){return e===Iu.POINTS||e===Iu.LINES||e===Iu.LINE_LOOP||e===Iu.LINE_STRIP||e===Iu.TRIANGLES||e===Iu.TRIANGLE_STRIP||e===Iu.TRIANGLE_FAN};var rn=Object.freeze(Iu);var Jo={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function Yw(e){e=T(e,T.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._modelMatrix=e.modelMatrix,this._primitiveType=T(e.primitiveType,rn.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=T(e.offset,0),this._instanceCount=T(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._owner=e.owner,this._debugOverlappingFrustums=0,this._pickId=e.pickId,this._flags=0,this.cull=T(e.cull,!0),this.occlude=T(e.occlude,!0),this.executeInClosestFrustum=T(e.executeInClosestFrustum,!1),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.castShadows=T(e.castShadows,!1),this.receiveShadows=T(e.receiveShadows,!1),this.pickOnly=T(e.pickOnly,!1),this.depthForTranslucentClassification=T(e.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function el(e,t){return(e._flags&t)===t}function Yg(e,t,n){n?e._flags|=t:e._flags&=~t}Object.defineProperties(Yw.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return el(this,Jo.CULL)},set:function(e){el(this,Jo.CULL)!==e&&(Yg(this,Jo.CULL,e),this.dirty=!0)}},occlude:{get:function(){return el(this,Jo.OCCLUDE)},set:function(e){el(this,Jo.OCCLUDE)!==e&&(Yg(this,Jo.OCCLUDE,e),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return el(this,Jo.CAST_SHADOWS)},set:function(e){el(this,Jo.CAST_SHADOWS)!==e&&(Yg(this,Jo.CAST_SHADOWS,e),this.dirty=!0)}},receiveShadows:{get:function(){return el(this,Jo.RECEIVE_SHADOWS)},set:function(e){el(this,Jo.RECEIVE_SHADOWS)!==e&&(Yg(this,Jo.RECEIVE_SHADOWS,e),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return el(this,Jo.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(e){el(this,Jo.EXECUTE_IN_CLOSEST_FRUSTUM)!==e&&(Yg(this,Jo.EXECUTE_IN_CLOSEST_FRUSTUM,e),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return el(this,Jo.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(e){el(this,Jo.DEBUG_SHOW_BOUNDING_VOLUME)!==e&&(Yg(this,Jo.DEBUG_SHOW_BOUNDING_VOLUME,e),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickOnly:{get:function(){return el(this,Jo.PICK_ONLY)},set:function(e){el(this,Jo.PICK_ONLY)!==e&&(Yg(this,Jo.PICK_ONLY,e),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return el(this,Jo.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(e){el(this,Jo.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==e&&(Yg(this,Jo.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,e),this.dirty=!0)}}});Yw.shallowClone=function(e,t){if(!!_(e))return _(t)||(t=new Yw),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._owner=e._owner,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._pickId=e._pickId,t._flags=e._flags,t.dirty=!0,t.lastDirtyTime=0,t};Yw.prototype.execute=function(e,t){e.draw(this,t)};var Zt=Yw;var Due={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,NUMBER_OF_PASSES:10},Qt=Object.freeze(Due);var Wb={CLOCKWISE:V.CW,COUNTER_CLOCKWISE:V.CCW};Wb.validate=function(e){return e===Wb.CLOCKWISE||e===Wb.COUNTER_CLOCKWISE};var Cm=Object.freeze(Wb);function np(e){let t=T(e,T.EMPTY_OBJECT),n=T(t.cull,T.EMPTY_OBJECT),r=T(t.polygonOffset,T.EMPTY_OBJECT),o=T(t.scissorTest,T.EMPTY_OBJECT),a=T(o.rectangle,T.EMPTY_OBJECT),s=T(t.depthRange,T.EMPTY_OBJECT),u=T(t.depthTest,T.EMPTY_OBJECT),l=T(t.colorMask,T.EMPTY_OBJECT),c=T(t.blending,T.EMPTY_OBJECT),f=T(c.color,T.EMPTY_OBJECT),h=T(t.stencilTest,T.EMPTY_OBJECT),d=T(h.frontOperation,T.EMPTY_OBJECT),p=T(h.backOperation,T.EMPTY_OBJECT),g=T(t.sampleCoverage,T.EMPTY_OBJECT),y=t.viewport;this.frontFace=T(t.frontFace,Cm.COUNTER_CLOCKWISE),this.cull={enabled:T(n.enabled,!1),face:T(n.face,V.BACK)},this.lineWidth=T(t.lineWidth,1),this.polygonOffset={enabled:T(r.enabled,!1),factor:T(r.factor,0),units:T(r.units,0)},this.scissorTest={enabled:T(o.enabled,!1),rectangle:en.clone(a)},this.depthRange={near:T(s.near,0),far:T(s.far,1)},this.depthTest={enabled:T(u.enabled,!1),func:T(u.func,V.LESS)},this.colorMask={red:T(l.red,!0),green:T(l.green,!0),blue:T(l.blue,!0),alpha:T(l.alpha,!0)},this.depthMask=T(t.depthMask,!0),this.stencilMask=T(t.stencilMask,-1),this.blending={enabled:T(c.enabled,!1),color:new K(T(f.red,0),T(f.green,0),T(f.blue,0),T(f.alpha,0)),equationRgb:T(c.equationRgb,V.FUNC_ADD),equationAlpha:T(c.equationAlpha,V.FUNC_ADD),functionSourceRgb:T(c.functionSourceRgb,V.ONE),functionSourceAlpha:T(c.functionSourceAlpha,V.ONE),functionDestinationRgb:T(c.functionDestinationRgb,V.ZERO),functionDestinationAlpha:T(c.functionDestinationAlpha,V.ZERO)},this.stencilTest={enabled:T(h.enabled,!1),frontFunction:T(h.frontFunction,V.ALWAYS),backFunction:T(h.backFunction,V.ALWAYS),reference:T(h.reference,0),mask:T(h.mask,-1),frontOperation:{fail:T(d.fail,V.KEEP),zFail:T(d.zFail,V.KEEP),zPass:T(d.zPass,V.KEEP)},backOperation:{fail:T(p.fail,V.KEEP),zFail:T(p.zFail,V.KEEP),zPass:T(p.zPass,V.KEEP)}},this.sampleCoverage={enabled:T(g.enabled,!1),value:T(g.value,1),invert:T(g.invert,!1)},this.viewport=_(y)?new en(y.x,y.y,y.width,y.height):void 0,this.id=0,this._applyFunctions=[]}var Pue=0,tp={};np.fromCache=function(e){let t=JSON.stringify(e),n=tp[t];if(_(n))return++n.referenceCount,n.state;let r=new np(e),o=JSON.stringify(r);return n=tp[o],_(n)||(r.id=Pue++,n={referenceCount:0,state:r},tp[o]=n),++n.referenceCount,tp[t]={referenceCount:1,state:n.state},n.state};np.removeFromCache=function(e){let t=new np(e),n=JSON.stringify(t),r=tp[n],o=JSON.stringify(e),a=tp[o];_(a)&&(--a.referenceCount,a.referenceCount===0&&(delete tp[o],_(r)&&--r.referenceCount)),_(r)&&r.referenceCount===0&&delete tp[n]};np.getCache=function(){return tp};np.clearCache=function(){tp={}};function O_(e,t,n){n?e.enable(t):e.disable(t)}function p5(e,t){e.frontFace(t.frontFace)}function m5(e,t){let n=t.cull,r=n.enabled;O_(e,e.CULL_FACE,r),r&&e.cullFace(n.face)}function g5(e,t){e.lineWidth(t.lineWidth)}function _5(e,t){let n=t.polygonOffset,r=n.enabled;O_(e,e.POLYGON_OFFSET_FILL,r),r&&e.polygonOffset(n.factor,n.units)}function y5(e,t,n){let r=t.scissorTest,o=_(n.scissorTest)?n.scissorTest.enabled:r.enabled;if(O_(e,e.SCISSOR_TEST,o),o){let a=_(n.scissorTest)?n.scissorTest.rectangle:r.rectangle;e.scissor(a.x,a.y,a.width,a.height)}}function v5(e,t){let n=t.depthRange;e.depthRange(n.near,n.far)}function C5(e,t){let n=t.depthTest,r=n.enabled;O_(e,e.DEPTH_TEST,r),r&&e.depthFunc(n.func)}function x5(e,t){let n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function w5(e,t){e.depthMask(t.depthMask)}function E5(e,t){e.stencilMask(t.stencilMask)}function Mue(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function T5(e,t,n){let r=t.blending,o=_(n.blendingEnabled)?n.blendingEnabled:r.enabled;O_(e,e.BLEND,o),o&&(Mue(e,r.color),e.blendEquationSeparate(r.equationRgb,r.equationAlpha),e.blendFuncSeparate(r.functionSourceRgb,r.functionDestinationRgb,r.functionSourceAlpha,r.functionDestinationAlpha))}function S5(e,t){let n=t.stencilTest,r=n.enabled;if(O_(e,e.STENCIL_TEST,r),r){let o=n.frontFunction,a=n.backFunction,s=n.reference,u=n.mask;e.stencilFunc(o,s,u),e.stencilFuncSeparate(e.BACK,a,s,u),e.stencilFuncSeparate(e.FRONT,o,s,u);let l=n.frontOperation,c=l.fail,f=l.zFail,h=l.zPass;e.stencilOpSeparate(e.FRONT,c,f,h);let d=n.backOperation,p=d.fail,g=d.zFail,y=d.zPass;e.stencilOpSeparate(e.BACK,p,g,y)}}function A5(e,t){let n=t.sampleCoverage,r=n.enabled;O_(e,e.SAMPLE_COVERAGE,r),r&&e.sampleCoverage(n.value,n.invert)}var Lue=new en;function b5(e,t,n){let r=T(t.viewport,n.viewport);_(r)||(r=Lue,r.width=n.context.drawingBufferWidth,r.height=n.context.drawingBufferHeight),n.context.uniformState.viewport=r,e.viewport(r.x,r.y,r.width,r.height)}np.apply=function(e,t,n){p5(e,t),m5(e,t),g5(e,t),_5(e,t),v5(e,t),C5(e,t),x5(e,t),w5(e,t),E5(e,t),S5(e,t),A5(e,t),y5(e,t,n),T5(e,t,n),b5(e,t,n)};function Rue(e,t){let n=[];return e.frontFace!==t.frontFace&&n.push(p5),(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face)&&n.push(m5),e.lineWidth!==t.lineWidth&&n.push(g5),(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units)&&n.push(_5),(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far)&&n.push(v5),(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func)&&n.push(C5),(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha)&&n.push(x5),e.depthMask!==t.depthMask&&n.push(w5),e.stencilMask!==t.stencilMask&&n.push(E5),(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass)&&n.push(S5),(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert)&&n.push(A5),n}np.partialApply=function(e,t,n,r,o,a){if(t!==n){let f=n._applyFunctions[t.id];_(f)||(f=Rue(t,n),n._applyFunctions[t.id]=f);let h=f.length;for(let d=0;d<h;++d)f[d](e,n)}let s=_(r.scissorTest)?r.scissorTest:t.scissorTest,u=_(o.scissorTest)?o.scissorTest:n.scissorTest;(s!==u||a)&&y5(e,n,o);let l=_(r.blendingEnabled)?r.blendingEnabled:t.blending.enabled,c=_(o.blendingEnabled)?o.blendingEnabled:n.blending.enabled;(l!==c||c&&t.blending!==n.blending)&&T5(e,n,o),(t!==n||r!==o||r.context!==o.context)&&b5(e,n,o)};np.getState=function(e){return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:en.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:K.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:_(e.viewport)?en.clone(e.viewport):void 0}};var un=np;var Oue=new x;function Ke(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var Ws={};Ws[V.FLOAT]="float";Ws[V.FLOAT_VEC2]="vec2";Ws[V.FLOAT_VEC3]="vec3";Ws[V.FLOAT_VEC4]="vec4";Ws[V.INT]="int";Ws[V.INT_VEC2]="ivec2";Ws[V.INT_VEC3]="ivec3";Ws[V.INT_VEC4]="ivec4";Ws[V.BOOL]="bool";Ws[V.BOOL_VEC2]="bvec2";Ws[V.BOOL_VEC3]="bvec3";Ws[V.BOOL_VEC4]="bvec4";Ws[V.FLOAT_MAT2]="mat2";Ws[V.FLOAT_MAT3]="mat3";Ws[V.FLOAT_MAT4]="mat4";Ws[V.SAMPLER_2D]="sampler2D";Ws[V.SAMPLER_CUBE]="samplerCube";Ke.prototype.getDeclaration=function(e){let t=`uniform ${Ws[this._datatype]} ${e}`,n=this._size;return n===1?t+=";":t+=`[${n.toString()}];`,t};var Nue={czm_viewport:new Ke({size:1,datatype:V.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new Ke({size:1,datatype:V.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new Ke({size:1,datatype:V.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.eyeHeight}}),czm_eyeHeight2D:new Ke({size:1,datatype:V.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new Ke({size:1,datatype:V.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new Ke({size:1,datatype:V.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new Ke({size:1,datatype:V.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_farDepthFromNearPlusOne:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_lightDirectionEC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.lightDirectionEC}}),czm_lightDirectionWC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.lightDirectionWC}}),czm_lightColor:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.lightColor}}),czm_lightColorHdr:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return U.getTranslation(e.inverseView,Oue)}}),czm_frameNumber:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new Ke({size:1,datatype:V.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new Ke({size:1,datatype:V.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new Ke({size:1,datatype:V.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new Ke({size:1,datatype:V.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new Ke({size:1,datatype:V.FLOAT_VEC2,getValue:function(e){return e.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new Ke({size:9,datatype:V.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new Ke({size:1,datatype:V.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_pixelRatio:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.pixelRatio}}),czm_fogDensity:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.fogDensity}}),czm_splitPosition:new Ke({size:1,datatype:V.FLOAT_VEC2,getValue:function(e){return e.splitPosition}}),czm_geometricToleranceOverMeter:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new Ke({size:1,datatype:V.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new Ke({size:1,datatype:V.FLOAT,getValue:function(e){return e.gamma}}),czm_ellipsoidRadii:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new Ke({size:1,datatype:V.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.oneOverRadii}})},rC=Nue;function Bue(e,t,n,r){switch(t.type){case e.FLOAT:return new I5(e,t,n,r);case e.FLOAT_VEC2:return new D5(e,t,n,r);case e.FLOAT_VEC3:return new P5(e,t,n,r);case e.FLOAT_VEC4:return new M5(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new HO(e,t,n,r);case e.INT:case e.BOOL:return new L5(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new R5(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new O5(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new N5(e,t,n,r);case e.FLOAT_MAT2:return new B5(e,t,n,r);case e.FLOAT_MAT3:return new F5(e,t,n,r);case e.FLOAT_MAT4:return new z5(e,t,n,r);default:throw new it(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function I5(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}I5.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))};function D5(e,t,n,r){this.name=n,this.value=void 0,this._value=new X,this._gl=e,this._location=r}D5.prototype.set=function(){let e=this.value;X.equals(e,this._value)||(X.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))};function P5(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}P5.prototype.set=function(){let e=this.value;_(e.red)?K.equals(e,this._value)||(this._value=K.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):_(e.x)&&(x.equals(e,this._value)||(this._value=x.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))};function M5(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}M5.prototype.set=function(){let e=this.value;_(e.red)?K.equals(e,this._value)||(this._value=K.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):_(e.x)&&(Se.equals(e,this._value)||(this._value=Se.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))};function HO(e,t,n,r){this.name=n,this.value=void 0,this._gl=e,this._location=r,this.textureUnitIndex=void 0}HO.prototype.set=function(){let e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);let t=this.value;e.bindTexture(t._target,t._texture)};HO.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1};function L5(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}L5.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))};function R5(e,t,n,r){this.name=n,this.value=void 0,this._value=new X,this._gl=e,this._location=r}R5.prototype.set=function(){let e=this.value;X.equals(e,this._value)||(X.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))};function O5(e,t,n,r){this.name=n,this.value=void 0,this._value=new x,this._gl=e,this._location=r}O5.prototype.set=function(){let e=this.value;x.equals(e,this._value)||(x.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))};function N5(e,t,n,r){this.name=n,this.value=void 0,this._value=new Se,this._gl=e,this._location=r}N5.prototype.set=function(){let e=this.value;Se.equals(e,this._value)||(Se.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var Fue=new Float32Array(4);function B5(e,t,n,r){this.name=n,this.value=void 0,this._value=new Ma,this._gl=e,this._location=r}B5.prototype.set=function(){if(!Ma.equalsArray(this.value,this._value,0)){Ma.clone(this.value,this._value);let e=Ma.toArray(this.value,Fue);this._gl.uniformMatrix2fv(this._location,!1,e)}};var zue=new Float32Array(9);function F5(e,t,n,r){this.name=n,this.value=void 0,this._value=new ne,this._gl=e,this._location=r}F5.prototype.set=function(){if(!ne.equalsArray(this.value,this._value,0)){ne.clone(this.value,this._value);let e=ne.toArray(this.value,zue);this._gl.uniformMatrix3fv(this._location,!1,e)}};var Vue=new Float32Array(16);function z5(e,t,n,r){this.name=n,this.value=void 0,this._value=new U,this._gl=e,this._location=r}z5.prototype.set=function(){if(!U.equalsArray(this.value,this._value,0)){U.clone(this.value,this._value);let e=U.toArray(this.value,Vue);this._gl.uniformMatrix4fv(this._location,!1,e)}};var V5=Bue;function kue(e,t,n,r){switch(t.type){case e.FLOAT:return new k5(e,t,n,r);case e.FLOAT_VEC2:return new G5(e,t,n,r);case e.FLOAT_VEC3:return new U5(e,t,n,r);case e.FLOAT_VEC4:return new H5(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new qO(e,t,n,r);case e.INT:case e.BOOL:return new q5(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new W5(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new Y5(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new X5(e,t,n,r);case e.FLOAT_MAT2:return new j5(e,t,n,r);case e.FLOAT_MAT3:return new K5(e,t,n,r);case e.FLOAT_MAT4:return new Z5(e,t,n,r);default:throw new it(`Unrecognized uniform type: ${t.type} for uniform "${n}".`)}}function k5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._location=r[0]}k5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1;for(let o=0;o<t;++o){let a=e[o];a!==n[o]&&(n[o]=a,r=!0)}r&&this._gl.uniform1fv(this._location,n)};function G5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*2),this._gl=e,this._location=r[0]}G5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];X.equalsArray(s,n,o)||(X.pack(s,n,o),r=!0),o+=2}r&&this._gl.uniform2fv(this._location,n)};function U5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*3),this._gl=e,this._location=r[0]}U5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];_(s.red)?(s.red!==n[o]||s.green!==n[o+1]||s.blue!==n[o+2])&&(n[o]=s.red,n[o+1]=s.green,n[o+2]=s.blue,r=!0):_(s.x)&&(x.equalsArray(s,n,o)||(x.pack(s,n,o),r=!0)),o+=3}r&&this._gl.uniform3fv(this._location,n)};function H5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=r[0]}H5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];_(s.red)?K.equalsArray(s,n,o)||(K.pack(s,n,o),r=!0):_(s.x)&&(Se.equalsArray(s,n,o)||(Se.pack(s,n,o),r=!0)),o+=4}r&&this._gl.uniform4fv(this._location,n)};function qO(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o),this._gl=e,this._locations=r,this.textureUnitIndex=void 0}qO.prototype.set=function(){let e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,r=n.length;for(let o=0;o<r;++o){let a=n[o];e.activeTexture(t+o),e.bindTexture(a._target,a._texture)}};qO.prototype._setSampler=function(e){this.textureUnitIndex=e;let t=this._locations,n=t.length;for(let r=0;r<n;++r){let o=e+r;this._gl.uniform1i(t[r],o)}return e+n};function q5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o),this._gl=e,this._location=r[0]}q5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1;for(let o=0;o<t;++o){let a=e[o];a!==n[o]&&(n[o]=a,r=!0)}r&&this._gl.uniform1iv(this._location,n)};function W5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*2),this._gl=e,this._location=r[0]}W5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];X.equalsArray(s,n,o)||(X.pack(s,n,o),r=!0),o+=2}r&&this._gl.uniform2iv(this._location,n)};function Y5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*3),this._gl=e,this._location=r[0]}Y5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];x.equalsArray(s,n,o)||(x.pack(s,n,o),r=!0),o+=3}r&&this._gl.uniform3iv(this._location,n)};function X5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Int32Array(o*4),this._gl=e,this._location=r[0]}X5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];Se.equalsArray(s,n,o)||(Se.pack(s,n,o),r=!0),o+=4}r&&this._gl.uniform4iv(this._location,n)};function j5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*4),this._gl=e,this._location=r[0]}j5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];Ma.equalsArray(s,n,o)||(Ma.pack(s,n,o),r=!0),o+=4}r&&this._gl.uniformMatrix2fv(this._location,!1,n)};function K5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*9),this._gl=e,this._location=r[0]}K5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];ne.equalsArray(s,n,o)||(ne.pack(s,n,o),r=!0),o+=9}r&&this._gl.uniformMatrix3fv(this._location,!1,n)};function Z5(e,t,n,r){let o=r.length;this.name=n,this.value=new Array(o),this._value=new Float32Array(o*16),this._gl=e,this._location=r[0]}Z5.prototype.set=function(){let e=this.value,t=e.length,n=this._value,r=!1,o=0;for(let a=0;a<t;++a){let s=e[a];U.equalsArray(s,n,o)||(U.pack(s,n,o),r=!0),o+=16}r&&this._gl.uniformMatrix4fv(this._location,!1,n)};var Q5=kue;var Gue=0;function xm(e){let t=e.vertexShaderText,n=e.fragmentShaderText;typeof spector<"u"&&(t=t.replace(/^#line/gm,"//#line"),n=n.replace(/^#line/gm,"//#line"));let r=Uue(t,n);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=r.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=r.fragmentShaderText,this.id=Gue++}xm.fromCache=function(e){return e=T(e,T.EMPTY_OBJECT),e.context.shaderCache.getShaderProgram(e)};xm.replaceCache=function(e){return e=T(e,T.EMPTY_OBJECT),e.context.shaderCache.replaceShaderProgram(e)};Object.defineProperties(xm.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return Yb(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return Yb(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return Yb(this),this._uniformsByName}}});function J5(e){let t=[],n=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(_(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o].trim(),s=a.slice(a.lastIndexOf(" ")+1);t.push(s)}}return t}function Uue(e,t){let n={};if(!Kt.highpFloatSupported||!Kt.highpIntSupported){let r,o,a,s,u=J5(e),l=J5(t),c=u.length,f=l.length;for(r=0;r<c;r++)for(o=0;o<f;o++)if(u[r]===l[o]){a=u[r],s=`czm_mediump_${a}`;let h=new RegExp(`${a}\\b`,"g");t=t.replace(h,s),n[s]=a}}return{fragmentShaderText:t,duplicateUniformNames:n}}var Rf="[Cesium WebGL] ";function Hue(e,t){let n=t._vertexShaderText,r=t._fragmentShaderText,o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,n),e.compileShader(o);let a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,r),e.compileShader(a);let s=e.createProgram();e.attachShader(s,o),e.attachShader(s,a),e.deleteShader(o),e.deleteShader(a);let u=t._attributeLocations;if(_(u))for(let f in u)u.hasOwnProperty(f)&&e.bindAttribLocation(s,u[f],f);e.linkProgram(s);let l;if(!e.getProgramParameter(s,e.LINK_STATUS)){let f=t._debugShaders;if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(l=e.getShaderInfoLog(a),console.error(`${Rf}Fragment shader compile log: ${l}`),_(f)){let h=f.getTranslatedShaderSource(a);console.error(h!==""?`${Rf}Translated fragment shader source:
${h}`:`${Rf}Fragment shader translation failed.`)}throw e.deleteProgram(s),new it(`Fragment shader failed to compile.  Compile log: ${l}`)}if(!e.getShaderParameter(o,e.COMPILE_STATUS)){if(l=e.getShaderInfoLog(o),console.error(`${Rf}Vertex shader compile log: ${l}`),_(f)){let h=f.getTranslatedShaderSource(o);console.error(h!==""?`${Rf}Translated vertex shader source:
${h}`:`${Rf}Vertex shader translation failed.`)}throw e.deleteProgram(s),new it(`Vertex shader failed to compile.  Compile log: ${l}`)}throw l=e.getProgramInfoLog(s),console.error(`${Rf}Shader program link log: ${l}`),_(f)&&(console.error(`${Rf}Translated vertex shader source:
${f.getTranslatedShaderSource(o)}`),console.error(`${Rf}Translated fragment shader source:
${f.getTranslatedShaderSource(a)}`)),e.deleteProgram(s),new it(`Program failed to link.  Link log: ${l}`)}let c=t._logShaderCompilation;return c&&(l=e.getShaderInfoLog(o),_(l)&&l.length>0&&console.log(`${Rf}Vertex shader compile log: ${l}`)),c&&(l=e.getShaderInfoLog(a),_(l)&&l.length>0&&console.log(`${Rf}Fragment shader compile log: ${l}`)),c&&(l=e.getProgramInfoLog(s),_(l)&&l.length>0&&console.log(`${Rf}Shader program link log: ${l}`)),s}function que(e,t,n){let r={};for(let o=0;o<n;++o){let a=e.getActiveAttrib(t,o),s=e.getAttribLocation(t,a.name);r[a.name]={name:a.name,type:a.type,index:s}}return r}function Wue(e,t){let n={},r=[],o=[],a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<a;++s){let u=e.getActiveUniform(t,s),l="[0]",c=u.name.indexOf(l,u.name.length-l.length)!==-1?u.name.slice(0,u.name.length-3):u.name;if(c.indexOf("gl_")!==0)if(u.name.indexOf("[")<0){let f=e.getUniformLocation(t,c);if(f!==null){let h=V5(e,u,c,f);n[c]=h,r.push(h),h._setSampler&&o.push(h)}}else{let f,h,d,p,g=c.indexOf("[");if(g>=0){if(f=n[c.slice(0,g)],!_(f))continue;h=f._locations,h.length<=1&&(d=f.value,p=e.getUniformLocation(t,c),p!==null&&(h.push(p),d.push(e.getUniform(t,p))))}else{h=[];for(let y=0;y<u.size;++y)p=e.getUniformLocation(t,`${c}[${y}]`),p!==null&&h.push(p);f=Q5(e,u,c,h),n[c]=f,r.push(f),f._setSampler&&o.push(f)}}}return{uniformsByName:n,uniforms:r,samplerUniforms:o}}function Yue(e,t){let n=[],r=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=o,u=e._duplicateUniformNames[s];_(u)&&(a.name=u,s=u);let l=rC[s];_(l)?n.push({uniform:a,automaticUniform:l}):r.push(a)}return{automaticUniforms:n,manualUniforms:r}}function Xue(e,t,n){e.useProgram(t);let r=0,o=n.length;for(let a=0;a<o;++a)r=n[a]._setSampler(r);return e.useProgram(null),r}function Yb(e){_(e._program)||$5(e)}function $5(e){let t=e._program,n=e._gl,r=Hue(n,e,e._debugShaders),o=n.getProgramParameter(r,n.ACTIVE_ATTRIBUTES),a=Wue(n,r),s=Yue(e,a.uniformsByName);e._program=r,e._numberOfVertexAttributes=o,e._vertexAttributes=que(n,r,o),e._uniformsByName=a.uniformsByName,e._uniforms=a.uniforms,e._automaticUniforms=s.automaticUniforms,e._manualUniforms=s.manualUniforms,e.maximumTextureUnitIndex=Xue(n,r,a.samplerUniforms),t&&e._gl.deleteProgram(t),typeof spector<"u"&&(e._program.__SPECTOR_rebuildProgram=function(u,l,c,f){let h=e._vertexShaderText,d=e._fragmentShaderText,p=/ ! = /g;e._vertexShaderText=u.replace(p," != "),e._fragmentShaderText=l.replace(p," != ");try{$5(e),c(e._program)}catch(g){e._vertexShaderText=h,e._fragmentShaderText=d;let v=/(?:Compile|Link) error: ([^]*)/.exec(g.message);f(v?v[1]:g.message)}})}xm.prototype._bind=function(){Yb(this),this._gl.useProgram(this._program)};xm.prototype._setUniforms=function(e,t,n){let r,o;if(_(e)){let u=this._manualUniforms;for(r=u.length,o=0;o<r;++o){let l=u[o];l.value=e[l.name]()}}let a=this._automaticUniforms;for(r=a.length,o=0;o<r;++o){let u=a[o];u.uniform.value=u.automaticUniform.getValue(t)}let s=this._uniforms;for(r=s.length,o=0;o<r;++o)s[o].set();if(n){let u=this._gl,l=this._program;u.validateProgram(l)}};xm.prototype.isDestroyed=function(){return!1};xm.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)};xm.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),ot(this)};var vi=xm;function jue(e,t){let n=/#define OUTPUT_DECLARATION/,r=e.split(`
`);if(/#version 300 es/g.test(e))return e;let o=-1,a,s;for(a=0;a<r.length;++a)if(s=r[a],n.test(s)){o=a;break}if(o===-1)throw new Le("Could not find a #define OUTPUT_DECLARATION!");let u=[];for(a=0;a<10;a++){let y=`gl_FragData\\[${a}\\]`,v=`czm_out${a}`;new RegExp(y,"g").test(e)&&(e8(v,u),rp(y,v,r),r.splice(o,0,`layout(location = ${a}) out vec4 ${v};`),o+=1)}let l="czm_fragColor";Zue("gl_FragColor",r)&&(e8(l,u),rp("gl_FragColor",l,r),r.splice(o,0,"layout(location = 0) out vec4 czm_fragColor;"),o+=1);let c=Jue(u,r),f={};for(a=0;a<r.length;a++){s=r[a];for(let y in c)c.hasOwnProperty(y)&&new RegExp(`(layout)[^]+(out)[^]+(${y})[^]+`,"g").test(s)&&(f[s]=y)}for(let y in f)if(f.hasOwnProperty(y)){let v=f[y],w=r.indexOf(y),C=c[v],E=C.length;for(let S=0;S<E;S++)r.splice(w,0,C[S]);w+=E+1;for(let S=E-1;S>=0;S--)r.splice(w,0,`#endif //${C[S]}`)}let h="WEBGL_2",d=`#define ${h}`,p="#version 300 es",g=!1;for(a=0;a<r.length;a++)if(/#version/.test(r[a])){r[a]=p,g=!0;break}return g||r.splice(0,0,p),r.splice(1,0,d),WO("EXT_draw_buffers",h,r),WO("EXT_frag_depth",h,r),WO("OES_standard_derivatives",h,r),rp("texture2D","texture",r),rp("texture3D","texture",r),rp("textureCube","texture",r),rp("gl_FragDepthEXT","gl_FragDepth",r),t?rp("varying","in",r):(rp("attribute","in",r),rp("varying","out",r)),Que(r)}function rp(e,t,n){let r=`(^|[^\\w])(${e})($|[^\\w])`,o=new RegExp(r,"g"),a=n.length;for(let s=0;s<a;++s){let u=n[s];n[s]=u.replace(o,`$1${t}$3`)}}function Kue(e,t,n){let r=n.length;for(let o=0;o<r;++o){let a=n[o];n[o]=a.replace(e,t)}}function Zue(e,t){let n=`(^|[^\\w])(${e})($|[^\\w])`,r=new RegExp(n,"g"),o=t.length;for(let a=0;a<o;++a){let s=t[a];if(r.test(s))return!0}return!1}function Que(e){let t="",n=e.length;for(let r=0;r<n;++r)t+=`${e[r]}
`;return t}function e8(e,t){t.indexOf(e)===-1&&t.push(e)}function Jue(e,t){let n={},r=e.length,o=[];for(let a=0;a<t.length;++a){let s=t[a],u=/(#ifdef|#if)/g.test(s),l=/#else/g.test(s),c=/#endif/g.test(s);if(u)o.push(s);else if(l){let h=o[o.length-1].replace("ifdef","ifndef");/if/g.test(h)&&(h=h.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),o.pop(),o.push(h)}else if(c)o.pop();else if(!/layout/g.test(s))for(let f=0;f<r;++f){let h=e[f];s.indexOf(h)!==-1&&(_(n[h])?n[h]=n[h].filter(function(d){return o.indexOf(d)>=0}):n[h]=o.slice())}}return n}function WO(e,t,n){let r=`#extension\\s+GL_${e}\\s+:\\s+[a-zA-Z0-9]+\\s*$`;Kue(new RegExp(r,"g"),"",n),rp(`GL_${e}`,t,n)}var t8=jue;var n8=`const float czm_degreesPerRadian = 57.29577951308232;
`;var r8=`const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);
`;var i8=`const float czm_epsilon1 = 0.1;
`;var o8=`const float czm_epsilon2 = 0.01;
`;var a8=`const float czm_epsilon3 = 0.001;
`;var s8=`const float czm_epsilon4 = 0.0001;
`;var u8=`const float czm_epsilon5 = 0.00001;
`;var l8=`const float czm_epsilon6 = 0.000001;
`;var c8=`const float czm_epsilon7 = 0.0000001;
`;var f8=`const float czm_infinity = 5906376272000.0;
`;var h8=`const float czm_oneOverPi = 0.3183098861837907;
`;var d8=`const float czm_oneOverTwoPi = 0.15915494309189535;
`;var p8=`const float czm_passCesium3DTile = 4.0;
`;var m8=`const float czm_passCesium3DTileClassification = 5.0;
`;var g8=`const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;
`;var _8=`const float czm_passClassification = 7.0;
`;var y8=`const float czm_passCompute = 1.0;
`;var v8=`const float czm_passEnvironment = 0.0;
`;var C8=`const float czm_passGlobe = 2.0;
`;var x8=`const float czm_passOpaque = 7.0;
`;var w8=`const float czm_passOverlay = 9.0;
`;var E8=`const float czm_passTerrainClassification = 3.0;
`;var T8=`const float czm_passTranslucent = 8.0;
`;var S8=`const float czm_pi = 3.141592653589793;
`;var A8=`const float czm_piOverFour = 0.7853981633974483;
`;var b8=`const float czm_piOverSix = 0.5235987755982988;
`;var I8=`const float czm_piOverThree = 1.0471975511965976;
`;var D8=`const float czm_piOverTwo = 1.5707963267948966;
`;var P8=`const float czm_radiansPerDegree = 0.017453292519943295;
`;var M8=`const float czm_sceneMode2D = 2.0;
`;var L8=`const float czm_sceneMode3D = 3.0;
`;var R8=`const float czm_sceneModeColumbusView = 1.0;
`;var O8=`const float czm_sceneModeMorphing = 0.0;
`;var N8=`const float czm_solarRadius = 695500000.0;
`;var B8=`const float czm_threePiOver2 = 4.71238898038469;
`;var F8=`const float czm_twoPi = 6.283185307179586;
`;var z8=`const float czm_webMercatorMaxLatitude = 1.4844222297453324;
`;var V8=`struct czm_depthRangeStruct
{
float near;
float far;
};
`;var k8=`struct czm_material
{
vec3 diffuse;
float specular;
float shininess;
vec3 normal;
vec3 emission;
float alpha;
};
`;var G8=`struct czm_materialInput
{
float s;
vec2 st;
vec3 str;
vec3 normalEC;
mat3 tangentToEyeMatrix;
vec3 positionToEyeEC;
float height;
float slope;
float aspect;
};
`;var U8=`struct czm_modelMaterial {
vec3 diffuse;
float alpha;
vec3 specular;
float roughness;
vec3 normalEC;
float occlusion;
vec3 emissive;
};
`;var H8=`struct czm_modelVertexOutput {
vec3 positionMC;
float pointSize;
};
`;var q8=`struct czm_pbrParameters
{
vec3 diffuseColor;
float roughness;
vec3 f0;
};
`;var W8=`struct czm_ray
{
vec3 origin;
vec3 direction;
};
`;var Y8=`struct czm_raySegment
{
float start;
float stop;
};
const czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);
const czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);
`;var X8=`struct czm_shadowParameters
{
#ifdef USE_CUBE_MAP_SHADOW
vec3 texCoords;
#else
vec2 texCoords;
#endif
float depthBias;
float depth;
float nDotL;
vec2 texelStepSize;
float normalShadingSmooth;
float darkness;
};
`;var j8=`vec3 czm_acesTonemapping(vec3 color) {
float g = 0.985;
float a = 0.065;
float b = 0.0001;
float c = 0.433;
float d = 0.238;
color = (color * (color + a) - b) / (color * (g * color + c) + d);
color = clamp(color, 0.0, 1.0);
return color;
}
`;var K8=`float czm_alphaWeight(float a)
{
float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));
}
`;var Z8=`vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)
{
float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);
float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);
val1 = val1 * (1.0 - val2);
val1 = val1 * val1 * (3.0 - (2.0 * val1));
val1 = pow(val1, 0.5);
vec4 midColor = (color1 + color2) * 0.5;
return mix(midColor, currentColor, val1);
}
vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)
{
return czm_antialias(color1, color2, currentColor, dist, 0.1);
}
`;var Q8=`vec2 czm_approximateSphericalCoordinates(vec3 normal) {
float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);
float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);
return vec2(latitudeApproximation, longitudeApproximation);
}
`;var J8=`bool czm_backFacing()
{
return gl_FrontFacing == false;
}
`;var $8=`float czm_branchFreeTernary(bool comparison, float a, float b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
`;var eG=`vec4 czm_cascadeColor(vec4 weights)
{
return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +
vec4(0.0, 1.0, 0.0, 1.0) * weights.y +
vec4(0.0, 0.0, 1.0, 1.0) * weights.z +
vec4(1.0, 0.0, 1.0, 1.0) * weights.w;
}
`;var tG=`uniform vec4 shadowMap_cascadeDistances;
float czm_cascadeDistance(vec4 weights)
{
return dot(shadowMap_cascadeDistances, weights);
}
`;var nG=`uniform mat4 shadowMap_cascadeMatrices[4];
mat4 czm_cascadeMatrix(vec4 weights)
{
return shadowMap_cascadeMatrices[0] * weights.x +
shadowMap_cascadeMatrices[1] * weights.y +
shadowMap_cascadeMatrices[2] * weights.z +
shadowMap_cascadeMatrices[3] * weights.w;
}
`;var rG=`uniform vec4 shadowMap_cascadeSplits[2];
vec4 czm_cascadeWeights(float depthEye)
{
vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));
vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);
return near * far;
}
`;var iG=`vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)
{
vec3 p = mix(position2D.xyz, position3D.xyz, time);
return vec4(p, 1.0);
}
`;var oG=`vec4 czm_computePosition();
`;var aG=`vec2 cordic(float angle)
{
vec2 vector = vec2(6.0725293500888267e-1, 0.0);
float sense = (angle < 0.0) ? -1.0 : 1.0;
mat2 rotation = mat2(1.0, sense, -sense, 1.0);
vector = rotation * vector;
angle -= sense * 7.8539816339744828e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
float factor = sense * 5.0e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.6364760900080609e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.5e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4497866312686414e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.25e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2435499454676144e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.25e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.2418809995957350e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.125e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.1239833430268277e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.5625e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5623728620476831e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.8125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.8123410601011111e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.90625e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.9062301319669718e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.953125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9531225164788188e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.765625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.7656218955931946e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.8828125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.8828121119489829e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.44140625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4414062014936177e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.220703125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2207031189367021e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.103515625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.1035156174208773e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.0517578125e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.0517578115526096e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.52587890625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5258789061315762e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.62939453125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.6293945311019700e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.814697265625e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.8146972656064961e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.9073486328125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9073486328101870e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.5367431640625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.5367431640596084e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.76837158203125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.7683715820308884e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.384185791015625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.3841857910155797e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.1920928955078125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
return vector;
}
vec2 czm_cosineAndSine(float angle)
{
if (angle < -czm_piOverTwo || angle > czm_piOverTwo)
{
if (angle < 0.0)
{
return -cordic(angle + czm_pi);
}
else
{
return -cordic(angle - czm_pi);
}
}
else
{
return cordic(angle);
}
}
`;var sG=`vec2 czm_decompressTextureCoordinates(float encoded)
{
float temp = encoded / 4096.0;
float xZeroTo4095 = floor(temp);
float stx = xZeroTo4095 / 4095.0;
float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;
return vec2(stx, sty);
}
`;var uG=`czm_pbrParameters czm_defaultPbrMaterial()
{
czm_pbrParameters results;
results.diffuseColor = vec3(1.0);
results.roughness = 1.0;
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
results.f0 = REFLECTANCE_DIELECTRIC;
return results;
}
`;var lG=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
vec4 czm_depthClamp(vec4 coords)
{
#ifndef LOG_DEPTH
#ifdef GL_EXT_frag_depth
v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;
coords.z = 0.0;
#else
coords.z = min(coords.z, coords.w);
#endif
#endif
return coords;
}
`;var cG=`mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)
{
vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));
vec3 tangentEC = normalize(czm_normal3D * tangentMC);
vec3 bitangentEC = normalize(cross(normalEC, tangentEC));
return mat3(
tangentEC.x,   tangentEC.y,   tangentEC.z,
bitangentEC.x, bitangentEC.y, bitangentEC.z,
normalEC.x,    normalEC.y,    normalEC.z);
}
`;var fG=`bool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)
{
vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;
return (dot(scaled, scaled) <= 1.0);
}
`;var hG=`vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)
{
return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);
}
`;var dG=`bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec4(epsilon)));
}
bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec3(epsilon)));
}
bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec2(epsilon)));
}
bool czm_equalsEpsilon(float left, float right, float epsilon) {
return (abs(left - right) <= epsilon);
}
`;var pG=`vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)
{
vec4 p = positionEC;
vec4 zEyeOffset = normalize(p) * eyeOffset.z;
p.xy += eyeOffset.xy + zEyeOffset.xy;
p.z += zEyeOffset.z;
return p;
}
`;var mG=`vec4 czm_eyeToWindowCoordinates(vec4 positionEC)
{
vec4 q = czm_projection * positionEC;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var gG=`float czm_fastApproximateAtan(float x) {
return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);
}
float czm_fastApproximateAtan(float x, float y) {
float t = abs(x);
float opposite = abs(y);
float adjacent = max(t, opposite);
opposite = min(t, opposite);
t = czm_fastApproximateAtan(opposite / adjacent);
t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);
t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);
t = czm_branchFreeTernary(y < 0.0, -t, t);
return t;
}
`;var _G=`vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-(scalar * scalar));
return mix(color, fogColor, fog);
}
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));
return mix(color, fogColor, fog);
}
`;var yG=`vec3 czm_gammaCorrect(vec3 color) {
#ifdef HDR
color = pow(color, vec3(czm_gamma));
#endif
return color;
}
vec4 czm_gammaCorrect(vec4 color) {
#ifdef HDR
color.rgb = pow(color.rgb, vec3(czm_gamma));
#endif
return color;
}
`;var vG=`vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)
{
return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);
}
`;var CG=`czm_material czm_getDefaultMaterial(czm_materialInput materialInput)
{
czm_material material;
material.diffuse = vec3(0.0);
material.specular = 0.0;
material.shininess = 1.0;
material.normal = materialInput.normalEC;
material.emission = vec3(0.0);
material.alpha = 1.0;
return material;
}
`;var xG=`float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)
{
return max(dot(lightDirectionEC, normalEC), 0.0);
}
`;var wG=`float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)
{
vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);
float specular = max(dot(toReflectedLight, toEyeEC), 0.0);
return pow(specular, max(shininess, czm_epsilon2));
}
`;var EG=`vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)
{
float cosAngle = cos(angleInRadians);
float sinAngle = sin(angleInRadians);
vec2 s0 = vec2(1.0/17.0, 0.0);
vec2 s1 = vec2(-1.0/29.0, 0.0);
vec2 s2 = vec2(1.0/101.0, 1.0/59.0);
vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);
s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));
s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));
s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));
s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));
vec2 uv0 = (uv/103.0) + (time * s0);
vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);
vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);
vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);
uv0 = fract(uv0);
uv1 = fract(uv1);
uv2 = fract(uv2);
uv3 = fract(uv3);
vec4 noise = (texture2D(normalMap, uv0)) +
(texture2D(normalMap, uv1)) +
(texture2D(normalMap, uv2)) +
(texture2D(normalMap, uv3));
return ((noise / 4.0) - 0.5) * 2.0;
}
`;var TG=`const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 czm_HSBToRGB(vec3 hsb)
{
vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);
return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);
}
`;var SG=`vec3 hueToRGB(float hue)
{
float r = abs(hue * 6.0 - 3.0) - 1.0;
float g = 2.0 - abs(hue * 6.0 - 2.0);
float b = 2.0 - abs(hue * 6.0 - 4.0);
return clamp(vec3(r, g, b), 0.0, 1.0);
}
vec3 czm_HSLToRGB(vec3 hsl)
{
vec3 rgb = hueToRGB(hsl.x);
float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;
return (rgb - 0.5) * c + hsl.z;
}
`;var AG=`vec3 czm_hue(vec3 rgb, float adjustment)
{
const mat3 toYIQ = mat3(0.299,     0.587,     0.114,
0.595716, -0.274453, -0.321263,
0.211456, -0.522591,  0.311135);
const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,
1.0, -0.2721, -0.6474,
1.0, -1.107,   1.7046);
vec3 yiq = toYIQ * rgb;
float hue = atan(yiq.z, yiq.y) + adjustment;
float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);
vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));
return toRGB * color;
}
`;var bG=`vec3 czm_inverseGamma(vec3 color) {
return pow(color, vec3(1.0 / czm_gamma));
}
`;var IG=`bool czm_isEmpty(czm_raySegment interval)
{
return (interval.stop < 0.0);
}
`;var DG=`bool czm_isFull(czm_raySegment interval)
{
return (interval.start == 0.0 && interval.stop == czm_infinity);
}
`;var PG=`float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)
{
float sinLatitude = sin(latitude);
float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));
return (mercatorY - southMercatorY) * oneOverMercatorHeight;
}
`;var MG=`vec3 czm_linearToSrgb(vec3 linearIn)
{
return pow(linearIn, vec3(1.0/2.2));
}
vec4 czm_linearToSrgb(vec4 linearIn)
{
vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));
return vec4(srgbOut, linearIn.a);
}
`;var LG=`float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {
return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);
}
`;var RG=`float czm_luminance(vec3 rgb)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
return dot(rgb, W);
}
`;var OG=`float czm_metersPerPixel(vec4 positionEC, float pixelRatio)
{
float width = czm_viewport.z;
float height = czm_viewport.w;
float pixelWidth;
float pixelHeight;
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)
{
float frustumWidth = right - left;
float frustumHeight = top - bottom;
pixelWidth = frustumWidth / width;
pixelHeight = frustumHeight / height;
}
else
{
float distanceToPixel = -positionEC.z;
float inverseNear = 1.0 / czm_currentFrustum.x;
float tanTheta = top * inverseNear;
pixelHeight = 2.0 * distanceToPixel * tanTheta / height;
tanTheta = right * inverseNear;
pixelWidth = 2.0 * distanceToPixel * tanTheta / width;
}
return max(pixelWidth, pixelHeight) * pixelRatio;
}
float czm_metersPerPixel(vec4 positionEC)
{
return czm_metersPerPixel(positionEC, czm_pixelRatio);
}
`;var NG=`vec4 czm_modelToWindowCoordinates(vec4 position)
{
vec4 q = czm_modelViewProjection * position;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var BG=`vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 target = left * right;
float leftLuminance = dot(left, W);
float rightLuminance = dot(right, W);
float targetLuminance = dot(target, W);
return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;
}
`;var FG=`float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)
{
float valueAtMin = nearFarScalar.y;
float valueAtMax = nearFarScalar.w;
float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;
float farDistanceSq = nearFarScalar.z * nearFarScalar.z;
float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);
t = pow(clamp(t, 0.0, 1.0), 0.2);
return mix(valueAtMin, valueAtMax, t);
}
`;var zG=`vec3 czm_octDecode(vec2 encoded, float range)
{
if (encoded.x == 0.0 && encoded.y == 0.0) {
return vec3(0.0, 0.0, 0.0);
}
encoded = encoded / range * 2.0 - 1.0;
vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));
if (v.z < 0.0)
{
v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);
}
return normalize(v);
}
vec3 czm_octDecode(vec2 encoded)
{
return czm_octDecode(encoded, 255.0);
}
vec3 czm_octDecode(float encoded)
{
float temp = encoded / 256.0;
float x = floor(temp);
float y = (temp - x) * 256.0;
return czm_octDecode(vec2(x, y));
}
void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)
{
float temp = encoded.x / 65536.0;
float x = floor(temp);
float encodedFloat1 = (temp - x) * 65536.0;
temp = encoded.y / 65536.0;
float y = floor(temp);
float encodedFloat2 = (temp - y) * 65536.0;
vector1 = czm_octDecode(encodedFloat1);
vector2 = czm_octDecode(encodedFloat2);
vector3 = czm_octDecode(vec2(x, y));
}
`;var VG=`vec4 czm_packDepth(float depth)
{
vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;
enc = fract(enc);
enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
return enc;
}
`;var kG=`vec3 lambertianDiffuse(vec3 diffuseColor)
{
return diffuseColor / czm_pi;
}
vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)
{
return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}
float smithVisibilityG1(float NdotV, float roughness)
{
float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
return NdotV / (NdotV * (1.0 - k) + k);
}
float smithVisibilityGGX(float roughness, float NdotL, float NdotV)
{
return (
smithVisibilityG1(NdotL, roughness) *
smithVisibilityG1(NdotV, roughness)
);
}
float GGX(float roughness, float NdotH)
{
float roughnessSquared = roughness * roughness;
float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
return roughnessSquared / (czm_pi * f * f);
}
vec3 czm_pbrLighting(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
)
{
vec3 v = -normalize(positionEC);
vec3 l = normalize(lightDirectionEC);
vec3 h = normalize(v + l);
vec3 n = normalEC;
float NdotL = clamp(dot(n, l), 0.001, 1.0);
float NdotV = abs(dot(n, v)) + 0.001;
float NdotH = clamp(dot(n, h), 0.0, 1.0);
float LdotH = clamp(dot(l, h), 0.0, 1.0);
float VdotH = clamp(dot(v, h), 0.0, 1.0);
vec3 f0 = pbrParameters.f0;
float reflectance = max(max(f0.r, f0.g), f0.b);
vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
vec3 F = fresnelSchlick2(f0, f90, VdotH);
float alpha = pbrParameters.roughness;
float G = smithVisibilityGGX(alpha, NdotL, NdotV);
float D = GGX(alpha, NdotH);
vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
vec3 diffuseColor = pbrParameters.diffuseColor;
vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
return (diffuseContribution + specularContribution) * NdotL * lightColorHdr;
}
`;var GG=`czm_pbrParameters czm_pbrMetallicRoughnessMaterial(
vec3 baseColor,
float metallic,
float roughness
)
{
czm_pbrParameters results;
roughness = clamp(roughness, 0.0, 1.0);
results.roughness = roughness * roughness;
metallic = clamp(metallic, 0.0, 1.0);
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
vec3 f0 = mix(REFLECTANCE_DIELECTRIC, baseColor, metallic);
results.f0 = f0;
results.diffuseColor = baseColor * (1.0 - f0) * (1.0 - metallic);
return results;
}
`;var UG=`czm_pbrParameters czm_pbrSpecularGlossinessMaterial(
vec3 diffuse,
vec3 specular,
float glossiness
)
{
czm_pbrParameters results;
float roughness = 1.0 - glossiness;
results.roughness = roughness * roughness;
results.diffuseColor = diffuse * (1.0 - max(max(specular.r, specular.g), specular.b));
results.f0 = specular;
return results;
}
`;var HG=`float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)
{
return czm_getLambertDiffuse(lightDirectionEC, material.normal);
}
float czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)
{
return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);
}
vec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);
}
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_phong(vec3 toEye, czm_material material)
{
return czm_phong(toEye, material,czm_lightDirectionEC);
}
vec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 ambient = vec3(0.0);
vec3 color = ambient + material.emission;
color += material.diffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
`;var qG=`float czm_planeDistance(vec4 plane, vec3 point) {
return (dot(plane.xyz, point) + plane.w);
}
float czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {
return (dot(planeNormal, point) + planeDistance);
}
`;var WG=`vec3 czm_pointAlongRay(czm_ray ray, float time)
{
return ray.origin + (time * ray.direction);
}
`;var YG=`czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)
{
vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;
vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;
q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;
float q2 = dot(q, q);
float qw = dot(q, w);
if (q2 > 1.0)
{
if (qw >= 0.0)
{
return czm_emptyRaySegment;
}
else
{
float qw2 = qw * qw;
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
if (qw2 < product)
{
return czm_emptyRaySegment;
}
else if (qw2 > product)
{
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
float root0 = temp / w2;
float root1 = difference / temp;
if (root0 < root1)
{
czm_raySegment i = czm_raySegment(root0, root1);
return i;
}
else
{
czm_raySegment i = czm_raySegment(root1, root0);
return i;
}
}
else
{
float root = sqrt(difference / w2);
czm_raySegment i = czm_raySegment(root, root);
return i;
}
}
}
else if (q2 < 1.0)
{
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
czm_raySegment i = czm_raySegment(0.0, temp / w2);
return i;
}
else
{
if (qw < 0.0)
{
float w2 = dot(w, w);
czm_raySegment i = czm_raySegment(0.0, -qw / w2);
return i;
}
else
{
return czm_emptyRaySegment;
}
}
}
`;var XG=`czm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)
{
vec3 o = ray.origin;
vec3 d = ray.direction;
vec3 oc = o - center;
float a = dot(d, d);
float b = 2.0 * dot(d, oc);
float c = dot(oc, oc) - (radius * radius);
float det = (b * b) - (4.0 * a * c);
if (det < 0.0) {
return czm_emptyRaySegment;
}
float sqrtDet = sqrt(det);
float t0 = (-b - sqrtDet) / (2.0 * a);
float t1 = (-b + sqrtDet) / (2.0 * a);
czm_raySegment result = czm_raySegment(t0, t1);
return result;
}
`;var jG=`float czm_readDepth(sampler2D depthTexture, vec2 texCoords)
{
return czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);
}
`;var KG=`float czm_readNonPerspective(float value, float oneOverW) {
return value * oneOverW;
}
vec2 czm_readNonPerspective(vec2 value, float oneOverW) {
return value * oneOverW;
}
vec3 czm_readNonPerspective(vec3 value, float oneOverW) {
return value * oneOverW;
}
vec4 czm_readNonPerspective(vec4 value, float oneOverW) {
return value * oneOverW;
}
`;var ZG=`float czm_reverseLogDepth(float logZ)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
return far * (1.0 - near / (depthFromNear + near)) / (far - near);
#endif
return logZ;
}
`;var QG=`const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec3 czm_RGBToHSB(vec3 rgb)
{
vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));
vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));
float d = q.x - min(q.w, q.y);
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);
}
`;var JG=`vec3 RGBtoHCV(vec3 rgb)
{
vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);
vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);
float c = q.x - min(q.w, q.y);
float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);
return vec3(h, c, q.x);
}
vec3 czm_RGBToHSL(vec3 rgb)
{
vec3 hcv = RGBtoHCV(rgb);
float l = hcv.z - hcv.y * 0.5;
float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);
return vec3(hcv.x, s, l);
}
`;var $G=`vec3 czm_RGBToXYZ(vec3 rgb)
{
const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,
0.3576, 0.7152, 0.1192,
0.1805, 0.0722, 0.9505);
vec3 xyz = RGB2XYZ * rgb;
vec3 Yxy;
Yxy.r = xyz.g;
float temp = dot(vec3(1.0), xyz);
Yxy.gb = xyz.rg / temp;
return Yxy;
}
`;var eU=`void czm_rollerShutter(vec2 coord,vec4 region)
{
vec2 st = coord / czm_viewport.zw;
if(st.x < region.x || st.x > region.z){
discard;
}
if(st.y < region.y || st.y > region.w){
discard;
}
}
`;var tU=`float czm_round(float value) {
return floor(value + 0.5);
}
vec2 czm_round(vec2 value) {
return floor(value + 0.5);
}
vec3 czm_round(vec3 value) {
return floor(value + 0.5);
}
vec4 czm_round(vec4 value) {
return floor(value + 0.5);
}
`;var nU=`vec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)
{
direction /= dot(vec3(1.0), abs(direction));
vec2 rev = abs(direction.zx) - vec2(1.0);
vec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,
direction.z < 0.0 ? rev.y : -rev.y);
vec2 uv = direction.y < 0.0 ? neg : direction.xz;
vec2 coord = 0.5 * uv + vec2(0.5);
vec2 pixel = 1.0 / textureSize;
if (lod > 0.0)
{
float scale = 1.0 / pow(2.0, lod);
float offset = ((textureSize.y + 1.0) / textureSize.x);
coord.x *= offset;
coord *= scale;
coord.x += offset + pixel.x;
coord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;
}
else
{
coord.x *= (textureSize.y / textureSize.x);
}
#ifndef OES_texture_float_linear
vec3 color1 = texture2D(projectedMap, coord + vec2(0.0, pixel.y)).rgb;
vec3 color2 = texture2D(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;
vec3 color3 = texture2D(projectedMap, coord + pixel).rgb;
vec3 color4 = texture2D(projectedMap, coord).rgb;
vec2 texturePosition = coord * textureSize;
float fu = fract(texturePosition.x);
float fv = fract(texturePosition.y);
vec3 average1 = mix(color4, color2, fu);
vec3 average2 = mix(color1, color3, fu);
vec3 color = mix(average1, average2, fv);
#else
vec3 color = texture2D(projectedMap, coord).rgb;
#endif
return color;
}
vec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {
float currentLod = floor(lod + 0.5);
float nextLod = min(currentLod + 1.0, maxLod);
vec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);
vec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);
return mix(colorNextLod, colorCurrentLod, nextLod - lod);
}
`;var rU=`vec3 czm_saturation(vec3 rgb, float adjustment)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 intensity = vec3(dot(rgb, W));
return mix(intensity, rgb, adjustment);
}
`;var iU=`float czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)
{
return czm_unpackDepth(textureCube(shadowMap, d));
}
float czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)
{
#ifdef USE_SHADOW_DEPTH_TEXTURE
return texture2D(shadowMap, uv).r;
#else
return czm_unpackDepth(texture2D(shadowMap, uv));
#endif
}
float czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
float czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
`;var oU=`float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)
{
#ifdef USE_NORMAL_SHADING
#ifdef USE_NORMAL_SHADING_SMOOTH
float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);
#else
float strength = step(0.0, nDotL);
#endif
visibility *= strength;
#endif
visibility = max(visibility, darkness);
return visibility;
}
#ifdef USE_CUBE_MAP_SHADOW
float czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec3 uvw = shadowParameters.texCoords;
depth -= depthBias;
float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#else
float czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec2 uv = shadowParameters.texCoords;
depth -= depthBias;
#ifdef USE_SOFT_SHADOWS
vec2 texelStepSize = shadowParameters.texelStepSize;
float radius = 1.0;
float dx0 = -texelStepSize.x * radius;
float dy0 = -texelStepSize.y * radius;
float dx1 = texelStepSize.x * radius;
float dy1 = texelStepSize.y * radius;
float visibility = (
czm_shadowDepthCompare(shadowMap, uv, depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)
) * (1.0 / 9.0);
#else
float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);
#endif
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#endif
`;var aU=`float czm_signNotZero(float value)
{
return value >= 0.0 ? 1.0 : -1.0;
}
vec2 czm_signNotZero(vec2 value)
{
return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));
}
vec3 czm_signNotZero(vec3 value)
{
return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));
}
vec4 czm_signNotZero(vec4 value)
{
return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));
}
`;var sU=`vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])
{
vec3 L00 = coefficients[0];
vec3 L1_1 = coefficients[1];
vec3 L10 = coefficients[2];
vec3 L11 = coefficients[3];
vec3 L2_2 = coefficients[4];
vec3 L2_1 = coefficients[5];
vec3 L20 = coefficients[6];
vec3 L21 = coefficients[7];
vec3 L22 = coefficients[8];
float x = normal.x;
float y = normal.y;
float z = normal.z;
return
L00
+ L1_1 * y
+ L10 * z
+ L11 * x
+ L2_2 * (y * x)
+ L2_1 * (y * z)
+ L20 * (3.0 * z * z - 1.0)
+ L21 * (z * x)
+ L22 * (x * x - y * y);
}
`;var uU=`vec3 czm_srgbToLinear(vec3 srgbIn)
{
return pow(srgbIn, vec3(2.2));
}
vec4 czm_srgbToLinear(vec4 srgbIn)
{
vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
return vec4(linearOut, srgbIn.a);
}
`;var lU=`mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)
{
vec3 normal = normalize(normalEC);
vec3 tangent = normalize(tangentEC);
vec3 bitangent = normalize(bitangentEC);
return mat3(tangent.x  , tangent.y  , tangent.z,
bitangent.x, bitangent.y, bitangent.z,
normal.x   , normal.y   , normal.z);
}
`;var cU=`vec4 czm_transformPlane(vec4 plane, mat4 transform) {
vec4 transformedPlane = transform * plane;
float normalMagnitude = length(transformedPlane.xyz);
return transformedPlane / normalMagnitude;
}
`;var fU=`vec4 czm_transformPlaneOld(vec4 clippingPlane, mat4 transform) {
vec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);
vec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;
vec4 transformedPlane;
transformedPlane.xyz = transformedDirection;
transformedPlane.w = -dot(transformedDirection, transformedPosition);
return transformedPlane;
}
`;var hU=`vec4 czm_translateRelativeToEye(vec3 high, vec3 low)
{
vec3 highDifference = high - czm_encodedCameraPositionMCHigh;
vec3 lowDifference = low - czm_encodedCameraPositionMCLow;
return vec4(highDifference + lowDifference, 1.0);
}
`;var dU=`vec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);
}
diffuse = clamp(diffuse, 0.0, 1.0);
float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_translucentPhong(vec3 toEye, czm_material material)
{
return czm_translucentPhong(toEye, material, czm_lightDirectionEC);
}
`;var pU=`mat2 czm_transpose(mat2 matrix)
{
return mat2(
matrix[0][0], matrix[1][0],
matrix[0][1], matrix[1][1]);
}
mat3 czm_transpose(mat3 matrix)
{
return mat3(
matrix[0][0], matrix[1][0], matrix[2][0],
matrix[0][1], matrix[1][1], matrix[2][1],
matrix[0][2], matrix[1][2], matrix[2][2]);
}
mat4 czm_transpose(mat4 matrix)
{
return mat4(
matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],
matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],
matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],
matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);
}
`;var mU=`float czm_unpackDepth(vec4 packedDepth)
{
return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));
}
`;var gU=`float czm_unpackFloat(vec4 packedFloat)
{
packedFloat = floor(packedFloat * 255.0 + 0.5);
float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;
float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;
if (exponent == -127.0)
{
return 0.0;
}
float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);
float result = sign * exp2(exponent - 23.0) * mantissa;
return result;
}
`;var _U=`int czm_unpackUint(float packedValue) {
float rounded = czm_round(packedValue * 255.0);
return int(rounded);
}
int czm_unpackUint(vec2 packedValue) {
vec2 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec2(1.0, 256.0)));
}
int czm_unpackUint(vec3 packedValue) {
vec3 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));
}
int czm_unpackUint(vec4 packedValue) {
vec4 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));
}
`;var yU=`float czm_valueTransform(float offset, float scale, float value) {
return scale * value + offset;
}
vec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {
return scale * value + offset;
}
vec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {
return scale * value + offset;
}
vec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {
return scale * value + offset;
}
mat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {
return matrixCompMult(scale, value) + offset;
}
mat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {
return matrixCompMult(scale, value) + offset;
}
mat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {
return matrixCompMult(scale, value) + offset;
}
`;var vU=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef SHADOW_MAP
varying vec3 v_logPositionEC;
#endif
#endif
vec4 czm_updatePositionDepth(vec4 coords) {
#if defined(LOG_DEPTH)
#ifdef SHADOW_MAP
vec3 logPositionEC = (czm_inverseProjection * coords).xyz;
v_logPositionEC = logPositionEC;
#endif
coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;
#endif
return coords;
}
void czm_vertexLogDepth()
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;
gl_Position = czm_updatePositionDepth(gl_Position);
#endif
}
void czm_vertexLogDepth(vec4 clipCoords)
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;
czm_updatePositionDepth(clipCoords);
#endif
}
`;var CU=`vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)
{
float x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;
float y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;
float z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
vec4 q = vec4(x, y, z, 1.0);
q /= fragmentCoordinate.w;
if (!(czm_inverseProjection == mat4(0.0)))
{
q = czm_inverseProjection * q;
}
else
{
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
q.x = (q.x * (right - left) + left + right) * 0.5;
q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
q.z = (q.z * (near - far) - near - far) * 0.5;
q.w = 1.0;
}
return q;
}
vec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
float depthFromCamera = depthFromNear + near;
vec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
eyeCoordinate.w = 1.0 / depthFromCamera;
return eyeCoordinate;
#else
vec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
#endif
return eyeCoordinate;
}
`;var xU=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
void czm_writeDepthClamp()
{
#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
gl_FragDepthEXT = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);
#endif
}
`;var wU=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef POLYGON_OFFSET
uniform vec2 u_polygonOffset;
#endif
#endif
void czm_writeLogDepth(float depth)
{
#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH)
if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {
discard;
}
#ifdef POLYGON_OFFSET
float factor = u_polygonOffset[0];
float units = u_polygonOffset[1];
#ifdef GL_OES_standard_derivatives
float x = dFdx(depth);
float y = dFdy(depth);
float m = sqrt(x * x + y * y);
depth += m * factor;
#endif
#endif
gl_FragDepthEXT = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;
#ifdef POLYGON_OFFSET
gl_FragDepthEXT += czm_epsilon7 * units;
#endif
#endif
}
void czm_writeLogDepth() {
#ifdef LOG_DEPTH
czm_writeLogDepth(v_depthFromNearPlusOne);
#endif
}
`;var EU=`float czm_writeNonPerspective(float value, float w) {
return value * w;
}
vec2 czm_writeNonPerspective(vec2 value, float w) {
return value * w;
}
vec3 czm_writeNonPerspective(vec3 value, float w) {
return value * w;
}
vec4 czm_writeNonPerspective(vec4 value, float w) {
return value * w;
}
`;var TU=`vec3 czm_XYZToRGB(vec3 Yxy)
{
const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,
-1.5371,  1.8760, -0.2040,
-0.4985,  0.0416,  1.0572);
vec3 xyz;
xyz.r = Yxy.r * Yxy.g / Yxy.b;
xyz.g = Yxy.r;
xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;
return XYZ2RGB * xyz;
}
`;var Xb={czm_degreesPerRadian:n8,czm_depthRange:r8,czm_epsilon1:i8,czm_epsilon2:o8,czm_epsilon3:a8,czm_epsilon4:s8,czm_epsilon5:u8,czm_epsilon6:l8,czm_epsilon7:c8,czm_infinity:f8,czm_oneOverPi:h8,czm_oneOverTwoPi:d8,czm_passCesium3DTile:p8,czm_passCesium3DTileClassification:m8,czm_passCesium3DTileClassificationIgnoreShow:g8,czm_passClassification:_8,czm_passCompute:y8,czm_passEnvironment:v8,czm_passGlobe:C8,czm_passOpaque:x8,czm_passOverlay:w8,czm_passTerrainClassification:E8,czm_passTranslucent:T8,czm_pi:S8,czm_piOverFour:A8,czm_piOverSix:b8,czm_piOverThree:I8,czm_piOverTwo:D8,czm_radiansPerDegree:P8,czm_sceneMode2D:M8,czm_sceneMode3D:L8,czm_sceneModeColumbusView:R8,czm_sceneModeMorphing:O8,czm_solarRadius:N8,czm_threePiOver2:B8,czm_twoPi:F8,czm_webMercatorMaxLatitude:z8,czm_depthRangeStruct:V8,czm_material:k8,czm_materialInput:G8,czm_modelMaterial:U8,czm_modelVertexOutput:H8,czm_pbrParameters:q8,czm_ray:W8,czm_raySegment:Y8,czm_shadowParameters:X8,czm_acesTonemapping:j8,czm_alphaWeight:K8,czm_antialias:Z8,czm_approximateSphericalCoordinates:Q8,czm_backFacing:J8,czm_branchFreeTernary:$8,czm_cascadeColor:eG,czm_cascadeDistance:tG,czm_cascadeMatrix:nG,czm_cascadeWeights:rG,czm_columbusViewMorph:iG,czm_computePosition:oG,czm_cosineAndSine:aG,czm_decompressTextureCoordinates:sG,czm_defaultPbrMaterial:uG,czm_depthClamp:lG,czm_eastNorthUpToEyeCoordinates:cG,czm_ellipsoidContainsPoint:fG,czm_ellipsoidWgs84TextureCoordinates:hG,czm_equalsEpsilon:dG,czm_eyeOffset:pG,czm_eyeToWindowCoordinates:mG,czm_fastApproximateAtan:gG,czm_fog:_G,czm_gammaCorrect:yG,czm_geodeticSurfaceNormal:vG,czm_getDefaultMaterial:CG,czm_getLambertDiffuse:xG,czm_getSpecular:wG,czm_getWaterNoise:EG,czm_HSBToRGB:TG,czm_HSLToRGB:SG,czm_hue:AG,czm_inverseGamma:bG,czm_isEmpty:IG,czm_isFull:DG,czm_latitudeToWebMercatorFraction:PG,czm_linearToSrgb:MG,czm_lineDistance:LG,czm_luminance:RG,czm_metersPerPixel:OG,czm_modelToWindowCoordinates:NG,czm_multiplyWithColorBalance:BG,czm_nearFarScalar:FG,czm_octDecode:zG,czm_packDepth:VG,czm_pbrLighting:kG,czm_pbrMetallicRoughnessMaterial:GG,czm_pbrSpecularGlossinessMaterial:UG,czm_phong:HG,czm_planeDistance:qG,czm_pointAlongRay:WG,czm_rayEllipsoidIntersectionInterval:YG,czm_raySphereIntersectionInterval:XG,czm_readDepth:jG,czm_readNonPerspective:KG,czm_reverseLogDepth:ZG,czm_RGBToHSB:QG,czm_RGBToHSL:JG,czm_RGBToXYZ:$G,czm_rollerShutter:eU,czm_round:tU,czm_sampleOctahedralProjection:nU,czm_saturation:rU,czm_shadowDepthCompare:iU,czm_shadowVisibility:oU,czm_signNotZero:aU,czm_sphericalHarmonics:sU,czm_srgbToLinear:uU,czm_tangentToEyeSpaceMatrix:lU,czm_transformPlane:cU,czm_transformPlaneOld:fU,czm_translateRelativeToEye:hU,czm_translucentPhong:dU,czm_transpose:pU,czm_unpackDepth:mU,czm_unpackFloat:gU,czm_unpackUint:_U,czm_valueTransform:yU,czm_vertexLogDepth:vU,czm_windowToEyeCoordinates:CU,czm_writeDepthClamp:xU,czm_writeLogDepth:wU,czm_writeNonPerspective:EU,czm_XYZToRGB:TU};function SU(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(t){let n=t.match(/\n/gm).length,r="";for(let o=0;o<n;++o)r+=`
`;return r})}function AU(e,t,n){let r;for(let o=0;o<n.length;++o)n[o].name===e&&(r=n[o]);return _(r)||(t=SU(t),r={name:e,glslSource:t,dependsOn:[],requiredBy:[],evaluated:!1},n.push(r)),r}function bU(e,t){if(e.evaluated)return;e.evaluated=!0;let n=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);_(n)&&n!==null&&(n=n.filter(function(r,o){return n.indexOf(r)===o}),n.forEach(function(r){if(r!==e.name&&Ys._czmBuiltinsAndUniforms.hasOwnProperty(r)){let o=AU(r,Ys._czmBuiltinsAndUniforms[r],t);e.dependsOn.push(o),o.requiredBy.push(e),bU(o,t)}}))}function $ue(e){let t=[],n=[];for(;e.length>0;){let o=e.pop();n.push(o),o.requiredBy.length===0&&t.push(o)}for(;t.length>0;){let o=t.shift();e.push(o);for(let a=0;a<o.dependsOn.length;++a){let s=o.dependsOn[a],u=s.requiredBy.indexOf(o);s.requiredBy.splice(u,1),s.requiredBy.length===0&&t.push(s)}}let r=[];for(let o=0;o<n.length;++o)n[o].requiredBy.length!==0&&r.push(n[o])}function ele(e){let t=[],n=AU("main",e,t);bU(n,t),$ue(t);let r="";for(let o=t.length-1;o>=0;--o)r=`${r+t[o].glslSource}
`;return r.replace(n.glslSource,"")}function IU(e,t,n){let r,o,a="",s=e.sources;if(_(s))for(r=0,o=s.length;r<o;++r)a+=`
#line 0
${s[r]}`;a=SU(a);let u;a=a.replace(/#version\s+(.*?)\n/gm,function(p,g){return u=g,`
`});let l=[];a=a.replace(/#extension.*\n/gm,function(p){return l.push(p),`
`}),a=a.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let c=e.pickColorQualifier;_(c)&&(a=Ys.createPickFragmentShaderSource(a,c));let f="";_(u)&&(f=`#version ${u}
`);let h=l.length;for(r=0;r<h;r++)f+=l[r];t&&(f+=`#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    precision highp int;
#else
    precision mediump float;
    precision mediump int;
    #define highp mediump
#endif

`);let d=e.defines;if(_(d))for(r=0,o=d.length;r<o;++r){let p=d[r];p.length!==0&&(f+=`#define ${p}
`)}return n.webgl2&&(f+=`#define OUTPUT_DECLARATION

`),n.textureFloatLinear&&(f+=`#define OES_texture_float_linear

`),n.floatingPointTexture&&(f+=`#define OES_texture_float

`),e.includeBuiltIns&&(f+=ele(a)),f+=`
#line 0
`,f+=a,n.webgl2&&(f=t8(f,t,!0)),f}function Ys(e){e=T(e,T.EMPTY_OBJECT);let t=e.pickColorQualifier;this.defines=_(e.defines)?e.defines.slice(0):[],this.sources=_(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=T(e.includeBuiltIns,!0)}Ys.prototype.clone=function(){return new Ys({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};Ys.replaceMain=function(e,t){return t=`void ${t}()`,e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)};Ys.prototype.createCombinedVertexShader=function(e){return IU(this,!1,e)};Ys.prototype.createCombinedFragmentShader=function(e){return IU(this,!0,e)};Ys._czmBuiltinsAndUniforms={};for(let e in Xb)Xb.hasOwnProperty(e)&&(Ys._czmBuiltinsAndUniforms[e]=Xb[e]);for(let e in rC)if(rC.hasOwnProperty(e)){let t=rC[e];typeof t.getDeclaration=="function"&&(Ys._czmBuiltinsAndUniforms[e]=t.getDeclaration(e))}Ys.createPickVertexShaderSource=function(e){return`${Ys.replaceMain(e,"czm_old_main")}
attribute vec4 pickColor; 
varying vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    czm_pickColor = pickColor; 
}`};Ys.createPickFragmentShaderSource=function(e,t){let n=Ys.replaceMain(e,"czm_old_main"),r=`${t} vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    if (gl_FragColor.a == 0.0) { 
       discard; 
    } 
    gl_FragColor = czm_pickColor; 
}`;return`${n}
${r}`};function tle(e,t){let n=e.defines,r=n.length;for(let o=0;o<r;++o)if(n[o]===t)return!0;return!1}function DU(e,t){let n=e.sources,r=n.length;for(let o=0;o<r;++o)if(n[o].indexOf(t)!==-1)return!0;return!1}function PU(e,t){let n=t.length;for(let r=0;r<n;++r){let o=t[r];if(DU(e,o))return o}}var nle=["v_normalEC","v_normal"];Ys.findNormalVarying=function(e){return DU(e,"#ifdef HAS_NORMALS")?tle(e,"HAS_NORMALS")?"v_normalEC":void 0:PU(e,nle)};var rle=["v_positionEC"];Ys.findPositionVarying=function(e){return PU(e,rle)};var xt=Ys;var ile={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},N_=Object.freeze(ile);function YO(e){e=T(e,T.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=T(e.primitiveType,rn.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=T(e.geometryType,N_.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}YO.computeNumberOfVertices=function(e){let t=-1;for(let n in e.attributes)if(e.attributes.hasOwnProperty(n)&&_(e.attributes[n])&&_(e.attributes[n].values)){let r=e.attributes[n];t=r.values.length/r.componentsPerAttribute}return t};var ole=new ce,ale=new x,MU=new U,sle=[new ce,new ce,new ce],ule=[new X,new X,new X],lle=[new X,new X,new X],cle=new x,fle=new je,hle=new U,dle=new Ma;YO._textureCoordinateRotationPoints=function(e,t,n,r){let o,a=ln.center(r,ole),s=ce.toCartesian(a,n,ale),u=yn.eastNorthUpToFixedFrame(s,n,MU),l=U.inverse(u,MU),c=ule,f=sle;f[0].longitude=r.west,f[0].latitude=r.south,f[1].longitude=r.west,f[1].latitude=r.north,f[2].longitude=r.east,f[2].latitude=r.south;let h=cle;for(o=0;o<3;o++)ce.toCartesian(f[o],n,h),h=U.multiplyByPointAsVector(l,h,h),c[o].x=h.x,c[o].y=h.y;let d=je.fromAxisAngle(x.UNIT_Z,-t,fle),p=ne.fromQuaternion(d,hle),g=e.length,y=Number.POSITIVE_INFINITY,v=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY,C=Number.NEGATIVE_INFINITY;for(o=0;o<g;o++)h=U.multiplyByPointAsVector(l,e[o],h),h=ne.multiplyByVector(p,h,h),y=Math.min(y,h.x),v=Math.min(v,h.y),w=Math.max(w,h.x),C=Math.max(C,h.y);let E=Ma.fromRotation(t,dle),S=lle;S[0].x=y,S[0].y=v,S[1].x=y,S[1].y=C,S[2].x=w,S[2].y=v;let A=c[0],D=c[2].x-A.x,P=c[1].y-A.y;for(o=0;o<3;o++){let b=S[o];Ma.multiplyByVector(E,b,b),b.x=(b.x-A.x)/D,b.y=(b.y-A.y)/P}let M=S[0],I=S[1],O=S[2],m=new Array(6);return X.pack(M,m),X.pack(I,m,2),X.pack(O,m,4),m};var Ci=YO;function ple(e,t,n,r){let o=_(t.vertexBuffer),a=_(t.value),s=t.value?t.value.length:t.componentsPerAttribute,u={index:T(t.index,n),enabled:T(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:a?t.value.slice(0):void 0,componentsPerAttribute:s,componentDatatype:T(t.componentDatatype,ie.FLOAT),normalize:T(t.normalize,!1),offsetInBytes:T(t.offsetInBytes,0),strideInBytes:T(t.strideInBytes,0),instanceDivisor:T(t.instanceDivisor,0)};if(o)u.vertexAttrib=function(l){let c=this.index;l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),l.vertexAttribPointer(c,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),l.enableVertexAttribArray(c),this.instanceDivisor>0&&(r.glVertexAttribDivisor(c,this.instanceDivisor),r._vertexAttribDivisors[c]=this.instanceDivisor,r._previousDrawInstanced=!0)},u.disableVertexAttribArray=function(l){l.disableVertexAttribArray(this.index),this.instanceDivisor>0&&r.glVertexAttribDivisor(n,0)};else{switch(u.componentsPerAttribute){case 1:u.vertexAttrib=function(l){l.vertexAttrib1fv(this.index,this.value)};break;case 2:u.vertexAttrib=function(l){l.vertexAttrib2fv(this.index,this.value)};break;case 3:u.vertexAttrib=function(l){l.vertexAttrib3fv(this.index,this.value)};break;case 4:u.vertexAttrib=function(l){l.vertexAttrib4fv(this.index,this.value)};break}u.disableVertexAttribArray=function(l){}}e.push(u)}function RU(e,t,n){for(let r=0;r<t.length;++r){let o=t[r];o.enabled&&o.vertexAttrib(e)}_(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function wm(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=t._gl,r=e.attributes,o=e.indexBuffer,a,s=[],u=1,l=!1,c=!1,f=r.length;for(a=0;a<f;++a)ple(s,r[a],a,t);for(f=s.length,a=0;a<f;++a){let d=s[a];if(_(d.vertexBuffer)&&d.instanceDivisor===0){let p=d.strideInBytes||d.componentsPerAttribute*ie.getSizeInBytes(d.componentDatatype);u=d.vertexBuffer.sizeInBytes/p;break}}for(a=0;a<f;++a)s[a].instanceDivisor>0&&(l=!0),_(s[a].value)&&(c=!0);let h;t.vertexArrayObject&&(h=t.glCreateVertexArray(),t.glBindVertexArray(h),RU(n,s,o),t.glBindVertexArray(null)),this._numberOfVertices=u,this._hasInstancedAttributes=l,this._hasConstantAttributes=c,this._context=t,this._gl=n,this._vao=h,this._attributes=s,this._indexBuffer=o}function LU(e){return e.values.length/e.componentsPerAttribute}function mle(e){return ie.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function gle(e){let t,n,r,o=[];for(n in e)e.hasOwnProperty(n)&&_(e[n])&&_(e[n].values)&&(o.push(n),e[n].componentDatatype===ie.DOUBLE&&(e[n].componentDatatype=ie.FLOAT,e[n].values=ie.createTypedArray(ie.FLOAT,e[n].values)));let a,s=o.length;if(s>0)for(a=LU(e[o[0]]),t=1;t<s;++t){let c=LU(e[o[t]]);if(c!==a)throw new it(`Each attribute list must have the same number of vertices.  Attribute ${o[t]} has a different number of vertices (${c.toString()}) than attribute ${o[0]} (${a.toString()}).`)}o.sort(function(c,f){return ie.getSizeInBytes(e[f].componentDatatype)-ie.getSizeInBytes(e[c].componentDatatype)});let u=0,l={};for(t=0;t<s;++t)n=o[t],r=e[n],l[n]=u,u+=mle(r);if(u>0){let c=ie.getSizeInBytes(e[o[0]].componentDatatype),f=u%c;f!==0&&(u+=c-f);let h=a*u,d=new ArrayBuffer(h),p={};for(t=0;t<s;++t){n=o[t];let g=ie.getSizeInBytes(e[n].componentDatatype);p[n]={pointer:ie.createTypedArray(e[n].componentDatatype,d),index:l[n]/g,strideInComponentType:u/g}}for(t=0;t<a;++t)for(let g=0;g<s;++g){n=o[g],r=e[n];let y=r.values,v=p[n],w=v.pointer,C=r.componentsPerAttribute;for(let E=0;E<C;++E)w[v.index+E]=y[t*C+E];v.index+=v.strideInComponentType}return{buffer:d,offsetsInBytes:l,vertexSizeInBytes:u}}}wm.fromGeometry=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=T(e.geometry,T.EMPTY_OBJECT),r=T(e.bufferUsage,We.DYNAMIC_DRAW),o=T(e.attributeLocations,T.EMPTY_OBJECT),a=T(e.interleave,!1),s=e.vertexArrayAttributes,u,l,c,f=_(s)?s:[],h=n.attributes;if(a){let g=gle(h);if(_(g)){c=ki.createVertexBuffer({context:t,typedArray:g.buffer,usage:r});let y=g.offsetsInBytes,v=g.vertexSizeInBytes;for(u in h)h.hasOwnProperty(u)&&_(h[u])&&(l=h[u],_(l.values)?f.push({index:o[u],vertexBuffer:c,componentDatatype:l.componentDatatype,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize,offsetInBytes:y[u],strideInBytes:v}):f.push({index:o[u],value:l.value,componentDatatype:l.componentDatatype,normalize:l.normalize}))}}else for(u in h)if(h.hasOwnProperty(u)&&_(h[u])){l=h[u];let g=l.componentDatatype;g===ie.DOUBLE&&(g=ie.FLOAT),c=void 0,_(l.values)&&(c=ki.createVertexBuffer({context:t,typedArray:ie.createTypedArray(g,l.values),usage:r})),f.push({index:o[u],vertexBuffer:c,value:l.value,componentDatatype:g,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize})}let d,p=n.indices;return _(p)&&(Ci.computeNumberOfVertices(n)>=z.SIXTY_FOUR_KILOBYTES&&t.elementIndexUint?d=ki.createIndexBuffer({context:t,typedArray:new Uint32Array(p),usage:r,indexDatatype:Rr.UNSIGNED_INT}):d=ki.createIndexBuffer({context:t,typedArray:new Uint16Array(p),usage:r,indexDatatype:Rr.UNSIGNED_SHORT})),new wm({context:t,attributes:f,indexBuffer:d})};Object.defineProperties(wm.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});wm.prototype.getAttribute=function(e){return this._attributes[e]};function _le(e){let t=e._context,n=e._hasInstancedAttributes;if(!n&&!t._previousDrawInstanced)return;t._previousDrawInstanced=n;let r=t._vertexAttribDivisors,o=e._attributes,a=Kt.maximumVertexAttributes,s;if(n){let u=o.length;for(s=0;s<u;++s){let l=o[s];if(l.enabled){let c=l.instanceDivisor,f=l.index;c!==r[f]&&(t.glVertexAttribDivisor(f,c),r[f]=c)}}}else for(s=0;s<a;++s)r[s]>0&&(t.glVertexAttribDivisor(s,0),r[s]=0)}function yle(e,t){let n=e._attributes,r=n.length;for(let o=0;o<r;++o){let a=n[o];a.enabled&&_(a.value)&&a.vertexAttrib(t)}}wm.prototype._bind=function(){_(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&_le(this),this._hasConstantAttributes&&yle(this,this._gl)):RU(this._gl,this._attributes,this._indexBuffer)};wm.prototype._unBind=function(){if(_(this._vao))this._context.glBindVertexArray(null);else{let e=this._attributes,t=this._gl;for(let n=0;n<e.length;++n){let r=e[n];r.enabled&&r.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}};wm.prototype.isDestroyed=function(){return!1};wm.prototype.destroy=function(){let e=this._attributes;for(let n=0;n<e.length;++n){let r=e[n].vertexBuffer;_(r)&&!r.isDestroyed()&&r.vertexArrayDestroyable&&r.destroy()}let t=this._indexBuffer;return _(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),_(this._vao)&&this._context.glDeleteVertexArray(this._vao),ot(this)};var Kh=wm;function Is(e,t,n,r){let o=Is._verifyAttributes(t);n=T(n,0);let a=[],s={},u,l,c=o.length;for(let h=0;h<c;++h){let d=o[h];if(d.vertexBuffer){a.push(d);continue}l=d.usage,u=s[l],_(u)||(u=s[l]=[]),u.push(d)}function f(h,d){return ie.getSizeInBytes(d.componentDatatype)-ie.getSizeInBytes(h.componentDatatype)}this._allBuffers=[];for(l in s)if(s.hasOwnProperty(l)){u=s[l],u.sort(f);let h=Is._vertexSizeInBytes(u),d=u[0].usage,p={vertexSizeInBytes:h,vertexBuffer:void 0,usage:d,needsCommit:!1,arrayBuffer:void 0,arrayViews:Is._createArrayViews(u,h)};this._allBuffers.push(p)}this._size=0,this._instanced=T(r,!1),this._precreated=a,this._context=e,this.writers=void 0,this.va=void 0,this.resize(n)}Is._verifyAttributes=function(e){let t=[];for(let r=0;r<e.length;++r){let o=e[r],a={index:T(o.index,r),enabled:T(o.enabled,!0),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:T(o.componentDatatype,ie.FLOAT),normalize:T(o.normalize,!1),vertexBuffer:o.vertexBuffer,usage:T(o.usage,We.STATIC_DRAW)};t.push(a)}let n=new Array(t.length);for(let r=0;r<t.length;++r){let a=t[r].index;n[a]=!0}return t};Is._vertexSizeInBytes=function(e){let t=0,n=e.length;for(let s=0;s<n;++s){let u=e[s];t+=u.componentsPerAttribute*ie.getSizeInBytes(u.componentDatatype)}let r=n>0?ie.getSizeInBytes(e[0].componentDatatype):0,o=r>0?t%r:0;return t+=o===0?0:r-o,t};Is._createArrayViews=function(e,t){let n=[],r=0,o=e.length;for(let a=0;a<o;++a){let s=e[a],u=s.componentDatatype;n.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:u,normalize:s.normalize,offsetInBytes:r,vertexSizeInComponentType:t/ie.getSizeInBytes(u),view:void 0}),r+=s.componentsPerAttribute*ie.getSizeInBytes(u)}return n};Is.prototype.resize=function(e){this._size=e;let t=this._allBuffers;this.writers=[];for(let n=0,r=t.length;n<r;++n){let o=t[n];Is._resize(o,this._size),Is._appendWriters(this.writers,o)}XO(this)};Is._resize=function(e,t){if(e.vertexSizeInBytes>0){let n=new ArrayBuffer(t*e.vertexSizeInBytes);if(_(e.arrayBuffer)){let a=new Uint8Array(n),s=new Uint8Array(e.arrayBuffer),u=s.length;for(let l=0;l<u;++l)a[l]=s[l]}let r=e.arrayViews,o=r.length;for(let a=0;a<o;++a){let s=r[a];s.view=ie.createArrayBufferView(s.componentDatatype,n,s.offsetInBytes)}e.arrayBuffer=n}};var vle=[function(e,t,n){return function(r,o){t[r*n]=o,e.needsCommit=!0}},function(e,t,n){return function(r,o,a){let s=r*n;t[s]=o,t[s+1]=a,e.needsCommit=!0}},function(e,t,n){return function(r,o,a,s){let u=r*n;t[u]=o,t[u+1]=a,t[u+2]=s,e.needsCommit=!0}},function(e,t,n){return function(r,o,a,s,u){let l=r*n;t[l]=o,t[l+1]=a,t[l+2]=s,t[l+3]=u,e.needsCommit=!0}}];Is._appendWriters=function(e,t){let n=t.arrayViews,r=n.length;for(let o=0;o<r;++o){let a=n[o];e[a.index]=vle[a.componentsPerAttribute-1](t,a.view,a.vertexSizeInComponentType)}};Is.prototype.commit=function(e){let t=!1,n=this._allBuffers,r,o,a;for(o=0,a=n.length;o<a;++o)r=n[o],t=Cle(this,r)||t;if(t||!_(this.va)){XO(this);let s=this.va=[],u=z.SIXTY_FOUR_KILOBYTES-4,l=_(e)&&!this._instanced?Math.ceil(this._size/u):1;for(let c=0;c<l;++c){let f=[];for(o=0,a=n.length;o<a;++o){r=n[o];let h=c*(r.vertexSizeInBytes*u);Is._appendAttributes(f,r,h,this._instanced)}f=f.concat(this._precreated),s.push({va:new Kh({context:this._context,attributes:f,indexBuffer:e}),indicesCount:1.5*(c!==l-1?u:this._size%u)})}}};function Cle(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;let n=t.vertexBuffer,r=e._size*t.vertexSizeInBytes,o=_(n);if(!o||n.sizeInBytes<r)return o&&n.destroy(),t.vertexBuffer=ki.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}Is._appendAttributes=function(e,t,n,r){let o=t.arrayViews,a=o.length;for(let s=0;s<a;++s){let u=o[s];e.push({index:u.index,enabled:u.enabled,componentsPerAttribute:u.componentsPerAttribute,componentDatatype:u.componentDatatype,normalize:u.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:n+u.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:r?1:0})}};Is.prototype.subCommit=function(e,t){let n=this._allBuffers;for(let r=0,o=n.length;r<o;++r)xle(n[r],e,t)};function xle(e,t,n){if(e.needsCommit&&e.vertexSizeInBytes>0){let r=e.vertexSizeInBytes*t,o=e.vertexSizeInBytes*n;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,r,o),r)}}Is.prototype.endSubCommits=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t)e[t].needsCommit=!1};function XO(e){let t=e.va;if(!_(t))return;let n=t.length;for(let r=0;r<n;++r)t[r].va.destroy();e.va=void 0}Is.prototype.isDestroyed=function(){return!1};Is.prototype.destroy=function(){let e=this._allBuffers;for(let t=0,n=e.length;t<n;++t){let r=e[t];r.vertexBuffer=r.vertexBuffer&&r.vertexBuffer.destroy()}return XO(this),ot(this)};var iC=Is;var jb=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform sampler2D u_atlas;
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_textureCoordinates;
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
float getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)
{
vec2 lookupVector = imageSize * (depthLookupST - adjustedST);
lookupVector = v_rotationMatrix * lookupVector;
vec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y));
vec2 translation = v_originTextureCoordinateAndTranslate.zw;
if (applyTranslate)
{
translation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));
}
vec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st));
if (logDepthOrDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
#ifdef SDF
float getDistance(vec2 position)
{
return texture2D(u_atlas, position).r;
}
vec4 getSDFColor(vec2 position, float outlineWidth, vec4 outlineColor, float smoothing)
{
float distance = getDistance(position);
if (outlineWidth > 0.0)
{
float outlineEdge = clamp(SDF_EDGE - outlineWidth, 0.0, SDF_EDGE);
float outlineFactor = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
vec4 sdfColor = mix(outlineColor, v_color, outlineFactor);
float alpha = smoothstep(outlineEdge - smoothing, outlineEdge + smoothing, distance);
return vec4(sdfColor.rgb, sdfColor.a * alpha);
}
else
{
float alpha = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
return vec4(v_color.rgb, v_color.a * alpha);
}
}
#endif
void main()
{
vec4 color = texture2D(u_atlas, v_textureCoordinates);
#ifdef SDF
float outlineWidth = v_outlineWidth;
vec4 outlineColor = v_outlineColor;
float distance = getDistance(v_textureCoordinates);
#ifdef GL_OES_standard_derivatives
float smoothing = fwidth(distance);
vec2 sampleOffset = 0.354 * vec2(dFdx(v_textureCoordinates) + dFdy(v_textureCoordinates));
vec4 center = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
vec4 color1 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color2 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color3 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color4 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
color = (center + color1 + color2 + color3 + color4)/5.0;
#else
float smoothing = 1.0/32.0;
color = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
#endif
color = czm_gammaCorrect(color);
#else
color = czm_gammaCorrect(color);
color *= czm_gammaCorrect(v_color);
#endif
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
#ifdef VECTOR_TILE
color *= u_highlightColor;
#endif
gl_FragColor = color;
#ifdef LOG_DEPTH
czm_writeLogDepth();
#endif
#ifdef FRAGMENT_DEPTH_CHECK
float temp = v_compressed.y;
temp = temp * SHIFT_RIGHT1;
float temp2 = (temp - floor(temp)) * SHIFT_LEFT1;
bool enableDepthTest = temp2 != 0.0;
bool applyTranslate = floor(temp) != 0.0;
if (enableDepthTest) {
temp = v_compressed.z;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
temp = v_compressed.w;
temp = temp * SHIFT_RIGHT12;
vec2 imageSize;
imageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;
imageSize.x = floor(temp);
vec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;
adjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);
float epsilonEyeDepth = v_compressed.x + czm_epsilon1;
float globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);
if (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)
{
float globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)
{
float globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)
{
discard;
}
}
}
}
#endif
}
`;var Kb=`#ifdef INSTANCED
attribute vec2 direction;
#endif
attribute vec4 positionHighAndScale;
attribute vec4 positionLowAndRotation;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 compressedAttribute2;
attribute vec4 eyeOffset;
attribute vec4 scaleByDistance;
attribute vec4 pixelOffsetScaleByDistance;
attribute vec4 compressedAttribute3;
attribute vec2 sdf;
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
attribute vec4 textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef VECTOR_TILE
attribute float a_batchId;
#endif
varying vec2 v_textureCoordinates;
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
#endif
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
const float UPPER_BOUND = 32768.0;
const float SHIFT_LEFT16 = 65536.0;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_LEFT7 = 128.0;
const float SHIFT_LEFT5 = 32.0;
const float SHIFT_LEFT3 = 8.0;
const float SHIFT_LEFT2 = 4.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
const float SHIFT_RIGHT7 = 1.0 / 128.0;
const float SHIFT_RIGHT5 = 1.0 / 32.0;
const float SHIFT_RIGHT3 = 1.0 / 8.0;
const float SHIFT_RIGHT2 = 1.0 / 4.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
{
vec2 halfSize = imageSize * scale * 0.5;
halfSize *= ((direction * 2.0) - 1.0);
vec2 originTranslate = origin * abs(halfSize);
#if defined(ROTATION) || defined(ALIGNED_AXIS)
if (validAlignedAxis || rotation != 0.0)
{
float angle = rotation;
if (validAlignedAxis)
{
vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);
angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
(projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
}
float cosTheta = cos(angle);
float sinTheta = sin(angle);
rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
halfSize = rotationMatrix * halfSize;
}
else
{
rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
}
#endif
mpp = czm_metersPerPixel(positionEC);
positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
positionEC.xy += (translate + pixelOffset) * mpp;
return positionEC;
}
#ifdef VERTEX_DEPTH_CHECK
float getGlobeDepth(vec4 positionEC)
{
vec4 posWC = czm_eyeToWindowCoordinates(positionEC);
float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));
if (globeDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(posWC.xy, globeDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
void main()
{
vec3 positionHigh = positionHighAndScale.xyz;
vec3 positionLow = positionLowAndRotation.xyz;
float scale = positionHighAndScale.w;
#if defined(ROTATION) || defined(ALIGNED_AXIS)
float rotation = positionLowAndRotation.w;
#else
float rotation = 0.0;
#endif
float compressed = compressedAttribute0.x;
vec2 pixelOffset;
pixelOffset.x = floor(compressed * SHIFT_RIGHT7);
compressed -= pixelOffset.x * SHIFT_LEFT7;
pixelOffset.x -= UPPER_BOUND;
vec2 origin;
origin.x = floor(compressed * SHIFT_RIGHT5);
compressed -= origin.x * SHIFT_LEFT5;
origin.y = floor(compressed * SHIFT_RIGHT3);
compressed -= origin.y * SHIFT_LEFT3;
#ifdef FRAGMENT_DEPTH_CHECK
vec2 depthOrigin = origin.xy;
#endif
origin -= vec2(1.0);
float show = floor(compressed * SHIFT_RIGHT2);
compressed -= show * SHIFT_LEFT2;
#ifdef INSTANCED
vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);
vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);
vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;
#else
vec2 direction;
direction.x = floor(compressed * SHIFT_RIGHT1);
direction.y = compressed - direction.x * SHIFT_LEFT1;
vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);
#endif
float temp = compressedAttribute0.y  * SHIFT_RIGHT8;
pixelOffset.y = -(floor(temp) - UPPER_BOUND);
vec2 translate;
translate.y = (temp - floor(temp)) * SHIFT_LEFT16;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
translate.x = floor(temp) - UPPER_BOUND;
translate.y += (temp - floor(temp)) * SHIFT_LEFT8;
translate.y -= UPPER_BOUND;
temp = compressedAttribute1.x * SHIFT_RIGHT8;
float temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);
vec2 imageSize = vec2(floor(temp), temp2);
#ifdef FRAGMENT_DEPTH_CHECK
float labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));
float applyTranslate = 0.0;
if (labelHorizontalOrigin != 0.0)
{
applyTranslate = 1.0;
labelHorizontalOrigin -= 2.0;
depthOrigin.x = labelHorizontalOrigin + 1.0;
}
depthOrigin = vec2(1.0) - (depthOrigin * 0.5);
#endif
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
temp = compressedAttribute3.w;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
#endif
#ifdef ALIGNED_AXIS
vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));
temp = compressedAttribute2.z * SHIFT_RIGHT5;
bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;
#else
vec3 alignedAxis = vec3(0.0);
bool validAlignedAxis = false;
#endif
vec4 pickColor;
vec4 color;
temp = compressedAttribute2.y;
temp = temp * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute2.x;
temp = temp * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute2.z * SHIFT_RIGHT8;
bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)
float eyeDepth = positionEC.z;
#endif
positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);
positionEC.xyz *= show;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);
scale *= distanceScale;
translate *= distanceScale;
if (scale == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef EYE_DISTANCE_PIXEL_OFFSET
float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);
pixelOffset *= pixelOffsetScale;
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = compressedAttribute3.x;
float farSq = compressedAttribute3.y;
if (lengthSq < nearSq || lengthSq > farSq)
{
positionEC.xyz = vec3(0.0);
}
#endif
mat2 rotationMatrix;
float mpp;
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = compressedAttribute3.z;
#endif
#ifdef VERTEX_DEPTH_CHECK
if (lengthSq < disableDepthTestDistance) {
float depthsilon = 10.0;
vec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;
vec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth1 = getGlobeDepth(pEC1);
if (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)
{
vec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth2 = getGlobeDepth(pEC2);
if (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)
{
vec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth3 = getGlobeDepth(pEC3);
if (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)
{
positionEC.xyz = vec3(0.0);
}
}
}
}
#endif
positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
gl_Position = czm_projection * positionEC;
v_textureCoordinates = textureCoordinates;
#ifdef LOG_DEPTH
czm_vertexLogDepth();
#endif
#ifdef DISABLE_DEPTH_DISTANCE
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = 1.0;
#endif
}
}
#endif
#ifdef FRAGMENT_DEPTH_CHECK
if (sizeInMeters) {
translate /= mpp;
dimensions /= mpp;
imageSize /= mpp;
}
#if defined(ROTATION) || defined(ALIGNED_AXIS)
v_rotationMatrix = rotationMatrix;
#else
v_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
#endif
float enableDepthCheck = 0.0;
if (lengthSq < disableDepthTestDistance)
{
enableDepthCheck = 1.0;
}
float dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));
float dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));
float iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));
float ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));
v_compressed.x = eyeDepth;
v_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;
v_compressed.z = dw * SHIFT_LEFT12 + dh;
v_compressed.w = iw * SHIFT_LEFT12 + ih;
v_originTextureCoordinateAndTranslate.xy = depthOrigin;
v_originTextureCoordinateAndTranslate.zw = translate;
v_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef SDF
vec4 outlineColor;
float outlineWidth;
temp = sdf.x;
temp = temp * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = sdf.y;
temp = temp * SHIFT_RIGHT8;
float temp3 = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineWidth = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.a = floor(temp);
outlineColor /= 255.0;
v_outlineWidth = outlineWidth / 255.0;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency;
#endif
v_pickColor = pickColor;
v_color = color;
v_color.a *= translucency;
}
`;var wle={ADD:V.FUNC_ADD,SUBTRACT:V.FUNC_SUBTRACT,REVERSE_SUBTRACT:V.FUNC_REVERSE_SUBTRACT,MIN:V.MIN,MAX:V.MAX},B_=Object.freeze(wle);var Ele={ZERO:V.ZERO,ONE:V.ONE,SOURCE_COLOR:V.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:V.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:V.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:V.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:V.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:V.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:V.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:V.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:V.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:V.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:V.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:V.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:V.SRC_ALPHA_SATURATE},Vc=Object.freeze(Ele);var Tle={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:B_.ADD,equationAlpha:B_.ADD,functionSourceRgb:Vc.SOURCE_ALPHA,functionSourceAlpha:Vc.ONE,functionDestinationRgb:Vc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Vc.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:B_.ADD,equationAlpha:B_.ADD,functionSourceRgb:Vc.ONE,functionSourceAlpha:Vc.ONE,functionDestinationRgb:Vc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Vc.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:B_.ADD,equationAlpha:B_.ADD,functionSourceRgb:Vc.SOURCE_ALPHA,functionSourceAlpha:Vc.ONE,functionDestinationRgb:Vc.ONE,functionDestinationAlpha:Vc.ONE})},za=Object.freeze(Tle);var Sle={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2},Or=Object.freeze(Sle);var Ale={FONT_SIZE:48,PADDING:10,RADIUS:8,CUTOFF:.25},Ds=Object.freeze(Ale);var Nr={UNSIGNED_BYTE:V.UNSIGNED_BYTE,UNSIGNED_SHORT:V.UNSIGNED_SHORT,UNSIGNED_INT:V.UNSIGNED_INT,FLOAT:V.FLOAT,HALF_FLOAT:V.HALF_FLOAT_OES,UNSIGNED_INT_24_8:V.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:V.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:V.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:V.UNSIGNED_SHORT_5_6_5};Nr.toWebGLConstant=function(e,t){switch(e){case Nr.UNSIGNED_BYTE:return V.UNSIGNED_BYTE;case Nr.UNSIGNED_SHORT:return V.UNSIGNED_SHORT;case Nr.UNSIGNED_INT:return V.UNSIGNED_INT;case Nr.FLOAT:return V.FLOAT;case Nr.HALF_FLOAT:return t.webgl2?V.HALF_FLOAT:V.HALF_FLOAT_OES;case Nr.UNSIGNED_INT_24_8:return V.UNSIGNED_INT_24_8;case Nr.UNSIGNED_SHORT_4_4_4_4:return V.UNSIGNED_SHORT_4_4_4_4;case Nr.UNSIGNED_SHORT_5_5_5_1:return V.UNSIGNED_SHORT_5_5_5_1;case Nr.UNSIGNED_SHORT_5_6_5:return Nr.UNSIGNED_SHORT_5_6_5}};Nr.isPacked=function(e){return e===Nr.UNSIGNED_INT_24_8||e===Nr.UNSIGNED_SHORT_4_4_4_4||e===Nr.UNSIGNED_SHORT_5_5_5_1||e===Nr.UNSIGNED_SHORT_5_6_5};Nr.sizeInBytes=function(e){switch(e){case Nr.UNSIGNED_BYTE:return 1;case Nr.UNSIGNED_SHORT:case Nr.UNSIGNED_SHORT_4_4_4_4:case Nr.UNSIGNED_SHORT_5_5_5_1:case Nr.UNSIGNED_SHORT_5_6_5:case Nr.HALF_FLOAT:return 2;case Nr.UNSIGNED_INT:case Nr.FLOAT:case Nr.UNSIGNED_INT_24_8:return 4}};Nr.validate=function(e){return e===Nr.UNSIGNED_BYTE||e===Nr.UNSIGNED_SHORT||e===Nr.UNSIGNED_INT||e===Nr.FLOAT||e===Nr.HALF_FLOAT||e===Nr.UNSIGNED_INT_24_8||e===Nr.UNSIGNED_SHORT_4_4_4_4||e===Nr.UNSIGNED_SHORT_5_5_5_1||e===Nr.UNSIGNED_SHORT_5_6_5};var vt=Object.freeze(Nr);var De={DEPTH_COMPONENT:V.DEPTH_COMPONENT,DEPTH_STENCIL:V.DEPTH_STENCIL,ALPHA:V.ALPHA,RGB:V.RGB,RGBA:V.RGBA,LUMINANCE:V.LUMINANCE,LUMINANCE_ALPHA:V.LUMINANCE_ALPHA,RGB_DXT1:V.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:V.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:V.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:V.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:V.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:V.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:V.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:V.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:V.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:V.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:V.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:V.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:V.COMPRESSED_RGBA_BPTC_UNORM};De.componentsLength=function(e){switch(e){case De.RGB:return 3;case De.RGBA:return 4;case De.LUMINANCE_ALPHA:return 2;case De.ALPHA:case De.LUMINANCE:return 1;default:return 1}};De.validate=function(e){return e===De.DEPTH_COMPONENT||e===De.DEPTH_STENCIL||e===De.ALPHA||e===De.RGB||e===De.RGBA||e===De.LUMINANCE||e===De.LUMINANCE_ALPHA||e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5||e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1||e===De.RGBA_ASTC||e===De.RGB_ETC1||e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC||e===De.RGBA_BC7};De.isColorFormat=function(e){return e===De.ALPHA||e===De.RGB||e===De.RGBA||e===De.LUMINANCE||e===De.LUMINANCE_ALPHA};De.isDepthFormat=function(e){return e===De.DEPTH_COMPONENT||e===De.DEPTH_STENCIL};De.isCompressedFormat=function(e){return e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5||e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1||e===De.RGBA_ASTC||e===De.RGB_ETC1||e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC||e===De.RGBA_BC7};De.isDXTFormat=function(e){return e===De.RGB_DXT1||e===De.RGBA_DXT1||e===De.RGBA_DXT3||e===De.RGBA_DXT5};De.isPVRTCFormat=function(e){return e===De.RGB_PVRTC_4BPPV1||e===De.RGB_PVRTC_2BPPV1||e===De.RGBA_PVRTC_4BPPV1||e===De.RGBA_PVRTC_2BPPV1};De.isASTCFormat=function(e){return e===De.RGBA_ASTC};De.isETC1Format=function(e){return e===De.RGB_ETC1};De.isETC2Format=function(e){return e===De.RGB8_ETC2||e===De.RGBA8_ETC2_EAC};De.isBC7Format=function(e){return e===De.RGBA_BC7};De.compressedTextureSizeInBytes=function(e,t,n){switch(e){case De.RGB_DXT1:case De.RGBA_DXT1:case De.RGB_ETC1:case De.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case De.RGBA_DXT3:case De.RGBA_DXT5:case De.RGBA_ASTC:case De.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case De.RGB_PVRTC_4BPPV1:case De.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case De.RGB_PVRTC_2BPPV1:case De.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);case De.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(n/4)*16;default:return 0}};De.textureSizeInBytes=function(e,t,n,r){let o=De.componentsLength(e);return vt.isPacked(t)&&(o=1),o*vt.sizeInBytes(t)*n*r};De.alignmentInBytes=function(e,t,n){let r=De.textureSizeInBytes(e,t,n,1)%4;return r===0?4:r===2?2:1};De.createTypedArray=function(e,t,n,r){let o,a=vt.sizeInBytes(t);a===Uint8Array.BYTES_PER_ELEMENT?o=Uint8Array:a===Uint16Array.BYTES_PER_ELEMENT?o=Uint16Array:a===Float32Array.BYTES_PER_ELEMENT&&t===vt.FLOAT?o=Float32Array:o=Uint32Array;let s=De.componentsLength(e)*n*r;return new o(s)};De.flipY=function(e,t,n,r,o){if(o===1)return e;let a=De.createTypedArray(t,n,r,o),s=De.componentsLength(t),u=r*s;for(let l=0;l<o;++l){let c=l*r*s,f=(o-l-1)*r*s;for(let h=0;h<u;++h)a[f+h]=e[c+h]}return a};De.toInternalFormat=function(e,t,n){if(!n.webgl2)return e;if(e===De.DEPTH_STENCIL)return V.DEPTH24_STENCIL8;if(e===De.DEPTH_COMPONENT){if(t===vt.UNSIGNED_SHORT)return V.DEPTH_COMPONENT16;if(t===vt.UNSIGNED_INT)return V.DEPTH_COMPONENT24}if(t===vt.FLOAT)switch(e){case De.RGBA:return V.RGBA32F;case De.RGB:return V.RGB32F;case De.RG:return V.RG32F;case De.R:return V.R32F}if(t===vt.HALF_FLOAT)switch(e){case De.RGBA:return V.RGBA16F;case De.RGB:return V.RGB16F;case De.RG:return V.RG16F;case De.R:return V.R16F}return e};var Gt=Object.freeze(De);function jO(e,t,n){let r=e._gl;r.framebufferTexture2D(r.FRAMEBUFFER,t,n._target,n._texture,0)}function Zb(e,t,n){let r=e._gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n._getRenderbuffer())}function Zh(e){e=T(e,T.EMPTY_OBJECT);let n=e.context._gl,r=Kt.maximumColorAttachments;this._gl=n,this._framebuffer=n.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=T(e.destroyAttachments,!0);let o=_(e.depthTexture)||_(e.depthRenderbuffer),a=_(e.depthStencilTexture)||_(e.depthStencilRenderbuffer);this._bind();let s,u,l,c,f;if(_(e.colorTextures)){let h=e.colorTextures;for(c=this._colorTextures.length=this._activeColorAttachments.length=h.length,l=0;l<c;++l)s=h[l],f=this._gl.COLOR_ATTACHMENT0+l,jO(this,f,s),this._activeColorAttachments[l]=f,this._colorTextures[l]=s}if(_(e.colorRenderbuffers)){let h=e.colorRenderbuffers;for(c=this._colorRenderbuffers.length=this._activeColorAttachments.length=h.length,l=0;l<c;++l)u=h[l],f=this._gl.COLOR_ATTACHMENT0+l,Zb(this,f,u),this._activeColorAttachments[l]=f,this._colorRenderbuffers[l]=u}_(e.depthTexture)&&(s=e.depthTexture,jO(this,this._gl.DEPTH_ATTACHMENT,s),this._depthTexture=s),_(e.depthRenderbuffer)&&(u=e.depthRenderbuffer,Zb(this,this._gl.DEPTH_ATTACHMENT,u),this._depthRenderbuffer=u),_(e.stencilRenderbuffer)&&(u=e.stencilRenderbuffer,Zb(this,this._gl.STENCIL_ATTACHMENT,u),this._stencilRenderbuffer=u),_(e.depthStencilTexture)&&(s=e.depthStencilTexture,jO(this,this._gl.DEPTH_STENCIL_ATTACHMENT,s),this._depthStencilTexture=s),_(e.depthStencilRenderbuffer)&&(u=e.depthStencilRenderbuffer,Zb(this,this._gl.DEPTH_STENCIL_ATTACHMENT,u),this._depthStencilRenderbuffer=u),this._unBind()}Object.defineProperties(Zh.prototype,{status:{get:function(){this._bind();let e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});Zh.prototype._bind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)};Zh.prototype._unBind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)};Zh.prototype.bindDraw=function(){let e=this._gl;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._framebuffer)};Zh.prototype.bindRead=function(){let e=this._gl;e.bindFramebuffer(e.READ_FRAMEBUFFER,this._framebuffer)};Zh.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};Zh.prototype.getColorTexture=function(e){return this._colorTextures[e]};Zh.prototype.getColorRenderbuffer=function(e){return this._colorRenderbuffers[e]};Zh.prototype.isDestroyed=function(){return!1};Zh.prototype.destroy=function(){if(this.destroyAttachments){let e=0,t=this._colorTextures,n=t.length;for(;e<n;++e){let o=t[e];_(o)&&o.destroy()}let r=this._colorRenderbuffers;for(n=r.length,e=0;e<n;++e){let o=r[e];_(o)&&o.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),ot(this)};var OU=Zh;var Qb={DONT_CARE:V.DONT_CARE,FASTEST:V.FASTEST,NICEST:V.NICEST,validate:function(e){return e===Qb.DONT_CARE||e===Qb.FASTEST||e===Qb.NICEST}},Jb=Object.freeze(Qb);var $b={NEAREST:V.NEAREST,LINEAR:V.LINEAR};$b.validate=function(e){return e===$b.NEAREST||e===$b.LINEAR};var Of=Object.freeze($b);var Xg={NEAREST:V.NEAREST,LINEAR:V.LINEAR,NEAREST_MIPMAP_NEAREST:V.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:V.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:V.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:V.LINEAR_MIPMAP_LINEAR};Xg.validate=function(e){return e===Xg.NEAREST||e===Xg.LINEAR||e===Xg.NEAREST_MIPMAP_NEAREST||e===Xg.LINEAR_MIPMAP_NEAREST||e===Xg.NEAREST_MIPMAP_LINEAR||e===Xg.LINEAR_MIPMAP_LINEAR};var bn=Object.freeze(Xg);var eI={CLAMP_TO_EDGE:V.CLAMP_TO_EDGE,REPEAT:V.REPEAT,MIRRORED_REPEAT:V.MIRRORED_REPEAT,validate:function(e){return e===eI.CLAMP_TO_EDGE||e===eI.REPEAT||e===eI.MIRRORED_REPEAT}},Il=Object.freeze(eI);function Xw(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.wrapS,Il.CLAMP_TO_EDGE),n=T(e.wrapT,Il.CLAMP_TO_EDGE),r=T(e.minificationFilter,bn.LINEAR),o=T(e.magnificationFilter,Of.LINEAR),a=_(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=t,this._wrapT=n,this._minificationFilter=r,this._magnificationFilter=o,this._maximumAnisotropy=a}Object.defineProperties(Xw.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});Xw.equals=function(e,t){return e===t||_(e)&&_(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy};Xw.NEAREST=Object.freeze(new Xw({wrapS:Il.CLAMP_TO_EDGE,wrapT:Il.CLAMP_TO_EDGE,minificationFilter:bn.NEAREST,magnificationFilter:Of.NEAREST}));var La=Xw;function Qh(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=e.width,r=e.height,o=e.source;_(o)&&(_(n)||(n=T(o.videoWidth,o.width)),_(r)||(r=T(o.videoHeight,o.height)));let a=T(e.pixelFormat,Gt.RGBA),s=T(e.pixelDatatype,vt.UNSIGNED_BYTE),u=Gt.toInternalFormat(a,s,t),l=Gt.isCompressedFormat(u),c=e.preMultiplyAlpha||a===Gt.RGB||a===Gt.LUMINANCE,f=T(e.flipY,!0),h=T(e.skipColorSpaceConversion,!1),d=!0,p=t._gl,g=p.TEXTURE_2D,y=p.createTexture();p.activeTexture(p.TEXTURE0),p.bindTexture(g,y);let v=4;if(_(o)&&_(o.arrayBufferView)&&!l&&(v=Gt.alignmentInBytes(a,s,n)),p.pixelStorei(p.UNPACK_ALIGNMENT,v),h?p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE):p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.BROWSER_DEFAULT_WEBGL),_(o))if(_(o.arrayBufferView)){p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1);let C=o.arrayBufferView,E,S,A;if(l){if(p.compressedTexImage2D(g,0,u,n,r,0,C),_(o.mipLevels))for(S=n,A=r,E=0;E<o.mipLevels.length;++E)S=Math.floor(S/2)|0,S<1&&(S=1),A=Math.floor(A/2)|0,A<1&&(A=1),p.compressedTexImage2D(g,E+1,u,S,A,0,o.mipLevels[E])}else if(f&&(C=Gt.flipY(C,a,s,n,r)),p.texImage2D(g,0,u,n,r,0,a,vt.toWebGLConstant(s,t),C),_(o.mipLevels))for(S=n,A=r,E=0;E<o.mipLevels.length;++E)S=Math.floor(S/2)|0,S<1&&(S=1),A=Math.floor(A/2)|0,A<1&&(A=1),p.texImage2D(g,E+1,u,S,A,0,a,vt.toWebGLConstant(s,t),o.mipLevels[E])}else _(o.framebuffer)?(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._bind(),p.copyTexImage2D(g,0,u,o.xOffset,o.yOffset,n,r,0),o.framebuffer!==t.defaultFramebuffer&&o.framebuffer._unBind()):(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,f),p.texImage2D(g,0,u,a,vt.toWebGLConstant(s,t),o));else p.texImage2D(g,0,u,n,r,0,a,vt.toWebGLConstant(s,t),null),d=!1;p.bindTexture(g,null);let w;l?w=Gt.compressedTextureSizeInBytes(a,n,r):w=Gt.textureSizeInBytes(a,s,n,r),this._id=_i(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g,this._texture=y,this._internalFormat=u,this._pixelFormat=a,this._pixelDatatype=s,this._width=n,this._height=r,this._dimensions=new X(n,r),this._hasMipmap=!1,this._sizeInBytes=w,this._preMultiplyAlpha=c,this._flipY=f,this._initialized=d,this._sampler=void 0,this.sampler=_(e.sampler)?e.sampler:new La}Qh.create=function(e){return new Qh(e)};Qh.fromFramebuffer=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=t._gl,r=T(e.pixelFormat,Gt.RGB),o=T(e.framebufferXOffset,0),a=T(e.framebufferYOffset,0),s=T(e.width,n.drawingBufferWidth),u=T(e.height,n.drawingBufferHeight),l=e.framebuffer;return new Qh({context:t,width:s,height:u,pixelFormat:r,source:{framebuffer:_(l)?l:t.defaultFramebuffer,xOffset:o,yOffset:a,width:s,height:u}})};Object.defineProperties(Qh.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,n=e.magnificationFilter,r=this._context,o=this._pixelFormat,a=this._pixelDatatype,s=t===bn.NEAREST_MIPMAP_NEAREST||t===bn.NEAREST_MIPMAP_LINEAR||t===bn.LINEAR_MIPMAP_NEAREST||t===bn.LINEAR_MIPMAP_LINEAR;(a===vt.FLOAT&&!r.textureFloatLinear||a===vt.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(t=s?bn.NEAREST_MIPMAP_NEAREST:bn.NEAREST,n=Of.NEAREST),r.webgl2&&Gt.isDepthFormat(o)&&(t=bn.NEAREST,n=Of.NEAREST);let u=r._gl,l=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(l,this._texture),u.texParameteri(l,u.TEXTURE_MIN_FILTER,t),u.texParameteri(l,u.TEXTURE_MAG_FILTER,n),u.texParameteri(l,u.TEXTURE_WRAP_S,e.wrapS),u.texParameteri(l,u.TEXTURE_WRAP_T,e.wrapT),_(this._textureFilterAnisotropic)&&u.texParameteri(l,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),u.bindTexture(l,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});Qh.prototype.copyFrom=function(e){let t=T(e.xOffset,0),n=T(e.yOffset,0),r=e.source,o=this._context,a=o._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture);let u=r.width,l=r.height,c=r.arrayBufferView,f=this._width,h=this._height,d=this._internalFormat,p=this._pixelFormat,g=this._pixelDatatype,y=this._preMultiplyAlpha,v=this._flipY,w=T(e.skipColorSpaceConversion,!1),C=4;_(c)&&(C=Gt.alignmentInBytes(p,g,u)),a.pixelStorei(a.UNPACK_ALIGNMENT,C),w?a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE):a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL);let E=!1;if(!this._initialized){if(t===0&&n===0&&u===f&&l===h)_(c)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),v&&(c=Gt.flipY(c,p,g,f,h)),a.texImage2D(s,0,d,f,h,0,p,vt.toWebGLConstant(g,o),c)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,v),a.texImage2D(s,0,d,p,vt.toWebGLConstant(g,o),r)),E=!0;else{a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);let S=Gt.createTypedArray(p,g,f,h);a.texImage2D(s,0,d,f,h,0,p,vt.toWebGLConstant(g,o),S)}this._initialized=!0}E||(_(c)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),v&&(c=Gt.flipY(c,p,g,u,l)),a.texSubImage2D(s,0,t,n,u,l,p,vt.toWebGLConstant(g,o),c)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,y),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,v),a.texSubImage2D(s,0,t,n,p,vt.toWebGLConstant(g,o),r))),a.bindTexture(s,null)};Qh.prototype.copyFromFramebuffer=function(e,t,n,r,o,a){e=T(e,0),t=T(t,0),n=T(n,0),r=T(r,0),o=T(o,this._width),a=T(a,this._height);let s=this._context._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(u,0,e,t,n,r,o,a),s.bindTexture(u,null),this._initialized=!0};Qh.prototype.generateMipmap=function(e){e=T(e,Jb.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};Qh.prototype.isDestroyed=function(){return!1};Qh.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),ot(this)};var $o=Qh;function Em(e,t,n,r,o){this.bottomLeft=T(e,X.ZERO),this.topRight=T(t,X.ZERO),this.childNode1=n,this.childNode2=r,this.imageIndex=o}var ble=new X(16,16);function Tm(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.borderWidthInPixels,1),n=T(e.initialSize,ble);this._context=e.context,this._pixelFormat=T(e.pixelFormat,Gt.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=_i(),this._idHash={},this._indexHash={},this._initialSize=n,this._root=void 0}Object.defineProperties(Tm.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return _(this._texture)||(this._texture=new $o({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function Ile(e,t){let n=e._context,r=e.numberOfImages,o=2,a=e._borderWidthInPixels;if(r>0){let s=e._texture.width,u=e._texture.height,l=o*(s+t.width+a),c=o*(u+t.height+a),f=s/l,h=u/c,d=new Em(new X(s+a,a),new X(l,u)),p=new Em(new X,new X(l,u),e._root,d),g=new Em(new X(a,u+a),new X(l,c)),y=new Em(new X,new X(l,c),p,g);for(let C=0;C<e._textureCoordinates.length;C++){let E=e._textureCoordinates[C];_(E)&&(E.x*=f,E.y*=h,E.width*=f,E.height*=h)}let v=new $o({context:e._context,width:l,height:c,pixelFormat:e._pixelFormat}),w=new OU({context:n,colorTextures:[e._texture],destroyAttachments:!1});w._bind(),v.copyFromFramebuffer(0,0,0,0,l,c),w._unBind(),w.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=v,e._root=y}else{let s=o*(t.width+2*a),u=o*(t.height+2*a);s<e._initialSize.x&&(s=e._initialSize.x),u<e._initialSize.y&&(u=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new $o({context:e._context,width:s,height:u,pixelFormat:e._pixelFormat}),e._root=new Em(new X(a,a),new X(s,u))}}function tI(e,t,n){if(!!_(t)){if(!_(t.childNode1)&&!_(t.childNode2)){if(_(t.imageIndex))return;let r=t.topRight.x-t.bottomLeft.x,o=t.topRight.y-t.bottomLeft.y,a=r-n.width,s=o-n.height;if(a<0||s<0)return;if(a===0&&s===0)return t;if(a>s){t.childNode1=new Em(new X(t.bottomLeft.x,t.bottomLeft.y),new X(t.bottomLeft.x+n.width,t.topRight.y));let u=t.bottomLeft.x+n.width+e._borderWidthInPixels;u<t.topRight.x&&(t.childNode2=new Em(new X(u,t.bottomLeft.y),new X(t.topRight.x,t.topRight.y)))}else{t.childNode1=new Em(new X(t.bottomLeft.x,t.bottomLeft.y),new X(t.topRight.x,t.bottomLeft.y+n.height));let u=t.bottomLeft.y+n.height+e._borderWidthInPixels;u<t.topRight.y&&(t.childNode2=new Em(new X(t.bottomLeft.x,u),new X(t.topRight.x,t.topRight.y)))}return tI(e,t.childNode1,n)}return tI(e,t.childNode1,n)||tI(e,t.childNode2,n)}}function NU(e,t,n){let r=tI(e,e._root,t);if(_(r)){r.imageIndex=n;let o=e._texture.width,a=e._texture.height,s=r.topRight.x-r.bottomLeft.x,u=r.topRight.y-r.bottomLeft.y,l=r.bottomLeft.x/o,c=r.bottomLeft.y/a,f=s/o,h=u/a;e._textureCoordinates[n]=new en(l,c,f,h),e._texture.copyFrom({source:t,xOffset:r.bottomLeft.x,yOffset:r.bottomLeft.y})}else Ile(e,t),NU(e,t,n);e._guid=_i()}function BU(e,t){if(!_(e)||e.isDestroyed())return-1;let n=e.numberOfImages;return NU(e,t,n),n}Tm.prototype.getImageIndex=function(e){return this._indexHash[e]};Tm.prototype.addImageSync=function(e,t){let n=this._indexHash[e];return _(n)||(n=BU(this,t),this._idHash[e]=Promise.resolve(n),this._indexHash[e]=n),n};Tm.prototype.addImage=function(e,t){let n=this._idHash[e];if(_(n))return n;typeof t=="function"?t=t(e):(typeof t=="string"||t instanceof _t)&&(t=_t.createIfNeeded(t).fetchImage());let r=this;return n=Promise.resolve(t).then(function(o){let a=BU(r,o);return r._indexHash[e]=a,a}),this._idHash[e]=n,n};Tm.prototype.updateImage=function(e,t){let n=this._textureCoordinates[e],r=this._texture,o=Math.round(n.x*r.width),a=Math.round(n.y*r.height);r.copyFrom({source:t,xOffset:o,yOffset:a})};Tm.prototype.addSubRegion=function(e,t){let n=this._idHash[e];if(!_(n))throw new it(`image with id "${e}" not found in the atlas.`);let r=this;return Promise.resolve(n).then(function(o){if(o===-1)return-1;let a=r._texture.width,s=r._texture.height,u=r.numberOfImages,l=r._textureCoordinates[o],c=l.x+t.x/a,f=l.y+t.y/s,h=t.width/a,d=t.height/s;return r._textureCoordinates.push(new en(c,f,h,d)),r._guid=_i(),u})};Tm.prototype.isDestroyed=function(){return!1};Tm.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ot(this)};var F_=Tm;var Dle=Xi.SHOW_INDEX,Kw=Xi.POSITION_INDEX,FU=Xi.PIXEL_OFFSET_INDEX,zU=Xi.EYE_OFFSET_INDEX,Ple=Xi.HORIZONTAL_ORIGIN_INDEX,Mle=Xi.VERTICAL_ORIGIN_INDEX,Lle=Xi.SCALE_INDEX,jw=Xi.IMAGE_INDEX_INDEX,VU=Xi.COLOR_INDEX,Rle=Xi.ROTATION_INDEX,Ole=Xi.ALIGNED_AXIS_INDEX,kU=Xi.SCALE_BY_DISTANCE_INDEX,GU=Xi.TRANSLUCENCY_BY_DISTANCE_INDEX,UU=Xi.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,HU=Xi.DISTANCE_DISPLAY_CONDITION,Nle=Xi.DISABLE_DEPTH_DISTANCE,Ble=Xi.TEXTURE_COORDINATE_BOUNDS,qU=Xi.SDF_INDEX,tN=Xi.NUMBER_OF_PROPERTIES,Ki,Fle={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},zle={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function kc(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(tN),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._modelMatrix=U.clone(U.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=T(e.debugShowTextureAtlas,!1),this.blendOption=T(e.blendOption,Or.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW],this._highlightColor=K.clone(K.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let n=this._scene;_(n)&&_(n.terrainProviderChanged)&&(this._removeCallbackFunc=n.terrainProviderChanged.addEventListener(function(){let r=this._billboards,o=r.length;for(let a=0;a<o;++a)_(r[a])&&r[a]._updateClamping()},this))}Object.defineProperties(kc.prototype,{length:{get:function(){return nN(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function WU(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}kc.prototype.add=function(e){let t=new Xi(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t};kc.prototype.remove=function(e){return this.contains(e)?(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};kc.prototype.resize=function(e){return this.removeAll(),this._billboards=e,this._billboardsRemoved=!0,this._createVertexArray=!0,!0};kc.prototype.removeAll=function(){WU(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function nN(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],n=e._billboards,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];_(s)&&(s._index=a++,t.push(s))}e._billboards=t}}kc.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]};kc.prototype.contains=function(e){return _(e)&&e._billboardCollection===this};kc.prototype.get=function(e){return nN(this),this._billboards[e]};var KO;function Vle(e){let n=e.cache.billboardCollection_indexBufferBatched;if(_(n))return n;let r=16384*6-6,o=new Uint16Array(r);for(let a=0,s=0;a<r;a+=6,s+=4)o[a]=s,o[a+1]=s+1,o[a+2]=s+2,o[a+3]=s+0,o[a+4]=s+2,o[a+5]=s+3;return n=ki.createIndexBuffer({context:e,typedArray:o,usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=n,n}function kle(e){let t=e.cache.billboardCollection_indexBufferInstanced;return _(t)||(t=ki.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function Gle(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return _(t)||(t=ki.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:We.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}kc.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<tN;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function Ule(e,t,n,r,o,a){let s=[{index:Ki.positionHighAndScale,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Kw]},{index:Ki.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Kw]},{index:Ki.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[FU]},{index:Ki.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[GU]},{index:Ki.compressedAttribute2,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[VU]},{index:Ki.eyeOffset,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[zU]},{index:Ki.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[kU]},{index:Ki.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[UU]},{index:Ki.compressedAttribute3,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[HU]},{index:Ki.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Ble]}];r&&s.push({index:Ki.direction,componentsPerAttribute:2,componentDatatype:ie.FLOAT,vertexBuffer:Gle(e)}),_(o)&&s.push({index:Ki.a_batchId,componentsPerAttribute:1,componentDatatype:ie.FLOAT,bufferUsage:We.STATIC_DRAW}),a&&s.push({index:Ki.sdf,componentsPerAttribute:2,componentDatatype:ie.FLOAT,usage:n[qU]});let u=r?t:4*t;return new iC(e,s,u,r)}var ZO=new ei;function YU(e,t,n,r,o){let a,s=r[Ki.positionHighAndScale],u=r[Ki.positionLowAndRotation],l=o._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),ei.fromCartesian(l,ZO);let c=o.scale,f=o.rotation;f!==0&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,c);let h=ZO.high,d=ZO.low;e._instanced?(a=o._index,s(a,h.x,h.y,h.z,c),u(a,d.x,d.y,d.z,f)):(a=o._index*4,s(a+0,h.x,h.y,h.z,c),s(a+1,h.x,h.y,h.z,c),s(a+2,h.x,h.y,h.z,c),s(a+3,h.x,h.y,h.z,c),u(a+0,d.x,d.y,d.z,f),u(a+1,d.x,d.y,d.z,f),u(a+2,d.x,d.y,d.z,f),u(a+3,d.x,d.y,d.z,f))}var Bf=new X,Nf=32768,oC=65536,QO=4096,ip=256,Hle=128,qle=32,Wle=8,XU=4,Yle=1/256,jU=0,KU=2,ZU=3,QU=1;function JU(e,t,n,r,o){let a,s=r[Ki.compressedAttribute0],u=o.pixelOffset,l=u.x,c=u.y,f=o._translate,h=f.x,d=f.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+h),Math.abs(-c+d));let p=o.horizontalOrigin,g=o._verticalOrigin,y=o.show&&o.clusterShow;o.color.alpha===0&&(y=!1),g===an.BASELINE&&(g=an.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===ho.CENTER,e._allVerticalCenter=e._allVerticalCenter&&g===an.CENTER;let v=0,w=0,C=0,E=0,S=o._imageIndex;if(S!==-1){let G=n[S];v=G.x,w=G.y,C=G.width,E=G.height}let A=v+C,D=w+E,P=Math.floor(z.clamp(l,-Nf,Nf)+Nf)*Hle;P+=(p+1)*qle,P+=(g+1)*Wle,P+=(y?1:0)*XU;let M=Math.floor(z.clamp(c,-Nf,Nf)+Nf)*ip,I=Math.floor(z.clamp(h,-Nf,Nf)+Nf)*ip,O=(z.clamp(d,-Nf,Nf)+Nf)*Yle,m=Math.floor(O),b=Math.floor((O-m)*ip);M+=m,I+=b,Bf.x=v,Bf.y=w;let L=ma.compressTextureCoordinates(Bf);Bf.x=A;let R=ma.compressTextureCoordinates(Bf);Bf.y=D;let N=ma.compressTextureCoordinates(Bf);Bf.x=v;let B=ma.compressTextureCoordinates(Bf);e._instanced?(a=o._index,s(a,P,M,I,L)):(a=o._index*4,s(a+0,P+jU,M,I,L),s(a+1,P+KU,M,I,R),s(a+2,P+ZU,M,I,N),s(a+3,P+QU,M,I,B))}function $U(e,t,n,r,o){let a,s=r[Ki.compressedAttribute1],u=o.alignedAxis;x.equals(u,x.ZERO)||(e._shaderAlignedAxis=!0);let l=0,c=1,f=1,h=1,d=o.translucencyByDistance;_(d)&&(l=d.near,c=d.nearValue,f=d.far,h=d.farValue,(c!==1||h!==1)&&(e._shaderTranslucencyByDistance=!0));let p=0,g=o._imageIndex;g!==-1&&(p=n[g].width);let y=e._textureAtlas.texture.width,v=Math.round(T(o.width,y*p));e._maxSize=Math.max(e._maxSize,v);let w=z.clamp(v,0,oC),C=0;Math.abs(x.magnitudeSquared(u)-1)<z.EPSILON6&&(C=ma.octEncodeFloat(u)),c=z.clamp(c,0,1),c=c===1?255:c*255|0,w=w*ip+c,h=z.clamp(h,0,1),h=h===1?255:h*255|0,C=C*ip+h,e._instanced?(a=o._index,s(a,w,C,l,f)):(a=o._index*4,s(a+0,w,C,l,f),s(a+1,w,C,l,f),s(a+2,w,C,l,f),s(a+3,w,C,l,f))}function $O(e,t,n,r,o){let a,s=r[Ki.compressedAttribute2],u=o.color,l=_(e._batchTable)?K.WHITE:o.getPickId(t.context).color,c=o.sizeInMeters?1:0,f=Math.abs(x.magnitudeSquared(o.alignedAxis)-1)<z.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&c===1;let h=0,d=o._imageIndex;d!==-1&&(h=n[d].height);let p=e._textureAtlas.texture.dimensions,g=Math.round(T(o.height,p.y*h));e._maxSize=Math.max(e._maxSize,g);let y=T(o._labelHorizontalOrigin,-2);y+=2;let v=g*XU+y,w=K.floatToByte(u.red),C=K.floatToByte(u.green),E=K.floatToByte(u.blue),S=w*oC+C*ip+E;w=K.floatToByte(l.red),C=K.floatToByte(l.green),E=K.floatToByte(l.blue);let A=w*oC+C*ip+E,D=K.floatToByte(u.alpha)*oC+K.floatToByte(l.alpha)*ip;D+=c*2+f,e._instanced?(a=o._index,s(a,S,A,D,v)):(a=o._index*4,s(a+0,S,A,D,v),s(a+1,S,A,D,v),s(a+2,S,A,D,v),s(a+3,S,A,D,v))}function eN(e,t,n,r,o){let a,s=r[Ki.eyeOffset],u=o.eyeOffset,l=u.z;if(o._heightReference!==Pt.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(u.x),Math.abs(u.y),Math.abs(l)),e._instanced){let c=0,f=0,h=o._imageIndex;if(h!==-1){let p=n[h];c=p.width,f=p.height}Bf.x=c,Bf.y=f;let d=ma.compressTextureCoordinates(Bf);a=o._index,s(a,u.x,u.y,l,d)}else a=o._index*4,s(a+0,u.x,u.y,l,0),s(a+1,u.x,u.y,l,0),s(a+2,u.x,u.y,l,0),s(a+3,u.x,u.y,l,0)}function e6(e,t,n,r,o){let a,s=r[Ki.scaleByDistance],u=0,l=1,c=1,f=1,h=o.scaleByDistance;_(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function t6(e,t,n,r,o){let a,s=r[Ki.pixelOffsetScaleByDistance],u=0,l=1,c=1,f=1,h=o.pixelOffsetScaleByDistance;_(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function n6(e,t,n,r,o){let a,s=r[Ki.compressedAttribute3],u=0,l=Number.MAX_VALUE,c=o.distanceDisplayCondition;_(c)&&(u=c.near,l=c.far,u*=u,l*=l,e._shaderDistanceDisplayCondition=!0);let f=o.disableDepthTestDistance,h=o.heightReference===Pt.CLAMP_TO_GROUND&&t.context.depthTexture;_(f)||(f=h?5e3:0),f*=f,(h||f>0)&&(e._shaderDisableDepthDistance=!0,f===Number.POSITIVE_INFINITY&&(f=-1));let d,p;if(_(o._labelDimensions))p=o._labelDimensions.x,d=o._labelDimensions.y;else{let w=0,C=0,E=o._imageIndex;if(E!==-1){let A=n[E];w=A.height,C=A.width}d=Math.round(T(o.height,e._textureAtlas.texture.dimensions.y*w));let S=e._textureAtlas.texture.width;p=Math.round(T(o.width,S*C))}let g=Math.floor(z.clamp(p,0,QO)),y=Math.floor(z.clamp(d,0,QO)),v=g*QO+y;e._instanced?(a=o._index,s(a,u,l,f,v)):(a=o._index*4,s(a+0,u,l,f,v),s(a+1,u,l,f,v),s(a+2,u,l,f,v),s(a+3,u,l,f,v))}function r6(e,t,n,r,o){if(o.heightReference===Pt.CLAMP_TO_GROUND){let g=e._scene,y=t.context,v=t.globeTranslucencyState.translucent,w=_(g.globe)&&g.globe.depthTestAgainstTerrain;e._shaderClampToGround=y.depthTexture&&!v&&w}let a,s=r[Ki.textureCoordinateBoundsOrLabelTranslate];if(Kt.maximumVertexTextureImageUnits>0){let g=0,y=0;_(o._labelTranslate)&&(g=o._labelTranslate.x,y=o._labelTranslate.y),e._instanced?(a=o._index,s(a,g,y,0,0)):(a=o._index*4,s(a+0,g,y,0,0),s(a+1,g,y,0,0),s(a+2,g,y,0,0),s(a+3,g,y,0,0));return}let u=0,l=0,c=0,f=0,h=o._imageIndex;if(h!==-1){let g=n[h];u=g.x,l=g.y,c=g.width,f=g.height}let d=u+c,p=l+f;e._instanced?(a=o._index,s(a,u,l,d,p)):(a=o._index*4,s(a+0,u,l,d,p),s(a+1,u,l,d,p),s(a+2,u,l,d,p),s(a+3,u,l,d,p))}function Xle(e,t,n,r,o){if(!_(e._batchTable))return;let a=r[Ki.a_batchId],s=o._batchIndex,u;e._instanced?(u=o._index,a(u,s)):(u=o._index*4,a(u+0,s),a(u+1,s),a(u+2,s),a(u+3,s))}function i6(e,t,n,r,o){if(!e._sdf)return;let a,s=r[Ki.sdf],u=o.outlineColor,l=o.outlineWidth,c=K.floatToByte(u.red),f=K.floatToByte(u.green),h=K.floatToByte(u.blue),d=c*oC+f*ip+h,p=l/Ds.RADIUS,g=K.floatToByte(u.alpha)*oC+K.floatToByte(p)*ip;e._instanced?(a=o._index,s(a,d,g)):(a=o._index*4,s(a+0,d+jU,g),s(a+1,d+KU,g),s(a+2,d+ZU,g),s(a+3,d+QU,g))}function jle(e,t,n,r,o){YU(e,t,n,r,o),JU(e,t,n,r,o),$U(e,t,n,r,o),$O(e,t,n,r,o),eN(e,t,n,r,o),e6(e,t,n,r,o),t6(e,t,n,r,o),n6(e,t,n,r,o),r6(e,t,n,r,o),Xle(e,t,n,r,o),i6(e,t,n,r,o)}function JO(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=Xi._computeActualPosition(c,f,r,o);_(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function Kle(e,t){let n=t.mode,r=e._billboards,o=e._billboardsToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!U.equals(a,e.modelMatrix)?(e._mode=n,U.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&JO(e,r,r.length,t,a,!0)):n===Ne.MORPHING?JO(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&JO(e,o,e._billboardsToUpdateIndex,t,a,!1)}function Zle(e,t,n){let r=1;(!e._allSizedInMeters||e._maxPixelOffset!==0)&&(r=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let o=r*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(o*=.5);let a=r*e._maxPixelOffset+e._maxEyeOffset;n.radius+=o+a}function Qle(e,t){let n=`uniform sampler2D billboard_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); 
} 
`,r=t.createViewportQuadCommand(n,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return r.pass=Qt.OVERLAY,r}var Jle=[];kc.prototype.update=function(e){if(nN(this),!this.show)return;let t=this._billboards,n=t.length,r=e.context;this._instanced=r.instancedArrays,Ki=this._instanced?zle:Fle,KO=this._instanced?kle:Vle;let o=this._textureAtlas;if(_(o))for(let M=0;M<n;++M){let I=t[M];I.animation&&I.ready&&I._updateImage()}else{o=this._textureAtlas=new F_({context:r});for(let M=0;M<n;++M)t[M]._loadImage()}let a=o.textureCoordinates;if(a.length===0)return;Kle(this,e),t=this._billboards,n=t.length;let s=this._billboardsToUpdate,u=this._billboardsToUpdateIndex,l=this._propertiesChanged,c=o.guid,f=this._createVertexArray||this._textureAtlasGUID!==c;this._textureAtlasGUID=c;let h,d=e.passes,p=d.pick;if(f||!p&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let M=0;M<tN;++M)l[M]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=Ule(r,n,this._buffersUsage,this._instanced,this._batchTable,this._sdf),h=this._vaf.writers;for(let M=0;M<n;++M){let I=this._billboards[M];I._dirty=!1,jle(this,e,a,h,I)}this._vaf.commit(KO(r))}this._billboardsToUpdateIndex=0}else if(u>0){let M=Jle;M.length=0,(l[Kw]||l[Rle]||l[Lle])&&M.push(YU),(l[jw]||l[FU]||l[Ple]||l[Mle]||l[Dle])&&(M.push(JU),this._instanced&&M.push(eN)),(l[jw]||l[Ole]||l[GU])&&(M.push($U),M.push($O)),(l[jw]||l[VU])&&M.push($O),l[zU]&&M.push(eN),l[kU]&&M.push(e6),l[UU]&&M.push(t6),(l[HU]||l[Nle]||l[jw]||l[Kw])&&M.push(n6),(l[jw]||l[Kw])&&M.push(r6),l[qU]&&M.push(i6);let I=M.length;if(h=this._vaf.writers,u/n>.1){for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let b=0;b<I;++b)M[b](this,e,a,h,m)}this._vaf.commit(KO(r))}else{for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let b=0;b<I;++b)M[b](this,e,a,h,m);this._instanced?this._vaf.subCommit(m._index,1):this._vaf.subCommit(m._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(u>n*1.5&&(s.length=n),!_(this._vaf)||!_(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let g,y=U.IDENTITY;e.mode===Ne.SCENE3D?(y=this.modelMatrix,g=Ee.clone(this._baseVolumeWC,this._boundingVolume)):g=Ee.clone(this._baseVolume2D,this._boundingVolume),Zle(this,e,g);let v=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,v){this._blendOption===Or.OPAQUE||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=un.fromCache({depthTest:{enabled:!0,func:V.LESS},depthMask:!0}):this._rsOpaque=void 0;let M=this._blendOption===Or.TRANSLUCENT;this._blendOption===Or.TRANSLUCENT||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=un.fromCache({depthTest:{enabled:!0,func:M?V.LEQUAL:V.LESS},depthMask:M,blending:za.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let w,C,E,S,A,D=Kt.maximumVertexTextureImageUnits>0;if(v||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){w=Kb,C=jb,A=[],_(this._batchTable)&&(A.push("VECTOR_TILE"),w=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(w),C=this._batchTable.getFragmentShaderCallback(!1,void 0)(C)),E=new xt({defines:A,sources:[w]}),this._instanced&&E.defines.push("INSTANCED"),this._shaderRotation&&E.defines.push("ROTATION"),this._shaderAlignedAxis&&E.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&E.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&E.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&E.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&E.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&E.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK"));let M=1-Ds.CUTOFF;this._sdf&&E.defines.push("SDF");let I=_(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Or.OPAQUE_AND_TRANSLUCENT&&(S=new xt({defines:["OPAQUE",I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=vi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ki}),S=new xt({defines:["TRANSLUCENT",I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=vi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ki})),this._blendOption===Or.OPAQUE&&(S=new xt({defines:[I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=vi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ki})),this._blendOption===Or.TRANSLUCENT&&(S=new xt({defines:[I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=vi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Ki})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let P=e.commandList;if(d.render||d.pick){let M=this._colorCommands,I=this._blendOption===Or.OPAQUE,O=this._blendOption===Or.OPAQUE_AND_TRANSLUCENT,m=this._vaf.va,b=m.length,L=this._uniforms,R;_(this._batchTable)?(L=this._batchTable.getUniformMapCallback()(L),R=this._batchTable.getPickId()):R="v_pickColor",M.length=b;let N=O?b*2:b;for(let B=0;B<N;++B){let G=M[B];_(G)||(G=M[B]=new Zt);let F=I||O&&B%2===0;G.pass=F||!O?Qt.OPAQUE:Qt.TRANSLUCENT,G.owner=this;let k=O?Math.floor(B/2):B;G.boundingVolume=g,G.modelMatrix=y,G.count=m[k].indicesCount,G.shaderProgram=F?this._sp:this._spTranslucent,G.uniformMap=L,G.vertexArray=m[k].va,G.renderState=F?this._rsOpaque:this._rsTranslucent,G.debugShowBoundingVolume=this.debugShowBoundingVolume,G.pickId=R,this._instanced&&(G.count=6,G.instanceCount=n),P.push(G)}this.debugShowTextureAtlas&&(_(this.debugCommand)||(this.debugCommand=Qle(this,e.context)),P.push(this.debugCommand))}};kc.prototype.isDestroyed=function(){return!1};kc.prototype.destroy=function(){return _(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),WU(this._billboards),ot(this)};var Zw=kc;var rN={};rN.toInt=function(e){if(!e)return;let t=e.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),n=parseInt((t[3]||1)*255),r=parseInt(t[0]),o=parseInt(t[1]),a=parseInt(t[2]);return(r<<24|o<<16|a<<8|n)>>>0};rN.fromInt=function(e){if(!e)return;let t=[];return t[0]=(e&4278190080)>>>24,t[1]=(e&16711680)>>>16,t[2]=(e&65280)>>>8,t[3]=e&255>>>0,`rgba(${t[0]},${t[1]},${t[2]},${t[3]/255})`};var o6=rN;function iN(){}iN.prototype.cgcs2000ToWgs84=function(e,t,n){let o=298.257222101,a=a6(6378137,o,t,e,n);o=298.257223563;let s=s6(6378137,o,a[0],a[1],a[2]);return new Cesium.Cartographic(s[0],s[1],s[2])};iN.prototype.wgs84ToCgcs2000=function(e,t,n){let o=298.257223563,a=a6(6378137,o,t,e,n);o=298.257222101;let s=s6(6378137,o,a[0],a[1],a[2]);return new Cesium.Cartographic(s[0],s[1],s[2])};function a6(e,t,n,r,o){let a=0,s=0,u=0,l=n,c=r,f=0;t!=0&&(f=1/t);let h=2*f-f*f,d=e/Math.sqrt(1-h*Math.sin(l)*Math.sin(l));return a=(d+o)*Math.cos(l)*Math.cos(c),s=(d+o)*Math.cos(l)*Math.sin(c),u=((1-h)*d+o)*Math.sin(l),[a,s,u]}function s6(e,t,n,r,o){let a=0,s=0,u=0,l=0;t!=0&&(l=1/t);let c=2*l-l*l,f=0,h=e,d=0,p=20,g=0;do{let y=(o+c*h*Math.sin(f))/Math.sqrt(n*n+r*r);if(f=Math.atan(y),h=e/Math.sqrt(1-c*Math.sin(f)*Math.sin(f)),d=f-a,a=f,++g,g>p)return!1}while(Math.abs(d)>1e-9);return h=e/Math.sqrt(1-c*Math.sin(a)*Math.sin(a)),s=Math.atan(r/n),r>0&&s<0&&(s+=Cesium.Math.PI),r<0&&s>0&&(s-=Cesium.Math.PI),u=n/(Math.cos(s)*Math.cos(a))-h,[s,a,u]}var u6=iN;function nI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.startYaw=Cesium.defaultValue(e.startYaw,-90),this.endYaw=Cesium.defaultValue(e.endYaw,100),this.radius=Cesium.defaultValue(e.radius,530),this._radius=void 0,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this._attributeLocations=void 0,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}nI.prototype.update=function(e){var t=e.context,n=this;this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this._modelMatrix,this._boundingSphere),this._command.boundingVolume=this._boundingSphere,this._command.uniformMap={v_colour:function(){return n.fillColor}};var r=this.createMesh();this._VA=$le(this,t,r),Cesium.defined(this._command.shaderProgram)||(this._command.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:tce(),fragmentShaderSource:nce()})),this._command.vertexArray=this._VA;var o=e.commandList,a=e.passes;a.render&&o.push(this._command)};nI.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function $le(e,t,n){var r=ece(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function ece(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}nI.prototype.createMesh=function(){var e=this.endYaw-this.startYaw;e=e*2;for(var t=new Float64Array(e*3),n=e,r=this._radius,o=0,a=0,s=Cesium.IndexDatatype.createTypedArray(e,n),u=1;u<e-1;u++)t[o++]=r*Math.sin((this.startYaw+u)*Math.PI/180),t[o++]=r*Math.cos((this.startYaw+u)*Math.PI/180),t[o++]=0;for(var l=0;l<e-1;l++)s[a++]=l,s[a++]=l+1;return{position:t,indices:s}};function tce(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function nce(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var rI=nI;var op={position:0,normal:1};function iI(e){var t=this;if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._position=e.position,this.position=this._position,this.positionChange=!1,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showDomeSurfaces=Cesium.defaultValue(e.showDomeSurfaces,!0),this.slice=Cesium.defaultValue(e.slice,32),this.modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._computedModelMatrix=new Cesium.Matrix4,this._computedScanPlaneModelMatrix=new Cesium.Matrix4,this.radius=Cesium.defaultValue(e.radius,Number.POSITIVE_INFINITY),this._radius=void 0,this.xHalfAngle=Cesium.Math.toRadians(90),this._xHalfAngle=void 0,this.yHalfAngle=Cesium.Math.toRadians(90),this._yHalfAngle=void 0,this.lineColor=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,.5)),this.showLateralSurfaces=Cesium.defaultValue(e.showLateralSurfaces,!1),this.material=Cesium.defaultValue(e.material,new Cesium.Material({fabric:{type:"Color",uniforms:{color:this.lineColor}}})),this._material=void 0,this._translucent=void 0,this.stackPartitions=Cesium.defaultValue(e.stackPartitions,32),this.slicePartitions=Cesium.defaultValue(e.slicePartitions,32),this.showIntersection=Cesium.defaultValue(e.showIntersection,!1),this.intersectionColor=Cesium.defaultValue(e.intersectionColor,Cesium.Color.WHITE),this.intersectionWidth=Cesium.defaultValue(e.intersectionWidth,5),this.showThroughEllipsoid=Cesium.defaultValue(e.showThroughEllipsoid,!0),this._showThroughEllipsoid=void 0,this.showScanPlane=Cesium.defaultValue(e.showScanPlane,!0),this.scanPlaneColor=Cesium.defaultValue(e.scanPlaneColor,Cesium.Color.WHITE),this.scanPlaneRate=Cesium.defaultValue(e.scanPlaneRate,100),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._timeDiff=0,this._boundingSphere=new Cesium.BoundingSphere,this._boundingSphereWC=new Cesium.BoundingSphere,this._sectorFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new Cesium.DrawCommand({owner:this,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return t.xHalfAngle},u_yHalfAngle:function(){return t.yHalfAngle},u_radius:function(){return t._radius},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return t._scanePlaneXHalfAngle},u_yHalfAngle:function(){return t._scanePlaneYHalfAngle},u_radius:function(){return t._radius},u_color:function(){return t.scanPlaneColor},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scene.primitives.add(this)}Object.defineProperties(iI.prototype,{position:{get:function(){return this._position},set:function(e){e instanceof x&&(this.positionChange=!0,this._position=e)}}});iI.prototype.update=function(e){var t=e.mode,n=this.viewer.scene.frameState.time;if(this.show instanceof Array?rce(this,n):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){var r=!1,o=!1,a=!1,s=this.xHalfAngle,u=this.yHalfAngle;if(s<0||u<0)throw new Cesium.DeveloperError("halfAngle must be greater than or equal to zero.");if(!(s==0||u==0)){(this._xHalfAngle!==s||this._yHalfAngle!==u)&&(this._xHalfAngle=s,this._yHalfAngle=u,r=!0),this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius;var l=this._radius;if(l<0)throw new Cesium.DeveloperError("this.radius must be greater than or equal to zero.");this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),(!Cesium.defined(this.modelMatrix)||this.positionChange)&&(this.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position)),Cesium.Matrix4.multiplyByUniformScale(this.modelMatrix,this._radius,this._computedModelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this.modelMatrix,this._boundingSphereWC);var c=this.showThroughEllipsoid;this._showThroughEllipsoid!==this.showThroughEllipsoid&&(this._showThroughEllipsoid=c,o=!0);var f=this.material;this._material!==f&&(this._material=f,o=!0,a=!0);var h=!0;if(this._translucent!==h&&(this._translucent=h,o=!0),this.showScanPlane){this._timeDiff>1&&(this._timeDiff=0),this._timeDiff+=1/(this.scanPlaneRate*10);var d=this._timeDiff,p;p=4*s*d-s;var g=Math.tan(u),y=Math.cos(p),v=Math.atan(y*g);this._scanePlaneXHalfAngle=p,this._scanePlaneYHalfAngle=v,Cesium.Matrix3.fromRotationZ(this._scanePlaneXHalfAngle,Qw),Cesium.Matrix4.multiplyByMatrix3(this.modelMatrix,Qw,this._computedScanPlaneModelMatrix),Cesium.Matrix4.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this._radius,this._computedScanPlaneModelMatrix)}r&&pce(this,e),o&&yce(this,c,h),a&&_ce(this,e,f),(o||a)&&vce(this,h);var w=e.commandList,C=e.passes,E=this._colorCommands;if(C.render)for(var S=0,A=E.length;S<A;S++){var D=E[S];w.push(D)}}}};iI.prototype.destroy=function(){if(this._scene.primitives.contains(this)){var e=this._scene.primitives._primitives.indexOf(this);e!==-1&&(this._scene.primitives._primitives.splice(e,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function rce(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=ice(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0;return}}else e._show=!1}function ice(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}var Qw=new ne,IJe=new ne,l6=new x;function oce(e,t,n){for(var r=e.slice,o=Math.cos(n),a=Math.tan(n),s=Math.cos(t),u=Math.tan(t),l=Math.atan(s*a),c=Math.atan(o*u),f=[],h=0;h<r;h++){var d=2*l*h/(r-1)-l;f.push(new Cesium.Cartesian3(0,Math.sin(d),Math.cos(d)))}for(var p=[],h=0;h<r;h++){var d=2*c*h/(r-1)-c;p.push(new Cesium.Cartesian3(Math.sin(d),0,Math.cos(d)))}return{zoy:f,zox:p}}function ace(e,t,n){for(var r=e.slice,o=[],a=Math.cos(t),s=Math.tan(n),u=Math.atan(a*s),l=0;l<r/2;l++){var c=2*u*l/(r-1)-u;o.push(new Cesium.Cartesian3(Math.sin(c),0,Math.cos(c)))}return o}function sce(e,t){var n=e.xHalfAngle,r=e.yHalfAngle,o=t.zoy,a=t.zox,s=[],u=Cesium.Matrix3.fromRotationY(n,Qw);s.push(o.map(function(l){return Cesium.Matrix3.multiplyByVector(u,l,new Cesium.Cartesian3)}));var u=Cesium.Matrix3.fromRotationX(-r,Qw),u=Cesium.Matrix3.fromRotationY(-n,Qw);return s.push(o.map(function(l){return Cesium.Matrix3.multiplyByVector(u,l,new Cesium.Cartesian3)}).reverse()),s}function uce(e,t){for(var n=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(2*3*3*n),o=0,a=0,s=t.length;a<s;a++)for(var u=t[a],l=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(u[0],u[u.length-1],l6),l6),c=0,n=u.length-1;c<n;c++)r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z,r[o++]=u[c].x,r[o++]=u[c].y,r[o++]=u[c].z,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z,r[o++]=u[c+1].x,r[o++]=u[c+1].y,r[o++]=u[c+1].z,r[o++]=-l.x,r[o++]=-l.y,r[o++]=-l.z;var f=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),h=2*3*Float32Array.BYTES_PER_ELEMENT,d=[{index:op.position,vertexBuffer:f,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:h},{index:op.normal,vertexBuffer:f,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:h}];return new Cesium.VertexArray({context:e,attributes:d})}function lce(e,t){for(var n=t.length,r=new Float32Array(3*3*n),o=0,a=0,s=t.length;a<s;a++){var u=t[a];r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=u[0].x,r[o++]=u[0].y,r[o++]=u[0].z}var l=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),c=3*Float32Array.BYTES_PER_ELEMENT,f=[{index:op.position,vertexBuffer:l,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:c}];return new Cesium.VertexArray({context:e,attributes:f})}function cce(e,t){for(var n=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(3*3*n),o=0,a=0,s=t.length;a<s;a++)for(var u=t[a],l=0,n=u.length-1;l<n;l++)r[o++]=u[l].x,r[o++]=u[l].y,r[o++]=u[l].z,r[o++]=u[l+1].x,r[o++]=u[l+1].y,r[o++]=u[l+1].z;var c=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),f=3*Float32Array.BYTES_PER_ELEMENT,h=[{index:op.position,vertexBuffer:c,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:f}];return new Cesium.VertexArray({context:e,attributes:h})}function fce(e){var t=Cesium.EllipsoidGeometry.createGeometry(new Cesium.EllipsoidGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,stackPartitions:32,slicePartitions:32})),n=Cesium.VertexArray.fromGeometry({context:e,geometry:t,attributeLocations:op,bufferUsage:Cesium.BufferUsage.STATIC_DRAW,interleave:!1});return n}function hce(e,t,n){var r=Cesium.EllipsoidOutlineGeometry.createGeometry(new Cesium.EllipsoidOutlineGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,stackPartitions:t,slicePartitions:n})),o=Cesium.VertexArray.fromGeometry({context:e,geometry:r,attributeLocations:op,bufferUsage:Cesium.BufferUsage.STATIC_DRAW,interleave:!1});return o}function dce(e,t){for(var n=t.length-1,r=new Float32Array(3*3*n),o=0,a=0;a<n;a++)r[o++]=t[a].x,r[o++]=t[a].y,r[o++]=t[a].z,r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=t[a+1].x,r[o++]=t[a+1].y,r[o++]=t[a+1].z;var s=Cesium.Buffer.createVertexBuffer({context:e,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),u=3*Float32Array.BYTES_PER_ELEMENT,l=[{index:op.position,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:Cesium.ComponentDatatype.FLOAT,offsetInBytes:0,strideInBytes:u}];return new Cesium.VertexArray({context:e,attributes:l})}function pce(e,t){var n=t.context,r=oce(e,e.xHalfAngle,e.yHalfAngle),o=sce(e,r);if(e.showLateralSurfaces&&(e._sectorVA=uce(n,o)),e.showSectorLines&&(e._sectorLineVA=lce(n,o)),e.showSectorSegmentLines&&(e._sectorSegmentLineVA=cce(n,o)),e._domeVA=fce(n),e._domeLineVA=hce(n,e.stackPartitions,e.slicePartitions),e.showScanPlane){var a=ace(e,0,Cesium.Math.PI_OVER_TWO);e._scanPlaneVA=dce(n,a)}}function mce(e,t,n){var r=t.context,o=f6(),a=new Cesium.ShaderSource({sources:[oN(),n.shaderSource,c6()]});e._sp=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:op});var s=new Cesium.ShaderSource({sources:[oN(),n.shaderSource,c6()],pickColorQualifier:"uniform"});e._pickSP=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._pickSP,vertexShaderSource:o,fragmentShaderSource:s,attributeLocations:op})}function gce(e,t,n){var r=t.context,o=f6(),a=new Cesium.ShaderSource({sources:[oN(),n.shaderSource,Cce()]});e._scanePlaneSP=Cesium.ShaderProgram.replaceCache({context:r,shaderProgram:e._scanePlaneSP,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:op})}function _ce(e,t,n){mce(e,t,n),e.showScanPlane&&gce(e,t,n)}function yce(e,t,n){n?(e._frontFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!0,face:Cesium.CullFace.BACK}}),e._backFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!0,face:Cesium.CullFace.FRONT}}),e._pickRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND})):(e._frontFaceRS=Cesium.RenderState.fromCache({depthTest:{enabled:!t},depthMask:!0}),e._pickRS=Cesium.RenderState.fromCache({depthTest:{enabled:!0},depthMask:!0}))}function aC(e,t,n,r,o,a,s,u,l,c,f,h){c&&n&&(n.vertexArray=s,n.renderState=o,n.shaderProgram=a,n.uniformMap=Cesium.combine(u,e._material._uniforms),n.uniformMap.u_normalDirection=function(){return-1},n.pass=f,n.modelMatrix=l,e._colorCommands.push(n)),t.vertexArray=s,t.renderState=r,t.shaderProgram=a,t.uniformMap=Cesium.combine(u,e._material._uniforms),h&&(t.uniformMap.u_type=function(){return 1}),t.pass=f,t.modelMatrix=l,e._colorCommands.push(t)}function vce(e,t){e._colorCommands.length=0;var n=Cesium.Pass.TRANSLUCENT;e.showLateralSurfaces&&aC(e,e._sectorFrontCommand,e._sectorBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorVA,e._uniforms,e._computedModelMatrix,t,n),e.showSectorLines&&aC(e,e._sectorLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showSectorSegmentLines&&aC(e,e._sectorSegmentLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorSegmentLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showDomeSurfaces&&aC(e,e._domeFrontCommand,e._domeBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._domeVA,e._uniforms,e._computedModelMatrix,t,n),aC(e,e._domeLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._domeLineVA,e._uniforms,e._computedModelMatrix,t,n,!0),e.showScanPlane&&aC(e,e._scanPlaneFrontCommand,e._scanPlaneBackCommand,e._frontFaceRS,e._backFaceRS,e._scanePlaneSP,e._scanPlaneVA,e._scanUniforms,e._computedScanPlaneModelMatrix,t,n)}function f6(){return`attribute vec4 position;
    attribute vec3 normal;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    void main()
    {
    gl_Position = czm_modelViewProjection * position;
    v_position = vec3(position);
    v_positionWC = (czm_model * position).xyz;
    v_positionEC = (czm_modelView * position).xyz;
    v_normalEC = czm_normal * normal;
    }
    `}function c6(){return`#ifdef GL_OES_standard_derivatives
    #extension GL_OES_standard_derivatives : enable
    #endif
    uniform bool u_showIntersection;
    uniform bool u_showThroughEllipsoid;
    uniform float u_radius;
    uniform float u_xHalfAngle;
    uniform float u_yHalfAngle;
    uniform float u_normalDirection;
    uniform float u_type;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    vec4 getColor(float sensorRadius, vec3 pointEC)
    {
    czm_materialInput materialInput;
    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;
    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);
    materialInput.str = pointMC / sensorRadius;
    vec3 positionToEyeEC = -v_positionEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    vec3 normalEC = normalize(v_normalEC);
    materialInput.normalEC = u_normalDirection * normalEC;
    czm_material material = czm_getMaterial(materialInput);
    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);
    }
    bool isOnBoundary(float value, float epsilon)
    {
    float width = getIntersectionWidth();
    float tolerance = width * epsilon;
    #ifdef GL_OES_standard_derivatives
    float delta = max(abs(dFdx(value)), abs(dFdy(value)));
    float pixels = width * delta;
    float temp = abs(value);
    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);
    #else
    return abs(value) < tolerance;
    #endif
    }
    vec4 shade(bool isOnBoundary)
    {
    if (u_showIntersection && isOnBoundary)
    {
    return getIntersectionColor();
    }
    if(u_type == 1.0){
    return getLineColor();
    }
    return getColor(u_radius, v_positionEC);
    }
    void main()
    {
    vec3 sensorVertexWC = czm_model[3].xyz;
    vec3 sensorVertexEC = czm_modelView[3].xyz;
    float positionX = v_position.x;
    float positionY = v_position.y;
    float positionZ = v_position.z;
    vec3 zDir = vec3(0.0, 0.0, 1.0);
    vec3 lineX = vec3(positionX, 0 ,positionZ);
    vec3 lineY = vec3(0, positionY, positionZ);
    float resX = dot(normalize(lineX), zDir);
    if(resX < cos(u_xHalfAngle)-0.00001){
    discard;
    }
    float resY = dot(normalize(lineY), zDir);
    if(resY < cos(u_yHalfAngle)-0.00001){
    discard;
    }
    bool isOnEllipsoid = false;
    gl_FragColor = shade(isOnEllipsoid);
    }
    `}function oN(){return`uniform vec4 u_intersectionColor;
    uniform float u_intersectionWidth;
    uniform vec4 u_lineColor;
    bool inSensorShadow(vec3 coneVertexWC, vec3 pointWC)
    {
    vec3 D = czm_ellipsoidInverseRadii;
    vec3 q = D * coneVertexWC;
    float qMagnitudeSquared = dot(q, q);
    float test = qMagnitudeSquared - 1.0;
    vec3 temp = D * pointWC - q;
    float d = dot(temp, q);
    return (d < -test) && (d / length(temp) < -sqrt(test));
    }
    vec4 getLineColor()
    {
    return u_lineColor;
    }
    vec4 getIntersectionColor()
    {
    return u_intersectionColor;
    }
    float getIntersectionWidth()
    {
    return u_intersectionWidth;
    }
    vec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)
    {
    float t = pointMC.z / sensorRadius;
    float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);
    s = s - floor(s);
    return vec2(s, t);
    }
    `}function Cce(){return`#ifdef GL_OES_standard_derivatives
    #extension GL_OES_standard_derivatives : enable
    #endif
    uniform bool u_showIntersection;
    uniform bool u_showThroughEllipsoid;
    uniform float u_radius;
    uniform float u_xHalfAngle;
    uniform float u_yHalfAngle;
    uniform float u_normalDirection;
    uniform vec4 u_color;
    varying vec3 v_position;
    varying vec3 v_positionWC;
    varying vec3 v_positionEC;
    varying vec3 v_normalEC;
    vec4 getColor(float sensorRadius, vec3 pointEC)
    {
    czm_materialInput materialInput;
    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;
    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);
    materialInput.str = pointMC / sensorRadius;
    vec3 positionToEyeEC = -v_positionEC;
    materialInput.positionToEyeEC = positionToEyeEC;
    vec3 normalEC = normalize(v_normalEC);
    materialInput.normalEC = u_normalDirection * normalEC;
    czm_material material = czm_getMaterial(materialInput);
    material.diffuse = u_color.rgb;
    material.alpha = u_color.a;
    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);
    }
    bool isOnBoundary(float value, float epsilon)
    {
    float width = getIntersectionWidth();
    float tolerance = width * epsilon;
    #ifdef GL_OES_standard_derivatives
    float delta = max(abs(dFdx(value)), abs(dFdy(value)));
    float pixels = width * delta;
    float temp = abs(value);
    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);
    #else
    return abs(value) < tolerance;
    #endif
    }
    vec4 shade(bool isOnBoundary)
    {
    if (u_showIntersection && isOnBoundary)
    {
    return getIntersectionColor();
    }
    return getColor(u_radius, v_positionEC);
    }
    void main()
    {
    vec3 sensorVertexWC = czm_model[3].xyz;
    vec3 sensorVertexEC = czm_modelView[3].xyz;
    float positionX = v_position.x;
    float positionY = v_position.y;
    float positionZ = v_position.z;
    vec3 zDir = vec3(0.0, 0.0, 1.0);
    vec3 lineX = vec3(positionX, 0 ,positionZ);
    vec3 lineY = vec3(0, positionY, positionZ);
    bool isOnEllipsoid =true;
    gl_FragColor = shade(isOnEllipsoid);
    }
    `}var jg=iI;function oI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this.id=e.id,this._scene=this._viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showSurfaces=Cesium.defaultValue(e.showSurfaces,!0),this.showLines=Cesium.defaultValue(e.showLines,!0),this._colorCommands=[],this._startYaw=Cesium.defaultValue(e.startYaw,0),this._yawSpan=Cesium.defaultValue(e.yawSpan,120),this._yawCount=Cesium.defaultValue(e.yawCount,10),this._startPitch=Cesium.defaultValue(e.startPitch,0),this._pitchSpan=Cesium.defaultValue(e.pitchSpan,50),this._pitchCount=Cesium.defaultValue(e.pitchCount,10),this.m_bClosed=Cesium.defaultValue(e.m_bClosed,!0),this.direction=Cesium.defaultValue(e.direction,0),this._center=new Cesium.Cartesian3,this.radius=Cesium.defaultValue(e.radius,30),this._radius=void 0,this.color=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,0,1)),this._position=void 0,this.position=e.position,this.endPos=Cesium.defaultValue(e.endPos,new Cesium.Cartesian3(0,0,0)),this.modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this.bottomRadius=Cesium.defaultValue(e.bottomRadius,2e3),this.orientation=e.orientation,this._orientation=void 0,this.waveDirection=Cesium.defaultValue(e.waveDirection,"WD_Horizontal"),this.wavePath=Cesium.defaultValue(e.wavePath,"right_Bottom"),this.angularRate=Cesium.defaultValue(e.angularRate,30),this.u_isTexture=Cesium.defaultValue(e.u_isTexture,0),this._texture=void 0,this._imageFilePath=Cesium.defaultValue(e.imageFilePath,Cesium.buildModuleUrl("Assets/EMExtensions/geometry3d.jpg")),this.imageFilePath=void 0,this.ms=Cesium.defaultValue(e.ms,.1),this.wavePoints=[],this.time=new Date().getTime(),this.index=0,this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1,cull:{enabled:!1,face:Cesium.CullFace.BACK}})}),this._sectorVA=void 0,this.showScan=Cesium.defaultValue(e.showScan,!1),this._showScan=void 0,this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}oI.prototype.addRadarWave=function(){var e=this;this.radarWave=this._viewer.entities.add({orientation:new Cesium.CallbackProperty(function(){var t=xce(e._position,e.endPos);return t.pitch+=Cesium.Math.PI_OVER_TWO,t.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(e._position,t)},!1),position:new Cesium.CallbackProperty(function(){var t=Cesium.Cartesian3.subtract(e._position,e.endPos,new Cesium.Cartesian3),n=Cesium.Cartesian3.divideByScalar(t,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(n,e.endPos,new Cesium.Cartesian3)},!1),cylinder:{length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(e._position,e.endPos)},!1),topRadius:0,bottomRadius:this.bottomRadius,showBottom:!1,showTop:!1,changeStCoordinate:!1,material:Cesium.Color.RED}}),e.wavePoints=wce(this)};function xce(e,t){var n=Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),l=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(l,new Cesium.Cartesian3),a=Math.atan2(o.y,o.x)-Cesium.Math.PI_OVER_TWO,s=Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(a),u=Cesium.Transforms.eastNorthUpToFixedFrame(e),l=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),c=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(u,u),l,l);Cesium.Cartesian3.normalize(c,c);var f=Cesium.Math.PI_OVER_TWO-Cesium.Math.acosClamped(c.z),h=new Cesium.HeadingPitchRoll(s,f,0);return h}function wce(e){var t=[],n=e._startYaw,r=e._startPitch,o=(e._yawSpan-n)/e._yawCount,a=(e._pitchSpan-r)/e._pitchCount,s=Cesium.Transforms.eastNorthUpToFixedFrame(e._position);if(e.waveDirection=="WD_Horizontal")switch(e.wavePath){case"right_Top":for(var u=e._pitchSpan;u>=r;u-=a)for(var l=n;l<=e._yawSpan;l+=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"right_Bottom":for(var u=r;u<=e._pitchSpan;u+=a)for(var l=n;l<=e._yawSpan;l+=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"left_Top":for(var u=e._pitchSpan;u>=r;u-=a)for(var l=e._yawSpan;l>=n;l-=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}break;case"left_Bottom":for(var u=r;u<=e._pitchSpan;u+=a)for(var l=e._yawSpan;l>=n;l-=o){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(u*Math.PI/180)*Math.sin(Cesium.Math.toRadians(l)),e.radius*Math.cos(u*Math.PI/180)*Math.cos(Cesium.Math.toRadians(l)),e.radius*Math.sin(Cesium.Math.toRadians(u))),new Cesium.Cartesian3);t.push(c)}}else if(e.waveDirection=="WD_Vertical")for(var u=n;u<=e._yawSpan;u+=o)for(var l=e._pitchSpan;l>=r;l-=a){var c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(l*Math.PI/180)*Math.sin(Cesium.Math.toRadians(u)),e.radius*Math.cos(l*Math.PI/180)*Math.cos(Cesium.Math.toRadians(u)),e.radius*Math.sin(Cesium.Math.toRadians(l))),new Cesium.Cartesian3);t.push(c)}else if(e.waveDirection=="WD_Random")for(var u=n;u<e._yawSpan;u+=o)for(var f=Math.floor(Math.random()*(e._yawSpan-n+1))+n,l=e._pitchSpan;l>r;l-=a){var h=Math.floor(Math.random()*(e._pitchSpan-r+1))+r,c=Cesium.Matrix4.multiplyByPoint(s,new Cesium.Cartesian3(e.radius*Math.cos(h*Math.PI/180)*Math.sin(Cesium.Math.toRadians(f)),e.radius*Math.cos(l*Math.PI/180)*Math.cos(Cesium.Math.toRadians(f)),e.radius*Math.sin(Cesium.Math.toRadians(h))),new Cesium.Cartesian3);t.push(c)}return t}oI.prototype.update=function(e){var t=this;this._colorCommands.length=0;var n=e.mode,r=e.context,o=this._viewer.scene.frameState.time;if(this.show instanceof Array?Ece(this,o):this._show!=this.show&&(this._show=this.show),!this._show||n!==Cesium.SceneMode.SCENE3D)return;if(this.position instanceof Cesium.SampledPositionProperty?this._position=this.position.getValue(o):this._position!=this.position&&(this._position=this.position),this.showScan&&this._showScan!=this.showScan&&(this._showScan=this.showScan,this.addRadarWave()),this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this._radius),this.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this.modelMatrix,this._radius,this.modelMatrix),Cesium.defined(this._orientation)){var a=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(this.direction+this._yawSpan/2),0,0),new Cesium.Matrix3),Cesium.Cartesian3.ZERO,new Cesium.Matrix4);this.modelMatrix=Cesium.Matrix4.multiply(this.modelMatrix,a,new Cesium.Matrix4)}if(this.imageFilePath!=this._imageFilePath){this.imageFilePath=this._imageFilePath;var s=this.imageFilePath,u={flipY:!0,preferImageBitmap:!0};Cesium.Resource.createIfNeeded(s).fetchImage(u).then(l).catch(c)}function l(w){t._texture=new Cesium.Texture({context:r,pixelFormat:Cesium.PixelFormat.RGBA,pixelDatatype:Cesium.PixelDatatype.UNSIGNED_BYTE,source:w,sampler:new Cesium.Sampler({minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})}),t._fillCommand.uniformMap={u_isTexture:function(){return t.u_isTexture},u_texture:function(){return t._texture}}}function c(w){console.error(w.message)}Cesium.BoundingSphere.transform(this._boundingSphere,this.modelMatrix,this._boundingSphere),Sce(this,e);var f=new Date().getTime();if(f-this.time>=500&&(this.time=f,Cesium.defined(this.radarWave)&&(this.index>=this.wavePoints.length&&(this.index=0),this.endPos=this.wavePoints[this.index++])),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:r,vertexShaderSource:Dce(),fragmentShaderSource:Pce()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:r,vertexShaderSource:Mce(),fragmentShaderSource:Lce()})),this.showSurfaces&&Cesium.defined(this._texture)&&(d6(this._fillVA,this.modelMatrix,this._boundingSphere,this._fillCommand),this._colorCommands.push(this._fillCommand)),this.showLines&&Cesium.defined(this._outlineVA)&&(d6(this._outlineVA,this.modelMatrix,this._boundingSphere,this._outlineCommand),this._colorCommands.push(this._outlineCommand)),!!Cesium.defined(this._texture)){var h=e.commandList,d=e.passes,p=this._colorCommands;if(d.render)for(var g=0,y=p.length;g<y;g++){var v=p[g];h.push(v)}}};oI.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return this.radarWave&&this._viewer.entities.contains(this.radarWave)&&this._viewer.entities.remove(this.radarWave),Cesium.destroyObject(this)};function Ece(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=Tce(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.orientation)&&(e._orientation=e.orientation.getValue(t));return}}else e._show=!1,e._orientation=void 0}function Tce(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function Sce(e,t){var n=t.context;if(e.showSurfaces){var r=Ace(e);e._fillVA=h6(e,n,r,!0)}if(e.showLines){var o=bce(e);e._outlineVA=h6(e,n,o,!1)}}function Ace(e){var t=e._yawCount,n=e._pitchCount,r=0,o=e.color,a=e._startYaw,s=e._yawSpan,u=(e._yawSpan-a)/t,l=e._startPitch,c=e._pitchSpan,f=(e._pitchSpan-l)/n,h=0,d=0,p=(t+1)*(n+1);p++;var g=n*t*6;e.m_bClosed&&((l!=-90||c!=90)&&(g+=(t-1)*6),(a!=0||s!=360)&&(g+=(n+1)*6));for(var y=Cesium.IndexDatatype.createTypedArray(p,g),v=new Float64Array(p*3),w=new Uint8Array(p*4),C=new Float32Array(p*2),E=0,S=0,A=0,D=l;D<c+f;D+=f){var P=D>c?c:D;d++,h=0;for(var M=a;M<s+u;M+=u){h++;var I=M>s?s:M,O=Math.cos(Cesium.Math.toRadians(P))*Math.sin(Cesium.Math.toRadians(I)),m=Math.cos(Cesium.Math.toRadians(I))*Math.cos(Cesium.Math.toRadians(P)),b=Math.sin(Cesium.Math.toRadians(P));v[E++]=O+r,v[E++]=m,v[E++]=b;var L=1-(M-a)/(s-a),R=1-(D-l)/(c-l);C[A++]=L,C[A++]=R,w[S++]=Cesium.Color.floatToByte(o.red),w[S++]=Cesium.Color.floatToByte(o.green),w[S++]=Cesium.Color.floatToByte(o.blue),w[S++]=Cesium.Color.floatToByte(o.alpha)}}v[E++]=r,v[E++]=0,v[E++]=0,w[S++]=Cesium.Color.floatToByte(o.red),w[S++]=Cesium.Color.floatToByte(o.green),w[S++]=Cesium.Color.floatToByte(o.blue),w[S++]=Cesium.Color.floatToByte(o.alpha);for(var N=0,D=0;D<d;D++)for(var M=0;M<h;M++)D+1<d&&M+1<h&&(y[N++]=D*h+M,y[N++]=(D+1)*h+M,y[N++]=(D+1)*h+M+1,y[N++]=D*h+M,y[N++]=(D+1)*h+M+1,y[N++]=D*h+M+1);if(e.m_bClosed){var B=d*h;if(l!=-90||c!=90)for(var D=0;D<h-1;D++)y[N++]=B,y[N++]=D,y[N++]=D+1,y[N++]=B,y[N++]=(d-1)*h+D+1,y[N++]=(d-1)*h+D;if(a!=0||s!=360)for(var M=0;M<d+1;M++)y[N++]=B,y[N++]=M*h,y[N++]=(M+1)*h,y[N++]=B,y[N++]=(M+1)*h+h-1,y[N++]=M*h+h-1}return{position:v,color:w,stPosition:C,indices:y}}function bce(e){var t=e._yawCount,n=e._pitchCount,r=0,o=e.lineColor,a=1,s=e._startYaw,u=e._yawSpan,l=(e._yawSpan-s)/t,c=e._startPitch,f=e._pitchSpan,h=(e._pitchSpan-c)/n,d=0,p=0,g=(t+1)*(n+1);g++;for(var y=new Float64Array(g*3),v=new Uint8Array(g*4),w=0,C=0,E=c;E<f+h;E+=h){var S=E>f?f:E;p++,d=0;for(var A=s;A<u+l;A+=l){d++;var D=A>u?u:A,P=Math.cos(Cesium.Math.toRadians(S))*Math.sin(Cesium.Math.toRadians(D)),M=Math.cos(Cesium.Math.toRadians(D))*Math.cos(Cesium.Math.toRadians(S)),I=Math.sin(Cesium.Math.toRadians(S));y[w++]=P+r,y[w++]=M,y[w++]=I,v[C++]=Cesium.Color.floatToByte(o.red),v[C++]=Cesium.Color.floatToByte(o.green),v[C++]=Cesium.Color.floatToByte(o.blue),v[C++]=Cesium.Color.floatToByte(o.alpha)}}y[w++]=r,y[w++]=0,y[w++]=0,v[C++]=Cesium.Color.floatToByte(o.red),v[C++]=Cesium.Color.floatToByte(o.green),v[C++]=Cesium.Color.floatToByte(o.blue),v[C++]=Cesium.Color.floatToByte(o.alpha);var O=0,m=(p-1)*d*2+p*(d-1)*2;e.m_bClosed&&(s!=0||u!=360)&&(c!=-90||f!=90)&&(m+=9);for(var b=Cesium.IndexDatatype.createTypedArray(g,m),E=0;E<p;E++)for(var A=0;A<d;A++)E+1<p&&(b[O++]=E*d+A,b[O++]=(E+1)*d+A),A+1<d&&(b[O++]=E*d+A,b[O++]=E*d+A+1);if(e.m_bClosed&&(s!=0||u!=360)&&(c!=-90||f!=90)){var L=p*d;b[O++]=L,b[O++]=0,b[O++]=L,b[O++]=d-1,b[O++]=L,b[O++]=(p-1)*d,b[O++]=L,b[O++]=L-1}return{position:y,color:v,indices:b}}function h6(e,t,n,r){var o=Ice(e),a=Cesium.Buffer.createVertexBuffer({context:t,typedArray:o,usage:Cesium.BufferUsage.STATIC_DRAW}),s=12,u=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),l={czm_modelMatrixRow0:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:u*4,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:a,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:u*8,strideInBytes:u*s,instanceDivisor:1}},c=0,f=[];return f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),r&&f.push({index:c++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float32Array(n.stPosition.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),l.czm_modelMatrixRow0.index=c++,f.push(l.czm_modelMatrixRow0),l.czm_modelMatrixRow1.index=c++,f.push(l.czm_modelMatrixRow1),l.czm_modelMatrixRow2.index=c++,f.push(l.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:f,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Ice(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r));var a=[],s=e.modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function d6(e,t,n,r){r.vertexArray=e,r.modelMatrix=t,r._boundingVolume=n}function Dce(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec2 st;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
 varying vec2 v_texCoord;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    v_texCoord = st;
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Pce(){var e=`uniform sampler2D u_texture;
uniform float u_isTexture;
varying vec4  v_colour;
varying vec2 v_texCoord;
void main()
{
if(u_isTexture<0.5){  gl_FragColor = v_colour;
}else{
   gl_FragColor = texture2D(u_texture, v_texCoord);
}
}
`;return e}function Mce(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model*  vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Lce(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var sC=oI;function Jw(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.lon)||!Cesium.defined(e.lat)||!Cesium.defined(e.height))throw new Cesium.DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=e.id,this._scene=this.viewer.scene,this._lon=e.lon,this._lat=e.lat,this._height=e.height,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.startYaw=Cesium.defaultValue(e.startYaw,0),this.endYaw=Cesium.defaultValue(e.endYaw,360),this.minorRadius=Cesium.defaultValue(e.minorRadius,5300),this._minorRadius=void 0,this.longRadius=Cesium.defaultValue(e.longRadius,15200),this._longRadius=void 0,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.ZERO,this.longRadius),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._attributeLocations=void 0,this._allCommands=[],this.instance=Cesium.defaultValue(e.instance,void 0),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({depthTest:!0})}),this._scene.primitives.add(this)}Jw.prototype.update=function(e){this._allCommands.length=0;var t=e.context,n=this;this.longRadius instanceof Cesium.CallbackProperty?this._longRadius=this.longRadius.getValue(e.time):this._longRadius=this.longRadius,this.minorRadius instanceof Cesium.CallbackProperty?this._minorRadius=this.minorRadius.getValue(e.time):this._minorRadius=this.minorRadius,this._position=Cesium.Cartesian3.fromDegrees(this._lon,this._lat,this._height),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),Cesium.BoundingSphere.transform(this._boundingSphere,this._modelMatrix,this._boundingSphere),this._fillCommand.uniformMap={v_colour:function(){return n.fillColor}};var r=this.createFillMesh();this._fillVA=p6(this,t,r),this._outlineCommand.uniformMap={v_colour:function(){return n.lineColor}};var o=this.createOutlineMesh();this._outlineVA=p6(this,t,o),Cesium.defined(this._fillCommand.shaderProgram)||(this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:m6(),fragmentShaderSource:g6()})),Cesium.defined(this._outlineCommand.shaderProgram)||(this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:m6(),fragmentShaderSource:g6()})),this._fillCommand.vertexArray=this._fillVA,this._outlineCommand.vertexArray=this._outlineVA,this.renderStyle!=2&&this._allCommands.push(this._fillCommand),this.renderStyle!=1&&this._allCommands.push(this._outlineCommand);var a=e.commandList,s=e.passes,u=this._allCommands;if(this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,s.render&&this._show)for(var l=0,c=u.length;l<c;l++){var f=u[l];a.push(f)}};Jw.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function p6(e,t,n){var r=Rce(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Rce(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}Jw.prototype.createFillMesh=function(){var e=1;if(this.renderStyle==1)var t=this.endYaw-this.startYaw;else{e=15,this.endYaw-this.startYaw<=15&&(e=1);var t=(this.endYaw-this.startYaw)/e+1}t=t*3;for(var n=new Float64Array(t*3),r=t*2,o=this._longRadius,a=this._minorRadius,s=0,u=0,l=Cesium.IndexDatatype.createTypedArray(t,r),c=this.startYaw;c<=this.endYaw;c+=e)n[s++]=a*Math.sin(c*Math.PI/180),n[s++]=a*Math.cos(c*Math.PI/180),n[s++]=0,n[s++]=o*Math.sin(c*Math.PI/180),n[s++]=o*Math.cos(c*Math.PI/180),n[s++]=0;for(var f=0;f<t-1;f++)l[u++]=f,l[u++]=f+1,l[u++]=f+2;return{position:n,indices:l}};Jw.prototype.createOutlineMesh=function(){var e=1;if(this.renderStyle==1)var t=this.endYaw-this.startYaw;else{e=15,this.endYaw-this.startYaw<=15&&(e=1);var t=(this.endYaw-this.startYaw)/e+1}t=t*2;for(var n=new Float64Array(t*3),r=t*4,o=this._longRadius,a=this._minorRadius,s=0,u=0,l=Cesium.IndexDatatype.createTypedArray(t,r),c=0,f=this.startYaw;f<this.endYaw+e;f+=e)n[s++]=a*Math.sin(f*Math.PI/180),n[s++]=a*Math.cos(f*Math.PI/180),n[s++]=0,n[s++]=o*Math.sin(f*Math.PI/180),n[s++]=o*Math.cos(f*Math.PI/180),n[s++]=0;for(var h=0;h<t;h+=2)l[u++]=h,l[u++]=h+1,l[u++]=h,h!=t-2&&(l[u++]=h+2,l[u++]=h+1,l[u++]=h+2,l[u++]=h+1,l[u++]=h+3);return{position:n,indices:l}};function m6(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function g6(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var uC=Jw;function aI(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.instances))throw new Cesium.DeveloperError("\u53C2\u6570options.instance\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.instances=e.instances,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.viewer=e.viewer,this._scene=this.viewer.scene,this._radius=Cesium.defaultValue(e.radius,10),this.lineColor=Cesium.defaultValue(e.lineColor,Cesium.Color.WHITE),this._center=new Cesium.Cartesian3,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}aI.prototype.update=function(e){var t=e.context,n=this,r=this._command;this._command.uniformMap={v_colour:function(){return n.lineColor}},Cesium.defined(r.shaderProgram)||(r.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Bce(),fragmentShaderSource:Fce()}));var o=this.createLineMesh();if(this.instances.length>0&&(r.vertexArray=Oce(this,t,o),r.instanceCount=this.instances.length,r.cull=!0,r._boundingVolume=this.boundingSphere),this.show instanceof Cesium.CallbackProperty?this._show=this.show.getValue():this._show=this.show,Cesium.defined(r.vertexArray)&&this._show){var a=e.commandList;a.push(r)}};aI.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function Oce(e,t,n){var r=Nce(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Nce(e){var t=e.instances,n=t.length,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix,c=Cesium.Matrix4.clone(l,new Cesium.Matrix4);c[12]-=r.x,c[13]-=r.y,c[14]-=r.z,s.push(new Cesium.Cartesian3(c[12],c[13],c[14]));var f=u*o;a[f+0]=c[0],a[f+1]=c[4],a[f+2]=c[8],a[f+3]=c[12],a[f+4]=c[1],a[f+5]=c[5],a[f+6]=c[9],a[f+7]=c[13],a[f+8]=c[2],a[f+9]=c[6],a[f+10]=c[10],a[f+11]=c[14]}return e.boundingSphere=Cesium.BoundingSphere.fromPoints(s),a}aI.prototype.createLineMesh=function(){var e=2,t=new Float64Array(e*3),n=e,r=this.radius,o=0,a=Cesium.IndexDatatype.createTypedArray(e,2);return t[o++]=0,t[o++]=this._radius,t[o++]=0,t[o++]=0,t[o++]=-this._radius,t[o++]=0,a[0]=0,a[1]=1,{position:t,indices:a}};function Bce(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Fce(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var sI=aI;function eE(e){if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this.id=e.id,this.ringArr=[],this.entityArr=[],this.circleCenter=e.position,console.log(this.circleCenter),this._position=this.circleCenter,this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this.circleCenter),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix),this.show=Cesium.defaultValue(e.show,!0),this._showLines=Cesium.defaultValue(e._showLines,!0),this._rowNumber=Cesium.defaultValue(e.rowNumber,3),this._columnNumber=Cesium.defaultValue(e.columnNumber,6),this.lineShow=Cesium.defaultValue(e.lineShow,!0),this._innerRadius=Cesium.defaultValue(e.innerRadius,4e3),this._innerColor=Cesium.defaultValue(e.innerColor,new Cesium.Color(1,1,0,1)),this.ringRadius=Cesium.defaultValue(e.ringRadius,[4e3,7500,1e4]),this.ringColor=Cesium.defaultValue(e.ringColor,[new Cesium.Color(1,1,0,.5),new Cesium.Color(1,0,0,.5),new Cesium.Color(0,0,1,.5)]),this._labels=this._viewer.scene.primitives.add(new Cesium.LabelCollection),this.distanceDisplayCondition=Cesium.defaultValue(e.distanceDisplayCondition,new Cesium.DistanceDisplayCondition(0,5e5));var t=this;this.createRing(),this.createLabels();var n=this.setInstance();this.line=new sI({viewer:this._viewer,radius:this.ringRadius[this.ringRadius.length-1],instances:n,show:new Cesium.CallbackProperty(function(){return t.show},!1)})}eE.prototype.setInstance=function(){for(var e=[],t=180/this._columnNumber,n=0,r=0;r<this._columnNumber;r++){var o=n*Cesium.Math.PI/180,a=Cesium.Matrix3.fromRotationZ(o,new Cesium.Matrix3),s=Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,a,new Cesium.Matrix4);e.push({modelMatrix:s}),n+=t}return e};eE.prototype.createRing=function(){var e=this._rowNumber,t=this,n=$w(this.circleCenter).height<=0?2:$w(this.circleCenter).height;if(console.log(n),e>0){var r=this._viewer.entities.add({position:this.circleCenter,ellipse:{semiMinorAxis:this._innerRadius,semiMajorAxis:this._innerRadius,material:this._innerColor,height:n}});if(this.entityArr.push(r),this._rowNumber==this.ringRadius.length&&this._rowNumber==this.ringColor.length)for(var o=0;o<this._rowNumber-1;o++){var a=new uC({viewer:this._viewer,show:new Cesium.CallbackProperty(function(){return t.show},!1),minorRadius:this.ringRadius[o],longRadius:this.ringRadius[o+1],fillColor:this.ringColor[o+1],lineColor:this.ringColor[o+1],lon:$w(this.circleCenter).lon,lat:$w(this.circleCenter).lat,height:$w(this.circleCenter).height,renderStyle:1});this.ringArr.push(a)}else throw new DeveloperError("\u5706\u73AF\u6570\u91CF\u4E0E\u53C2\u6570\u4E0D\u5339\u914D\u3002")}};eE.prototype.createLabels=function(){for(var e=this,t=360/(2*this._columnNumber),n=0,r=0;r<this._columnNumber*2;r++){var o=n*Cesium.Math.PI/180,a=new Cesium.Cartesian3((this.ringRadius[this.ringRadius.length-1]+1e3)*Math.sin(o),(this.ringRadius[this.ringRadius.length-1]+1e3)*Math.cos(o),0),s=Cesium.Matrix4.multiplyByPoint(this._modelMatrix,a,new Cesium.Cartesian3),u=this._viewer.entities.add({position:s,label:{text:n+"\xB0",font:"20px \u5B8B\u4F53",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,10),disableDepthTestDistance:Number.POSITIVE_INFINITY,outlineColor:Cesium.Color.RED,style:Cesium.LabelStyle.FILL_AND_OUTLINE,distanceDisplayCondition:e.distanceDisplayCondition,fillColor:Cesium.Color.RED,show:new Cesium.CallbackProperty(function(){return e.show},!1)}});this.entityArr.push(u),n+=t}for(var r=0;r<this._rowNumber;r++){var l=new Cesium.Cartesian3(0,this.ringRadius[r],0),c=Cesium.Matrix4.multiplyByPoint(this._modelMatrix,l,new Cesium.Cartesian3),f=this._viewer.entities.add({position:c,label:{text:zce(this.ringRadius[r]),font:"20px \u5B8B\u4F53",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,10),disableDepthTestDistance:Number.POSITIVE_INFINITY,outlineColor:Cesium.Color.RED,style:Cesium.LabelStyle.FILL_AND_OUTLINE,distanceDisplayCondition:e.distanceDisplayCondition,fillColor:Cesium.Color.RED,show:new Cesium.CallbackProperty(function(){return e.show},!1)}});this.entityArr.push(f)}};eE.prototype.destroy=function(){if(this.line&&this.line.destroy(),this.ringArr.length!=0)for(var e=0;e<this.ringArr.length;e++)this.ringArr[e].destroy();if(this.entityArr.length!=0)for(var e=0;e<this.entityArr.length;e++)this._viewer.entities.remove(this.entityArr[e])};function zce(e){return e>=1e3?(e/=1e3,e.toFixed(0)+"km"):e.toFixed(0)+"m"}function $w(e){var t=new Cesium.Cartographic.fromCartesian(e,Cesium.Ellipsoid.WGS84),n=Cesium.Math.toDegrees(t.longitude),r=Cesium.Math.toDegrees(t.latitude),o=t.height;return{lon:n,lat:r,height:o}}var uI=eE;function _6(){if(!_(Du._canTransferArrayBuffer)){let e=new Worker(v6("Workers/transferTypedArrayTest.js"));e.postMessage=T(e.webkitPostMessage,e.postMessage);let t=99,n=new Int8Array([t]);try{e.postMessage({array:n},[n.buffer])}catch{return Du._canTransferArrayBuffer=!1,Du._canTransferArrayBuffer}let r=Ro();e.onmessage=function(o){let a=o.data.array,s=_(a)&&a[0]===t;r.resolve(s),e.terminate(),Du._canTransferArrayBuffer=s},Du._canTransferArrayBuffer=r.promise}return Du._canTransferArrayBuffer}var sN=new xe;function y6(e,t){--e._activeTasks;let n=t.id;if(!_(n))return;let r=e._deferreds,o=r[n];if(_(t.error)){let a=t.error;a.name==="RuntimeError"?(a=new it(t.error.message),a.stack=t.error.stack):a.name==="DeveloperError"&&(a=new Le(t.error.message),a.stack=t.error.stack),sN.raiseEvent(a),o.reject(a)}else sN.raiseEvent(),o.resolve(t.result);delete r[n]}function v6(e){let t=Pa(e);if(ob(t)){let n=`importScripts("${t}");`,r;try{r=new Blob([n],{type:"application/javascript"})}catch{let s=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,u=new s;u.append(n),r=u.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(r)}return t}var aN;function Vce(){return _(aN)||(aN=v6("Workers/cesiumWorkerBootstrapper.js")),aN}function C6(e){let t=new Worker(Vce());t.postMessage=T(t.webkitPostMessage,t.postMessage);let n={loaderConfig:{paths:{Workers:Pa("Workers")},baseUrl:Pa.getCesiumBaseUrl().url},workerModule:e._workerPath};return t.postMessage(n),t.onmessage=function(r){y6(e,r.data)},t}function kce(e,t){let n={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Qo.supportsWebAssembly()){if(!_(t.fallbackModulePath))throw new it(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return n.modulePath=Pa(t.fallbackModulePath),Promise.resolve(n)}return n.modulePath=Pa(t.modulePath),n.wasmBinaryFile=Pa(t.wasmBinaryFile),_t.fetchArrayBuffer({url:n.wasmBinaryFile}).then(function(r){return n.wasmBinary=r,n})}function Du(e,t){let n=new Qi.default(e);this._workerPath=n.scheme().length!==0&&n.fragment().length===0?e:Du._workerModulePrefix+e,this._maximumActiveTasks=T(t,Number.POSITIVE_INFINITY),this._activeTasks=0,this._deferreds={},this._nextID=0}var Gce=[];Du.prototype.scheduleTask=function(e,t){if(_(this._worker)||(this._worker=C6(this)),this._activeTasks>=this._maximumActiveTasks)return;++this._activeTasks;let n=this;return Promise.resolve(_6()).then(function(r){_(t)?r||(t.length=0):t=Gce;let o=n._nextID++,a=Ro();return n._deferreds[o]=a,n._worker.postMessage({id:o,parameters:e,canTransferArrayBuffer:r},t),a.promise})};Du.prototype.initWebAssemblyModule=function(e){_(this._worker)||(this._worker=C6(this));let t=Ro(),n=this,r=this._worker;return kce(this,e).then(function(o){return Promise.resolve(_6()).then(function(a){let s,u=o.wasmBinary;_(u)&&a&&(s=[u]),r.onmessage=function(l){r.onmessage=function(c){y6(n,c.data)},t.resolve(l.data)},r.postMessage({webAssemblyConfig:o},s)})}),t.promise};Du.prototype.isDestroyed=function(){return!1};Du.prototype.destroy=function(){return _(this._worker)&&this._worker.terminate(),ot(this)};Du.taskCompletedEvent=sN;Du._defaultWorkerModulePrefix="Workers/";Du._workerModulePrefix=Du._defaultWorkerModulePrefix;Du._canTransferArrayBuffer=void 0;var Gc=Du;function lC(e){this.vertexData=void 0,this.blUpdateVAO=!1,this.allInvisible=!0,this.backColor=new Cesium.Color(30/255,100/255,50/255,.5);var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1}),uniformMap:{u_backColor:function(){return t.backColor}}})}Object.defineProperties(lC.prototype,{});var Uce=new Gc("createRibbonVertices",1);function Hce(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec3 normal; 
attribute vec4 color; 
varying vec4  v_colour;
uniform vec4 u_backColor; 
void main()
{
   v_colour = vec4(color.r, color.g, color.b, color.a); 
   vec4 position;
   if(czm_morphTime == 1.0){
       position = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
   }else if(czm_morphTime == 0.0){
       position = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
   }else{
       position = czm_columbusViewMorph(
       czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
       czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
       czm_morphTime);
    }
   vec4 positionEC = czm_modelViewRelativeToEye * position;
   vec4 positionWC = czm_inverseView * positionEC;
   if(dot(normalize(normal), normalize(czm_viewerPositionWC-positionWC.xyz)) < 0.0){
     v_colour = u_backColor; 
   }
   gl_Position = czm_projection * positionEC;
   #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
   #endif
}
`;return e}function qce(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}lC.prototype.recreateVertexArrays=function(e){this.allInvisible=!0;var t=e.length;if(e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)Cesium.defined(e[r])&&e[r].ribbonVisible&&e[r].trackPoints.length>1&&(n.push({color:e[r].ribbonColor,scale:e[r].ribbonScale,trackPoints:e[r].trackPoints,forwardOffset:e[r].forwardOffset,upOffset:e[r].upOffset}),this.allInvisible=!1);if(n.length>0){var o=Uce.scheduleTask({ribbons:n});if(!Cesium.defined(o)){n=[];return}var a=this;o.then(function(s){a.vertexData=s,a.blUpdateVAO=!0})}}};lC.prototype.update=function(e){var t=e.context,n=this._command;if(!!Cesium.defined(this.vertexData)){if(this.allInvisible&&Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO){Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy();var r=0,o=[];o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.position3DHighBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.position3DLowBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(this.vertexData.normalBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),o.push({index:r++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(this.vertexData.colorBuffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:o,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.vertexData.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.vertexData.position3DHighBuffer.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=new Cesium.BoundingSphere(this.vertexData.boundingSphere.center,this.vertexData.boundingSphere.radius),Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Hce(),fragmentShaderSource:qce()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var a=e.commandList;a.push(n)}this.blUpdateVAO=!1}};lC.prototype.isDestroyed=function(){return!1};lC.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var cC=lC;function uN(e){this.viewer=e.viewer,this.mHorizontalnum=e.mHorizontalnum,this.sectionPoints=e.sectionPoints,this.mpVerticalVector=[],this.mpSplitLineVector=[],this.mpScaleVectorList=[],this.maxAngle=0,this.mOnlyTerrain=!0,this.workName="calculateShadeAnalysist",this._maxTaskConcurrency=T(5,e._maxTaskConcurrency),this.radius=e.radius,this.taskNum=T(e.taskNum,8),this.modelMatrix=e.modelMatrix,this.radarPosition=e.radarPosition}uN.prototype.shadeAnalysistCalculateOnlyTerrain=function(e,t){let n=this.radarPosition,r=1,o=new x,a=this.mHorizontalnum,s=e.length/a;for(let u=0;u<a;u++){Qce(this,u,e);let l=this.mpVerticalVector.length;for(let c=0;c<l;c++){let f=this.mpVerticalVector[c].mPitchAngle,h={};h.verticalAngle=f,h.powerScale=1,this.mpScaleVectorList.push(h)}r-2>l&&(r=r/5),o=this.mpVerticalVector[r].mPitchPoint,Xce(this,n,o,t),jce(this,u*s,t,this.mpSplitLineVector,this.mpVerticalVector,n,o)}};uN.prototype.shadeAnalysistCalculateOnlyTerrainByThread=function(e,t){let n=this.mHorizontalnum,r=this,o=this.viewer.scene.globe._surface._tileProvider.tilingScheme.ellipsoid,a=Wce(this),s=[];for(let u=0;u<this.taskNum;u++){let l=new Gc(this.workName,this._maxTaskConcurrency);s.push(l),this.promise=l.scheduleTask({taskNum:this.taskNum,count:n,index:u,ellipsoid:o,tileMesh:a,sectionPoints:this.sectionPoints,modelMatrix:this.modelMatrix,vertexVector:e,splitNum:t,radarPosition:this.radarPosition}),l._worker.onmessage=function(c){let f=c.data;if(_(f.index)&&_(f.mpScaleVectorList)){let h=f.index;s[h].destroy();let d=f.mpScaleVectorList,p=d.length;if(h===r.taskNum-1){let g=p-r.sectionPoints.length;for(let y=0;y<p;y++)r.mpScaleVectorList[h*g+y]=d[y]}else for(let g=0;g<p;g++)r.mpScaleVectorList[h*p+g]=d[g]}}}};function Wce(e){let t=e.radarPosition,n=e.radius,r=ce.fromCartesian(t),o=yn.eastNorthUpToFixedFrame(t),a=new x(n*Math.cos(0),n*Math.sin(0),0);U.multiplyByPoint(o,a,a);let s=ce.fromCartesian(a),u,l,c,f;l=c=s.longitude,u=f=s.latitude;for(let g=0;g<360;g++){let y=new x(n*Math.cos(g),n*Math.sin(g),0);U.multiplyByPoint(o,y,y);let v=ce.fromCartesian(y),w=v.longitude,C=v.latitude;f>C&&(f=C),u<C&&(u=C),l>w&&(l=w),c<w&&(c=w)}let h=new ln(l,f,c,u),d=e.viewer.scene.globe._surface._levelZeroTiles;return Yce(d,r,h)}function Yce(e,t,n){let r=[];if(!_(e))return;let o,a,s=e.length;for(a=0;a<s&&(o=e[a],!ln.contains(o.rectangle,t));++a);let u=z_(o._southwestChild,n)?lI(o,n):void 0,l=z_(o._southeastChild,n)?lI(o,n):void 0,c=z_(o._northwestChild,n)?lI(o,n):void 0,f=z_(o._northeastChild,n)?lI(o,n):void 0;return _(u)&&(r=r.concat(u)),_(l)&&(r=r.concat(l)),_(c)&&(r=r.concat(c)),_(f)&&(r=r.concat(f)),r}function lI(e,t){let n=[],r=[];for(;_(e);)e=z_(e._southwestChild,t)||z_(e._southeastChild,t)||z_(e._northwestChild,t)||e._northeastChild,_(e)&&_(e.data)&&_(e.data.renderedMesh)&&r.push(e);for(let o=0;o<r.length;o++){let a=r[o];if(!_(a)||!_(a.data)||!_(a.data.renderedMesh))return;n.push(a.data.mesh)}return n}function z_(e,t){return _(e)&&ln.simpleIntersection(e.rectangle,t)?e:void 0}function Xce(e,t,n,r){e.mpSplitLineVector=[];let o=[];e.maxAngle=-90;let a=ce.fromCartesian(t),s=ce.fromCartesian(n),u=Math.toDegrees(a.longitude),l=Math.toDegrees(a.latitude),c=Math.toDegrees(s.longitude),f=Math.toDegrees(s.latitude),h=e.viewer.scene.globe.getHeight(a),d=new x.fromDegrees(u,l,h);o=x6(e,r,u,l,c,f,!0),e.mpSplitLineVector=[{mPitchAngle:-90,mPitchPoint:o[0]}];let p=x.normalize(new x(-d.x,-d.y,-d.z));for(let g=0;g<r;g++){let y=x.subtract(o[r-g],d);if(y.x!==0&&y.y!==0&&y.z!==0){let v=x.normalize(y),w=x.dot(p,v),C=Math.toDegrees(Math.acos(w))-90;C>e.maxAngle&&(e.mpSplitLineVector.push({mPitchAngle:C,mPitchPoint:o[r-g]}),e.maxAngle=C)}}}function jce(e,t,n,r,o,a,s){let u=o.length;for(let l=0;l<u-1;l++){let c=x.normalize(new x(-a.x,-a.y,-a.z)),f=x.subtract(o[l+1].mPitchPoint,a);if(f.x!==0&&f.y!==0&&f.z!==0){let h=x.normalize(f),d=Math.toDegrees(Math.acos(x.dot(c,h)))-90,p=o[l+1].mPitchPoint;if(!(d>=e.maxAngle)){let g=-100,y=-1,v=-1,w=500,C=r.length;for(let E=0;E<C-1;E++)if(r[E].mPitchAngle>=d?r[E].mPitchAngle<w&&(w=r[E].mPitchAngle,v=E):r[E].mPitchAngle>g&&(g=r[E].mPitchAngle,y=E),v!==-1&&y!==-1){let S=x.subtract(p,a),A=r[v].mPitchPoint,D=r[y].mPitchPoint,P=Zce(e,n,A,D,d,h),M=0,I=1e8,O=0;for(let N=0;N<P.length;N++){let B=P[N],G=ce.fromCartesian(B.vector).height,F=Math.abs(B.linePTHeight-G);F<I&&(I=F,O=N)}let m=P[O],b=ce.fromCartesian(m.vector);b.height=m.linePTHeight;let L=ce.toCartesian(b);M=x.distance(L,e.radarPosition);let R=M/x.magnitude(S);R>1&&(R=1),R<0&&(R=1e-5),e.mpScaleVectorList[t+u-l-2].powerScale=R,e.mpScaleVectorList[t+u-l-2].verticalAngle=d}}}}}function x6(e,t,n,r,o,a,s){let u=[],l=Kce(r,n,a,o),c=Math.sin(l),f=Math.cos(Math.toRadians(r)),h=Math.cos(Math.toRadians(a));for(let d=0;d<=t;d++){let p=d/t,g=Math.sin((1-p)*l)/c,y=Math.sin(p*l)/c,v=g*f*Math.cos(Math.toRadians(n))+y*h*Math.cos(Math.toRadians(o)),w=g*f*Math.sin(Math.toRadians(n))+y*h*Math.sin(Math.toRadians(o)),C=g*Math.sin(Math.toRadians(r))+y*Math.sin(Math.toRadians(a)),E=Math.toDegrees(Math.atan2(C,Math.sqrt(v*v+w*w))),S=Math.toDegrees(Math.atan2(w,v)),A=0;s&&(A=e.viewer.scene.globe.getHeight(new ce(Math.toRadians(S),Math.toRadians(E)))),u.push(new x.fromDegrees(S,E,A))}return u}function Kce(e,t,n,r){let o=Math.toRadians(r,t),a=Math.toRadians(n,e),s=Math.sin(a*.5),u=Math.sin(o*.5),l=s*s+Math.cos(Math.toRadians(e))*Math.cos(Math.toRadians(n))*u*u;return 2*Math.asin(Math.min(1,Math.sqrt(l)))}function Zce(e,t,n,r,o,a){let s=[],u=ce.fromCartesian(n),l=ce.fromCartesian(r),c=Math.toDegrees(u.longitude),f=Math.toDegrees(u.latitude),h=Math.toDegrees(l.longitude),d=Math.toDegrees(l.latitude),p=x6(e,t,c,f,h,d,!0);for(let g=0;g<p.length;g++){let y={},w=x.distance(p[g],e.radarPosition)/Math.cos(Math.toRadians(o)),C=x.add(e.radarPosition,x.multiplyByScalar(a,w,new x)),E=ce.fromCartesian(C);y.linePTHeight=E.height,y.vector=p[g],s.push(y)}return s}function Qce(e,t,n){e.mpVerticalVector=[];let r=n.length/e.mHorizontalnum,o=t*r;for(let a=0;a<r;a++){let s=n[o+r-1-a];s=U.multiplyByVector(e.modelMatrix,new Se(s.x,s.y,s.z,1),new x),e.sectionPoints[a].mPitchPoint=x.fromCartesian4(s),e.mpVerticalVector.push(e.sectionPoints[a])}}var cI=uN;function fI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this._id=e.id,this.id=e.id,this._scene=this._viewer.scene,this.instances=e.instances,this.scanInstances=this.instances,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.showScan=Cesium.defaultValue(e.showScan,!0),this._position=Cesium.defaultValue(e.position,new Cesium.Cartesian3(100,20,1e3)),this._colorCommands=[],this._startYaw=Cesium.defaultValue(e.startYaw,0),this._endYaw=Cesium.defaultValue(e.endYaw,360),this._angularRate=Cesium.defaultValue(e.angularRate,50),this.curAngle=Cesium.defaultValue(e.curAngle,0),this.deltaAngle=Cesium.defaultValue(e.deltaAngle,15),this._center=new Cesium.Cartesian3,this.radius=Cesium.defaultValue(e.radius,300),this.isDepthTest=Cesium.defaultValue(e.isDepthTest,!1),this._radius=void 0,this.envelopeColor=Cesium.defaultValue(e.envelopeColor,new Cesium.Color(1,.5,.1,.5)),this.scanColor=Cesium.defaultValue(e.sectorColor,new Cesium.Color(1,1,1,.28)),this._geoCenter=e.geoCenter,this.powerData=Cesium.defaultValue(e.powerData,[]),this.scanInArr=[0,143,142,0,1,143,142,285,284,142,143,285,1,144,143,1,2,144,143,286,285,143,144,286,2,145,144,2,3,145,144,287,286,144,145,287,3,146,145,3,4,146,145,288,287,145,146,288,4,147,146,4,5,147,146,289,288,146,147,289,5,148,147,5,6,148,147,290,289,147,148,290,6,149,148,6,7,149,148,291,290,148,149,291,7,150,149,7,8,150,149,292,291,149,150,292,8,151,150,8,9,151,150,293,292,150,151,293,9,152,151,9,10,152,151,294,293,151,152,294,10,153,152,10,11,153,152,295,294,152,153,295,11,154,153,11,12,154,153,296,295,153,154,296,12,155,154,12,13,155,154,297,296,154,155,297,13,156,155,13,14,156,155,298,297,155,156,298,14,157,156,14,15,157,156,299,298,156,157,299,15,158,157,15,16,158,157,300,299,157,158,300,16,159,158,16,17,159,158,301,300,158,159,301,17,160,159,17,18,160,159,302,301,159,160,302,18,161,160,18,19,161,160,303,302,160,161,303,19,162,161,19,20,162,161,304,303,161,162,304,20,163,162,20,21,163,162,305,304,162,163,305,21,164,163,21,22,164,163,306,305,163,164,306,22,165,164,22,23,165,164,307,306,164,165,307,23,166,165,23,24,166,165,308,307,165,166,308,24,167,166,24,25,167,166,309,308,166,167,309,25,168,167,25,26,168,167,310,309,167,168,310,26,169,168,26,27,169,168,311,310,168,169,311,27,170,169,27,28,170,169,312,311,169,170,312,28,171,170,28,29,171,170,313,312,170,171,313,29,172,171,29,30,172,171,314,313,171,172,314,30,173,172,30,31,173,172,315,314,172,173,315,31,174,173,31,32,174,173,316,315,173,174,316,32,175,174,32,33,175,174,317,316,174,175,317,33,176,175,33,34,176,175,318,317,175,176,318,34,177,176,34,35,177,176,319,318,176,177,319,35,178,177,35,36,178,177,320,319,177,178,320,36,179,178,36,37,179,178,321,320,178,179,321,37,180,179,37,38,180,179,322,321,179,180,322,38,181,180,38,39,181,180,323,322,180,181,323,39,182,181,39,40,182,181,324,323,181,182,324,40,183,182,40,41,183,182,325,324,182,183,325,41,184,183,41,42,184,183,326,325,183,184,326,42,185,184,42,43,185,184,327,326,184,185,327,43,186,185,43,44,186,185,328,327,185,186,328,44,187,186,44,45,187,186,329,328,186,187,329,45,188,187,45,46,188,187,330,329,187,188,330,46,189,188,46,47,189,188,331,330,188,189,331,47,190,189,47,48,190,189,332,331,189,190,332,48,191,190,48,49,191,190,333,332,190,191,333,49,192,191,49,50,192,191,334,333,191,192,334,50,193,192,50,51,193,192,335,334,192,193,335,51,194,193,51,52,194,193,336,335,193,194,336,52,195,194,52,53,195,194,337,336,194,195,337,53,196,195,53,54,196,195,338,337,195,196,338,54,197,196,54,55,197,196,339,338,196,197,339,55,198,197,55,56,198,197,340,339,197,198,340,56,199,198,56,57,199,198,341,340,198,199,341,57,200,199,57,58,200,199,342,341,199,200,342,58,201,200,58,59,201,200,343,342,200,201,343,59,202,201,59,60,202,201,344,343,201,202,344,60,203,202,60,61,203,202,345,344,202,203,345,61,204,203,61,62,204,203,346,345,203,204,346,62,205,204,62,63,205,204,347,346,204,205,347,63,206,205,63,64,206,205,348,347,205,206,348,64,207,206,64,65,207,206,349,348,206,207,349,65,208,207,65,66,208,207,350,349,207,208,350,66,209,208,66,67,209,208,351,350,208,209,351,67,210,209,67,68,210,209,352,351,209,210,352,68,211,210,68,69,211,210,353,352,210,211,353,69,212,211,69,70,212,211,354,353,211,212,354,70,213,212,70,71,213,212,355,354,212,213,355,71,214,213,71,72,214,213,356,355,213,214,356,72,215,214,72,73,215,214,357,356,214,215,357,73,216,215,73,74,216,215,358,357,215,216,358,74,217,216,74,75,217,216,359,358,216,217,359,75,218,217,75,76,218,217,360,359,217,218,360,76,219,218,76,77,219,218,361,360,218,219,361,77,220,219,77,78,220,219,362,361,219,220,362,78,221,220,78,79,221,220,363,362,220,221,363,79,222,221,79,80,222,221,364,363,221,222,364,80,223,222,80,81,223,222,365,364,222,223,365,81,224,223,81,82,224,223,366,365,223,224,366,82,225,224,82,83,225,224,367,366,224,225,367,83,226,225,83,84,226,225,368,367,225,226,368,84,227,226,84,85,227,226,369,368,226,227,369,85,228,227,85,86,228,227,370,369,227,228,370,86,229,228,86,87,229,228,371,370,228,229,371,87,230,229,87,88,230,229,372,371,229,230,372,88,231,230,88,89,231,230,373,372,230,231,373,89,232,231,89,90,232,231,374,373,231,232,374,90,233,232,90,91,233,232,375,374,232,233,375,91,234,233,91,92,234,233,376,375,233,234,376,92,235,234,92,93,235,234,377,376,234,235,377,93,236,235,93,94,236,235,378,377,235,236,378,94,237,236,94,95,237,236,379,378,236,237,379,95,238,237,95,96,238,237,380,379,237,238,380,96,239,238,96,97,239,238,381,380,238,239,381,97,240,239,97,98,240,239,382,381,239,240,382,98,241,240,98,99,241,240,383,382,240,241,383,99,242,241,99,100,242,241,384,383,241,242,384,100,243,242,100,101,243,242,385,384,242,243,385,101,244,243,101,102,244,243,386,385,243,244,386,102,245,244,102,103,245,244,387,386,244,245,387,103,246,245,103,104,246,245,388,387,245,246,388,104,247,246,104,105,247,246,389,388,246,247,389,105,248,247,105,106,248,247,390,389,247,248,390,106,249,248,106,107,249,248,391,390,248,249,391,107,250,249,107,108,250,249,392,391,249,250,392,108,251,250,108,109,251,250,393,392,250,251,393,109,252,251,109,110,252,251,394,393,251,252,394,110,253,252,110,111,253,252,395,394,252,253,395,111,254,253,111,112,254,253,396,395,253,254,396,112,255,254,112,113,255,254,397,396,254,255,397,113,256,255,113,114,256,255,398,397,255,256,398,114,257,256,114,115,257,256,399,398,256,257,399,115,258,257,115,116,258,257,400,399,257,258,400,116,259,258,116,117,259,258,401,400,258,259,401,117,260,259,117,118,260,259,402,401,259,260,402,118,261,260,118,119,261,260,403,402,260,261,403,119,262,261,119,120,262,261,404,403,261,262,404,120,263,262,120,121,263,262,405,404,262,263,405,121,264,263,121,122,264,263,406,405,263,264,406,122,265,264,122,123,265,264,407,406,264,265,407,123,266,265,123,124,266,265,408,407,265,266,408,124,267,266,124,125,267,266,409,408,266,267,409,125,268,267,125,126,268,267,410,409,267,268,410,126,269,268,126,127,269,268,411,410,268,269,411,127,270,269,127,128,270,269,412,411,269,270,412,128,271,270,128,129,271,270,413,412,270,271,413,129,272,271,129,130,272,271,414,413,271,272,414,130,273,272,130,131,273,272,415,414,272,273,415,131,274,273,131,132,274,273,416,415,273,274,416,132,275,274,132,133,275,274,417,416,274,275,417,133,276,275,133,134,276,275,418,417,275,276,418,134,277,276,134,135,277,276,419,418,276,277,419,135,278,277,135,136,278,277,420,419,277,278,420,136,279,278,136,137,279,278,421,420,278,279,421,137,280,279,137,138,280,279,422,421,279,280,422,138,281,280,138,139,281,280,423,422,280,281,423,139,282,281,139,140,282,281,424,423,281,282,424,140,283,282,140,141,283,282,425,424,282,283,425,0,2,1,0,3,2,0,4,3,0,5,4,0,6,5,0,7,6,0,8,7,0,9,8,0,10,9,0,11,10,0,12,11,0,13,12,0,14,13,0,15,14,0,16,15,0,17,16,0,18,17,0,19,18,0,20,19,0,21,20,0,22,21,0,23,22,0,24,23,0,25,24,0,26,25,0,27,26,0,28,27,0,29,28,0,30,29,0,31,30,0,32,31,0,33,32,0,34,33,0,35,34,0,36,35,0,37,36,0,38,37,0,39,38,0,40,39,0,41,40,0,42,41,0,43,42,0,44,43,0,45,44,0,46,45,0,47,46,0,48,47,0,49,48,0,50,49,0,51,50,0,52,51,0,53,52,0,54,53,0,55,54,0,56,55,0,57,56,0,58,57,0,59,58,0,60,59,0,61,60,0,62,61,0,63,62,0,64,63,0,65,64,0,66,65,0,67,66,0,68,67,0,69,68,0,70,69,0,71,70,0,72,71,0,73,72,0,74,73,0,75,74,0,76,75,0,77,76,0,78,77,0,79,78,0,80,79,0,81,80,0,82,81,0,83,82,0,84,83,0,85,84,0,86,85,0,87,86,0,88,87,0,89,88,0,90,89,0,91,90,0,92,91,0,93,92,0,94,93,0,95,94,0,96,95,0,97,96,0,98,97,0,99,98,0,100,99,0,101,100,0,102,101,0,103,102,0,104,103,0,105,104,0,106,105,0,107,106,0,108,107,0,109,108,0,110,109,0,111,110,0,112,111,0,113,112,0,114,113,0,115,114,0,116,115,0,117,116,0,118,117,0,119,118,0,120,119,0,121,120,0,122,121,0,123,122,0,124,123,0,125,124,0,126,125,0,127,126,0,128,127,0,129,128,0,130,129,0,131,130,0,132,131,0,133,132,0,134,133,0,135,134,0,136,135,0,137,136,0,138,137,0,139,138,0,140,139,0,141,140,284,285,286,284,286,287,284,287,288,284,288,289,284,289,290,284,290,291,284,291,292,284,292,293,284,293,294,284,294,295,284,295,296,284,296,297,284,297,298,284,298,299,284,299,300,284,300,301,284,301,302,284,302,303,284,303,304,284,304,305,284,305,306,284,306,307,284,307,308,284,308,309,284,309,310,284,310,311,284,311,312,284,312,313,284,313,314,284,314,315,284,315,316,284,316,317,284,317,318,284,318,319,284,319,320,284,320,321,284,321,322,284,322,323,284,323,324,284,324,325,284,325,326,284,326,327,284,327,328,284,328,329,284,329,330,284,330,331,284,331,332,284,332,333,284,333,334,284,334,335,284,335,336,284,336,337,284,337,338,284,338,339,284,339,340,284,340,341,284,341,342,284,342,343,284,343,344,284,344,345,284,345,346,284,346,347,284,347,348,284,348,349,284,349,350,284,350,351,284,351,352,284,352,353,284,353,354,284,354,355,284,355,356,284,356,357,284,357,358,284,358,359,284,359,360,284,360,361,284,361,362,284,362,363,284,363,364,284,364,365,284,365,366,284,366,367,284,367,368,284,368,369,284,369,370,284,370,371,284,371,372,284,372,373,284,373,374,284,374,375,284,375,376,284,376,377,284,377,378,284,378,379,284,379,380,284,380,381,284,381,382,284,382,383,284,383,384,284,384,385,284,385,386,284,386,387,284,387,388,284,388,389,284,389,390,284,390,391,284,391,392,284,392,393,284,393,394,284,394,395,284,395,396,284,396,397,284,397,398,284,398,399,284,399,400,284,400,401,284,401,402,284,402,403,284,403,404,284,404,405,284,405,406,284,406,407,284,407,408,284,408,409,284,409,410,284,410,411,284,411,412,284,412,413,284,413,414,284,414,415,284,415,416,284,416,417,284,417,418,284,418,419,284,419,420,284,420,421,284,421,422,284,422,423,284,423,424,284,424,425],this.sectionPoints=[],this.vertexPositions=[],this.points=[],this.mpTerrainShade=void 0,this.scanSpeed=Cesium.defaultValue(e.scanSpeed,1500),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._scanModelMatrix=Cesium.defaultValue(e.scanModelMatrix,new Cesium.Matrix4),this.updateRotator=!1,this.changeScan=!1,this._time=new Date().getTime(),this.shadeType=Cesium.defaultValue(e.shadeType,1),this.tsSectionPoint=[{mPitchAngle:0,mPitchPoint:new Cesium.Cartesian3(0,0,0)}],this.maxPowerDistance=0,this.mHorizontalnum=parseInt(360/this.deltaAngle)+1,this.scanIndex=0,this.startTerrainShade=Cesium.defaultValue(e.startTerrainShade,!0),this.updateShade=Cesium.defaultValue(e.updateShade,!1),this.terrainShadeProgress=0,this.filePath=Cesium.defaultValue(e.filePath,Cesium.buildModuleUrl("Assets/EMExtensions/powerData.txt")),this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._scanCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:this.isDepthTest},depthMask:!1})}),this._fillVA=void 0,this._outlineVA=void 0,this._scanVA=void 0;var t=new Cesium.Resource({url:this.filePath}),n=this;t.fetchText().then(function(r){for(var o=r.split(`\r
`),a=0;a<o.length-1;a++){var s=o[a].indexOf("=");n.powerData.push({x:o[a].substring(0,s),y:o[a].substring(s+1)})}Jce(n)}),this._scene.primitives.add(this)}function Jce(e){e.points=$ce(e);for(var t=0;t<e.points.length;++t)e.sectionPoints.push(new Cesium.Cartesian3(0,e.points[t].y,e.points[t].x));e.updateRotator=!0}function $ce(e){var t=[];t.push(new Cesium.Cartesian2(0,0));for(var n=e.powerData.length-1;n>=0;--n){var r=e.powerData[n].y;r>e.maxPowerDistance&&(e.maxPowerDistance=r);var o=Cesium.Math.toRadians(e.powerData[n].x);if(t.push(new Cesium.Cartesian2(r*Math.cos(o),r*Math.sin(o))),e.startTerrainShade){var a={};a.mPitchAngle=Number(e.powerData[n].x),a.mPitchPoint=new Cesium.Cartesian3(0,r*Math.sin(o)*1e3,r*Math.cos(o)*1e3),e.tsSectionPoint.push(a)}}return t.push(new Cesium.Cartesian2(0,0)),e.tsSectionPoint.push({mPitchAngle:0,mPitchPoint:new Cesium.Cartesian3(0,0,0)}),t}fI.prototype.update=function(e){this._colorCommands.length=0;var t=e.mode,n=e.context,r=this._viewer.scene.frameState.time;if(this.show instanceof Array?efe(this,r):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){if(this.radius instanceof Cesium.CallbackProperty?this._radius=this.radius.getValue(e.time):this._radius=this.radius,!Cesium.defined(this._modelMatrix)){this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,this._radius,this._modelMatrix);var o=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,o,this._modelMatrix),this._scanModelMatrix=this._modelMatrix}if(this.showScan){var a=new Date().getTime();if(a-this._time>this.scanSpeed){if(!this.changeScan)this.instances?this.curAngle+=1:this.curAngle+=this.deltaAngle,this.curAngle=this.curAngle>360?this.curAngle-360:this.curAngle,this.updateScan=!0;else{this.points=[];var s=this.vertexPositions.length/this.mHorizontalnum;this.curAngle+=this.deltaAngle,this.curAngle>=this._endYaw&&(this.curAngle=0,this.scanIndex=0),this.scanIndex=this.mHorizontalnum-1-parseInt(this.curAngle/this.deltaAngle);for(var u=this.vertexPositions.slice(this.scanIndex*s,(this.scanIndex+1)*s),l=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(this.curAngle)),c=Cesium.Matrix3.fromQuaternion(l,new Cesium.Matrix3),f=0;f<u.length;f++){var h=Cesium.Matrix3.multiplyByVector(Cesium.Matrix3.inverse(c,new Cesium.Matrix3),u[f],new Cesium.Cartesian3);this.points.push(h)}}ufe(this,new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(this.curAngle),0,0),new Cesium.Cartesian3(10,1,1)),this._time=a}}nfe(this,e),this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:fN(),fragmentShaderSource:hN()}),this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:fN(),fragmentShaderSource:hN()}),this._scanCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:fN(),fragmentShaderSource:hN()}),this.show&&Cesium.defined(this._fillVA)&&cN(this,this._fillVA,this._modelMatrix,this._fillCommand),this.show&&Cesium.defined(this._outlineVA)&&cN(this,this._outlineVA,this._modelMatrix,this._outlineCommand),this.updateScan&&Cesium.defined(this._scanVA)&&cN(this,this._scanVA,this._scanModelMatrix,this._scanCommand);var d=e.commandList,p=e.passes,g=this._colorCommands;if(p.render)for(var f=0,y=g.length;f<y;f++){var v=g[f];d.push(v)}}};fI.prototype.destroy=function(){if(this._scene.primitives.contains(this)){var e=this._scene.primitives._primitives.indexOf(this);e!==-1&&(this._scene.primitives._primitives.splice(e,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return Cesium.destroyObject(this)};fI.prototype.calTerrainShade=function(e){if(Cesium.defined(this.mpTerrainShade))throw new Error("\u5730\u5F62\u906E\u853D\u5DF2\u5F00\u542F");var t=this.maxPowerDistance*this._radius;switch(this.mpTerrainShade=new cI({viewer:this._viewer,sectionPoints:this.tsSectionPoint,mHorizontalnum:this.mHorizontalnum,radarPosition:this._position,modelMatrix:this._modelMatrix,radius:t}),this.shadeType){case 0:this.mpTerrainShade.shadeAnalysistCalculateOnlyTerrain(this.vertexPositions,e);for(var n=0;n<this.vertexPositions.length;n++){var r=this.mpTerrainShade.mpScaleVectorList[n].powerScale;r!=1&&(this.vertexPositions[n]=Cesium.Cartesian3.multiplyByScalar(this.vertexPositions[n],r,new Cesium.Cartesian3))}this.updateShade=!0,this.changeScan=!0;break;case 1:this.mpTerrainShade.shadeAnalysistCalculateOnlyTerrainByThread(this.vertexPositions,e);var o=this,a=0,s=setInterval(function(){o.terrainShadeProgress<99&&o.terrainShadeProgress++,a++;var u=o.mpTerrainShade.mpScaleVectorList,l=(u.length-o.tsSectionPoint.length)/8;if(l>0&&Cesium.defined(u[0])&&Cesium.defined(u[l])&&Cesium.defined(u[l*2])&&Cesium.defined(u[l*3])&&Cesium.defined(u[l*4])&&Cesium.defined(u[l*5])&&Cesium.defined(u[l*6])&&Cesium.defined(u[l*7])&&Cesium.defined(u[0].powerScale)&&Cesium.defined(u[l].powerScale)&&Cesium.defined(u[l*2].powerScale)&&Cesium.defined(u[l*3].powerScale)&&Cesium.defined(u[l*4].powerScale)&&Cesium.defined(u[l*5].powerScale)&&Cesium.defined(u[l*6].powerScale)&&Cesium.defined(u[l*7].powerScale)){clearInterval(s),o.terrainShadeProgress=100;for(var c=0;c<o.vertexPositions.length;c++){var f=u[c].powerScale;f!=1&&(o.vertexPositions[c]=Cesium.Cartesian3.multiplyByScalar(o.vertexPositions[c],f,new Cesium.Cartesian3))}o.updateShade=!0,o.changeScan=!0}},1e3);break;case 2:this.mpTerrainShade.shadeAnalysistCalculateOnlyNearAngle(this.vertexPositions,e,shadeDataList);break;case 3:this.mpTerrainShade.shadeAnalysistCalculateWithTerrainNearAngle(this.vertexPositions,e,shadeDataList);break}};function efe(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=tfe(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show);return}}else e._show=!1,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show)}function tfe(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function nfe(e,t){var n=t.context;if(e.show&&(e.updateRotator||e.updateShade)){e.updateRotator=!1;var r=rfe(e,e.sectionPoints);e._fillVA=lN(e,n,e._modelMatrix,e.instances,r);var o=ife(e,e.sectionPoints);e._outlineVA=lN(e,n,e._modelMatrix,e.instances,o)}if(e.showScan&&e.updateScan&&(e.points.length!=0||e.updateShade)){var a=ofe(e,e.points);e._scanVA=lN(e,n,e._scanModelMatrix,e.scanInstances,a)}e.updateShade&&(e.updateShade=!1)}function rfe(e,t){if(!(t.length<=1)){var n=new Cesium.Color(e.envelopeColor.red,e.envelopeColor.green,e.envelopeColor.blue,.2),r=e._startYaw,o=e._endYaw,a=e.deltaAngle,s=(o-r)/a+1,u=s*t.length,l=(s-1)*t.length*6,c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=0,p=0,g=0,y=0;if(e.updateShade){if(e.vertexPositions.length==0)return;y=e.vertexPositions.length/t.length}else for(var v=r;v<o+a;v+=a){y++;for(var w=v>o?o:v,C=0;C<t.length;C++){var E=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.fromQuaternion(E,new Cesium.Matrix3),A=Cesium.Matrix3.multiplyByVector(S,t[C],new Cesium.Cartesian3);e.vertexPositions.push(A)}}for(var D=0;D<e.vertexPositions.length;D++){var P=e.vertexPositions[D];f[d++]=P.x,f[d++]=P.y,f[d++]=P.z,h[p++]=Cesium.Color.floatToByte(n.red),h[p++]=Cesium.Color.floatToByte(n.green),h[p++]=Cesium.Color.floatToByte(n.blue),h[p++]=Cesium.Color.floatToByte(n.alpha)}for(var M=0;M<y;++M)for(var I=0;I<t.length-1;++I)M<y-1&&(c[g++]=M*t.length+I,c[g++]=(M+1)*t.length+I+1,c[g++]=M*t.length+I+1,c[g++]=M*t.length+I,c[g++]=(M+1)*t.length+I,c[g++]=(M+1)*t.length+I+1);return{position:f,color:h,indices:c}}}function ife(e,t){if(!(t.length<=1)){var n=e.envelopeColor,r=e._startYaw,o=e._endYaw,a=e.deltaAngle,s=(o-r)/a+1,u=s*t.length,l=u*4,c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=0,p=0,g=0,y=0;if(e.updateShade){if(e.vertexPositions.length==0)return;y=e.vertexPositions.length/t.length}else for(var v=r;v<o+a;v+=a){y++;for(var w=v>o?o:v,C=0;C<t.length;C++)var E=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Y,Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.fromQuaternion(E,new Cesium.Matrix3),A=Cesium.Matrix3.multiplyByVector(S,t[C],new Cesium.Cartesian3)}for(var D=0;D<e.vertexPositions.length;D++){var P=e.vertexPositions[D];f[d++]=P.x,f[d++]=P.y,f[d++]=P.z,h[p++]=Cesium.Color.floatToByte(n.red),h[p++]=Cesium.Color.floatToByte(n.green),h[p++]=Cesium.Color.floatToByte(n.blue),h[p++]=Cesium.Color.floatToByte(n.alpha)}for(var M=0,I=0;I<y;++I)for(var O=0;O<t.length-1;++O)(I!=y-1||o-r!=360)&&(M++,c[g++]=I*t.length+O,c[g++]=I*t.length+O+1),I<y-1&&(M++,c[g++]=I*t.length+O,c[g++]=(I+1)*t.length+O);return{position:f,color:h,indices:c}}}function ofe(e,t){for(var n=e.scanColor,r=t.length,o=r*3,a=new Float64Array(r*3),s=new Uint8Array(r*4),u=new Uint32Array(e.scanInArr),l=0,c=0,f=0;f<t.length;++f)e.changeScan?(a[l++]=0,a[l++]=t[f].y,a[l++]=t[f].z):(a[l++]=0,a[l++]=t[f].y,a[l++]=t[f].x),s[c++]=Cesium.Color.floatToByte(n.red),s[c++]=Cesium.Color.floatToByte(n.green),s[c++]=Cesium.Color.floatToByte(n.blue),s[c++]=Cesium.Color.floatToByte(n.alpha);return{position:a,color:s,indices:u}}function lN(e,t,n,r,o){if(r)var a=sfe(e,r);else var a=afe(e,n);var s=Cesium.Buffer.createVertexBuffer({context:t,typedArray:a,usage:Cesium.BufferUsage.STATIC_DRAW}),u=12,l=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),c={czm_modelMatrixRow0:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:l*u,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:l*4,strideInBytes:l*u,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:l*8,strideInBytes:l*u,instanceDivisor:1}},f=0,h=[];return h.push({index:f++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(o.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),h.push({index:f++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(o.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),c.czm_modelMatrixRow0.index=f++,h.push(c.czm_modelMatrixRow0),c.czm_modelMatrixRow1.index=f++,h.push(c.czm_modelMatrixRow1),c.czm_modelMatrixRow2.index=f++,h.push(c.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:h,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(o.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function afe(e,t){var n=new Cesium.Matrix4,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(o));var s=[],u=Cesium.Matrix4.clone(t,n);return u[12]-=r.x,u[13]-=r.y,u[14]-=r.z,s.push(new Cesium.Cartesian3(u[12],u[13],u[14])),a[0]=u[0],a[1]=u[4],a[2]=u[8],a[3]=u[12],a[4]=u[1],a[5]=u[5],a[6]=u[9],a[7]=u[13],a[8]=u[2],a[9]=u[6],a[10]=u[10],a[11]=u[14],a}function sfe(e,t){var n=t.length,r=new Cesium.Matrix4,o=e._center,a=12,s=e._vertexBufferTypedArray;Cesium.defined(s)||(s=new Float32Array(n*a));for(var u=[],l=0;l<n;++l){var c=Cesium.Matrix4.clone(t[l],r);c[12]-=o.x,c[13]-=o.y,c[14]-=o.z,u.push(new Cesium.Cartesian3(c[12],c[13],c[14]));var f=l*a;s[f+0]=c[0],s[f+1]=c[4],s[f+2]=c[8],s[f+3]=c[12],s[f+4]=c[1],s[f+5]=c[5],s[f+6]=c[9],s[f+7]=c[13],s[f+8]=c[2],s[f+9]=c[6],s[f+10]=c[10],s[f+11]=c[14]}return s}function cN(e,t,n,r){e.instances?(r.vertexArray=t,r.instanceCount=e.instances.length):(r.vertexArray=t,r.modelMatrix=n),e._colorCommands.push(r)}function ufe(e,t,n){var r=e.scanInstances;if(r)for(var o=0;o<r.length;o++){var a=Cesium.Matrix3.fromRotationY(t.heading,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(r[o],a,r[o])}else{e._scanModelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e._position),Cesium.Matrix4.multiplyByUniformScale(e._scanModelMatrix,e._radius,e._scanModelMatrix);var s=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(e._scanModelMatrix,s,e._scanModelMatrix);var a=Cesium.Matrix3.fromRotationY(t.heading,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(e._scanModelMatrix,a,e._scanModelMatrix);var u=Cesium.Matrix4.fromScale(n);e._scanModelMatrix=Cesium.Matrix4.multiply(e._scanModelMatrix,u,e._scanModelMatrix)}}function fN(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function hN(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var Kg=fI;function hI(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570options.position\u4E0D\u80FD\u4E3A\u7A7A\u3002");this._viewer=e.viewer,this._id=e.id,this.id=e.id,this._scene=this._viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._show=void 0,this.renderStyle=Cesium.defaultValue(e.renderStyle,0),this._center=new Cesium.Cartesian3,this.position=e.position,this._position=void 0,this.outRadius=Cesium.defaultValue(e.outRadius,4e4),this.inRadius=Cesium.defaultValue(e.inRadius,1e4),this._colorCommands=[],this.color=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,.3)),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),this.yawRange=Cesium.defaultValue(e.yawRange,new Cesium.Cartesian2(0,360)),this.pitchRange=Cesium.defaultValue(e.pitchRange,new Cesium.Cartesian2(-90,90)),this.circleDensity=Cesium.defaultValue(e.circleDensity,36),this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this.topRadius=Cesium.defaultValue(e.topRadius,3e3),this.angularRate=Cesium.defaultValue(e.angularRate,50),this.waveDirection=Cesium.defaultValue(e.waveDirection,"WD_Horizontal"),this.wavePath=Cesium.defaultValue(e.wavePath,"WP_Z"),this.ms=Cesium.defaultValue(e.ms,100),this.wavePoints=[],this._fillCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._sectorVA=void 0,this.showScan=Cesium.defaultValue(e.showScan,!1),this._showScan=void 0,this._outlineCommand=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}hI.prototype.addRadarWave=function(){var e=Cesium.Cartographic.fromCartesian(this._position,Cesium.Ellipsoid.WGS84);e.height+=this.outRadius/2;var t=Cesium.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,Cesium.Ellipsoid.WGS84);this.radarWave=this._viewer.entities.add({position:t,show:this._show,cylinder:{length:this.outRadius,topRadius:this.topRadius,bottomRadius:0,showBottom:!1,showTop:!1,changeStCoordinate:!1,material:this.color}})};hI.prototype.update=function(e){this._colorCommands.length=0;var t=e.mode,n=e.context,r=this._viewer.scene.frameState.time;if(this.show instanceof Array?lfe(this,r):this._show!=this.show&&(this._show=this.show),!(!this._show||t!==Cesium.SceneMode.SCENE3D)){this.position instanceof Cesium.ConstantPositionProperty?this._position=this.position.getValue(e.time):this._position=this.position,this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),Cesium.Matrix4.multiplyByUniformScale(this._modelMatrix,1,this._modelMatrix);var o=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,new Cesium.Matrix3);Cesium.Matrix4.multiplyByMatrix3(this._modelMatrix,o,this._modelMatrix),this.showScan&&this._showScan!=this.showScan&&(this._showScan=this.showScan,this.addRadarWave()),ffe(this,e),this._fillCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:T6(),fragmentShaderSource:S6()}),this._outlineCommand.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:T6(),fragmentShaderSource:S6()}),this.renderStyle!=2&&Cesium.defined(this._fillVA)&&E6(this,this._fillVA,this._modelMatrix,this._boundingSphere,this._fillCommand),this.renderStyle!=1&&Cesium.defined(this._outlineVA)&&E6(this,this._outlineVA,this._modelMatrix,this._boundingSphere,this._outlineCommand);var a=e.commandList,s=e.passes,u=this._colorCommands;if(s.render)for(var l=0,c=u.length;l<c;l++){var f=u[l];a.push(f)}}};hI.prototype.destroy=function(){var e=this._fillCommand,t=this._outlineCommand;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._scene.primitives.contains(this)){var n=this._scene.primitives._primitives.indexOf(this);n!==-1&&(this._scene.primitives._primitives.splice(n,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return this.radarWave&&this._viewer.entities.contains(this.radarWave)&&this._viewer.entities.remove(this.radarWave),Cesium.destroyObject(this)};function lfe(e,t){if(e.show.length>0)for(var n=0;n<e.show.length;n++)if(e.show[n].boolean){var r=e.show[n].interval,o=cfe(r);if(Cesium.JulianDate.compare(o.start,t)<=0&&Cesium.JulianDate.compare(o.stop,t)>=0){e._show=!0,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show);return}}else e._show=!1,Cesium.defined(e.radarWave)&&(e.radarWave.show=e._show)}function cfe(e){var t={iso8601:void 0};if(!!Cesium.defined(e))return t.iso8601=e,Cesium.TimeInterval.fromIso8601(t)}function ffe(e,t){var n=t.context;if(e.renderStyle!=2&&!Cesium.defined(e._fillVA)){var r=hfe(e);e._fillVA=w6(e,n,r)}if(e.renderStyle!=1&&!Cesium.defined(e._outlineVA)){var o=dfe(e);e._outlineVA=w6(e,n,o)}}function hfe(e){var t=A6(e);if(!(t.length<=1)){var y=0,n=0,r=e.yawRange.y-e.yawRange.x,o=e.pitchRange.y-e.pitchRange.x,a=360/e.circleDensity,s=(r/a+1)*t.length,u=(r/a+1)*(t.length-1)*6;r<360&&(s+=(o/a+1)*4,u+=o/a*12);for(var l=Cesium.IndexDatatype.createTypedArray(s,u),c=new Float64Array(s*3),f=new Uint8Array(s*4),h=e.color,d=0,p=0,g=0,y=0,v=n;v<r+a;v+=a){y++;for(var w=v>r?r:v,C=0;C<t.length;C++){var E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.multiplyByVector(E,t[C],new Cesium.Cartesian3);c[d++]=S.x,c[d++]=S.y,c[d++]=S.z,f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha)}}for(var v=0;v<y;++v)for(var C=0;C<t.length-1;++C)v<y-1&&(l[g++]=v*t.length+C,l[g++]=(v+1)*t.length+C+1,l[g++]=v*t.length+C+1,l[g++]=v*t.length+C,l[g++]=(v+1)*t.length+C,l[g++]=(v+1)*t.length+C+1);if(r<360){for(var A=d/3,D=0,P=e.pitchRange.x;P<e.pitchRange.y+a;P+=a){D++;var M=P>e.pitchRange.y?e.pitchRange.y:P,I=Zg(e.inRadius,n,M),O=Zg(e.inRadius,r,M),m=Zg(e.outRadius,n,M),b=Zg(e.outRadius,r,M),E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-r));I=Cesium.Matrix3.multiplyByVector(E,I,new Cesium.Cartesian3),O=Cesium.Matrix3.multiplyByVector(E,O,new Cesium.Cartesian3),m=Cesium.Matrix3.multiplyByVector(E,m,new Cesium.Cartesian3),b=Cesium.Matrix3.multiplyByVector(E,b,new Cesium.Cartesian3),c[d++]=I.x,c[d++]=I.y,c[d++]=I.z,c[d++]=O.x,c[d++]=O.y,c[d++]=O.z,c[d++]=m.x,c[d++]=m.y,c[d++]=m.z,c[d++]=b.x,c[d++]=b.y,c[d++]=b.z,f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha),f[p++]=Cesium.Color.floatToByte(h.red),f[p++]=Cesium.Color.floatToByte(h.green),f[p++]=Cesium.Color.floatToByte(h.blue),f[p++]=Cesium.Color.floatToByte(h.alpha)}for(var v=0;v<D-1;++v)l[g++]=A+v*4+0,l[g++]=A+(v+1)*4+0,l[g++]=A+v*4+2,l[g++]=A+v*4+2,l[g++]=A+(v+1)*4+0,l[g++]=A+(v+1)*4+2,l[g++]=A+v*4+1,l[g++]=A+v*4+3,l[g++]=A+(v+1)*4+1,l[g++]=A+v*4+3,l[g++]=A+(v+1)*4+3,l[g++]=A+(v+1)*4+1}return{position:c,color:f,indices:l}}}function dfe(e){var t=A6(e);if(!(t.length<=1)){var n=0,r=0,o=e.yawRange.y-e.yawRange.x,a=e.pitchRange.y-e.pitchRange.x,s=360/e.circleDensity,u=(o/s+1)*t.length,l=(o/s+1)*(t.length-1)*4;o<360&&(u+=a/s*4,l+=(a/s-1)*4);for(var c=Cesium.IndexDatatype.createTypedArray(u,l),f=new Float64Array(u*3),h=new Uint8Array(u*4),d=e.lineColor,p=0,g=0,y=0,v=r;v<o+s;v+=s){n++;for(var w=v>o?o:v,C=0;C<t.length;C++){var E=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(-w)),S=Cesium.Matrix3.multiplyByVector(E,t[C],new Cesium.Cartesian3);f[p++]=S.x,f[p++]=S.y,f[p++]=S.z,h[g++]=Cesium.Color.floatToByte(d.red),h[g++]=Cesium.Color.floatToByte(d.green),h[g++]=Cesium.Color.floatToByte(d.blue),h[g++]=Cesium.Color.floatToByte(d.alpha)}}for(var v=0;v<n;++v)for(var C=0;C<t.length-1;++C)(v!=n-1||o-r!=360)&&(c[y++]=v*t.length+C,c[y++]=v*t.length+C+1),v<n-1&&(c[y++]=v*t.length+C,c[y++]=(v+1)*t.length+C);if(o<360){for(var A=p/3,D=0,P=e.pitchRange.x;P<e.pitchRange.y+s;P+=s){D++;var M=P>e.pitchRange.y?e.pitchRange.y:P,I=Zg(e.inRadius,0,M),O=Zg(e.inRadius,o,M),m=Zg(e.outRadius,0,M),b=Zg(e.outRadius,o,M);I=Cesium.Matrix3.multiplyByVector(E,I,new Cesium.Cartesian3),O=Cesium.Matrix3.multiplyByVector(E,O,new Cesium.Cartesian3),m=Cesium.Matrix3.multiplyByVector(E,m,new Cesium.Cartesian3),b=Cesium.Matrix3.multiplyByVector(E,b,new Cesium.Cartesian3),f[p++]=I.x,f[p++]=I.y,f[p++]=I.z,f[p++]=O.x,f[p++]=O.y,f[p++]=O.z,f[p++]=m.x,f[p++]=m.y,f[p++]=m.z,f[p++]=b.x,f[p++]=b.y,f[p++]=b.z,h[g++]=Cesium.Color.floatToByte(d.red),h[g++]=Cesium.Color.floatToByte(d.green),h[g++]=Cesium.Color.floatToByte(d.blue),h[g++]=Cesium.Color.floatToByte(d.alpha),h[g++]=Cesium.Color.floatToByte(d.red),h[g++]=Cesium.Color.floatToByte(d.green),h[g++]=Cesium.Color.floatToByte(d.blue),h[g++]=Cesium.Color.floatToByte(d.alpha),h[g++]=Cesium.Color.floatToByte(d.red),h[g++]=Cesium.Color.floatToByte(d.green),h[g++]=Cesium.Color.floatToByte(d.blue),h[g++]=Cesium.Color.floatToByte(d.alpha),h[g++]=Cesium.Color.floatToByte(d.red),h[g++]=Cesium.Color.floatToByte(d.green),h[g++]=Cesium.Color.floatToByte(d.blue),h[g++]=Cesium.Color.floatToByte(d.alpha)}for(var v=0;v<D-1;++v)c[y++]=A+v*4+0,c[y++]=A+v*4+2,c[y++]=A+v*4+1,c[y++]=A+v*4+3}return{position:f,color:h,indices:c}}}function A6(e){for(var t=[],n=[],r=360/e.circleDensity,o=e.pitchRange.x;o<e.pitchRange.y+r;o+=r){var a=o>e.pitchRange.y?e.pitchRange.y:o,s=e.inRadius*Math.cos(Cesium.Math.toRadians(a))*Math.sin(Cesium.Math.toRadians(0)),u=e.inRadius*Math.sin(Cesium.Math.toRadians(a)),l=e.inRadius*Math.cos(Cesium.Math.toRadians(a))*Math.cos(Cesium.Math.toRadians(0)),c=e.outRadius*Math.cos(Cesium.Math.toRadians(a))*Math.sin(Cesium.Math.toRadians(0)),f=e.outRadius*Math.sin(Cesium.Math.toRadians(a)),h=e.outRadius*Math.cos(Cesium.Math.toRadians(a))*Math.cos(Cesium.Math.toRadians(0));t.push(new Cesium.Cartesian3(s,u,l)),n.push(new Cesium.Cartesian3(c,f,h))}for(var o=n.length-1;o>=0;--o)t.push(n[o]);return t.length>0&&t.push(t[0]),t}function Zg(e,t,n){var r=e*Math.cos(Cesium.Math.toRadians(n))*Math.sin(Cesium.Math.toRadians(t)),o=e*Math.sin(Cesium.Math.toRadians(n)),a=e*Math.cos(Cesium.Math.toRadians(n))*Math.cos(Cesium.Math.toRadians(t));return new Cesium.Cartesian3(r,o,a)}function w6(e,t,n){var r=pfe(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function pfe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r));var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function E6(e,t,n,r,o){o.vertexArray=t,o.modelMatrix=n,o._boundingVolume=r,e._colorCommands.push(o)}function T6(){var e=`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function S6(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var fC=hI;function dN(e,t){this.viewer=e,this.GeometryArr=[],this.callback=t}dN.prototype={constructor:dN,drawClampToGroundLine:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,polyline:{positions:e.positions,width:e.lineWidth,material:e.material,clampToGround:!0}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawPolygon:function(e){var t=this,n=t.viewer.entities.add({id:e.id,polygon:{hierarchy:e.hierarchy,material:Cesium.Color.RED,outline:e.outline,outlineColor:e.outlineColor,arcType:Cesium.ArcType.RHUMB,height:e.height}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawEllipse:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,ellipse:{semiMinorAxis:e.semiMinorAxis,semiMajorAxis:e.semiMajorAxis,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,material:e.material,isCompareAxis:e.isCompareAxis,height:e.height}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawPoint:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,point:{pixelSize:e.point.pixelSize,Color:e.color,outlineColor:e.outlineColor,disableDepthTestDistance:Number.POSITIVE_INFINITY}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCurve:function(e){var t=this,n=new rI({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,radius:e.radius});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCuboid:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,rectangle:{coordinates:e.coordinates,extrudedHeight:e.extrudedHeight,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,stRotation:e.stRotation,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCylinder:function(e){var t=this,n=this.viewer.entities.add({id:e.id,orientation:e.orientation,position:e.position,startPosition:e.startPosition,endPosition:e.endPosition,cylinder:{length:e.length,topRadius:e.topRadius,bottomRadius:e.bottomRadius,material:Cesium.Color.RED.withAlpha(.4),outline:e.outline,outlineColor:e.outlineColor,color:e.color,slices:e.slices,showBottom:e.showBottom,showTop:e.showTop}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawEllipsoid:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,ellipsoid:{radii:e.radii,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,slicePartitions:e.slicePartitions,stackPartitions:e.stackPartitions,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCommonBox:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,box:{dimensions:e.dimensions,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,height:1,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawVehicleRadar:function(e){var t=this,n=new jg({viewer:t.viewer,id:e.id,position:e.position,radius:e.radius,color:e.color,showScanPlane:e.showScanPlane,scanPlaneColor:e.scanPlaneColor,scanPlaneRate:e.scanPlaneRate});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawFlightBillboard:function(e){var t=new Date,n=new Date(t.getTime()+1e5),r=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(t),currentTime:Cesium.JulianDate.fromDate(t),stopTime:Cesium.JulianDate.fromDate(n),clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,clockRange:Cesium.ClockRange.CLAMPED}),o=new CesiumEMExtensions.EV_DatagramManager({viewer}),a=new CesiumEMExtensions.EV_MovingTargetManager({viewer,ev_dataMgr:o,trainingClock:r});setTimeout(function(){r.shouldAnimate=!0,console.log(r.currentTime),r.tick(),o.receiveData.raiseEvent(o.receiveMTFlightDatas,CesiumEMExtensions.EV_DataOperated.ADD)},1e3)},drawFlightRibbon:function(e){},drawParseArrayRadar:function(e){var t=this,n=new sC({viewer:t.viewer,id:e.id,position:e.position,radius:e.radius});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawMechanicalRadar:function(e){var t=this,n=new Kg({viewer,id:e.id,position:e.position,showScan:e.showScan});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCustomizedPARadar:function(e){var t=this,n=new fC({viewer,position:e.position,pitchRange:new Cesium.Cartesian2(0,40),lineColor:e.lineColor,color:e.color,id:e.id});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawFanRing:function(e){var t=this,n=new uC({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,longRadius:e.longRadius,minorRadius:e.minorRadius,fillColor:e.fillColor,lineColor:e.lineColor,renderStyle:e.renderStyle});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawAnnulus:function(e){var t=this,n=new pb({viewer:t.viewer,id:e.id,lon:e.lon,lat:e.lat,height:e.height,outerRadius:e.outerRadius,innerRadius:e.innerRadius,fillColor:e.fillColor,lineColor:e.lineColor,renderStyle:e.renderStyle});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawTargetRing:function(e){var t=this,n=new uI({viewer:t.viewer,id:e.id,position:e.position});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCommunicationLink:function(e){var t=this,n=this.viewer.entities.add({id:e.id,orientation:e.orientation,position:e.position,cylinder:{length:e.length,topRadius:e.topRadius,bottomRadius:e.bottomRadius,slices:e.slices,showBottom:e.showBottom,showTop:e.showTop,changeStCoordinate:e.changeStCoordinate,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},computeCircle:function(e){for(var t=[],n=0;n<360;n++){var r=Cesium.Math.toRadians(n);t.push(new Cesium.Cartesian2(e*Math.cos(r),e*Math.sin(r)))}return t},drawPolylineVolume:function(e){var t=this,n=t.viewer.entities.add({id:e.id,position:e.position,polylineVolume:{positions:e.positions,shape:e.shape,material:e.material,outline:e.outline,outlineColor:e.outlineColor}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawBoxVolume:function(e){var t=this,n=t.viewer.entities.add({id:e.id,polylineVolume:{positions:e.positions,shape:e.shape,cornerType:e.cornerType,outline:e.outline,outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawCorridor:function(e){var t=this,n=t.viewer.entities.add({id:e.id,corridor:{positions:e.positions,width:e.width,height:e.height,extrudedHeight:e.extrudedHeight,cornerType:e.cornerType,material:e.material}});e.id&&(t.GeometryArr.push(n),t.callback&&t.callback(e.id))},drawLine:function(e){var t=this,n=t.viewer.entities.add({id:e.in_id,polyline:{positions:e.in_positions,width:e.in_width,material:e.in_color}});t.windageLine.push(n)},getOneEntity:function(e){var t=this;return t.viewer.entities.getById(e)},removeOneEntity:function(e){var t=this,n=t.GeometryArr.find(function(o){return o.id==e});if(e.indexOf("\u98D8\u5E26")>-1){this.removeRibbon();return}n instanceof Cesium.Entity?t.viewer.entities.remove(n):n.remove();var r=t.GeometryArr.indexOf(e);r>-1&&(t.GeometryArr.splice(r,1),console.log("json",t.GeometryArr))},removeAllEntity:function(){for(var e=this,t=0;t<e.GeometryArr.length;t++)e.GeometryArr[t]instanceof Cesium.Entity?e.viewer.entities.remove(e.GeometryArr[t]):e.GeometryArr[t]instanceof cC?e.viewer.scene.primitives.remove(e.GeometryArr[t]):e.GeometryArr[t].remove();e.GeometryArr=[]}};var dI=dN;function ti(e){this._viewer=e.viewer,this.callback=e.callback,this._draw=new dI(this._viewer,this.callback),this.index=0,this._points=this._viewer.scene.primitives.add(new Cesium.PointPrimitiveCollection),this._handler=new Cesium.ScreenSpaceEventHandler(this._viewer.canvas),this._stop=!1}ti.prototype.exportLayerData=function(e){var t=[];if(e.length>0)for(var n=0;n<e.length;n++){var r=this._draw.GeometryArr.find(function(s){return s.id==e[n].label});r&&t.push(r)}var o={SITSYMBOLFILE:{LayerGroup:[]}},a=this};ti.prototype.drawLine=function(e){var t=this,n=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),r=Cesium.defaultValue(e.lineWidth,3),o=e.positions;window.positionsL=o;var a=o[0],s=e.id,u=this._viewer.entities.getById(s);if(!u){t._draw.drawClampToGroundLine({id:s,position:a,positions:new Cesium.CallbackProperty(function(){return o},!1),lineWidth:r,material:n,clampToGround:!0});var u=this._viewer.entities.getById(s)}return u.geometryType="LineString",u};ti.prototype.getLineAttr=function(e){pI="line";var t=!0,n=!1,r=!1,o=this,a=[];Oo=function(u){if(o._stop&&(jr(u),Ra=!1),t&&(a.push(u),a.length==1))return a.push(new Cesium.Cartesian3(u.x+1,u.y+1,u.z)),n=!0,a},ns=function(u){if(o._stop&&(jr(u),Ra=!1),n)return a[a.length-1]=u,a},jr=function(u){if(!r){t=!1,n=!1,r=!0;var l=mI(a);return a=[],l}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u6298\u7EBF_"+o.index;u==="rightClick"&&o.index++,e(u,l,c)}};ti.prototype.drawPolygon=function(e){var t=this,n=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),o=Cesium.defaultValue(e.outline,!1),a=Cesium.defaultValue(e.height,void 0),s=e.positions,u=s[0],l=e.id,c=this._viewer.entities.getById(l);if(!c){t._draw.drawPolygon({id:l,position:u,hierarchy:new Cesium.CallbackProperty(function(){return{positions:s}},!1),material:n,outline:o,outlineColor:r,height:e.height});var c=this._viewer.entities.getById(l)}return c.geometryType="Polygon",c};ti.prototype.getPolygonAttr=function(e){pI="polygon";var t=this,n=!0,r=!1,o=!1,a=[];Oo=function(u){if(t._stop&&(jr(u),Ra=!1),n)return a.push(u),r=!0,a},ns=function(u){if(t._stop&&(jr(u),Ra=!1),r)return a.length==1?a.push(u):a[a.length-1]=u,a},jr=function(u){if(!o)return n=!1,r=!1,o=!0,a=[],a},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u591A\u8FB9\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ti.prototype.drawRectangle=function(e){var t=this,n=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),o=Cesium.defaultValue(e.outline,2),a=e.positions,s=e.height,u=e.id,l=this._viewer.entities.getById(u);if(!l){t._draw.drawPolygon({id:u,hierarchy:new Cesium.CallbackProperty(function(){var f=[a[0],Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[0]).longitude),Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[1]).latitude)),a[1],Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[1]).longitude),Cesium.Math.toDegrees(Cesium.Cartographic.fromCartesian(a[0]).latitude))];return{positions:f}},!1),material:n,outline:o,outlineColor:r,height:s});var l=this._viewer.entities.getById(u)}return l.geometryType="Rectangle",l};ti.prototype.getRectangleAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];Oo=function(u){if(t._stop&&(jr(u),Ra=!1),n){if(n=!1,r=!0,a.length===0){var l=new Cesium.Cartesian3(u.x+100,u.y+100,u.z);a[0]=u,a[1]=l}else if(a.length===2)return}},ns=function(u){if(t._stop&&(jr(u),Ra=!1),r)return a[1]=u,a},jr=function(u){if(!o){var l=mI(a);return a=[],n=!1,r=!1,o=!0,l}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u77E9\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ti.prototype.drawCircle=function(e){var t=this,n=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),o=e.positions,a=Cesium.defaultValue(e.outline,!1),s=e.height,u=o[0],l=e.id,c=this._viewer.entities.getById(l);if(!c){t._draw.drawEllipse({id:l,position:new Cesium.CallbackProperty(function(){return o[0]},!1),semiMinorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),semiMajorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),material:n,isCompareAxis:!1,outline:a,outlineColor:r,outlineWidth:1,height:s});var c=this._viewer.entities.getById(l)}return c.geometryType="Circle",c};ti.prototype.getCircleAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=this._points,s=1,u=[];Oo=function(c){if(t._stop&&(jr(c),Ra=!1),n){if(u.push(c),u.length==1){var f={x:u[0].x+10,y:u[0].y+10,z:u[0].z};u.push(f),f=void 0}var h=Cesium.Cartographic.fromCartesian(u[0]);h.height=0;var d=Cesium.Cartographic.fromCartesian(u[1]);return h.height=0,u[2]=Cesium.Cartesian3.distance(u[0],u[1]),n=!1,r=!0,u}},ns=function(c){if(t._stop&&(jr(c),Ra=!1),r){u[1]=c;var f=Cesium.Cartographic.fromCartesian(u[0]);f.height=0;var h=Cesium.Cartographic.fromCartesian(u[1]);return f.height=0,console.log(vfe(f,h)),u[2]=Cesium.Cartesian3.distance(u[0],u[1]),console.log(u[2]),u}},jr=function(c){if(!o){s=Cesium.Cartesian3.distance(u[0],c),n=!1,r=!1,o=!0;var f=mI(u);return u=[],f}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,l);function l(c,f){var h="\u5706\u5F62_"+t.index;c==="rightClick"&&t.index++,e(c,f,h)}};ti.prototype.drawEllipse=function(e){var t=this,n=e.positions,r=n[0],o=e.id,a=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),s=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),u=this._viewer.entities.getById(o);if(!u){t._draw.drawEllipse({id:o,position:new Cesium.CallbackProperty(function(){return n[0]},!1),semiMinorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(n[0],n[1])},!1),semiMajorAxis:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(n[0],n[2])},!1),isCompareAxis:!1,material:a,outline:!0,outlineColor:s,outlineWidth:1});var u=this._viewer.entities.getById(o)}return u.geometryType="Ellipse",u};ti.prototype.getEllipseAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];a[3]=100,a[4]=100,Oo=function(u){if(t._stop&&(jr(u),Ra=!1),n)return o=!1,a[0]?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1]),r=!1,n=!1):(a[0]=u,a[1]=new Cesium.Cartesian3(u.x,u.y+1e3,u.z),a[2]=new Cesium.Cartesian3(u.x+1e3,u.y,u.z),r=!0),a},ns=function(u){return t._stop&&(jr(u),Ra=!1),r?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1])):o||(a[2]=u,a[4]=Cesium.Cartesian3.distance(a[0],a[2])),a},jr=function(u){if(!o)return r?(a[1]=u,a[3]=Cesium.Cartesian3.distance(a[0],a[1]),a[4]=Cesium.Cartesian3.distance(a[0],a[1])):(a[2]=u,a[4]=Cesium.Cartesian3.distance(a[0],a[2])),a=[],n=!1,r=!1,o=!0,a},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u692D\u5706_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ti.prototype.drawCurve=function(e){var t=this,n=!0,r=!1,o=[],a=10;Oo=function(s){if(n){o.push(s);var u=gN(s),l=t._draw.drawCurve({id:"\u5F27_"+t.index++,lon:u.lon,lat:u.lat,height:u.height,radius:new Cesium.CallbackProperty(function(){return a},!1)});n=!1,r=!0}},ns=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s))},jr=function(s){a=Cesium.Cartesian3.distance(o[0],s),r=!1},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawSectorPlane=function(e){var t=this,n=Cesium.defaultValue(e.yawAngle,30),r=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),o=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),a=Cesium.defaultValue(e.outline,!1),s=e.positions,u=e.id,l=this._viewer.entities.getById(u);return l||(t._draw.drawPolygon({id:u,hierarchy:new Cesium.CallbackProperty(function(){n=s[3];var c=pN(s[0],s[1]),f=Cesium.Cartesian3.distance(s[0],s[1]),h=mfe(s[0],c,f,s[3]);return{positions:h}},!1),outline:a,outlineColor:o,material:r}),l=this._viewer.entities.getById(u)),l.geometryType="SectorPlane",l};ti.prototype.getSectorPlaneAttr=function(e){pI="SectorPlane";var t=this,n=!0,r=!1,o=!1,a=[];Oo=function(u){if(t._stop&&(jr(u),Ra=!1),n)return a.push(u),r=!0,a[1]=new Cesium.Cartesian3(u.x+10,u.y+10,u.z),a[2]=Cesium.Cartesian3.distance(a[0],a[1]),a[3]=30,a},ns=function(u){if(t._stop&&(jr(u),Ra=!1),r)return a.length==1?a.push(u):(a[1]=u,a[2]=Cesium.Cartesian3.distance(a[0],a[1])),a},jr=function(u){if(!o)return n=!1,r=!1,o=!0,a=[],a},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u6247\u5F62_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ti.prototype.drawSectorPlaneByThreePoint=function(e){var t=this,n=e.positions,r=e.id,o=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),a=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,1,1)),s=Cesium.defaultValue(e.outline,!1),u=this._viewer.entities.getById(r);return u||(t._draw.drawPolygon({id:r,hierarchy:new Cesium.CallbackProperty(function(){var l=pN(n[0],n[1]);if(u)var c=Cesium.defaultValue(u.index,1);var f=Cesium.Cartesian3.distance(n[0],n[c]),h=pN(n[0],n[2]),d=gfe(n[0],l,h,f);return{positions:d}},!1),outline:s,color:o,outlineColor:a}),u=this._viewer.entities.getById(r)),u.geometryType="SectorPlaneByThreePoint",u};ti.prototype.getSectorPlaneByThreePointAttr=function(e){pI="SectorPlaneByThreePoint";var t=this,n=!0,r=0,o=!1,a=!1,s=[];Oo=function(l){if(t._stop&&(jr(l),Ra=!1),n)return o=!0,r==0?(s.push(l),s[1]=new Cesium.Cartesian3(l.x+10,l.y+10,l.y),s[2]=new Cesium.Cartesian3(s[1].x+10,s[1].y+10,l.y),s[3]=Cesium.Cartesian3.distance(s[0],s[1])):r==1&&(s[1]=l),r++,s},ns=function(l){if(t._stop&&(jr(l),Ra=!1),o)return r==1?(s[1]=l,s[3]=Cesium.Cartesian3.distance(s[0],s[1])):r==2&&(s[2]=l),s},jr=function(l){if(r==2)return a?void 0:(n=!1,o=!1,a=!0,s=[],s)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,u);function u(l,c){var f="\u6247\u5F622_"+t.index;l==="rightClick"&&t.index++,e(l,c,f)}};function pN(e,t){var n=new Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),o=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Matrix4),a=Cesium.Cartesian3.normalize(o,new Cesium.Cartesian3),s=Math.atan2(a.y,a.x)-Cesium.Math.PI_OVER_TWO;return s=Cesium.Math.toDegrees(Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(s)),s}function mfe(e,t,n,r){for(var o=[e],a=r/10,s=-r;s<r;s+=a)o.push(I6(e,-(t+s),n));return o}function gfe(e,t,n,r){for(var o=[e],a=t;a<n;a+=1)o.push(I6(e,-(t+a),r));return o}function I6(e,t,n){var r=new Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t||0)),a=Cesium.Matrix4.fromRotationTranslation(o);Cesium.Matrix4.multiply(r,a,r);var s=new Cesium.Matrix4.multiplyByPoint(r,new Cesium.Cartesian3(0,n,0),new Cesium.Cartesian3);return s}ti.prototype.drawPoint=function(e){var t=this,n=e.positions,r=n[0],o=Cesium.defaultValue(e.color,new Cesium.Color(1,0,0,1)),a=Cesium.defaultValue(e.outlineColor,new Cesium.Color(1,1,0,1)),s=Cesium.defaultValue(e.pixelSize,10),u=e.id,l=this._viewer.entities.getById(u);return l||(t._draw.drawPoint({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),point:{pixelSize:new Cesium.CallbackProperty(function(){return n[1]},!1),color:o,outlineColor:a}}),l=this._viewer.entities.getById(u)),l.geometryType="Point",l};ti.prototype.getPointAttr=function(e){var t=this,n=!0,r=!1,o=!1,a=[];Oo=function(u){if(t._stop&&(jr(u),Ra=!1),n)return a[0]=u,a[1]=10,o=!1,r=!0,a},ns=function(u){if(t._stop&&(jr(u),Ra=!1),r)return a[0]=u,a},jr=function(u){if(!o)return a[0]=u,a=[],n=!1,r=!1,o=!0,a},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK,s);function s(u,l){var c="\u70B9_"+t.index;u==="rightClick"&&t.index++,e(u,l,c)}};ti.prototype.drawCylinder=function(e){var t=this,n=!0,r=!1,o=[],a=1e4,s=Cesium.defaultValue(e.topRadius,5e3),u=Cesium.defaultValue(e.bottomRadius,5e3),l=Cesium.defaultValue(e.outline,!0),c=Cesium.defaultValue(e.showBottom,!1),f=Cesium.defaultValue(e.showTop,!1),h=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),d=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:1})),p=Cesium.defaultValue(e.slice,void 0),g=Cesium.defaultValue(e.id,"\u5706\u9525_");Oo=function(y){if(n){o.push(y),o.push(new Cesium.Cartesian3(y.x+100,y.y+100,y.z));var v=t._draw.drawCylinder({id:g+t.index++,orientation:new Cesium.CallbackProperty(function(){var w=D6(o[0],o[1]);return w.pitch+=Cesium.Math.PI_OVER_TWO,w.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(o[1],w)},!1),startPosition:o[0],endPosition:new Cesium.CallbackProperty(function(){return o[1]},!1),position:new Cesium.CallbackProperty(function(){var w=Cesium.Cartesian3.subtract(o[0],o[1],new Cesium.Cartesian3),C=Cesium.Cartesian3.divideByScalar(w,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(C,o[1],new Cesium.Cartesian3)},!1),length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),topRadius:s,bottomRadius:u,outline:l,outlineColor:h,slices:p,color:d,showBottom:c,showTop:f});n=!1,r=!0}},ns=function(y){r&&(o[1]=y)},jr=function(y){if(r){var v=Cesium.Cartographic.fromCartesian(y,Cesium.Ellipsoid.WGS84);v.height+=u,y=Cesium.Cartesian3.fromRadians(v.longitude,v.latitude,v.height,Cesium.Ellipsoid.WGS84),o[1]=y,r=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};function D6(e,t){var n=Cesium.Transforms.eastNorthUpToFixedFrame(e),r=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),l=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(n,new Cesium.Matrix4),r,new Cesium.Cartesian3),o=Cesium.Cartesian3.normalize(l,new Cesium.Cartesian3),a=Math.atan2(o.y,o.x)-Cesium.Math.PI_OVER_TWO,s=Cesium.Math.TWO_PI-Cesium.Math.zeroToTwoPi(a),u=Cesium.Transforms.eastNorthUpToFixedFrame(e),l=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),c=Cesium.Matrix4.multiplyByPointAsVector(Cesium.Matrix4.inverse(u,u),l,l);Cesium.Cartesian3.normalize(c,c);var f=Cesium.Math.PI_OVER_TWO-Cesium.Math.acosClamped(c.z),h=new Cesium.HeadingPitchRoll(s,f,0);return h}ti.prototype.drawHalfsphere=function(e){this.drawVehicleRadar({showScanPlane:!1,id:"\u7403\u9762_"})};ti.prototype.drawEllipsoid=function(e){var t=this,n=!0,r=!1,o=[],a=10,s,u=Cesium.defaultValue(e.isBall,!0),l=Cesium.defaultValue(e.outline,!0),c=Cesium.defaultValue(e.outlineWidth,5),f=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:.5})),h=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),d=Cesium.defaultValue(e.radii,new Cesium.Cartesian3(4500,4500,4500)),p=Cesium.defaultValue(e.slicePartitions,24),g=Cesium.defaultValue(e.stackPartitions,24),y=u?"\u7403\u4F53_":"\u692D\u7403\u4F53_";Oo=function(v){if(console.log(v),n){var w=Cesium.Cartographic.fromCartesian(v,Cesium.Ellipsoid.WGS84);w.height+=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84),o.push(v);var C=t._draw.drawEllipsoid({id:y+t.index++,position:new Cesium.CallbackProperty(function(){return s},!1),radii:new Cesium.CallbackProperty(function(){return d},!1),outline:l,outlineColor:h,outlineWidth:c,slicePartitions:p,stackPartitions:g,material:f});n=!1,r=!0}},ns=function(v){if(r){a=Cesium.Cartesian3.distance(o[0],v),d.x=a,d.y=a,u?d.z=a:d.z=a/1.25;var w=Cesium.Cartographic.fromCartesian(o[0],Cesium.Ellipsoid.WGS84);w.height=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84)}},jr=function(v){if(r){a=Cesium.Cartesian3.distance(o[0],v),d.x=a,d.y=a,u?d.z=a:d.z=a/1.25;var w=Cesium.Cartographic.fromCartesian(o[0],Cesium.Ellipsoid.WGS84);w.height=d.z,s=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,w.height,Cesium.Ellipsoid.WGS84),r=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawCuboid=function(e){var t=this,n=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,1)),r=Cesium.defaultValue(e.outlineColor,new Cesium.Color(0,1,0,1)),o=Cesium.defaultValue(e.outline,!0),a=Cesium.defaultValue(e.outlineWidth,2),s=!0,u=!1,l=100,c=[];Oo=function(f){if(s){c.push(f);var h=t._draw.drawCommonBox({id:"\u957F\u65B9\u4F53_"+t.index++,position:f,dimensions:new Cesium.CallbackProperty(function(){return new Cesium.Cartesian3(l,l/2,l/2)},!1),outline:o,outlineColor:r,outlineWidth:a,material:n});s=!1,u=!0}},ns=function(f){l=Cesium.Cartesian3.distance(c[0],f)},jr=function(f){u&&(c[1]=f,l=Cesium.Cartesian3.distance(c[0],f),u=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawVehicleRadar=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.color,new Cesium.Color(0,1,0,.8)),s=Cesium.defaultValue(e.scanColor,new Cesium.Color(1,1,1,.5)),u=Cesium.defaultValue(e.scanRate,100),l=Cesium.defaultValue(e.showScanPlane,!0),c=Cesium.defaultValue(e.id,"\u8F66\u8F7D\u96F7\u8FBE_"),f=1e3;Oo=function(h){if(n){o.push(h);var d=t._draw.drawVehicleRadar({id:c+t.index++,position:h,radius:new Cesium.CallbackProperty(function(){return f},!1),color:a,showScanPlane:l,scanPlaneColor:s,scanPlaneRate:u});n=!1,r=!0}},ns=function(h){r&&(f=Cesium.Cartesian3.distance(o[0],h))},jr=function(h){r&&(f=Cesium.Cartesian3.distance(o[0],h),r=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawParseArrayRadar=function(e){var t=this,n=!0,r=!1,o=[],a=30;Oo=function(s){if(n){o.push(s);var u=t._draw.drawParseArrayRadar({id:"\u76F8\u63A7\u72B6\u96F7\u8FBE_"+t.index++,position:s,radius:new Cesium.CallbackProperty(function(){return a},!1)});n=!1,r=!0}},ns=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s))},jr=function(s){r&&(a=Cesium.Cartesian3.distance(o[0],s),r=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawCustomizedPARadar=function(e){var t=this,n=!0,r=[];Oo=function(o){if(n){r.push(o);var a=t._draw.drawCustomizedPARadar({id:"\u5B9A\u5236\u76F8\u63A7\u72B6\u96F7\u8FBE_"+t.index++,position:o,lineColor:new Cesium.Color(.5,1,1,.6),color:new Cesium.Color(.5,1,1,.1)});n=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ti.prototype.drawMechanicalRadar=function(e){var t=this,n=!0,r=[];Oo=function(o){if(n){r.push(o);var a=t._draw.drawMechanicalRadar({id:"\u673A\u68B0\u96F7\u8FBE_"+t.index++,position:o,showScan:!0});n=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ti.prototype.drawFlightBillboard=function(e){var t=this,n=!0,r=[];Oo=function(o){if(n){r.push(o);var a=t._draw.drawFlightBillboard({id:"\u98DE\u673A\u6807\u724C_"+t.index++,position:o});n=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ti.prototype.drawFlightRibbon=function(e){var t=this,n=!0,r=[];Oo=function(o){if(n){r.push(o);var a=t._draw.drawFlightRibbon({id:"\u98DE\u673A\u98D8\u5E26_"+t.index++,position:o});n=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ti.prototype.drawFanRing=function(e){var t=this,n=!0,r=!1,o=!0,a=[],s=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,0,.5)),u=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,1,.5)),l=Cesium.defaultValue(e.renderStyle,0),c=1e3;Oo=function(f){if(n){a.push(f);var h=gN(f);console.log(h);var d=t._draw.drawFanRing({id:"\u6247\u73AF\u5F62_"+t.index++,lon:h.lon,lat:h.lat,height:h.height,longRadius:new Cesium.CallbackProperty(function(){return c},!1),minorRadius:new Cesium.CallbackProperty(function(){return c*2/3},!1),fillColor:s,lineColor:u,renderStyle:l});n=!1,r=!0}},ns=function(f){r&&(c=Cesium.Cartesian3.distance(a[0],f))},jr=function(f){!o||(c=Cesium.Cartesian3.distance(a[0],f),n=!1,r=!1,o=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawAnnulus=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.fillColor,new Cesium.Color(0,1,1,.5)),s=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,1,1,.5)),u=Cesium.defaultValue(e.renderStyle,0),l=1e3;Oo=function(c){if(n){o.push(c);var f=gN(c),h=t._draw.drawAnnulus({id:"\u73AF\u9762\u4F53_"+t.index++,lon:f.lon,lat:f.lat,height:f.height,outerRadius:new Cesium.CallbackProperty(function(){return l},!1),innerRadius:new Cesium.CallbackProperty(function(){return l*3/5},!1),fillColor:a,lineColor:s,renderStyle:u});n=!1,r=!0}},ns=function(c){r&&(l=Cesium.Cartesian3.distance(o[0],c))},jr=function(c){r&&(l=Cesium.Cartesian3.distance(o[0],c),r=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawTargetRing=function(e){var t=this,n=!0,r=[];Oo=function(o){if(n){r.push(o);var a=t._draw.drawTargetRing({id:"\u9776\u5FC3_"+t.index++,position:o});n=!1}},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK)};ti.prototype.drawCommunicationLink=function(e){var t=this,n=!0,r=!1,o=[];Oo=function(a){if(n){o.push(a),o.push(new Cesium.Cartesian3(a.x+1e3,a.y+1e3,a.z));var s=t._draw.drawCommunicationLink({id:"\u901A\u4FE1\u94FE\u8DEF_"+t.index++,orientation:new Cesium.CallbackProperty(function(){var u=D6(o[0],o[1]);return u.pitch+=Cesium.Math.PI_OVER_TWO,u.heading-=Cesium.Math.PI_OVER_TWO,Cesium.Transforms.headingPitchRollQuaternion(o[1],u)},!1),position:new Cesium.CallbackProperty(function(){var u=Cesium.Cartesian3.subtract(o[0],o[1],new Cesium.Cartesian3),l=Cesium.Cartesian3.divideByScalar(u,2,new Cesium.Cartesian3);return Cesium.Cartesian3.add(l,o[1],new Cesium.Cartesian3)},!1),length:new Cesium.CallbackProperty(function(){return Cesium.Cartesian3.distance(o[0],o[1])},!1),topRadius:0,bottomRadius:3e3,showBottom:!1,changeStCoordinate:!0,material:new Cesium.PolylineTrailLinkMaterialProperty({color:Cesium.Color.WHITE,duration:1e4,trailImage:Cesium.buildModuleUrl("Assets/EMExtensions/downwavetexture.png")})});n=!1,r=!0}},ns=function(a){r&&(o[1]=a)},jr=function(a){r&&(o[1]=a,r=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.drawPolylineVolume=function(e){var t=this,n=!0,r=!1,o=[],a=Cesium.defaultValue(e.outline,!0),s=Cesium.defaultValue(e.radius,300),u=Cesium.defaultValue(e.outlineColor,Cesium.Color.fromRandom({alpha:1})),l=Cesium.defaultValue(e.color,Cesium.Color.fromRandom({alpha:0}));Oo=function(c){if(n){o.push(c);var f=t._draw.drawPolylineVolume({id:"\u7BA1\u9053"+t.index++,position:c,positions:new Cesium.CallbackProperty(function(){return o},!1),shape:yfe(s),material:l,outline:a,outlineColor:u});n=!1,r=!0}},ns=function(c){r&&(o.length==1?o.push(c):o[o.length-1]=c)},jr=function(c){r&&(r=!1)},ga(this,this._handler,Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.ScreenSpaceEventType.RIGHT_CLICK)};ti.prototype.clear=function(){this._draw.removeAllEntity(),this._stop=!0};var P6,mN,Ra=!1,Oo,jr,ns,hC=[],pI=void 0;function ga(e,t,n,r,o){e.stopDraw=!1,Ra=!1,P6=n,mN=r,t.setInputAction(function(a){var s=b6(e,a,Cesium.ScreenSpaceEventType.LEFT_CLICK);s&&o&&o("leftClick",s)},Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction(function(a){var s=_fe(e,a);s&&o&&o("mouseMove",s)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(function(a){var s=b6(e,a,Cesium.ScreenSpaceEventType.RIGHT_CLICK);s&&o&&o("rightClick",s)},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}function b6(e,t,n){if(!e.stopDraw){if(n===mN&&Ra){var r=e._viewer.camera.getPickRay(t.position),o=e._viewer.scene.globe.pick(r,e._viewer.scene);if(Cesium.defined(o)&&Cesium.defined(jr))return hC=jr(o),Ra=!1,hC}else if(n===P6){var r=e._viewer.camera.getPickRay(t.position),o=e._viewer.scene.globe.pick(r,e._viewer.scene);if(Cesium.defined(o)&&(Ra=!0,Cesium.defined(mN)||(Ra=!1),Cesium.defined(Oo)))return hC=Oo(o),hC}}}function _fe(e,t){if(Ra){var n=Cesium.EV_ScreenMethod.globePick(e._viewer.scene,t.endPosition);if(Cesium.defined(n)&&Cesium.defined(ns))return hC=ns(n),hC}}function gN(e){var t=new Cesium.Cartographic.fromCartesian(e,Cesium.Ellipsoid.WGS84),n=Cesium.Math.toDegrees(t.longitude),r=Cesium.Math.toDegrees(t.latitude),o=t.height;return{lon:n,lat:r,height:o}}function yfe(e){for(var t=[],n=0;n<360;n+=10){var r=Cesium.Math.toRadians(n);t.push(new Cesium.Cartesian2(e*Math.cos(r),e*Math.sin(r)))}return t}function mI(e){var t=e.constructor===Array?[]:{};if(typeof e!="object")return e;for(var n in e)typeof e[n]=="object"?t[n]=mI(e[n]):t[n]=e[n];return t}function vfe(e,t){var n=new Cesium.EllipsoidGeodesic;n.setEndPoints(e,t);var r=n.surfaceDistance;return r}var dC=ti;function V_(){this._array=[],this._hash={}}Object.defineProperties(V_.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});V_.prototype.contains=function(e){return _(this._hash[e])};V_.prototype.set=function(e,t){let n=this._hash[e];t!==n&&(this.remove(e),this._hash[e]=t,this._array.push(t))};V_.prototype.get=function(e){return this._hash[e]};V_.prototype.remove=function(e){let t=this._hash[e],n=_(t);if(n){let r=this._array;r.splice(r.indexOf(t),1),delete this._hash[e]}return n};V_.prototype.removeAll=function(){let e=this._array;e.length>0&&(this._hash={},e.length=0)};var Va=V_;var _N;typeof performance<"u"&&typeof performance.now=="function"&&isFinite(performance.now())?_N=function(){return performance.now()}:_N=function(){return Date.now()};var pC=_N;var Cfe={SHIFT:0,CTRL:1,ALT:2},gI=Object.freeze(Cfe);var xfe={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19},pn=Object.freeze(xfe);function Qg(e,t,n){let r=e._element;if(r===document)return n.x=t.clientX,n.y=t.clientY,n;let o=r.getBoundingClientRect();return n.x=t.clientX-o.left,n.y=t.clientY-o.top,n}function EN(e,t){let n=e;return _(t)&&(n+=`+${t}`),n}function k_(e){if(e.shiftKey)return gI.SHIFT;if(e.ctrlKey)return gI.CTRL;if(e.altKey)return gI.ALT}var rs={LEFT:0,MIDDLE:1,RIGHT:2};function Uc(e,t,n,r){function o(a){r(e,a)}Qo.isInternetExplorer()?n.addEventListener(t,o,!1):n.addEventListener(t,o,{capture:!1,passive:!1}),e._removalFunctions.push(function(){n.removeEventListener(t,o,!1)})}function wfe(e){let t=e._element,n=_(t.disableRootEvents)?t:document;Qo.supportsPointerEvents()?(Uc(e,"pointerdown",t,Ife),Uc(e,"pointerup",t,k6),Uc(e,"pointermove",t,Dfe),Uc(e,"pointercancel",t,k6)):(Uc(e,"mousedown",t,G6),Uc(e,"mouseup",n,U6),Uc(e,"mousemove",n,H6),Uc(e,"touchstart",t,Afe),Uc(e,"touchend",n,N6),Uc(e,"touchmove",n,bfe),Uc(e,"touchcancel",n,N6)),Uc(e,"dblclick",t,Tfe);let r;"onwheel"in t?r="wheel":document.onmousewheel!==void 0?r="mousewheel":r="DOMMouseScroll",Uc(e,r,t,Sfe)}function Efe(e){let t=e._removalFunctions;for(let n=0;n<t.length;++n)t[n]()}var M6={position:new X};function TN(e){e._lastSeenTouchEvent=pC()}function SN(e){return pC()-e._lastSeenTouchEvent>Jh.mouseEmulationIgnoreMilliseconds}function wN(e,t,n){let r=e.x-t.x,o=e.y-t.y;return Math.sqrt(r*r+o*o)<n}function G6(e,t){if(!SN(e))return;let n=t.button;e._buttonDown[n]=!0;let r;if(n===rs.LEFT)r=pn.LEFT_DOWN;else if(n===rs.MIDDLE)r=pn.MIDDLE_DOWN;else if(n===rs.RIGHT)r=pn.RIGHT_DOWN;else return;let o=Qg(e,t,e._primaryPosition);X.clone(o,e._primaryStartPosition),X.clone(o,e._primaryPreviousPosition);let a=k_(t),s=e.getInputAction(r,a);_(s)&&(X.clone(o,M6.position),s(M6),t.preventDefault())}var L6={position:new X},R6={position:new X};function yN(e,t,n,r){let o=k_(r),a=e.getInputAction(t,o),s=e.getInputAction(n,o);if(_(a)||_(s)){let u=Qg(e,r,e._primaryPosition);if(_(a)&&(X.clone(u,L6.position),a(L6)),_(s)){let l=e._primaryStartPosition;wN(l,u,e._clickPixelTolerance)&&(X.clone(u,R6.position),s(R6))}}}function U6(e,t){if(!SN(e))return;let n=t.button;if(!(n!==rs.LEFT&&n!==rs.MIDDLE&&n!==rs.RIGHT)){if(e._buttonDown[rs.LEFT]&&(yN(e,pn.LEFT_UP,pn.LEFT_CLICK,t),e._buttonDown[rs.LEFT]=!1),e._buttonDown[rs.MIDDLE]){let r=document.getElementById("focalPointCanvas");r&&document.body.removeChild(r),yN(e,pn.MIDDLE_UP,pn.MIDDLE_CLICK,t),e._buttonDown[rs.MIDDLE]=!1}if(e._buttonDown[rs.RIGHT]){let r=document.getElementById("focalPointCanvas");r&&document.body.removeChild(r),yN(e,pn.RIGHT_UP,pn.RIGHT_CLICK,t),e._buttonDown[rs.RIGHT]=!1}}}var vN={startPosition:new X,endPosition:new X};function H6(e,t){if(!SN(e))return;let n=k_(t),r=Qg(e,t,e._primaryPosition),o=e._primaryPreviousPosition,a=e.getInputAction(pn.MOUSE_MOVE,n);_(a)&&(X.clone(o,vN.startPosition),X.clone(r,vN.endPosition),a(vN)),X.clone(r,o),(e._buttonDown[rs.LEFT]||e._buttonDown[rs.MIDDLE]||e._buttonDown[rs.RIGHT])&&t.preventDefault()}var O6={position:new X};function Tfe(e,t){let n=t.button,r;if(n===rs.LEFT)r=pn.LEFT_DOUBLE_CLICK;else return;let o=k_(t),a=e.getInputAction(r,o);_(a)&&(Qg(e,t,O6.position),a(O6))}function Sfe(e,t){let n;if(_(t.deltaY)){let a=t.deltaMode;a===t.DOM_DELTA_PIXEL?n=-t.deltaY:a===t.DOM_DELTA_LINE?n=-t.deltaY*40:n=-t.deltaY*120}else t.detail>0?n=t.detail*-120:n=t.wheelDelta;if(!_(n))return;let r=k_(t),o=e.getInputAction(pn.WHEEL,r);_(o)&&(o(n),t.preventDefault())}function Afe(e,t){TN(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r)a=n[r],s=a.identifier,u.set(s,Qg(e,a,new X));_I(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,l.set(s,X.clone(u.get(s)))}function N6(e,t){TN(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r)a=n[r],s=a.identifier,u.remove(s);_I(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,l.remove(s)}var B6={position:new X},CN={position1:new X,position2:new X},F6={position:new X},z6={position:new X},V6={position:new X};function _I(e,t){let n=k_(t),r=e._positions,o=r.length,a,s,u=e._isPinching;if(o!==1&&e._buttonDown[rs.LEFT]){if(e._buttonDown[rs.LEFT]=!1,_(e._touchHoldTimer)&&(clearTimeout(e._touchHoldTimer),e._touchHoldTimer=void 0),a=e.getInputAction(pn.LEFT_UP,n),_(a)&&(X.clone(e._primaryPosition,F6.position),a(F6)),o===0&&!e._isTouchHolding&&(s=e.getInputAction(pn.LEFT_CLICK,n),_(s))){let l=e._primaryStartPosition,c=e._previousPositions.values[0];wN(l,c,e._clickPixelTolerance)&&(X.clone(e._primaryPosition,z6.position),s(z6))}e._isTouchHolding=!1}if(o===0&&u&&(e._isPinching=!1,a=e.getInputAction(pn.PINCH_END,n),_(a)&&a()),o===1&&!u){let l=r.values[0];X.clone(l,e._primaryPosition),X.clone(l,e._primaryStartPosition),X.clone(l,e._primaryPreviousPosition),e._buttonDown[rs.LEFT]=!0,a=e.getInputAction(pn.LEFT_DOWN,n),_(a)&&(X.clone(l,B6.position),a(B6)),e._touchHoldTimer=setTimeout(function(){if(!e.isDestroyed()&&(e._touchHoldTimer=void 0,e._isTouchHolding=!0,s=e.getInputAction(pn.RIGHT_CLICK,n),_(s))){let c=e._primaryStartPosition,f=e._previousPositions.values[0];wN(c,f,e._holdPixelTolerance)&&(X.clone(e._primaryPosition,V6.position),s(V6))}},Jh.touchHoldDelayMilliseconds),t.preventDefault()}o===2&&!u&&(e._isPinching=!0,a=e.getInputAction(pn.PINCH_START,n),_(a)&&(X.clone(r.values[0],CN.position1),X.clone(r.values[1],CN.position2),a(CN),t.preventDefault()))}function bfe(e,t){TN(e);let n=t.changedTouches,r,o=n.length,a,s,u=e._positions;for(r=0;r<o;++r){a=n[r],s=a.identifier;let c=u.get(s);_(c)&&Qg(e,a,c)}q6(e,t);let l=e._previousPositions;for(r=0;r<o;++r)a=n[r],s=a.identifier,X.clone(u.get(s),l.get(s))}var xN={startPosition:new X,endPosition:new X},tE={distance:{startPosition:new X,endPosition:new X},angleAndHeight:{startPosition:new X,endPosition:new X}};function q6(e,t){let n=k_(t),r=e._positions,o=e._previousPositions,a=r.length,s;if(a===1&&e._buttonDown[rs.LEFT]){let u=r.values[0];X.clone(u,e._primaryPosition);let l=e._primaryPreviousPosition;s=e.getInputAction(pn.MOUSE_MOVE,n),_(s)&&(X.clone(l,xN.startPosition),X.clone(u,xN.endPosition),s(xN)),X.clone(u,l),t.preventDefault()}else if(a===2&&e._isPinching&&(s=e.getInputAction(pn.PINCH_MOVE,n),_(s))){let u=r.values[0],l=r.values[1],c=o.values[0],f=o.values[1],h=l.x-u.x,d=l.y-u.y,p=Math.sqrt(h*h+d*d)*.25,g=f.x-c.x,y=f.y-c.y,v=Math.sqrt(g*g+y*y)*.25,w=(l.y+u.y)*.125,C=(f.y+c.y)*.125,E=Math.atan2(d,h),S=Math.atan2(y,g);X.fromElements(0,v,tE.distance.startPosition),X.fromElements(0,p,tE.distance.endPosition),X.fromElements(S,C,tE.angleAndHeight.startPosition),X.fromElements(E,w,tE.angleAndHeight.endPosition),s(tE)}}function Ife(e,t){if(t.target.setPointerCapture(t.pointerId),t.pointerType==="touch"){let n=e._positions,r=t.pointerId;n.set(r,Qg(e,t,new X)),_I(e,t),e._previousPositions.set(r,X.clone(n.get(r)))}else G6(e,t)}function k6(e,t){if(t.pointerType==="touch"){let n=e._positions,r=t.pointerId;n.remove(r),_I(e,t),e._previousPositions.remove(r)}else U6(e,t)}function Dfe(e,t){if(t.pointerType==="touch"){let n=e._positions,r=t.pointerId,o=n.get(r);if(!_(o))return;Qg(e,t,o),q6(e,t);let a=e._previousPositions;X.clone(n.get(r),a.get(r))}else H6(e,t)}function Jh(e){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._isTouchHolding=!1,this._lastSeenTouchEvent=-Jh.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new X,this._primaryPosition=new X,this._primaryPreviousPosition=new X,this._positions=new Va,this._previousPositions=new Va,this._removalFunctions=[],this._touchHoldTimer=void 0,this._clickPixelTolerance=5,this._holdPixelTolerance=25,this._element=T(e,document),wfe(this)}Jh.prototype.setInputAction=function(e,t,n){let r=EN(t,n);this._inputEvents[r]=e};Jh.prototype.getInputAction=function(e,t){let n=EN(e,t);return this._inputEvents[n]};Jh.prototype.removeInputAction=function(e,t){let n=EN(e,t);delete this._inputEvents[n]};Jh.prototype.isDestroyed=function(){return!1};Jh.prototype.destroy=function(){return Efe(this),ot(this)};Jh.mouseEmulationIgnoreMilliseconds=800;Jh.touchHoldDelayMilliseconds=1500;var Jg=Jh;function Sm(e){this.viewer=e.viewer,this.callback=e.callback,this.drawPrimitive=new dC({viewer:this.viewer,callback:this.callback}),this.callbackFuncs={drawing:void 0,drawEnd:void 0},this.isDrawingFlag=!1,this.editingEntity=void 0,this.nextEditEntity=void 0,this._primitives=this.viewer.scene.primitives,this.enableEditMode=!0,this.startEdit()}Sm.prototype.startDraw=function(e){this.isDrawingFlag=!0,this.drawPrimitive._stop=!1;let t=this;switch(e){case"LineString":this.drawPrimitive.getLineAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Polygon":this.drawPrimitive.getPolygonAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Square":this.drawPrimitive.getRectangleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Rectangle":this.drawPrimitive.getRectangleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"FanRing":this.drawPrimitive.prototype.getFanRingAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Ellipse":this.drawPrimitive.getEllipseAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Circle":this.drawPrimitive.getCircleAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"SectorPlane":this.drawPrimitive.getSectorPlaneAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"Point":this.drawPrimitive.getPointAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;case"SectorPlaneByThreePoint":this.drawPrimitive.getSectorPlaneByThreePointAttr(function(r,o,a){o&&t.drawByPositions({geometryType:e,callbackType:r,positions3D:o,id:a}),n(r,o,a)});break;default:break}function n(r,o,a){a||console.error("EV_CsDrawHelper click draw 'entites' id undifined"),!t.callbackFuncs.drawing||t.callbackFuncs.drawing}};Sm.prototype.endDraw=function(){};Sm.prototype.drawByPositions=function(e){let t=e.geometryType,n=e.callbackType,r=e.positions3D,o=e.id,a=[];r.forEach(function(u,l,c){l%3===0&&(a[Math.floor(l/3)]=[]),a[Math.floor(l/3)].push(u)});let s;switch(t){case"LineString":s=this.drawPrimitive.drawLine({positions:r,id:o});break;case"Polygon":s=this.drawPrimitive.drawPolygon({positions:r,id:o});break;case"Rectangle":s=this.drawPrimitive.drawRectangle({positions:r,id:o});break;case"Circle":s=this.drawPrimitive.drawCircle({positions:r,id:o});break;case"Ellipse":s=this.drawPrimitive.drawEllipse({positions:r,id:o});break;case"SectorPlane":s=this.drawPrimitive.drawSectorPlane({positions:r,id:o});break;case"Point":s=this.drawPrimitive.drawPoint({positions:r,id:o});break;case"SectorPlaneByThreePoint":s=this.drawPrimitive.drawSectorPlaneByThreePoint({positions:r,id:o});break;default:break}s.positions3D||(s.positions3D=r),n==="rightClick"&&(Pfe(this,s),r&&this.callbackFuncs.drawEnd&&typeof this.callbackFuncs.drawEnd=="function"&&this.callbackFuncs.drawEnd(s))};Sm.prototype.startEdit=function(){this.handler=new Jg(this.viewer.scene.canvas);let e=this;this.handler.setInputAction(function(t){e.handlerCallBcak("leftClick",t.position)},pn.LEFT_CLICK),this.handler.setInputAction(function(t){e.handlerCallBcak("leftDown",t.position)},pn.LEFT_DOWN),this.handler.setInputAction(function(t){e.handlerCallBcak("rightClick",t.position)},pn.RIGHT_CLICK)};Sm.prototype.endEdit=function(){this.handler&&(this.handler.destroy(),delete this.handler)};Sm.prototype.handlerCallBcak=function(e,t){let n=this.viewer.scene.drillPick(t);!this.isDrawingFlag&&n.length>0?n.forEach(function(r){Object.keys(r).forEach(function(a){r[a]&&r[a][e]&&r[a][e](t)})}):!this.isDrawingFlag&&n.length===0&&this.setEditMode(this.editingEntity,!1)};Sm.prototype.setEditMode=function(e,t,n){};Sm.prototype.clear=function(){this.drawPrimitive.clear()};function Pfe(e,t){e.isDrawingFlag=!1;function n(r){e.nextEditEntity&&e.nextEditEntity.id===r.id||(e.nextEditEntity=r,e.setEditMode(e.editingEntity,!1),e.editingEntity=e.nextEditEntity)}t&&Mfe(t,"leftClick",function(){!e.enableEditMode||(n(t),e.setEditMode(t,!0,!0))})}function Mfe(e,t,n){e[t]=n}var W6=Sm;function nE(e){if(!Cesium.defined(e))throw new DeveloperError("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.viewer))throw new DeveloperError("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!Cesium.defined(e.position))throw new DeveloperError("\u4F4D\u7F6E\u53C2\u6570\u672A\u5B9A\u4E49");this.viewer=e.viewer,this.id=Cesium.defaultValue(e.id,Cesium.createGuid()),this._scene=this.viewer.scene,this.show=Cesium.defaultValue(e.show,!0),this._topRadius=Cesium.defaultValue(e.topRadius,0),this._bottomRadius=Cesium.defaultValue(e.bottomRadius,0),this._length=Cesium.defaultValue(e.length,1e3),this._slices=Cesium.defaultValue(e.slices,128),this._position=e.position,this.fillColor=Cesium.defaultValue(e.fillColor,Cesium.Color.RED),this.geometry=void 0,this.changeMt=!1,this.changeGeometry=!1,this._modelMatrix=Cesium.defaultValue(e.modelMatrix,void 0),this._center=new Cesium.Cartesian3,this._command=new Cesium.DrawCommand({owner:this,pass:Cesium.Pass.TRANSLUCENT,primitiveType:Cesium.PrimitiveType.TRIANGLES,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})}),this._scene.primitives.add(this)}nE.prototype.update=function(e){var t=e.mode;if(!(!this.show||t!==Cesium.SceneMode.SCENE3D)){var n=e.context,r=this;this._command.uniformMap={v_colour:function(){return r.fillColor}},this._modelMatrix||(this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position)),(!this.geometry||this.changeGeometry)&&(this.geometry=this.createGeometry(this._length,this._topRadius,this._bottomRadius,this._slices,!0)),(!this._VA||this.changeMt)&&(this._VA=Lfe(this,n,this.geometry)),Cesium.defined(this._command.shaderProgram)||(this._command.shaderProgram=Cesium.ShaderProgram.fromCache({context:n,vertexShaderSource:Ofe(),fragmentShaderSource:Nfe()})),this._command.vertexArray=this._VA;var o=e.commandList,a=e.passes;a.render&&o.push(this._command)}};nE.prototype.change=function(e,t){e&&(this.changeMt=!0,this._modelMatrix=e),t&&(this.changeGeometry=!0,this._length=t)};nE.prototype.createGeometry=function(e,t,n,r,o){var a=0,s=-e;if(!(e<=0||t<0||n<0||t===0&&n===0)){var E=0,u=0,l=r+r,c=r+l,f=l+l,h=o?(l+r)*3:r*3,d=o?l*3:0,p=o?2*l:l,g=new Float64Array(p*3);for(A=0;A<r;A++){let D=A/r*Cesium.Math.TWO_PI,P=Math.cos(D),M=Math.sin(D),I=P*n,O=M*n;var y=P*t,v=M*t;g[u+h]=I,g[u+h+1]=O,g[u+h+2]=s,g[u+d]=y,g[u+d+1]=v,g[u+d+2]=a,u+=3,o&&(g[E++]=I,g[E++]=O,g[E++]=s,g[E++]=y,g[E++]=v,g[E++]=a)}for(var w=12*r-12,C=Cesium.IndexDatatype.createTypedArray(f,w),E=0,S=0,A=0;A<r-1;A++)C[E++]=S,C[E++]=S+2,C[E++]=S+3,C[E++]=S,C[E++]=S+3,C[E++]=S+1,S+=2;if(C[E++]=l-2,C[E++]=0,C[E++]=1,C[E++]=l-2,C[E++]=1,C[E++]=l-1,this._showBottom)for(A=1;A<r-1;A++)C[E++]=l+A+1,C[E++]=l+A,C[E++]=l;if(this._showTop==!0)for(A=1;A<r-1;A++)C[E++]=c,C[E++]=c+A,C[E++]=c+A+1;return{position:g,indices:C}}};nE.prototype.destroy=function(){var e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._scene.primitives.contains(this)){var t=this._scene.primitives._primitives.indexOf(this);t!==-1&&(this._scene.primitives._primitives.splice(t,1),delete this._external._composites[this._scene.primitives._guid])}return Cesium.destroyObject(this)};function Lfe(e,t,n){var r=Rfe(e),o=Cesium.Buffer.createVertexBuffer({context:t,typedArray:r,usage:e._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),a=12,s=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(n.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Cesium.VertexArray({context:t,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}function Rfe(e){var t=new Cesium.Matrix4,n=e._center,r=12,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(r)),e._dynamic&&(e._vertexBufferTypedArray=o);var a=[],s=e._modelMatrix,u=Cesium.Matrix4.clone(s,t);return u[12]-=n.x,u[13]-=n.y,u[14]-=n.z,a.push(new Cesium.Cartesian3(u[12],u[13],u[14])),o[0]=u[0],o[1]=u[4],o[2]=u[8],o[3]=u[12],o[4]=u[1],o[5]=u[5],o[6]=u[9],o[7]=u[13],o[8]=u[2],o[9]=u[6],o[10]=u[10],o[11]=u[14],o}function Ofe(){var e=`attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position =czm_viewProjection* czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Nfe(){var e=`uniform vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var Y6=nE;function yI(e,t){}yI.GetData=function(e,t,n){var r=[],o=t.split("/");if(e.toUpperCase()==="XML")var a=new Cesium.Resource.fetchXML({url:t}).then(function(s){if(s){for(var u=0;u<s.children.length;u++)if(s.children[u].attributes.length===0&&s.children[u].children.length!==0)for(var l=0;l<s.children[u].children.length;l++){var c=s.children[u].children[l].attributes;if(c.length!==0&&s.children[u].children[l].children.length===0){var f={type:s.children[u].children[l].attributes[0].nodeValue,scale:s.children[u].children[l].attributes[1].nodeValue,name:s.children[u].children[l].attributes[2].nodeValue,path:o[0]+"/"+o[1]+"/gltf/"+s.children[u].children[l].attributes[2].nodeValue+".gltf",desc:s.children[u].children[l].attributes[3].nodeValue};r.push(f)}}n&&n(r)}else return})};yI.GetDataByJson=function(e,t,n){var r="",o=t.split("/");if(e.toUpperCase()==="XML")var a=new Cesium.Resource.fetchXML({url:t}).then(function(s){if(s)r=X6(s.children,r,o),n&&n(r);else return})};yI.GetXMLToObject=function(e,t){var n=[],r=[];for(var o in e)r.push(o),n.push(e[o]);for(var a=[],o=0;o<n.length;o++)var s=n[o],u=r[o],l=new Cesium.Resource.fetchXML({url:s,queryParameters:{name:u}}).then(function(f){var h=f.URL.indexOf("=")+1,d=f.URL.slice(h,f.URL.length),p={name:d,InfoJson:Bfe(f)};a.push(p),a.length===n.length&&t&&t(a)}).catch(function(){throw new Cesium.DeveloperError("\u8BF7\u6C42\u6570\u636E\u5931\u8D25")})};function Bfe(e){var t=t||{};n();function n(){t.escapeMode===void 0&&(t.escapeMode=!0),t.attributePrefix=t.attributePrefix||"_",t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",t.enableToStringFunc===void 0&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],t.skipEmptyTextNodesForObj===void 0&&(t.skipEmptyTextNodesForObj=!0),t.stripWhitespaces===void 0&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],t.useDoubleQuotes===void 0&&(t.useDoubleQuotes=!1),t.xmlElementsFilter=t.xmlElementsFilter||[],t.jsonPropertiesFilter=t.jsonPropertiesFilter||[],t.keepCData===void 0&&(t.keepCData=!1)}var r={ELEMENT_NODE:1,ATTR_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function o(I){var O=I.localName;return O==null&&(O=I.baseName),(O==null||O=="")&&(O=I.nodeName),O}function a(I){return I.prefix}function s(I){return typeof I=="string"?I.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):I}function u(I,O,m,b){for(var L=0;L<I.length;L++){var R=I[L];if(typeof R=="string"){if(R==b)break}else if(R instanceof RegExp){if(R.test(b))break}else if(typeof R=="function"&&R(O,m,b))break}return L!=I.length}function l(I,O,m){switch(t.arrayAccessForm){case"property":I[O]instanceof Array?I[O+"_asArray"]=I[O]:I[O+"_asArray"]=[I[O]];break}!(I[O]instanceof Array)&&t.arrayAccessFormPaths.length>0&&u(t.arrayAccessFormPaths,I,O,m)&&(I[O]=[I[O]])}function c(I){var O=I.split(/[-T:+Z]/g),m=new Date(O[0],O[1]-1,O[2]),b=O[5].split(".");if(m.setHours(O[3],O[4],b[0]),b.length>1&&m.setMilliseconds(b[1]),O[6]&&O[7]){var L=O[6]*60+Number(O[7]),R=/\d\d-\d\d:\d\d$/.test(I)?"-":"+";L=0+(R=="-"?-1*L:L),m.setMinutes(m.getMinutes()-L-m.getTimezoneOffset())}else I.indexOf("Z",I.length-1)!==-1&&(m=new Date(Date.UTC(m.getFullYear(),m.getMonth(),m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds(),m.getMilliseconds())));return m}function f(I,O,m){if(t.datetimeAccessFormPaths.length>0){var b=m.split(".#")[0];return u(t.datetimeAccessFormPaths,I,O,b)?c(I):I}else return I}function h(I,O,m,b){return O==r.ELEMENT_NODE&&t.xmlElementsFilter.length>0?u(t.xmlElementsFilter,I,m,b):!0}function d(I,O){if(I.nodeType==r.DOCUMENT_NODE){for(var m=new Object,b=I.childNodes,L=0;L<b.length;L++){var R=b.item(L);if(R.nodeType==r.ELEMENT_NODE){var N=o(R);m[N]=d(R,N)}}return m}else if(I.nodeType==r.ELEMENT_NODE){var m=new Object;m.__cnt=0;for(var b=I.childNodes,L=0;L<b.length;L++){var R=b.item(L),N=o(R);if(R.nodeType!=r.COMMENT_NODE){var B=O+"."+N;h(m,R.nodeType,N,B)&&(m.__cnt++,m[N]==null?(m[N]=d(R,B),l(m,N,B)):(m[N]!=null&&(m[N]instanceof Array||(m[N]=[m[N]],l(m,N,B))),m[N][m[N].length]=d(R,B)))}}for(var G=0;G<I.attributes.length;G++){var F=I.attributes.item(G);m.__cnt++;var k=F.name;F.name==="model"||F.name==="name"||F.name==="modelname"?(m[t.attributePrefix+"path"]="./data/gltf/"+F.value+".gltf",k="modelname",m[t.attributePrefix+k]=F.value):F.name==="scale"?(k="modelscale",m[t.attributePrefix+k]=F.value):F.name==="icon"&&F.value!==""?m[t.attributePrefix+k]="./data/images/"+F.value:m[t.attributePrefix+k]=F.value}var Z=a(I);return Z!=null&&Z!=""&&(m.__cnt++,m.__prefix=Z),m["#text"]!=null&&(m.__text=m["#text"],m.__text instanceof Array&&(m.__text=m.__text.join(`
`)),t.stripWhitespaces&&(m.__text=m.__text.trim()),delete m["#text"],t.arrayAccessForm=="property"&&delete m["#text_asArray"],m.__text=f(m.__text,N,O+"."+N)),m["#cdata-section"]!=null&&(m.__cdata=m["#cdata-section"],delete m["#cdata-section"],t.arrayAccessForm=="property"&&delete m["#cdata-section_asArray"]),m.__cnt==0&&t.emptyNodeForm=="text"?m="":m.__cnt==1&&m.__text!=null?m=m.__text:m.__cnt==1&&m.__cdata!=null&&!t.keepCData?m=m.__cdata:m.__cnt>1&&m.__text!=null&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&m.__text==""||m.__text.trim()=="")&&delete m.__text,delete m.__cnt,t.enableToStringFunc&&(m.__text!=null||m.__cdata!=null)&&(m.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),m}else if(I.nodeType==r.TEXT_NODE||I.nodeType==r.CDATA_SECTION_NODE)return I.nodeValue}function p(I,O,m,b){var L="<"+(I!=null&&I.__prefix!=null?I.__prefix+":":"")+O;if(m!=null)for(var R=0;R<m.length;R++){var N=m[R],B=I[N];t.escapeMode&&(B=s(B)),L+=" "+N.substr(t.attributePrefix.length)+"=",t.useDoubleQuotes?L+='"'+B+'"':L+="'"+B+"'"}return b?L+="/>":L+=">",L}function g(I,O){return"</"+(I.__prefix!=null?I.__prefix+":":"")+O+">"}function y(I,O){return I.indexOf(O,I.length-O.length)!==-1}function v(I,O){return!!(t.arrayAccessForm=="property"&&y(O.toString(),"_asArray")||O.toString().indexOf(t.attributePrefix)==0||O.toString().indexOf("__")==0||I[O]instanceof Function)}function w(I){var O=0;if(I instanceof Object)for(var m in I)v(I,m)||O++;return O}function C(I,O,m){return t.jsonPropertiesFilter.length==0||m==""||u(t.jsonPropertiesFilter,I,O,m)}function E(I){var O=[];if(I instanceof Object)for(var m in I)m.toString().indexOf("__")==-1&&m.toString().indexOf(t.attributePrefix)==0&&O.push(m);return O}function S(I){var O="";return I.__cdata!=null&&(O+="<![CDATA["+I.__cdata+"]]>"),I.__text!=null&&(t.escapeMode?O+=s(I.__text):O+=I.__text),O}function A(I){var O="";return I instanceof Object?O+=S(I):I!=null&&(t.escapeMode?O+=s(I):O+=I),O}function D(I,O){return I===""?O:I+"."+O}function P(I,O,m,b){var L="";if(I.length==0)L+=p(I,O,m,!0);else for(var R=0;R<I.length;R++)L+=p(I[R],O,E(I[R]),!1),L+=M(I[R],D(b,O)),L+=g(I[R],O);return L}function M(I,O){var m="",b=w(I);if(b>0){for(var L in I)if(!(v(I,L)||O!=""&&!C(I,L,D(O,L)))){var R=I[L],N=E(R);if(R==null||R==null)m+=p(R,L,N,!0);else if(R instanceof Object)if(R instanceof Array)m+=P(R,L,N,O);else if(R instanceof Date)m+=p(R,L,N,!1),m+=R.toISOString(),m+=g(R,L);else{var B=w(R);B>0||R.__text!=null||R.__cdata!=null?(m+=p(R,L,N,!1),m+=M(R,D(O,L)),m+=g(R,L)):m+=p(R,L,N,!0)}else m+=p(R,L,N,!1),m+=A(R),m+=g(R,L)}}return m+=A(I),m}return d(e)}function X6(e,t,n){for(var r=0;r<e.length;r++){var o=e[r];if(o.attributes.length!==0)t=Ffe(o,t,n);else if(o.children!==void 0)return t+='"children":[{',X6(o.children,t,n)}return t}function Ffe(e,t,n){for(var r='"'+n[0]+"/"+n[1]+"/gltf/",o=0;o<e.attributes.length;o++)t+='"'+e.attributes[o].nodeName+'":"'+e.attributes[o].nodeValue+'",',e.attributes[o].nodeName==="name"&&(r+=e.attributes[o].nodeValue+'.gltf"');return t+='"path":'+r,t+="},{",t}var vI=yI;var zfe={NET_MSG_MIN:-1,NET_MSG_FIGHTER:0,NET_MSG_COMMAND:1,NET_MSG_TSPI:2,NET_MSG_RDR_STATE:3,NET_MSG_EWS_STA:4,NET_MSG_TARGET:6,NET_MSG_IRST:9,NET_MSG_IRMSL_STATE:12,NET_MSG_GTSPI:20,NET_MSG_RAD_STATE:21,NET_MSG_STATICTARGET:22,NET_MSG_COMBATPOWER:23,NET_MSG_RTSN:30,NET_MSG_RTKN:31,NET_MSG_WPN_TRAJ:32,NET_MSG_LARGE_PLANE:35,NET_MSG_SAFETYALARM:40},Re=Object.freeze(zfe);function AN(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.mtType=Cesium.defaultValue(e.mtType,Re.NET_MSG_MIN),this.name=e.name,this.uId=e.uId,this.show=Cesium.defaultValue(e.show,!0),this.modelType=e.modelType,this.nRedOrBlue=e.nRedOrBlue,this.realTime=e.realTime,this.fLon=e.fLon,this.fLat=e.fLat,this.fAlt=e.fAlt,this.position=e.position,this.headingPitchRoll=e.headingPitchRoll,this.scale=Cesium.defaultValue(e.scale,1),this.modelUri=e.modelUri,this.boundingBoxVisible=Cesium.defaultValue(e.boundingBoxVisible,!1),this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{}),this.modelIconUri=e.modelIconUri,this.modelIconColor=Cesium.defaultValue(e.modelIconColor,Cesium.Color.RED),this.modelIconScale=Cesium.defaultValue(e.modelIconScale,1),this.modelIconRotation=Cesium.defaultValue(e.modelIconRotation,0),this.modelIconDisplayDistance=Cesium.defaultValue(e.modelIconDisplayDistance,new Cesium.DistanceDisplayCondition(6e4,9e4)),this.modelLabelType=void 0,this.modelLabelVisible=Cesium.defaultValue(e.modelLabelVisible,!0),this.modelLabelPixelOffset=Cesium.defaultValue(e.modelLabelPixelOffset,new Cesium.Cartesian2(50,25)),this.modelLabelPullWireColor=Cesium.defaultValue(e.modelLabelPullWireColor,Cesium.Color.RED),this.modelLabelTextColor=Cesium.defaultValue(e.modelLabelTextColor,Cesium.Color.RED),this.sectorRadarVisible=Cesium.defaultValue(e.sectorRadarVisible,!1),this.sectorRadarColor=Cesium.defaultValue(e.sectorRadarColor,new Cesium.Color(.38,.64,.64,.6)),this.trace=Cesium.defaultValue(e.trace,void 0)}AN.clone=function(e,t){if(!!Cesium.defined(e))return Cesium.defined(t)||(t=new AN(e)),t.name=e.name,t.uId=e.uId,t.show=e.show,t.modelType=e.modelType,t.realTime=e.realTime,t.fLon=e.fLon,t.fLat=e.fLat,t.fAlt=e.fAlt,t.position=e.position,t.headingPitchRoll=Cesium.HeadingPitchRoll.clone(e.headingPitchRoll),t.scale=Cesium.defaultValue(t.scale,1),t.modelUri=e.modelUri,t.modelIconUri=e.modelIconUri,t.modelIconColor=Cesium.Color.clone(e.iconColor),t.modelIconDisplayDistance=Cesium.DistanceDisplayCondition.clone(e.modelIconDisplayDistance),t.ribbonVisible=e.ribbonVisible,t.ribbonColor=Cesium.Color.clone(e.ribbonColor),t.modelLabelVisible=e.modelLabelVisible,t.modelLabelPullWireColor=e.modelLabelPullWireColor,t.modelLabelType=e.modelLabelType,t.nRedOrBlue=e.nRedOrBlue,t.modelLabelPixelOffset=e.modelLabelPixelOffset,t.modelColor=e.modelColor,t.modelColorBlendMode=e.modelColorBlendMode,t.modelLabelTextColor=e.modelLabelTextColor,t.sectorRadarVisible=e.sectorRadarVisible,t.sectorRadarColor=e.sectorRadarColor,t};var rE=AN;function $h(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.wcPosition=e.wcPosition,this.headingPitchRoll=e.headingPitchRoll,this.timeMsec=e.timeMsec}function CI(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._traceTimeDuration=Cesium.defaultValue(e.traceTimeDuration,0),this._ribbonVisible=Cesium.defaultValue(e.ribbonVisible,!1),this.ribbonColor=Cesium.defaultValue(e.ribbonColor,new Cesium.Color(1,0,0,1)),this._wallVisible=Cesium.defaultValue(e.wallVisible,!1),this.wallColor=Cesium.defaultValue(e.wallColor,new Cesium.Color(1,0,0,1)),this._barVisible=Cesium.defaultValue(e.barVisible,!1),this.barColor=Cesium.defaultValue(e.barColor,new Cesium.Color(1,0,0,1)),this._barTimeInterval=Cesium.defaultValue(e.barTimeInterval,8),this._barDistanceInterval=Cesium.defaultValue(e.barDistanceInterval,0),this.lineColor=Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),this._lineVisible=Cesium.defaultValue(e.lineVisible,!1),this.ribbonScale=1,this.trackPoints=[],this.barPoints=[],this._forwardOffset=Cesium.defaultValue(e.forwardOffset,0),this._upOffset=Cesium.defaultValue(e.upOffset,0)}Object.defineProperties(CI.prototype,{traceTimeDuration:{get:function(){return this._traceTimeDuration},set:function(e){this._traceTimeDuration=e}},barTimeInterval:{get:function(){return this._barTimeInterval},set:function(e){this.barPoints=[],this._barDistanceInterval=0,this._barTimeInterval=e}},barDistanceInterval:{get:function(){return this._barDistanceInterval},set:function(e){this.barPoints=[],this._barTimeInterval=0,this._barDistanceInterval=e}},ribbonVisible:{get:function(){return this._ribbonVisible},set:function(e){this._ribbonVisible=e}},wallVisible:{get:function(){return this._wallVisible},set:function(e){this._wallVisible=e}},barVisible:{get:function(){return this._barVisible},set:function(e){this._barVisible=e}},forwardOffset:{get:function(){return this._forwardOffset},set:function(e){this._forwardOffset=e}},upOffset:{get:function(){return this._upOffset},set:function(e){this._upOffset=e}},lineVisible:{get:function(){return this._lineVisible},set:function(e){this._lineVisible=e}}});CI.prototype.add=function(e,t,n,r){if(this.ribbonScale=r,!(this.trackPoints.length>0&&n===this.trackPoints[this.trackPoints.length-1].timeMsec)){for(;this.trackPoints.length>0&&n-this.trackPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.trackPoints.shift();if(this.trackPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this._barVisible){if(this._barTimeInterval>0)if(this.barPoints.length>0){for(;this.barPoints.length>0&&n-this.barPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.barPoints.shift();this.barPoints.length-2>=0&&n-this.barPoints[this.barPoints.length-2].timeMsec>this._barTimeInterval*1e3?this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})):this.barPoints.length==0||this.barPoints.length==1?this.barPoints[this.barPoints.length]=new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n}):this.barPoints[this.barPoints.length-1]=new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})}else this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n}));else if(this._barDistanceInterval>0)if(this.barPoints.length>0){for(;this.barPoints.length>0&&n-this.barPoints[0].timeMsec>this._traceTimeDuration*1e3;)this.barPoints.shift();this.barPoints.length-2>=0&&Cesium.Cartesian3.distance(e,this.barPoints[this.barPoints.length-2].wcPosition)>=this._barDistanceInterval?this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})):this.barPoints.length==0||this.barPoints.length==1?this.barPoints[this.barPoints.length]=new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n}):this.barPoints[this.barPoints.length-1]=new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})}else this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n})),this.barPoints.push(new $h({wcPosition:e,headingPitchRoll:t,timeMsec:n}))}}};CI.prototype.clearAll=function(){this.trackPoints=[],this.barPoints=[]};var xI=CI;function G_(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.realTime=e.realTime,this.fLon=e.fLon,this.fLat=e.fLat,this.fAlt=e.fAlt,this.position=e.position,this.nRedOrBlue=Cesium.defaultValue(e.nRedOrBlue,0),Cesium.defined(e.headingPitchRoll)?this.headingPitchRoll=Cesium.HeadingPitchRoll.clone(e.headingPitchRoll):this.headingPitchRoll=new Cesium.HeadingPitchRoll,this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{})}function iE(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.mtType=Cesium.defaultValue(e.mtType,Re.NET_MSG_MIN),this.name=Cesium.defaultValue(e.name,""),this.uId=Cesium.defaultValue(e.uId,void 0),this.show=Cesium.defaultValue(e.show,!0),this.checked=Cesium.defaultValue(e.checked,!1),this.modelType=Cesium.defaultValue(e.modelType,0),this.timeAttitudeCollection=[],this.specialAttributes=Cesium.defaultValue(e.specialAttributes,{}),this.curTimeAttitude=Cesium.defaultValue(e.curTimeAttitude,new G_),this.disappearedTimeAttitude=Cesium.defaultValue(e.disappearedTimeAttitude,new G_),this.scale=Cesium.defaultValue(e.scale,1),this.modelUri=Cesium.defaultValue(e.modelUri,void 0),this.boundingBoxVisible=Cesium.defaultValue(e.boundingBoxVisible,!1),this.modelIconUri=Cesium.defaultValue(e.modelIconUri,void 0),this.modelIconColor=Cesium.defaultValue(e.modelIconColor,new Cesium.Color(1,0,0,1)),this.modelIconScale=Cesium.defaultValue(e.modelIconScale,1),this.modelIconRotation=Cesium.defaultValue(e.modelIconRotation,0),this.modelIconDisplayDistance=Cesium.defaultValue(e.modelIconDisplayDistance,new Cesium.DistanceDisplayCondition(6e4,9e4)),this.modelLabelType=void 0,this.modelLabelVisible=Cesium.defaultValue(e.modelLabelVisible,!0),this.modelLabelPixelOffset=Cesium.defaultValue(e.modelLabelPixelOffset,new Cesium.Cartesian2(50,25)),this.modelLabelPullWireColor=Cesium.defaultValue(e.modelLabelPullWireColor,new Cesium.Color(1,0,0,1)),this.modelLabelTextColor=Cesium.defaultValue(e.modelLabelTextColor,new Cesium.Color(1,0,0,1)),this.sectorRadarVisible=Cesium.defaultValue(e.sectorRadarVisible,!1),this.sectorRadarColor=Cesium.defaultValue(e.sectorRadarColor,new Cesium.Color(.38,.64,.64,.6)),this.trace=new xI({ribbonVisible:Cesium.defined(e.trace)?e.trace.ribbonVisible:Cesium.defaultValue(e.ribbonVisible,!1),ribbonColor:Cesium.defined(e.trace)?e.trace.ribbonColor:Cesium.defaultValue(e.ribbonColor,new Cesium.Color(1,0,0,1)),wallVisible:Cesium.defined(e.trace)?e.trace.wallVisible:Cesium.defaultValue(e.wallVisible,!1),wallColor:Cesium.defined(e.trace)?e.trace.wallColor:Cesium.defaultValue(e.wallColor,new Cesium.Color(1,0,0,1)),forwardOffset:Cesium.defined(e.trace)?e.trace.forwardOffset:Cesium.defaultValue(e.forwardOffset,0),upOffset:Cesium.defined(e.trace)?e.trace.upOffset:Cesium.defaultValue(e.upOffset,5),traceTimeDuration:Cesium.defined(e.trace)?e.trace.traceTimeDuration:Cesium.defaultValue(e.traceTimeDuration,0),barVisible:Cesium.defined(e.trace)?e.trace.barVisible:Cesium.defaultValue(e.barVisible,!1),barColor:Cesium.defined(e.trace)?e.trace.barColor:Cesium.defaultValue(e.barColor,new Cesium.Color(1,0,0,1)),lineVisible:Cesium.defined(e.trace)?e.trace.lineVisible:Cesium.defaultValue(e.lineVisible,!1),lineColor:Cesium.defined(e.trace)?e.trace.lineColor:Cesium.defaultValue(e.lineColor,new Cesium.Color(1,0,0,1)),barTimeInterval:Cesium.defined(e.trace)?e.trace.barTimeInterval:Cesium.defaultValue(e.barTimeInterval,0)})}iE.prototype.addTimeAttitude=function(e){this.timeAttitudeCollection.push(new G_(e))};iE.prototype.getMovingTargetStateByTime=function(e,t,n){Cesium.Check.typeOf.number("time",e);var r=Cesium.defined(t)?t:!1,o=Cesium.defined(n)?n:!1,a=void 0;if(this.timeAttitudeCollection.length>0){if(!r&&e>=this.timeAttitudeCollection[this.timeAttitudeCollection.length-1].realTime){if(this.disappearedTimeAttitude=this.timeAttitudeCollection[this.timeAttitudeCollection.length-1],o)return this.curTimeAttitude=this.disappearedTimeAttitude,this.timeAttitudeCollection.splice(0,this.timeAttitudeCollection.length-1),a=new rE(this),a.realTime=this.disappearedTimeAttitude.realTime,a.fLon=this.disappearedTimeAttitude.fLon,a.fLat=this.disappearedTimeAttitude.fLat,a.fAlt=this.disappearedTimeAttitude.fAlt,a.position=this.disappearedTimeAttitude.position,a.headingPitchRoll=this.disappearedTimeAttitude.headingPitchRoll,a.nRedOrBlue=this.disappearedTimeAttitude.nRedOrBlue,a.specialAttributes=this.disappearedTimeAttitude.specialAttributes,a;this.curTimeAttitude=new G_,this.timeAttitudeCollection.splice(0,this.timeAttitudeCollection.length);return}for(var s=this.timeAttitudeCollection[0],u=s,l=1;l<this.timeAttitudeCollection.length;l++){if(u=this.timeAttitudeCollection[l],e>=s.realTime&&e<=u.realTime){var c=Vfe(s,u,e);Cesium.defined(c)&&(a=new rE(this),a.realTime=c.realTime,a.fLon=c.fLon,a.fLat=c.fLat,a.fAlt=c.fAlt,a.position=c.position,a.headingPitchRoll=c.headingPitchRoll,a.nRedOrBlue=c.nRedOrBlue,a.specialAttributes=c.specialAttributes,this.curTimeAttitude=c,!r&&this.timeAttitudeCollection.length>2&&l-2>0&&this.timeAttitudeCollection.splice(0,l-2));break}s=this.timeAttitudeCollection[l]}}else Cesium.defined(this.disappearedTimeAttitude.position)&&(this.disappearedTimeAttitude=new G_),Cesium.defined(this.curTimeAttitude.position)&&(this.curTimeAttitude=new G_);return a};iE.cloneTimeAttitude=function(e){return new G_(e)};function Vfe(e,t,n){if(!(!Cesium.defined(e)||!Cesium.defined(t))){var r=e.realTime,o=t.realTime,a=o*1-r;if(!(a<=0)){var s=n*1-e.realTime;if(!(s<=0||s>a)){var u=iE.cloneTimeAttitude(e),l=e.position,c=t.position,f=s/a,h=Cesium.Cartesian3.lerp(l,c,f,new Cesium.Cartesian3);u.position=h,u.realTime=n;var d=e.headingPitchRoll.roll,p=e.headingPitchRoll.pitch,g=e.headingPitchRoll.heading,y=t.headingPitchRoll.roll,v=t.headingPitchRoll.pitch,w=t.headingPitchRoll.heading,C=Math.abs(y-d),E=Math.abs(w-g),S=v-p;E=E>Math.PI?Math.PI*2-E:E,C=C>Math.PI?Math.PI*2-C:C;var A=j6(g,w),D=j6(d,y);return u.headingPitchRoll.heading=g+E*f*A,u.headingPitchRoll.pitch=p+(v-p)*f,u.headingPitchRoll.roll=d+C*f*D,u}}}}var tet=new x,net=new x,ret=new x;function j6(e,t){var n=new Cesium.Cartesian3(Math.sin(e),Math.cos(e),0),r=new Cesium.Cartesian3(Math.sin(t),Math.cos(t),0),o=Cesium.Cartesian3.cross(n,r,new Cesium.Cartesian3);return o.z>0?-1:1}var Pu=iE;var kfe={ADD:0,REPLACE:1},Br=Object.freeze(kfe);function ap(e){if(this._loaderTaskProcessor=e.worker,this._xmlUrl=e.xmlUrl,!Cesium.defined(e.xmlUrl))throw new Cesium.DeveloperError("xmlUrl undefined!");this.trainingClock=e.trainingClock,this.datSource=e.datSource,this._promise=void 0,this.timeId=void 0,this.dataOperated=Br.ADD,this.trajOperated=Br.ADD,this.cachePlaneData=[],this.receiveDatas=[],this.receiveMTDatas=[],this.receiveMTFlightDatas=new Cesium.AssociativeArray,this.receiveTrajFlightDatas=new Cesium.AssociativeArray,this.receiveGtspiFlightDatas=new Cesium.AssociativeArray,this.receiveData=new Cesium.Event,this.stopReceiveData=new Cesium.Event,this.parseflight=new Cesium.AssociativeArray,this.initial_parseflight=new Cesium.AssociativeArray,this.idchFlyUser=new Cesium.AssociativeArray,this.idchFlyName=new Cesium.AssociativeArray,this.sendRadarMV=!1,this.redPlane=0,this.bluePlane=0,this.idchUnderName=new Cesium.AssociativeArray,this.idchUnderList=new Cesium.AssociativeArray,this.idchUnderInfo=new Cesium.AssociativeArray,this.idchUnderRaderList=new Cesium.AssociativeArray,this.rtknData=[],this.addEventArr=[],this.addRtkn=new Cesium.Event,this.addEventList=[],this.addAllRtkn=[],this.addIrsm=new Cesium.Event,this.addShowEvent=new Cesium.Event,this.irsmData=[],this.irsmIndex=0,this.redOrBlue=new Cesium.AssociativeArray,this.trajData=new Cesium.AssociativeArray,this.trajSendData=new Cesium.AssociativeArray,this.trajDataSid=new Cesium.AssociativeArray,this.radarTargetMap=new Cesium.AssociativeArray,this.radarTarget=new Cesium.AssociativeArray,this.radarEvent=new Cesium.Event,this.radarmvArr=[],this.ewsIndex=new Cesium.AssociativeArray,this.ewsData=new Cesium.AssociativeArray,this.gtspiData=[],this.gtspiArr=new Cesium.AssociativeArray,this.gtspiArrFine=new Cesium.AssociativeArray,this.sdrState=new Cesium.AssociativeArray,this.sdrIndex=new Cesium.AssociativeArray,this.sdrStateEvent=new Cesium.Event,this.missileXml=new Cesium.AssociativeArray,this.sendArr=new Cesium.AssociativeArray,this.planeXml=new Cesium.AssociativeArray,this.statictargetXml=new Cesium.AssociativeArray,this.largePlaneXml=new Cesium.AssociativeArray,this.gtspiXml=new Cesium.AssociativeArray,this.i3wpntypeXml=new Cesium.AssociativeArray,this.randomColor=new Cesium.AssociativeArray;var t=this;this.cacheTime=void 0,this.index=new Cesium.AssociativeArray,this.radarIndex=new Cesium.AssociativeArray,this.gtspiIndex=0,this.trajIndex=new Cesium.AssociativeArray,this.combatpower=new Cesium.AssociativeArray,vI.GetXMLToObject(this._xmlUrl,function(n){Ufe(t,n)}),this.clickNum=0,this.speed=1,this.StartWork(),this.planeResued=new Cesium.AssociativeArray,this.radarTime=new Cesium.AssociativeArray,this.radarWM=new Cesium.Event,this.addReaction=new Cesium.Event,this.flightState=new Cesium.Event,this.addPlane=new Cesium.Event,this.ewsEvent=new Cesium.Event}ap.prototype.addReceiveDataListener=function(e,t){switch(e){case Re.NET_MSG_TSPI:return this.receiveData.addEventListener(t);case Re.NET_MSG_FIGHTER:return this.flightState.addEventListener(t);case Re.NET_MSG_GTSPI:return this.receiveData.addEventListener(t);case Re.NET_MSG_RTKN:return this.addRtkn.addEventListener(t);case Re.NET_MSG_TARGET:return this.radarEvent.addEventListener(t);case Re.NET_MSG_RDR_STATE:return this.radarWM.addEventListener(t);case Re.NET_MSG_EWS_STA:return this.ewsEvent.addEventListener(t);case Re.NET_MSG_IRMSL_STATE:return this.addIrsm.addEventListener(t);case Re.NET_MSG_RAD_STATE:return this.sdrStateEvent.addEventListener(t);case"addShowEvent":return this.addShowEvent.addEventListener(t);case Re.NET_MSG_COMBATPOWER:return this.combatpower.addEventListener(t)}};ap.prototype.removeReceiveDataListener=function(e){return this.receiveData.removeEventListener(e)};ap.prototype.StartWork=function(){var e=this;this._promise=this._loaderTaskProcessor.scheduleTask({datSource:e.datSource}),this.onMessage()};ap.prototype.onMessage=function(){var e=this;if(Cesium.defined(e._promise))e._loaderTaskProcessor._worker.onmessage=function(t){var n=t.data;if(!Cesium.defined(n.id)&&n.length!=0&&typeof n[0]!="string")switch(e.cacheTime=n[n.length-1].header.datTime,n[0].header.msgType){case Re.NET_MSG_TSPI:for(var r=0;r<n.length;r++){var o=e.sendArr.get(n[r].header.sID),a=e.index.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.sendArr.set(n[r].header.sID,s)}if(a||e.index.set(n[r].header.sID,0),e.randomColor.contains(n[r].header.sID)||(e.randomColor.set(n[r].header.sID,Gfe()),n[r].chFlyUser?(e.idchFlyUser.set(n[r].header.sID,n[r].chFlyUser),e.idchFlyName.set(n[r].header.sID,n[r].chFlyUser+""+n[r].chFighterName)):(e.idchFlyUser.set(n[r].header.sID,n[r].header.sID),e.idchFlyName.set(n[r].header.sID,n[r].header.sID))),e.redOrBlue.contains(n[r].header.sID)){var u=e.redOrBlue.get(n[r].header.sID),l=u.length;u[l-1].nRedOrBlue!=n[r].nRedOrBlue&&u.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"fly"})}else{var s=[];s.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"fly"}),e.redOrBlue.set(n[r].header.sID,s)}}break;case Re.NET_MSG_FIGHTER:e.flightState.raiseEvent(n);for(var r=0;r<n.length;r++){var o=e.parseflight.get(n[r].header.sID),c=e.initial_parseflight.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.parseflight.set(n[r].header.sID,s)}c||e.initial_parseflight.set(n[r].header.sID,n[r])}break;case Re.NET_MSG_RTKN:for(var f=0;f<n.length;f++)if(e.idchFlyUser.contains(n[f].nTgtID))if(e.planeResued.contains(n[f].nTgtID))e.planeResued.get(n[f].nTgtID).push(n[f]);else{var h=[];h.push(n[f]),e.planeResued.set(n[f].nTgtID,h)}e.rtknData=e.rtknData.concat(n),e.addAllRtkn=e.addAllRtkn.concat(n),e.addEventArr=e.addEventArr.concat(n);break;case Re.NET_MSG_RTSN:e.addAllRtkn=e.addAllRtkn.concat(n),e.addEventArr=e.addEventArr.concat(n);break;case Re.NET_MSG_WPN_TRAJ:n.forEach(function(S){if(e.trajData.contains(S.header.sID))e.trajData.get(S.header.sID).push(S);else{var A=[];A.push(S),e.trajData.set(S.header.sID,A)}if(e.trajSendData.contains(S.weaponID))S.captureState!=0&&e.trajSendData.get(S.weaponID).length!=2&&e.trajSendData.get(S.weaponID)[0].captureState==0&&e.trajSendData.get(S.weaponID).push(S),e.trajDataSid.get(S.header.sID+"_"+S.weaponID).push(S);else{var D=[];D.push(S),e.trajSendData.set(S.weaponID,D),e.trajDataSid.set(S.header.sID+"_"+S.weaponID,D)}e.trajIndex.contains(S.header.sID)||e.trajIndex.set(S.header.sID,0)});break;case Re.NET_MSG_GTSPI:e.gtspiData=e.gtspiData.concat(n);for(var f=0;f<n.length;f++)e.idchUnderName.set(n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType),e.idchUnderList.set(n[f].header.sID,n[f].header.sID),e.idchUnderInfo.set(n[f].header.sID,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType),n[f].equipmentType==2&&e.idchUnderRaderList.set(n[f].header.sID,n[f].header.sID+"_"+n[f].equipmentID+"_"+n[f].equipmentType);for(var r=0;r<n.length;r++){var o=e.gtspiArr.get(n[r].header.sID);if(o)o.push(n[r]);else{var s=[];s.push(n[r]),e.gtspiArr.set(n[r].header.sID,s)}var d=e.gtspiArrFine.get(n[r].header.sID+"_"+n[r].equipmentID+"_"+n[r].equipmentType);if(d)d.push(n[r]);else{var s=[];s.push(n[r]),e.gtspiArrFine.set(n[r].header.sID+"_"+n[r].equipmentID+"_"+n[r].equipmentType,s)}}break;case Re.NET_MSG_IRMSL_STATE:n.forEach(function(S){e.irsmData.push(S)});break;case Re.NET_MSG_TARGET:n.forEach(function(S,A,D){if(e.radarTargetMap.contains(S.header.sID))e.radarTargetMap.get(S.header.sID).push(S);else{var P=[];P.push(S),e.radarTargetMap.set(S.header.sID,P)}if(e.radarIndex.contains(S.header.sID)||e.radarIndex.set(S.header.sID,0),e.radarTarget.contains(S.header.sID))e.radarTarget.get(S.header.sID).push(S);else{var P=[];P.push(S),e.radarTarget.set(S.header.sID,P)}});for(var p in e.radarTargetMap._hash){var g=e.radarTargetMap.get(p);if(Cesium.defined(g[0])){for(var y=g[0].header.datTime,v=0;v<g.length;v++){var w=g[v].header.datTime,C=e.radarTime.get(g[v].header.sID);if((g[v].tgtInfo[0].tgtSensor==0||g[v].tgtInfo[0].tgtSensor==2)&&g[v].tgtInfo[0].tgtAzimuth!=0&&g[v].tgtInfo[0].tgtAzimuth<70&&g[v].tgtInfo[0].tgtAzimuth>-70){if(e.radarTime.contains(g[v].header.sID)){if(v==0)continue;Cesium.defined(C[C.length-1].endTime)?C.push({startTime:new Date(g[v].header.datTime)}):w-y>2e3&&(C[C.length-1].endTime=new Date(g[v-1].header.datTime))}else{var s=[];s[0]={},s[0].startTime=g[v].header.datTime,e.radarTime.set(g[v].header.sID,s)}y=w}else Cesium.defined(C)&&!Cesium.defined(C[C.length-1].endTime)&&(C[C.length-1].endTime=new Date(g[v-1].header.datTime))}g.splice(0,g.length-1)}}break;case Re.NET_MSG_RDR_STATE:e.radarmvArr=e.radarmvArr.concat(n),e.radarWM.raiseEvent(e.radarmvArr);break;case Re.NET_MSG_EWS_STA:n.forEach(function(S){if(e.ewsData.contains(S.header.sID))e.ewsData.get(S.header.sID).push(S);else{var A=[];A.push(S),e.ewsData.set(S.header.sID,A)}e.ewsIndex.contains(S.header.sID)||e.ewsIndex.set(S.header.sID,0)});break;case Re.NET_MSG_RAD_STATE:n.forEach(function(S){if(e.sdrState.contains(S.header.sID))e.sdrState.get(S.header.sID).push(S);else{var A=[];A.push(S),e.sdrState.set(S.header.sID,A)}e.sdrIndex.contains(S.header.sID)||e.sdrIndex.set(S.header.sID,0)});case Re.NET_MSG_COMBATPOWER:n.forEach(function(S){if(e.combatpower.contains(S.header.sID))e.combatpower.get(S.header.sID).push(S);else{var A=[];A.push(S),e.combatpower.set(S.header.sID,A)}});for(var r=0;r<n.length;r++)if(e.redOrBlue.contains(n[r].header.sID)){var u=e.redOrBlue.get(n[r].header.sID),l=u.length,E=n[r].nRedOrBlue;E!==0&&E!=1&&(E=2),u[l-1].nRedOrBlue!=E&&u.push({time:n[r].header.datTime,nRedOrBlue:n[r].nRedOrBlue,type:"car"})}else{var s=[],E=n[r].nRedOrBlue;E!==0&&E!==1&&(E=2),s.push({time:n[r].header.datTime,nRedOrBlue:E,type:"car"}),e.redOrBlue.set(n[r].header.sID,s)}break}};else return!1};ap.prototype.startSend=function(){var e=this;this.timeId=setInterval(function(){e.trainingClock.tick();var t=Cesium.JulianDate.toDate(e.trainingClock.currentTime);t=t.getTime(),e.speed=Number(e.speed);var n=[];for(var r in e.sendArr._hash){var o=e.index.get(r);if(o<e.sendArr._hash[r].length)o+parseInt(e.speed*50)>=e.sendArr._hash[r].length?n=n.concat(e.sendArr._hash[r].slice(o,e.sendArr._hash[r].length)):n=n.concat(e.sendArr._hash[r].slice(o,o+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.index.set(r,o+parseInt(e.speed*50)):n=n.concat(e.sendArr._hash[r].slice(o-400,o+parseInt(e.speed*400)));else continue}if(e.sendTspi(n,e.dataOperated),e.trajData._array.length!=0){var a=[];for(var r in e.trajData._hash){var s=e.trajIndex.get(r);s<e.trajData._hash[r].length&&(s+parseInt(e.speed*100)>e.trajData._hash[r].length?a=a.concat(e.trajData._hash[r].slice(s,e.trajData._hash[r].length)):a=a.concat(e.trajData._hash[r].slice(s,s+parseInt(e.speed*100))),e.trainingClock.shouldAnimate?e.trajIndex.set(r,s+parseInt(e.speed*100)):a=a.concat(e.trajData._hash[r].slice(s-200,s+parseInt(e.speed*200))))}e.sendTraj(a,e.trajOperated)}if(e.gtspiData.length!=0){if(e.gtspiIndex+parseInt(e.speed*50)>=e.gtspiData.length){var u=e.gtspiData.slice(e.gtspiIndex,e.gtspiData.length);e.trainingClock.shouldAnimate&&(e.gtspiIndex=parseInt(e.gtspiData.length))}else{var u=e.gtspiData.slice(e.gtspiIndex,e.gtspiIndex+parseInt(e.speed*50));e.trainingClock.shouldAnimate&&(e.gtspiIndex+=parseInt(e.speed*50))}u.length!=0&&e.sendGtspi(u,e.dataOperated)}if(e.irsmData.length!=0){var l=e.irsmData.slice(e.irsmIndex,e.irsmIndex+parseInt(e.speed*500));e.trainingClock.shouldAnimate&&(e.irsmIndex+=parseInt(e.speed*500)),l.length!=0&&e.addIrsm.raiseEvent(l)}if(e.rtknData.length!=0&&e.addRtkn.raiseEvent(e.rtknData.splice(0,e.rtknData.length)),e.addEventArr.length!=0&&e.addShowEvent.raiseEvent(e.addEventArr.splice(0,e.addEventArr.length)),e.radarTarget._array.length!=0){var c=[];for(var r in e.radarTarget._hash){var f=e.radarIndex.get(r);f<e.radarTarget._hash[r].length&&(f+parseInt(e.speed*50)>e.radarTarget._hash[r].length?c=c.concat(e.radarTarget._hash[r].slice(f,e.radarTarget._hash[r].length)):c=c.concat(e.radarTarget._hash[r].slice(f,f+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.radarIndex.set(r,f+parseInt(e.speed*50)):c=c.concat(e.radarTarget._hash[r].slice(f-200,f+parseInt(e.speed*200))))}c.length!=0&&(c=c.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.radarEvent.raiseEvent(c))}if(e.ewsData._array.length!=0){var h=[];for(var r in e.ewsData._hash){var d=e.ewsIndex.get(r);d<e.ewsData._hash[r].length&&(d+parseInt(e.speed*50)>e.ewsData._hash[r].length?h=h.concat(e.ewsData._hash[r].slice(d,e.ewsData._hash[r].length)):h=h.concat(e.ewsData._hash[r].slice(d,d+parseInt(e.speed*50))),e.trainingClock.shouldAnimate?e.ewsIndex.set(r,d+parseInt(e.speed*50)):h=h.concat(e.ewsData._hash[r].slice(d-100,d+parseInt(e.speed*100))))}h.length!=0&&(h=h.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.ewsEvent.raiseEvent(h))}if(e.sdrState._array.length!=0){var p=[];for(var r in e.sdrState._hash){var g=e.sdrIndex.get(r);g<e.sdrState._hash[r].length&&(g+parseInt(e.speed*20)>e.sdrState._hash[r].length?p=p.concat(e.sdrState._hash[r].slice(g,e.sdrState._hash[r].length)):p=p.concat(e.sdrState._hash[r].slice(g,g+parseInt(e.speed*20))),e.trainingClock.shouldAnimate?e.sdrIndex.set(r,g+parseInt(e.speed*20)):p=p.concat(e.sdrState._hash[r].slice(g,f+parseInt(e.speed*10))))}p.length!=0&&(p=p.sort(function(y,v){return y.header.datTime-v.header.datTime}),e.sdrStateEvent.raiseEvent(p))}e.sendRadarMV&&(e.radarWM.raiseEvent(e.radarmvArr),e.sendRadarMV=!1)},1e3)};ap.prototype.sendTspi=function(e,t){var n=this,r=1,o=e;o=o.sort(function(f,h){return f.header.datTime-h.header.datTime});for(var a=0;a<o.length;a+=r){var s=o[a].header.sID,u=n.receiveMTFlightDatas.get(s);if(Cesium.defined(u))u.addTimeAttitude({realTime:o[a].header.datTime,fLon:o[a].fLon,fLat:o[a].fLat,fAlt:o[a].fAlt,position:o[a].position,nRedOrBlue:o[a].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(o[a].fHeading,o[a].fPitch,o[a].fRoll),specialAttributes:{decoyDrop:o[a].decoyDrop,enginePower:o[a].enginePower,trainPro:o[a].trainPro,height:o[a].height,vel_east:o[a].vel_east,vel_north:o[a].vel_north,vel_up:o[a].vel_up,fHeading:o[a].fHeading,fPitch:o[a].fPitch,fRoll:o[a].fRoll}});else{if(Cesium.defined(n.planeXml.get(o[a].header.planeType)))var l=n.planeXml.get(o[a].header.planeType)._path;else continue;var c=new Pu({uId:o[a].header.sID,mtType:Re.NET_MSG_TSPI,name:o[a].chFlyUser,modelType:o[a].header.planeType,modelUri:l,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(n.planeXml.get(o[a].header.planeType)._modelscale),forwardOffset:-15,upOffset:2,traceTimeDuration:20});c.addTimeAttitude({realTime:o[a].header.datTime,fLon:o[a].fLon,fLat:o[a].fLat,fAlt:o[a].fAlt,position:o[a].position,nRedOrBlue:o[a].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(o[a].fHeading,o[a].fPitch,o[a].fRoll),specialAttributes:{decoyDrop:o[a].decoyDrop,enginePower:o[a].enginePower,trainPro:o[a].trainPro,height:o[a].height,vel_east:o[a].vel_east,vel_north:o[a].vel_north,vel_up:o[a].vel_up,fHeading:o[a].fHeading,fPitch:o[a].fPitch,fRoll:o[a].fRoll}}),n.receiveMTFlightDatas.set(c.uId,c),n.addAllRtkn.push(o[a])}}n.receiveData.raiseEvent(n.receiveMTFlightDatas,t),n.dataOperated=Br.ADD,n.receiveMTFlightDatas._array.forEach(function(f){f.timeAttitudeCollection=[]})};ap.prototype.sendTraj=function(e,t){for(var n=this,r=e.sort(function(h,d){return h.header.datTime-d.header.datTime}),o=0;o<r.length;o++){var a=r[o].header.sID+"_"+r[o].weaponID,s=n.redOrBlue.get(r[o].header.sID);if(!!Cesium.defined(s)){if(s.length==1)r[o].nRedOrBlue=s[0].nRedOrBlue;else for(var u=1;u<s.length;u++)r[o].header.datTime>=s[u].time&&(r[o].nRedOrBlue=s[u].nRedOrBlue);var l=n.receiveTrajFlightDatas.get(a);if(Cesium.defined(l))l.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].mslLongitude,fLat:r[o].mslLatitude,fAlt:r[o].mslAltitude,position:r[o].position,nRedOrBlue:r[o].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].mslCourse,r[o].mslPitch,0),specialAttributes:{weaponID:r[o].weaponID,vel:parseFloat(r[o].vel)*3.6,mslDistance:r[o].mslDistance,targetID:r[o].targetID,weaponType:r[o].weaponType,mslAltitude:r[o].mslAltitude}});else{if(Cesium.defined(n.missileXml.get(r[o].weaponType)))var c=n.missileXml.get(r[o].weaponType)._path;else continue;var f=new Pu({uId:a,mtType:Re.NET_MSG_WPN_TRAJ,name:n.missileXml.get(r[o].weaponType)._modelName,modelType:r[o].weaponType,modelUri:c,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(n.missileXml.get(r[o].weaponType)._modelscale),forwardOffset:-15,upOffset:2,traceTimeDuration:20,specialAttributes:{targetID:r[o].targetID}});f.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].mslLongitude,fLat:r[o].mslLatitude,fAlt:r[o].mslAltitude,position:r[o].position,nRedOrBlue:r[o].nRedOrBlue,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].mslCourse,r[o].mslPitch,0),specialAttributes:{weaponID:r[o].weaponID,vel:parseFloat(r[o].vel)*3.6,mslDistance:r[o].mslDistance,targetID:r[o].targetID,weaponType:r[o].weaponType,mslAltitude:r[o].mslAltitude}}),n.receiveTrajFlightDatas.set(f.uId,f)}}}n.receiveData.raiseEvent(n.receiveTrajFlightDatas,t),n.trajOperated=Br.ADD,n.receiveTrajFlightDatas._array.forEach(function(h){h.timeAttitudeCollection=[]})};ap.prototype.sendGtspi=function(e,t){for(var n=this,r=e,o=0;o<r.length;o++){var a=r[o].header.sID+"_"+r[o].equipmentID+"_"+r[o].equipmentType,s=Hfe(n.combatpower,r[o]),u=n.receiveGtspiFlightDatas.get(a);if(Cesium.defined(u))u.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].gTspiLon,fLat:r[o].gTspiLat,fAlt:r[o].gTspiAlt,position:r[o].position,nRedOrBlue:s,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].northAngle,0,0),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}});else{if(Cesium.defined(n.gtspiXml.get(r[o].campType)))var l=n.gtspiXml.get(r[o].campType).srdtype,c=l.find(function(d){return d._id==r[o].equipmentType}),f=c._path;else continue;var h=new Pu({uId:a,mtType:Re.NET_MSG_GTSPI,name:c._desc,modelType:r[o].equipmentType,modelUri:f,modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(c._modelscale),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}});h.addTimeAttitude({realTime:r[o].header.datTime,fLon:r[o].gTspiLon,fLat:r[o].gTspiLat,fAlt:r[o].gTspiAlt,position:r[o].position,nRedOrBlue:s,headingPitchRoll:Cesium.HeadingPitchRoll.fromDegrees(r[o].northAngle,0,0),specialAttributes:{fakeCampID:r[o].fakeCampID,campType:r[o].campType,equipmentType:r[o].equipmentType,equipmentID:r[o].equipmentID,gTspiState:r[o].gTspiState}}),n.receiveGtspiFlightDatas.set(h.uId,h)}}n.receiveData.raiseEvent(n.receiveGtspiFlightDatas,t),n.dataOperated=Br.ADD,n.receiveGtspiFlightDatas._array.forEach(function(d){d.timeAttitudeCollection=[]})};ap.prototype.splitTwo=function(e,t,n){var r=0,o=t.length-1;if(n==null)for(;r<=o;){var a=Math.ceil((o+r)/2);if(t[a+1]!=null){if(t[a].header.datTime<=e&&t[a+1].header.datTime>e)return t[a+1];if(t[a].header.datTime<e)r=a;else if(t[a].header.datTime>e)o=a;else return-1}else return t[a];if(o==1)return t[0]}else if(n!=null)for(;r<=o;){var a=Math.ceil((o+r)/2);if(t[a+1]!=null){if(t[a].header.datTime<=e&&t[a+1].header.datTime>e)return a;if(t[a].header.datTime<e)r=a;else if(t[a].header.datTime>e)o=a;else return-1}else return a;if(o==1)return a-1}};function Gfe(){var e=Math.floor(Math.random()*256),t=Math.floor(Math.random()*256),n=Math.floor(Math.random()*256);return"rgb("+e+","+t+","+n+")"}function Ufe(e,t){for(var n=0;n<t.length;n++){var r=t[n].name;if(r=="planemissile"){for(var o=t[n].InfoJson.root.missile.model,a=t[n].InfoJson.root.plane.model,s=0;s<o.length;s++)e.missileXml.set(o[s]._type,o[s]);for(var u=0;u<a.length;u++)e.planeXml.set(a[u]._type,a[u])}else if(r=="gtspi")for(var l=t[n].InfoJson.root.gtspi,c=0;c<l.length;c++)e.gtspiXml.set(l[c]._id,l[c]);else if(r=="statictarget")for(var f=t[n].InfoJson.root.statictgt,h=0;h<f.length;h++)e.statictargetXml.set(f[h]._id,f[h]);else if(r=="largeplane")for(var d=t[n].InfoJson.root.model,p=0;p<d.length;p++)e.largePlaneXml.set(d[p]._type,d[p]);else if(r=="i3wpntype")for(var g=t[n].InfoJson.root.missileType.model,y=0;y<g.length;y++)e.i3wpntypeXml.set(g[y]._type,g[y])}}function Hfe(e,t){for(var n=e.get(t.header.sID),r=t.header.realTime,o="",a=0;a<n.length;a++)a==0?o=n[0].nRedOrBlue:a<n.length-1&&n[a].header.datTime<=r&&n[a].header.datTime>r&&(o=n[a].nRedOrBlue);return o!==0&&o!==1&&(o=2),o}var wI=ap;function $g(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new xe,this.setValue(e)}Object.defineProperties($g.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}});$g.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value};$g.prototype.setValue=function(e){let t=this._value;if(t!==e){let n=_(e),r=n&&typeof e.clone=="function",o=n&&typeof e.equals=="function";(!o||!e.equals(t))&&(this._hasClone=r,this._hasEquals=o,this._value=r?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}};$g.prototype.equals=function(e){return this===e||e instanceof $g&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))};$g.prototype.valueOf=function(){return this._value};$g.prototype.toString=function(){return String(this._value)};var sp=$g;function qfe(e,t,n,r,o){return{configurable:r,get:function(){return this[t]},set:function(a){let s=this[t],u=this[n];_(u)&&(u(),this[n]=void 0),a!==void 0&&(!_(a)||!_(a.getValue))&&_(o)&&(a=o(a)),s!==a&&(this[t]=a,this._definitionChanged.raiseEvent(this,e,a,s)),_(a)&&_(a.definitionChanged)&&(this[n]=a.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,e,a,a)},this))}}}function Wfe(e){return new sp(e)}function Yfe(e,t,n){return qfe(e,`_${e.toString()}`,`_${e.toString()}Subscription`,T(t,!1),T(n,Wfe))}var Q=Yfe;function ed(){Le.throwInstantiationError()}Object.defineProperties(ed.prototype,{isConstant:{get:Le.throwInstantiationError},definitionChanged:{get:Le.throwInstantiationError}});ed.prototype.getValue=Le.throwInstantiationError;ed.prototype.equals=Le.throwInstantiationError;ed.equals=function(e,t){return e===t||_(e)&&e.equals(t)};ed.arrayEquals=function(e,t){if(e===t)return!0;if(!_(e)||!_(t)||e.length!==t.length)return!1;let n=e.length;for(let r=0;r<n;r++)if(!ed.equals(e[r],t[r]))return!1;return!0};ed.isConstant=function(e){return!_(e)||e.isConstant};ed.getValueOrUndefined=function(e,t,n){return _(e)?e.getValue(t,n):void 0};ed.getValueOrDefault=function(e,t,n,r){return _(e)?T(e.getValue(t,r),n):n};ed.getValueOrClonedDefault=function(e,t,n,r){let o;return _(e)&&(o=e.getValue(t,r)),_(o)||(o=n.clone(o)),o};var ye=ed;var Xfe=K.WHITE,jfe=K.BLACK,Kfe=1;function mC(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(mC.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)&&ye.isConstant(this._outlineColor)&&ye.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth")});mC.prototype.getType=function(e){return"PolylineOutline"};mC.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,Xfe,t.color),t.outlineColor=ye.getValueOrClonedDefault(this._outlineColor,e,jfe,t.outlineColor),t.outlineWidth=ye.getValueOrDefault(this._outlineWidth,e,Kfe),t};mC.prototype.equals=function(e){return this===e||e instanceof mC&&ye.equals(this._color,e._color)&&ye.equals(this._outlineColor,e._outlineColor)&&ye.equals(this._outlineWidth,e._outlineWidth)};var oE=mC;function bN(e,t){this.viewer=e,this.options=t,this.mtMgr=t.mtMgr,this.entityid=[]}bN.prototype.Point_Connection=function(e,t,n,r,o){let a=this;a.viewer.entities.add({polyline:{positions:e,width:1,material:new oE({color:K.YELLOW,outlineWidth:1,outlineColor:K.YELLOW})},id:t}),a.viewer.entities.add({position:n,label:{text:r,font:"15px sans-serif",name:t},id:`${t}pop`}),a.entityid.push({lineID:t,textID:`${t}pop`,type:o})};bN.prototype.RemoveLine=function(e){let t=this;for(let r=0;r<e.length;r++)n(e[r]),n(`${e[r]}pop`),t.entityid=t.entityid.filter(function(o){return o.lineID!==e[r]});function n(r){let o=t.viewer.entities.getById(r);t.viewer.entities.remove(o)}};var EI=bN;function hc(e){this._ellipsoid=T(e,Ge.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(hc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});hc.mercatorAngleToGeodeticLatitude=function(e){return z.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};hc.geodeticLatitudeToMercatorAngle=function(e){e>hc.MaximumLatitude?e=hc.MaximumLatitude:e<-hc.MaximumLatitude&&(e=-hc.MaximumLatitude);let t=Math.sin(e);return .5*Math.log((1+t)/(1-t))};hc.MaximumLatitude=hc.mercatorAngleToGeodeticLatitude(Math.PI);hc.prototype.project=function(e,t){let n=this._semimajorAxis,r=e.longitude*n,o=hc.geodeticLatitudeToMercatorAngle(e.latitude)*n,a=e.height;return _(t)?(t.x=r,t.y=o,t.z=a,t):new x(r,o,a)};hc.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,r=e.x*n,o=hc.mercatorAngleToGeodeticLatitude(e.y*n),a=e.z;return _(t)?(t.longitude=r,t.latitude=o,t.height=a,t):new ce(r,o,a)};var gC=hc;function _C(e){if(e=T(e,T.EMPTY_OBJECT),!_(e.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");this.KiloGridHandler=void 0,this._viewer=e.viewer,this.coordinatesEntities=[],this.gridLines=[],this.kiloGridlabels=[]}Object.defineProperties(_C.prototype,{});_C.prototype.drawCoordinates=function(e,t,n,r,o){this.removeCoordinates(),this._viewer.scene.globe.depthTestAgainstTerrain=!1,this._viewer.scene.enableDepthPlane=!0;let a=T(e,20),s=T(t,10),u=T(n,!0),l=T(r,!0),c=T(o,K.WHITE),f=this._viewer.entities;for(let d=-180;d<=180;d+=a){let p="";d===0&&(p="0"),p+=d===0?"":`${d}\xB0`,d===-180&&(p=""),this.coordinatesEntities.push(f.add({position:x.fromDegrees(d,0),polyline:{positions:x.fromDegreesArray([d,-90,d,0,d,90]),width:1,clampToGround:!1,material:c},label:{show:u,text:p,verticalOrigin:an.TOP,font:"14px sans-serif",fillColor:c}}))}let h=[];for(let d=-180;d<=180;d+=.5)h.push(d);for(let d=-80;d<=80;d+=s){let p="";p+=`${d}\xB0`,d===0&&(p="");let g=h.map(function(y){return[y,d].join(",")}).join(",").split(",").map(y=>Number(y));this.coordinatesEntities.push(f.add({position:x.fromDegrees(0,d),polyline:{positions:x.fromDegreesArray(g),clampToGround:!1,width:1,material:c},label:{show:l,text:p,font:"14px sans-serif",fillColor:K.WHITE}}))}};_C.prototype.removeCoordinates=function(){let e=this;this.coordinatesEntities.forEach(t=>{e._viewer.entities.remove(t)}),this.coordinatesEntities=[]};_C.prototype.drawKilometerGrid=function(e,t,n,r,o,a,s,u,l,c,f){this.removeKilometerGrid(),this._viewer.scene.globe.depthTestAgainstTerrain=!1,this._viewer.scene.enableDepthPlane=!0;let h=this;this.gridLines=[],this.kiloGridlabels=[];let d=T(e,120),p=T(t,120),g=T(n,0),y=T(r,0),v=T(a,100),w=T(s,100),C=1,E=1,S=T(u,new K(1,0,0,1)),A=T(l,new K(0,0,1,1));c=T(c,new K(0,1,0,1));let D=ce.fromDegrees(d,p),P=new gC,M=P.project(D),I=P.unproject(new x(M.x+v*1e3,M.y+w*1e3,M.z));if(o===0){for(let O=0;O<=v;O++){let m=M.x+O*C*1e3,b=[];for(let L=0;L<=w;L++){let R=M.y+L*1e3,N=P.unproject(new x(m,R,M.z));b.push(N.longitude),b.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(b),width:1,clampToGround:!1,material:S}}))}for(let O=0;O<=w;O++){let m=M.y+O*E*1e3,b=[];for(let L=0;L<=v;L++){let R=M.x+L*1e3,N=P.unproject(new x(R,m,M.z));b.push(N.longitude),b.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(b),width:1,clampToGround:!1,material:S}}))}}else if(o===1){let O=v*3;C=C/3;for(let b=0;b<=O;b++){let L=M.x+b*C*1e3,R=[];for(let B=0;B<=w;B++){let G=M.y+B*1e3,F=P.unproject(new x(L,G,M.z));R.push(F.longitude),R.push(F.latitude)}let N=S;b%3!==0&&(N=A),this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(R),width:1,clampToGround:!1,material:N}}))}let m=v*3;E=E/3;for(let b=0;b<=m;b++){let L=M.y+b*E*1e3,R=[];for(let B=0;B<=v;B++){let G=M.x+B*1e3,F=P.unproject(new x(G,L,M.z));R.push(F.longitude),R.push(F.latitude)}let N=S;b%3!==0&&(N=A),this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(R),width:1,clampToGround:!1,material:N}}))}for(let b=0;b<O;b++){let L=M.x+(b+.5)*C*1e3;for(let R=0;R<m;R++){let N=M.y+(R+.5)*E*1e3,B=P.unproject(new x(L,N,M.z)),G=b%3,F=R%3,k=K6(G,F);this.kiloGridlabels.push(this._viewer.entities.add({position:ce.toCartesian(B),label:{show:!0,text:k,verticalOrigin:an.TOP,font:"14px sans-serif",fillColor:c,distanceDisplayCondition:new gn(0,3e4)}}))}}}else if(o===2){for(let O=0;O<=v;O++){let m=M.x+O*C*1e3,b=[];for(let L=0;L<=w;L++){let R=M.y+L*1e3,N=P.unproject(new x(m,R,M.z));b.push(N.longitude),b.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(b),width:1,clampToGround:!1,material:S}}))}for(let O=0;O<=w;O++){let m=M.y+O*E*1e3,b=[];for(let L=0;L<=v;L++){let R=M.x+L*1e3,N=P.unproject(new x(R,m,M.z));b.push(N.longitude),b.push(N.latitude)}this.gridLines.push(this._viewer.entities.add({polyline:{positions:x.fromRadiansArray(b),width:1,clampToGround:!1,material:S}}))}}this.KiloGridHandler||(this.KiloGridHandler=new Jg(this._viewer.canvas,!0),this.KiloGridHandler.setInputAction(function(O){if(h._viewer.scene.pickPositionSupported){let b=h._viewer.scene.camera.getPickRay(O.endPosition),L=h._viewer.scene.globe.pick(b,h._viewer.scene);if(!L)return;let R=ce.fromCartesian(L);if(D.longitude<=R.longitude&&D.latitude<R.latitude&&I.longitude>=R.longitude&&I.latitude>=R.latitude){let N=(I.longitude-D.longitude)/v,B=(I.latitude-D.latitude)/w,G=(R.longitude-D.longitude)/N,F=(R.latitude-D.latitude)/B;if(o===0){if(f){let k=`${Math.floor(G+g)},${Math.floor(F+y)}`;f(k)}}else if(o===1){let k=G-Math.floor(G)<=.3333333333333333?0:G-Math.floor(G)>=.6666666666666666?2:1,Z=F-Math.floor(F)<=1/3?0:F-Math.floor(F)>=2/3?2:1,te=K6(k,Z);if(f){let oe=`${Math.floor(G+g)},${Math.floor(F+y)}(${te})`;f(oe)}}else if(o===2){let k=Math.floor(G)*N+D.longitude,Z=Math.floor(F)*B+D.latitude,te=P.project(new ce(k,Z)),oe=P.project(R);if(f){let ue=`${String(Math.floor(G+g))+String((oe.x-te.x).toFixed(2))},${String(Math.floor(F+y))}${String((oe.y-te.y).toFixed(2))}`;f(ue)}}}}},pn.MOUSE_MOVE))};_C.prototype.removeKilometerGrid=function(){this.KiloGridHandler&&(this.KiloGridHandler.destroy(),this.KiloGridHandler=void 0);let e=this;this.gridLines.forEach(t=>{e._viewer.entities.remove(t)}),this.gridLines=[],this.kiloGridlabels.forEach(t=>{e._viewer.entities.remove(t)}),this.kiloGridlabels=[]};function K6(e,t){let n="1";return e===0&&t===2?n="1":e===1&&t===2?n="2":e===2&&t===2?n="3":e===2&&t===1?n="4":e===2&&t===0?n="5":e===1&&t===0?n="6":e===0&&t===0?n="7":e===0&&t===1?n="8":e===1&&t===1&&(n="9"),n}var Z6=_C;var Zfe={POLYGON:0,POLYLINE:1,POINT:2,DASHLINE:3,OUTLINE:4,ARROELINE:5,GLOWLINE:6,WAKELINE:7,GRID:8,STRIPE:9,MEASURELINE:10,CIRCLE:11},td=Object.freeze(Zfe);var Qfe={LEFT_RIGHT_CLICK:0,LEFT_DOUBLE_CLICK:1},U_=Object.freeze(Qfe);function e0(e){e=T(e,T.EMPTY_OBJECT),this._ellipsoid=T(e.ellipsoid,Ge.WGS84),this._rectangle=T(e.rectangle,ln.MAX_VALUE),this._projection=new uc(this._ellipsoid),this._numberOfLevelZeroTilesX=T(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=T(e.numberOfLevelZeroTilesY,1)}Object.defineProperties(e0.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});e0.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e};e0.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e};e0.prototype.rectangleToNativeRectangle=function(e,t){let n=z.toDegrees(e.west),r=z.toDegrees(e.south),o=z.toDegrees(e.east),a=z.toDegrees(e.north);return _(t)?(t.west=n,t.south=r,t.east=o,t.north=a,t):new ln(n,r,o,a)};e0.prototype.tileXYToNativeRectangle=function(e,t,n,r){let o=this.tileXYToRectangle(e,t,n,r);return o.west=z.toDegrees(o.west),o.south=z.toDegrees(o.south),o.east=z.toDegrees(o.east),o.north=z.toDegrees(o.north),o};e0.prototype.tileXYToRectangle=function(e,t,n,r){let o=this._rectangle,a=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),u=o.width/a,l=e*u+o.west,c=(e+1)*u+o.west,f=o.height/s,h=o.north-t*f,d=o.north-(t+1)*f;return _(r)||(r=new ln(l,d,c,h)),r.west=l,r.south=d,r.east=c,r.north=h,r};e0.prototype.positionToTileXY=function(e,t,n){let r=this._rectangle;if(!ln.contains(r,e))return;let o=this.getNumberOfXTilesAtLevel(t),a=this.getNumberOfYTilesAtLevel(t),s=r.width/o,u=r.height/a,l=e.longitude;r.east<r.west&&(l+=z.TWO_PI);let c=(l-r.west)/s|0;c>=o&&(c=o-1);let f=(r.north-e.latitude)/u|0;return f>=a&&(f=a-1),_(n)?(n.x=c,n.y=f,n):new X(c,f)};var TI=e0;var Q6=new x,J6=new x,$6=new ce,IN=new x,Jfe=new x,eH=new Ee,$fe=new TI,aE=[new ce,new ce,new ce,new ce],sE=new X,Oa={};Oa.initialize=function(){let e=Oa._initPromise;return _(e)||(e=_t.fetchJson(Pa("Assets/approximateTerrainHeights.json")).then(function(t){Oa._terrainHeights=t}),Oa._initPromise=e),e};Oa.getMinimumMaximumHeights=function(e,t){t=T(t,Ge.WGS84);let n=tH(e),r=Oa._defaultMinTerrainHeight,o=Oa._defaultMaxTerrainHeight;if(_(n)){let a=`${n.level}-${n.x}-${n.y}`,s=Oa._terrainHeights[a];_(s)&&(r=s[0],o=s[1]),t.cartographicToCartesian(ln.northeast(e,$6),Q6),t.cartographicToCartesian(ln.southwest(e,$6),J6),x.midpoint(J6,Q6,IN);let u=t.scaleToGeodeticSurface(IN,Jfe);if(_(u)){let l=x.distance(IN,u);r=Math.min(r,-l)}else r=Oa._defaultMinTerrainHeight}return r=Math.max(Oa._defaultMinTerrainHeight,r),{minimumTerrainHeight:r,maximumTerrainHeight:o}};Oa.getBoundingSphere=function(e,t){t=T(t,Ge.WGS84);let n=tH(e),r=Oa._defaultMaxTerrainHeight;if(_(n)){let a=`${n.level}-${n.x}-${n.y}`,s=Oa._terrainHeights[a];_(s)&&(r=s[1])}let o=Ee.fromRectangle3D(e,t,0);return Ee.fromRectangle3D(e,t,r,eH),Ee.union(o,eH,o)};function tH(e){ce.fromRadians(e.east,e.north,0,aE[0]),ce.fromRadians(e.west,e.north,0,aE[1]),ce.fromRadians(e.east,e.south,0,aE[2]),ce.fromRadians(e.west,e.south,0,aE[3]);let t=0,n=0,r=0,o=0,a=Oa._terrainHeightsMaxLevel,s;for(s=0;s<=a;++s){let u=!1;for(let l=0;l<4;++l){let c=aE[l];if($fe.positionToTileXY(c,s,sE),l===0)r=sE.x,o=sE.y;else if(r!==sE.x||o!==sE.y){u=!0;break}}if(u)break;t=r,n=o}if(s!==0)return{x:t,y:n,level:s>a?a:s-1}}Oa._terrainHeightsMaxLevel=6;Oa._defaultMaxTerrainHeight=9e3;Oa._defaultMinTerrainHeight=-1e5;Oa._terrainHeights=void 0;Oa._initPromise=void 0;Object.defineProperties(Oa,{initialized:{get:function(){return _(Oa._terrainHeights)}}});var Hc=Oa;function ehe(e){e=T(e,T.EMPTY_OBJECT),this.geometry=e.geometry,this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=T(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var H_=ehe;function the(e){e=T(e,T.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=T(e.normalize,!1),this.value=e.value}var qc=the;var nhe={NONE:0,GEODESIC:1,RHUMB:2},Na=Object.freeze(nhe);var nH=z.EPSILON10;function rhe(e,t,n,r){if(!_(e))return;n=T(n,!1);let o=_(r),a=e.length;if(a<2)return e;let s,u=e[0],l,c,f=0,h=-1;for(s=1;s<a;++s)l=e[s],t(u,l,nH)?(_(c)||(c=e.slice(0,s),f=s-1,h=0),o&&r.push(s)):(_(c)&&(c.push(l),f=s,o&&(h=r.length)),u=l);return n&&t(e[0],e[a-1],nH)&&(o&&(_(c)?r.splice(h,0,f):r.push(a-1)),_(c)?c.length-=1:c=e.slice(0,-1)),_(c)?c:e}var yC=rhe;function ihe(e){let t=e._uSquared,n=e._ellipsoid.maximumRadius,r=e._ellipsoid.minimumRadius,o=(n-r)/n,a=Math.cos(e._startHeading),s=Math.sin(e._startHeading),u=(1-o)*Math.tan(e._start.latitude),l=1/Math.sqrt(1+u*u),c=l*u,f=Math.atan2(u,a),h=l*s,d=h*h,p=1-d,g=Math.sqrt(p),y=t/4,v=y*y,w=v*y,C=v*v,E=1+y-3*v/4+5*w/4-175*C/64,S=1-y+15*v/8-35*w/8,A=1-3*y+35*v/4,D=1-5*y,P=E*f-S*Math.sin(2*f)*y/2-A*Math.sin(4*f)*v/16-D*Math.sin(6*f)*w/48-Math.sin(8*f)*5*C/512,M=e._constants;M.a=n,M.b=r,M.f=o,M.cosineHeading=a,M.sineHeading=s,M.tanU=u,M.cosineU=l,M.sineU=c,M.sigma=f,M.sineAlpha=h,M.sineSquaredAlpha=d,M.cosineSquaredAlpha=p,M.cosineAlpha=g,M.u2Over4=y,M.u4Over16=v,M.u6Over64=w,M.u8Over256=C,M.a0=E,M.a1=S,M.a2=A,M.a3=D,M.distanceRatio=P}function ohe(e,t){return e*t*(4+e*(4-3*t))/16}function rH(e,t,n,r,o,a,s){let u=ohe(e,n);return(1-u)*e*t*(r+u*o*(s+u*a*(2*s*s-1)))}function ahe(e,t,n,r,o,a,s){let u=(t-n)/t,l=a-r,c=Math.atan((1-u)*Math.tan(o)),f=Math.atan((1-u)*Math.tan(s)),h=Math.cos(c),d=Math.sin(c),p=Math.cos(f),g=Math.sin(f),y=h*p,v=h*g,w=d*g,C=d*p,E=l,S=z.TWO_PI,A=Math.cos(E),D=Math.sin(E),P,M,I,O,m;do{A=Math.cos(E),D=Math.sin(E);let Z=v-C*A;I=Math.sqrt(p*p*D*D+Z*Z),M=w+y*A,P=Math.atan2(I,M);let te;I===0?(te=0,O=1):(te=y*D/I,O=1-te*te),S=E,m=M-2*w/O,isFinite(m)||(m=0),E=l+rH(u,te,O,P,I,M,m)}while(Math.abs(E-S)>z.EPSILON12);let b=O*(t*t-n*n)/(n*n),L=1+b*(4096+b*(b*(320-175*b)-768))/16384,R=b*(256+b*(b*(74-47*b)-128))/1024,N=m*m,B=R*I*(m+R*(M*(2*N-1)-R*m*(4*I*I-3)*(4*N-3)/6)/4),G=n*L*(P-B),F=Math.atan2(p*D,v-C*A),k=Math.atan2(h*D,v*A-C);e._distance=G,e._startHeading=F,e._endHeading=k,e._uSquared=b}var she=new x,DN=new x;function iH(e,t,n,r){let o=x.normalize(r.cartographicToCartesian(t,DN),she),a=x.normalize(r.cartographicToCartesian(n,DN),DN);ahe(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude),e._start=ce.clone(t,e._start),e._end=ce.clone(n,e._end),e._start.height=0,e._end.height=0,ihe(e)}function uE(e,t,n){let r=T(n,Ge.WGS84);this._ellipsoid=r,this._start=new ce,this._end=new ce,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,_(e)&&_(t)&&iH(this,e,t,r)}Object.defineProperties(uE.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}});uE.prototype.setEndPoints=function(e,t){iH(this,e,t,this._ellipsoid)};uE.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)};uE.prototype.interpolateUsingSurfaceDistance=function(e,t){let n=this._constants,r=n.distanceRatio+e/n.b,o=Math.cos(2*r),a=Math.cos(4*r),s=Math.cos(6*r),u=Math.sin(2*r),l=Math.sin(4*r),c=Math.sin(6*r),f=Math.sin(8*r),h=r*r,d=r*h,p=n.u8Over256,g=n.u2Over4,y=n.u6Over64,v=n.u4Over16,w=2*d*p*o/3+r*(1-g+7*v/4-15*y/4+579*p/64-(v-15*y/4+187*p/16)*o-(5*y/4-115*p/16)*a-29*p*s/16)+(g/2-v+71*y/32-85*p/16)*u+(5*v/16-5*y/4+383*p/96)*l-h*((y-11*p/2)*u+5*p*l/2)+(29*y/96-29*p/16)*c+539*p*f/1536,C=Math.asin(Math.sin(w)*n.cosineAlpha),E=Math.atan(n.a/n.b*Math.tan(C));w=w-n.sigma;let S=Math.cos(2*n.sigma+w),A=Math.sin(w),D=Math.cos(w),P=n.cosineU*D,M=n.sineU*A,O=Math.atan2(A*n.sineHeading,P-M*n.cosineHeading)-rH(n.f,n.sineAlpha,n.cosineSquaredAlpha,w,A,D,S);return _(t)?(t.longitude=this._start.longitude+O,t.latitude=E,t.height=0,t):new ce(this._start.longitude+O,E,0)};var t0=uE;function MN(e,t,n){if(e===0)return t*n;let r=e*e,o=r*r,a=o*r,s=a*r,u=s*r,l=u*r,c=n,f=Math.sin(2*c),h=Math.sin(4*c),d=Math.sin(6*c),p=Math.sin(8*c),g=Math.sin(10*c),y=Math.sin(12*c);return t*((1-r/4-3*o/64-5*a/256-175*s/16384-441*u/65536-4851*l/1048576)*c-(3*r/8+3*o/32+45*a/1024+105*s/4096+2205*u/131072+6237*l/524288)*f+(15*o/256+45*a/1024+525*s/16384+1575*u/65536+155925*l/8388608)*h-(35*a/3072+175*s/12288+3675*u/262144+13475*l/1048576)*d+(315*s/131072+2205*u/524288+43659*l/8388608)*p-(693*u/1310720+6237*l/5242880)*g+1001*l/8388608*y)}function uhe(e,t,n){let r=e/n;if(t===0)return r;let o=r*r,a=o*r,s=a*r,u=t,l=u*u,c=l*l,f=c*l,h=f*l,d=h*l,p=d*l,g=Math.sin(2*r),y=Math.cos(2*r),v=Math.sin(4*r),w=Math.cos(4*r),C=Math.sin(6*r),E=Math.cos(6*r),S=Math.sin(8*r),A=Math.cos(8*r),D=Math.sin(10*r),P=Math.cos(10*r),M=Math.sin(12*r);return r+r*l/4+7*r*c/64+15*r*f/256+579*r*h/16384+1515*r*d/65536+16837*r*p/1048576+(3*r*c/16+45*r*f/256-r*(32*o-561)*h/4096-r*(232*o-1677)*d/16384+r*(399985-90560*o+512*s)*p/5242880)*y+(21*r*f/256+483*r*h/4096-r*(224*o-1969)*d/16384-r*(33152*o-112599)*p/1048576)*w+(151*r*h/4096+4681*r*d/65536+1479*r*p/16384-453*a*p/32768)*E+(1097*r*d/65536+42783*r*p/1048576)*A+8011*r*p/1048576*P+(3*l/8+3*c/16+213*f/2048-3*o*f/64+255*h/4096-33*o*h/512+20861*d/524288-33*o*d/512+s*d/1024+28273*p/1048576-471*o*p/8192+9*s*p/4096)*g+(21*c/256+21*f/256+533*h/8192-21*o*h/512+197*d/4096-315*o*d/4096+584039*p/16777216-12517*o*p/131072+7*s*p/2048)*v+(151*f/6144+151*h/4096+5019*d/131072-453*o*d/16384+26965*p/786432-8607*o*p/131072)*C+(1097*h/131072+1097*d/65536+225797*p/10485760-1097*o*p/65536)*S+(8011*d/2621440+8011*p/1048576)*D+293393*p/251658240*M}function vC(e,t){if(e===0)return Math.log(Math.tan(.5*(z.PI_OVER_TWO+t)));let n=e*Math.sin(t);return Math.log(Math.tan(.5*(z.PI_OVER_TWO+t)))-e/2*Math.log((1+n)/(1-n))}function lhe(e,t,n,r,o){let a=vC(e._ellipticity,n),s=vC(e._ellipticity,o);return Math.atan2(z.negativePiToPi(r-t),s-a)}function che(e,t,n,r,o,a,s){let u=e._heading,l=a-r,c=0;if(z.equalsEpsilon(Math.abs(u),z.PI_OVER_TWO,z.EPSILON8))if(t===n)c=t*Math.cos(o)*z.negativePiToPi(l);else{let f=Math.sin(o);c=t*Math.cos(o)*z.negativePiToPi(l)/Math.sqrt(1-e._ellipticitySquared*f*f)}else{let f=MN(e._ellipticity,t,o);c=(MN(e._ellipticity,t,s)-f)/Math.cos(u)}return Math.abs(c)}var fhe=new x,PN=new x;function oH(e,t,n,r){let o=x.normalize(r.cartographicToCartesian(t,PN),fhe),a=x.normalize(r.cartographicToCartesian(n,PN),PN),s=r.maximumRadius,u=r.minimumRadius,l=s*s,c=u*u;e._ellipticitySquared=(l-c)/l,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=ce.clone(t,e._start),e._start.height=0,e._end=ce.clone(n,e._end),e._end.height=0,e._heading=lhe(e,t.longitude,t.latitude,n.longitude,n.latitude),e._distance=che(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude)}function aH(e,t,n,r,o,a){if(n===0)return ce.clone(e,a);let s=o*o,u,l,c;if(Math.abs(z.PI_OVER_TWO-Math.abs(t))>z.EPSILON8){let f=MN(o,r,e.latitude),h=n*Math.cos(t),d=f+h;l=uhe(d,o,r);let p=vC(o,e.latitude),g=vC(o,l);c=Math.tan(t)*(g-p),u=z.negativePiToPi(e.longitude+c)}else{l=e.latitude;let f;if(o===0)f=r*Math.cos(e.latitude);else{let h=Math.sin(e.latitude);f=r*Math.cos(e.latitude)/Math.sqrt(1-s*h*h)}c=n/f,t>0?u=z.negativePiToPi(e.longitude+c):u=z.negativePiToPi(e.longitude-c)}return _(a)?(a.longitude=u,a.latitude=l,a.height=0,a):new ce(u,l,0)}function Am(e,t,n){let r=T(n,Ge.WGS84);this._ellipsoid=r,this._start=new ce,this._end=new ce,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,_(e)&&_(t)&&oH(this,e,t,r)}Object.defineProperties(Am.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return this._heading}}});Am.fromStartHeadingDistance=function(e,t,n,r,o){let a=T(r,Ge.WGS84),s=a.maximumRadius,u=a.minimumRadius,l=s*s,c=u*u,f=Math.sqrt((l-c)/l);t=z.negativePiToPi(t);let h=aH(e,t,n,a.maximumRadius,f);return!_(o)||_(r)&&!r.equals(o.ellipsoid)?new Am(e,h,a):(o.setEndPoints(e,h),o)};Am.prototype.setEndPoints=function(e,t){oH(this,e,t,this._ellipsoid)};Am.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)};Am.prototype.interpolateUsingSurfaceDistance=function(e,t){return aH(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)};Am.prototype.findIntersectionWithLongitude=function(e,t){let n=this._ellipticity,r=this._heading,o=Math.abs(r),a=this._start;if(e=z.negativePiToPi(e),z.equalsEpsilon(Math.abs(e),Math.PI,z.EPSILON14)&&(e=z.sign(a.longitude)*Math.PI),_(t)||(t=new ce),Math.abs(z.PI_OVER_TWO-o)<=z.EPSILON8)return t.longitude=e,t.latitude=a.latitude,t.height=0,t;if(z.equalsEpsilon(Math.abs(z.PI_OVER_TWO-o),z.PI_OVER_TWO,z.EPSILON8))return z.equalsEpsilon(e,a.longitude,z.EPSILON12)?void 0:(t.longitude=e,t.latitude=z.PI_OVER_TWO*z.sign(z.PI_OVER_TWO-r),t.height=0,t);let s=a.latitude,u=n*Math.sin(s),l=Math.tan(.5*(z.PI_OVER_TWO+s))*Math.exp((e-a.longitude)/Math.tan(r)),c=(1+u)/(1-u),f=a.latitude,h;do{h=f;let d=n*Math.sin(h),p=(1+d)/(1-d);f=2*Math.atan(l*Math.pow(p/c,n/2))-z.PI_OVER_TWO}while(!z.equalsEpsilon(f,h,z.EPSILON12));return t.longitude=e,t.latitude=f,t.height=0,t};Am.prototype.findIntersectionWithLatitude=function(e,t){let n=this._ellipticity,r=this._heading,o=this._start;if(z.equalsEpsilon(Math.abs(r),z.PI_OVER_TWO,z.EPSILON8))return;let a=vC(n,o.latitude),s=vC(n,e),u=Math.tan(r)*(s-a),l=z.negativePiToPi(o.longitude+u);return _(t)?(t.longitude=l,t.latitude=e,t.height=0,t):new ce(l,e,0)};var up=Am;function hhe(e){e=T(e,T.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=T(e.normalize,!1),this.values=e.values}var xi=hhe;var LN={};LN.computeDiscriminant=function(e,t,n){return t*t-4*e*n};function sH(e,t,n){let r=e+t;return z.sign(e)!==z.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}LN.computeRealRoots=function(e,t,n){let r;if(e===0)return t===0?[]:[-n/t];if(t===0){if(n===0)return[0,0];let l=Math.abs(n),c=Math.abs(e);if(l<c&&l/c<z.EPSILON14)return[0,0];if(l>c&&c/l<z.EPSILON14)return[];if(r=-n/e,r<0)return[];let f=Math.sqrt(r);return[-f,f]}else if(n===0)return r=-t/e,r<0?[r,0]:[0,r];let o=t*t,a=4*e*n,s=sH(o,-a,z.EPSILON14);if(s<0)return[];let u=-.5*sH(t,z.sign(t)*Math.sqrt(s),z.EPSILON14);return t>0?[u/e,n/u]:[n/u,u/e]};var Ff=LN;var ON={};ON.computeDiscriminant=function(e,t,n,r){let o=e*e,a=t*t,s=n*n,u=r*r;return 18*e*t*n*r+a*s-27*o*u-4*(e*s*n+a*t*r)};function RN(e,t,n,r){let o=e,a=t/3,s=n/3,u=r,l=o*s,c=a*u,f=a*a,h=s*s,d=o*s-f,p=o*u-a*s,g=a*u-h,y=4*d*g-p*p,v,w;if(y<0){let te,oe,ue;f*c>=l*h?(te=o,oe=d,ue=-2*a*d+o*p):(te=u,oe=g,ue=-u*p+2*s*g);let me=-(ue<0?-1:1)*Math.abs(te)*Math.sqrt(-y);w=-ue+me;let st=w/2,ht=st<0?-Math.pow(-st,1/3):Math.pow(st,1/3),jt=w===me?-ht:-oe/ht;return v=oe<=0?ht+jt:-ue/(ht*ht+jt*jt+oe),f*c>=l*h?[(v-a)/o]:[-u/(v+s)]}let C=d,E=-2*a*d+o*p,S=g,A=-u*p+2*s*g,D=Math.sqrt(y),P=Math.sqrt(3)/2,M=Math.abs(Math.atan2(o*D,-E)/3);v=2*Math.sqrt(-C);let I=Math.cos(M);w=v*I;let O=v*(-I/2-P*Math.sin(M)),m=w+O>2*a?w-a:O-a,b=o,L=m/b;M=Math.abs(Math.atan2(u*D,-A)/3),v=2*Math.sqrt(-S),I=Math.cos(M),w=v*I,O=v*(-I/2-P*Math.sin(M));let R=-u,N=w+O<2*s?w+s:O+s,B=R/N,G=b*N,F=-m*N-b*R,k=m*R,Z=(s*F-a*k)/(-a*F+s*G);return L<=Z?L<=B?Z<=B?[L,Z,B]:[L,B,Z]:[B,L,Z]:L<=B?[Z,L,B]:Z<=B?[Z,B,L]:[B,Z,L]}ON.computeRealRoots=function(e,t,n,r){let o,a;if(e===0)return Ff.computeRealRoots(t,n,r);if(t===0){if(n===0){if(r===0)return[0,0,0];a=-r/e;let s=a<0?-Math.pow(-a,1/3):Math.pow(a,1/3);return[s,s,s]}else if(r===0)return o=Ff.computeRealRoots(e,0,n),o.Length===0?[0]:[o[0],0,o[1]];return RN(e,0,n,r)}else{if(n===0)return r===0?(a=-t/e,a<0?[a,0,0]:[0,0,a]):RN(e,t,0,r);if(r===0)return o=Ff.computeRealRoots(e,t,n),o.length===0?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]}return RN(e,t,n,r)};var SI=ON;var NN={};NN.computeDiscriminant=function(e,t,n,r,o){let a=e*e,s=a*e,u=t*t,l=u*t,c=n*n,f=c*n,h=r*r,d=h*r,p=o*o,g=p*o;return u*c*h-4*l*d-4*e*f*h+18*e*t*n*d-27*a*h*h+256*s*g+o*(18*l*n*r-4*u*f+16*e*c*c-80*e*t*c*r-6*e*u*h+144*a*n*h)+p*(144*e*u*n-27*u*u-128*a*c-192*a*t*r)};function nd(e,t,n,r){let o=e*e,a=t-3*o/8,s=n-t*e/2+o*e/8,u=r-n*e/4+t*o/16-3*o*o/256,l=SI.computeRealRoots(1,2*a,a*a-4*u,-s*s);if(l.length>0){let c=-e/4,f=l[l.length-1];if(Math.abs(f)<z.EPSILON14){let h=Ff.computeRealRoots(1,a,u);if(h.length===2){let d=h[0],p=h[1],g;if(d>=0&&p>=0){let y=Math.sqrt(d),v=Math.sqrt(p);return[c-v,c-y,c+y,c+v]}else{if(d>=0&&p<0)return g=Math.sqrt(d),[c-g,c+g];if(d<0&&p>=0)return g=Math.sqrt(p),[c-g,c+g]}}return[]}else if(f>0){let h=Math.sqrt(f),d=(a+f-s/h)/2,p=(a+f+s/h)/2,g=Ff.computeRealRoots(1,h,d),y=Ff.computeRealRoots(1,-h,p);return g.length!==0?(g[0]+=c,g[1]+=c,y.length!==0?(y[0]+=c,y[1]+=c,g[1]<=y[0]?[g[0],g[1],y[0],y[1]]:y[1]<=g[0]?[y[0],y[1],g[0],g[1]]:g[0]>=y[0]&&g[1]<=y[1]?[y[0],g[0],g[1],y[1]]:y[0]>=g[0]&&y[1]<=g[1]?[g[0],y[0],y[1],g[1]]:g[0]>y[0]&&g[0]<y[1]?[y[0],g[0],y[1],g[1]]:[g[0],y[0],g[1],y[1]]):g):y.length!==0?(y[0]+=c,y[1]+=c,y):[]}}return[]}function lE(e,t,n,r){let o=n*n,a=t*t,s=e*e,u=-2*t,l=n*e+a-4*r,c=s*r-n*t*e+o,f=SI.computeRealRoots(1,u,l,c);if(f.length>0){let h=f[0],d=t-h,p=d*d,g=e/2,y=d/2,v=p-4*r,w=p+4*Math.abs(r),C=s-4*h,E=s+4*Math.abs(h),S,A;if(h<0||v*E<C*w){let b=Math.sqrt(C);S=b/2,A=b===0?0:(e*y-n)/b}else{let b=Math.sqrt(v);S=b===0?0:(e*y-n)/b,A=b/2}let D,P;g===0&&S===0?(D=0,P=0):z.sign(g)===z.sign(S)?(D=g+S,P=h/D):(P=g-S,D=h/P);let M,I;y===0&&A===0?(M=0,I=0):z.sign(y)===z.sign(A)?(M=y+A,I=r/M):(I=y-A,M=r/I);let O=Ff.computeRealRoots(1,D,M),m=Ff.computeRealRoots(1,P,I);if(O.length!==0)return m.length!==0?O[1]<=m[0]?[O[0],O[1],m[0],m[1]]:m[1]<=O[0]?[m[0],m[1],O[0],O[1]]:O[0]>=m[0]&&O[1]<=m[1]?[m[0],O[0],O[1],m[1]]:m[0]>=O[0]&&m[1]<=O[1]?[O[0],m[0],m[1],O[1]]:O[0]>m[0]&&O[0]<m[1]?[m[0],O[0],m[1],O[1]]:[O[0],m[0],O[1],m[1]]:O;if(m.length!==0)return m}return[]}NN.computeRealRoots=function(e,t,n,r,o){if(Math.abs(e)<z.EPSILON15)return SI.computeRealRoots(t,n,r,o);let a=t/e,s=n/e,u=r/e,l=o/e,c=a<0?1:0;switch(c+=s<0?c+1:c,c+=u<0?c+1:c,c+=l<0?c+1:c,c){case 0:return nd(a,s,u,l);case 1:return lE(a,s,u,l);case 2:return lE(a,s,u,l);case 3:return nd(a,s,u,l);case 4:return nd(a,s,u,l);case 5:return lE(a,s,u,l);case 6:return nd(a,s,u,l);case 7:return nd(a,s,u,l);case 8:return lE(a,s,u,l);case 9:return nd(a,s,u,l);case 10:return nd(a,s,u,l);case 11:return lE(a,s,u,l);case 12:return nd(a,s,u,l);case 13:return nd(a,s,u,l);case 14:return nd(a,s,u,l);case 15:return nd(a,s,u,l);default:return}};var uH=NN;function AI(e,t){t=x.clone(T(t,x.ZERO)),x.equals(t,x.ZERO)||x.normalize(t,t),this.origin=x.clone(T(e,x.ZERO)),this.direction=t}AI.clone=function(e,t){if(!!_(e))return _(t)?(t.origin=x.clone(e.origin),t.direction=x.clone(e.direction),t):new AI(e.origin,e.direction)};AI.getPoint=function(e,t,n){return _(n)||(n=new x),n=x.multiplyByScalar(e.direction,t,n),x.add(e.origin,n,n)};var q_=AI;var No={};No.rayPlane=function(e,t,n){_(n)||(n=new x);let r=e.origin,o=e.direction,a=t.normal,s=x.dot(a,o);if(Math.abs(s)<z.EPSILON15)return;let u=(-t.distance-x.dot(a,r))/s;if(!(u<0))return n=x.multiplyByScalar(o,u,n),x.add(r,n,n)};var dhe=new x,phe=new x,gH=new x,lH=new x,cH=new x;No.rayTriangleParametric=function(e,t,n,r,o){o=T(o,!1);let a=e.origin,s=e.direction,u=x.subtract(n,t,dhe),l=x.subtract(r,t,phe),c=x.cross(s,l,gH),f=x.dot(u,c),h,d,p,g,y;if(o){if(f<z.EPSILON6||(h=x.subtract(a,t,lH),p=x.dot(h,c),p<0||p>f)||(d=x.cross(h,u,cH),g=x.dot(s,d),g<0||p+g>f))return;y=x.dot(l,d)/f}else{if(Math.abs(f)<z.EPSILON6)return;let v=1/f;if(h=x.subtract(a,t,lH),p=x.dot(h,c)*v,p<0||p>1||(d=x.cross(h,u,cH),g=x.dot(s,d)*v,g<0||p+g>1))return;y=x.dot(l,d)*v}return y};No.rayTriangle=function(e,t,n,r,o,a){let s=No.rayTriangleParametric(e,t,n,r,o);if(!(!_(s)||s<0))return _(a)||(a=new x),x.multiplyByScalar(e.direction,s,a),x.add(e.origin,a,a)};var mhe=new q_;No.lineSegmentTriangle=function(e,t,n,r,o,a,s){let u=mhe;x.clone(e,u.origin),x.subtract(t,e,u.direction),x.normalize(u.direction,u.direction);let l=No.rayTriangleParametric(u,n,r,o,a);if(!(!_(l)||l<0||l>x.distance(e,t)))return _(s)||(s=new x),x.multiplyByScalar(u.direction,l,s),x.add(u.origin,s,s)};function ghe(e,t,n,r){let o=t*t-4*e*n;if(o<0)return;if(o>0){let s=1/(2*e),u=Math.sqrt(o),l=(-t+u)*s,c=(-t-u)*s;return l<c?(r.root0=l,r.root1=c):(r.root0=c,r.root1=l),r}let a=-t/(2*e);if(a!==0)return r.root0=r.root1=a,r}var _he={root0:0,root1:0};function _H(e,t,n){_(n)||(n=new $d);let r=e.origin,o=e.direction,a=t.center,s=t.radius*t.radius,u=x.subtract(r,a,gH),l=x.dot(o,o),c=2*x.dot(o,u),f=x.magnitudeSquared(u)-s,h=ghe(l,c,f,_he);if(!!_(h))return n.start=h.root0,n.stop=h.root1,n}No.raySphere=function(e,t,n){if(n=_H(e,t,n),!(!_(n)||n.stop<0))return n.start=Math.max(n.start,0),n};var yhe=new q_;No.lineSegmentSphere=function(e,t,n,r){let o=yhe;x.clone(e,o.origin);let a=x.subtract(t,e,o.direction),s=x.magnitude(a);if(x.normalize(a,a),r=_H(o,n,r),!(!_(r)||r.stop<0||r.start>s))return r.start=Math.max(r.start,0),r.stop=Math.min(r.stop,s),r};var vhe=new x,Che=new x;No.rayEllipsoid=function(e,t){let n=t.oneOverRadii,r=x.multiplyComponents(n,e.origin,vhe),o=x.multiplyComponents(n,e.direction,Che),a=x.magnitudeSquared(r),s=x.dot(r,o),u,l,c,f,h;if(a>1){if(s>=0)return;let d=s*s;if(u=a-1,l=x.magnitudeSquared(o),c=l*u,d<c)return;if(d>c){f=s*s-c,h=-s+Math.sqrt(f);let g=h/l,y=u/h;return g<y?new $d(g,y):{start:y,stop:g}}let p=Math.sqrt(u/l);return new $d(p,p)}else if(a<1)return u=a-1,l=x.magnitudeSquared(o),c=l*u,f=s*s-c,h=-s+Math.sqrt(f),new $d(0,h/l);if(s<0)return l=x.magnitudeSquared(o),new $d(0,-s/l)};function W_(e,t,n){let r=e+t;return z.sign(e)!==z.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}function xhe(e,t,n,r,o){let a=r*r,s=o*o,u=(e[ne.COLUMN1ROW1]-e[ne.COLUMN2ROW2])*s,l=o*(r*W_(e[ne.COLUMN1ROW0],e[ne.COLUMN0ROW1],z.EPSILON15)+t.y),c=e[ne.COLUMN0ROW0]*a+e[ne.COLUMN2ROW2]*s+r*t.x+n,f=s*W_(e[ne.COLUMN2ROW1],e[ne.COLUMN1ROW2],z.EPSILON15),h=o*(r*W_(e[ne.COLUMN2ROW0],e[ne.COLUMN0ROW2])+t.z),d,p=[];if(h===0&&f===0){if(d=Ff.computeRealRoots(u,l,c),d.length===0)return p;let M=d[0],I=Math.sqrt(Math.max(1-M*M,0));if(p.push(new x(r,o*M,o*-I)),p.push(new x(r,o*M,o*I)),d.length===2){let O=d[1],m=Math.sqrt(Math.max(1-O*O,0));p.push(new x(r,o*O,o*-m)),p.push(new x(r,o*O,o*m))}return p}let g=h*h,y=f*f,v=u*u,w=h*f,C=v+y,E=2*(l*u+w),S=2*c*u+l*l-y+g,A=2*(c*l-w),D=c*c-g;if(C===0&&E===0&&S===0&&A===0)return p;d=uH.computeRealRoots(C,E,S,A,D);let P=d.length;if(P===0)return p;for(let M=0;M<P;++M){let I=d[M],O=I*I,m=Math.max(1-O,0),b=Math.sqrt(m),L;z.sign(u)===z.sign(c)?L=W_(u*O+c,l*I,z.EPSILON12):z.sign(c)===z.sign(l*I)?L=W_(u*O,l*I+c,z.EPSILON12):L=W_(u*O+l*I,c,z.EPSILON12);let R=W_(f*I,h,z.EPSILON15),N=L*R;N<0?p.push(new x(r,o*I,o*b)):N>0?p.push(new x(r,o*I,o*-b)):b!==0?(p.push(new x(r,o*I,o*-b)),p.push(new x(r,o*I,o*b)),++M):p.push(new x(r,o*I,o*b))}return p}var BN=new x,fH=new x,hH=new x,bI=new x,whe=new x,Ehe=new ne,The=new ne,She=new ne,Ahe=new ne,bhe=new ne,dH=new ne,pH=new ne,mH=new x,Ihe=new x,Dhe=new ce;No.grazingAltitudeLocation=function(e,t){let n=e.origin,r=e.direction;if(!x.equals(n,x.ZERO)){let D=t.geodeticSurfaceNormal(n,BN);if(x.dot(r,D)>=0)return n}let o=_(this.rayEllipsoid(e,t)),a=t.transformPositionToScaledSpace(r,BN),s=x.normalize(a,a),u=x.mostOrthogonalAxis(a,bI),l=x.normalize(x.cross(u,s,fH),fH),c=x.normalize(x.cross(s,l,hH),hH),f=Ehe;f[0]=s.x,f[1]=s.y,f[2]=s.z,f[3]=l.x,f[4]=l.y,f[5]=l.z,f[6]=c.x,f[7]=c.y,f[8]=c.z;let h=ne.transpose(f,The),d=ne.fromScale(t.radii,She),p=ne.fromScale(t.oneOverRadii,Ahe),g=bhe;g[0]=0,g[1]=-r.z,g[2]=r.y,g[3]=r.z,g[4]=0,g[5]=-r.x,g[6]=-r.y,g[7]=r.x,g[8]=0;let y=ne.multiply(ne.multiply(h,p,dH),g,dH),v=ne.multiply(ne.multiply(y,d,pH),f,pH),w=ne.multiplyByVector(y,n,whe),C=xhe(v,x.negate(w,BN),0,0,1),E,S,A=C.length;if(A>0){let D=x.clone(x.ZERO,Ihe),P=Number.NEGATIVE_INFINITY;for(let I=0;I<A;++I){E=ne.multiplyByVector(d,ne.multiplyByVector(f,C[I],mH),mH);let O=x.normalize(x.subtract(E,n,bI),bI),m=x.dot(O,r);m>P&&(P=m,D=x.clone(E,D))}let M=t.cartesianToCartographic(D,Dhe);return P=z.clamp(P,0,1),S=x.magnitude(x.subtract(D,n,bI))*Math.sqrt(1-P*P),S=o?-S:S,M.height=S,t.cartographicToCartesian(M,new x)}};var Phe=new x;No.lineSegmentPlane=function(e,t,n,r){_(r)||(r=new x);let o=x.subtract(t,e,Phe),a=n.normal,s=x.dot(a,o);if(Math.abs(s)<z.EPSILON6)return;let u=x.dot(a,e),l=-(n.distance+u)/s;if(!(l<0||l>1))return x.multiplyByScalar(o,l,r),x.add(e,r,r),r};No.trianglePlaneIntersection=function(e,t,n,r){let o=r.normal,a=r.distance,s=x.dot(o,e)+a<0,u=x.dot(o,t)+a<0,l=x.dot(o,n)+a<0,c=0;c+=s?1:0,c+=u?1:0,c+=l?1:0;let f,h;if((c===1||c===2)&&(f=new x,h=new x),c===1){if(s)return No.lineSegmentPlane(e,t,r,f),No.lineSegmentPlane(e,n,r,h),{positions:[e,t,n,f,h],indices:[0,3,4,1,2,4,1,4,3]};if(u)return No.lineSegmentPlane(t,n,r,f),No.lineSegmentPlane(t,e,r,h),{positions:[e,t,n,f,h],indices:[1,3,4,2,0,4,2,4,3]};if(l)return No.lineSegmentPlane(n,e,r,f),No.lineSegmentPlane(n,t,r,h),{positions:[e,t,n,f,h],indices:[2,3,4,0,1,4,0,4,3]}}else if(c===2)if(s)if(u){if(!l)return No.lineSegmentPlane(e,n,r,f),No.lineSegmentPlane(t,n,r,h),{positions:[e,t,n,f,h],indices:[0,1,4,0,4,3,2,3,4]}}else return No.lineSegmentPlane(n,t,r,f),No.lineSegmentPlane(e,t,r,h),{positions:[e,t,n,f,h],indices:[2,0,4,2,4,3,1,3,4]};else return No.lineSegmentPlane(t,e,r,f),No.lineSegmentPlane(n,e,r,h),{positions:[e,t,n,f,h],indices:[1,2,4,1,4,3,0,3,4]}};var Wc=No;var qN=[uc,gC],Mhe=qN.length,FH=Math.cos(z.toRadians(30)),yH=Math.cos(z.toRadians(150)),zH=0,VH=1e3;function r0(e){e=T(e,T.EMPTY_OBJECT);let t=e.positions;this.width=T(e.width,1),this._positions=t,this.granularity=T(e.granularity,9999),this.loop=T(e.loop,!1),this.arcType=T(e.arcType,Na.GEODESIC),this._ellipsoid=Ge.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(r0.prototype,{packedLength:{get:function(){return 1+this._positions.length*3+1+1+1+Ge.packedLength+1+1}}});r0.setProjectionAndEllipsoid=function(e,t){let n=0;for(let r=0;r<Mhe;r++)if(t instanceof qN[r]){n=r;break}e._projectionIndex=n,e._ellipsoid=t.ellipsoid};var Lhe=new x,vH=new x,CH=new x;function HN(e,t,n,r,o){let a=Dl(r,e,0,Lhe),s=Dl(r,e,n,vH),u=Dl(r,t,0,CH),l=bm(s,a,vH),c=bm(u,a,CH);return x.cross(c,l,o),x.normalize(o,o)}var Rhe=new ce,Ohe=new x,Nhe=new x,Bhe=new x;function FN(e,t,n,r,o,a,s,u,l,c,f){if(o===0)return;let h;a===Na.GEODESIC?h=new t0(e,t,s):a===Na.RHUMB&&(h=new up(e,t,s));let d=h.surfaceDistance;if(d<o)return;let p=HN(e,t,r,s,Bhe),g=Math.ceil(d/o),y=d/g,v=y,w=g-1,C=u.length;for(let E=0;E<w;E++){let S=h.interpolateUsingSurfaceDistance(v,Rhe),A=Dl(s,S,n,Ohe),D=Dl(s,S,r,Nhe);x.pack(p,u,C),x.pack(A,l,C),x.pack(D,c,C),f.push(S.latitude),f.push(S.longitude),C+=3,v+=y}}var zN=new ce;function Dl(e,t,n,r){return ce.clone(t,zN),zN.height=n,ce.toCartesian(zN,e,r)}r0.pack=function(e,t,n){let r=T(n,0),o=e._positions,a=o.length;t[r++]=a;for(let s=0;s<a;++s){let u=o[s];x.pack(u,t,r),r+=3}return t[r++]=e.granularity,t[r++]=e.loop?1:0,t[r++]=e.arcType,Ge.pack(e._ellipsoid,t,r),r+=Ge.packedLength,t[r++]=e._projectionIndex,t[r++]=e._scene3DOnly?1:0,t};r0.unpack=function(e,t,n){let r=T(t,0),o=e[r++],a=new Array(o);for(let d=0;d<o;d++)a[d]=x.unpack(e,r),r+=3;let s=e[r++],u=e[r++]===1,l=e[r++],c=Ge.unpack(e,r);r+=Ge.packedLength;let f=e[r++],h=e[r++]===1;return _(n)||(n=new r0({positions:a})),n._positions=a,n.granularity=s,n.loop=u,n.arcType=l,n._ellipsoid=c,n._projectionIndex=f,n._scene3DOnly=h,n};function bm(e,t,n){return x.subtract(e,t,n),x.normalize(n,n),n}function xH(e,t,n,r){return r=bm(e,t,r),r=x.cross(r,n,r),r=x.normalize(r,r),r=x.cross(n,r,r),r}var Fhe=new x,zhe=new x,Vhe=new x,kH=new x,khe=0,Ghe=-1;function VN(e,t,n,r,o){let a=bm(n,t,kH),s=xH(e,t,a,Fhe),u=xH(r,t,a,zhe);if(z.equalsEpsilon(x.dot(s,u),Ghe,z.EPSILON5))return o=x.cross(a,s,o),o=x.normalize(o,o),o;o=x.add(u,s,o),o=x.normalize(o,o);let l=x.cross(a,o,Vhe);return x.dot(u,l)<khe&&(o=x.negate(o,o)),o}var MI=oi.fromPointNormal(x.ZERO,x.UNIT_Y),Uhe=new x,Hhe=new x,qhe=new x,Whe=new x,Yhe=new x,II=new x,DI=new ce,wH=new ce,EH=new ce;r0.createGeometry=function(e){let t=!e._scene3DOnly,n=e.loop,r=e._ellipsoid,o=e.granularity,a=e.arcType,s=new qN[e._projectionIndex](r),u=zH,l=VH,c,f,h=e._positions,d=h.length;d===2&&(n=!1);let p,g,y,v,w=new up(void 0,void 0,r),C,E,S,A=[h[0]];for(f=0;f<d-1;f++)p=h[f],g=h[f+1],C=Wc.lineSegmentPlane(p,g,MI,II),_(C)&&!x.equalsEpsilon(C,p,z.EPSILON7)&&!x.equalsEpsilon(C,g,z.EPSILON7)&&(e.arcType===Na.GEODESIC?A.push(x.clone(C)):e.arcType===Na.RHUMB&&(S=r.cartesianToCartographic(C,DI).longitude,y=r.cartesianToCartographic(p,DI),v=r.cartesianToCartographic(g,wH),w.setEndPoints(y,v),E=w.findIntersectionWithLongitude(S,EH),C=r.cartographicToCartesian(E,II),_(C)&&!x.equalsEpsilon(C,p,z.EPSILON7)&&!x.equalsEpsilon(C,g,z.EPSILON7)&&A.push(x.clone(C)))),A.push(g);n&&(p=h[d-1],g=h[0],C=Wc.lineSegmentPlane(p,g,MI,II),_(C)&&!x.equalsEpsilon(C,p,z.EPSILON7)&&!x.equalsEpsilon(C,g,z.EPSILON7)&&(e.arcType===Na.GEODESIC?A.push(x.clone(C)):e.arcType===Na.RHUMB&&(S=r.cartesianToCartographic(C,DI).longitude,y=r.cartesianToCartographic(p,DI),v=r.cartesianToCartographic(g,wH),w.setEndPoints(y,v),E=w.findIntersectionWithLongitude(S,EH),C=r.cartographicToCartesian(E,II),_(C)&&!x.equalsEpsilon(C,p,z.EPSILON7)&&!x.equalsEpsilon(C,g,z.EPSILON7)&&A.push(x.clone(C)))));let D=A.length,P=new Array(D);for(f=0;f<D;f++){let oe=ce.fromCartesian(A[f],r);oe.height=0,P[f]=oe}if(P=yC(P,ce.equalsEpsilon),D=P.length,D<2)return;let M=[],I=[],O=[],m=[],b=Uhe,L=Hhe,R=qhe,N=Whe,B=Yhe,G=P[0],F=P[1],k=P[D-1];for(b=Dl(r,k,u,b),N=Dl(r,F,u,N),L=Dl(r,G,u,L),R=Dl(r,G,l,R),n?B=VN(b,L,R,N,B):B=HN(G,F,l,r,B),x.pack(B,I,0),x.pack(L,O,0),x.pack(R,m,0),M.push(G.latitude),M.push(G.longitude),FN(G,F,u,l,o,a,r,I,O,m,M),f=1;f<D-1;++f){b=x.clone(L,b),L=x.clone(N,L);let oe=P[f];Dl(r,oe,l,R),Dl(r,P[f+1],u,N),VN(b,L,R,N,B),c=I.length,x.pack(B,I,c),x.pack(L,O,c),x.pack(R,m,c),M.push(oe.latitude),M.push(oe.longitude),FN(P[f],P[f+1],u,l,o,a,r,I,O,m,M)}let Z=P[D-1],te=P[D-2];if(L=Dl(r,Z,u,L),R=Dl(r,Z,l,R),n){let oe=P[0];b=Dl(r,te,u,b),N=Dl(r,oe,u,N),B=VN(b,L,R,N,B)}else B=HN(te,Z,l,r,B);if(c=I.length,x.pack(B,I,c),x.pack(L,O,c),x.pack(R,m,c),M.push(Z.latitude),M.push(Z.longitude),n){for(FN(Z,G,u,l,o,a,r,I,O,m,M),c=I.length,f=0;f<3;++f)I[c+f]=I[f],O[c+f]=O[f],m[c+f]=m[f];M.push(G.latitude),M.push(G.longitude)}return yde(n,s,O,m,I,M,t)};var Xhe=new x,jhe=new ne,Khe=new je;function TH(e,t,n,r){let o=bm(n,t,Xhe),a=x.dot(o,e);if(a>FH||a<yH){let s=bm(r,n,kH),u=a<yH?z.PI_OVER_TWO:-z.PI_OVER_TWO,l=je.fromAxisAngle(s,u,Khe),c=ne.fromQuaternion(l,jhe);return ne.multiplyByVector(c,e,e),!0}return!1}var SH=new ce,Zhe=new x,AH=new x;function cE(e,t,n,r,o){let a=ce.toCartesian(t,e._ellipsoid,Zhe),s=x.add(a,n,AH),u=!1,l=e._ellipsoid,c=l.cartesianToCartographic(s,SH);Math.abs(t.longitude-c.longitude)>z.PI_OVER_TWO&&(u=!0,s=x.subtract(a,n,AH),c=l.cartesianToCartographic(s,SH)),c.height=0;let f=e.project(c,o);return o=x.subtract(f,r,o),o.z=0,o=x.normalize(o,o),u&&x.negate(o,o),o}var Qhe=new x,bH=new x;function IH(e,t,n,r,o,a){let s=x.subtract(t,e,Qhe);x.normalize(s,s);let u=n-zH,l=x.multiplyByScalar(s,u,bH);x.add(e,l,o);let c=r-VH;l=x.multiplyByScalar(s,c,bH),x.add(t,l,a)}var Jhe=new x;function PI(e,t){let n=oi.getPointDistance(MI,e),r=oi.getPointDistance(MI,t),o=Jhe;z.equalsEpsilon(n,0,z.EPSILON2)?(o=bm(t,e,o),x.multiplyByScalar(o,z.EPSILON2,o),x.add(e,o,e)):z.equalsEpsilon(r,0,z.EPSILON2)&&(o=bm(e,t,o),x.multiplyByScalar(o,z.EPSILON2,o),x.add(t,o,t))}function $he(e,t){let n=Math.abs(e.longitude),r=Math.abs(t.longitude);if(z.equalsEpsilon(n,z.PI,z.EPSILON11)){let o=z.sign(t.longitude);return e.longitude=o*(n-z.EPSILON11),1}else if(z.equalsEpsilon(r,z.PI,z.EPSILON11)){let o=z.sign(e.longitude);return t.longitude=o*(r-z.EPSILON11),2}return 0}var GH=new ce,UH=new ce,DH=new x,kN=new x,PH=new x,MH=new x,ede=new x,LH=new x,tde=[GH,UH],nde=new ln,rde=new x,ide=new x,ode=new x,ade=new x,sde=new x,ude=new x,GN=new x,UN=new x,lde=new x,cde=new x,fde=new x,RH=new x,hde=new x,dde=new x,pde=new ei,mde=new ei,OH=new x,gde=new x,NH=new x,_de=[new Ee,new Ee],HH=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],BH=HH.length;function yde(e,t,n,r,o,a,s){let u,l,c=t._ellipsoid,f=n.length/3-1,h=f*8,d=h*4,p=f*36,g=h>65535?new Uint32Array(p):new Uint16Array(p),y=new Float64Array(h*3),v=new Float32Array(d),w=new Float32Array(d),C=new Float32Array(d),E=new Float32Array(d),S=new Float32Array(d),A,D,P,M;s&&(A=new Float32Array(d),D=new Float32Array(d),P=new Float32Array(d),M=new Float32Array(h*2));let I=a.length/2,O=0,m=GH;m.height=0;let b=UH;b.height=0;let L=DH,R=kN;if(s)for(l=0,u=1;u<I;u++)m.latitude=a[l],m.longitude=a[l+1],b.latitude=a[l+2],b.longitude=a[l+3],L=t.project(m,L),R=t.project(b,R),O+=x.distance(L,R),l+=2;let N=r.length/3;R=x.unpack(r,0,R);let B=0;for(l=3,u=1;u<N;u++)L=x.clone(R,L),R=x.unpack(r,l,R),B+=x.distance(L,R),l+=3;let G;l=3;let F=0,k=0,Z=0,te=0,oe=!1,ue=x.unpack(n,0,MH),pe=x.unpack(r,0,kN),me=x.unpack(o,0,LH);if(e){let zi=x.unpack(n,n.length-6,PH);TH(me,zi,ue,pe)&&(me=x.negate(me,me))}let st=0,ht=0,jt=0;for(u=0;u<f;u++){let zi=x.clone(ue,PH),at=x.clone(pe,DH),Sn=x.clone(me,ede);oe&&(Sn=x.negate(Sn,Sn)),ue=x.unpack(n,l,MH),pe=x.unpack(r,l,kN),me=x.unpack(o,l,LH),oe=TH(me,zi,ue,pe),m.latitude=a[F],m.longitude=a[F+1],b.latitude=a[F+2],b.longitude=a[F+3];let fa,Tu,Gh,Uh;if(s){let no=$he(m,b);fa=t.project(m,sde),Tu=t.project(b,ude);let Yd=bm(Tu,fa,OH);Yd.y=Math.abs(Yd.y),Gh=GN,Uh=UN,no===0||x.dot(Yd,x.UNIT_Y)>FH?(Gh=cE(t,m,Sn,fa,GN),Uh=cE(t,b,me,Tu,UN)):no===1?(Uh=cE(t,b,me,Tu,UN),Gh.x=0,Gh.y=z.sign(m.longitude-Math.abs(b.longitude)),Gh.z=0):(Gh=cE(t,m,Sn,fa,GN),Uh.x=0,Uh.y=z.sign(m.longitude-b.longitude),Uh.z=0)}let KA=x.distance(at,pe),Fv=ei.fromCartesian(zi,pde),Wd=x.subtract(ue,zi,lde),Bg=x.normalize(Wd,RH),Sf=x.subtract(at,zi,cde);Sf=x.normalize(Sf,Sf);let lm=x.cross(Bg,Sf,RH);lm=x.normalize(lm,lm);let x_=x.cross(Sf,Sn,hde);x_=x.normalize(x_,x_);let w_=x.subtract(pe,ue,fde);w_=x.normalize(w_,w_);let Fg=x.cross(me,w_,dde);Fg=x.normalize(Fg,Fg);let ZA=KA/B,Dw=st/B,E_=0,ac,cm,Hh,fm=0,QA=0;if(s){E_=x.distance(fa,Tu),ac=ei.fromCartesian(fa,mde),cm=x.subtract(Tu,fa,OH),Hh=x.normalize(cm,gde);let no=Hh.x;Hh.x=Hh.y,Hh.y=-no,fm=E_/O,QA=ht/O}for(G=0;G<8;G++){let no=te+G*4,Yd=k+G*2,T_=no+3,Af=G<4?1:-1,zg=G===2||G===3||G===6||G===7?1:-1;x.pack(Fv.high,v,no),v[T_]=Wd.x,x.pack(Fv.low,w,no),w[T_]=Wd.y,x.pack(x_,C,no),C[T_]=Wd.z,x.pack(Fg,E,no),E[T_]=ZA*Af,x.pack(lm,S,no);let Xd=Dw*zg;Xd===0&&zg<0&&(Xd=9),S[T_]=Xd,s&&(A[no]=ac.high.x,A[no+1]=ac.high.y,A[no+2]=ac.low.x,A[no+3]=ac.low.y,P[no]=-Gh.y,P[no+1]=Gh.x,P[no+2]=Uh.y,P[no+3]=-Uh.x,D[no]=cm.x,D[no+1]=cm.y,D[no+2]=Hh.x,D[no+3]=Hh.y,M[Yd]=fm*Af,Xd=QA*zg,Xd===0&&zg<0&&(Xd=9),M[Yd+1]=Xd)}let qh=ode,to=ade,Yu=rde,Wh=ide,JA=ln.fromCartographicArray(tde,nde),zv=Hc.getMinimumMaximumHeights(JA,c),Vv=zv.minimumTerrainHeight,kv=zv.maximumTerrainHeight;jt+=Vv,jt+=kv,IH(zi,at,Vv,kv,qh,Yu),IH(ue,pe,Vv,kv,to,Wh);let Yh=x.multiplyByScalar(lm,z.EPSILON5,NH);x.add(qh,Yh,qh),x.add(to,Yh,to),x.add(Yu,Yh,Yu),x.add(Wh,Yh,Wh),PI(qh,to),PI(Yu,Wh),x.pack(qh,y,Z),x.pack(to,y,Z+3),x.pack(Wh,y,Z+6),x.pack(Yu,y,Z+9),Yh=x.multiplyByScalar(lm,-2*z.EPSILON5,NH),x.add(qh,Yh,qh),x.add(to,Yh,to),x.add(Yu,Yh,Yu),x.add(Wh,Yh,Wh),PI(qh,to),PI(Yu,Wh),x.pack(qh,y,Z+12),x.pack(to,y,Z+15),x.pack(Wh,y,Z+18),x.pack(Yu,y,Z+21),F+=2,l+=3,k+=16,Z+=24,te+=32,st+=KA,ht+=E_}l=0;let Ct=0;for(u=0;u<f;u++){for(G=0;G<BH;G++)g[l+G]=HH[G]+Ct;Ct+=8,l+=BH}let bt=_de;Ee.fromVertices(n,x.ZERO,3,bt[0]),Ee.fromVertices(r,x.ZERO,3,bt[1]);let mn=Ee.fromBoundingSpheres(bt);mn.radius+=jt/(f*2);let Tn={position:new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,normalize:!1,values:y}),startHiAndForwardOffsetX:n0(v),startLoAndForwardOffsetY:n0(w),startNormalAndForwardOffsetZ:n0(C),endNormalAndTextureCoordinateNormalizationX:n0(E),rightNormalAndTextureCoordinateNormalizationY:n0(S)};return s&&(Tn.startHiLo2D=n0(A),Tn.offsetAndRight2D=n0(D),Tn.startEndNormals2D=n0(P),Tn.texcoordNormalization2D=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,normalize:!1,values:M})),new Ci({attributes:Tn,indices:g,boundingSphere:mn})}function n0(e){return new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}r0._projectNormal=cE;var qH=r0;var WH=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main(void)
{
float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));
vec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);
if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
eyeCoordinate /= eyeCoordinate.w;
float halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);
float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);
float distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);
float distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);
if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec3 alignedPlaneNormal;
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);
s = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;
float t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, t);
materialInput.str = vec3(s, t, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
gl_FragColor.rgb *= gl_FragColor.a;
czm_writeDepthClamp();
}
`;var YH=`varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
float rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {
return (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);
}
void main(void)
{
vec4 eyeCoordinate = gl_FragCoord;
eyeCoordinate /= eyeCoordinate.w;
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);
float distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);
distanceFromStart = max(0.0, distanceFromStart);
distanceFromEnd = max(0.0, distanceFromEnd);
float s = distanceFromStart / (distanceFromStart + distanceFromEnd);
s = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, v_texcoordT);
materialInput.str = vec3(s, v_texcoordT, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
}
`;var XH=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
attribute float batchId;
varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
void main()
{
v_batchId = batchId;
vec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));
vec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);
vec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
vec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
vec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec4 startPlane2D;
vec4 startPlane3D;
startPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlane2D.w = -dot(startPlane2D.xyz, posEc2D);
startPlane3D.w = -dot(startPlane3D.xyz, posEc3D);
vec4 rightPlane2D;
vec4 rightPlane3D;
rightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
rightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
rightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);
rightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);
posRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);
posRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);
posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));
vec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));
vec4 endPlane2D;
vec4 endPlane3D;
endPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlane2D.w = -dot(endPlane2D.xyz, posEc2D);
endPlane3D.w = -dot(endPlane3D.xyz, posEc3D);
v_forwardDirectionEC = normalize(endEC - startEC);
vec2 cleanTexcoordNormalization2D;
cleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);
cleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));
vec2 cleanTexcoordNormalization3D;
cleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
cleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;
cleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));
v_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#else // PER_INSTANCE_COLOR
v_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);
v_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);
#endif // PER_INSTANCE_COLOR
#ifdef WIDTH_VARYING
float width = czm_batchTable_width(batchId);
float halfWidth = width * 0.5;
v_width = width;
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#else
float halfWidth = 0.5 * czm_batchTable_width(batchId);
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#endif
vec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);
float absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);
vec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
vec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));
geodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc3D.xyz += geodeticSurfaceNormal;
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
positionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;
vec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);
absStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));
absEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));
planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);
upOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));
normalEC = normalize(cross(planeDirection, upOrDown));
geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));
geodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc2D.xyz += geodeticSurfaceNormal;
normalEC *= sign(texcoordNormalization2D.x);
#ifndef PER_INSTANCE_COLOR
v_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);
#endif
positionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;
gl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var jH=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
#ifndef COLUMBUS_VIEW_2D
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
#else
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
#endif
attribute float batchId;
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main()
{
#ifdef COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;
vec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);
vec3 ecEnd = forwardDirectionEC + ecStart;
forwardDirectionEC = normalize(forwardDirectionEC);
v_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
vec4 startPlaneEC;
startPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);
v_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;
#else // COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;
vec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);
vec3 ecEnd = ecStart + offset;
vec3 forwardDirectionEC = normalize(offset);
vec4 startPlaneEC;
startPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
v_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
v_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;
#endif // COLUMBUS_VIEW_2D
v_endEcAndStartEcX.xyz = ecEnd;
v_endEcAndStartEcX.w = ecStart.x;
v_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif // PER_INSTANCE_COLOR
vec4 positionRelativeToEye = czm_computePosition();
vec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;
float absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);
vec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
upOrDown = cross(forwardDirectionEC, normalEC);
upOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;
upOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;
upOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;
positionEC.xyz += upOrDown;
v_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));
float width = czm_batchTable_width(batchId);
#ifdef WIDTH_VARYING
v_width = width;
#endif
v_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;
v_startPlaneNormalEcAndHalfWidth.w = width * 0.5;
v_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;
v_endPlaneNormalEcAndBatchId.w = batchId;
width = width * max(0.0, czm_metersPerPixel(positionEC));
width = width / dot(normalEC, v_rightPlaneEC.xyz);
#ifdef COLUMBUS_VIEW_2D
normalEC *= sign(texcoordNormalization2D.x);
#else
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
#endif
positionEC.xyz += width * normalEC;
gl_Position = czm_depthClamp(czm_projection * positionEC);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var KH={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2};KH.NUMBER_OF_CLASSIFICATION_TYPES=3;var ka=Object.freeze(KH);var vde={FRONT:V.FRONT,BACK:V.BACK,FRONT_AND_BACK:V.FRONT_AND_BACK},rd=Object.freeze(vde);function Ga(e){e=T(e,T.EMPTY_OBJECT),this.position=T(e.position,!1),this.normal=T(e.normal,!1),this.st=T(e.st,!1),this.bitangent=T(e.bitangent,!1),this.tangent=T(e.tangent,!1),this.color=T(e.color,!1)}Ga.POSITION_ONLY=Object.freeze(new Ga({position:!0}));Ga.POSITION_AND_NORMAL=Object.freeze(new Ga({position:!0,normal:!0}));Ga.POSITION_NORMAL_AND_ST=Object.freeze(new Ga({position:!0,normal:!0,st:!0}));Ga.POSITION_AND_ST=Object.freeze(new Ga({position:!0,st:!0}));Ga.POSITION_AND_COLOR=Object.freeze(new Ga({position:!0,color:!0}));Ga.ALL=Object.freeze(new Ga({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0}));Ga.DEFAULT=Ga.POSITION_NORMAL_AND_ST;Ga.packedLength=6;Ga.pack=function(e,t,n){return n=T(n,0),t[n++]=e.position?1:0,t[n++]=e.normal?1:0,t[n++]=e.st?1:0,t[n++]=e.tangent?1:0,t[n++]=e.bitangent?1:0,t[n]=e.color?1:0,t};Ga.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Ga),n.position=e[t++]===1,n.normal=e[t++]===1,n.st=e[t++]===1,n.tangent=e[t++]===1,n.bitangent=e[t++]===1,n.color=e[t]===1,n};Ga.clone=function(e,t){if(!!_(e))return _(t)||(t=new Ga),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var go=Ga;var LI=`varying vec4 v_color;
void main()
{
gl_FragColor = czm_gammaCorrect(v_color);
}
`;var ZH=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_color = color;
}
`;var RI=`void clipLineSegmentToNearPlane(
vec3 p0,
vec3 p1,
out vec4 positionWC,
out bool clipped,
out bool culledByNearPlane,
out vec4 clippedPositionEC)
{
culledByNearPlane = false;
clipped = false;
vec3 p0ToP1 = p1 - p0;
float magnitude = length(p0ToP1);
vec3 direction = normalize(p0ToP1);
float endPoint0Distance =  czm_currentFrustum.x + p0.z;
float denominator = -direction.z;
if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)
{
culledByNearPlane = true;
}
else if (endPoint0Distance > 0.0)
{
float t = endPoint0Distance / denominator;
if (t < 0.0 || t > magnitude)
{
culledByNearPlane = true;
}
else
{
p0 = p0 + t * direction;
p0.z = min(p0.z, -czm_currentFrustum.x);
clipped = true;
}
}
clippedPositionEC = vec4(p0, 1.0);
positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);
}
vec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)
{
#ifdef POLYLINE_DASH
vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);
vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);
vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);
vec2 lineDir;
if (usePrevious) {
lineDir = normalize(positionWindow.xy - previousWindow.xy);
}
else {
lineDir = normalize(nextWindow.xy - positionWindow.xy);
}
angle = atan(lineDir.x, lineDir.y) - 1.570796327;
angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;
#endif
vec4 clippedPrevWC, clippedPrevEC;
bool prevSegmentClipped, prevSegmentCulled;
clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);
vec4 clippedNextWC, clippedNextEC;
bool nextSegmentClipped, nextSegmentCulled;
clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);
bool segmentClipped, segmentCulled;
vec4 clippedPositionWC, clippedPositionEC;
clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);
if (segmentCulled)
{
return vec4(0.0, 0.0, 0.0, 1.0);
}
vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);
vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);
if (prevSegmentCulled)
{
directionToPrevWC = -directionToNextWC;
}
else if (nextSegmentCulled)
{
directionToNextWC = -directionToPrevWC;
}
vec2 thisSegmentForwardWC, otherSegmentForwardWC;
if (usePrevious)
{
thisSegmentForwardWC = -directionToPrevWC;
otherSegmentForwardWC = directionToNextWC;
}
else
{
thisSegmentForwardWC = directionToNextWC;
otherSegmentForwardWC =  -directionToPrevWC;
}
vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);
vec2 leftWC = thisSegmentLeftWC;
float expandWidth = width * 0.5;
if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))
{
vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);
vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;
float leftSumLength = length(leftSumWC);
leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);
vec2 u = -thisSegmentForwardWC;
vec2 v = leftWC;
float sinAngle = abs(u.x * v.y - u.y * v.x);
expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);
}
vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;
return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;
}
vec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)
{
vec4 positionEC = czm_modelViewRelativeToEye * position;
vec4 prevEC = czm_modelViewRelativeToEye * previous;
vec4 nextEC = czm_modelViewRelativeToEye * next;
return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);
}
`;function CC(e){e=T(e,T.EMPTY_OBJECT),this.material=e.material,this.translucent=T(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=T(e.closed,!1)}Object.defineProperties(CC.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});CC.prototype.getFragmentShaderSource=function(){let e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),_(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join(`
`)};CC.prototype.isTranslucent=function(){return _(this.material)&&this.material.isTranslucent()||!_(this.material)&&this.translucent};CC.prototype.getRenderState=function(){let e=this.isTranslucent(),t=kt(this.renderState,!1);return e?(t.depthMask=!1,t.blending=za.ALPHA_BLEND):t.depthMask=!0,t};CC.getDefaultRenderState=function(e,t,n){let r={depthTest:{enabled:!0}};return e&&(r.depthMask=!1,r.blending=za.ALPHA_BLEND),t&&(r.cull={enabled:!0,face:rd.BACK}),_(n)&&(r=Yi(n,r,!0)),r};var Pl=CC;var WN=`${RI}
${ZH}`,Cde=LI;Qo.isInternetExplorer()||(WN=`#define CLIP_POLYLINE 
${WN}`);function Y_(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=!1,r=Y_.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,WN),this._fragmentShaderSource=T(e.fragmentShaderSource,Cde),this._renderState=Pl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}Object.defineProperties(Y_.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});Y_.VERTEX_FORMAT=go.POSITION_ONLY;Y_.prototype.getFragmentShaderSource=Pl.prototype.getFragmentShaderSource;Y_.prototype.isTranslucent=Pl.prototype.isTranslucent;Y_.prototype.getRenderState=Pl.prototype.getRenderState;var YN=Y_;var QH=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec2 st;
attribute float batchId;
varying float v_width;
varying vec2 v_st;
varying float v_polylineAngle;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_width = width;
v_st.s = st.s;
v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);
v_polylineAngle = angle;
}
`;var JH=`#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_st;
void main()
{
czm_materialInput materialInput;
vec2 st = v_st;
st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);
materialInput.s = st.s;
materialInput.st = st;
materialInput.str = vec3(st, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#ifdef VECTOR_TILE
gl_FragColor *= u_highlightColor;
#endif
czm_writeLogDepth();
}
`;function xC(e,t,n,r,o){this._format=e,this._datatype=t,this._width=n,this._height=r,this._buffer=o}Object.defineProperties(xC.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}});xC.clone=function(e){if(!!_(e))return new xC(e._format,e._datatype,e._width,e._height,e._buffer)};xC.prototype.clone=function(){return xC.clone(this)};var OI=xC;function Im(){}Im._transcodeTaskProcessor=new Gc("transcodeKTX2",Number.POSITIVE_INFINITY);Im._readyPromise=void 0;function xde(){let e=Im._transcodeTaskProcessor.initWebAssemblyModule({modulePath:"ThirdParty/Workers/basis_transcoder.js",wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then(function(){return Im._transcodeTaskProcessor});Im._readyPromise=e}Im.transcode=function(e,t){return _(Im._readyPromise)||xde(),Im._readyPromise.then(function(n){let r;if(e instanceof ArrayBuffer){let o=new Uint8Array(e);return r={supportedTargetFormats:t,ktx2Buffer:o},n.scheduleTask(r,[e])}return r={supportedTargetFormats:t,ktx2Buffer:e},n.scheduleTask(r,[e.buffer])}).then(function(n){let r=n.length,o=Object.keys(n[0]),a=o.length,s;for(s=0;s<r;s++){let u=n[s];for(let l=0;l<a;l++){let c=u[o[l]];u[o[l]]=new OI(c.internalFormat,c.datatype,c.width,c.height,c.levelBuffer)}}if(a===1){for(s=0;s<r;++s)n[s]=n[s][o[0]];r===1&&(n=n[0])}return n}).catch(function(n){throw n})};var $H=Im;var eq;tq.setKTX2SupportedFormats=function(e,t,n,r,o,a){eq={s3tc:e,pvrtc:t,astc:n,etc:r,etc1:o,bc7:a}};function tq(e){let t;return e instanceof ArrayBuffer||ArrayBuffer.isView(e)?t=Promise.resolve(e):t=_t.createIfNeeded(e).fetchArrayBuffer(),t.then(function(n){return $H.transcode(n,eq)})}var Dm=tq;function NI(e,t,n,r,o,a,s,u,l,c,f){this._context=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelDatatype=s,this._internalFormat=o,this._pixelFormat=a,this._size=u,this._preMultiplyAlpha=l,this._flipY=c,this._initialized=f}Object.defineProperties(NI.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});NI.prototype.copyFrom=function(e){let t=T(e.xOffset,0),n=T(e.yOffset,0),r=e.source,o=this._context._gl,a=this._textureTarget,s=this._targetFace;o.activeTexture(o.TEXTURE0),o.bindTexture(a,this._texture);let u=r.width,l=r.height,c=r.arrayBufferView,f=this._size,h=this._pixelFormat,d=this._internalFormat,p=this._pixelDatatype,g=this._preMultiplyAlpha,y=this._flipY,v=T(e.skipColorSpaceConversion,!1),w=4;_(c)&&(w=Gt.alignmentInBytes(h,p,u)),o.pixelStorei(o.UNPACK_ALIGNMENT,w),v?o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE):o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.BROWSER_DEFAULT_WEBGL);let C=!1;if(!this._initialized){if(t===0&&n===0&&u===f&&l===f)_(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),y&&(c=Gt.flipY(c,h,p,f,f)),o.texImage2D(s,0,d,f,f,0,h,vt.toWebGLConstant(p,this._context),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,y),o.texImage2D(s,0,d,h,vt.toWebGLConstant(p,this._context),r)),C=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);let E=Gt.createTypedArray(h,p,f,f);o.texImage2D(s,0,d,f,f,0,h,vt.toWebGLConstant(p,this._context),E)}this._initialized=!0}C||(_(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),y&&(c=Gt.flipY(c,h,p,u,l)),o.texSubImage2D(s,0,t,n,u,l,h,vt.toWebGLConstant(p,this._context),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,y),o.texSubImage2D(s,0,t,n,h,vt.toWebGLConstant(p,this._context),r))),o.bindTexture(a,null)};NI.prototype.copyFromFramebuffer=function(e,t,n,r,o,a){e=T(e,0),t=T(t,0),n=T(n,0),r=T(r,0),o=T(o,this._size),a=T(a,this._size);let s=this._context._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(this._targetFace,0,e,t,n,r,o,a),s.bindTexture(u,null),this._initialized=!0};var X_=NI;function fE(e){e=T(e,T.EMPTY_OBJECT);let t=e.context,n=e.source,r,o;if(_(n)){let C=[n.positiveX,n.negativeX,n.positiveY,n.negativeY,n.positiveZ,n.negativeZ];r=C[0].width,o=C[0].height}else r=e.width,o=e.height;let a=r,s=T(e.pixelDatatype,vt.UNSIGNED_BYTE),u=T(e.pixelFormat,Gt.RGBA),l=Gt.toInternalFormat(u,s,t),c=Gt.textureSizeInBytes(u,s,a,a)*6,f=e.preMultiplyAlpha||u===Gt.RGB||u===Gt.LUMINANCE,h=T(e.flipY,!0),d=T(e.skipColorSpaceConversion,!1),p=t._gl,g=p.TEXTURE_CUBE_MAP,y=p.createTexture();p.activeTexture(p.TEXTURE0),p.bindTexture(g,y);function v(C,E,S,A,D){let P=E.arrayBufferView;_(P)||(P=E.bufferView);let M=4;_(P)&&(M=Gt.alignmentInBytes(u,s,r)),p.pixelStorei(p.UNPACK_ALIGNMENT,M),D?p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE):p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.BROWSER_DEFAULT_WEBGL),_(P)?(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1),A&&(P=Gt.flipY(P,u,s,a,a)),p.texImage2D(C,0,l,a,a,0,u,vt.toWebGLConstant(s,t),P)):(p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,S),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,A),p.texImage2D(C,0,l,u,vt.toWebGLConstant(s,t),E))}_(n)?(v(p.TEXTURE_CUBE_MAP_POSITIVE_X,n.positiveX,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_X,n.negativeX,f,h,d),v(p.TEXTURE_CUBE_MAP_POSITIVE_Y,n.positiveY,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,n.negativeY,f,h,d),v(p.TEXTURE_CUBE_MAP_POSITIVE_Z,n.positiveZ,f,h,d),v(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,n.negativeZ,f,h,d)):(p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_X,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null),p.texImage2D(p.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l,a,a,0,u,vt.toWebGLConstant(s,t),null)),p.bindTexture(g,null),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g,this._texture=y,this._pixelFormat=u,this._pixelDatatype=s,this._size=a,this._hasMipmap=!1,this._sizeInBytes=c,this._preMultiplyAlpha=f,this._flipY=h,this._sampler=void 0;let w=_(n);this._positiveX=new X_(t,y,g,p.TEXTURE_CUBE_MAP_POSITIVE_X,l,u,s,a,f,h,w),this._negativeX=new X_(t,y,g,p.TEXTURE_CUBE_MAP_NEGATIVE_X,l,u,s,a,f,h,w),this._positiveY=new X_(t,y,g,p.TEXTURE_CUBE_MAP_POSITIVE_Y,l,u,s,a,f,h,w),this._negativeY=new X_(t,y,g,p.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,u,s,a,f,h,w),this._positiveZ=new X_(t,y,g,p.TEXTURE_CUBE_MAP_POSITIVE_Z,l,u,s,a,f,h,w),this._negativeZ=new X_(t,y,g,p.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,u,s,a,f,h,w),this.sampler=_(e.sampler)?e.sampler:new La}Object.defineProperties(fE.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,n=e.magnificationFilter,r=t===bn.NEAREST_MIPMAP_NEAREST||t===bn.NEAREST_MIPMAP_LINEAR||t===bn.LINEAR_MIPMAP_NEAREST||t===bn.LINEAR_MIPMAP_LINEAR,o=this._context,a=this._pixelDatatype;(a===vt.FLOAT&&!o.textureFloatLinear||a===vt.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(t=r?bn.NEAREST_MIPMAP_NEAREST:bn.NEAREST,n=Of.NEAREST);let s=o._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.texParameteri(u,s.TEXTURE_MIN_FILTER,t),s.texParameteri(u,s.TEXTURE_MAG_FILTER,n),s.texParameteri(u,s.TEXTURE_WRAP_S,e.wrapS),s.texParameteri(u,s.TEXTURE_WRAP_T,e.wrapT),_(this._textureFilterAnisotropic)&&s.texParameteri(u,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),s.bindTexture(u,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});fE.prototype.generateMipmap=function(e){e=T(e,Jb.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)};fE.prototype.isDestroyed=function(){return!1};fE.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=ot(this._positiveX),this._negativeX=ot(this._negativeX),this._positiveY=ot(this._positiveY),this._negativeY=ot(this._negativeY),this._positiveZ=ot(this._positiveZ),this._negativeZ=ot(this._negativeZ),ot(this)};var hE=fE;var nq=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var rq=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec2 centerPixel = fract(repeat * st);
float centerBump = texture2D(image, centerPixel).channel;
float imageWidth = float(imageDimensions.x);
vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));
float rightBump = texture2D(image, rightPixel).channel;
float imageHeight = float(imageDimensions.y);
vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));
float topBump = texture2D(image, leftPixel).channel;
vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
material.diffuse = vec3(0.01);
return material;
}
`;var iq=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);
float scaledWidth = fract(repeat.s * st.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(repeat.t * st.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value = min(scaledWidth, scaledHeight);
vec4 currentColor = mix(lightColor, darkColor, b);
vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var oq=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));
vec4 color = mix(lightColor, darkColor, b);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var aq=`uniform sampler2D heights;
uniform sampler2D colors;
float getHeight(int idx, float invTexSize)
{
vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);
#ifdef OES_texture_float
return texture2D(heights, uv).x;
#else
return czm_unpackFloat(texture2D(heights, uv));
#endif
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float height = materialInput.height;
float invTexSize = 1.0 / float(heightsDimensions.x);
float minHeight = getHeight(0, invTexSize);
float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);
if (height < minHeight || height > maxHeight) {
material.diffuse = vec3(0.0);
material.alpha = 0.0;
return material;
}
int idxBelow = 0;
int idxAbove = heightsDimensions.x;
float heightBelow = minHeight;
float heightAbove = maxHeight;
const int maxIterations = 16;
for (int i = 0; i < maxIterations; i++) {
if (idxBelow >= idxAbove - 1) {
break;
}
int idxMid = (idxBelow + idxAbove) / 2;
float heightTex = getHeight(idxMid, invTexSize);
if (height > heightTex) {
idxBelow = idxMid;
heightBelow = heightTex;
} else {
idxAbove = idxMid;
heightAbove = heightTex;
}
}
float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);
vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);
vec4 color = texture2D(colors, colorUv);
if (color.a > 0.0)
{
color.rgb /= color.a;
}
color.rgb = czm_gammaCorrect(color.rgb);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var sq=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float spacing;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float distanceToContour = mod(materialInput.height, spacing);
#ifdef GL_OES_standard_derivatives
float dxc = abs(dFdx(materialInput.height));
float dyc = abs(dFdy(materialInput.height));
float dF = max(dxc, dyc) * czm_pixelRatio * width;
float alpha = (distanceToContour < dF) ? 1.0 : 0.0;
#else
float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;
#endif
vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var uq=`uniform sampler2D image;
uniform float minimumHeight;
uniform float maximumHeight;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);
vec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var lq=`uniform vec4 fadeInColor;
uniform vec4 fadeOutColor;
uniform float maximumDistance;
uniform bool repeat;
uniform vec2 fadeDirection;
uniform vec2 time;
float getTime(float t, float coord)
{
float scalar = 1.0 / maximumDistance;
float q  = distance(t, coord) * scalar;
if (repeat)
{
float r = distance(t, coord + 1.0) * scalar;
float s = distance(t, coord - 1.0) * scalar;
q = min(min(r, s), q);
}
return clamp(q, 0.0, 1.0);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float s = getTime(time.x, st.s) * fadeDirection.s;
float t = getTime(time.y, st.t) * fadeDirection.t;
float u = length(vec2(s, t));
vec4 color = mix(fadeInColor, fadeOutColor, u);
color = czm_gammaCorrect(color);
material.emission = color.rgb;
material.alpha = color.a;
return material;
}
`;var cq=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float cellAlpha;
uniform vec2 lineCount;
uniform vec2 lineThickness;
uniform vec2 lineOffset;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value;
#ifdef GL_OES_standard_derivatives
const float fuzz = 1.2;
vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;
vec2 dx = abs(dFdx(st));
vec2 dy = abs(dFdy(st));
vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;
value = min(
smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),
smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));
#else
const float fuzz = 0.05;
vec2 range = 0.5 - (lineThickness * 0.05);
value = min(
1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),
1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));
#endif
float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));
float sRim = smoothstep(0.8, 1.0, dRim);
value *= (1.0 - sRim);
vec4 halfColor;
halfColor.rgb = color.rgb * 0.5;
halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));
halfColor = czm_gammaCorrect(halfColor);
material.diffuse = halfColor.rgb;
material.emission = halfColor.rgb;
material.alpha = halfColor.a;
return material;
}
`;var fq=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 textureValue = texture2D(image, fract(repeat * materialInput.st));
vec3 normalTangentSpace = textureValue.channels;
normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;
normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);
normalTangentSpace = normalize(normalTangentSpace);
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
return material;
}
`;var hq=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
float getPointOnLine(vec2 p0, vec2 p1, float x)
{
float slope = (p0.y - p1.y) / (p0.x - p1.x);
return slope * (x - p0.x) + p0.y;
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
#ifdef GL_OES_standard_derivatives
float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;
#else
float base = 0.975;
#endif
vec2 center = vec2(1.0, 0.5);
float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);
float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);
float halfWidth = 0.15;
float s = step(0.5 - halfWidth, st.t);
s *= 1.0 - step(0.5 + halfWidth, st.t);
s *= 1.0 - step(base, st.s);
float t = step(base, materialInput.st.s);
t *= 1.0 - step(ptOnUpperLine, st.t);
t *= step(ptOnLowerLine, st.t);
float dist;
if (st.s < base)
{
float d1 = abs(st.t - (0.5 - halfWidth));
float d2 = abs(st.t - (0.5 + halfWidth));
dist = min(d1, d2);
}
else
{
float d1 = czm_infinity;
if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)
{
d1 = abs(st.s - base);
}
float d2 = abs(st.t - ptOnUpperLine);
float d3 = abs(st.t - ptOnLowerLine);
dist = min(min(d1, d2), d3);
}
vec4 outsideColor = vec4(0.0);
vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));
vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var dq=`uniform vec4 color;
uniform vec4 gapColor;
uniform float dashLength;
uniform float dashPattern;
varying float v_polylineAngle;
const float maskLength = 16.0;
mat2 rotate(float rad) {
float c = cos(rad);
float s = sin(rad);
return mat2(
c, s,
-s, c
);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;
float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));
float maskIndex = floor(dashPosition * maskLength);
float maskTest = floor(dashPattern / pow(2.0, maskIndex));
vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;
if (fragColor.a < 0.005) {
discard;
}
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var pq=`uniform vec4 color;
uniform float glowPower;
uniform float taperPower;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);
if (taperPower <= 0.99999) {
glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));
}
vec4 fragColor;
fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);
fragColor.a = clamp(0.0, 1.0, glow) * color.a;
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var mq=`uniform vec4 color;
uniform vec4 outlineColor;
uniform float outlineWidth;
varying float v_width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;
float b = step(0.5 - halfInteriorWidth, st.t);
b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);
float d1 = abs(st.t - (0.5 - halfInteriorWidth));
float d2 = abs(st.t - (0.5 + halfInteriorWidth));
float dist = min(d1, d2);
vec4 currentColor = mix(outlineColor, color, b);
vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var gq=`uniform vec4 color;
uniform vec4 rimColor;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));
float s = smoothstep(1.0 - width, 1.0, d);
vec4 outColor = czm_gammaCorrect(color);
vec4 outRimColor = czm_gammaCorrect(rimColor);
material.diffuse = outColor.rgb;
material.emission = outRimColor.rgb * s;
material.alpha = mix(outColor.a, outRimColor.a, s);
return material;
}
`;var _q=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var yq=`uniform vec4 evenColor;
uniform vec4 oddColor;
uniform float offset;
uniform float repeat;
uniform bool horizontal;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));
float value = fract((coord - offset) * (repeat * 0.5));
float dist = min(value, min(abs(value - 0.5), 1.0 - value));
vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));
vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var vq=`uniform sampler2D specularMap;
uniform sampler2D normalMap;
uniform vec4 baseWaterColor;
uniform vec4 blendColor;
uniform float frequency;
uniform float animationSpeed;
uniform float amplitude;
uniform float specularIntensity;
uniform float fadeFactor;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float time = czm_frameNumber * animationSpeed;
float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);
float specularMapValue = texture2D(specularMap, materialInput.st).r;
vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);
vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));
normalTangentSpace.xy /= fade;
normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);
normalTangentSpace = normalize(normalTangentSpace);
float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);
material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;
material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);
material.diffuse += (0.1 * tsPerturbationRatio);
material.diffuse = material.diffuse;
material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);
material.specular = specularIntensity;
material.shininess = 10.0;
return material;
}
`;function Ce(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=T(e.minificationFilter,bn.LINEAR),this._magnificationFilter=T(e.magnificationFilter,Of.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,wde(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),_(Ce._uniformList[this.type])||(Ce._uniformList[this.type]=Object.keys(this._uniforms))}Ce._uniformList={};Ce.fromType=function(e,t){let n=new Ce({fabric:{type:e}});if(_(t))for(let r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n};Ce.prototype.isTranslucent=function(){if(_(this.translucent))return typeof this.translucent=="function"?this.translucent():this.translucent;let e=!0,t=this._translucentFunctions,n=t.length;for(let r=0;r<n;++r){let o=t[r];if(typeof o=="function"?e=e&&o():e=e&&o,!e)break}return e};Ce.prototype.update=function(e){this._defaultTexture=e.defaultTexture;let t,n,r=this._loadedImages,o=r.length;for(t=0;t<o;++t){let l=r[t];n=l.id;let c=l.image,f;Array.isArray(c)&&(f=c.slice(1,c.length).map(function(y){return y.bufferView}),c=c[0]);let h=new La({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter}),d;_(c.internalFormat)?d=new $o({context:e,pixelFormat:c.internalFormat,width:c.width,height:c.height,source:{arrayBufferView:c.bufferView,mipLevels:f},sampler:h}):d=new $o({context:e,source:c,sampler:h});let p=this._textures[n];_(p)&&p!==this._defaultTexture&&p.destroy(),this._textures[n]=d;let g=`${n}Dimensions`;if(this.uniforms.hasOwnProperty(g)){let y=this.uniforms[g];y.x=d._width,y.y=d._height}}r.length=0;let a=this._loadedCubeMaps;for(o=a.length,t=0;t<o;++t){let l=a[t];n=l.id;let c=l.images,f=new hE({context:e,source:{positiveX:c[0],negativeX:c[1],positiveY:c[2],negativeY:c[3],positiveZ:c[4],negativeZ:c[5]},sampler:new La({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[n]=f}a.length=0;let s=this._updateFunctions;for(o=s.length,t=0;t<o;++t)s[t](this,e);let u=this.materials;for(let l in u)u.hasOwnProperty(l)&&u[l].update(e)};Ce.prototype.isDestroyed=function(){return!1};Ce.prototype.destroy=function(){let e=this._textures;for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];r!==this._defaultTexture&&r.destroy()}let t=this.materials;for(let n in t)t.hasOwnProperty(n)&&t[n].destroy();return ot(this)};function wde(e,t){e=T(e,T.EMPTY_OBJECT),t._strict=T(e.strict,!1),t._count=T(e.count,0),t._template=kt(T(e.fabric,T.EMPTY_OBJECT)),t._template.uniforms=kt(T(t._template.uniforms,T.EMPTY_OBJECT)),t._template.materials=kt(T(t._template.materials,T.EMPTY_OBJECT)),t.type=_(t._template.type)?t._template.type:_i(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];let n,r=Ce._materialCache.getMaterial(t.type);if(_(r)){let a=kt(r.fabric,!0);t._template=Yi(t._template,a,!0),n=r.translucent}Ade(t),_(r)||Ce._materialCache.addMaterial(t.type,t),Ide(t),Lde(t),Ode(t);let o=t._translucentFunctions.length===0?!0:void 0;if(n=T(n,o),n=T(e.translucent,n),_(n))if(typeof n=="function"){let a=function(){return n(t)};t._translucentFunctions.push(a)}else t._translucentFunctions.push(n)}function XN(e,t,n,r){if(_(e)){for(let o in e)if(e.hasOwnProperty(o)){let a=t.indexOf(o)!==-1;(r&&!a||!r&&a)&&n(o,t)}}}function Cq(e,t){}function Ede(e,t){}var Tde=["type","materials","uniforms","components","source"],Sde=["diffuse","specular","shininess","normal","emission","alpha"];function Ade(e){let t=e._template,n=t.uniforms,r=t.materials,o=t.components;XN(t,Tde,Cq,!0),XN(o,Sde,Cq,!0);let a=[];for(let s in r)r.hasOwnProperty(s)&&a.push(s);XN(n,a,Ede,!1)}function bde(e,t){let n=t._template.materials;for(let r in n)if(n.hasOwnProperty(r)&&e.indexOf(r)>-1)return!0;return!1}function Ide(e){let t=e._template.components,n=e._template.source;if(_(n))e.shaderSource+=`${n}
`;else{if(e.shaderSource+=`czm_material czm_getMaterial(czm_materialInput materialInput)
{
`,e.shaderSource+=`czm_material material = czm_getDefaultMaterial(materialInput);
`,_(t)){let r=Object.keys(e._template.materials).length>0;for(let o in t)if(t.hasOwnProperty(o))if(o==="diffuse"||o==="emission"){let s=r&&bde(t[o],e)?t[o]:`czm_gammaCorrect(${t[o]})`;e.shaderSource+=`material.${o} = ${s}; 
`}else o==="alpha"?e.shaderSource+=`material.alpha = ${t.alpha}; 
`:e.shaderSource+=`material.${o} = ${t[o]};
`}e.shaderSource+=`return material;
}
`}}var xq={mat2:Ma,mat3:ne,mat4:U},Dde=/\.ktx2$/i;function Pde(e){let t;return function(n,r){let o=n.uniforms,a=o[e],s=t!==a,u=!_(a)||a===Ce.DefaultImageId;t=a;let l=n._textures[e],c,f;if(a instanceof HTMLVideoElement){if(a.readyState>=2){if(s&&_(l)&&(l!==r.defaultTexture&&l.destroy(),l=void 0),!_(l)||l===r.defaultTexture){let d=new La({minificationFilter:n._minificationFilter,magnificationFilter:n._magnificationFilter});l=new $o({context:r,source:a,sampler:d}),n._textures[e]=l;return}l.copyFrom({source:a})}else _(l)||(n._textures[e]=r.defaultTexture);return}if(a instanceof $o&&a!==l){n._texturePaths[e]=void 0;let d=n._textures[e];_(d)&&d!==n._defaultTexture&&d.destroy(),n._textures[e]=a,c=`${e}Dimensions`,o.hasOwnProperty(c)&&(f=o[c],f.x=a._width,f.y=a._height);return}if(s&&_(l)&&u&&(l!==n._defaultTexture&&l.destroy(),l=void 0),_(l)||(n._texturePaths[e]=void 0,l=n._textures[e]=n._defaultTexture,c=`${e}Dimensions`,o.hasOwnProperty(c)&&(f=o[c],f.x=l._width,f.y=l._height)),u)return;let h=a instanceof _t;if(!_(n._texturePaths[e])||h&&a.url!==n._texturePaths[e].url||!h&&a!==n._texturePaths[e]){if(typeof a=="string"||h){let d=h?a:_t.createIfNeeded(a),p;Dde.test(d.url)?p=Dm(d.url):p=d.fetchImage(),Promise.resolve(p).then(function(g){n._loadedImages.push({id:e,image:g})}).catch(function(){_(l)&&l!==n._defaultTexture&&l.destroy(),n._textures[e]=n._defaultTexture})}else(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:a});n._texturePaths[e]=a}}}function Mde(e){return function(t,n){let r=t.uniforms[e];if(r instanceof hE){let a=t._textures[e];a!==t._defaultTexture&&a.destroy(),t._texturePaths[e]=void 0,t._textures[e]=r;return}if(_(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),r===Ce.DefaultCubeMapId)return;let o=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(o!==t._texturePaths[e]){let a=[_t.createIfNeeded(r.positiveX).fetchImage(),_t.createIfNeeded(r.negativeX).fetchImage(),_t.createIfNeeded(r.positiveY).fetchImage(),_t.createIfNeeded(r.negativeY).fetchImage(),_t.createIfNeeded(r.positiveZ).fetchImage(),_t.createIfNeeded(r.negativeZ).fetchImage()];Promise.all(a).then(function(s){t._loadedCubeMaps.push({id:e,images:s})}),t._texturePaths[e]=o}}}function Lde(e){let t=e._template.uniforms;for(let n in t)t.hasOwnProperty(n)&&wq(e,n)}function wq(e,t){let n=e._strict,r=e._template.uniforms,o=r[t],a=Rde(o),s;if(a==="channels")s=dE(e,t,o,!1);else{if(a==="sampler2D"){let c=`${t}Dimensions`;Nde(e,c)>0&&(r[c]={type:"ivec3",x:1,y:1},wq(e,c))}if(!new RegExp(`uniform\\s+${a}\\s+${t}\\s*;`).test(e.shaderSource)){let c=`uniform ${a} ${t};`;e.shaderSource=c+e.shaderSource}let l=`${t}_${e._count++}`;if(s=dE(e,t,l),e.uniforms[t]=o,a==="sampler2D")e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(Pde(t));else if(a==="samplerCube")e._uniforms[l]=function(){return e._textures[t]},e._updateFunctions.push(Mde(t));else if(a.indexOf("mat")!==-1){let c=new xq[a];e._uniforms[l]=function(){return xq[a].fromColumnMajorArray(e.uniforms[t],c)}}else e._uniforms[l]=function(){return e.uniforms[t]}}}function Rde(e){let t=e.type;if(!_(t)){let n=typeof e;if(n==="number")t="float";else if(n==="boolean")t="bool";else if(n==="string"||e instanceof _t||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)/^([rgba]){1,4}$/i.test(e)?t="channels":e===Ce.DefaultCubeMapId?t="samplerCube":t="sampler2D";else if(n==="object")if(Array.isArray(e))(e.length===4||e.length===9||e.length===16)&&(t=`mat${Math.sqrt(e.length)}`);else{let r=0;for(let o in e)e.hasOwnProperty(o)&&(r+=1);r>=2&&r<=4?t=`vec${r}`:r===6&&(t="samplerCube")}}return t}function Ode(e){let t=e._strict,n=e._template.materials;for(let r in n)if(n.hasOwnProperty(r)){let o=new Ce({strict:t,fabric:n[r],count:e._count});e._count=o._count,e._uniforms=Yi(e._uniforms,o._uniforms,!0),e.materials[r]=o,e._translucentFunctions=e._translucentFunctions.concat(o._translucentFunctions);let a="czm_getMaterial",s=`${a}_${e._count++}`;dE(o,a,s),e.shaderSource=o.shaderSource+e.shaderSource;let u=`${s}(materialInput)`,l=dE(e,r,u)}}function dE(e,t,n,r){r=T(r,!0);let o=0,a="([\\w])?",s=`([\\w${r?".":""}])?`,u=new RegExp(s+t+a,"g");return e.shaderSource=e.shaderSource.replace(u,function(l,c,f){return c||f?l:(o+=1,n)}),o}function Nde(e,t,n){return dE(e,t,t,n)}Ce._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}};Ce.DefaultImageId="czm_defaultImage";Ce.DefaultCubeMapId="czm_defaultCubeMap";Ce.ColorType="Color";Ce._materialCache.addMaterial(Ce.ColorType,{fabric:{type:Ce.ColorType,uniforms:{color:new K(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});Ce.ImageType="Image";Ce._materialCache.addMaterial(Ce.ImageType,{fabric:{type:Ce.ImageType,uniforms:{image:Ce.DefaultImageId,repeat:new X(1,1),color:new K(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}});Ce.DiffuseMapType="DiffuseMap";Ce._materialCache.addMaterial(Ce.DiffuseMapType,{fabric:{type:Ce.DiffuseMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",repeat:new X(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});Ce.AlphaMapType="AlphaMap";Ce._materialCache.addMaterial(Ce.AlphaMapType,{fabric:{type:Ce.AlphaMapType,uniforms:{image:Ce.DefaultImageId,channel:"a",repeat:new X(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0});Ce.SpecularMapType="SpecularMap";Ce._materialCache.addMaterial(Ce.SpecularMapType,{fabric:{type:Ce.SpecularMapType,uniforms:{image:Ce.DefaultImageId,channel:"r",repeat:new X(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1});Ce.EmissionMapType="EmissionMap";Ce._materialCache.addMaterial(Ce.EmissionMapType,{fabric:{type:Ce.EmissionMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",repeat:new X(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});Ce.BumpMapType="BumpMap";Ce._materialCache.addMaterial(Ce.BumpMapType,{fabric:{type:Ce.BumpMapType,uniforms:{image:Ce.DefaultImageId,channel:"r",strength:.8,repeat:new X(1,1)},source:rq},translucent:!1});Ce.NormalMapType="NormalMap";Ce._materialCache.addMaterial(Ce.NormalMapType,{fabric:{type:Ce.NormalMapType,uniforms:{image:Ce.DefaultImageId,channels:"rgb",strength:.8,repeat:new X(1,1)},source:fq},translucent:!1});Ce.GridType="Grid";Ce._materialCache.addMaterial(Ce.GridType,{fabric:{type:Ce.GridType,uniforms:{color:new K(0,1,0,1),cellAlpha:.1,lineCount:new X(8,8),lineThickness:new X(1,1),lineOffset:new X(0,0)},source:cq},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}});Ce.StripeType="Stripe";Ce._materialCache.addMaterial(Ce.StripeType,{fabric:{type:Ce.StripeType,uniforms:{horizontal:!0,evenColor:new K(1,1,1,.5),oddColor:new K(0,0,1,.5),offset:0,repeat:5},source:yq},translucent:function(e){let t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}});Ce.CheckerboardType="Checkerboard";Ce._materialCache.addMaterial(Ce.CheckerboardType,{fabric:{type:Ce.CheckerboardType,uniforms:{lightColor:new K(1,1,1,.5),darkColor:new K(0,0,0,.5),repeat:new X(5,5)},source:iq},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});Ce.DotType="Dot";Ce._materialCache.addMaterial(Ce.DotType,{fabric:{type:Ce.DotType,uniforms:{lightColor:new K(1,1,0,.75),darkColor:new K(0,1,1,.75),repeat:new X(5,5)},source:oq},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}});Ce.WaterType="Water";Ce._materialCache.addMaterial(Ce.WaterType,{fabric:{type:Ce.WaterType,uniforms:{baseWaterColor:new K(.2,.3,.6,1),blendColor:new K(0,1,.699,1),specularMap:Ce.DefaultImageId,normalMap:Ce.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:vq},translucent:function(e){let t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}});Ce.RimLightingType="RimLighting";Ce._materialCache.addMaterial(Ce.RimLightingType,{fabric:{type:Ce.RimLightingType,uniforms:{color:new K(1,0,0,.7),rimColor:new K(1,1,1,.4),width:.3},source:gq},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}});Ce.FadeType="Fade";Ce._materialCache.addMaterial(Ce.FadeType,{fabric:{type:Ce.FadeType,uniforms:{fadeInColor:new K(1,0,0,1),fadeOutColor:new K(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new X(.5,.5)},source:lq},translucent:function(e){let t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}});Ce.PolylineArrowType="PolylineArrow";Ce._materialCache.addMaterial(Ce.PolylineArrowType,{fabric:{type:Ce.PolylineArrowType,uniforms:{color:new K(1,1,1,1)},source:hq},translucent:!0});Ce.PolylineDashType="PolylineDash";Ce._materialCache.addMaterial(Ce.PolylineDashType,{fabric:{type:Ce.PolylineDashType,uniforms:{color:new K(1,0,1,1),gapColor:new K(0,0,0,0),dashLength:16,dashPattern:255},source:dq},translucent:!0});Ce.PolylineGlowType="PolylineGlow";Ce._materialCache.addMaterial(Ce.PolylineGlowType,{fabric:{type:Ce.PolylineGlowType,uniforms:{color:new K(0,.5,1,1),glowPower:.25,taperPower:1},source:pq},translucent:!0});Ce.PolylineOutlineType="PolylineOutline";Ce._materialCache.addMaterial(Ce.PolylineOutlineType,{fabric:{type:Ce.PolylineOutlineType,uniforms:{color:new K(1,1,1,1),outlineColor:new K(1,0,0,1),outlineWidth:1},source:mq},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}});Ce.ElevationContourType="ElevationContour";Ce._materialCache.addMaterial(Ce.ElevationContourType,{fabric:{type:Ce.ElevationContourType,uniforms:{spacing:100,color:new K(1,0,0,1),width:1},source:sq},translucent:!1});Ce.ElevationRampType="ElevationRamp";Ce._materialCache.addMaterial(Ce.ElevationRampType,{fabric:{type:Ce.ElevationRampType,uniforms:{image:Ce.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:uq},translucent:!1});Ce.SlopeRampMaterialType="SlopeRamp";Ce._materialCache.addMaterial(Ce.SlopeRampMaterialType,{fabric:{type:Ce.SlopeRampMaterialType,uniforms:{image:Ce.DefaultImageId},source:_q},translucent:!1});Ce.AspectRampMaterialType="AspectRamp";Ce._materialCache.addMaterial(Ce.AspectRampMaterialType,{fabric:{type:Ce.AspectRampMaterialType,uniforms:{image:Ce.DefaultImageId},source:nq},translucent:!1});Ce.ElevationBandType="ElevationBand";Ce._materialCache.addMaterial(Ce.ElevationBandType,{fabric:{type:Ce.ElevationBandType,uniforms:{heights:Ce.DefaultImageId,colors:Ce.DefaultImageId},source:aq},translucent:!0});var pE=Ce;var jN=`${RI}
${QH}`,Bde=JH;Qo.isInternetExplorer()||(jN=`#define CLIP_POLYLINE 
${jN}`);function j_(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=!1,r=j_.VERTEX_FORMAT;this.material=_(e.material)?e.material:pE.fromType(pE.ColorType),this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,jN),this._fragmentShaderSource=T(e.fragmentShaderSource,Bde),this._renderState=Pl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}Object.defineProperties(j_.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&(e=`#define POLYLINE_DASH
${e}`),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});j_.VERTEX_FORMAT=go.POSITION_AND_ST;j_.prototype.getFragmentShaderSource=Pl.prototype.getFragmentShaderSource;j_.prototype.isTranslucent=Pl.prototype.isTranslucent;j_.prototype.getRenderState=Pl.prototype.getRenderState;var Eq=j_;function Fde(e){e=T(e,T.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}var i0=Fde;var zde={NONE:0,TOP:1,ALL:2},KN=Object.freeze(zde);function Vde(e,t){let n=[],r=e.length,o=0;for(;o<r;){let a=Math.ceil((r-o)/t--);n.push(e.slice(o,o+a)),o+=a}return n}var Tq=Vde;function Pm(e,t,n){if(this._attributes=t,this._numberOfInstances=n,t.length===0)return;let r=kde(t),o=e.floatingPointTexture,a=r===vt.FLOAT&&!o,s=Gde(t,a),u=Ude(s,t,a),l=Math.floor(Kt.maximumTextureSize/u),c=Math.min(n,l),f=u*c,h=Math.ceil(n/c),d=1/f,p=d*.5,g=1/h,y=g*.5;this._textureDimensions=new X(f,h),this._textureStep=new Se(d,p,g,y),this._pixelDatatype=a?vt.UNSIGNED_BYTE:r,this._packFloats=a,this._offsets=s,this._stride=u,this._texture=void 0;let v=4*f*h;this._batchValues=r===vt.FLOAT&&!a?new Float32Array(v):new Uint8Array(v),this._batchValuesDirty=!1}Object.defineProperties(Pm.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function kde(e){let t=!1,n=e.length;for(let r=0;r<n;++r)if(e[r].componentDatatype!==ie.UNSIGNED_BYTE){t=!0;break}return t?vt.FLOAT:vt.UNSIGNED_BYTE}function Aq(e,t){let n=e[t].componentsPerAttribute;return n===2?X:n===3?x:n===4?Se:Number}function Gde(e,t){let n=new Array(e.length),r=0,o=e.length;for(let a=0;a<o;++a){let u=e[a].componentDatatype;n[a]=r,u!==ie.UNSIGNED_BYTE&&t?r+=4:++r}return n}function Ude(e,t,n){let r=e.length,o=e[r-1];return t[r-1].componentDatatype!==ie.UNSIGNED_BYTE&&n?o+4:o+1}var mE=new Se;function Hde(e,t,n){let r=Se.unpack(e,t,mE),o=Se.unpackFloat(r);r=Se.unpack(e,t+4,mE);let a=Se.unpackFloat(r);r=Se.unpack(e,t+8,mE);let s=Se.unpackFloat(r);r=Se.unpack(e,t+12,mE);let u=Se.unpackFloat(r);return Se.fromElements(o,a,s,u,n)}function qde(e,t,n){let r=Se.packFloat(e.x,mE);Se.pack(r,t,n),r=Se.packFloat(e.y,r),Se.pack(r,t,n+4),r=Se.packFloat(e.z,r),Se.pack(r,t,n+8),r=Se.packFloat(e.w,r),Se.pack(r,t,n+12)}var Sq=new Se;Pm.prototype.getBatchedAttribute=function(e,t,n){let r=this._attributes,o=this._offsets[t],a=this._stride,s=4*a*e+4*o,u;this._packFloats&&r[t].componentDatatype!==vt.UNSIGNED_BYTE?u=Hde(this._batchValues,s,Sq):u=Se.unpack(this._batchValues,s,Sq);let l=Aq(r,t);return _(l.fromCartesian4)?l.fromCartesian4(u,n):_(l.clone)?l.clone(u,n):u.x};var Wde=[void 0,void 0,new X,new x,new Se],Yde=new Se;Pm.prototype.setBatchedAttribute=function(e,t,n){let r=this._attributes,o=Wde[r[t].componentsPerAttribute],a=this.getBatchedAttribute(e,t,o),s=Aq(this._attributes,t);if(_(s.equals)?s.equals(a,n):a===n)return;let l=Yde;l.x=_(n.x)?n.x:n,l.y=_(n.y)?n.y:0,l.z=_(n.z)?n.z:0,l.w=_(n.w)?n.w:0;let c=this._offsets[t],f=this._stride,h=4*f*e+4*c;this._packFloats&&r[t].componentDatatype!==vt.UNSIGNED_BYTE?qde(l,this._batchValues,h):Se.pack(l,this._batchValues,h),this._batchValuesDirty=!0};function Xde(e,t){let n=e._textureDimensions;e._texture=new $o({context:t,pixelFormat:Gt.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:La.NEAREST,flipY:!1})}function jde(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}Pm.prototype.update=function(e){_(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,_(this._texture)||Xde(this,e.context),jde(this))};Pm.prototype.getUniformMapCallback=function(){let e=this;return function(t){return e._attributes.length===0?t:Yi(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}};function Kde(e){let t=e._stride;return e._textureDimensions.y===1?`uniform vec4 batchTextureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float numberOfAttributes = float(${t}); 
    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); 
} 
`:`uniform vec4 batchTextureStep; 
uniform vec2 batchTextureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float stepY = batchTextureStep.z; 
    float centerY = batchTextureStep.w; 
    float numberOfAttributes = float(${t}); 
    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); 
    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}function Zde(e){return e===1?"float":`vec${e}`}function Qde(e){return e===1?".x":e===2?".xy":e===3?".xyz":""}function Jde(e,t){let r=e._attributes[t],o=r.componentsPerAttribute,a=r.functionName,s=Zde(o),u=Qde(o),l=e._offsets[t],c=`${s} ${a}(float batchId) 
{ 
    vec2 st = computeSt(batchId); 
    st.x += batchTextureStep.x * float(${l}); 
`;return e._packFloats&&r.componentDatatype!==vt.UNSIGNED_BYTE?c+=`vec4 textureValue; 
textureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); 
textureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); 
textureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); 
textureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); 
`:c+=`    vec4 textureValue = texture2D(batchTexture, st); 
`,c+=`    ${s} value = textureValue${u}; 
`,e._pixelDatatype===vt.UNSIGNED_BYTE&&r.componentDatatype===ie.UNSIGNED_BYTE&&!r.normalize?c+=`value *= 255.0; 
`:e._pixelDatatype===vt.FLOAT&&r.componentDatatype===ie.UNSIGNED_BYTE&&r.normalize&&(c+=`value /= 255.0; 
`),c+=`    return value; 
} 
`,c}Pm.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(e.length===0)return function(r){return r};let t=`uniform highp sampler2D batchTexture; 
`;t+=`${Kde(this)}
`;let n=e.length;for(let r=0;r<n;++r)t+=Jde(this,r);return function(r){let o=r.indexOf("void main"),a=r.substring(0,o),s=r.substring(o);return`${a}
${t}
${s}`}};Pm.prototype.isDestroyed=function(){return!1};Pm.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ot(this)};var bq=Pm;var $de={NEVER:V.NEVER,LESS:V.LESS,EQUAL:V.EQUAL,LESS_OR_EQUAL:V.LEQUAL,GREATER:V.GREATER,NOT_EQUAL:V.NOTEQUAL,GREATER_OR_EQUAL:V.GEQUAL,ALWAYS:V.ALWAYS},o0=Object.freeze($de);var Iq=new x,Dq=new x,Pq=new x;function epe(e,t,n,r,o){_(o)||(o=new x);let a,s,u,l,c,f,h,d;if(_(t.z)){if(x.equalsEpsilon(e,t,z.EPSILON14))return x.clone(x.UNIT_X,o);if(x.equalsEpsilon(e,n,z.EPSILON14))return x.clone(x.UNIT_Y,o);if(x.equalsEpsilon(e,r,z.EPSILON14))return x.clone(x.UNIT_Z,o);a=x.subtract(n,t,Iq),s=x.subtract(r,t,Dq),u=x.subtract(e,t,Pq),l=x.dot(a,a),c=x.dot(a,s),f=x.dot(a,u),h=x.dot(s,s),d=x.dot(s,u)}else{if(X.equalsEpsilon(e,t,z.EPSILON14))return x.clone(x.UNIT_X,o);if(X.equalsEpsilon(e,n,z.EPSILON14))return x.clone(x.UNIT_Y,o);if(X.equalsEpsilon(e,r,z.EPSILON14))return x.clone(x.UNIT_Z,o);a=X.subtract(n,t,Iq),s=X.subtract(r,t,Dq),u=X.subtract(e,t,Pq),l=X.dot(a,a),c=X.dot(a,s),f=X.dot(a,u),h=X.dot(s,s),d=X.dot(s,u)}o.y=h*f-c*d,o.z=l*d-c*f;let p=l*h-c*c;if(p!==0)return o.y/=p,o.z/=p,o.x=1-o.y-o.z,o}var Mq=epe;var ZN={};ZN.calculateACMR=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,r=T(e.cacheSize,24),o=t.length;if(!_(n)){n=0;let u=0,l=t[u];for(;u<o;)l>n&&(n=l),++u,l=t[u]}let a=[];for(let u=0;u<n+1;u++)a[u]=0;let s=r+1;for(let u=0;u<o;++u)s-a[t[u]]>r&&(a[t[u]]=s,++s);return(s-r+1)/(o/3)};ZN.tipsify=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,r=T(e.cacheSize,24),o;function a(m,b,L,R){for(;b.length>=1;){let N=b[b.length-1];if(b.splice(b.length-1,1),m[N].numLiveTriangles>0)return N}for(;o<R;){if(m[o].numLiveTriangles>0)return++o,o-1;++o}return-1}function s(m,b,L,R,N,B,G){let F=-1,k,Z=-1,te=0;for(;te<L.length;){let oe=L[te];R[oe].numLiveTriangles&&(k=0,N-R[oe].timeStamp+2*R[oe].numLiveTriangles<=b&&(k=N-R[oe].timeStamp),(k>Z||Z===-1)&&(Z=k,F=oe)),++te}return F===-1?a(R,B,m,G):F}let u=t.length,l=0,c=0,f=t[c],h=u;if(_(n))l=n+1;else{for(;c<h;)f>l&&(l=f),++c,f=t[c];if(l===-1)return 0;++l}let d=[],p;for(p=0;p<l;p++)d[p]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};c=0;let g=0;for(;c<h;)d[t[c]].vertexTriangles.push(g),++d[t[c]].numLiveTriangles,d[t[c+1]].vertexTriangles.push(g),++d[t[c+1]].numLiveTriangles,d[t[c+2]].vertexTriangles.push(g),++d[t[c+2]].numLiveTriangles,++g,c+=3;let y=0,v=r+1;o=1;let w=[],C=[],E,S,A=0,D=[],P=u/3,M=[];for(p=0;p<P;p++)M[p]=!1;let I,O;for(;y!==-1;){w=[],S=d[y],O=S.vertexTriangles.length;for(let m=0;m<O;++m)if(g=S.vertexTriangles[m],!M[g]){M[g]=!0,c=g+g+g;for(let b=0;b<3;++b)I=t[c],w.push(I),C.push(I),D[A]=I,++A,E=d[I],--E.numLiveTriangles,v-E.timeStamp>r&&(E.timeStamp=v,++v),++c}y=s(t,r,w,d,v,C,l)}return D};var Lq=ZN;var Ml={};function UI(e,t,n,r,o){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=o,e[t++]=o,e[t]=n}function tpe(e){let t=e.length,n=t/3*6,r=Rr.createTypedArray(t,n),o=0;for(let a=0;a<t;a+=3,o+=6)UI(r,o,e[a],e[a+1],e[a+2]);return r}function npe(e){let t=e.length;if(t>=3){let n=(t-2)*6,r=Rr.createTypedArray(t,n);UI(r,0,e[0],e[1],e[2]);let o=6;for(let a=3;a<t;++a,o+=6)UI(r,o,e[a-1],e[a],e[a-2]);return r}return new Uint16Array}function rpe(e){if(e.length>0){let t=e.length-1,n=(t-1)*6,r=Rr.createTypedArray(t,n),o=e[0],a=0;for(let s=1;s<t;++s,a+=6)UI(r,a,o,e[s],e[s+1]);return r}return new Uint16Array}Ml.toWireframe=function(e){let t=e.indices;if(_(t)){switch(e.primitiveType){case rn.TRIANGLES:e.indices=tpe(t);break;case rn.TRIANGLE_STRIP:e.indices=npe(t);break;case rn.TRIANGLE_FAN:e.indices=rpe(t);break}e.primitiveType=rn.LINES}return e};Ml.createLineSegmentsForVectors=function(e,t,n){t=T(t,"normal"),n=T(n,1e4);let r=e.attributes.position.values,o=e.attributes[t].values,a=r.length,s=new Float64Array(2*a),u=0;for(let f=0;f<a;f+=3)s[u++]=r[f],s[u++]=r[f+1],s[u++]=r[f+2],s[u++]=r[f]+o[f]*n,s[u++]=r[f+1]+o[f+1]*n,s[u++]=r[f+2]+o[f+2]*n;let l,c=e.boundingSphere;return _(c)&&(l=new Ee(c.center,c.radius+n)),new Ci({attributes:{position:new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:rn.LINES,boundingSphere:l})};Ml.createAttributeLocations=function(e){let t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,r={},o=0,a,s=t.length;for(a=0;a<s;++a){let u=t[a];_(n[u])&&(r[u]=o++)}for(let u in n)n.hasOwnProperty(u)&&!_(r[u])&&(r[u]=o++);return r};Ml.reorderForPreVertexCache=function(e){let t=Ci.computeNumberOfVertices(e),n=e.indices;if(_(n)){let r=new Int32Array(t);for(let d=0;d<t;d++)r[d]=-1;let o=n,a=o.length,s=Rr.createTypedArray(t,a),u=0,l=0,c=0,f;for(;u<a;)f=r[o[u]],f!==-1?s[l]=f:(f=o[u],r[f]=c,s[l]=c,++c),++u,++l;e.indices=s;let h=e.attributes;for(let d in h)if(h.hasOwnProperty(d)&&_(h[d])&&_(h[d].values)){let p=h[d],g=p.values,y=0,v=p.componentsPerAttribute,w=ie.createTypedArray(p.componentDatatype,c*v);for(;y<t;){let C=r[y];if(C!==-1)for(let E=0;E<v;E++)w[v*C+E]=g[v*y+E];++y}p.values=w}}return e};Ml.reorderForPostVertexCache=function(e,t){let n=e.indices;if(e.primitiveType===rn.TRIANGLES&&_(n)){let r=n.length,o=0;for(let a=0;a<r;a++)n[a]>o&&(o=n[a]);e.indices=Lq.tipsify({indices:n,maximumIndex:o,cacheSize:t})}return e};function Rq(e){let t={};for(let n in e)if(e.hasOwnProperty(n)&&_(e[n])&&_(e[n].values)){let r=e[n];t[n]=new xi({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function ipe(e,t,n){for(let r in t)if(t.hasOwnProperty(r)&&_(t[r])&&_(t[r].values)){let o=t[r];for(let a=0;a<o.componentsPerAttribute;++a)e[r].values.push(o.values[n*o.componentsPerAttribute+a])}}Ml.fitToUnsignedShortIndices=function(e){let t=[],n=Ci.computeNumberOfVertices(e);if(_(e.indices)&&n>=z.SIXTY_FOUR_KILOBYTES){let r=[],o=[],a=0,s=Rq(e.attributes),u=e.indices,l=u.length,c;e.primitiveType===rn.TRIANGLES?c=3:e.primitiveType===rn.LINES?c=2:e.primitiveType===rn.POINTS&&(c=1);for(let f=0;f<l;f+=c){for(let h=0;h<c;++h){let d=u[f+h],p=r[d];_(p)||(p=a++,r[d]=p,ipe(s,e.attributes,d)),o.push(p)}a+c>=z.SIXTY_FOUR_KILOBYTES&&(t.push(new Ci({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),r=[],o=[],a=0,s=Rq(e.attributes))}o.length!==0&&t.push(new Ci({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var Oq=new x,ope=new ce;Ml.projectTo2D=function(e,t,n,r,o){let a=e.attributes[t];o=_(o)?o:new uc;let s=o.ellipsoid,u=a.values,l=new Float64Array(u.length),c=0;for(let f=0;f<u.length;f+=3){let h=x.fromArray(u,f,Oq),d=s.cartesianToCartographic(h,ope),p=o.project(d,Oq);l[c++]=p.x,l[c++]=p.y,l[c++]=p.z}return e.attributes[n]=a,e.attributes[r]=new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:l}),delete e.attributes[t],e};var QN={high:0,low:0};Ml.encodeAttribute=function(e,t,n,r){let o=e.attributes[t],a=o.values,s=a.length,u=new Float32Array(s),l=new Float32Array(s);for(let f=0;f<s;++f)ei.encode(a[f],QN),u[f]=QN.high,l[f]=QN.low;let c=o.componentsPerAttribute;return e.attributes[n]=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:c,values:u}),e.attributes[r]=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:c,values:l}),delete e.attributes[t],e};var od=new x;function JN(e,t){if(_(t)){let n=t.values,r=n.length;for(let o=0;o<r;o+=3)x.unpack(n,o,od),U.multiplyByPoint(e,od,od),x.pack(od,n,o)}}function $N(e,t){if(_(t)){let n=t.values,r=n.length;for(let o=0;o<r;o+=3)x.unpack(n,o,od),ne.multiplyByVector(e,od,od),od=x.normalize(od,od),x.pack(od,n,o)}}var BI=new U,FI=new ne;Ml.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(U.equals(t,U.IDENTITY))return e;let n=e.geometry.attributes;JN(t,n.position),JN(t,n.prevPosition),JN(t,n.nextPosition),(_(n.normal)||_(n.tangent)||_(n.bitangent))&&(U.inverse(t,BI),U.transpose(BI,BI),U.getMatrix3(BI,FI),$N(FI,n.normal),$N(FI,n.tangent),$N(FI,n.bitangent));let r=e.geometry.boundingSphere;return _(r)&&(e.geometry.boundingSphere=Ee.transform(r,t,r)),e.modelMatrix=U.clone(U.IDENTITY),e};function ape(e,t){let n=e.length,r={},o=e[0][t].attributes,a;for(a in o)if(o.hasOwnProperty(a)&&_(o[a])&&_(o[a].values)){let s=o[a],u=s.values.length,l=!0;for(let c=1;c<n;++c){let f=e[c][t].attributes[a];if(!_(f)||s.componentDatatype!==f.componentDatatype||s.componentsPerAttribute!==f.componentsPerAttribute||s.normalize!==f.normalize){l=!1;break}u+=f.values.length}l&&(r[a]=new xi({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:ie.createTypedArray(s.componentDatatype,u)}))}return r}var spe=new x;function e2(e,t){let n=e.length,r,o,a,s,u=e[0].modelMatrix,l=_(e[0][t].indices),c=e[0][t].primitiveType,f=ape(e,t),h,d,p;for(r in f)if(f.hasOwnProperty(r))for(h=f[r].values,s=0,o=0;o<n;++o)for(d=e[o][t].attributes[r].values,p=d.length,a=0;a<p;++a)h[s++]=d[a];let g;if(l){let C=0;for(o=0;o<n;++o)C+=e[o][t].indices.length;let E=Ci.computeNumberOfVertices(new Ci({attributes:f,primitiveType:rn.POINTS})),S=Rr.createTypedArray(E,C),A=0,D=0;for(o=0;o<n;++o){let P=e[o][t].indices,M=P.length;for(s=0;s<M;++s)S[A++]=D+P[s];D+=Ci.computeNumberOfVertices(e[o][t])}g=S}let y=new x,v=0,w;for(o=0;o<n;++o){if(w=e[o][t].boundingSphere,!_(w)){y=void 0;break}x.add(w.center,y,y)}if(_(y))for(x.divideByScalar(y,n,y),o=0;o<n;++o){w=e[o][t].boundingSphere;let C=x.magnitude(x.subtract(w.center,y,spe))+w.radius;C>v&&(v=C)}return new Ci({attributes:f,indices:g,primitiveType:c,boundingSphere:_(y)?new Ee(y,v):void 0})}Ml.combineInstances=function(e){let t=[],n=[],r=e.length;for(let a=0;a<r;++a){let s=e[a];_(s.geometry)?t.push(s):_(s.westHemisphereGeometry)&&_(s.eastHemisphereGeometry)&&n.push(s)}let o=[];return t.length>0&&o.push(e2(t,"geometry")),n.length>0&&(o.push(e2(n,"westHemisphereGeometry")),o.push(e2(n,"eastHemisphereGeometry"))),o};var zf=new x,gE=new x,wC=new x,EC=new x;Ml.computeNormal=function(e){let t=e.indices,n=e.attributes,r=n.position.values,o=n.position.values.length/3,a=t.length,s=new Array(o),u=new Array(a/3),l=new Array(a),c;for(c=0;c<o;c++)s[c]={indexOffset:0,count:0,currentCount:0};let f=0;for(c=0;c<a;c+=3){let g=t[c],y=t[c+1],v=t[c+2],w=g*3,C=y*3,E=v*3;gE.x=r[w],gE.y=r[w+1],gE.z=r[w+2],wC.x=r[C],wC.y=r[C+1],wC.z=r[C+2],EC.x=r[E],EC.y=r[E+1],EC.z=r[E+2],s[g].count++,s[y].count++,s[v].count++,x.subtract(wC,gE,wC),x.subtract(EC,gE,EC),u[f]=x.cross(wC,EC,new x),f++}let h=0;for(c=0;c<o;c++)s[c].indexOffset+=h,h+=s[c].count;f=0;let d;for(c=0;c<a;c+=3){d=s[t[c]];let g=d.indexOffset+d.currentCount;l[g]=f,d.currentCount++,d=s[t[c+1]],g=d.indexOffset+d.currentCount,l[g]=f,d.currentCount++,d=s[t[c+2]],g=d.indexOffset+d.currentCount,l[g]=f,d.currentCount++,f++}let p=new Float32Array(o*3);for(c=0;c<o;c++){let g=c*3;if(d=s[c],x.clone(x.ZERO,zf),d.count>0){for(f=0;f<d.count;f++)x.add(zf,u[l[d.indexOffset+f]],zf);x.equalsEpsilon(x.ZERO,zf,z.EPSILON10)&&x.clone(u[l[d.indexOffset]],zf)}x.equalsEpsilon(x.ZERO,zf,z.EPSILON10)&&(zf.z=1),x.normalize(zf,zf),p[g]=zf.x,p[g+1]=zf.y,p[g+2]=zf.z}return e.attributes.normal=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:p}),e};var upe=new x,Nq=new x,lpe=new x;Ml.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,r=e.attributes.position.values,o=e.attributes.normal.values,a=e.attributes.st.values,s=e.attributes.position.values.length/3,u=n.length,l=new Array(s*3),c;for(c=0;c<l.length;c++)l[c]=0;let f,h,d;for(c=0;c<u;c+=3){let y=n[c],v=n[c+1],w=n[c+2];f=y*3,h=v*3,d=w*3;let C=y*2,E=v*2,S=w*2,A=r[f],D=r[f+1],P=r[f+2],M=a[C],I=a[C+1],O=a[E+1]-I,m=a[S+1]-I,b=1/((a[E]-M)*m-(a[S]-M)*O),L=(m*(r[h]-A)-O*(r[d]-A))*b,R=(m*(r[h+1]-D)-O*(r[d+1]-D))*b,N=(m*(r[h+2]-P)-O*(r[d+2]-P))*b;l[f]+=L,l[f+1]+=R,l[f+2]+=N,l[h]+=L,l[h+1]+=R,l[h+2]+=N,l[d]+=L,l[d+1]+=R,l[d+2]+=N}let p=new Float32Array(s*3),g=new Float32Array(s*3);for(c=0;c<s;c++){f=c*3,h=f+1,d=f+2;let y=x.fromArray(o,f,upe),v=x.fromArray(l,f,lpe),w=x.dot(y,v);x.multiplyByScalar(y,w,Nq),x.normalize(x.subtract(v,Nq,v),v),p[f]=v.x,p[h]=v.y,p[d]=v.z,x.normalize(x.cross(y,v,v),v),g[f]=v.x,g[h]=v.y,g[d]=v.z}return e.attributes.tangent=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:p}),e.attributes.bitangent=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:3,values:g}),e};var _E=new X,id=new x,Bq=new x,Fq=new x,zI=new X;Ml.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,r;if(_(t)){let D=t.values;r=D.length/3;let P=new Float32Array(r*2),M=0;for(n=0;n<r;++n){if(x.fromArray(D,n*3,id),x.equals(id,x.ZERO)){M+=2;continue}zI=ma.octEncodeInRange(id,65535,zI),P[M++]=zI.x,P[M++]=zI.y}return e.attributes.compressedAttributes=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:P}),delete e.attributes.extrudeDirection,e}let o=e.attributes.normal,a=e.attributes.st,s=_(o),u=_(a);if(!s&&!u)return e;let l=e.attributes.tangent,c=e.attributes.bitangent,f=_(l),h=_(c),d,p,g,y;s&&(d=o.values),u&&(p=a.values),f&&(g=l.values),h&&(y=c.values),r=(s?d.length:p.length)/(s?3:2);let C=r,E=u&&s?2:1;E+=f||h?1:0,C*=E;let S=new Float32Array(C),A=0;for(n=0;n<r;++n){u&&(X.fromArray(p,n*2,_E),S[A++]=ma.compressTextureCoordinates(_E));let D=n*3;s&&_(g)&&_(y)?(x.fromArray(d,D,id),x.fromArray(g,D,Bq),x.fromArray(y,D,Fq),ma.octPack(id,Bq,Fq,_E),S[A++]=_E.x,S[A++]=_E.y):(s&&(x.fromArray(d,D,id),S[A++]=ma.octEncodeFloat(id)),f&&(x.fromArray(g,D,id),S[A++]=ma.octEncodeFloat(id)),h&&(x.fromArray(y,D,id),S[A++]=ma.octEncodeFloat(id)))}return e.attributes.compressedAttributes=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:E,values:S}),s&&delete e.attributes.normal,u&&delete e.attributes.st,h&&delete e.attributes.bitangent,f&&delete e.attributes.tangent,e};function cpe(e){if(_(e.indices))return e;let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}function fpe(e){let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let r=3;for(let o=3;o<t;++o)n[r++]=o-1,n[r++]=0,n[r++]=o;return e.indices=n,e.primitiveType=rn.TRIANGLES,e}function hpe(e){let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let r=6;for(let o=3;o<t-1;o+=2)n[r++]=o,n[r++]=o-1,n[r++]=o+1,o+2<t&&(n[r++]=o,n[r++]=o+1,n[r++]=o+2);return e.indices=n,e.primitiveType=rn.TRIANGLES,e}function dpe(e){if(_(e.indices))return e;let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}function ppe(e){let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return e.indices=n,e.primitiveType=rn.LINES,e}function mpe(e){let t=Ci.computeNumberOfVertices(e),n=Rr.createTypedArray(t,t*2);n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=rn.LINES,e}function gpe(e){switch(e.primitiveType){case rn.TRIANGLE_FAN:return fpe(e);case rn.TRIANGLE_STRIP:return hpe(e);case rn.TRIANGLES:return cpe(e);case rn.LINE_STRIP:return ppe(e);case rn.LINE_LOOP:return mpe(e);case rn.LINES:return dpe(e)}return e}function a0(e,t){Math.abs(e.y)<z.EPSILON6&&(t?e.y=-z.EPSILON6:e.y=z.EPSILON6)}function _pe(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){a0(e,e.y<0),a0(t,t.y<0),a0(n,n.y<0);return}let r=Math.abs(e.y),o=Math.abs(t.y),a=Math.abs(n.y),s;r>o?r>a?s=z.sign(e.y):s=z.sign(n.y):o>a?s=z.sign(t.y):s=z.sign(n.y);let u=s<0;a0(e,u),a0(t,u),a0(n,u)}var zq=new x;function Vf(e,t,n,r){x.add(e,x.multiplyByScalar(x.subtract(t,e,zq),e.y/(e.y-t.y),zq),n),x.clone(n,r),a0(n,!0),a0(r,!1)}var K_=new x,Z_=new x,Q_=new x,J_=new x,t2={positions:new Array(7),indices:new Array(3*3)};function ype(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;_pe(e,t,n);let r=e.y<0,o=t.y<0,a=n.y<0,s=0;s+=r?1:0,s+=o?1:0,s+=a?1:0;let u=t2.indices;s===1?(u[1]=3,u[2]=4,u[5]=6,u[7]=6,u[8]=5,r?(Vf(e,t,K_,Q_),Vf(e,n,Z_,J_),u[0]=0,u[3]=1,u[4]=2,u[6]=1):o?(Vf(t,n,K_,Q_),Vf(t,e,Z_,J_),u[0]=1,u[3]=2,u[4]=0,u[6]=2):a&&(Vf(n,e,K_,Q_),Vf(n,t,Z_,J_),u[0]=2,u[3]=0,u[4]=1,u[6]=0)):s===2&&(u[2]=4,u[4]=4,u[5]=3,u[7]=5,u[8]=6,r?o?a||(Vf(n,e,K_,Q_),Vf(n,t,Z_,J_),u[0]=0,u[1]=1,u[3]=0,u[6]=2):(Vf(t,n,K_,Q_),Vf(t,e,Z_,J_),u[0]=2,u[1]=0,u[3]=2,u[6]=1):(Vf(e,t,K_,Q_),Vf(e,n,Z_,J_),u[0]=1,u[1]=2,u[3]=1,u[6]=0));let l=t2.positions;return l[0]=e,l[1]=t,l[2]=n,l.length=3,(s===1||s===2)&&(l[3]=K_,l[4]=Z_,l[5]=Q_,l[6]=J_,l.length=7),t2}function Vq(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let o in n)if(n.hasOwnProperty(o)&&_(n[o])&&_(n[o].values)){let a=n[o];a.values=ie.createTypedArray(a.componentDatatype,a.values)}let r=Ci.computeNumberOfVertices(e);return e.indices=Rr.createTypedArray(r,e.indices),t&&(e.boundingSphere=Ee.fromVertices(n.position.values)),e}function SC(e){let t=e.attributes,n={};for(let r in t)if(t.hasOwnProperty(r)&&_(t[r])&&_(t[r].values)){let o=t[r];n[r]=new xi({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return new Ci({attributes:n,indices:[],primitiveType:e.primitiveType})}function o2(e,t,n){let r=_(e.geometry.boundingSphere);t=Vq(t,r),n=Vq(n,r),_(n)&&!_(t)?e.geometry=n:!_(n)&&_(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function a2(e,t){let n=new e,r=new e,o=new e;return function(a,s,u,l,c,f,h,d){let p=e.fromArray(c,a*t,n),g=e.fromArray(c,s*t,r),y=e.fromArray(c,u*t,o);e.multiplyByScalar(p,l.x,p),e.multiplyByScalar(g,l.y,g),e.multiplyByScalar(y,l.z,y);let v=e.add(p,g,p);e.add(v,y,v),d&&e.normalize(v,v),e.pack(v,f,h*t)}}var vpe=a2(Se,4),GI=a2(x,3),Wq=a2(X,2),Cpe=function(e,t,n,r,o,a,s){let u=o[e]*r.x,l=o[t]*r.y,c=o[n]*r.z;a[s]=u+l+c>z.EPSILON6?1:0},yE=new x,n2=new x,r2=new x,xpe=new x;function VI(e,t,n,r,o,a,s,u,l,c,f,h,d,p,g,y){if(!_(a)&&!_(s)&&!_(u)&&!_(l)&&!_(c)&&p===0)return;let v=x.fromArray(o,e*3,yE),w=x.fromArray(o,t*3,n2),C=x.fromArray(o,n*3,r2),E=Mq(r,v,w,C,xpe);if(!!_(E)){if(_(a)&&GI(e,t,n,E,a,h.normal.values,y,!0),_(c)){let S=x.fromArray(c,e*3,yE),A=x.fromArray(c,t*3,n2),D=x.fromArray(c,n*3,r2);x.multiplyByScalar(S,E.x,S),x.multiplyByScalar(A,E.y,A),x.multiplyByScalar(D,E.z,D);let P;!x.equals(S,x.ZERO)||!x.equals(A,x.ZERO)||!x.equals(D,x.ZERO)?(P=x.add(S,A,S),x.add(P,D,P),x.normalize(P,P)):(P=yE,P.x=0,P.y=0,P.z=0),x.pack(P,h.extrudeDirection.values,y*3)}if(_(f)&&Cpe(e,t,n,E,f,h.applyOffset.values,y),_(s)&&GI(e,t,n,E,s,h.tangent.values,y,!0),_(u)&&GI(e,t,n,E,u,h.bitangent.values,y,!0),_(l)&&Wq(e,t,n,E,l,h.st.values,y),p>0)for(let S=0;S<p;S++){let A=d[S];wpe(e,t,n,E,y,g[A],h[A])}}}function wpe(e,t,n,r,o,a,s){let u=a.componentsPerAttribute,l=a.values,c=s.values;switch(u){case 4:vpe(e,t,n,r,l,c,o,!1);break;case 3:GI(e,t,n,r,l,c,o,!1);break;case 2:Wq(e,t,n,r,l,c,o,!1);break;default:c[o]=l[e]*r.x+l[t]*r.y+l[n]*r.z}}function lp(e,t,n,r,o,a){let s=e.position.values.length/3;if(o!==-1){let u=r[o],l=n[u];return l===-1?(n[u]=s,e.position.values.push(a.x,a.y,a.z),t.push(s),s):(t.push(l),l)}return e.position.values.push(a.x,a.y,a.z),t.push(s),s}var Epe={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function kq(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=_(n.normal)?n.normal.values:void 0,a=_(n.bitangent)?n.bitangent.values:void 0,s=_(n.tangent)?n.tangent.values:void 0,u=_(n.st)?n.st.values:void 0,l=_(n.extrudeDirection)?n.extrudeDirection.values:void 0,c=_(n.applyOffset)?n.applyOffset.values:void 0,f=t.indices,h=[];for(let P in n)n.hasOwnProperty(P)&&!Epe[P]&&_(n[P])&&h.push(P);let d=h.length,p=SC(t),g=SC(t),y,v,w,C,E,S=[];S.length=r.length/3;let A=[];for(A.length=r.length/3,E=0;E<S.length;++E)S[E]=-1,A[E]=-1;let D=f.length;for(E=0;E<D;E+=3){let P=f[E],M=f[E+1],I=f[E+2],O=x.fromArray(r,P*3),m=x.fromArray(r,M*3),b=x.fromArray(r,I*3),L=ype(O,m,b);if(_(L)&&L.positions.length>3){let R=L.positions,N=L.indices,B=N.length;for(let G=0;G<B;++G){let F=N[G],k=R[F];k.y<0?(y=g.attributes,v=g.indices,w=S):(y=p.attributes,v=p.indices,w=A),C=lp(y,v,w,f,F<3?E+F:-1,k),VI(P,M,I,k,r,o,s,a,u,l,c,y,h,d,n,C)}}else _(L)&&(O=L.positions[0],m=L.positions[1],b=L.positions[2]),O.y<0?(y=g.attributes,v=g.indices,w=S):(y=p.attributes,v=p.indices,w=A),C=lp(y,v,w,f,E,O),VI(P,M,I,O,r,o,s,a,u,l,c,y,h,d,n,C),C=lp(y,v,w,f,E+1,m),VI(P,M,I,m,r,o,s,a,u,l,c,y,h,d,n,C),C=lp(y,v,w,f,E+2,b),VI(P,M,I,b,r,o,s,a,u,l,c,y,h,d,n,C)}o2(e,g,p)}var Yq=oi.fromPointNormal(x.ZERO,x.UNIT_Y),Tpe=new x,Spe=new x;function TC(e,t,n,r,o,a,s){if(!_(s))return;let u=x.fromArray(r,e*3,yE);x.equalsEpsilon(u,n,z.EPSILON10)?a.applyOffset.values[o]=s[e]:a.applyOffset.values[o]=s[t]}function Gq(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=_(n.applyOffset)?n.applyOffset.values:void 0,a=t.indices,s=SC(t),u=SC(t),l,c=a.length,f=[];f.length=r.length/3;let h=[];for(h.length=r.length/3,l=0;l<f.length;++l)f[l]=-1,h[l]=-1;for(l=0;l<c;l+=2){let d=a[l],p=a[l+1],g=x.fromArray(r,d*3,yE),y=x.fromArray(r,p*3,n2),v;Math.abs(g.y)<z.EPSILON6&&(g.y<0?g.y=-z.EPSILON6:g.y=z.EPSILON6),Math.abs(y.y)<z.EPSILON6&&(y.y<0?y.y=-z.EPSILON6:y.y=z.EPSILON6);let w=s.attributes,C=s.indices,E=h,S=u.attributes,A=u.indices,D=f,P=Wc.lineSegmentPlane(g,y,Yq,r2);if(_(P)){let M=x.multiplyByScalar(x.UNIT_Y,5*z.EPSILON9,Tpe);g.y<0&&(x.negate(M,M),w=u.attributes,C=u.indices,E=f,S=s.attributes,A=s.indices,D=h);let I=x.add(P,M,Spe);v=lp(w,C,E,a,l,g),TC(d,p,g,r,v,w,o),v=lp(w,C,E,a,-1,I),TC(d,p,I,r,v,w,o),x.negate(M,M),x.add(P,M,I),v=lp(S,A,D,a,-1,I),TC(d,p,I,r,v,S,o),v=lp(S,A,D,a,l+1,y),TC(d,p,y,r,v,S,o)}else{let M,I,O;g.y<0?(M=u.attributes,I=u.indices,O=f):(M=s.attributes,I=s.indices,O=h),v=lp(M,I,O,a,l,g),TC(d,p,g,r,v,M,o),v=lp(M,I,O,a,l+1,y),TC(d,p,y,r,v,M,o)}}o2(e,u,s)}var Uq=new X,Ape=new X,Xq=new x,jq=new x,i2=new x,bpe=new x,Ipe=new x,Dpe=new x,Hq=new Se;function qq(e){let t=e.attributes,n=t.position.values,r=t.prevPosition.values,o=t.nextPosition.values,a=n.length;for(let s=0;s<a;s+=3){let u=x.unpack(n,s,Xq);if(u.x>0)continue;let l=x.unpack(r,s,jq);(u.y<0&&l.y>0||u.y>0&&l.y<0)&&(s-3>0?(r[s]=n[s-3],r[s+1]=n[s-2],r[s+2]=n[s-1]):x.pack(u,r,s));let c=x.unpack(o,s,i2);(u.y<0&&c.y>0||u.y>0&&c.y<0)&&(s+3<a?(o[s]=n[s+3],o[s+1]=n[s+4],o[s+2]=n[s+5]):x.pack(u,o,s))}}var Ppe=5*z.EPSILON9,kI=z.EPSILON6;function Mpe(e){let t=e.geometry,n=t.attributes,r=n.position.values,o=n.prevPosition.values,a=n.nextPosition.values,s=n.expandAndWidth.values,u=_(n.st)?n.st.values:void 0,l=_(n.color)?n.color.values:void 0,c=SC(t),f=SC(t),h,d,p,g=!1,y=r.length/3;for(h=0;h<y;h+=4){let v=h,w=h+2,C=x.fromArray(r,v*3,Xq),E=x.fromArray(r,w*3,jq);if(Math.abs(C.y)<kI)for(C.y=kI*(E.y<0?-1:1),r[h*3+1]=C.y,r[(h+1)*3+1]=C.y,d=v*3;d<v*3+4*3;d+=3)o[d]=r[h*3],o[d+1]=r[h*3+1],o[d+2]=r[h*3+2];if(Math.abs(E.y)<kI)for(E.y=kI*(C.y<0?-1:1),r[(h+2)*3+1]=E.y,r[(h+3)*3+1]=E.y,d=v*3;d<v*3+4*3;d+=3)a[d]=r[(h+2)*3],a[d+1]=r[(h+2)*3+1],a[d+2]=r[(h+2)*3+2];let S=c.attributes,A=c.indices,D=f.attributes,P=f.indices,M=Wc.lineSegmentPlane(C,E,Yq,bpe);if(_(M)){g=!0;let I=x.multiplyByScalar(x.UNIT_Y,Ppe,Ipe);C.y<0&&(x.negate(I,I),S=f.attributes,A=f.indices,D=c.attributes,P=c.indices);let O=x.add(M,I,Dpe);S.position.values.push(C.x,C.y,C.z,C.x,C.y,C.z),S.position.values.push(O.x,O.y,O.z),S.position.values.push(O.x,O.y,O.z),S.prevPosition.values.push(o[v*3],o[v*3+1],o[v*3+2]),S.prevPosition.values.push(o[v*3+3],o[v*3+4],o[v*3+5]),S.prevPosition.values.push(C.x,C.y,C.z,C.x,C.y,C.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),S.nextPosition.values.push(O.x,O.y,O.z),x.negate(I,I),x.add(M,I,O),D.position.values.push(O.x,O.y,O.z),D.position.values.push(O.x,O.y,O.z),D.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.prevPosition.values.push(O.x,O.y,O.z),D.nextPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.nextPosition.values.push(a[w*3],a[w*3+1],a[w*3+2]),D.nextPosition.values.push(a[w*3+3],a[w*3+4],a[w*3+5]);let m=X.fromArray(s,v*2,Uq),b=Math.abs(m.y);S.expandAndWidth.values.push(-1,b,1,b),S.expandAndWidth.values.push(-1,-b,1,-b),D.expandAndWidth.values.push(-1,b,1,b),D.expandAndWidth.values.push(-1,-b,1,-b);let L=x.magnitudeSquared(x.subtract(M,C,i2));if(L/=x.magnitudeSquared(x.subtract(E,C,i2)),_(l)){let R=Se.fromArray(l,v*4,Hq),N=Se.fromArray(l,w*4,Hq),B=z.lerp(R.x,N.x,L),G=z.lerp(R.y,N.y,L),F=z.lerp(R.z,N.z,L),k=z.lerp(R.w,N.w,L);for(d=v*4;d<v*4+2*4;++d)S.color.values.push(l[d]);for(S.color.values.push(B,G,F,k),S.color.values.push(B,G,F,k),D.color.values.push(B,G,F,k),D.color.values.push(B,G,F,k),d=w*4;d<w*4+2*4;++d)D.color.values.push(l[d])}if(_(u)){let R=X.fromArray(u,v*2,Uq),N=X.fromArray(u,(h+3)*2,Ape),B=z.lerp(R.x,N.x,L);for(d=v*2;d<v*2+2*2;++d)S.st.values.push(u[d]);for(S.st.values.push(B,R.y),S.st.values.push(B,N.y),D.st.values.push(B,R.y),D.st.values.push(B,N.y),d=w*2;d<w*2+2*2;++d)D.st.values.push(u[d])}p=S.position.values.length/3-4,A.push(p,p+2,p+1),A.push(p+1,p+2,p+3),p=D.position.values.length/3-4,P.push(p,p+2,p+1),P.push(p+1,p+2,p+3)}else{let I,O;for(C.y<0?(I=f.attributes,O=f.indices):(I=c.attributes,O=c.indices),I.position.values.push(C.x,C.y,C.z),I.position.values.push(C.x,C.y,C.z),I.position.values.push(E.x,E.y,E.z),I.position.values.push(E.x,E.y,E.z),d=h*3;d<h*3+4*3;++d)I.prevPosition.values.push(o[d]),I.nextPosition.values.push(a[d]);for(d=h*2;d<h*2+4*2;++d)I.expandAndWidth.values.push(s[d]),_(u)&&I.st.values.push(u[d]);if(_(l))for(d=h*4;d<h*4+4*4;++d)I.color.values.push(l[d]);p=I.position.values.length/3-4,O.push(p,p+2,p+1),O.push(p+1,p+2,p+3)}}g&&(qq(f),qq(c)),o2(e,f,c)}Ml.splitLongitude=function(e){let t=e.geometry,n=t.boundingSphere;if(_(n)&&(n.center.x-n.radius>0||Ee.intersectPlane(n,oi.ORIGIN_ZX_PLANE)!==gi.INTERSECTING))return e;if(t.geometryType!==N_.NONE)switch(t.geometryType){case N_.POLYLINES:Mpe(e);break;case N_.TRIANGLES:kq(e);break;case N_.LINES:Gq(e);break}else gpe(t),t.primitiveType===rn.TRIANGLES?kq(e):t.primitiveType===rn.LINES&&Gq(e);return e};var _a=Ml;function vE(e,t,n){e=T(e,0),t=T(t,0),n=T(n,0),this.value=new Float32Array([e,t,n])}Object.defineProperties(vE.prototype,{componentDatatype:{get:function(){return ie.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}});vE.fromCartesian3=function(e){return new vE(e.x,e.y,e.z)};vE.toValue=function(e,t){return _(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var Kq=vE;function Lpe(e,t,n){let r=!n,o=e.length,a;if(!r&&o>1){let s=e[0].modelMatrix;for(a=1;a<o;++a)if(!U.equals(s,e[a].modelMatrix)){r=!0;break}}if(r)for(a=0;a<o;++a)_(e[a].geometry)&&_a.transformToWorldCoordinates(e[a]);else U.multiplyTransformation(t,e[0].modelMatrix,t)}function s2(e,t){let n=e.attributes,r=n.position,o=r.values.length/r.componentsPerAttribute;n.batchId=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:1,values:new Float32Array(o)});let a=n.batchId.values;for(let s=0;s<o;++s)a[s]=t}function Rpe(e){let t=e.length;for(let n=0;n<t;++n){let r=e[n];_(r.geometry)?s2(r.geometry,n):_(r.westHemisphereGeometry)&&_(r.eastHemisphereGeometry)&&(s2(r.westHemisphereGeometry,n),s2(r.eastHemisphereGeometry,n))}}function Ope(e){let t=e.instances,n=e.projection,r=e.elementIndexUintSupported,o=e.scene3DOnly,a=e.vertexCacheOptimize,s=e.compressVertices,u=e.modelMatrix,l,c,f,h=t.length;for(l=0;l<h;++l)if(_(t[l].geometry)){f=t[l].geometry.primitiveType;break}if(Lpe(t,u,o),!o)for(l=0;l<h;++l)_(t[l].geometry)&&_a.splitLongitude(t[l]);if(Rpe(t),a)for(l=0;l<h;++l){let p=t[l];_(p.geometry)?(_a.reorderForPostVertexCache(p.geometry),_a.reorderForPreVertexCache(p.geometry)):_(p.westHemisphereGeometry)&&_(p.eastHemisphereGeometry)&&(_a.reorderForPostVertexCache(p.westHemisphereGeometry),_a.reorderForPreVertexCache(p.westHemisphereGeometry),_a.reorderForPostVertexCache(p.eastHemisphereGeometry),_a.reorderForPreVertexCache(p.eastHemisphereGeometry))}let d=_a.combineInstances(t);for(h=d.length,l=0;l<h;++l){c=d[l];let p=c.attributes;if(o)for(let g in p)p.hasOwnProperty(g)&&p[g].componentDatatype===ie.DOUBLE&&_a.encodeAttribute(c,g,`${g}3DHigh`,`${g}3DLow`);else for(let g in p)if(p.hasOwnProperty(g)&&p[g].componentDatatype===ie.DOUBLE){let y=`${g}3D`,v=`${g}2D`;_a.projectTo2D(c,g,y,v,n),_(c.boundingSphere)&&g==="position"&&(c.boundingSphereCV=Ee.fromVertices(c.attributes.position2D.values)),_a.encodeAttribute(c,y,`${y}High`,`${y}Low`),_a.encodeAttribute(c,v,`${v}High`,`${v}Low`)}s&&_a.compressVertices(c)}if(!r){let p=[];for(h=d.length,l=0;l<h;++l)c=d[l],p=p.concat(_a.fitToUnsignedShortIndices(c));d=p}return d}function u2(e,t,n,r){let o,a,s,u=r.length-1;if(u>=0){let c=r[u];o=c.offset+c.count,s=c.index,a=n[s].indices.length}else o=0,s=0,a=n[s].indices.length;let l=e.length;for(let c=0;c<l;++c){let h=e[c][t];if(!_(h))continue;let d=h.indices.length;o+d>a&&(o=0,a=n[++s].indices.length),r.push({index:s,offset:o,count:d}),o+=d}}function Npe(e,t){let n=[];return u2(e,"geometry",t,n),u2(e,"westHemisphereGeometry",t,n),u2(e,"eastHemisphereGeometry",t,n),n}var Mm={};Mm.combineGeometry=function(e){let t,n,r=e.instances,o=r.length,a,s,u=!1;o>0&&(t=Ope(e),t.length>0&&(n=_a.createAttributeLocations(t[0]),e.createPickOffsets&&(a=Npe(r,t))),_(r[0].attributes)&&_(r[0].attributes.offset)&&(s=new Array(o),u=!0));let l=new Array(o),c=new Array(o);for(let f=0;f<o;++f){let h=r[f],d=h.geometry;_(d)&&(l[f]=d.boundingSphere,c[f]=d.boundingSphereCV,u&&(s[f]=h.geometry.offsetAttribute));let p=h.eastHemisphereGeometry,g=h.westHemisphereGeometry;_(p)&&_(g)&&(_(p.boundingSphere)&&_(g.boundingSphere)&&(l[f]=Ee.union(p.boundingSphere,g.boundingSphere)),_(p.boundingSphereCV)&&_(g.boundingSphereCV)&&(c[f]=Ee.union(p.boundingSphereCV,g.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:a,offsetInstanceExtend:s,boundingSpheres:l,boundingSpheresCV:c}};function Bpe(e,t){let n=e.attributes;for(let r in n)if(n.hasOwnProperty(r)){let o=n[r];_(o)&&_(o.values)&&t.push(o.values.buffer)}_(e.indices)&&t.push(e.indices.buffer)}function Fpe(e,t){let n=e.length;for(let r=0;r<n;++r)Bpe(e[r],t)}function zpe(e){let t=1,n=e.length;for(let r=0;r<n;r++){let o=e[r];if(++t,!_(o))continue;let a=o.attributes;t+=7+2*Ee.packedLength+(_(o.indices)?o.indices.length:0);for(let s in a)if(a.hasOwnProperty(s)&&_(a[s])){let u=a[s];t+=5+u.values.length}}return t}Mm.packCreateGeometryResults=function(e,t){let n=new Float64Array(zpe(e)),r=[],o={},a=e.length,s=0;n[s++]=a;for(let u=0;u<a;u++){let l=e[u],c=_(l);if(n[s++]=c?1:0,!c)continue;n[s++]=l.primitiveType,n[s++]=l.geometryType,n[s++]=T(l.offsetAttribute,-1);let f=_(l.boundingSphere)?1:0;n[s++]=f,f&&Ee.pack(l.boundingSphere,n,s),s+=Ee.packedLength;let h=_(l.boundingSphereCV)?1:0;n[s++]=h,h&&Ee.pack(l.boundingSphereCV,n,s),s+=Ee.packedLength;let d=l.attributes,p=[];for(let y in d)d.hasOwnProperty(y)&&_(d[y])&&(p.push(y),_(o[y])||(o[y]=r.length,r.push(y)));n[s++]=p.length;for(let y=0;y<p.length;y++){let v=p[y],w=d[v];n[s++]=o[v],n[s++]=w.componentDatatype,n[s++]=w.componentsPerAttribute,n[s++]=w.normalize?1:0,n[s++]=w.values.length,n.set(w.values,s),s+=w.values.length}let g=_(l.indices)?l.indices.length:0;n[s++]=g,g>0&&(n.set(l.indices,s),s+=g)}return t.push(n.buffer),{stringTable:r,packedData:n}};Mm.unpackCreateGeometryResults=function(e){let t=e.stringTable,n=e.packedData,r,o=new Array(n[0]),a=0,s=1;for(;s<n.length;){if(!(n[s++]===1)){o[a++]=void 0;continue}let l=n[s++],c=n[s++],f=n[s++];f===-1&&(f=void 0);let h,d;n[s++]===1&&(h=Ee.unpack(n,s)),s+=Ee.packedLength,n[s++]===1&&(d=Ee.unpack(n,s)),s+=Ee.packedLength;let y,v,w,C=new i0,E=n[s++];for(r=0;r<E;r++){let A=t[n[s++]],D=n[s++];w=n[s++];let P=n[s++]!==0;y=n[s++],v=ie.createTypedArray(D,y);for(let M=0;M<y;M++)v[M]=n[s++];C[A]=new xi({componentDatatype:D,componentsPerAttribute:w,normalize:P,values:v})}let S;if(y=n[s++],y>0){let A=v.length/w;for(S=Rr.createTypedArray(A,y),r=0;r<y;r++)S[r]=n[s++]}o[a++]=new Ci({primitiveType:l,geometryType:c,boundingSphere:h,boundingSphereCV:d,indices:S,attributes:C,offsetAttribute:f})}return o};function Vpe(e,t){let n=e.length,r=new Float64Array(1+n*19),o=0;r[o++]=n;for(let a=0;a<n;a++){let s=e[a];if(U.pack(s.modelMatrix,r,o),o+=U.packedLength,_(s.attributes)&&_(s.attributes.offset)){let u=s.attributes.offset.value;r[o]=u[0],r[o+1]=u[1],r[o+2]=u[2]}o+=3}return t.push(r.buffer),r}function kpe(e){let t=e,n=new Array(t[0]),r=0,o=1;for(;o<t.length;){let a=U.unpack(t,o),s;o+=U.packedLength,_(t[o])&&(s={offset:new Kq(t[o],t[o+1],t[o+2])}),o+=3,n[r++]={modelMatrix:a,attributes:s}}return n}Mm.packCombineGeometryParameters=function(e,t){let n=e.createGeometryResults,r=n.length;for(let o=0;o<r;o++)t.push(n[o].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:Vpe(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof uc,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};Mm.unpackCombineGeometryParameters=function(e){let t=kpe(e.packedInstances),n=e.createGeometryResults,r=n.length,o=0;for(let u=0;u<r;u++){let l=Mm.unpackCreateGeometryResults(n[u]),c=l.length;for(let f=0;f<c;f++){let h=l[f],d=t[o];d.geometry=h,++o}}let a=Ge.clone(e.ellipsoid),s=e.isGeographic?new uc(a):new gC(a);return{instances:t,ellipsoid:a,projection:s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:U.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function Zq(e){let t=e.length,n=1+(Ee.packedLength+1)*t,r=new Float32Array(n),o=0;r[o++]=t;for(let a=0;a<t;++a){let s=e[a];_(s)?(r[o++]=1,Ee.pack(e[a],r,o)):r[o++]=0,o+=Ee.packedLength}return r}function Qq(e){let t=new Array(e[0]),n=0,r=1;for(;r<e.length;)e[r++]===1&&(t[n]=Ee.unpack(e,r)),++n,r+=Ee.packedLength;return t}Mm.packCombineGeometryResults=function(e,t){_(e.geometries)&&Fpe(e.geometries,t);let n=Zq(e.boundingSpheres),r=Zq(e.boundingSpheresCV);return t.push(n.buffer,r.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:r}};Mm.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:Qq(e.boundingSpheres),boundingSpheresCV:Qq(e.boundingSpheresCV)}};var HI=Mm;var Gpe={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},Ua=Object.freeze(Gpe);var Yc={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};Yc.NUMBER_OF_SHADOW_MODES=4;Yc.castShadows=function(e){return e===Yc.ENABLED||e===Yc.CAST_ONLY};Yc.receiveShadows=function(e){return e===Yc.ENABLED||e===Yc.RECEIVE_ONLY};Yc.fromCastReceive=function(e,t){return e&&t?Yc.ENABLED:e?Yc.CAST_ONLY:t?Yc.RECEIVE_ONLY:Yc.DISABLED};var ro=Object.freeze(Yc);function ea(e){e=T(e,T.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._modelMatrix=new U,this.show=T(e.show,!0),this._vertexCacheOptimize=T(e.vertexCacheOptimize,!1),this._interleave=T(e.interleave,!1),this._releaseGeometryInstances=T(e.releaseGeometryInstances,!0),this._allowPicking=T(e.allowPicking,!0),this._asynchronous=T(e.asynchronous,!0),this._compressVertices=T(e.compressVertices,!0),this.cull=T(e.cull,!0),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=T(e.shadows,ro.DISABLED),this._translucent=void 0,this._state=Ua.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1;let t=this;this._readyPromise=new Promise((n,r)=>{t._completeLoad=(o,a,s)=>{this._error=s,this._state=a,o.afterRender.push(function(){t._ready=t._state===Ua.COMPLETE||t._state===Ua.FAILED,_(s)?r(s):n(t)})}}),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(ea.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},pickIds:{get:function(){return this._pickIds}}});function Upe(e){let t=e.length,n=[],r=e[0].attributes,o;for(o in r)if(r.hasOwnProperty(o)&&_(r[o])){let a=r[o],s=!0;for(let u=1;u<t;++u){let l=e[u].attributes[o];if(!_(l)||a.componentDatatype!==l.componentDatatype||a.componentsPerAttribute!==l.componentsPerAttribute||a.normalize!==l.normalize){s=!1;break}}s&&n.push(o)}return n}var Hpe=new X,qpe=new x,a9=new Se;function s9(e){let t=e.length;if(t===1)return e[0];if(t===2)return X.unpack(e,0,Hpe);if(t===3)return x.unpack(e,0,qpe);if(t===4)return Se.unpack(e,0,a9)}function Wpe(e,t){let n=e.geometryInstances,r=Array.isArray(n)?n:[n],o=r.length;if(o===0)return;let a=Upe(r),s=a.length,u=[],l={},c={},f,d=r[0].attributes,p,g,y;for(p=0;p<s;++p)g=a[p],y=d[g],l[g]=p,u.push({functionName:`czm_batchTable_${g}`,componentDatatype:y.componentDatatype,componentsPerAttribute:y.componentsPerAttribute,normalize:y.normalize});a.indexOf("distanceDisplayCondition")!==-1&&(u.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:ie.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:ie.FLOAT,componentsPerAttribute:1}),c.center3DHigh=u.length-5,c.center3DLow=u.length-4,c.center2DHigh=u.length-3,c.center2DLow=u.length-2,c.radius=u.length-1),a.indexOf("offset")!==-1&&(u.push({functionName:"czm_batchTable_offset2D",componentDatatype:ie.FLOAT,componentsPerAttribute:3}),f=u.length-1),u.push({functionName:"czm_batchTable_pickColor",componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let v=u.length,w=new bq(t,u,o);for(p=0;p<o;++p){let C=r[p];d=C.attributes;for(let P=0;P<s;++P){g=a[P],y=d[g];let M=s9(y.value),I=l[g];w.setBatchedAttribute(p,I,M)}let E={primitive:T(C.pickPrimitive,e)};_(C.id)&&(E.id=C.id);let S=t.createPickId(E);e._pickIds.push(S);let A=S.color,D=a9;D.x=K.floatToByte(A.red),D.y=K.floatToByte(A.green),D.z=K.floatToByte(A.blue),D.w=K.floatToByte(A.alpha),w.setBatchedAttribute(p,v-1,D)}e._batchTable=w,e._batchTableAttributeIndices=l,e._batchTableBoundingSphereAttributeIndices=c,e._batchTableOffsetAttribute2DIndex=f}function Ype(e){let t;return Array.isArray(e.values)?t=e.values.slice(0):t=new e.values.constructor(e.values),new xi({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function Xpe(e){let t=e.attributes,n=new i0;for(let o in t)t.hasOwnProperty(o)&&_(t[o])&&(n[o]=Ype(t[o]));let r;if(_(e.indices)){let o=e.indices;Array.isArray(o)?r=o.slice(0):r=new o.constructor(o)}return new Ci({attributes:n,indices:r,primitiveType:e.primitiveType,boundingSphere:Ee.clone(e.boundingSphere)})}function jpe(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:U.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var Kpe=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;ea._modifyShaderPosition=function(e,t,n){let r,o="",a="",s="";for(;(r=Kpe.exec(t))!==null;){let u=r[1],l=`vec4 czm_compute${u[0].toUpperCase()}${u.substr(1)}()`;l!=="vec4 czm_computePosition()"&&(o+=`${l};
`),_(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),o+=`uniform mat4 u_modifiedModelView;
`,a+=`attribute vec4 position;
`,s+=`${l}
{
    return u_modifiedModelView * position;
}

`,t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?s+=`${l}
{
    return czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow);
}

`:(a+=`attribute vec3 ${u}2DHigh;
attribute vec3 ${u}2DLow;
`,s+=`${l}
{
    vec4 p;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(${u}2DHigh.zxy, ${u}2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(${u}2DHigh.zxy, ${u}2DLow.zxy),
                czm_translateRelativeToEye(${u}3DHigh, ${u}3DLow),
                czm_morphTime);
    }
    return p;
}

`)}return[o,a,t,s].join(`
`)};ea._appendShowToShader=function(e,t){return _(e._batchTableAttributeIndices.show)?`${xt.replaceMain(t,"czm_non_show_main")}
void main() 
{ 
    czm_non_show_main(); 
    gl_Position *= czm_batchTable_show(batchId); 
}`:t};ea._updateColorAttribute=function(e,t,n){if(!_(e._batchTableAttributeIndices.color)&&!_(e._batchTableAttributeIndices.depthFailColor)||t.search(/attribute\s+vec4\s+color;/g)===-1)return t;let r=t;return r=r.replace(/attribute\s+vec4\s+color;/g,""),n?r=r.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):r=r.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),r};function Jq(e){return`${xt.replaceMain(e,"czm_non_pick_main")}
varying vec4 v_pickColor; 
void main() 
{ 
    czm_non_pick_main(); 
    v_pickColor = czm_batchTable_pickColor(batchId); 
}`}function $q(e){return`varying vec4 v_pickColor;
${e}`}ea._updatePickColorAttribute=function(e){let t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t};ea._appendOffsetToShader=function(e,t){if(!_(e._batchTableAttributeIndices.offset))return t;let n=`attribute float batchId;
`;n+="attribute float applyOffset;";let r=t.replace(/attribute\s+float\s+batchId;/g,n),o=`vec4 $1 = czm_computePosition();
`;return o+=`    if (czm_sceneMode == czm_sceneMode3D)
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",o+=`    }
`,o+=`    else
`,o+=`    {
`,o+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",o+=`    }
`,r=r.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,o),r};ea._appendDistanceDisplayConditionToShader=function(e,t,n){if(!_(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let r=xt.replaceMain(t,"czm_non_distanceDisplayCondition_main"),o=`void main() 
{ 
    czm_non_distanceDisplayCondition_main(); 
    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);
    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);
    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);
    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);
`;return n?o+=`    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
`:o+=`    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);
    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);
    vec4 centerRTE;
    if (czm_morphTime == 1.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);
    }
    else
    {
        centerRTE = czm_columbusViewMorph(
                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),
                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),
                czm_morphTime);
    }
`,o+=`    float radiusSq = boundingSphereRadius * boundingSphereRadius; 
    float distanceSq; 
    if (czm_sceneMode == czm_sceneMode2D) 
    { 
        distanceSq = czm_eyeHeight2D.y - radiusSq; 
    } 
    else 
    { 
        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; 
    } 
    distanceSq = max(distanceSq, 0.0); 
    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; 
    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; 
    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; 
    gl_Position *= show; 
}`,`${r}
${o}`};function e9(e,t){if(!e.compressVertices)return t;let n=t.search(/attribute\s+vec3\s+normal;/g)!==-1,r=t.search(/attribute\s+vec2\s+st;/g)!==-1;if(!n&&!r)return t;let o=t.search(/attribute\s+vec3\s+tangent;/g)!==-1,a=t.search(/attribute\s+vec3\s+bitangent;/g)!==-1,s=r&&n?2:1;s+=o||a?1:0;let u=s>1?`vec${s}`:"float",l="compressedAttributes",c=`attribute ${u} ${l};`,f="",h="";r&&(f+=`vec2 st;
`,h+=`    st = czm_decompressTextureCoordinates(${s>1?`${l}.x`:l});
`),n&&o&&a?(f+=`vec3 normal;
vec3 tangent;
vec3 bitangent;
`,h+=`    czm_octDecode(${l}.${r?"yz":"xy"}, normal, tangent, bitangent);
`):(n&&(f+=`vec3 normal;
`,h+=`    normal = czm_octDecode(${l}${s>1?`.${r?"y":"x"}`:""});
`),o&&(f+=`vec3 tangent;
`,h+=`    tangent = czm_octDecode(${l}.${r&&n?"z":"y"});
`),a&&(f+=`vec3 bitangent;
`,h+=`    bitangent = czm_octDecode(${l}.${r&&n?"z":"y"});
`));let d=t;d=d.replace(/attribute\s+vec3\s+normal;/g,""),d=d.replace(/attribute\s+vec2\s+st;/g,""),d=d.replace(/attribute\s+vec3\s+tangent;/g,""),d=d.replace(/attribute\s+vec3\s+bitangent;/g,""),d=xt.replaceMain(d,"czm_non_compressed_main");let p=`void main() 
{ 
${h}    czm_non_compressed_main(); 
}`;return[c,f,d,p].join(`
`)}function Zpe(e){let t=xt.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
    gl_Position = czm_depthClamp(gl_Position);}
`,t}function Qpe(e){let t=xt.replaceMain(e,"czm_non_depth_clamp_main");return t+=`void main() {
    czm_non_depth_clamp_main();
#if defined(GL_EXT_frag_depth)
    #if defined(LOG_DEPTH)
        czm_writeLogDepth();
    #else
        czm_writeDepthClamp();
    #endif
#endif
}
`,t=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
${t}`,t}function t9(e,t){let n=e.vertexAttributes}function Jpe(e,t){return function(){return e[t]}}var l2=Math.max(Qo.hardwareConcurrency-1,1),qI,$pe=new Gc("combineGeometry");function eme(e,t){let n,r,o,a,s=e._instanceIds;if(e._state===Ua.READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let u=e._numberOfInstances=n.length,l=[],c=[];for(o=0;o<u;++o)r=n[o].geometry,s.push(n[o].id),c.push({moduleName:r._workerName,geometry:r});if(!_(qI))for(qI=new Array(l2),o=0;o<l2;o++)qI[o]=new Gc("createGeometry");let f;for(c=Tq(c,l2),o=0;o<c.length;o++){let h=0,d=c[o],p=d.length;for(a=0;a<p;++a)f=d[a],r=f.geometry,_(r.constructor.pack)&&(f.offset=h,h+=T(r.constructor.packedLength,r.packedLength));let g;if(h>0){let y=new Float64Array(h);for(g=[y.buffer],a=0;a<p;++a)f=d[a],r=f.geometry,_(r.constructor.pack)&&(r.constructor.pack(r,y,f.offset),f.geometry=y)}l.push(qI[o].scheduleTask({subTasks:c[o]},g))}e._state=Ua.CREATING,Promise.all(l).then(function(h){e._createGeometryResults=h,e._state=Ua.CREATED}).catch(function(h){xE(e,t,Ua.FAILED,h)})}else if(e._state===Ua.CREATED){let u=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let l=t.scene3DOnly,c=t.mapProjection,f=$pe.scheduleTask(HI.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:c.ellipsoid,projection:c,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:l,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},u),u);e._createGeometryResults=void 0,e._state=Ua.COMBINING,Promise.resolve(f).then(function(h){let d=HI.unpackCombineGeometryResults(h);e._geometries=d.geometries,e._attributeLocations=d.attributeLocations,e.modelMatrix=U.clone(d.modelMatrix,e.modelMatrix),e._pickOffsets=d.pickOffsets,e._offsetInstanceExtend=d.offsetInstanceExtend,e._instanceBoundingSpheres=d.boundingSpheres,e._instanceBoundingSpheresCV=d.boundingSpheresCV,_(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=Ua.COMBINED):xE(e,t,Ua.FAILED,void 0)}).catch(function(h){xE(e,t,Ua.FAILED,h)})}}function tme(e,t){let n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],r=e._numberOfInstances=n.length,o=new Array(r),a=e._instanceIds,s,u,l=0;for(u=0;u<r;u++){s=n[u];let d=s.geometry,p;_(d.attributes)&&_(d.primitiveType)?p=Xpe(d):p=d.constructor.createGeometry(d),o[l++]=jpe(s,p),a.push(s.id)}o.length=l;let c=t.scene3DOnly,f=t.mapProjection,h=HI.combineGeometry({instances:o,ellipsoid:f.ellipsoid,projection:f,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:c,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=h.geometries,e._attributeLocations=h.attributeLocations,e.modelMatrix=U.clone(h.modelMatrix,e.modelMatrix),e._pickOffsets=h.pickOffsets,e._offsetInstanceExtend=h.offsetInstanceExtend,e._instanceBoundingSpheres=h.boundingSpheres,e._instanceBoundingSpheresCV=h.boundingSpheresCV,_(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=Ua.COMBINED):xE(e,t,Ua.FAILED,void 0)}function nme(e,t){let n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!_(n)){e._recomputeBoundingSpheres=!1;return}let r,o=e._offsetInstanceExtend,a=e._instanceBoundingSpheres,s=a.length,u=e._tempBoundingSpheres;if(!_(u)){for(u=new Array(s),r=0;r<s;r++)u[r]=new Ee;e._tempBoundingSpheres=u}for(r=0;r<s;++r){let y=u[r],v=e._batchTable.getBatchedAttribute(r,n,new x);y=a[r].clone(y),f9(y,v,o[r])}let l=[],c=[],f=[];for(r=0;r<s;++r){let y=u[r];y.center.x-y.radius>0||Ee.intersectPlane(y,oi.ORIGIN_ZX_PLANE)!==gi.INTERSECTING?l.push(y):(c.push(y),f.push(y))}let h=l[0],d=f[0],p=c[0];for(r=1;r<l.length;r++)h=Ee.union(h,l[r]);for(r=1;r<f.length;r++)d=Ee.union(d,f[r]);for(r=1;r<c.length;r++)p=Ee.union(p,c[r]);let g=[];for(_(h)&&g.push(h),_(d)&&g.push(d),_(p)&&g.push(p),r=0;r<g.length;r++){let y=g[r].clone(e._boundingSpheres[r]);e._boundingSpheres[r]=y,e._boundingSphereCV[r]=Ee.projectTo2D(y,t.mapProjection,e._boundingSphereCV[r])}ea._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}var n9=new ei,u9=new ce,l9=new x,c9=new Ee;function rme(e,t){if(!_(e._batchTableAttributeIndices.distanceDisplayCondition)||e._batchTableBoundingSpheresUpdated)return;let r=e._batchTableBoundingSphereAttributeIndices,o=r.center3DHigh,a=r.center3DLow,s=r.center2DHigh,u=r.center2DLow,l=r.radius,c=t.mapProjection,f=c.ellipsoid,h=e._batchTable,d=e._instanceBoundingSpheres,p=d.length;for(let g=0;g<p;++g){let y=d[g];if(!_(y))continue;let v=e.modelMatrix;_(v)&&(y=Ee.transform(y,v,c9));let w=y.center,C=y.radius,E=ei.fromCartesian(w,n9);if(h.setBatchedAttribute(g,o,E.high),h.setBatchedAttribute(g,a,E.low),!t.scene3DOnly){let S=f.cartesianToCartographic(w,u9),A=c.project(S,l9);E=ei.fromCartesian(A,n9),h.setBatchedAttribute(g,s,E.high),h.setBatchedAttribute(g,u,E.low)}h.setBatchedAttribute(g,l,C)}e._batchTableBoundingSpheresUpdated=!0}var c2=new x,ime=new x;function r9(e,t){if(!_(e._batchTableAttributeIndices.offset)||e._batchTableOffsetsUpdated||t.scene3DOnly)return;let r=e._batchTableOffsetAttribute2DIndex,o=t.mapProjection,a=o.ellipsoid,s=e._batchTable,u=e._instanceBoundingSpheres,l=u.length;for(let c=0;c<l;++c){let f=u[c];if(!_(f))continue;let h=s.getBatchedAttribute(c,e._batchTableAttributeIndices.offset);if(x.equals(h,x.ZERO)){s.setBatchedAttribute(c,r,x.ZERO);continue}let d=e.modelMatrix;_(d)&&(f=Ee.transform(f,d,c9));let p=f.center;p=a.scaleToGeodeticSurface(p,ime);let g=a.cartesianToCartographic(p,u9),y=o.project(g,l9),v=x.add(h,p,c2);g=a.cartesianToCartographic(v,g);let w=o.project(g,c2),C=x.subtract(w,y,c2),E=C.x;C.x=C.z,C.z=C.y,C.y=E,s.setBatchedAttribute(c,r,C)}e._batchTableOffsetsUpdated=!0}function ome(e,t){let n=e._attributeLocations,r=e._geometries,o=t.scene3DOnly,a=t.context,s=[],u=r.length;for(let l=0;l<u;++l){let c=r[l];if(s.push(Kh.fromGeometry({context:a,geometry:c,attributeLocations:n,bufferUsage:We.STATIC_DRAW,interleave:e._interleave})),_(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,c);else if(e._boundingSpheres.push(Ee.clone(c.boundingSphere)),e._boundingSphereWC.push(new Ee),!o){let f=c.boundingSphereCV.center,h=f.x,d=f.y,p=f.z;f.x=p,f.y=h,f.z=d,e._boundingSphereCV.push(Ee.clone(c.boundingSphereCV)),e._boundingSphere2D.push(new Ee),e._boundingSphereMorph.push(new Ee)}}e._va=s,e._primitiveType=r[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,xE(e,t,Ua.COMPLETE,void 0)}function ame(e,t,n,r){let o=n.getRenderState(),a;r?(a=kt(o,!1),a.cull={enabled:!0,face:rd.BACK},e._frontFaceRS=un.fromCache(a),a.cull.face=rd.FRONT,e._backFaceRS=un.fromCache(a)):(e._frontFaceRS=un.fromCache(o),e._backFaceRS=e._frontFaceRS),a=kt(o,!1),_(e._depthFailAppearance)&&(a.depthTest.enabled=!1),_(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),a=kt(o,!1),a.depthTest.func=o0.GREATER,r?(a.cull={enabled:!0,face:rd.BACK},e._frontFaceDepthFailRS=un.fromCache(a),a.cull.face=rd.FRONT,e._backFaceDepthFailRS=un.fromCache(a)):(e._frontFaceDepthFailRS=un.fromCache(a),e._backFaceDepthFailRS=e._frontFaceRS))}function sme(e,t,n){let r=t.context,o=e._attributeLocations,a=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);a=ea._appendOffsetToShader(e,a),a=ea._appendShowToShader(e,a),a=ea._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=Jq(a),a=ea._updateColorAttribute(e,a,!1),a=e9(e,a),a=ea._modifyShaderPosition(e,a,t.scene3DOnly);let s=n.getFragmentShaderSource();s=$q(s),e._sp=vi.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:o}),t9(e._sp,o),_(e._depthFailAppearance)&&(a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),a=ea._appendShowToShader(e,a),a=ea._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=Jq(a),a=ea._updateColorAttribute(e,a,!0),a=e9(e,a),a=ea._modifyShaderPosition(e,a,t.scene3DOnly),a=Zpe(a),s=e._depthFailAppearance.getFragmentShaderSource(),s=$q(s),s=Qpe(s),e._spDepthFail=vi.replaceCache({context:r,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:o}),t9(e._spDepthFail,o))}var CE=new U,i9=new x;function o9(e,t,n,r){let o=_(n)?n._uniforms:void 0,a={},s=t.uniforms;if(_(s))for(let l in s)s.hasOwnProperty(l)&&(a[l]=Jpe(s,l));let u=Yi(a,o);return u=e._batchTable.getUniformMapCallback()(u),_(e.rtcCenter)&&(u.u_modifiedModelView=function(){let l=r.context.uniformState.view;return U.multiply(l,e._modelMatrix,CE),U.multiplyByPoint(CE,e.rtcCenter,i9),U.setTranslation(CE,i9,CE),CE}),u}function ume(e,t,n,r,o,a,s,u){let l=o9(e,t,n,u),c;_(e._depthFailAppearance)&&(c=o9(e,e._depthFailAppearance,e._depthFailAppearance.material,u));let f=r?Qt.TRANSLUCENT:Qt.OPAQUE,h=o?2:1;h*=_(e._depthFailAppearance)?2:1,a.length=e._va.length*h;let d=a.length,p=0;for(let g=0;g<d;++g){let y;o&&(y=a[g],_(y)||(y=a[g]=new Zt({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._backFaceRS,y.shaderProgram=e._sp,y.uniformMap=l,y.pass=f,++g),y=a[g],_(y)||(y=a[g]=new Zt({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._frontFaceRS,y.shaderProgram=e._sp,y.uniformMap=l,y.pass=f,_(e._depthFailAppearance)&&(o&&(++g,y=a[g],_(y)||(y=a[g]=new Zt({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._backFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=c,y.pass=f),++g,y=a[g],_(y)||(y=a[g]=new Zt({owner:e,primitiveType:e._primitiveType})),y.vertexArray=e._va[p],y.renderState=e._frontFaceDepthFailRS,y.shaderProgram=e._spDepthFail,y.uniformMap=c,y.pass=f),++p}}ea._updateBoundingVolumes=function(e,t,n,r){let o,a,s;if(r||!U.equals(n,e._modelMatrix))for(U.clone(n,e._modelMatrix),a=e._boundingSpheres.length,o=0;o<a;++o)s=e._boundingSpheres[o],_(s)&&(e._boundingSphereWC[o]=Ee.transform(s,n,e._boundingSphereWC[o]),t.scene3DOnly||(e._boundingSphere2D[o]=Ee.clone(e._boundingSphereCV[o],e._boundingSphere2D[o]),e._boundingSphere2D[o].center.x=0,e._boundingSphereMorph[o]=Ee.union(e._boundingSphereWC[o],e._boundingSphereCV[o])));let u=e.appearance.pixelSize;if(_(u))for(a=e._boundingSpheres.length,o=0;o<a;++o){s=e._boundingSpheres[o];let l=e._boundingSphereWC[o],f=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*u;l.radius=s.radius+f}};function lme(e,t,n,r,o,a,s,u){ea._updateBoundingVolumes(e,t,o);let l;t.mode===Ne.SCENE3D?l=e._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?l=e._boundingSphereCV:t.mode===Ne.SCENE2D&&_(e._boundingSphere2D)?l=e._boundingSphere2D:_(e._boundingSphereMorph)&&(l=e._boundingSphereMorph);let c=t.commandList,f=t.passes;if(f.render||f.pick){let h=e.allowPicking,d=ro.castShadows(e.shadows),p=ro.receiveShadows(e.shadows),g=n.length,y=u?2:1;y*=_(e._depthFailAppearance)?2:1;for(let v=0;v<g;++v){let w=Math.floor(v/y),C=n[v];C.modelMatrix=o,C.boundingVolume=l[w],C.cull=a,C.debugShowBoundingVolume=s,C.castShadows=d,C.receiveShadows=p,h?C.pickId="v_pickColor":C.pickId=void 0,c.push(C)}}}ea.prototype.update=function(e){if(!_(this.geometryInstances)&&this._va.length===0||_(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&this.geometryInstances.length===0||!_(this.appearance)||e.mode!==Ne.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(_(this._error))throw this._error;if(this._state===Ua.FAILED)return;let t=e.context;if(_(this._batchTable)||Wpe(this,t),this._batchTable.attributes.length>0){if(Kt.maximumVertexTextureImageUnits===0)throw new it("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==Ua.COMPLETE&&this._state!==Ua.COMBINED&&(this.asynchronous?eme(this,e):tme(this,e)),this._state===Ua.COMBINED&&(rme(this,e),r9(this,e),ome(this,e)),!this.show||this._state!==Ua.COMPLETE)return;this._batchTableOffsetsUpdated||r9(this,e),this._recomputeBoundingSpheres&&nme(this,e);let n=this.appearance,r=n.material,o=!1,a=!1;this._appearance!==n?(this._appearance=n,this._material=r,o=!0,a=!0):this._material!==r&&(this._material=r,a=!0);let s=this.depthFailAppearance,u=_(s)?s.material:void 0;this._depthFailAppearance!==s?(this._depthFailAppearance=s,this._depthFailMaterial=u,o=!0,a=!0):this._depthFailMaterial!==u&&(this._depthFailMaterial=u,a=!0);let l=this._appearance.isTranslucent();this._translucent!==l&&(this._translucent=l,o=!0),_(this._material)&&this._material.update(t);let c=n.closed&&l;o&&T(this._createRenderStatesFunction,ame)(this,t,n,c),a&&T(this._createShaderProgramFunction,sme)(this,e,n),(o||a)&&T(this._createCommandsFunction,ume)(this,n,r,l,c,this._colorCommands,this._pickCommands,e),T(this._updateAndQueueCommandsFunction,lme)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,c)};var cme=new Ee,fme=new Ee;function f9(e,t,n){if(n===KN.TOP){let r=Ee.clone(e,cme),o=Ee.clone(e,fme);o.center=x.add(o.center,t,o.center),e=Ee.union(r,o,e)}else n===KN.ALL&&(e.center=x.add(e.center,t,e.center));return e}function hme(e,t,n){return function(){let r=e.getBatchedAttribute(t,n),o=e.attributes[n],a=o.componentsPerAttribute,s=ie.createTypedArray(o.componentDatatype,a);return _(r.constructor.pack)?r.constructor.pack(r,s,0):s[0]=r,s}}function dme(e,t,n,r,o){return function(a){let s=s9(a);e.setBatchedAttribute(t,n,s),o==="offset"&&(r._recomputeBoundingSpheres=!0,r._batchTableOffsetsUpdated=!1)}}var pme=new x;function mme(e,t,n){t.boundingSphere={get:function(){let r=e._instanceBoundingSpheres[n];if(_(r)){r=r.clone();let o=e.modelMatrix,a=t.offset;_(a)&&f9(r,x.fromArray(a.get(),0,pme),e._offsetInstanceExtend[n]),_(o)&&(r=Ee.transform(r,o))}return r}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function gme(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}ea.prototype.getGeometryInstanceAttributes=function(e){let t=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,o=r.length;for(let c=0;c<o;++c){let f=(n+c)%o;if(e===r[f]){t=f;break}}if(t===-1)return;let a=this._perInstanceAttributeCache[t];if(_(a))return a;let s=this._batchTable,u=this._batchTableAttributeIndices;a={};let l={};for(let c in u)if(u.hasOwnProperty(c)){let f=u[c];l[c]={get:hme(s,t,f),set:dme(s,t,f,this,c)}}return mme(this,l,t),gme(this,l,t),Object.defineProperties(a,l),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=a,a};ea.prototype.isDestroyed=function(){return!1};ea.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;let r=this._pickIds;for(e=r.length,t=0;t<e;++t)r[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,ot(this)};function xE(e,t,n,r){e._completeLoad(t,n,r)}var Xs=ea;var _me={NEVER:V.NEVER,LESS:V.LESS,EQUAL:V.EQUAL,LESS_OR_EQUAL:V.LEQUAL,GREATER:V.GREATER,NOT_EQUAL:V.NOTEQUAL,GREATER_OR_EQUAL:V.GEQUAL,ALWAYS:V.ALWAYS},tl=Object.freeze(_me);var yme={ZERO:V.ZERO,KEEP:V.KEEP,REPLACE:V.REPLACE,INCREMENT:V.INCR,DECREMENT:V.DECR,INVERT:V.INVERT,INCREMENT_WRAP:V.INCR_WRAP,DECREMENT_WRAP:V.DECR_WRAP},Kr=Object.freeze(yme);var WI={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15};WI.setCesium3DTileBit=function(){return{enabled:!0,frontFunction:tl.ALWAYS,frontOperation:{fail:Kr.KEEP,zFail:Kr.KEEP,zPass:Kr.REPLACE},backFunction:tl.ALWAYS,backOperation:{fail:Kr.KEEP,zFail:Kr.KEEP,zPass:Kr.REPLACE},reference:WI.CESIUM_3D_TILE_MASK,mask:WI.CESIUM_3D_TILE_MASK}};var io=Object.freeze(WI);function Lm(e){e=T(e,T.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;let t=e.appearance;_(t)||(t=new Eq),this.appearance=t,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,ka.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1;let n=this;this._readyPromise=new Promise((r,o)=>{n._completeLoad=()=>{this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let a=this._error;_(a)?o(a):r(this)}}),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=h9(!1),this._renderState3DTiles=h9(!0),this._renderStateMorph=un.fromCache({cull:{enabled:!0,face:rd.FRONT},depthTest:{enabled:!0},blending:za.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1})}Object.defineProperties(Lm.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}});Lm.initializeTerrainHeights=function(){return Hc.initialize()};function vme(e,t,n){let r=t.context,o=e._primitive,a=o._attributeLocations,s=o._batchTable.getVertexShaderCallback()(jH);s=Xs._appendShowToShader(o,s),s=Xs._appendDistanceDisplayConditionToShader(o,s),s=Xs._modifyShaderPosition(e,s,t.scene3DOnly);let u=o._batchTable.getVertexShaderCallback()(XH);u=Xs._appendShowToShader(o,u),u=Xs._appendDistanceDisplayConditionToShader(o,u),u=Xs._modifyShaderPosition(e,u,t.scene3DOnly);let l=o._batchTable.getVertexShaderCallback()(WH),c=[`GLOBE_MINIMUM_ALTITUDE ${t.mapProjection.ellipsoid.minimumRadius.toFixed(1)}`],f="",h="";_(n.material)?(h=_(n.material)?n.material.shaderSource:"",h.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&c.push("ANGLE_VARYING"),h.search(/varying\s+float\s+v_width;/g)!==-1&&c.push("WIDTH_VARYING")):f="PER_INSTANCE_COLOR",c.push(f);let d=e.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",f]:[f],p=new xt({defines:c,sources:[s]}),g=new xt({defines:d,sources:[h,l]});e._sp=vi.replaceCache({context:r,shaderProgram:o._sp,vertexShaderSource:p,fragmentShaderSource:g,attributeLocations:a});let y=r.shaderCache.getDerivedShaderProgram(e._sp,"2dColor");if(!_(y)){let w=new xt({defines:c.concat(["COLUMBUS_VIEW_2D"]),sources:[s]});y=r.shaderCache.createDerivedShaderProgram(e._sp,"2dColor",{context:r,shaderProgram:e._sp2D,vertexShaderSource:w,fragmentShaderSource:g,attributeLocations:a})}e._sp2D=y;let v=r.shaderCache.getDerivedShaderProgram(e._sp,"MorphColor");if(!_(v)){let w=new xt({defines:c.concat([`MAX_TERRAIN_HEIGHT ${Hc._defaultMaxTerrainHeight.toFixed(1)}`]),sources:[u]});l=o._batchTable.getVertexShaderCallback()(YH);let C=new xt({defines:d,sources:[h,l]});v=r.shaderCache.createDerivedShaderProgram(e._sp,"MorphColor",{context:r,shaderProgram:e._spMorph,vertexShaderSource:w,fragmentShaderSource:C,attributeLocations:a})}e._spMorph=v}function h9(e){return un.fromCache({cull:{enabled:!0},blending:za.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:tl.EQUAL,frontOperation:{fail:Kr.KEEP,zFail:Kr.KEEP,zPass:Kr.KEEP},backFunction:tl.EQUAL,backOperation:{fail:Kr.KEEP,zFail:Kr.KEEP,zPass:Kr.KEEP},reference:io.CESIUM_3D_TILE_MASK,mask:io.CESIUM_3D_TILE_MASK}})}function Cme(e,t,n,r,o,a){let s=e._primitive,u=s._va.length;o.length=u,a.length=u;let c=t instanceof YN?{}:n._uniforms,f=s._batchTable.getUniformMapCallback()(c);for(let h=0;h<u;h++){let d=s._va[h],p=o[h];_(p)||(p=o[h]=new Zt({owner:e,primitiveType:s._primitiveType})),p.vertexArray=d,p.renderState=e._renderState,p.shaderProgram=e._sp,p.uniformMap=f,p.pass=Qt.TERRAIN_CLASSIFICATION,p.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";let g=Zt.shallowClone(p,p.derivedCommands.tileset);g.renderState=e._renderState3DTiles,g.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION,p.derivedCommands.tileset=g;let y=Zt.shallowClone(p,p.derivedCommands.color2D);y.shaderProgram=e._sp2D,p.derivedCommands.color2D=y;let v=Zt.shallowClone(g,g.derivedCommands.color2D);v.shaderProgram=e._sp2D,g.derivedCommands.color2D=v;let w=Zt.shallowClone(p,p.derivedCommands.colorMorph);w.renderState=e._renderStateMorph,w.shaderProgram=e._spMorph,w.pickId="czm_batchTable_pickColor(v_batchId)",p.derivedCommands.colorMorph=w}}function d9(e,t,n,r,o,a,s){n.mode===Ne.MORPHING?t=t.derivedCommands.colorMorph:n.mode!==Ne.SCENE3D&&(t=t.derivedCommands.color2D),t.modelMatrix=r,t.boundingVolume=a,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function xme(e,t,n,r,o,a,s){let u=e._primitive;Xs._updateBoundingVolumes(u,t,o);let l;t.mode===Ne.SCENE3D?l=u._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?l=u._boundingSphereCV:t.mode===Ne.SCENE2D&&_(u._boundingSphere2D)?l=u._boundingSphere2D:_(u._boundingSphereMorph)&&(l=u._boundingSphereMorph);let c=t.mode===Ne.MORPHING,f=e.classificationType,h=f!==ka.CESIUM_3D_TILE,d=f!==ka.TERRAIN&&!c,p,g=t.passes;if(g.render||g.pick&&u.allowPicking){let y=n.length;for(let v=0;v<y;++v){let w=l[v];h&&(p=n[v],d9(e,p,t,o,a,w,s)),d&&(p=n[v].derivedCommands.tileset,d9(e,p,t,o,a,w,s))}}}Lm.prototype.update=function(e){if(!_(this._primitive)&&!_(this.geometryInstances))return;if(!Hc.initialized){Lm.initializeTerrainHeights();return}let t,n=this,r=this._primitiveOptions;if(!_(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length,s=new Array(a),u;for(t=0;t<a;++t)if(u=o[t].attributes,!_(u)||!_(u.color)){this._hasPerInstanceColors=!1;break}for(t=0;t<a;++t){let l=o[t];u={};let c=l.attributes;for(let f in c)c.hasOwnProperty(f)&&(u[f]=c[f]);_(u.width)||(u.width=new qc({componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:1,value:[l.geometry.width]})),l.geometry._scene3DOnly=e.scene3DOnly,qH.setProjectionAndEllipsoid(l.geometry,e.mapProjection),s[t]=new H_({geometry:l.geometry,attributes:u,id:l.id,pickPrimitive:n})}r.geometryInstances=s,r.appearance=this.appearance,r._createShaderProgramFunction=function(l,c,f){vme(n,c,f)},r._createCommandsFunction=function(l,c,f,h,d,p,g){Cme(n,c,f,h,p,g)},r._updateAndQueueCommandsFunction=function(l,c,f,h,d,p,g,y){xme(n,c,f,h,d,p,g)},this._primitive=new Xs(r),this._primitive.readyPromise.then(this._completeLoad)}if(this.appearance instanceof YN&&!this._hasPerInstanceColors)throw new Le("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)};Lm.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};Lm.isSupported=function(e){return e.frameState.context.depthTexture};Lm.prototype.isDestroyed=function(){return!1};Lm.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,ot(this)};var p9=Lm;function Ll(e,t,n){this.minimum=x.clone(T(e,x.ZERO)),this.maximum=x.clone(T(t,x.ZERO)),_(n)?n=x.clone(n):n=x.midpoint(this.minimum,this.maximum,new x),this.center=n}Ll.fromCorners=function(e,t,n){return _(n)||(n=new Ll),n.minimum=x.clone(e,n.minimum),n.maximum=x.clone(t,n.maximum),n.center=x.midpoint(e,t,n.center),n};Ll.fromPoints=function(e,t){if(_(t)||(t=new Ll),!_(e)||e.length===0)return t.minimum=x.clone(x.ZERO,t.minimum),t.maximum=x.clone(x.ZERO,t.maximum),t.center=x.clone(x.ZERO,t.center),t;let n=e[0].x,r=e[0].y,o=e[0].z,a=e[0].x,s=e[0].y,u=e[0].z,l=e.length;for(let h=1;h<l;h++){let d=e[h],p=d.x,g=d.y,y=d.z;n=Math.min(p,n),a=Math.max(p,a),r=Math.min(g,r),s=Math.max(g,s),o=Math.min(y,o),u=Math.max(y,u)}let c=t.minimum;c.x=n,c.y=r,c.z=o;let f=t.maximum;return f.x=a,f.y=s,f.z=u,t.center=x.midpoint(c,f,t.center),t};Ll.clone=function(e,t){if(!!_(e))return _(t)?(t.minimum=x.clone(e.minimum,t.minimum),t.maximum=x.clone(e.maximum,t.maximum),t.center=x.clone(e.center,t.center),t):new Ll(e.minimum,e.maximum,e.center)};Ll.equals=function(e,t){return e===t||_(e)&&_(t)&&x.equals(e.center,t.center)&&x.equals(e.minimum,t.minimum)&&x.equals(e.maximum,t.maximum)};var YI=new x;Ll.intersectPlane=function(e,t){YI=x.subtract(e.maximum,e.minimum,YI);let n=x.multiplyByScalar(YI,.5,YI),r=t.normal,o=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),a=x.dot(e.center,r)+t.distance;return a-o>0?gi.INSIDE:a+o<0?gi.OUTSIDE:gi.INTERSECTING};Ll.prototype.clone=function(e){return Ll.clone(this,e)};Ll.prototype.intersectPlane=function(e){return Ll.intersectPlane(this,e)};Ll.prototype.equals=function(e){return Ll.equals(this,e)};var f2=Ll;var h2=new Se;function cp(e,t){t=T(t,Ge.WGS84),e=t.scaleToGeodeticSurface(e);let n=yn.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=x.fromCartesian4(U.getColumn(n,0,h2)),this._yAxis=x.fromCartesian4(U.getColumn(n,1,h2));let r=x.fromCartesian4(U.getColumn(n,2,h2));this._plane=oi.fromPointNormal(e,r)}Object.defineProperties(cp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var wme=new f2;cp.fromPoints=function(e,t){let n=f2.fromPoints(e,wme);return new cp(n.center,t)};var m9=new q_,XI=new x;cp.prototype.projectPointOntoPlane=function(e,t){let n=m9;n.origin=e,x.normalize(e,n.direction);let r=Wc.rayPlane(n,this._plane,XI);if(_(r)||(x.negate(n.direction,n.direction),r=Wc.rayPlane(n,this._plane,XI)),_(r)){let o=x.subtract(r,this._origin,r),a=x.dot(this._xAxis,o),s=x.dot(this._yAxis,o);return _(t)?(t.x=a,t.y=s,t):new X(a,s)}};cp.prototype.projectPointsOntoPlane=function(e,t){_(t)||(t=[]);let n=0,r=e.length;for(let o=0;o<r;o++){let a=this.projectPointOntoPlane(e[o],t[n]);_(a)&&(t[n]=a,n++)}return t.length=n,t};cp.prototype.projectPointToNearestOnPlane=function(e,t){_(t)||(t=new X);let n=m9;n.origin=e,x.clone(this._plane.normal,n.direction);let r=Wc.rayPlane(n,this._plane,XI);_(r)||(x.negate(n.direction,n.direction),r=Wc.rayPlane(n,this._plane,XI));let o=x.subtract(r,this._origin,r),a=x.dot(this._xAxis,o),s=x.dot(this._yAxis,o);return t.x=a,t.y=s,t};cp.prototype.projectPointsToNearestOnPlane=function(e,t){_(t)||(t=[]);let n=e.length;t.length=n;for(let r=0;r<n;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};var Eme=new x;cp.prototype.projectPointOntoEllipsoid=function(e,t){_(t)||(t=new x);let n=this._ellipsoid,r=this._origin,o=this._xAxis,a=this._yAxis,s=Eme;return x.multiplyByScalar(o,e.x,s),t=x.add(r,s,t),x.multiplyByScalar(a,e.y,s),x.add(t,s,t),n.scaleToGeocentricSurface(t,t),t};cp.prototype.projectPointsOntoEllipsoid=function(e,t){let n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.projectPointOntoEllipsoid(e[r],t[r]);return t};var s0=cp;function Zr(e,t){this.center=x.clone(T(e,x.ZERO)),this.halfAxes=ne.clone(T(t,ne.ZERO))}Zr.packedLength=x.packedLength+ne.packedLength;Zr.pack=function(e,t,n){return n=T(n,0),x.pack(e.center,t,n),ne.pack(e.halfAxes,t,n+x.packedLength),t};Zr.unpack=function(e,t,n){return t=T(t,0),_(n)||(n=new Zr),x.unpack(e,t,n.center),ne.unpack(e,t+x.packedLength,n.halfAxes),n};var Tme=new x,Sme=new x,Ame=new x,bme=new x,Ime=new x,Dme=new x,Pme=new ne,Mme={unitary:new ne,diagonal:new ne};Zr.fromPoints=function(e,t){if(_(t)||(t=new Zr),!_(e)||e.length===0)return t.halfAxes=ne.ZERO,t.center=x.ZERO,t;let n,r=e.length,o=x.clone(e[0],Tme);for(n=1;n<r;n++)x.add(o,e[n],o);let a=1/r;x.multiplyByScalar(o,a,o);let s=0,u=0,l=0,c=0,f=0,h=0,d;for(n=0;n<r;n++)d=x.subtract(e[n],o,Sme),s+=d.x*d.x,u+=d.x*d.y,l+=d.x*d.z,c+=d.y*d.y,f+=d.y*d.z,h+=d.z*d.z;s*=a,u*=a,l*=a,c*=a,f*=a,h*=a;let p=Pme;p[0]=s,p[1]=u,p[2]=l,p[3]=u,p[4]=c,p[5]=f,p[6]=l,p[7]=f,p[8]=h;let g=ne.computeEigenDecomposition(p,Mme),y=ne.clone(g.unitary,t.halfAxes),v=ne.getColumn(y,0,bme),w=ne.getColumn(y,1,Ime),C=ne.getColumn(y,2,Dme),E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,A=-Number.MAX_VALUE,D=Number.MAX_VALUE,P=Number.MAX_VALUE,M=Number.MAX_VALUE;for(n=0;n<r;n++)d=e[n],E=Math.max(x.dot(v,d),E),S=Math.max(x.dot(w,d),S),A=Math.max(x.dot(C,d),A),D=Math.min(x.dot(v,d),D),P=Math.min(x.dot(w,d),P),M=Math.min(x.dot(C,d),M);v=x.multiplyByScalar(v,.5*(D+E),v),w=x.multiplyByScalar(w,.5*(P+S),w),C=x.multiplyByScalar(C,.5*(M+A),C);let I=x.add(v,w,t.center);x.add(I,C,I);let O=Ame;return O.x=E-D,O.y=S-P,O.z=A-M,x.multiplyByScalar(O,.5,O),ne.multiplyByScale(t.halfAxes,O,t.halfAxes),t};var x9=new x,Lme=new x;function g9(e,t,n,r,o,a,s,u,l,c,f){_(f)||(f=new Zr);let h=f.halfAxes;ne.setColumn(h,0,t,h),ne.setColumn(h,1,n,h),ne.setColumn(h,2,r,h);let d=x9;d.x=(o+a)/2,d.y=(s+u)/2,d.z=(l+c)/2;let p=Lme;p.x=(a-o)/2,p.y=(u-s)/2,p.z=(c-l)/2;let g=f.center;return d=ne.multiplyByVector(h,d,d),x.add(e,d,g),ne.multiplyByScale(h,p,h),f}var _9=new ce,Rme=new x,Ome=new ce,Nme=new ce,Bme=new ce,Fme=new ce,zme=new ce,Vme=new x,y9=new x,kme=new x,v9=new x,Gme=new x,Ume=new X,Hme=new X,qme=new X,Wme=new X,Yme=new X,Xme=new x,jme=new x,Kme=new x,Zme=new x,Qme=new X,Jme=new x,$me=new x,ege=new x,tge=new oi(x.UNIT_X,0);Zr.fromRectangle=function(e,t,n,r,o){t=T(t,0),n=T(n,0),r=T(r,Ge.WGS84);let a,s,u,l,c,f,h;if(e.width<=z.PI){let P=ln.center(e,_9),M=r.cartographicToCartesian(P,Rme),I=new s0(M,r);h=I.plane;let O=P.longitude,m=e.south<0&&e.north>0?0:P.latitude,b=ce.fromRadians(O,e.north,n,Ome),L=ce.fromRadians(e.west,e.north,n,Nme),R=ce.fromRadians(e.west,m,n,Bme),N=ce.fromRadians(e.west,e.south,n,Fme),B=ce.fromRadians(O,e.south,n,zme),G=r.cartographicToCartesian(b,Vme),F=r.cartographicToCartesian(L,y9),k=r.cartographicToCartesian(R,kme),Z=r.cartographicToCartesian(N,v9),te=r.cartographicToCartesian(B,Gme),oe=I.projectPointToNearestOnPlane(G,Ume),ue=I.projectPointToNearestOnPlane(F,Hme),pe=I.projectPointToNearestOnPlane(k,qme),me=I.projectPointToNearestOnPlane(Z,Wme),st=I.projectPointToNearestOnPlane(te,Yme);return a=Math.min(ue.x,pe.x,me.x),s=-a,l=Math.max(ue.y,oe.y),u=Math.min(me.y,st.y),L.height=N.height=t,F=r.cartographicToCartesian(L,y9),Z=r.cartographicToCartesian(N,v9),c=Math.min(oi.getPointDistance(h,F),oi.getPointDistance(h,Z)),f=n,g9(I.origin,I.xAxis,I.yAxis,I.zAxis,a,s,u,l,c,f,o)}let d=e.south>0,p=e.north<0,g=d?e.south:p?e.north:0,y=ln.center(e,_9).longitude,v=x.fromRadians(y,g,n,r,Xme);v.z=0;let C=Math.abs(v.x)<z.EPSILON10&&Math.abs(v.y)<z.EPSILON10?x.UNIT_X:x.normalize(v,jme),E=x.UNIT_Z,S=x.cross(C,E,Kme);h=oi.fromPointNormal(v,C,tge);let A=x.fromRadians(y+z.PI_OVER_TWO,g,n,r,Zme);s=x.dot(oi.projectPointOntoPlane(h,A,Qme),S),a=-s,l=x.fromRadians(0,e.north,p?t:n,r,Jme).z,u=x.fromRadians(0,e.south,d?t:n,r,$me).z;let D=x.fromRadians(e.east,g,n,r,ege);return c=oi.getPointDistance(h,D),f=0,g9(v,S,E,C,a,s,u,l,c,f,o)};Zr.fromTransformation=function(e,t){return _(t)||(t=new Zr),t.center=U.getTranslation(e,t.center),t.halfAxes=U.getMatrix3(e,t.halfAxes),t.halfAxes=ne.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t};Zr.clone=function(e,t){if(!!_(e))return _(t)?(x.clone(e.center,t.center),ne.clone(e.halfAxes,t.halfAxes),t):new Zr(e.center,e.halfAxes)};Zr.intersectPlane=function(e,t){let n=e.center,r=t.normal,o=e.halfAxes,a=r.x,s=r.y,u=r.z,l=Math.abs(a*o[ne.COLUMN0ROW0]+s*o[ne.COLUMN0ROW1]+u*o[ne.COLUMN0ROW2])+Math.abs(a*o[ne.COLUMN1ROW0]+s*o[ne.COLUMN1ROW1]+u*o[ne.COLUMN1ROW2])+Math.abs(a*o[ne.COLUMN2ROW0]+s*o[ne.COLUMN2ROW1]+u*o[ne.COLUMN2ROW2]),c=x.dot(r,n)+t.distance;return c<=-l?gi.OUTSIDE:c>=l?gi.INSIDE:gi.INTERSECTING};var w9=new x,E9=new x,T9=new x,nge=new x,C9=new x,rge=new x;Zr.distanceSquaredTo=function(e,t){let n=x.subtract(t,e.center,x9),r=e.halfAxes,o=ne.getColumn(r,0,w9),a=ne.getColumn(r,1,E9),s=ne.getColumn(r,2,T9),u=x.magnitude(o),l=x.magnitude(a),c=x.magnitude(s),f=!0,h=!0,d=!0;u>0?x.divideByScalar(o,u,o):f=!1,l>0?x.divideByScalar(a,l,a):h=!1,c>0?x.divideByScalar(s,c,s):d=!1;let p=!f+!h+!d,g,y,v;if(p===1){let S=o;g=a,y=s,h?d||(S=s,y=o):(S=a,g=o),v=x.cross(g,y,C9),S===o?o=v:S===a?a=v:S===s&&(s=v)}else if(p===2){g=o,h?g=a:d&&(g=s);let S=x.UNIT_Y;S.equalsEpsilon(g,z.EPSILON3)&&(S=x.UNIT_X),y=x.cross(g,S,nge),x.normalize(y,y),v=x.cross(g,y,C9),x.normalize(v,v),g===o?(a=y,s=v):g===a?(s=y,o=v):g===s&&(o=y,a=v)}else p===3&&(o=x.UNIT_X,a=x.UNIT_Y,s=x.UNIT_Z);let w=rge;w.x=x.dot(n,o),w.y=x.dot(n,a),w.z=x.dot(n,s);let C=0,E;return w.x<-u?(E=w.x+u,C+=E*E):w.x>u&&(E=w.x-u,C+=E*E),w.y<-l?(E=w.y+l,C+=E*E):w.y>l&&(E=w.y-l,C+=E*E),w.z<-c?(E=w.z+c,C+=E*E):w.z>c&&(E=w.z-c,C+=E*E),C};var ige=new x,oge=new x;Zr.computePlaneDistances=function(e,t,n,r){_(r)||(r=new $d);let o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=e.center,u=e.halfAxes,l=ne.getColumn(u,0,w9),c=ne.getColumn(u,1,E9),f=ne.getColumn(u,2,T9),h=x.add(l,c,ige);x.add(h,f,h),x.add(h,s,h);let d=x.subtract(h,t,oge),p=x.dot(n,d);return o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.add(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.subtract(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.add(s,l,h),x.subtract(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.add(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.add(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.subtract(h,c,h),x.add(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),x.subtract(s,l,h),x.subtract(h,c,h),x.subtract(h,f,h),x.subtract(h,t,d),p=x.dot(n,d),o=Math.min(p,o),a=Math.max(p,a),r.start=o,r.stop=a,r};var age=new x,sge=new x,uge=new x;Zr.computeCorners=function(e,t){_(t)||(t=[new x,new x,new x,new x,new x,new x,new x,new x]);let n=e.center,r=e.halfAxes,o=ne.getColumn(r,0,age),a=ne.getColumn(r,1,sge),s=ne.getColumn(r,2,uge);return x.clone(n,t[0]),x.subtract(t[0],o,t[0]),x.subtract(t[0],a,t[0]),x.subtract(t[0],s,t[0]),x.clone(n,t[1]),x.subtract(t[1],o,t[1]),x.subtract(t[1],a,t[1]),x.add(t[1],s,t[1]),x.clone(n,t[2]),x.subtract(t[2],o,t[2]),x.add(t[2],a,t[2]),x.subtract(t[2],s,t[2]),x.clone(n,t[3]),x.subtract(t[3],o,t[3]),x.add(t[3],a,t[3]),x.add(t[3],s,t[3]),x.clone(n,t[4]),x.add(t[4],o,t[4]),x.subtract(t[4],a,t[4]),x.subtract(t[4],s,t[4]),x.clone(n,t[5]),x.add(t[5],o,t[5]),x.subtract(t[5],a,t[5]),x.add(t[5],s,t[5]),x.clone(n,t[6]),x.add(t[6],o,t[6]),x.add(t[6],a,t[6]),x.subtract(t[6],s,t[6]),x.clone(n,t[7]),x.add(t[7],o,t[7]),x.add(t[7],a,t[7]),x.add(t[7],s,t[7]),t};var lge=new ne;Zr.computeTransformation=function(e,t){_(t)||(t=new U);let n=e.center,r=ne.multiplyByUniformScale(e.halfAxes,2,lge);return U.fromRotationTranslation(r,n,t)};var cge=new Ee;Zr.isOccluded=function(e,t){let n=Ee.fromOrientedBoundingBox(e,cge);return!t.isBoundingSphereVisible(n)};Zr.prototype.intersectPlane=function(e){return Zr.intersectPlane(this,e)};Zr.prototype.distanceSquaredTo=function(e){return Zr.distanceSquaredTo(this,e)};Zr.prototype.computePlaneDistances=function(e,t,n){return Zr.computePlaneDistances(this,e,t,n)};Zr.prototype.computeCorners=function(e){return Zr.computeCorners(this,e)};Zr.prototype.computeTransformation=function(e){return Zr.computeTransformation(this,e)};Zr.prototype.isOccluded=function(e){return Zr.isOccluded(this,e)};Zr.equals=function(e,t){return e===t||_(e)&&_(t)&&x.equals(e.center,t.center)&&ne.equals(e.halfAxes,t.halfAxes)};Zr.prototype.clone=function(e){return Zr.clone(this,e)};Zr.prototype.equals=function(e){return Zr.equals(this,e)};var S9=Zr;var jI={};jI.getHeight=function(e,t,n){return(e-n)*t+n};var fge=new x;jI.getPosition=function(e,t,n,r,o){let a=t.cartesianToCartographic(e,fge),s=jI.getHeight(a.height,n,r);return x.fromRadians(a.longitude,a.latitude,s,t,o)};var d2=jI;function AC(e,t,n,r){e=T(e,1),t=T(t,1),n=T(n,1),r=T(r,1),this.value=new Uint8Array([K.floatToByte(e),K.floatToByte(t),K.floatToByte(n),K.floatToByte(r)])}Object.defineProperties(AC.prototype,{componentDatatype:{get:function(){return ie.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}});AC.fromColor=function(e){return new AC(e.red,e.green,e.blue,e.alpha)};AC.toValue=function(e,t){return _(t)?e.toBytes(t):new Uint8Array(e.toBytes())};AC.equals=function(e,t){return e===t||_(e)&&_(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var A9=AC;var b9=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute float batchId;
#ifdef EXTRUDED_GEOMETRY
attribute vec3 extrudeDirection;
uniform float u_globeMinimumAltitude;
#endif // EXTRUDED_GEOMETRY
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif // PER_INSTANCE_COLOR
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
void main()
{
vec4 position = czm_computePosition();
#ifdef EXTRUDED_GEOMETRY
float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));
delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;
position = position + vec4(extrudeDirection * delta, 0.0);
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
v_sphericalExtents = czm_batchTable_sphericalExtents(batchId);
v_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);
#else // SPHERICAL
#ifdef COLUMBUS_VIEW_2D
vec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);
vec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);
vec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));
bool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;
planes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);
planes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);
idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;
idlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));
planes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);
planes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;
vec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;
vec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;
#else // COLUMBUS_VIEW_2D
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;
vec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;
vec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;
#endif // COLUMBUS_VIEW_2D
vec3 eastWard = southEastCorner - southWestCorner;
float eastExtent = length(eastWard);
eastWard /= eastExtent;
vec3 northWard = northWestCorner - southWestCorner;
float northExtent = length(northWard);
northWard /= northExtent;
v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));
v_southPlane = vec4(northWard, -dot(northWard, southWestCorner));
v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);
#endif // SPHERICAL
vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);
vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);
v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);
v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);
v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif
gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position);
}
`;var I9=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
void main(void)
{
#ifdef VECTOR_TILE
gl_FragColor = czm_gammaCorrect(u_highlightColor);
#else
gl_FragColor = vec4(1.0);
#endif
czm_writeDepthClamp();
}
`;var D9=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
vec4 color = czm_gammaCorrect(v_color);
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
}
`;var P9=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec4 color;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var M9=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function Rm(e){e=T(e,T.EMPTY_OBJECT);let t=T(e.translucent,!0),n=T(e.closed,!1),r=T(e.flat,!1),o=r?M9:P9,a=r?LI:D9,s=r?Rm.FLAT_VERTEX_FORMAT:Rm.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=T(e.vertexShaderSource,o),this._fragmentShaderSource=T(e.fragmentShaderSource,a),this._renderState=Pl.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=s,this._flat=r,this._faceForward=T(e.faceForward,!n)}Object.defineProperties(Rm.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});Rm.VERTEX_FORMAT=go.POSITION_AND_NORMAL;Rm.FLAT_VERTEX_FORMAT=go.POSITION_ONLY;Rm.prototype.getFragmentShaderSource=Pl.prototype.getFragmentShaderSource;Rm.prototype.isTranslucent=Pl.prototype.isTranslucent;Rm.prototype.getRenderState=Pl.prototype.getRenderState;var Om=Rm;var p2=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
#ifdef NORMAL_EC
vec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {
vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);
return eyeCoordinate.xyz / eyeCoordinate.w;
}
vec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {
vec2 glFragCoordXY = gl_FragCoord.xy;
float upOrRightLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));
float downOrLeftLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));
bvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);
float useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);
float useDownOrLeft = float(useUpOrRight == 0.0);
vec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);
vec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);
return (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;
}
#endif // NORMAL_EC
void main(void)
{
#ifdef REQUIRES_EC
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
#endif
#ifdef REQUIRES_WC
vec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;
vec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;
#endif
#ifdef TEXTURE_COORDINATES
vec2 uv;
#ifdef SPHERICAL
vec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);
sphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;
sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);
uv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;
uv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;
#else // SPHERICAL
uv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;
uv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;
#endif // SPHERICAL
#endif // TEXTURE_COORDINATES
#ifdef PICK
#ifdef CULL_FRAGMENTS
if (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0 || logDepthOrDepth != 0.0) {
gl_FragColor.a = 1.0;
czm_writeDepthClamp();
}
#else // CULL_FRAGMENTS
gl_FragColor.a = 1.0;
#endif // CULL_FRAGMENTS
#else // PICK
#ifdef CULL_FRAGMENTS
if (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y || logDepthOrDepth == 0.0) {
discard;
}
#endif
#ifdef NORMAL_EC
vec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));
vec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));
vec3 normalEC = normalize(cross(leftRight, downUp));
#endif
#ifdef PER_INSTANCE_COLOR
vec4 color = czm_gammaCorrect(v_color);
#ifdef FLAT
gl_FragColor = color;
#else // FLAT
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#else // PER_INSTANCE_COLOR
czm_materialInput materialInput;
#ifdef USES_NORMAL_EC
materialInput.normalEC = normalEC;
#endif
#ifdef USES_POSITION_TO_EYE_EC
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
#endif
#ifdef USES_TANGENT_TO_EYE
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);
#endif
#ifdef USES_ST
materialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;
materialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;
#endif
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else // FLAT
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#endif // PER_INSTANCE_COLOR
czm_writeDepthClamp();
#endif // PICK
}
`;function kf(e,t,n){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};let r=new m2;r.requiresTextureCoordinates=e,r.requiresEC=!n.flat;let o=new m2;if(o.requiresTextureCoordinates=e,n instanceof Om)r.requiresNormalEC=!n.flat;else{let a=`${n.material.shaderSource}
${n.fragmentShaderSource}`;r.normalEC=a.indexOf("materialInput.normalEC")!==-1||a.indexOf("czm_getDefaultMaterial")!==-1,r.positionToEyeEC=a.indexOf("materialInput.positionToEyeEC")!==-1,r.tangentToEyeMatrix=a.indexOf("materialInput.tangentToEyeMatrix")!==-1,r.st=a.indexOf("materialInput.st")!==-1}this._colorShaderDependencies=r,this._pickShaderDependencies=o,this._appearance=n,this._extentsCulling=e,this._planarExtents=t}kf.prototype.createFragmentShader=function(e){let t=this._appearance,n=this._colorShaderDependencies,r=[];!e&&!this._planarExtents&&r.push("SPHERICAL"),n.requiresEC&&r.push("REQUIRES_EC"),n.requiresWC&&r.push("REQUIRES_WC"),n.requiresTextureCoordinates&&r.push("TEXTURE_COORDINATES"),this._extentsCulling&&r.push("CULL_FRAGMENTS"),n.requiresNormalEC&&r.push("NORMAL_EC"),t instanceof Om&&r.push("PER_INSTANCE_COLOR"),n.normalEC&&r.push("USES_NORMAL_EC"),n.positionToEyeEC&&r.push("USES_POSITION_TO_EYE_EC"),n.tangentToEyeMatrix&&r.push("USES_TANGENT_TO_EYE"),n.st&&r.push("USES_ST"),t.flat&&r.push("FLAT");let o="";return t instanceof Om||(o=t.material.shaderSource),new xt({defines:r,sources:[o,p2]})};kf.prototype.createPickFragmentShader=function(e){let t=this._pickShaderDependencies,n=["PICK"];return!e&&!this._planarExtents&&n.push("SPHERICAL"),t.requiresEC&&n.push("REQUIRES_EC"),t.requiresWC&&n.push("REQUIRES_WC"),t.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),new xt({defines:n,sources:[p2],pickColorQualifier:"varying"})};kf.prototype.createVertexShader=function(e,t,n,r){return V9(this._colorShaderDependencies,this._planarExtents,n,e,t,this._appearance,r,this._projectionExtentDefines)};kf.prototype.createPickVertexShader=function(e,t,n,r){return V9(this._pickShaderDependencies,this._planarExtents,n,e,t,void 0,r,this._projectionExtentDefines)};var L9=new x,R9=new ce,O9={high:0,low:0};function V9(e,t,n,r,o,a,s,u){let l=r.slice();if(u.eastMostYhighDefine===""){let c=R9;c.longitude=z.PI,c.latitude=0,c.height=0;let f=s.project(c,L9),h=ei.encode(f.x,O9);u.eastMostYhighDefine=`EAST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,u.eastMostYlowDefine=`EAST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`;let d=R9;d.longitude=-z.PI,d.latitude=0,d.height=0;let p=s.project(d,L9);h=ei.encode(p.x,O9),u.westMostYhighDefine=`WEST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,u.westMostYlowDefine=`WEST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`}return n&&(l.push(u.eastMostYhighDefine),l.push(u.eastMostYlowDefine),l.push(u.westMostYhighDefine),l.push(u.westMostYlowDefine)),_(a)&&a instanceof Om&&l.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(l.push("TEXTURE_COORDINATES"),t||n||l.push("SPHERICAL"),n&&l.push("COLUMBUS_VIEW_2D")),new xt({defines:l,sources:[o]})}function m2(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}Object.defineProperties(m2.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});function N9(e,t,n){return Math.abs((t.y-e.y)*n.x-(t.x-e.x)*n.y+t.x*e.y-t.y*e.x)/X.distance(t,e)}var hge=[new X,new X,new X,new X];function k9(e,t){let n=hge,r=X.unpack(t,0,n[0]),o=X.unpack(t,2,n[1]),a=X.unpack(t,4,n[2]);e.uMaxVmax=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o.x,o.y,a.x,a.y]});let s=1/N9(r,o,a),u=1/N9(r,a,o);e.uvMinAndExtents=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,s,u]})}var G9=new ce,U9=new x,dge=new x,pge=new x,KI={high:0,low:0};function H9(e,t,n){let r=G9;r.height=0,r.longitude=e.west,r.latitude=e.south;let o=t.project(r,U9);r.latitude=e.north;let a=t.project(r,dge);r.longitude=e.east,r.latitude=e.south;let s=t.project(r,pge),u=[0,0,0,0],l=[0,0,0,0],c=ei.encode(o.x,KI);u[0]=c.high,l[0]=c.low,c=ei.encode(o.y,KI),u[1]=c.high,l[1]=c.low,c=ei.encode(a.y,KI),u[2]=c.high,l[2]=c.low,c=ei.encode(s.x,KI),u[3]=c.high,l[3]=c.low,n.planes2D_HIGH=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:u}),n.planes2D_LOW=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:l})}var mge=new U,gge=new U,B9=new x,_ge=new ce,yge=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];function vge(e,t,n,r,o,a){let s=ln.center(e,_ge);s.height=n;let u=ce.toCartesian(s,t,B9),l=yn.eastNorthUpToFixedFrame(u,t,mge),c=U.inverse(l,gge),f=e.west,h=e.east,d=e.north,p=e.south,g=yge;g[0].latitude=p,g[0].longitude=f,g[1].latitude=d,g[1].longitude=f,g[2].latitude=d,g[2].longitude=h,g[3].latitude=p,g[3].longitude=h;let y=(f+h)*.5,v=(d+p)*.5;g[4].latitude=p,g[4].longitude=y,g[5].latitude=d,g[5].longitude=y,g[6].latitude=v,g[6].longitude=f,g[7].latitude=v,g[7].longitude=h;let w=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,E=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY;for(let M=0;M<8;M++){g[M].height=n;let I=ce.toCartesian(g[M],t,B9);U.multiplyByPoint(c,I,I),I.z=0,w=Math.min(w,I.x),C=Math.max(C,I.x),E=Math.min(E,I.y),S=Math.max(S,I.y)}let A=r;A.x=w,A.y=E,A.z=0,U.multiplyByPoint(l,A,A);let D=o;D.x=C,D.y=E,D.z=0,U.multiplyByPoint(l,D,D),x.subtract(D,A,o);let P=a;P.x=w,P.y=S,P.z=0,U.multiplyByPoint(l,P,P),x.subtract(P,A,a)}var Cge=new x,xge=new x,wge=new ei;kf.getPlanarTextureCoordinateAttributes=function(e,t,n,r,o){let a=U9,s=Cge,u=xge;vge(e,n,T(o,0),a,s,u);let l={};k9(l,t);let c=ei.fromCartesian(a,wge);return l.southWest_HIGH=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(c.high,[0,0,0])}),l.southWest_LOW=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(c.low,[0,0,0])}),l.eastward=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(s,[0,0,0])}),l.northward=new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1,value:x.pack(u,[0,0,0])}),H9(e,r,l),l};var Ege=new x;function F9(e,t,n,r){let o=G9;o.latitude=e,o.longitude=t,o.height=0;let a=ce.toCartesian(o,n,Ege),s=Math.sqrt(a.x*a.x+a.y*a.y),u=z.fastApproximateAtan2(s,a.z),l=z.fastApproximateAtan2(a.x,a.y);return r.x=u,r.y=l,r}var z9=new X;kf.getSphericalExtentGeometryInstanceAttributes=function(e,t,n,r){let o=F9(e.south,e.west,n,z9),a=o.x,s=o.y,u=F9(e.north,e.east,n,z9),l=u.x,c=u.y,f=0;s>c&&(f=z.PI-s,s=-z.PI,c+=f),a-=z.EPSILON5,s-=z.EPSILON5,l+=z.EPSILON5,c+=z.EPSILON5;let h=1/(c-s),d=1/(l-a),p={sphericalExtents:new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:4,normalize:!1,value:[a,s,d,h]}),longitudeRotation:new qc({componentDatatype:ie.FLOAT,componentsPerAttribute:1,normalize:!1,value:[f]})};return k9(p,t),H9(e,r,p),p};kf.hasAttributesForTextureCoordinatePlanes=function(e){return _(e.southWest_HIGH)&&_(e.southWest_LOW)&&_(e.northward)&&_(e.eastward)&&_(e.planes2D_HIGH)&&_(e.planes2D_LOW)&&_(e.uMaxVmax)&&_(e.uvMinAndExtents)};kf.hasAttributesForSphericalExtents=function(e){return _(e.sphericalExtents)&&_(e.longitudeRotation)&&_(e.planes2D_HIGH)&&_(e.planes2D_LOW)&&_(e.uMaxVmax)&&_(e.uvMinAndExtents)};function Tge(e){return Math.max(e.width,e.height)>kf.MAX_WIDTH_FOR_PLANAR_EXTENTS}kf.shouldUseSphericalCoordinates=function(e){return Tge(e)};kf.MAX_WIDTH_FOR_PLANAR_EXTENTS=z.toRadians(1);var u0=kf;function $_(e){e=T(e,T.EMPTY_OBJECT);let t=e.geometryInstances;this.geometryInstances=t,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,ka.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=T(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1;let n=this;this._readyPromise=new Promise((r,o)=>{n._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let a=this._error;_(a)?o(a):r(this)}}),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:T(e.vertexCacheOptimize,!1),interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:T(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}Object.defineProperties($_.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}});$_.isSupported=function(e){return e.context.stencilBuffer};function bC(e,t){let n=t?tl.EQUAL:tl.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:n,frontOperation:{fail:Kr.KEEP,zFail:Kr.DECREMENT_WRAP,zPass:Kr.KEEP},backFunction:n,backOperation:{fail:Kr.KEEP,zFail:Kr.INCREMENT_WRAP,zPass:Kr.KEEP},reference:io.CESIUM_3D_TILE_MASK,mask:io.CESIUM_3D_TILE_MASK},stencilMask:io.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:o0.LESS_OR_EQUAL},depthMask:!1}}function _2(e){return{stencilTest:{enabled:e,frontFunction:tl.NOT_EQUAL,frontOperation:{fail:Kr.ZERO,zFail:Kr.ZERO,zPass:Kr.ZERO},backFunction:tl.NOT_EQUAL,backOperation:{fail:Kr.ZERO,zFail:Kr.ZERO,zPass:Kr.ZERO},reference:0,mask:io.CLASSIFICATION_MASK},stencilMask:io.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:za.PRE_MULTIPLIED_ALPHA_BLEND}}var Sge={stencilTest:{enabled:!0,frontFunction:tl.NOT_EQUAL,frontOperation:{fail:Kr.ZERO,zFail:Kr.ZERO,zPass:Kr.ZERO},backFunction:tl.NOT_EQUAL,backOperation:{fail:Kr.ZERO,zFail:Kr.ZERO,zPass:Kr.ZERO},reference:0,mask:io.CLASSIFICATION_MASK},stencilMask:io.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function Age(e,t,n,r){if(_(e._rsStencilDepthPass))return;let o=!e.debugShowShadowVolume;e._rsStencilDepthPass=un.fromCache(bC(o,!1)),e._rsStencilDepthPass3DTiles=un.fromCache(bC(o,!0)),e._rsColorPass=un.fromCache(_2(o,!1)),e._rsPickPass=un.fromCache(Sge)}function bge(e,t){if(!e.compressVertices)return t;if(t.search(/attribute\s+vec3\s+extrudeDirection;/g)!==-1){let n="compressedAttributes",r=`attribute vec2 ${n};`,o=`vec3 extrudeDirection;
`,a=`    extrudeDirection = czm_octDecode(${n}, 65535.0);
`,s=t;s=s.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),s=xt.replaceMain(s,"czm_non_compressed_main");let u=`void main() 
{ 
${a}    czm_non_compressed_main(); 
}`;return[r,o,s,u].join(`
`)}}function Ige(e,t){let n=t.context,r=e._primitive,o=b9;o=e._primitive._batchTable.getVertexShaderCallback()(o),o=Xs._appendDistanceDisplayConditionToShader(r,o),o=Xs._modifyShaderPosition(e,o,t.scene3DOnly),o=Xs._updateColorAttribute(r,o);let a=e._hasPlanarExtentsAttributes,s=a||e._hasSphericalExtentsAttribute;e._extruded&&(o=bge(r,o));let u=e._extruded?"EXTRUDED_GEOMETRY":"",l=new xt({defines:[u],sources:[o]}),c=new xt({sources:[I9]}),f=e._primitive._attributeLocations,h=new u0(s,a,e.appearance);if(e._spStencil=vi.replaceCache({context:n,shaderProgram:e._spStencil,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f}),e._primitive.allowPicking){let g=xt.createPickVertexShaderSource(o);g=Xs._appendShowToShader(r,g),g=Xs._updatePickColorAttribute(g);let y=h.createPickFragmentShader(!1),v=h.createPickVertexShader([u],g,!1,t.mapProjection);if(e._spPick=vi.replaceCache({context:n,shaderProgram:e._spPick,vertexShaderSource:v,fragmentShaderSource:y,attributeLocations:f}),s){let w=n.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!_(w)){let C=h.createPickFragmentShader(!0),E=h.createPickVertexShader([u],g,!0,t.mapProjection);w=n.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:E,fragmentShaderSource:C,attributeLocations:f})}e._spPick2D=w}}else e._spPick=vi.fromCache({context:n,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f});o=Xs._appendShowToShader(r,o),l=new xt({defines:[u],sources:[o]}),e._sp=vi.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:f});let d=h.createFragmentShader(!1),p=h.createVertexShader([u],o,!1,t.mapProjection);if(e._spColor=vi.replaceCache({context:n,shaderProgram:e._spColor,vertexShaderSource:p,fragmentShaderSource:d,attributeLocations:f}),s){let g=n.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!_(g)){let y=h.createFragmentShader(!0),v=h.createVertexShader([u],o,!0,t.mapProjection);g=n.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:v,fragmentShaderSource:y,attributeLocations:f})}e._spColor2D=g}}function Dge(e,t){let n=e._primitive,r=n._va.length*2;t.length=r;let o,a,s,u=0,l=n._batchTable.getUniformMapCallback()(e._uniformMap),c=e._needs2DShader;for(o=0;o<r;o+=2){let p=n._va[u++];a=t[o],_(a)||(a=t[o]=new Zt({owner:e,primitiveType:n._primitiveType})),a.vertexArray=p,a.renderState=e._rsStencilDepthPass,a.shaderProgram=e._sp,a.uniformMap=l,a.pass=Qt.TERRAIN_CLASSIFICATION,s=Zt.shallowClone(a,a.derivedCommands.tileset),s.renderState=e._rsStencilDepthPass3DTiles,s.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=s,a=t[o+1],_(a)||(a=t[o+1]=new Zt({owner:e,primitiveType:n._primitiveType})),a.vertexArray=p,a.renderState=e._rsColorPass,a.shaderProgram=e._spColor,a.pass=Qt.TERRAIN_CLASSIFICATION;let y=e.appearance.material;if(_(y)&&(l=Yi(l,y._uniforms)),a.uniformMap=l,s=Zt.shallowClone(a,a.derivedCommands.tileset),s.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=s,c){let v=Zt.shallowClone(a,a.derivedCommands.appearance2D);v.shaderProgram=e._spColor2D,a.derivedCommands.appearance2D=v,v=Zt.shallowClone(s,s.derivedCommands.appearance2D),v.shaderProgram=e._spColor2D,s.derivedCommands.appearance2D=v}}let f=e._commandsIgnoreShow,h=e._spStencil,d=0;r=f.length=r/2;for(let p=0;p<r;++p){let g=f[p]=Zt.shallowClone(t[d],f[p]);g.shaderProgram=h,g.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,d+=2}}function Pge(e,t){let n=e._usePickOffsets,r=e._primitive,o=r._va.length*2,a,s=0,u;n&&(a=r._pickOffsets,o=a.length*2),t.length=o;let l,c,f,h=0,d=r._batchTable.getUniformMapCallback()(e._uniformMap),p=e._needs2DShader;for(l=0;l<o;l+=2){let g=r._va[h++];if(n&&(u=a[s++],g=r._va[u.index]),c=t[l],_(c)||(c=t[l]=new Zt({owner:e,primitiveType:r._primitiveType,pickOnly:!0})),c.vertexArray=g,c.renderState=e._rsStencilDepthPass,c.shaderProgram=e._sp,c.uniformMap=d,c.pass=Qt.TERRAIN_CLASSIFICATION,n&&(c.offset=u.offset,c.count=u.count),f=Zt.shallowClone(c,c.derivedCommands.tileset),f.renderState=e._rsStencilDepthPass3DTiles,f.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=f,c=t[l+1],_(c)||(c=t[l+1]=new Zt({owner:e,primitiveType:r._primitiveType,pickOnly:!0})),c.vertexArray=g,c.renderState=e._rsPickPass,c.shaderProgram=e._spPick,c.uniformMap=d,c.pass=Qt.TERRAIN_CLASSIFICATION,n&&(c.offset=u.offset,c.count=u.count),f=Zt.shallowClone(c,c.derivedCommands.tileset),f.pass=Qt.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=f,p){let y=Zt.shallowClone(c,c.derivedCommands.pick2D);y.shaderProgram=e._spPick2D,c.derivedCommands.pick2D=y,y=Zt.shallowClone(f,f.derivedCommands.pick2D),y.shaderProgram=e._spPick2D,f.derivedCommands.pick2D=y}}}function Mge(e,t,n,r,o,a,s){Dge(e,a),Pge(e,s)}function q9(e,t){return Math.floor(e%t/2)}function g2(e,t,n,r,o,a){e.modelMatrix=n,e.boundingVolume=o,e.cull=r,e.debugShowBoundingVolume=a,t.commandList.push(e)}function W9(e,t,n,r,o){e.modelMatrix=n,e.boundingVolume=o,e.cull=r,t.commandList.push(e)}function Lge(e,t,n,r,o,a,s,u){let l=e._primitive;Xs._updateBoundingVolumes(l,t,o);let c;t.mode===Ne.SCENE3D?c=l._boundingSphereWC:t.mode===Ne.COLUMBUS_VIEW?c=l._boundingSphereCV:t.mode===Ne.SCENE2D&&_(l._boundingSphere2D)?c=l._boundingSphere2D:_(l._boundingSphereMorph)&&(c=l._boundingSphereMorph);let f=e.classificationType,h=f!==ka.CESIUM_3D_TILE,d=f!==ka.TERRAIN,p=t.passes,g,y,v;if(p.render){let w=n.length;for(g=0;g<w;++g)y=c[q9(g,w)],h&&(v=n[g],g2(v,t,o,a,y,s)),d&&(v=n[g].derivedCommands.tileset,g2(v,t,o,a,y,s));if(t.invertClassification){let C=e._commandsIgnoreShow,E=C.length;for(g=0;g<E;++g)y=c[g],v=C[g],g2(v,t,o,a,y,s)}}if(p.pick){let w=r.length,C=l._pickOffsets;for(g=0;g<w;++g){let E=C[q9(g,w)];y=c[E.index],h&&(v=r[g],W9(v,t,o,a,y)),d&&(v=r[g].derivedCommands.tileset,W9(v,t,o,a,y))}}}$_.prototype.update=function(e){if(!_(this._primitive)&&!_(this.geometryInstances))return;let t=this.appearance;_(t)&&_(t.material)&&t.material.update(e.context);let n=this,r=this._primitiveOptions;if(!_(this._primitive)){let o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length,s,u,l,c=!1,f=!0,h,d=!1,p=!1;for(a>0&&(l=o[0].attributes,d=u0.hasAttributesForSphericalExtents(l),p=u0.hasAttributesForTextureCoordinatePlanes(l),h=l.color),s=0;s<a;s++){u=o[s];let y=u.attributes.color;_(y)&&(c=!0),f=f&&_(y)&&A9.equals(h,y)}if(!f&&!d&&!p)throw new Le("All GeometryInstances must have the same color attribute except via GroundPrimitives");c&&!_(t)&&(t=new Om({flat:!0}),this.appearance=t),this._usePickOffsets=!d&&!p,this._hasSphericalExtentsAttribute=d,this._hasPlanarExtentsAttributes=p,this._hasPerColorAttribute=c;let g=new Array(a);for(s=0;s<a;++s)u=o[s],g[s]=new H_({geometry:u.geometry,attributes:u.attributes,modelMatrix:u.modelMatrix,id:u.id,pickPrimitive:T(this._pickPrimitive,n)});r.appearance=t,r.geometryInstances=g,_(this._createBoundingVolumeFunction)&&(r._createBoundingVolumeFunction=function(y,v){n._createBoundingVolumeFunction(y,v)}),r._createRenderStatesFunction=function(y,v,w,C){Age(n,v)},r._createShaderProgramFunction=function(y,v,w){Ige(n,v)},r._createCommandsFunction=function(y,v,w,C,E,S,A){Mge(n,void 0,void 0,!0,!1,S,A)},_(this._updateAndQueueCommandsFunction)?r._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){n._updateAndQueueCommandsFunction(y,v,w,C,E,S,A,D)}:r._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){Lge(n,v,w,C,E,S,A,D)},this._primitive=new Xs(r)}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=un.fromCache(bC(!1,!1)),this._rsStencilDepthPass3DTiles=un.fromCache(bC(!1,!0)),this._rsColorPass=un.fromCache(_2(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=un.fromCache(bC(!0,!1)),this._rsStencilDepthPass3DTiles=un.fromCache(bC(!0,!0)),this._rsColorPass=un.fromCache(_2(!0))),this._primitive.appearance!==t&&(this._primitive.appearance=t),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{_(this._primitive)&&this._primitive.ready&&this._completeLoad()})};$_.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};$_.prototype.isDestroyed=function(){return!1};$_.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,ot(this)};var y2=$_;var Rge={u_globeMinimumAltitude:function(){return 55e3}};function dc(e){e=T(e,T.EMPTY_OBJECT);let t=e.appearance,n=e.geometryInstances;if(!_(t)&&_(n)){let a=Array.isArray(n)?n:[n],s=a.length;for(let u=0;u<s;u++){let l=a[u].attributes;if(_(l)&&_(l.color)){t=new Om({flat:!0});break}}}this.appearance=t,this.geometryInstances=e.geometryInstances,this.show=T(e.show,!0),this.classificationType=T(e.classificationType,ka.BOTH),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=T(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1;let r=this;this._readyPromise=new Promise((a,s)=>{r._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let u=this._error;_(u)?s(u):a(this)}}),this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=Hc._defaultMaxTerrainHeight,this._minTerrainHeight=Hc._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;let o=this;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:T(e.vertexCacheOptimize,!1),interleave:T(e.interleave,!1),releaseGeometryInstances:T(e.releaseGeometryInstances,!0),allowPicking:T(e.allowPicking,!0),asynchronous:T(e.asynchronous,!0),compressVertices:T(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:o,_extruded:!0,_uniformMap:Rge}}Object.defineProperties(dc.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});dc.isSupported=y2.isSupported;function Y9(e){return function(t,n){let r=n.maximumRadius,o=r/Math.cos(t*.5)-r;return e._maxHeight+o}}function X9(e){return function(t,n){return e._minHeight}}var Oge=new x,Nge=new x,Bge=new x,Fge=new ce,zge=new ln;function ZI(e,t){let n=e.mapProjection.ellipsoid;if(!_(t.attributes)||!_(t.attributes.position3DHigh))return _(t.rectangle)?t.rectangle:void 0;let r=t.attributes.position3DHigh.values,o=t.attributes.position3DLow.values,a=r.length,s=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let h=0;h<a;h+=3){let d=x.unpack(r,h,Oge),p=x.unpack(o,h,Nge),g=x.add(d,p,Bge),y=n.cartesianToCartographic(g,Fge),v=y.latitude,w=y.longitude;s=Math.min(s,v),u=Math.min(u,w),l=Math.max(l,v),c=Math.max(c,w)}let f=zge;return f.north=l,f.south=s,f.east=c,f.west=u,f}function Vge(e,t,n){let r=Hc.getMinimumMaximumHeights(t,n);e._minTerrainHeight=r.minimumTerrainHeight,e._maxTerrainHeight=r.maximumTerrainHeight}function kge(e,t,n){let r=t.mapProjection.ellipsoid,o=ZI(t,n),a=S9.fromRectangle(o,e._minHeight,e._maxHeight,r);if(e._boundingVolumes.push(a),!t.scene3DOnly){let s=t.mapProjection,u=Ee.fromRectangleWithHeights2D(o,s,e._maxHeight,e._minHeight);x.fromElements(u.center.z,u.center.x,u.center.y,u.center),e._boundingVolumes2D.push(u)}}function v2(e,t){return Math.floor(e%t/2)}function C2(e,t,n,r,o,a,s){let u=e._primitive;n.mode!==Ne.SCENE3D&&t.shaderProgram===u._spColor&&u._needs2DShader&&(t=t.derivedCommands.appearance2D),t.owner=e,t.modelMatrix=r,t.boundingVolume=a,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function j9(e,t,n,r,o,a){let s=e._primitive;n.mode!==Ne.SCENE3D&&t.shaderProgram===s._spPick&&s._needs2DShader&&(t=t.derivedCommands.pick2D),t.owner=e,t.modelMatrix=r,t.boundingVolume=a,t.cull=o,n.commandList.push(t)}function Gge(e,t,n,r,o,a,s,u){let l;t.mode===Ne.SCENE3D?l=e._boundingVolumes:l=e._boundingVolumes2D;let c=e.classificationType,f=c!==ka.CESIUM_3D_TILE,h=c!==ka.TERRAIN,d=t.passes,p=e._primitive,g,y,v;if(d.render){let w=n.length;for(g=0;g<w;++g)y=l[v2(g,w)],f&&(v=n[g],C2(e,v,t,o,a,y,s)),h&&(v=n[g].derivedCommands.tileset,C2(e,v,t,o,a,y,s));if(t.invertClassification){let C=p._commandsIgnoreShow,E=C.length;for(g=0;g<E;++g)y=l[g],v=C[g],C2(e,v,t,o,a,y,s)}}if(d.pick){let w=r.length,C;for(e._useFragmentCulling||(C=p._primitive._pickOffsets),g=0;g<w;++g){if(y=l[v2(g,w)],!e._useFragmentCulling){let E=C[v2(g,w)];y=l[E.index]}f&&(v=r[g],j9(e,v,t,o,a,y)),h&&(v=r[g].derivedCommands.tileset,j9(e,v,t,o,a,y))}}}dc.initializeTerrainHeights=function(){return Hc.initialize()};dc.prototype.update=function(e){if(!_(this._primitive)&&!_(this.geometryInstances))return;if(!Hc.initialized){dc.initializeTerrainHeights();return}let t=this,n=this._classificationPrimitiveOptions;if(!_(this._primitive)){let r=e.mapProjection.ellipsoid,o,a,s,u=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=u.length,c=new Array(l),f,h;for(f=0;f<l;++f){o=u[f],a=o.geometry;let y=ZI(e,a);_(h)?_(y)&&ln.union(h,y,h):h=ln.clone(y);let v=o.id;if(_(v)&&_(y)){let w=Hc.getBoundingSphere(y,r);this._boundingSpheresKeys.push(v),this._boundingSpheres.push(w)}s=a.constructor,!_(s)||_(s.createShadowVolume)}Vge(this,h,r);let d=e.terrainExaggeration,p=e.terrainExaggerationRelativeHeight;this._minHeight=d2.getHeight(this._minTerrainHeight,d,p),this._maxHeight=d2.getHeight(this._maxTerrainHeight,d,p);let g=dc._supportsMaterials(e.context);if(this._useFragmentCulling=g,g){let y,v=!0;for(f=0;f<l;++f)if(o=u[f],a=o.geometry,h=ZI(e,a),u0.shouldUseSphericalCoordinates(h)){v=!1;break}for(f=0;f<l;++f){o=u[f],a=o.geometry,s=a.constructor;let w=ZI(e,a),C=a.textureCoordinateRotationPoints;v?y=u0.getPlanarTextureCoordinateAttributes(w,C,r,e.mapProjection,this._maxHeight):y=u0.getSphericalExtentGeometryInstanceAttributes(w,C,r,e.mapProjection);let E=o.attributes;for(let S in E)E.hasOwnProperty(S)&&(y[S]=E[S]);c[f]=new H_({geometry:s.createShadowVolume(a,X9(this),Y9(this)),attributes:y,id:o.id})}}else for(f=0;f<l;++f)o=u[f],a=o.geometry,s=a.constructor,c[f]=new H_({geometry:s.createShadowVolume(a,X9(this),Y9(this)),attributes:o.attributes,id:o.id});n.geometryInstances=c,n.appearance=this.appearance,n._createBoundingVolumeFunction=function(y,v){kge(t,y,v)},n._updateAndQueueCommandsFunction=function(y,v,w,C,E,S,A,D){Gge(t,v,w,C,E,S,A,D)},this._primitive=new y2(n)}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push(()=>{_(this._primitive)&&this._primitive.ready&&this._completeLoad()})};dc.prototype.getBoundingSphere=function(e){let t=this._boundingSpheresKeys.indexOf(e);if(t!==-1)return this._boundingSpheres[t]};dc.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)};dc.prototype.isDestroyed=function(){return!1};dc.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ot(this)};dc._supportsMaterials=function(e){return e.depthTexture};dc.supportsMaterials=function(e){return dc._supportsMaterials(e.frameState.context)};var K9=dc;function wE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._image=void 0,this._imageSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(wE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),image:Q("image"),scale:Q("scale"),pixelOffset:Q("pixelOffset"),eyeOffset:Q("eyeOffset"),horizontalOrigin:Q("horizontalOrigin"),verticalOrigin:Q("verticalOrigin"),heightReference:Q("heightReference"),color:Q("color"),rotation:Q("rotation"),alignedAxis:Q("alignedAxis"),sizeInMeters:Q("sizeInMeters"),width:Q("width"),height:Q("height"),scaleByDistance:Q("scaleByDistance"),translucencyByDistance:Q("translucencyByDistance"),pixelOffsetScaleByDistance:Q("pixelOffsetScaleByDistance"),imageSubRegion:Q("imageSubRegion"),distanceDisplayCondition:Q("distanceDisplayCondition"),disableDepthTestDistance:Q("disableDepthTestDistance")});wE.prototype.clone=function(e){return _(e)?(e.show=this._show,e.image=this._image,e.scale=this._scale,e.pixelOffset=this._pixelOffset,e.eyeOffset=this._eyeOffset,e.horizontalOrigin=this._horizontalOrigin,e.verticalOrigin=this._verticalOrigin,e.heightReference=this._heightReference,e.color=this._color,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.sizeInMeters=this._sizeInMeters,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.imageSubRegion=this._imageSubRegion,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e.animation=this.animation,e):new wE(this)};wE.prototype.merge=function(e){this.show=T(this._show,e.show),this.image=T(this._image,e.image),this.scale=T(this._scale,e.scale),this.pixelOffset=T(this._pixelOffset,e.pixelOffset),this.eyeOffset=T(this._eyeOffset,e.eyeOffset),this.horizontalOrigin=T(this._horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=T(this._verticalOrigin,e.verticalOrigin),this.heightReference=T(this._heightReference,e.heightReference),this.color=T(this._color,e.color),this.rotation=T(this._rotation,e.rotation),this.alignedAxis=T(this._alignedAxis,e.alignedAxis),this.sizeInMeters=T(this._sizeInMeters,e.sizeInMeters),this.width=T(this._width,e.width),this.height=T(this._height,e.height),this.scaleByDistance=T(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=T(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=T(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.imageSubRegion=T(this._imageSubRegion,e.imageSubRegion),this.distanceDisplayCondition=T(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this._disableDepthTestDistance,e.disableDepthTestDistance),this.animation=T(this.animation,e.animation)};var QI=wE;function IC(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(IC.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color")});IC.prototype.getType=function(e){return"Color"};IC.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t};IC.prototype.equals=function(e){return this===e||e instanceof IC&&ye.equals(this._color,e._color)};var EE=IC;var Uge=new X(1,1),Hge=!1,qge=K.WHITE;function DC(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}Object.defineProperties(DC.prototype,{isConstant:{get:function(){return ye.isConstant(this._image)&&ye.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:Q("image"),repeat:Q("repeat"),color:Q("color"),transparent:Q("transparent")});DC.prototype.getType=function(e){return"Image"};DC.prototype.getValue=function(e,t){return _(t)||(t={}),t.image=ye.getValueOrUndefined(this._image,e),t.repeat=ye.getValueOrClonedDefault(this._repeat,e,Uge,t.repeat),t.color=ye.getValueOrClonedDefault(this._color,e,qge,t.color),ye.getValueOrDefault(this._transparent,e,Hge)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t};DC.prototype.equals=function(e){return this===e||e instanceof DC&&ye.equals(this._image,e._image)&&ye.equals(this._repeat,e._repeat)&&ye.equals(this._color,e._color)&&ye.equals(this._transparent,e._transparent)};var TE=DC;function Wge(e){if(e instanceof K)return new EE(e);if(typeof e=="string"||e instanceof _t||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){let t=new TE;return t.image=e,t}}function Yge(e,t){return Q(e,t,Wge)}var Bo=Yge;function SE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(SE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),dimensions:Q("dimensions"),heightReference:Q("heightReference"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});SE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.dimensions=this.dimensions,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new SE(this)};SE.prototype.merge=function(e){this.show=T(this.show,e.show),this.dimensions=T(this.dimensions,e.dimensions),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var JI=SE;var Xge={FIXED:0,INERTIAL:1},Ba=Object.freeze(Xge);function PC(){Le.throwInstantiationError()}Object.defineProperties(PC.prototype,{isConstant:{get:Le.throwInstantiationError},definitionChanged:{get:Le.throwInstantiationError},referenceFrame:{get:Le.throwInstantiationError}});PC.prototype.getValue=Le.throwInstantiationError;PC.prototype.getValueInReferenceFrame=Le.throwInstantiationError;PC.prototype.equals=Le.throwInstantiationError;var x2=new ne;PC.convertToReferenceFrame=function(e,t,n,r,o){if(!_(t))return t;if(_(o)||(o=new x),n===r)return x.clone(t,o);let a=yn.computeIcrfToFixedMatrix(e,x2);if(_(a)||(a=yn.computeTemeToPseudoFixedMatrix(e,x2)),n===Ba.INERTIAL)return ne.multiplyByVector(a,t,o);if(n===Ba.FIXED)return ne.multiplyByVector(ne.transpose(a,x2),t,o)};var MC=PC;function ey(e,t){this._definitionChanged=new xe,this._value=x.clone(e),this._referenceFrame=T(t,Ba.FIXED)}Object.defineProperties(ey.prototype,{isConstant:{get:function(){return!_(this._value)||this._referenceFrame===Ba.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});ey.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,Ba.FIXED,t)};ey.prototype.setValue=function(e,t){let n=!1;x.equals(this._value,e)||(n=!0,this._value=x.clone(e)),_(t)&&this._referenceFrame!==t&&(n=!0,this._referenceFrame=t),n&&this._definitionChanged.raiseEvent(this)};ey.prototype.getValueInReferenceFrame=function(e,t,n){return MC.convertToReferenceFrame(e,this._value,this._referenceFrame,t,n)};ey.prototype.equals=function(e){return this===e||e instanceof ey&&x.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame};var LC=ey;function AE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(AE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),positions:Q("positions"),width:Q("width"),height:Q("height"),heightReference:Q("heightReference"),extrudedHeight:Q("extrudedHeight"),extrudedHeightReference:Q("extrudedHeightReference"),cornerType:Q("cornerType"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition"),classificationType:Q("classificationType"),zIndex:Q("zIndex")});AE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new AE(this)};AE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.width=T(this.width,e.width),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.cornerType=T(this.cornerType,e.cornerType),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var $I=AE;function jge(e){return e}function Kge(e,t){return Q(e,t,jge)}var ad=Kge;function bE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(bE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),length:Q("length"),topRadius:Q("topRadius"),bottomRadius:Q("bottomRadius"),heightReference:Q("heightReference"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),numberOfVerticalLines:Q("numberOfVerticalLines"),slices:Q("slices"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});bE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.length=this.length,e.topRadius=this.topRadius,e.bottomRadius=this.bottomRadius,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new bE(this)};bE.prototype.merge=function(e){this.show=T(this.show,e.show),this.length=T(this.length,e.length),this.topRadius=T(this.topRadius,e.topRadius),this.bottomRadius=T(this.bottomRadius,e.bottomRadius),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=T(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=T(this.slices,e.slices),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var eD=bE;function IE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(IE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),semiMajorAxis:Q("semiMajorAxis"),semiMinorAxis:Q("semiMinorAxis"),height:Q("height"),heightReference:Q("heightReference"),extrudedHeight:Q("extrudedHeight"),extrudedHeightReference:Q("extrudedHeightReference"),rotation:Q("rotation"),stRotation:Q("stRotation"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),numberOfVerticalLines:Q("numberOfVerticalLines"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition"),classificationType:Q("classificationType"),zIndex:Q("zIndex")});IE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new IE(this)};IE.prototype.merge=function(e){this.show=T(this.show,e.show),this.semiMajorAxis=T(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=T(this.semiMinorAxis,e.semiMinorAxis),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=T(this.rotation,e.rotation),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=T(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var tD=IE;function DE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._innerRadii=void 0,this._innerRadiiSubscription=void 0,this._minimumClock=void 0,this._minimumClockSubscription=void 0,this._maximumClock=void 0,this._maximumClockSubscription=void 0,this._minimumCone=void 0,this._minimumConeSubscription=void 0,this._maximumCone=void 0,this._maximumConeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(DE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),radii:Q("radii"),innerRadii:Q("innerRadii"),minimumClock:Q("minimumClock"),maximumClock:Q("maximumClock"),minimumCone:Q("minimumCone"),maximumCone:Q("maximumCone"),heightReference:Q("heightReference"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),stackPartitions:Q("stackPartitions"),slicePartitions:Q("slicePartitions"),subdivisions:Q("subdivisions"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});DE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.radii=this.radii,e.innerRadii=this.innerRadii,e.minimumClock=this.minimumClock,e.maximumClock=this.maximumClock,e.minimumCone=this.minimumCone,e.maximumCone=this.maximumCone,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new DE(this)};DE.prototype.merge=function(e){this.show=T(this.show,e.show),this.radii=T(this.radii,e.radii),this.innerRadii=T(this.innerRadii,e.innerRadii),this.minimumClock=T(this.minimumClock,e.minimumClock),this.maximumClock=T(this.maximumClock,e.maximumClock),this.minimumCone=T(this.minimumCone,e.minimumCone),this.maximumCone=T(this.maximumCone,e.maximumCone),this.heightReference=T(this.heightReference,e.heightReference),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.stackPartitions=T(this.stackPartitions,e.stackPartitions),this.slicePartitions=T(this.slicePartitions,e.slicePartitions),this.subdivisions=T(this.subdivisions,e.subdivisions),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var nD=DE;function PE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(PE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),text:Q("text"),font:Q("font"),style:Q("style"),scale:Q("scale"),showBackground:Q("showBackground"),backgroundColor:Q("backgroundColor"),backgroundPadding:Q("backgroundPadding"),pixelOffset:Q("pixelOffset"),eyeOffset:Q("eyeOffset"),horizontalOrigin:Q("horizontalOrigin"),verticalOrigin:Q("verticalOrigin"),heightReference:Q("heightReference"),fillColor:Q("fillColor"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),translucencyByDistance:Q("translucencyByDistance"),pixelOffsetScaleByDistance:Q("pixelOffsetScaleByDistance"),scaleByDistance:Q("scaleByDistance"),distanceDisplayCondition:Q("distanceDisplayCondition"),disableDepthTestDistance:Q("disableDepthTestDistance")});PE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.text=this.text,e.font=this.font,e.style=this.style,e.scale=this.scale,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.pixelOffset=this.pixelOffset,e.eyeOffset=this.eyeOffset,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.heightReference=this.heightReference,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new PE(this)};PE.prototype.merge=function(e){this.show=T(this.show,e.show),this.text=T(this.text,e.text),this.font=T(this.font,e.font),this.style=T(this.style,e.style),this.scale=T(this.scale,e.scale),this.showBackground=T(this.showBackground,e.showBackground),this.backgroundColor=T(this.backgroundColor,e.backgroundColor),this.backgroundPadding=T(this.backgroundPadding,e.backgroundPadding),this.pixelOffset=T(this.pixelOffset,e.pixelOffset),this.eyeOffset=T(this.eyeOffset,e.eyeOffset),this.horizontalOrigin=T(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=T(this.verticalOrigin,e.verticalOrigin),this.heightReference=T(this.heightReference,e.heightReference),this.fillColor=T(this.fillColor,e.fillColor),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.translucencyByDistance=T(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=T(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=T(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this.disableDepthTestDistance,e.disableDepthTestDistance)};var rD=PE;var Zge=new x(1,1,1),Qge=x.ZERO,Jge=je.IDENTITY;function Z9(e,t,n){this.translation=x.clone(T(e,Qge)),this.rotation=je.clone(T(t,Jge)),this.scale=x.clone(T(n,Zge))}Z9.prototype.equals=function(e){return this===e||_(e)&&x.equals(this.translation,e.translation)&&je.equals(this.rotation,e.rotation)&&x.equals(this.scale,e.scale)};var w2=Z9;var E2=new w2;function ME(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale}Object.defineProperties(ME.prototype,{isConstant:{get:function(){return ye.isConstant(this._translation)&&ye.isConstant(this._rotation)&&ye.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:Q("translation"),rotation:Q("rotation"),scale:Q("scale")});ME.prototype.getValue=function(e,t){return _(t)||(t=new w2),t.translation=ye.getValueOrClonedDefault(this._translation,e,E2.translation,t.translation),t.rotation=ye.getValueOrClonedDefault(this._rotation,e,E2.rotation,t.rotation),t.scale=ye.getValueOrClonedDefault(this._scale,e,E2.scale,t.scale),t};ME.prototype.equals=function(e){return this===e||e instanceof ME&&ye.equals(this._translation,e._translation)&&ye.equals(this._rotation,e._rotation)&&ye.equals(this._scale,e._scale)};var iD=ME;function Nm(e,t){this._propertyNames=[],this._definitionChanged=new xe,_(e)&&this.merge(e,t)}Object.defineProperties(Nm.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){let e=this._propertyNames;for(let t=0,n=e.length;t<n;t++)if(!ye.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});Nm.prototype.hasProperty=function(e){return this._propertyNames.indexOf(e)!==-1};function $ge(e){return new sp(e)}Nm.prototype.addProperty=function(e,t,n){this._propertyNames.push(e),Object.defineProperty(this,e,Q(e,!0,T(n,$ge))),_(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)};Nm.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e],this._definitionChanged.raiseEvent(this)};Nm.prototype.getValue=function(e,t){_(t)||(t={});let n=this._propertyNames;for(let r=0,o=n.length;r<o;r++){let a=n[r];t[a]=ye.getValueOrUndefined(this[a],e,t[a])}return t};Nm.prototype.merge=function(e,t){let n=this._propertyNames,r=_(e._propertyNames)?e._propertyNames:Object.keys(e);for(let o=0,a=r.length;o<a;o++){let s=r[o],u=this[s],l=e[s];u===void 0&&n.indexOf(s)===-1&&this.addProperty(s,void 0,t),l!==void 0&&(u!==void 0?_(u)&&_(u.merge)&&u.merge(l):_(l)&&_(l.merge)&&_(l.clone)?this[s]=l.clone():this[s]=l)}};function e0e(e,t){let n=e._propertyNames,r=t._propertyNames,o=n.length;if(o!==r.length)return!1;for(let a=0;a<o;++a){let s=n[a];if(r.indexOf(s)===-1||!ye.equals(e[s],t[s]))return!1}return!0}Nm.prototype.equals=function(e){return this===e||e instanceof Nm&&e0e(this,e)};var sd=Nm;function Q9(e){return new iD(e)}function t0e(e){return new sd(e,Q9)}function n0e(e){return new sd(e)}function LE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._clampAnimations=void 0,this._clampAnimationsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._articulations=void 0,this._articulationsSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(LE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),uri:Q("uri"),scale:Q("scale"),minimumPixelSize:Q("minimumPixelSize"),maximumScale:Q("maximumScale"),incrementallyLoadTextures:Q("incrementallyLoadTextures"),runAnimations:Q("runAnimations"),clampAnimations:Q("clampAnimations"),shadows:Q("shadows"),heightReference:Q("heightReference"),silhouetteColor:Q("silhouetteColor"),silhouetteSize:Q("silhouetteSize"),color:Q("color"),colorBlendMode:Q("colorBlendMode"),colorBlendAmount:Q("colorBlendAmount"),imageBasedLightingFactor:Q("imageBasedLightingFactor"),lightColor:Q("lightColor"),distanceDisplayCondition:Q("distanceDisplayCondition"),nodeTransformations:Q("nodeTransformations",void 0,t0e),articulations:Q("articulations",void 0,n0e),clippingPlanes:Q("clippingPlanes")});LE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.uri=this.uri,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.heightReference=this._heightReference,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.imageBasedLightingFactor=this.imageBasedLightingFactor,e.lightColor=this.lightColor,e.distanceDisplayCondition=this.distanceDisplayCondition,e.nodeTransformations=this.nodeTransformations,e.articulations=this.articulations,e.clippingPlanes=this.clippingPlanes,e):new LE(this)};LE.prototype.merge=function(e){this.show=T(this.show,e.show),this.uri=T(this.uri,e.uri),this.scale=T(this.scale,e.scale),this.minimumPixelSize=T(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=T(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=T(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.runAnimations=T(this.runAnimations,e.runAnimations),this.clampAnimations=T(this.clampAnimations,e.clampAnimations),this.shadows=T(this.shadows,e.shadows),this.heightReference=T(this.heightReference,e.heightReference),this.silhouetteColor=T(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=T(this.silhouetteSize,e.silhouetteSize),this.color=T(this.color,e.color),this.colorBlendMode=T(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=T(this.colorBlendAmount,e.colorBlendAmount),this.imageBasedLightingFactor=T(this.imageBasedLightingFactor,e.imageBasedLightingFactor),this.lightColor=T(this.lightColor,e.lightColor),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.clippingPlanes=T(this.clippingPlanes,e.clippingPlanes);let t=e.nodeTransformations;if(_(t)){let r=this.nodeTransformations;_(r)?r.merge(t):this.nodeTransformations=new sd(t,Q9)}let n=e.articulations;if(_(n)){let r=this.articulations;_(r)?r.merge(n):this.articulations=new sd(n)}};var oD=LE;function RE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._maximumScreenSpaceError=void 0,this._maximumScreenSpaceErrorSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(RE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),uri:Q("uri"),maximumScreenSpaceError:Q("maximumScreenSpaceError")});RE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.uri=this.uri,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e):new RE(this)};RE.prototype.merge=function(e){this.show=T(this.show,e.show),this.uri=T(this.uri,e.uri),this.maximumScreenSpaceError=T(this.maximumScreenSpaceError,e.maximumScreenSpaceError)};var aD=RE;function OE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(OE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),leadTime:Q("leadTime"),trailTime:Q("trailTime"),width:Q("width"),resolution:Q("resolution"),material:Bo("material"),distanceDisplayCondition:Q("distanceDisplayCondition")});OE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.width=this.width,e.resolution=this.resolution,e.material=this.material,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new OE(this)};OE.prototype.merge=function(e){this.show=T(this.show,e.show),this.leadTime=T(this.leadTime,e.leadTime),this.trailTime=T(this.trailTime,e.trailTime),this.width=T(this.width,e.width),this.resolution=T(this.resolution,e.resolution),this.material=T(this.material,e.material),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var sD=OE;function NE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(NE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),plane:Q("plane"),dimensions:Q("dimensions"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});NE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.plane=this.plane,e.dimensions=this.dimensions,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new NE(this)};NE.prototype.merge=function(e){this.show=T(this.show,e.show),this.plane=T(this.plane,e.plane),this.dimensions=T(this.dimensions,e.dimensions),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var J9=NE;function BE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(BE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),pixelSize:Q("pixelSize"),heightReference:Q("heightReference"),color:Q("color"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),scaleByDistance:Q("scaleByDistance"),translucencyByDistance:Q("translucencyByDistance"),distanceDisplayCondition:Q("distanceDisplayCondition"),disableDepthTestDistance:Q("disableDepthTestDistance")});BE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.pixelSize=this.pixelSize,e.heightReference=this.heightReference,e.color=this.color,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new BE(this)};BE.prototype.merge=function(e){this.show=T(this.show,e.show),this.pixelSize=T(this.pixelSize,e.pixelSize),this.heightReference=T(this.heightReference,e.heightReference),this.color=T(this.color,e.color),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.scaleByDistance=T(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=T(this._translucencyByDistance,e.translucencyByDistance),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=T(this.disableDepthTestDistance,e.disableDepthTestDistance)};var uD=BE;function r0e(e,t){this.positions=_(e)?e:[],this.holes=_(t)?t:[]}var ty=r0e;function i0e(e){return Array.isArray(e)&&(e=new ty(e)),new sp(e)}function FE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._textureCoordinates=void 0,this._textureCoordinatesSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(FE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),hierarchy:Q("hierarchy",void 0,i0e),height:Q("height"),heightReference:Q("heightReference"),extrudedHeight:Q("extrudedHeight"),extrudedHeightReference:Q("extrudedHeightReference"),stRotation:Q("stRotation"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),perPositionHeight:Q("perPositionHeight"),closeTop:Q("closeTop"),closeBottom:Q("closeBottom"),arcType:Q("arcType"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition"),classificationType:Q("classificationType"),zIndex:Q("zIndex"),textureCoordinates:Q("textureCoordinates")});FE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.hierarchy=this.hierarchy,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.arcType=this.arcType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e.textureCoordinates=this.textureCoordinates,e):new FE(this)};FE.prototype.merge=function(e){this.show=T(this.show,e.show),this.hierarchy=T(this.hierarchy,e.hierarchy),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.perPositionHeight=T(this.perPositionHeight,e.perPositionHeight),this.closeTop=T(this.closeTop,e.closeTop),this.closeBottom=T(this.closeBottom,e.closeBottom),this.arcType=T(this.arcType,e.arcType),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex),this.textureCoordinates=T(this.textureCoordinates,e.textureCoordinates)};var lD=FE;function zE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(zE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),positions:Q("positions"),width:Q("width"),granularity:Q("granularity"),material:Bo("material"),depthFailMaterial:Bo("depthFailMaterial"),arcType:Q("arcType"),clampToGround:Q("clampToGround"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition"),classificationType:Q("classificationType"),zIndex:Q("zIndex")});zE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.granularity=this.granularity,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.arcType=this.arcType,e.clampToGround=this.clampToGround,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new zE(this)};zE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.width=T(this.width,e.width),this.granularity=T(this.granularity,e.granularity),this.material=T(this.material,e.material),this.depthFailMaterial=T(this.depthFailMaterial,e.depthFailMaterial),this.arcType=T(this.arcType,e.arcType),this.clampToGround=T(this.clampToGround,e.clampToGround),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var cD=zE;function VE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(VE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),positions:Q("positions"),shape:Q("shape"),cornerType:Q("cornerType"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});VE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.positions=this.positions,e.shape=this.shape,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new VE(this)};VE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.shape=T(this.shape,e.shape),this.cornerType=T(this.cornerType,e.cornerType),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var $9=VE;function kE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(kE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),coordinates:Q("coordinates"),height:Q("height"),heightReference:Q("heightReference"),extrudedHeight:Q("extrudedHeight"),extrudedHeightReference:Q("extrudedHeightReference"),rotation:Q("rotation"),stRotation:Q("stRotation"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition"),classificationType:Q("classificationType"),zIndex:Q("zIndex")});kE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.coordinates=this.coordinates,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new kE(this)};kE.prototype.merge=function(e){this.show=T(this.show,e.show),this.coordinates=T(this.coordinates,e.coordinates),this.height=T(this.height,e.height),this.heightReference=T(this.heightReference,e.heightReference),this.extrudedHeight=T(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=T(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=T(this.rotation,e.rotation),this.stRotation=T(this.stRotation,e.stRotation),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=T(this.classificationType,e.classificationType),this.zIndex=T(this.zIndex,e.zIndex)};var fD=kE;function GE(e){this._definitionChanged=new xe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(T(e,T.EMPTY_OBJECT))}Object.defineProperties(GE.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:Q("show"),positions:Q("positions"),minimumHeights:Q("minimumHeights"),maximumHeights:Q("maximumHeights"),granularity:Q("granularity"),fill:Q("fill"),material:Bo("material"),outline:Q("outline"),outlineColor:Q("outlineColor"),outlineWidth:Q("outlineWidth"),shadows:Q("shadows"),distanceDisplayCondition:Q("distanceDisplayCondition")});GE.prototype.clone=function(e){return _(e)?(e.show=this.show,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new GE(this)};GE.prototype.merge=function(e){this.show=T(this.show,e.show),this.positions=T(this.positions,e.positions),this.minimumHeights=T(this.minimumHeights,e.minimumHeights),this.maximumHeights=T(this.maximumHeights,e.maximumHeights),this.granularity=T(this.granularity,e.granularity),this.fill=T(this.fill,e.fill),this.material=T(this.material,e.material),this.outline=T(this.outline,e.outline),this.outlineColor=T(this.outlineColor,e.outlineColor),this.outlineWidth=T(this.outlineWidth,e.outlineWidth),this.shadows=T(this.shadows,e.shadows),this.distanceDisplayCondition=T(this.distanceDisplayCondition,e.distanceDisplayCondition)};var hD=GE;var o0e=new ce;function a0e(e){return new LC(e)}function s0e(e){return Q(e,void 0,a0e)}function js(e,t){return Q(e,void 0,function(n){return n instanceof t?n:new t(n)})}function fp(e){e=T(e,T.EMPTY_OBJECT);let t=e.id;_(t)||(t=_i()),this._availability=void 0,this._id=t,this._definitionChanged=new xe,this._name=e.name,this._show=T(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function T2(e,t,n){let r=t.length;for(let o=0;o<r;o++){let a=t[o],s=a._show;(!n&&s)!==(n&&s)&&T2(a,a._children,n)}e._definitionChanged.raiseEvent(e,"isShowing",n,!n)}Object.defineProperties(fp.prototype,{availability:ad("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:ad("name"),show:{get:function(){return this._show},set:function(e){if(e===this._show)return;let t=this.isShowing;this._show=e;let n=this.isShowing;t!==n&&T2(this,this._children,n),this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!_(this.entityCollection)||this.entityCollection.show)&&(!_(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){let t=this._parent;if(t===e)return;let n=this.isShowing;if(_(t)){let o=t._children.indexOf(this);t._children.splice(o,1)}this._parent=e,_(e)&&e._children.push(this);let r=this.isShowing;n!==r&&T2(this,this._children,r),this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:js("billboard",QI),box:js("box",JI),corridor:js("corridor",$I),cylinder:js("cylinder",eD),description:Q("description"),ellipse:js("ellipse",tD),ellipsoid:js("ellipsoid",nD),label:js("label",rD),model:js("model",oD),tileset:js("tileset",aD),orientation:Q("orientation"),path:js("path",sD),plane:js("plane",J9),point:js("point",uD),polygon:js("polygon",lD),polyline:js("polyline",cD),polylineVolume:js("polylineVolume",$9),properties:js("properties",sd),position:s0e("position"),rectangle:js("rectangle",fD),viewFrom:Q("viewFrom"),wall:js("wall",hD)});fp.prototype.isAvailable=function(e){let t=this._availability;return!_(t)||t.contains(e)};fp.prototype.addProperty=function(e){this._propertyNames.push(e),Object.defineProperty(this,e,ad(e,!0))};fp.prototype.removeProperty=function(e){let n=this._propertyNames.indexOf(e);this._propertyNames.splice(n,1),delete this[e]};fp.prototype.merge=function(e){this.name=T(this.name,e.name),this.availability=T(this.availability,e.availability);let t=this._propertyNames,n=_(e._propertyNames)?e._propertyNames:Object.keys(e),r=n.length;for(let o=0;o<r;o++){let a=n[o];if(a==="parent"||a==="name"||a==="availability")continue;let s=this[a],u=e[a];!_(s)&&t.indexOf(a)===-1&&this.addProperty(a),_(u)&&(_(s)?_(s.merge)&&s.merge(u):_(u.merge)&&_(u.clone)?this[a]=u.clone():this[a]=u)}};var eW=new ne,tW=new x,nW=new je;fp.prototype.computeModelMatrix=function(e,t){let n=ye.getValueOrUndefined(this._position,e,tW);if(!_(n))return;let r=ye.getValueOrUndefined(this._orientation,e,nW);return _(r)?t=U.fromRotationTranslation(ne.fromQuaternion(r,eW),n,t):t=yn.eastNorthUpToFixedFrame(n,void 0,t),t};fp.prototype.computeModelMatrixForHeightReference=function(e,t,n,r,o){let a=ye.getValueOrDefault(t,e,Pt.NONE),s=ye.getValueOrUndefined(this._position,e,tW);if(a===Pt.NONE||!_(s)||x.equalsEpsilon(s,x.ZERO,z.EPSILON8))return this.computeModelMatrix(e,o);let u=r.cartesianToCartographic(s,o0e);a===Pt.CLAMP_TO_GROUND?u.height=n:u.height+=n,s=r.cartographicToCartesian(u,s);let l=ye.getValueOrUndefined(this._orientation,e,nW);return _(l)?o=U.fromRotationTranslation(ne.fromQuaternion(l,eW),s,o):o=yn.eastNorthUpToFixedFrame(s,void 0,o),o};fp.supportsMaterialsforEntitiesOnTerrain=function(e){return K9.supportsMaterials(e)};fp.supportsPolylinesOnTerrain=function(e){return p9.isSupported(e)};var is=fp;var rW={};function UE(e,t){_(rW[e])||(rW[e]=!0,console.warn(T(t,e)))}UE.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";UE.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored";UE.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored";UE.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var l0=UE;function u0e(e,t){l0(e,t)}var nl=u0e;function Xc(e,t){this._content=e,this._batchId=t,this._color=void 0}Object.defineProperties(Xc.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return _(this._color)||(this._color=new K),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},polylinePositions:{get:function(){if(!!_(this._content.getPolylinePositions))return this._content.getPolylinePositions(this._batchId)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},featureId:{get:function(){return this._batchId}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}});Xc.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)};Xc.prototype.getPropertyNames=function(e){return nl("Cesium3DTileFeature.getPropertyNames","Cesium3DTileFeature.getPropertyNames was deprecated in CesiumJS 1.95 and will be removed in 1.98. Use Cesium3DTileFeature.getPropertyIds instead"),this._content.batchTable.getPropertyIds(this._batchId,e)};Xc.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)};Xc.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)};Xc.getPropertyInherited=function(e,t,n){let r=e.batchTable;if(_(r)){if(r.hasPropertyBySemantic(t,n))return r.getPropertyBySemantic(t,n);if(r.hasProperty(t,n))return r.getProperty(t,n)}let o=e.metadata;if(_(o)){if(o.hasPropertyBySemantic(n))return o.getPropertyBySemantic(n);if(o.hasProperty(n))return o.getProperty(n)}let a=e.tile,s=a.metadata;if(_(s)){if(s.hasPropertyBySemantic(n))return s.getPropertyBySemantic(n);if(s.hasProperty(n))return s.getProperty(n)}let u;if(_(a.implicitSubtree)&&(u=a.implicitSubtree.metadata),_(u)){if(u.hasPropertyBySemantic(n))return u.getPropertyBySemantic(n);if(u.hasProperty(n))return u.getProperty(n)}let l=_(e.group)?e.group.metadata:void 0;if(_(l)){if(l.hasPropertyBySemantic(n))return l.getPropertyBySemantic(n);if(l.hasProperty(n))return l.getProperty(n)}let c=e.tileset.metadata;if(_(c)){if(c.hasPropertyBySemantic(n))return c.getPropertyBySemantic(n);if(c.hasProperty(n))return c.getProperty(n)}};Xc.prototype.getPropertyInherited=function(e){return Xc.getPropertyInherited(this._content,this._batchId,e)};Xc.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0};Xc.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)};Xc.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)};Xc.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var iW=Xc;var c0=[];function f0(e){this._handler=new Jg(e.canvas,!0),this._viewer=e,this._state={mouseMove:!1}}f0.prototype.setListener=function(e,t,n){c0.length>0&&this.removeListener(),typeof t!="function"&&(n=t,t=void 0),l0e(this,e,t,n)};f0.prototype.moveListener=function(e){if(!_(e))return;Ss.typeOf.func("moveListener",e),c0.push(pn.MOUSE_MOVE);let t=this._handler,n=this._viewer.scene,r=this._state;t.setInputAction(function(o){if(r.mouseMove)return;let a=dD(n,o);e(a)},pn.MOUSE_MOVE)};f0.prototype.removeMoveListener=function(){this._handler.removeInputAction(pn.MOUSE_MOVE)};f0.prototype.removeListener=function(){for(;c0.length!==0;){let e=c0.pop();this._handler.removeInputAction(e)}};f0.prototype.setInputAction=function(e,t,n){this._handler.setInputAction(e,t,n)};f0.prototype.removeInputAction=function(e,t){this._handler.removeInputAction(e,t)};f0.prototype.destroy=function(){this._handler.destroy()};function l0e(e,t,n,r){r===U_.LEFT_RIGHT_CLICK?c0e(e,t,n):r===U_.LEFT_DOUBLE_CLICK&&f0e(e,t,n)}function c0e(e,t,n){let r=e._handler;c0.push(pn.LEFT_UP),c0.push(pn.RIGHT_CLICK),r.setInputAction(function(o){if(_(t)){let a=dD(e._viewer.scene,o);t(kt(a))}},pn.LEFT_UP),r.setInputAction(function(o){if(_(n)){let a=dD(e._viewer.scene,o);n(kt(a))}},pn.RIGHT_CLICK)}function f0e(e,t,n){let r=e._handler;c0.push(pn.LEFT_CLICK),c0.push(pn.LEFT_DOUBLE_CLICK);let o=!0,a,s=Date.now();r.setInputAction(function(l){let c=Date.now(),f=c-s;if(s=c,!(f<500&&!o)){if(f<500&&o){a!==void 0&&(a=a()),a=e._viewer.scene._preUpdate.addEventListener(function(){u(l),a=a()});return}o=!0,u(l)}},pn.LEFT_CLICK),r.setInputAction(function(l){a!==void 0&&(a=a()),o=!1,u(l)},pn.LEFT_DOUBLE_CLICK);function u(l){let c=dD(e._viewer.scene,l);o?_(t)&&t(c):_(n)&&n(c)}}function h0e(e,t){let n={},r=e.pick(t);if(!!_(r))return r instanceof iW?(n.type="tilt",n.value=r):r.id instanceof is?(n.type="entity",n.value=r.id):(n.type="primitive",n.pick=r.primitive),kt(n)}function dD(e,t){let n={};return n.event=kt(t),n.pick=h0e(e,_(t.position)?t.position:t.endPosition),n.cartesian3=d0e(e,_(t.position)?t.position:t.endPosition),kt(n)}function d0e(e,t){let n=e.camera,r;e.pickPositionSupported&&(r=e.pickPositionWorldCoordinates(t));let o=n.getPickRay(t),a=e.globe.pick(o,e),s=_(r)?x.distance(n._positionWC,r):Number.POSITIVE_INFINITY,u=_(a)?x.distance(n._positionWC,a):Number.POSITIVE_INFINITY;return s<u&&e.mode!==Ne.SCENE2D?r:a}var pD=f0;function RC(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new xe,this.setCallback(e,t)}Object.defineProperties(RC.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});RC.prototype.getValue=function(e,t){return this._callback(e,t)};RC.prototype.setCallback=function(e,t){let n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)};RC.prototype.equals=function(e){return this===e||e instanceof RC&&this._callback===e._callback&&this._isConstant===e._isConstant};var Ks=RC;var ny=[];function h0(e){this._viewer=e,this._aggregator=new pD(e),this._type=void 0,this._stop=!1,this._options=void 0,this._callback=void 0,this._isDestroyed=!1}Object.defineProperties(h0.prototype,{stop:{set:function(e){Ss.typeOf.bool("stop",e),this._stop=e},get:function(){return this._stop}},type:{get:function(){return this._type}},callback:{get:function(){return this._callback},set:function(e){Ss.typeOf.func("callback",e),this._callback=e}}});h0.prototype.draw=function(e,t,n,r){Ss.typeOf.object("option",e),Ss.typeOf.func("finish",t),Ss.typeOf.number("type",n),r=T(r,!1),this._options=e,this._callback=t,this._type=n,this._stop=!1,p0e(this,e,r)};h0.prototype.destroy=function(){this.clear(),this._aggregator.destroy(),ot(this),this._isDestroyed=!0};h0.prototype.remove=function(){this.clear(),this._stop=!0,this._aggregator.removeListener()};h0.prototype.isDestroyed=function(){return this._isDestroyed};h0.prototype.clear=function(){for(let e=0;e<ny.length;e++)this._viewer.entities.remove(ny[e]);ny.length=0};h0.prototype.clearEntity=function(e){for(let t=0;t<ny.length;t++)e===ny[t].name&&(this._viewer.entities.remove(ny[t]),t--)};function p0e(e,t,n){let r=e._aggregator,o=e._viewer,a=[],s,u=!1;r.setListener(function(l){if(_(l.cartesian3)){if(e._stop)return;if(a.length===0){if(e._type===td.POLYGON){if(l.cartesian3.z!==null){let c=[];a=c,a.push(l.cartesian3),t.hierarchy=new Ks(function(){let f=c.length;return f>2&&c[f-2].equals(c[f-1])&&c.splice(f-1,1),new ty(c)},!1),s=new is({polygon:t}),r._state.mouseMove=!1}}else if(e._type===td.POLYLINE){let c=[];a=c,a.push(l.cartesian3),t.positions=new Ks(function(){let f=c[c.length-1]instanceof Array,h=c[c.length-1][0];return f&&(c.splice(c.length-1,1),c.push(h)),c},!1),t.name!==void 0?s=new is({polyline:t,name:t.name}):s=new is({polyline:t}),r._state.mouseMove=!1}else if(e._type===td.POINT)s=new is({position:l.cartesian3,point:t}),e._callback(s);else if(e._type===td.MEASURELINE){let c=[];a=c,a.push(l.cartesian3),t.positions=new Ks(function(){let f=c[c.length-1]instanceof Array,h=c[c.length-1][0];return f&&(c.splice(c.length-1,1),c.push(h)),c},!1),s=new is({polyline:t}),r._state.mouseMove=!1}else if(e._type===td.CIRCLE&&l.cartesian3.z!==null){let c=[];a=c,a.push(l.cartesian3),t.semiMinorAxis=new Ks(function(){if(c.length>=2)return x.distance(c[0],c[1])},!1),t.semiMajorAxis=new Ks(function(){if(c.length>=2)return x.distance(c[0],c[1])},!1),t.name!==void 0?s=new is({position:l.cartesian3,ellipse:t}):s=new is({position:l.cartesian3,ellipse:t}),r._state.mouseMove=!1}ny.push(o.entities.add(s))}e._type!==td.CIRCLE&&(u=!0)}},function(){e._type!==td.POINT&&(e._stop||(n&&(e._stop=!0),_(s.positions)||(s.positions=a),a=[],e._callback(s)))},U_.LEFT_RIGHT_CLICK),r.moveListener(function(l){let c=a.length;if(c===0){r._state.mouseMove=!0;return}if(_(l.cartesian3)){let f=l.cartesian3;c===1?a.push(f):c>1&&(u?e._type===td.MEASURELINE?a.push([f]):a.push(f):a[c-1]=f),u=!1}})}var oW=h0;function ry(e){this._url=m0e(e.url),this._width=e.width,this._height=e.height,this._id=_i(),this._canvas=new OffscreenCanvas(this._width||160,this._height||90),this._canvasContext2D=this._canvas.getContext("2d"),this._frames=[],this._preUpdate=new Cesium.Event,this._postUpdate=new Cesium.Event,this._ready=!1,this._readyPromise=Ro(),this._nextFrameIndex=0,this._lastFrameTime=null,this._fullData=!1,this._play=!0,this._loopPlayState=!0,this._stopPlayCallbackFunc=void 0,e.fps&&(this._delay=1e3/e.fps,this._useCustomFPS=!0),this._load()}Object.defineProperties(ry.prototype,{url:{set:function(e){this._url=e},get:function(){return this._url}},canvas:{get:function(){return this._canvas}},context2D:{get:function(){return this._canvasContext2D}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},id:{get:function(){return this._id}},width:{get:function(){return this._canvas.width}},height:{get:function(){return this._canvas.height}},fps:{get:function(){let e=1e3/this._delay;return Math.round(e)},set:function(e){if(typeof e!="number"||e<=0)throw new Le("fps\u9700\u8981\u662F\u6B63\u6574\u6570");this._delay=1e3/e}}});ry.prototype._load=function(){let e=this,t=new Worker(Pa("Workers/parseGif.js"));t.onmessage=function(n){let r=n.data;if(r.finish)e._fullData=!0,t=null;else{let o=r.data;e._frames.push({data:o,delay:r.delay}),e._ready||(e._useCustomFPS||(e._delay=r.delay),_(e._width)||(e._canvas.width=e._width=o.width),_(e._height)||(e._canvas.height=e._height=o.height),e._ready=!0,e._readyPromise.resolve(!0))}},t.postMessage({url:this._url,width:e._width,height:e._height})};ry.prototype.playOnce=function(e){this._loopPlayState=!1,this._stopPlayCallbackFunc=e,this._play=!0,this._updateImageData(0)};ry.prototype.update=function(){if(!!this._ready&&!!this._play)if(!this._lastFrameTime)this._updateImageData(0);else{let e=performance.now()-this._lastFrameTime,t=this._lastFrameIndex,n=t,r=this._frames.length;if(this._useCustomFPS){if(n+=Math.floor(e/this._delay),n>=r&&(this._fullData?n%=r:n=r-1,!this._loopPlayState&&this._stopPlayCallbackFunc)){this._stopPlayCallbackFunc(),this._play=!1;return}}else{let o=this._frames[t].delay;for(;e>o;){if(n===this._frames.length-1){if(!this._loopPlayState&&this._stopPlayCallbackFunc){this._stopPlayCallbackFunc(),this._play=!1;return}if(this._fullData)n=0;else{n=r-1;break}}else++n;e-=o,o=this._frames[n].delay}}n!==t&&this._updateImageData(n)}};ry.prototype._updateImageData=function(e){this._preUpdate.raiseEvent();let t=this._frames[e].data;this._canvasContext2D.clearRect(0,0,this._canvasContext2D.canvas.width,this._canvasContext2D.canvas.height),this._canvasContext2D.putImageData(t,0,0),this._lastFrameIndex=e,this._lastFrameTime=performance.now(),this._postUpdate.raiseEvent()};function m0e(e){if(/^http[s]{0,1}:\/\//.test(e))return e;let t=location.href,n=t.lastIndexOf("/");t=t.substring(0,n),/^\.\//.test(e)&&(e=e.substring(2));let r=/^\.\.\//;for(;r.test(e);)n=t.lastIndexOf("/"),t=t.substring(0,n),e=e.substring(3);return t.concat("/").concat(e)}ry.prototype.destroy=function(){this._canvasContext2D=null,this._canvas=null,this._frames=null,this._preUpdate=null,this._postUpdate=null,this._readyPromise=null};var mD=ry;function Bm(e){if(!(e instanceof Cesium.Viewer))throw new Le("viewer is not a instance of Viewer.");this._viewer=e,this.gifs=new Va,e.clock.onTick.addEventListener(this.update,this)}Object.defineProperties(Bm.prototype,{length:{get:function(){return this.gif.length}},values:{get:function(){return this.gif.values}}});Bm.prototype.add=function(e){let t;if(e instanceof Cesium.EV_Gif)t=e;else if(typeof e=="object")t=new mD(e);else throw new Le("options is not a object");return t&&this.gifs.set(t._id,t),t};Bm.prototype.contains=function(e){return this.gifs.contains(e)};Bm.prototype.get=function(e){return this.gifs.get(e)};Bm.prototype.remove=function(e){return this.gifs.remove(e.id)};Bm.prototype.removeAll=function(){this.gifs.removeAll()};Bm.prototype.update=function(){let e=this.gifs.values;for(let t=0,n=e.length;t<n;++t)e[t].update()};Bm.prototype.destroy=function(){this._viewer.clock.onTick.removeEventListener(this.update,this),this._viewer=null,this.gifs=null};var aW=Bm;var ay,p0=!1,wi=!1,j,on=0,$,iy=!1,In={},Nt,ai,d0=!1,Ha=!1,oy=!0,vD=!1;function ve(e){this.gemotryList=new Cesium.AssociativeArray,this.billboardCollection=new Cesium.BillboardCollection,this.index=0,this.viewer=e,this.viewer.scene.primitives.add(this.billboardCollection),this.viewer.scene.globe.depthTestAgainstTerrain=!1,this.viewer.scene.enableDepthPlane=!0,this.leftClickStartEdit=new Cesium.Event}ve.prototype.drawPolygon=function(e,t){let n=this;Pi(n),n.index++,e.name=`\u591A\u8FB9\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polygon",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=HE(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1);let r=j.polygon.hierarchy.getValue();Nt=WE(e,n.viewer,r),setTimeout(()=>{Nt.show=e.outline.show},10),n.gemotryList.get(e.id).push(Nt),j.callbackFunc=t};ve.prototype.drawCircle=function(e,t){let n=this;return Pi(n),e.geometryType="circle",n.index++,e.name=`\u5706\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=HE(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1),Nt=WE(e,n.viewer),setTimeout(()=>{Nt.show=e.outline.show},10),n.gemotryList.get(e.id).push(Nt),j.callbackFunc=t,e.id};ve.prototype.drawEllipse=function(e,t){let n=this;return Pi(n),n.index++,e.name=`\u692D\u5706${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="ellipse",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=HE(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.width=Cesium.defaultValue(e.outline.width,1),Nt=WE(e,n.viewer),setTimeout(()=>{Nt.show=e.outline.show},10),n.gemotryList.get(e.id).push(Nt),j.callbackFunc=t,e.id};ve.prototype.drawRectangle=function(e,t){let n=this;return Pi(n),n.index++,e.name=`\u77E9\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="rectangle",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=HE(e,n.viewer),n.gemotryList.set(e.id,[j]),e.outline.material=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,1,1,1)),e.outline.show=Cesium.defaultValue(e.outline.show,!1),e.outline.width=Cesium.defaultValue(e.outline.width,1),Nt=WE(e,n.viewer),setTimeout(()=>{Nt.show=e.outline.show},10),n.gemotryList.get(e.id).push(Nt),j.callbackFunc=t,e.id};ve.prototype.drawPolyline=function(e,t){let n=this;return Pi(n),wi=!0,n.index++,e.name=`\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=YE(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ve.prototype.drawPoint=function(e,t){let n=this;return Pi(n),n.index++,e.name=`\u70B9${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="point",e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=g0e(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ve.prototype.drawSector=function(e,t){let n=this;return Pi(n),n.index++,e.name=`\u6247\u5F62${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="sector",e.attr!=null&&(e.attr.height=Cesium.defaultValue(e.attr.height,1e3)),e.outline=Cesium.defaultValue(e.outline,{draw:!1}),j=HE(e,n.viewer),wi=!0,n.gemotryList.set(e.id,[j]),Nt=WE(e,n.viewer),e.extrudedHeight&&(e.outline.show=!1),setTimeout(()=>{Nt.show=e.outline.show},10),n.gemotryList.get(e.id).push(Nt),j.callbackFunc=t,e.id};ve.prototype.drawArrowLine=function(e,t){let n=this;Pi(n),wi=!0,n.index++,e.name=`\u5355\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowLine_single"),j=YE(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=v0e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ve.prototype.drawArrowCurve=function(e,t){let n=this;Pi(n),wi=!0,n.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),e.lineStyle="curve",j=YE(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=E0e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ve.prototype.drawArrowTriangle=function(e,t){let n=this;Pi(n),wi=!0,n.index++,e.name=`\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),j=YE(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=C0e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ve.prototype.drawArrowCurveTriangle=function(e,t){let n=this;Pi(n),wi=!0,n.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${n.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),e.lineStyle="curve",j=YE(e,n.viewer),n.gemotryList.set(e.id,[j]);let r=S0e(e,this.viewer);return r.length==1?n.gemotryList.get(e.id).push(r[0]):(n.gemotryList.get(e.id).push(r[0]),n.gemotryList.get(e.id).push(r[1])),j.callbackFunc=t,e.id};ve.prototype.drawCurve=function(e,t){let n=this;return Pi(n),wi=!0,n.index++,e.name="\u5706\u5F27"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="curve",j=b0e(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ve.prototype.drawCurveByAttr=function(e,t){let n=this;Pi(n),e.geometryType="curve",n.index++;let r=ud(e.geometryType,n.index);e.name=r;let o=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=o;let a=So(e);return j=y0e(e,n.viewer,a),n.gemotryList.set(o,[j]),wi=!1,o};ve.prototype.drawBezierWall=function(e,t){let n=this;return e.geometryType="bezierWall",e.name="\u8D1D\u585E\u5C14\u66F2\u7EBF\u4F53"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),Pi(n),wi=!0,n.index++,j=xD(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ve.prototype.drawCurveWall=function(e,t){let n=this;return e.geometryType="curveWall",e.name="\u5706\u5F27\u4F53"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),Pi(n),wi=!0,n.index++,j=xD(e,n.viewer),n.gemotryList.set(e.id,[j]),j.callbackFunc=t,e.id};ve.prototype.drawCurveWallByAttr=function(e){let t=this;Pi(t),e.geometryType="curveWall",t.index++,e.name="\u5706\u5F27\u4F53"+t.index;let n=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=n;let r=So(e);return e.byAttr=!0,j=xD(e,t.viewer,r),t.gemotryList.set(n,[j]),wi=!1,n};ve.prototype.drawBezierWallByAttr=function(e){let t=this;Pi(t),e.geometryType="bezierWall",t.index++,e.name="\u8D1D\u585E\u5C14\u66F2\u7EBF\u4F53"+t.index;let n=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=n;let r=So(e);return e.byAttr=!0,j=xD(e,t.viewer,r),t.gemotryList.set(n,[j]),wi=!1,n};ve.prototype.drawMultipleArrowLine=function(e,t){let n=this;return Pi(n),wi=!0,n.index++,e.name="\u591A\u7BAD\u5934"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="multipleArrowLine",j=I0e(e,n.viewer),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,e.id};ve.prototype.drawMultipleArrowLineByAttr=function(e,t){let n=this;return Pi(n),n.index++,e.name="\u591A\u7BAD\u5934"+n.index,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.positions=Cesium.defaultValue(e.positions,[]),e.geometryType="multipleArrowLine",j=D0e(e,n.viewer,e.positions),n.gemotryList.set(e.id,[j]),t==null&&(t=function(r){}),j.callbackFunc=t,wi=!1,e.id};ve.prototype.startEdit=function(e){oy=!1,ay==null&&(ay=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas)),e!=null&&this.leftClickStartEdit._listeners.length==0&&this.leftClickStartEdit.addEventListener(e),uW(ay,this.viewer,this)};ve.prototype.stopEdit=function(e){let t=this;oy=!0,t.billboardCollection.removeAll(),$=void 0,iy=!1,In={},d0=!1,e!=null&&t.leftClickStartEdit._listeners.length!=0&&t.leftClickStartEdit.removeEventListener(e)};ve.prototype.startDraw=function(){Pi(this)};ve.prototype.stopDraw=function(){};ve.prototype.remove=function(e){let t=this;if(t.gemotryList.get(e)){let n=t.gemotryList.get(e)[0];t.viewer.entities.remove(n),t.gemotryList.get(e)[1]!=null&&t.viewer.entities.remove(t.gemotryList.get(e)[1]),t.gemotryList.get(e)[2]!=null&&t.viewer.entities.remove(t.gemotryList.get(e)[2]),t.gemotryList.remove(n.id)}t.billboardCollection.removeAll()};ve.prototype.setShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e).forEach(o=>{o.show=t})};ve.prototype.removeAll=function(){let e=this;for(let t in e.gemotryList._hash)e.gemotryList._hash[t][0].outline!=null&&e.gemotryList._hash[t][0].outline.show&&e.viewer.entities.remove(e.gemotryList._hash[t][1]),e.viewer.entities.remove(e.gemotryList._hash[t][0]);e.gemotryList.removeAll(),e.billboardCollection.removeAll(),Pi(e)};ve.prototype.LoadAnddrawGeomerty=function(e){};ve.prototype.exportGeometry=function(e){};ve.prototype.destroy=function(){return ay=void 0,p0=void 0,wi=void 0,j=void 0,on=void 0,$=void 0,iy=void 0,In=void 0,Nt=void 0,ai=void 0,d0=void 0,Ha=void 0,oy=void 0,vD=void 0,this.index=void 0,this.gemotryList.removeAll(),this.gemotryList=void 0,this.billboardCollection.removeAll(),this.billboardCollection=void 0,this.viewer=void 0,ot(this)};ve.prototype.drawSectorByAttr=function(e){let t=this;Pi(t),e.geometryType="sector",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=qE(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&!e.extrudedHeight&&(Nt=dp(e,t.viewer,o),t.gemotryList.get(r).push(Nt)),wi=!1,r};ve.prototype.setSectorFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&(n.gemotryList.get(e)[0].polygon.material=t)};ve.prototype.getSectorFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].polygon.material};ve.prototype.setShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e).forEach(o=>{o.show=t})};ve.prototype.setSectorRadius=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e)[0];r.attr.radius=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,startAngle:r.attr.startAngle,endAngle:r.attr.endAngle,height:r.attr.height},geometryType:"sector"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getSectorRadius=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].attr.radius};ve.prototype.setSectorPosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e)[0];r.anhor=t;let o={positions:t,attr:{radius:r.attr.radius,startAngle:r.attr.startAngle,endAngle:r.attr.endAngle,height:r.attr.height},geometryType:"sector"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getSectorPosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return t.gemotryList.get(e)[0].nodelist[0]};ve.prototype.setSectorOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ve.prototype.getSectorOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ve.prototype.setSectorAngle=function(e,t,n){let r=this;if(r.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(r.gemotryList.get(e)!=null&&r.gemotryList.get(e)[0].geometryType=="sector"){let o=r.gemotryList.get(e)[0];o.attr.startAngle=t,o.attr.endAngle=n;let a={positions:o.nodelist[0],attr:{radius:o.attr.radius,startAngle:o.attr.startAngle,endAngle:o.attr.endAngle,height:o.attr.height},geometryType:"sector"},s=So(a);for(let u=0;u<s.length;u++)o.nodelist[u]=s[u];if(o.anhor=s[0],o.entityChange.nodelistChange=!0,r.gemotryList.get(e)[1]!=null){for(let u=0;u<s.length;u++){let l=Jt(s[u],a.attr.height);o.nodelist[u]=l,r.gemotryList.get(e)[1].nodelist[u]=l,r.billboardCollection._billboards[0]!=null&&r.billboardCollection._billboards[0].id.split("_")[r.billboardCollection._billboards[0].id.split("_").length-1]==e&&(r.billboardCollection._billboards[u].position=l)}r.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getSectorAngle=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"){let n=t.gemotryList.get(e)[0].attr.startAngle,r=t.gemotryList.get(e)[0].attr.endAngle;return{startAngle:n,endAngle:r}}};ve.prototype.setSectorOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ve.prototype.getSectorOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ve.prototype.setSectorOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="sector"){let r=n.gemotryList.get(e);if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ai=r[1]:Nt=r[1];else{let o=dp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Nt=void 0,ai=void 0}};ve.prototype.getSectorOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="sector")return n[1].show};ve.prototype.setSectorAttr=function(e,t){let n=this,r=n.gemotryList.get(e);if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let o=Cesium.defaultValue(t.material,n.getSectorFillMaterial(e));n.setSectorFillMaterial(e,o);let a=Cesium.defaultValue(t.anhor,n.getSectorPosition(e));n.setSectorPosition(e,a);let s=Cesium.defaultValue(t.outline.show,n.getSectorOutlineShow(e));n.setSectorOutlineShow(e,s);let u=Cesium.defaultValue(t.outline.width,n.getSectorOutlineWidth(e));n.setSectorOutlineWidth(e,u);let l=Cesium.defaultValue(t.outline.material,n.getSectorOutlineMaterial(e));n.setSectorOutlineMaterial(e,l);let c=Cesium.defaultValue(t.attr.radius,n.getSectorRadius(e));n.setSectorRadius(e,c);let f=Cesium.defaultValue({startAngle:t.attr.startAngle,endAngle:t.attr.endAngle},n.getSectorAngle(e));n.setSectorAngle(e,f.startAngle,f.endAngle)}};ve.prototype.getSectorAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{material:t.getSectorFillMaterial(e),outline:{show:t.getSectorOutlineShow(e),material:t.getSectorOutlineMaterial(e),width:t.getSectorOutlineWidth(e)},attr:{height:n[0].attr.height,radius:t.getSectorRadius(e),startAngle:t.getSectorAngle(e).startAngle,endAngle:t.getSectorAngle(e).endAngle},anhor:t.getSectorPosition(e),id:e,name:n[0].name}};ve.prototype.drawCircleByAttr=function(e){let t=this;Pi(t),e.geometryType="circle",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=qE(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Nt=dp(e,t.viewer,o),t.gemotryList.get(r).push(Nt)),wi=!1,r};ve.prototype.setCircleFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&(n.gemotryList.get(e)[0].polygon.material=t)};ve.prototype.getCircleFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].polygon.material};ve.prototype.setCircleRadius=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="circle"){let r=n.gemotryList.get(e)[0];r.attr.radius=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,height:r.attr.height},geometryType:"circle"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getCircleRadius=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].attr.radius};ve.prototype.setCirclePosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="circle"){let r=n.gemotryList.get(e)[0];r.nodelist[0]=t;let o={positions:r.nodelist[0],attr:{radius:r.attr.radius,height:r.attr.height},geometryType:"circle"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.entityChange.nodelistChange=!0,r.anhor=a[0],n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getCirclePosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle")return t.gemotryList.get(e)[0].nodelist[0]};ve.prototype.setCircleOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ve.prototype.getCircleOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ve.prototype.setCircleOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ve.prototype.getCircleOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ve.prototype.setCircleOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ai=r[1]:Nt=r[1];else{let o=dp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Nt=void 0,ai=void 0};ve.prototype.getCircleOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ve.prototype.setCircleIntervalDegrees=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="circle"&&n.gemotryList.get(e)[1]!=null&&n.gemotryList.get(e)[0].Interval_degrees!=null&&(n.gemotryList.get(e)[0].Interval_degrees.value=t,n.gemotryList.get(e)[0].entityChange.nodelistChange=!0,n.gemotryList.get(e)[1].Interval_degrees.value=t,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0)};ve.prototype.getCircleIntervalDegrees=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="circle"&&t.gemotryList.get(e)[1]!=null&&t.gemotryList.get(e)[0].Interval_degrees!=null)return t.gemotryList.get(e)[0].Interval_degrees.value==null?12:t.gemotryList.get(e)[0].Interval_degrees.value};ve.prototype.getCircleAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{anhor:t.getCirclePosition(e),attr:{height:n[0].attr.height,radius:t.getCircleRadius(e),Interval_degrees:t.getCircleIntervalDegrees(e)},outline:{show:t.getCircleOutlineShow(e),width:t.getCircleOutlineWidth(e),material:t.getCircleOutlineMaterial(e)},material:t.getCircleFillMaterial(e),id:e,name:n[0].name}};ve.prototype.setCircleAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let r=Cesium.defaultValue(t.anhor,n.getCirclePosition(e));n.setCirclePosition(e,r);let o=Cesium.defaultValue(t.outline.material,n.getCircleOutlineMaterial(e));n.setCircleOutlineMaterial(e,o);let a=Cesium.defaultValue(t.outline.show,n.getCircleOutlineShow(e));n.setCircleOutlineShow(e,a);let s=Cesium.defaultValue(t.outline.width,n.getCircleOutlineWidth(e));n.setCircleOutlineWidth(e,s);let u=Cesium.defaultValue(t.material,n.getCircleFillMaterial(e));n.setCircleFillMaterial(e,u);let l=Cesium.defaultValue(t.attr.radius,n.getCircleRadius(e));n.setCircleRadius(e,l);let c=Cesium.defaultValue(t.Interval_degrees,n.getCircleIntervalDegrees(e));n.setCircleIntervalDegrees(e,c)}};ve.prototype.drawEllipseByAttr=function(e){let t=this;Pi(t),e.geometryType="ellipse",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=qE(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Nt=dp(e,t.viewer,o),t.gemotryList.get(r).push(Nt)),wi=!1,r};ve.prototype.setEllipseFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&(n.gemotryList.get(e)[0].polygon.material=t)};ve.prototype.getEllipseFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].polygon.material};ve.prototype.setEllipseMinoraxis=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.attr.minoraxis=t;let o={positions:r.nodelist[0],attr:{minoraxis:r.attr.minoraxis,majoraxis:r.attr.majoraxis,height:r.attr.height},geometryType:"ellipse"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getEllipseMinoraxis=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&this.gemotryList.get(e)[0].geometryType=="ellipse")return this.gemotryList.get(e)[0].attr.minoraxis};ve.prototype.setEllipseMajoraxis=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.attr.majoraxis=t;let o={positions:r.nodelist[0],attr:{minoraxis:r.attr.minoraxis,majoraxis:r.attr.majoraxis,height:r.attr.height},geometryType:"ellipse"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getEllipseMajoraxis=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].attr.majoraxis};ve.prototype.setEllipsePosition=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"){let r=n.gemotryList.get(e)[0];r.nodelist[0]=t;let o={positions:r.nodelist[0],attr:{majoraxis:r.attr.majoraxis,minoraxis:r.attr.minoraxis,height:r.attr.height},geometryType:"ellipse"},a=So(o);for(let s=0;s<a.length;s++)r.nodelist[s]=a[s];if(r.anhor=a[0],r.entityChange.nodelistChange=!0,n.gemotryList.get(e)[1]!=null){for(let s=0;s<a.length;s++){let u=Jt(a[s],o.attr.height);r.nodelist[s]=u,n.gemotryList.get(e)[1].nodelist[s]=u,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[s].position=u)}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getEllipsePosition=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse")return t.gemotryList.get(e)[0].nodelist[0]};ve.prototype.setEllipseOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.material=t)};ve.prototype.getEllipseOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ve.prototype.setEllipseOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ve.prototype.getEllipseOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ve.prototype.setEllipseOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null&&(j.outline.show=!0),$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ai=r[1]:Nt=r[1];else{let o=dp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Nt=void 0,ai=void 0};ve.prototype.getEllipseOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ve.prototype.setEllipseIntervalDegrees=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="ellipse"&&n.gemotryList.get(e)[1]!=null&&n.gemotryList.get(e)[0].Interval_degrees!=null&&(n.gemotryList.get(e)[0].Interval_degrees.value=t,n.gemotryList.get(e)[0].entityChange.nodelistChange=!0,n.gemotryList.get(e)[1].Interval_degrees.value=t,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0)};ve.prototype.getEllipseIntervalDegrees=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="ellipse"&&t.gemotryList.get(e)[1]!=null&&t.gemotryList.get(e)[0].Interval_degrees!=null)return t.gemotryList.get(e)[0].Interval_degrees.value==null?12:t.gemotryList.get(e)[0].Interval_degrees.value};ve.prototype.setEllipseAttr=function(e,t){let n=this,r=n.gemotryList.get(e);if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let o=Cesium.defaultValue(t.anhor,n.getEllipsePosition(e));n.setEllipsePosition(e,o);let a=Cesium.defaultValue(t.outline.material,n.getEllipseOutlineMaterial(e));n.setEllipseOutlineMaterial(e,a);let s=Cesium.defaultValue(t.outline.show,n.getEllipseOutlineShow(e));n.setEllipseOutlineShow(e,s);let u=Cesium.defaultValue(t.outline.width,n.getEllipseOutlineWidth(e));n.setEllipseOutlineWidth(e,u);let l=Cesium.defaultValue(t.material,n.getEllipseFillMaterial(e));n.setEllipseFillMaterial(e,l);let c=Cesium.defaultValue(t.attr.majoraxis,n.getEllipseMajoraxis(e));n.setEllipseMajoraxis(e,c);let f=Cesium.defaultValue(t.attr.minoraxis,n.getEllipseMinoraxis(e));n.setEllipseMinoraxis(e,f);let h=Cesium.defaultValue(t.Interval_degrees,n.getEllipseIntervalDegrees(e));n.setEllipseIntervalDegrees(e,h)}};ve.prototype.getEllipseAttr=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{anhor:t.getEllipsePosition(e),attr:{height:n[0].attr.height,majoraxis:t.getEllipseMajoraxis(e),minoraxis:t.getEllipseMinoraxis(e),Interval_degrees:t.getEllipseIntervalDegrees(e)},outline:{show:t.getEllipseOutlineShow(e),width:t.getEllipseOutlineWidth(e),material:t.getEllipseOutlineMaterial(e)},material:t.getEllipseFillMaterial(e),id:e,name:n[0].name}};ve.prototype.drawRectangleByAttr=function(e){let t=this;Pi(t),e.geometryType="rectangle",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=qE(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Nt=dp(e,t.viewer,o),t.gemotryList.get(r).push(Nt)),wi=!1,r};ve.prototype.setRectangleFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&(n.gemotryList.get(e)[0].polygon.material=t)};ve.prototype.getRectangleFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle")return t.gemotryList.get(e)[0].polygon.material};ve.prototype.setRectanglePoint=function(e,t,n){let r=this;if(r.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(r.gemotryList.get(e)!=null&&r.gemotryList.get(e)[0]!=null&&r.gemotryList.get(e)[0].geometryType=="rectangle"){let o=r.gemotryList.get(e)[0];o.attr.endPoint=n,o.attr.startPoint=t;let a={attr:{height:o.attr.height,startPoint:o.attr.startPoint,endPoint:o.attr.endPoint},geometryType:"rectangle"},s=So(a);for(let l=0;l<s.length;l++)o.nodelist[l]=s[l];o.entityChange.nodelistChange=!0;let u=sy(o.nodelist);if(o.anhor=u,r.gemotryList.get(e)[1]!=null){for(let l=0;l<s.length;l++){let c=Jt(s[l],a.attr.height);o.nodelist[l]=c,r.gemotryList.get(e)[1].nodelist[l]=c,r.billboardCollection._billboards[0]!=null&&r.billboardCollection._billboards[0].id.split("_")[r.billboardCollection._billboards[0].id.split("_").length-1]==e&&(r.billboardCollection._billboards[l+1].position=c)}r.billboardCollection._billboards[0]!=null&&(r.billboardCollection._billboards[0].position=u),r.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getRectanglePoint=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"){let n=t.gemotryList.get(e)[0].nodelist[0];return{endPoint:t.gemotryList.get(e)[0].nodelist[1],startPoint:n}}};ve.prototype.setRectangleOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&n.gemotryList.get(e)[1]!=null)return n.gemotryList.get(e)[1].polyline.material=t,t};ve.prototype.getRectangleOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ve.prototype.setRectangleOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="rectangle"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ve.prototype.getRectangleOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="rectangle"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width};ve.prototype.setRectangleOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!==void 0)if(t)if(j!=null?j.outline.show=!0:$!==void 0&&($.outline.show=!0),r[0].outline.show=!0,r.length===2)r[1].show=!0,$!==void 0?ai=r[1]:Nt=r[1];else{let o=dp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null&&(j.outline.show=!1),$!=null&&($.outline.show=!1),r[1].show=!1,Nt=void 0};ve.prototype.getRectangleOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ve.prototype.setRectangleAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&(n.setRectanglePoint(e,t.attr.startPoint,t.attr.endPoint),n.setRectangleOutlineShow(e,t.outline.show),n.setRectangleFillMaterial(e,t.material),n.setRectangleOutlineWidth(e,t.outline.width),n.setRectangleOutlineMaterial(e,t.outline.material))};ve.prototype.getRectangleAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let n=t.gemotryList.get(e);if(n!=null)return{attr:{height:n[0].attr.height,startPoint:t.getRectanglePoint(e).startPoint,endPoint:t.getRectanglePoint(e).endPoint},material:t.getRectangleFillMaterial(e),outline:{show:t.getRectangleOutlineShow(e),width:t.getRectangleOutlineWidth(e),material:t.getRectangleOutlineMaterial(e)},id:e,name:n[0].name}};ve.prototype.drawPolygonByAttr=function(e){let t=this;Pi(t),e.geometryType="polygon",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=qE(e,t.viewer,o),t.gemotryList.set(r,[j]),e.outline.show&&(Nt=dp(e,t.viewer,o),t.gemotryList.get(r).push(Nt)),wi=!1,r};ve.prototype.setPolygonFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&(n.gemotryList.get(e)[0].polygon.material=t)};ve.prototype.getPolygonFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon")return t.gemotryList.get(e)[0].polygon.material};ve.prototype.setPolygonPositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height},positions:t,geometryType:"polygon"},a=So(o);if(r.nodelist.length<=a)for(let u=0;u<a.length;u++)r.nodelist[u]=a[u];else{let u=r.nodelist.length,l=a.length,c=u-l;r.nodelist.length=r.nodelist.length-c;for(let f=0;f<r.nodelist.length;f++)r.nodelist[f]=a[f]}r.entityChange.nodelistChange=!0;let s=sy(r.nodelist);if(r.anhor=s,n.gemotryList.get(e)[1]!=null){let u=n.gemotryList.get(e)[1].nodelist.length,l=a.length,c=u-l;c>=0&&(n.gemotryList.get(e)[1].nodelist.length=n.gemotryList.get(e)[1].nodelist.length-c);for(let f=0;f<a.length;f++){let h=Jt(a[f],o.attr.height);r.nodelist[f]=h,n.gemotryList.get(e)[1].nodelist[f]=h,n.billboardCollection._billboards[0]!=null&&(n.billboardCollection._billboards[0].position=s,n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f+1].position=h))}n.gemotryList.get(e)[1].entityChange.nodelistChange=!0}}};ve.prototype.getPolygonPositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon")return this.gemotryList.get(e)[0].nodelist};ve.prototype.setPolygonOutlineMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&n.gemotryList.get(e)[1]!=null)return n.gemotryList.get(e)[1].polyline.material=t,t};ve.prototype.getPolygonOutlineMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.material};ve.prototype.setPolygonOutlineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polygon"&&n.gemotryList.get(e)[1]!=null&&(n.gemotryList.get(e)[1].polyline.width=t)};ve.prototype.getPolygonOutlineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polygon"&&t.gemotryList.get(e)[1]!=null)return t.gemotryList.get(e)[1].polyline.width._value};ve.prototype.setPolygonOutlineShow=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)if(t)if(j!=null?j.outline.show=!0:$!=null&&($.outline.show=!0),r[0].outline.show=!0,r.length==2)r[1].show=!0,$!=null?ai=r[1]:Nt=r[1],r[1].entityChange.nodelistChange=!0;else{let o=dp({geometryType:r[0].geometryType,attr:{height:r[0].attr.height},outline:{width:r[0].outline.width,material:r[0].outline.material}},n.viewer,r[0].nodelist);o.show=!0,r.push(o)}else j!=null?j.outline.show=!1:$!=null&&($.outline.show=!1),r[0].outline.show=!1,r[1].show=!1,Nt=void 0,ai=void 0};ve.prototype.getPolygonOutlineShow=function(e){let t=this,n=t.gemotryList.get(e);if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return n[1].show};ve.prototype.getPolygonAttr=function(e){let t={},n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");let r=n.gemotryList.get(e);if(r!=null)return t.material=n.getPolygonFillMaterial(e),t.positions=n.getPolygonPositions(e),t.outline={material:n.getPolygonOutlineMaterial(e),width:n.getPolygonOutlineWidth(e),show:n.getPolygonOutlineShow(e)},t.attr={height:r[0].attr.height},t.id=e,t};ve.prototype.setPolygonAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null){let o=Cesium.defaultValue(t.outline.show,n.getPolygonOutlineShow(e));n.setPolygonOutlineShow(e,o);let a=Cesium.defaultValue(t.material,n.getPolygonFillMaterial(e));n.setPolygonFillMaterial(e,a);let s=Cesium.defaultValue(t.outline.width,n.getPolygonOutlineWidth(e));n.setPolygonOutlineWidth(e,s);let u=Cesium.defaultValue(t.outline.material,n.getPolygonOutlineMaterial(e));n.setPolygonOutlineMaterial(e,u);let l=Cesium.defaultValue(t.positions,n.getPolygonPositions(e));n.setPolygonPositions(e,l)}};ve.prototype.drawPolylineByAttr=function(e){let t=this;Pi(t),e.geometryType="polyline",t.index++;let n=ud(e.geometryType,t.index);e.name=n,e.attr.clampToGround=Cesium.defaultValue(e.attr.clampToGround,!1);let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);return j=XE(e,t.viewer,o),t.gemotryList.set(r,[j]),wi=!1,r};ve.prototype.drawArrowLineByAttr=function(e){let t=this;Pi(t),e.geometryType="polyline",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowLine_single"),j=XE(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=w0e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),wi=!1,r};ve.prototype.drawArrowTriangleByAttr=function(e){let t=this;Pi(t),e.geometryType="polyline",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),j=XE(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=x0e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),wi=!1,r};ve.prototype.drawArrowCurveByAttr=function(e){let t=this;Pi(t),e.geometryType="polyline",t.index++;let n=ud(e.geometryType,t.index);e.name=n;let r=Cesium.defaultValue(e.id,Cesium.createGuid());e.id=r;let o=So(e);e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),e.lineStyle="curve",j=XE(e,t.viewer,o),t.gemotryList.set(r,[j]);let a=T0e(e,this.viewer,o);return a.length==1?t.gemotryList.get(e.id).push(a[0]):(t.gemotryList.get(e.id).push(a[0]),t.gemotryList.get(e.id).push(a[1])),wi=!1,r};ve.prototype.drawArrowCurveTriangleByAttr=function(e){let t=this;Pi(t),t.index++,e.name=`\u5355\u66F2\u7EBF\u7BAD\u5934\u7EBF${t.index}`,e.id=Cesium.defaultValue(e.id,Cesium.createGuid()),e.geometryType="polyline",e.triangleType=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),e.lineStyle="curve";let n=So(e);j=XE(e,t.viewer,n),t.gemotryList.set(e.id,[j]);let r=A0e(e,t.viewer,n);return r.length==1?t.gemotryList.get(e.id).push(r[0]):(t.gemotryList.get(e.id).push(r[0]),t.gemotryList.get(e.id).push(r[1])),wi=!1,e.id};ve.prototype.setPolylineFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.material=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline!=null?n.gemotryList.get(e)[1].polyline.material=t:n.gemotryList.get(e)[1].polygon.material=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline!=null?(n.gemotryList.get(e)[1].polyline.material=t,n.gemotryList.get(e)[2].polyline.material=t):(n.gemotryList.get(e)[1].polygon.material=t,n.gemotryList.get(e)[2].polygon.material=t))))};ve.prototype.getPolylineFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.material};ve.prototype.setPolylinePositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height},positions:t,geometryType:"polyline"},a=So(o),s=r.nodelist.length,u=a.length,l=s-u;l>=0&&(r.nodelist.length=r.nodelist.length-l);for(let f=0;f<a.length;f++)r.nodelist[f]=a[f];r.entityChange.nodelistChange=!0;let c=sy(r.nodelist);r.anhor=c;for(let f=0;f<a.length;f++){let h=Jt(a[f],o.attr.height);r.nodelist[f]=h,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?(n.gemotryList.get(e)[1].nodelist[f]=h,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0):n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].nodelist[f]=h,n.gemotryList.get(e)[1].entityChange.nodelistChange=!0,n.gemotryList.get(e)[2].nodelist[f]=h,n.gemotryList.get(e)[2].entityChange.nodelistChange=!0)),n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f].position=h)}}};ve.prototype.getPolylinePositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return this.gemotryList.get(e)[0].nodelist};ve.prototype.setPolylineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.width=t,n.gemotryList.get(e)[0].triangleType!=null&&n.gemotryList.get(e)[1].polyline!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.width=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.width=t,n.gemotryList.get(e)[2].polyline.width=t)))};ve.prototype.getPolylineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.width};ve.prototype.getPolylineAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return{attr:{width:t.gemotryList.get(e)[0].attr.width,height:t.gemotryList.get(e)[0].attr.height,clampToGround:t.gemotryList.get(e)[0].attr.clampToGround},material:t.gemotryList.get(e)[0].polyline.material,positions:t.gemotryList.get(e)[0].nodelist,anhor:t.gemotryList.get(e)[0].anhor,id:e}};ve.prototype.setPolylineAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(n.gemotryList.get(e)[0].polyline.width=Cesium.defaultValue(t.attr.width,n.gemotryList.get(e)[0].attr.width),n.gemotryList.get(e)[0].attr.height=Cesium.defaultValue(t.attr.height,n.gemotryList.get(e)[0].attr.height),n.gemotryList.get(e)[0].nodelist=Cesium.defaultValue(t.positions,n.gemotryList.get(e)[0].nodelist),n.gemotryList.get(e)[0].polyline.material=Cesium.defaultValue(t.material,n.gemotryList.get(e)[0].polyline.material),n.gemotryList.get(e)[0].polyline.clampToGround=Cesium.defaultValue(t.attr.clampToGround,n.gemotryList.get(e)[0].polyline.clampToGround))};ve.prototype.setPolylineClampToGround=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(clampToGround=Cesium.defaultValue(clampToGround,!1),n.gemotryList.get(e)[0].polyline.ClampToGround=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.ClampToGround=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.ClampToGround=t,n.gemotryList.get(e)[2].polyline.ClampToGround=t)))};ve.prototype.drawPointByAttr=function(e){let t=this;Pi(t),e.geometryType="point",t.index++;let n=ud(e.geometryType,t.index);e.name=n,e.id=Cesium.defaultValue(e.id,Cesium.createGuid());let r=e.id,o=So(e);return j=_0e(e,t.viewer,[o]),t.gemotryList.set(r,[j]),wi=!1,r};ve.prototype.setPointColor=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="point"&&(t==null&&(t=Cesium.Color.WHITE),n.gemotryList.get(e)[0].attr.color=t,n.gemotryList.get(e)[0].point.color=t)};ve.prototype.getPointColor=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return t.gemotryList.get(e)[0].point.color};ve.prototype.setPointPixelSize=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="point"&&(t==null&&(t=10),n.gemotryList.get(e)[0].attr.pixelSize=t,n.gemotryList.get(e)[0].point.pixelSize=t)};ve.prototype.getPointPixelSize=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return t.gemotryList.get(e)[0].point.pixelSize};ve.prototype.setPointPositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="point"){let r=n.gemotryList.get(e)[0];t=Jt(t,r.attr.height);let o=[t];r.nodelist[0]=o[0],r.entityChange.nodelistChange=!0,r.anhor=o[0];for(let a=0;a<o.length;a++){let s=Jt(o[a],r.attr.height);r.nodelist[a]=s,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[a].position=s)}}};ve.prototype.getPointPositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="point")return this.gemotryList.get(e)[0].nodelist};ve.prototype.setPointAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");{let r=Cesium.defaultValue(t.attr.pixelSize,n.getPointPixelSize(e));n.setPointPixelSize(e,r);let o=Cesium.defaultValue(t.attr.color,n.getPointColor(e));n.setPointColor(e,o);let a=Cesium.defaultValue(t.anhor,n.getPointPositions(e));n.setPointPositions(e,a)}};ve.prototype.getPointAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");return{id:e,name:geometryList[0].name,attr:{pixelSize:t.getPointPixelSize(e),color:t.getPointColor(e),height:t.gemotryList.get(e)[0].attr.height},anhor:t.getPointPositions(e)}};ve.prototype.setMultipleArrowLineFillMaterial=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.material=t)};ve.prototype.getMultipleArrowLineFillMaterial=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return t.gemotryList.get(e)[0].polyline.material};ve.prototype.setMultipleArrowLinePositions=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0]!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"){let r=n.gemotryList.get(e)[0],o={attr:{height:r.attr.height,width:r.attr.width,clampToGround:r.attr.clampToGround},positions:t,geometryType:"multipleArrowLine"},a=So(o),s=r.nodelist.length,u=a.length,l=s-u;l>=0&&(r.nodelist.length=r.nodelist.length-l);for(let f=0;f<a.length;f++)r.nodelist[f]=a[f];r.entityChange.nodelistChange=!0;let c=sy(r.nodelist);r.anhor=c;for(let f=0;f<a.length;f++){let h=Jt(a[f],o.attr.height);r.nodelist[f]=h,n.billboardCollection._billboards[0]!=null&&n.billboardCollection._billboards[0].id.split("_")[n.billboardCollection._billboards[0].id.split("_").length-1]==e&&(n.billboardCollection._billboards[f].position=h)}}};ve.prototype.getMultipleArrowLinePositions=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return this.gemotryList.get(e)[0].nodelist};ve.prototype.setMultipleArrowLineWidth=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="multipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.width=t,n.gemotryList.get(e)[0].attr.width=t)};ve.prototype.getMultipleArrowLineWidth=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="polyline")return t.gemotryList.get(e)[0].polyline.width};ve.prototype.getMultipleArrowLineAttr=function(e){let t=this;if(t.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");if(t.gemotryList.get(e)!=null&&t.gemotryList.get(e)[0].geometryType=="multipleArrowLine")return{attr:{width:t.gemotryList.get(e)[0].attr.width,height:t.gemotryList.get(e)[0].attr.height,clampToGround:t.gemotryList.get(e)[0].attr.clampToGround},material:t.gemotryList.get(e)[0].polyline.material,positions:t.gemotryList.get(e)[0].nodelist,anhor:t.gemotryList.get(e)[0].anhor,id:e}};ve.prototype.setMultipleArrowLineAttr=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="MultipleArrowLine"&&(n.gemotryList.get(e)[0].polyline.width=Cesium.defaultValue(t.attr.width,n.gemotryList.get(e)[0].attr.width),n.gemotryList.get(e)[0].attr.width=n.gemotryList.get(e)[0].polyline.width,n.gemotryList.get(e)[0].attr.height=Cesium.defaultValue(t.attr.height,n.gemotryList.get(e)[0].attr.height),n.gemotryList.get(e)[0].nodelist=Cesium.defaultValue(t.positions,n.gemotryList.get(e)[0].nodelist),n.gemotryList.get(e)[0].polyline.material=Cesium.defaultValue(t.material,n.gemotryList.get(e)[0].polyline.material),n.gemotryList.get(e)[0].polyline.clampToGround=Cesium.defaultValue(t.attr.clampToGround,n.gemotryList.get(e)[0].polyline.clampToGround))};ve.prototype.setPolylineClampToGround=function(e,t){let n=this;if(n.gemotryList.get(e)==null)throw new Error("\u5F53\u524DId\u6CA1\u6709\u5BF9\u5E94\u7684\u56FE\u5143");n.gemotryList.get(e)!=null&&n.gemotryList.get(e)[0].geometryType=="polyline"&&(clampToGround=Cesium.defaultValue(clampToGround,!1),n.gemotryList.get(e)[0].polyline.ClampToGround=t,n.gemotryList.get(e)[0].triangleType!=null&&(n.gemotryList.get(e)[0].triangleType.split("_")[1]=="single"?n.gemotryList.get(e)[1].polyline.ClampToGround=t:n.gemotryList.get(e)[0].triangleType.split("_")[1]=="double"&&(n.gemotryList.get(e)[1].polyline.ClampToGround=t,n.gemotryList.get(e)[2].polyline.ClampToGround=t)))};function HE(e,t){let n=[],r=[],o=e.id,a={nodelistChange:!1},s=Cesium.defaultValue(e.geometryType,"polygon"),u=Cesium.defaultValue(e.material,new Cesium.Color(1,1,1,1)),l=1e3;e.attr!=null&&e.attr.height!=null&&(l=e.attr.height);let c={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(c.value=e.attr.Interval_degrees);let f;(e.geometryType=="circle"||e.geometryType=="ellipse")&&(f=e.geometryType);let h=t.entities.add({id:o,polygon:{arcType:Cesium.ArcType.RHUMB,material:u,hierarchy:new Cesium.CallbackProperty(function(){let d=[];return a.nodelistChange?(d=Ei(n,s,e.attr.height,f,c),r=d,a.nodelistChange=!1):d=r,{positions:d}},!1),extrudedHeight:e.extrudedHeight},name:e.name,geometryType:s,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:l},outline:e.outline,entityChange:a,Interval_degrees:c});return e.attr.clampToGround||(h.polygon.height=e.attr.height,h.polygon.perPositionHeight=Cesium.defaultValue(e.attr.clampToGround,!1)),h}function qE(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(e.geometryType,"polygon"),s=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),u=1e3;e.attr!=null&&e.attr.height!=null&&(u=e.attr.height);let l={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(l.value=e.attr.Interval_degrees);let c;(e.geometryType=="circle"||e.geometryType=="ellipse")&&(c=e.geometryType);let f=t.entities.add({id:e.id,polygon:{arcType:Cesium.ArcType.RHUMB,material:s,hierarchy:new Cesium.CallbackProperty(function(){let h=[];return o.nodelistChange?(h=Ei(n,a,u,c,l),r=h,o.nodelistChange=!1):h=r,{positions:h}},!1),extrudedHeight:e.extrudedHeight},geometryType:a,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:Cesium.defaultValue(e.attr,{height:Cesium.defaultValue(e.height,1e3)}),name:e.name,outline:e.outline,entityChange:o,Interval_degrees:l});return e.attr.clampToGround==null&&!e.attr.clampToGround&&(f.polygon.height=e.attr.height,f.polygon.perPositionHeight=Cesium.defaultValue(e.attr.clampToGround,!1)),f}function g0e(e,t){let n=[],r={nodelistChange:!0},o=Cesium.defaultValue(e.attr,{height:1e3,pixelSize:3,color:new Cesium.Color(1,1,1,1)}),a=Cesium.defaultValue(e.attr.color,new Cesium.Color(1,1,1,1)),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.attr.pixelSize,10);o.height=s,o.pixelSize=u;let l=t.entities.add({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),nodelist:n,point:{pixelSize:o.pixelSize,color:a,disableDepthTestDistance:Number.POSITIVE_INFINITY},name:e.name,attr:o,geometryType:"point",entityChange:r});return p0=!0,Ha=!0,l}function _0e(e,t,n){let r={nodelistChange:!0},o=Cesium.defaultValue(e.attr.color,new Cesium.Color(1,1,1,1)),a=Cesium.defaultValue(e.attr,{height:1e3,pixelSize:10,color:o}),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.attr.pixelSize,10);a.height=s,a.pixelSize=u;let l=t.entities.add({id:e.id,position:new Cesium.CallbackProperty(function(){return n[0]},!1),nodelist:n,point:{pixelSize:a.pixelSize,color:o,disableDepthTestDistance:Number.POSITIVE_INFINITY},name:e.name,attr:a,geometryType:"point",entityChange:r});return p0=!0,Ha=!0,l}function WE(e,t){let n=[],r={nodelistChange:!1},o=[],a=`${e.id}_outline`,s=Cesium.defaultValue(`${e.geometryType}_outline`,"polygon_outline"),u=1e3;e.attr!=null&&e.attr.height!=null&&(u=e.attr.height);let l=Cesium.defaultValue(e.outline.width,10),c=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,0,0,1)),f={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(f.value=e.attr.Interval_degrees);let h;return(e.geometryType=="circle"||e.geometryType=="ellipse")&&(h=e.geometryType),t.entities.add({id:a,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return r.nodelistChange?(p=Ei(o,s,u,h,f),n=p,r.nodelistChange=!1):p=n,p},!1),arcType:Cesium.ArcType.RHUMB,clampToGround:Cesium.defaultValue(e.attr.clampToGround,!1),width:l,material:c},geometryType:s,height:u,nodelist:o,entityChange:r,Interval_degrees:f})}function dp(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(`${e.geometryType}_outline`,"polygon_outline"),s=Cesium.defaultValue(e.attr.height,1e3),u=Cesium.defaultValue(e.outline.width,10),l=Cesium.defaultValue(e.outline.material,new Cesium.Color(1,0,0,1)),c=[];for(let p=0;p<n.length;p++){let g=Jt(n[p],s);c.push(g)}e.geometryType=="polygon"&&c.push(c[0]);let f={value:void 0};e.attr!=null&&e.attr.Interval_degrees!=null&&(f.value=e.attr.Interval_degrees);let h;return(e.geometryType=="circle"||e.geometryType=="ellipse")&&(h=e.geometryType),t.entities.add({id:`${e.id}_outline`,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return o.nodelistChange?(p=Ei(c,a,s,h,f),r=p,o.nodelistChange=!1):p=r,p},!1),arcType:Cesium.ArcType.RHUMB,width:u,material:l},name:e.name,nodelist:c,geometryType:a,height:s,entityChange:o,Interval_degrees:f})}function YE(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s,u=Cesium.defaultValue(e.geometryType,"polyline"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1);e.lineStyle=="curve"&&(s="curve");let d={width:c,height:f,clampToGround:h},p=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let g=[];return a.nodelistChange?(g=Ei(n,u,d.height,s),o=g,a.nodelistChange=!1):g=o,g},!1),material:l,width:d.width,clampToGround:h},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:d,midNodeList:r,entityChange:a});return e.triangleType!=null&&(p.triangleType=e.triangleType),p}function XE(e,t,n){let r=[],o=[],a=Cesium.defaultValue(e.geometryType,"polyline"),s={nodelistChange:!0},u=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let l=Cesium.defaultValue(e.attr.width,5),c=Cesium.defaultValue(e.attr.height,1e3),f=Cesium.defaultValue(e.attr.clampToGround,!1),h={height:c,width:l,clampToGround:f},d;e.lineStyle=="curve"&&(d="curve");let p=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let g=[];return s.nodelistChange?(g=Ei(n,a,h.height,d),o=g,s.nodelistChange=!1):g=o,g},!1),material:u,width:h.width,clampToGround:f},name:e.name,geometryType:a,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:h,midNodeList:r,entityChange:s});return e.triangleType!=null&&(p.triangleType=e.triangleType),p}function y0e(e,t,n){let r=[],o=Cesium.defaultValue(e.geometryType,"curve"),a={nodelistChange:!0},s=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let u=Cesium.defaultValue(e.attr.width,5),l=Cesium.defaultValue(e.attr.height,1e3),c=Cesium.defaultValue(e.attr.clampToGround,!1),f=Cesium.defaultValue(e.attr.radius,5e3),h={height:l,width:u,clampToGround:c,radius:f};return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let p=[];return a.nodelistChange?(p=I2(n,h.height,f),r=p,a.nodelistChange=!1):p=r,p},!1),material:s,width:h.width,clampToGround:c},name:e.name,geometryType:o,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:h,entityChange:a})}function v0e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowLine_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowLine_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y)}return g}function C0e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowTriangle_single"){let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y),y=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,e.attr.height),a=v,u.nodelistChange=!1):v=a,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:u}),e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y)}return g}function x0e(e,t,n){let r=[],o=[],a={nodelistChange:!0},s={nodelistChange:!0},u=Cesium.defaultValue(e.triangleType,"arrowTriangle_single"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1),d={width:c,height:f,clampToGround:h},p=[];if(e.triangleType!="arrowTriangle_single"){let g=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ei(n,"arrowTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g),g=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return s.nodelistChange?(y=Ei(n,u,e.attr.height),o=y,s.nodelistChange=!1):y=o,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:s}),e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g)}else{let g=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ei(n,"arrowTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g)}return p}function w0e(e,t,n){let r=[],o=[],a=[],s={nodelistChange:!0},u={nodelistChange:!0},l=Cesium.defaultValue(e.triangleType,"arrowLine_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowLine_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowLine_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y)}return g}function E0e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowCurve_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y)}return g}function T0e(e,t,n){let r=[],o=[],a=[],s={nodelistChange:!0},u={nodelistChange:!0},l=Cesium.defaultValue(e.triangleType,"arrowCurve_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowCurve_single"){let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y),y=t.entities.add({id:`${e.id}_foot`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,p.height),a=v,u.nodelistChange=!1):v=a,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:u}),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polyline:{positions:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurve_single",p.height),o=v,s.nodelistChange=!1):v=o,v},!1),material:c,width:p.width,clampToGround:d},name:e.name,show:!0,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:p,midNodeList:r,entityChange:s});g.push(y)}return g}function S0e(e,t){let n=[],r=[],o=[],a=[],s={nodelistChange:!1},u={nodelistChange:!1},l=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let f=Cesium.defaultValue(e.attr.width,5),h=Cesium.defaultValue(e.attr.height,1e3),d=Cesium.defaultValue(e.attr.clampToGround,!1),p={width:f,height:h,clampToGround:d},g=[];if(e.triangleType!="arrowCurveTriangle_single"){let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurveTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y),y=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return u.nodelistChange?(v=Ei(n,l,e.attr.height),a=v,u.nodelistChange=!1):v=a,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:u}),e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y)}else{let y=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:c,hierarchy:new Cesium.CallbackProperty(function(){let v=[];return s.nodelistChange?(v=Ei(n,"arrowCurveTriangle_single",e.attr.height),o=v,s.nodelistChange=!1):v=o,{positions:v}},!1)},name:e.name,triangleType:l,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:o,attr:{height:h},outline:e.outline,entityChange:s});e.attr.height!=null&&(y.polygon.height=e.attr.height),g.push(y)}return g}function A0e(e,t,n){let r=[],o=[],a={nodelistChange:!0},s={nodelistChange:!0},u=Cesium.defaultValue(e.triangleType,"arrowCurveTriangle_single"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));e.attr=Cesium.defaultValue(e.attr,{});let c=Cesium.defaultValue(e.attr.width,5),f=Cesium.defaultValue(e.attr.height,1e3),h=Cesium.defaultValue(e.attr.clampToGround,!1),d={width:c,height:f,clampToGround:h},p=[];if(e.triangleType!="arrowCurveTriangle_single"){let g=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ei(n,"arrowCurveTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g),g=t.entities.add({id:`${e.id}_foot`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return s.nodelistChange?(y=Ei(n,u,e.attr.height),o=y,s.nodelistChange=!1):y=o,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:s}),e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g)}else{let g=t.entities.add({id:`${e.id}_top`,polygon:{arcType:Cesium.ArcType.RHUMB,material:l,hierarchy:new Cesium.CallbackProperty(function(){let y=[];return a.nodelistChange?(y=Ei(n,"arrowCurveTriangle_single",e.attr.height),r=y,a.nodelistChange=!1):y=r,{positions:y}},!1)},name:e.name,triangleType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,positionsPre:r,attr:{height:f},outline:e.outline,entityChange:a});e.attr.height!=null&&(g.polygon.height=e.attr.height),p.push(g)}return p}function b0e(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s=Cesium.defaultValue(e.attr,{});s.height=Cesium.defaultValue(s.height,1e3),s.radius=Cesium.defaultValue(s.radius,1e3),s.clampToGround=Cesium.defaultValue(s.clampToGround,!1),s.width=Cesium.defaultValue(s.width,5);let u=Cesium.defaultValue(e.geometryType,"curve"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),c=t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let f=[];return a.nodelistChange?(f=I2(n,s.height,s.radius),o=f,a.nodelistChange=!1):f=o,f},!1),material:l,width:s.width,clampToGround:s.clampToGround},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:s,midNodeList:r,entityChange:a});return e.triangleType!=null&&(c.triangleType=e.triangleType),c}function xD(e,t,n){let r=Cesium.defaultValue(n,[]),o=[],a=Cesium.defaultValue(e.byAttr,!1),s=[],u={nodelistChange:!1},l=Cesium.defaultValue(e.attr,{});l.height=Cesium.defaultValue(l.height,1e3),l.radius=Cesium.defaultValue(l.radius,5e3);let c=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1)),f=Cesium.defaultValue(e.geometryType,"bezierWall");if(a&&(u.nodelistChange=!0,f=="bezierWall"))for(let d=0;d<r.length;d++){let p=Cesium.Cartographic.fromCartesian(r[d]);p.height+=l.height,r[d]=Cesium.Cartographic.toCartesian(p)}return t.entities.add({id:e.id,wall:{positions:new Cesium.CallbackProperty(function(){let d=[];return u.nodelistChange?(f=="bezierWall"?d=hp(r):d=I2(r,l.height,l.radius),s=d,u.nodelistChange=!1):d=s,d},!1),material:c},name:e.name,show:!0,geometryType:f,nodelist:r,attr:l,midNodeList:o,entityChange:u})}function I0e(e,t){let n=[],r=[],o=[],a={nodelistChange:!1},s=Cesium.defaultValue(e.attr,{});s.height=Cesium.defaultValue(s.height,1e3),s.clampToGround=Cesium.defaultValue(s.clampToGround,!1),s.width=Cesium.defaultValue(s.width,5);let u=Cesium.defaultValue(e.geometryType,"multipleArrowLine"),l=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let f=[];return a.nodelistChange?(f=lW(n,s.height),o=f,a.nodelistChange=!1):f=o,f},!1),material:l,width:s.width,clampToGround:s.clampToGround},name:e.name,show:!0,geometryType:u,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:s,midNodeList:r,entityChange:a})}function D0e(e,t,n){let r=[],o={nodelistChange:!0},a=Cesium.defaultValue(e.attr,{});a.height=Cesium.defaultValue(a.height,1e3),a.clampToGround=Cesium.defaultValue(a.clampToGround,!1),a.width=Cesium.defaultValue(a.width,5);let s=Cesium.defaultValue(e.geometryType,"multipleArrowLine"),u=Cesium.defaultValue(e.material,new Cesium.Color(1,0,0,1));return t.entities.add({id:e.id,polyline:{positions:new Cesium.CallbackProperty(function(){let c=[];return o.nodelistChange?(c=lW(n,a.height),r=c,o.nodelistChange=!1):c=r,c},!1),material:u,width:a.width,clampToGround:a.clampToGround},name:e.name,show:!0,geometryType:s,anhor:new Cesium.Cartesian3(0,0,0),nodelist:n,attr:a,entityChange:o})}function uW(e,t,n){let r=n;e.setInputAction(function(o){let a=t.camera.pickEllipsoid(o.position,t.scene.globe.ellipsoid);if(a!=null&&wi&&!vD){switch(a=Jt(a,j.attr.height),j.geometryType){case"polygon":j.nodelist.push(a),j.outline.show&&Nt.nodelist.push(a),on>=1&&(Ha=!0),on++;break;case"circle":!Ha&&on<1&&(j.nodelist.push(a),j.anhor=a,j.outline.show&&Nt.nodelist.push(a),Ha=!0,on++);break;case"ellipse":!Ha&&on<2&&(on==0?(j.nodelist.push(a),j.anhor=a,j.outline.show&&Nt.nodelist.push(a)):(j.nodelist.push(a),j.outline.show&&Nt.nodelist.push(a),Ha=!0),on++);break;case"rectangle":!Ha&&on<1&&(j.nodelist.push(a),j.outline.show&&Nt.nodelist.push(a),Ha=!0,on++);break;case"polyline":j.nodelist.push(a),Ha=!0,on++;break;case"sector":if(!Ha&&on<2){if(on==0)j.nodelist.push(a),j.anhor=a,j.outline.show&&Nt.nodelist.push(a);else{let s=t.entities.getById("\u6247\u5F62_temp01");t.entities.remove(s),j.nodelist.push(a),Ha=!0}on++}break;case"curve":!Ha&&on<1&&(j.nodelist.push(a),j.anhor=a,Ha=!0,on++);break;case"multipleArrowLine":j.nodelist.push(a),Ha=!0,on++;break;case"bezierWall":j.nodelist.push(a),Ha=!0,on++;break;case"curveWall":!Ha&&on<1&&(j.nodelist.push(a),j.anhor=a,Ha=!0,on++);break;default:break}j.entityChange.nodelistChange=!0,j.outline!=null&&j.outline.show&&(Nt.entityChange.nodelistChange=!0),p0=!0}else if(!wi&&!oy){let s=t.scene.pick(o.position);s==null?(r.billboardCollection!=null&&r.billboardCollection.removeAll(),d0=!1,iy=!1,$!=null&&$.geometryType=="point"&&($.show=!0),$=void 0):s.id instanceof Cesium.Entity&&s.id.id.split("_")[1]!="outline"&&(d0=!0,r.billboardCollection!=null&&r.billboardCollection.removeAll(),r.billboardCollection=L0e(s.id,r.billboardCollection),$=s.id,r.gemotryList.get(s.id.id)[1]!=null&&(ai=r.gemotryList.get(s.id.id)[1],$.outline.show=r.gemotryList.get(s.id.id)[1].show),r.leftClickStartEdit&&r.leftClickStartEdit.raiseEvent({id:$.id,type:$.geometryType}))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.setInputAction(function(o){if(!oy&&d0){let a=t.scene.pick(o.position);if(a!=null&&!(a.id instanceof Cesium.Entity)){let s=a.id.split("_");In.index=parseInt(s[0]),In.type=s[1],In.entityid=s[2],In.id=a.id,iy=!0,t.scene.screenSpaceCameraController.enableTranslate=!1,t.scene.screenSpaceCameraController.enableRotate=!1}}},Cesium.ScreenSpaceEventType.LEFT_DOWN),e.setInputAction(function(o){let a=t.camera.pickEllipsoid(o.endPosition,t.scene.globe.ellipsoid);if(!vD&&p0&&a!=null&&wi){a=Jt(a,j.attr.height);let s;switch(j.geometryType){case"polygon":j.nodelist[on]=a,j.outline.show&&(Nt.nodelist[on]=a);break;case"circle":if(on==1){j.nodelist[on]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]);s=Cesium.Cartographic.fromCartesian(j.nodelist[1]);let c=u.project(l),f=u.project(s),h=Cesium.Cartesian3.distance(f,c);j.attr.radius=h,j.outline.show&&(Nt.nodelist[on]=a)}break;case"ellipse":if(j.nodelist[on]=a,on==1){j.attr.minoraxis=Cesium.Cartesian3.distance(j.nodelist[0],j.nodelist[1]),a=gD(j.nodelist[0],j.nodelist[1],"minoraxis"),j.nodelist[on]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]);s=Cesium.Cartographic.fromCartesian(j.nodelist[1]);let c=u.project(l),f=u.project(s),h=Cesium.Cartesian3.distance(f,c);j.attr.minoraxis=h,j.attr.majoraxis=h}else if(on==2){j.attr.majoraxis=Cesium.Cartesian3.distance(j.nodelist[0],j.nodelist[2]),a=gD(j.nodelist[0],j.nodelist[2],"majoraxis"),j.nodelist[on]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]),f=Cesium.Cartographic.fromCartesian(j.nodelist[2]),h=u.project(l),d=u.project(f),p=u.project(c),g=Cesium.Cartesian3.distance(d,h),y=Cesium.Cartesian3.distance(p,h);j.attr.minoraxis=y,j.attr.majoraxis=g}j.outline.show&&(Nt.nodelist[on]=a);break;case"rectangle":if(on==1){j.nodelist[on]=a;let u=Cesium.Cartesian3.midpoint(j.nodelist[0],j.nodelist[1],new Cesium.Cartesian3);j.anhor=u;let l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]);j.attr.startPoint=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,j.attr.height),j.attr.endPoint=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,j.attr.height),j.attr.height=j.attr.height,j.outline.show&&(Nt.nodelist[on]=a)}break;case"polyline":if(j.nodelist[on]=a,j.triangleType!=null){if(j.triangleType=="arrowLine_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowLine_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowTriangle_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowTriangle_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurve_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurve_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurveTriangle_single"){let u=r.gemotryList.get(j.id)[1];for(let l=0;l<j.nodelist.length;l++)u.nodelist[l]=j.nodelist[l];u.entityChange.nodelistChange=!0}else if(j.triangleType=="arrowCurveTriangle_double"){let u=r.gemotryList.get(j.id)[1];for(let c=0;c<j.nodelist.length;c++)u.nodelist[c]=j.nodelist[c];u.entityChange.nodelistChange=!0;let l=r.gemotryList.get(j.id)[2];for(let c=0;c<j.nodelist.length;c++)l.nodelist[c]=j.nodelist[c];l.entityChange.nodelistChange=!0}}break;case"point":j.nodelist[0]=a;break;case"sector":if(on==1){j.nodelist[on]=a,j.outline.show&&(Nt.nodelist[on]=a);let u=t.entities.getById("\u6247\u5F62_temp01");u==null?t.entities.add({id:"\u6247\u5F62_temp01",position:a,point:{pixelSize:20,color:Cesium.Color.WHITE,disableDepthTestDistance:Number.POSITIVE_INFINITY}}):u.position=a}else if(on==2){j.nodelist[2]=a;let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(j.nodelist[0]),c=Cesium.Cartographic.fromCartesian(j.nodelist[1]);s=Cesium.Cartographic.fromCartesian(j.nodelist[2]);let f=u.project(l),h=u.project(c),d=u.project(s),p=Cesium.Cartesian3.distance(h,f),g=m0(h,f),y=m0(d,f);y<0&&(y+=360),g<0&&(g+=360),y<g&&(y+=360);let v=new Cesium.Cartesian3(p*Math.cos(Cesium.Math.toRadians(Math.trunc(y)))+f.x,p*Math.sin(Cesium.Math.toRadians(Math.trunc(y)))+f.y,j.attr.height);s=u.unproject(v),a=Cesium.Cartesian3.fromRadians(s.longitude,s.latitude,s.height),j.nodelist[2]=a,j.outline.show&&(Nt.nodelist[on]=a)}break;case"curve":on==1&&(j.nodelist[on]=a);break;case"multipleArrowLine":j.nodelist[on]=a;break;case"bezierWall":j.nodelist[on]=a;break;case"curveWall":on==1&&(j.nodelist[on]=a);break;default:break}j.entityChange.nodelistChange=!0,j.outline!=null&&j.outline.show&&(Nt.entityChange.nodelistChange=!0)}else if(!oy&&!wi&&iy&&a!=null&&!isNaN(a.x)&&d0&&In.id!=null){if(a=Jt(a,$.attr.height),$.geometryType!="point")if(In.type!="anhor"){if($.geometryType=="polygon"||$.geometryType=="polyline"||$.geometryType=="rectangle"){In.index==1?($.nodelist[0]=a,$.triangleType=="arrowLine_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_single"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_single"||$.triangleType=="arrowCurve_single"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowCurve_double"||$.triangleType=="arrowCurveTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[0]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowCurveTriangle_single"&&(r.gemotryList.get($.id)[1].nodelist[0]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0)):($.nodelist[In.index-1]=a,$.triangleType=="arrowTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[In.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowTriangle_single"?(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_double"?(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[In.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowLine_single"||$.triangleType=="arrowCurve_single"?(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0):$.triangleType=="arrowCurve_double"||$.triangleType=="arrowCurveTriangle_double"?(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].nodelist[In.index-1]=a,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0):$.triangleType=="arrowCurveTriangle_single"&&(r.gemotryList.get($.id)[1].nodelist[In.index-1]=a,r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0));let s=Ei($.nodelist,$.geometryType),u=Cesium.BoundingSphere.fromPoints(s);r.gemotryList.get(In.entityid)[0].anhor=u.center,r.billboardCollection.get(In.index).position=a,S2(r.billboardCollection._billboards,$.geometryType,u.center)}else{if($.nodelist[In.index-1]=a,r.billboardCollection.get(In.index-1).position=a,$.geometryType=="sector"){let s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian($.nodelist[0]),l=s.project(u),c=Cesium.Cartographic.fromCartesian(a),f=s.project(c),h=Cesium.Cartesian3.distance(l,f);if(In.index-1==2){let d=Cesium.Cartographic.fromCartesian($.nodelist[1]),p=s.project(d),g=_D(p,l,h,$.attr.height),y=s.unproject(g);$.nodelist[1]=Cesium.Cartographic.toCartesian(y),r.billboardCollection.get(1).position=$.nodelist[1]}else if(In.index-1==1){let d=Cesium.Cartographic.fromCartesian($.nodelist[2]),p=s.project(d),g=_D(p,l,h,$.attr.height),y=s.unproject(g);$.nodelist[2]=Cesium.Cartographic.toCartesian(y),r.billboardCollection.get(2).position=$.nodelist[2]}}$.attr=sW($.nodelist,$.geometryType,$.attr),$.anhor=$.nodelist[0]}if($.outline!=null&&$.outline.show!=null&&$.outline.show){let s=Jt(a,ai.height);if($.geometryType=="sector")if(Cesium.Cartesian3.equals($.anhor,$.nodelist[0])){let u=new Cesium.WebMercatorProjection,l=Cesium.Cartographic.fromCartesian(ai.nodelist[0]),c=u.project(l),f=Cesium.Cartographic.fromCartesian(a),h=u.project(f),d=Cesium.Cartesian3.distance(c,h);if(In.index-1==2){let p=Cesium.Cartographic.fromCartesian(ai.nodelist[1]),g=u.project(p),y=_D(g,c,d,ai.height),v=u.unproject(y);ai.nodelist[1]=Cesium.Cartographic.toCartesian(v),ai.nodelist[2]=$.nodelist[2]}else if(In.index-1==1){let p=Cesium.Cartographic.fromCartesian(ai.nodelist[2]),g=u.project(p),y=_D(g,c,d,ai.height),v=u.unproject(y);ai.nodelist[2]=Cesium.Cartographic.toCartesian(v),ai.nodelist[1]=$.nodelist[1]}}else In.index=="0"&&(ai.nodelist[ai.nodelist.length-1]=s),ai.nodelist[In.index]=s;else Cesium.Cartesian3.equals($.anhor,$.nodelist[0])?ai.nodelist[In.index-1]=s:In.index=="1"&&ai.nodelist.length>2?$.geometryType=="polygon"?ai.nodelist[In.index-1]=s:ai.nodelist[ai.nodelist.length-1]=s:ai.nodelist[In.index-1]=s}}else{if(S2(r.billboardCollection._billboards,$.geometryType,a),$.outline!=null&&$.outline.show?A2($.nodelist,$.anhor,a,r.billboardCollection._billboards,ai.nodelist,ai.height):A2($.nodelist,$.anhor,a,r.billboardCollection._billboards,"",$.attr.height),$.geometryType=="rectangle")$.attr.startPoint=Jt($.nodelist[0],$.attr.height),$.attr.endPoint=Jt($.nodelist[1],$.attr.height);else if($.geometryType=="polyline"){if($.triangleType=="arrowLine_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowLine_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowTriangle_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowTriangle_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurve_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurve_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurveTriangle_single"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0}else if($.triangleType=="arrowCurveTriangle_double"){for(let s=0;s<$.nodelist.length;s++)r.gemotryList.get($.id)[1].nodelist[s]=$.nodelist[s],r.gemotryList.get($.id)[2].nodelist[s]=$.nodelist[s];r.gemotryList.get($.id)[1].entityChange.nodelistChange=!0,r.gemotryList.get($.id)[2].entityChange.nodelistChange=!0}}$.anhor=a}else a=Jt(a,$.attr.height),S2(r.billboardCollection._billboards,$.geometryType,a),$.nodelist[0]=a,$.anhor=a;$.entityChange.nodelistChange=!0,$.outline!=null&&$.outline.show&&(ai.entityChange.nodelistChange=!0)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(function(o){if(!oy&&d0&&$!=null&&In.id!=null){if($.geometryType=="ellipse"){let a=parseInt(In.id.split("_")[0])-1;$.nodelist[1]=gD($.nodelist[0],$.nodelist[1],"minoraxis"),$.nodelist[2]=gD($.nodelist[0],$.nodelist[2],"majoraxis"),r.billboardCollection.get(a).position=$.nodelist[a]}else if($.geometryType=="point")$.show=!0,r.billboardCollection.get(0).show=!1;else if($.geometryType=="rectangle"){let a=Cesium.Cartographic.fromCartesian($.nodelist[0]),s=Cesium.Cartographic.fromCartesian($.nodelist[1]),u=Cesium.Cartesian3.fromRadians(s.longitude,a.latitude,$.height);$.attr.width=Cesium.Cartesian3.distance($.nodelist[0],u),$.attr.length=Cesium.Cartesian3.distance($.nodelist[1],u)}else $.geometryType=="circle"&&($.attr.radius=M0e($.nodelist[0],$.nodelist[1]));iy=!1,t.scene.screenSpaceCameraController.enableTranslate=!0,t.scene.screenSpaceCameraController.enableRotate=!0,r.leftClickStartEdit&&r.leftClickStartEdit.raiseEvent({id:$.id,type:$.geometryType})}},Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction(function(o){if(!vD&&Ha&&p0){let a={},s,u;switch(j.geometryType){case"polygon":u=Ei(j.nodelist,j.geometryType),s=Cesium.BoundingSphere.fromPoints(u),j.anhor=s.center,a={id:j.id,attr:{height:j.attr.height},material:j.polygon.material,positions:u,anhor:j.anhor,outline:j.outline,name:j.name},j.outline.show&&Nt.nodelist.push(Nt.nodelist[0]);break;case"circle":a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"ellipse":a={id:j.id,attr:{height:j.attr.height,majoraxis:j.attr.majoraxis,minoraxis:j.attr.minoraxis},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"rectangle":a={id:j.id,attr:{height:j.attr.height,startPoint:j.attr.startPoint,endPoint:j.attr.endPoint},material:j.polygon.material,anhor:j.anhor,outline:j.outline,name:j.name};break;case"polyline":u=Ei(j.nodelist,j.geometryType),s=Cesium.BoundingSphere.fromPoints(u),j.anhor=s.center,a={id:j.id,attr:{height:j.attr.height,width:j.attr.width,clampToGround:j.attr.clampToGround},material:j.polyline.material,positions:u,anhor:j.anhor,name:j.name};break;case"point":j.anhor=j.nodelist[0],a={id:j.id,attr:{height:j.attr.height,pixelSize:j.attr.pixelSize,color:j.point.color},anhor:j.anhor,name:j.name};break;case"sector":j.attr=sW(j.nodelist,j.geometryType,j.attr),a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius,startAngle:j.attr.startAngle,endAngle:j.attr.endAngle},material:j.polygon.material,nodelist:j.nodelist,anhor:j.anhor,outline:j.outline,name:j.name};break;case"curve":a={id:j.id,attr:{height:j.attr.height,radius:j.attr.radius},material:j.polyline.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};break;case"multipleArrowLine":a={id:j.id,attr:{height:j.attr.height,width:j.attr.height},material:j.polyline.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};break;case"curveWall":a={id:j.id,attr:{radius:j.attr.radius},material:j.wall.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};case"bezierWall":a={id:j.id,material:j.wall.material,nodelist:j.nodelist,anhor:j.anhor,name:j.name};default:break}p0=!1,on=0,wi=!1,j.callbackFunc(a),j=void 0,Nt=void 0}},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}function Ei(e,t,n,r,o){let a=[],s=[],u=[];switch(t){case"polygon":a=e;break;case"polygon_outline":if(e.length!=0){for(let l=0;l<e.length;l++){let c=Cesium.Cartographic.fromCartesian(e[l]),f=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,n);a.push(f)}a.push(a[0])}break;case"circle":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,d);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}}break;case"circle_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}}break;case"ellipse":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%o!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=c.project(f),d=Cesium.Cartographic.fromCartesian(e[1]),p=c.project(d),g=Cesium.Cartographic.fromCartesian(e[2]),y=c.project(g),v=Cesium.Cartesian3.distance(p,h),w=Cesium.Cartesian3.distance(y,h),C=Cesium.defaultValue(o.value,12);for(let E=0;E<360;E=E+C){let S=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(E))+h.x,w*Math.sin(Cesium.Math.toRadians(E))+h.y,n),A=c.unproject(S);a.push(Cesium.Cartographic.toCartesian(A))}if(360%C!=0){let E=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(360))+h.x,w*Math.sin(Cesium.Math.toRadians(360))+h.y,n),S=c.unproject(E);a.push(Cesium.Cartographic.toCartesian(S))}}}break;case"ellipse_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let h=0;h<e.length;h++){let d=Cesium.Cartographic.fromCartesian(e[h]);s[h]=l.project(d,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]),f=Cesium.defaultValue(o.value,12);for(let h=0;h<360;h+=f){let d=new Cesium.Cartesian3;d.x=s[0].x+Math.cos(Cesium.Math.toRadians(h))*c,d.y=s[0].y+Math.sin(Cesium.Math.toRadians(h))*c,d.z=s[0].z;let p=l.unproject(d,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,s[0].z))}if(360%f!=0){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(360))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(360))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}else if(e.length==3){let c=Cesium.Cartographic.fromCartesian(e[0]),f=l.project(c),h=Cesium.Cartographic.fromCartesian(e[1]),d=l.project(h),p=Cesium.Cartographic.fromCartesian(e[2]),g=l.project(p),y=Cesium.Cartesian3.distance(d,f),v=Cesium.Cartesian3.distance(g,f),w=Cesium.defaultValue(o.value,12);for(let C=0;C<360;C=C+w){let E=new Cesium.Cartesian3(y*Math.cos(Cesium.Math.toRadians(C))+f.x,v*Math.sin(Cesium.Math.toRadians(C))+f.y,n),S=l.unproject(E);a.push(Cesium.Cartographic.toCartesian(S))}if(360%o!=0){let C=new Cesium.Cartesian3(y*Math.cos(Cesium.Math.toRadians(360))+f.x,v*Math.sin(Cesium.Math.toRadians(360))+f.y,n),E=l.unproject(C);a.push(Cesium.Cartographic.toCartesian(E))}a.push(a[0])}}break;case"rectangle":if(e.length==2){let l=Cesium.Cartographic.fromCartesian(e[0]),c=Cesium.Cartographic.fromCartesian(e[1]),f=Cesium.Cartesian3.fromRadians(c.longitude,l.latitude,n),h=Cesium.Cartesian3.fromRadians(l.longitude,c.latitude,n);a=[e[0],f,e[1],h]}break;case"rectangle_outline":{if(e.length==2){let l=Cesium.Cartographic.fromCartesian(e[0]),c=Cesium.Cartographic.fromCartesian(e[1]),f=Cesium.Cartesian3.fromRadians(c.longitude,l.latitude,n),h=Cesium.Cartesian3.fromRadians(l.longitude,c.latitude,n);l=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,n),c=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,n),a=[l,f,c,h]}a.push(a[0])}break;case"polyline":if(r!=null){for(let c=0;c<e.length;c++){let f=Jt(e[c],n);u.push(f)}let l=hp(u);for(let c=0;c<l.length;c++){let f=Jt(l[c],n);a.push(f)}}else for(let l=0;l<e.length;l++){let c=Jt(e[l],n);a.push(c)}break;case"sector":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let f=0;f<e.length;f++){let h=Cesium.Cartographic.fromCartesian(e[f]);s[f]=l.project(h,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]);for(let f=0;f<360;f+=12){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(f))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(f))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=Cesium.Cartographic.fromCartesian(e[1]),d=Cesium.Cartographic.fromCartesian(e[2]),p=c.project(f),g=c.project(h),y=c.project(d),v=Cesium.Cartesian3.distance(g,p),w=m0(g,p),C=m0(y,p);C<0&&(C+=360),w<0&&(w+=360),C<w&&(C+=360);for(let A=w;A<C;A=A+1){let D=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(A))+p.x,v*Math.sin(Cesium.Math.toRadians(A))+p.y,n),P=c.unproject(D);a.push(Cesium.Cartographic.toCartesian(P))}let E=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(C))+p.x,v*Math.sin(Cesium.Math.toRadians(C))+p.y,n),S=c.unproject(E);a.push(Cesium.Cartographic.toCartesian(S)),a.push(e[0])}}break;case"sector_outline":{let l=new Cesium.WebMercatorProjection;if(e.length==2){for(let f=0;f<e.length;f++){let h=Cesium.Cartographic.fromCartesian(e[f]);s[f]=l.project(h,new Cesium.Cartesian3)}let c=Cesium.Cartesian3.distance(s[0],s[1]);for(let f=0;f<360;f+=12){let h=new Cesium.Cartesian3;h.x=s[0].x+Math.cos(Cesium.Math.toRadians(f))*c,h.y=s[0].y+Math.sin(Cesium.Math.toRadians(f))*c,h.z=s[0].z;let d=l.unproject(h,new Cesium.Cartographic);a.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,s[0].z))}a.push(a[0])}else if(e.length==3){let c=new Cesium.WebMercatorProjection,f=Cesium.Cartographic.fromCartesian(e[0]),h=Cesium.Cartographic.fromCartesian(e[1]),d=Cesium.Cartographic.fromCartesian(e[2]),p=c.project(f),g=c.project(h),y=c.project(d),v=Cesium.Cartesian3.distance(g,p),w=m0(g,p),C=m0(y,p);C<0&&(C+=360),w<0&&(w+=360),C<w&&(C+=360);let E=Jt(e[0],n);a.push(E);for(let D=w;D<C;D=D+1){let P=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(D))+p.x,v*Math.sin(Cesium.Math.toRadians(D))+p.y,n),M=c.unproject(P);a.push(Cesium.Cartographic.toCartesian(M))}let S=new Cesium.Cartesian3(v*Math.cos(Cesium.Math.toRadians(C))+p.x,v*Math.sin(Cesium.Math.toRadians(C))+p.y,n),A=c.unproject(S);a.push(Cesium.Cartographic.toCartesian(A)),a.push(E)}}break;case"arrowLine_single":if(e.length>=2){for(let l=0;l<e.length;l++){let c=Jt(e[l],n);u.push(c)}a=yD(u[u.length-2],u[u.length-1])}break;case"arrowLine_double":if(e.length>=2){for(let l=0;l<e.length;l++){let c=Jt(e[l],n);u.push(c)}a=yD(u[1],u[0])}break;case"arrowTriangle_single":if(e.length>=2){for(let l=0;l<e.length;l++){let c=Jt(e[l],n);u.push(c)}a=yD(u[u.length-2],u[u.length-1],"triangle")}break;case"arrowTriangle_double":if(e.length>=2){for(let l=0;l<e.length;l++){let c=Jt(e[l],n);u.push(c)}a=yD(u[1],u[0],"triangle")}break;case"arrowCurve_single":if(e.length>2){for(let f=0;f<e.length;f++){let h=Jt(e[f],n);u.push(h)}let l=hp(u),c=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=OC(l[l.length-2],l[l.length-1],c)}break;case"arrowCurve_double":if(e.length>2){for(let f=0;f<e.length;f++){let h=Jt(e[f],n);u.push(h)}let l=hp(u),c=Cesium.Cartesian3.distance(u[1],u[0]);a=OC(l[1],l[0],c)}break;case"arrowCurveTriangle_single":if(e.length>2){for(let f=0;f<e.length;f++){let h=Jt(e[f],n);u.push(h)}let l=hp(u),c=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=OC(l[l.length-2],l[l.length-1],c,"triangle")}else{for(let c=0;c<e.length;c++){let f=Jt(e[c],n);u.push(f)}let l=Cesium.Cartesian3.distance(u[u.length-2],u[u.length-1]);a=OC(u[u.length-2],u[u.length-1],l,"triangle")}break;case"arrowCurveTriangle_double":if(e.length>2){for(let f=0;f<e.length;f++){let h=Jt(e[f],n);u.push(h)}let l=hp(u),c=Cesium.Cartesian3.distance(u[1],u[0]);a=OC(l[1],l[0],c,"triangle")}else{for(let c=0;c<e.length;c++){let f=Jt(e[c],n);u.push(f)}let l=Cesium.Cartesian3.distance(u[1],u[0]);a=OC(u[1],u[0],l,"triangle")}break;default:break}return a}function I2(e,t,n){let r=[];if(e.length==2){let o=new Cesium.WebMercatorProjection,a=Cesium.Cartographic.fromCartesian(e[0]),s=Cesium.Cartographic.fromCartesian(e[1]),u=o.project(a),l=o.project(s),c=new Cesium.Cartesian3(u.x+n,u.y,u.z),f=m0(u,c),h=m0(l,c);h<0&&(h+=360),h<f&&(h+=360);for(let d=f;d<h;d=d+1){let p=new Cesium.Cartesian3(n*Math.cos(Cesium.Math.toRadians(d))+c.x,n*Math.sin(Cesium.Math.toRadians(d))+c.y,t),g=o.unproject(p);r.push(Cesium.Cartographic.toCartesian(g))}}return r}function lW(e,t){let n=[];for(let r=0;r<e.length;r++)e[r]=Jt(e[r],t);if(e.length>2){let r=[];for(let o=0;o<e.length-2;o=o+2){let a=Cesium.Cartesian3.midpoint(e[o],e[o+2],new Cesium.Cartesian3);r=r.concat(P0e([e[o],e[o+1],e[o+2]],a))}(e.length-3)%2==1&&r.push(e[e.length-1]),n=r}else n=e;return n}function P0e(e,t){let n={headHeightFactor:.18,headWidthFactor:.3,neckHeightFactor:.85,neckWidthFactor:.15,tailWidthFactor:.1,headTailFactor:.8,swallowTailFactor:1},r=n.headHeightFactor,o=n.headTailFactor,a=n.headWidthFactor,s=n.neckWidthFactor,u=n.neckHeightFactor,l=Cesium.Cartesian3.distance(t,e[1]),c=l*r,f=e[1];l=Cesium.Cartesian3.distance(t,e[1]);let h=Cesium.Cartesian3.distance(e[0],e[2]);c>h*o&&(c=h*o);let d=c*a,p=c*s;c=c>l?l:c;let g=c*u,y=CD(t,e[1]),v=y-90,w=Zs(e[1],v,c),C=Zs(e[1],v,g),E=Zs(w,v-90,d),S=Zs(w,v+90,d),A=Zs(C,v-90,p),D=Zs(C,v+90,p),P=[],M=Cesium.Cartesian3.midpoint(e[1],t,new Cesium.Cartesian3),I=CD(e[0],e[2]),O=0;if(O=y-I,y-I<0&&(O=y-I+360),O>=0&&O<180){let m=hp([e[0],M,A],100),b=hp([D,M,e[2]],100);P=m.concat([A,E,e[1],S,D]),P=P.concat(b)}else{let m=hp([e[0],M,D],100),b=hp([A,M,e[2]],100);P=m.concat([D,S,e[1],E,A]),P=P.concat(b)}return P}function sW(e,t,n){let r={},o=[];switch(t){case"sector":if(e.length==2){for(let d=0;d<e.length;d++){let p=Cesium.Cartographic.fromCartesian(e[d]),g=new Cesium.Cartesian3(z.toDegrees(p.longitude),z.toDegrees(p.latitude),p.height);o.push(g)}let f=Math.abs(Math.sqrt(Math.pow(o[0].x-o[1].x,2)+Math.pow(o[0].y-o[1].y,2)));for(let d=0;d<360;d=d+12){let p=new Cesium.Cartesian3(f*Math.cos(Cesium.Math.toRadians(d))+o[0].x,f*Math.sin(Cesium.Math.toRadians(d))+o[0].y,height),g=Cesium.Cartesian3.fromDegrees(p.x,p.y,p.z);positions.push(g)}let h=b2(e[1],e[0]);r.startAngle=h,r.endAngle=h,r.height=j.attr.height}else if(e.length==3){for(let p=0;p<e.length;p++){let g=Cesium.Cartographic.fromCartesian(e[p]),y=new Cesium.Cartesian3(z.toDegrees(g.longitude),z.toDegrees(g.latitude),g.height);o.push(y)}let f=Math.abs(Math.sqrt(Math.pow(o[0].x-o[1].x,2)+Math.pow(o[0].y-o[1].y,2))),h=b2(e[1],e[0]),d=b2(e[2],e[0]);r.startAngle=h,r.endAngle=d,r.height=n.height}let a=new Cesium.WebMercatorProjection,s=Cesium.Cartographic.fromCartesian(e[0]),u=a.project(s,new Cesium.Cartesian3);u.height=r.height;let l=Cesium.Cartographic.fromCartesian(e[1]),c=a.project(l,new Cesium.Cartesian3);c.height=r.height,r.radius=Cesium.Cartesian3.distance(u,c);break;case"ellipse":{let f=new Cesium.WebMercatorProjection;r.height=n.height;let h=Cesium.Cartographic.fromCartesian(e[0]),d=f.project(h),p=Cesium.Cartographic.fromCartesian(e[1]),g=f.project(p),y=Cesium.Cartographic.fromCartesian(e[2]),v=f.project(y),w=Cesium.Cartesian3.distance(g,d);r.minoraxis=w;let C=Cesium.Cartesian3.distance(v,d);r.majoraxis=C}break;case"circle":{let f=new Cesium.WebMercatorProjection;for(let d=0;d<e.length;d++){let p=Cesium.Cartographic.fromCartesian(e[d]);o[d]=f.project(p,new Cesium.Cartesian3)}let h=Cesium.Cartesian3.distance(o[0],o[1]);r.height=n.height,r.radius=h}break;case"rectangle":r.height=n.height,r.startPoint=e[0],r.endPoint=e[1];break;case"polygon":debugger;break;default:break}return r}function S2(e,t,n){for(let r=0;r<e.length;r++)e[r].id.split("_")[1]=="anhor"&&(e[r].position=n)}function A2(e,t,n,r,o,a){let s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian(t),l=s.project(u,new Cesium.Cartesian3),c=Cesium.Cartographic.fromCartesian(n),f=s.project(c,new Cesium.Cartesian3),h=l.x-f.x,d=l.y-f.y,p=[];for(let y=0;y<e.length;y++){let v=Cesium.Cartographic.fromCartesian(e[y]);if(p[y]=s.project(v),p[y].x-=h,p[y].y-=d,p[y].z=a,Cesium.Cartesian3.equals(e[y],t))e[y]=n;else{let w=s.unproject(p[y],new Cesium.Cartographic);e[y]=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,a)}}let g=[];for(let y=0;y<r.length;y++)if(r[y].id.split("_")[1]!="anhor"){let v=Cesium.Cartographic.fromCartesian(r[y].position);g[y]=s.project(v),g[y].x-=h,g[y].y-=d,g[y].z=a;let w=s.unproject(g[y],w);r[y].position=Cesium.Cartesian3.fromRadians(w.longitude,w.latitude,a)}if(o!=null)for(let y=0;y<o.length;y++)if(e[y]==null){let v=Jt(o[0],a);o[y]=v}else{let v=Jt(e[y],a);o[y]=v}}function Jt(e,t){let n=Cesium.Cartographic.fromCartesian(e);return Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,t)}function gD(e,t,n){let r=new Cesium.Cartesian3,o=Cesium.Cartographic.fromCartesian(e),a=new Cesium.WebMercatorProjection,s=a.project(o),u=Cesium.Cartographic.fromCartesian(t),l=a.project(u),c=[];if(n=="minoraxis"||n==null){let f=Cesium.Cartesian3.distance(s,l),h=new Cesium.Cartesian3(s.x+f*Math.cos(Cesium.Math.toRadians(0)),s.y+f*Math.sin(Cesium.Math.toRadians(0)),s.z);c[0]=a.unproject(h,new Cesium.Cartographic),r=Cesium.Cartesian3.fromRadians(c[0].longitude,c[0].latitude,c[0].height)}else{let f=Cesium.Cartesian3.distance(s,l),h=new Cesium.Cartesian3(s.x+f*Math.cos(Cesium.Math.toRadians(90)),s.y+f*Math.sin(Cesium.Math.toRadians(90)),s.z);c[0]=a.unproject(h,c[0]),r=Cesium.Cartesian3.fromRadians(c[0].longitude,c[0].latitude,c[0].height)}return r}function M0e(e,t){let n=Cesium.Cartographic.fromCartesian(e),r=new Cesium.WebMercatorProjection,o=r.project(n,new Cesium.Cartesian3),a=Cesium.Cartographic.fromCartesian(t),s=r.project(a,new Cesium.Cartesian3);return Cesium.Cartesian3.distance(o,s)}function b2(e,t){let n=Cesium.Cartographic.fromCartesian(e),r=Cesium.Cartographic.fromCartesian(t),o=z.toDegrees(n.longitude)-z.toDegrees(r.longitude),a=z.toDegrees(n.latitude)-z.toDegrees(r.latitude),s=Math.atan2(a,o);return z.zeroToTwoPi(s),s=z.toDegrees(s),s}function m0(e,t){let n=e.x-t.x,r=e.y-t.y,o=Math.atan2(r,n);return z.zeroToTwoPi(o),o=z.toDegrees(o),o}function _D(e,t,n,r){let o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),u=t.x+Math.cos(s)*n,l=t.y+Math.sin(s)*n;return new Cesium.Cartesian3(u,l,r)}function ud(e,t){let n="";switch(e){case"sector":n=`\u6247\u5F62${t}`;break;case"polygon":n=`\u591A\u8FB9\u5F62${t}`;break;case"circle":n=`\u5706\u5F62${t}`;break;case"ellipse":n=`\u692D\u5706${t}`;break;case"rectangle":n=`\u77E9\u5F62${t}`;break;case"polyline":n=`\u7EBF${t}`;break;case"point":n=`\u70B9${t}`;break;case"curve":n="\u5706\u5F27"+t;break;default:break}return n}function L0e(e,t){let n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sKHAksBNXfIvIAAADGSURBVBjTlZC9DsFgFIafWsQgDE0vwGBjNVjNdYl1BYYmbkDim0yMEotFooNEW+Wjr6GfpCQG73J+nmc5B/6I924kNYEh0APawAXYAxvP827URUlTSZGkg6S7q5HbN+vySNJM0lOfebr9CKABUBRFH5i851oawMTxCuZ53gGCH3cFjldymqYZcPohnxyv5CzLdsASKL/EElg6XsnW2rUxZgHMgSPwcHVujFlYa9cff47juJUkyRgYAF3gDGx931+FYXjl37wANeOE+Ghv1/sAAAAASUVORK5CYII=",r=e.nodelist,o,a;switch(e.geometryType){case"sector":for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"polygon":o=sy(r),a=Jt(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"circle":for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"ellipse":for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,s==0?(t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_anhor_${e.id}`}),e.anhor=u):t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"rectangle":o=sy(r),a=Jt(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"polyline":o=sy(r),a=Jt(o,e.attr.height),t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(0,0,1,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`0_anhor_${e.id}`}),e.anhor=a;for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${s+1}_node_${e.id}`})}break;case"point":a=Jt(r[0],e.attr.height),r[0]=a,t.add({show:!0,position:a,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:`${i+1}_anhor_${e.id}`}),e.anhor=a,e.show=!1;break;case"multipleArrowLine":for(let s=0;s<r.length;s++){let u=Jt(r[s],e.attr.height);r[s]=u,t.add({show:!0,position:u,horizontalOrigin:0,verticalOrigin:0,scale:1.25,image:n,color:new Cesium.Color(1,1,0,1),disableDepthTestDistance:Number.POSITIVE_INFINITY,id:s+1+"_node_"+e.id})}break;default:break}return t}function sy(e){return new Cesium.BoundingSphere.fromPoints(e).center}function So(e){var t=[];switch(e.geometryType){case"sector":{let n=e.attr.radius,r=e.attr.startAngle,o=e.attr.endAngle,a=e.positions,s=Cesium.Cartographic.fromCartesian(a),u=new Cesium.WebMercatorProjection,l=u.project(s,new Cesium.Cartesian3);r>o&&(o+=360),t=[a];let c=new Cesium.Cartesian3;c.x=l.x+n*Math.cos(z.toRadians(r)),c.y=l.y+n*Math.sin(z.toRadians(r)),c.z=l.z;let f=u.unproject(c,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(f.longitude,f.latitude,f.height));let h=new Cesium.Cartesian3;h.x=l.x+n*Math.cos(z.toRadians(o)),h.y=l.y+n*Math.sin(z.toRadians(o)),h.z=l.z;let d=u.unproject(h,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,d.height))}break;case"circle":{let n=e.attr.radius,r=e.positions,o=e.attr.height,a=new Cesium.WebMercatorProjection,s=Cesium.Cartographic.fromCartesian(r),u=a.project(s,new Cesium.Cartesian3);t.push(r);let l=new Cesium.Cartesian3;l.x=u.x+Math.cos(Cesium.Math.toRadians(0))*n,l.y=u.y+Math.sin(Cesium.Math.toRadians(0))*n,l.z=u.z;let c=a.unproject(l,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,o))}break;case"ellipse":{let n=e.attr.minoraxis,r=e.attr.majoraxis,o=e.positions,a=e.attr.height,s=new Cesium.WebMercatorProjection,u=Cesium.Cartographic.fromCartesian(o),l=s.project(u,new Cesium.Cartesian3);t.push(o);let c=new Cesium.Cartesian3;c.x=l.x+Math.cos(Cesium.Math.toRadians(0))*n,c.y=l.y+Math.sin(Cesium.Math.toRadians(0))*r,c.z=l.z;let f=s.unproject(c,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(f.longitude,f.latitude,a));let h=new Cesium.Cartesian3;h.x=l.x+Math.cos(Cesium.Math.toRadians(90))*n,h.y=l.y+Math.sin(Cesium.Math.toRadians(90))*r,h.z=l.z;let d=s.unproject(h,new Cesium.Cartographic);t.push(Cesium.Cartesian3.fromRadians(d.longitude,d.latitude,a))}break;case"rectangle":t=[e.attr.startPoint,e.attr.endPoint];break;case"polygon":t=e.positions;break;case"polyline":t=e.positions;break;case"point":t=e.positions;break;case"curve":t=e.positions;break;case"curveWall":t=e.positions;break;case"bezierWall":t=e.positions;break;case"multipleArrowLine":t=e.positions;break;default:break}return t}function CD(e,t){let n=Cesium.Transforms.eastNorthUpToFixedFrame(t),r=Cesium.Matrix4.inverse(n,new Cesium.Matrix4),o=Cesium.Matrix4.multiplyByPoint(r,t,new Cesium.Cartesian3),a=Cesium.Matrix4.multiplyByPoint(r,e,new Cesium.Cartesian3),u=Math.atan2(a.y-o.y,a.x-o.x)*(180/Math.PI);return u<0&&(u=u+360),u}function Zs(e,t,n){let r=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t||0)),a=Cesium.Matrix4.fromRotationTranslation(o);return Cesium.Matrix4.multiply(r,a,r),Cesium.Matrix4.multiplyByPoint(r,new Cesium.Cartesian3(0,n,0),new Cesium.Cartesian3)}function yD(e,t,n){let r=CD(e,t),o=r+30-90,a=r-30-90,s=[],u=Cesium.Cartesian3.distance(e,t)/10;if(n=="triangle"){let l=Zs(t,r+90,u/10),c=Zs(l,o,u),f=Zs(l,a,u);s=[c,l,f]}else{let l=Zs(t,r+90,0),c=Zs(l,o,u),f=Zs(l,a,u);s=[c,l,f]}return s}function hp(e,t){t=Cesium.defaultValue(t,100);let n=e.length,r=[];if(n>2){let o=[],a=[],s=[];for(let u=0;u<n;u++)a.push(e.length-u-1),s.push(u),o.push(R0e(u,n));for(let u=0;u<t;u++){let l=u/t,c=new Cesium.Cartesian3,f=new Cesium.Cartesian3;for(let h=0;h<n;h++){let d=o[h]*Math.pow(1-l,a[h])*Math.pow(l,s[h]);Cesium.Cartesian3.multiplyByScalar(e[h],d,c),Cesium.Cartesian3.add(f,c,f)}r.push(f)}r.push(e[e.length-1])}else r=e;return r}function R0e(e,t){let n=1,r=1;for(let a=1;a<e+1;a++)r=r*a,n=(t-a)*n;return n/r}function OC(e,t,n,r){let o=CD(e,t),a=o+30-90,s=[],u=o-30-90;if(n=n/10,r=="triangle"){let l=Zs(t,o+90,n/10),c=Zs(l,a,n),f=Zs(l,u,n);s=[c,l,f]}else{let l=Zs(t,o+90,0),c=Zs(l,a,n),f=Zs(l,u,n);s=[c,l,f]}return s}function Pi(e){let t=e;wi&&(j!=null&&(t.gemotryList.remove(j.id),t.viewer.entities.remove(j),j.outline!=null&&j.outline.show&&Nt!=null&&t.viewer.entities.remove(Nt),t.index--),p0=!1,j=void 0,Nt=void 0,ai=void 0),d0=!1,on=0,iy=!1,In={},wi=!0,Ha=!1,t.billboardCollection.removeAll(),ay==null&&(ay=new Cesium.ScreenSpaceEventHandler(t.viewer.scene.canvas)),uW(ay,t.viewer,t)}var cW=ve;var os=63710088e-1,sP={meters:os,metres:os,millimeters:os*1e3,millimetres:os*1e3,centimeters:os*100,centimetres:os*100,kilometers:os/1e3,kilometres:os/1e3,miles:os/1609.344,nauticalmiles:os/1852,inches:os*39.37,yards:os/1.0936,feet:os*3.28084,radians:1,degrees:os/111325},K7={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:1/1e3,kilometres:1/1e3,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/os,degrees:1/111325},GD={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function ra(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.bbox,o=n.id;if(e===void 0)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");r&&g1(r),o&&lP(o);var a={type:"Feature"};return o&&(a.id=o),r&&(a.bbox=r),a.properties=t||{},a.geometry=e,a}function Z7(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.bbox;if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");r&&g1(r);var o;switch(e){case"Point":o=Vr(t).geometry;break;case"LineString":o=Li(t).geometry;break;case"Polygon":o=Dn(t).geometry;break;case"MultiPoint":o=uP(t).geometry;break;case"MultiLineString":o=R0(t).geometry;break;case"MultiPolygon":o=m1(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(o.bbox=r),o}function Vr(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ui(e[0])||!ui(e[1]))throw new Error("coordinates must contain numbers");return ra({type:"Point",coordinates:e},t,n)}function Q7(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Bt(e.map(function(r){return Vr(r,t)}),n)}function Dn(e,t,n){if(!e)throw new Error("coordinates is required");for(var r=0;r<e.length;r++){var o=e[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(r===0&&a===0&&!ui(o[0][0])||!ui(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return ra({type:"Polygon",coordinates:e},t,n)}function J7(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Bt(e.map(function(r){return Dn(r,t)}),n)}function Li(e,t,n){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!ui(e[0][1])||!ui(e[0][1]))throw new Error("coordinates must contain numbers");return ra({type:"LineString",coordinates:e},t,n)}function $7(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Bt(e.map(function(r){return Li(r,t)}),n)}function Bt(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.bbox,r=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");n&&g1(n),r&&lP(r);var o={type:"FeatureCollection"};return r&&(o.id=r),n&&(o.bbox=n),o.features=e,o}function R0(e,t,n){if(!e)throw new Error("coordinates is required");return ra({type:"MultiLineString",coordinates:e},t,n)}function uP(e,t,n){if(!e)throw new Error("coordinates is required");return ra({type:"MultiPoint",coordinates:e},t,n)}function m1(e,t,n){if(!e)throw new Error("coordinates is required");return ra({type:"MultiPolygon",coordinates:e},t,n)}function m3(e,t,n){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return ra({type:"GeometryCollection",geometries:e},t,n)}function eY(e,t){if(e==null||isNaN(e))throw new Error("num is required");if(t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function WC(e,t){if(e==null)throw new Error("radians is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=sP[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e*n}function hy(e,t){if(e==null)throw new Error("distance is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=sP[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e/n}function UD(e,t){return w0(hy(e,t))}function _0(e){if(e==null)throw new Error("bearing is required");var t=e%360;return t<0&&(t+=360),t}function w0(e){if(e==null)throw new Error("radians is required");var t=e%(2*Math.PI);return t*180/Math.PI}function qa(e){if(e==null)throw new Error("degrees is required");var t=e%360;return t*Math.PI/180}function dy(e,t,n){if(e==null)throw new Error("length is required");if(!(e>=0))throw new Error("length must be a positive number");return WC(hy(e,t),n||"kilometers")}function tY(e,t,n){if(e==null)throw new Error("area is required");if(!(e>=0))throw new Error("area must be a positive number");var r=GD[t||"meters"];if(!r)throw new Error("invalid original units");var o=GD[n||"kilometers"];if(!o)throw new Error("invalid final units");return e/r*o}function ui(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function pt(e){return!!e&&e.constructor===Object}function g1(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!ui(t))throw new Error("bbox must only contain numbers")})}function lP(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function O0e(){throw new Error("method has been renamed to `radiansToDegrees`")}function N0e(){throw new Error("method has been renamed to `degreesToRadians`")}function B0e(){throw new Error("method has been renamed to `lengthToDegrees`")}function F0e(){throw new Error("method has been renamed to `lengthToRadians`")}function z0e(){throw new Error("method has been renamed to `radiansToLength`")}function V0e(){throw new Error("method has been renamed to `bearingToAzimuth`")}function k0e(){throw new Error("method has been renamed to `convertLength`")}var G0e=Object.freeze({earthRadius:os,factors:sP,unitsFactors:K7,areaFactors:GD,feature:ra,geometry:Z7,point:Vr,points:Q7,polygon:Dn,polygons:J7,lineString:Li,lineStrings:$7,featureCollection:Bt,multiLineString:R0,multiPoint:uP,multiPolygon:m1,geometryCollection:m3,round:eY,radiansToLength:WC,lengthToRadians:hy,lengthToDegrees:UD,bearingToAzimuth:_0,radiansToDegrees:w0,degreesToRadians:qa,convertLength:dy,convertArea:tY,isNumber:ui,isObject:pt,validateBBox:g1,validateId:lP,radians2degrees:O0e,degrees2radians:N0e,distanceToDegrees:B0e,distanceToRadians:F0e,radiansToDistance:z0e,bearingToAngle:V0e,convertDistance:k0e});function Wa(e,t,n){if(e!==null)for(var r,o,a,s,u,l,c,f=0,h=0,d,p=e.type,g=p==="FeatureCollection",y=p==="Feature",v=g?e.features.length:1,w=0;w<v;w++){c=g?e.features[w].geometry:y?e.geometry:e,d=c?c.type==="GeometryCollection":!1,u=d?c.geometries.length:1;for(var C=0;C<u;C++){var E=0,S=0;if(s=d?c.geometries[C]:c,s!==null){l=s.coordinates;var A=s.type;switch(f=n&&(A==="Polygon"||A==="MultiPolygon")?1:0,A){case null:break;case"Point":t(l,h,w,E,S),h++,E++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++)t(l[r],h,w,E,S),h++,A==="MultiPoint"&&E++;A==="LineString"&&E++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-f;o++)t(l[r][o],h,w,E,S),h++;A==="MultiLineString"&&E++,A==="Polygon"&&S++}A==="Polygon"&&E++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(A==="MultiPolygon"&&(S=0),o=0;o<l[r].length;o++){for(a=0;a<l[r][o].length-f;a++)t(l[r][o][a],h,w,E,S),h++;S++}E++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)Wa(s.geometries[r],t,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function cP(e,t,n,r){var o=n;return Wa(e,function(a,s,u,l,c){s===0&&n===void 0?o=a:o=t(o,a,s,u,l,c)},r),o}function g3(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length;n++)t(e.features[n].properties,n);break;case"Feature":t(e.properties,0);break}}function nY(e,t,n){var r=n;return g3(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function li(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)t(e.features[n],n)}function _3(e,t,n){var r=n;return li(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function Cp(e){var t=[];return Wa(e,function(n){t.push(n)}),t}function ih(e,t){var n,r,o,a,s,u,l,c,f,h,d=0,p=e.type==="FeatureCollection",g=e.type==="Feature",y=p?e.features.length:1;for(n=0;n<y;n++){for(u=p?e.features[n].geometry:g?e.geometry:e,c=p?e.features[n].properties:g?e.properties:{},f=p?e.features[n].bbox:g?e.bbox:void 0,h=p?e.features[n].id:g?e.id:void 0,l=u?u.type==="GeometryCollection":!1,s=l?u.geometries.length:1,o=0;o<s;o++){if(a=l?u.geometries[o]:u,a===null){t(null,d,c,f,h);continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{t(a,d,c,f,h);break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)t(a.geometries[r],d,c,f,h);break}default:throw new Error("Unknown Geometry Type")}}d++}}function y3(e,t,n){var r=n;return ih(e,function(o,a,s,u,l){a===0&&n===void 0?r=o:r=t(r,o,a,s,u,l)}),r}function ko(e,t){ih(e,function(n,r,o,a,s){var u=n===null?null:n.type;switch(u){case null:case"Point":case"LineString":case"Polygon":t(ra(n,o,{bbox:a,id:s}),r,0);return}var l;switch(u){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}n.coordinates.forEach(function(c,f){var h={type:l,coordinates:c};t(ra(h,o),r,f)})})}function rY(e,t,n){var r=n;return ko(e,function(o,a,s){a===0&&s===0&&n===void 0?r=o:r=t(r,o,a,s)}),r}function Fm(e,t){ko(e,function(n,r,o){var a=0;if(!!n.geometry){var s=n.geometry.type;s==="Point"||s==="MultiPoint"||cP(n,function(u,l,c,f,h,d){var p=Li([u,l],n.properties);return t(p,r,o,d,a),a++,l})}})}function v3(e,t,n){var r=n,o=!1;return Fm(e,function(a,s,u,l,c){o===!1&&n===void 0?r=a:r=t(r,a,s,u,l,c),o=!0}),r}function C3(e,t){if(!e)throw new Error("geojson is required");ko(e,function(n,r,o){if(n.geometry!==null){var a=n.geometry.type,s=n.geometry.coordinates;switch(a){case"LineString":t(n,r,o,0,0);break;case"Polygon":for(var u=0;u<s.length;u++)t(Li(s[u],n.properties),r,o,u);break}}})}function x3(e,t,n){var r=n;return C3(e,function(o,a,s,u){a===0&&n===void 0?r=o:r=t(r,o,a,s,u)}),r}var U0e=Object.freeze({coordEach:Wa,coordReduce:cP,propEach:g3,propReduce:nY,featureEach:li,featureReduce:_3,coordAll:Cp,geomEach:ih,geomReduce:y3,flattenEach:ko,flattenReduce:rY,segmentEach:Fm,segmentReduce:v3,lineEach:C3,lineReduce:x3});function Ca(e){var t=[1/0,1/0,-1/0,-1/0];return Wa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function ao(e){if(!e)throw new Error("obj is required");var t=wt(e);if(t.length>1&&ui(t[0])&&ui(t[1]))return t;throw new Error("Coordinate is not a valid Point")}function wt(e){if(!e)throw new Error("obj is required");var t;if(e.length?t=e:e.coordinates?t=e.coordinates:e.geometry&&e.geometry.coordinates&&(t=e.geometry.coordinates),t)return fP(t),t;throw new Error("No valid coordinates")}function fP(e){if(e.length>1&&ui(e[0])&&ui(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return fP(e[0]);throw new Error("coordinates must only contain numbers")}function iY(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function lT(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function xd(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<e.features.length;r++){var o=e.features[r];if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+o.geometry.type)}}function Bl(e){if(!e)throw new Error("geojson is required");if(e.geometry!==void 0)return e.geometry;if(e.coordinates||e.geometries)return e;throw new Error("geojson must be a valid Feature or Geometry Object")}function oY(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function Ri(e,t){if(!e)throw new Error((t||"geojson")+" is required");if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error((t||"geojson")+" is invalid")}var H0e=Object.freeze({getCoord:ao,getCoords:wt,containsNumber:fP,geojsonType:iY,featureOf:lT,collectionOf:xd,getGeom:Bl,getGeomType:oY,getType:Ri});/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var fW={successCallback:null,verbose:!1},wD={};function q0e(e,t,n){n=n||{};for(var r=Object.keys(fW),o=0;o<r.length;o++){var a=r[o],s=n[a];s=typeof s<"u"&&s!==null?s:fW[a],wD[a]=s}wD.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var u=X0e(W0e(e,t));return typeof wD.successCallback=="function"&&wD.successCallback(u),u}function Mi(e,t,n){return(e-t)/(n-t)}function W0e(e,t){for(var n=e.length-1,r=e[0].length-1,o={rows:n,cols:r,cells:[]},a=0;a<n;++a){o.cells[a]=[];for(var s=0;s<r;++s){var u=0,l=e[a+1][s],c=e[a+1][s+1],f=e[a][s+1],h=e[a][s];if(!(isNaN(l)||isNaN(c)||isNaN(f)||isNaN(h))){u|=l>=t?8:0,u|=c>=t?4:0,u|=f>=t?2:0,u|=h>=t?1:0;var d=!1;if(u===5||u===10){var p=(l+c+f+h)/4;u===5&&p<t?(u=10,d=!0):u===10&&p<t&&(u=5,d=!0)}if(u!==0&&u!==15){var g,y,v,w;g=y=v=w=.5,u===1?(v=1-Mi(t,l,h),y=1-Mi(t,f,h)):u===2?(y=Mi(t,h,f),w=1-Mi(t,c,f)):u===3?(v=1-Mi(t,l,h),w=1-Mi(t,c,f)):u===4?(g=Mi(t,l,c),w=Mi(t,f,c)):u===5?(g=Mi(t,l,c),w=Mi(t,f,c),y=1-Mi(t,f,h),v=1-Mi(t,l,h)):u===6?(y=Mi(t,h,f),g=Mi(t,l,c)):u===7?(v=1-Mi(t,l,h),g=Mi(t,l,c)):u===8?(v=Mi(t,h,l),g=1-Mi(t,c,l)):u===9?(y=1-Mi(t,f,h),g=1-Mi(t,c,l)):u===10?(g=1-Mi(t,c,l),w=1-Mi(t,c,f),y=Mi(t,h,f),v=Mi(t,h,l)):u===11?(g=1-Mi(t,c,l),w=1-Mi(t,c,f)):u===12?(v=Mi(t,h,l),w=Mi(t,f,c)):u===13?(y=1-Mi(t,f,h),w=Mi(t,f,c)):u===14?(v=Mi(t,h,l),y=Mi(t,h,f)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+u),o.cells[a][s]={cval:u,flipped:d,top:g,right:w,bottom:y,left:v}}}}}return o}function Y0e(e){return e.cval===5||e.cval===10}function aY(e){return e.cval===0||e.cval===15}function hW(e){!aY(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function D2(e,t){if(t==="top")return[e.top,1];if(t==="bottom")return[e.bottom,0];if(t==="right")return[1,e.right];if(t==="left")return[0,e.left]}function X0e(e){var t=[],n=0,r=e.rows,o=e.cols,a=1e-7;return e.cells.forEach(function(s,u){s.forEach(function(l,c){if(typeof l<"u"&&!Y0e(l)&&!aY(l)){var f=j0e(e.cells,u,c),h=!1;if(f.info==="mergeable"){for(var d=f.path[f.path.length-1][0],p=f.path[f.path.length-1][1],g=n-1;g>=0;g--)if(Math.abs(t[g][0][0]-d)<=a&&Math.abs(t[g][0][1]-p)<=a){for(var y=f.path.length-2;y>=0;--y)t[g].unshift(f.path[y]);h=!0;break}}h||(t[n++]=f.path)}})}),t}function j0e(e,t,n){var r=e.length,o=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],s=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u,l,c=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],f=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],g,h=e[t][n],d=e[t][n],p=d.cval,g=c[p],y=D2(d,g);o.push([n+y[0],t+y[1]]),g=f[p],y=D2(d,g),o.push([n+y[0],t+y[1]]),hW(d);for(var v=n+a[p],w=t+s[p],C=p;v>=0&&w>=0&&w<r&&(v!=n||w!=t)&&(d=e[w][v],!(typeof d>"u"));){if(p=d.cval,p===0||p===15)return{path:o,info:"mergeable"};g=f[p],u=a[p],l=s[p],(p===5||p===10)&&(p===5?d.flipped?s[C]===-1?(g="left",u=-1,l=0):(g="right",u=1,l=0):a[C]===-1&&(g="bottom",u=0,l=-1):p===10&&(d.flipped?a[C]===-1?(g="top",u=0,l=1):(g="bottom",u=0,l=-1):s[C]===1&&(g="left",u=-1,l=0))),y=D2(d,g),o.push([v+y[0],w+y[1]]),hW(d),v+=u,w+=l,C=p}return{path:o,info:"closed"}}function K0e(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;xd(e,"Point","input must contain Points");for(var a=Z0e(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function Z0e(e,t){var n={};li(e,function(a){var s=wt(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return wt(l)[0]-wt(c)[0]});return u}),o=r.sort(function(a,s){return t?wt(a[0])[1]-wt(s[0])[1]:wt(s[0])[1]-wt(a[0])[1]});return o}function Q0e(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(xd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!pt(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(a))throw new Error("breaksProperties must be an Array");var s=K0e(e,{zProperty:r,flip:!0}),u=J0e(s,t,r,o,a),l=$0e(u,s,e);return Bt(l)}function J0e(e,t,n,r,o){for(var a=[],s=1;s<t.length;s++){var u=+t[s],l=Object.assign({},r,o[s]);l[n]=u;var c=R0(q0e(e,u),l);a.push(c)}return a}function $0e(e,t,n){var r=Ca(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){Wa(p,d)}),e}var e_e=sY;function sY(e,t,n,r,o){for(n=n||0,r=r||e.length-1,o=o||t_e;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));sY(e,t,f,h,o)}var d=e[t],p=n,g=r;for(jE(e,n,t),o(e[r],d)>0&&jE(e,n,r);p<g;){for(jE(e,p,g),p++,g--;o(e[p],d)<0;)p++;for(;o(e[g],d)>0;)g--}o(e[n],d)===0?jE(e,n,g):(g++,jE(e,g,r)),g<=t&&(n=g+1),t<=g&&(r=g-1)}}function jE(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function t_e(e,t){return e<t?-1:e>t?1:0}var YC=HD;function HD(e,t){if(!(this instanceof HD))return new HD(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}HD.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!TD(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,TD(e,l)&&(t.leaf?n.push(u):M2(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!TD(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,TD(e,u)){if(t.leaf||M2(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=FC([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=n_e(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&M2(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:dW,compareMinY:pW,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=FC(e.slice(t,n+1)),NC(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=FC([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(mW(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),mW(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return NC(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=P2(s),c=r_e(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),tT(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=FC(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,NC(n,this.toBBox),NC(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=FC([e,t]),this.data.height=e.height+1,this.data.leaf=!1,NC(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=eT(e,0,r,this.toBBox),a=eT(e,r,n,this.toBBox),s=i_e(o,a),u=P2(o)+P2(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:dW,o=e.leaf?this.compareMinY:pW,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=eT(e,0,t,o),s=eT(e,n-t,n,o),u=ED(a)+ED(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],tT(a,e.leaf?o(c):c),u+=ED(a);for(l=n-t-1;l>=t;l--)c=e.children[l],tT(s,e.leaf?o(c):c),u+=ED(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)tT(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():NC(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function n_e(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function NC(e,t){eT(e,0,e.children.length,t,e)}function eT(e,t,n,r,o){o||(o=FC(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],tT(o,e.leaf?r(s):s);return o}function tT(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function dW(e,t){return e.minX-t.minX}function pW(e,t){return e.minY-t.minY}function P2(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function ED(e){return e.maxX-e.minX+(e.maxY-e.minY)}function r_e(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function i_e(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function M2(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function TD(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function FC(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function mW(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,e_e(e,s,t,n,o),a.push(t,s,s,n))}function Jm(e,t){return t={exports:{}},e(t,t.exports),t.exports}var BD=o_e,gW=+(Math.pow(2,27)+1);function o_e(e,t,n){var r=e*t,o=gW*e,a=o-e,s=o-a,u=e-s,l=gW*t,c=l-t,f=l-c,h=t-f,d=r-s*f,p=d-u*f,g=p-s*h,y=u*h-g;return n?(n[0]=y,n[1]=r,n):[y,r]}var a_e=u_e;function s_e(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function u_e(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return s_e(e[0],t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=t[l],p=c(d),g,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=t[l],p=c(d))),u<n&&h<p||l>=r?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=t[l],p=c(d)));for(var v=g+y,w=v-g,C=y-w,E=C,S=v,A,D,P,M,I;u<n&&l<r;)h<p?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=t[l],p=c(d))),y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A;for(;u<n;)g=f,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)g=d,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,l+=1,l<r&&(d=t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var l_e=c_e;function c_e(e,t,n){var r=e+t,o=r-e,a=r-o,s=t-o,u=e-a;return n?(n[0]=u+s,n[1]=r,n):[u+s,r]}var f_e=h_e;function h_e(e,t){var n=e.length;if(n===1){var r=BD(e[0],t);return r[0]?r:[r[1]]}var o=new Array(2*n),a=[.1,.1],s=[.1,.1],u=0;BD(e[0],t,a),a[0]&&(o[u++]=a[0]);for(var l=1;l<n;++l){BD(e[l],t,s);var c=a[1];l_e(c,s[0],a),a[0]&&(o[u++]=a[0]);var f=s[1],h=a[1],d=f+h,p=d-f,g=h-p;a[1]=d,g&&(o[u++]=g)}return a[1]&&(o[u++]=a[1]),u===0&&(o[u++]=0),o.length=u,o}var d_e=m_e;function p_e(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function m_e(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return p_e(e[0],-t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=-t[l],p=c(d),g,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=-t[l],p=c(d))),u<n&&h<p||l>=r?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=-t[l],p=c(d)));for(var v=g+y,w=v-g,C=y-w,E=C,S=v,A,D,P,M,I;u<n&&l<r;)h<p?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=-t[l],p=c(d))),y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A;for(;u<n;)g=f,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)g=d,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,l+=1,l<r&&(d=-t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var uY=Jm(function(e){var t=5,n=11102230246251565e-32,r=(3+16*n)*n,o=(7+56*n)*n;function a(v,w){for(var C=new Array(v.length-1),E=1;E<v.length;++E)for(var S=C[E-1]=new Array(v.length-1),A=0,D=0;A<v.length;++A)A!==w&&(S[D++]=v[E][A]);return C}function s(v){for(var w=new Array(v),C=0;C<v;++C){w[C]=new Array(v);for(var E=0;E<v;++E)w[C][E]=["m",E,"[",v-C-1,"]"].join("")}return w}function u(v){return v&1?"-":""}function l(v){if(v.length===1)return v[0];if(v.length===2)return["sum(",v[0],",",v[1],")"].join("");var w=v.length>>1;return["sum(",l(v.slice(0,w)),",",l(v.slice(w)),")"].join("")}function c(v){if(v.length===2)return[["sum(prod(",v[0][0],",",v[1][1],"),prod(-",v[0][1],",",v[1][0],"))"].join("")];for(var w=[],C=0;C<v.length;++C)w.push(["scale(",l(c(a(v,C))),",",u(C),v[0][C],")"].join(""));return w}function f(v){for(var w=[],C=[],E=s(v),S=[],A=0;A<v;++A)(A&1)===0?w.push.apply(w,c(a(E,A))):C.push.apply(C,c(a(E,A))),S.push("m"+A);var D=l(w),P=l(C),M="orientation"+v+"Exact",I=["function ",M,"(",S.join(),"){var p=",D,",n=",P,",d=sub(p,n);return d[d.length-1];};return ",M].join(""),O=new Function("sum","prod","scale","sub",I);return O(a_e,BD,f_e,d_e)}var h=f(3),d=f(4),p=[function(){return 0},function(){return 0},function(w,C){return C[0]-w[0]},function(w,C,E){var S=(w[1]-E[1])*(C[0]-E[0]),A=(w[0]-E[0])*(C[1]-E[1]),D=S-A,P;if(S>0){if(A<=0)return D;P=S+A}else if(S<0){if(A>=0)return D;P=-(S+A)}else return D;var M=r*P;return D>=M||D<=-M?D:h(w,C,E)},function(w,C,E,S){var A=w[0]-S[0],D=C[0]-S[0],P=E[0]-S[0],M=w[1]-S[1],I=C[1]-S[1],O=E[1]-S[1],m=w[2]-S[2],b=C[2]-S[2],L=E[2]-S[2],R=D*O,N=P*I,B=P*M,G=A*O,F=A*I,k=D*M,Z=m*(R-N)+b*(B-G)+L*(F-k),te=(Math.abs(R)+Math.abs(N))*Math.abs(m)+(Math.abs(B)+Math.abs(G))*Math.abs(b)+(Math.abs(F)+Math.abs(k))*Math.abs(L),oe=o*te;return Z>oe||-Z>oe?Z:d(w,C,E,S)}];function g(v){var w=p[v.length];return w||(w=p[v.length]=f(v.length)),w.apply(void 0,v)}function y(){for(;p.length<=t;)p.push(f(p.length));for(var v=[],w=["slow"],C=0;C<=t;++C)v.push("a"+C),w.push("o"+C);for(var E=["function getOrientation(",v.join(),"){switch(arguments.length){case 0:case 1:return 0;"],C=2;C<=t;++C)E.push("case ",C,":return o",C,"(",v.slice(0,C).join(),");");E.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),w.push(E.join(""));var S=Function.apply(void 0,w);e.exports=S.apply(void 0,[g].concat(p));for(var C=0;C<=t;++C)e.exports[C]=p[C]}y()}),g_e=__e,_W=uY[3];function __e(e){var t=e.length;if(t<3){for(var c=new Array(t),n=0;n<t;++n)c[n]=n;return t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:c}for(var r=new Array(t),n=0;n<t;++n)r[n]=n;r.sort(function(p,g){var y=e[p][0]-e[g][0];return y||e[p][1]-e[g][1]});for(var o=[r[0],r[1]],a=[r[0],r[1]],n=2;n<t;++n){for(var s=r[n],u=e[s],l=o.length;l>1&&_W(e[o[l-2]],e[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(s),l=a.length;l>1&&_W(e[a[l-2]],e[a[l-1]],u)>=0;)l-=1,a.pop();a.push(s)}for(var c=new Array(a.length+o.length-2),f=0,n=0,h=o.length;n<h;++n)c[f++]=o[n];for(var d=a.length-2;d>0;--d)c[f++]=a[d];return c}var lY=cT,y_e=cT;function cT(e,t){if(!(this instanceof cT))return new cT(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||v_e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function v_e(e,t){return e<t?-1:e>t?1:0}cT.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var o=e-1>>1,a=t[o];if(n(r,a)>=0)break;t[e]=a,e=o}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,o=t[e];e<r;){var a=(e<<1)+1,s=a+1,u=t[a];if(s<this.length&&n(t[s],u)<0&&(a=s,u=t[s]),n(u,o)>=0)break;t[e]=u,e=a}t[e]=o}};lY.default=y_e;var C_e=function(e,t){for(var n=e[0],r=e[1],o=!1,a=0,s=t.length-1;a<t.length;s=a++){var u=t[a][0],l=t[a][1],c=t[s][0],f=t[s][1],h=l>r!=f>r&&n<(c-u)*(r-l)/(f-l)+u;h&&(o=!o)}return o},SD=uY[3],cY=fY,x_e=fY;function fY(e,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;for(var r=A_e(e),o=YC(16,["[0]","[1]","[0]","[1]"]).load(e),a=[],s=0,u;s<r.length;s++){var l=r[s];o.remove(l),u=CW(l,u),a.push(u)}var c=YC(16);for(s=0;s<a.length;s++)c.insert(L2(a[s]));for(var f=t*t,h=n*n;a.length;){var d=a.shift(),p=d.p,g=d.next.p,y=R2(p,g);if(!(y<h)){var v=y/f;l=w_e(o,d.prev.p,p,g,d.next.next.p,v,c),l&&Math.min(R2(l,p),R2(l,g))<=v&&(a.push(d),a.push(CW(l,d)),o.remove(l),c.remove(d),c.insert(L2(d)),c.insert(L2(d.next)))}}d=u;var w=[];do w.push(d.p),d=d.next;while(d!==u);return w.push(d.p),w}function w_e(e,t,n,r,o,a,s){for(var u=new lY(null,E_e),l=e.data;l;){for(var c=0;c<l.children.length;c++){var f=l.children[c],h=l.leaf?O2(f,n,r):T_e(n,r,f);h>a||u.push({node:f,dist:h})}for(;u.length&&!u.peek().node.children;){var d=u.pop(),p=d.node,g=O2(p,t,n),y=O2(p,r,o);if(d.dist<g&&d.dist<y&&vW(n,p,s)&&vW(r,p,s))return p}l=u.pop(),l&&(l=l.node)}return null}function E_e(e,t){return e.dist-t.dist}function T_e(e,t,n){if(yW(e,n)||yW(t,n))return 0;var r=AD(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var o=AD(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(o===0)return 0;var a=AD(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var s=AD(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return s===0?0:Math.min(r,o,a,s)}function yW(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function vW(e,t,n){for(var r=Math.min(e[0],t[0]),o=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),s=Math.max(e[1],t[1]),u=n.search({minX:r,minY:o,maxX:a,maxY:s}),l=0;l<u.length;l++)if(S_e(u[l].p,u[l].next.p,e,t))return!1;return!0}function S_e(e,t,n,r){return e!==r&&t!==n&&SD(e,t,n)>0!=SD(e,t,r)>0&&SD(n,r,e)>0!=SD(n,r,t)>0}function L2(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function A_e(e){for(var t=e[0],n=e[0],r=e[0],o=e[0],a=0;a<e.length;a++){var s=e[a];s[0]<t[0]&&(t=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>o[1]&&(o=s)}var u=[t,n,r,o],l=u.slice();for(a=0;a<e.length;a++)C_e(e[a],u)||l.push(e[a]);var c=g_e(l),f=[];for(a=0;a<c.length;a++)f.push(l[c[a]]);return f}function CW(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function R2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function O2(e,t,n){var r=t[0],o=t[1],a=n[0]-r,s=n[1]-o;if(a!==0||s!==0){var u=((e[0]-r)*a+(e[1]-o)*s)/(a*a+s*s);u>1?(r=n[0],o=n[1]):u>0&&(r+=a*u,o+=s*u)}return a=e[0]-r,s=e[1]-o,a*a+s*s}function AD(e,t,n,r,o,a,s,u){var l=n-e,c=r-t,f=s-o,h=u-a,d=e-o,p=t-a,g=l*l+c*c,y=l*f+c*h,v=f*f+h*h,w=l*d+c*p,C=f*d+h*p,E=g*v-y*y,S,A,D,P,M=E,I=E;E===0?(A=0,M=1,P=C,I=v):(A=y*C-v*w,P=g*C-y*w,A<0?(A=0,P=C,I=v):A>M&&(A=M,P=C+y,I=v)),P<0?(P=0,-w<0?A=0:-w>g?A=M:(A=-w,M=g)):P>I&&(P=I,-w+y<0?A=0:-w+y>g?A=M:(A=-w+y,M=g)),S=A===0?0:A/M,D=P===0?0:P/I;var O=(1-S)*e+S*n,m=(1-S)*t+S*r,b=(1-D)*o+D*s,L=(1-D)*a+D*u,R=b-O,N=L-m;return R*R+N*N}cY.default=x_e;function hY(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.concavity||1/0,r=[];if(Wa(e,function(a){r.push([a[0],a[1]])}),!r.length)return null;var o=cY(r,n);return o.length>3?Dn([o]):null}function _o(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=ao(e),a=wt(t),s=t.geometry?t.geometry.type:t.type,u=t.bbox;if(u&&b_e(o,u)===!1)return!1;s==="Polygon"&&(a=[a]);for(var l=0,c=!1;l<a.length&&!c;l++)if(xW(o,a[l][0],r)){for(var f=!1,h=1;h<a[l].length&&!f;)xW(o,a[l][h],!r)&&(f=!0),h++;f||(c=!0)}return c}function xW(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],u=t[o][1],l=t[a][0],c=t[a][1],f=e[1]*(s-l)+u*(l-e[0])+c*(e[0]-s)===0&&(s-e[0])*(l-e[0])<=0&&(u-e[1])*(c-e[1])<=0;if(f)return!n;var h=u>e[1]!=c>e[1]&&e[0]<(l-s)*(e[1]-u)/(c-u)+s;h&&(r=!r)}return r}function b_e(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function K2(e,t){var n=[];return ih(t,function(r){li(e,function(o){_o(o,r)&&n.push(o)})}),Bt(n)}function dY(e,t){if(e.type!=="FeatureCollection")throw new Error("points must be a FeatureCollection");var n=!1;return Bt(P_e(e.features.map(function(r){var o={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1]};return t?o.z=r.properties[t]:r.geometry.coordinates.length===3&&(n=!0,o.z=r.geometry.coordinates[2]),o})).map(function(r){var o=[r.a.x,r.a.y],a=[r.b.x,r.b.y],s=[r.c.x,r.c.y],u={};return n?(o.push(r.a.z),a.push(r.b.z),s.push(r.c.z)):u={a:r.a.z,b:r.b.z,c:r.c.z},Dn([[o,a,s,o]],u)}))}function wW(e,t,n){this.a=e,this.b=t,this.c=n;var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,u=r*(e.x+t.x)+o*(e.y+t.y),l=a*(e.x+n.x)+s*(e.y+n.y),c=2*(r*(n.y-t.y)-o*(n.x-t.x)),f,h;this.x=(s*u-o*l)/c,this.y=(r*l-a*u)/c,f=this.x-e.x,h=this.y-e.y,this.r=f*f+h*h}function I_e(e,t){return t.x-e.x}function D_e(e){var t=e.length,n,r,o,a,s;e:for(;t;)for(r=e[--t],n=e[--t],o=t;o;)if(s=e[--o],a=e[--o],n===a&&r===s||n===s&&r===a){e.splice(t,2),e.splice(o,2),t-=2;continue e}}function P_e(e){if(e.length<3)return[];e.sort(I_e);for(var t=e.length-1,n=e[t].x,r=e[0].x,o=e[t].y,a=o,s=1e-12,u,l,c,f,h,d;t--;)e[t].y<o&&(o=e[t].y),e[t].y>a&&(a=e[t].y);var p=r-n,g=a-o,y=p>g?p:g,v=(r+n)*.5,w=(a+o)*.5,C=[new wW({x:v-20*y,y:w-y,__sentinel:!0},{x:v,y:w+20*y,__sentinel:!0},{x:v+20*y,y:w-y,__sentinel:!0})],E=[],S=[],A;for(t=e.length;t--;){for(S.length=0,A=C.length;A--;){if(p=e[t].x-C[A].x,p>0&&p*p>C[A].r){E.push(C[A]),C.splice(A,1);continue}g=e[t].y-C[A].y,!(p*p+g*g>C[A].r)&&(S.push(C[A].a,C[A].b,C[A].b,C[A].c,C[A].c,C[A].a),C.splice(A,1))}for(D_e(S),A=S.length;A;)l=S[--A],u=S[--A],c=e[t],f=l.x-u.x,h=l.y-u.y,d=2*(f*(c.y-l.y)-h*(c.x-l.x)),Math.abs(d)>s&&C.push(new wW(u,l,c))}for(Array.prototype.push.apply(E,C),t=E.length;t--;)(E[t].a.__sentinel||E[t].b.__sentinel||E[t].c.__sentinel)&&E.splice(t,1);return E}function si(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.units,o=ao(e),a=ao(t),s=qa(a[1]-o[1]),u=qa(a[0]-o[0]),l=qa(o[1]),c=qa(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return WC(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r)}function ru(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return pY(e);case"FeatureCollection":return M_e(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return w3(e);default:throw new Error("unknown GeoJSON type")}}function pY(e){var t={type:"Feature"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}}),t.properties=mY(e.properties),t.geometry=w3(e.geometry),t}function mY(e){var t={};return e&&Object.keys(e).forEach(function(n){var r=e[n];typeof r=="object"?r===null?t[n]=null:r.length?t[n]=r.map(function(o){return o}):t[n]=mY(r):t[n]=r}),t}function M_e(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}}),t.features=e.features.map(function(n){return pY(n)}),t}function w3(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(function(n){return w3(n)}),t):(t.coordinates=gY(e.coordinates),t)}function gY(e){return typeof e[0]!="object"?e.slice():e.map(function(t){return gY(t)})}var L_e=function(e){return e},R_e=function(e){if(e==null)return L_e;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f);for(h[0]=(t+=u[0])*r+a,h[1]=(n+=u[1])*o+s;c<f;)h[c]=u[c],++c;return h}},O_e=function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n};function _Y(e,t){var n=R_e(e.transform),r=e.arcs;function o(f,h){h.length&&h.pop();for(var d=r[f<0?~f:f],p=0,g=d.length;p<g;++p)h.push(n(d[p],p));f<0&&O_e(h,g)}function a(f){return n(f)}function s(f){for(var h=[],d=0,p=f.length;d<p;++d)o(f[d],h);return h.length<2&&h.push(h[0]),h}function u(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function l(f){return f.map(u)}function c(f){var h=f.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":d=a(f.coordinates);break;case"MultiPoint":d=f.coordinates.map(a);break;case"LineString":d=s(f.arcs);break;case"MultiLineString":d=f.arcs.map(s);break;case"Polygon":d=l(f.arcs);break;case"MultiPolygon":d=f.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(t)}var N_e=function(e,t){var n={},r={},o={},a=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=t[++s],t[s]=c,t[f]=d)}),t.forEach(function(c){var f=u(c),h=f[0],d=f[1],p,g;if(p=o[h])if(delete o[p.end],p.push(c),p.end=d,g=r[d]){delete r[g.start];var y=g===p?p:p.concat(g);r[y.start=p.start]=o[y.end=g.end]=y}else r[p.start]=o[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(c),p.start=h,g=o[h]){delete o[g.end];var v=g===p?p:g.concat(p);r[v.start=g.start]=o[v.end=p.end]=v}else r[p.start]=o[p.end]=p;else p=[c],r[p.start=h]=o[p.end=d]=p});function u(c){var f=e.arcs[c<0?~c:c],h=f[0],d;return e.transform?(d=[0,0],f.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=f[f.length-1],c<0?[d,h]:[h,d]}function l(c,f){for(var h in c){var d=c[h];delete f[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),a.push(d)}}return l(o,r),l(r,o),t.forEach(function(c){n[c<0?~c:c]||a.push([c])}),a};function B_e(e){for(var t=-1,n=e.length,r,o=e[n-1],a=0;++t<n;)r=o,o=e[t],a+=r[0]*o[1]-r[1]*o[0];return Math.abs(a)}var F_e=function(e){return _Y(e,z_e.apply(this,arguments))};function z_e(e,t){var n={},r=[],o=[];t.forEach(a);function a(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(a);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(c){c.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),r.push(l)}function u(l){return B_e(_Y(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return r.forEach(function(l){if(!l._){var c=[],f=[l];for(l._=1,o.push(c);l=f.pop();)c.push(l),l.forEach(function(h){h.forEach(function(d){n[d<0?~d:d].forEach(function(p){p._||(p._=1,f.push(p))})})})}}),r.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:o.map(function(l){var c=[],f;if(l.forEach(function(y){y.forEach(function(v){v.forEach(function(w){n[w<0?~w:w].length<2&&c.push(w)})})}),c=N_e(e,c),(f=c.length)>1)for(var h=1,d=u(c[0]),p,g;h<f;++h)(p=u(c[h]))>d&&(g=c[0],c[0]=c[h],c[h]=g,d=p);return c})}}var V_e=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;function a(h){h!=null&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},Point:function(h){u(h.coordinates)},MultiPoint:function(h){h.coordinates.forEach(u)},LineString:function(h){l(h.arcs)},MultiLineString:function(h){h.arcs.forEach(l)},Polygon:function(h){h.arcs.forEach(l)},MultiPolygon:function(h){h.arcs.forEach(c)}};function u(h){var d=h[0],p=h[1];d<t&&(t=d),d>r&&(r=d),p<n&&(n=p),p>o&&(o=p)}function l(h){h.forEach(u)}function c(h){h.forEach(l)}for(var f in e)a(e[f]);return r>=t&&o>=n?[t,n,r,o]:void 0},k_e=function(e,t,n,r,o){arguments.length===3&&(r=Array,o=null);for(var a=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,u=0;u<e;++u)a[u]=o;function l(h){for(var d=t(h)&s,p=a[d],g=0;p!=o;){if(n(p,h))return!0;if(++g>=e)throw new Error("full hashset");p=a[d=d+1&s]}return a[d]=h,!0}function c(h){for(var d=t(h)&s,p=a[d],g=0;p!=o;){if(n(p,h))return!0;if(++g>=e)break;p=a[d=d+1&s]}return!1}function f(){for(var h=[],d=0,p=a.length;d<p;++d){var g=a[d];g!=o&&h.push(g)}return h}return{add:l,has:c,values:f}},E3=function(e,t,n,r,o,a){arguments.length===3&&(r=a=Array,o=null);for(var s=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new a(e),l=e-1,c=0;c<e;++c)s[c]=o;function f(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v]=y;if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=g,u[v]=y,y}function h(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v];if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=g,u[v]=y,y}function d(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v];if(++C>=e)break;w=s[v=v+1&l]}return y}function p(){for(var g=[],y=0,v=s.length;y<v;++y){var w=s[y];w!=o&&g.push(w)}return g}return{set:f,maybeSet:h,get:d,keys:p}},ly=function(e,t){return e[0]===t[0]&&e[1]===t[1]},yY=new ArrayBuffer(16),EW=new Float64Array(yY),bD=new Uint32Array(yY),Z2=function(e){EW[0]=e[0],EW[1]=e[1];var t=bD[0]^bD[1];return t=t<<5^t>>7^bD[2]^bD[3],t&2147483647},G_e=function(e){var t=e.coordinates,n=e.lines,r=e.rings,o=D(),a=new Int32Array(t.length),s=new Int32Array(t.length),u=new Int32Array(t.length),l=new Int8Array(t.length),c=0,f,h,d,p,g;for(f=0,h=t.length;f<h;++f)a[f]=s[f]=u[f]=-1;for(f=0,h=n.length;f<h;++f){var y=n[f],v=y[0],w=y[1];for(p=o[v],g=o[++v],++c,l[p]=1;++v<=w;)A(f,d=p,p=g,g=o[v]);++c,l[g]=1}for(f=0,h=t.length;f<h;++f)a[f]=-1;for(f=0,h=r.length;f<h;++f){var C=r[f],E=C[0]+1,S=C[1];for(d=o[S-1],p=o[E-1],g=o[E],A(f,d,p,g);++E<=S;)A(f,d=p,p=g,g=o[E])}function A(m,b,L,R){if(a[L]!==m){a[L]=m;var N=s[L];if(N>=0){var B=u[L];(N!==b||B!==R)&&(N!==R||B!==b)&&(++c,l[L]=1)}else s[L]=b,u[L]=R}}function D(){for(var m=E3(t.length*1.4,P,M,Int32Array,-1,Int32Array),b=new Int32Array(t.length),L=0,R=t.length;L<R;++L)b[L]=m.maybeSet(L,L);return b}function P(m){return Z2(t[m])}function M(m,b){return ly(t[m],t[b])}a=s=u=null;var I=k_e(c*1.4,Z2,ly),O;for(f=0,h=t.length;f<h;++f)l[O=o[f]]&&I.add(t[O]);return I},U_e=function(e){var t=G_e(e),n=e.coordinates,r=e.lines,o=e.rings,a,s,u;for(s=0,u=r.length;s<u;++s)for(var l=r[s],c=l[0],f=l[1];++c<f;)t.has(n[c])&&(a={0:c,1:l[1]},l[1]=c,l=l.next=a);for(s=0,u=o.length;s<u;++s)for(var h=o[s],d=h[0],p=d,g=h[1],y=t.has(n[d]);++p<g;)t.has(n[p])&&(y?(a={0:p,1:h[1]},h[1]=p,h=h.next=a):(H_e(n,d,g,g-p),n[g]=n[d],y=!0,p=d));return e};function H_e(e,t,n,r){N2(e,t,n),N2(e,t,t+r),N2(e,t+r,n)}function N2(e,t,n){for(var r=t+(n---t>>1),o;t<r;++t,--n)o=e[t],e[t]=e[n],e[n]=o}var q_e=function(e){var t=e.coordinates,n=e.lines,r,o=e.rings,a,s=n.length+o.length,u,l;for(delete e.lines,delete e.rings,u=0,l=n.length;u<l;++u)for(r=n[u];r=r.next;)++s;for(u=0,l=o.length;u<l;++u)for(a=o[u];a=a.next;)++s;var c=E3(s*2*1.4,Z2,ly),f=e.arcs=[];for(u=0,l=n.length;u<l;++u){r=n[u];do h(r);while(r=r.next)}for(u=0,l=o.length;u<l;++u)if(a=o[u],a.next)do h(a);while(a=a.next);else d(a);function h(C){var E,S,A,D,P,M,I,O;if(A=c.get(E=t[C[0]])){for(I=0,O=A.length;I<O;++I)if(D=A[I],p(D,C)){C[0]=D[0],C[1]=D[1];return}}if(P=c.get(S=t[C[1]])){for(I=0,O=P.length;I<O;++I)if(M=P[I],g(M,C)){C[1]=M[0],C[0]=M[1];return}}A?A.push(C):c.set(E,[C]),P?P.push(C):c.set(S,[C]),f.push(C)}function d(C){var E,S,A,D,P;if(S=c.get(E=t[C[0]]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}if(S=c.get(E=t[C[0]+w(C)]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}S?S.push(C):c.set(E,[C]),f.push(C)}function p(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,++A)if(!ly(t[S],t[A]))return!1;return!0}function g(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,--P)if(!ly(t[S],t[P]))return!1;return!0}function y(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var I=w(C),O=w(E),m=0;m<M;++m)if(!ly(t[S+(m+I)%M],t[A+(m+O)%M]))return!1;return!0}function v(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var I=w(C),O=M-w(E),m=0;m<M;++m)if(!ly(t[S+(m+I)%M],t[P-(m+O)%M]))return!1;return!0}function w(C){for(var E=C[0],S=C[1],A=E,D=A,P=t[A];++A<S;){var M=t[A];(M[0]<P[0]||M[0]===P[0]&&M[1]<P[1])&&(D=A,P=M)}return D-E}return e},W_e=function(e){for(var t=-1,n=e.length;++t<n;){for(var r=e[t],o=0,a=1,s=r.length,u=r[0],l=u[0],c=u[1],f,h;++o<s;)u=r[o],f=u[0],h=u[1],(f!==l||h!==c)&&(r[a++]=[f-l,h-c],l=f,c=h);a===1&&(r[a++]=[0,0]),r.length=a}return e},Y_e=function(e){var t=-1,n=[],r=[],o=[];function a(h){h&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},LineString:function(h){h.arcs=u(h.arcs)},MultiLineString:function(h){h.arcs=h.arcs.map(u)},Polygon:function(h){h.arcs=h.arcs.map(l)},MultiPolygon:function(h){h.arcs=h.arcs.map(c)}};function u(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var g={0:t-p+1,1:t};return n.push(g),g}function l(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var g={0:t-p+1,1:t};return r.push(g),g}function c(h){return h.map(l)}for(var f in e)a(e[f]);return{type:"Topology",coordinates:o,lines:n,rings:r,objects:e}},X_e=function(e){var t={},n;for(n in e)t[n]=j_e(e[n]);return t};function j_e(e){return e==null?{type:null}:(e.type==="FeatureCollection"?K_e:e.type==="Feature"?vY:T3)(e)}function K_e(e){var t={type:"GeometryCollection",geometries:e.features.map(vY)};return e.bbox!=null&&(t.bbox=e.bbox),t}function vY(e){var t=T3(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function T3(e){if(e==null)return{type:null};var t=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map(T3)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(t.bbox=e.bbox),t}var Z_e=function(e,t,n){var r=t[0],o=t[1],a=t[2],s=t[3],u=a-r?(n-1)/(a-r):1,l=s-o?(n-1)/(s-o):1;function c(w){return[Math.round((w[0]-r)*u),Math.round((w[1]-o)*l)]}function f(w,C){for(var E=-1,S=0,A=w.length,D=new Array(A),P,M,I,O,m;++E<A;)P=w[E],O=Math.round((P[0]-r)*u),m=Math.round((P[1]-o)*l),(O!==M||m!==I)&&(D[S++]=[M=O,I=m]);for(D.length=S;S<C;)S=D.push([D[0][0],D[0][1]]);return D}function h(w){return f(w,2)}function d(w){return f(w,4)}function p(w){return w.map(d)}function g(w){w!=null&&y.hasOwnProperty(w.type)&&y[w.type](w)}var y={GeometryCollection:function(w){w.geometries.forEach(g)},Point:function(w){w.coordinates=c(w.coordinates)},MultiPoint:function(w){w.coordinates=w.coordinates.map(c)},LineString:function(w){w.arcs=h(w.arcs)},MultiLineString:function(w){w.arcs=w.arcs.map(h)},Polygon:function(w){w.arcs=p(w.arcs)},MultiPolygon:function(w){w.arcs=w.arcs.map(p)}};for(var v in e)g(e[v]);return{scale:[1/u,1/l],translate:[r,o]}},Q_e=function(e,t){var n=V_e(e=X_e(e)),r=t>0&&n&&Z_e(e,n,t),o=q_e(U_e(Y_e(e))),a=o.coordinates,s=E3(o.arcs.length*1.4,J_e,$_e);e=o.objects,o.bbox=n,o.arcs=o.arcs.map(function(d,p){return s.set(d,p),a.slice(d[0],d[1]+1)}),delete o.coordinates,a=null;function u(d){d&&l.hasOwnProperty(d.type)&&l[d.type](d)}var l={GeometryCollection:function(d){d.geometries.forEach(u)},LineString:function(d){d.arcs=c(d.arcs)},MultiLineString:function(d){d.arcs=d.arcs.map(c)},Polygon:function(d){d.arcs=d.arcs.map(c)},MultiPolygon:function(d){d.arcs=d.arcs.map(f)}};function c(d){var p=[];do{var g=s.get(d);p.push(d[0]<d[1]?g:~g)}while(d=d.next);return p}function f(d){return d.map(c)}for(var h in e)u(e[h]);return r&&(o.transform=r,o.arcs=W_e(o.arcs)),o};function J_e(e){var t=e[0],n=e[1],r;return n<t&&(r=t,t=n,n=r),t+31*n}function $_e(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s;return r<n&&(s=n,n=r,r=s),a<o&&(s=o,o=a,a=s),n===o&&r===a}function eye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.mutate;if(Ri(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=ru(e));var r=[],o=x3(e,function(a,s){var u=tye(a,s);return u||(r.push(a),s)});return o&&r.push(o),r.length?r.length===1?r[0]:R0(r.map(function(a){return a.coordinates})):null}function ID(e){return e[0].toString()+","+e[1].toString()}function tye(e,t){var n=e.geometry.coordinates,r=t.geometry.coordinates,o=ID(n[0]),a=ID(n[n.length-1]),s=ID(r[0]),u=ID(r[r.length-1]),l;if(o===u)l=r.concat(n.slice(1));else if(s===a)l=n.concat(r.slice(1));else if(o===s)l=n.slice(1).reverse().concat(r);else if(a===u)l=n.concat(r.reverse().slice(1));else return null;return Li(l)}function nye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.mutate;if(Ri(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=ru(e));var r=[];ko(e,function(a){r.push(a.geometry)});var o=Q_e({geoms:m3(r).geometry});return F_e(o,o.objects.geoms.geometries)}function rye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.mutate;if(Ri(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=ru(e));var r=iye(e);if(!r)throw new Error("geojson must be homogenous");switch(r){case"LineString":return eye(e,t);case"Polygon":return nye(e,t);default:throw new Error(r+" is not supported")}}function iye(e){var t={};ko(e,function(r){t[r.geometry.type]=!0});var n=Object.keys(t);return n.length===1?n[0]:null}function oye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");if(!e)throw new Error("points is required");var n=t.maxEdge||1/0;if(!ui(n))throw new Error("maxEdge is invalid");var r=aye(e),o=dY(r);if(o.features=o.features.filter(function(s){var u=s.geometry.coordinates[0][0],l=s.geometry.coordinates[0][1],c=s.geometry.coordinates[0][2],f=si(u,l,t),h=si(l,c,t),d=si(u,c,t);return f<=n&&h<=n&&d<=n}),o.features.length<1)return null;var a=rye(o,t);return a.coordinates.length===1&&(a.coordinates=a.coordinates[0],a.type="Polygon"),ra(a)}function aye(e){var t=[],n={};return li(e,function(r){if(!!r.geometry){var o=r.geometry.coordinates.join("-");n.hasOwnProperty(o)||(t.push(r),n[o]=!0)}}),Bt(t)}function sye(e,t,n,r){var o=YC(6),a=t.features.map(function(s){return{minX:s.geometry.coordinates[0],minY:s.geometry.coordinates[1],maxX:s.geometry.coordinates[0],maxY:s.geometry.coordinates[1],property:s.properties[n]}});return o.load(a),e.features.forEach(function(s){s.properties||(s.properties={});var u=Ca(s),l=o.search({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}),c=[];l.forEach(function(f){_o([f.minX,f.minY],s)&&c.push(f.property)}),s.properties[r]=c}),e}function uye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.mutate;if(!e)throw new Error("geojson is required");return(n===!1||n===void 0)&&(e=ru(e)),Wa(e,function(r){var o=r[0],a=r[1];r[0]=a,r[1]=o}),e}function Um(e,t){var n=typeof t=="object"?t.mutate:t;if(!e)throw new Error("geojson is required");var r=Ri(e),o=[];switch(r){case"LineString":o=B2(e);break;case"MultiLineString":case"Polygon":wt(e).forEach(function(s){o.push(B2(s))});break;case"MultiPolygon":wt(e).forEach(function(s){var u=[];s.forEach(function(l){u.push(B2(l))}),o.push(u)});break;case"Point":return e;case"MultiPoint":var a={};wt(e).forEach(function(s){var u=s.join("-");a.hasOwnProperty(u)||(o.push(s),a[u]=!0)});break;default:throw new Error(r+" geometry not supported")}return e.coordinates?n===!0?(e.coordinates=o,e):{type:r,coordinates:o}:n===!0?(e.geometry.coordinates=o,e):ra({type:r,coordinates:o},e.properties,e.bbox,e.id)}function B2(e){var t=wt(e);if(t.length===2&&!lye(t[0],t[1]))return t;var n,r,o,a=[],s=t.length-1;a.push(t[0]);for(var u=1;u<s;u++)n=t[u-1],r=t[u],o=t[u+1],cye(n,o,r)||a.push(r);return a.push(o),a}function lye(e,t){return e[0]===t[0]&&e[1]===t[1]}function cye(e,t,n){var r=n[0],o=n[1],a=e[0],s=e[1],u=t[0],l=t[1],c=r-a,f=o-s,h=u-a,d=l-s,p=c*d-f*h;return p!==0?!1:Math.abs(h)>=Math.abs(d)?h>0?a<=r&&r<=u:u<=r&&r<=a:d>0?s<=o&&o<=l:l<=o&&o<=s}function fye(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function hye(e,t,n){var r=t.x,o=t.y,a=n.x-r,s=n.y-o;if(a!==0||s!==0){var u=((e.x-r)*a+(e.y-o)*s)/(a*a+s*s);u>1?(r=n.x,o=n.y):u>0&&(r+=a*u,o+=s*u)}return a=e.x-r,s=e.y-o,a*a+s*s}function dye(e,t){for(var n=e[0],r=[n],o,a=1,s=e.length;a<s;a++)o=e[a],fye(o,n)>t&&(r.push(o),n=o);return n!==o&&r.push(o),r}function Q2(e,t,n,r,o){for(var a=r,s,u=t+1;u<n;u++){var l=hye(e[u],e[t],e[n]);l>a&&(s=u,a=l)}a>r&&(s-t>1&&Q2(e,t,s,r,o),o.push(e[s]),n-s>1&&Q2(e,s,n,r,o))}function pye(e,t){var n=e.length-1,r=[e[0]];return Q2(e,0,n,t,r),r.push(e[n]),r}function J2(e,t,n){if(e.length<=2)return e;var r=t!==void 0?t*t:1;return e=n?e:dye(e,r),e=pye(e,r),e}function mye(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.tolerance!==void 0?t.tolerance:1,r=t.highQuality||!1,o=t.mutate||!1;if(!e)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return o!==!0&&(e=ru(e)),ih(e,function(a){gye(a,n,r)}),e}function gye(e,t,n){var r=e.type;if(r==="Point"||r==="MultiPoint")return e;Um(e,!0);var o=e.coordinates;switch(r){case"LineString":e.coordinates=TW(o,t,n);break;case"MultiLineString":e.coordinates=o.map(function(a){return TW(a,t,n)});break;case"Polygon":e.coordinates=SW(o,t,n);break;case"MultiPolygon":e.coordinates=o.map(function(a){return SW(a,t,n)})}return e}function TW(e,t,n){return J2(e.map(function(r){return{x:r[0],y:r[1],z:r[2]}}),t,n).map(function(r){return r.z?[r.x,r.y,r.z]:[r.x,r.y]})}function SW(e,t,n){return e.map(function(r){var o=r.map(function(s){return{x:s[0],y:s[1]}});if(o.length<4)throw new Error("invalid polygon");for(var a=J2(o,t,n).map(function(s){return[s.x,s.y]});!_ye(a);)t-=t*.01,a=J2(o,t,n).map(function(s){return[s.x,s.y]});return(a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),a})}function _ye(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var hP=function(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],r=this.points[t+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var n=this.centers[t],r=this.centers[t+1],o=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,a=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,s=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+s)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};hP.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var o=this.pos(r),a=Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)+(o.z-n.z)*(o.z-n.z));a>e&&(t.push(r),n=o)}return t};hP.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}};hP.prototype.pos=function(e){function t(s,u,l,c,f){var h=function(g){var y=g*g,v=y*g;return[v,3*y*(1-g),3*g*(1-g)*(1-g),(1-g)*(1-g)*(1-g)]},d=h(s),p={x:f.x*d[0]+c.x*d[1]+l.x*d[2]+u.x*d[3],y:f.y*d[0]+c.y*d[1]+l.y*d[2]+u.y*d[3],z:f.z*d[0]+c.z*d[1]+l.z*d[2]+u.z*d[3]};return p}var n=e-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);var r=n/this.duration;if(r>=1)return this.points[this.length-1];var o=Math.floor((this.points.length-1)*r),a=(this.length-1)*r-o;return t(a,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])};function AW(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.resolution||1e4,r=t.sharpness||.85;if(!e)throw new Error("line is required");if(!ui(n))throw new Error("resolution must be an number");if(!ui(r))throw new Error("sharpness must be an number");for(var o=[],a=new hP({points:Bl(e).coordinates.map(function(l){return{x:l[0],y:l[1]}}),duration:n,sharpness:r}),s=0;s<a.duration;s+=10){var u=a.pos(s);Math.floor(s/100)%2===0&&o.push([u.x,u.y])}return Li(o,e.properties)}function yye(e,t,n,r){return e=ru(e),t=ru(t),li(e,function(o){o.properties||(o.properties={}),li(t,function(a){o.properties[r]===void 0&&_o(o,a)&&(o.properties[r]=a.properties[n])})}),e}function vye(e,t){if(!e)throw new Error("featurecollection is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var n=Bt(Cye(e.features,t));return n}function Cye(e,t){for(var n=e.slice(0),r=e.length,o=r-t,a,s;r-- >o;)s=Math.floor((r+1)*Math.random()),a=n[s],n[s]=n[r],n[r]=a;return n.slice(o)}function S3(e){g1(e);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]),o=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[t,n],s=[t,o],u=[r,o],l=[r,n];return Dn([[a,l,u,s,a]])}function CY(e){return S3(Ca(e))}function xY(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=si(e.slice(0,2),[r,n]),s=si(e.slice(0,2),[t,o]);if(a>=s){var u=(n+o)/2;return[t,u-(r-t)/2,r,u+(r-t)/2]}else{var l=(t+r)/2;return[l-(o-n)/2,n,l+(o-n)/2,o]}}function xp(e,t,n,r){if(r=r||{},!pt(r))throw new Error("options is invalid");var o=r.units,a=r.properties,s=ao(e),u=qa(s[0]),l=qa(s[1]),c=qa(n),f=hy(t,o),h=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(c)),d=u+Math.atan2(Math.sin(c)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(h)),p=w0(d),g=w0(h);return Vr([p,g],a)}function A3(e,t,n){n=n||{};var r=n.steps||64,o=n.properties;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be a number");r=r||64,o=o||e.properties||{};for(var a=[],s=0;s<r;s++)a.push(xp(e,t,s*-360/r,n).geometry.coordinates);return a.push(a[0]),Dn([a],o)}function yp(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.final;if(r===!0)return xye(e,t);var o=ao(e),a=ao(t),s=qa(o[0]),u=qa(a[0]),l=qa(o[1]),c=qa(a[1]),f=Math.sin(u-s)*Math.cos(c),h=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-s);return w0(Math.atan2(f,h))}function xye(e,t){var n=yp(t,e);return n=(n+180)%360,n}function wye(e,t){var n=si(e,t),r=yp(e,t),o=xp(e,n/2,r);return o}function dP(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.properties;if(!e)throw new Error("geojson is required");var r=Ca(e),o=(r[0]+r[2])/2,a=(r[1]+r[3])/2;return Vr([o,a],n)}function py(e,t){var n=0,r=0,o=0;return Wa(e,function(a){n+=a[0],r+=a[1],o++},!0),Vr([n/o,r/o],t)}function wY(e,t){switch(Ri(e)){case"Point":return e;case"Polygon":var n=[];Wa(e,function(S){n.push(S)});var r=py(e,t),o=r.geometry.coordinates,a=0,s=0,u=0,l,c,f,h,d,p,g,y,v=n.map(function(S){return[S[0]-o[0],S[1]-o[1]]});for(l=0;l<n.length-1;l++)c=v[l],h=c[0],p=c[1],f=v[l+1],d=f[0],g=f[1],y=h*g-d*p,u+=y,a+=(h+d)*y,s+=(p+g)*y;if(u===0)return r;var w=u*.5,C=1/(6*w);return Vr([o[0]+C*a,o[1]+C*s],t);default:var E=hY(e);return E?wY(E,t):py(e,t)}}function Eye(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(t).reduce(function(o,a){return o[a.replace("Multi","")]=a,o},{});function r(o,a,s){s?t[a].coordinates=t[a].coordinates.concat(o.geometry.coordinates):t[a].coordinates.push(o.geometry.coordinates),t[a].properties.push(o.properties)}return li(e,function(o){!o.geometry||(t[o.geometry.type]?r(o,o.geometry.type,!0):n[o.geometry.type]&&r(o,n[o.geometry.type],!1))}),Bt(Object.keys(t).filter(function(o){return t[o].coordinates.length}).sort().map(function(o){var a={type:o,coordinates:t[o].coordinates},s={collectedProperties:t[o].properties};return ra(a,s)}))}function b3(e){var t=[];return e.type==="FeatureCollection"?li(e,function(n){Wa(n,function(r){t.push(Vr(r,n.properties))})}):Wa(e,function(n){t.push(Vr(n,e.properties))}),Bt(t)}var EY=pP,Tye=pP;function pP(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=TY(e,0,o,n,!0),s=[];if(!a)return s;var u,l,c,f,h,d,p;if(r&&(a=Dye(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var g=n;g<o;g+=n)h=e[g],d=e[g+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?1/p:0}return hT(a,s,n,u,l,p),s}function TY(e,t,n,r,o){var a,s;if(o===t3(e,t,n,r)>0)for(a=t;a<n;a+=r)s=bW(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=bW(a,e[a],e[a+1],s);return s&&cy(s,s.next)&&(pT(s),s=s.next),s}function fT(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(cy(n,n.next)||Ol(n.prev,n,n.next)===0)){if(pT(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function hT(e,t,n,r,o,a,s){if(!!e){!s&&a&&Rye(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?Aye(e,r,o,a):Sye(e)){t.push(l.i/n),t.push(e.i/n),t.push(c.i/n),pT(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=bye(e,t,n),hT(e,t,n,r,o,a,2)):s===2&&Iye(e,t,n,r,o,a):hT(fT(e),t,n,r,o,a,1);break}}}}function Sye(e){var t=e.prev,n=e,r=e.next;if(Ol(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(qD(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&Ol(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function Aye(e,t,n,r){var o=e.prev,a=e,s=e.next;if(Ol(o,a,s)>=0)return!1;for(var u=o.x<a.x?o.x<s.x?o.x:s.x:a.x<s.x?a.x:s.x,l=o.y<a.y?o.y<s.y?o.y:s.y:a.y<s.y?a.y:s.y,c=o.x>a.x?o.x>s.x?o.x:s.x:a.x>s.x?a.x:s.x,f=o.y>a.y?o.y>s.y?o.y:s.y:a.y>s.y?a.y:s.y,h=$2(u,l,t,n,r),d=$2(c,f,t,n,r),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&qD(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Ol(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&qD(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Ol(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function bye(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!cy(o,a)&&SY(o,r,r.next,a)&&dT(o,a)&&dT(a,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(a.i/n),pT(r),pT(r.next),r=e=a),r=r.next}while(r!==e);return r}function Iye(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&Bye(s,u)){var l=AY(s,u);s=fT(s,s.next),l=fT(l,l.next),hT(s,t,n,r,o,a),hT(l,t,n,r,o,a);return}u=u.next}s=s.next}while(s!==e)}function Dye(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=TY(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(Nye(c));for(o.sort(Pye),a=0;a<o.length;a++)Mye(o[a],n),n=fT(n,n.next);return n}function Pye(e,t){return e.x-t.x}function Mye(e,t){if(t=Lye(e,t),t){var n=AY(t,e);fT(n,n.next)}}function Lye(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a){if(a=u,u===r){if(o===n.y)return n;if(o===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(r===a)return s.prev;var l=s,c=s.x,f=s.y,h=1/0,d;for(n=s.next;n!==l;)r>=n.x&&n.x>=c&&r!==n.x&&qD(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),(d<h||d===h&&n.x>s.x)&&dT(n,e)&&(s=n,h=d)),n=n.next;return s}function Rye(e,t,n,r){var o=e;do o.z===null&&(o.z=$2(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,Oye(o)}function Oye(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function $2(e,t,n,r,o){return e=32767*(e-n)*o,t=32767*(t-r)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Nye(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function qD(e,t,n,r,o,a,s,u){return(o-s)*(t-u)-(e-s)*(a-u)>=0&&(e-s)*(r-u)-(n-s)*(t-u)>=0&&(n-s)*(a-u)-(o-s)*(r-u)>=0}function Bye(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Fye(e,t)&&dT(e,t)&&dT(t,e)&&zye(e,t)}function Ol(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function cy(e,t){return e.x===t.x&&e.y===t.y}function SY(e,t,n,r){return cy(e,t)&&cy(n,r)||cy(e,r)&&cy(n,t)?!0:Ol(e,t,n)>0!=Ol(e,t,r)>0&&Ol(n,r,e)>0!=Ol(n,r,t)>0}function Fye(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&SY(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function dT(e,t){return Ol(e.prev,e,e.next)<0?Ol(e,t,e.next)>=0&&Ol(e,e.prev,t)>=0:Ol(e,t,e.prev)<0||Ol(e,e.next,t)<0}function zye(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function AY(e,t){var n=new e3(e.i,e.x,e.y),r=new e3(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function bW(e,t,n,r){var o=new e3(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function pT(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function e3(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}pP.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(t3(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(t3(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,g=r[u+2]*n;h+=Math.abs((e[d]-e[g])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[g+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function t3(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}pP.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};EY.default=Tye;function Vye(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?t.features=IW(e.geometry.coordinates):e.geometry.coordinates.forEach(function(n){t.features=t.features.concat(IW(n))}),t}function IW(e){var t=kye(e),n=2,r=EY(t.vertices,t.holes,n),o=[],a=[];r.forEach(function(l,c){var f=r[c];a.push([t.vertices[f*n],t.vertices[f*n+1]])});for(var s=0;s<a.length;s+=3){var u=a.slice(s,s+3);u.push(a[s]),o.push(Dn([u]))}return o}function kye(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}function n3(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var n,r=1/0;return li(t,function(o,a){var s=si(e,o);s<r&&(n=ru(o),n.properties.featureIndex=a,n.properties.distanceToPoint=s,r=s)}),n}function Gye(e,t,n,r,o){bY(e,t,n||0,r||e.length-1,o||Uye)}function bY(e,t,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));bY(e,t,f,h,o)}var d=e[t],p=n,g=r;for(KE(e,n,t),o(e[r],d)>0&&KE(e,n,r);p<g;){for(KE(e,p,g),p++,g--;o(e[p],d)<0;)p++;for(;o(e[g],d)>0;)g--}o(e[n],d)===0?KE(e,n,g):(g++,KE(e,g,r)),g<=t&&(n=g+1),t<=g&&(r=g-1)}}function KE(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Uye(e,t){return e<t?-1:e>t?1:0}function jc(e,t){if(!(this instanceof jc))return new jc(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}jc.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!PD(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,PD(e,l)&&(t.leaf?n.push(u):z2(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!PD(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,PD(e,u)){if(t.leaf||z2(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=zC([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=Hye(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&z2(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:DW,compareMinY:PW,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=zC(e.slice(t,n+1)),BC(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=zC([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(MW(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),MW(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return BC(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=F2(s),c=qye(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),rT(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=zC(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,BC(n,this.toBBox),BC(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=zC([e,t]),this.data.height=e.height+1,this.data.leaf=!1,BC(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=nT(e,0,r,this.toBBox),a=nT(e,r,n,this.toBBox),s=Wye(o,a),u=F2(o)+F2(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:DW,o=e.leaf?this.compareMinY:PW,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=nT(e,0,t,o),s=nT(e,n-t,n,o),u=DD(a)+DD(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],rT(a,e.leaf?o(c):c),u+=DD(a);for(l=n-t-1;l>=t;l--)c=e.children[l],rT(s,e.leaf?o(c):c),u+=DD(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)rT(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():BC(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function Hye(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function BC(e,t){nT(e,0,e.children.length,t,e)}function nT(e,t,n,r,o){o||(o=zC(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],rT(o,e.leaf?r(s):s);return o}function rT(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function DW(e,t){return e.minX-t.minX}function PW(e,t){return e.minY-t.minY}function F2(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function DD(e){return e.maxX-e.minX+(e.maxY-e.minY)}function qye(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Wye(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function z2(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function PD(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function zC(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function MW(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,Gye(e,s,t,n,o),a.push(t,s,s,n))}function BT(e){var t=jc(e);return t.insert=function(n){if(Array.isArray(n)){var r=n;n=V2(r),n.bbox=r}else n.bbox=n.bbox?n.bbox:k2(n);return jc.prototype.insert.call(this,n)},t.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(o){var a=V2(o);a.bbox=o,r.push(a)}):li(n,function(o){o.bbox=o.bbox?o.bbox:k2(o),r.push(o)}),jc.prototype.load.call(this,r)},t.remove=function(n){if(Array.isArray(n)){var r=n;n=V2(r),n.bbox=r}return jc.prototype.remove.call(this,n)},t.clear=function(){return jc.prototype.clear.call(this)},t.search=function(n){var r=jc.prototype.search.call(this,this.toBBox(n));return{type:"FeatureCollection",features:r}},t.collides=function(n){return jc.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=jc.prototype.all.call(this);return{type:"FeatureCollection",features:n}},t.toJSON=function(){return jc.prototype.toJSON.call(this)},t.fromJSON=function(n){return jc.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var r;return n.bbox?r=n.bbox:Array.isArray(n)&&n.length===4?r=n:r=k2(n),{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},t}function V2(e){var t=[e[0],e[1]],n=[e[0],e[3]],r=[e[2],e[3]],o=[e[2],e[1]],a=[[t,o,r,n,t]];return{type:"Feature",bbox:e,properties:{},geometry:{type:"Polygon",coordinates:a}}}function k2(e){var t=[1/0,1/0,-1/0,-1/0];return Wa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function my(e){if(!e)throw new Error("geojson is required");var t=[];return ko(e,function(n){Yye(n,t)}),Bt(t)}function Yye(e,t){var n=[],r=e.geometry;switch(r.type){case"Polygon":n=wt(r);break;case"LineString":n=[wt(r)]}n.forEach(function(o){var a=Xye(o,e.properties);a.forEach(function(s){s.id=t.length,t.push(s)})})}function Xye(e,t){var n=[];return e.reduce(function(r,o){var a=Li([r,o],t);return a.bbox=jye(r,o),n.push(a),o}),n}function jye(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s=n<o?n:o,u=r<a?r:a,l=n>o?n:o,c=r>a?r:a;return[s,u,l,c]}function $m(e,t){var n={},r=[];if(e.type==="LineString"&&(e=ra(e)),t.type==="LineString"&&(t=ra(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var o=LW(e,t);return o&&r.push(o),Bt(r)}var a=BT();return a.load(my(t)),li(my(e),function(s){li(a.search(s),function(u){var l=LW(s,u);if(l){var c=wt(l).join(",");n[c]||(n[c]=!0,r.push(l))}})}),Bt(r)}function LW(e,t){var n=wt(e),r=wt(t);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],u=n[1][1],l=r[0][0],c=r[0][1],f=r[1][0],h=r[1][1],d=(h-c)*(s-o)-(f-l)*(u-a),p=(f-l)*(a-c)-(h-c)*(o-l),g=(s-o)*(a-c)-(u-a)*(o-l);if(d===0)return p===0&&g===0,null;var y=p/d,v=g/d;if(y>=0&&y<=1&&v>=0&&v<=1){var w=o+y*(s-o),C=a+y*(u-a);return Vr([w,C])}return null}function zm(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=e.geometry?e.geometry.type:e.type;if(r!=="LineString"&&r!=="MultiLineString")throw new Error("lines must be LineString or MultiLineString");var o=Vr([1/0,1/0],{dist:1/0}),a=0;return ko(e,function(s){for(var u=wt(s),l=0;l<u.length-1;l++){var c=Vr(u[l]);c.properties.dist=si(t,c,n);var f=Vr(u[l+1]);f.properties.dist=si(t,f,n);var h=si(c,f,n),d=Math.max(c.properties.dist,f.properties.dist),p=yp(c,f),g=xp(t,d,p+90,n),y=xp(t,d,p-90,n),v=$m(Li([g.geometry.coordinates,y.geometry.coordinates]),Li([c.geometry.coordinates,f.geometry.coordinates])),w=null;v.features.length>0&&(w=v.features[0],w.properties.dist=si(t,w,n),w.properties.location=a+si(c,w,n)),c.properties.dist<o.properties.dist&&(o=c,o.properties.index=l,o.properties.location=a),f.properties.dist<o.properties.dist&&(o=f,o.properties.index=l+1,o.properties.location=a+h),w&&w.properties.dist<o.properties.dist&&(o=w,o.properties.index=l),a+=h}}),o}function y0(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.final;if(!e)throw new Error("start point is required");if(!t)throw new Error("end point is required");var o;r?o=RW(ao(t),ao(e)):o=RW(ao(e),ao(t));var a=o>180?-(360-o):o;return a}function RW(e,t){var n=qa(e[1]),r=qa(t[1]),o=qa(t[0]-e[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),s=Math.atan2(o,a);return(w0(s)+360)%360}function mP(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("from point is required");if(!t)throw new Error("to point is required");var o=ao(e),a=ao(t);a[0]+=a[0]-o[0]>180?-360:o[0]-a[0]>180?360:0;var s=Kye(o,a),u=dy(s,"meters",r);return u}function Kye(e,t,n){n=n===void 0?os:Number(n);var r=n,o=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-o,u=Math.abs(t[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var l=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(l)>1e-11?s/l:Math.cos(o),f=Math.sqrt(s*s+c*c*u*u),h=f*r;return h}function v0(e,t){return IY(e,"mercator",t)}function gP(e,t){return IY(e,"wgs84",t)}function IY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&ui(e[0])?e=t==="mercator"?OW(e):NW(e):(r!==!0&&(e=ru(e)),Wa(e,function(o){var a=t==="mercator"?OW(o):NW(o);o[0]=a[0],o[1]=a[1]})),e}function OW(e){var t=Math.PI/180,n=6378137,r=20037508342789244e-9,o=Math.abs(e[0])<=180?e[0]:e[0]-Zye(e[0])*360,a=[n*o*t,n*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return a[0]>r&&(a[0]=r),a[0]<-r&&(a[0]=-r),a[1]>r&&(a[1]=r),a[1]<-r&&(a[1]=-r),a}function NW(e){var t=180/Math.PI,n=6378137;return[e[0]*t/n,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/n)))*t]}function Zye(e){return e<0?-1:e>0?1:0}var Qye=Object.freeze({toMercator:v0,toWgs84:gP});function DY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");if(!e)throw new Error("pt is required");if(Array.isArray(e)?e=Vr(e):e.type==="Point"?e=ra(e):lT(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=Li(t):t.type==="LineString"?t=ra(t):lT(t,"LineString","line");var r=1/0,o=e.geometry.coordinates;return Fm(t,function(a){var s=a.geometry.coordinates[0],u=a.geometry.coordinates[1],l=Jye(o,s,u,n);r>l&&(r=l)}),r}function Jye(e,t,n,r){var o=r.mercator,a=o!==!0?si(t,e,r):BW(t,e,r),s=_0(o!==!0?yp(t,e):y0(t,e)),u=_0(o!==!0?yp(t,n):y0(t,n)),l=Math.abs(s-u);if(l>90)return a;var c=(u+180)%360,f=_0(o!==!0?yp(n,e):y0(n,e)),h=Math.abs(f-c);return h>180&&(h=Math.abs(h-360)),h>90?o!==!0?si(e,n,r):BW(e,n,r):o!==!0?a*Math.sin(qa(l)):$ye(t,n,e,r)}function $ye(e,t,n,r){var o=0;(Math.abs(e[0])>=180||Math.abs(t[0])>=180||Math.abs(n[0])>=180)&&(o=e[0]>0||t[0]>0||n[0]>0?-180:180);var a=Vr(n),s=v0([e[0]+o,e[1]]),u=v0([t[0]+o,t[1]]),l=v0([n[0]+o,n[1]]),c=gP(eve(s,u,l));o!==0&&(c[0]-=o);var f=mP(a,c,r);return f}function eve(e,t,n){var r=e[0],o=e[1],a=t[0],s=t[1],u=n[0],l=n[1],c=a-r,f=s-o,h=c*c+f*f,d=((u-r)*c+(l-o)*f)/h,p=r+d*c,g=o+d*f;return[p,g]}function BW(e,t,n){var r=n.units,o=0;Math.abs(e[0])>=180&&(o=e[0]>0?-180:180),Math.abs(t[0])>=180&&(o=t[0]>0?-180:180);var a=v0([e[0]+o,e[1]]),s=v0([t[0]+o,t[1]]),u=function(f){return f*f},l=u(a[0]-s[0])+u(a[1]-s[1]),c=Math.sqrt(l);return dy(c,"meters",r)}function tve(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.units,o=n.properties||{};if(!e)throw new Error("points is required");if(e=nve(e),!e.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(Ri(t)!=="LineString")throw new Error("line must be a LineString");var a=1/0,s=null;return li(e,function(u){var l=DY(u,t,{units:r});l<a&&(a=l,s=u)}),s&&(s.properties=Object.assign({dist:a},s.properties,o)),s}function nve(e){var t=[],n=e.geometry?e.geometry.type:e.type;switch(n){case"GeometryCollection":return ih(e,function(r){r.type==="Point"&&t.push({type:"Feature",properties:{},geometry:r})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(r){return r.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}function rve(e,t){var n=ao(e),r=Bl(t),o=r.coordinates,a=o[0];if(a.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var s=t.properties||{},u=s.a,l=s.b,c=s.c,f=n[0],h=n[1],d=a[0][0],p=a[0][1],g=u!==void 0?u:a[0][2],y=a[1][0],v=a[1][1],w=l!==void 0?l:a[1][2],C=a[2][0],E=a[2][1],S=c!==void 0?c:a[2][2],A=(S*(f-d)*(h-v)+g*(f-y)*(h-E)+w*(f-C)*(h-p)-w*(f-d)*(h-E)-S*(f-y)*(h-p)-g*(f-C)*(h-v))/((f-d)*(h-v)+(f-y)*(h-E)+(f-C)*(h-p)-(f-d)*(h-E)-(f-y)*(h-p)-(f-C)*(h-v));return A}function ive(e){var t,n,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?n=e.geometry:n=e,n.type==="LineString")t=[n.coordinates];else if(n.type==="MultiLineString")t=n.coordinates;else if(n.type==="MultiPolygon")t=[].concat.apply([],n.coordinates);else if(n.type==="Polygon")t=n.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(o){t.forEach(function(a){for(var s=0;s<o.length-1;s++)for(var u=s;u<a.length-1;u++)if(!(o===a&&(Math.abs(s-u)===1||s===0&&u===o.length-2&&o[s][0]===o[o.length-1][0]&&o[s][1]===o[o.length-1][1]))){var l=ove(o[s][0],o[s][1],o[s+1][0],o[s+1][1],a[u][0],a[u][1],a[u+1][0],a[u+1][1]);l&&r.features.push(Vr([l[0],l[1]]))}})}),r}function ove(e,t,n,r,o,a,s,u){var l,c,f,h,d,p={x:null,y:null,onLine1:!1,onLine2:!1};return l=(u-a)*(n-e)-(s-o)*(r-t),l===0?p.x!==null&&p.y!==null?p:!1:(c=t-a,f=e-o,h=(s-o)*c-(u-a)*f,d=(n-e)*c-(r-t)*f,c=h/l,f=d/l,p.x=e+c*(n-e),p.y=t+c*(r-t),c>=0&&c<=1&&(p.onLine1=!0),f>=0&&f<=1&&(p.onLine2=!0),p.onLine1&&p.onLine2?[p.x,p.y]:!1)}function FW(e){for(var t=ave(e),n=dP(t),r=!1,o=0;!r&&o<t.features.length;){var a=t.features[o].geometry,s,u,l,c,f,h,d,p=!1;if(a.type==="Point")n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if(a.type==="MultiPoint"){var g=!1;for(d=0;!g&&d<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[d][0]&&n.geometry.coordinates[1]===a.coordinates[d][1]&&(r=!0,g=!0),d++}else if(a.type==="LineString")for(d=0;!p&&d<a.coordinates.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=a.coordinates[d][0],c=a.coordinates[d][1],f=a.coordinates[d+1][0],h=a.coordinates[d+1][1],zW(s,u,l,c,f,h)&&(p=!0,r=!0),d++;else if(a.type==="MultiLineString")for(var y=0;y<a.coordinates.length;){p=!1,d=0;for(var v=a.coordinates[y];!p&&d<v.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=v[d][0],c=v[d][1],f=v[d+1][0],h=v[d+1][1],zW(s,u,l,c,f,h)&&(p=!0,r=!0),d++;y++}else(a.type==="Polygon"||a.type==="MultiPolygon")&&_o(n,a)&&(r=!0);o++}if(r)return n;var w=Bt([]);for(o=0;o<t.features.length;o++)w.features=w.features.concat(b3(t.features[o]).features);return Vr(n3(n,w).geometry.coordinates)}function ave(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?Bt([ra(e)]):Bt([e]):e}function zW(e,t,n,r,o,a){var s=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r)),l=Math.sqrt((o-e)*(o-e)+(a-t)*(a-t));return s===u+l}function mT(e){return y3(e,function(t,n){return t+PY(n)},0)}var VW=6378137;function PY(e){var t=0,n;switch(e.type){case"Polygon":return kW(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=kW(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=PY(e.geometries[n]);return t}}function kW(e){var t=0;if(e&&e.length>0){t+=Math.abs(GW(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(GW(e[n]))}return t}function GW(e){var t,n,r,o,a,s,u,l=0,c=e.length;if(c>2){for(u=0;u<c;u++)u===c-2?(o=c-2,a=c-1,s=0):u===c-1?(o=c-1,a=0,s=1):(o=u,a=u+1,s=u+2),t=e[o],n=e[a],r=e[s],l+=(G2(r[0])-G2(t[0]))*Math.sin(G2(n[1]));l=l*VW*VW/2}return l}function G2(e){return e*Math.PI/180}function sve(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r;if(e.type==="Feature")r=e.geometry.coordinates;else if(e.type==="LineString")r=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");if(!ui(t))throw new Error("distance must be a number");for(var o=0,a=0;a<r.length&&!(t>=o&&a===r.length-1);a++)if(o>=t){var s=t-o;if(s){var u=yp(r[a],r[a-1])-180,l=xp(r[a],s,u,n);return l}else return Vr(r[a])}else o+=si(r[a],r[a+1],n);return Vr(r[r.length-1])}function r3(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");if(!e)throw new Error("geojson is required");return v3(e,function(n,r){var o=r.geometry.coordinates;return n+si(o[0],o[1],t)},0)}function uve(e,t,n){var r=wt(n);if(Ri(n)!=="LineString")throw new Error("line must be a LineString");var o=zm(n,e),a=zm(n,t),s;o.properties.index<=a.properties.index?s=[o,a]:s=[a,o];for(var u=[s[0].geometry.coordinates],l=s[0].properties.index+1;l<s[1].properties.index+1;l++)u.push(r[l]);return u.push(s[1].geometry.coordinates),Li(u,n.properties)}function MY(e,t,n,r){if(r=r||{},!pt(r))throw new Error("options is invalid");var o,a=[];if(e.type==="Feature")o=e.geometry.coordinates;else if(e.type==="LineString")o=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=0,u,l,c,f=0;f<o.length&&!(t>=s&&f===o.length-1);f++){if(s>t&&a.length===0){if(u=t-s,!u)return a.push(o[f]),Li(a);l=yp(o[f],o[f-1])-180,c=xp(o[f],u,l,r),a.push(c.geometry.coordinates)}if(s>=n)return u=n-s,u?(l=yp(o[f],o[f-1])-180,c=xp(o[f],u,l,r),a.push(c.geometry.coordinates),Li(a)):(a.push(o[f]),Li(a));if(s>=t&&a.push(o[f]),f===o.length-1)return Li(a);s+=si(o[f],o[f+1],r)}return Li(o[o.length-1])}function pc(e,t,n){n=n||{};var r=n.ignoreEndVertices;if(!pt(n))throw new Error("invalid options");if(!e)throw new Error("pt is required");if(!t)throw new Error("line is required");for(var o=ao(e),a=wt(t),s=0;s<a.length-1;s++){var u=!1;if(r&&(s===0&&(u="start"),s===a.length-2&&(u="end"),s===0&&s+1===a.length-1&&(u="both")),lve(a[s],a[s+1],o,u))return!0}return!1}function lve(e,t,n,r){var o=n[0],a=n[1],s=e[0],u=e[1],l=t[0],c=t[1],f=n[0]-s,h=n[1]-u,d=l-s,p=c-u,g=f*p-h*d;if(g!==0)return!1;if(r){if(r==="start")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<=l:l<=o&&o<s:p>0?u<a&&a<=c:c<=a&&a<u;if(r==="end")return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<l:l<o&&o<=s:p>0?u<=a&&a<c:c<a&&a<=u;if(r==="both")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<l:l<o&&o<s:p>0?u<a&&a<c:c<a&&a<u}else return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<=l:l<=o&&o<=s:p>0?u<=a&&a<=c:c<=a&&a<=u}function LY(e,t){var n=Ri(e),r=Ri(t),o=Bl(e),a=Bl(t);switch(n){case"Point":switch(r){case"MultiPoint":return cve(o,a);case"LineString":return pc(o,a,{ignoreEndVertices:!0});case"Polygon":return _o(o,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"MultiPoint":return fve(o,a);case"LineString":return hve(o,a);case"Polygon":return dve(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"LineString":return pve(o,a);case"Polygon":return mve(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Polygon":return gve(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function cve(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(OY(t.coordinates[n],e.coordinates)){r=!0;break}return r}function fve(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,o=0;o<t.coordinates.length;o++)OY(e.coordinates[n],t.coordinates[o])&&(r=!0);if(!r)return!1}return!0}function hve(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!pc(e.coordinates[r],t))return!1;n||(n=pc(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}function dve(e,t){for(var n=!0,r=!1,o=0;o<e.coordinates.length;o++){var a=_o(e.coordinates[1],t);if(!a){n=!1;break}r||(a=_o(e.coordinates[1],t,{ignoreBoundary:!0}))}return n&&a}function pve(e,t){for(var n=0;n<e.coordinates.length;n++)if(!pc(e.coordinates[n],t))return!1;return!0}function mve(e,t){var n=Ca(t),r=Ca(e);if(!RY(n,r))return!1;for(var o=!1,a=0;a<e.coordinates.length-1;a++){if(!_o(e.coordinates[a],t))return!1;if(o||(o=_o(e.coordinates[a],t,{ignoreBoundary:!0})),!o){var s=_ve(e.coordinates[a],e.coordinates[a+1]);o=_o(s,t,{ignoreBoundary:!0})}}return o}function gve(e,t){var n=Ca(e),r=Ca(t);if(!RY(r,n))return!1;for(var o=0;o<e.coordinates[0].length;o++)if(!_o(e.coordinates[0][o],t))return!1;return!0}function RY(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function OY(e,t){return e[0]===t[0]&&e[1]===t[1]}function _ve(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function NY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.mask,o=n.properties,a=[];if(t==null)throw new Error("cellSide is required");if(!ui(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(r&&["Polygon","MultiPolygon"].indexOf(Ri(r))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/si([s,u],[l,u],n),h=f*(l-s),d=t/si([s,u],[s,c],n),p=d*(c-u),g=l-s,y=c-u,v=Math.floor(g/h),w=Math.floor(y/p),C=(g-v*h)/2,E=(y-w*p)/2,S=s+C;S<=l;){for(var A=u+E;A<=c;){var D=Vr([S,A],o);r?LY(D,r)&&a.push(D):a.push(D),A+=p}S+=h}return Bt(a)}function VC(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.precision,r=t.coordinates,o=t.mutate;if(n=n==null||isNaN(n)?6:n,r=r==null||isNaN(r)?3:r,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(o===!1||o===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,n);return Wa(e,function(s){yve(s,a,r)}),e}function yve(e,t,n){e.length>n&&e.splice(n,e.length);for(var r=0;r<e.length;r++)e[r]=Math.round(e[r]*t)/t;return e}function vve(e){if(!e)throw new Error("geojson is required");var t=[];return ko(e,function(n){t.push(n)}),Bt(t)}function Cve(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.units,o=n.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var a=[];return ko(e,function(s){o&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),xve(s,t,r,function(u){a.push(u)})}),Bt(a)}function xve(e,t,n,r){var o=r3(e,{units:n});if(o<=t)return r(e);var a=o/t;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var u=MY(e,t*s,t*(s+1),{units:n});r(u,s)}}var wve=function(e,t,n){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");n===void 0&&(n=1);var r=e.geometry.coordinates,o=[],a={};if(n){for(var s=[],u=0;u<r.length;u++)for(var l=0;l<r[u].length-1;l++)s.push(v(u,l));var c=YC();c.load(s)}for(var f=0;f<r.length;f++)for(var h=0;h<r[f].length-1;h++)if(n){var d=c.search(v(f,h));d.forEach(function(w){var C=w.ring,E=w.edge;y(f,h,C,E)})}else for(var p=0;p<r.length;p++)for(var g=0;g<r[p].length-1;g++)y(f,h,p,g);return t||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function y(w,C,E,S){var A=r[w][C],D=r[w][C+1],P=r[E][S],M=r[E][S+1],I=Eve(A,D,P,M);if(I!==null){var O,m;if(D[0]!==A[0]?O=(I[0]-A[0])/(D[0]-A[0]):O=(I[1]-A[1])/(D[1]-A[1]),M[0]!==P[0]?m=(I[0]-P[0])/(M[0]-P[0]):m=(I[1]-P[1])/(M[1]-P[1]),!(O>=1||O<=0||m>=1||m<=0)){var b=I,L=!a[b];L&&(a[b]=!0),t?o.push(t(I,w,C,A,D,O,E,S,P,M,m,L)):o.push(I)}}}function v(w,C){var E=r[w][C],S=r[w][C+1],A,D,P,M;return E[0]<S[0]?(A=E[0],D=S[0]):(A=S[0],D=E[0]),E[1]<S[1]?(P=E[1],M=S[1]):(P=S[1],M=E[1]),{minX:A,minY:P,maxX:D,maxY:M,ring:w,edge:C}}};function Eve(e,t,n,r){if(iT(e,n)||iT(e,r)||iT(t,n)||iT(r,n))return null;var o=e[0],a=e[1],s=t[0],u=t[1],l=n[0],c=n[1],f=r[0],h=r[1],d=(o-s)*(c-h)-(a-u)*(l-f);if(d===0)return null;var p=((o*u-a*s)*(l-f)-(o-s)*(l*h-c*f))/d,g=((o*u-a*s)*(c-h)-(a-u)*(l*h-c*f))/d;return[p,g]}function iT(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!iT(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}var Tve=function(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,n=[],C=0;C<t;C++){var r=e.geometry.coordinates[C];oT(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!Ave(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,a=wve(e,function(pe,me,st,ht,jt,Ct,bt,mn,Tn,zi,at,Sn){return[pe,me,st,ht,jt,Ct,bt,mn,Tn,zi,at,Sn]}),s=a.length;if(s==0){for(var P=[],C=0;C<t;C++)P.push(Dn([e.geometry.coordinates[C]],{parent:-1,winding:Sve(e.geometry.coordinates[C])}));var k=Bt(P);return Z(),te(),k}for(var u=[],l=[],C=0;C<t;C++){u.push([]);for(var c=0;c<e.geometry.coordinates[C].length-1;c++)u[C].push([new UW(e.geometry.coordinates[C][(c+1).modulo(e.geometry.coordinates[C].length-1)],1,[C,c],[C,(c+1).modulo(e.geometry.coordinates[C].length-1)],void 0)]),l.push(new HW(e.geometry.coordinates[C][c],[C,(c-1).modulo(e.geometry.coordinates[C].length-1)],[C,c],void 0,void 0,!1,!0))}for(var C=0;C<s;C++)u[a[C][1]][a[C][2]].push(new UW(a[C][0],a[C][5],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0)),a[C][11]&&l.push(new HW(a[C][0],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0,void 0,!0,!0));for(var f=l.length,C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)u[C][c].sort(function(me,st){return me.param<st.param?-1:1});for(var h=[],C=0;C<f;C++)h.push({minX:l[C].coord[0],minY:l[C].coord[1],maxX:l[C].coord[0],maxY:l[C].coord[1],index:C});var d=YC();d.load(h);for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var g;p==u[C][c].length-1?g=u[C][(c+1).modulo(e.geometry.coordinates[C].length-1)][0].coord:g=u[C][c][p+1].coord;var y=d.search({minX:g[0],minY:g[1],maxX:g[0],maxY:g[1]})[0];u[C][c][p].nxtIsectAlongEdgeIn=y.index}for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var g=u[C][c][p].coord,y=d.search({minX:g[0],minY:g[1],maxX:g[0],maxY:g[1]})[0],v=y.index;v<o?l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn:oT(l[v].ringAndEdge1,u[C][c][p].ringAndEdgeIn)?l[v].nxtIsectAlongRingAndEdge1=u[C][c][p].nxtIsectAlongEdgeIn:l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn}for(var w=[],C=0,c=0;c<t;c++){for(var E=C,p=0;p<e.geometry.coordinates[c].length-1;p++)l[C].coord[0]<l[E].coord[0]&&(E=C),C++;for(var S=l[E].nxtIsectAlongRingAndEdge2,p=0;p<l.length;p++)if(l[p].nxtIsectAlongRingAndEdge1==E||l[p].nxtIsectAlongRingAndEdge2==E){var A=p;break}var D=FD([l[A].coord,l[E].coord,l[S].coord],!0)?1:-1;w.push({isect:E,parent:-1,winding:D})}w.sort(function(ue,pe){return l[ue.isect].coord>l[pe.isect].coord?-1:1});for(var P=[];w.length>0;){var M=w.pop(),I=M.isect,O=M.parent,m=M.winding,b=P.length,L=[l[I].coord],R=I;if(l[I].ringAndEdge1Walkable)var N=l[I].ringAndEdge1,B=l[I].nxtIsectAlongRingAndEdge1;else var N=l[I].ringAndEdge2,B=l[I].nxtIsectAlongRingAndEdge2;for(;!oT(l[I].coord,l[B].coord);){L.push(l[B].coord);for(var G=void 0,C=0;C<w.length;C++)if(w[C].isect==B){G=C;break}if(G!=null&&w.splice(G,1),oT(N,l[B].ringAndEdge1)){if(N=l[B].ringAndEdge2,l[B].ringAndEdge2Walkable=!1,l[B].ringAndEdge1Walkable){var F={isect:B};FD([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge2].coord],m==1)?(F.parent=O,F.winding=-m):(F.parent=b,F.winding=m),w.push(F)}R=B,B=l[B].nxtIsectAlongRingAndEdge2}else{if(N=l[B].ringAndEdge1,l[B].ringAndEdge1Walkable=!1,l[B].ringAndEdge2Walkable){var F={isect:B};FD([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge1].coord],m==1)?(F.parent=O,F.winding=-m):(F.parent=b,F.winding=m),w.push(F)}R=B,B=l[B].nxtIsectAlongRingAndEdge1}}L.push(l[B].coord),P.push(Dn([L],{index:b,parent:O,winding:m,netWinding:void 0}))}var k=Bt(P);Z(),te();function Z(){for(var ue=[],pe=0;pe<k.features.length;pe++)k.features[pe].properties.parent==-1&&ue.push(pe);if(ue.length>1)for(var pe=0;pe<ue.length;pe++){for(var me=-1,st=1/0,ht=0;ht<k.features.length;ht++)ue[pe]!=ht&&_o(k.features[ue[pe]].geometry.coordinates[0][0],k.features[ht],{ignoreBoundary:!0})&&mT(k.features[ht])<st&&(me=ht);k.features[ue[pe]].properties.parent=me}}function te(){for(var ue=0;ue<k.features.length;ue++)if(k.features[ue].properties.parent==-1){var pe=k.features[ue].properties.winding;k.features[ue].properties.netWinding=pe,oe(ue,pe)}}function oe(ue,pe){for(var me=0;me<k.features.length;me++)if(k.features[me].properties.parent==ue){var st=pe+k.features[me].properties.winding;k.features[me].properties.netWinding=st,oe(me,st)}}return k},UW=function(e,t,n,r,o){this.coord=e,this.param=t,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=o},HW=function(e,t,n,r,o,a,s){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=a,this.ringAndEdge2Walkable=s};function FD(e,t){if(typeof t>"u"&&(t=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var n=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return n>=0==t}function Sve(e){for(var t=0,n=0;n<e.length-1;n++)e[n][0]<e[t][0]&&(t=n);if(FD([e[(t-1).modulo(e.length-1)],e[t],e[(t+1).modulo(e.length-1)]],!0))var r=1;else var r=-1;return r}function oT(e,t){if(!e||!t||e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!oT(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}Number.prototype.modulo=function(e){return(this%e+e)%e};function Ave(e){for(var t={},n=1,r=0,o=e.length;r<o;++r){if(t.hasOwnProperty(e[r])){n=0;break}t[e[r]]=1}return n}function bve(e){var t=[];return ko(e,function(n){n.geometry.type==="Polygon"&&li(Tve(n),function(r){t.push(Dn(r.geometry.coordinates,n.properties))})}),Bt(t)}var qW=Math.PI/180,WW=180/Math.PI,gT=function(e,t){this.lon=e,this.lat=t,this.x=qW*e,this.y=qW*t};gT.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};gT.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new gT(t,e)};var BY=function(){this.coords=[],this.length=0};BY.prototype.move_to=function(e){this.length++,this.coords.push(e)};var I3=function(e){this.properties=e||{},this.geometries=[]};I3.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};I3.prototype.wkt=function(){for(var e="",t="LINESTRING(",n=function(a){t+=a[0]+" "+a[1]+","},r=0;r<this.geometries.length;r++){if(this.geometries[r].coords.length===0)return"LINESTRING(empty)";var o=this.geometries[r].coords;o.forEach(n),e+=t.substring(0,t.length-1)+")"}return e};var D3=function(e,t,n){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new gT(e.x,e.y),this.end=new gT(t.x,t.y),this.properties=n||{};var r=this.start.x-this.end.x,o=this.start.y-this.end.y,a=Math.pow(Math.sin(o/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};D3.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),n=Math.sin(e*this.g)/Math.sin(this.g),r=t*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=t*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=t*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=WW*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(o,2))),u=WW*Math.atan2(o,r);return[u,s]};D3.prototype.Arc=function(e,t){var n=[];if(!e||e<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(e-1),o=0;o<e;++o){var a=r*o,s=this.interpolate(a);n.push(s)}for(var u=!1,l=0,c=t&&t.offset?t.offset:10,f=180-c,h=-180+c,d=360-c,p=1;p<n.length;++p){var g=n[p-1][0],y=n[p][0],v=Math.abs(y-g);v>d&&(y>f&&g<h||g>f&&y<h)?u=!0:v>l&&(l=v)}var w=[];if(u&&l<c){var C=[];w.push(C);for(var E=0;E<n.length;++E){var S=parseFloat(n[E][0]);if(E>0&&Math.abs(S-n[E-1][0])>d){var A=parseFloat(n[E-1][0]),D=parseFloat(n[E-1][1]),P=parseFloat(n[E][0]),M=parseFloat(n[E][1]);if(A>-180&&A<h&&P===180&&E+1<n.length&&n[E-1][0]>-180&&n[E-1][0]<h){C.push([-180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}else if(A>f&&A<180&&P===-180&&E+1<n.length&&n[E-1][0]>f&&n[E-1][0]<180){C.push([180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}if(A<h&&P>f){var I=A;A=P,P=I;var O=D;D=M,M=O}if(A>f&&P<h&&(P+=360),A<=180&&P>=180&&A<P){var m=(180-A)/(P-A),b=m*M+(1-m)*D;C.push([n[E-1][0]>f?180:-180,b]),C=[],C.push([n[E-1][0]>f?-180:180,b]),w.push(C)}else C=[],w.push(C);C.push([S,n[E][1]])}else C.push([n[E][0],n[E][1]])}}else{var L=[];w.push(L);for(var R=0;R<n.length;++R)L.push([n[R][0],n[R][1]])}for(var N=new I3(this.properties),B=0;B<w.length;++B){var G=new BY;N.geometries.push(G);for(var F=w[B],k=0;k<F.length;++k)G.move_to(F[k])}return N};function Ive(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.properties,o=n.npoints,a=n.offset;e=ao(e),t=ao(t),r=r||{},o=o||100,a=a||10;var s=new D3({x:e[0],y:e[1]},{x:t[0],y:t[1]},r),u=s.Arc(o,{offset:a});return u.json()}function Dve(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=Ri(e),r=Ri(t);if(n!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var o=VC(t,{precision:7});switch(r){case"Point":return i3(e,o);case"MultiPoint":return YW(e,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return YW(e,$m(e,o))}}function YW(e,t){var n=[],r=BT();return ko(t,function(o){if(n.forEach(function(u,l){u.id=l}),!n.length)n=i3(e,o).features,n.forEach(function(u){u.bbox||(u.bbox=xY(Ca(u)))}),r.load(Bt(n));else{var a=r.search(o);if(a.features.length){var s=FY(o,a);n=n.filter(function(u){return u.id!==s.id}),r.remove(s),li(i3(s,o),function(u){n.push(u),r.insert(u)})}}}),Bt(n)}function i3(e,t){var n=[],r=wt(e)[0],o=wt(e)[e.geometry.coordinates.length-1];if(U2(r,ao(t))||U2(o,ao(t)))return Bt([e]);var a=BT(),s=my(e);a.load(s);var u=a.search(t);if(!u.features.length)return Bt([e]);var l=FY(t,u),c=[r],f=_3(s,function(h,d,p){var g=wt(d)[1],y=ao(t);return p===l.id?(h.push(y),n.push(Li(h)),U2(y,g)?[y]:[y,g]):(h.push(g),h)},c);return f.length>1&&n.push(Li(f)),Bt(n)}function FY(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,r=1/0;return li(t,function(o){var a=zm(o,e),s=a.properties.dist;s<r&&(n=o,r=s)}),n}function U2(e,t){return e[0]===t[0]&&e[1]===t[1]}function zY(e,t,n,r,o){if(o=o||{},!pt(o))throw new Error("options is invalid");var a=o.steps,s=o.units;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(typeof o!="object")throw new Error("options must be an object");a=a||64;var u=XW(n),l=XW(r),c=e.properties;if(u===l)return Li(A3(e,t,o).geometry.coordinates[0],c);for(var f=u,h=u<l?l:l+360,d=f,p=[],g=0;d<h;)p.push(xp(e,t,d,s).geometry.coordinates),g++,d=f+g*360/a;return d>h&&p.push(xp(e,t,h,s).geometry.coordinates),Li(p,c)}function XW(e){var t=e%360;return t<0&&(t+=360),t}function WD(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.properties,r=Ri(e),o=wt(e);if(n=n||e.properties||{},!o.length)throw new Error("polygon must contain coordinates");switch(r){case"Polygon":return jW(o,n);case"MultiPolygon":var a=[];return o.forEach(function(s){a.push(jW(s,n))}),Bt(a);default:throw new Error("geom "+r+" not supported")}}function jW(e,t){return e.length>1?R0(e,t):Li(e[0],t)}function KW(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.properties,r=t.autoComplete,o=t.orderCoords;if(!e)throw new Error("lines is required");r=r!==void 0?r:!0,o=o!==void 0?o:!0;var a=Ri(e);switch(a){case"FeatureCollection":case"GeometryCollection":var s=[],u=e.features?e.features:e.geometries;return u.forEach(function(l){s.push(wt(ZW(l,{},r,o)))}),m1(s,n)}return ZW(e,n,r,o)}function ZW(e,t,n,r){t=t||e.properties||{};var o=wt(e),a=Ri(e);if(!o.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(o=QW(o)),Dn([o],t);case"MultiLineString":var s=[],u=0;return o.forEach(function(l){if(n&&(l=QW(l)),r){var c=Pve(Ca(Li(l)));c>u?(s.unshift(l),u=c):s.push(l)}else s.push(l)}),Dn(s,t);default:throw new Error("geometry type "+a+" is not supported")}}function QW(e){var t=e[0],n=t[0],r=t[1],o=e[e.length-1],a=o[0],s=o[1];return(n!==a||r!==s)&&e.push(t),e}function Pve(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.abs(t-r)*Math.abs(n-o)}var VY=YD;YD.polyline=YD;YD.polygon=Mve;function YD(e,t,n){var r=e.length,o=kC(e[0],t),a=[],s,u,l,c,f;for(n||(n=[]),s=1;s<r;s++){for(u=e[s-1],l=e[s],c=f=kC(l,t);;)if(o|c){if(o&c)break;o?(u=o3(u,l,o,t),o=kC(u,t)):(l=o3(u,l,c,t),c=kC(l,t))}else{a.push(u),c!==f?(a.push(l),s<r-1&&(n.push(a),a=[])):s===r-1&&a.push(l);break}o=f}return a.length&&n.push(a),n}function Mve(e,t){var n,r,o,a,s,u,l;for(r=1;r<=8;r*=2){for(n=[],o=e[e.length-1],a=!(kC(o,t)&r),s=0;s<e.length;s++)u=e[s],l=!(kC(u,t)&r),l!==a&&n.push(o3(o,u,r,t)),l&&n.push(u),o=u,a=l;if(e=n,!e.length)break}return n}function o3(e,t,n,r){return n&8?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:n&4?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:n&2?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:n&1?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function kC(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Lve(e,t){var n=Rve(e),r=wt(e),o=e.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return n==="LineString"&&(r=[r]),r.forEach(function(s){VY(s,t,a)}),a.length===1?Li(a[0],o):R0(a,o);case"Polygon":return Dn(JW(r,t),o);case"MultiPolygon":return m1(r.map(function(s){return JW(s,t)}),o);default:throw new Error("geometry "+n+" not supported")}}function JW(e,t){for(var n=[],r=0;r<e.length;r++){var o=VY.polygon(e[r],t);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&n.push(o))}return n}function Rve(e){return e.geometry?e.geometry.type:e.type}var $W=Array.prototype.slice;function e7(e){return Object.prototype.toString.call(e)==="[object Arguments]"}function fy(e,t,n){return n||(n={}),e===t?!0:e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||typeof e!="object"&&typeof t!="object"?(n.strict,e===t):Ove(e,t,n)}function t7(e){return e==null}function n7(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function Ove(e,t,n){var r,o;if(t7(e)||t7(t)||e.prototype!==t.prototype)return!1;if(e7(e))return e7(t)?(e=$W.call(e),t=$W.call(t),fy(e,t,n)):!1;if(n7(e)){if(!n7(t)||e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}try{var a=Object.keys(e),s=Object.keys(t)}catch{return!1}if(a.length!==s.length)return!1;for(a.sort(),s.sort(),r=a.length-1;r>=0;r--)if(a[r]!==s[r])return!1;for(r=a.length-1;r>=0;r--)if(o=a[r],!fy(e[o],t[o],n))return!1;return typeof e==typeof t}function kY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.tolerance||0,o=[],a=BT();a.load(my(e));var s;return Fm(t,function(u){var l=!1;li(a.search(u),function(c){if(l===!1){var f=wt(u).sort(),h=wt(c).sort();fy(f,h)||(r===0?pc(f[0],c)&&pc(f[1],c):zm(c,f[0]).properties.dist<=r&&zm(c,f[1]).properties.dist<=r)?(l=!0,s?s=H2(s,u):s=u):(r===0?pc(h[0],u)&&pc(h[1],u):zm(u,h[0]).properties.dist<=r&&zm(u,h[1]).properties.dist<=r)&&(s?s=H2(s,c):s=c)}}),l===!1&&s&&(o.push(s),s=void 0)}),s&&o.push(s),Bt(o)}function H2(e,t){var n=wt(t),r=wt(e),o=r[0],a=r[r.length-1],s=e.geometry.coordinates;return fy(n[0],o)?s.unshift(n[1]):fy(n[0],a)?s.push(n[1]):fy(n[1],o)?s.unshift(n[0]):fy(n[1],a)&&s.push(n[0]),e}function Nve(e,t,n,r,o){if(o=o||{},!pt(o))throw new Error("options is invalid");if(!e)throw new Error("center is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof o!="object")throw new Error("options must be an object");if(r7(n)===r7(r))return A3(e,t,o);var a=wt(e),s=zY(e,t,n,r,o),u=[[a]];return Wa(s,function(l){u[0].push(l)}),u[0].push(a),Dn(u)}function r7(e){var t=e%360;return t<0&&(t+=360),t}function XC(e,t,n,r){if(r=r||{},!pt(r))throw new Error("options is invalid");var o=r.units,a=r.properties;if(!e)throw new Error("origin is required");if(t==null)throw new Error("distance is required");if(n==null)throw new Error("bearing is required");if(!(t>=0))throw new Error("distance must be greater than 0");var s=dy(t,o,"meters"),u=ao(e),l=Bve(u,s,n);return l[0]+=l[0]-u[0]>180?-360:u[0]-l[0]>180?360:0,Vr(l,a)}function Bve(e,t,n,r){r=r===void 0?os:Number(r);var o=t/r,a=e[0]*Math.PI/180,s=qa(e[1]),u=qa(n),l=o*Math.cos(u),c=s+l;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var f=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(f)>1e-11?l/f:Math.cos(s),d=o*Math.sin(u)/h,p=a+d;return[(p*180/Math.PI+540)%360-180,c*180/Math.PI]}function Fve(e,t){var n=wt(e),r=wt(t),o,a,s,u,l=Ri(t);switch(l){case"Polygon":o=r[0][0],a=r[0][0],u=_T(r[0][0],r[0][r[0].length-1],n);var c=i7(r[0],n,u,s,o,a);o=c[0],a=c[1];break;case"MultiPolygon":o=r[0][0][0],a=r[0][0][0],u=_T(r[0][0][0],r[0][0][r[0][0].length-1],n),r.forEach(function(f){var h=i7(f[0],n,u,s,o,a);o=h[0],a=h[1]});break}return Bt([Vr(o),Vr(a)])}function i7(e,t,n,r,o,a){for(var s=0;s<e.length;s++){var u=e[s],l=e[s+1];s===e.length-1&&(l=e[0]),r=_T(u,l,t),n<=0&&r>0?Vve(t,u,o)||(o=u):n>0&&r<=0&&(zve(t,u,a)||(a=u)),n=r}return[o,a]}function zve(e,t,n){return _T(e,t,n)>0}function Vve(e,t,n){return _T(e,t,n)<0}function _T(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function XD(e){if(!e)throw new Error("line is required");var t=e.geometry?e.geometry.type:e.type;if(!Array.isArray(e)&&t!=="LineString")throw new Error("geometry must be a LineString");for(var n=wt(e),r=0,o=1,a,s;o<n.length;)a=s||n[0],s=n[o],r+=(s[0]-a[0])*(s[1]+a[1]),o++;return r>0}function kve(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.reverse||!1,r=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(e=ru(e));var o=[];switch(e.type){case"GeometryCollection":return ih(e,function(a){zD(a,n)}),e;case"FeatureCollection":return li(e,function(a){li(zD(a,n),function(s){o.push(s)})}),Bt(o)}return zD(e,n)}function zD(e,t){var n=e.type==="Feature"?e.geometry.type:e.type;switch(n){case"GeometryCollection":return ih(e,function(r){zD(r,t)}),e;case"LineString":return o7(wt(e),t),e;case"Polygon":return a7(wt(e),t),e;case"MultiLineString":return wt(e).forEach(function(r){o7(r,t)}),e;case"MultiPolygon":return wt(e).forEach(function(r){a7(r,t)}),e;case"Point":case"MultiPoint":return e}}function o7(e,t){XD(e)===t&&e.reverse()}function a7(e,t){XD(e[0])!==t&&e[0].reverse();for(var n=1;n<e.length;n++)XD(e[n])===t&&e[n].reverse()}function Gve(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;xd(e,"Point","input must contain Points");for(var a=Uve(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function Uve(e,t){var n={};li(e,function(a){var s=wt(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return wt(l)[0]-wt(c)[0]});return u}),o=r.sort(function(a,s){return t?wt(a[0])[1]-wt(s[0])[1]:wt(s[0])[1]-wt(a[0])[1]});return o}/*!
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var s7={successCallback:null,verbose:!1,polygons:!1},uy={};function Hve(e,t,n,r){r=r||{};for(var o=Object.keys(s7),a=0;a<o.length;a++){var s=o[a],u=r[s];u=typeof u<"u"&&u!==null?u:s7[s],uy[s]=u}uy.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n)+"]");var l=wCe(e,t,n),c;return uy.polygons?(uy.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),c=ICe(l)):(uy.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),c=ECe(l)),typeof uy.successCallback=="function"&&uy.successCallback(c),c}var Lu=64,Wf=16,Ms=4,Qs=1,Pn=[],Mn=[],Ln=[],Rn=[],On=[],Nn=[],Bn=[],Fn=[],zn=[],Vn=[],kn=[],Gn=[],Un=[],Hn=[],qn=[],Wn=[],Yn=[],Xn=[],jn=[],Kn=[],Zn=[],Qn=[],Jn=[],$n=[];Bn[85]=Vn[85]=-1;Fn[85]=kn[85]=0;zn[85]=Gn[85]=1;jn[85]=Qn[85]=1;Kn[85]=Jn[85]=0;Zn[85]=$n[85]=1;Pn[85]=Rn[85]=0;Mn[85]=On[85]=-1;Ln[85]=qn[85]=0;Wn[85]=Un[85]=0;Yn[85]=Hn[85]=1;Nn[85]=Xn[85]=1;Qn[1]=Qn[169]=0;Jn[1]=Jn[169]=-1;$n[1]=$n[169]=0;Un[1]=Un[169]=-1;Hn[1]=Hn[169]=0;qn[1]=qn[169]=0;Vn[4]=Vn[166]=0;kn[4]=kn[166]=-1;Gn[4]=Gn[166]=1;Wn[4]=Wn[166]=1;Yn[4]=Yn[166]=0;Xn[4]=Xn[166]=0;Bn[16]=Bn[154]=0;Fn[16]=Fn[154]=1;zn[16]=zn[154]=1;Rn[16]=Rn[154]=1;On[16]=On[154]=0;Nn[16]=Nn[154]=1;jn[64]=jn[106]=0;Kn[64]=Kn[106]=1;Zn[64]=Zn[106]=0;Pn[64]=Pn[106]=-1;Mn[64]=Mn[106]=0;Ln[64]=Ln[106]=1;jn[2]=jn[168]=0;Kn[2]=Kn[168]=-1;Zn[2]=Zn[168]=1;Qn[2]=Qn[168]=0;Jn[2]=Jn[168]=-1;$n[2]=$n[168]=0;Un[2]=Un[168]=-1;Hn[2]=Hn[168]=0;qn[2]=qn[168]=0;Wn[2]=Wn[168]=-1;Yn[2]=Yn[168]=0;Xn[2]=Xn[168]=1;Bn[8]=Bn[162]=0;Fn[8]=Fn[162]=-1;zn[8]=zn[162]=0;Vn[8]=Vn[162]=0;kn[8]=kn[162]=-1;Gn[8]=Gn[162]=1;Un[8]=Un[162]=1;Hn[8]=Hn[162]=0;qn[8]=qn[162]=1;Wn[8]=Wn[162]=1;Yn[8]=Yn[162]=0;Xn[8]=Xn[162]=0;Bn[32]=Bn[138]=0;Fn[32]=Fn[138]=1;zn[32]=zn[138]=1;Vn[32]=Vn[138]=0;kn[32]=kn[138]=1;Gn[32]=Gn[138]=0;Pn[32]=Pn[138]=1;Mn[32]=Mn[138]=0;Ln[32]=Ln[138]=0;Rn[32]=Rn[138]=1;On[32]=On[138]=0;Nn[32]=Nn[138]=1;Qn[128]=Qn[42]=0;Jn[128]=Jn[42]=1;$n[128]=$n[42]=1;jn[128]=jn[42]=0;Kn[128]=Kn[42]=1;Zn[128]=Zn[42]=0;Pn[128]=Pn[42]=-1;Mn[128]=Mn[42]=0;Ln[128]=Ln[42]=1;Rn[128]=Rn[42]=-1;On[128]=On[42]=0;Nn[128]=Nn[42]=0;Vn[5]=Vn[165]=-1;kn[5]=kn[165]=0;Gn[5]=Gn[165]=0;Qn[5]=Qn[165]=1;Jn[5]=Jn[165]=0;$n[5]=$n[165]=0;Wn[20]=Wn[150]=0;Yn[20]=Yn[150]=1;Xn[20]=Xn[150]=1;Rn[20]=Rn[150]=0;On[20]=On[150]=-1;Nn[20]=Nn[150]=1;Bn[80]=Bn[90]=-1;Fn[80]=Fn[90]=0;zn[80]=zn[90]=1;jn[80]=jn[90]=1;Kn[80]=Kn[90]=0;Zn[80]=Zn[90]=1;Un[65]=Un[105]=0;Hn[65]=Hn[105]=1;qn[65]=qn[105]=0;Pn[65]=Pn[105]=0;Mn[65]=Mn[105]=-1;Ln[65]=Ln[105]=0;Bn[160]=Bn[10]=-1;Fn[160]=Fn[10]=0;zn[160]=zn[10]=1;Vn[160]=Vn[10]=-1;kn[160]=kn[10]=0;Gn[160]=Gn[10]=0;Qn[160]=Qn[10]=1;Jn[160]=Jn[10]=0;$n[160]=$n[10]=0;jn[160]=jn[10]=1;Kn[160]=Kn[10]=0;Zn[160]=Zn[10]=1;Wn[130]=Wn[40]=0;Yn[130]=Yn[40]=1;Xn[130]=Xn[40]=1;Un[130]=Un[40]=0;Hn[130]=Hn[40]=1;qn[130]=qn[40]=0;Pn[130]=Pn[40]=0;Mn[130]=Mn[40]=-1;Ln[130]=Ln[40]=0;Rn[130]=Rn[40]=0;On[130]=On[40]=-1;Nn[130]=Nn[40]=1;Vn[37]=Vn[133]=0;kn[37]=kn[133]=1;Gn[37]=Gn[133]=1;Qn[37]=Qn[133]=0;Jn[37]=Jn[133]=1;$n[37]=$n[133]=0;Pn[37]=Pn[133]=-1;Mn[37]=Mn[133]=0;Ln[37]=Ln[133]=0;Rn[37]=Rn[133]=1;On[37]=On[133]=0;Nn[37]=Nn[133]=0;Wn[148]=Wn[22]=-1;Yn[148]=Yn[22]=0;Xn[148]=Xn[22]=0;Qn[148]=Qn[22]=0;Jn[148]=Jn[22]=-1;$n[148]=$n[22]=1;jn[148]=jn[22]=0;Kn[148]=Kn[22]=1;Zn[148]=Zn[22]=1;Rn[148]=Rn[22]=-1;On[148]=On[22]=0;Nn[148]=Nn[22]=1;Bn[82]=Bn[88]=0;Fn[82]=Fn[88]=-1;zn[82]=zn[88]=1;Wn[82]=Wn[88]=1;Yn[82]=Yn[88]=0;Xn[82]=Xn[88]=1;Un[82]=Un[88]=-1;Hn[82]=Hn[88]=0;qn[82]=qn[88]=1;jn[82]=jn[88]=0;Kn[82]=Kn[88]=-1;Zn[82]=Zn[88]=0;Bn[73]=Bn[97]=0;Fn[73]=Fn[97]=1;zn[73]=zn[97]=0;Vn[73]=Vn[97]=0;kn[73]=kn[97]=-1;Gn[73]=Gn[97]=0;Un[73]=Un[97]=1;Hn[73]=Hn[97]=0;qn[73]=qn[97]=0;Pn[73]=Pn[97]=1;Mn[73]=Mn[97]=0;Ln[73]=Ln[97]=1;Bn[145]=Bn[25]=0;Fn[145]=Fn[25]=-1;zn[145]=zn[25]=0;Un[145]=Un[25]=1;Hn[145]=Hn[25]=0;qn[145]=qn[25]=1;Qn[145]=Qn[25]=0;Jn[145]=Jn[25]=1;$n[145]=$n[25]=1;Rn[145]=Rn[25]=-1;On[145]=On[25]=0;Nn[145]=Nn[25]=0;Vn[70]=Vn[100]=0;kn[70]=kn[100]=1;Gn[70]=Gn[100]=0;Wn[70]=Wn[100]=-1;Yn[70]=Yn[100]=0;Xn[70]=Xn[100]=1;jn[70]=jn[100]=0;Kn[70]=Kn[100]=-1;Zn[70]=Zn[100]=1;Pn[70]=Pn[100]=1;Mn[70]=Mn[100]=0;Ln[70]=Ln[100]=0;Vn[101]=Vn[69]=0;kn[101]=kn[69]=1;Gn[101]=Gn[69]=0;Pn[101]=Pn[69]=1;Mn[101]=Mn[69]=0;Ln[101]=Ln[69]=0;Qn[149]=Qn[21]=0;Jn[149]=Jn[21]=1;$n[149]=$n[21]=1;Rn[149]=Rn[21]=-1;On[149]=On[21]=0;Nn[149]=Nn[21]=0;Wn[86]=Wn[84]=-1;Yn[86]=Yn[84]=0;Xn[86]=Xn[84]=1;jn[86]=jn[84]=0;Kn[86]=Kn[84]=-1;Zn[86]=Zn[84]=1;Bn[89]=Bn[81]=0;Fn[89]=Fn[81]=-1;zn[89]=zn[81]=0;Un[89]=Un[81]=1;Hn[89]=Hn[81]=0;qn[89]=qn[81]=1;Bn[96]=Bn[74]=0;Fn[96]=Fn[74]=1;zn[96]=zn[74]=0;Vn[96]=Vn[74]=-1;kn[96]=kn[74]=0;Gn[96]=Gn[74]=1;jn[96]=jn[74]=1;Kn[96]=Kn[74]=0;Zn[96]=Zn[74]=0;Pn[96]=Pn[74]=1;Mn[96]=Mn[74]=0;Ln[96]=Ln[74]=1;Bn[24]=Bn[146]=0;Fn[24]=Fn[146]=-1;zn[24]=zn[146]=1;Wn[24]=Wn[146]=1;Yn[24]=Yn[146]=0;Xn[24]=Xn[146]=1;Un[24]=Un[146]=0;Hn[24]=Hn[146]=1;qn[24]=qn[146]=1;Rn[24]=Rn[146]=0;On[24]=On[146]=-1;Nn[24]=Nn[146]=0;Vn[6]=Vn[164]=-1;kn[6]=kn[164]=0;Gn[6]=Gn[164]=1;Wn[6]=Wn[164]=-1;Yn[6]=Yn[164]=0;Xn[6]=Xn[164]=0;Qn[6]=Qn[164]=0;Jn[6]=Jn[164]=-1;$n[6]=$n[164]=1;jn[6]=jn[164]=1;Kn[6]=Kn[164]=0;Zn[6]=Zn[164]=0;Un[129]=Un[41]=0;Hn[129]=Hn[41]=1;qn[129]=qn[41]=1;Qn[129]=Qn[41]=0;Jn[129]=Jn[41]=1;$n[129]=$n[41]=0;Pn[129]=Pn[41]=-1;Mn[129]=Mn[41]=0;Ln[129]=Ln[41]=0;Rn[129]=Rn[41]=0;On[129]=On[41]=-1;Nn[129]=Nn[41]=0;Wn[66]=Wn[104]=0;Yn[66]=Yn[104]=1;Xn[66]=Xn[104]=0;Un[66]=Un[104]=-1;Hn[66]=Hn[104]=0;qn[66]=qn[104]=1;jn[66]=jn[104]=0;Kn[66]=Kn[104]=-1;Zn[66]=Zn[104]=0;Pn[66]=Pn[104]=0;Mn[66]=Mn[104]=-1;Ln[66]=Ln[104]=1;Bn[144]=Bn[26]=-1;Fn[144]=Fn[26]=0;zn[144]=zn[26]=0;Qn[144]=Qn[26]=1;Jn[144]=Jn[26]=0;$n[144]=$n[26]=1;jn[144]=jn[26]=0;Kn[144]=Kn[26]=1;Zn[144]=Zn[26]=1;Rn[144]=Rn[26]=-1;On[144]=On[26]=0;Nn[144]=Nn[26]=1;Vn[36]=Vn[134]=0;kn[36]=kn[134]=1;Gn[36]=Gn[134]=1;Wn[36]=Wn[134]=0;Yn[36]=Yn[134]=1;Xn[36]=Xn[134]=0;Pn[36]=Pn[134]=0;Mn[36]=Mn[134]=-1;Ln[36]=Ln[134]=1;Rn[36]=Rn[134]=1;On[36]=On[134]=0;Nn[36]=Nn[134]=0;Bn[9]=Bn[161]=-1;Fn[9]=Fn[161]=0;zn[9]=zn[161]=0;Vn[9]=Vn[161]=0;kn[9]=kn[161]=-1;Gn[9]=Gn[161]=0;Un[9]=Un[161]=1;Hn[9]=Hn[161]=0;qn[9]=qn[161]=0;Qn[9]=Qn[161]=1;Jn[9]=Jn[161]=0;$n[9]=$n[161]=1;Bn[136]=0;Fn[136]=1;zn[136]=1;Vn[136]=0;kn[136]=1;Gn[136]=0;Wn[136]=-1;Yn[136]=0;Xn[136]=1;Un[136]=-1;Hn[136]=0;qn[136]=0;Qn[136]=0;Jn[136]=-1;$n[136]=0;jn[136]=0;Kn[136]=-1;Zn[136]=1;Pn[136]=1;Mn[136]=0;Ln[136]=0;Rn[136]=1;On[136]=0;Nn[136]=1;Bn[34]=0;Fn[34]=-1;zn[34]=0;Vn[34]=0;kn[34]=-1;Gn[34]=1;Wn[34]=1;Yn[34]=0;Xn[34]=0;Un[34]=1;Hn[34]=0;qn[34]=1;Qn[34]=0;Jn[34]=1;$n[34]=1;jn[34]=0;Kn[34]=1;Zn[34]=0;Pn[34]=-1;Mn[34]=0;Ln[34]=1;Rn[34]=-1;On[34]=0;Nn[34]=0;Bn[35]=0;Fn[35]=1;zn[35]=1;Vn[35]=0;kn[35]=-1;Gn[35]=1;Wn[35]=1;Yn[35]=0;Xn[35]=0;Un[35]=-1;Hn[35]=0;qn[35]=0;Qn[35]=0;Jn[35]=-1;$n[35]=0;jn[35]=0;Kn[35]=1;Zn[35]=0;Pn[35]=-1;Mn[35]=0;Ln[35]=1;Rn[35]=1;On[35]=0;Nn[35]=1;Bn[153]=0;Fn[153]=1;zn[153]=1;Un[153]=-1;Hn[153]=0;qn[153]=0;Qn[153]=0;Jn[153]=-1;$n[153]=0;Rn[153]=1;On[153]=0;Nn[153]=1;Vn[102]=0;kn[102]=-1;Gn[102]=1;Wn[102]=1;Yn[102]=0;Xn[102]=0;jn[102]=0;Kn[102]=1;Zn[102]=0;Pn[102]=-1;Mn[102]=0;Ln[102]=1;Bn[155]=0;Fn[155]=-1;zn[155]=0;Un[155]=1;Hn[155]=0;qn[155]=1;Qn[155]=0;Jn[155]=1;$n[155]=1;Rn[155]=-1;On[155]=0;Nn[155]=0;Vn[103]=0;kn[103]=1;Gn[103]=0;Wn[103]=-1;Yn[103]=0;Xn[103]=1;jn[103]=0;Kn[103]=-1;Zn[103]=1;Pn[103]=1;Mn[103]=0;Ln[103]=0;Bn[152]=0;Fn[152]=1;zn[152]=1;Wn[152]=-1;Yn[152]=0;Xn[152]=1;Un[152]=-1;Hn[152]=0;qn[152]=0;Qn[152]=0;Jn[152]=-1;$n[152]=0;jn[152]=0;Kn[152]=-1;Zn[152]=1;Rn[152]=1;On[152]=0;Nn[152]=1;Bn[156]=0;Fn[156]=-1;zn[156]=1;Wn[156]=1;Yn[156]=0;Xn[156]=1;Un[156]=-1;Hn[156]=0;qn[156]=0;Qn[156]=0;Jn[156]=-1;$n[156]=0;jn[156]=0;Kn[156]=1;Zn[156]=1;Rn[156]=-1;On[156]=0;Nn[156]=1;Bn[137]=0;Fn[137]=1;zn[137]=1;Vn[137]=0;kn[137]=1;Gn[137]=0;Un[137]=-1;Hn[137]=0;qn[137]=0;Qn[137]=0;Jn[137]=-1;$n[137]=0;Pn[137]=1;Mn[137]=0;Ln[137]=0;Rn[137]=1;On[137]=0;Nn[137]=1;Bn[139]=0;Fn[139]=1;zn[139]=1;Vn[139]=0;kn[139]=-1;Gn[139]=0;Un[139]=1;Hn[139]=0;qn[139]=0;Qn[139]=0;Jn[139]=1;$n[139]=0;Pn[139]=-1;Mn[139]=0;Ln[139]=0;Rn[139]=1;On[139]=0;Nn[139]=1;Bn[98]=0;Fn[98]=-1;zn[98]=0;Vn[98]=0;kn[98]=-1;Gn[98]=1;Wn[98]=1;Yn[98]=0;Xn[98]=0;Un[98]=1;Hn[98]=0;qn[98]=1;jn[98]=0;Kn[98]=1;Zn[98]=0;Pn[98]=-1;Mn[98]=0;Ln[98]=1;Bn[99]=0;Fn[99]=1;zn[99]=0;Vn[99]=0;kn[99]=-1;Gn[99]=1;Wn[99]=1;Yn[99]=0;Xn[99]=0;Un[99]=-1;Hn[99]=0;qn[99]=1;jn[99]=0;Kn[99]=-1;Zn[99]=0;Pn[99]=1;Mn[99]=0;Ln[99]=1;Vn[38]=0;kn[38]=-1;Gn[38]=1;Wn[38]=1;Yn[38]=0;Xn[38]=0;Qn[38]=0;Jn[38]=1;$n[38]=1;jn[38]=0;Kn[38]=1;Zn[38]=0;Pn[38]=-1;Mn[38]=0;Ln[38]=1;Rn[38]=-1;On[38]=0;Nn[38]=0;Vn[39]=0;kn[39]=1;Gn[39]=1;Wn[39]=-1;Yn[39]=0;Xn[39]=0;Qn[39]=0;Jn[39]=-1;$n[39]=1;jn[39]=0;Kn[39]=1;Zn[39]=0;Pn[39]=-1;Mn[39]=0;Ln[39]=1;Rn[39]=1;On[39]=0;Nn[39]=0;var P3=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},M3=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},L3=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},R3=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},O3=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},N3=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},B3=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},F3=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},qve=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},Wve=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},Yve=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},Xve=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},jve=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},Kve=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},Zve=function(){return[[0,0],[0,1],[1,1],[1,0]]},Qve=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},Jve=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},$ve=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},eCe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},tCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},nCe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},rCe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},iCe=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},oCe=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},aCe=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},sCe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},uCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},lCe=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},cCe=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},fCe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},hCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},dCe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},pCe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},mCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},gCe=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},_Ce=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},yCe=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},vCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},CCe=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},xCe=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},et=[],Ze=[],St=[],dt=[],Ut=[],zt=[],er=[],Dr=[];dt[1]=Ut[1]=18;dt[169]=Ut[169]=18;St[4]=Ze[4]=12;St[166]=Ze[166]=12;et[16]=Dr[16]=4;et[154]=Dr[154]=4;zt[64]=er[64]=22;zt[106]=er[106]=22;St[2]=zt[2]=17;dt[2]=Ut[2]=18;St[168]=zt[168]=17;dt[168]=Ut[168]=18;et[8]=dt[8]=9;Ze[8]=St[8]=12;et[162]=dt[162]=9;Ze[162]=St[162]=12;et[32]=Dr[32]=4;Ze[32]=er[32]=1;et[138]=Dr[138]=4;Ze[138]=er[138]=1;Ut[128]=Dr[128]=21;zt[128]=er[128]=22;Ut[42]=Dr[42]=21;zt[42]=er[42]=22;Ze[5]=Ut[5]=14;Ze[165]=Ut[165]=14;St[20]=Dr[20]=6;St[150]=Dr[150]=6;et[80]=zt[80]=11;et[90]=zt[90]=11;dt[65]=er[65]=3;dt[105]=er[105]=3;et[160]=zt[160]=11;Ze[160]=Ut[160]=14;et[10]=zt[10]=11;Ze[10]=Ut[10]=14;St[130]=Dr[130]=6;dt[130]=er[130]=3;St[40]=Dr[40]=6;dt[40]=er[40]=3;Ze[101]=er[101]=1;Ze[69]=er[69]=1;Ut[149]=Dr[149]=21;Ut[21]=Dr[21]=21;St[86]=zt[86]=17;St[84]=zt[84]=17;et[89]=dt[89]=9;et[81]=dt[81]=9;et[96]=er[96]=0;Ze[96]=zt[96]=15;et[74]=er[74]=0;Ze[74]=zt[74]=15;et[24]=St[24]=8;dt[24]=Dr[24]=7;et[146]=St[146]=8;dt[146]=Dr[146]=7;Ze[6]=zt[6]=15;St[6]=Ut[6]=16;Ze[164]=zt[164]=15;St[164]=Ut[164]=16;dt[129]=Dr[129]=7;Ut[129]=er[129]=20;dt[41]=Dr[41]=7;Ut[41]=er[41]=20;St[66]=er[66]=2;dt[66]=zt[66]=19;St[104]=er[104]=2;dt[104]=zt[104]=19;et[144]=Ut[144]=10;zt[144]=Dr[144]=23;et[26]=Ut[26]=10;zt[26]=Dr[26]=23;Ze[36]=Dr[36]=5;St[36]=er[36]=2;Ze[134]=Dr[134]=5;St[134]=er[134]=2;et[9]=Ut[9]=10;Ze[9]=dt[9]=13;et[161]=Ut[161]=10;Ze[161]=dt[161]=13;Ze[37]=Dr[37]=5;Ut[37]=er[37]=20;Ze[133]=Dr[133]=5;Ut[133]=er[133]=20;St[148]=Ut[148]=16;zt[148]=Dr[148]=23;St[22]=Ut[22]=16;zt[22]=Dr[22]=23;et[82]=St[82]=8;dt[82]=zt[82]=19;et[88]=St[88]=8;dt[88]=zt[88]=19;et[73]=er[73]=0;Ze[73]=dt[73]=13;et[97]=er[97]=0;Ze[97]=dt[97]=13;et[145]=dt[145]=9;Ut[145]=Dr[145]=21;et[25]=dt[25]=9;Ut[25]=Dr[25]=21;Ze[70]=er[70]=1;St[70]=zt[70]=17;Ze[100]=er[100]=1;St[100]=zt[100]=17;et[34]=dt[34]=9;Ze[34]=St[34]=12;Ut[34]=Dr[34]=21;zt[34]=er[34]=22;et[136]=Dr[136]=4;Ze[136]=er[136]=1;St[136]=zt[136]=17;dt[136]=Ut[136]=18;et[35]=Dr[35]=4;Ze[35]=St[35]=12;dt[35]=Ut[35]=18;zt[35]=er[35]=22;et[153]=Dr[153]=4;dt[153]=Ut[153]=18;Ze[102]=St[102]=12;zt[102]=er[102]=22;et[155]=dt[155]=9;Ut[155]=Dr[155]=23;Ze[103]=er[103]=1;St[103]=zt[103]=17;et[152]=Dr[152]=4;St[152]=zt[152]=17;dt[152]=Ut[152]=18;et[156]=St[156]=8;dt[156]=Ut[156]=18;zt[156]=Dr[156]=23;et[137]=Dr[137]=4;Ze[137]=er[137]=1;dt[137]=Ut[137]=18;et[139]=Dr[139]=4;Ze[139]=dt[139]=13;Ut[139]=er[139]=20;et[98]=dt[98]=9;Ze[98]=St[98]=12;zt[98]=er[98]=22;et[99]=er[99]=0;Ze[99]=St[99]=12;dt[99]=zt[99]=19;Ze[38]=St[38]=12;Ut[38]=Dr[38]=21;zt[38]=er[38]=22;Ze[39]=Dr[39]=5;St[39]=Ut[39]=16;zt[39]=er[39]=22;var Ye=[];Ye[1]=Ye[169]=P3;Ye[4]=Ye[166]=M3;Ye[16]=Ye[154]=L3;Ye[64]=Ye[106]=R3;Ye[168]=Ye[2]=O3;Ye[162]=Ye[8]=N3;Ye[138]=Ye[32]=B3;Ye[42]=Ye[128]=F3;Ye[5]=Ye[165]=qve;Ye[20]=Ye[150]=Wve;Ye[80]=Ye[90]=Yve;Ye[65]=Ye[105]=Xve;Ye[160]=Ye[10]=jve;Ye[130]=Ye[40]=Kve;Ye[85]=Zve;Ye[101]=Ye[69]=Qve;Ye[149]=Ye[21]=Jve;Ye[86]=Ye[84]=$ve;Ye[89]=Ye[81]=eCe;Ye[96]=Ye[74]=tCe;Ye[24]=Ye[146]=nCe;Ye[6]=Ye[164]=rCe;Ye[129]=Ye[41]=iCe;Ye[66]=Ye[104]=oCe;Ye[144]=Ye[26]=aCe;Ye[36]=Ye[134]=sCe;Ye[9]=Ye[161]=uCe;Ye[37]=Ye[133]=lCe;Ye[148]=Ye[22]=cCe;Ye[82]=Ye[88]=fCe;Ye[73]=Ye[97]=hCe;Ye[145]=Ye[25]=dCe;Ye[70]=Ye[100]=pCe;Ye[34]=function(e){return[F3(e),N3(e)]};Ye[35]=mCe;Ye[136]=function(e){return[B3(e),O3(e)]};Ye[153]=function(e){return[L3(e),P3(e)]};Ye[102]=function(e){return[M3(e),R3(e)]};Ye[155]=gCe;Ye[103]=_Ce;Ye[152]=function(e){return[L3(e),O3(e)]};Ye[156]=yCe;Ye[137]=function(e){return[B3(e),P3(e)]};Ye[139]=vCe;Ye[98]=function(e){return[N3(e),R3(e)]};Ye[99]=CCe;Ye[38]=function(e){return[M3(e),F3(e)]};Ye[39]=xCe;function H(e,t,n){return(e-t)/(n-t)}function q2(e){return e.constructor.toString().indexOf("Array")>-1}function wCe(e,t,n){for(var r=e.length-1,o=e[0].length-1,a={rows:r,cols:o,cells:[]},s=t+Math.abs(n),u=0;u<r;++u){a.cells[u]=[];for(var l=0;l<o;++l){var c=0,f=e[u+1][l],h=e[u+1][l+1],d=e[u][l+1],p=e[u][l];if(!(isNaN(f)||isNaN(h)||isNaN(d)||isNaN(p))){c|=f<t?0:f>s?128:64,c|=h<t?0:h>s?32:16,c|=d<t?0:d>s?8:4,c|=p<t?0:p>s?2:1;var g=+c,y=0;if(c===17||c===18||c===33||c===34||c===38||c===68||c===72||c===98||c===102||c===132||c===136||c===137||c===152||c===153){var v=(f+h+d+p)/4;y=v>s?2:v<t?0:1,c===34?y===1?c=35:y===0&&(c=136):c===136?y===1?(c=35,y=4):y===0&&(c=34):c===17?y===1?(c=155,y=4):y===0&&(c=153):c===68?y===1?(c=103,y=4):y===0&&(c=102):c===153?y===1&&(c=155):c===102?y===1&&(c=103):c===152?y<2&&(c=156,y=1):c===137?y<2&&(c=139,y=1):c===98?y<2&&(c=99,y=1):c===38?y<2&&(c=39,y=1):c===18?y>0?(c=156,y=4):c=152:c===33?y>0?(c=139,y=4):c=137:c===72?y>0?(c=99,y=4):c=98:c===132&&(y>0?(c=39,y=4):c=38)}if(c!=0&&c!=170){var w,C,E,S,A,D,P,M;w=C=E=S=A=D=P=M=.5;var I=[];c===1?(E=1-H(t,d,p),M=1-H(t,f,p),I.push(dt[c])):c===169?(E=H(s,p,d),M=H(s,p,f),I.push(dt[c])):c===4?(D=1-H(t,h,d),S=H(t,p,d),I.push(Ze[c])):c===166?(D=H(s,d,h),S=1-H(s,d,p),I.push(Ze[c])):c===16?(A=H(t,d,h),C=H(t,f,h),I.push(et[c])):c===154?(A=1-H(s,h,d),C=1-H(s,h,f),I.push(et[c])):c===64?(P=H(t,p,f),w=1-H(t,h,f),I.push(zt[c])):c===106?(P=1-H(s,f,p),w=H(s,f,h),I.push(zt[c])):c===168?(S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),I.push(St[c]),I.push(dt[c])):c===2?(S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),I.push(St[c]),I.push(dt[c])):c===162?(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),I.push(St[c]),I.push(dt[c])):c===8?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),I.push(et[c]),I.push(Ze[c])):c===138?(A=1-H(t,h,d),D=1-H(s,h,d),w=1-H(s,h,f),C=1-H(t,h,f),I.push(et[c]),I.push(Ze[c])):c===32?(A=H(s,d,h),D=H(t,d,h),w=H(t,f,h),C=H(s,f,h),I.push(et[c]),I.push(Ze[c])):c===42?(M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),I.push(Ut[c]),I.push(zt[c])):c===128&&(M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),I.push(Ut[c]),I.push(zt[c])),c===5?(D=1-H(t,h,d),M=1-H(t,f,p),I.push(Ze[c])):c===165?(D=H(s,d,h),M=H(s,p,f),I.push(Ze[c])):c===20?(S=H(t,p,d),C=H(t,f,h),I.push(St[c])):c===150?(S=1-H(s,d,p),C=1-H(s,h,f),I.push(St[c])):c===80?(A=H(t,d,h),P=H(t,p,f),I.push(et[c])):c===90?(A=1-H(s,h,d),P=1-H(s,f,p),I.push(et[c])):c===65?(E=1-H(t,d,p),w=1-H(t,h,f),I.push(dt[c])):c===105?(E=H(s,p,d),w=H(s,f,h),I.push(dt[c])):c===160?(A=H(s,d,h),D=H(t,d,h),M=H(t,p,f),P=H(s,p,f),I.push(et[c]),I.push(Ze[c])):c===10?(A=1-H(t,h,d),D=1-H(s,h,d),M=1-H(s,f,p),P=1-H(t,f,p),I.push(et[c]),I.push(Ze[c])):c===130?(S=1-H(t,d,p),E=1-H(s,d,p),w=1-H(s,h,f),C=1-H(t,h,f),I.push(St[c]),I.push(dt[c])):c===40?(S=H(s,p,d),E=H(t,p,d),w=H(t,f,h),C=H(s,f,h),I.push(St[c]),I.push(dt[c])):c===101?(D=H(s,d,h),w=H(s,f,h),I.push(Ze[c])):c===69?(D=1-H(t,h,d),w=1-H(t,h,f),I.push(Ze[c])):c===149?(M=H(s,p,f),C=1-H(s,h,f),I.push(Ut[c])):c===21?(M=1-H(t,f,p),C=H(t,f,h),I.push(Ut[c])):c===86?(S=1-H(s,d,p),P=1-H(s,f,p),I.push(St[c])):c===84?(S=H(t,p,d),P=H(t,p,f),I.push(St[c])):c===89?(A=1-H(s,h,d),E=H(s,p,d),I.push(dt[c])):c===81?(A=H(t,d,h),E=1-H(t,d,p),I.push(dt[c])):c===96?(A=H(s,d,h),D=H(t,d,h),P=H(t,p,f),w=H(s,f,h),I.push(et[c]),I.push(Ze[c])):c===74?(A=1-H(t,h,d),D=1-H(s,h,d),P=1-H(s,f,p),w=1-H(t,h,f),I.push(et[c]),I.push(Ze[c])):c===24?(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),C=H(t,f,h),I.push(et[c]),I.push(dt[c])):c===146?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),C=1-H(s,h,f),I.push(et[c]),I.push(dt[c])):c===6?(D=1-H(t,h,d),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),I.push(Ze[c]),I.push(St[c])):c===164?(D=H(s,d,h),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),I.push(Ze[c]),I.push(St[c])):c===129?(E=1-H(t,d,p),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),I.push(dt[c]),I.push(Ut[c])):c===41?(E=H(s,p,d),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),I.push(dt[c]),I.push(Ut[c])):c===66?(S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=1-H(t,h,f),I.push(St[c]),I.push(dt[c])):c===104?(S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=H(s,f,h),I.push(dt[c]),I.push(er[c])):c===144?(A=H(t,d,h),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f),I.push(et[c]),I.push(zt[c])):c===26?(A=1-H(s,h,d),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h),I.push(et[c]),I.push(zt[c])):c===36?(D=H(s,d,h),S=H(t,p,d),w=H(t,f,h),C=H(s,f,h),I.push(Ze[c]),I.push(St[c])):c===134?(D=1-H(t,h,d),S=1-H(s,d,p),w=1-H(s,h,f),C=1-H(t,h,f),I.push(Ze[c]),I.push(St[c])):c===9?(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=1-H(t,f,p),I.push(et[c]),I.push(Ze[c])):c===161?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=H(s,p,f),I.push(et[c]),I.push(Ze[c])):c===37?(D=H(s,d,h),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h),I.push(Ze[c]),I.push(Ut[c])):c===133?(D=1-H(t,h,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f),I.push(Ze[c]),I.push(Ut[c])):c===148?(S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f),I.push(St[c]),I.push(zt[c])):c===22?(S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h),I.push(St[c]),I.push(zt[c])):c===82?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),I.push(et[c]),I.push(dt[c])):c===88?(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),I.push(et[c]),I.push(dt[c])):c===73?(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),w=1-H(t,h,f),I.push(et[c]),I.push(Ze[c])):c===97?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),w=H(s,f,h),I.push(et[c]),I.push(Ze[c])):c===145?(A=H(t,d,h),E=1-H(t,d,p),M=H(s,p,f),C=1-H(s,h,f),I.push(et[c]),I.push(Ut[c])):c===25?(A=1-H(s,h,d),E=H(s,p,d),M=1-H(t,f,p),C=H(t,f,h),I.push(et[c]),I.push(Ut[c])):c===70?(D=1-H(t,h,d),S=1-H(s,d,p),P=1-H(s,f,p),w=1-H(t,h,f),I.push(Ze[c]),I.push(St[c])):c===100?(D=H(s,d,h),S=H(t,p,d),P=H(t,p,f),w=H(s,f,h),I.push(Ze[c]),I.push(St[c])):c===34?(y===0?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),I.push(et[c]),I.push(Ze[c]),I.push(Ut[c]),I.push(zt[c])):c===35?(y===4?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),I.push(et[c]),I.push(Ze[c]),I.push(dt[c]),I.push(zt[c])):c===136?(y===0?(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),I.push(et[c]),I.push(Ze[c]),I.push(Ut[c]),I.push(zt[c])):c===153?(y===0?(A=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),C=1-H(s,h,f)),I.push(et[c]),I.push(dt[c])):c===102?(y===0?(D=1-H(t,h,d),S=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),I.push(Ze[c]),I.push(zt[c])):c===155?(y===4?(A=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),C=1-H(s,h,f)),I.push(et[c]),I.push(Ut[c])):c===103?(y===4?(D=1-H(t,h,d),S=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),I.push(Ze[c]),I.push(St[c])):c===152?(y===0?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f)),I.push(et[c]),I.push(St[c]),I.push(dt[c])):c===156?(y===4?(A=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),C=H(t,f,h)):(A=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),M=H(t,p,f),P=H(s,p,f),C=1-H(s,h,f)),I.push(et[c]),I.push(dt[c]),I.push(zt[c])):c===137?(y===0?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),I.push(et[c]),I.push(Ze[c]),I.push(dt[c])):c===139?(y===4?(A=H(s,d,h),D=H(t,d,h),E=1-H(t,d,p),M=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)):(A=1-H(t,h,d),D=1-H(s,h,d),E=H(s,p,d),M=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)),I.push(et[c]),I.push(Ze[c]),I.push(Ut[c])):c===98?(y===0?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),I.push(et[c]),I.push(Ze[c]),I.push(zt[c])):c===99?(y===4?(A=1-H(t,h,d),D=1-H(s,h,d),S=H(s,p,d),E=H(t,p,d),P=H(t,p,f),w=1-H(t,h,f)):(A=H(s,d,h),D=H(t,d,h),S=1-H(t,d,p),E=1-H(s,d,p),P=1-H(s,f,p),w=H(s,f,h)),I.push(et[c]),I.push(Ze[c]),I.push(dt[c])):c===38?(y===0?(D=1-H(t,h,d),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),I.push(Ze[c]),I.push(Ut[c]),I.push(zt[c])):c===39?(y===4?(D=1-H(t,h,d),S=H(t,p,d),M=H(t,p,f),P=H(s,p,f),w=1-H(s,h,f),C=1-H(t,h,f)):(D=H(s,d,h),S=1-H(s,d,p),M=1-H(s,f,p),P=1-H(t,f,p),w=H(t,f,h),C=H(s,f,h)),I.push(Ze[c]),I.push(St[c]),I.push(zt[c])):c===85&&(A=1,D=0,S=1,E=0,M=0,P=1,w=0,C=1),(w<0||w>1||C<0||C>1||A<0||A>1||S<0||S>1||M<0||M>1||P<0||P>1)&&console.log("MarchingSquaresJS-isoBands: "+c+" "+g+" "+f+","+h+","+d+","+p+" "+y+" "+w+" "+C+" "+A+" "+D+" "+S+" "+E+" "+M+" "+P),a.cells[u][l]={cval:c,cval_real:g,flipped:y,topleft:w,topright:C,righttop:A,rightbottom:D,bottomright:S,bottomleft:E,leftbottom:M,lefttop:P,edges:I}}}}}return a}function ECe(e){for(var t=[],n=e.rows,r=e.cols,o=[],a=0;a<n;a++)for(var s=0;s<r;s++)if(typeof e.cells[a][s]<"u"&&e.cells[a][s].edges.length>0){var u=e.cells[a][s],l=ACe(u),c=null,f=s,h=a;l!==null&&o.push([l.p[0]+f,l.p[1]+h]);do{if(c=bCe(e.cells[h][f],l.x,l.y,l.o),c!==null)o.push([c.p[0]+f,c.p[1]+h]),f+=c.x,h+=c.y,l=c;else break;if(h<0||h>=n||f<0||f>=r||typeof e.cells[h][f]>"u"){f-=c.x,h-=c.y;var d=TCe(e,f,h,c.x,c.y,c.o);if(d!==null)d.path.forEach(function(p){o.push(p)}),f=d.i,h=d.j,l=d;else break}}while(typeof e.cells[h][f]<"u"&&e.cells[h][f].edges.length>0);t.push(o),o=[],e.cells[a][s].edges.length>0&&s--}return t}function TCe(e,t,n,r,o,a){for(var s=e.cells[n][t],u=s.cval_real,l=t+r,c=n+o,f=[],h=!1;!h;){if(typeof e.cells[c]>"u"||typeof e.cells[c][l]>"u")if(c-=o,l-=r,s=e.cells[c][l],u=s.cval_real,o===-1)if(a===0)if(u&Qs)f.push([l,c]),r=-1,o=0,a=0;else if(u&Ms)f.push([l+1,c]),r=1,o=0,a=0;else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&Qs)f.push([l,c]),r=-1,o=0,a=0;else if(u&Ms){f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else{f.push([l+s.bottomleft,c]),r=0,o=1,a=0,h=!0;break}else if(o===1)if(a===0)if(u&Wf)f.push([l+1,c+1]),r=1,o=0,a=1;else if(u&Lu){f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else{f.push([l+s.topright,c+1]),r=0,o=-1,a=1,h=!0;break}else u&Wf?(f.push([l+1,c+1]),r=1,o=0,a=1):(f.push([l+1,c+1]),r=1,o=0,a=1);else if(r===-1)if(a===0)if(u&Lu)f.push([l,c+1]),r=0,o=1,a=0;else if(u&Qs){f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{f.push([l,c+s.lefttop]),r=1,o=0,a=1,h=!0;break}else if(u&Lu)f.push([l,c+1]),r=0,o=1,a=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(r===1)if(a===0)if(u&Ms)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else if(u&Ms)f.push([l+1,c]),r=0,o=-1,a=1;else if(u&Wf){f.push([l+1,c+s.righttop]),r=-1,o=0,a=1;break}else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(s=e.cells[c][l],u=s.cval_real,r===-1)if(a===0)if(typeof e.cells[c-1]<"u"&&typeof e.cells[c-1][l]<"u")r=0,o=-1,a=1;else if(u&Qs)f.push([l,c]);else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&Lu)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+c);break}else if(r===1)if(a===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof e.cells[c+1]<"u"&&typeof e.cells[c+1][l]<"u")r=0,o=1,a=0;else if(u&Wf)f.push([l+1,c+1]),r=1,o=0,a=1;else{f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else if(o===-1)if(a===1)if(typeof e.cells[c][l+1]<"u")r=1,o=0,a=1;else if(u&Ms)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.righttop]),r=-1,o=0,a=1,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(o===1)if(a===0)if(typeof e.cells[c][l-1]<"u")r=-1,o=0,a=0;else if(u&Lu)f.push([l,c+1]),r=0,o=1,a=0;else{f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(l+=r,c+=o,l===t&&c===n)break}return{path:f,i:l,j:c,x:r,y:o,o:a}}function SCe(e,t){delete e.edges[t];for(var n=t+1;n<e.edges.length;n++)e.edges[n-1]=e.edges[n];e.edges.pop()}function ACe(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],n=e.cval_real;switch(t){case 0:return n&Wf?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return n&Ms?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return n&Ms?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return n&Qs?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return n&Wf?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return n&Ms?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return n&Ms?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return n&Qs?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return n&Ms?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return n&Qs?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return n&Qs?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return n&Lu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return n&Ms?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return n&Qs?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return n&Qs?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return n&Lu?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return n&Ms?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return n&Lu?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return n&Qs?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return n&Lu?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return n&Lu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return n&Wf?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return n&Lu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return n&Wf?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e);break}}return null}function bCe(e,t,n,r){var o,a,s,u,l=e.cval,c;switch(t){case-1:switch(r){case 0:o=Ze[l],s=Vn[l],u=kn[l],c=Gn[l];break;default:o=et[l],s=Bn[l],u=Fn[l],c=zn[l];break}break;case 1:switch(r){case 0:o=Ut[l],s=Qn[l],u=Jn[l],c=$n[l];break;default:o=zt[l],s=jn[l],u=Kn[l],c=Zn[l];break}break;default:switch(n){case-1:switch(r){case 0:o=er[l],s=Pn[l],u=Mn[l],c=Ln[l];break;default:o=Dr[l],s=Rn[l],u=On[l],c=Nn[l];break}break;case 1:switch(r){case 0:o=dt[l],s=Un[l],u=Hn[l],c=qn[l];break;default:o=St[l],s=Wn[l],u=Yn[l],c=Xn[l];break}break;default:break}break}if(a=e.edges.indexOf(o),typeof e.edges[a]<"u")SCe(e,a);else return null;switch(l=e.cval_real,o){case 0:l&Wf?(t=e.topleft,n=1):(t=1,n=e.righttop);break;case 1:l&Ms?(t=1,n=e.rightbottom):(t=e.topleft,n=1);break;case 2:l&Ms?(t=e.topleft,n=1):(t=e.bottomright,n=0);break;case 3:l&Qs?(t=e.bottomleft,n=0):(t=e.topleft,n=1);break;case 4:l&Wf?(t=e.topright,n=1):(t=1,n=e.righttop);break;case 5:l&Ms?(t=1,n=e.rightbottom):(t=e.topright,n=1);break;case 6:l&Ms?(t=e.topright,n=1):(t=e.bottomright,n=0);break;case 7:l&Qs?(t=e.bottomleft,n=0):(t=e.topright,n=1);break;case 8:l&Ms?(t=1,n=e.righttop):(t=e.bottomright,n=0);break;case 9:l&Qs?(t=e.bottomleft,n=0):(t=1,n=e.righttop);break;case 10:l&Qs?(t=1,n=e.righttop):(t=0,n=e.leftbottom);break;case 11:l&Lu?(t=0,n=e.lefttop):(t=1,n=e.righttop);break;case 12:l&Ms?(t=1,n=e.rightbottom):(t=e.bottomright,n=0);break;case 13:l&Qs?(t=e.bottomleft,n=0):(t=1,n=e.rightbottom);break;case 14:l&Qs?(t=1,n=e.rightbottom):(t=0,n=e.leftbottom);break;case 15:l&Lu?(t=0,n=e.lefttop):(t=1,n=e.rightbottom);break;case 16:l&Ms?(t=0,n=e.leftbottom):(t=e.bottomright,n=0);break;case 17:l&Lu?(t=0,n=e.lefttop):(t=e.bottomright,n=0);break;case 18:l&Qs?(t=e.bottomleft,n=0):(t=0,n=e.leftbottom);break;case 19:l&Lu?(t=0,n=e.lefttop):(t=e.bottomleft,n=0);break;case 20:l&Lu?(t=0,n=e.leftbottom):(t=e.topleft,n=1);break;case 21:l&Wf?(t=e.topright,n=1):(t=0,n=e.leftbottom);break;case 22:l&Lu?(t=0,n=e.lefttop):(t=e.topleft,n=1);break;case 23:l&Wf?(t=e.topright,n=1):(t=0,n=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return(typeof t>"u"||typeof n>"u"||typeof s>"u"||typeof u>"u"||typeof c>"u")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+n+" "+s+" "+u+" "+c)),{p:[t,n],x:s,y:u,o:c}}function ICe(e){var t=[],n=0;return e.cells.forEach(function(r,o){r.forEach(function(a,s){if(typeof a<"u"){var u=Ye[a.cval](a);typeof u=="object"&&q2(u)?typeof u[0]=="object"&&q2(u[0])?typeof u[0][0]=="object"&&q2(u[0][0])?u.forEach(function(l){l.forEach(function(c){c[0]+=s,c[1]+=o}),t[n++]=l}):(u.forEach(function(l){l[0]+=s,l[1]+=o}),t[n++]=u):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}function DCe(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(xd(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!pt(o))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=Gve(e,{zProperty:r,flip:!0}),u=PCe(s,t,r);u=MCe(u,s,e);var l=u.map(function(c,f){if(a[f]&&!pt(a[f]))throw new Error("Each mappedProperty is required to be an Object");var h=Object.assign({},o,a[f]);h[r]=c[r];var d=m1(c.groupedRings,h);return d});return Bt(l)}function PCe(e,t,n){for(var r=[],o=1;o<t.length;o++){var a=+t[o-1],s=+t[o],u=Hve(e,a,s-a),l=LCe(u),c=RCe(l),f={};f.groupedRings=c,f[n]=a+"-"+s,r.push(f)}return r}function MCe(e,t,n){var r=Ca(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){p.groupedRings.forEach(function(g){g.forEach(function(y){y.forEach(d)})})}),e}function LCe(e){var t=[],n=[];e.forEach(function(o){var a=mT(Dn([o]));n.push(a),t.push({ring:o,area:a})}),n.sort(function(o,a){return a-o});var r=[];return n.forEach(function(o){for(var a=0;a<t.length;a++)if(t[a].area===o){r.push(t[a].ring),t.splice(a,1);break}}),r}function RCe(e){for(var t=e.map(function(l){return{lrCoordinates:l,grouped:!1}}),n=[];!NCe(t);)for(var r=0;r<t.length;r++)if(!t[r].grouped){var o=[];o.push(t[r].lrCoordinates),t[r].grouped=!0;for(var a=Dn([t[r].lrCoordinates]),s=r+1;s<t.length;s++)if(!t[s].grouped){var u=Dn([t[s].lrCoordinates]);OCe(u,a)&&(o.push(t[s].lrCoordinates),t[s].grouped=!0)}n.push(o)}return n}function OCe(e,t){for(var n=b3(e),r=0;r<n.features.length;r++)if(!_o(n.features[r],t))return!1;return!0}function NCe(e){for(var t=0;t<e.length;t++)if(e[t].grouped===!1)return!1;return!0}function GY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.pivot,o=n.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");return t===0||(r||(r=py(e)),(o===!1||o===void 0)&&(e=ru(e)),Wa(e,function(a){var s=y0(r,a),u=s+t,l=mP(r,a),c=wt(XC(r,l,u));a[0]=c[0],a[1]=c[1]})),e}function UY(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!e)throw new Error("geojson required");if(typeof t!="number"||t===0)throw new Error("invalid factor");var a=Array.isArray(r)||typeof r=="object";return o!==!0&&(e=ru(e)),e.type==="FeatureCollection"&&!a?(li(e,function(s,u){e.features[u]=u7(s,t,r)}),e):u7(e,t,r)}function u7(e,t,n){var r=Ri(e)==="Point";return n=BCe(e,n),t===1||r||Wa(e,function(o){var a=mP(n,o),s=y0(n,o),u=a*t,l=wt(XC(n,u,s));o[0]=l[0],o[1]=l[1],o.length===3&&(o[2]*=t)}),e}function BCe(e,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return ao(t);var n=e.bbox?e.bbox:Ca(e),r=n[0],o=n[1],a=n[2],s=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return Vr([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return Vr([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return Vr([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Vr([a,s]);case"center":return dP(e);case void 0:case null:case"centroid":return py(e);default:throw new Error("invalid origin")}}function FCe(e,t,n,r){if(r=r||{},!pt(r))throw new Error("options is invalid");var o=r.units,a=r.zTranslation,s=r.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(a&&typeof a!="number"&&isNaN(a))throw new Error("zTranslation is not a number");if(a=a!==void 0?a:0,t===0&&a===0)return e;if(n==null||isNaN(n))throw new Error("direction is required");return t<0&&(t=-t,n=-n),(s===!1||s===void 0)&&(e=ru(e)),Wa(e,function(u){var l=wt(XC(u,t,n,{units:o}));u[0]=l[0],u[1]=l[1],a&&u.length===3&&(u[2]+=a)}),e}function jD(e){var t=e[0],n=e[1];return[n[0]-t[0],n[1]-t[1]]}function a3(e,t){return e[0]*t[1]-t[0]*e[1]}function zCe(e,t){return[e[0]+t[0],e[1]+t[1]]}function VCe(e,t){return[e[0]-t[0],e[1]-t[1]]}function kCe(e,t){return[e*t[0],e*t[1]]}function GCe(e,t){var n=e[0],r=jD(e),o=t[0],a=jD(t),s=a3(r,a),u=VCe(o,n),l=a3(u,a),c=l/s,f=zCe(n,kCe(c,r));return f}function UCe(e,t){var n=jD(e),r=jD(t);return a3(n,r)===0}function HCe(e,t){return UCe(e,t)?!1:GCe(e,t)}function qCe(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var o=Ri(e),a=e.properties;switch(o){case"LineString":return l7(e,t,r);case"MultiLineString":var s=[];return ko(e,function(u){s.push(l7(u,t,r).geometry.coordinates)}),R0(s,a);default:throw new Error("geometry "+o+" is not supported")}}function l7(e,t,n){var r=[],o=UD(t,n),a=wt(e),s=[];return a.forEach(function(u,l){if(l!==a.length-1){var c=WCe(u,a[l+1],o);if(r.push(c),l>0){var f=r[l-1],h=HCe(c,f);h!==!1&&(f[1]=h,c[0]=h),s.push(f[0]),l===a.length-2&&(s.push(c[0]),s.push(c[1]))}a.length===2&&(s.push(c[0]),s.push(c[1]))}}),Li(s,e.properties)}function WCe(e,t,n){var r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),o=e[0]+n*(t[1]-e[1])/r,a=t[0]+n*(t[1]-e[1])/r,s=e[1]+n*(e[0]-t[0])/r,u=t[1]+n*(e[0]-t[0])/r;return[[o,s],[a,u]]}function z3(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],a=n[0]-t[0],s=n[1]-t[1];return Math.sign(r*s-a*o)}function YCe(e,t){var n=e.geometry.coordinates.map(function(s){return s[0]}),r=e.geometry.coordinates.map(function(s){return s[1]}),o=t.geometry.coordinates.map(function(s){return s[0]}),a=t.geometry.coordinates.map(function(s){return s[1]});return Math.max(null,n)===Math.max(null,o)&&Math.max(null,r)===Math.max(null,a)&&Math.min(null,n)===Math.min(null,o)&&Math.min(null,r)===Math.min(null,a)}function c7(e,t){return t.geometry.coordinates[0].every(function(n){return _o(Vr(n),e)})}function XCe(e,t){return e[0]===t[0]&&e[1]===t[1]}var wp=function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};wp.buildId=function(t){return t.join(",")};wp.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(n){return n.from.id!==t.from.id})};wp.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(n){return n.to.id!==t.to.id})};wp.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1};wp.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(n,r){var o=n.to,a=r.to;if(o.coordinates[0]-t.coordinates[0]>=0&&a.coordinates[0]-t.coordinates[0]<0)return 1;if(o.coordinates[0]-t.coordinates[0]<0&&a.coordinates[0]-t.coordinates[0]>=0)return-1;if(o.coordinates[0]-t.coordinates[0]===0&&a.coordinates[0]-t.coordinates[0]===0)return o.coordinates[1]-t.coordinates[1]>=0||a.coordinates[1]-t.coordinates[1]>=0?o.coordinates[1]-a.coordinates[1]:a.coordinates[1]-o.coordinates[1];var s=z3(t.coordinates,o.coordinates,a.coordinates);if(s<0)return 1;if(s>0)return-1;var u=Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2),l=Math.pow(a.coordinates[0]-t.coordinates[0],2)+Math.pow(a.coordinates[1]-t.coordinates[1],2);return u-l}),this.outerEdgesSorted=!0)};wp.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges};wp.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]};wp.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var E0=function(t,n){this.from=t,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};E0.prototype.getSymetric=function(){return this.symetric||(this.symetric=new E0(this.to,this.from),this.symetric.symetric=this),this.symetric};E0.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)};E0.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id};E0.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"};E0.prototype.toLineString=function(){return Li([this.from.coordinates,this.to.coordinates])};E0.prototype.compareTo=function(t){return z3(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var Ul=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},HY={length:{configurable:!0}};Ul.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0};Ul.prototype.get=function(t){return this.edges[t]};HY.length.get=function(){return this.edges.length};Ul.prototype.forEach=function(t){this.edges.forEach(t)};Ul.prototype.map=function(t){return this.edges.map(t)};Ul.prototype.some=function(t){return this.edges.some(t)};Ul.prototype.isValid=function(){return!0};Ul.prototype.isHole=function(){var t=this,n=this.edges.reduce(function(s,u,l){return u.from.coordinates[1]>t.edges[s].from.coordinates[1]&&(s=l),s},0),r=(n===0?this.length:n)-1,o=(n+1)%this.length,a=z3(this.edges[r].from.coordinates,this.edges[n].from.coordinates,this.edges[o].from.coordinates);return a===0?this.edges[r].from.coordinates[0]>this.edges[o].from.coordinates[0]:a>0};Ul.prototype.toMultiPoint=function(){return uP(this.edges.map(function(t){return t.from.coordinates}))};Ul.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(n){return n.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=Dn([t])};Ul.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=CY(this.toPolygon())};Ul.findEdgeRingContaining=function(t,n){var r=t.getEnvelope(),o,a;return n.forEach(function(s){var u=s.getEnvelope();if(a&&(o=a.getEnvelope()),!YCe(u,r)&&c7(u,r)){var l=t.map(function(c){return c.from.coordinates}).find(function(c){return!s.some(function(f){return XCe(c,f.from.coordinates)})});l&&s.inside(Vr(l))&&(!a||c7(o,u))&&(a=s)}}),a};Ul.prototype.inside=function(t){return _o(t,this.toPolygon())};Object.defineProperties(Ul.prototype,HY);function jCe(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var al=function(){this.edges=[],this.nodes={}};al.fromGeoJson=function(t){jCe(t);var n=new al;return ko(t,function(r){lT(r,"LineString","Graph::fromGeoJson"),cP(r,function(o,a){if(o){var s=n.getNode(o),u=n.getNode(a);n.addEdge(s,u)}return a})}),n};al.prototype.getNode=function(t){var n=wp.buildId(t),r=this.nodes[n];return r||(r=this.nodes[n]=new wp(t)),r};al.prototype.addEdge=function(t,n){var r=new E0(t,n),o=r.getSymetric();this.edges.push(r),this.edges.push(o)};al.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(n){return t.nodes[n]}).forEach(function(n){return t._removeIfDangle(n)})};al.prototype._removeIfDangle=function(t){var n=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map(function(o){return o.to});this.removeNode(t),r.forEach(function(o){return n._removeIfDangle(o)})}};al.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(n){n.label===n.symetric.label&&(t.removeEdge(n.symetric),t.removeEdge(n))})};al.prototype._computeNextCWEdges=function(t){var n=this;typeof t>"u"?Object.keys(this.nodes).forEach(function(r){return n._computeNextCWEdges(n.nodes[r])}):t.getOuterEdges().forEach(function(r,o){t.getOuterEdge((o===0?t.getOuterEdges().length:o)-1).symetric.next=r})};al.prototype._computeNextCCWEdges=function(t,n){for(var r=t.getOuterEdges(),o,a,s=r.length-1;s>=0;--s){var u=r[s],l=u.symetric,c=void 0,f=void 0;u.label===n&&(c=u),l.label===n&&(f=l),!(!c||!f)&&(f&&(a=f),c&&(a&&(a.next=c,a=void 0),o||(o=c)))}a&&(a.next=o)};al.prototype._findLabeledEdgeRings=function(){var t=[],n=0;return this.edges.forEach(function(r){if(!(r.label>=0)){t.push(r);var o=r;do o.label=n,o=o.next;while(!r.isEqual(o));n++}}),t};al.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){t._findIntersectionNodes(r).forEach(function(o){t._computeNextCCWEdges(o,r.label)})});var n=[];return this.edges.forEach(function(r){r.ring||n.push(t._findEdgeRing(r))}),n};al.prototype._findIntersectionNodes=function(t){var n=[],r=t,o=function(){var a=0;r.from.getOuterEdges().forEach(function(s){s.label===t.label&&++a}),a>1&&n.push(r.from),r=r.next};do o();while(!t.isEqual(r));return n};al.prototype._findEdgeRing=function(t){var n=t,r=new Ul;do r.push(n),n.ring=r,n=n.next;while(!t.isEqual(n));return r};al.prototype.removeNode=function(t){var n=this;t.getOuterEdges().forEach(function(r){return n.removeEdge(r)}),t.innerEdges.forEach(function(r){return n.removeEdge(r)}),delete this.nodes[t.id]};al.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(n){return!n.isEqual(t)}),t.deleteEdge()};function KCe(e){var t=al.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var n=[],r=[];return t.getEdgeRings().filter(function(o){return o.isValid()}).forEach(function(o){o.isHole()?n.push(o):r.push(o)}),n.forEach(function(o){Ul.findEdgeRingContaining(o,r)&&r.push(o)}),Bt(r.map(function(o){return o.toPolygon()}))}function qY(e,t){var n;return ko(e,function(r){ko(t,function(o){if(n===!1)return!1;n=ZCe(r.geometry,o.geometry)})}),n}function ZCe(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!e1e(e.coordinates,t.coordinates);case"LineString":return!f7(t,e);case"Polygon":return!_o(e,t)}break;case"LineString":switch(t.type){case"Point":return!f7(e,t);case"LineString":return!QCe(e,t);case"Polygon":return!h7(t,e)}break;case"Polygon":switch(t.type){case"Point":return!_o(t,e);case"LineString":return!h7(e,t);case"Polygon":return!JCe(t,e)}}}function f7(e,t){for(var n=0;n<e.coordinates.length-1;n++)if($Ce(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function QCe(e,t){var n=$m(e,t);return n.features.length>0}function h7(e,t){var n=$m(t,WD(e));return n.features.length>0}function JCe(e,t){for(var n=0;n<e.coordinates[0].length;n++)if(_o(e.coordinates[0][n],t))return!0;for(var r=0;r<t.coordinates[0].length;r++)if(_o(t.coordinates[0][r],e))return!0;return!1}function $Ce(e,t,n){var r=n[0]-e[0],o=n[1]-e[1],a=t[0]-e[0],s=t[1]-e[1],u=r*s-o*a;return u!==0?!1:Math.abs(a)>=Math.abs(s)?a>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:s>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function e1e(e,t){return e[0]===t[0]&&e[1]===t[1]}function t1e(e,t){var n=Ri(e),r=Ri(t),o=Bl(e),a=Bl(t),s=wt(e),u=wt(t);switch(n){case"Point":switch(r){case"Point":return V3(s,u);default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"Point":return n1e(o,a);case"MultiPoint":return r1e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return pc(a,o,{ignoreEndVertices:!0});case"LineString":return a1e(o,a);case"MultiPoint":return i1e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return _o(a,o,{ignoreBoundary:!0});case"LineString":return s1e(o,a);case"Polygon":return u1e(o,a);case"MultiPoint":return o1e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function n1e(e,t){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(V3(e.coordinates[n],t.coordinates)){r=!0;break}return r}function r1e(e,t){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,o=0;o<e.coordinates.length;o++)if(V3(t.coordinates[n],e.coordinates[o])){r=!0;break}if(!r)return!1}return!0}function i1e(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(pc(t.coordinates[r],e,{ignoreEndVertices:!0})&&(n=!0),!pc(t.coordinates[r],e))return!1;return!!n}function o1e(e,t){for(var n=0;n<t.coordinates.length;n++)if(!_o(t.coordinates[n],e,{ignoreBoundary:!0}))return!1;return!0}function a1e(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(pc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!0})&&(n=!0),!pc({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!1}))return!1;return n}function s1e(e,t){var n=!1,r=0,o=Ca(e),a=Ca(t);if(!WY(o,a))return!1;for(r;r<t.coordinates.length-1;r++){var s=l1e(t.coordinates[r],t.coordinates[r+1]);if(_o({type:"Point",coordinates:s},e,{ignoreBoundary:!0})){n=!0;break}}return n}function u1e(e,t){var n=Ca(e),r=Ca(t);if(!WY(n,r))return!1;for(var o=0;o<t.coordinates[0].length;o++)if(!_o(t.coordinates[0][o],e))return!1;return!0}function WY(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function V3(e,t){return e[0]===t[0]&&e[1]===t[1]}function l1e(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function c1e(e,t){var n=Ri(e),r=Ri(t),o=Bl(e),a=Bl(t);switch(n){case"MultiPoint":switch(r){case"LineString":return d7(o,a);case"Polygon":return m7(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return d7(a,o);case"LineString":return f1e(o,a);case"Polygon":return p7(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return m7(a,o);case"LineString":return p7(a,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function d7(e,t){for(var n=!1,r=!1,o=e.coordinates.length,a=0;a<o&&!n&&!r;){for(var s=0;s<t.coordinates.length-1;s++){var u=!0;(s===0||s===t.coordinates.length-2)&&(u=!1),YY(t.coordinates[s],t.coordinates[s+1],e.coordinates[a],u)?n=!0:r=!0}a++}return n&&r}function f1e(e,t){var n=$m(e,t);if(n.features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var o=0;o<t.coordinates.length-1;o++){var a=!0;if((o===0||o===t.coordinates.length-2)&&(a=!1),YY(e.coordinates[r],e.coordinates[r+1],t.coordinates[o],a))return!0}return!1}function p7(e,t){var n=$m(e,WD(t));return n.features.length>0}function m7(e,t){for(var n=!1,r=!1,o=e.coordinates[0].length,a=0;a<o&&n&&r;)_o(Vr(e.coordinates[0][a]),t)?n=!0:r=!0,a++;return r&&r}function YY(e,t,n,r){var o=n[0]-e[0],a=n[1]-e[1],s=t[0]-e[0],u=t[1]-e[1],l=o*u-a*s;return l!==0?!1:r?Math.abs(s)>=Math.abs(u)?s>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:u>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]:Math.abs(s)>=Math.abs(u)?s>0?e[0]<n[0]&&n[0]<t[0]:t[0]<n[0]&&n[0]<e[0]:u>0?e[1]<n[1]&&n[1]<t[1]:t[1]<n[1]&&n[1]<e[1]}var s3=Jm(function(e,t){t=e.exports=typeof Object.keys=="function"?Object.keys:n,t.shim=n;function n(r){var o=[];for(var a in r)o.push(a);return o}}),a0t=s3.shim,KD=Jm(function(e,t){var n=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";t=e.exports=n?r:o,t.supported=r;function r(a){return Object.prototype.toString.call(a)=="[object Arguments]"}t.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}}),s0t=KD.supported,u0t=KD.unsupported,h1e=Jm(function(e){var t=Array.prototype.slice,n=e.exports=function(s,u,l){return l||(l={}),s===u?!0:s instanceof Date&&u instanceof Date?s.getTime()===u.getTime():!s||!u||typeof s!="object"&&typeof u!="object"?l.strict?s===u:s==u:a(s,u,l)};function r(s){return s==null}function o(s){return!(!s||typeof s!="object"||typeof s.length!="number"||typeof s.copy!="function"||typeof s.slice!="function"||s.length>0&&typeof s[0]!="number")}function a(s,u,l){var c,f;if(r(s)||r(u)||s.prototype!==u.prototype)return!1;if(KD(s))return KD(u)?(s=t.call(s),u=t.call(u),n(s,u,l)):!1;if(o(s)){if(!o(u)||s.length!==u.length)return!1;for(c=0;c<s.length;c++)if(s[c]!==u[c])return!1;return!0}try{var h=s3(s),d=s3(u)}catch{return!1}if(h.length!=d.length)return!1;for(h.sort(),d.sort(),c=h.length-1;c>=0;c--)if(h[c]!=d[c])return!1;for(c=h.length-1;c>=0;c--)if(f=h[c],!n(s[f],u[f],l))return!1;return typeof s==typeof u}}),Dp=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:d1e};Dp.prototype.compare=function(e,t){if(e.type!==t.type||!XY(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(e.type.indexOf("Multi")===0){var n=this,r=g7(e),o=g7(t);return r.every(function(a){return this.some(function(s){return n.compare(a,s)})},o)}}return!1};function g7(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function XY(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}Dp.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].toFixed(this.precision)!==t[n].toFixed(this.precision))return!1;return!0};Dp.prototype.compareLine=function(e,t,n,r){if(!XY(e,t))return!1;var o=this.pseudoNode?e:this.removePseudo(e),a=this.pseudoNode?t:this.removePseudo(t);if(!(r&&!this.compareCoord(o[0],a[0])&&(a=this.fixStartIndex(a,o),!a))){var s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}};Dp.prototype.fixStartIndex=function(e,t){for(var n,r=-1,o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){r=o;break}return r>=0&&(n=[].concat(e.slice(r,e.length),e.slice(1,r+1))),n};Dp.prototype.comparePath=function(e,t){var n=this;return e.every(function(r,o){return n.compareCoord(r,this[o])},t)};Dp.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var n=e.coordinates.slice(1,e.coordinates.length),r=t.coordinates.slice(1,t.coordinates.length),o=this;return n.every(function(a){return this.some(function(s){return o.compareLine(a,s,1,!0)})},r)}else return!1};Dp.prototype.compareFeature=function(e,t){return e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t)?!1:this.compare(e.geometry,t.geometry)};Dp.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))};Dp.prototype.removePseudo=function(e){return e};function d1e(e,t){return h1e(e,t,{strict:!0})}var jY=Dp;function KY(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Ri(e),r=Ri(t);if(n!==r)throw new Error("features must be of the same type");if(n==="Point")throw new Error("Point geometry not supported");var o=new jY({precision:6});if(o.compare(e,t))return!1;var a=0;switch(n){case"MultiPoint":var s=Cp(e),u=Cp(t);s.forEach(function(l){u.forEach(function(c){l[0]===c[0]&&l[1]===c[1]&&a++})});break;case"LineString":case"MultiLineString":Fm(e,function(l){Fm(t,function(c){kY(l,c).features.length&&a++})});break;case"Polygon":case"MultiPolygon":Fm(e,function(l){Fm(t,function(c){$m(l,c).features.length&&a++})});break}return a>0}function p1e(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Ri(e),r=Ri(t);if(n!==r)return!1;var o=new jY({precision:6});return o.compare(Um(e),Um(t))}var m1e=Jm(function(e){function t(n,r,o,a){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,o,a)}t.prototype.run=function(n,r,o,a){this._init(n,r,o,a);for(var s=0;s<this._datasetLength;s++)if(this._visited[s]!==1){this._visited[s]=1;var u=this._regionQuery(s);if(u.length<this.minPts)this.noise.push(s);else{var l=this.clusters.length;this.clusters.push([]),this._addToCluster(s,l),this._expandCluster(l,u)}}return this.clusters},t.prototype._init=function(n,r,o,a){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),o&&(this.minPts=o),a&&(this.distance=a)},t.prototype._expandCluster=function(n,r){for(var o=0;o<r.length;o++){var a=r[o];if(this._visited[a]!==1){this._visited[a]=1;var s=this._regionQuery(a);s.length>=this.minPts&&(r=this._mergeArrays(r,s))}this._assigned[a]!==1&&this._addToCluster(a,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],o=0;o<this._datasetLength;o++){var a=this.distance(this.dataset[n],this.dataset[o]);a<this.epsilon&&r.push(o)}return r},t.prototype._mergeArrays=function(n,r){for(var o=r.length,a=0;a<o;a++){var s=r[a];n.indexOf(s)<0&&n.push(s)}return n},t.prototype._euclideanDistance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;)o+=(n[a]-r[a])*(n[a]-r[a]);return Math.sqrt(o)},e.exports&&(e.exports=t)}),g1e=Jm(function(e){function t(n,r,o){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,o)}t.prototype.init=function(n,r,o){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof o<"u"&&(this.distance=o)},t.prototype.run=function(n,r){this.init(n,r);for(var o=this.dataset.length,a=0;a<this.k;a++)this.centroids[a]=this.randomCentroid();for(var s=!0;s;){s=this.assign();for(var u=0;u<this.k;u++){for(var l=new Array(d),c=0,f=0;f<d;f++)l[f]=0;for(var h=0;h<o;h++){var d=this.dataset[h].length;if(u===this.assignments[h]){for(var f=0;f<d;f++)l[f]+=this.dataset[h][f];c++}}if(c>0){for(var f=0;f<d;f++)l[f]/=c;this.centroids[u]=l}else this.centroids[u]=this.randomCentroid(),s=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,o;do o=Math.round(Math.random()*n),r=this.dataset[o];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,o,a=0;a<r;a++)o=this.argmin(this.dataset[a],this.centroids,this.distance),o!=this.assignments[a]&&(this.assignments[a]=o,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,o=0;o<this.assignments.length;o++)r=this.assignments[o],typeof n[r]>"u"&&(n[r]=[]),n[r].push(o);return n},t.prototype.argmin=function(n,r,o){for(var a=Number.MAX_VALUE,s=0,u=r.length,l,c=0;c<u;c++)l=o(n,r[c]),l<a&&(a=l,s=c);return s},t.prototype.distance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;){var s=n[a]-r[a];o+=s*s}return Math.sqrt(o)},e.exports&&(e.exports=t)}),ZY=Jm(function(e){function t(n,r,o){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,o)}t.prototype.insert=function(n,r){for(var o=this._queue.length,a=o;a--;){var s=this._priorities[a];this._sorting==="desc"?r>s&&(o=a):r<s&&(o=a)}this._insertAt(n,r,o)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var o=this._queue[r];if(n===o){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,o=this._queue.length;r<o;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,o){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var a=0;a<n.length;a++)this.insert(n[a],r[a])}o&&(this._sorting=o)},t.prototype._insertAt=function(n,r,o){this._queue.length===o?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(o,0,n),this._priorities.splice(o,0,r))},e.exports&&(e.exports=t)}),_1e=Jm(function(e){if(e.exports)var t=ZY;function n(r,o,a,s){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,o,a,s)}n.prototype.run=function(r,o,a,s){this._init(r,o,a,s);for(var u=0,l=this.dataset.length;u<l;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var c=this.clusters.length-1;this._orderedList.push(u);var f=new t(null,null,"asc"),h=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,h,f),this._expandCluster(c,f))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],o=0,a=this._orderedList.length;o<a;o++){var s=this._orderedList[o],u=this._reachability[s];r.push([s,u])}return r},n.prototype._init=function(r,o,a,s){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}o&&(this.epsilon=o),a&&(this.minPts=a),s&&(this.distance=s)},n.prototype._updateQueue=function(r,o,a){var s=this;this._coreDistance=this._distanceToCore(r),o.forEach(function(u){if(s._processed[u]===void 0){var l=s.distance(s.dataset[r],s.dataset[u]),c=Math.max(s._coreDistance,l);s._reachability[u]===void 0?(s._reachability[u]=c,a.insert(u,c)):c<s._reachability[u]&&(s._reachability[u]=c,a.remove(u),a.insert(u,c))}})},n.prototype._expandCluster=function(r,o){for(var a=o.getElements(),s=0,u=a.length;s<u;s++){var l=a[s];if(this._processed[l]===void 0){var c=this._regionQuery(l);this._processed[l]=1,this.clusters[r].push(l),this._orderedList.push(l),this._distanceToCore(l)!==void 0&&(this._updateQueue(l,c,o),this._expandCluster(r,o))}}},n.prototype._distanceToCore=function(r){for(var o=this.epsilon,a=0;a<o;a++){var s=this._regionQuery(r,a);if(s.length>=this.minPts)return a}},n.prototype._regionQuery=function(r,o){o=o||this.epsilon;for(var a=[],s=0,u=this.dataset.length;s<u;s++)this.distance(this.dataset[r],this.dataset[s])<o&&a.push(s);return a},n.prototype._euclideanDistance=function(r,o){for(var a=0,s=Math.min(r.length,o.length);s--;)a+=(r[s]-o[s])*(r[s]-o[s]);return Math.sqrt(a)},e.exports&&(e.exports=n)}),FT=Jm(function(e){e.exports&&(e.exports={DBSCAN:m1e,KMEANS:g1e,OPTICS:_1e,PriorityQueue:ZY})}),l0t=FT.DBSCAN,c0t=FT.KMEANS,f0t=FT.OPTICS,h0t=FT.PriorityQueue;function y1e(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.minPoints,o=n.units;if(xd(e,"Point","Input must contain Points"),t==null)throw new Error("maxDistance is required");if(!(Math.sign(t)>0))throw new Error("Invalid maxDistance");if(!(r==null||Math.sign(r)>0))throw new Error("Invalid minPoints");e=ru(e,!0),r=r||3;var a=new FT.DBSCAN,s=a.run(Cp(e),dy(t,o),r,si),u=-1;return s.forEach(function(l){u++,l.forEach(function(c){var f=e.features[c];f.properties||(f.properties={}),f.properties.cluster=u,f.properties.dbscan="core"})}),a.noise.forEach(function(l){var c=e.features[l];c.properties||(c.properties={}),c.properties.cluster?c.properties.dbscan="edge":c.properties.dbscan="noise"}),e}var k3={eudist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++){var u=(t[s]||0)-(n[s]||0);a+=u*u}return r?Math.sqrt(a):a},mandist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++)a+=Math.abs((t[s]||0)-(n[s]||0));return r?Math.sqrt(a):a},dist:function(t,n,r){var o=Math.abs(t-n);return r?o:o*o}},v1e=k3.eudist,C1e=k3.dist,QY={kmrand:function(t,n){for(var r={},o=[],a=n<<2,s=t.length,u=t[0].length>0;o.length<n&&a-- >0;){var l=t[Math.floor(Math.random()*s)],c=u?l.join("_"):""+l;r[c]||(r[c]=!0,o.push(l))}if(o.length<n)throw new Error("Error initializating clusters");return o},kmpp:function(t,n){var r=t[0].length?v1e:C1e,o=[],a=t.length,s=t[0].length>0,u=t[Math.floor(Math.random()*a)],l=s?u.join("_"):""+u;for(o.push(u);o.length<n;){for(var c=[],f=o.length,h=0,d=[],p=0;p<a;p++){for(var g=1/0,y=0;y<f;y++){var v=r(t[p],o[y]);v<=g&&(g=v)}c[p]=g}for(var w=0;w<a;w++)h+=c[w];for(var C=0;C<a;C++)d[C]={i:C,v:t[C],pr:c[C]/h,cs:0};d.sort(function(D,P){return D.pr-P.pr}),d[0].cs=d[0].pr;for(var E=1;E<a;E++)d[E].cs=d[E-1].cs+d[E].pr;for(var S=Math.random(),A=0;A<a-1&&d[A++].cs<S;);o.push(d[A-1].v)}return o}},x1e=k3.eudist,w1e=QY.kmrand,E1e=QY.kmpp,_7=1e4;function y7(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function T1e(e,t,n,r){var o=[],a=[],s=[],u=[],l=!1,c=r||_7,f=e.length,h=e[0].length,d=h>0,p=[];if(n)n=="kmrand"?o=w1e(e,t):n=="kmpp"?o=E1e(e,t):o=n;else for(var g={};o.length<t;){var y=Math.floor(Math.random()*f);g[y]||(g[y]=!0,o.push(e[y]))}do{y7(t,0,p);for(var v=0;v<f;v++){for(var w=1/0,C=0,E=0;E<t;E++){var u=d?x1e(e[v],o[E]):Math.abs(e[v]-o[E]);u<=w&&(w=u,C=E)}s[v]=C,p[C]++}for(var S=[],a=[],A=0;A<t;A++)S[A]=d?y7(h,0,S[A]):0,a[A]=o[A];if(d){for(var D=0;D<t;D++)o[D]=[];for(var P=0;P<f;P++)for(var M=s[P],I=S[M],O=e[P],m=0;m<h;m++)I[m]+=O[m];l=!0;for(var b=0;b<t;b++){for(var L=o[b],R=S[b],N=a[b],B=p[b],G=0;G<h;G++)L[G]=R[G]/B||0;if(l){for(var F=0;F<h;F++)if(N[F]!=L[F]){l=!1;break}}}}else{for(var k=0;k<f;k++){var Z=s[k];S[Z]+=e[k]}for(var te=0;te<t;te++)o[te]=S[te]/p[te]||0;l=!0;for(var oe=0;oe<t;oe++)if(a[oe]!=o[oe]){l=!1;break}}l=l||--c<=0}while(!l);return{it:_7-c,k:t,idxs:s,centroids:o}}var S1e=T1e;function A1e(e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.numberOfClusters,r=t.mutate;xd(e,"Point","Input must contain Points");var o=e.features.length;n=n||Math.round(Math.sqrt(o/2)),n>o&&(n=o),(r===!1||r===void 0)&&(e=ru(e,!0));var a=Cp(e),s=a.slice(0,n),u=S1e(a,n,s),l={};return u.centroids.forEach(function(c,f){l[f]=c}),li(e,function(c,f){var h=u.idxs[f];c.properties.cluster=h,c.properties.centroid=l[h]}),e}function b1e(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var n=v7(e,"line1");if(n!=="LineString")throw new Error("line1 must be a LineString");var r=v7(t,"line2");if(r!=="LineString")throw new Error("line2 must be a LineString");for(var o=my(Um(e)).features,a=my(Um(t)).features,s=0;s<o.length;s++){var u=o[s].geometry.coordinates;if(!a[s])break;var l=a[s].geometry.coordinates;if(!D1e(u,l))return!1}return!0}function I1e(e,t){var n=!1;return ko(e,function(r){ko(t,function(o){if(n===!0)return!0;n=!qY(r.geometry,o.geometry)})}),n}function D1e(e,t){var n=_0(y0(e[0],e[1])),r=_0(y0(t[0],t[1]));return n===r}function v7(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function C7(e){for(var t=e,n=[];t.parent;)n.unshift(t),t=t.parent;return n}function P1e(){return new JY(function(e){return e.f})}var _P={search:function(e,t,n,r){e.cleanDirty(),r=r||{};var o=r.heuristic||_P.heuristics.manhattan,a=r.closest||!1,s=P1e(),u=t;for(t.h=o(t,n),s.push(t);s.size()>0;){var l=s.pop();if(l===n)return C7(l);l.closed=!0;for(var c=e.neighbors(l),f=0,h=c.length;f<h;++f){var d=c[f];if(!(d.closed||d.isWall())){var p=l.g+d.getCost(l),g=d.visited;(!g||p<d.g)&&(d.visited=!0,d.parent=l,d.h=d.h||o(d,n),d.g=p,d.f=d.g+d.h,e.markDirty(d),a&&(d.h<u.h||d.h===u.h&&d.g<u.g)&&(u=d),g?s.rescoreElement(d):s.push(d))}}}return a?C7(u):[]},heuristics:{manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},diagonal:function(e,t){var n=1,r=Math.sqrt(2),o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return n*(o+a)+(r-2*n)*Math.min(o,a)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function _1(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var n=0;n<e.length;n++){this.grid[n]=[];for(var r=0,o=e[n];r<o.length;r++){var a=new yP(n,r,o[r]);this.grid[n][r]=a,this.nodes.push(a)}}this.init()}_1.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)_P.cleanNode(this.nodes[e])};_1.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)_P.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};_1.prototype.markDirty=function(e){this.dirtyNodes.push(e)};_1.prototype.neighbors=function(e){var t=[],n=e.x,r=e.y,o=this.grid;return o[n-1]&&o[n-1][r]&&t.push(o[n-1][r]),o[n+1]&&o[n+1][r]&&t.push(o[n+1][r]),o[n]&&o[n][r-1]&&t.push(o[n][r-1]),o[n]&&o[n][r+1]&&t.push(o[n][r+1]),this.diagonal&&(o[n-1]&&o[n-1][r-1]&&t.push(o[n-1][r-1]),o[n+1]&&o[n+1][r-1]&&t.push(o[n+1][r-1]),o[n-1]&&o[n-1][r+1]&&t.push(o[n-1][r+1]),o[n+1]&&o[n+1][r+1]&&t.push(o[n+1][r+1])),t};_1.prototype.toString=function(){for(var e=[],t=this.grid,n,r,o,a,s=0,u=t.length;s<u;s++){for(n=[],r=t[s],o=0,a=r.length;o<a;o++)n.push(r[o].weight);e.push(n.join(" "))}return e.join(`
`)};function yP(e,t,n){this.x=e,this.y=t,this.weight=n}yP.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};yP.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};yP.prototype.isWall=function(){return this.weight===0};function JY(e){this.content=[],this.scoreFunction=e}JY.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r))this.content[n]=t,this.content[e]=r,e=n;else break}},bubbleUp:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,a=o-1,s=null,u;if(a<t){var l=this.content[a];u=this.scoreFunction(l),u<r&&(s=a)}if(o<t){var c=this.content[o],f=this.scoreFunction(c);f<(s===null?r:u)&&(s=o)}if(s!==null)this.content[e]=this.content[s],this.content[s]=n,e=s;else break}}};function M1e(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.resolution,o=n.minDistance,a=n.obstacles||Bt([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(r&&!ui(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(o)throw new Error("options.minDistance is not yet implemented");var s=ao(e),u=ao(t);switch(e=Vr(s),t=Vr(u),Ri(a)){case"FeatureCollection":if(a.features.length===0)return Li([s,u]);break;case"Polygon":a=Bt([ra(Bl(a))]);break;default:throw new Error("invalid obstacles")}var l=a;l.features.push(e),l.features.push(t);var c=Ca(UY(S3(Ca(l)),1.15));if(!r){var f=si([c[0],c[1]],[c[2],c[1]],n);r=f/100}l.features.pop(),l.features.pop();for(var h=c[0],d=c[1],p=c[2],g=c[3],y=r/si([h,d],[p,d],n),v=y*(p-h),w=r/si([h,d],[h,g],n),C=w*(g-d),E=p-h,S=g-d,A=Math.floor(E/v),D=Math.floor(S/C),P=(E-A*v)/2,M=(S-D*C)/2,I=[],O=[],m=[],b=[],L=1/0,R=1/0,N=g-M,B=0;N>=d;){for(var G=[],F=[],k=h+P,Z=0;k<=p;){var te=Vr([k,N]),oe=L1e(te,a);G.push(oe?0:1),F.push(k+"|"+N);var ue=si(te,e);!oe&&ue<L&&(L=ue,m={x:Z,y:B});var pe=si(te,t);!oe&&pe<R&&(R=pe,b={x:Z,y:B}),k+=v,Z++}O.push(G),I.push(F),N-=C,B++}var me=new _1(O,{diagonal:!0}),st=me.grid[m.y][m.x],ht=me.grid[b.y][b.x],jt=_P.search(me,st,ht),Ct=[s];return jt.forEach(function(bt){var mn=I[bt.x][bt.y].split("|");Ct.push([+mn[0],+mn[1]])}),Ct.push(u),Um(Li(Ct))}function L1e(e,t){for(var n=0;n<t.features.length;n++)if(_o(e,t.features[n]))return!0;return!1}var x7=function(e){return function(){return e}};function R1e(e){return e[0]}function O1e(e){return e[1]}function ZD(){this._=null}function vP(e){e.U=e.C=e.L=e.R=e.P=e.N=null}ZD.prototype={constructor:ZD,insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=w7(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(o=r.R,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(ZE(this,n),e=n,n=e.U),n.C=!1,r.C=!0,QE(this,r))):(o=r.L,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(QE(this,n),e=n,n=e.U),n.C=!1,r.C=!0,ZE(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,o=e.R,a,s;if(r?o?a=w7(o):a=r:a=o,t?t.L===e?t.L=a:t.R=a:this._=a,r&&o?(s=a.C,a.C=e.C,a.L=r,r.U=a,a!==o?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=o,o.U=a):(a.U=t,t=a,e=a.R)):(s=e.C,e=a),e&&(e.U=t),!s){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,ZE(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,QE(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,ZE(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,QE(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,ZE(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,QE(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function ZE(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function QE(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function w7(e){for(;e.L;)e=e.L;return e}function aT(e,t,n,r){var o=[null,null],a=rl.push(o)-1;return o.left=e,o.right=t,n&&QD(o,e,t,n),r&&QD(o,t,e,r),Kc[e.index].halfedges.push(a),Kc[t.index].halfedges.push(a),o}function JE(e,t,n){var r=[t,n];return r.left=e,r}function QD(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function N1e(e,t,n,r,o){var a=e[0],s=e[1],u=a[0],l=a[1],c=s[0],f=s[1],h=0,d=1,p=c-u,g=f-l,y;if(y=t-u,!(!p&&y>0)){if(y/=p,p<0){if(y<h)return;y<d&&(d=y)}else if(p>0){if(y>d)return;y>h&&(h=y)}if(y=r-u,!(!p&&y<0)){if(y/=p,p<0){if(y>d)return;y>h&&(h=y)}else if(p>0){if(y<h)return;y<d&&(d=y)}if(y=n-l,!(!g&&y>0)){if(y/=g,g<0){if(y<h)return;y<d&&(d=y)}else if(g>0){if(y>d)return;y>h&&(h=y)}if(y=o-l,!(!g&&y<0)){if(y/=g,g<0){if(y>d)return;y>h&&(h=y)}else if(g>0){if(y<h)return;y<d&&(d=y)}return!(h>0)&&!(d<1)||(h>0&&(e[0]=[u+h*p,l+h*g]),d<1&&(e[1]=[u+d*p,l+d*g])),!0}}}}}function B1e(e,t,n,r,o){var a=e[1];if(a)return!0;var s=e[0],u=e.left,l=e.right,c=u[0],f=u[1],h=l[0],d=l[1],p=(c+h)/2,g=(f+d)/2,y,v;if(d===f){if(p<t||p>=r)return;if(c>h){if(!s)s=[p,n];else if(s[1]>=o)return;a=[p,o]}else{if(!s)s=[p,o];else if(s[1]<n)return;a=[p,n]}}else if(y=(c-h)/(d-f),v=g-y*p,y<-1||y>1)if(c>h){if(!s)s=[(n-v)/y,n];else if(s[1]>=o)return;a=[(o-v)/y,o]}else{if(!s)s=[(o-v)/y,o];else if(s[1]<n)return;a=[(n-v)/y,n]}else if(f<d){if(!s)s=[t,y*t+v];else if(s[0]>=r)return;a=[r,y*r+v]}else{if(!s)s=[r,y*r+v];else if(s[0]<t)return;a=[t,y*t+v]}return e[0]=s,e[1]=a,!0}function F1e(e,t,n,r){for(var o=rl.length,a;o--;)(!B1e(a=rl[o],e,t,n,r)||!N1e(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>oo||Math.abs(a[0][1]-a[1][1])>oo))&&delete rl[o]}function z1e(e){return Kc[e.index]={site:e,halfedges:[]}}function V1e(e,t){var n=e.site,r=t.left,o=t.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=t[1],o=t[0]):(r=t[0],o=t[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function $Y(e,t){return t[+(t.left!==e.site)]}function k1e(e,t){return t[+(t.left===e.site)]}function G1e(){for(var e=0,t=Kc.length,n,r,o,a;e<t;++e)if((n=Kc[e])&&(a=(r=n.halfedges).length)){var s=new Array(a),u=new Array(a);for(o=0;o<a;++o)s[o]=o,u[o]=V1e(n,rl[r[o]]);for(s.sort(function(l,c){return u[c]-u[l]}),o=0;o<a;++o)u[o]=r[s[o]];for(o=0;o<a;++o)r[o]=u[o]}}function U1e(e,t,n,r){var o=Kc.length,a,s,u,l,c,f,h,d,p,g,y,v,w=!0;for(a=0;a<o;++a)if(s=Kc[a]){for(u=s.site,c=s.halfedges,l=c.length;l--;)rl[c[l]]||c.splice(l,1);for(l=0,f=c.length;l<f;)g=k1e(s,rl[c[l]]),y=g[0],v=g[1],h=$Y(s,rl[c[++l%f]]),d=h[0],p=h[1],(Math.abs(y-d)>oo||Math.abs(v-p)>oo)&&(c.splice(l,0,rl.push(JE(u,g,Math.abs(y-e)<oo&&r-v>oo?[e,Math.abs(d-e)<oo?p:r]:Math.abs(v-r)<oo&&n-y>oo?[Math.abs(p-r)<oo?d:n,r]:Math.abs(y-n)<oo&&v-t>oo?[n,Math.abs(d-n)<oo?p:t]:Math.abs(v-t)<oo&&y-e>oo?[Math.abs(p-t)<oo?d:e,t]:null))-1),++f);f&&(w=!1)}if(w){var C,E,S,A=1/0;for(a=0,w=null;a<o;++a)(s=Kc[a])&&(u=s.site,C=u[0]-e,E=u[1]-t,S=C*C+E*E,S<A&&(A=S,w=s));if(w){var D=[e,t],P=[e,r],M=[n,r],I=[n,t];w.halfedges.push(rl.push(JE(u=w.site,D,P))-1,rl.push(JE(u,P,M))-1,rl.push(JE(u,M,I))-1,rl.push(JE(u,I,D))-1)}}for(a=0;a<o;++a)(s=Kc[a])&&(s.halfedges.length||delete Kc[a])}var eX=[],G3;function H1e(){vP(this),this.x=this.y=this.arc=this.site=this.cy=null}function GC(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,o=e.site,a=n.site;if(r!==a){var s=o[0],u=o[1],l=r[0]-s,c=r[1]-u,f=a[0]-s,h=a[1]-u,d=2*(l*h-c*f);if(!(d>=-j1e)){var p=l*l+c*c,g=f*f+h*h,y=(h*p-c*g)/d,v=(l*g-f*p)/d,w=eX.pop()||new H1e;w.arc=e,w.site=o,w.x=y+s,w.y=(w.cy=v+u)+Math.sqrt(y*y+v*v),e.circle=w;for(var C=null,E=yT._;E;)if(w.y<E.y||w.y===E.y&&w.x<=E.x)if(E.L)E=E.L;else{C=E.P;break}else if(E.R)E=E.R;else{C=E;break}yT.insert(C,w),C||(G3=w)}}}}function HC(e){var t=e.circle;t&&(t.P||(G3=t.N),yT.remove(t),eX.push(t),vP(t),e.circle=null)}var tX=[];function q1e(){vP(this),this.edge=this.site=this.circle=null}function E7(e){var t=tX.pop()||new q1e;return t.site=e,t}function W2(e){HC(e),qC.remove(e),tX.push(e),vP(e)}function W1e(e){var t=e.circle,n=t.x,r=t.cy,o=[n,r],a=e.P,s=e.N,u=[e];W2(e);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<oo&&Math.abs(r-l.circle.cy)<oo;)a=l.P,u.unshift(l),W2(l),l=a;u.unshift(l),HC(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<oo&&Math.abs(r-c.circle.cy)<oo;)s=c.N,u.push(c),W2(c),c=s;u.push(c),HC(c);var f=u.length,h;for(h=1;h<f;++h)c=u[h],l=u[h-1],QD(c.edge,l.site,c.site,o);l=u[0],c=u[f-1],c.edge=aT(l.site,c.site,null,o),GC(l),GC(c)}function Y1e(e){for(var t=e[0],n=e[1],r,o,a,s,u=qC._;u;)if(a=nX(u,n)-t,a>oo)u=u.L;else if(s=t-X1e(u,n),s>oo){if(!u.R){r=u;break}u=u.R}else{a>-oo?(r=u.P,o=u):s>-oo?(r=u,o=u.N):r=o=u;break}z1e(e);var l=E7(e);if(qC.insert(r,l),!(!r&&!o)){if(r===o){HC(r),o=E7(r.site),qC.insert(l,o),l.edge=o.edge=aT(r.site,l.site),GC(r),GC(o);return}if(!o){l.edge=aT(r.site,l.site);return}HC(r),HC(o);var c=r.site,f=c[0],h=c[1],d=e[0]-f,p=e[1]-h,g=o.site,y=g[0]-f,v=g[1]-h,w=2*(d*v-p*y),C=d*d+p*p,E=y*y+v*v,S=[(v*C-p*E)/w+f,(d*E-y*C)/w+h];QD(o.edge,c,g,S),l.edge=aT(c,e,null,S),o.edge=aT(e,g,null,S),GC(r),GC(o)}}function nX(e,t){var n=e.site,r=n[0],o=n[1],a=o-t;if(!a)return r;var s=e.P;if(!s)return-1/0;n=s.site;var u=n[0],l=n[1],c=l-t;if(!c)return u;var f=u-r,h=1/a-1/c,d=f/c;return h?(-d+Math.sqrt(d*d-2*h*(f*f/(-2*c)-l+c/2+o-a/2)))/h+r:(r+u)/2}function X1e(e,t){var n=e.N;if(n)return nX(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var oo=1e-6,j1e=1e-12,qC,Kc,yT,rl;function K1e(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function Z1e(e,t){return t[1]-e[1]||t[0]-e[0]}function u3(e,t){var n=e.sort(Z1e).pop(),r,o,a;for(rl=[],Kc=new Array(e.length),qC=new ZD,yT=new ZD;;)if(a=G3,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==o)&&(Y1e(n),r=n[0],o=n[1]),n=e.pop();else if(a)W1e(a.arc);else break;if(G1e(),t){var s=+t[0][0],u=+t[0][1],l=+t[1][0],c=+t[1][1];F1e(s,u,l,c),U1e(s,u,l,c)}this.edges=rl,this.cells=Kc,qC=yT=rl=Kc=null}u3.prototype={constructor:u3,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return $Y(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(!!(u=(a=n.halfedges).length))for(var o=n.site,a,s=-1,u,l,c=t[a[u-1]],f=c.left===o?c.right:c.left;++s<u;)l=f,c=t[a[s]],f=c.left===o?c.right:c.left,l&&f&&r<l.index&&r<f.index&&K1e(o,l,f)<0&&e.push([o.data,l.data,f.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,o,a=r._found||0,s=r.cells.length,u;!(u=r.cells[a]);)if(++a>=s)return null;var l=e-u.site[0],c=t-u.site[1],f=l*l+c*c;do u=r.cells[o=a],a=null,u.halfedges.forEach(function(h){var d=r.edges[h],p=d.left;if(!((p===u.site||!p)&&!(p=d.right))){var g=e-p[0],y=t-p[1],v=g*g+y*y;v<f&&(f=v,a=p.index)}});while(a!==null);return r._found=o,n==null||f<=n*n?u.site:null}};var Q1e=function(){var e=R1e,t=O1e,n=null;function r(o){return new u3(o.map(function(a,s){var u=[Math.round(e(a,s,o)/oo)*oo,Math.round(t(a,s,o)/oo)*oo];return u.index=s,u.data=a,u}),n)}return r.polygons=function(o){return r(o).polygons()},r.links=function(o){return r(o).links()},r.triangles=function(o){return r(o).triangles()},r.x=function(o){return arguments.length?(e=typeof o=="function"?o:x7(+o),r):e},r.y=function(o){return arguments.length?(t=typeof o=="function"?o:x7(+o),r):t},r.extent=function(o){return arguments.length?(n=o==null?null:[[+o[0][0],+o[0][1]],[+o[1][0],+o[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(o){return arguments.length?(n=o==null?null:[[0,0],[+o[0],+o[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r};function J1e(e){return e=e.slice(),e.push(e[0]),Dn([e])}function $1e(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return xd(e,"Point","points"),Bt(Q1e().x(function(r){return r.geometry.coordinates[0]}).y(function(r){return r.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(J1e))}function rX(e,t,n,r){r=r||{};var o=r.steps||64,a=r.units||"kilometers",s=r.angle||0,u=r.pivot||e,l=r.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!pt(r))throw new Error("options must be an object");if(!ui(o))throw new Error("steps must be a number");if(!ui(s))throw new Error("angle must be a number");var c=ao(e);if(a==="degrees")var f=qa(s);else t=XC(e,t,90,{units:a}),n=XC(e,n,0,{units:a}),t=ao(t)[0]-c[0],n=ao(n)[1]-c[1];for(var h=[],d=0;d<o;d+=1){var p=d*-360/o,g=t*n/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)*Math.pow(T7(p),2)),y=t*n/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)/Math.pow(T7(p),2));if(p<-90&&p>=-270&&(g=-g),p<-180&&p>=-360&&(y=-y),a==="degrees"){var v=g*Math.cos(f)+y*Math.sin(f),w=y*Math.cos(f)-g*Math.sin(f);g=v,y=w}h.push([g+c[0],y+c[1]])}return h.push(h[0]),a==="degrees"?Dn([h],l):GY(Dn([h],l),s,{pivot:u})}function T7(e){var t=e*Math.PI/180;return Math.tan(t)}function U3(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.properties,r=t.weight;if(!e)throw new Error("geojson is required");var o=0,a=0,s=0;return ih(e,function(u,l,c){var f=c[r];if(f=f??1,!ui(f))throw new Error("weight value must be a number for feature index "+l);f=Number(f),f>0&&Wa(u,function(h){o+=h[0]*f,a+=h[1]*f,s+=f})}),Vr([o/s,a/s],n)}function exe(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.counter||10;if(!ui(n))throw new Error("counter must be a number");var r=t.weight,o=U3(e,{weight:t.weight}),a=Bt([]);return li(e,function(s){a.features.push(py(s,{weight:s.properties[r]}))}),a.properties={tolerance:t.tolerance,medianCandidates:[]},iX(o.geometry.coordinates,[0,0],a,n)}function iX(e,t,n,r){var o=n.properties.tolerance||.001,a=0,s=0,u=0,l=0;if(li(n,function(h){var d=h.properties.weight,p=d??1;if(p=Number(p),!ui(p))throw new Error("weight value must be a number");if(p>0){l+=1;var g=p*si(h,e);g===0&&(g=1);var y=p/g;a+=h.geometry.coordinates[0]*y,s+=h.geometry.coordinates[1]*y,u+=y}}),l<1)throw new Error("no features to measure");var c=a/u,f=s/u;return l===1||r===0||Math.abs(c-t[0])<o&&Math.abs(f-t[1])<o?Vr([c,f],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,f]),iX([c,f],e,n,r-1))}function txe(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.steps||64,r=t.weight,o=t.properties||{};if(!ui(n))throw new Error("steps must be a number");if(!pt(o))throw new Error("properties must be a number");var a=Cp(e).length,s=U3(e,{weight:r}),u=0,l=0,c=0;li(e,function(P){var M=P.properties[r]||1,I=S7(wt(P),wt(s));u+=Math.pow(I.x,2)*M,l+=Math.pow(I.y,2)*M,c+=I.x*I.y*M});var f=u-l,h=Math.sqrt(Math.pow(f,2)+4*Math.pow(c,2)),d=2*c,p=Math.atan((f+h)/d),g=p*180/Math.PI,y=0,v=0,w=0;li(e,function(P){var M=P.properties[r]||1,I=S7(wt(P),wt(s));y+=Math.pow(I.x*Math.cos(p)-I.y*Math.sin(p),2)*M,v+=Math.pow(I.x*Math.sin(p)+I.y*Math.cos(p),2)*M,w+=M});var C=Math.sqrt(2*y/w),E=Math.sqrt(2*v/w),S=rX(s,C,E,{units:"degrees",angle:g,steps:n,properties:o}),A=K2(e,Bt([S])),D={meanCenterCoordinates:wt(s),semiMajorAxis:C,semiMinorAxis:E,numberOfFeatures:a,angle:g,percentageWithinEllipse:100*Cp(A).length/a};return S.properties.standardDeviationalEllipse=D,S}function S7(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function zT(e){if(pt(e)&&(e=e.bbox),e&&!Array.isArray(e))throw new Error("bbox is invalid");return e?oxe(e):[rxe(),ixe()]}function oX(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.bbox;e==null&&(e=1);for(var r=[],o=0;o<e;o++)r.push(Vr(zT(n)));return Bt(r)}function aX(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_radial_length;e==null&&(e=1),ui(r)||(r=10),ui(o)||(o=10);for(var a=[],s=0;s<e;s++){var u=[],l=Array.apply(null,new Array(r+1)).map(Math.random);l.forEach(c),l.forEach(f),u[u.length-1]=u[0],u=u.map(nxe(zT(n))),a.push(Dn([u]))}function c(h,d,p){p[d]=d>0?h+p[d-1]:h}function f(h){h=h*2*Math.PI/l[l.length-1];var d=Math.random();u.push([d*o*Math.sin(h),d*o*Math.cos(h)])}return Bt(a)}function sX(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_length,a=t.max_rotation;e==null&&(e=1),(!ui(r)||r<2)&&(r=10),ui(o)||(o=1e-4),ui(a)||(a=Math.PI/8);for(var s=[],u=0;u<e;u++){for(var l=zT(n),c=[l],f=0;f<r-1;f++){var h=f===0?Math.random()*2*Math.PI:Math.tan((c[f][1]-c[f-1][1])/(c[f][0]-c[f-1][0])),d=h+(Math.random()-.5)*a*2,p=Math.random()*o;c.push([c[f][0]+p*Math.cos(d),c[f][1]+p*Math.sin(d)])}s.push(Li(c))}return Bt(s)}function nxe(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function uX(){return Math.random()-.5}function rxe(){return uX()*360}function ixe(){return uX()*180}function oxe(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var axe=Object.freeze({randomPosition:zT,randomPoint:oX,randomPolygon:aX,randomLineString:sX});function lX(e,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var n=[];return li(e,function(r){CP(r.properties,t)&&n.push(r)}),Bt(n)}function H3(e,t,n){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var r=q3(e,t),o=Object.keys(r),a=0;a<o.length;a++){for(var s=o[a],u=r[s],l=[],c=0;c<u.length;c++)l.push(e.features[u[c]]);n(Bt(l),s,a)}}function cX(e,t,n,r){var o=r;return H3(e,t,function(a,s,u){u===0&&r===void 0?o=a:o=n(o,a,s,u)}),o}function q3(e,t){var n={};return li(e,function(r,o){var a=r.properties||{};if(a.hasOwnProperty(t)){var s=a[t];n.hasOwnProperty(s)?n[s].push(o):n[s]=[o]}}),n}function CP(e,t){if(e===void 0)return!1;var n=typeof t;if(n==="number"||n==="string")return e.hasOwnProperty(t);if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(!CP(e,t[r]))return!1;return!0}else return W3(e,t)}function W3(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];if(e[o]!==t[o])return!1}return!0}function fX(e,t){if(!t)return{};if(!t.length)return{};for(var n={},r=0;r<t.length;r++){var o=t[r];e.hasOwnProperty(o)&&(n[o]=e[o])}return n}var sxe=Object.freeze({getCluster:lX,clusterEach:H3,clusterReduce:cX,createBins:q3,applyFilter:CP,propertiesContainsFilter:W3,filterProperties:fX});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(a=a<0?Math.max(r+arguments[2],0):Math.min(a,r);o<a;)n[o]=t,++o;return n},writable:!0});Number.isFinite=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)};Number.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(e){return e!==e};Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var gy=function(){};gy.prototype.interfaces_=function(){return[]};gy.prototype.getClass=function(){return gy};gy.prototype.equalsWithTolerance=function(t,n,r){return Math.abs(t-n)<=r};var so=function(){},Wt=function(){},hX={MAX_VALUE:{configurable:!0}};Wt.isNaN=function(t){return Number.isNaN(t)};Wt.doubleToLongBits=function(t){return t};Wt.longBitsToDouble=function(t){return t};Wt.isInfinite=function(t){return!Number.isFinite(t)};hX.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Wt,hX);var wc=function(){},xP=function(){},jC=function(){};function Ec(){}var ae=function e(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Iy={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ae.prototype.setOrdinate=function(t,n){switch(t){case ae.X:this.x=n;break;case ae.Y:this.y=n;break;case ae.Z:this.z=n;break;default:throw new so("Invalid ordinate index: "+t)}};ae.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!gy.equalsWithTolerance(this.x,n.x,r)||!gy.equalsWithTolerance(this.y,n.y,r))}};ae.prototype.getOrdinate=function(t){switch(t){case ae.X:return this.x;case ae.Y:return this.y;case ae.Z:return this.z;default:}throw new so("Invalid ordinate index: "+t)};ae.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Wt.isNaN(this.z))&&Wt.isNaN(t.z)};ae.prototype.equals=function(t){return t instanceof ae?this.equals2D(t):!1};ae.prototype.equalInZ=function(t,n){return gy.equalsWithTolerance(this.z,t.z,n)};ae.prototype.compareTo=function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};ae.prototype.clone=function(){};ae.prototype.copy=function(){return new ae(this)};ae.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};ae.prototype.distance3D=function(t){var n=this.x-t.x,r=this.y-t.y,o=this.z-t.z;return Math.sqrt(n*n+r*r+o*o)};ae.prototype.distance=function(t){var n=this.x-t.x,r=this.y-t.y;return Math.sqrt(n*n+r*r)};ae.prototype.hashCode=function(){var t=17;return t=37*t+ae.hashCode(this.x),t=37*t+ae.hashCode(this.y),t};ae.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};ae.prototype.interfaces_=function(){return[wc,xP,Ec]};ae.prototype.getClass=function(){return ae};ae.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=Wt.doubleToLongBits(t);return Math.trunc((n^n)>>>32)}};Iy.DimensionalComparator.get=function(){return Vm};Iy.serialVersionUID.get=function(){return 6683108902428367e3};Iy.NULL_ORDINATE.get=function(){return Wt.NaN};Iy.X.get=function(){return 0};Iy.Y.get=function(){return 1};Iy.Z.get=function(){return 2};Object.defineProperties(ae,Iy);var Vm=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new so("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Vm.prototype.compare=function(t,n){var r=t,o=n,a=Vm.compare(r.x,o.x);if(a!==0)return a;var s=Vm.compare(r.y,o.y);if(s!==0)return s;if(this._dimensionsToTest<=2)return 0;var u=Vm.compare(r.z,o.z);return u};Vm.prototype.interfaces_=function(){return[jC]};Vm.prototype.getClass=function(){return Vm};Vm.compare=function(t,n){return t<n?-1:t>n?1:Wt.isNaN(t)?Wt.isNaN(n)?0:-1:Wt.isNaN(n)?1:0};var KC=function(){};KC.prototype.create=function(){};KC.prototype.interfaces_=function(){return[]};KC.prototype.getClass=function(){return KC};var he=function(){},VT={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};he.prototype.interfaces_=function(){return[]};he.prototype.getClass=function(){return he};he.toLocationSymbol=function(t){switch(t){case he.EXTERIOR:return"e";case he.BOUNDARY:return"b";case he.INTERIOR:return"i";case he.NONE:return"-";default:}throw new so("Unknown location value: "+t)};VT.INTERIOR.get=function(){return 0};VT.BOUNDARY.get=function(){return 1};VT.EXTERIOR.get=function(){return 2};VT.NONE.get=function(){return-1};Object.defineProperties(he,VT);var Mt=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},Fl=function(){},dX={LOG_10:{configurable:!0}};Fl.prototype.interfaces_=function(){return[]};Fl.prototype.getClass=function(){return Fl};Fl.log10=function(t){var n=Math.log(t);return Wt.isInfinite(n)||Wt.isNaN(n)?n:n/Fl.LOG_10};Fl.min=function(t,n,r,o){var a=t;return n<a&&(a=n),r<a&&(a=r),o<a&&(a=o),a};Fl.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],r=arguments[2];return t<n?n:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1],s=arguments[2];return o<a?a:o>s?s:o}};Fl.wrap=function(t,n){return t<0?n- -t%n:t%n};Fl.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2],o=t;return n>o&&(o=n),r>o&&(o=r),o}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=a;return s>c&&(c=s),u>c&&(c=u),l>c&&(c=l),c}};Fl.average=function(t,n){return(t+n)/2};dX.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(Fl,dX);var oh=function(t){this.str=t};oh.prototype.append=function(t){this.str+=t};oh.prototype.setCharAt=function(t,n){this.str=this.str.substr(0,t)+n+this.str.substr(t+1)};oh.prototype.toString=function(t){return this.str};var jf=function(t){this.value=t};jf.prototype.intValue=function(){return this.value};jf.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};jf.isNaN=function(t){return Number.isNaN(t)};var vT=function(){};vT.isWhitespace=function(t){return t<=32&&t>=0||t===127};vT.toUpperCase=function(t){return t.toUpperCase()};var ge=function e(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];e.call(this,e.parse(r))}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.init(o,a)}},af={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};ge.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};ge.prototype.extractSignificantDigits=function(t,n){var r=this.abs(),o=ge.magnitude(r._hi),a=ge.TEN.pow(o);r=r.divide(a),r.gt(ge.TEN)?(r=r.divide(ge.TEN),o+=1):r.lt(ge.ONE)&&(r=r.multiply(ge.TEN),o-=1);for(var s=o+1,u=new oh,l=ge.MAX_PRINT_DIGITS-1,c=0;c<=l;c++){t&&c===s&&u.append(".");var f=Math.trunc(r._hi);if(f<0)break;var h=!1,d=0;f>9?(h=!0,d="9"):d="0"+f,u.append(d),r=r.subtract(ge.valueOf(f)).multiply(ge.TEN),h&&r.selfAdd(ge.TEN);var p=!0,g=ge.magnitude(r._hi);if(g<0&&Math.abs(g)>=l-c&&(p=!1),!p)break}return n[0]=o,u.toString()};ge.prototype.sqr=function(){return this.multiply(this)};ge.prototype.doubleValue=function(){return this._hi+this._lo};ge.prototype.subtract=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};ge.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};ge.prototype.isZero=function(){return this._hi===0&&this._lo===0};ge.prototype.selfSubtract=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};ge.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};ge.prototype.min=function(t){return this.le(t)?this:t};ge.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null,h=null,d=null;return c=this._hi/r,f=ge.SPLIT*c,a=f-c,d=ge.SPLIT*r,a=f-a,s=c-a,u=d-r,h=c*r,u=d-u,l=r-u,d=a*u-h+a*l+s*u+s*l,f=(this._hi-h-d+this._lo-c*o)/r,d=c+f,this._hi=d,this._lo=c-d+f,this}};ge.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};ge.prototype.divide=function(){if(arguments[0]instanceof ge){var t=arguments[0],n=null,r=null,o=null,a=null,s=null,u=null,l=null,c=null;s=this._hi/t._hi,u=ge.SPLIT*s,n=u-s,c=ge.SPLIT*t._hi,n=u-n,r=s-n,o=c-t._hi,l=s*t._hi,o=c-o,a=t._hi-o,c=n*o-l+n*a+r*o+r*a,u=(this._hi-l-c+this._lo-s*t._lo)/t._hi,c=s+u;var f=c,h=s-c+u;return new ge(f,h)}else if(typeof arguments[0]=="number"){var d=arguments[0];return Wt.isNaN(d)?ge.createNaN():ge.copy(this).selfDivide(d,0)}};ge.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};ge.prototype.pow=function(t){if(t===0)return ge.valueOf(1);var n=new ge(this),r=ge.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2===1&&r.selfMultiply(n),o/=2,o>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r};ge.prototype.ceil=function(){if(this.isNaN())return ge.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new ge(t,n)};ge.prototype.compareTo=function(t){var n=t;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};ge.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};ge.prototype.setValue=function(){if(arguments[0]instanceof ge){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};ge.prototype.max=function(t){return this.ge(t)?this:t};ge.prototype.sqrt=function(){if(this.isZero())return ge.valueOf(0);if(this.isNegative())return ge.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=ge.valueOf(n),o=this.subtract(r.sqr()),a=o._hi*(t*.5);return r.add(a)};ge.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,o=null,a=null,s=null,u=null,l=null;return a=this._hi+n,u=a-this._hi,s=a-u,s=n-u+(this._hi-s),l=s+this._lo,r=a+l,o=l+(a-r),this._hi=r+o,this._lo=o+(r-this._hi),this}}else if(arguments.length===2){var c=arguments[0],f=arguments[1],h=null,d=null,p=null,g=null,y=null,v=null,w=null,C=null;y=this._hi+c,p=this._lo+f,w=y-this._hi,C=p-this._lo,v=y-w,g=p-C,v=c-w+(this._hi-v),g=f-C+(this._lo-g),w=v+p,h=y+w,d=w+(y-h),w=g+d;var E=h+w,S=w+(h-E);return this._hi=E,this._lo=S,this}};ge.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof ge){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null;c=ge.SPLIT*this._hi,a=c-this._hi,f=ge.SPLIT*r,a=c-a,s=this._hi-a,u=f-r,c=this._hi*r,u=f-u,l=r-u,f=a*u-c+a*l+s*u+s*l+(this._hi*o+this._lo*r);var h=c+f;a=c-h;var d=f+a;return this._hi=h,this._lo=d,this}};ge.prototype.selfSqr=function(){return this.selfMultiply(this)};ge.prototype.floor=function(){if(this.isNaN())return ge.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new ge(t,n)};ge.prototype.negate=function(){return this.isNaN()?this:new ge(-this._hi,-this._lo)};ge.prototype.clone=function(){};ge.prototype.multiply=function(){if(arguments[0]instanceof ge){var t=arguments[0];return t.isNaN()?ge.createNaN():ge.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Wt.isNaN(n)?ge.createNaN():ge.copy(this).selfMultiply(n,0)}};ge.prototype.isNaN=function(){return Wt.isNaN(this._hi)};ge.prototype.intValue=function(){return Math.trunc(this._hi)};ge.prototype.toString=function(){var t=ge.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};ge.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),o=n[0]+1,a=r;if(r.charAt(0)===".")a="0"+r;else if(o<0)a="0."+ge.stringOfChar("0",-o)+r;else if(r.indexOf(".")===-1){var s=o-r.length,u=ge.stringOfChar("0",s);a=r+u+".0"}return this.isNegative()?"-"+a:a};ge.prototype.reciprocal=function(){var t=null,n=null,r=null,o=null,a=null,s=null,u=null,l=null;a=1/this._hi,s=ge.SPLIT*a,t=s-a,l=ge.SPLIT*this._hi,t=s-t,n=a-t,r=l-this._hi,u=a*this._hi,r=l-r,o=this._hi-r,l=t*r-u+t*o+n*r+n*o,s=(1-u-l-a*this._lo)/this._hi;var c=a+s,f=a-c+s;return new ge(c,f)};ge.prototype.toSciNotation=function(){if(this.isZero())return ge.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),o=ge.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var a="";r.length>1&&(a=r.substring(1));var s=r.charAt(0)+"."+a;return this.isNegative()?"-"+s+o:s+o};ge.prototype.abs=function(){return this.isNaN()?ge.NaN:this.isNegative()?this.negate():new ge(this)};ge.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};ge.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};ge.prototype.add=function(){if(arguments[0]instanceof ge){var t=arguments[0];return ge.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return ge.copy(this).selfAdd(n)}};ge.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof ge){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._hi=r,this._lo=o}};ge.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};ge.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};ge.prototype.trunc=function(){return this.isNaN()?ge.NaN:this.isPositive()?this.floor():this.ceil()};ge.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};ge.prototype.interfaces_=function(){return[Ec,wc,xP]};ge.prototype.getClass=function(){return ge};ge.sqr=function(t){return ge.valueOf(t).selfMultiply(t)};ge.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return ge.parse(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new ge(n)}};ge.sqrt=function(t){return ge.valueOf(t).sqrt()};ge.parse=function(t){for(var n=0,r=t.length;vT.isWhitespace(t.charAt(n));)n++;var o=!1;if(n<r){var a=t.charAt(n);(a==="-"||a==="+")&&(n++,a==="-"&&(o=!0))}for(var s=new ge,u=0,l=0,c=0;!(n>=r);){var f=t.charAt(n);if(n++,vT.isDigit(f)){var h=f-"0";s.selfMultiply(ge.TEN),s.selfAdd(h),u++;continue}if(f==="."){l=u;continue}if(f==="e"||f==="E"){var d=t.substring(n);try{c=jf.parseInt(d)}catch(w){throw w instanceof Error?new Error("Invalid exponent "+d+" in string "+t):w}finally{}break}throw new Error("Unexpected character '"+f+"' at position "+n+" in string "+t)}var p=s,g=u-l-c;if(g===0)p=s;else if(g>0){var y=ge.TEN.pow(g);p=s.divide(y)}else if(g<0){var v=ge.TEN.pow(-g);p=s.multiply(v)}return o?p.negate():p};ge.createNaN=function(){return new ge(Wt.NaN,Wt.NaN)};ge.copy=function(t){return new ge(t)};ge.magnitude=function(t){var n=Math.abs(t),r=Math.log(n)/Math.log(10),o=Math.trunc(Math.floor(r)),a=Math.pow(10,o);return a*10<=n&&(o+=1),o};ge.stringOfChar=function(t,n){for(var r=new oh,o=0;o<n;o++)r.append(t);return r.toString()};af.PI.get=function(){return new ge(3.141592653589793,12246467991473532e-32)};af.TWO_PI.get=function(){return new ge(6.283185307179586,24492935982947064e-32)};af.PI_2.get=function(){return new ge(1.5707963267948966,6123233995736766e-32)};af.E.get=function(){return new ge(2.718281828459045,14456468917292502e-32)};af.NaN.get=function(){return new ge(Wt.NaN,Wt.NaN)};af.EPS.get=function(){return 123259516440783e-46};af.SPLIT.get=function(){return 134217729};af.MAX_PRINT_DIGITS.get=function(){return 32};af.TEN.get=function(){return ge.valueOf(10)};af.ONE.get=function(){return ge.valueOf(1)};af.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};af.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(ge,af);var Ru=function(){},pX={DP_SAFE_EPSILON:{configurable:!0}};Ru.prototype.interfaces_=function(){return[]};Ru.prototype.getClass=function(){return Ru};Ru.orientationIndex=function(t,n,r){var o=Ru.orientationIndexFilter(t,n,r);if(o<=1)return o;var a=ge.valueOf(n.x).selfAdd(-t.x),s=ge.valueOf(n.y).selfAdd(-t.y),u=ge.valueOf(r.x).selfAdd(-n.x),l=ge.valueOf(r.y).selfAdd(-n.y);return a.selfMultiply(l).selfSubtract(s.selfMultiply(u)).signum()};Ru.signOfDet2x2=function(t,n,r,o){var a=t.multiply(o).selfSubtract(n.multiply(r));return a.signum()};Ru.intersection=function(t,n,r,o){var a=ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(ge.valueOf(n.x).selfSubtract(t.x)),s=ge.valueOf(o.x).selfSubtract(r.x).selfMultiply(ge.valueOf(n.y).selfSubtract(t.y)),u=a.subtract(s),l=ge.valueOf(o.x).selfSubtract(r.x).selfMultiply(ge.valueOf(t.y).selfSubtract(r.y)),c=ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(ge.valueOf(t.x).selfSubtract(r.x)),f=l.subtract(c),h=f.selfDivide(u).doubleValue(),d=ge.valueOf(t.x).selfAdd(ge.valueOf(n.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),p=ge.valueOf(n.x).selfSubtract(t.x).selfMultiply(ge.valueOf(t.y).selfSubtract(r.y)),g=ge.valueOf(n.y).selfSubtract(t.y).selfMultiply(ge.valueOf(t.x).selfSubtract(r.x)),y=p.subtract(g),v=y.selfDivide(u).doubleValue(),w=ge.valueOf(r.y).selfAdd(ge.valueOf(o.y).selfSubtract(r.y).selfMultiply(v)).doubleValue();return new ae(d,w)};Ru.orientationIndexFilter=function(t,n,r){var o=null,a=(t.x-r.x)*(n.y-r.y),s=(t.y-r.y)*(n.x-r.x),u=a-s;if(a>0){if(s<=0)return Ru.signum(u);o=a+s}else if(a<0){if(s>=0)return Ru.signum(u);o=-a-s}else return Ru.signum(u);var l=Ru.DP_SAFE_EPSILON*o;return u>=l||-u>=l?Ru.signum(u):2};Ru.signum=function(t){return t>0?1:t<0?-1:0};pX.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Ru,pX);var xn=function(){},kT={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};kT.X.get=function(){return 0};kT.Y.get=function(){return 1};kT.Z.get=function(){return 2};kT.M.get=function(){return 3};xn.prototype.setOrdinate=function(t,n,r){};xn.prototype.size=function(){};xn.prototype.getOrdinate=function(t,n){};xn.prototype.getCoordinate=function(){};xn.prototype.getCoordinateCopy=function(t){};xn.prototype.getDimension=function(){};xn.prototype.getX=function(t){};xn.prototype.clone=function(){};xn.prototype.expandEnvelope=function(t){};xn.prototype.copy=function(){};xn.prototype.getY=function(t){};xn.prototype.toCoordinateArray=function(){};xn.prototype.interfaces_=function(){return[xP]};xn.prototype.getClass=function(){return xn};Object.defineProperties(xn,kT);var mX=function(){},y1=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(mX),cs=function(){};cs.arraycopy=function(t,n,r,o,a){for(var s=0,u=n;u<n+a;u++)r[o+s]=t[u],s++};cs.getProperty=function(t){return{"line.separator":`
`}[t]};var Zc=function e(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var o=arguments[0],a=arguments[1];this.x=o.y*a.w-a.y*o.w,this.y=a.x*o.w-o.x*a.w,this.w=o.x*a.y-a.x*o.y}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var s=arguments[0],u=arguments[1];this.x=s.y-u.y,this.y=u.x-s.x,this.w=s.x*u.y-u.x*s.y}}else if(arguments.length===3){var l=arguments[0],c=arguments[1],f=arguments[2];this.x=l,this.y=c,this.w=f}else if(arguments.length===4){var h=arguments[0],d=arguments[1],p=arguments[2],g=arguments[3],y=h.y-d.y,v=d.x-h.x,w=h.x*d.y-d.x*h.y,C=p.y-g.y,E=g.x-p.x,S=p.x*g.y-g.x*p.y;this.x=v*S-E*w,this.y=C*w-y*S,this.w=y*E-C*v}};Zc.prototype.getY=function(){var t=this.y/this.w;if(Wt.isNaN(t)||Wt.isInfinite(t))throw new y1;return t};Zc.prototype.getX=function(){var t=this.x/this.w;if(Wt.isNaN(t)||Wt.isInfinite(t))throw new y1;return t};Zc.prototype.getCoordinate=function(){var t=new ae;return t.x=this.getX(),t.y=this.getY(),t};Zc.prototype.interfaces_=function(){return[]};Zc.prototype.getClass=function(){return Zc};Zc.intersection=function(t,n,r,o){var a=t.y-n.y,s=n.x-t.x,u=t.x*n.y-n.x*t.y,l=r.y-o.y,c=o.x-r.x,f=r.x*o.y-o.x*r.y,h=s*f-c*u,d=l*u-a*f,p=a*c-l*s,g=h/p,y=d/p;if(Wt.isNaN(g)||Wt.isInfinite(g)||Wt.isNaN(y)||Wt.isInfinite(y))throw new y1;return new ae(g,y)};var ut=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];this.init(a,s,u,l)}},gX={serialVersionUID:{configurable:!0}};ut.prototype.getArea=function(){return this.getWidth()*this.getHeight()};ut.prototype.equals=function(t){if(!(t instanceof ut))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};ut.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new ut;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new ut(n,o,r,a)};ut.prototype.isNull=function(){return this._maxx<this._minx};ut.prototype.getMaxX=function(){return this._maxx};ut.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof ut){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&o>=this._miny&&o<=this._maxy}};ut.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof ut){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof ae){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||o>this._maxy||o<this._miny)}};ut.prototype.getMinY=function(){return this._miny};ut.prototype.getMinX=function(){return this._minx};ut.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof ut){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=o,this._maxy=o):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}};ut.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t<n?t:n};ut.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};ut.prototype.compareTo=function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};ut.prototype.translate=function(t,n){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)};ut.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};ut.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};ut.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};ut.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n};ut.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};ut.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof ut){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof ae){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.covers(r,o)}};ut.prototype.centre=function(){return this.isNull()?null:new ae((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};ut.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof ut){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];a<s?(this._minx=a,this._maxx=s):(this._minx=s,this._maxx=a),u<l?(this._miny=u,this._maxy=l):(this._miny=l,this._maxy=u)}};ut.prototype.getMaxY=function(){return this._maxy};ut.prototype.distance=function(t){if(this.intersects(t))return 0;var n=0;this._maxx<t._minx?n=t._minx-this._maxx:this._minx>t._maxx&&(n=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};ut.prototype.hashCode=function(){var t=17;return t=37*t+ae.hashCode(this._minx),t=37*t+ae.hashCode(this._maxx),t=37*t+ae.hashCode(this._miny),t=37*t+ae.hashCode(this._maxy),t};ut.prototype.interfaces_=function(){return[wc,Ec]};ut.prototype.getClass=function(){return ut};ut.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(t.x<n.x?t.x:n.x)&&r.x<=(t.x>n.x?t.x:n.x)&&r.y>=(t.y<n.y?t.y:n.y)&&r.y<=(t.y>n.y?t.y:n.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=Math.min(s.x,u.x),c=Math.max(s.x,u.x),f=Math.min(o.x,a.x),h=Math.max(o.x,a.x);return!(f>c||h<l||(l=Math.min(s.y,u.y),c=Math.max(s.y,u.y),f=Math.min(o.y,a.y),h=Math.max(o.y,a.y),f>c)||h<l)}};gX.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(ut,gX);var Gf={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},wP=function(t){this.geometryFactory=t||new cn};wP.prototype.read=function(t){var n,r,o;t=t.replace(/[\n\r]/g," ");var a=Gf.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(a=Gf.emptyTypeStr.exec(t),a[2]=void 0),a&&(r=a[1].toLowerCase(),o=a[2],UC[r]&&(n=UC[r].apply(this,[o]))),n===void 0)throw new Error("Could not parse WKT "+t);return n};wP.prototype.write=function(t){return this.extractGeometry(t)};wP.prototype.extractGeometry=function(t){var n=t.getGeometryType().toLowerCase();if(!mp[n])return null;var r=n.toUpperCase(),o;return t.isEmpty()?o=r+" EMPTY":o=r+"("+mp[n].apply(this,[t])+")",o};var mp={coordinate:function(t){return t.x+" "+t.y},point:function(t){return mp.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+mp.point.apply(n,[t._geometries[o]])+")");return r.join(",")},linestring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(mp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},linearring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(mp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},multilinestring:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+mp.linestring.apply(n,[t._geometries[o]])+")");return r.join(",")},polygon:function(t){var n=this,r=[];r.push("("+mp.linestring.apply(this,[t._shell])+")");for(var o=0,a=t._holes.length;o<a;++o)r.push("("+mp.linestring.apply(n,[t._holes[o]])+")");return r.join(",")},multipolygon:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+mp.polygon.apply(n,[t._geometries[o]])+")");return r.join(",")},geometrycollection:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push(n.extractGeometry(t._geometries[o]));return r.join(",")}},UC={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(Gf.spaces);return this.geometryFactory.createPoint(new ae(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,o=t.trim().split(","),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Gf.trimParens,"$1"),a.push(UC.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(a)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Gf.spaces),r.push(new ae(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Gf.spaces),r.push(new ae(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,o=t.trim().split(Gf.parenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Gf.trimParens,"$1"),a.push(UC.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(a)},polygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,o,a,s=t.trim().split(Gf.parenComma),u,l=[],c=0,f=s.length;c<f;++c)r=s[c].replace(Gf.trimParens,"$1"),o=UC.linestring.apply(n,[r]),a=n.geometryFactory.createLinearRing(o._points),c===0?u=a:l.push(a);return this.geometryFactory.createPolygon(u,l)},multipolygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,o=t.trim().split(Gf.doubleParenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Gf.trimParens,"$1"),a.push(UC.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(t){var n=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),o=[],a=0,s=r.length;a<s;++a)o.push(n.read(r[a]));return this.geometryFactory.createGeometryCollection(o)}},Jc=function(t){this.parser=new wP(t)};Jc.prototype.write=function(t){return this.parser.write(t)};Jc.toLineString=function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"};var Ep=function(e){function t(n){e.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),JD=function(e){function t(){if(e.call(this),arguments.length===0)e.call(this);else if(arguments.length===1){var n=arguments[0];e.call(this,n)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ep),tn=function(){};tn.prototype.interfaces_=function(){return[]};tn.prototype.getClass=function(){return tn};tn.shouldNeverReachHere=function(){if(arguments.length===0)tn.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new JD("Should never reach here"+(t!==null?": "+t:""))}};tn.isTrue=function(){var t,n;if(arguments.length===1)t=arguments[0],tn.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],n=arguments[1],!t))throw n===null?new JD:new JD(n)};tn.equals=function(){var t,n,r;if(arguments.length===2)t=arguments[0],n=arguments[1],tn.equals(t,n,null);else if(arguments.length===3&&(t=arguments[0],n=arguments[1],r=arguments[2],!n.equals(t)))throw new JD("Expected "+t+" but encountered "+n+(r!==null?": "+r:""))};var yo=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ae,this._intPt[1]=new ae,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Dy={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};yo.prototype.getIndexAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intLineIndex[t][n]};yo.prototype.getTopologySummary=function(){var t=new oh;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};yo.prototype.computeIntersection=function(t,n,r,o){this._inputLines[0][0]=t,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,n,r,o)};yo.prototype.getIntersectionNum=function(){return this._result};yo.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);n>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};yo.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};yo.prototype.setPrecisionModel=function(t){this._precisionModel=t};yo.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[n][0])||t._intPt[r].equals2D(t._inputLines[n][1])))return!0;return!1}};yo.prototype.getIntersection=function(t){return this._intPt[t]};yo.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};yo.prototype.hasIntersection=function(){return this._result!==yo.NO_INTERSECTION};yo.prototype.getEdgeDistance=function(t,n){var r=yo.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1]);return r};yo.prototype.isCollinear=function(){return this._result===yo.COLLINEAR_INTERSECTION};yo.prototype.toString=function(){return Jc.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Jc.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};yo.prototype.getEndpoint=function(t,n){return this._inputLines[t][n]};yo.prototype.isIntersection=function(t){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(t))return!0;return!1};yo.prototype.getIntersectionAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][n]]};yo.prototype.interfaces_=function(){return[]};yo.prototype.getClass=function(){return yo};yo.computeEdgeDistance=function(t,n,r){var o=Math.abs(r.x-n.x),a=Math.abs(r.y-n.y),s=-1;if(t.equals(n))s=0;else if(t.equals(r))o>a?s=o:s=a;else{var u=Math.abs(t.x-n.x),l=Math.abs(t.y-n.y);o>a?s=u:s=l,s===0&&!t.equals(n)&&(s=Math.max(u,l))}return tn.isTrue(!(s===0&&!t.equals(n)),"Bad distance calculation"),s};yo.nonRobustComputeEdgeDistance=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=Math.sqrt(o*o+a*a);return tn.isTrue(!(s===0&&!t.equals(n)),"Invalid distance calculation"),s};Dy.DONT_INTERSECT.get=function(){return 0};Dy.DO_INTERSECT.get=function(){return 1};Dy.COLLINEAR.get=function(){return 2};Dy.NO_INTERSECTION.get=function(){return 0};Dy.POINT_INTERSECTION.get=function(){return 1};Dy.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(yo,Dy);var O0=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var o=new ut(this._inputLines[0][0],this._inputLines[0][1]),a=new ut(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(r)&&a.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];if(this._isProper=!1,ut.intersects(o,a,r)&&Ue.orientationIndex(o,a,r)===0&&Ue.orientationIndex(a,o,r)===0)return this._isProper=!0,(r.equals(o)||r.equals(a))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION}else return e.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,o,a,s,u){u.x=this.smallestInAbsValue(r.x,o.x,a.x,s.x),u.y=this.smallestInAbsValue(r.y,o.y,a.y,s.y),r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.safeHCoordinateIntersection=function(r,o,a,s){var u=null;try{u=Zc.intersection(r,o,a,s)}catch(l){if(l instanceof y1)u=t.nearestEndpoint(r,o,a,s);else throw l}finally{}return u},t.prototype.intersection=function(r,o,a,s){var u=this.intersectionWithNormalization(r,o,a,s);return this.isInSegmentEnvelopes(u)||(u=new ae(t.nearestEndpoint(r,o,a,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u},t.prototype.smallestInAbsValue=function(r,o,a,s){var u=r,l=Math.abs(u);return Math.abs(o)<l&&(u=o,l=Math.abs(o)),Math.abs(a)<l&&(u=a,l=Math.abs(a)),Math.abs(s)<l&&(u=s),u},t.prototype.checkDD=function(r,o,a,s,u){var l=Ru.intersection(r,o,a,s),c=this.isInSegmentEnvelopes(l);cs.out.println("DD in env = "+c+"  --------------------- "+l),u.distance(l)>1e-4&&cs.out.println("Distance = "+u.distance(l))},t.prototype.intersectionWithNormalization=function(r,o,a,s){var u=new ae(r),l=new ae(o),c=new ae(a),f=new ae(s),h=new ae;this.normalizeToEnvCentre(u,l,c,f,h);var d=this.safeHCoordinateIntersection(u,l,c,f);return d.x+=h.x,d.y+=h.y,d},t.prototype.computeCollinearIntersection=function(r,o,a,s){var u=ut.intersects(r,o,a),l=ut.intersects(r,o,s),c=ut.intersects(a,s,r),f=ut.intersects(a,s,o);return u&&l?(this._intPt[0]=a,this._intPt[1]=s,e.COLLINEAR_INTERSECTION):c&&f?(this._intPt[0]=r,this._intPt[1]=o,e.COLLINEAR_INTERSECTION):u&&c?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!l&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):u&&f?(this._intPt[0]=a,this._intPt[1]=o,a.equals(o)&&!l&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&c?(this._intPt[0]=s,this._intPt[1]=r,s.equals(r)&&!u&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&f?(this._intPt[0]=s,this._intPt[1]=o,s.equals(o)&&!u&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,o,a,s,u){var l=r.x<o.x?r.x:o.x,c=r.y<o.y?r.y:o.y,f=r.x>o.x?r.x:o.x,h=r.y>o.y?r.y:o.y,d=a.x<s.x?a.x:s.x,p=a.y<s.y?a.y:s.y,g=a.x>s.x?a.x:s.x,y=a.y>s.y?a.y:s.y,v=l>d?l:d,w=f<g?f:g,C=c>p?c:p,E=h<y?h:y,S=(v+w)/2,A=(C+E)/2;u.x=S,u.y=A,r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.computeIntersect=function(r,o,a,s){if(this._isProper=!1,!ut.intersects(r,o,a,s))return e.NO_INTERSECTION;var u=Ue.orientationIndex(r,o,a),l=Ue.orientationIndex(r,o,s);if(u>0&&l>0||u<0&&l<0)return e.NO_INTERSECTION;var c=Ue.orientationIndex(a,s,r),f=Ue.orientationIndex(a,s,o);if(c>0&&f>0||c<0&&f<0)return e.NO_INTERSECTION;var h=u===0&&l===0&&c===0&&f===0;return h?this.computeCollinearIntersection(r,o,a,s):(u===0||l===0||c===0||f===0?(this._isProper=!1,r.equals2D(a)||r.equals2D(s)?this._intPt[0]=r:o.equals2D(a)||o.equals2D(s)?this._intPt[0]=o:u===0?this._intPt[0]=new ae(a):l===0?this._intPt[0]=new ae(s):c===0?this._intPt[0]=new ae(r):f===0&&(this._intPt[0]=new ae(o))):(this._isProper=!0,this._intPt[0]=this.intersection(r,o,a,s)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,o,a,s){var u=r,l=Ue.distancePointLine(r,a,s),c=Ue.distancePointLine(o,a,s);return c<l&&(l=c,u=o),c=Ue.distancePointLine(a,r,o),c<l&&(l=c,u=a),c=Ue.distancePointLine(s,r,o),c<l&&(l=c,u=s),u},t}(yo),_y=function(){};_y.prototype.interfaces_=function(){return[]};_y.prototype.getClass=function(){return _y};_y.orientationIndex=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=r.x-n.x,u=r.y-n.y;return _y.signOfDet2x2(o,a,s,u)};_y.signOfDet2x2=function(t,n,r,o){var a=null,s=null,u=null;if(a=1,t===0||o===0)return n===0||r===0?0:n>0?r>0?-a:a:r>0?a:-a;if(n===0||r===0)return o>0?t>0?a:-a:t>0?-a:a;if(n>0?o>0?n<=o||(a=-a,s=t,t=r,r=s,s=n,n=o,o=s):n<=-o?(a=-a,r=-r,o=-o):(s=t,t=-r,r=s,s=n,n=-o,o=s):o>0?-n<=o?(a=-a,t=-t,n=-n):(s=-t,t=r,r=s,s=-n,n=o,o=s):n>=o?(t=-t,n=-n,r=-r,o=-o):(a=-a,s=-t,t=-r,r=s,s=-n,n=-o,o=s),t>0)if(r>0){if(!(t<=r))return a}else return a;else{if(r>0)return-a;if(t>=r)a=-a,t=-t,r=-r;else return-a}for(;;){if(u=Math.floor(r/t),r=r-u*t,o=o-u*n,o<0)return-a;if(o>n)return a;if(t>r+r){if(n<o+o)return a}else{if(n>o+o)return-a;r=t-r,o=n-o,a=-a}if(o===0)return r===0?0:-a;if(r===0||(u=Math.floor(t/r),t=t-u*r,n=n-u*o,n<0))return a;if(n>o)return-a;if(r>t+t){if(o<n+n)return-a}else{if(o>n+n)return a;t=r-t,n=o-n,a=-a}if(n===0)return t===0?0:a;if(t===0)return-a}};var Yf=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Yf.prototype.countSegment=function(t,n){if(t.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&n.y===this._p.y){var r=t.x,o=n.x;return r>o&&(r=n.x,o=t.x),this._p.x>=r&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&t.y<=this._p.y){var a=t.x-this._p.x,s=t.y-this._p.y,u=n.x-this._p.x,l=n.y-this._p.y,c=_y.signOfDet2x2(a,s,u,l);if(c===0)return this._isPointOnSegment=!0,null;l<s&&(c=-c),c>0&&this._crossingCount++}};Yf.prototype.isPointInPolygon=function(){return this.getLocation()!==he.EXTERIOR};Yf.prototype.getLocation=function(){return this._isPointOnSegment?he.BOUNDARY:this._crossingCount%2===1?he.INTERIOR:he.EXTERIOR};Yf.prototype.isOnSegment=function(){return this._isPointOnSegment};Yf.prototype.interfaces_=function(){return[]};Yf.prototype.getClass=function(){return Yf};Yf.locatePointInRing=function(){if(arguments[0]instanceof ae&&Mt(arguments[1],xn)){for(var t=arguments[0],n=arguments[1],r=new Yf(t),o=new ae,a=new ae,s=1;s<n.size();s++)if(n.getCoordinate(s,o),n.getCoordinate(s-1,a),r.countSegment(o,a),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof ae&&arguments[1]instanceof Array){for(var u=arguments[0],l=arguments[1],c=new Yf(u),f=1;f<l.length;f++){var h=l[f],d=l[f-1];if(c.countSegment(h,d),c.isOnSegment())return c.getLocation()}return c.getLocation()}};var Ue=function(){},Py={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Ue.prototype.interfaces_=function(){return[]};Ue.prototype.getClass=function(){return Ue};Ue.orientationIndex=function(t,n,r){return Ru.orientationIndex(t,n,r)};Ue.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,r=t[0].x,o=1;o<t.length-1;o++){var a=t[o].x-r,s=t[o+1].y,u=t[o-1].y;n+=a*(u-s)}return n/2}else if(Mt(arguments[0],xn)){var l=arguments[0],c=l.size();if(c<3)return 0;var f=new ae,h=new ae,d=new ae;l.getCoordinate(0,h),l.getCoordinate(1,d);var p=h.x;d.x-=p;for(var g=0,y=1;y<c-1;y++)f.y=h.y,h.x=d.x,h.y=d.y,l.getCoordinate(y+1,d),d.x-=p,g+=h.x*(f.y-d.y);return g/2}};Ue.distanceLineLine=function(t,n,r,o){if(t.equals(n))return Ue.distancePointLine(t,r,o);if(r.equals(o))return Ue.distancePointLine(o,t,n);var a=!1;if(!ut.intersects(t,n,r,o))a=!0;else{var s=(n.x-t.x)*(o.y-r.y)-(n.y-t.y)*(o.x-r.x);if(s===0)a=!0;else{var u=(t.y-r.y)*(o.x-r.x)-(t.x-r.x)*(o.y-r.y),l=(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y),c=l/s,f=u/s;(f<0||f>1||c<0||c>1)&&(a=!0)}}return a?Fl.min(Ue.distancePointLine(t,r,o),Ue.distancePointLine(n,r,o),Ue.distancePointLine(r,t,n),Ue.distancePointLine(o,t,n)):0};Ue.isPointInRing=function(t,n){return Ue.locatePointInRing(t,n)!==he.EXTERIOR};Ue.computeLength=function(t){var n=t.size();if(n<=1)return 0;var r=0,o=new ae;t.getCoordinate(0,o);for(var a=o.x,s=o.y,u=1;u<n;u++){t.getCoordinate(u,o);var l=o.x,c=o.y,f=l-a,h=c-s;r+=Math.sqrt(f*f+h*h),a=l,s=c}return r};Ue.isCCW=function(t){var n=t.length-1;if(n<3)throw new so("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],o=0,a=1;a<=n;a++){var s=t[a];s.y>r.y&&(r=s,o=a)}var u=o;do u=u-1,u<0&&(u=n);while(t[u].equals2D(r)&&u!==o);var l=o;do l=(l+1)%n;while(t[l].equals2D(r)&&l!==o);var c=t[u],f=t[l];if(c.equals2D(r)||f.equals2D(r)||c.equals2D(f))return!1;var h=Ue.computeOrientation(c,r,f),d=!1;return h===0?d=c.x>f.x:d=h>0,d};Ue.locatePointInRing=function(t,n){return Yf.locatePointInRing(t,n)};Ue.distancePointLinePerpendicular=function(t,n,r){var o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),a=((n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y))/o;return Math.abs(a)*Math.sqrt(o)};Ue.computeOrientation=function(t,n,r){return Ue.orientationIndex(t,n,r)};Ue.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new so("Line array must contain at least one vertex");for(var r=t.distance(n[0]),o=0;o<n.length-1;o++){var a=Ue.distancePointLine(t,n[o],n[o+1]);a<r&&(r=a)}return r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];if(u.x===l.x&&u.y===l.y)return s.distance(u);var c=(l.x-u.x)*(l.x-u.x)+(l.y-u.y)*(l.y-u.y),f=((s.x-u.x)*(l.x-u.x)+(s.y-u.y)*(l.y-u.y))/c;if(f<=0)return s.distance(u);if(f>=1)return s.distance(l);var h=((u.y-s.y)*(l.x-u.x)-(u.x-s.x)*(l.y-u.y))/c;return Math.abs(h)*Math.sqrt(c)}};Ue.isOnLine=function(t,n){for(var r=new O0,o=1;o<n.length;o++){var a=n[o-1],s=n[o];if(r.computeIntersection(t,a,s),r.hasIntersection())return!0}return!1};Py.CLOCKWISE.get=function(){return-1};Py.RIGHT.get=function(){return Ue.CLOCKWISE};Py.COUNTERCLOCKWISE.get=function(){return 1};Py.LEFT.get=function(){return Ue.COUNTERCLOCKWISE};Py.COLLINEAR.get=function(){return 0};Py.STRAIGHT.get=function(){return Ue.COLLINEAR};Object.defineProperties(Ue,Py);var Tp=function(){};Tp.prototype.filter=function(t){};Tp.prototype.interfaces_=function(){return[]};Tp.prototype.getClass=function(){return Tp};var It=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},wd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};It.prototype.isGeometryCollection=function(){return this.getSortIndex()===It.SORTINDEX_GEOMETRYCOLLECTION};It.prototype.getFactory=function(){return this._factory};It.prototype.getGeometryN=function(t){return this};It.prototype.getArea=function(){return 0};It.prototype.isRectangle=function(){return!1};It.prototype.equals=function(){if(arguments[0]instanceof It){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof It))return!1;var r=n;return this.equalsExact(r)}};It.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};It.prototype.geometryChanged=function(){this.apply(It.geometryChangedFilter)};It.prototype.geometryChangedAction=function(){this._envelope=null};It.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};It.prototype.getLength=function(){return 0};It.prototype.getNumGeometries=function(){return 1};It.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,o)}};It.prototype.getUserData=function(){return this._userData};It.prototype.getSRID=function(){return this._SRID};It.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};It.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===It.SORTINDEX_GEOMETRYCOLLECTION)throw new so("This method does not support GeometryCollection arguments")};It.prototype.equal=function(t,n,r){return r===0?t.equals(n):t.distance(n)<=r};It.prototype.norm=function(){var t=this.copy();return t.normalize(),t};It.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};It.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new ut(this._envelope)};It.prototype.setSRID=function(t){this._SRID=t};It.prototype.setUserData=function(t){this._userData=t};It.prototype.compare=function(t,n){for(var r=t.iterator(),o=n.iterator();r.hasNext()&&o.hasNext();){var a=r.next(),s=o.next(),u=a.compareTo(s);if(u!==0)return u}return r.hasNext()?1:o.hasNext()?-1:0};It.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};It.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===It.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===It.SORTINDEX_MULTIPOINT||this.getSortIndex()===It.SORTINDEX_MULTILINESTRING||this.getSortIndex()===It.SORTINDEX_MULTIPOLYGON};It.prototype.interfaces_=function(){return[xP,wc,Ec]};It.prototype.getClass=function(){return It};It.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1};It.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1};wd.serialVersionUID.get=function(){return 8763622679187377e3};wd.SORTINDEX_POINT.get=function(){return 0};wd.SORTINDEX_MULTIPOINT.get=function(){return 1};wd.SORTINDEX_LINESTRING.get=function(){return 2};wd.SORTINDEX_LINEARRING.get=function(){return 3};wd.SORTINDEX_MULTILINESTRING.get=function(){return 4};wd.SORTINDEX_POLYGON.get=function(){return 5};wd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};wd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};wd.geometryChangedFilter.get=function(){return Y3};Object.defineProperties(It,wd);var Y3=function(){};Y3.interfaces_=function(){return[Tp]};Y3.filter=function(t){t.geometryChangedAction()};var hd=function(){};hd.prototype.filter=function(t){};hd.prototype.interfaces_=function(){return[]};hd.prototype.getClass=function(){return hd};var vc=function(){},Pp={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};vc.prototype.isInBoundary=function(t){};vc.prototype.interfaces_=function(){return[]};vc.prototype.getClass=function(){return vc};Pp.Mod2BoundaryNodeRule.get=function(){return ZC};Pp.EndPointBoundaryNodeRule.get=function(){return QC};Pp.MultiValentEndPointBoundaryNodeRule.get=function(){return JC};Pp.MonoValentEndPointBoundaryNodeRule.get=function(){return $C};Pp.MOD2_BOUNDARY_RULE.get=function(){return new ZC};Pp.ENDPOINT_BOUNDARY_RULE.get=function(){return new QC};Pp.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new JC};Pp.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new $C};Pp.OGC_SFS_BOUNDARY_RULE.get=function(){return vc.MOD2_BOUNDARY_RULE};Object.defineProperties(vc,Pp);var ZC=function(){};ZC.prototype.isInBoundary=function(t){return t%2===1};ZC.prototype.interfaces_=function(){return[vc]};ZC.prototype.getClass=function(){return ZC};var QC=function(){};QC.prototype.isInBoundary=function(t){return t>0};QC.prototype.interfaces_=function(){return[vc]};QC.prototype.getClass=function(){return QC};var JC=function(){};JC.prototype.isInBoundary=function(t){return t>1};JC.prototype.interfaces_=function(){return[vc]};JC.prototype.getClass=function(){return JC};var $C=function(){};$C.prototype.isInBoundary=function(t){return t===1};$C.prototype.interfaces_=function(){return[vc]};$C.prototype.getClass=function(){return $C};var ya=function(){};ya.prototype.add=function(){};ya.prototype.addAll=function(){};ya.prototype.isEmpty=function(){};ya.prototype.iterator=function(){};ya.prototype.size=function(){};ya.prototype.toArray=function(){};ya.prototype.remove=function(){};var uxe=function(e){function t(r){e.call(this),this.message=r||""}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error),v1=function(){};v1.prototype.hasNext=function(){};v1.prototype.next=function(){};v1.prototype.remove=function(){};var Qc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(ya);function C1(e){this.message=e||""}C1.prototype=new Error;C1.prototype.name="NoSuchElementException";var Be=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof ya&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,ya]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.set=function(r,o){var a=this.array_[r];return this.array_[r]=o,a},t.prototype.iterator=function(){return new lxe(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new uxe;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.remove=function(r){for(var o=this,a=!1,s=0,u=this.array_.length;s<u;s++)if(o.array_[s]===r){o.array_.splice(s,1),a=!0;break}return a},t}(Qc),lxe=function(e){function t(n){e.call(this),this.arrayList_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new C1;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(v1),GT=function(e){function t(){if(e.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.ensureCapacity(o.length),this.add(o,a)}}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(o){return this.get(o)},t.prototype.addAll=function(){var o=this;if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=!1,l=a.iterator();l.hasNext();)o.add(l.next(),s),u=!0;return u}else return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var o=this,a=e.prototype.clone.call(this),s=0;s<this.size();s++)a.add(s,o.get(s).copy());return a},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var o=this;if(arguments.length===1){var a=arguments[0];e.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1];return this.add(s,u,!0),!0}else if(arguments[0]instanceof ae&&typeof arguments[1]=="boolean"){var l=arguments[0],c=arguments[1];if(!c&&this.size()>=1){var f=this.get(this.size()-1);if(f.equals2D(l))return null}e.prototype.add.call(this,l)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var h=arguments[0],d=arguments[1];return this.add(h,d),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],g=arguments[1],y=arguments[2];if(y)for(var v=0;v<p.length;v++)o.add(p[v],g);else for(var w=p.length-1;w>=0;w--)o.add(p[w],g);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2];if(!S){var A=this.size();if(A>0){if(C>0){var D=this.get(C-1);if(D.equals2D(E))return null}if(C<A){var P=this.get(C);if(P.equals2D(E))return null}}}e.prototype.add.call(this,C,E)}}else if(arguments.length===4){var M=arguments[0],I=arguments[1],O=arguments[2],m=arguments[3],b=1;O>m&&(b=-1);for(var L=O;L!==m;L+=b)o.add(M[L],I);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new ae(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,n),t}(Be),fn=function(){},EP={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};EP.ForwardComparator.get=function(){return CT};EP.BidirectionalComparator.get=function(){return e1};EP.coordArrayType.get=function(){return new Array(0).fill(null)};fn.prototype.interfaces_=function(){return[]};fn.prototype.getClass=function(){return fn};fn.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};fn.ptNotInList=function(t,n){for(var r=0;r<t.length;r++){var o=t[r];if(fn.indexOf(o,n)<0)return o}return null};fn.scroll=function(t,n){var r=fn.indexOf(n,t);if(r<0)return null;var o=new Array(t.length).fill(null);cs.arraycopy(t,r,o,0,t.length-r),cs.arraycopy(t,0,o,t.length-r,r),cs.arraycopy(o,0,t,0,t.length)};fn.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(o===a)return!0;if(o===null||a===null||o.length!==a.length)return!1;for(var u=0;u<o.length;u++)if(s.compare(o[u],a[u])!==0)return!1;return!0}};fn.intersection=function(t,n){for(var r=new GT,o=0;o<t.length;o++)n.intersects(t[o])&&r.add(t[o],!0);return r.toCoordinateArray()};fn.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1};fn.removeRepeatedPoints=function(t){if(!fn.hasRepeatedPoints(t))return t;var n=new GT(t,!1);return n.toCoordinateArray()};fn.reverse=function(t){for(var n=t.length-1,r=Math.trunc(n/2),o=0;o<=r;o++){var a=t[o];t[o]=t[n-o],t[n-o]=a}};fn.removeNull=function(t){for(var n=0,r=0;r<t.length;r++)t[r]!==null&&n++;var o=new Array(n).fill(null);if(n===0)return o;for(var a=0,s=0;s<t.length;s++)t[s]!==null&&(o[a++]=t[s]);return o};fn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),r=0;r<t.length;r++)n[r]=new ae(t[r]);return n}else if(arguments.length===5)for(var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=arguments[4],c=0;c<l;c++)s[u+c]=new ae(o[a+c])};fn.isEqualReversed=function(t,n){for(var r=0;r<t.length;r++){var o=t[r],a=n[t.length-r-1];if(o.compareTo(a)!==0)return!1}return!0};fn.envelope=function(t){for(var n=new ut,r=0;r<t.length;r++)n.expandToInclude(t[r]);return n};fn.toCoordinateArray=function(t){return t.toArray(fn.coordArrayType)};fn.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]};fn.indexOf=function(t,n){for(var r=0;r<n.length;r++)if(t.equals(n[r]))return r;return-1};fn.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var r=t.length-1-n,o=t[n].compareTo(t[r]);if(o!==0)return o}return 1};fn.compare=function(t,n){for(var r=0;r<t.length&&r<n.length;){var o=t[r].compareTo(n[r]);if(o!==0)return o;r++}return r<n.length?-1:r<t.length?1:0};fn.minCoordinate=function(t){for(var n=null,r=0;r<t.length;r++)(n===null||n.compareTo(t[r])>0)&&(n=t[r]);return n};fn.extract=function(t,n,r){n=Fl.clamp(n,0,t.length),r=Fl.clamp(r,-1,t.length);var o=r-n+1;r<0&&(o=0),n>=t.length&&(o=0),r<n&&(o=0);var a=new Array(o).fill(null);if(o===0)return a;for(var s=0,u=n;u<=r;u++)a[s++]=t[u];return a};Object.defineProperties(fn,EP);var CT=function(){};CT.prototype.compare=function(t,n){var r=t,o=n;return fn.compare(r,o)};CT.prototype.interfaces_=function(){return[jC]};CT.prototype.getClass=function(){return CT};var e1=function(){};e1.prototype.compare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;var a=fn.compare(r,o),s=fn.isEqualReversed(r,o);return s?0:a};e1.prototype.OLDcompare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;for(var a=fn.increasingDirection(r),s=fn.increasingDirection(o),u=a>0?0:r.length-1,l=s>0?0:r.length-1,c=0;c<r.length;c++){var f=r[u].compareTo(o[l]);if(f!==0)return f;u+=a,l+=s}return 0};e1.prototype.interfaces_=function(){return[jC]};e1.prototype.getClass=function(){return e1};var My=function(){};My.prototype.get=function(){};My.prototype.put=function(){};My.prototype.size=function(){};My.prototype.values=function(){};My.prototype.entrySet=function(){};var cxe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(My);function UT(e){this.message=e||""}UT.prototype=new Error;UT.prototype.name="OperationNotSupported";function TP(){}TP.prototype=new ya;TP.prototype.contains=function(){};var X3=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof ya&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var o=this,a=0,s=this.array_.length;a<s;a++){var u=o.array_[a];if(u===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.iterator=function(){return new fxe(this)},t}(TP),fxe=function(e){function t(n){e.call(this),this.hashSet_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new C1;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new UT},t}(v1),_p=0,g0=1;function A7(e){return e===null?_p:e.color}function Gi(e){return e===null?null:e.parent}function pp(e,t){e!==null&&(e.color=t)}function Y2(e){return e===null?null:e.left}function b7(e){return e===null?null:e.right}function Os(){this.root_=null,this.size_=0}Os.prototype=new cxe;Os.prototype.get=function(e){for(var t=this.root_;t!==null;){var n=e.compareTo(t.key);if(n<0)t=t.left;else if(n>0)t=t.right;else return t.value}return null};Os.prototype.put=function(e,t){if(this.root_===null)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:_p,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,o;do if(r=n,o=e.compareTo(n.key),o<0)n=n.left;else if(o>0)n=n.right;else{var a=n.value;return n.value=t,a}while(n!==null);var s={key:e,left:null,right:null,value:t,parent:r,color:_p,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null};Os.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=g0;e!=null&&e!==this.root_&&e.parent.color===g0;)if(Gi(e)===Y2(Gi(Gi(e)))){var n=b7(Gi(Gi(e)));A7(n)===g0?(pp(Gi(e),_p),pp(n,_p),pp(Gi(Gi(e)),g0),e=Gi(Gi(e))):(e===b7(Gi(e))&&(e=Gi(e),t.rotateLeft(e)),pp(Gi(e),_p),pp(Gi(Gi(e)),g0),t.rotateRight(Gi(Gi(e))))}else{var r=Y2(Gi(Gi(e)));A7(r)===g0?(pp(Gi(e),_p),pp(r,_p),pp(Gi(Gi(e)),g0),e=Gi(Gi(e))):(e===Y2(Gi(e))&&(e=Gi(e),t.rotateRight(e)),pp(Gi(e),_p),pp(Gi(Gi(e)),g0),t.rotateLeft(Gi(Gi(e))))}this.root_.color=_p};Os.prototype.values=function(){var e=new Be,t=this.getFirstEntry();if(t!==null)for(e.add(t.value);(t=Os.successor(t))!==null;)e.add(t.value);return e};Os.prototype.entrySet=function(){var e=new X3,t=this.getFirstEntry();if(t!==null)for(e.add(t);(t=Os.successor(t))!==null;)e.add(t);return e};Os.prototype.rotateLeft=function(e){if(e!=null){var t=e.right;e.right=t.left,t.left!=null&&(t.left.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}};Os.prototype.rotateRight=function(e){if(e!=null){var t=e.left;e.left=t.right,t.right!=null&&(t.right.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}};Os.prototype.getFirstEntry=function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e};Os.successor=function(e){if(e===null)return null;if(e.right!==null){for(var t=e.right;t.left!==null;)t=t.left;return t}else{for(var n=e.parent,r=e;n!==null&&r===n.right;)r=n,n=n.parent;return n}};Os.prototype.size=function(){return this.size_};var xT=function(){};xT.prototype.interfaces_=function(){return[]};xT.prototype.getClass=function(){return xT};function _X(){}_X.prototype=new TP;function Kf(){this.array_=[],arguments[0]instanceof ya&&this.addAll(arguments[0])}Kf.prototype=new _X;Kf.prototype.contains=function(e){for(var t=this,n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===0)return!0}return!1};Kf.prototype.add=function(e){var t=this;if(this.contains(e))return!1;for(var n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===1)return t.array_.splice(n,0,e),!0}return this.array_.push(e),!0};Kf.prototype.addAll=function(e){for(var t=this,n=e.iterator();n.hasNext();)t.add(n.next());return!0};Kf.prototype.remove=function(e){throw new UT};Kf.prototype.size=function(){return this.array_.length};Kf.prototype.isEmpty=function(){return this.array_.length===0};Kf.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};Kf.prototype.iterator=function(){return new SP(this)};var SP=function(e){this.treeSet_=e,this.position_=0};SP.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new C1;return this.treeSet_.array_[this.position_++]};SP.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};SP.prototype.remove=function(){throw new UT};var C0=function(){};C0.sort=function(){var t=arguments[0],n,r,o,a;if(arguments.length===1)a=function(u,l){return u.compareTo(l)},t.sort(a);else if(arguments.length===2)o=arguments[1],a=function(u,l){return o.compare(u,l)},t.sort(a);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),o=arguments[3],a=function(u,l){return o.compare(u,l)},r.sort(a),s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])};C0.asList=function(t){for(var n=new Be,r=0,o=t.length;r<o;r++)n.add(t[r]);return n};var Fr=function(){},sf={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};sf.P.get=function(){return 0};sf.L.get=function(){return 1};sf.A.get=function(){return 2};sf.FALSE.get=function(){return-1};sf.TRUE.get=function(){return-2};sf.DONTCARE.get=function(){return-3};sf.SYM_FALSE.get=function(){return"F"};sf.SYM_TRUE.get=function(){return"T"};sf.SYM_DONTCARE.get=function(){return"*"};sf.SYM_P.get=function(){return"0"};sf.SYM_L.get=function(){return"1"};sf.SYM_A.get=function(){return"2"};Fr.prototype.interfaces_=function(){return[]};Fr.prototype.getClass=function(){return Fr};Fr.toDimensionSymbol=function(t){switch(t){case Fr.FALSE:return Fr.SYM_FALSE;case Fr.TRUE:return Fr.SYM_TRUE;case Fr.DONTCARE:return Fr.SYM_DONTCARE;case Fr.P:return Fr.SYM_P;case Fr.L:return Fr.SYM_L;case Fr.A:return Fr.SYM_A;default:}throw new so("Unknown dimension value: "+t)};Fr.toDimensionValue=function(t){switch(vT.toUpperCase(t)){case Fr.SYM_FALSE:return Fr.FALSE;case Fr.SYM_TRUE:return Fr.TRUE;case Fr.SYM_DONTCARE:return Fr.DONTCARE;case Fr.SYM_P:return Fr.P;case Fr.SYM_L:return Fr.L;case Fr.SYM_A:return Fr.A;default:}throw new so("Unknown dimension symbol: "+t)};Object.defineProperties(Fr,sf);var Zf=function(){};Zf.prototype.filter=function(t){};Zf.prototype.interfaces_=function(){return[]};Zf.prototype.getClass=function(){return Zf};var $c=function(){};$c.prototype.filter=function(t,n){};$c.prototype.isDone=function(){};$c.prototype.isGeometryChanged=function(){};$c.prototype.interfaces_=function(){return[]};$c.prototype.getClass=function(){return $c};var iu=function(e){function t(r,o){if(e.call(this,o),this._geometries=r||[],e.hasNullElements(this._geometries))throw new so("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var o=this,a=new ut,s=0;s<this._geometries.length;s++)a.expandToInclude(o._geometries[s].getEnvelopeInternal());return a},t.prototype.getGeometryN=function(o){return this._geometries[o]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var o=this,a=new Array(this.getNumPoints()).fill(null),s=-1,u=0;u<this._geometries.length;u++)for(var l=o._geometries[u].getCoordinates(),c=0;c<l.length;c++)s++,a[s]=l[c];return a},t.prototype.getArea=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getArea();return a},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._geometries.length!==u._geometries.length)return!1;for(var l=0;l<this._geometries.length;l++)if(!o._geometries[l].equalsExact(u._geometries[l],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<this._geometries.length;a++)o._geometries[a].normalize();C0.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var o=this,a=Fr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getBoundaryDimension());return a},t.prototype.getDimension=function(){for(var o=this,a=Fr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getDimension());return a},t.prototype.getLength=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getNumPoints();return a},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createGeometryCollection(s)},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=new Kf(C0.asList(this._geometries)),u=new Kf(C0.asList(a._geometries));return this.compare(s,u)}else if(arguments.length===2){for(var l=arguments[0],c=arguments[1],f=l,h=this.getNumGeometries(),d=f.getNumGeometries(),p=0;p<h&&p<d;){var g=o.getGeometryN(p),y=f.getGeometryN(p),v=g.compareToSameClass(y,c);if(v!==0)return v;p++}return p<h?1:p<d?-1:0}},t.prototype.apply=function(){var o=this;if(Mt(arguments[0],hd))for(var a=arguments[0],s=0;s<this._geometries.length;s++)o._geometries[s].apply(a);else if(Mt(arguments[0],$c)){var u=arguments[0];if(this._geometries.length===0)return null;for(var l=0;l<this._geometries.length&&(o._geometries[l].apply(u),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Mt(arguments[0],Zf)){var c=arguments[0];c.filter(this);for(var f=0;f<this._geometries.length;f++)o._geometries[f].apply(c)}else if(Mt(arguments[0],Tp)){var h=arguments[0];h.filter(this);for(var d=0;d<this._geometries.length;d++)o._geometries[d].apply(h)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),tn.shouldNeverReachHere(),null},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var s=0;s<this._geometries.length;s++)a._geometries[s]=o._geometries[s].clone();return a},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.isEmpty=function(){for(var o=this,a=0;a<this._geometries.length;a++)if(!o._geometries[a].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,n),t}(It),T0=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return It.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Fr.FALSE:0},t.prototype.isClosed=function(){var o=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!o._geometries[a].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[a-1-u]=o._geometries[u].reverse();return this.getFactory().createMultiLineString(s)},t.prototype.getBoundary=function(){return new gc(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[xT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,n),t}(iu),gc=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],n=vc.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};gc.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};gc.prototype.getBoundary=function(){return this._geom instanceof bo?this.boundaryLineString(this._geom):this._geom instanceof T0?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};gc.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this._bnRule.isInBoundary(2);return n?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};gc.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};gc.prototype.computeBoundaryCoordinates=function(t){var n=this,r=new Be;this._endpointMap=new Os;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);a.getNumPoints()!==0&&(n.addEndpoint(a.getCoordinateN(0)),n.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var s=this._endpointMap.entrySet().iterator();s.hasNext();){var u=s.next(),l=u.getValue(),c=l.count;n._bnRule.isInBoundary(c)&&r.add(u.getKey())}return fn.toCoordinateArray(r)};gc.prototype.addEndpoint=function(t){var n=this._endpointMap.get(t);n===null&&(n=new $D,this._endpointMap.put(t,n)),n.count++};gc.prototype.interfaces_=function(){return[]};gc.prototype.getClass=function(){return gc};gc.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new gc(t);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new gc(r,o);return a.getBoundary()}};var $D=function(){this.count=null};$D.prototype.interfaces_=function(){return[]};$D.prototype.getClass=function(){return $D};function hxe(){}function dxe(){}var pxe=function(){};function mxe(){}function gxe(){}function _xe(){}var _c=function(){},j3={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};_c.prototype.interfaces_=function(){return[]};_c.prototype.getClass=function(){return _c};_c.chars=function(t,n){for(var r=new Array(n).fill(null),o=0;o<n;o++)r[o]=t;return String(r)};_c.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new mxe,r=new hxe(n);return t.printStackTrace(r),n.toString()}else if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s="",u=new dxe(_c.getStackTrace(o)),l=new _xe(u),c=0;c<a;c++)try{s+=l.readLine()+_c.NEWLINE}catch(f){if(f instanceof gxe)tn.shouldNeverReachHere();else throw f}finally{}return s}};_c.split=function(t,n){for(var r=n.length,o=new Be,a=""+t,s=a.indexOf(n);s>=0;){var u=a.substring(0,s);o.add(u),a=a.substring(s+r),s=a.indexOf(n)}a.length>0&&o.add(a);for(var l=new Array(o.size()).fill(null),c=0;c<l.length;c++)l[c]=o.get(c);return l};_c.toString=function(){if(arguments.length===1){var t=arguments[0];return _c.SIMPLE_ORDINATE_FORMAT.format(t)}};_c.spaces=function(t){return _c.chars(" ",t)};j3.NEWLINE.get=function(){return cs.getProperty("line.separator")};j3.SIMPLE_ORDINATE_FORMAT.get=function(){return new pxe("0.#")};Object.defineProperties(_c,j3);var Vo=function(){};Vo.prototype.interfaces_=function(){return[]};Vo.prototype.getClass=function(){return Vo};Vo.copyCoord=function(t,n,r,o){for(var a=Math.min(t.getDimension(),r.getDimension()),s=0;s<a;s++)r.setOrdinate(o,s,t.getOrdinate(n,s))};Vo.isRing=function(t){var n=t.size();return n===0?!0:n<=3?!1:t.getOrdinate(0,xn.X)===t.getOrdinate(n-1,xn.X)&&t.getOrdinate(0,xn.Y)===t.getOrdinate(n-1,xn.Y)};Vo.isEqual=function(t,n){var r=t.size(),o=n.size();if(r!==o)return!1;for(var a=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)for(var u=0;u<a;u++){var l=t.getOrdinate(s,u),c=n.getOrdinate(s,u);if(t.getOrdinate(s,u)!==n.getOrdinate(s,u)&&!(Wt.isNaN(l)&&Wt.isNaN(c)))return!1}return!0};Vo.extend=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();if(Vo.copy(n,0,o,0,a),a>0)for(var s=a;s<r;s++)Vo.copy(n,a-1,o,s,1);return o};Vo.reverse=function(t){for(var n=t.size()-1,r=Math.trunc(n/2),o=0;o<=r;o++)Vo.swap(t,o,n-o)};Vo.swap=function(t,n,r){if(n===r)return null;for(var o=0;o<t.getDimension();o++){var a=t.getOrdinate(n,o);t.setOrdinate(n,o,t.getOrdinate(r,o)),t.setOrdinate(r,o,a)}};Vo.copy=function(t,n,r,o,a){for(var s=0;s<a;s++)Vo.copyCoord(t,n+s,r,o+s)};Vo.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var r=t.getDimension(),o=new oh;o.append("(");for(var a=0;a<n;a++){a>0&&o.append(" ");for(var s=0;s<r;s++)s>0&&o.append(","),o.append(_c.toString(t.getOrdinate(a,s)))}return o.append(")"),o.toString()}};Vo.ensureValidRing=function(t,n){var r=n.size();if(r===0)return n;if(r<=3)return Vo.createClosedRing(t,n,4);var o=n.getOrdinate(0,xn.X)===n.getOrdinate(r-1,xn.X)&&n.getOrdinate(0,xn.Y)===n.getOrdinate(r-1,xn.Y);return o?n:Vo.createClosedRing(t,n,r+1)};Vo.createClosedRing=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();Vo.copy(n,0,o,0,a);for(var s=a;s<r;s++)Vo.copy(n,0,o,s,1);return o};var bo=function(e){function t(r,o){e.call(this,o),this._points=null,this.init(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new ut:this._points.expandEnvelope(new ut)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._points.size()!==u._points.size())return!1;for(var l=0;l<this._points.size();l++)if(!o.equal(o._points.getCoordinate(l),u._points.getCoordinate(l),s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<Math.trunc(this._points.size()/2);a++){var s=o._points.size()-1-a;if(!o._points.getCoordinate(a).equals(o._points.getCoordinate(s)))return o._points.getCoordinate(a).compareTo(o._points.getCoordinate(s))>0&&Vo.reverse(o._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Fr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return Ue.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var o=this._points.copy();Vo.reverse(o);var a=this.getFactory().createLineString(o);return a},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){for(var a=arguments[0],s=a,u=0,l=0;u<this._points.size()&&l<s._points.size();){var c=o._points.getCoordinate(u).compareTo(s._points.getCoordinate(l));if(c!==0)return c;u++,l++}return u<this._points.size()?1:l<s._points.size()?-1:0}else if(arguments.length===2){var f=arguments[0],h=arguments[1],d=f;return h.compare(this._points,d._points)}},t.prototype.apply=function(){var o=this;if(Mt(arguments[0],hd))for(var a=arguments[0],s=0;s<this._points.size();s++)a.filter(o._points.getCoordinate(s));else if(Mt(arguments[0],$c)){var u=arguments[0];if(this._points.size()===0)return null;for(var l=0;l<this._points.size()&&(u.filter(o._points,l),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Mt(arguments[0],Zf)){var c=arguments[0];c.filter(this)}else if(Mt(arguments[0],Tp)){var f=arguments[0];f.filter(this)}},t.prototype.getBoundary=function(){return new gc(this).getBoundary()},t.prototype.isEquivalentClass=function(o){return o instanceof t},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._points=this._points.clone(),o},t.prototype.getCoordinateN=function(o){return this._points.getCoordinate(o)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(o){if(o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),o.size()===1)throw new so("Invalid number of points in LineString (found "+o.size()+" - must be 0 or >= 2)");this._points=o},t.prototype.isCoordinate=function(o){for(var a=this,s=0;s<this._points.size();s++)if(a._points.getCoordinate(s).equals(o))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(o){return this.getFactory().createPoint(this._points.getCoordinate(o))},t.prototype.interfaces_=function(){return[xT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,n),t}(It),wT=function(){};wT.prototype.interfaces_=function(){return[]};wT.prototype.getClass=function(){return wT};var sl=function(e){function t(r,o){e.call(this,o),this._coordinates=r||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new ut;var o=new ut;return o.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),o},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?this.isEmpty()&&o.isEmpty()?!0:this.isEmpty()!==o.isEmpty()?!1:this.equal(o.getCoordinate(),this.getCoordinate(),a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Fr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var o=arguments[0],a=o;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var s=arguments[0],u=arguments[1],l=s;return u.compare(this._coordinates,l._coordinates)}},t.prototype.apply=function(){if(Mt(arguments[0],hd)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this.getCoordinate())}else if(Mt(arguments[0],$c)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Mt(arguments[0],Zf)){var s=arguments[0];s.filter(this)}else if(Mt(arguments[0],Tp)){var u=arguments[0];u.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._coordinates=this._coordinates.clone(),o},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(o){o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),tn.isTrue(o.size()<=1),this._coordinates=o},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[wT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,n),t}(It),Hm=function(){};Hm.prototype.interfaces_=function(){return[]};Hm.prototype.getClass=function(){return Hm};var xa=function(e){function t(r,o,a){if(e.call(this,a),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),o===null&&(o=[]),e.hasNullElements(o))throw new so("holes must not contain null elements");if(r.isEmpty()&&e.hasNonEmptyElements(o))throw new so("shell is empty but holes are not");this._shell=r,this._holes=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var o=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),s=-1,u=this._shell.getCoordinates(),l=0;l<u.length;l++)s++,a[s]=u[l];for(var c=0;c<this._holes.length;c++)for(var f=o._holes[c].getCoordinates(),h=0;h<f.length;h++)s++,a[s]=f[h];return a},t.prototype.getArea=function(){var o=this,a=0;a+=Math.abs(Ue.signedArea(this._shell.getCoordinateSequence()));for(var s=0;s<this._holes.length;s++)a-=Math.abs(Ue.signedArea(o._holes[s].getCoordinateSequence()));return a},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var o=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),s=0;s<5;s++){var u=o.getX(s);if(!(u===a.getMinX()||u===a.getMaxX()))return!1;var l=o.getY(s);if(!(l===a.getMinY()||l===a.getMaxY()))return!1}for(var c=o.getX(0),f=o.getY(0),h=1;h<=4;h++){var d=o.getX(h),p=o.getY(h),g=d!==c,y=p!==f;if(g===y)return!1;c=d,f=p}return!0},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a,l=this._shell,c=u._shell;if(!l.equalsExact(c,s)||this._holes.length!==u._holes.length)return!1;for(var f=0;f<this._holes.length;f++)if(!o._holes[f].equalsExact(u._holes[f],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var o=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)o.normalize(o._holes[a],!1);C0.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],u=arguments[1];if(s.isEmpty())return null;var l=new Array(s.getCoordinates().length-1).fill(null);cs.arraycopy(s.getCoordinates(),0,l,0,l.length);var c=fn.minCoordinate(s.getCoordinates());fn.scroll(l,c),cs.arraycopy(l,0,s.getCoordinates(),0,l.length),s.getCoordinates()[l.length]=l[0],Ue.isCCW(s.getCoordinates())===u&&fn.reverse(s.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var o=this,a=0;a+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)a+=o._holes[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)a+=o._holes[s].getNumPoints();return a},t.prototype.reverse=function(){var o=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].copy().reverse();return a},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=this._shell,u=a._shell;return s.compareToSameClass(u)}else if(arguments.length===2){var l=arguments[0],c=arguments[1],f=l,h=this._shell,d=f._shell,p=h.compareToSameClass(d,c);if(p!==0)return p;for(var g=this.getNumInteriorRing(),y=f.getNumInteriorRing(),v=0;v<g&&v<y;){var w=o.getInteriorRingN(v),C=f.getInteriorRingN(v),E=w.compareToSameClass(C,c);if(E!==0)return E;v++}return v<g?1:v<y?-1:0}},t.prototype.apply=function(o){var a=this;if(Mt(o,hd)){this._shell.apply(o);for(var s=0;s<this._holes.length;s++)a._holes[s].apply(o)}else if(Mt(o,$c)){if(this._shell.apply(o),!o.isDone())for(var u=0;u<this._holes.length&&(a._holes[u].apply(o),!o.isDone());u++);o.isGeometryChanged()&&this.geometryChanged()}else if(Mt(o,Zf))o.filter(this);else if(Mt(o,Tp)){o.filter(this),this._shell.apply(o);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(o)}},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var s=0;s<this._holes.length;s++)a[s+1]=o._holes[s];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].clone();return a},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var o=this,a=this._shell.copy(),s=new Array(this._holes.length).fill(null),u=0;u<s.length;u++)s[u]=o._holes[u].copy();return new t(a,s,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(o){return this._holes[o]},t.prototype.interfaces_=function(){return[Hm]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,n),t}(It),t1=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return It.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._geometries[o].getCoordinate()}else return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return Fr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[wT]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,n),t}(iu),dd=function(e){function t(r,o){r instanceof ae&&o instanceof cn&&(r=o.getCoordinateSequenceFactory().create(r)),e.call(this,r,o),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return It.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Fr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var o=this._points.copy();Vo.reverse(o);var a=this.getFactory().createLinearRing(o);return a},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new so("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new so("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,n),t}(bo),cd=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return It.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createMultiPolygon(s)},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new Be,s=0;s<this._geometries.length;s++)for(var u=o._geometries[s],l=u.getBoundary(),c=0;c<l.getNumGeometries();c++)a.add(l.getGeometryN(c));var f=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(f))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[Hm]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,n),t}(iu),Cc=function(t){this._factory=t||null,this._isUserDataCopied=!1},AP={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Cc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};Cc.prototype.edit=function(t,n){if(t===null)return null;var r=this.editInternal(t,n);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};Cc.prototype.editInternal=function(t,n){return this._factory===null&&(this._factory=t.getFactory()),t instanceof iu?this.editGeometryCollection(t,n):t instanceof xa?this.editPolygon(t,n):t instanceof sl?n.edit(t,this._factory):t instanceof bo?n.edit(t,this._factory):(tn.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};Cc.prototype.editGeometryCollection=function(t,n){for(var r=this,o=n.edit(t,this._factory),a=new Be,s=0;s<o.getNumGeometries();s++){var u=r.edit(o.getGeometryN(s),n);u===null||u.isEmpty()||a.add(u)}return o.getClass()===t1?this._factory.createMultiPoint(a.toArray([])):o.getClass()===T0?this._factory.createMultiLineString(a.toArray([])):o.getClass()===cd?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};Cc.prototype.editPolygon=function(t,n){var r=this,o=n.edit(t,this._factory);if(o===null&&(o=this._factory.createPolygon(null)),o.isEmpty())return o;var a=this.edit(o.getExteriorRing(),n);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var s=new Be,u=0;u<o.getNumInteriorRing();u++){var l=r.edit(o.getInteriorRingN(u),n);l===null||l.isEmpty()||s.add(l)}return this._factory.createPolygon(a,s.toArray([]))};Cc.prototype.interfaces_=function(){return[]};Cc.prototype.getClass=function(){return Cc};Cc.GeometryEditorOperation=function(){};AP.NoOpGeometryOperation.get=function(){return ET};AP.CoordinateOperation.get=function(){return TT};AP.CoordinateSequenceOperation.get=function(){return ST};Object.defineProperties(Cc,AP);var ET=function(){};ET.prototype.edit=function(t,n){return t};ET.prototype.interfaces_=function(){return[Cc.GeometryEditorOperation]};ET.prototype.getClass=function(){return ET};var TT=function(){};TT.prototype.edit=function(t,n){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof dd?n.createLinearRing(r):t instanceof bo?n.createLineString(r):t instanceof sl?r.length>0?n.createPoint(r[0]):n.createPoint():t};TT.prototype.interfaces_=function(){return[Cc.GeometryEditorOperation]};TT.prototype.getClass=function(){return TT};var ST=function(){};ST.prototype.edit=function(t,n){return t instanceof dd?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof bo?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof sl?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t};ST.prototype.interfaces_=function(){return[Cc.GeometryEditorOperation]};ST.prototype.getClass=function(){return ST};var Fo=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)t._coordinates[r]=new ae}else if(Mt(arguments[0],xn)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._coordinates=new Array(o.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)t._coordinates[a]=o.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],u=arguments[1];this._coordinates=s,this._dimension=u,s===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],c=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=c;for(var f=0;f<l;f++)t._coordinates[f]=new ae}}},yX={serialVersionUID:{configurable:!0}};Fo.prototype.setOrdinate=function(t,n,r){switch(n){case xn.X:this._coordinates[t].x=r;break;case xn.Y:this._coordinates[t].y=r;break;case xn.Z:this._coordinates[t].z=r;break;default:throw new so("invalid ordinateIndex")}};Fo.prototype.size=function(){return this._coordinates.length};Fo.prototype.getOrdinate=function(t,n){switch(n){case xn.X:return this._coordinates[t].x;case xn.Y:return this._coordinates[t].y;case xn.Z:return this._coordinates[t].z;default:}return Wt.NaN};Fo.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};Fo.prototype.getCoordinateCopy=function(t){return new ae(this._coordinates[t])};Fo.prototype.getDimension=function(){return this._dimension};Fo.prototype.getX=function(t){return this._coordinates[t].x};Fo.prototype.clone=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].clone();return new Fo(n,this._dimension)};Fo.prototype.expandEnvelope=function(t){for(var n=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(n._coordinates[r]);return t};Fo.prototype.copy=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].copy();return new Fo(n,this._dimension)};Fo.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var n=new oh(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(t._coordinates[r]);return n.append(")"),n.toString()}else return"()"};Fo.prototype.getY=function(t){return this._coordinates[t].y};Fo.prototype.toCoordinateArray=function(){return this._coordinates};Fo.prototype.interfaces_=function(){return[xn,Ec]};Fo.prototype.getClass=function(){return Fo};yX.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(Fo,yX);var pd=function(){},K3={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};pd.prototype.readResolve=function(){return pd.instance()};pd.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Fo(t)}else if(Mt(arguments[0],xn)){var n=arguments[0];return new Fo(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return o>3&&(o=3),o<2?new Fo(r):new Fo(r,o)}};pd.prototype.interfaces_=function(){return[KC,Ec]};pd.prototype.getClass=function(){return pd};pd.instance=function(){return pd.instanceObject};K3.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};K3.instanceObject.get=function(){return new pd};Object.defineProperties(pd,K3);var vX=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,o){return this.map_.set(r,o),o},t.prototype.values=function(){for(var r=new Be,o=this.map_.values(),a=o.next();!a.done;)r.add(a.value),a=o.next();return r},t.prototype.entrySet=function(){var r=new X3;return this.map_.entries().forEach(function(o){return r.add(o)}),r},t.prototype.size=function(){return this.map_.size()},t}(My),kr=function e(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Qf){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},Z3={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};kr.prototype.equals=function(t){if(!(t instanceof kr))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale};kr.prototype.compareTo=function(t){var n=t,r=this.getMaximumSignificantDigits(),o=n.getMaximumSignificantDigits();return new jf(r).compareTo(new jf(o))};kr.prototype.getScale=function(){return this._scale};kr.prototype.isFloating=function(){return this._modelType===kr.FLOATING||this._modelType===kr.FLOATING_SINGLE};kr.prototype.getType=function(){return this._modelType};kr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===kr.FLOATING?t="Floating":this._modelType===kr.FLOATING_SINGLE?t="Floating-Single":this._modelType===kr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};kr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Wt.isNaN(t))return t;if(this._modelType===kr.FLOATING_SINGLE){var n=t;return n}return this._modelType===kr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof ae){var r=arguments[0];if(this._modelType===kr.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};kr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===kr.FLOATING?t=16:this._modelType===kr.FLOATING_SINGLE?t=6:this._modelType===kr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};kr.prototype.setScale=function(t){this._scale=Math.abs(t)};kr.prototype.interfaces_=function(){return[Ec,wc]};kr.prototype.getClass=function(){return kr};kr.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n};Z3.serialVersionUID.get=function(){return 7777263578777804e3};Z3.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(kr,Z3);var Qf=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},Q3={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Qf.prototype.readResolve=function(){return Qf.nameToTypeMap.get(this._name)};Qf.prototype.toString=function(){return this._name};Qf.prototype.interfaces_=function(){return[Ec]};Qf.prototype.getClass=function(){return Qf};Q3.serialVersionUID.get=function(){return-552860263173159e4};Q3.nameToTypeMap.get=function(){return new vX};Object.defineProperties(Qf,Q3);kr.Type=Qf;kr.FIXED=new Qf("FIXED");kr.FLOATING=new Qf("FLOATING");kr.FLOATING_SINGLE=new Qf("FLOATING SINGLE");var cn=function e(){this._precisionModel=new kr,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Mt(arguments[0],KC)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof kr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},CX={serialVersionUID:{configurable:!0}};cn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new ae(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new ae(t.getMinX(),t.getMinY()),new ae(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new ae(t.getMinX(),t.getMinY()),new ae(t.getMinX(),t.getMaxY()),new ae(t.getMaxX(),t.getMaxY()),new ae(t.getMaxX(),t.getMinY()),new ae(t.getMinX(),t.getMinY())]),null)};cn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new bo(this.getCoordinateSequenceFactory().create(t),this);if(Mt(t,xn))return new bo(t,this)}else return new bo(this.getCoordinateSequenceFactory().create([]),this)};cn.prototype.createMultiLineString=function(){if(arguments.length===0)return new T0(null,this);if(arguments.length===1){var t=arguments[0];return new T0(t,this)}};cn.prototype.buildGeometry=function(t){for(var n=null,r=!1,o=!1,a=t.iterator();a.hasNext();){var s=a.next(),u=s.getClass();n===null&&(n=u),u!==n&&(r=!0),s.isGeometryCollectionOrDerived()&&(o=!0)}if(n===null)return this.createGeometryCollection();if(r||o)return this.createGeometryCollection(cn.toGeometryArray(t));var l=t.iterator().next(),c=t.size()>1;if(c){if(l instanceof xa)return this.createMultiPolygon(cn.toPolygonArray(t));if(l instanceof bo)return this.createMultiLineString(cn.toLineStringArray(t));if(l instanceof sl)return this.createMultiPoint(cn.toPointArray(t));tn.shouldNeverReachHere("Unhandled class: "+l.getClass().getName())}return l};cn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};cn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof ae){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Mt(arguments[0],xn)){var n=arguments[0];return new sl(n,this)}}};cn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};cn.prototype.createPolygon=function(){if(arguments.length===0)return new xa(null,null,this);if(arguments.length===1){if(Mt(arguments[0],xn)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof dd){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return new xa(o,a,this)}};cn.prototype.getSRID=function(){return this._SRID};cn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new iu(null,this);if(arguments.length===1){var t=arguments[0];return new iu(t,this)}};cn.prototype.createGeometry=function(t){var n=new Cc(this);return n.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};cn.prototype.getPrecisionModel=function(){return this._precisionModel};cn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Mt(arguments[0],xn)){var n=arguments[0];return new dd(n,this)}}};cn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new cd(null,this);if(arguments.length===1){var t=arguments[0];return new cd(t,this)}};cn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new t1(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new t1(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(Mt(arguments[0],xn)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(o.size()).fill(null),s=0;s<o.size();s++){var u=t.getCoordinateSequenceFactory().create(1,o.getDimension());Vo.copy(o,s,u,0,1),a[s]=t.createPoint(u)}return this.createMultiPoint(a)}}};cn.prototype.interfaces_=function(){return[Ec]};cn.prototype.getClass=function(){return cn};cn.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.getDefaultCoordinateSequenceFactory=function(){return pd.instance()};cn.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};cn.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)};CX.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(cn,CX);var yxe=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],bP=function(t){this.geometryFactory=t||new cn};bP.prototype.read=function(t){var n;typeof t=="string"?n=JSON.parse(t):n=t;var r=n.type;if(!Uf[r])throw new Error("Unknown GeoJSON type: "+n.type);return yxe.indexOf(r)!==-1?Uf[r].apply(this,[n.coordinates]):r==="GeometryCollection"?Uf[r].apply(this,[n.geometries]):Uf[r].apply(this,[n])};bP.prototype.write=function(t){var n=t.getGeometryType();if(!gp[n])throw new Error("Geometry is not supported");return gp[n].apply(this,[t])};var Uf={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var r=e.geometry.type;if(!Uf[r])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=Uf.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t=this,n={};if(e.features){n.features=[];for(var r=0;r<e.features.length;++r)n.features.push(t.read(e.features[r]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push(new ae(r[0],r[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new ae(e[0],e[1]),new ae(e[2],e[1]),new ae(e[2],e[3]),new ae(e[0],e[3]),new ae(e[0],e[1])])},Point:function(e){var t=new ae(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(Uf.Point.apply(t,[e[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var t=Uf.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(Uf.LineString.apply(t,[e[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var t=this,n=Uf.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(n),o=[],a=1;a<e.length;++a){var s=e[a],u=Uf.coordinates.apply(t,[s]),l=t.geometryFactory.createLinearRing(u);o.push(l)}return this.geometryFactory.createPolygon(r,o)},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(Uf.Polygon.apply(t,[o]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(t.read(o))}return this.geometryFactory.createGeometryCollection(n)}},gp={coordinate:function(e){return[e.x,e.y]},Point:function(e){var t=gp.coordinate.apply(this,[e.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=gp.Point.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var t=this,n=[],r=e.getCoordinates(),o=0;o<r.length;++o){var a=r[o];n.push(gp.coordinate.apply(t,[a]))}return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=gp.LineString.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var t=this,n=[],r=gp.LineString.apply(this,[e._shell]);n.push(r.coordinates);for(var o=0;o<e._holes.length;++o){var a=e._holes[o],s=gp.LineString.apply(t,[a]);n.push(s.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=gp.Polygon.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=o.getGeometryType();n.push(gp[a].apply(t,[o]))}return{type:"GeometryCollection",geometries:n}}},x1=function(t){this.geometryFactory=t||new cn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new bP(this.geometryFactory)};x1.prototype.read=function(t){var n=this.parser.read(t);return this.precisionModel.getType()===kr.FIXED&&this.reducePrecision(n),n};x1.prototype.reducePrecision=function(t){var n=this,r,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,o=t.points.length;r<o;r++)n.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,o=t.geometries.length;r<o;r++)n.reducePrecision(t.geometries[r])};var HT=function(){this.parser=new bP(this.geometryFactory)};HT.prototype.write=function(t){return this.parser.write(t)};var Pe=function(){},IP={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Pe.prototype.interfaces_=function(){return[]};Pe.prototype.getClass=function(){return Pe};Pe.opposite=function(t){return t===Pe.LEFT?Pe.RIGHT:t===Pe.RIGHT?Pe.LEFT:t};IP.ON.get=function(){return 0};IP.LEFT.get=function(){return 1};IP.RIGHT.get=function(){return 2};Object.defineProperties(Pe,IP);function DP(e){this.message=e||""}DP.prototype=new Error;DP.prototype.name="EmptyStackException";function ah(){this.array_=[]}ah.prototype=new Qc;ah.prototype.add=function(e){return this.array_.push(e),!0};ah.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]};ah.prototype.push=function(e){return this.array_.push(e),e};ah.prototype.pop=function(e){if(this.array_.length===0)throw new DP;return this.array_.pop()};ah.prototype.peek=function(){if(this.array_.length===0)throw new DP;return this.array_[this.array_.length-1]};ah.prototype.empty=function(){return this.array_.length===0};ah.prototype.isEmpty=function(){return this.empty()};ah.prototype.search=function(e){return this.array_.indexOf(e)};ah.prototype.size=function(){return this.array_.length};ah.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};var Jf=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Jf.prototype.getCoordinate=function(){return this._minCoord};Jf.prototype.getRightmostSide=function(t,n){var r=this.getRightmostSideOfSegment(t,n);return r<0&&(r=this.getRightmostSideOfSegment(t,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};Jf.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();tn.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this._minIndex-1],r=t[this._minIndex+1],o=Ue.computeOrientation(this._minCoord,r,n),a=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&o===Ue.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&o===Ue.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};Jf.prototype.getRightmostSideOfSegment=function(t,n){var r=t.getEdge(),o=r.getCoordinates();if(n<0||n+1>=o.length||o[n].y===o[n+1].y)return-1;var a=Pe.LEFT;return o[n].y<o[n+1].y&&(a=Pe.RIGHT),a};Jf.prototype.getEdge=function(){return this._orientedDe};Jf.prototype.checkForRightmostCoordinate=function(t){for(var n=this,r=t.getEdge().getCoordinates(),o=0;o<r.length-1;o++)(n._minCoord===null||r[o].x>n._minCoord.x)&&(n._minDe=t,n._minIndex=o,n._minCoord=r[o])};Jf.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),n=t.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Jf.prototype.findEdge=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();!o.isForward()||n.checkForRightmostCoordinate(o)}tn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Pe.LEFT&&(this._orientedDe=this._minDe.getSym())};Jf.prototype.interfaces_=function(){return[]};Jf.prototype.getClass=function(){return Jf};var Sp=function(e){function t(n,r){e.call(this,t.msgWithCoord(n,r)),this.pt=r?new ae(r):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,o){return o?r:r+" [ "+o+" ]"},t}(Ep),PP=function(){this.array_=[]};PP.prototype.addLast=function(t){this.array_.push(t)};PP.prototype.removeFirst=function(){return this.array_.shift()};PP.prototype.isEmpty=function(){return this.array_.length===0};var ou=function(){this._finder=null,this._dirEdgeList=new Be,this._nodes=new Be,this._rightMostCoord=null,this._env=null,this._finder=new Jf};ou.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}};ou.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};ou.prototype.computeNodeDepth=function(t){for(var n=this,r=null,o=t.getEdges().iterator();o.hasNext();){var a=o.next();if(a.isVisited()||a.getSym().isVisited()){r=a;break}}if(r===null)throw new Sp("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var s=t.getEdges().iterator();s.hasNext();){var u=s.next();u.setVisited(!0),n.copySymDepths(u)}};ou.prototype.computeDepth=function(t){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(Pe.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)};ou.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};ou.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Pe.RIGHT)>=1&&n.getDepth(Pe.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};ou.prototype.computeDepths=function(t){var n=this,r=new X3,o=new PP,a=t.getNode();for(o.addLast(a),r.add(a),t.setVisited(!0);!o.isEmpty();){var s=o.removeFirst();r.add(s),n.computeNodeDepth(s);for(var u=s.getEdges().iterator();u.hasNext();){var l=u.next(),c=l.getSym();if(!c.isVisited()){var f=c.getNode();r.contains(f)||(o.addLast(f),r.add(f))}}}};ou.prototype.compareTo=function(t){var n=t;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};ou.prototype.getEnvelope=function(){if(this._env===null){for(var t=new ut,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),o=r.getEdge().getCoordinates(),a=0;a<o.length-1;a++)t.expandToInclude(o[a]);this._env=t}return this._env};ou.prototype.addReachable=function(t){var n=this,r=new ah;for(r.add(t);!r.empty();){var o=r.pop();n.add(o,r)}};ou.prototype.copySymDepths=function(t){var n=t.getSym();n.setDepth(Pe.LEFT,t.getDepth(Pe.RIGHT)),n.setDepth(Pe.RIGHT,t.getDepth(Pe.LEFT))};ou.prototype.add=function(t,n){var r=this;t.setVisited(!0),this._nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var a=o.next();r._dirEdgeList.add(a);var s=a.getSym(),u=s.getNode();u.isVisited()||n.push(u)}};ou.prototype.getNodes=function(){return this._nodes};ou.prototype.getDirectedEdges=function(){return this._dirEdgeList};ou.prototype.interfaces_=function(){return[wc]};ou.prototype.getClass=function(){return ou};var Ui=function e(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Pe.ON]=r}else if(arguments[0]instanceof e){var o=arguments[0];if(this.init(o.location.length),o!==null)for(var a=0;a<this.location.length;a++)t.location[a]=o.location[a]}}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.init(3),this.location[Pe.ON]=s,this.location[Pe.LEFT]=u,this.location[Pe.RIGHT]=l}};Ui.prototype.setAllLocations=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=t};Ui.prototype.isNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]!==he.NONE)return!1;return!0};Ui.prototype.setAllLocationsIfNull=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===he.NONE&&(n.location[r]=t)};Ui.prototype.isLine=function(){return this.location.length===1};Ui.prototype.merge=function(t){var n=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[Pe.ON]=this.location[Pe.ON],r[Pe.LEFT]=he.NONE,r[Pe.RIGHT]=he.NONE,this.location=r}for(var o=0;o<this.location.length;o++)n.location[o]===he.NONE&&o<t.location.length&&(n.location[o]=t.location[o])};Ui.prototype.getLocations=function(){return this.location};Ui.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Pe.LEFT];this.location[Pe.LEFT]=this.location[Pe.RIGHT],this.location[Pe.RIGHT]=t};Ui.prototype.toString=function(){var t=new oh;return this.location.length>1&&t.append(he.toLocationSymbol(this.location[Pe.LEFT])),t.append(he.toLocationSymbol(this.location[Pe.ON])),this.location.length>1&&t.append(he.toLocationSymbol(this.location[Pe.RIGHT])),t.toString()};Ui.prototype.setLocations=function(t,n,r){this.location[Pe.ON]=t,this.location[Pe.LEFT]=n,this.location[Pe.RIGHT]=r};Ui.prototype.get=function(t){return t<this.location.length?this.location[t]:he.NONE};Ui.prototype.isArea=function(){return this.location.length>1};Ui.prototype.isAnyNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]===he.NONE)return!0;return!1};Ui.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Pe.ON,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};Ui.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(he.NONE)};Ui.prototype.isEqualOnSide=function(t,n){return this.location[n]===t.location[n]};Ui.prototype.allPositionsEqual=function(t){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==t)return!1;return!0};Ui.prototype.interfaces_=function(){return[]};Ui.prototype.getClass=function(){return Ui};var ni=function e(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Ui(t),this.elt[1]=new Ui(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new Ui(n.elt[0]),this.elt[1]=new Ui(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.elt[0]=new Ui(he.NONE),this.elt[1]=new Ui(he.NONE),this.elt[r].setLocation(o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this.elt[0]=new Ui(a,s,u),this.elt[1]=new Ui(a,s,u)}else if(arguments.length===4){var l=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3];this.elt[0]=new Ui(he.NONE,he.NONE,he.NONE),this.elt[1]=new Ui(he.NONE,he.NONE,he.NONE),this.elt[l].setLocations(c,f,h)}};ni.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};ni.prototype.setAllLocations=function(t,n){this.elt[t].setAllLocations(n)};ni.prototype.isNull=function(t){return this.elt[t].isNull()};ni.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};ni.prototype.isLine=function(t){return this.elt[t].isLine()};ni.prototype.merge=function(t){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&t.elt[r]!==null?n.elt[r]=new Ui(t.elt[r]):n.elt[r].merge(t.elt[r])};ni.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};ni.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Pe.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};ni.prototype.toString=function(){var t=new oh;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};ni.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};ni.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};ni.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Pe.ON,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this.elt[r].setLocation(o,a)}};ni.prototype.isEqualOnSide=function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)};ni.prototype.allPositionsEqual=function(t,n){return this.elt[t].allPositionsEqual(n)};ni.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Ui(this.elt[t].location[0]))};ni.prototype.interfaces_=function(){return[]};ni.prototype.getClass=function(){return ni};ni.toLineLabel=function(t){for(var n=new ni(he.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n};var ia=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Be,this._pts=new Be,this._label=new ni(he.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Be,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()};ia.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=Ue.isCCW(this._ring.getCoordinates())};ia.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};ia.prototype.computePoints=function(t){var n=this;this._startDe=t;var r=t,o=!0;do{if(r===null)throw new Sp("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new Sp("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var a=r.getLabel();tn.isTrue(a.isArea()),n.mergeLabel(a),n.addPoints(r.getEdge(),r.isForward(),o),o=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};ia.prototype.getLinearRing=function(){return this._ring};ia.prototype.getCoordinate=function(t){return this._pts.get(t)};ia.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),o=r.getEdges().getOutgoingDegree(t);o>t._maxNodeDegree&&(t._maxNodeDegree=o),n=t.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};ia.prototype.addPoints=function(t,n,r){var o=this,a=t.getCoordinates();if(n){var s=1;r&&(s=0);for(var u=s;u<a.length;u++)o._pts.add(a[u])}else{var l=a.length-2;r&&(l=a.length-1);for(var c=l;c>=0;c--)o._pts.add(a[c])}};ia.prototype.isHole=function(){return this._isHole};ia.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};ia.prototype.containsPoint=function(t){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(t)||!Ue.isPointInRing(t,n.getCoordinates()))return!1;for(var o=this._holes.iterator();o.hasNext();){var a=o.next();if(a.containsPoint(t))return!1}return!0};ia.prototype.addHole=function(t){this._holes.add(t)};ia.prototype.isShell=function(){return this._shell===null};ia.prototype.getLabel=function(){return this._label};ia.prototype.getEdges=function(){return this._edges};ia.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};ia.prototype.getShell=function(){return this._shell};ia.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=n.getLocation(r,Pe.RIGHT);if(o===he.NONE)return null;if(this._label.getLocation(r)===he.NONE)return this._label.setLocation(r,o),null}};ia.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};ia.prototype.toPolygon=function(t){for(var n=this,r=new Array(this._holes.size()).fill(null),o=0;o<this._holes.size();o++)r[o]=n._holes.get(o).getLinearRing();var a=t.createPolygon(this.getLinearRing(),r);return a};ia.prototype.interfaces_=function(){return[]};ia.prototype.getClass=function(){return ia};var vxe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,o){r.setMinEdgeRing(o)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ia),Cxe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,o=new Be,a=this._startDe;do{if(a.getMinEdgeRing()===null){var s=new vxe(a,r._geometryFactory);o.add(s)}a=a.getNext()}while(a!==this._startDe);return o},t.prototype.setEdgeRing=function(r,o){r.setEdgeRing(o)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,o=this._startDe;do{var a=o.getNode();a.getEdges().linkMinimalDirectedEdges(r),o=o.getNext()}while(o!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ia),zl=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};zl.prototype.setVisited=function(t){this._isVisited=t};zl.prototype.setInResult=function(t){this._isInResult=t};zl.prototype.isCovered=function(){return this._isCovered};zl.prototype.isCoveredSet=function(){return this._isCoveredSet};zl.prototype.setLabel=function(t){this._label=t};zl.prototype.getLabel=function(){return this._label};zl.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};zl.prototype.updateIM=function(t){tn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};zl.prototype.isInResult=function(){return this._isInResult};zl.prototype.isVisited=function(){return this._isVisited};zl.prototype.interfaces_=function(){return[]};zl.prototype.getClass=function(){return zl};var MP=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new ni(0,he.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var o=r.next();if(o.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,o){var a=he.NONE;if(a=this._label.getLocation(o),!r.isNull(o)){var s=r.getLocation(o);a!==he.BOUNDARY&&(a=s)}return a},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];this._label===null?this._label=new ni(r,o):this._label.setLocation(r,o)}else return e.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var o=arguments[0];this.mergeLabel(o._label)}else if(arguments[0]instanceof ni)for(var a=arguments[0],s=0;s<2;s++){var u=r.computeMergedLocation(a,s),l=r._label.getLocation(s);l===he.NONE&&r._label.setLocation(s,u)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var o=he.NONE;this._label!==null&&(o=this._label.getLocation(r));var a=null;switch(o){case he.BOUNDARY:a=he.INTERIOR;break;case he.INTERIOR:a=he.BOUNDARY;break;default:a=he.BOUNDARY;break}this._label.setLocation(r,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(zl),$f=function(){this.nodeMap=new Os,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};$f.prototype.find=function(t){return this.nodeMap.get(t)};$f.prototype.addNode=function(){if(arguments[0]instanceof ae){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}else if(arguments[0]instanceof MP){var r=arguments[0],o=this.nodeMap.get(r.getCoordinate());return o===null?(this.nodeMap.put(r.getCoordinate(),r),r):(o.mergeLabel(r),o)}};$f.prototype.print=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};$f.prototype.iterator=function(){return this.nodeMap.values().iterator()};$f.prototype.values=function(){return this.nodeMap.values()};$f.prototype.getBoundaryNodes=function(t){for(var n=new Be,r=this.iterator();r.hasNext();){var o=r.next();o.getLabel().getLocation(t)===he.BOUNDARY&&n.add(o)}return n};$f.prototype.add=function(t){var n=t.getCoordinate(),r=this.addNode(n);r.add(t)};$f.prototype.interfaces_=function(){return[]};$f.prototype.getClass=function(){return $f};var Ti=function(){},qT={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Ti.prototype.interfaces_=function(){return[]};Ti.prototype.getClass=function(){return Ti};Ti.isNorthern=function(t){return t===Ti.NE||t===Ti.NW};Ti.isOpposite=function(t,n){if(t===n)return!1;var r=(t-n+4)%4;return r===2};Ti.commonHalfPlane=function(t,n){if(t===n)return t;var r=(t-n+4)%4;if(r===2)return-1;var o=t<n?t:n,a=t>n?t:n;return o===0&&a===3?3:o};Ti.isInHalfPlane=function(t,n){return n===Ti.SE?t===Ti.SE||t===Ti.SW:t===n||t===n+1};Ti.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new so("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?Ti.NE:Ti.SE:n>=0?Ti.NW:Ti.SW}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var r=arguments[0],o=arguments[1];if(o.x===r.x&&o.y===r.y)throw new so("Cannot compute the quadrant for two identical points "+r);return o.x>=r.x?o.y>=r.y?Ti.NE:Ti.SE:o.y>=r.y?Ti.NW:Ti.SW}};qT.NE.get=function(){return 0};qT.NW.get=function(){return 1};qT.SW.get=function(){return 2};qT.SE.get=function(){return 3};Object.defineProperties(Ti,qT);var Ns=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=null;this._edge=n,this.init(r,o),this._label=a}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this._edge=s,this.init(u,l),this._label=c}};Ns.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Ue.computeOrientation(t._p0,t._p1,this._p1)};Ns.prototype.getDy=function(){return this._dy};Ns.prototype.getCoordinate=function(){return this._p0};Ns.prototype.setNode=function(t){this._node=t};Ns.prototype.print=function(t){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),o=r.lastIndexOf("."),a=r.substring(o+1);t.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Ns.prototype.compareTo=function(t){var n=t;return this.compareDirection(n)};Ns.prototype.getDirectedCoordinate=function(){return this._p1};Ns.prototype.getDx=function(){return this._dx};Ns.prototype.getLabel=function(){return this._label};Ns.prototype.getEdge=function(){return this._edge};Ns.prototype.getQuadrant=function(){return this._quadrant};Ns.prototype.getNode=function(){return this._node};Ns.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),o=n.substring(r+1);return"  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Ns.prototype.computeLabel=function(t){};Ns.prototype.init=function(t,n){this._p0=t,this._p1=n,this._dx=n.x-t.x,this._dy=n.y-t.y,this._quadrant=Ti.quadrant(this._dx,this._dy),tn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Ns.prototype.interfaces_=function(){return[wc]};Ns.prototype.getClass=function(){return Ns};var l3=function(e){function t(){var n=arguments[0],r=arguments[1];if(e.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var o=n.getNumPoints()-1;this.init(n.getCoordinate(o),n.getCoordinate(o-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new ni(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,o){if(this._depth[r]!==-999&&this._depth[r]!==o)throw new Sp("assigned depths do not match",this.getCoordinate());this._depth[r]=o},t.prototype.isInteriorAreaEdge=function(){for(var r=this,o=!0,a=0;a<2;a++)r._label.isArea(a)&&r._label.getLocation(a,Pe.LEFT)===he.INTERIOR&&r._label.getLocation(a,Pe.RIGHT)===he.INTERIOR||(o=!1);return o},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){e.prototype.print.call(this,r),r.print(" "+this._depth[Pe.LEFT]+"/"+this._depth[Pe.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,he.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,he.EXTERIOR);return r&&o&&a},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,o){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var s=1;r===Pe.LEFT&&(s=-1);var u=Pe.opposite(r),l=a*s,c=o+l;this.setDepth(r,o),this.setDepth(u,c)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,o){return r===he.EXTERIOR&&o===he.INTERIOR?1:r===he.INTERIOR&&o===he.EXTERIOR?-1:0},t}(Ns),n1=function(){};n1.prototype.createNode=function(t){return new MP(t,null)};n1.prototype.interfaces_=function(){return[]};n1.prototype.getClass=function(){return n1};var vo=function(){if(this._edges=new Be,this._nodes=null,this._edgeEndList=new Be,arguments.length===0)this._nodes=new $f(new n1);else if(arguments.length===1){var t=arguments[0];this._nodes=new $f(t)}};vo.prototype.printEdges=function(t){var n=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var o=n._edges.get(r);o.print(t),o.eiList.print(t)}};vo.prototype.find=function(t){return this._nodes.find(t)};vo.prototype.addNode=function(){if(arguments[0]instanceof MP){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof ae){var n=arguments[0];return this._nodes.addNode(n)}};vo.prototype.getNodeIterator=function(){return this._nodes.iterator()};vo.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}};vo.prototype.debugPrintln=function(t){cs.out.println(t)};vo.prototype.isBoundaryNode=function(t,n){var r=this._nodes.find(n);if(r===null)return!1;var o=r.getLabel();return o!==null&&o.getLocation(t)===he.BOUNDARY};vo.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}};vo.prototype.matchInSameDirection=function(t,n,r,o){return t.equals(r)?Ue.computeOrientation(t,n,o)===Ue.COLLINEAR&&Ti.quadrant(t,n)===Ti.quadrant(r,o):!1};vo.prototype.getEdgeEnds=function(){return this._edgeEndList};vo.prototype.debugPrint=function(t){cs.out.print(t)};vo.prototype.getEdgeIterator=function(){return this._edges.iterator()};vo.prototype.findEdgeInSameDirection=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(r.matchInSameDirection(t,n,s[0],s[1])||r.matchInSameDirection(t,n,s[s.length-1],s[s.length-2]))return a}return null};vo.prototype.insertEdge=function(t){this._edges.add(t)};vo.prototype.findEdgeEnd=function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===t)return r}return null};vo.prototype.addEdges=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();n._edges.add(o);var a=new l3(o,!0),s=new l3(o,!1);a.setSym(s),s.setSym(a),n.add(a),n.add(s)}};vo.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};vo.prototype.getNodes=function(){return this._nodes.values()};vo.prototype.findEdge=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(t.equals(s[0])&&n.equals(s[1]))return a}return null};vo.prototype.interfaces_=function(){return[]};vo.prototype.getClass=function(){return vo};vo.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var ul=function(){this._geometryFactory=null,this._shellList=new Be;var t=arguments[0];this._geometryFactory=t};ul.prototype.sortShellsAndHoles=function(t,n,r){for(var o=t.iterator();o.hasNext();){var a=o.next();a.isHole()?r.add(a):n.add(a)}};ul.prototype.computePolygons=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=a.toPolygon(n._geometryFactory);r.add(s)}return r};ul.prototype.placeFreeHoles=function(t,n){for(var r=this,o=n.iterator();o.hasNext();){var a=o.next();if(a.getShell()===null){var s=r.findEdgeRingContaining(a,t);if(s===null)throw new Sp("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(s)}}};ul.prototype.buildMinimalEdgeRings=function(t,n,r){for(var o=this,a=new Be,s=t.iterator();s.hasNext();){var u=s.next();if(u.getMaxNodeDegree()>2){u.linkDirectedEdgesForMinimalEdgeRings();var l=u.buildMinimalRings(),c=o.findShell(l);c!==null?(o.placePolygonHoles(c,l),n.add(c)):r.addAll(l)}else a.add(u)}return a};ul.prototype.containsPoint=function(t){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(t))return!0}return!1};ul.prototype.buildMaximalEdgeRings=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var s=new Cxe(a,n._geometryFactory);r.add(s),s.setInResult()}}return r};ul.prototype.placePolygonHoles=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next();o.isHole()&&o.setShell(t)}};ul.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};ul.prototype.findEdgeRingContaining=function(t,n){for(var r=t.getLinearRing(),o=r.getEnvelopeInternal(),a=r.getCoordinateN(0),s=null,u=null,l=n.iterator();l.hasNext();){var c=l.next(),f=c.getLinearRing(),h=f.getEnvelopeInternal();s!==null&&(u=s.getLinearRing().getEnvelopeInternal());var d=!1;h.contains(o)&&Ue.isPointInRing(a,f.getCoordinates())&&(d=!0),d&&(s===null||u.contains(h))&&(s=c)}return s};ul.prototype.findShell=function(t){for(var n=0,r=null,o=t.iterator();o.hasNext();){var a=o.next();a.isHole()||(r=a,n++)}return tn.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};ul.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];vo.linkResultDirectedEdges(r);var o=this.buildMaximalEdgeRings(n),a=new Be,s=this.buildMinimalEdgeRings(o,this._shellList,a);this.sortShellsAndHoles(s,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};ul.prototype.interfaces_=function(){return[]};ul.prototype.getClass=function(){return ul};var r1=function(){};r1.prototype.getBounds=function(){};r1.prototype.interfaces_=function(){return[]};r1.prototype.getClass=function(){return r1};var ef=function(){this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n};ef.prototype.getItem=function(){return this._item};ef.prototype.getBounds=function(){return this._bounds};ef.prototype.interfaces_=function(){return[r1,Ec]};ef.prototype.getClass=function(){return ef};var Ap=function(){this._size=null,this._items=null,this._size=0,this._items=new Be,this._items.add(null)};Ap.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};Ap.prototype.size=function(){return this._size};Ap.prototype.reorder=function(t){for(var n=this,r=null,o=this._items.get(t);t*2<=this._size&&(r=t*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(o)<0);t=r)n._items.set(t,n._items.get(r));this._items.set(t,o)};Ap.prototype.clear=function(){this._size=0,this._items.clear()};Ap.prototype.isEmpty=function(){return this._size===0};Ap.prototype.add=function(t){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,t)};Ap.prototype.interfaces_=function(){return[]};Ap.prototype.getClass=function(){return Ap};var qm=function(){};qm.prototype.visitItem=function(t){};qm.prototype.interfaces_=function(){return[]};qm.prototype.getClass=function(){return qm};var yy=function(){};yy.prototype.insert=function(t,n){};yy.prototype.remove=function(t,n){};yy.prototype.query=function(){};yy.prototype.interfaces_=function(){return[]};yy.prototype.getClass=function(){return yy};var va=function(){if(this._childBoundables=new Be,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},xX={serialVersionUID:{configurable:!0}};va.prototype.getLevel=function(){return this._level};va.prototype.size=function(){return this._childBoundables.size()};va.prototype.getChildBoundables=function(){return this._childBoundables};va.prototype.addChildBoundable=function(t){tn.isTrue(this._bounds===null),this._childBoundables.add(t)};va.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};va.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};va.prototype.interfaces_=function(){return[r1,Ec]};va.prototype.getClass=function(){return va};xX.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(va,xX);var tf=function(){};tf.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};tf.min=function(t){return tf.sort(t),t.get(0)};tf.sort=function(t,n){var r=t.toArray();n?C0.sort(r,n):C0.sort(r);for(var o=t.iterator(),a=0,s=r.length;a<s;a++)o.next(),o.set(r[a])};tf.singletonList=function(t){var n=new Be;return n.add(t),n};var ta=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};ta.prototype.expandToQueue=function(t,n){var r=ta.isComposite(this._boundable1),o=ta.isComposite(this._boundable2);if(r&&o)return ta.area(this._boundable1)>ta.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,t,n),null;if(o)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new so("neither boundable is composite")};ta.prototype.isLeaves=function(){return!(ta.isComposite(this._boundable1)||ta.isComposite(this._boundable2))};ta.prototype.compareTo=function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0};ta.prototype.expand=function(t,n,r,o){for(var a=this,s=t.getChildBoundables(),u=s.iterator();u.hasNext();){var l=u.next(),c=new ta(l,n,a._itemDistance);c.getDistance()<o&&r.add(c)}};ta.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};ta.prototype.getDistance=function(){return this._distance};ta.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};ta.prototype.interfaces_=function(){return[wc]};ta.prototype.getClass=function(){return ta};ta.area=function(t){return t.getBounds().getArea()};ta.isComposite=function(t){return t instanceof va};var Ya=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Be,this._nodeCapacity=null,arguments.length===0){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var n=arguments[0];tn.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},LP={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ya.prototype.getNodeCapacity=function(){return this._nodeCapacity};Ya.prototype.lastNode=function(t){return t.get(t.size()-1)};Ya.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof va?r+=t.size(a):a instanceof ef&&(r+=1)}return r}};Ya.prototype.removeItem=function(t,n){for(var r=null,o=t.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof ef&&a.getItem()===n&&(r=a)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};Ya.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new Be:n}else if(arguments.length===1){for(var r=arguments[0],o=new Be,a=r.getChildBoundables().iterator();a.hasNext();){var s=a.next();if(s instanceof va){var u=t.itemsTree(s);u!==null&&o.add(u)}else s instanceof ef?o.add(s.getItem()):tn.shouldNeverReachHere()}return o.size()<=0?null:o}};Ya.prototype.insert=function(t,n){tn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ef(t,n))};Ya.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var n=arguments[0],r=new Be;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(tn.isTrue(o>-2),a.getLevel()===o)return s.add(a),null;for(var u=a.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof va?t.boundablesAtLevel(o,l,s):(tn.isTrue(l instanceof ef),o===-1&&s.add(l))}return null}};Ya.prototype.query=function(){var t=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new Be;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var o=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,a)}else if(arguments.length===3){if(Mt(arguments[2],qm)&&arguments[0]instanceof Object&&arguments[1]instanceof va)for(var s=arguments[0],u=arguments[1],l=arguments[2],c=u.getChildBoundables(),f=0;f<c.size();f++){var h=c.get(f);!t.getIntersectsOp().intersects(h.getBounds(),s)||(h instanceof va?t.query(s,h,l):h instanceof ef?l.visitItem(h.getItem()):tn.shouldNeverReachHere())}else if(Mt(arguments[2],Qc)&&arguments[0]instanceof Object&&arguments[1]instanceof va)for(var d=arguments[0],p=arguments[1],g=arguments[2],y=p.getChildBoundables(),v=0;v<y.size();v++){var w=y.get(v);!t.getIntersectsOp().intersects(w.getBounds(),d)||(w instanceof va?t.query(d,w,g):w instanceof ef?g.add(w.getItem()):tn.shouldNeverReachHere())}}};Ya.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Ya.prototype.getRoot=function(){return this.build(),this._root};Ya.prototype.remove=function(){var t=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=this.removeItem(a,s);if(u)return!0;for(var l=null,c=a.getChildBoundables().iterator();c.hasNext();){var f=c.next();if(!!t.getIntersectsOp().intersects(f.getBounds(),o)&&f instanceof va&&(u=t.remove(o,f,s),u)){l=f;break}}return l!==null&&l.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(l),u}};Ya.prototype.createHigherLevels=function(t,n){tn.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};Ya.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();if(a instanceof va){var s=t.depth(a);s>r&&(r=s)}}return r+1}};Ya.prototype.createParentBoundables=function(t,n){var r=this;tn.isTrue(!t.isEmpty());var o=new Be;o.add(this.createNode(n));var a=new Be(t);tf.sort(a,this.getComparator());for(var s=a.iterator();s.hasNext();){var u=s.next();r.lastNode(o).getChildBoundables().size()===r.getNodeCapacity()&&o.add(r.createNode(n)),r.lastNode(o).addChildBoundable(u)}return o};Ya.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Ya.prototype.interfaces_=function(){return[Ec]};Ya.prototype.getClass=function(){return Ya};Ya.compareDoubles=function(t,n){return t>n?1:t<n?-1:0};LP.IntersectsOp.get=function(){return xxe};LP.serialVersionUID.get=function(){return-3886435814360241e3};LP.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Ya,LP);var xxe=function(){},i1=function(){};i1.prototype.distance=function(t,n){};i1.prototype.interfaces_=function(){return[]};i1.prototype.getClass=function(){return i1};var wX=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(o,a){var s=this;tn.isTrue(o.length>0);for(var u=new Be,l=0;l<o.length;l++)u.addAll(s.createParentBoundablesFromVerticalSlice(o[l],a));return u},t.prototype.createNode=function(o){return new I7(o)},t.prototype.size=function(){return arguments.length===0?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];if(o.isNull())return null;e.prototype.insert.call(this,o,a)}else return e.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(o,a){for(var s=Math.trunc(Math.ceil(o.size()/a)),u=new Array(a).fill(null),l=o.iterator(),c=0;c<a;c++){u[c]=new Be;for(var f=0;l.hasNext()&&f<s;){var h=l.next();u[c].add(h),f++}}return u},t.prototype.query=function(){if(arguments.length===1){var o=arguments[0];return e.prototype.query.call(this,o)}else if(arguments.length===2){var a=arguments[0],s=arguments[1];e.prototype.query.call(this,a,s)}else if(arguments.length===3){if(Mt(arguments[2],qm)&&arguments[0]instanceof Object&&arguments[1]instanceof va){var u=arguments[0],l=arguments[1],c=arguments[2];e.prototype.query.call(this,u,l,c)}else if(Mt(arguments[2],Qc)&&arguments[0]instanceof Object&&arguments[1]instanceof va){var f=arguments[0],h=arguments[1],d=arguments[2];e.prototype.query.call(this,f,h,d)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(o,a){return e.prototype.createParentBoundables.call(this,o,a)},t.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return e.prototype.remove.call(this,o,a)}else return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(o,a){tn.isTrue(!o.isEmpty());var s=Math.trunc(Math.ceil(o.size()/this.getNodeCapacity())),u=new Be(o);tf.sort(u,t.xComparator);var l=this.verticalSlices(u,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(l,a)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Mt(arguments[0],i1)){var o=arguments[0],a=new ta(this.getRoot(),this.getRoot(),o);return this.nearestNeighbour(a)}else if(arguments[0]instanceof ta){var s=arguments[0];return this.nearestNeighbour(s,Wt.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Mt(arguments[1],i1)){var u=arguments[0],l=arguments[1],c=new ta(this.getRoot(),u.getRoot(),l);return this.nearestNeighbour(c)}else if(arguments[0]instanceof ta&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=h,p=null,g=new Ap;for(g.add(f);!g.isEmpty()&&d>0;){var y=g.poll(),v=y.getDistance();if(v>=d)break;y.isLeaves()?(d=v,p=y):y.expandToQueue(g,d)}return[p.getBoundable(0).getItem(),p.getBoundable(1).getItem()]}}else if(arguments.length===3){var w=arguments[0],C=arguments[1],E=arguments[2],S=new ef(w,C),A=new ta(this.getRoot(),S,E);return this.nearestNeighbour(A)[0]}},t.prototype.interfaces_=function(){return[yy,Ec]},t.prototype.getClass=function(){return t},t.centreX=function(o){return t.avg(o.getMinX(),o.getMaxX())},t.avg=function(o,a){return(o+a)/2},t.centreY=function(o){return t.avg(o.getMinY(),o.getMaxY())},n.STRtreeNode.get=function(){return I7},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[jC]},compare:function(r,o){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(o.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[jC]},compare:function(r,o){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(o.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(r,o){return r.intersects(o)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,n),t}(Ya),I7=function(e){function t(){var n=arguments[0];e.call(this,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,o=this.getChildBoundables().iterator();o.hasNext();){var a=o.next();r===null?r=new ut(a.getBounds()):r.expandToInclude(a.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(va),Mu=function(){};Mu.prototype.interfaces_=function(){return[]};Mu.prototype.getClass=function(){return Mu};Mu.relativeSign=function(t,n){return t<n?-1:t>n?1:0};Mu.compare=function(t,n,r){if(n.equals2D(r))return 0;var o=Mu.relativeSign(n.x,r.x),a=Mu.relativeSign(n.y,r.y);switch(t){case 0:return Mu.compareValue(o,a);case 1:return Mu.compareValue(a,o);case 2:return Mu.compareValue(a,-o);case 3:return Mu.compareValue(-o,a);case 4:return Mu.compareValue(-o,-a);case 5:return Mu.compareValue(-a,-o);case 6:return Mu.compareValue(-a,o);case 7:return Mu.compareValue(o,-a);default:}return tn.shouldNeverReachHere("invalid octant value"),0};Mu.compareValue=function(t,n){return t<0?-1:t>0?1:n<0?-1:n>0?1:0};var Wm=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._segString=t,this.coord=new ae(n),this.segmentIndex=r,this._segmentOctant=o,this._isInterior=!n.equals2D(t.getCoordinate(r))};Wm.prototype.getCoordinate=function(){return this.coord};Wm.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Wm.prototype.compareTo=function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Mu.compare(this._segmentOctant,this.coord,n.coord)};Wm.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Wm.prototype.isInterior=function(){return this._isInterior};Wm.prototype.interfaces_=function(){return[wc]};Wm.prototype.getClass=function(){return Wm};var au=function(){this._nodeMap=new Os,this._edge=null;var t=arguments[0];this._edge=t};au.prototype.getSplitCoordinates=function(){var t=this,n=new GT;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next();t.addEdgeCoordinates(o,a,n),o=a}return n.toCoordinateArray()};au.prototype.addCollapsedNodes=function(){var t=this,n=new Be;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var o=r.next().intValue();t.add(t._edge.getCoordinate(o),o)}};au.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};au.prototype.findCollapsesFromExistingVertices=function(t){for(var n=this,r=0;r<this._edge.size()-2;r++){var o=n._edge.getCoordinate(r),a=n._edge.getCoordinate(r+2);o.equals2D(a)&&t.add(new jf(r+1))}};au.prototype.addEdgeCoordinates=function(t,n,r){var o=this,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);r.add(new ae(t.coord),!1);for(var u=t.segmentIndex+1;u<=n.segmentIndex;u++)r.add(o._edge.getCoordinate(u));s&&r.add(new ae(n.coord))};au.prototype.iterator=function(){return this._nodeMap.values().iterator()};au.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};au.prototype.findCollapseIndex=function(t,n,r){if(!t.coord.equals2D(n.coord))return!1;var o=n.segmentIndex-t.segmentIndex;return n.isInterior()||o--,o===1?(r[0]=t.segmentIndex+1,!0):!1};au.prototype.findCollapsesFromInsertedNodes=function(t){for(var n=this,r=new Array(1).fill(null),o=this.iterator(),a=o.next();o.hasNext();){var s=o.next(),u=n.findCollapseIndex(a,s,r);u&&t.add(new jf(r[0])),a=s}};au.prototype.getEdge=function(){return this._edge};au.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};au.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new ae(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r._edge.getCoordinate(c);return s&&(u[l]=new ae(n.coord)),new Go(u,this._edge.getData())};au.prototype.add=function(t,n){var r=new Wm(this._edge,t,n,this._edge.getSegmentOctant(n)),o=this._nodeMap.get(r);return o!==null?(tn.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(r,r),r)};au.prototype.checkSplitEdgesCorrectness=function(t){var n=this._edge.getCoordinates(),r=t.get(0),o=r.getCoordinate(0);if(!o.equals2D(n[0]))throw new Ep("bad split edge start point at "+o);var a=t.get(t.size()-1),s=a.getCoordinates(),u=s[s.length-1];if(!u.equals2D(n[n.length-1]))throw new Ep("bad split edge end point at "+u)};au.prototype.interfaces_=function(){return[]};au.prototype.getClass=function(){return au};var vy=function(){};vy.prototype.interfaces_=function(){return[]};vy.prototype.getClass=function(){return vy};vy.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new so("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),o=Math.abs(n);return t>=0?n>=0?r>=o?0:1:r>=o?7:6:n>=0?r>=o?3:2:r>=o?4:5}else if(arguments[0]instanceof ae&&arguments[1]instanceof ae){var a=arguments[0],s=arguments[1],u=s.x-a.x,l=s.y-a.y;if(u===0&&l===0)throw new so("Cannot compute the octant for two identical points "+a);return vy.octant(u,l)}};var md=function(){};md.prototype.getCoordinates=function(){};md.prototype.size=function(){};md.prototype.getCoordinate=function(t){};md.prototype.isClosed=function(){};md.prototype.setData=function(t){};md.prototype.getData=function(){};md.prototype.interfaces_=function(){return[]};md.prototype.getClass=function(){return md};var AT=function(){};AT.prototype.addIntersection=function(t,n){};AT.prototype.interfaces_=function(){return[md]};AT.prototype.getClass=function(){return AT};var Go=function(){this._nodeList=new au(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};Go.prototype.getCoordinates=function(){return this._pts};Go.prototype.size=function(){return this._pts.length};Go.prototype.getCoordinate=function(t){return this._pts[t]};Go.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Go.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};Go.prototype.setData=function(t){this._data=t};Go.prototype.safeOctant=function(t,n){return t.equals2D(n)?0:vy.octant(t,n)};Go.prototype.getData=function(){return this._data};Go.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[3],s=new ae(r.getIntersection(a));this.addIntersection(s,o)}};Go.prototype.toString=function(){return Jc.toLineString(new Fo(this._pts))};Go.prototype.getNodeList=function(){return this._nodeList};Go.prototype.addIntersectionNode=function(t,n){var r=n,o=r+1;if(o<this._pts.length){var a=this._pts[o];t.equals2D(a)&&(r=o)}var s=this._nodeList.add(t,r);return s};Go.prototype.addIntersections=function(t,n,r){for(var o=this,a=0;a<t.getIntersectionNum();a++)o.addIntersection(t,n,r,a)};Go.prototype.interfaces_=function(){return[AT]};Go.prototype.getClass=function(){return Go};Go.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new Be;return Go.getNodedSubstrings(t,n),n}else if(arguments.length===2)for(var r=arguments[0],o=arguments[1],a=r.iterator();a.hasNext();){var s=a.next();s.getNodeList().addSplitEdges(o)}};var ct=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new ae,this.p1=new ae;else if(arguments.length===1){var t=arguments[0];this.p0=new ae(t.p0),this.p1=new ae(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3];this.p0=new ae(n,r),this.p1=new ae(o,a)}},EX={serialVersionUID:{configurable:!0}};ct.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ct.prototype.orientationIndex=function(){if(arguments[0]instanceof ct){var t=arguments[0],n=Ue.orientationIndex(this.p0,this.p1,t.p0),r=Ue.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof ae){var o=arguments[0];return Ue.orientationIndex(this.p0,this.p1,o)}};ct.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};ct.prototype.isVertical=function(){return this.p0.x===this.p1.x};ct.prototype.equals=function(t){if(!(t instanceof ct))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};ct.prototype.intersection=function(t){var n=new O0;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null};ct.prototype.project=function(){if(arguments[0]instanceof ae){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new ae(t);var n=this.projectionFactor(t),r=new ae;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof ct){var o=arguments[0],a=this.projectionFactor(o.p0),s=this.projectionFactor(o.p1);if(a>=1&&s>=1||a<=0&&s<=0)return null;var u=this.project(o.p0);a<0&&(u=this.p0),a>1&&(u=this.p1);var l=this.project(o.p1);return s<0&&(l=this.p0),s>1&&(l=this.p1),new ct(u,l)}};ct.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ct.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ct.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};ct.prototype.distancePerpendicular=function(t){return Ue.distancePointLinePerpendicular(t,this.p0,this.p1)};ct.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ct.prototype.midPoint=function(){return ct.midPoint(this.p0,this.p1)};ct.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,o=n*n+r*r;if(o<=0)return Wt.NaN;var a=((t.x-this.p0.x)*n+(t.y-this.p0.y)*r)/o;return a};ct.prototype.closestPoints=function(t){var n=this.intersection(t);if(n!==null)return[n,n];var r=new Array(2).fill(null),o=Wt.MAX_VALUE,a=null,s=this.closestPoint(t.p0);o=s.distance(t.p0),r[0]=s,r[1]=t.p0;var u=this.closestPoint(t.p1);a=u.distance(t.p1),a<o&&(o=a,r[0]=u,r[1]=t.p1);var l=t.closestPoint(this.p0);a=l.distance(this.p0),a<o&&(o=a,r[0]=this.p0,r[1]=l);var c=t.closestPoint(this.p1);return a=c.distance(this.p1),a<o&&(o=a,r[0]=this.p1,r[1]=c),r};ct.prototype.closestPoint=function(t){var n=this.projectionFactor(t);if(n>0&&n<1)return this.project(t);var r=this.p0.distance(t),o=this.p1.distance(t);return r<o?this.p0:this.p1};ct.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ct.prototype.getLength=function(){return this.p0.distance(this.p1)};ct.prototype.compareTo=function(t){var n=t,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};ct.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};ct.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};ct.prototype.lineIntersection=function(t){try{var n=Zc.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(r){if(!(r instanceof y1))throw r}finally{}return null};ct.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ct.prototype.pointAlongOffset=function(t,n){var r=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,u=Math.sqrt(a*a+s*s),l=0,c=0;if(n!==0){if(u<=0)throw new Error("Cannot compute offset from zero-length line segment");l=n*a/u,c=n*s/u}var f=r-c,h=o+l,d=new ae(f,h);return d};ct.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};ct.prototype.segmentFraction=function(t){var n=this.projectionFactor(t);return n<0?n=0:(n>1||Wt.isNaN(n))&&(n=1),n};ct.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ct.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ct.prototype.distance=function(){if(arguments[0]instanceof ct){var t=arguments[0];return Ue.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof ae){var n=arguments[0];return Ue.distancePointLine(n,this.p0,this.p1)}};ct.prototype.pointAlong=function(t){var n=new ae;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n};ct.prototype.hashCode=function(){var t=Wt.doubleToLongBits(this.p0.x);t^=Wt.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(t)^Math.trunc(t>>32),r=Wt.doubleToLongBits(this.p1.x);r^=Wt.doubleToLongBits(this.p1.y)*31;var o=Math.trunc(r)^Math.trunc(r>>32);return n^o};ct.prototype.interfaces_=function(){return[wc,Ec]};ct.prototype.getClass=function(){return ct};ct.midPoint=function(t,n){return new ae((t.x+n.x)/2,(t.y+n.y)/2)};EX.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ct,EX);var bT=function(){this.tempEnv1=new ut,this.tempEnv2=new ut,this._overlapSeg1=new ct,this._overlapSeg2=new ct};bT.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];t.getLineSegment(n,this._overlapSeg1),r.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};bT.prototype.interfaces_=function(){return[]};bT.prototype.getClass=function(){return bT};var ll=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._pts=t,this._start=n,this._end=r,this._context=o};ll.prototype.getLineSegment=function(t,n){n.p0=this._pts[t],n.p1=this._pts[t+1]};ll.prototype.computeSelect=function(t,n,r,o){var a=this._pts[n],s=this._pts[r];if(o.tempEnv1.init(a,s),r-n===1)return o.select(this,n),null;if(!t.intersects(o.tempEnv1))return null;var u=Math.trunc((n+r)/2);n<u&&this.computeSelect(t,n,u,o),u<r&&this.computeSelect(t,u,r,o)};ll.prototype.getCoordinates=function(){for(var t=this,n=new Array(this._end-this._start+1).fill(null),r=0,o=this._start;o<=this._end;o++)n[r++]=t._pts[o];return n};ll.prototype.computeOverlaps=function(t,n){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,n)};ll.prototype.setId=function(t){this._id=t};ll.prototype.select=function(t,n){this.computeSelect(t,this._start,this._end,n)};ll.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],n=this._pts[this._end];this._env=new ut(t,n)}return this._env};ll.prototype.getEndIndex=function(){return this._end};ll.prototype.getStartIndex=function(){return this._start};ll.prototype.getContext=function(){return this._context};ll.prototype.getId=function(){return this._id};ll.prototype.computeOverlapsInternal=function(t,n,r,o,a,s){var u=this._pts[t],l=this._pts[n],c=r._pts[o],f=r._pts[a];if(n-t===1&&a-o===1)return s.overlap(this,t,r,o),null;if(s.tempEnv1.init(u,l),s.tempEnv2.init(c,f),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((t+n)/2),d=Math.trunc((o+a)/2);t<h&&(o<d&&this.computeOverlapsInternal(t,h,r,o,d,s),d<a&&this.computeOverlapsInternal(t,h,r,d,a,s)),h<n&&(o<d&&this.computeOverlapsInternal(h,n,r,o,d,s),d<a&&this.computeOverlapsInternal(h,n,r,d,a,s))};ll.prototype.interfaces_=function(){return[]};ll.prototype.getClass=function(){return ll};var Xf=function(){};Xf.prototype.interfaces_=function(){return[]};Xf.prototype.getClass=function(){return Xf};Xf.getChainStartIndices=function(t){var n=0,r=new Be;r.add(new jf(n));do{var o=Xf.findChainEnd(t,n);r.add(new jf(o)),n=o}while(n<t.length-1);var a=Xf.toIntArray(r);return a};Xf.findChainEnd=function(t,n){for(var r=n;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var o=Ti.quadrant(t[r],t[r+1]),a=n+1;a<t.length;){if(!t[a-1].equals2D(t[a])){var s=Ti.quadrant(t[a-1],t[a]);if(s!==o)break}a++}return a-1};Xf.getChains=function(){if(arguments.length===1){var t=arguments[0];return Xf.getChains(t,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],o=new Be,a=Xf.getChainStartIndices(n),s=0;s<a.length-1;s++){var u=new ll(n,a[s],a[s+1],r);o.add(u)}return o}};Xf.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var S0=function(){};S0.prototype.computeNodes=function(t){};S0.prototype.getNodedSubstrings=function(){};S0.prototype.interfaces_=function(){return[]};S0.prototype.getClass=function(){return S0};var IT=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};IT.prototype.setSegmentIntersector=function(t){this._segInt=t};IT.prototype.interfaces_=function(){return[S0]};IT.prototype.getClass=function(){return IT};var J3=function(e){function t(r){r?e.call(this,r):e.call(this),this._monoChains=new Be,this._index=new wX,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Go.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(o){for(var a=this,s=Xf.getChains(o.getCoordinates(),o),u=s.iterator();u.hasNext();){var l=u.next();l.setId(a._idCounter++),a._index.insert(l.getEnvelope(),l),a._monoChains.add(l)}},t.prototype.computeNodes=function(o){var a=this;this._nodedSegStrings=o;for(var s=o.iterator();s.hasNext();)a.add(s.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var o=this,a=new D7(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var u=s.next(),l=o._index.query(u.getEnvelope()),c=l.iterator();c.hasNext();){var f=c.next();if(f.getId()>u.getId()&&(u.computeOverlaps(f,a),o._nOverlaps++),o._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return D7},Object.defineProperties(t,n),t}(IT),D7=function(e){function t(){e.call(this),this._si=null;var n=arguments[0];this._si=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=r.getContext(),l=a.getContext();this._si.processIntersections(u,o,l,s)}else return e.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(bT),zr=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(a),this.setJoinStyle(s),this.setMitreLimit(u)}}},Mp={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};zr.prototype.getEndCapStyle=function(){return this._endCapStyle};zr.prototype.isSingleSided=function(){return this._isSingleSided};zr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=zr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=zr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==zr.JOIN_ROUND&&(this._quadrantSegments=zr.DEFAULT_QUADRANT_SEGMENTS)};zr.prototype.getJoinStyle=function(){return this._joinStyle};zr.prototype.setJoinStyle=function(t){this._joinStyle=t};zr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};zr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};zr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};zr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};zr.prototype.getMitreLimit=function(){return this._mitreLimit};zr.prototype.setMitreLimit=function(t){this._mitreLimit=t};zr.prototype.setSingleSided=function(t){this._isSingleSided=t};zr.prototype.interfaces_=function(){return[]};zr.prototype.getClass=function(){return zr};zr.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)};Mp.CAP_ROUND.get=function(){return 1};Mp.CAP_FLAT.get=function(){return 2};Mp.CAP_SQUARE.get=function(){return 3};Mp.JOIN_ROUND.get=function(){return 1};Mp.JOIN_MITRE.get=function(){return 2};Mp.JOIN_BEVEL.get=function(){return 3};Mp.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};Mp.DEFAULT_MITRE_LIMIT.get=function(){return 5};Mp.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(zr,Mp);var Io=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ue.COUNTERCLOCKWISE,this._inputLine=t||null},WT={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Io.prototype.isDeletable=function(t,n,r,o){var a=this._inputLine[t],s=this._inputLine[n],u=this._inputLine[r];return!this.isConcave(a,s,u)||!this.isShallow(a,s,u,o)?!1:this.isShallowSampled(a,s,t,r,o)};Io.prototype.deleteShallowConcavities=function(){for(var t=this,n=1,r=this.findNextNonDeletedIndex(n),o=this.findNextNonDeletedIndex(r),a=!1;o<this._inputLine.length;){var s=!1;t.isDeletable(n,r,o,t._distanceTol)&&(t._isDeleted[r]=Io.DELETE,s=!0,a=!0),s?n=o:n=r,r=t.findNextNonDeletedIndex(n),o=t.findNextNonDeletedIndex(r)}return a};Io.prototype.isShallowConcavity=function(t,n,r,o){var a=Ue.computeOrientation(t,n,r),s=a===this._angleOrientation;if(!s)return!1;var u=Ue.distancePointLine(n,t,r);return u<o};Io.prototype.isShallowSampled=function(t,n,r,o,a){var s=this,u=Math.trunc((o-r)/Io.NUM_PTS_TO_CHECK);u<=0&&(u=1);for(var l=r;l<o;l+=u)if(!s.isShallow(t,n,s._inputLine[l],a))return!1;return!0};Io.prototype.isConcave=function(t,n,r){var o=Ue.computeOrientation(t,n,r),a=o===this._angleOrientation;return a};Io.prototype.simplify=function(t){var n=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Ue.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Io.prototype.findNextNonDeletedIndex=function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===Io.DELETE;)n++;return n};Io.prototype.isShallow=function(t,n,r,o){var a=Ue.distancePointLine(n,t,r);return a<o};Io.prototype.collapseLine=function(){for(var t=this,n=new GT,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==Io.DELETE&&n.add(t._inputLine[r]);return n.toCoordinateArray()};Io.prototype.interfaces_=function(){return[]};Io.prototype.getClass=function(){return Io};Io.simplify=function(t,n){var r=new Io(t);return r.simplify(n)};WT.INIT.get=function(){return 0};WT.DELETE.get=function(){return 1};WT.KEEP.get=function(){return 1};WT.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Io,WT);var Vl=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Be},TX={COORDINATE_ARRAY_TYPE:{configurable:!0}};Vl.prototype.getCoordinates=function(){var t=this._ptList.toArray(Vl.COORDINATE_ARRAY_TYPE);return t};Vl.prototype.setPrecisionModel=function(t){this._precisionModel=t};Vl.prototype.addPt=function(t){var n=new ae(t);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};Vl.prototype.revere=function(){};Vl.prototype.addPts=function(t,n){var r=this;if(n)for(var o=0;o<t.length;o++)r.addPt(t[o]);else for(var a=t.length-1;a>=0;a--)r.addPt(t[a])};Vl.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=t.distance(n);return r<this._minimimVertexDistance};Vl.prototype.toString=function(){var t=new cn,n=t.createLineString(this.getCoordinates());return n.toString()};Vl.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new ae(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(t.equals(n))return null;this._ptList.add(t)};Vl.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};Vl.prototype.interfaces_=function(){return[]};Vl.prototype.getClass=function(){return Vl};TX.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(Vl,TX);var vn=function(){},Ly={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};vn.prototype.interfaces_=function(){return[]};vn.prototype.getClass=function(){return vn};vn.toDegrees=function(t){return t*180/Math.PI};vn.normalize=function(t){for(;t>Math.PI;)t-=vn.PI_TIMES_2;for(;t<=-Math.PI;)t+=vn.PI_TIMES_2;return t};vn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=r.x-n.x,a=r.y-n.y;return Math.atan2(a,o)}};vn.isAcute=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l>0};vn.isObtuse=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l<0};vn.interiorAngle=function(t,n,r){var o=vn.angle(n,t),a=vn.angle(n,r);return Math.abs(a-o)};vn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=vn.PI_TIMES_2;t>=vn.PI_TIMES_2&&(t=0)}else{for(;t>=vn.PI_TIMES_2;)t-=vn.PI_TIMES_2;t<0&&(t=0)}return t};vn.angleBetween=function(t,n,r){var o=vn.angle(n,t),a=vn.angle(n,r);return vn.diff(o,a)};vn.diff=function(t,n){var r=null;return t<n?r=n-t:r=t-n,r>Math.PI&&(r=2*Math.PI-r),r};vn.toRadians=function(t){return t*Math.PI/180};vn.getTurn=function(t,n){var r=Math.sin(n-t);return r>0?vn.COUNTERCLOCKWISE:r<0?vn.CLOCKWISE:vn.NONE};vn.angleBetweenOriented=function(t,n,r){var o=vn.angle(n,t),a=vn.angle(n,r),s=a-o;return s<=-Math.PI?s+vn.PI_TIMES_2:s>Math.PI?s-vn.PI_TIMES_2:s};Ly.PI_TIMES_2.get=function(){return 2*Math.PI};Ly.PI_OVER_2.get=function(){return Math.PI/2};Ly.PI_OVER_4.get=function(){return Math.PI/4};Ly.COUNTERCLOCKWISE.get=function(){return Ue.COUNTERCLOCKWISE};Ly.CLOCKWISE.get=function(){return Ue.CLOCKWISE};Ly.NONE.get=function(){return Ue.COLLINEAR};Object.defineProperties(vn,Ly);var Ji=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ct,this._seg1=new ct,this._offset0=new ct,this._offset1=new ct,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new O0,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===zr.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},YT={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ji.prototype.addNextSegment=function(t,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=Ue.computeOrientation(this._s0,this._s1,this._s2),o=r===Ue.CLOCKWISE&&this._side===Pe.LEFT||r===Ue.COUNTERCLOCKWISE&&this._side===Pe.RIGHT;r===0?this.addCollinear(n):o?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};Ji.prototype.addLineEndCap=function(t,n){var r=new ct(t,n),o=new ct;this.computeOffsetSegment(r,Pe.LEFT,this._distance,o);var a=new ct;this.computeOffsetSegment(r,Pe.RIGHT,this._distance,a);var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s);switch(this._bufParams.getEndCapStyle()){case zr.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(n,l+Math.PI/2,l-Math.PI/2,Ue.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case zr.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(a.p1);break;case zr.CAP_SQUARE:var c=new ae;c.x=Math.abs(this._distance)*Math.cos(l),c.y=Math.abs(this._distance)*Math.sin(l);var f=new ae(o.p1.x+c.x,o.p1.y+c.y),h=new ae(a.p1.x+c.x,a.p1.y+c.y);this._segList.addPt(f),this._segList.addPt(h);break;default:}};Ji.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};Ji.prototype.addMitreJoin=function(t,n,r,o){var a=!0,s=null;try{s=Zc.intersection(n.p0,n.p1,r.p0,r.p1);var u=o<=0?1:s.distance(t)/Math.abs(o);u>this._bufParams.getMitreLimit()&&(a=!1)}catch(l){if(l instanceof y1)s=new ae(0,0),a=!1;else throw l}finally{}a?this._segList.addPt(s):this.addLimitedMitreJoin(n,r,o,this._bufParams.getMitreLimit())};Ji.prototype.addFilletCorner=function(t,n,r,o,a){var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s),c=r.x-t.x,f=r.y-t.y,h=Math.atan2(f,c);o===Ue.CLOCKWISE?l<=h&&(l+=2*Math.PI):l>=h&&(l-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(t,l,h,o,a),this._segList.addPt(r)};Ji.prototype.addOutsideTurn=function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ji.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===zr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===zr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};Ji.prototype.createSquare=function(t){this._segList.addPt(new ae(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new ae(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new ae(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new ae(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};Ji.prototype.addSegments=function(t,n){this._segList.addPts(t,n)};Ji.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Ji.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Ji.prototype.initSideSegments=function(t,n,r){this._s1=t,this._s2=n,this._side=r,this._seg1.setCoordinates(t,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};Ji.prototype.addLimitedMitreJoin=function(t,n,r,o){var a=this._seg0.p1,s=vn.angle(a,this._seg0.p0),u=vn.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),l=u/2,c=vn.normalize(s+l),f=vn.normalize(c+Math.PI),h=o*r,d=h*Math.abs(Math.sin(l)),p=r-d,g=a.x+h*Math.cos(f),y=a.y+h*Math.sin(f),v=new ae(g,y),w=new ct(a,v),C=w.pointAlongOffset(1,p),E=w.pointAlongOffset(1,-p);this._side===Pe.LEFT?(this._segList.addPt(C),this._segList.addPt(E)):(this._segList.addPt(E),this._segList.addPt(C))};Ji.prototype.computeOffsetSegment=function(t,n,r,o){var a=n===Pe.LEFT?1:-1,s=t.p1.x-t.p0.x,u=t.p1.y-t.p0.y,l=Math.sqrt(s*s+u*u),c=a*r*s/l,f=a*r*u/l;o.p0.x=t.p0.x-f,o.p0.y=t.p0.y+c,o.p1.x=t.p1.x-f,o.p1.y=t.p1.y+c};Ji.prototype.addFilletArc=function(t,n,r,o,a){var s=this,u=o===Ue.CLOCKWISE?-1:1,l=Math.abs(n-r),c=Math.trunc(l/this._filletAngleQuantum+.5);if(c<1)return null;for(var f=0,h=l/c,d=f,p=new ae;d<l;){var g=n+u*d;p.x=t.x+a*Math.cos(g),p.y=t.y+a*Math.sin(g),s._segList.addPt(p),d+=h}};Ji.prototype.addInsideTurn=function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ji.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new ae((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var o=new ae((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Ji.prototype.createCircle=function(t){var n=new ae(t.x+this._distance,t.y);this._segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Ji.prototype.addBevelJoin=function(t,n){this._segList.addPt(t.p1),this._segList.addPt(n.p0)};Ji.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Vl,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Ji.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Ji.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===zr.JOIN_BEVEL||this._bufParams.getJoinStyle()===zr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Ue.CLOCKWISE,this._distance))};Ji.prototype.closeRing=function(){this._segList.closeRing()};Ji.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Ji.prototype.interfaces_=function(){return[]};Ji.prototype.getClass=function(){return Ji};YT.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};YT.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};YT.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};YT.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Ji,YT);var Ou=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n};Ou.prototype.getOffsetCurve=function(t,n){if(this._distance=n,n===0)return null;var r=n<0,o=Math.abs(n),a=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],a):this.computeOffsetCurve(t,r,a);var s=a.getCoordinates();return r&&fn.reverse(s),s};Ou.prototype.computeSingleSidedBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){r.addSegments(t,!0);var a=Io.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Pe.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{r.addSegments(t,!1);var l=Io.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Pe.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment(),r.closeRing()};Ou.prototype.computeRingBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);n===Pe.RIGHT&&(o=-o);var a=Io.simplify(t,o),s=a.length-1;r.initSideSegments(a[s-1],a[0],n);for(var u=1;u<=s;u++){var l=u!==1;r.addNextSegment(a[u],l)}r.closeRing()};Ou.prototype.computeLineBufferCurve=function(t,n){var r=this.simplifyTolerance(this._distance),o=Io.simplify(t,r),a=o.length-1;n.initSideSegments(o[0],o[1],Pe.LEFT);for(var s=2;s<=a;s++)n.addNextSegment(o[s],!0);n.addLastSegment(),n.addLineEndCap(o[a-1],o[a]);var u=Io.simplify(t,-r),l=u.length-1;n.initSideSegments(u[l],u[l-1],Pe.LEFT);for(var c=l-2;c>=0;c--)n.addNextSegment(u[c],!0);n.addLastSegment(),n.addLineEndCap(u[1],u[0]),n.closeRing()};Ou.prototype.computePointCurve=function(t,n){switch(this._bufParams.getEndCapStyle()){case zr.CAP_ROUND:n.createCircle(t);break;case zr.CAP_SQUARE:n.createSquare(t);break;default:}};Ou.prototype.getLineCurve=function(t,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),o=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var a=n<0;this.computeSingleSidedBufferCurve(t,a,o)}else this.computeLineBufferCurve(t,o);var s=o.getCoordinates();return s};Ou.prototype.getBufferParameters=function(){return this._bufParams};Ou.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};Ou.prototype.getRingCurve=function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return Ou.copyCoordinates(t);var o=this.getSegGen(r);return this.computeRingBufferCurve(t,n,o),o.getCoordinates()};Ou.prototype.computeOffsetCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){var a=Io.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Pe.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{var l=Io.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Pe.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment()};Ou.prototype.getSegGen=function(t){return new Ji(this._precisionModel,this._bufParams,t)};Ou.prototype.interfaces_=function(){return[]};Ou.prototype.getClass=function(){return Ou};Ou.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),r=0;r<n.length;r++)n[r]=new ae(t[r]);return n};var Cy=function(){this._subgraphs=null,this._seg=new ct,this._cga=new Ue;var t=arguments[0];this._subgraphs=t},SX={DepthSegment:{configurable:!0}};Cy.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=new Be,o=this._subgraphs.iterator();o.hasNext();){var a=o.next(),s=a.getEnvelope();n.y<s.getMinY()||n.y>s.getMaxY()||t.findStabbedSegments(n,a.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(Mt(arguments[2],Qc)&&arguments[0]instanceof ae&&arguments[1]instanceof l3)for(var u=arguments[0],l=arguments[1],c=arguments[2],f=l.getEdge().getCoordinates(),h=0;h<f.length-1;h++){t._seg.p0=f[h],t._seg.p1=f[h+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var d=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(d<u.x)&&!t._seg.isHorizontal()&&!(u.y<t._seg.p0.y||u.y>t._seg.p1.y)&&Ue.computeOrientation(t._seg.p0,t._seg.p1,u)!==Ue.RIGHT){var p=l.getDepth(Pe.LEFT);t._seg.p0.equals(f[h])||(p=l.getDepth(Pe.RIGHT));var g=new A0(t._seg,p);c.add(g)}}else if(Mt(arguments[2],Qc)&&arguments[0]instanceof ae&&Mt(arguments[1],Qc))for(var y=arguments[0],v=arguments[1],w=arguments[2],C=v.iterator();C.hasNext();){var E=C.next();!E.isForward()||t.findStabbedSegments(y,E,w)}}};Cy.prototype.getDepth=function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var r=tf.min(n);return r._leftDepth};Cy.prototype.interfaces_=function(){return[]};Cy.prototype.getClass=function(){return Cy};SX.DepthSegment.get=function(){return A0};Object.defineProperties(Cy,SX);var A0=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new ct(t),this._leftDepth=n};A0.prototype.compareTo=function(t){var n=t;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};A0.prototype.compareX=function(t,n){var r=t.p0.compareTo(n.p0);return r!==0?r:t.p1.compareTo(n.p1)};A0.prototype.toString=function(){return this._upwardSeg.toString()};A0.prototype.interfaces_=function(){return[wc]};A0.prototype.getClass=function(){return A0};var Gr=function(t,n,r){this.p0=t||null,this.p1=n||null,this.p2=r||null};Gr.prototype.area=function(){return Gr.area(this.p0,this.p1,this.p2)};Gr.prototype.signedArea=function(){return Gr.signedArea(this.p0,this.p1,this.p2)};Gr.prototype.interpolateZ=function(t){if(t===null)throw new so("Supplied point is null.");return Gr.interpolateZ(t,this.p0,this.p1,this.p2)};Gr.prototype.longestSideLength=function(){return Gr.longestSideLength(this.p0,this.p1,this.p2)};Gr.prototype.isAcute=function(){return Gr.isAcute(this.p0,this.p1,this.p2)};Gr.prototype.circumcentre=function(){return Gr.circumcentre(this.p0,this.p1,this.p2)};Gr.prototype.area3D=function(){return Gr.area3D(this.p0,this.p1,this.p2)};Gr.prototype.centroid=function(){return Gr.centroid(this.p0,this.p1,this.p2)};Gr.prototype.inCentre=function(){return Gr.inCentre(this.p0,this.p1,this.p2)};Gr.prototype.interfaces_=function(){return[]};Gr.prototype.getClass=function(){return Gr};Gr.area=function(t,n,r){return Math.abs(((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2)};Gr.signedArea=function(t,n,r){return((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2};Gr.det=function(t,n,r,o){return t*o-n*r};Gr.interpolateZ=function(t,n,r,o){var a=n.x,s=n.y,u=r.x-a,l=o.x-a,c=r.y-s,f=o.y-s,h=u*f-l*c,d=t.x-a,p=t.y-s,g=(f*d-l*p)/h,y=(-c*d+u*p)/h,v=n.z+g*(r.z-n.z)+y*(o.z-n.z);return v};Gr.longestSideLength=function(t,n,r){var o=t.distance(n),a=n.distance(r),s=r.distance(t),u=o;return a>u&&(u=a),s>u&&(u=s),u};Gr.isAcute=function(t,n,r){return!(!vn.isAcute(t,n,r)||!vn.isAcute(n,r,t)||!vn.isAcute(r,t,n))};Gr.circumcentre=function(t,n,r){var o=r.x,a=r.y,s=t.x-o,u=t.y-a,l=n.x-o,c=n.y-a,f=2*Gr.det(s,u,l,c),h=Gr.det(u,s*s+u*u,c,l*l+c*c),d=Gr.det(s,s*s+u*u,l,l*l+c*c),p=o-h/f,g=a+d/f;return new ae(p,g)};Gr.perpendicularBisector=function(t,n){var r=n.x-t.x,o=n.y-t.y,a=new Zc(t.x+r/2,t.y+o/2,1),s=new Zc(t.x-o+r/2,t.y+r+o/2,1);return new Zc(a,s)};Gr.angleBisector=function(t,n,r){var o=n.distance(t),a=n.distance(r),s=o/(o+a),u=r.x-t.x,l=r.y-t.y,c=new ae(t.x+s*u,t.y+s*l);return c};Gr.area3D=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=n.z-t.z,u=r.x-t.x,l=r.y-t.y,c=r.z-t.z,f=a*c-s*l,h=s*u-o*c,d=o*l-a*u,p=f*f+h*h+d*d,g=Math.sqrt(p)/2;return g};Gr.centroid=function(t,n,r){var o=(t.x+n.x+r.x)/3,a=(t.y+n.y+r.y)/3;return new ae(o,a)};Gr.inCentre=function(t,n,r){var o=n.distance(r),a=t.distance(r),s=t.distance(n),u=o+a+s,l=(o*t.x+a*n.x+s*r.x)/u,c=(o*t.y+a*n.y+s*r.y)/u;return new ae(l,c)};var xc=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=r};xc.prototype.addPoint=function(t){if(this._distance<=0)return null;var n=t.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,he.EXTERIOR,he.INTERIOR)};xc.prototype.addPolygon=function(t){var n=this,r=this._distance,o=Pe.LEFT;this._distance<0&&(r=-this._distance,o=Pe.RIGHT);var a=t.getExteriorRing(),s=fn.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&s.length<3)return null;this.addPolygonRing(s,r,o,he.EXTERIOR,he.INTERIOR);for(var u=0;u<t.getNumInteriorRing();u++){var l=t.getInteriorRingN(u),c=fn.removeRepeatedPoints(l.getCoordinates());n._distance>0&&n.isErodedCompletely(l,-n._distance)||n.addPolygonRing(c,r,Pe.opposite(o),he.INTERIOR,he.EXTERIOR)}};xc.prototype.isTriangleErodedCompletely=function(t,n){var r=new Gr(t[0],t[1],t[2]),o=r.inCentre(),a=Ue.distancePointLine(o,r.p0,r.p1);return a<Math.abs(n)};xc.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=fn.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,he.EXTERIOR,he.INTERIOR)};xc.prototype.addCurve=function(t,n,r){if(t===null||t.length<2)return null;var o=new Go(t,new ni(0,he.BOUNDARY,n,r));this._curveList.add(o)};xc.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};xc.prototype.addPolygonRing=function(t,n,r,o,a){if(n===0&&t.length<dd.MINIMUM_VALID_SIZE)return null;var s=o,u=a;t.length>=dd.MINIMUM_VALID_SIZE&&Ue.isCCW(t)&&(s=a,u=o,r=Pe.opposite(r));var l=this._curveBuilder.getRingCurve(t,r,n);this.addCurve(l,s,u)};xc.prototype.add=function(t){if(t.isEmpty())return null;t instanceof xa?this.addPolygon(t):t instanceof bo?this.addLineString(t):t instanceof sl?this.addPoint(t):t instanceof t1?this.addCollection(t):t instanceof T0?this.addCollection(t):t instanceof cd?this.addCollection(t):t instanceof iu&&this.addCollection(t)};xc.prototype.isErodedCompletely=function(t,n){var r=t.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var o=t.getEnvelopeInternal(),a=Math.min(o.getHeight(),o.getWidth());return n<0&&2*Math.abs(n)>a};xc.prototype.addCollection=function(t){for(var n=this,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r);n.add(o)}};xc.prototype.interfaces_=function(){return[]};xc.prototype.getClass=function(){return xc};var o1=function(){};o1.prototype.locate=function(t){};o1.prototype.interfaces_=function(){return[]};o1.prototype.getClass=function(){return o1};var fd=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};fd.prototype.next=function(){if(this._atStart)return this._atStart=!1,fd.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new C1;var t=this._parent.getGeometryN(this._index++);return t instanceof iu?(this._subcollectionIterator=new fd(t),this._subcollectionIterator.next()):t};fd.prototype.remove=function(){throw new Error(this.getClass().getName())};fd.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};fd.prototype.interfaces_=function(){return[v1]};fd.prototype.getClass=function(){return fd};fd.isAtomic=function(t){return!(t instanceof iu)};var Nl=function(){this._geom=null;var t=arguments[0];this._geom=t};Nl.prototype.locate=function(t){return Nl.locate(t,this._geom)};Nl.prototype.interfaces_=function(){return[o1]};Nl.prototype.getClass=function(){return Nl};Nl.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?Ue.isPointInRing(t,n.getCoordinates()):!1};Nl.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Nl.isPointInRing(t,r))return!1;for(var o=0;o<n.getNumInteriorRing();o++){var a=n.getInteriorRingN(o);if(Nl.isPointInRing(t,a))return!1}return!0};Nl.containsPoint=function(t,n){if(n instanceof xa)return Nl.containsPointInPolygon(t,n);if(n instanceof iu)for(var r=new fd(n);r.hasNext();){var o=r.next();if(o!==n&&Nl.containsPoint(t,o))return!0}return!1};Nl.locate=function(t,n){return n.isEmpty()?he.EXTERIOR:Nl.containsPoint(t,n)?he.INTERIOR:he.EXTERIOR};var Bs=function(){this._edgeMap=new Os,this._edgeList=null,this._ptInAreaLocation=[he.NONE,he.NONE]};Bs.prototype.getNextCW=function(t){this.getEdges();var n=this._edgeList.indexOf(t),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};Bs.prototype.propagateSideLabels=function(t){for(var n=he.NONE,r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.isArea(t)&&a.getLocation(t,Pe.LEFT)!==he.NONE&&(n=a.getLocation(t,Pe.LEFT))}if(n===he.NONE)return null;for(var s=n,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();if(c.getLocation(t,Pe.ON)===he.NONE&&c.setLocation(t,Pe.ON,s),c.isArea(t)){var f=c.getLocation(t,Pe.LEFT),h=c.getLocation(t,Pe.RIGHT);if(h!==he.NONE){if(h!==s)throw new Sp("side location conflict",l.getCoordinate());f===he.NONE&&tn.shouldNeverReachHere("found single null side (at "+l.getCoordinate()+")"),s=f}else tn.isTrue(c.getLocation(t,Pe.LEFT)===he.NONE,"found single null side"),c.setLocation(t,Pe.RIGHT,s),c.setLocation(t,Pe.LEFT,s)}}};Bs.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()};Bs.prototype.print=function(t){cs.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Bs.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Bs.prototype.checkAreaLabelsConsistent=function(t){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,o=n.get(r).getLabel(),a=o.getLocation(t,Pe.LEFT);tn.isTrue(a!==he.NONE,"Found unlabelled area edge");for(var s=a,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();tn.isTrue(c.isArea(t),"Found non-area edge");var f=c.getLocation(t,Pe.LEFT),h=c.getLocation(t,Pe.RIGHT);if(f===h||h!==s)return!1;s=f}return!0};Bs.prototype.findIndex=function(t){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var o=n._edgeList.get(r);if(o===t)return r}return-1};Bs.prototype.iterator=function(){return this.getEdges().iterator()};Bs.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Be(this._edgeMap.values())),this._edgeList};Bs.prototype.getLocation=function(t,n,r){return this._ptInAreaLocation[t]===he.NONE&&(this._ptInAreaLocation[t]=Nl.locate(n,r[t].getGeometry())),this._ptInAreaLocation[t]};Bs.prototype.toString=function(){var t=new oh;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();t.append(r),t.append(`
`)}return t.toString()};Bs.prototype.computeEdgeEndLabels=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(t)}};Bs.prototype.computeLabelling=function(t){var n=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),u=0;u<2;u++)s.isLine(u)&&s.getLocation(u)===he.BOUNDARY&&(r[u]=!0);for(var l=this.iterator();l.hasNext();)for(var c=l.next(),f=c.getLabel(),h=0;h<2;h++)if(f.isAnyNull(h)){var d=he.NONE;if(r[h])d=he.EXTERIOR;else{var p=c.getCoordinate();d=n.getLocation(h,p,t)}f.setAllLocationsIfNull(h,d)}};Bs.prototype.getDegree=function(){return this._edgeMap.size()};Bs.prototype.insertEdgeEnd=function(t,n){this._edgeMap.put(t,n),this._edgeList=null};Bs.prototype.interfaces_=function(){return[]};Bs.prototype.getClass=function(){return Bs};var wxe=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var o=null,a=null,s=this._SCANNING_FOR_INCOMING,u=0;u<this._resultAreaEdgeList.size();u++){var l=r._resultAreaEdgeList.get(u),c=l.getSym();if(!!l.getLabel().isArea())switch(o===null&&l.isInResult()&&(o=l),s){case r._SCANNING_FOR_INCOMING:if(!c.isInResult())continue;a=c,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!l.isInResult())continue;a.setNext(l),s=r._SCANNING_FOR_INCOMING;break;default:}}if(s===this._LINKING_TO_OUTGOING){if(o===null)throw new Sp("no outgoing dirEdge found",this.getCoordinate());tn.isTrue(o.isInResult(),"unable to link last incoming dirEdge"),a.setNext(o)}},t.prototype.insert=function(r){var o=r;this.insertEdgeEnd(o,o)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),o=r.size();if(o<1)return null;var a=r.get(0);if(o===1)return a;var s=r.get(o-1),u=a.getQuadrant(),l=s.getQuadrant();return Ti.isNorthern(u)&&Ti.isNorthern(l)?a:!Ti.isNorthern(u)&&!Ti.isNorthern(l)?s:a.getDy()!==0?a:s.getDy()!==0?s:(tn.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){cs.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var a=o.next();r.print("out "),a.print(r),r.println(),r.print("in "),a.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Be;for(var o=this.iterator();o.hasNext();){var a=o.next();(a.isInResult()||a.getSym().isInResult())&&r._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.setAllLocationsIfNull(0,r.getLocation(0)),s.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var o=null,a=null,s=this._edgeList.size()-1;s>=0;s--){var u=r._edgeList.get(s),l=u.getSym();a===null&&(a=l),o!==null&&l.setNext(o),o=u}a.setNext(o)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var o=arguments[0],a=this.findIndex(o),s=o.getDepth(Pe.LEFT),u=o.getDepth(Pe.RIGHT),l=this.computeDepths(a+1,this._edgeList.size(),s),c=this.computeDepths(0,a,l);if(c!==u)throw new Sp("depth mismatch at "+o.getCoordinate())}else if(arguments.length===3){for(var f=arguments[0],h=arguments[1],d=arguments[2],p=d,g=f;g<h;g++){var y=r._edgeList.get(g);y.setEdgeDepths(Pe.RIGHT,p),p=y.getDepth(Pe.LEFT)}return p}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.merge(o.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var o=this,a=null,s=null,u=this._SCANNING_FOR_INCOMING,l=this._resultAreaEdgeList.size()-1;l>=0;l--){var c=o._resultAreaEdgeList.get(l),f=c.getSym();switch(a===null&&c.getEdgeRing()===r&&(a=c),u){case o._SCANNING_FOR_INCOMING:if(f.getEdgeRing()!==r)continue;s=f,u=o._LINKING_TO_OUTGOING;break;case o._LINKING_TO_OUTGOING:if(c.getEdgeRing()!==r)continue;s.setNextMin(c),u=o._SCANNING_FOR_INCOMING;break;default:}}u===this._LINKING_TO_OUTGOING&&(tn.isTrue(a!==null,"found null for first outgoing dirEdge"),tn.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),s.setNextMin(a))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,o=this.iterator();o.hasNext();){var a=o.next();a.isInResult()&&r++}return r}else if(arguments.length===1){for(var s=arguments[0],u=0,l=this.iterator();l.hasNext();){var c=l.next();c.getEdgeRing()===s&&u++}return u}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=he.NONE,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){r=he.INTERIOR;break}if(s.isInResult()){r=he.EXTERIOR;break}}}if(r===he.NONE)return null;for(var u=r,l=this.iterator();l.hasNext();){var c=l.next(),f=c.getSym();c.isLineEdge()?c.getEdge().setCovered(u===he.INTERIOR):(c.isInResult()&&(u=he.EXTERIOR),f.isInResult()&&(u=he.INTERIOR))}},t.prototype.computeLabelling=function(r){var o=this;e.prototype.computeLabelling.call(this,r),this._label=new ni(he.NONE);for(var a=this.iterator();a.hasNext();)for(var s=a.next(),u=s.getEdge(),l=u.getLabel(),c=0;c<2;c++){var f=l.getLocation(c);(f===he.INTERIOR||f===he.BOUNDARY)&&o._label.setLocation(c,he.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Bs),AX=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new MP(r,new wxe)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(n1),Ym=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};Ym.prototype.compareTo=function(t){var n=t,r=Ym.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};Ym.prototype.interfaces_=function(){return[wc]};Ym.prototype.getClass=function(){return Ym};Ym.orientation=function(t){return fn.increasingDirection(t)===1};Ym.compareOriented=function(t,n,r,o){for(var a=n?1:-1,s=o?1:-1,u=n?t.length:-1,l=o?r.length:-1,c=n?0:t.length-1,f=o?0:r.length-1;;){var h=t[c].compareTo(r[f]);if(h!==0)return h;c+=a,f+=s;var d=c===u,p=f===l;if(d&&!p)return-1;if(!d&&p)return 1;if(d&&p)return 0}};var nf=function(){this._edges=new Be,this._ocaMap=new Os};nf.prototype.print=function(t){var n=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var o=n._edges.get(r);r>0&&t.print(","),t.print("(");for(var a=o.getCoordinates(),s=0;s<a.length;s++)s>0&&t.print(","),t.print(a[s].x+" "+a[s].y);t.println(")")}t.print(")  ")};nf.prototype.addAll=function(t){for(var n=this,r=t.iterator();r.hasNext();)n.add(r.next())};nf.prototype.findEdgeIndex=function(t){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(t))return r;return-1};nf.prototype.iterator=function(){return this._edges.iterator()};nf.prototype.getEdges=function(){return this._edges};nf.prototype.get=function(t){return this._edges.get(t)};nf.prototype.findEqualEdge=function(t){var n=new Ym(t.getCoordinates()),r=this._ocaMap.get(n);return r};nf.prototype.add=function(t){this._edges.add(t);var n=new Ym(t.getCoordinates());this._ocaMap.put(n,t)};nf.prototype.interfaces_=function(){return[]};nf.prototype.getClass=function(){return nf};var b0=function(){};b0.prototype.processIntersections=function(t,n,r,o){};b0.prototype.isDone=function(){};b0.prototype.interfaces_=function(){return[]};b0.prototype.getClass=function(){return b0};var kl=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};kl.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(kl.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.size()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};kl.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};kl.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};kl.prototype.getLineIntersector=function(){return this._li};kl.prototype.hasProperIntersection=function(){return this._hasProper};kl.prototype.processIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};kl.prototype.hasIntersection=function(){return this._hasIntersection};kl.prototype.isDone=function(){return!1};kl.prototype.hasInteriorIntersection=function(){return this._hasInterior};kl.prototype.interfaces_=function(){return[b0]};kl.prototype.getClass=function(){return kl};kl.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var eh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],r=arguments[2];this.coord=new ae(t),this.segmentIndex=n,this.dist=r};eh.prototype.getSegmentIndex=function(){return this.segmentIndex};eh.prototype.getCoordinate=function(){return this.coord};eh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};eh.prototype.compareTo=function(t){var n=t;return this.compare(n.segmentIndex,n.dist)};eh.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};eh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};eh.prototype.getDistance=function(){return this.dist};eh.prototype.compare=function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0};eh.prototype.interfaces_=function(){return[wc]};eh.prototype.getClass=function(){return eh};var gd=function(){this._nodeMap=new Os,this.edge=null;var t=arguments[0];this.edge=t};gd.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};gd.prototype.iterator=function(){return this._nodeMap.values().iterator()};gd.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};gd.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};gd.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this.edge.pts[n.segmentIndex],s=n.dist>0||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new ae(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r.edge.pts[c];return s&&(u[l]=n.coord),new eP(u,new ni(this.edge._label))};gd.prototype.add=function(t,n,r){var o=new eh(t,n,r),a=this._nodeMap.get(o);return a!==null?a:(this._nodeMap.put(o,o),o)};gd.prototype.isIntersection=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(t))return!0}return!1};gd.prototype.interfaces_=function(){return[]};gd.prototype.getClass=function(){return gd};var I0=function(){};I0.prototype.getChainStartIndices=function(t){var n=this,r=0,o=new Be;o.add(new jf(r));do{var a=n.findChainEnd(t,r);o.add(new jf(a)),r=a}while(r<t.length-1);var s=I0.toIntArray(o);return s};I0.prototype.findChainEnd=function(t,n){for(var r=Ti.quadrant(t[n],t[n+1]),o=n+1;o<t.length;){var a=Ti.quadrant(t[o-1],t[o]);if(a!==r)break;o++}return o-1};I0.prototype.interfaces_=function(){return[]};I0.prototype.getClass=function(){return I0};I0.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var bp=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new ut,this.env2=new ut;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new I0;this.startIndex=n.getChainStartIndices(this.pts)};bp.prototype.getCoordinates=function(){return this.pts};bp.prototype.getMaxX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n>r?n:r};bp.prototype.getMinX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n<r?n:r};bp.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[r],n.startIndex[r+1],o)}else if(arguments.length===6){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=arguments[4],f=arguments[5],h=this.pts[a],d=this.pts[s],p=u.pts[l],g=u.pts[c];if(s-a===1&&c-l===1)return f.addIntersections(this.e,a,u.e,l),null;if(this.env1.init(h,d),this.env2.init(p,g),!this.env1.intersects(this.env2))return null;var y=Math.trunc((a+s)/2),v=Math.trunc((l+c)/2);a<y&&(l<v&&this.computeIntersectsForChain(a,y,u,l,v,f),v<c&&this.computeIntersectsForChain(a,y,u,v,c,f)),y<s&&(l<v&&this.computeIntersectsForChain(y,s,u,l,v,f),v<c&&this.computeIntersectsForChain(y,s,u,v,c,f))}};bp.prototype.getStartIndexes=function(){return this.startIndex};bp.prototype.computeIntersects=function(t,n){for(var r=this,o=0;o<this.startIndex.length-1;o++)for(var a=0;a<t.startIndex.length-1;a++)r.computeIntersectsForChain(o,t,a,n)};bp.prototype.interfaces_=function(){return[]};bp.prototype.getClass=function(){return bp};var ls=function e(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)t._depth[n][r]=e.NULL_VALUE},bX={NULL_VALUE:{configurable:!0}};ls.prototype.getDepth=function(t,n){return this._depth[t][n]};ls.prototype.setDepth=function(t,n,r){this._depth[t][n]=r};ls.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(t._depth[n][r]!==ls.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var o=arguments[0];return this._depth[o][1]===ls.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._depth[a][s]===ls.NULL_VALUE}};ls.prototype.normalize=function(){for(var t=this,n=0;n<2;n++)if(!t.isNull(n)){var r=t._depth[n][1];t._depth[n][2]<r&&(r=t._depth[n][2]),r<0&&(r=0);for(var o=1;o<3;o++){var a=0;t._depth[n][o]>r&&(a=1),t._depth[n][o]=a}}};ls.prototype.getDelta=function(t){return this._depth[t][Pe.RIGHT]-this._depth[t][Pe.LEFT]};ls.prototype.getLocation=function(t,n){return this._depth[t][n]<=0?he.EXTERIOR:he.INTERIOR};ls.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};ls.prototype.add=function(){var t=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var o=1;o<3;o++){var a=n.getLocation(r,o);(a===he.EXTERIOR||a===he.INTERIOR)&&(t.isNull(r,o)?t._depth[r][o]=ls.depthAtLocation(a):t._depth[r][o]+=ls.depthAtLocation(a))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];l===he.INTERIOR&&this._depth[s][u]++}};ls.prototype.interfaces_=function(){return[]};ls.prototype.getClass=function(){return ls};ls.depthAtLocation=function(t){return t===he.EXTERIOR?0:t===he.INTERIOR?1:ls.NULL_VALUE};bX.NULL_VALUE.get=function(){return-1};Object.defineProperties(ls,bX);var eP=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new gd(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ls,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.pts=r,this._label=o}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var o=new t(r,ni.toLineLabel(this._label));return o},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var o=this;if(!(r instanceof t))return!1;var a=r;if(this.pts.length!==a.pts.length)return!1;for(var s=!0,u=!0,l=this.pts.length,c=0;c<this.pts.length;c++)if(o.pts[c].equals2D(a.pts[c])||(s=!1),o.pts[c].equals2D(a.pts[--l])||(u=!1),!s&&!u)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var o=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(o.pts[a].x+" "+o.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var o=this;r.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)r.print(o.pts[a]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new bp(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new ut;for(var o=0;o<this.pts.length;o++)r._env.expandToInclude(r.pts[o])}return this._env},t.prototype.addIntersection=function(r,o,a,s){var u=new ae(r.getIntersection(s)),l=o,c=r.getEdgeDistance(a,s),f=l+1;if(f<this.pts.length){var h=this.pts[f];u.equals2D(h)&&(l=f,c=0)}this.eiList.add(u,l,c)},t.prototype.toString=function(){var r=this,o=new oh;o.append("edge "+this._name+": "),o.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&o.append(","),o.append(r.pts[a].x+" "+r.pts[a].y);return o.append(")  "+this._label+" "+this._depthDelta),o.toString()},t.prototype.isPointwiseEqual=function(r){var o=this;if(this.pts.length!==r.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!o.pts[a].equals2D(r.pts[a]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,o,a){for(var s=this,u=0;u<r.getIntersectionNum();u++)s.addIntersection(r,o,a,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];o.setAtLeastIfValid(r.getLocation(0,Pe.ON),r.getLocation(1,Pe.ON),1),r.isArea()&&(o.setAtLeastIfValid(r.getLocation(0,Pe.LEFT),r.getLocation(1,Pe.LEFT),2),o.setAtLeastIfValid(r.getLocation(0,Pe.RIGHT),r.getLocation(1,Pe.RIGHT),2))}else return e.prototype.updateIM.apply(this,arguments)},t}(zl),nu=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new nf,this._bufParams=t||null};nu.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};nu.prototype.insertUniqueEdge=function(t){var n=this._edgeList.findEqualEdge(t);if(n!==null){var r=n.getLabel(),o=t.getLabel();n.isPointwiseEqual(t)||(o=new ni(t.getLabel()),o.flip()),r.merge(o);var a=nu.depthDelta(o),s=n.getDepthDelta(),u=s+a;n.setDepthDelta(u)}else this._edgeList.add(t),t.setDepthDelta(nu.depthDelta(t.getLabel()))};nu.prototype.buildSubgraphs=function(t,n){for(var r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=a.getRightmostCoordinate(),u=new Cy(r),l=u.getDepth(s);a.computeDepth(l),a.findResultEdges(),r.add(a),n.add(a.getDirectedEdges(),a.getNodes())}};nu.prototype.createSubgraphs=function(t){for(var n=new Be,r=t.getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isVisited()){var a=new ou;a.create(o),n.add(a)}}return tf.sort(n,tf.reverseOrder()),n};nu.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};nu.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var n=new J3,r=new O0;return r.setPrecisionModel(t),n.setSegmentIntersector(new kl(r)),n};nu.prototype.buffer=function(t,n){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new Ou(r,this._bufParams),a=new xc(t,n,o),s=a.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,r),this._graph=new vo(new AX),this._graph.addEdges(this._edgeList.getEdges());var u=this.createSubgraphs(this._graph),l=new ul(this._geomFact);this.buildSubgraphs(u,l);var c=l.getPolygons();if(c.size()<=0)return this.createEmptyResultGeometry();var f=this._geomFact.buildGeometry(c);return f};nu.prototype.computeNodedEdges=function(t,n){var r=this,o=this.getNoder(n);o.computeNodes(t);for(var a=o.getNodedSubstrings(),s=a.iterator();s.hasNext();){var u=s.next(),l=u.getCoordinates();if(!(l.length===2&&l[0].equals2D(l[1]))){var c=u.getData(),f=new eP(u.getCoordinates(),new ni(c));r.insertUniqueEdge(f)}}};nu.prototype.setNoder=function(t){this._workingNoder=t};nu.prototype.interfaces_=function(){return[]};nu.prototype.getClass=function(){return nu};nu.depthDelta=function(t){var n=t.getLocation(0,Pe.LEFT),r=t.getLocation(0,Pe.RIGHT);return n===he.INTERIOR&&r===he.EXTERIOR?1:n===he.EXTERIOR&&r===he.INTERIOR?-1:0};nu.convertSegStrings=function(t){for(var n=new cn,r=new Be;t.hasNext();){var o=t.next(),a=n.createLineString(o.getCoordinates());r.add(a)}return n.buildGeometry(r)};var Xm=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._noder=r,this._scaleFactor=o,this._offsetX=a,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};Xm.prototype.rescale=function(){var t=this;if(Mt(arguments[0],ya))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.rescale(o.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],s=0;s<a.length;s++)a[s].x=a[s].x/t._scaleFactor+t._offsetX,a[s].y=a[s].y/t._scaleFactor+t._offsetY;a.length===2&&a[0].equals2D(a[1])&&cs.out.println(a)}};Xm.prototype.scale=function(){var t=this;if(Mt(arguments[0],ya)){for(var n=arguments[0],r=new Be,o=n.iterator();o.hasNext();){var a=o.next();r.add(new Go(t.scale(a.getCoordinates()),a.getData()))}return r}else if(arguments[0]instanceof Array){for(var s=arguments[0],u=new Array(s.length).fill(null),l=0;l<s.length;l++)u[l]=new ae(Math.round((s[l].x-t._offsetX)*t._scaleFactor),Math.round((s[l].y-t._offsetY)*t._scaleFactor),s[l].z);var c=fn.removeRepeatedPoints(u);return c}};Xm.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Xm.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Xm.prototype.computeNodes=function(t){var n=t;this._isScaled&&(n=this.scale(t)),this._noder.computeNodes(n)};Xm.prototype.interfaces_=function(){return[S0]};Xm.prototype.getClass=function(){return Xm};var th=function(){this._li=new O0,this._segStrings=null;var t=arguments[0];this._segStrings=t},IX={fact:{configurable:!0}};th.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();t.checkEndPtVertexIntersections(o[0],t._segStrings),t.checkEndPtVertexIntersections(o[o.length-1],t._segStrings)}else if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=s.iterator();u.hasNext();)for(var l=u.next(),c=l.getCoordinates(),f=1;f<c.length-1;f++)if(c[f].equals(a))throw new Ep("found endpt/interior pt intersection at index "+f+" :pt "+a)}};th.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),o=this._segStrings.iterator();o.hasNext();){var a=o.next();t.checkInteriorIntersections(r,a)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],l=s.getCoordinates(),c=u.getCoordinates(),f=0;f<l.length-1;f++)for(var h=0;h<c.length-1;h++)t.checkInteriorIntersections(s,f,u,h);else if(arguments.length===4){var d=arguments[0],p=arguments[1],g=arguments[2],y=arguments[3];if(d===g&&p===y)return null;var v=d.getCoordinates()[p],w=d.getCoordinates()[p+1],C=g.getCoordinates()[y],E=g.getCoordinates()[y+1];if(this._li.computeIntersection(v,w,C,E),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,v,w)||this.hasInteriorIntersection(this._li,C,E)))throw new Ep("found non-noded intersection at "+v+"-"+w+" and "+C+"-"+E)}};th.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};th.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkCollapses(r)}else if(arguments.length===1)for(var o=arguments[0],a=o.getCoordinates(),s=0;s<a.length-2;s++)t.checkCollapse(a[s],a[s+1],a[s+2])};th.prototype.hasInteriorIntersection=function(t,n,r){for(var o=0;o<t.getIntersectionNum();o++){var a=t.getIntersection(o);if(!(a.equals(n)||a.equals(r)))return!0}return!1};th.prototype.checkCollapse=function(t,n,r){if(t.equals(r))throw new Ep("found non-noded collapse at "+th.fact.createLineString([t,n,r]))};th.prototype.interfaces_=function(){return[]};th.prototype.getClass=function(){return th};IX.fact.get=function(){return new cn};Object.defineProperties(th,IX);var Nu=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=r,n<=0)throw new so("Scale factor must be non-zero");n!==1&&(this._pt=new ae(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new ae,this._p1Scaled=new ae),this.initCorners(this._pt)},DX={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Nu.prototype.intersectsScaled=function(t,n){var r=Math.min(t.x,n.x),o=Math.max(t.x,n.x),a=Math.min(t.y,n.y),s=Math.max(t.y,n.y),u=this._maxx<r||this._minx>o||this._maxy<a||this._miny>s;if(u)return!1;var l=this.intersectsToleranceSquare(t,n);return tn.isTrue(!(u&&l),"Found bad envelope test"),l};Nu.prototype.initCorners=function(t){var n=.5;this._minx=t.x-n,this._maxx=t.x+n,this._miny=t.y-n,this._maxy=t.y+n,this._corner[0]=new ae(this._maxx,this._maxy),this._corner[1]=new ae(this._minx,this._maxy),this._corner[2]=new ae(this._minx,this._miny),this._corner[3]=new ae(this._maxx,this._miny)};Nu.prototype.intersects=function(t,n){return this._scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Nu.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};Nu.prototype.getCoordinate=function(){return this._originalPt};Nu.prototype.copyScaled=function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)};Nu.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=Nu.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ut(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};Nu.prototype.intersectsPixelClosure=function(t,n){return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Nu.prototype.intersectsToleranceSquare=function(t,n){var r=!1,o=!1;return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&o||t.equals(this._pt)||n.equals(this._pt))};Nu.prototype.addSnappedNode=function(t,n){var r=t.getCoordinate(n),o=t.getCoordinate(n+1);return this.intersects(r,o)?(t.addIntersection(this.getCoordinate(),n),!0):!1};Nu.prototype.interfaces_=function(){return[]};Nu.prototype.getClass=function(){return Nu};DX.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Nu,DX);var DT=function(){this.tempEnv1=new ut,this.selectedSegment=new ct};DT.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};DT.prototype.interfaces_=function(){return[]};DT.prototype.getClass=function(){return DT};var a1=function(){this._index=null;var t=arguments[0];this._index=t},PX={HotPixelSnapAction:{configurable:!0}};a1.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=n.getSafeEnvelope(),s=new MX(n,r,o);return this._index.query(a,{interfaces_:function(){return[qm]},visitItem:function(u){var l=u;l.select(a,s)}}),s.isNodeAdded()}};a1.prototype.interfaces_=function(){return[]};a1.prototype.getClass=function(){return a1};PX.HotPixelSnapAction.get=function(){return MX};Object.defineProperties(a1,PX);var MX=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],o=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1],a=r.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&o===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,o)}else return e.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(DT),xy=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Be};xy.prototype.processIntersections=function(t,n,r,o){var a=this;if(t===r&&n===o)return null;var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];if(this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var f=0;f<this._li.getIntersectionNum();f++)a._interiorIntersections.add(a._li.getIntersection(f));t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)}};xy.prototype.isDone=function(){return!1};xy.prototype.getInteriorIntersections=function(){return this._interiorIntersections};xy.prototype.interfaces_=function(){return[b0]};xy.prototype.getClass=function(){return xy};var _d=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new O0,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};_d.prototype.checkCorrectness=function(t){var n=Go.getNodedSubstrings(t),r=new th(n);try{r.checkValid()}catch(o){if(o instanceof mX)o.printStackTrace();else throw o}finally{}};_d.prototype.getNodedSubstrings=function(){return Go.getNodedSubstrings(this._nodedSegStrings)};_d.prototype.snapRound=function(t,n){var r=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};_d.prototype.findInteriorIntersections=function(t,n){var r=new xy(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};_d.prototype.computeVertexSnaps=function(){var t=this;if(Mt(arguments[0],ya))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.computeVertexSnaps(o)}else if(arguments[0]instanceof Go)for(var a=arguments[0],s=a.getCoordinates(),u=0;u<s.length;u++){var l=new Nu(s[u],t._scaleFactor,t._li),c=t._pointSnapper.snap(l,a,u);c&&a.addIntersection(s[u],u)}};_d.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new J3,this._pointSnapper=new a1(this._noder.getIndex()),this.snapRound(t,this._li)};_d.prototype.computeIntersectionSnaps=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=new Nu(o,n._scaleFactor,n._li);n._pointSnapper.snap(a)}};_d.prototype.interfaces_=function(){return[S0]};_d.prototype.getClass=function(){return _d};var us=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new zr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},w1={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};us.prototype.bufferFixedPrecision=function(t){var n=new Xm(new _d(new kr(1)),t.getScale()),r=new nu(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};us.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var n=us.MAX_PRECISION_DIGITS;n>=0;n--){try{t.bufferReducedPrecision(n)}catch(s){if(s instanceof Sp)t._saveException=s;else throw s}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],o=us.precisionScaleFactor(this._argGeom,this._distance,r),a=new kr(o);this.bufferFixedPrecision(a)}};us.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===kr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};us.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};us.prototype.bufferOriginalPrecision=function(){try{var t=new nu(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof Ep)this._saveException=n;else throw n}finally{}};us.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};us.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};us.prototype.interfaces_=function(){return[]};us.prototype.getClass=function(){return us};us.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new us(t),o=r.getResultGeometry(n);return o}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof It&&typeof arguments[1]=="number"){var a=arguments[0],s=arguments[1],u=arguments[2],l=new us(a);l.setQuadrantSegments(u);var c=l.getResultGeometry(s);return c}else if(arguments[2]instanceof zr&&arguments[0]instanceof It&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=arguments[2],p=new us(f,d),g=p.getResultGeometry(h);return g}}else if(arguments.length===4){var y=arguments[0],v=arguments[1],w=arguments[2],C=arguments[3],E=new us(y);E.setQuadrantSegments(w),E.setEndCapStyle(C);var S=E.getResultGeometry(v);return S}};us.precisionScaleFactor=function(t,n,r){var o=t.getEnvelopeInternal(),a=Fl.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY())),s=n>0?n:0,u=a+2*s,l=Math.trunc(Math.log(u)/Math.log(10)+1),c=r-l,f=Math.pow(10,c);return f};w1.CAP_ROUND.get=function(){return zr.CAP_ROUND};w1.CAP_BUTT.get=function(){return zr.CAP_FLAT};w1.CAP_FLAT.get=function(){return zr.CAP_FLAT};w1.CAP_SQUARE.get=function(){return zr.CAP_SQUARE};w1.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(us,w1);var $s=function(){this._pt=[new ae,new ae],this._distance=Wt.NaN,this._isNull=!0};$s.prototype.getCoordinates=function(){return this._pt};$s.prototype.getCoordinate=function(t){return this._pt[t]};$s.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};$s.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};$s.prototype.getDistance=function(){return this._distance};$s.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};$s.prototype.interfaces_=function(){return[]};$s.prototype.getClass=function(){return $s};var ld=function(){};ld.prototype.interfaces_=function(){return[]};ld.prototype.getClass=function(){return ld};ld.computeDistance=function(){if(arguments[2]instanceof $s&&arguments[0]instanceof bo&&arguments[1]instanceof ae)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=t.getCoordinates(),a=new ct,s=0;s<o.length-1;s++){a.setCoordinates(o[s],o[s+1]);var u=a.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof $s&&arguments[0]instanceof xa&&arguments[1]instanceof ae){var l=arguments[0],c=arguments[1],f=arguments[2];ld.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)ld.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof $s&&arguments[0]instanceof It&&arguments[1]instanceof ae){var d=arguments[0],p=arguments[1],g=arguments[2];if(d instanceof bo)ld.computeDistance(d,p,g);else if(d instanceof xa)ld.computeDistance(d,p,g);else if(d instanceof iu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);ld.computeDistance(w,p,g)}else g.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof $s&&arguments[0]instanceof ct&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var D0=function(t){this._maxPtDist=new $s,this._inputGeom=t||null},$3={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};D0.prototype.computeMaxMidpointDistance=function(t){var n=new jm(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};D0.prototype.computeMaxVertexDistance=function(t){var n=new wy(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};D0.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};D0.prototype.getDistancePoints=function(){return this._maxPtDist};D0.prototype.interfaces_=function(){return[]};D0.prototype.getClass=function(){return D0};$3.MaxPointDistanceFilter.get=function(){return wy};$3.MaxMidpointDistanceFilter.get=function(){return jm};Object.defineProperties(D0,$3);var wy=function(t){this._maxPtDist=new $s,this._minPtDist=new $s,this._geom=t||null};wy.prototype.filter=function(t){this._minPtDist.initialize(),ld.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};wy.prototype.getMaxPointDistance=function(){return this._maxPtDist};wy.prototype.interfaces_=function(){return[hd]};wy.prototype.getClass=function(){return wy};var jm=function(t){this._maxPtDist=new $s,this._minPtDist=new $s,this._geom=t||null};jm.prototype.filter=function(t,n){if(n===0)return null;var r=t.getCoordinate(n-1),o=t.getCoordinate(n),a=new ae((r.x+o.x)/2,(r.y+o.y)/2);this._minPtDist.initialize(),ld.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};jm.prototype.isDone=function(){return!1};jm.prototype.isGeometryChanged=function(){return!1};jm.prototype.getMaxPointDistance=function(){return this._maxPtDist};jm.prototype.interfaces_=function(){return[$c]};jm.prototype.getClass=function(){return jm};var vp=function(t){this._comps=t||null};vp.prototype.filter=function(t){t instanceof xa&&this._comps.add(t)};vp.prototype.interfaces_=function(){return[Zf]};vp.prototype.getClass=function(){return vp};vp.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return vp.getPolygons(t,new Be)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof xa?r.add(n):n instanceof iu&&n.apply(new vp(r)),r}};var as=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};as.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof dd){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(n),null}t instanceof bo&&this._lines.add(t)};as.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};as.prototype.interfaces_=function(){return[Tp]};as.prototype.getClass=function(){return as};as.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(as.getLines(t))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(as.getLines(n,r))}};as.getLines=function(){if(arguments.length===1){var t=arguments[0];return as.getLines(t,!1)}else if(arguments.length===2){if(Mt(arguments[0],ya)&&Mt(arguments[1],ya)){for(var n=arguments[0],r=arguments[1],o=n.iterator();o.hasNext();){var a=o.next();as.getLines(a,r)}return r}else if(arguments[0]instanceof It&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1],l=new Be;return s.apply(new as(l,u)),l}else if(arguments[0]instanceof It&&Mt(arguments[1],ya)){var c=arguments[0],f=arguments[1];return c instanceof bo?f.add(c):c.apply(new as(f)),f}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Mt(arguments[0],ya)&&Mt(arguments[1],ya)){for(var h=arguments[0],d=arguments[1],p=arguments[2],g=h.iterator();g.hasNext();){var y=g.next();as.getLines(y,d,p)}return d}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof It&&Mt(arguments[1],ya)){var v=arguments[0],w=arguments[1],C=arguments[2];return v.apply(new as(w,C)),w}}};var rf=function(){if(this._boundaryRule=vc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new so("Rule must be non-null");this._boundaryRule=t}}};rf.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof ae&&arguments[1]instanceof xa){var n=arguments[0],r=arguments[1];if(r.isEmpty())return he.EXTERIOR;var o=r.getExteriorRing(),a=this.locateInPolygonRing(n,o);if(a===he.EXTERIOR)return he.EXTERIOR;if(a===he.BOUNDARY)return he.BOUNDARY;for(var s=0;s<r.getNumInteriorRing();s++){var u=r.getInteriorRingN(s),l=t.locateInPolygonRing(n,u);if(l===he.INTERIOR)return he.EXTERIOR;if(l===he.BOUNDARY)return he.BOUNDARY}return he.INTERIOR}else if(arguments[0]instanceof ae&&arguments[1]instanceof bo){var c=arguments[0],f=arguments[1];if(!f.getEnvelopeInternal().intersects(c))return he.EXTERIOR;var h=f.getCoordinates();return!f.isClosed()&&(c.equals(h[0])||c.equals(h[h.length-1]))?he.BOUNDARY:Ue.isOnLine(c,h)?he.INTERIOR:he.EXTERIOR}else if(arguments[0]instanceof ae&&arguments[1]instanceof sl){var d=arguments[0],p=arguments[1],g=p.getCoordinate();return g.equals2D(d)?he.INTERIOR:he.EXTERIOR}};rf.prototype.locateInPolygonRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?Ue.locatePointInRing(t,n.getCoordinates()):he.EXTERIOR};rf.prototype.intersects=function(t,n){return this.locate(t,n)!==he.EXTERIOR};rf.prototype.updateLocationInfo=function(t){t===he.INTERIOR&&(this._isIn=!0),t===he.BOUNDARY&&this._numBoundaries++};rf.prototype.computeLocation=function(t,n){var r=this;if(n instanceof sl&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof bo)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof xa)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof T0)for(var o=n,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);r.updateLocationInfo(r.locateInternal(t,s))}else if(n instanceof cd)for(var u=n,l=0;l<u.getNumGeometries();l++){var c=u.getGeometryN(l);r.updateLocationInfo(r.locateInternal(t,c))}else if(n instanceof iu)for(var f=new fd(n);f.hasNext();){var h=f.next();h!==n&&r.computeLocation(t,h)}};rf.prototype.locate=function(t,n){return n.isEmpty()?he.EXTERIOR:n instanceof bo?this.locateInternal(t,n):n instanceof xa?this.locateInternal(t,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,n),this._boundaryRule.isInBoundary(this._numBoundaries)?he.BOUNDARY:this._numBoundaries>0||this._isIn?he.INTERIOR:he.EXTERIOR)};rf.prototype.interfaces_=function(){return[]};rf.prototype.getClass=function(){return rf};var eu=function e(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._component=r,this._segIndex=o,this._pt=a}},LX={INSIDE_AREA:{configurable:!0}};eu.prototype.isInsideArea=function(){return this._segIndex===eu.INSIDE_AREA};eu.prototype.getCoordinate=function(){return this._pt};eu.prototype.getGeometryComponent=function(){return this._component};eu.prototype.getSegmentIndex=function(){return this._segIndex};eu.prototype.interfaces_=function(){return[]};eu.prototype.getClass=function(){return eu};LX.INSIDE_AREA.get=function(){return-1};Object.defineProperties(eu,LX);var km=function(t){this._pts=t||null};km.prototype.filter=function(t){t instanceof sl&&this._pts.add(t)};km.prototype.interfaces_=function(){return[Zf]};km.prototype.getClass=function(){return km};km.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof sl?tf.singletonList(t):km.getPoints(t,new Be)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof sl?r.add(n):n instanceof iu&&n.apply(new km(r)),r}};var Ey=function(){this._locations=null;var t=arguments[0];this._locations=t};Ey.prototype.filter=function(t){(t instanceof sl||t instanceof bo||t instanceof xa)&&this._locations.add(new eu(t,0,t.getCoordinate()))};Ey.prototype.interfaces_=function(){return[Zf]};Ey.prototype.getClass=function(){return Ey};Ey.getLocations=function(t){var n=new Be;return t.apply(new Ey(n)),n};var fs=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new rf,this._minDistanceLocation=null,this._minDistance=Wt.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=o,this._terminateDistance=a}};fs.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=1-r,s=vp.getPolygons(this._geom[r]);if(s.size()>0){var u=Ey.getLocations(this._geom[a]);if(this.computeContainmentDistance(u,s,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=o[0],this._minDistanceLocation[r]=o[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Mt(arguments[0],Qc)&&Mt(arguments[1],Qc)){for(var l=arguments[0],c=arguments[1],f=arguments[2],h=0;h<l.size();h++)for(var d=l.get(h),p=0;p<c.size();p++)if(t.computeContainmentDistance(d,c.get(p),f),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof eu&&arguments[1]instanceof xa){var g=arguments[0],y=arguments[1],v=arguments[2],w=g.getCoordinate();if(he.EXTERIOR!==this._ptLocator.locate(w,y))return this._minDistance=0,v[0]=g,v[1]=new eu(y,w),null}}};fs.prototype.computeMinDistanceLinesPoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};fs.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),n=as.getLines(this._geom[0]),r=as.getLines(this._geom[1]),o=km.getPoints(this._geom[0]),a=km.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,a,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(o,a,t),this.updateMinDistance(t,!1)};fs.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};fs.prototype.updateMinDistance=function(t,n){if(t[0]===null)return null;n?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};fs.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};fs.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof bo&&arguments[1]instanceof sl){var n=arguments[0],r=arguments[1],o=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var a=n.getCoordinates(),s=r.getCoordinate(),u=0;u<a.length-1;u++){var l=Ue.distancePointLine(s,a[u],a[u+1]);if(l<t._minDistance){t._minDistance=l;var c=new ct(a[u],a[u+1]),f=c.closestPoint(s);o[0]=new eu(n,u,f),o[1]=new eu(r,0,s)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof bo&&arguments[1]instanceof bo){var h=arguments[0],d=arguments[1],p=arguments[2];if(h.getEnvelopeInternal().distance(d.getEnvelopeInternal())>this._minDistance)return null;for(var g=h.getCoordinates(),y=d.getCoordinates(),v=0;v<g.length-1;v++)for(var w=0;w<y.length-1;w++){var C=Ue.distanceLineLine(g[v],g[v+1],y[w],y[w+1]);if(C<t._minDistance){t._minDistance=C;var E=new ct(g[v],g[v+1]),S=new ct(y[w],y[w+1]),A=E.closestPoints(S);p[0]=new eu(h,v,A[0]),p[1]=new eu(d,w,A[1])}if(t._minDistance<=t._terminateDistance)return null}}}};fs.prototype.computeMinDistancePoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u),c=s.getCoordinate().distance(l.getCoordinate());if(c<o._minDistance&&(o._minDistance=c,r[0]=new eu(s,0,s.getCoordinate()),r[1]=new eu(l,0,l.getCoordinate())),o._minDistance<=o._terminateDistance)return null}};fs.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new so("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};fs.prototype.computeMinDistanceLines=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};fs.prototype.interfaces_=function(){return[]};fs.prototype.getClass=function(){return fs};fs.distance=function(t,n){var r=new fs(t,n);return r.distance()};fs.isWithinDistance=function(t,n,r){var o=new fs(t,n,r);return o.distance()<=r};fs.nearestPoints=function(t,n){var r=new fs(t,n);return r.nearestPoints()};var Rs=function(){this._pt=[new ae,new ae],this._distance=Wt.NaN,this._isNull=!0};Rs.prototype.getCoordinates=function(){return this._pt};Rs.prototype.getCoordinate=function(t){return this._pt[t]};Rs.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};Rs.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};Rs.prototype.toString=function(){return Jc.toLineString(this._pt[0],this._pt[1])};Rs.prototype.getDistance=function(){return this._distance};Rs.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};Rs.prototype.interfaces_=function(){return[]};Rs.prototype.getClass=function(){return Rs};var qf=function(){};qf.prototype.interfaces_=function(){return[]};qf.prototype.getClass=function(){return qf};qf.computeDistance=function(){if(arguments[2]instanceof Rs&&arguments[0]instanceof bo&&arguments[1]instanceof ae)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=new ct,a=t.getCoordinates(),s=0;s<a.length-1;s++){o.setCoordinates(a[s],a[s+1]);var u=o.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof Rs&&arguments[0]instanceof xa&&arguments[1]instanceof ae){var l=arguments[0],c=arguments[1],f=arguments[2];qf.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)qf.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof Rs&&arguments[0]instanceof It&&arguments[1]instanceof ae){var d=arguments[0],p=arguments[1],g=arguments[2];if(d instanceof bo)qf.computeDistance(d,p,g);else if(d instanceof xa)qf.computeDistance(d,p,g);else if(d instanceof iu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);qf.computeDistance(w,p,g)}else g.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof Rs&&arguments[0]instanceof ct&&arguments[1]instanceof ae){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var yc=function(){this._g0=null,this._g1=null,this._ptDist=new Rs,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n},eB={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};yc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};yc.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new so("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};yc.prototype.compute=function(t,n){this.computeOrientedDistance(t,n,this._ptDist),this.computeOrientedDistance(n,t,this._ptDist)};yc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};yc.prototype.computeOrientedDistance=function(t,n,r){var o=new Ty(n);if(t.apply(o),r.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var a=new Km(n,this._densifyFrac);t.apply(a),r.setMaximum(a.getMaxPointDistance())}};yc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};yc.distance=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new yc(t,n);return r.distance()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new yc(o,a);return u.setDensifyFraction(s),u.distance()}};eB.MaxPointDistanceFilter.get=function(){return Ty};eB.MaxDensifiedByFractionDistanceFilter.get=function(){return Km};Object.defineProperties(yc,eB);var Ty=function(){this._maxPtDist=new Rs,this._minPtDist=new Rs,this._euclideanDist=new qf,this._geom=null;var t=arguments[0];this._geom=t};Ty.prototype.filter=function(t){this._minPtDist.initialize(),qf.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Ty.prototype.getMaxPointDistance=function(){return this._maxPtDist};Ty.prototype.interfaces_=function(){return[hd]};Ty.prototype.getClass=function(){return Ty};var Km=function(){this._maxPtDist=new Rs,this._minPtDist=new Rs,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))};Km.prototype.filter=function(t,n){var r=this;if(n===0)return null;for(var o=t.getCoordinate(n-1),a=t.getCoordinate(n),s=(a.x-o.x)/this._numSubSegs,u=(a.y-o.y)/this._numSubSegs,l=0;l<this._numSubSegs;l++){var c=o.x+l*s,f=o.y+l*u,h=new ae(c,f);r._minPtDist.initialize(),qf.computeDistance(r._geom,h,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Km.prototype.isDone=function(){return!1};Km.prototype.isGeometryChanged=function(){return!1};Km.prototype.getMaxPointDistance=function(){return this._maxPtDist};Km.prototype.interfaces_=function(){return[$c]};Km.prototype.getClass=function(){return Km};var il=function(t,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=r||null},tB={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};il.prototype.checkMaximumDistance=function(t,n,r){var o=new yc(n,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var a=o.getCoordinates();this._errorLocation=a[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Jc.toLineString(a[0],a[1])+")"}};il.prototype.isValid=function(){var t=Math.abs(this._bufDistance),n=il.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),il.VERBOSE&&cs.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};il.prototype.checkNegativeValid=function(){if(!(this._input instanceof xa||this._input instanceof cd||this._input instanceof iu))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};il.prototype.getErrorIndicator=function(){return this._errorIndicator};il.prototype.checkMinimumDistance=function(t,n,r){var o=new fs(t,n,r);if(this._minDistanceFound=o.distance(),this._minDistanceFound<r){this._isValid=!1;var a=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Jc.toLineString(a[0],a[1])+" )"}};il.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};il.prototype.getErrorLocation=function(){return this._errorLocation};il.prototype.getPolygonLines=function(t){for(var n=new Be,r=new as(n),o=vp.getPolygons(t),a=o.iterator();a.hasNext();){var s=a.next();s.apply(r)}return t.getFactory().buildGeometry(n)};il.prototype.getErrorMessage=function(){return this._errMsg};il.prototype.interfaces_=function(){return[]};il.prototype.getClass=function(){return il};tB.VERBOSE.get=function(){return!1};tB.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(il,tB);var hs=function(t,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=r||null},nB={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};hs.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};hs.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*hs.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var n=new ut(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new ut(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};hs.prototype.checkDistance=function(){var t=new il(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};hs.prototype.checkArea=function(){var t=this._input.getArea(),n=this._result.getArea();this._distance>0&&t>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};hs.prototype.checkPolygonal=function(){this._result instanceof xa||this._result instanceof cd||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};hs.prototype.getErrorIndicator=function(){return this._errorIndicator};hs.prototype.getErrorLocation=function(){return this._errorLocation};hs.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};hs.prototype.report=function(t){if(!hs.VERBOSE)return null;cs.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};hs.prototype.getErrorMessage=function(){return this._errorMsg};hs.prototype.interfaces_=function(){return[]};hs.prototype.getClass=function(){return hs};hs.isValidMsg=function(t,n,r){var o=new hs(t,n,r);return o.isValid()?null:o.getErrorMessage()};hs.isValid=function(t,n,r){var o=new hs(t,n,r);return!!o.isValid()};nB.VERBOSE.get=function(){return!1};nB.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(hs,nB);var nh=function(){this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};nh.prototype.getCoordinates=function(){return this._pts};nh.prototype.size=function(){return this._pts.length};nh.prototype.getCoordinate=function(t){return this._pts[t]};nh.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};nh.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:vy.octant(this.getCoordinate(t),this.getCoordinate(t+1))};nh.prototype.setData=function(t){this._data=t};nh.prototype.getData=function(){return this._data};nh.prototype.toString=function(){return Jc.toLineString(new Fo(this._pts))};nh.prototype.interfaces_=function(){return[md]};nh.prototype.getClass=function(){return nh};var Xa=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Be,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Xa.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Xa.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};Xa.prototype.getIntersectionSegments=function(){return this._intSegments};Xa.prototype.count=function(){return this._intersectionCount};Xa.prototype.getIntersections=function(){return this._intersections};Xa.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};Xa.prototype.setKeepIntersections=function(t){this._keepIntersections=t};Xa.prototype.processIntersections=function(t,n,r,o){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&n===o)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(t,n)||this.isEndSegment(r,o);if(!a)return null}var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=u,this._intSegments[2]=l,this._intSegments[3]=c,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Xa.prototype.isEndSegment=function(t,n){return n===0||n>=t.size()-2};Xa.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Xa.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Xa.prototype.interfaces_=function(){return[b0]};Xa.prototype.getClass=function(){return Xa};Xa.createAllIntersectionsFinder=function(t){var n=new Xa(t);return n.setFindAllIntersections(!0),n};Xa.createAnyIntersectionFinder=function(t){return new Xa(t)};Xa.createIntersectionCounter=function(t){var n=new Xa(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var of=function(){this._li=new O0,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};of.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};of.prototype.getIntersections=function(){return this._segInt.getIntersections()};of.prototype.isValid=function(){return this.execute(),this._isValid};of.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};of.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Xa(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new J3;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};of.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Sp(this.getErrorMessage(),this._segInt.getInteriorIntersection())};of.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Jc.toLineString(t[0],t[1])+" and "+Jc.toLineString(t[2],t[3])};of.prototype.interfaces_=function(){return[]};of.prototype.getClass=function(){return of};of.computeIntersections=function(t){var n=new of(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var P0=function e(){this._nv=null;var t=arguments[0];this._nv=new of(e.toSegmentStrings(t))};P0.prototype.checkValid=function(){this._nv.checkValid()};P0.prototype.interfaces_=function(){return[]};P0.prototype.getClass=function(){return P0};P0.toSegmentStrings=function(t){for(var n=new Be,r=t.iterator();r.hasNext();){var o=r.next();n.add(new nh(o.getCoordinates(),o))}return n};P0.checkValid=function(t){var n=new P0(t);n.checkValid()};var Sy=function(t){this._mapOp=t};Sy.prototype.map=function(t){for(var n=this,r=new Be,o=0;o<t.getNumGeometries();o++){var a=n._mapOp.map(t.getGeometryN(o));a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(cn.toGeometryArray(r))};Sy.prototype.interfaces_=function(){return[]};Sy.prototype.getClass=function(){return Sy};Sy.map=function(t,n){var r=new Sy(n);return r.map(t)};var rh=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Be,this._resultLineList=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=r};rh.prototype.collectLines=function(t){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var o=r.next();n.collectLineEdge(o,t,n._lineEdgesList),n.collectBoundaryTouchEdge(o,t,n._lineEdgesList)}};rh.prototype.labelIsolatedLine=function(t,n){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(n));t.getLabel().setLocation(n,r)};rh.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};rh.prototype.collectLineEdge=function(t,n,r){var o=t.getLabel(),a=t.getEdge();t.isLineEdge()&&!t.isVisited()&&qt.isResultOfOp(o,n)&&!a.isCovered()&&(r.add(a),t.setVisitedEdge(!0))};rh.prototype.findCoveredLineEdges=function(){for(var t=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var o=this._op.getGraph().getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getEdge();if(a.isLineEdge()&&!s.isCoveredSet()){var u=t._op.isCoveredByA(a.getCoordinate());s.setCovered(u)}}};rh.prototype.labelIsolatedLines=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();o.isIsolated()&&(a.isNull(0)?n.labelIsolatedLine(o,0):n.labelIsolatedLine(o,1))}};rh.prototype.buildLines=function(t){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var o=r.next(),a=n._geometryFactory.createLineString(o.getCoordinates());n._resultLineList.add(a),o.setInResult(!0)}};rh.prototype.collectBoundaryTouchEdge=function(t,n,r){var o=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;tn.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),qt.isResultOfOp(o,n)&&n===qt.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};rh.prototype.interfaces_=function(){return[]};rh.prototype.getClass=function(){return rh};var Ay=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Be;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n};Ay.prototype.filterCoveredNodeToPoint=function(t){var n=t.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};Ay.prototype.extractNonCoveredResultNodes=function(t){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isInResult()&&!o.isIncidentEdgeInResult()&&(o.getEdges().getDegree()===0||t===qt.INTERSECTION)){var a=o.getLabel();qt.isResultOfOp(a,t)&&n.filterCoveredNodeToPoint(o)}}};Ay.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Ay.prototype.interfaces_=function(){return[]};Ay.prototype.getClass=function(){return Ay};var Bu=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Bu.prototype.transformPoint=function(t,n){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};Bu.prototype.transformPolygon=function(t,n){var r=this,o=!0,a=this.transformLinearRing(t.getExteriorRing(),t);(a===null||!(a instanceof dd)||a.isEmpty())&&(o=!1);for(var s=new Be,u=0;u<t.getNumInteriorRing();u++){var l=r.transformLinearRing(t.getInteriorRingN(u),t);l===null||l.isEmpty()||(l instanceof dd||(o=!1),s.add(l))}if(o)return this._factory.createPolygon(a,s.toArray([]));var c=new Be;return a!==null&&c.add(a),c.addAll(s),this._factory.buildGeometry(c)};Bu.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};Bu.prototype.getInputGeometry=function(){return this._inputGeom};Bu.prototype.transformMultiLineString=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformLineString(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Bu.prototype.transformCoordinates=function(t,n){return this.copy(t)};Bu.prototype.transformLineString=function(t,n){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};Bu.prototype.transformMultiPoint=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformPoint(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Bu.prototype.transformMultiPolygon=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transformPolygon(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Bu.prototype.copy=function(t){return t.copy()};Bu.prototype.transformGeometryCollection=function(t,n){for(var r=this,o=new Be,a=0;a<t.getNumGeometries();a++){var s=r.transform(t.getGeometryN(a));s!==null&&(r._pruneEmptyGeometry&&s.isEmpty()||o.add(s))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(cn.toGeometryArray(o)):this._factory.buildGeometry(o)};Bu.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof sl)return this.transformPoint(t,null);if(t instanceof t1)return this.transformMultiPoint(t,null);if(t instanceof dd)return this.transformLinearRing(t,null);if(t instanceof bo)return this.transformLineString(t,null);if(t instanceof T0)return this.transformMultiLineString(t,null);if(t instanceof xa)return this.transformPolygon(t,null);if(t instanceof cd)return this.transformMultiPolygon(t,null);if(t instanceof iu)return this.transformGeometryCollection(t,null);throw new so("Unknown Geometry subtype: "+t.getClass().getName())};Bu.prototype.transformLinearRing=function(t,n){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var o=r.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};Bu.prototype.interfaces_=function(){return[]};Bu.prototype.getClass=function(){return Bu};var yd=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ct,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof bo&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],o=arguments[1];this._srcPts=r,this._isClosed=e.isClosed(r),this._snapTolerance=o}};yd.prototype.snapVertices=function(t,n){for(var r=this,o=this._isClosed?t.size()-1:t.size(),a=0;a<o;a++){var s=t.get(a),u=r.findSnapForVertex(s,n);u!==null&&(t.set(a,new ae(u)),a===0&&r._isClosed&&t.set(t.size()-1,new ae(u)))}};yd.prototype.findSnapForVertex=function(t,n){for(var r=this,o=0;o<n.length;o++){if(t.equals2D(n[o]))return null;if(t.distance(n[o])<r._snapTolerance)return n[o]}return null};yd.prototype.snapTo=function(t){var n=new GT(this._srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var r=n.toCoordinateArray();return r};yd.prototype.snapSegments=function(t,n){var r=this;if(n.length===0)return null;var o=n.length;n[0].equals2D(n[n.length-1])&&(o=n.length-1);for(var a=0;a<o;a++){var s=n[a],u=r.findSegmentIndexToSnap(s,t);u>=0&&t.add(u+1,new ae(s),!1)}};yd.prototype.findSegmentIndexToSnap=function(t,n){for(var r=this,o=Wt.MAX_VALUE,a=-1,s=0;s<n.size()-1;s++){if(r._seg.p0=n.get(s),r._seg.p1=n.get(s+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var u=r._seg.distance(t);u<r._snapTolerance&&u<o&&(o=u,a=s)}return a};yd.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};yd.prototype.interfaces_=function(){return[]};yd.prototype.getClass=function(){return yd};yd.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var zo=function(t){this._srcGeom=t||null},RX={SNAP_PRECISION_FACTOR:{configurable:!0}};zo.prototype.snapTo=function(t,n){var r=this.extractTargetCoordinates(t),o=new OX(n,r);return o.transform(this._srcGeom)};zo.prototype.snapToSelf=function(t,n){var r=this.extractTargetCoordinates(this._srcGeom),o=new OX(t,r,!0),a=o.transform(this._srcGeom),s=a;return n&&Mt(s,Hm)&&(s=a.buffer(0)),s};zo.prototype.computeSnapTolerance=function(t){var n=this.computeMinimumSegmentLength(t),r=n/10;return r};zo.prototype.extractTargetCoordinates=function(t){for(var n=new Kf,r=t.getCoordinates(),o=0;o<r.length;o++)n.add(r[o]);return n.toArray(new Array(0).fill(null))};zo.prototype.computeMinimumSegmentLength=function(t){for(var n=Wt.MAX_VALUE,r=0;r<t.length-1;r++){var o=t[r].distance(t[r+1]);o<n&&(n=o)}return n};zo.prototype.interfaces_=function(){return[]};zo.prototype.getClass=function(){return zo};zo.snap=function(t,n,r){var o=new Array(2).fill(null),a=new zo(t);o[0]=a.snapTo(n,r);var s=new zo(n);return o[1]=s.snapTo(o[0],r),o};zo.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=zo.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===kr.FIXED){var o=1/r.getScale()*2/1.415;o>n&&(n=o)}return n}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return Math.min(zo.computeOverlaySnapTolerance(a),zo.computeOverlaySnapTolerance(s))}};zo.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),o=r*zo.SNAP_PRECISION_FACTOR;return o};zo.snapToSelf=function(t,n,r){var o=new zo(t);return o.snapToSelf(n,r)};RX.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(zo,RX);var OX=function(e){function t(n,r,o){e.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=o!==void 0?o:!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,o){var a=new yd(r,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(o)},t.prototype.transformCoordinates=function(r,o){var a=r.toCoordinateArray(),s=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(s)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Bu),Js=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Js.prototype.getCommon=function(){return Wt.longBitsToDouble(this._commonBits)};Js.prototype.add=function(t){var n=Wt.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=Js.signExpBits(this._commonBits),this._isFirst=!1,null;var r=Js.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Js.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=Js.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};Js.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],n=Wt.longBitsToDouble(t),r=Wt.toBinaryString(t),o="0000000000000000000000000000000000000000000000000000000000000000"+r,a=o.substring(o.length-64),s=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+n+" ]";return s}};Js.prototype.interfaces_=function(){return[]};Js.prototype.getClass=function(){return Js};Js.getBit=function(t,n){var r=1<<n;return(t&r)!==0?1:0};Js.signExpBits=function(t){return t>>52};Js.zeroLowerBits=function(t,n){var r=(1<<n)-1,o=~r,a=t&o;return a};Js.numCommonMostSigMantissaBits=function(t,n){for(var r=0,o=52;o>=0;o--){if(Js.getBit(t,o)!==Js.getBit(n,o))return r;r++}return 52};var Zm=function(){this._commonCoord=null,this._ccFilter=new by},rB={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Zm.prototype.addCommonBits=function(t){var n=new Qm(this._commonCoord);t.apply(n),t.geometryChanged()};Zm.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var n=new ae(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new Qm(n);return t.apply(r),t.geometryChanged(),t};Zm.prototype.getCommonCoordinate=function(){return this._commonCoord};Zm.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Zm.prototype.interfaces_=function(){return[]};Zm.prototype.getClass=function(){return Zm};rB.CommonCoordinateFilter.get=function(){return by};rB.Translater.get=function(){return Qm};Object.defineProperties(Zm,rB);var by=function(){this._commonBitsX=new Js,this._commonBitsY=new Js};by.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};by.prototype.getCommonCoordinate=function(){return new ae(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};by.prototype.interfaces_=function(){return[hd]};by.prototype.getClass=function(){return by};var Qm=function(){this.trans=null;var t=arguments[0];this.trans=t};Qm.prototype.filter=function(t,n){var r=t.getOrdinate(n,0)+this.trans.x,o=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,r),t.setOrdinate(n,1,o)};Qm.prototype.isDone=function(){return!1};Qm.prototype.isGeometryChanged=function(){return!0};Qm.prototype.interfaces_=function(){return[$c]};Qm.prototype.getClass=function(){return Qm};var ja=function(t,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()};ja.prototype.selfSnap=function(t){var n=new zo(t),r=n.snapTo(t,this._snapTolerance);return r};ja.prototype.removeCommonBits=function(t){this._cbr=new Zm,this._cbr.add(t[0]),this._cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t[0].copy()),n[1]=this._cbr.removeCommonBits(t[1].copy()),n};ja.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};ja.prototype.getResultGeometry=function(t){var n=this.snap(this._geom),r=qt.overlayOp(n[0],n[1],t);return this.prepareResult(r)};ja.prototype.checkValid=function(t){t.isValid()||cs.out.println("Snapped geometry is invalid")};ja.prototype.computeSnapTolerance=function(){this._snapTolerance=zo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};ja.prototype.snap=function(t){var n=this.removeCommonBits(t),r=zo.snap(n[0],n[1],this._snapTolerance);return r};ja.prototype.interfaces_=function(){return[]};ja.prototype.getClass=function(){return ja};ja.overlayOp=function(t,n,r){var o=new ja(t,n);return o.getResultGeometry(r)};ja.union=function(t,n){return ja.overlayOp(t,n,qt.UNION)};ja.intersection=function(t,n){return ja.overlayOp(t,n,qt.INTERSECTION)};ja.symDifference=function(t,n){return ja.overlayOp(t,n,qt.SYMDIFFERENCE)};ja.difference=function(t,n){return ja.overlayOp(t,n,qt.DIFFERENCE)};var su=function(t,n){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n};su.prototype.getResultGeometry=function(t){var n=null,r=!1,o=null;try{n=qt.overlayOp(this._geom[0],this._geom[1],t);var a=!0;a&&(r=!0)}catch(s){if(s instanceof Ep)o=s;else throw s}finally{}if(!r)try{n=ja.overlayOp(this._geom[0],this._geom[1],t)}catch(s){throw s instanceof Ep?o:s}finally{}return n};su.prototype.interfaces_=function(){return[]};su.prototype.getClass=function(){return su};su.overlayOp=function(t,n,r){var o=new su(t,n);return o.getResultGeometry(r)};su.union=function(t,n){return su.overlayOp(t,n,qt.UNION)};su.intersection=function(t,n){return su.overlayOp(t,n,qt.INTERSECTION)};su.symDifference=function(t,n){return su.overlayOp(t,n,qt.SYMDIFFERENCE)};su.difference=function(t,n){return su.overlayOp(t,n,qt.DIFFERENCE)};var PT=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n};PT.prototype.computeIntersections=function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)};PT.prototype.interfaces_=function(){return[]};PT.prototype.getClass=function(){return PT};var cl=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._eventType=e.INSERT,this._label=r,this._xValue=o,this._obj=a}},iB={INSERT:{configurable:!0},DELETE:{configurable:!0}};cl.prototype.isDelete=function(){return this._eventType===cl.DELETE};cl.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};cl.prototype.getObject=function(){return this._obj};cl.prototype.compareTo=function(t){var n=t;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};cl.prototype.getInsertEvent=function(){return this._insertEvent};cl.prototype.isInsert=function(){return this._eventType===cl.INSERT};cl.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};cl.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};cl.prototype.interfaces_=function(){return[wc]};cl.prototype.getClass=function(){return cl};iB.INSERT.get=function(){return 1};iB.DELETE.get=function(){return 2};Object.defineProperties(cl,iB);var tP=function(){};tP.prototype.interfaces_=function(){return[]};tP.prototype.getClass=function(){return tP};var ds=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=r};ds.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(ds.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.getNumPoints()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};ds.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ds.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};ds.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ds.prototype.isBoundaryPointInternal=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next(),a=o.getCoordinate();if(t.isIntersection(a))return!0}return!1};ds.prototype.hasProperIntersection=function(){return this._hasProper};ds.prototype.hasIntersection=function(){return this._hasIntersection};ds.prototype.isDone=function(){return this._isDone};ds.prototype.isBoundaryPoint=function(t,n){return n===null?!1:!!(this.isBoundaryPointInternal(t,n[0])||this.isBoundaryPointInternal(t,n[1]))};ds.prototype.setBoundaryNodes=function(t,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=n};ds.prototype.addIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};ds.prototype.interfaces_=function(){return[]};ds.prototype.getClass=function(){return ds};ds.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var Exe=function(e){function t(){e.call(this),this.events=new Be,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;tf.sort(this.events);for(var o=0;o<this.events.size();o++){var a=r.events.get(o);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(o)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var o=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var s=r.events.get(a);if(s.isInsert()&&r.processOverlaps(a,s.getDeleteEventIndex(),s,o),o.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof ds&&Mt(arguments[0],Qc)&&Mt(arguments[1],Qc)){var u=arguments[0],l=arguments[1],c=arguments[2];this.addEdges(u,u),this.addEdges(l,l),this.computeIntersections(c)}else if(typeof arguments[2]=="boolean"&&Mt(arguments[0],Qc)&&arguments[1]instanceof ds){var f=arguments[0],h=arguments[1],d=arguments[2];d?this.addEdges(f,null):this.addEdges(f),this.computeIntersections(h)}}},t.prototype.addEdge=function(r,o){for(var a=this,s=r.getMonotoneChainEdge(),u=s.getStartIndexes(),l=0;l<u.length-1;l++){var c=new PT(s,l),f=new cl(o,s.getMinX(l),c);a.events.add(f),a.events.add(new cl(s.getMaxX(l),f))}},t.prototype.processOverlaps=function(r,o,a,s){for(var u=this,l=a.getObject(),c=r;c<o;c++){var f=u.events.get(c);if(f.isInsert()){var h=f.getObject();a.isSameLabel(f)||(l.computeIntersections(h,s),u.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var o=arguments[0],a=o.iterator();a.hasNext();){var s=a.next();r.addEdge(s,s)}else if(arguments.length===2)for(var u=arguments[0],l=arguments[1],c=u.iterator();c.hasNext();){var f=c.next();r.addEdge(f,l)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(tP),vd=function(){this._min=Wt.POSITIVE_INFINITY,this._max=Wt.NEGATIVE_INFINITY},NX={NodeComparator:{configurable:!0}};vd.prototype.getMin=function(){return this._min};vd.prototype.intersects=function(t,n){return!(this._min>n||this._max<t)};vd.prototype.getMax=function(){return this._max};vd.prototype.toString=function(){return Jc.toLineString(new ae(this._min,0),new ae(this._max,0))};vd.prototype.interfaces_=function(){return[]};vd.prototype.getClass=function(){return vd};NX.NodeComparator.get=function(){return MT};Object.defineProperties(vd,NX);var MT=function(){};MT.prototype.compare=function(t,n){var r=t,o=n,a=(r._min+r._max)/2,s=(o._min+o._max)/2;return a<s?-1:a>s?1:0};MT.prototype.interfaces_=function(){return[jC]};MT.prototype.getClass=function(){return MT};var Txe=function(e){function t(){e.call(this),this._item=null;var n=arguments[0],r=arguments[1],o=arguments[2];this._min=n,this._max=r,this._item=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;a.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(vd),Sxe=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,o){this._min=Math.min(r._min,o._min),this._max=Math.max(r._max,o._max)},t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;this._node1!==null&&this._node1.query(r,o,a),this._node2!==null&&this._node2.query(r,o,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(vd),Cd=function(){this._leaves=new Be,this._root=null,this._level=0};Cd.prototype.buildTree=function(){var t=this;tf.sort(this._leaves,new vd.NodeComparator);for(var n=this._leaves,r=null,o=new Be;;){if(t.buildLevel(n,o),o.size()===1)return o.get(0);r=n,n=o,o=r}};Cd.prototype.insert=function(t,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Txe(t,n,r))};Cd.prototype.query=function(t,n,r){this.init(),this._root.query(t,n,r)};Cd.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Cd.prototype.printNode=function(t){cs.out.println(Jc.toLineString(new ae(t._min,this._level),new ae(t._max,this._level)))};Cd.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Cd.prototype.buildLevel=function(t,n){this._level++,n.clear();for(var r=0;r<t.size();r+=2){var o=t.get(r),a=r+1<t.size()?t.get(r):null;if(a===null)n.add(o);else{var s=new Sxe(t.get(r),t.get(r+1));n.add(s)}}};Cd.prototype.interfaces_=function(){return[]};Cd.prototype.getClass=function(){return Cd};var s1=function(){this._items=new Be};s1.prototype.visitItem=function(t){this._items.add(t)};s1.prototype.getItems=function(){return this._items};s1.prototype.interfaces_=function(){return[qm]};s1.prototype.getClass=function(){return s1};var u1=function(){this._index=null;var t=arguments[0];if(!Mt(t,Hm))throw new so("Argument must be Polygonal");this._index=new M0(t)},oB={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};u1.prototype.locate=function(t){var n=new Yf(t),r=new l1(n);return this._index.query(t.y,t.y,r),n.getLocation()};u1.prototype.interfaces_=function(){return[o1]};u1.prototype.getClass=function(){return u1};oB.SegmentVisitor.get=function(){return l1};oB.IntervalIndexedGeometry.get=function(){return M0};Object.defineProperties(u1,oB);var l1=function(){this._counter=null;var t=arguments[0];this._counter=t};l1.prototype.visitItem=function(t){var n=t;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};l1.prototype.interfaces_=function(){return[qm]};l1.prototype.getClass=function(){return l1};var M0=function(){this._index=new Cd;var t=arguments[0];this.init(t)};M0.prototype.init=function(t){for(var n=this,r=as.getLines(t),o=r.iterator();o.hasNext();){var a=o.next(),s=a.getCoordinates();n.addLine(s)}};M0.prototype.addLine=function(t){for(var n=this,r=1;r<t.length;r++){var o=new ct(t[r-1],t[r]),a=Math.min(o.p0.y,o.p1.y),s=Math.max(o.p0.y,o.p1.y);n._index.insert(a,s,o)}};M0.prototype.query=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new s1;return this._index.query(t,n,r),r.getItems()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this._index.query(o,a,s)}};M0.prototype.interfaces_=function(){return[]};M0.prototype.getClass=function(){return M0};var $E=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new vX,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new rf,arguments.length===2){var n=arguments[0],r=arguments[1],o=vc.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=o,r!==null&&this.add(r)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this._argIndex=a,this._parentGeom=s,this._boundaryNodeRule=u,s!==null&&this.add(s)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,o){var a=this._nodes.addNode(o),s=a.getLabel(),u=1,l=he.NONE;l=s.getLocation(r,Pe.ON),l===he.BOUNDARY&&u++;var c=t.determineBoundary(this._boundaryNodeRule,u);s.setLocation(r,c)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.computeSelfNodes(r,o,!1)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2],l=new ds(a,!0,!1);l.setIsDoneIfProperInt(u);var c=this.createEdgeSetIntersector(),f=this._parentGeom instanceof dd||this._parentGeom instanceof xa||this._parentGeom instanceof cd,h=s||!f;return c.computeIntersections(this._edges,l,h),this.addSelfIntersectionNodes(this._argIndex),l}},t.prototype.computeSplitEdges=function(r){for(var o=this._edges.iterator();o.hasNext();){var a=o.next();a.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,o,a){var s=new ds(o,a,!0);s.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var u=this.createEdgeSetIntersector();return u.computeIntersections(this._edges,r._edges,s),s},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof sl){var r=arguments[0],o=r.getCoordinate();this.insertPoint(this._argIndex,o,he.INTERIOR)}else if(arguments[0]instanceof ae){var a=arguments[0];this.insertPoint(this._argIndex,a,he.INTERIOR)}},t.prototype.addPolygon=function(r){var o=this;this.addPolygonRing(r.getExteriorRing(),he.EXTERIOR,he.INTERIOR);for(var a=0;a<r.getNumInteriorRing();a++){var s=r.getInteriorRingN(a);o.addPolygonRing(s,he.INTERIOR,he.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var o=r.getCoordinates();this.insertPoint(this._argIndex,o[0],he.BOUNDARY),this.insertPoint(this._argIndex,o[o.length-1],he.BOUNDARY)},t.prototype.addLineString=function(r){var o=fn.removeRepeatedPoints(r.getCoordinates());if(o.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var a=new eP(o,new ni(this._argIndex,he.INTERIOR));this._lineEdgeMap.put(r,a),this.insertEdge(a),tn.isTrue(o.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,o[0]),this.insertBoundaryPoint(this._argIndex,o[o.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),o=new Array(r.size()).fill(null),a=0,s=r.iterator();s.hasNext();){var u=s.next();o[a++]=u.getCoordinate().copy()}return o},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,o,a){if(this.isBoundaryNode(r,o))return null;a===he.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,o):this.insertPoint(r,o,a)},t.prototype.addPolygonRing=function(r,o,a){if(r.isEmpty())return null;var s=fn.removeRepeatedPoints(r.getCoordinates());if(s.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var u=o,l=a;Ue.isCCW(s)&&(u=a,l=o);var c=new eP(s,new ni(this._argIndex,he.BOUNDARY,u,l));this._lineEdgeMap.put(r,c),this.insertEdge(c),this.insertPoint(this._argIndex,s[0],he.BOUNDARY)},t.prototype.insertPoint=function(r,o,a){var s=this._nodes.addNode(o),u=s.getLabel();u===null?s._label=new ni(r,a):u.setLocation(r,a)},t.prototype.createEdgeSetIntersector=function(){return new Exe},t.prototype.addSelfIntersectionNodes=function(r){for(var o=this,a=this._edges.iterator();a.hasNext();)for(var s=a.next(),u=s.getLabel().getLocation(r),l=s.eiList.iterator();l.hasNext();){var c=l.next();o.addSelfIntersectionNode(r,c.coord,u)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof cd&&(this._useBoundaryDeterminationRule=!1),r instanceof xa)this.addPolygon(r);else if(r instanceof bo)this.addLineString(r);else if(r instanceof sl)this.addPoint(r);else if(r instanceof t1)this.addCollection(r);else if(r instanceof T0)this.addCollection(r);else if(r instanceof cd)this.addCollection(r);else if(r instanceof iu)this.addCollection(r);else throw new Error(r.getClass().getName())}else return e.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var o=this,a=0;a<r.getNumGeometries();a++){var s=r.getGeometryN(a);o.add(s)}},t.prototype.locate=function(r){return Mt(this._parentGeom,Hm)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new u1(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,o){return r.isInBoundary(o)?he.BOUNDARY:he.INTERIOR},t}(vo),c1=function(){if(this._li=new O0,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new $E(0,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=vc.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $E(0,n,o),this._arg[1]=new $E(1,r,o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];a.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new $E(0,a,u),this._arg[1]=new $E(1,s,u)}};c1.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};c1.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};c1.prototype.interfaces_=function(){return[]};c1.prototype.getClass=function(){return c1};var x0=function(){};x0.prototype.interfaces_=function(){return[]};x0.prototype.getClass=function(){return x0};x0.map=function(){if(arguments[0]instanceof It&&Mt(arguments[1],x0.MapOp)){for(var t=arguments[0],n=arguments[1],r=new Be,o=0;o<t.getNumGeometries();o++){var a=n.map(t.getGeometryN(o));a!==null&&r.add(a)}return t.getFactory().buildGeometry(r)}else if(Mt(arguments[0],ya)&&Mt(arguments[1],x0.MapOp)){for(var s=arguments[0],u=arguments[1],l=new Be,c=s.iterator();c.hasNext();){var f=c.next(),h=u.map(f);h!==null&&l.add(h)}return l}};x0.MapOp=function(){};var qt=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r),this._ptLocator=new rf,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new nf,this._resultPolyList=new Be,this._resultLineList=new Be,this._resultPointList=new Be,this._graph=new vo(new AX),this._geomFact=n.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var o=this._edgeList.findEqualEdge(r);if(o!==null){var a=o.getLabel(),s=r.getLabel();o.isPointwiseEqual(r)||(s=new ni(r.getLabel()),s.flip());var u=o.getDepth();u.isNull()&&u.add(a),u.add(s),a.merge(s)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var o=r.next(),a=o.getSym();o.isInResult()&&a.isInResult()&&(o.setInResult(!1),a.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,o,a,s){var u=new Be;return u.addAll(r),u.addAll(o),u.addAll(a),u.isEmpty()?t.createEmptyResult(s,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(u)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next();o.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,o){for(var a=this,s=o.iterator();s.hasNext();){var u=s.next(),l=a._ptLocator.locate(r,u);if(l!==he.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new Be,o=this._edgeList.iterator();o.hasNext();){var a=o.next();a.isCollapsed()&&(o.remove(),r.add(a.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next(),a=o.getEdges().getLabel();o.getLabel().merge(a)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var o=this,a=r.iterator();a.hasNext();){var s=a.next();o.insertUniqueEdge(s)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var o=new Be;this._arg[0].computeSplitEdges(o),this._arg[1].computeSplitEdges(o),this.insertUniqueEdges(o),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),P0.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var a=new ul(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var s=new rh(this,this._geomFact,this._ptLocator);this._resultLineList=s.build(r);var u=new Ay(this,this._geomFact,this._ptLocator);this._resultPointList=u.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,o){var a=this._ptLocator.locate(r.getCoordinate(),this._arg[o].getGeometry());r.getLabel().setLocation(o,a)},t.prototype.copyPoints=function(r){for(var o=this,a=this._arg[r].getNodeIterator();a.hasNext();){var s=a.next(),u=o._graph.addNode(s.getCoordinate());u.setLabel(r,s.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var o=this._graph.getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.isArea()&&!a.isInteriorAreaEdge()&&t.isResultOfOp(s.getLocation(0,Pe.RIGHT),s.getLocation(1,Pe.RIGHT),r)&&a.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var o=r.next(),a=o.getLabel(),s=o.getDepth();if(!s.isNull()){s.normalize();for(var u=0;u<2;u++)!a.isNull(u)&&a.isArea()&&!s.isNull(u)&&(s.getDelta(u)===0?a.toLine(u):(tn.isTrue(!s.isNull(u,Pe.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(u,Pe.LEFT,s.getLocation(u,Pe.LEFT)),tn.isTrue(!s.isNull(u,Pe.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(u,Pe.RIGHT,s.getLocation(u,Pe.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next();a.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();a.isIsolated()&&(s.isNull(0)?r.labelIncompleteNode(a,0):r.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(s)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(c1);qt.overlayOp=function(e,t,n){var r=new qt(e,t),o=r.getResultGeometry(n);return o};qt.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return qt.createEmptyResult(qt.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return Sy.map(e,{interfaces_:function(){return[x0.MapOp]},map:function(r){return r.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),su.overlayOp(e,t,qt.INTERSECTION)};qt.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return qt.createEmptyResult(qt.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),su.overlayOp(e,t,qt.SYMDIFFERENCE)};qt.resultDimension=function(e,t,n){var r=t.getDimension(),o=n.getDimension(),a=-1;switch(e){case qt.INTERSECTION:a=Math.min(r,o);break;case qt.UNION:a=Math.max(r,o);break;case qt.DIFFERENCE:a=r;break;case qt.SYMDIFFERENCE:a=Math.max(r,o);break;default:}return a};qt.createEmptyResult=function(e,t,n,r){var o=null;switch(qt.resultDimension(e,t,n)){case-1:o=r.createGeometryCollection(new Array(0).fill(null));break;case 0:o=r.createPoint();break;case 1:o=r.createLineString();break;case 2:o=r.createPolygon();break;default:}return o};qt.difference=function(e,t){return e.isEmpty()?qt.createEmptyResult(qt.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),su.overlayOp(e,t,qt.DIFFERENCE))};qt.isResultOfOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=e.getLocation(0),r=e.getLocation(1);return qt.isResultOfOp(n,r,t)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];switch(o===he.BOUNDARY&&(o=he.INTERIOR),a===he.BOUNDARY&&(a=he.INTERIOR),s){case qt.INTERSECTION:return o===he.INTERIOR&&a===he.INTERIOR;case qt.UNION:return o===he.INTERIOR||a===he.INTERIOR;case qt.DIFFERENCE:return o===he.INTERIOR&&a!==he.INTERIOR;case qt.SYMDIFFERENCE:return o===he.INTERIOR&&a!==he.INTERIOR||o!==he.INTERIOR&&a===he.INTERIOR;default:}return!1}};qt.INTERSECTION=1;qt.UNION=2;qt.DIFFERENCE=3;qt.SYMDIFFERENCE=4;var Gm=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new rf,this._seg=new ct;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)};Gm.prototype.isWithinToleranceOfBoundary=function(t){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var o=n._linework.getGeometryN(r),a=o.getCoordinateSequence(),s=0;s<a.size()-1;s++){a.getCoordinate(s,n._seg.p0),a.getCoordinate(s+1,n._seg.p1);var u=n._seg.distance(t);if(u<=n._boundaryDistanceTolerance)return!0}return!1};Gm.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?he.BOUNDARY:this._ptLocator.locate(t,this._g)};Gm.prototype.extractLinework=function(t){var n=new f1;t.apply(n);var r=n.getLinework(),o=cn.toLineStringArray(r);return t.getFactory().createMultiLineString(o)};Gm.prototype.interfaces_=function(){return[]};Gm.prototype.getClass=function(){return Gm};var f1=function(){this._linework=null,this._linework=new Be};f1.prototype.getLinework=function(){return this._linework};f1.prototype.filter=function(t){var n=this;if(t instanceof xa){var r=t;this._linework.add(r.getExteriorRing());for(var o=0;o<r.getNumInteriorRing();o++)n._linework.add(r.getInteriorRingN(o))}};f1.prototype.interfaces_=function(){return[Zf]};f1.prototype.getClass=function(){return f1};var L0=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};L0.prototype.extractPoints=function(t,n,r){for(var o=this,a=t.getCoordinates(),s=0;s<a.length-1;s++)o.computeOffsetPoints(a[s],a[s+1],n,r)};L0.prototype.setSidesToGenerate=function(t,n){this._doLeft=t,this._doRight=n};L0.prototype.getPoints=function(t){for(var n=this,r=new Be,o=as.getLines(this._g),a=o.iterator();a.hasNext();){var s=a.next();n.extractPoints(s,t,r)}return r};L0.prototype.computeOffsetPoints=function(t,n,r,o){var a=n.x-t.x,s=n.y-t.y,u=Math.sqrt(a*a+s*s),l=r*a/u,c=r*s/u,f=(n.x+t.x)/2,h=(n.y+t.y)/2;if(this._doLeft){var d=new ae(f-c,h+l);o.add(d)}if(this._doRight){var p=new ae(f+c,h-l);o.add(p)}};L0.prototype.interfaces_=function(){return[]};L0.prototype.getClass=function(){return L0};var Gl=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Be;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,r],this._locFinder=[new Gm(this._geom[0],this._boundaryDistanceTolerance),new Gm(this._geom[1],this._boundaryDistanceTolerance),new Gm(this._geom[2],this._boundaryDistanceTolerance)]},BX={TOLERANCE:{configurable:!0}};Gl.prototype.reportResult=function(t,n,r){cs.out.println("Overlay result invalid - A:"+he.toLocationSymbol(n[0])+" B:"+he.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+he.toLocationSymbol(n[2]))};Gl.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(t);return n};Gl.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var o=t._testCoords.get(r);if(!t.checkValid(n,o))return t._invalidLocation=o,!1}return!0}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),Gl.hasLocation(this._location,he.BOUNDARY)?!0:this.isValidResult(a,this._location)}};Gl.prototype.addTestPts=function(t){var n=new L0(t);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};Gl.prototype.isValidResult=function(t,n){var r=qt.isResultOfOp(n[0],n[1],t),o=n[2]===he.INTERIOR,a=!(r^o);return a||this.reportResult(t,n,r),a};Gl.prototype.getInvalidLocation=function(){return this._invalidLocation};Gl.prototype.interfaces_=function(){return[]};Gl.prototype.getClass=function(){return Gl};Gl.hasLocation=function(t,n){for(var r=0;r<3;r++)if(t[r]===n)return!0;return!1};Gl.computeBoundaryDistanceTolerance=function(t,n){return Math.min(zo.computeSizeBasedSnapTolerance(t),zo.computeSizeBasedSnapTolerance(n))};Gl.isValid=function(t,n,r,o){var a=new Gl(t,n,o);return a.isValid(r)};BX.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(Gl,BX);var Rl=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};Rl.prototype.extractElements=function(t,n){var r=this;if(t===null)return null;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);r._skipEmpty&&a.isEmpty()||n.add(a)}};Rl.prototype.combine=function(){for(var t=this,n=new Be,r=this._inputGeoms.iterator();r.hasNext();){var o=r.next();t.extractElements(o,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};Rl.prototype.interfaces_=function(){return[]};Rl.prototype.getClass=function(){return Rl};Rl.combine=function(){if(arguments.length===1){var t=arguments[0],n=new Rl(t);return n.combine()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new Rl(Rl.createList(r,o));return a.combine()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2],c=new Rl(Rl.createList(s,u,l));return c.combine()}};Rl.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};Rl.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Be;return r.add(t),r.add(n),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Be;return u.add(o),u.add(a),u.add(s),u}};var na=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new Be)},FX={STRTREE_NODE_CAPACITY:{configurable:!0}};na.prototype.reduceToGeometries=function(t){for(var n=this,r=new Be,o=t.iterator();o.hasNext();){var a=o.next(),s=null;Mt(a,Qc)?s=n.unionTree(a):a instanceof It&&(s=a),r.add(s)}return r};na.prototype.extractByEnvelope=function(t,n,r){for(var o=new Be,a=0;a<n.getNumGeometries();a++){var s=n.getGeometryN(a);s.getEnvelopeInternal().intersects(t)?o.add(s):r.add(s)}return this._geomFactory.buildGeometry(o)};na.prototype.unionOptimized=function(t,n){var r=t.getEnvelopeInternal(),o=n.getEnvelopeInternal();if(!r.intersects(o)){var a=Rl.combine(t,n);return a}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var s=r.intersection(o);return this.unionUsingEnvelopeIntersection(t,n,s)};na.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new wX(na.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var o=t.itemsTree(),a=this.unionTree(o);return a};na.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2];if(o-r<=1){var a=na.getGeometry(n,r);return this.unionSafe(a,null)}else{if(o-r===2)return this.unionSafe(na.getGeometry(n,r),na.getGeometry(n,r+1));var s=Math.trunc((o+r)/2),u=this.binaryUnion(n,r,s),l=this.binaryUnion(n,s,o);return this.unionSafe(u,l)}}};na.prototype.repeatedUnion=function(t){for(var n=null,r=t.iterator();r.hasNext();){var o=r.next();n===null?n=o.copy():n=n.union(o)}return n};na.prototype.unionSafe=function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)};na.prototype.unionActual=function(t,n){return na.restrictToPolygons(t.union(n))};na.prototype.unionTree=function(t){var n=this.reduceToGeometries(t),r=this.binaryUnion(n);return r};na.prototype.unionUsingEnvelopeIntersection=function(t,n,r){var o=new Be,a=this.extractByEnvelope(r,t,o),s=this.extractByEnvelope(r,n,o),u=this.unionActual(a,s);o.add(u);var l=Rl.combine(o);return l};na.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),r=n.buildGeometry(t),o=r.buffer(0);return o}else if(arguments.length===2){var a=arguments[0],s=arguments[1],u=a.getFactory(),l=u.createGeometryCollection([a,s]),c=l.buffer(0);return c}};na.prototype.interfaces_=function(){return[]};na.prototype.getClass=function(){return na};na.restrictToPolygons=function(t){if(Mt(t,Hm))return t;var n=vp.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(cn.toPolygonArray(n))};na.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)};na.union=function(t){var n=new na(t);return n.union()};FX.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(na,FX);var LT=function(){};LT.prototype.interfaces_=function(){return[]};LT.prototype.getClass=function(){return LT};LT.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return qt.createEmptyResult(qt.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),su.overlayOp(t,n,qt.UNION)};function Axe(e,t){var n=Bl(e),r=Bl(t),o=e.properties||{};if(n=P7(n),r=P7(r),!n)return null;if(!r)return ra(n,o);var a=new x1,s=a.read(n),u=a.read(r),l=qt.difference(s,u);if(l.isEmpty())return null;var c=new HT,f=c.write(l);return ra(f,o)}function P7(e){switch(e.type){case"Polygon":return mT(e)>1?e:null;case"MultiPolygon":var t=[];if(ko(e,function(n){mT(n)>1&&t.push(n.geometry.coordinates)}),t.length)return{type:"MultiPolygon",coordinates:t}}}var N0=function(){return new nP};function nP(){this.reset()}nP.prototype={constructor:nP,reset:function(){this.s=this.t=0},add:function(e){M7(MD,e,this.t),M7(this,MD.s,this.s),this.s?this.t+=MD.t:this.s=MD.t},valueOf:function(){return this.s}};var MD=new nP;function M7(e,t,n){var r=e.s=t+n,o=r-t,a=r-o;e.t=t-a+(n-o)}var Ao=1e-6,Si=Math.PI,mc=Si/2,L7=Si/4,Ip=Si*2,Hf=180/Si,Ps=Si/180,tu=Math.abs,aB=Math.atan,RT=Math.atan2,ss=Math.cos,zX=Math.exp,VX=Math.log,Ls=Math.sin,RP=Math.sqrt,kX=Math.tan;function bxe(e){return e>1?0:e<-1?Si:Math.acos(e)}function OT(e){return e>1?mc:e<-1?-mc:Math.asin(e)}function sT(){}function rP(e,t){e&&O7.hasOwnProperty(e.type)&&O7[e.type](e,t)}var R7={Feature:function(e,t){rP(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,o=n.length;++r<o;)rP(n[r].geometry,t)}},O7={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){c3(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)c3(n[r],t,0)},Polygon:function(e,t){N7(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)N7(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,o=n.length;++r<o;)rP(n[r],t)}};function c3(e,t,n){var r=-1,o=e.length-n,a;for(t.lineStart();++r<o;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function N7(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)c3(e[n],t,1);t.polygonEnd()}var Ixe=function(e,t){e&&R7.hasOwnProperty(e.type)?R7[e.type](e,t):rP(e,t)},d0t=N0(),p0t=N0();function f3(e){return[RT(e[1],e[0]),OT(e[2])]}function h1(e){var t=e[0],n=e[1],r=ss(n);return[r*ss(t),r*Ls(t),Ls(n)]}function LD(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function iP(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function X2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function RD(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function h3(e){var t=RP(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var m0t=N0(),GX=function(e,t){function n(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,o){return r=t.invert(r,o),r&&e.invert(r[0],r[1])}),n};function d3(e,t){return[e>Si?e-Ip:e<-Si?e+Ip:e,t]}d3.invert=d3;function UX(e,t,n){return(e%=Ip)?t||n?GX(F7(e),z7(t,n)):F7(e):t||n?z7(t,n):d3}function B7(e){return function(t,n){return t+=e,[t>Si?t-Ip:t<-Si?t+Ip:t,n]}}function F7(e){var t=B7(e);return t.invert=B7(-e),t}function z7(e,t){var n=ss(e),r=Ls(e),o=ss(t),a=Ls(t);function s(u,l){var c=ss(l),f=ss(u)*c,h=Ls(u)*c,d=Ls(l),p=d*n+f*r;return[RT(h*o-p*a,f*n-d*r),OT(p*o+h*a)]}return s.invert=function(u,l){var c=ss(l),f=ss(u)*c,h=Ls(u)*c,d=Ls(l),p=d*o-h*a;return[RT(h*o+d*a,f*n+p*r),OT(p*n-f*r)]},s}var Dxe=function(e){e=UX(e[0]*Ps,e[1]*Ps,e.length>2?e[2]*Ps:0);function t(n){return n=e(n[0]*Ps,n[1]*Ps),n[0]*=Hf,n[1]*=Hf,n}return t.invert=function(n){return n=e.invert(n[0]*Ps,n[1]*Ps),n[0]*=Hf,n[1]*=Hf,n},t};function Pxe(e,t,n,r,o,a){if(!!n){var s=ss(t),u=Ls(t),l=r*n;o==null?(o=t+r*Ip,a=t-l/2):(o=V7(s,o),a=V7(s,a),(r>0?o<a:o>a)&&(o+=r*Ip));for(var c,f=o;r>0?f>a:f<a;f-=l)c=f3([s,-u*ss(f),-u*Ls(f)]),e.point(c[0],c[1])}}function V7(e,t){t=h1(t),t[0]-=e,h3(t);var n=bxe(-t[1]);return((-t[2]<0?-n:n)+Ip-Ao)%Ip}var HX=function(){var e=[],t;return{point:function(n,r){t.push([n,r])},lineStart:function(){e.push(t=[])},lineEnd:sT,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Mxe=function(e,t,n,r,o,a){var s=e[0],u=e[1],l=t[0],c=t[1],f=0,h=1,d=l-s,p=c-u,g;if(g=n-s,!(!d&&g>0)){if(g/=d,d<0){if(g<f)return;g<h&&(h=g)}else if(d>0){if(g>h)return;g>f&&(f=g)}if(g=o-s,!(!d&&g<0)){if(g/=d,d<0){if(g>h)return;g>f&&(f=g)}else if(d>0){if(g<f)return;g<h&&(h=g)}if(g=r-u,!(!p&&g>0)){if(g/=p,p<0){if(g<f)return;g<h&&(h=g)}else if(p>0){if(g>h)return;g>f&&(f=g)}if(g=a-u,!(!p&&g<0)){if(g/=p,p<0){if(g>h)return;g>f&&(f=g)}else if(p>0){if(g<f)return;g<h&&(h=g)}return f>0&&(e[0]=s+f*d,e[1]=u+f*p),h<1&&(t[0]=s+h*d,t[1]=u+h*p),!0}}}}},VD=function(e,t){return tu(e[0]-t[0])<Ao&&tu(e[1]-t[1])<Ao};function OD(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var qX=function(e,t,n,r,o){var a=[],s=[],u,l;if(e.forEach(function(g){if(!((y=g.length-1)<=0)){var y,v=g[0],w=g[y],C;if(VD(v,w)){for(o.lineStart(),u=0;u<y;++u)o.point((v=g[u])[0],v[1]);o.lineEnd();return}a.push(C=new OD(v,g,null,!0)),s.push(C.o=new OD(v,null,C,!1)),a.push(C=new OD(w,g,null,!1)),s.push(C.o=new OD(w,null,C,!0))}}),!!a.length){for(s.sort(t),k7(a),k7(s),u=0,l=s.length;u<l;++u)s[u].e=n=!n;for(var c=a[0],f,h;;){for(var d=c,p=!0;d.v;)if((d=d.n)===c)return;f=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(u=0,l=f.length;u<l;++u)o.point((h=f[u])[0],h[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(f=d.p.z,u=f.length-1;u>=0;--u)o.point((h=f[u])[0],h[1]);else r(d.x,d.p.x,-1,o);d=d.p}d=d.o,f=d.z,p=!p}while(!d.v);o.lineEnd()}}};function k7(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],o;++n<t;)r.n=o=e[n],o.p=r,r=o;r.n=o=e[0],o.p=r}}var WX=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Lxe=function(e){return e.length===1&&(e=Rxe(e)),{left:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)<0?r=a+1:o=a}return r},right:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)>0?o=a:r=a+1}return r}}};function Rxe(e){return function(t,n){return WX(e(t),n)}}var g0t=Lxe(WX),YX=function(e){for(var t=e.length,n,r=-1,o=0,a,s;++r<t;)o+=e[r].length;for(a=new Array(o);--t>=0;)for(s=e[t],n=s.length;--n>=0;)a[--o]=s[n];return a},uT=1e9,ND=-uT;function Oxe(e,t,n,r){function o(c,f){return e<=c&&c<=n&&t<=f&&f<=r}function a(c,f,h,d){var p=0,g=0;if(c==null||(p=s(c,h))!==(g=s(f,h))||l(c,f)<0^h>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+h+4)%4)!==g);else d.point(f[0],f[1])}function s(c,f){return tu(c[0]-e)<Ao?f>0?0:3:tu(c[0]-n)<Ao?f>0?2:1:tu(c[1]-t)<Ao?f>0?1:0:f>0?3:2}function u(c,f){return l(c.x,f.x)}function l(c,f){var h=s(c,1),d=s(f,1);return h!==d?h-d:h===0?f[1]-c[1]:h===1?c[0]-f[0]:h===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,h=HX(),d,p,g,y,v,w,C,E,S,A,D,P={point:M,lineStart:b,lineEnd:L,polygonStart:O,polygonEnd:m};function M(N,B){o(N,B)&&f.point(N,B)}function I(){for(var N=0,B=0,G=p.length;B<G;++B)for(var F=p[B],k=1,Z=F.length,te=F[0],oe,ue,pe=te[0],me=te[1];k<Z;++k)oe=pe,ue=me,te=F[k],pe=te[0],me=te[1],ue<=r?me>r&&(pe-oe)*(r-ue)>(me-ue)*(e-oe)&&++N:me<=r&&(pe-oe)*(r-ue)<(me-ue)*(e-oe)&&--N;return N}function O(){f=h,d=[],p=[],D=!0}function m(){var N=I(),B=D&&N,G=(d=YX(d)).length;(B||G)&&(c.polygonStart(),B&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),G&&qX(d,u,N,a,c),c.polygonEnd()),f=c,d=p=g=null}function b(){P.point=R,p&&p.push(g=[]),A=!0,S=!1,C=E=NaN}function L(){d&&(R(y,v),w&&S&&h.rejoin(),d.push(h.result())),P.point=M,S&&f.lineEnd()}function R(N,B){var G=o(N,B);if(p&&g.push([N,B]),A)y=N,v=B,w=G,A=!1,G&&(f.lineStart(),f.point(N,B));else if(G&&S)f.point(N,B);else{var F=[C=Math.max(ND,Math.min(uT,C)),E=Math.max(ND,Math.min(uT,E))],k=[N=Math.max(ND,Math.min(uT,N)),B=Math.max(ND,Math.min(uT,B))];Mxe(F,k,e,t,n,r)?(S||(f.lineStart(),f.point(F[0],F[1])),f.point(k[0],k[1]),G||f.lineEnd(),D=!1):G&&(f.lineStart(),f.point(N,B),D=!1)}C=N,E=B,S=G}return P}}var j2=N0(),Nxe=function(e,t){var n=t[0],r=t[1],o=[Ls(n),-ss(n),0],a=0,s=0;j2.reset();for(var u=0,l=e.length;u<l;++u)if(!!(f=(c=e[u]).length))for(var c,f,h=c[f-1],d=h[0],p=h[1]/2+L7,g=Ls(p),y=ss(p),v=0;v<f;++v,d=C,g=S,y=A,h=w){var w=c[v],C=w[0],E=w[1]/2+L7,S=Ls(E),A=ss(E),D=C-d,P=D>=0?1:-1,M=P*D,I=M>Si,O=g*S;if(j2.add(RT(O*P*Ls(M),y*A+O*ss(M))),a+=I?D+P*Ip:D,I^d>=n^C>=n){var m=iP(h1(h),h1(w));h3(m);var b=iP(o,m);h3(b);var L=(I^D>=0?-1:1)*OT(b[2]);(r>L||r===L&&(m[0]||m[1]))&&(s+=I^D>=0?1:-1)}}return(a<-Ao||a<Ao&&j2<-Ao)^s&1},_0t=N0(),G7=function(e){return e},y0t=N0(),v0t=N0(),d1=1/0,oP=d1,NT=-d1,aP=NT,U7={point:Bxe,lineStart:sT,lineEnd:sT,polygonStart:sT,polygonEnd:sT,result:function(){var e=[[d1,oP],[NT,aP]];return NT=aP=-(oP=d1=1/0),e}};function Bxe(e,t){e<d1&&(d1=e),e>NT&&(NT=e),t<oP&&(oP=t),t>aP&&(aP=t)}var C0t=N0(),XX=function(e,t,n,r){return function(o,a){var s=t(a),u=o.invert(r[0],r[1]),l=HX(),c=t(l),f=!1,h,d,p,g={point:y,lineStart:w,lineEnd:C,polygonStart:function(){g.point=E,g.lineStart=S,g.lineEnd=A,d=[],h=[]},polygonEnd:function(){g.point=y,g.lineStart=w,g.lineEnd=C,d=YX(d);var D=Nxe(h,u);d.length?(f||(a.polygonStart(),f=!0),qX(d,zxe,D,n,a)):D&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),d=h=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function y(D,P){var M=o(D,P);e(D=M[0],P=M[1])&&a.point(D,P)}function v(D,P){var M=o(D,P);s.point(M[0],M[1])}function w(){g.point=v,s.lineStart()}function C(){g.point=y,s.lineEnd()}function E(D,P){p.push([D,P]);var M=o(D,P);c.point(M[0],M[1])}function S(){c.lineStart(),p=[]}function A(){E(p[0][0],p[0][1]),c.lineEnd();var D=c.clean(),P=l.result(),M,I=P.length,O,m,b;if(p.pop(),h.push(p),p=null,!!I){if(D&1){if(m=P[0],(O=m.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),M=0;M<O;++M)a.point((b=m[M])[0],b[1]);a.lineEnd()}return}I>1&&D&2&&P.push(P.pop().concat(P.shift())),d.push(P.filter(Fxe))}}return g}};function Fxe(e){return e.length>1}function zxe(e,t){return((e=e.x)[0]<0?e[1]-mc-Ao:mc-e[1])-((t=t.x)[0]<0?t[1]-mc-Ao:mc-t[1])}var H7=XX(function(){return!0},Vxe,Gxe,[-Si,-mc]);function Vxe(e){var t=NaN,n=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(a,s){var u=a>0?Si:-Si,l=tu(a-t);tu(l-Si)<Ao?(e.point(t,n=(n+s)/2>0?mc:-mc),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(a,n),o=0):r!==u&&l>=Si&&(tu(t-r)<Ao&&(t-=r*Ao),tu(a-u)<Ao&&(a-=u*Ao),n=kxe(t,n,a,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),o=0),e.point(t=a,n=s),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-o}}}function kxe(e,t,n,r){var o,a,s=Ls(e-n);return tu(s)>Ao?aB((Ls(t)*(a=ss(r))*Ls(n)-Ls(r)*(o=ss(t))*Ls(e))/(o*a*s)):(t+r)/2}function Gxe(e,t,n,r){var o;if(e==null)o=n*mc,r.point(-Si,o),r.point(0,o),r.point(Si,o),r.point(Si,0),r.point(Si,-o),r.point(0,-o),r.point(-Si,-o),r.point(-Si,0),r.point(-Si,o);else if(tu(e[0]-t[0])>Ao){var a=e[0]<t[0]?Si:-Si;o=n*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}var Uxe=function(e,t){var n=ss(e),r=n>0,o=tu(n)>Ao;function a(f,h,d,p){Pxe(p,e,t,d,f,h)}function s(f,h){return ss(f)*ss(h)>n}function u(f){var h,d,p,g,y;return{lineStart:function(){g=p=!1,y=1},point:function(v,w){var C=[v,w],E,S=s(v,w),A=r?S?0:c(v,w):S?c(v+(v<0?Si:-Si),w):0;if(!h&&(g=p=S)&&f.lineStart(),S!==p&&(E=l(h,C),(!E||VD(h,E)||VD(C,E))&&(C[0]+=Ao,C[1]+=Ao,S=s(C[0],C[1]))),S!==p)y=0,S?(f.lineStart(),E=l(C,h),f.point(E[0],E[1])):(E=l(h,C),f.point(E[0],E[1]),f.lineEnd()),h=E;else if(o&&h&&r^S){var D;!(A&d)&&(D=l(C,h,!0))&&(y=0,r?(f.lineStart(),f.point(D[0][0],D[0][1]),f.point(D[1][0],D[1][1]),f.lineEnd()):(f.point(D[1][0],D[1][1]),f.lineEnd(),f.lineStart(),f.point(D[0][0],D[0][1])))}S&&(!h||!VD(h,C))&&f.point(C[0],C[1]),h=C,p=S,d=A},lineEnd:function(){p&&f.lineEnd(),h=null},clean:function(){return y|(g&&p)<<1}}}function l(f,h,d){var p=h1(f),g=h1(h),y=[1,0,0],v=iP(p,g),w=LD(v,v),C=v[0],E=w-C*C;if(!E)return!d&&f;var S=n*w/E,A=-n*C/E,D=iP(y,v),P=RD(y,S),M=RD(v,A);X2(P,M);var I=D,O=LD(P,I),m=LD(I,I),b=O*O-m*(LD(P,P)-1);if(!(b<0)){var L=RP(b),R=RD(I,(-O-L)/m);if(X2(R,P),R=f3(R),!d)return R;var N=f[0],B=h[0],G=f[1],F=h[1],k;B<N&&(k=N,N=B,B=k);var Z=B-N,te=tu(Z-Si)<Ao,oe=te||Z<Ao;if(!te&&F<G&&(k=G,G=F,F=k),oe?te?G+F>0^R[1]<(tu(R[0]-N)<Ao?G:F):G<=R[1]&&R[1]<=F:Z>Si^(N<=R[0]&&R[0]<=B)){var ue=RD(I,(-O+L)/m);return X2(ue,P),[R,f3(ue)]}}}function c(f,h){var d=r?e:Si-e,p=0;return f<-d?p|=1:f>d&&(p|=2),h<-d?p|=4:h>d&&(p|=8),p}return XX(s,u,a,r?[0,-e]:[-Si,e-Si])};function jX(e){return function(t){var n=new p3;for(var r in e)n[r]=e[r];return n.stream=t,n}}function p3(){}p3.prototype={constructor:p3,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function KX(e,t,n){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),Ixe(n,e.stream(U7));var s=U7.result(),u=Math.min(r/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),l=+t[0][0]+(r-u*(s[1][0]+s[0][0]))/2,c=+t[0][1]+(o-u*(s[1][1]+s[0][1]))/2;return a!=null&&e.clipExtent(a),e.scale(u*150).translate([l,c])}function Hxe(e,t,n){return KX(e,[[0,0],t],n)}var q7=16,qxe=ss(30*Ps),W7=function(e,t){return+t?Yxe(e,t):Wxe(e)};function Wxe(e){return jX({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Yxe(e,t){function n(r,o,a,s,u,l,c,f,h,d,p,g,y,v){var w=c-r,C=f-o,E=w*w+C*C;if(E>4*t&&y--){var S=s+d,A=u+p,D=l+g,P=RP(S*S+A*A+D*D),M=OT(D/=P),I=tu(tu(D)-1)<Ao||tu(a-h)<Ao?(a+h)/2:RT(A,S),O=e(I,M),m=O[0],b=O[1],L=m-r,R=b-o,N=C*L-w*R;(N*N/E>t||tu((w*L+C*R)/E-.5)>.3||s*d+u*p+l*g<qxe)&&(n(r,o,a,s,u,l,m,b,I,S/=P,A/=P,D,y,v),v.point(m,b),n(m,b,I,S,A,D,c,f,h,d,p,g,y,v))}}return function(r){var o,a,s,u,l,c,f,h,d,p,g,y,v={point:w,lineStart:C,lineEnd:S,polygonStart:function(){r.polygonStart(),v.lineStart=A},polygonEnd:function(){r.polygonEnd(),v.lineStart=C}};function w(M,I){M=e(M,I),r.point(M[0],M[1])}function C(){h=NaN,v.point=E,r.lineStart()}function E(M,I){var O=h1([M,I]),m=e(M,I);n(h,d,f,p,g,y,h=m[0],d=m[1],f=M,p=O[0],g=O[1],y=O[2],q7,r),r.point(h,d)}function S(){v.point=w,r.lineEnd()}function A(){C(),v.point=D,v.lineEnd=P}function D(M,I){E(o=M,I),a=h,s=d,u=p,l=g,c=y,v.point=E}function P(){n(h,d,f,p,g,y,a,s,o,u,l,c,q7,r),v.lineEnd=S,S()}return v}}var Xxe=jX({point:function(e,t){this.stream.point(e*Ps,t*Ps)}});function jxe(e){return Kxe(function(){return e})()}function Kxe(e){var t,n=150,r=480,o=250,a,s,u=0,l=0,c=0,f=0,h=0,d,p,g=null,y=H7,v=null,w,C,E,S=G7,A=.5,D=W7(m,A),P,M;function I(R){return R=p(R[0]*Ps,R[1]*Ps),[R[0]*n+a,s-R[1]*n]}function O(R){return R=p.invert((R[0]-a)/n,(s-R[1])/n),R&&[R[0]*Hf,R[1]*Hf]}function m(R,N){return R=t(R,N),[R[0]*n+a,s-R[1]*n]}I.stream=function(R){return P&&M===R?P:P=Xxe(y(d,D(S(M=R))))},I.clipAngle=function(R){return arguments.length?(y=+R?Uxe(g=R*Ps,6*Ps):(g=null,H7),L()):g*Hf},I.clipExtent=function(R){return arguments.length?(S=R==null?(v=w=C=E=null,G7):Oxe(v=+R[0][0],w=+R[0][1],C=+R[1][0],E=+R[1][1]),L()):v==null?null:[[v,w],[C,E]]},I.scale=function(R){return arguments.length?(n=+R,b()):n},I.translate=function(R){return arguments.length?(r=+R[0],o=+R[1],b()):[r,o]},I.center=function(R){return arguments.length?(u=R[0]%360*Ps,l=R[1]%360*Ps,b()):[u*Hf,l*Hf]},I.rotate=function(R){return arguments.length?(c=R[0]%360*Ps,f=R[1]%360*Ps,h=R.length>2?R[2]%360*Ps:0,b()):[c*Hf,f*Hf,h*Hf]},I.precision=function(R){return arguments.length?(D=W7(m,A=R*R),L()):RP(A)},I.fitExtent=function(R,N){return KX(I,R,N)},I.fitSize=function(R,N){return Hxe(I,R,N)};function b(){p=GX(d=UX(c,f,h),t);var R=t(u,l);return a=r-R[0]*n,s=o+R[1]*n,L()}function L(){return P=M=null,I}return function(){return t=e.apply(this,arguments),I.invert=t.invert&&O,b()}}function ZX(e,t){return[e,VX(kX((mc+t)/2))]}ZX.invert=function(e,t){return[e,2*aB(zX(t))-mc]};function Zxe(e){var t=jxe(e),n=t.center,r=t.scale,o=t.translate,a=t.clipExtent,s=null,u,l,c;t.scale=function(h){return arguments.length?(r(h),f()):r()},t.translate=function(h){return arguments.length?(o(h),f()):o()},t.center=function(h){return arguments.length?(n(h),f()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=u=l=c=null:(s=+h[0][0],u=+h[0][1],l=+h[1][0],c=+h[1][1]),f()):s==null?null:[[s,u],[l,c]]};function f(){var h=Si*r(),d=t(Dxe(t.rotate()).invert([0,0]));return a(s==null?[[d[0]-h,d[1]-h],[d[0]+h,d[1]+h]]:e===ZX?[[Math.max(d[0]-h,s),u],[Math.min(d[0]+h,l),c]]:[[s,Math.max(d[1]-h,u)],[l,Math.min(d[1]+h,c)]])}return f()}function QX(e,t){return[VX(kX((mc+t)/2)),-e]}QX.invert=function(e,t){return[-t,2*aB(zX(e))-mc]};var Qxe=function(){var e=Zxe(QX),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)};function Jxe(e,t,n){n=n||{};var r=n.units,o=n.steps||64;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");o=o||64,r=r||"kilometers";var a=[];switch(e.type){case"GeometryCollection":return ih(e,function(s){var u=kD(s,t,r,o);u&&a.push(u)}),Bt(a);case"FeatureCollection":return li(e,function(s){var u=kD(s,t,r,o);u&&li(u,function(l){l&&a.push(l)})}),Bt(a)}return kD(e,t,r,o)}function kD(e,t,n,r){var o=e.properties||{},a=e.type==="Feature"?e.geometry:e;if(a.type==="GeometryCollection"){var s=[];return ih(e,function(v){var w=kD(v,t,n,r);w&&s.push(w)}),Bt(s)}var u,l=Ca(e),c=l[1]>50&&l[3]>50;c?u={type:a.type,coordinates:$X(a.coordinates,Y7(a))}:u=v0(a);var f=new x1,h=f.read(u),d=WC(hy(t,n),"meters"),p=us.bufferOp(h,d),g=new HT;if(p=g.write(p),!JX(p.coordinates)){var y;return c?y={type:p.type,coordinates:ej(p.coordinates,Y7(a))}:y=gP(p),y.geometry?y:ra(y,o)}}function JX(e){return Array.isArray(e[0])?JX(e[0]):isNaN(e[0])}function $X(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return $X(n,t)})}function ej(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return ej(n,t)})}function Y7(e){var t=dP(e).geometry.coordinates.reverse(),n=t.map(function(r){return-r});return Qxe().center(t).rotate(n).scale(os)}function sB(){for(var e=new x1,t=e.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)t=LT.union(t,e.read(JSON.stringify(arguments[n].geometry)));var r=new HT;return t=r.write(t),{type:"Feature",geometry:t,properties:arguments[0].properties}}function p1(e,t){var n=Bl(e),r=Bl(t);if(Um(VC(r,{precision:4})).coordinates[0].length<4||Um(VC(n,{precision:4})).coordinates[0].length<4)return null;var o=new x1,a=o.read(VC(n)),s=o.read(VC(r)),u=qt.intersection(a,s);if(u.isEmpty())return null;var l=new HT,c=l.write(u);return ra(c)}/**
 * @license get-closest https://github.com/cosmosio/get-closest
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2017 Olivier Scherrer <pode.fr@gmail.com>
 */function $xe(e,t,n){var r,o;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(a,s){var u=n(a,e);u>=0&&(typeof o>"u"||u<o)&&(o=u,r=s)}),r}function ewe(e,t){return $xe(e,t,function(n,r){return n-r})}function twe(e,t){if(t=t||{},!pt(t))throw new Error("options is invalid");var n=t.propertyName;xd(e,"Polygon","dissolve");var r=ru(e),o=r.features,a=[];o.forEach(function(f,h){f.properties.origIndexPosition=h});var s=BT();s.load(r);for(var u in o){var l=o[u],c=!1;if(s.search(l).features.forEach(function(f){l=o[u];var h=f.properties.origIndexPosition;if(a.length>0&&h!==0)if(h>a[a.length-1])h=h-a.length;else{var d=ewe(h,a);d!==0&&(h=h-d)}if(h!==+u){var p=o[h];!p||!l||n!==void 0&&p.properties[n]!==l.properties[n]||!KY(l,p)||!nwe(l,p)||(o[u]=sB(l,p),a.push(f.properties.origIndexPosition),a.sort(function(g,y){return g-y}),s.remove(f),o.splice(h,1),l.properties.origIndexPosition=u,s.remove(l,function(g,y){return g.properties.origIndexPosition===y.properties.origIndexPosition}),c=!0)}}),c){if(!l)continue;l.properties.origIndexPosition=u,s.insert(l),u--}}return o.forEach(function(f){delete f.properties.origIndexPosition,delete f.bbox}),r}function nwe(e,t){var n=Li(Cp(e)),r=Li(Cp(t)),o=$m(n,r).features;return o.length>0}function tj(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.properties||{},o=n.triangles,a=n.mask;if(t==null)throw new Error("cellSide is required");if(!ui(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(a&&["Polygon","MultiPolygon"].indexOf(Ri(a))===-1)throw new Error("options.mask must be a (Multi)Polygon");var s=e[0],u=e[1],l=e[2],c=e[3],f=(u+c)/2,h=(s+l)/2,d=t*2/si([s,f],[l,f],n),p=d*(l-s),g=t*2/si([h,u],[h,c],n),y=g*(c-u),v=p/2,w=v*2,C=Math.sqrt(3)/2*y,E=l-s,S=c-u,A=3/4*w,D=C,P=(E-w)/(w-v/2),M=Math.floor(P),I=(M*A-v/2-E)/2-v/2+A/2,O=Math.floor((S-C)/C),m=(S-O*C)/2,b=O*C-S>C/2;b&&(m-=C/4);for(var L=[],R=[],N=0;N<6;N++){var B=2*Math.PI/6*N;L.push(Math.cos(B)),R.push(Math.sin(B))}for(var G=[],F=0;F<=M;F++)for(var k=0;k<=O;k++){var Z=F%2===1;if(!(k===0&&Z)&&!(k===0&&b)){var te=F*A+s-I,oe=k*D+u+m;if(Z&&(oe-=C/2),o===!0)iwe([te,oe],p/2,y/2,r,L,R).forEach(function(pe){a?p1(a,pe)&&G.push(pe):G.push(pe)});else{var ue=rwe([te,oe],p/2,y/2,r,L,R);a?p1(a,ue)&&G.push(ue):G.push(ue)}}}return Bt(G)}function rwe(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=e[0]+t*o[u],c=e[1]+n*a[u];s.push([l,c])}return s.push(s[0].slice()),Dn([s],r)}function iwe(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=[];l.push(e),l.push([e[0]+t*o[u],e[1]+n*a[u]]),l.push([e[0]+t*o[(u+1)%6],e[1]+n*a[(u+1)%6]]),l.push(e),s.push(Dn([l],r))}return s}function owe(e,t){var n=uwe(t),r=swe(e),o=r[0],a=r[1];o=X7(o),a=X7(a);var s=awe(n,o,a);return s}function awe(e,t,n){var r=[];return r.push(e.geometry.coordinates[0]),ko(t,function(o){r.push(o.geometry.coordinates[0])}),ko(n,function(o){r.push(o.geometry.coordinates[0])}),Dn(r)}function swe(e){var t=[],n=[];return ko(e,function(r){var o=r.geometry.coordinates,a=o[0],s=o.slice(1);t.push(Dn([a])),s.forEach(function(u){n.push(Dn([u]))})}),[Bt(t),Bt(n)]}function uwe(e){var t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],n=e&&e.geometry.coordinates||t;return Dn(n)}function X7(e){if(e.features.length<=1)return e;var t=lwe(e),n=[],r={};return ko(e,function(o,a){if(r[a])return!0;for(t.remove({index:a},j7),r[a]=!0;;){var s=Ca(o),u=t.search({minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]});if(u.length>0){var l=u.map(function(c){return r[c.index]=!0,t.remove({index:c.index},j7),c.geojson});l.push(o),o=sB.apply(this,l)}if(u.length===0)break}n.push(o)}),Bt(n)}function j7(e,t){return e.index===t.index}function lwe(e){var t=YC(),n=[];return ko(e,function(r,o){var a=Ca(r);n.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],geojson:r,index:o})}),t.load(n),t}function nj(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!ui(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Ri(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/si([s,u],[l,u],n),h=f*(l-s),d=t/si([s,u],[s,c],n),p=d*(c-u),g=l-s,y=c-u,v=Math.floor(g/h),w=Math.floor(y/p),C=(g-v*h)/2,E=(y-w*p)/2,S=s+C,A=0;A<v;A++){for(var D=u+E,P=0;P<w;P++){var M=Dn([[[S,D],[S,D+p],[S+h,D+p],[S+h,D],[S,D]]],r);o?p1(o,M)&&a.push(M):a.push(M),D+=p}S+=h}return Bt(a)}function rj(e,t,n){if(n=n||{},!pt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!ui(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Ri(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=t/si([e[0],e[1]],[e[2],e[1]],n),u=s*(e[2]-e[0]),l=t/si([e[0],e[1]],[e[0],e[3]],n),c=l*(e[3]-e[1]),f=0,h=e[0];h<=e[2];){for(var d=0,p=e[1];p<=e[3];){var g=null,y=null;f%2===0&&d%2===0?(g=Dn([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=Dn([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)):f%2===0&&d%2===1?(g=Dn([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r),y=Dn([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r)):d%2===0&&f%2===1?(g=Dn([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r),y=Dn([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r)):d%2===1&&f%2===1&&(g=Dn([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=Dn([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)),o?(p1(o,g)&&a.push(g),p1(o,y)&&a.push(y)):(a.push(g),a.push(y)),p+=c,d++}f++,h+=u}return Bt(a)}function cwe(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.gridType,o=n.property,a=n.weight;if(!e)throw new Error("points is required");if(xd(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(a!==void 0&&typeof a!="number")throw new Error("weight must be a number");o=o||"elevation",r=r||"square",a=a||1;var s=Ca(e),u;switch(r){case"point":case"points":u=NY(s,t,n);break;case"square":case"squares":u=nj(s,t,n);break;case"hex":case"hexes":u=tj(s,t,n);break;case"triangle":case"triangles":u=rj(s,t,n);break;default:throw new Error("invalid gridType")}var l=[];return li(u,function(c){var f=0,h=0;li(e,function(p){var g=r==="point"?c:py(c),y=si(g,p,n),v;if(o!==void 0&&(v=p.properties[o]),v===void 0&&(v=p.geometry.coordinates[2]),v===void 0)throw new Error("zValue is missing");y===0&&(f=v);var w=1/Math.pow(y,a);h+=w,f+=w*v});var d=ru(c);d.properties[o]=f/h,l.push(d)}),Bt(l)}var ij={projection:Qye,random:axe,clusters:sxe,helpers:G0e,invariant:H0e,meta:U0e,isolines:Q0e,convex:hY,pointsWithinPolygon:K2,concave:oye,collect:sye,flip:uye,simplify:mye,bezierSpline:AW,tag:yye,sample:vye,envelope:CY,square:xY,circle:A3,midpoint:wye,center:dP,centerOfMass:wY,centroid:py,combine:Eye,distance:si,explode:b3,bbox:Ca,tesselate:Vye,bboxPolygon:S3,booleanPointInPolygon:_o,nearestPoint:n3,nearestPointOnLine:zm,nearestPointToLine:tve,planepoint:rve,tin:dY,bearing:yp,destination:xp,kinks:ive,pointOnFeature:FW,area:mT,along:sve,length:r3,lineSlice:uve,lineSliceAlong:MY,pointGrid:NY,truncate:VC,flatten:vve,lineIntersect:$m,lineChunk:Cve,unkinkPolygon:bve,greatCircle:Ive,lineSegment:my,lineSplit:Dve,lineArc:zY,polygonToLine:WD,lineToPolygon:KW,bboxClip:Lve,lineOverlap:kY,sector:Nve,rhumbBearing:y0,rhumbDistance:mP,rhumbDestination:XC,polygonTangents:Fve,rewind:kve,isobands:DCe,transformRotate:GY,transformScale:UY,transformTranslate:FCe,lineOffset:qCe,polygonize:KCe,booleanDisjoint:qY,booleanContains:t1e,booleanCrosses:c1e,booleanClockwise:XD,booleanOverlap:KY,booleanPointOnLine:pc,booleanEqual:p1e,booleanWithin:LY,clone:ru,cleanCoords:Um,clustersDbscan:y1e,clustersKmeans:A1e,pointToLineDistance:DY,booleanParallel:b1e,booleanIntersects:I1e,shortestPath:M1e,voronoi:$1e,ellipse:rX,centerMean:U3,centerMedian:exe,standardDeviationalEllipse:txe,difference:Axe,buffer:Jxe,union:sB,intersect:p1,dissolve:twe,hexGrid:tj,mask:owe,squareGrid:nj,triangleGrid:rj,interpolate:cwe,pointOnSurface:FW,polygonToLineString:WD,lineStringToPolygon:KW,inside:_o,within:K2,bezier:AW,nearest:n3,pointOnLine:zm,lineDistance:r3,radians2degrees:w0,degrees2radians:qa,distanceToDegrees:UD,distanceToRadians:hy,radiansToDistance:WC,bearingToAngle:_0,convertDistance:dy,toMercator:v0,toWgs84:gP,randomPosition:zT,randomPoint:oX,randomPolygon:aX,randomLineString:sX,getCluster:lX,clusterEach:H3,clusterReduce:cX,createBins:q3,applyFilter:CP,propertiesContainsFilter:W3,filterProperties:fX,earthRadius:os,factors:sP,unitsFactors:K7,areaFactors:GD,feature:ra,geometry:Z7,point:Vr,points:Q7,polygon:Dn,polygons:J7,lineString:Li,lineStrings:$7,featureCollection:Bt,multiLineString:R0,multiPoint:uP,multiPolygon:m1,geometryCollection:m3,round:eY,radiansToLength:WC,lengthToRadians:hy,lengthToDegrees:UD,bearingToAzimuth:_0,radiansToDegrees:w0,degreesToRadians:qa,convertLength:dy,convertArea:tY,isNumber:ui,isObject:pt,validateBBox:g1,validateId:lP,getCoord:ao,getCoords:wt,containsNumber:fP,geojsonType:iY,featureOf:lT,collectionOf:xd,getGeom:Bl,getGeomType:oY,getType:Ri,coordEach:Wa,coordReduce:cP,propEach:g3,propReduce:nY,featureEach:li,featureReduce:_3,coordAll:Cp,geomEach:ih,geomReduce:y3,flattenEach:ko,flattenReduce:rY,segmentEach:Fm,segmentReduce:v3,lineEach:C3,lineReduce:x3};function uB(e,t,n){this.viewer=e,this.handler=void 0,this.turf=T(t,ij),this.curEntity="",this.stop=!0,this.selectType="",this.leftClickSelectEntity=new xe,this.selectEntityList=new Va,this.entityList=n}uB.prototype.startAnalysis=function(e,t){this.stop=!1,this.selectType=T(t,"radio"),fwe(this),this.leftClickSelectEntity._listeners.length===0&&this.leftClickSelectEntity.addEventListener(e)};uB.prototype.stopAnalysis=function(e){this.stop=!0,this.leftClickSelectEntity._listeners.length!==0&&this.leftClickSelectEntity.removeEventListener(e),this.selectEntityList.removeAll()};function fwe(e){let t=e;t.handler===void 0&&(t.handler=new Jg(t.viewer.scene.canvas)),t.handler.setInputAction(function(n){if(!t.stop){if(t.selectType==="radio"){let r=t.viewer.scene.pick(n.position);if(r!==void 0&&r.id instanceof is){r.id.id.split("_")[1]==="outline"&&(r.id.id=r.id.id.split("_")[0]),t.selectEntityList.set(r.id.id,{id:r.id.id,type:r.id.geometryType});let o=[];for(let a in t.selectEntityList._hash)t.selectEntityList._hash.hasOwnProperty(a)&&o.push(t.selectEntityList.get(a));t.leftClickSelectEntity.raiseEvent(o)}}else if(t.selectType==="checkbox"){let r=t.viewer.camera.pickEllipsoid(n.position,t.viewer.scene.globe.ellipsoid);if(r!==void 0){let o=[r];t.curEntity=t.viewer.entities.add({polygon:{arcType:Na.RHUMB,material:K.RED.withAlpha(.6),hierarchy:new Ks(function(){let a=[],s=o;if(s.length===2){let u=ce.fromCartesian(s[0]),l=ce.fromCartesian(s[1]),c=x.fromRadians(l.longitude,u.latitude),f=x.fromRadians(u.longitude,l.latitude);a=[s[0],c,s[1],f]}return{positions:a}},!1)},nodelist:o}),t.viewer.scene.screenSpaceCameraController.enableTranslate=!1,t.viewer.scene.screenSpaceCameraController.enableRotate=!1}}}},pn.LEFT_DOWN),t.handler.setInputAction(function(n){if(!t.stop&&t.selectType==="checkbox"){let r=t.viewer.camera.pickEllipsoid(n.endPosition,t.viewer.scene.globe.ellipsoid);t.curEntity!==""&&t.curEntity!==void 0&&r!==void 0&&(t.curEntity.nodelist[1]=r)}},pn.MOUSE_MOVE),t.handler.setInputAction(function(n){t.stop||(t.viewer.scene.screenSpaceCameraController.enableTranslate=!0,t.viewer.scene.screenSpaceCameraController.enableRotate=!0,t.curEntity instanceof is&&t.leftClickSelectEntity.raiseEvent(hwe(t.curEntity,t.entityList,t.turf)),t.selectType==="checkbox"&&(t.viewer.entities.remove(t.curEntity),t.curEntity=void 0))},pn.LEFT_UP)}function hwe(e,t,n){let r=[],o=e.polygon.hierarchy.getValue().positions;if(e.polygon.hierarchy.getValue().positions.length<4)return r;let a=OP(o,"polygon"),s=n.polygon([a]);if(t instanceof Va){for(let u in t._hash)if(t._hash.hasOwnProperty(u)){let l=t._hash[u][0];if(t._hash[u][0].geometryType==="polyline"){let c=l.polyline.positions.getValue(),f=OP(c),h=n.lineString(f);(n.booleanContains(s,h)||n.booleanCrosses(s,h))&&r.push({id:l.id,type:"polyline"})}else if(t._hash[u][0].geometryType==="point"){let c=l.position.getValue(),f=OP([c]),h=n.point(f[0]);n.booleanContains(s,h)&&r.push({id:l.id,type:"point"})}else{let c=l.polygon.hierarchy.getValue().positions,f=OP(c,"polygon"),h=n.polygon([f]);(n.booleanContains(s,h)||!n.booleanDisjoint(s,h)||n.booleanContains(h,s))&&r.push({id:l.id,type:l.geometryType})}}}return r}function OP(e,t){let n=[];return e.forEach(function(r){let o=ce.fromCartesian(r);n.push([Math.toDegrees(o.longitude),Math.toDegrees(o.latitude)])}),t==="polygon"&&n.push(n[0]),n}var oj=uB;function E1(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._dynamic=Cesium.defaultValue(e.dynamic,!1),this._cylinderLength=Cesium.defaultValue(e.cylinderLength,1e3),this._topRadius=Cesium.defaultValue(e.topRadius,34),this._bottomRadius=Cesium.defaultValue(e.bottomRadius,.001),this._updateGeometryMesh=!0,this.instances=[],this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this.cylinderGeometry=void 0,this.geometryBuffer=void 0,this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1},this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(E1.prototype,{cylinderLength:{get:function(){return this._cylinderLength},set:function(e){this._updateGeometryMesh=this._cylinderLength!=e,this._cylinderLength=e}},topRadius:{get:function(){return this._topRadius},set:function(e){this._updateGeometryMesh=this._topRadius!=e,this._topRadius=e}},bottomRadius:{get:function(){return this._bottomRadius},set:function(e){this._updateGeometryMesh=this._bottomRadius!=e,this._bottomRadius=e}}});E1.prototype.recreateVertexArrays=function(e,t){this.instances=e||[],!(this.instances.length<1)&&(this.blUpdateVAO=!0)};E1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!this.blUpdateVAO){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:_we(),fragmentShaderSource:ywe()})),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this._updateGeometryMesh&&(this.cylinderGeometry=new Cesium.CylinderGeometry({length:this._cylinderLength,topRadius:this._topRadius,bottomRadius:this._bottomRadius,showTop:!1}),dwe(this),this._updateGeometryMesh=!1),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=pwe(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1}};E1.prototype.isDestroyed=function(){return!1};E1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.defined(this.geometryBuffer)&&(delete this.geometryBuffer.indices,delete this.geometryBuffer.attributes.normal.values,delete this.geometryBuffer.attributes.position.values,delete this.geometryBuffer.attributes.st.values),Cesium.destroyObject(this)};function dwe(e){Cesium.defined(e.geometryBuffer)&&(delete e.geometryBuffer.indices,delete e.geometryBuffer.attributes.normal.values,delete e.geometryBuffer.attributes.position.values,delete e.geometryBuffer.attributes.st.values),e.geometryBuffer=void 0,e.geometryBuffer=Cesium.CylinderGeometry.createGeometry(e.cylinderGeometry)}function pwe(e,t){var n=gwe(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=16,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1},czm_modelColor:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*12,strideInBytes:a*o,instanceDivisor:1}},u=0,l=[],c=t.geometryBuffer.attributes.position,f=t.geometryBuffer.indices;return l.push({index:u++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(c.values.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),s.czm_modelMatrixRow0.index=u++,l.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=u++,l.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=u++,l.push(s.czm_modelMatrixRow2),s.czm_modelColor.index=u++,l.push(s.czm_modelColor),new Cesium.VertexArray({context:e,attributes:l,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:new Uint16Array(f.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var mwe=new U;function gwe(e){var t=e.instances,n=t.length,r=16,o=e._vertexBufferTypedArray;Cesium.defined(o)||(o=new Float32Array(n*r)),e._dynamic&&(e._vertexBufferTypedArray=o);for(var a=[],s=0;s<n;++s){var u=t[s].modelMatrix;a.push(new Cesium.Cartesian3(u[12],u[13],u[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(a);for(var s=0;s<n;++s){var u=t[s].modelMatrix,l=t[s].color,c=Cesium.Matrix4.clone(u,mwe);c[12]=c[12]-e.boundingSphere.center.x,c[13]=c[13]-e.boundingSphere.center.y,c[14]=c[14]-e.boundingSphere.center.z;var f=s*r;o[f+0]=c[0],o[f+1]=c[4],o[f+2]=c[8],o[f+3]=c[12],o[f+4]=c[1],o[f+5]=c[5],o[f+6]=c[9],o[f+7]=c[13],o[f+8]=c[2],o[f+9]=c[6],o[f+10]=c[10],o[f+11]=c[14],o[f+12]=l.red,o[f+13]=l.green,o[f+14]=l.blue,o[f+15]=l.alpha}return o}function _we(){var e=`precision highp float;
attribute vec3 position;
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = color; 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function ywe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var NP=E1;function Ry(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.blUpdateVAO=!1,this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this._startYaw=Cesium.defaultValue(e.startYaw,-30),this._yawSpan=Cesium.defaultValue(e.yawSpan,60),this._startPitch=Cesium.defaultValue(e.startPitch,-20),this._pitchSpan=Cesium.defaultValue(e.pitchSpan,40),this._radius=Cesium.defaultValue(e.radius,30),this._forwardDis=Cesium.defaultValue(e.forwardDis,15),this.color=Cesium.defaultValue(e.color,new Cesium.Color(99/255,164/255,164/255,.6)),this._heading=Cesium.defaultValue(e.heading,0),this._pitch=Cesium.defaultValue(e.pitch,0),this._roll=Cesium.defaultValue(e.roll,0),this._center=new Cesium.Cartesian3,this.instances=[],this._dynamic=Cesium.defaultValue(e.dynamic,!1),this._updateGeometryMesh=!1,this.openSectorPyramid=Cesium.defaultValue(e.openSectorPyramid,!1),this.geometryMesh=aj(this),this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1};var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(Ry.prototype,{forwardDis:{get:function(){return this._forwardDis},set:function(e){this._updateGeometryMesh=this._forwardDis!=e,this._forwardDis=e}},startYaw:{get:function(){return this._startYaw},set:function(e){this._updateGeometryMesh=this._startYaw!=e,this._startYaw=e}},yawSpan:{get:function(){return this._yawSpan},set:function(e){this._updateGeometryMesh=this._yawSpan!=e,this._yawSpan=e}},startPitch:{get:function(){return this._startPitch},set:function(e){this._updateGeometryMesh=this._startPitch!=e,this._startPitch=e}},pitchSpan:{get:function(){return this._pitchSpan},set:function(e){this._updateGeometryMesh=this._pitchSpan!=e,this._pitchSpan=e}},radius:{get:function(){return this._radius},set:function(e){this._updateGeometryMesh=this._radius!=e,this._radius=e}},heading:{get:function(){return this._heading},set:function(e){this._updateGeometryMesh=this._heading!=e,this._heading=e}},pitch:{get:function(){return this._pitch},set:function(e){this._updateGeometryMesh=this._pitch!=e,this._pitch=e}},roll:{get:function(){return this._roll},set:function(e){this._updateGeometryMesh=this._roll!=e,this._roll=e}}});Ry.prototype.resetRadarInstances=function(e){this.instances=e,this.blUpdateVAO=!0};var vwe=new U;Ry.prototype.resetRadarByPositionProperty=function(e){this.instances=[];for(var t=0;t<e.length;t++){var n=e[t].position,r=this.transformFunc(n,void 0,vwe),o=Cesium.Quaternion.fromHeadingPitchRoll(e[t].headingPitchRoll,new Cesium.Quaternion),a=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),o,e[t].scale);r=Cesium.Matrix4.multiply(r,a,new Cesium.Matrix4),Cesium.defined(r)&&this.instances.push({modelMatrix:r,color:e[t].color})}this.blUpdateVAO=!0};Ry.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.geometryMesh)){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Ewe(),fragmentShaderSource:Twe()})),this._updateGeometryMesh&&(Cesium.defined(this.geometryMesh)&&(Cesium.defined(this.geometryMesh.position)&&delete this.geometryMesh.position,Cesium.defined(this.geometryMesh.surfaceTag)&&delete this.geometryMesh.surfaceTag,Cesium.defined(this.geometryMesh.indices)&&delete this.geometryMesh.indices),this.geometryMesh=aj(this),this._updateGeometryMesh=!1,this.blUpdateVAO=!0),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&this.blUpdateVAO&&n.vertexArray.destroy(),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=Cwe(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1}};function Cwe(e,t){var n=wwe(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=16,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1},czm_modelColor:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*12,strideInBytes:a*o,instanceDivisor:1}},u=t.geometryMesh,l=0,c=[];return c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(u.position.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,new Float64Array(u.surfaceTag.buffer)),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:1,normalize:!1}),s.czm_modelMatrixRow0.index=l++,c.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=l++,c.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=l++,c.push(s.czm_modelMatrixRow2),s.czm_modelColor.index=l++,c.push(s.czm_modelColor),new Cesium.VertexArray({context:e,attributes:c,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:new Uint16Array(u.indices.buffer),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var xwe=new U;function wwe(e){var t=e.instances,n=t.length,r=e._center,o=16,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix;s.push(new Cesium.Cartesian3(l[12],l[13],l[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(s);for(var u=0;u<n;++u){var l=t[u].modelMatrix,c=t[u].color,f=Cesium.Matrix4.clone(l,xwe);f[12]=f[12]-e.boundingSphere.center.x-r.x,f[13]=f[13]-e.boundingSphere.center.y-r.y,f[14]=f[14]-e.boundingSphere.center.z-r.z;var h=u*o;a[h+0]=f[0],a[h+1]=f[4],a[h+2]=f[8],a[h+3]=f[12],a[h+4]=f[1],a[h+5]=f[5],a[h+6]=f[9],a[h+7]=f[13],a[h+8]=f[2],a[h+9]=f[6],a[h+10]=f[10],a[h+11]=f[14],a[h+12]=c.red,a[h+13]=c.green,a[h+14]=c.blue,a[h+15]=c.alpha}return a}function Ewe(){var e=`precision highp float;
attribute vec3 position;
attribute float surfaceTag; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = color; 
    if(surfaceTag<0.5){ 
    v_colour.a = 0.0; 
     } 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Twe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}function aj(e){var t=5,n=5,r=e._forwardDis,o=e.color,a=e.radius,s=e.startYaw,u=e.yawSpan/t+1,l=e.startPitch,c=e.pitchSpan/n+1,f=u*c;f++;var h=(u-1)*2+(c-1)*2+(u-1)*(c-1)*2;h*=3;for(var d=Cesium.IndexDatatype.createTypedArray(f,h),p=new Float64Array(f*3),g=new Float64Array(f),y=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(e._heading,e._pitch,e._roll),new Cesium.Quaternion),v=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(r,0,0),y,new Cesium.Cartesian3(1,1,1)),w=new Cesium.Cartesian3,C=0,E=0,S=0;S<u;S++){var A=s+S*t;A=-A;for(var D=0;D<c;D++){var P=l+D*n;if(P=-P,e.openSectorPyramid)var M=a*Math.tan(P*Math.PI/180),I=a,O=I,m=I*Math.tan(A*Math.PI/180);else var M=a*Math.sin(P*Math.PI/180),I=a*Math.cos(P*Math.PI/180),O=I*Math.cos(A*Math.PI/180),m=I*Math.sin(A*Math.PI/180);w.x=O+r,w.y=m,w.z=M,w=Cesium.Matrix4.multiplyByPoint(v,w,w),p[C++]=w.x,p[C++]=w.y,p[C++]=w.z,g[E++]=1}}p[C++]=r,p[C++]=0,p[C++]=0,g[E++]=0;for(var b=0,S=0;S<u-1;S++)for(var D=0;D<c-1;D++)d[b++]=S*c+D,d[b++]=(S+1)*c+D,d[b++]=(S+1)*c+D+1,d[b++]=S*c+D,d[b++]=(S+1)*c+D+1,d[b++]=S*c+D+1;for(var S=0;S<u-1;S++)d[b++]=S*c,d[b++]=f-1,d[b++]=(S+1)*c,d[b++]=(S+1)*c+(c-1),d[b++]=S*c+(c-1),d[b++]=f-1;for(var D=0;D<c-1;D++)d[b++]=D,d[b++]=D+1,d[b++]=f-1,d[b++]=(u-1)*c+D,d[b++]=f-1,d[b++]=(u-1)*c+D+1;return{position:p,surfaceTag:g,indices:d}}Ry.prototype.isDestroyed=function(){return!1};Ry.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.defined(this.geometryMesh)&&(Cesium.defined(this.geometryMesh.position)&&delete this.geometryMesh.position,Cesium.defined(this.geometryMesh.surfaceTag)&&delete this.geometryMesh.surfaceTag,Cesium.defined(this.geometryMesh.indices)&&delete this.geometryMesh.indices),Cesium.destroyObject(this)};var T1=Ry;function S1(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.scene=e.scene,this.geometry=void 0,this.blUpdateVAO=!1,this.boundingSphere=void 0,this.pullWireMesh=void 0,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDistanceDisplayCondition=!1,this._renderState={blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!1),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1},this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache(this._renderState)})}Object.defineProperties(S1.prototype,{depthTestState:{get:function(){return this._renderState.depthTest.enabled},set:function(e){this._renderState.depthTest.enabled=e,this._command&&(this._command.renderState=Cesium.RenderState.fromCache(this._renderState))}}});var lB=new ei;S1.prototype.resizeLabelInfos=function(e){var t=e.length,n=0,r=Number.MAX_VALUE;if(this.pullWireMesh=void 0,e instanceof Array&&t>0){for(var o=t*2,a=t*2,s=Cesium.IndexDatatype.createTypedArray(o,a),u=0;u<a;u++)s[u]=u;for(var l=new Cesium.BoundingSphere(e[0].position,200),c=new Float64Array(o*3),f=new Float64Array(o*3),h=new Float64Array(o*2),d=new Float32Array(o*2),p=new Float32Array(o*3),g=new Float32Array(o*3),y=new Uint8Array(o*4),v=0;v<e.length;v++){var w=e[v].distanceDisplayCondition;Cesium.defined(w)&&(n=w.near,r=w.far,n*=n,r*=r,this._shaderDistanceDisplayCondition=!0);var C=e[v].position,E=e[v].imageSize,S=e[v].pixelOffset,A=e[v].origin,D=e[v].scale;l=Cesium.BoundingSphere.expand(l,C),Cesium.EncodedCartesian3.fromCartesian(C,lB);var P=lB.high,M=lB.low;c[v*6]=P.x,c[v*6+1]=P.y,c[v*6+2]=P.z,c[v*6+3]=P.x,c[v*6+4]=P.y,c[v*6+5]=P.z,f[v*6]=M.x,f[v*6+1]=M.y,f[v*6+2]=M.z,f[v*6+3]=M.x,f[v*6+4]=M.y,f[v*6+5]=M.z,h[v*4]=n,h[v*4+1]=r,h[v*4+2]=n,h[v*4+3]=r,d[v*4]=0,d[v*4+1]=0,d[v*4+2]=1,d[v*4+3]=D,p[v*6]=0,p[v*6+1]=0,p[v*6+2]=0,p[v*6+3]=S.x,p[v*6+4]=S.y,p[v*6+5]=E.x,g[v*6]=0,g[v*6+1]=0,g[v*6+2]=0,g[v*6+3]=A.x,g[v*6+4]=A.y,g[v*6+5]=E.y,y[v*8]=Cesium.Color.floatToByte(e[v].color.red),y[v*8+1]=Cesium.Color.floatToByte(e[v].color.green),y[v*8+2]=Cesium.Color.floatToByte(e[v].color.blue),y[v*8+3]=Cesium.Color.floatToByte(e[v].color.alpha),y[v*8+4]=Cesium.Color.floatToByte(e[v].color.red),y[v*8+5]=Cesium.Color.floatToByte(e[v].color.green),y[v*8+6]=Cesium.Color.floatToByte(e[v].color.blue),y[v*8+7]=Cesium.Color.floatToByte(e[v].color.alpha)}this.pullWireMesh={position3DHigh:c,position3DLow:f,disCondition:h,st:d,tangent:p,bitangent:g,color:y,indices:s},this.boundingSphere=l.clone(),this.blUpdateVAO=!0}};S1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&this.pullWireMesh){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.tangent),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.bitangent),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.pullWireMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.pullWireMesh.disCondition),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.pullWireMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Swe(),fragmentShaderSource:Awe()})),this._shaderDistanceDisplayCondition!=this._compiledShaderDistanceDisplayCondition&&(n.shaderProgram.vertexShaderSource.defines.push("DISTANCE_DISPLAY_CONDITION"),this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition)}if(Cesium.defined(n.vertexArray)){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};S1.prototype.isDestroyed=function(){return!1};S1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function Swe(){return`attribute vec3 position3DHigh;
  attribute vec3 position3DLow;
  attribute vec2 uv;
  attribute vec3 tangent;
  attribute vec3 bitangent;
  attribute vec4 color;
  attribute vec2 disCondition;
  varying vec4  v_colour;
  vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
  {
  vec2 halfSize = imageSize * scale * 0.5;
  halfSize *= ((direction * 2.0) - 1.0);
  vec2 originTranslate = origin * abs(halfSize);
  #if defined(ROTATION) || defined(ALIGNED_AXIS)
  if (validAlignedAxis || rotation != 0.0)
  {
  float angle = rotation;
  if (validAlignedAxis)
  {
  vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);
  angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
  (projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
  }
  float cosTheta = cos(angle);
  float sinTheta = sin(angle);
  rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
  halfSize = rotationMatrix * halfSize;
  }
  else
  {
  rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
  }
  #endif
  mpp = czm_metersPerPixel(positionEC);
  positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
  positionEC.xy += (translate + pixelOffset) * mpp;
  return positionEC;
  }
  void main(){
  vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);
  vec4 positionEC = czm_modelViewRelativeToEye * p;
  if(uv.x > 0.5){
  float scale = uv.y;
  vec2 pixelOffset = vec2(tangent.x, -tangent.y);
  vec2 imageSize = vec2(tangent.z, bitangent.z);
  vec2 origin = vec2(bitangent.x, bitangent.y);
  vec2 direction = vec2(0.0, 1.0);
  if((pixelOffset.x+ 0.5*imageSize.x) >=0.0 && (pixelOffset.y- 0.5*imageSize.y)>0.0){
  pixelOffset = vec2(pixelOffset.x, pixelOffset.y-imageSize.y);
  }else if((pixelOffset.x+ 0.5*imageSize.x) <0.0 && (pixelOffset.y- 0.5*imageSize.y)<0.0){
  pixelOffset = vec2(pixelOffset.x+imageSize.x , pixelOffset.y);
  }else if((pixelOffset.x+ 0.5*imageSize.x) <0.0 && (pixelOffset.y- 0.5*imageSize.y)>0.0){
  pixelOffset = vec2(pixelOffset.x+imageSize.x , pixelOffset.y-imageSize.y);
  }
  vec2 translate = vec2(0.0, 0.0);
  vec3 alignedAxis = vec3(0.0);
  bool validAlignedAxis = false;
  float rotation = 0.0;
  bool sizeInMeters = false;
  mat2 rotationMatrix;
  float mpp;
  positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
  }
  #if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
  float lengthSq;
  if (czm_sceneMode == czm_sceneMode2D)
  {
  lengthSq = czm_eyeHeight2D.y;
  }
  else
  {
  lengthSq = dot(positionEC.xyz, positionEC.xyz);
  }
  #endif
  #ifdef DISTANCE_DISPLAY_CONDITION
  float nearSq = disCondition.x;
  float farSq = disCondition.y;
  if (lengthSq < nearSq || lengthSq > farSq)
  {
  positionEC.xyz = vec3(0.0);
  }
  #endif
  v_colour = vec4(color.r, color.g, color.b, color.a);
  gl_Position = czm_projection * positionEC;
  #ifdef LOG_DEPTH
  czm_vertexLogDepth();
  #endif
  }
  `}function Awe(){return`varying vec4  v_colour;
  void main(){
  gl_FragColor = v_colour;
  }
  `}var BP=S1;function bwe(e){var t;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))t=Ro().resolve(e);else{var n=_t.createIfNeeded(e);t=n.fetchArrayBuffer()}if(!!_(t))return t.then(function(r){if(_(r))return Dwe(r)})}var sj=[171,75,84,88,32,49,49,187,13,10,26,10],Iwe=67305985,uj=["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"],Tc=4;function Dwe(e){var t=new Uint8Array(e),n=!0,r;for(r=0;r<sj.length;++r)if(sj[r]!==t[r]){n=!1;break}if(!n)throw new it("Invalid KTX file.");var o,a;_(e.buffer)?(o=new DataView(e.buffer),a=e.byteOffset):(o=new DataView(e),a=0),a+=12;var s=o.getUint32(a,!0);if(a+=Tc,s!==Iwe)throw new it("File is the wrong endianness.");var u=o.getUint32(a,!0);a+=Tc;var l=o.getUint32(a,!0);a+=Tc;var c=o.getUint32(a,!0);a+=Tc;var f=o.getUint32(a,!0);a+=Tc;var h=o.getUint32(a,!0);a+=Tc;var d=o.getUint32(a,!0);a+=Tc;var p=o.getUint32(a,!0);a+=Tc;var g=o.getUint32(a,!0);a+=Tc;var y=o.getUint32(a,!0);a+=Tc;var v=o.getUint32(a,!0);a+=Tc;var w=o.getUint32(a,!0);a+=Tc;var C=o.getUint32(a,!0);a+=Tc,a+=C;var E=o.getUint32(a,!0);a+=Tc;var S;if(_(e.buffer)?S=new Uint8Array(e.buffer,a,E):S=new Uint8Array(e,a,E),f===V.RGB8?f=Gt.RGB:f===V.RGBA8&&(f=Gt.RGBA),!Gt.validate(f))throw new it("glInternalFormat is not a valid format.");if(Gt.isCompressedFormat(f)){if(u!==0)throw new it("glType must be zero when the texture is compressed.");if(l!==1)throw new it("The type size for compressed textures must be 1.");if(c!==0)throw new it("glFormat must be zero when the texture is compressed.")}else{if(u!==V.UNSIGNED_BYTE)throw new it("Only unsigned byte buffers are supported.");if(h!==c)throw new it("The base internal format must be the same as the format for uncompressed textures.")}if(g!==0)throw new it("3D textures are unsupported.");if(y!==0)throw new it("Texture arrays are unsupported.");var A=S.byteOffset,D=new Array(w);for(r=0;r<w;++r){for(var P=D[r]={},M=0;M<v;++M){var I=d>>r,O=p>>r;I<1&&(I=1),O<1&&(O=1);var m=Gt.isCompressedFormat(f)?Gt.compressedTextureSizeInBytes(f,I,O):Gt.textureSizeInBytes(f,u,I,O),b=new Uint8Array(S.buffer,A,m);P[uj[M]]=new OI(f,vt.UNSIGNED_BYTE,I,O,b),A+=m}_(e.buffer)?A+=4:A+=3-(A+3)%4+4}var L=D;if(v===1)for(r=0;r<w;++r)L[r]=L[r][uj[0]];return w===1&&(L=L[0]),L}var FP=bwe;var Pwe={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},uf=Object.freeze(Pwe);var Mwe={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},uu=Object.freeze(Mwe);function cB(e){e=T(e,T.EMPTY_OBJECT);let t=e.currentTime,n=e.startTime,r=e.stopTime;_(t)?t=fe.clone(t):_(n)?t=fe.clone(n):_(r)?t=fe.addDays(r,-1,new fe):t=fe.now(),_(n)?n=fe.clone(n):n=fe.clone(t),_(r)?r=fe.clone(r):r=fe.addDays(n,1,new fe),this.startTime=n,this.stopTime=r,this.clockRange=T(e.clockRange,uf.UNBOUNDED),this.canAnimate=T(e.canAnimate,!0),this.onTick=new xe,this.onStop=new xe,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=pC(),this.currentTime=t,this.multiplier=T(e.multiplier,1),this.shouldAnimate=T(e.shouldAnimate,!1),this.clockStep=T(e.clockStep,uu.SYSTEM_CLOCK_MULTIPLIER)}Object.defineProperties(cB.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){fe.equals(this._currentTime,e)||(this._clockStep===uu.SYSTEM_CLOCK&&(this._clockStep=uu.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===uu.SYSTEM_CLOCK&&(this._clockStep=uu.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===uu.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=fe.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===uu.SYSTEM_CLOCK&&(this._clockStep=uu.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}});cB.prototype.tick=function(){let e=pC(),t=fe.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){let n=this._clockStep;if(n===uu.SYSTEM_CLOCK)t=fe.now(t);else{let r=this._multiplier;if(n===uu.TICK_DEPENDENT)t=fe.addSeconds(t,r,t);else{let u=e-this._lastSystemTime;t=fe.addSeconds(t,r*(u/1e3),t)}let o=this.clockRange,a=this.startTime,s=this.stopTime;if(o===uf.CLAMPED)fe.lessThan(t,a)?t=fe.clone(a,t):fe.greaterThan(t,s)&&(t=fe.clone(s,t),this.onStop.raiseEvent(this));else if(o===uf.LOOP_STOP)for(fe.lessThan(t,a)&&(t=fe.clone(a,t));fe.greaterThan(t,s);)t=fe.addSeconds(a,fe.secondsDifference(t,s),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};var A1=cB;function fl(e,t,n){this.clock=T(e,0),this.cone=T(t,0),this.magnitude=T(n,1)}fl.fromCartesian3=function(e,t){let n=e.x,r=e.y,o=e.z,a=n*n+r*r;return _(t)||(t=new fl),t.clock=Math.atan2(r,n),t.cone=Math.atan2(Math.sqrt(a),o),t.magnitude=Math.sqrt(a+o*o),t};fl.clone=function(e,t){if(!!_(e))return _(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new fl(e.clock,e.cone,e.magnitude)};fl.normalize=function(e,t){return _(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new fl(e.clock,e.cone,1)};fl.equals=function(e,t){return e===t||_(e)&&_(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude};fl.equalsEpsilon=function(e,t,n){return n=T(n,0),e===t||_(e)&&_(t)&&Math.abs(e.clock-t.clock)<=n&&Math.abs(e.cone-t.cone)<=n&&Math.abs(e.magnitude-t.magnitude)<=n};fl.prototype.equals=function(e){return fl.equals(this,e)};fl.prototype.clone=function(e){return fl.clone(this,e)};fl.prototype.equalsEpsilon=function(e,t){return fl.equalsEpsilon(this,e,t)};fl.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};var lj=fl;function Do(e){e=T(e,T.EMPTY_OBJECT),this.start=_(e.start)?fe.clone(e.start):new fe,this.stop=_(e.stop)?fe.clone(e.stop):new fe,this.data=e.data,this.isStartIncluded=T(e.isStartIncluded,!0),this.isStopIncluded=T(e.isStopIncluded,!0)}Object.defineProperties(Do.prototype,{isEmpty:{get:function(){let e=fe.compare(this.stop,this.start);return e<0||e===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var b1={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};Do.fromIso8601=function(e,t){let n=e.iso8601.split("/");if(n.length!==2)throw new Le("options.iso8601 is an invalid ISO 8601 interval.");let r=fe.fromIso8601(n[0]),o=fe.fromIso8601(n[1]),a=T(e.isStartIncluded,!0),s=T(e.isStopIncluded,!0),u=e.data;return _(t)?(t.start=r,t.stop=o,t.isStartIncluded=a,t.isStopIncluded=s,t.data=u,t):(b1.start=r,b1.stop=o,b1.isStartIncluded=a,b1.isStopIncluded=s,b1.data=u,new Do(b1))};Do.toIso8601=function(e,t){return`${fe.toIso8601(e.start,t)}/${fe.toIso8601(e.stop,t)}`};Do.clone=function(e,t){if(!!_(e))return _(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new Do(e)};Do.equals=function(e,t,n){return e===t||_(e)&&_(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&fe.equals(e.start,t.start)&&fe.equals(e.stop,t.stop)&&(e.data===t.data||_(n)&&n(e.data,t.data)))};Do.equalsEpsilon=function(e,t,n,r){return n=T(n,0),e===t||_(e)&&_(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&fe.equalsEpsilon(e.start,t.start,n)&&fe.equalsEpsilon(e.stop,t.stop,n)&&(e.data===t.data||_(r)&&r(e.data,t.data)))};Do.intersect=function(e,t,n,r){if(!_(t))return Do.clone(Do.EMPTY,n);let o=e.start,a=e.stop,s=t.start,u=t.stop,l=fe.greaterThanOrEquals(s,o)&&fe.greaterThanOrEquals(a,s),c=!l&&fe.lessThanOrEquals(s,o)&&fe.lessThanOrEquals(o,u);if(!l&&!c)return Do.clone(Do.EMPTY,n);let f=e.isStartIncluded,h=e.isStopIncluded,d=t.isStartIncluded,p=t.isStopIncluded,g=fe.lessThan(a,u);return _(n)||(n=new Do),n.start=l?s:o,n.isStartIncluded=f&&d||!fe.equals(s,o)&&(l&&d||c&&f),n.stop=g?a:u,n.isStopIncluded=g?h:h&&p||!fe.equals(u,a)&&p,n.data=_(r)?r(e.data,t.data):e.data,n};Do.contains=function(e,t){if(e.isEmpty)return!1;let n=fe.compare(e.start,t);if(n===0)return e.isStartIncluded;let r=fe.compare(t,e.stop);return r===0?e.isStopIncluded:n<0&&r<0};Do.prototype.clone=function(e){return Do.clone(this,e)};Do.prototype.equals=function(e,t){return Do.equals(this,e,t)};Do.prototype.equalsEpsilon=function(e,t,n){return Do.equalsEpsilon(this,e,t,n)};Do.prototype.toString=function(){return Do.toIso8601(this)};Do.EMPTY=Object.freeze(new Do({start:new fe,stop:new fe,isStartIncluded:!1,isStopIncluded:!1}));var ri=Do;var Lwe=z.factorial;function fB(e,t,n,r,o,a){let s=0,u,l,c;if(r>0){for(l=0;l<o;l++){for(u=!1,c=0;c<a.length&&!u;c++)l===a[c]&&(u=!0);u||(a.push(l),s+=fB(e,t,n,r-1,o,a),a.splice(a.length-1,1))}return s}for(s=1,l=0;l<o;l++){for(u=!1,c=0;c<a.length&&!u;c++)l===a[c]&&(u=!0);u||(s*=e-n[t[l]])}return s}var zP={type:"Hermite"};zP.getRequiredDataPoints=function(e,t){return t=T(t,0),Math.max(Math.floor((e+1)/(t+1)),2)};zP.interpolateOrderZero=function(e,t,n,r,o){_(o)||(o=new Array(r));let a,s,u,l,c,f,h=t.length,d=new Array(r);for(a=0;a<r;a++){o[a]=0;let v=new Array(h);for(d[a]=v,s=0;s<h;s++)v[s]=[]}let p=h,g=new Array(p);for(a=0;a<p;a++)g[a]=a;let y=h-1;for(l=0;l<r;l++){for(s=0;s<p;s++)f=g[s]*r+l,d[l][0].push(n[f]);for(a=1;a<p;a++){let v=!1;for(s=0;s<p-a;s++){let w=t[g[s]],C=t[g[s+a]],E;C-w<=0?(f=g[s]*r+r*a+l,E=n[f],d[l][a].push(E/Lwe(a))):(E=d[l][a-1][s+1]-d[l][a-1][s],d[l][a].push(E/(C-w))),v=v||E!==0}v||(y=a-1)}}for(u=0,c=0;u<=c;u++)for(a=u;a<=y;a++){let v=fB(e,g,t,u,a,[]);for(l=0;l<r;l++){let w=d[l][a][0];o[l+u*r]+=w*v}}return o};var Rwe=[];zP.interpolate=function(e,t,n,r,o,a,s){let u=r*(a+1);_(s)||(s=new Array(u));for(let w=0;w<u;w++)s[w]=0;let l=t.length,c=new Array(l*(o+1)),f;for(f=0;f<l;f++)for(let w=0;w<o+1;w++)c[f*(o+1)+w]=f;let h=c.length,d=Rwe,p=Owe(d,c,t,n,r,o),g=[],y=h*(h+1)/2,v=Math.min(p,a);for(let w=0;w<=v;w++)for(f=w;f<=p;f++){g.length=0;let C=fB(e,c,t,w,f,g),E=Math.floor(f*(1-f)/2)+h*f;for(let S=0;S<r;S++){let A=Math.floor(S*y),D=d[A+E];s[S+w*r]+=D*C}}return s};function Owe(e,t,n,r,o,a){let s,u,l=-1,c=t.length,f=c*(c+1)/2;for(let h=0;h<o;h++){let d=Math.floor(h*f);for(s=0;s<c;s++)u=t[s]*o*(a+1)+h,e[d+s]=r[u];for(let p=1;p<c;p++){let g=0,y=Math.floor(p*(1-p)/2)+c*p,v=!1;for(s=0;s<c-p;s++){let w=n[t[s]],C=n[t[s+p]],E,S;if(C-w<=0)u=t[s]*o*(a+1)+o*p+h,E=r[u],S=E/z.factorial(p),e[d+y+g]=S,g++;else{let A=Math.floor((p-1)*(2-p)/2)+c*(p-1);E=e[d+A+s+1]-e[d+A+s],S=E/(C-w),e[d+y+g]=S,g++}v=v||E!==0}v&&(l=Math.max(l,p))}}return l}var cj=zP;var hB={type:"Lagrange"};hB.getRequiredDataPoints=function(e){return Math.max(e+1,2)};hB.interpolateOrderZero=function(e,t,n,r,o){_(o)||(o=new Array(r));let a,s,u=t.length;for(a=0;a<r;a++)o[a]=0;for(a=0;a<u;a++){let l=1;for(s=0;s<u;s++)if(s!==a){let c=t[a]-t[s];l*=(e-t[s])/c}for(s=0;s<r;s++)o[s]+=l*n[a*r+s]}return o};var fj=hB;var dB={type:"Linear"};dB.getRequiredDataPoints=function(e){return 2};dB.interpolateOrderZero=function(e,t,n,r,o){_(o)||(o=new Array(r));let a,s,u,l=t[0],c=t[1];for(a=0;a<r;a++)s=n[a],u=n[a+r],o[a]=((u-s)*e+c*s-l*u)/(c-l);return o};var VP=dB;var Nwe={ROUNDED:0,MITERED:1,BEVELED:2,EV_ARC:3},Ai=Object.freeze(Nwe);var Bwe={NONE:0,HOLD:1,EXTRAPOLATE:2},Lp=Object.freeze(Bwe);var hj=Object.freeze(fe.fromIso8601("0000-01-01T00:00:00Z")),dj=Object.freeze(fe.fromIso8601("9999-12-31T24:00:00Z")),Fwe=Object.freeze(new ri({start:hj,stop:dj})),zwe={MINIMUM_VALUE:hj,MAXIMUM_VALUE:dj,MAXIMUM_INTERVAL:Fwe},ps=zwe;function gB(e,t){return fe.compare(e.start,t.start)}function wa(e){if(this._intervals=[],this._changedEvent=new xe,_(e)){let t=e.length;for(let n=0;n<t;n++)this.addInterval(e[n])}}Object.defineProperties(wa.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){let e=this._intervals;return e.length===0?void 0:e[0].start}},isStartIncluded:{get:function(){let e=this._intervals;return e.length===0?!1:e[0].isStartIncluded}},stop:{get:function(){let e=this._intervals,t=e.length;return t===0?void 0:e[t-1].stop}},isStopIncluded:{get:function(){let e=this._intervals,t=e.length;return t===0?!1:e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});wa.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof wa))return!1;let n=this._intervals,r=e._intervals,o=n.length;if(o!==r.length)return!1;for(let a=0;a<o;a++)if(!ri.equals(n[a],r[a],t))return!1;return!0};wa.prototype.get=function(e){return this._intervals[e]};wa.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))};wa.prototype.findIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t]:void 0};wa.prototype.findDataForIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0};wa.prototype.contains=function(e){return this.indexOf(e)>=0};var pB=new ri;wa.prototype.indexOf=function(e){let t=this._intervals;pB.start=e,pB.stop=e;let n=Au(t,pB,gB);return n>=0?t[n].isStartIncluded?n:n>0&&t[n-1].stop.equals(e)&&t[n-1].isStopIncluded?n-1:~n:(n=~n,n>0&&n-1<t.length&&ri.contains(t[n-1],e)?n-1:~n)};wa.prototype.findInterval=function(e){e=T(e,T.EMPTY_OBJECT);let t=e.start,n=e.stop,r=e.isStartIncluded,o=e.isStopIncluded,a=this._intervals;for(let s=0,u=a.length;s<u;s++){let l=a[s];if((!_(t)||l.start.equals(t))&&(!_(n)||l.stop.equals(n))&&(!_(r)||l.isStartIncluded===r)&&(!_(o)||l.isStopIncluded===o))return a[s]}};wa.prototype.addInterval=function(e,t){if(e.isEmpty)return;let n=this._intervals;if(n.length===0||fe.greaterThan(e.start,n[n.length-1].stop)){n.push(e),this._changedEvent.raiseEvent(this);return}let r=Au(n,e,gB);r<0?r=~r:r>0&&e.isStartIncluded&&n[r-1].isStartIncluded&&n[r-1].start.equals(e.start)?--r:r<n.length&&!e.isStartIncluded&&n[r].isStartIncluded&&n[r].start.equals(e.start)&&++r;let o;for(r>0&&(o=fe.compare(n[r-1].stop,e.start),(o>0||o===0&&(n[r-1].isStopIncluded||e.isStartIncluded))&&((_(t)?t(n[r-1].data,e.data):n[r-1].data===e.data)?(fe.greaterThan(e.stop,n[r-1].stop)?e=new ri({start:n[r-1].start,stop:e.stop,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):e=new ri({start:n[r-1].start,stop:n[r-1].stop,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:n[r-1].isStopIncluded||e.stop.equals(n[r-1].stop)&&e.isStopIncluded,data:e.data}),n.splice(r-1,1),--r):(o=fe.compare(n[r-1].stop,e.stop),(o>0||o===0&&n[r-1].isStopIncluded&&!e.isStopIncluded)&&n.splice(r,0,new ri({start:e.stop,stop:n[r-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[r-1].isStopIncluded,data:n[r-1].data})),n[r-1]=new ri({start:n[r-1].start,stop:e.start,isStartIncluded:n[r-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[r-1].data}))));r<n.length&&(o=fe.compare(e.stop,n[r].start),o>0||o===0&&(e.isStopIncluded||n[r].isStartIncluded));)if(_(t)?t(n[r].data,e.data):n[r].data===e.data)e=new ri({start:e.start,stop:fe.greaterThan(n[r].stop,e.stop)?n[r].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:fe.greaterThan(n[r].stop,e.stop)?n[r].isStopIncluded:e.isStopIncluded,data:e.data}),n.splice(r,1);else if(n[r]=new ri({start:e.stop,stop:n[r].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[r].isStopIncluded,data:n[r].data}),n[r].isEmpty)n.splice(r,1);else break;n.splice(r,0,e),this._changedEvent.raiseEvent(this)};wa.prototype.removeInterval=function(e){if(e.isEmpty)return!1;let t=this._intervals,n=Au(t,e,gB);n<0&&(n=~n);let r=!1;for(n>0&&(fe.greaterThan(t[n-1].stop,e.start)||t[n-1].stop.equals(e.start)&&t[n-1].isStopIncluded&&e.isStartIncluded)&&(r=!0,(fe.greaterThan(t[n-1].stop,e.stop)||t[n-1].isStopIncluded&&!e.isStopIncluded&&t[n-1].stop.equals(e.stop))&&t.splice(n,0,new ri({start:e.stop,stop:t[n-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n-1].isStopIncluded,data:t[n-1].data})),t[n-1]=new ri({start:t[n-1].start,stop:e.start,isStartIncluded:t[n-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[n-1].data})),n<t.length&&!e.isStartIncluded&&t[n].isStartIncluded&&e.start.equals(t[n].start)&&(r=!0,t.splice(n,0,new ri({start:t[n].start,stop:t[n].start,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data})),++n);n<t.length&&fe.greaterThan(e.stop,t[n].stop);)r=!0,t.splice(n,1);return n<t.length&&e.stop.equals(t[n].stop)&&(r=!0,!e.isStopIncluded&&t[n].isStopIncluded?n+1<t.length&&t[n+1].start.equals(e.stop)&&t[n].data===t[n+1].data?(t.splice(n,1),t[n]=new ri({start:t[n].start,stop:t[n].stop,isStartIncluded:!0,isStopIncluded:t[n].isStopIncluded,data:t[n].data})):t[n]=new ri({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data}):t.splice(n,1)),n<t.length&&(fe.greaterThan(e.stop,t[n].start)||e.stop.equals(t[n].start)&&e.isStopIncluded&&t[n].isStartIncluded)&&(r=!0,t[n]=new ri({start:e.stop,stop:t[n].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n].isStopIncluded,data:t[n].data})),r&&this._changedEvent.raiseEvent(this),r};wa.prototype.intersect=function(e,t,n){let r=new wa,o=0,a=0,s=this._intervals,u=e._intervals;for(;o<s.length&&a<u.length;){let l=s[o],c=u[a];if(fe.lessThan(l.stop,c.start))++o;else if(fe.lessThan(c.stop,l.start))++a;else{if(_(n)||_(t)&&t(l.data,c.data)||!_(t)&&c.data===l.data){let f=ri.intersect(l,c,new ri,n);f.isEmpty||r.addInterval(f,t)}fe.lessThan(l.stop,c.stop)||l.stop.equals(c.stop)&&!l.isStopIncluded&&c.isStopIncluded?++o:++a}}return r};wa.fromJulianDateArray=function(e,t){_(t)||(t=new wa);let n=e.julianDates,r=n.length,o=e.dataCallback,a=T(e.isStartIncluded,!0),s=T(e.isStopIncluded,!0),u=T(e.leadingInterval,!1),l=T(e.trailingInterval,!1),c,f=0;u&&(++f,c=new ri({start:ps.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!a}),c.data=_(o)?o(c,t.length):t.length,t.addInterval(c));for(let h=0;h<r-1;++h){let d=n[h],p=n[h+1];c=new ri({start:d,stop:p,isStartIncluded:t.length===f?a:!0,isStopIncluded:h===r-2?s:!1}),c.data=_(o)?o(c,t.length):t.length,t.addInterval(c),d=p}return l&&(c=new ri({start:n[r-1],stop:ps.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0}),c.data=_(o)?o(c,t.length):t.length,t.addInterval(c)),t};var hl=new Jv,XT=[0,31,28,31,30,31,30,31,31,30,31,30,31];function mB(e,t,n){_(n)||(n=new fe),fe.toGregorianDate(e,hl);let r=hl.millisecond+t.millisecond,o=hl.second+t.second,a=hl.minute+t.minute,s=hl.hour+t.hour,u=hl.day+t.day,l=hl.month+t.month,c=hl.year+t.year;for(r>=1e3&&(o+=Math.floor(r/1e3),r=r%1e3),o>=60&&(a+=Math.floor(o/60),o=o%60),a>=60&&(s+=Math.floor(a/60),a=a%60),s>=24&&(u+=Math.floor(s/24),s=s%24),XT[2]=$v(c)?29:28;u>XT[l]||l>=13;)u>XT[l]&&(u-=XT[l],++l),l>=13&&(--l,c+=Math.floor(l/12),l=l%12,++l),XT[2]=$v(c)?29:28;return hl.millisecond=r,hl.second=o,hl.minute=a,hl.hour=s,hl.day=u,hl.month=l,hl.year=c,fe.fromGregorianDate(hl,n)}var Vwe=new fe,kwe=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function pj(e,t){if(!_(e)||e.length===0)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,e[0]==="P"){let n=e.match(kwe);if(!_(n))return!1;if(_(n[1])&&(t.year=Number(n[1].replace(",","."))),_(n[2])&&(t.month=Number(n[2].replace(",","."))),_(n[3])&&(t.day=Number(n[3].replace(",","."))*7),_(n[4])&&(t.day+=Number(n[4].replace(",","."))),_(n[5])&&(t.hour=Number(n[5].replace(",","."))),_(n[6])&&(t.minute=Number(n[6].replace(",","."))),_(n[7])){let r=Number(n[7].replace(",","."));t.second=Math.floor(r),t.millisecond=r%1*1e3}}else e[e.length-1]!=="Z"&&(e+="Z"),fe.toGregorianDate(fe.fromIso8601(e,Vwe),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var jT=new Jv;wa.fromIso8601=function(e,t){let n=e.iso8601.split("/"),r=fe.fromIso8601(n[0]),o=fe.fromIso8601(n[1]),a=[];if(!pj(n[2],jT))a.push(r,o);else{let s=fe.clone(r);for(a.push(s);fe.compare(s,o)<0;)s=mB(s,jT),fe.compare(o,s)<=0&&fe.clone(o,s),a.push(s)}return wa.fromJulianDateArray({julianDates:a,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};wa.fromIso8601DateArray=function(e,t){return wa.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(n){return fe.fromIso8601(n)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};wa.fromIso8601DurationArray=function(e,t){let n=e.epoch,r=e.iso8601Durations,o=T(e.relativeToPrevious,!1),a=[],s,u,l=r.length;for(let c=0;c<l;++c)(pj(r[c],jT)||c===0)&&(o&&_(u)?s=mB(u,jT):s=mB(n,jT),a.push(s),u=s);return wa.fromJulianDateArray({julianDates:a,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};var eg=wa;function Gwe(e){let t=new Qi.default(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return r!==-1&&(n=n.substr(r+1)),n}var mj=Gwe;function Rp(e,t){this._ellipsoid=e,this._cameraPosition=new x,this._cameraPositionInScaledSpace=new x,this._distanceToLimbInScaledSpaceSquared=0,_(t)&&(this.cameraPosition=t)}Object.defineProperties(Rp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),r=x.magnitudeSquared(n)-1;x.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=n,this._distanceToLimbInScaledSpaceSquared=r}}});var gj=new x;Rp.prototype.isPointVisible=function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,gj);return yB(n,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};Rp.prototype.isScaledSpacePointVisible=function(e){return yB(e,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var Uwe=new x;Rp.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(e,t){let n=this._ellipsoid,r,o;return _(t)&&t<0&&n.minimumRadius>-t?(o=Uwe,o.x=this._cameraPosition.x/(n.radii.x+t),o.y=this._cameraPosition.y/(n.radii.y+t),o.z=this._cameraPosition.z/(n.radii.z+t),r=o.x*o.x+o.y*o.y+o.z*o.z-1):(o=this._cameraPositionInScaledSpace,r=this._distanceToLimbInScaledSpaceSquared),yB(e,o,r)};Rp.prototype.computeHorizonCullingPoint=function(e,t,n){return vj(this._ellipsoid,e,t,n)};var _j=Ge.clone(Ge.UNIT_SPHERE);Rp.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(e,t,n,r){let o=yj(this._ellipsoid,n,_j);return vj(o,e,t,r)};Rp.prototype.computeHorizonCullingPointFromVertices=function(e,t,n,r,o){return Cj(this._ellipsoid,e,t,n,r,o)};Rp.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(e,t,n,r,o,a){let s=yj(this._ellipsoid,o,_j);return Cj(s,e,t,n,r,a)};var Hwe=[];Rp.prototype.computeHorizonCullingPointFromRectangle=function(e,t,n){let r=ln.subsample(e,t,0,Hwe),o=Ee.fromPoints(r);if(!(x.magnitude(o.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(o.center,r,n)};var qwe=new x;function yj(e,t,n){if(_(t)&&t<0&&e.minimumRadius>-t){let r=x.fromElements(e.radii.x+t,e.radii.y+t,e.radii.z+t,qwe);e=Ge.fromCartesian3(r,n)}return e}function vj(e,t,n,r){_(r)||(r=new x);let o=Ej(e,t),a=0;for(let s=0,u=n.length;s<u;++s){let l=n[s],c=xj(e,l,o);if(c<0)return;a=Math.max(a,c)}return wj(o,a,r)}var kP=new x;function Cj(e,t,n,r,o,a){_(a)||(a=new x),r=T(r,3),o=T(o,x.ZERO);let s=Ej(e,t),u=0;for(let l=0,c=n.length;l<c;l+=r){kP.x=n[l]+o.x,kP.y=n[l+1]+o.y,kP.z=n[l+2]+o.z;let f=xj(e,kP,s);if(f<0)return;u=Math.max(u,f)}return wj(s,u,a)}function yB(e,t,n){let r=t,o=n,a=x.subtract(e,r,gj),s=-x.dot(a,r);return!(o<0?s>0:s>o&&s*s/x.magnitudeSquared(a)>o)}var Wwe=new x,Ywe=new x;function xj(e,t,n){let r=e.transformPositionToScaledSpace(t,Wwe),o=x.magnitudeSquared(r),a=Math.sqrt(o),s=x.divideByScalar(r,a,Ywe);o=Math.max(1,o),a=Math.max(1,a);let u=x.dot(s,n),l=x.magnitude(x.cross(s,n,s)),c=1/a,f=Math.sqrt(o-1)*c;return 1/(u*c-l*f)}function wj(e,t,n){if(!(t<=0||t===1/0||t!==t))return x.multiplyByScalar(e,t,n)}var _B=new x;function Ej(e,t){return x.equals(t,x.ZERO)?t:(e.transformPositionToScaledSpace(t,_B),x.normalize(_B,_B))}var vB=Rp;function tr(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;_(n)&&(n=Tt.clone(n)),_(r)&&(r=Tt.clone(r)),_(o)&&(o=Tt.clone(o)),_(a)&&(a=gn.clone(a)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._translate=new X(0,0),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._heightReference=T(e.heightReference,Pt.NONE),this._verticalOrigin=T(e.verticalOrigin,an.CENTER),this._horizontalOrigin=T(e.horizontalOrigin,ho.CENTER),this._scale=T(e.scale,1),this._color=K.clone(T(e.color,K.WHITE)),this._rotation=T(e.rotation,0),this._alignedAxis=x.clone(T(e.alignedAxis,x.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=o,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._sizeInMeters=T(e.sizeInMeters,!1),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=T(e.collection,t),this._pickId=void 0,this._pickPrimitive=T(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0,this._clusterId=void 0;let s=e.image,u=e.imageId;_(s)&&(_(u)||(typeof s=="string"?u=s:_(s.src)?u=s.src:u=_i()),this._imageId=u,this._image=s),_(e.imageSubRegion)&&(this._imageId=u,this._imageSubRegion=e.imageSubRegion),_(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=Ne.SCENE3D,this._clusterShow=!0,this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,0),this._animation=T(e.animation,!1),this._updateClamping()}var Tj=tr.SHOW_INDEX=0,UP=tr.POSITION_INDEX=1,Dj=tr.PIXEL_OFFSET_INDEX=2,Xwe=tr.EYE_OFFSET_INDEX=3,jwe=tr.HORIZONTAL_ORIGIN_INDEX=4,Kwe=tr.VERTICAL_ORIGIN_INDEX=5,Zwe=tr.SCALE_INDEX=6,HP=tr.IMAGE_INDEX_INDEX=7,Sj=tr.COLOR_INDEX=8,Qwe=tr.ROTATION_INDEX=9,Jwe=tr.ALIGNED_AXIS_INDEX=10,$we=tr.SCALE_BY_DISTANCE_INDEX=11,eEe=tr.TRANSLUCENCY_BY_DISTANCE_INDEX=12,tEe=tr.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,nEe=tr.DISTANCE_DISPLAY_CONDITION=14,rEe=tr.DISABLE_DEPTH_DISTANCE=15;tr.TEXTURE_COORDINATE_BOUNDS=16;var Aj=tr.SDF_INDEX=17;tr.NUMBER_OF_PROPERTIES=18;function Co(e,t){let n=e._billboardCollection;_(n)&&(n._updateBillboard(e,t),e._dirty=!0)}Object.defineProperties(tr.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,Co(this,Tj))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),this._updateClamping(),Co(this,UP))}},heightReference:{get:function(){return this._heightReference},set:function(e){let t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),Co(this,UP))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;X.equals(t,e)||(X.clone(e,t),Co(this,Dj))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;Tt.equals(t,e)||(this._scaleByDistance=Tt.clone(e,t),Co(this,$we))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;Tt.equals(t,e)||(this._translucencyByDistance=Tt.clone(e,t),Co(this,eEe))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;Tt.equals(t,e)||(this._pixelOffsetScaleByDistance=Tt.clone(e,t),Co(this,tEe))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;x.equals(t,e)||(x.clone(e,t),Co(this,Xwe))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,Co(this,jwe))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,Co(this,Kwe))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,Co(this,Zwe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),Co(this,Sj))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,Co(this,Qwe))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;x.equals(t,e)||(x.clone(e,t),Co(this,Jwe))}},width:{get:function(){return T(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,Co(this,HP))}},height:{get:function(){return T(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,Co(this,HP))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,Co(this,Sj))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){gn.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=gn.clone(e,this._distanceDisplayCondition),Co(this,nEe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,Co(this,rEe))}},id:{get:function(){return this._id},set:function(e){this._id=e,_(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,_(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){_(e)?typeof e=="string"?this.setImage(e,e):e instanceof _t?this.setImage(e.url,e):_(e.src)?this.setImage(e.src,e):this.setImage(_i(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,Co(this,HP))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition),Co(this,UP)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,Co(this,Tj))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),Co(this,Aj))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Co(this,Aj))}},animation:{get:function(){return this._animation},set:function(e){this._animation!==e&&(this._animation=e)}}});tr.prototype.getPickId=function(e){return _(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};tr.prototype._updateClamping=function(){tr._updateClamping(this._billboardCollection,this)};var KT=new ce,bj=new x;tr._updateClamping=function(e,t){let n=e._scene;if(!_(n)||!_(n.globe))return;let r=n.globe,o=r.ellipsoid,a=r._surface,s=n.frameState.mode,u=s!==t._mode;if(t._mode=s,(t._heightReference===Pt.NONE||u)&&_(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===Pt.NONE||!_(t._position))return;let l=o.cartesianToCartographic(t._position);if(!_(l)){t._actualClampedPosition=void 0;return}_(t._removeCallbackFunc)&&t._removeCallbackFunc();function c(h){if(t._heightReference===Pt.RELATIVE_TO_GROUND)if(t._mode===Ne.SCENE3D){let d=o.cartesianToCartographic(h,KT);d.height+=l.height,o.cartographicToCartesian(d,h)}else h.x+=l.height;t._clampedPosition=x.clone(h,t._clampedPosition)}t._removeCallbackFunc=a.updateHeight(l,c),ce.clone(l,KT);let f=r.getHeight(l);_(f)&&(KT.height=f),o.cartographicToCartesian(KT,bj),c(bj)};tr.prototype._loadImage=function(){let e=this._billboardCollection._textureAtlas,t=this._imageId,n=this._image,r=this._imageSubRegion,o,a=this;function s(u){if(a._imageId!==t||a._image!==n||!en.equals(a._imageSubRegion,r))return;let l=e.textureCoordinates[u];a._imageWidth=e.texture.width*l.width,a._imageHeight=e.texture.height*l.height,a._imageIndex=u,a._ready=!0,a._imageIndexPromise=void 0,Co(a,HP)}if(_(n)){let u=e.getImageIndex(t);if(_(u)){s(u);return}o=e.addImage(t,n)}_(r)&&(o=e.addSubRegion(t,r)),this._imageIndexPromise=o,_(o)&&o.then(s).catch(function(u){console.error(`Error loading image for billboard: ${u}`),a._imageIndexPromise=void 0})};tr.prototype._updateImage=function(){this._billboardCollection._textureAtlas.updateImage(this._imageIndex,this._image)};tr.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,_(this._billboardCollection._textureAtlas)&&this._loadImage())};tr.prototype.setImageSubRegion=function(e,t){this._imageId===e&&en.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=en.clone(t),_(this._billboardCollection._textureAtlas)&&this._loadImage())};tr.prototype._setTranslate=function(e){let t=this._translate;X.equals(t,e)||(X.clone(e,t),Co(this,Dj))};tr.prototype._getActualPosition=function(){return _(this._clampedPosition)?this._clampedPosition:this._actualPosition};tr.prototype._setActualPosition=function(e){_(this._clampedPosition)||x.clone(e,this._actualPosition),Co(this,UP)};var Ij=new Se;tr._computeActualPosition=function(e,t,n,r){return _(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===Ne.SCENE3D?t:(U.multiplyByPoint(r,t,Ij),Mf.computeActualWgs84Position(n,Ij))};var Pj=new x;tr._computeScreenSpacePosition=function(e,t,n,r,o,a){let s=U.multiplyByPoint(e,t,Pj),u=Mf.wgs84WithEyeOffsetToWindowCoordinates(o,s,n,a);if(!!_(u))return X.add(u,r,u),u};var GP=new X(0,0);tr.prototype.computeScreenSpacePosition=function(e,t){let n=this._billboardCollection;_(t)||(t=new X),X.clone(this._pixelOffset,GP),X.add(GP,this._translate,GP);let r=n.modelMatrix,o=this._position;if(_(this._clampedPosition)&&(o=this._clampedPosition,e.mode!==Ne.SCENE3D)){let s=e.mapProjection,u=s.ellipsoid,l=s.unproject(o,KT);o=u.cartographicToCartesian(l,Pj),r=U.IDENTITY}return tr._computeScreenSpacePosition(r,o,this._eyeOffset,GP,e,t)};tr.getScreenSpaceBoundingBox=function(e,t,n){let r=e.width,o=e.height,a=e.scale;r*=a,o*=a;let s=t.x;e.horizontalOrigin===ho.RIGHT?s-=r:e.horizontalOrigin===ho.CENTER&&(s-=r*.5);let u=t.y;return e.verticalOrigin===an.BOTTOM||e.verticalOrigin===an.BASELINE?u-=o:e.verticalOrigin===an.CENTER&&(u-=o*.5),_(n)||(n=new en),n.x=s,n.y=u,n.width=r,n.height=o,n};tr.prototype.equals=function(e){return this===e||_(e)&&this._id===e._id&&x.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&en.equals(this._imageSubRegion,e._imageSubRegion)&&K.equals(this._color,e._color)&&X.equals(this._pixelOffset,e._pixelOffset)&&X.equals(this._translate,e._translate)&&x.equals(this._eyeOffset,e._eyeOffset)&&Tt.equals(this._scaleByDistance,e._scaleByDistance)&&Tt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Tt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&gn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};tr.prototype._destroy=function(){_(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),_(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var uo=tr;var iEe=uo.SHOW_INDEX,QT=uo.POSITION_INDEX,Mj=uo.PIXEL_OFFSET_INDEX,Lj=uo.EYE_OFFSET_INDEX,oEe=uo.HORIZONTAL_ORIGIN_INDEX,aEe=uo.VERTICAL_ORIGIN_INDEX,sEe=uo.SCALE_INDEX,ZT=uo.IMAGE_INDEX_INDEX,Rj=uo.COLOR_INDEX,uEe=uo.ROTATION_INDEX,lEe=uo.ALIGNED_AXIS_INDEX,Oj=uo.SCALE_BY_DISTANCE_INDEX,Nj=uo.TRANSLUCENCY_BY_DISTANCE_INDEX,Bj=uo.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,Fj=uo.DISTANCE_DISPLAY_CONDITION,cEe=uo.DISABLE_DEPTH_DISTANCE,fEe=uo.TEXTURE_COORDINATE_BOUNDS,zj=uo.SDF_INDEX,AB=uo.NUMBER_OF_PROPERTIES,Zi,hEe={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},dEe={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function lh(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(AB),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._modelMatrix=U.clone(U.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=T(e.debugShowTextureAtlas,!1),this.blendOption=T(e.blendOption,Or.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW],this._highlightColor=K.clone(K.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let n=this._scene;_(n)&&_(n.terrainProviderChanged)&&(this._removeCallbackFunc=n.terrainProviderChanged.addEventListener(function(){let r=this._billboards,o=r.length;for(let a=0;a<o;++a)_(r[a])&&r[a]._updateClamping()},this))}Object.defineProperties(lh.prototype,{length:{get:function(){return bB(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}});function Vj(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}lh.prototype.add=function(e){let t=new uo(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t};lh.prototype.remove=function(e){return this.contains(e)?(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};lh.prototype.removeAll=function(){Vj(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function bB(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],n=e._billboards,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];_(s)&&(s._index=a++,t.push(s))}e._billboards=t}}lh.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]};lh.prototype.contains=function(e){return _(e)&&e._billboardCollection===this};lh.prototype.get=function(e){return bB(this),this._billboards[e]};var CB;function pEe(e){let n=e.cache.billboardCollection_indexBufferBatched;if(_(n))return n;let r=16384*6-6,o=new Uint16Array(r);for(let a=0,s=0;a<r;a+=6,s+=4)o[a]=s,o[a+1]=s+1,o[a+2]=s+2,o[a+3]=s+0,o[a+4]=s+2,o[a+5]=s+3;return n=ki.createIndexBuffer({context:e,typedArray:o,usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=n,n}function mEe(e){let t=e.cache.billboardCollection_indexBufferInstanced;return _(t)||(t=ki.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function gEe(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return _(t)||(t=ki.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:We.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}lh.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<AB;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function _Ee(e,t,n,r,o,a){let s=[{index:Zi.positionHighAndScale,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[QT]},{index:Zi.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[QT]},{index:Zi.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Mj]},{index:Zi.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Nj]},{index:Zi.compressedAttribute2,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Rj]},{index:Zi.eyeOffset,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Lj]},{index:Zi.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Oj]},{index:Zi.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Bj]},{index:Zi.compressedAttribute3,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[Fj]},{index:Zi.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[fEe]}];r&&s.push({index:Zi.direction,componentsPerAttribute:2,componentDatatype:ie.FLOAT,vertexBuffer:gEe(e)}),_(o)&&s.push({index:Zi.a_batchId,componentsPerAttribute:1,componentDatatype:ie.FLOAT,bufferUsage:We.STATIC_DRAW}),a&&s.push({index:Zi.sdf,componentsPerAttribute:2,componentDatatype:ie.FLOAT,usage:n[zj]});let u=r?t:4*t;return new iC(e,s,u,r)}var xB=new ei;function kj(e,t,n,r,o){let a,s=r[Zi.positionHighAndScale],u=r[Zi.positionLowAndRotation],l=o._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),ei.fromCartesian(l,xB);let c=o.scale,f=o.rotation;f!==0&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,c);let h=xB.high,d=xB.low;e._instanced?(a=o._index,s(a,h.x,h.y,h.z,c),u(a,d.x,d.y,d.z,f)):(a=o._index*4,s(a+0,h.x,h.y,h.z,c),s(a+1,h.x,h.y,h.z,c),s(a+2,h.x,h.y,h.z,c),s(a+3,h.x,h.y,h.z,c),u(a+0,d.x,d.y,d.z,f),u(a+1,d.x,d.y,d.z,f),u(a+2,d.x,d.y,d.z,f),u(a+3,d.x,d.y,d.z,f))}var uh=new X,sh=32768,I1=65536,wB=4096,Op=256,yEe=128,vEe=32,CEe=8,Gj=4,xEe=1/256,Uj=0,Hj=2,qj=3,Wj=1;function Yj(e,t,n,r,o){let a,s=r[Zi.compressedAttribute0],u=o.pixelOffset,l=u.x,c=u.y,f=o._translate,h=f.x,d=f.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+h),Math.abs(-c+d));let p=o.horizontalOrigin,g=o._verticalOrigin,y=o.show&&o.clusterShow;o.color.alpha===0&&(y=!1),g===an.BASELINE&&(g=an.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===ho.CENTER,e._allVerticalCenter=e._allVerticalCenter&&g===an.CENTER;let v=0,w=0,C=0,E=0,S=o._imageIndex;if(S!==-1){let G=n[S];v=G.x,w=G.y,C=G.width,E=G.height}let A=v+C,D=w+E,P=Math.floor(z.clamp(l,-sh,sh)+sh)*yEe;P+=(p+1)*vEe,P+=(g+1)*CEe,P+=(y?1:0)*Gj;let M=Math.floor(z.clamp(c,-sh,sh)+sh)*Op,I=Math.floor(z.clamp(h,-sh,sh)+sh)*Op,O=(z.clamp(d,-sh,sh)+sh)*xEe,m=Math.floor(O),b=Math.floor((O-m)*Op);M+=m,I+=b,uh.x=v,uh.y=w;let L=ma.compressTextureCoordinates(uh);uh.x=A;let R=ma.compressTextureCoordinates(uh);uh.y=D;let N=ma.compressTextureCoordinates(uh);uh.x=v;let B=ma.compressTextureCoordinates(uh);e._instanced?(a=o._index,s(a,P,M,I,L)):(a=o._index*4,s(a+0,P+Uj,M,I,L),s(a+1,P+Hj,M,I,R),s(a+2,P+qj,M,I,N),s(a+3,P+Wj,M,I,B))}function Xj(e,t,n,r,o){let a,s=r[Zi.compressedAttribute1],u=o.alignedAxis;x.equals(u,x.ZERO)||(e._shaderAlignedAxis=!0);let l=0,c=1,f=1,h=1,d=o.translucencyByDistance;_(d)&&(l=d.near,c=d.nearValue,f=d.far,h=d.farValue,(c!==1||h!==1)&&(e._shaderTranslucencyByDistance=!0));let p=0,g=o._imageIndex;g!==-1&&(p=n[g].width);let y=e._textureAtlas.texture.width,v=Math.round(T(o.width,y*p));e._maxSize=Math.max(e._maxSize,v);let w=z.clamp(v,0,I1),C=0;Math.abs(x.magnitudeSquared(u)-1)<z.EPSILON6&&(C=ma.octEncodeFloat(u)),c=z.clamp(c,0,1),c=c===1?255:c*255|0,w=w*Op+c,h=z.clamp(h,0,1),h=h===1?255:h*255|0,C=C*Op+h,e._instanced?(a=o._index,s(a,w,C,l,f)):(a=o._index*4,s(a+0,w,C,l,f),s(a+1,w,C,l,f),s(a+2,w,C,l,f),s(a+3,w,C,l,f))}function TB(e,t,n,r,o){let a,s=r[Zi.compressedAttribute2],u=o.color,l=_(e._batchTable)?K.WHITE:o.getPickId(t.context).color,c=o.sizeInMeters?1:0,f=Math.abs(x.magnitudeSquared(o.alignedAxis)-1)<z.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&c===1;let h=0,d=o._imageIndex;d!==-1&&(h=n[d].height);let p=e._textureAtlas.texture.dimensions,g=Math.round(T(o.height,p.y*h));e._maxSize=Math.max(e._maxSize,g);let y=T(o._labelHorizontalOrigin,-2);y+=2;let v=g*Gj+y,w=K.floatToByte(u.red),C=K.floatToByte(u.green),E=K.floatToByte(u.blue),S=w*I1+C*Op+E;w=K.floatToByte(l.red),C=K.floatToByte(l.green),E=K.floatToByte(l.blue);let A=w*I1+C*Op+E,D=K.floatToByte(u.alpha)*I1+K.floatToByte(l.alpha)*Op;D+=c*2+f,e._instanced?(a=o._index,s(a,S,A,D,v)):(a=o._index*4,s(a+0,S,A,D,v),s(a+1,S,A,D,v),s(a+2,S,A,D,v),s(a+3,S,A,D,v))}function SB(e,t,n,r,o){let a,s=r[Zi.eyeOffset],u=o.eyeOffset,l=u.z;if(o._heightReference!==Pt.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(u.x),Math.abs(u.y),Math.abs(l)),e._instanced){let c=0,f=0,h=o._imageIndex;if(h!==-1){let p=n[h];c=p.width,f=p.height}uh.x=c,uh.y=f;let d=ma.compressTextureCoordinates(uh);a=o._index,s(a,u.x,u.y,l,d)}else a=o._index*4,s(a+0,u.x,u.y,l,0),s(a+1,u.x,u.y,l,0),s(a+2,u.x,u.y,l,0),s(a+3,u.x,u.y,l,0)}function jj(e,t,n,r,o){let a,s=r[Zi.scaleByDistance],u=0,l=1,c=1,f=1,h=o.scaleByDistance;_(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function Kj(e,t,n,r,o){let a,s=r[Zi.pixelOffsetScaleByDistance],u=0,l=1,c=1,f=1,h=o.pixelOffsetScaleByDistance;_(h)&&(u=h.near,l=h.nearValue,c=h.far,f=h.farValue,(l!==1||f!==1)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(a=o._index,s(a,u,l,c,f)):(a=o._index*4,s(a+0,u,l,c,f),s(a+1,u,l,c,f),s(a+2,u,l,c,f),s(a+3,u,l,c,f))}function Zj(e,t,n,r,o){let a,s=r[Zi.compressedAttribute3],u=0,l=Number.MAX_VALUE,c=o.distanceDisplayCondition;_(c)&&(u=c.near,l=c.far,u*=u,l*=l,e._shaderDistanceDisplayCondition=!0);let f=o.disableDepthTestDistance,h=o.heightReference===Pt.CLAMP_TO_GROUND&&t.context.depthTexture;_(f)||(f=h?5e3:0),f*=f,(h||f>0)&&(e._shaderDisableDepthDistance=!0,f===Number.POSITIVE_INFINITY&&(f=-1));let d,p;if(_(o._labelDimensions))p=o._labelDimensions.x,d=o._labelDimensions.y;else{let w=0,C=0,E=o._imageIndex;if(E!==-1){let A=n[E];w=A.height,C=A.width}d=Math.round(T(o.height,e._textureAtlas.texture.dimensions.y*w));let S=e._textureAtlas.texture.width;p=Math.round(T(o.width,S*C))}let g=Math.floor(z.clamp(p,0,wB)),y=Math.floor(z.clamp(d,0,wB)),v=g*wB+y;e._instanced?(a=o._index,s(a,u,l,f,v)):(a=o._index*4,s(a+0,u,l,f,v),s(a+1,u,l,f,v),s(a+2,u,l,f,v),s(a+3,u,l,f,v))}function Qj(e,t,n,r,o){if(o.heightReference===Pt.CLAMP_TO_GROUND){let g=e._scene,y=t.context,v=t.globeTranslucencyState.translucent,w=_(g.globe)&&g.globe.depthTestAgainstTerrain;e._shaderClampToGround=y.depthTexture&&!v&&w}let a,s=r[Zi.textureCoordinateBoundsOrLabelTranslate];if(Kt.maximumVertexTextureImageUnits>0){let g=0,y=0;_(o._labelTranslate)&&(g=o._labelTranslate.x,y=o._labelTranslate.y),e._instanced?(a=o._index,s(a,g,y,0,0)):(a=o._index*4,s(a+0,g,y,0,0),s(a+1,g,y,0,0),s(a+2,g,y,0,0),s(a+3,g,y,0,0));return}let u=0,l=0,c=0,f=0,h=o._imageIndex;if(h!==-1){let g=n[h];u=g.x,l=g.y,c=g.width,f=g.height}let d=u+c,p=l+f;e._instanced?(a=o._index,s(a,u,l,d,p)):(a=o._index*4,s(a+0,u,l,d,p),s(a+1,u,l,d,p),s(a+2,u,l,d,p),s(a+3,u,l,d,p))}function wEe(e,t,n,r,o){if(!_(e._batchTable))return;let a=r[Zi.a_batchId],s=o._batchIndex,u;e._instanced?(u=o._index,a(u,s)):(u=o._index*4,a(u+0,s),a(u+1,s),a(u+2,s),a(u+3,s))}function Jj(e,t,n,r,o){if(!e._sdf)return;let a,s=r[Zi.sdf],u=o.outlineColor,l=o.outlineWidth,c=K.floatToByte(u.red),f=K.floatToByte(u.green),h=K.floatToByte(u.blue),d=c*I1+f*Op+h,p=l/Ds.RADIUS,g=K.floatToByte(u.alpha)*I1+K.floatToByte(p)*Op;e._instanced?(a=o._index,s(a,d,g)):(a=o._index*4,s(a+0,d+Uj,g),s(a+1,d+Hj,g),s(a+2,d+qj,g),s(a+3,d+Wj,g))}function EEe(e,t,n,r,o){kj(e,t,n,r,o),Yj(e,t,n,r,o),Xj(e,t,n,r,o),TB(e,t,n,r,o),SB(e,t,n,r,o),jj(e,t,n,r,o),Kj(e,t,n,r,o),Zj(e,t,n,r,o),Qj(e,t,n,r,o),wEe(e,t,n,r,o),Jj(e,t,n,r,o)}function EB(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=uo._computeActualPosition(c,f,r,o);_(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function TEe(e,t){let n=t.mode,r=e._billboards,o=e._billboardsToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!U.equals(a,e.modelMatrix)?(e._mode=n,U.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&EB(e,r,r.length,t,a,!0)):n===Ne.MORPHING?EB(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&EB(e,o,e._billboardsToUpdateIndex,t,a,!1)}function SEe(e,t,n){let r=1;(!e._allSizedInMeters||e._maxPixelOffset!==0)&&(r=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let o=r*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(o*=.5);let a=r*e._maxPixelOffset+e._maxEyeOffset;n.radius+=o+a}function AEe(e,t){let n=`uniform sampler2D billboard_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); 
} 
`,r=t.createViewportQuadCommand(n,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return r.pass=Qt.OVERLAY,r}var bEe=[];lh.prototype.update=function(e){if(bB(this),!this.show)return;let t=this._billboards,n=t.length,r=e.context;this._instanced=r.instancedArrays,Zi=this._instanced?dEe:hEe,CB=this._instanced?mEe:pEe;let o=this._textureAtlas;if(_(o))for(let M=0;M<n;++M){let I=t[M];I.animation&&I.ready&&I._updateImage()}else{o=this._textureAtlas=new F_({context:r});for(let M=0;M<n;++M)t[M]._loadImage()}let a=o.textureCoordinates;if(a.length===0)return;TEe(this,e),t=this._billboards,n=t.length;let s=this._billboardsToUpdate,u=this._billboardsToUpdateIndex,l=this._propertiesChanged,c=o.guid,f=this._createVertexArray||this._textureAtlasGUID!==c;this._textureAtlasGUID=c;let h,d=e.passes,p=d.pick;if(f||!p&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let M=0;M<AB;++M)l[M]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=_Ee(r,n,this._buffersUsage,this._instanced,this._batchTable,this._sdf),h=this._vaf.writers;for(let M=0;M<n;++M){let I=this._billboards[M];I._dirty=!1,EEe(this,e,a,h,I)}this._vaf.commit(CB(r))}this._billboardsToUpdateIndex=0}else if(u>0){let M=bEe;M.length=0,(l[QT]||l[uEe]||l[sEe])&&M.push(kj),(l[ZT]||l[Mj]||l[oEe]||l[aEe]||l[iEe])&&(M.push(Yj),this._instanced&&M.push(SB)),(l[ZT]||l[lEe]||l[Nj])&&(M.push(Xj),M.push(TB)),(l[ZT]||l[Rj])&&M.push(TB),l[Lj]&&M.push(SB),l[Oj]&&M.push(jj),l[Bj]&&M.push(Kj),(l[Fj]||l[cEe]||l[ZT]||l[QT])&&M.push(Zj),(l[ZT]||l[QT])&&M.push(Qj),l[zj]&&M.push(Jj);let I=M.length;if(h=this._vaf.writers,u/n>.1){for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let b=0;b<I;++b)M[b](this,e,a,h,m)}this._vaf.commit(CB(r))}else{for(let O=0;O<u;++O){let m=s[O];m._dirty=!1;for(let b=0;b<I;++b)M[b](this,e,a,h,m);this._instanced?this._vaf.subCommit(m._index,1):this._vaf.subCommit(m._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(u>n*1.5&&(s.length=n),!_(this._vaf)||!_(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let g,y=U.IDENTITY;e.mode===Ne.SCENE3D?(y=this.modelMatrix,g=Ee.clone(this._baseVolumeWC,this._boundingVolume)):g=Ee.clone(this._baseVolume2D,this._boundingVolume),SEe(this,e,g);let v=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,v){this._blendOption===Or.OPAQUE||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=un.fromCache({depthTest:{enabled:!0,func:V.LESS},depthMask:!0}):this._rsOpaque=void 0;let M=this._blendOption===Or.TRANSLUCENT;this._blendOption===Or.TRANSLUCENT||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=un.fromCache({depthTest:{enabled:!0,func:M?V.LEQUAL:V.LESS},depthMask:M,blending:za.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let w,C,E,S,A,D=Kt.maximumVertexTextureImageUnits>0;if(v||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){w=Kb,C=jb,A=[],_(this._batchTable)&&(A.push("VECTOR_TILE"),w=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(w),C=this._batchTable.getFragmentShaderCallback(!1,void 0)(C)),E=new xt({defines:A,sources:[w]}),this._instanced&&E.defines.push("INSTANCED"),this._shaderRotation&&E.defines.push("ROTATION"),this._shaderAlignedAxis&&E.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&E.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&E.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&E.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&E.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&E.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(D?E.defines.push("VERTEX_DEPTH_CHECK"):E.defines.push("FRAGMENT_DEPTH_CHECK"));let M=1-Ds.CUTOFF;this._sdf&&E.defines.push("SDF");let I=_(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Or.OPAQUE_AND_TRANSLUCENT&&(S=new xt({defines:["OPAQUE",I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=vi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Zi}),S=new xt({defines:["TRANSLUCENT",I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=vi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Zi})),this._blendOption===Or.OPAQUE&&(S=new xt({defines:[I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._sp=vi.replaceCache({context:r,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Zi})),this._blendOption===Or.TRANSLUCENT&&(S=new xt({defines:[I],sources:[C]}),this._shaderClampToGround&&(D?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(S.defines.push("SDF"),S.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=vi.replaceCache({context:r,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:Zi})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let P=e.commandList;if(d.render||d.pick){let M=this._colorCommands,I=this._blendOption===Or.OPAQUE,O=this._blendOption===Or.OPAQUE_AND_TRANSLUCENT,m=this._vaf.va,b=m.length,L=this._uniforms,R;_(this._batchTable)?(L=this._batchTable.getUniformMapCallback()(L),R=this._batchTable.getPickId()):R="v_pickColor",M.length=b;let N=O?b*2:b;for(let B=0;B<N;++B){let G=M[B];_(G)||(G=M[B]=new Zt);let F=I||O&&B%2===0;G.pass=F||!O?Qt.OPAQUE:Qt.TRANSLUCENT,G.owner=this;let k=O?Math.floor(B/2):B;G.boundingVolume=g,G.modelMatrix=y,G.count=m[k].indicesCount,G.shaderProgram=F?this._sp:this._spTranslucent,G.uniformMap=L,G.vertexArray=m[k].va,G.renderState=F?this._rsOpaque:this._rsTranslucent,G.debugShowBoundingVolume=this.debugShowBoundingVolume,G.pickId=R,this._instanced&&(G.count=6,G.instanceCount=n),P.push(G)}this.debugShowTextureAtlas&&(_(this.debugCommand)||(this.debugCommand=AEe(this,e.context)),P.push(this.debugCommand))}};lh.prototype.isDestroyed=function(){return!1};lh.prototype.destroy=function(){return _(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Vj(this._billboards),ot(this)};var tg=lh;var IEe={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2},dl=Object.freeze(IEe);var $j={},eK=0,DEe=256,PEe=new K(.165,.165,.165,.8),MEe=new X(7,5),Ka=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function Oy(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function JT(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function $T(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function nK(e){let t=$j[e._font];if(!_(t)){let n=document.createElement("div");n.style.position="absolute",n.style.opacity=0,n.style.font=e._font,document.body.appendChild(n);let r=parseFloat($T(n,"line-height"));isNaN(r)&&(r=void 0),t={family:$T(n,"font-family"),size:$T(n,"font-size").replace("px",""),style:$T(n,"font-style"),weight:$T(n,"font-weight"),lineHeight:r},document.body.removeChild(n),eK<DEe&&($j[e._font]=t,eK++)}e._fontFamily=t.family,e._fontSize=t.size,e._fontStyle=t.style,e._fontWeight=t.weight,e._lineHeight=t.lineHeight}function ng(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.pixelOffsetScaleByDistance,o=e.scaleByDistance,a=e.distanceDisplayCondition;_(n)&&(n=Tt.clone(n)),_(r)&&(r=Tt.clone(r)),_(o)&&(o=Tt.clone(o)),_(a)&&(a=gn.clone(a)),this._renderedText=void 0,this._text=void 0,this._show=T(e.show,!0),this._font=T(e.font,"30px sans-serif"),this._fillColor=K.clone(T(e.fillColor,K.WHITE)),this._outlineColor=K.clone(T(e.outlineColor,K.BLACK)),this._outlineWidth=T(e.outlineWidth,1),this._showBackground=T(e.showBackground,!1),this._backgroundColor=K.clone(T(e.backgroundColor,PEe)),this._backgroundPadding=X.clone(T(e.backgroundPadding,MEe)),this._style=T(e.style,dl.FILL),this._verticalOrigin=T(e.verticalOrigin,an.BASELINE),this._horizontalOrigin=T(e.horizontalOrigin,ho.LEFT),this._pixelOffset=X.clone(T(e.pixelOffset,X.ZERO)),this._eyeOffset=x.clone(T(e.eyeOffset,x.ZERO)),this._position=x.clone(T(e.position,x.ZERO)),this._scale=T(e.scale,1),this._id=e.id,this._translucencyByDistance=n,this._pixelOffsetScaleByDistance=r,this._scaleByDistance=o,this._heightReference=T(e.heightReference,Pt.NONE),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=T(e.text,""),this._relativeSize=1,this._clusterId=void 0,nK(this),this._updateClamping()}Object.defineProperties(ng.prototype,{show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r].billboard;_(a)&&(a.show=e)}let n=this._backgroundBillboard;_(n)&&(n.show=e)}}},position:{get:function(){return this._position},set:function(e){let t=this._position;if(!x.equals(t,e)){x.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o].billboard;_(s)&&(s.position=e)}let r=this._backgroundBillboard;_(r)&&(r.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(e!==this._heightReference){this._heightReference=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r].billboard;_(a)&&(a.heightReference=e)}let n=this._backgroundBillboard;_(n)&&(n.heightReference=e),JT(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(this._text!==e){this._text=e;let t=e.replace(/\u00ad/g,"");this._renderedText=ng.enableRightToLeftDetection?FEe(t):t,Oy(this)}}},font:{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,Oy(this),nK(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){let t=this._fillColor;K.equals(t,e)||(K.clone(e,t),Oy(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),Oy(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Oy(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){this._showBackground!==e&&(this._showBackground=e,Oy(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){let t=this._backgroundColor;if(!K.equals(t,e)){K.clone(e,t);let n=this._backgroundBillboard;_(n)&&(n.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){let t=this._backgroundPadding;X.equals(t,e)||(X.clone(e,t),JT(this))}},style:{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,Oy(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;if(!X.equals(t,e)){X.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];_(s.billboard)&&(s.billboard.pixelOffset=e)}let r=this._backgroundBillboard;_(r)&&(r.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;if(!Tt.equals(t,e)){this._translucencyByDistance=Tt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];_(s.billboard)&&(s.billboard.translucencyByDistance=e)}let r=this._backgroundBillboard;_(r)&&(r.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;if(!Tt.equals(t,e)){this._pixelOffsetScaleByDistance=Tt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];_(s.billboard)&&(s.billboard.pixelOffsetScaleByDistance=e)}let r=this._backgroundBillboard;_(r)&&(r.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;if(!Tt.equals(t,e)){this._scaleByDistance=Tt.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];_(s.billboard)&&(s.billboard.scaleByDistance=e)}let r=this._backgroundBillboard;_(r)&&(r.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;if(!x.equals(t,e)){x.clone(e,t);let n=this._glyphs;for(let o=0,a=n.length;o<a;o++){let s=n[o];_(s.billboard)&&(s.billboard.eyeOffset=e)}let r=this._backgroundBillboard;_(r)&&(r.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,JT(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(this._verticalOrigin!==e){this._verticalOrigin=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.verticalOrigin=e)}let n=this._backgroundBillboard;_(n)&&(n.verticalOrigin=e),JT(this)}}},scale:{get:function(){return this._scale},set:function(e){if(this._scale!==e){this._scale=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.scale=e*this._relativeSize)}let n=this._backgroundBillboard;_(n)&&(n.scale=e*this._relativeSize),JT(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!gn.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=gn.clone(e,this._distanceDisplayCondition);let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.distanceDisplayCondition=e)}let n=this._backgroundBillboard;_(n)&&(n.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){this._disableDepthTestDistance=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.disableDepthTestDistance=e)}let n=this._backgroundBillboard;_(n)&&(n.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.id=e)}let n=this._backgroundBillboard;_(n)&&(n.id=e)}}},pickId:{get:function(){if(!(this._glyphs.length===0||!_(this._glyphs[0].billboard)))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=x.clone(e,this._actualClampedPosition);let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard._clampedPosition=e)}let n=this._backgroundBillboard;_(n)&&(n._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;let t=this._glyphs;for(let r=0,o=t.length;r<o;r++){let a=t[r];_(a.billboard)&&(a.billboard.clusterShow=e)}let n=this._backgroundBillboard;_(n)&&(n.clusterShow=e)}}}});ng.prototype._updateClamping=function(){uo._updateClamping(this._labelCollection,this)};ng.prototype.computeScreenSpacePosition=function(e,t){_(t)||(t=new X);let r=this._labelCollection.modelMatrix,o=_(this._actualClampedPosition)?this._actualClampedPosition:this._position;return uo._computeScreenSpacePosition(r,o,this._eyeOffset,this._pixelOffset,e,t)};ng.getScreenSpaceBoundingBox=function(e,t,n){let r=0,o=0,a=0,s=0,u=e.totalScale,l=e._backgroundBillboard;if(_(l))r=t.x+l._translate.x,o=t.y-l._translate.y,a=l.width*u,s=l.height*u,e.verticalOrigin===an.BOTTOM||e.verticalOrigin===an.BASELINE?o-=s:e.verticalOrigin===an.CENTER&&(o-=s*.5);else{r=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;let c=0,f=0,h=e._glyphs,d=h.length;for(let p=0;p<d;++p){let g=h[p],y=g.billboard;if(!_(y))continue;let v=t.x+y._translate.x,w=t.y-y._translate.y,C=g.dimensions.width*u,E=g.dimensions.height*u;e.verticalOrigin===an.BOTTOM||e.verticalOrigin===an.BASELINE?w-=E:e.verticalOrigin===an.CENTER&&(w-=E*.5),e._verticalOrigin===an.TOP?w+=Ds.PADDING*u:(e._verticalOrigin===an.BOTTOM||e._verticalOrigin===an.BASELINE)&&(w-=Ds.PADDING*u),r=Math.min(r,v),o=Math.min(o,w),c=Math.max(c,v+C),f=Math.max(f,w+E)}a=c-r,s=f-o}return _(n)||(n=new en),n.x=r,n.y=o,n.width=a,n.height=s,n};ng.prototype.equals=function(e){return this===e||_(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&x.equals(this._position,e._position)&&K.equals(this._fillColor,e._fillColor)&&K.equals(this._outlineColor,e._outlineColor)&&K.equals(this._backgroundColor,e._backgroundColor)&&X.equals(this._backgroundPadding,e._backgroundPadding)&&X.equals(this._pixelOffset,e._pixelOffset)&&x.equals(this._eyeOffset,e._eyeOffset)&&Tt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Tt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&Tt.equals(this._scaleByDistance,e._scaleByDistance)&&gn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id};ng.prototype.isDestroyed=function(){return!1};ng.enableRightToLeftDetection=!1;function LEe(e,t){let n=/[a-zA-Z0-9]/,r=/[()[\]{}<>]/,o=[],a="",s=Ka.LTR,u="",l=e.length;for(let c=0;c<l;++c){let f=e.charAt(c);t.test(f)?u=Ka.RTL:n.test(f)?u=Ka.LTR:r.test(f)?u=Ka.BRACKETS:u=Ka.WEAK,c===0&&(s=u),s===u&&u!==Ka.BRACKETS?a+=f:(a!==""&&o.push({Type:s,Word:a}),s=u,a=f)}return o.push({Type:u,Word:a}),o}function REe(e){return e.split("").reverse().join("")}function eS(e,t,n){return e.slice(0,t)+n+e.slice(t)}function OEe(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}var NEe="\u05D0-\u05EA",BEe="\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF",tK=new RegExp(`[${NEe}${BEe}]`);function FEe(e){let t=e.split(`
`),n="";for(let r=0;r<t.length;r++){let o=t[r],a=tK.test(o.charAt(0)),s=LEe(o,tK),u=0,l="";for(let c=0;c<s.length;++c){let f=s[c],h=f.Type===Ka.BRACKETS?OEe(f.Word):REe(f.Word);a?f.Type===Ka.RTL?(l=h+l,u=0):f.Type===Ka.LTR?(l=eS(l,u,f.Word),u+=f.Word.length):(f.Type===Ka.WEAK||f.Type===Ka.BRACKETS)&&(f.Type===Ka.WEAK&&s[c-1].Type===Ka.BRACKETS?l=h+l:s[c-1].Type===Ka.RTL?(l=h+l,u=0):s.length>c+1?s[c+1].Type===Ka.RTL?(l=h+l,u=0):(l=eS(l,u,f.Word),u+=f.Word.length):l=eS(l,0,h)):f.Type===Ka.RTL?l=eS(l,u,h):f.Type===Ka.LTR?(l+=f.Word,u=l.length):(f.Type===Ka.WEAK||f.Type===Ka.BRACKETS)&&(c>0&&s[c-1].Type===Ka.RTL?s.length>c+1?s[c+1].Type===Ka.RTL?l=eS(l,u,h):(l+=f.Word,u=l.length):l+=f.Word:(l+=f.Word,u=l.length))}n+=l,r<t.length-1&&(n+=`
`)}return n}var tS=ng;function zEe(e,t,n,r,o){let a=e.measureText(t);if(!!/\S/.test(t)){let u=document.defaultView.getComputedStyle(e.canvas).getPropertyValue("font-size").replace("px",""),l=document.createElement("canvas"),c=100,f=a.width+c|0,h=3*u,d=h/2;l.width=f,l.height=h;let p=l.getContext("2d");p.font=n,p.fillStyle="white",p.fillRect(0,0,l.width+1,l.height+1),r&&(p.strokeStyle="black",p.lineWidth=e.lineWidth,p.strokeText(t,c/2,d)),o&&(p.fillStyle="black",p.fillText(t,c/2,d));let g=p.getImageData(0,0,f,h).data,y=g.length,v=f*4,w,C,E,S;for(w=0;w<y;++w)if(g[w]!==255){E=w/v|0;break}for(w=y-1;w>=0;--w)if(g[w]!==255){S=w/v|0;break}let A=-1;for(w=0;w<f&&A===-1;++w)for(C=0;C<h;++C){let D=w*4+C*v;if(g[D]!==255||g[D+1]!==255||g[D+2]!==255||g[D+3]!==255){A=w;break}}return{width:a.width,height:S-E,ascent:d-E,descent:S-d,minx:A-c/2}}return{width:a.width,height:0,ascent:0,descent:0,minx:0}}var Ny;function VEe(e,t){if(e==="")return;t=T(t,T.EMPTY_OBJECT);let n=T(t.font,"10px sans-serif"),r=T(t.stroke,!1),o=T(t.fill,!0),a=T(t.strokeWidth,1),s=T(t.backgroundColor,K.TRANSPARENT),u=T(t.padding,0),l=u*2,c=document.createElement("canvas");c.width=1,c.height=1,c.style.font=n;let f=c.getContext("2d");_(Ny)||(_(f.imageSmoothingEnabled)?Ny="imageSmoothingEnabled":_(f.mozImageSmoothingEnabled)?Ny="mozImageSmoothingEnabled":_(f.webkitImageSmoothingEnabled)?Ny="webkitImageSmoothingEnabled":_(f.msImageSmoothingEnabled)&&(Ny="msImageSmoothingEnabled")),f.font=n,f.lineJoin="round",f.lineWidth=a,f[Ny]=!1,c.style.visibility="hidden",document.body.appendChild(c);let h=zEe(f,e,n,r,o);c.dimensions=h,document.body.removeChild(c),c.style.visibility="";let d=-h.minx,p=Math.ceil(h.width)+d+l,g=h.height+l,y=g-h.ascent+u,v=g-y+l;if(c.width=p,c.height=g,f.font=n,f.lineJoin="round",f.lineWidth=a,f[Ny]=!1,s!==K.TRANSPARENT&&(f.fillStyle=s.toCssColorString(),f.fillRect(0,0,c.width,c.height)),r){let w=T(t.strokeColor,K.BLACK);f.strokeStyle=w.toCssColorString(),f.strokeText(e,d+u,v)}if(o){let w=T(t.fillColor,K.WHITE);f.fillStyle=w.toCssColorString(),f.fillText(e,d+u,v)}return c}var rK=VEe;var IB=Vg(sK(),1);var DB=Vg(uK(),1);function UEe(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function HEe(e,t,n){this.labelCollection=e,this.index=t,this.dimensions=n}var qEe=1.2,fK="ID_WHITE_PIXEL",MB=new X(4,4),WEe=new en(1,1,1,1);function YEe(e){let t=document.createElement("canvas");t.width=MB.x,t.height=MB.y;let n=t.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,t.width,t.height),e.addImage(fK,t)}var ch={};function XEe(e,t,n,r,o,a,s){return ch.font=t,ch.fillColor=n,ch.strokeColor=r,ch.strokeWidth=o,ch.padding=Ds.PADDING,s===an.CENTER?ch.textBaseline="middle":s===an.TOP?ch.textBaseline="top":ch.textBaseline="bottom",ch.fill=a===dl.FILL||a===dl.FILL_AND_OUTLINE,ch.stroke=a===dl.OUTLINE||a===dl.FILL_AND_OUTLINE,ch.backgroundColor=K.BLACK,rK(e,ch)}function LB(e,t){t.textureInfo=void 0,t.dimensions=void 0;let n=t.billboard;_(n)&&(n.show=!1,n.image=void 0,_(n._removeCallbackFunc)&&(n._removeCallbackFunc(),n._removeCallbackFunc=void 0),e._spareBillboards.push(n),t.billboard=void 0)}var PB={},lK=0,jEe=256*2;function KEe(e,t,n,r){r.index=e.addImageSync(t,n)}var ZEe=new DB.default;function QEe(e,t){let n=t._renderedText,r=ZEe.splitGraphemes(n),o=r.length,a=t._glyphs,s=a.length,u,l,c;if(t._relativeSize=t._fontSize/Ds.FONT_SIZE,o<s)for(l=o;l<s;++l)LB(e,a[l]);a.length=o;let f=t._showBackground&&n.split(`
`).join("").length>0,h=t._backgroundBillboard,d=e._backgroundBillboardCollection;f?(_(h)||(h=d.add({collection:e,image:fK,imageSubRegion:WEe}),t._backgroundBillboard=h),h.color=t._backgroundColor,h.show=t._show,h.position=t._position,h.eyeOffset=t._eyeOffset,h.pixelOffset=t._pixelOffset,h.horizontalOrigin=ho.LEFT,h.verticalOrigin=t._verticalOrigin,h.heightReference=t._heightReference,h.scale=t.totalScale,h.pickPrimitive=t,h.id=t._id,h.translucencyByDistance=t._translucencyByDistance,h.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,h.scaleByDistance=t._scaleByDistance,h.distanceDisplayCondition=t._distanceDisplayCondition,h.disableDepthTestDistance=t._disableDepthTestDistance):_(h)&&(d.remove(h),t._backgroundBillboard=h=void 0);let p=e._glyphTextureCache;for(c=0;c<o;++c){let g=r[c],y=t._verticalOrigin,v=JSON.stringify([g,t._fontFamily,t._fontStyle,t._fontWeight,+y]),w=p[v];if(!_(w)){let C=`${t._fontStyle} ${t._fontWeight} ${Ds.FONT_SIZE}px ${t._fontFamily}`,E=!1,S;if(_(PB[v])?(S=PB[v],E=!0):(S=XEe(g,C,K.WHITE,K.WHITE,0,dl.FILL,y),lK<jEe&&(PB[v]=S,lK++)),w=new HEe(e,-1,S.dimensions),p[v]=w,S.width>0&&S.height>0){if(!E){let A=(0,IB.default)(S,{cutoff:Ds.CUTOFF,radius:Ds.RADIUS}),D=S.getContext("2d"),P=S.width,M=S.height,I=D.getImageData(0,0,P,M);for(let O=0;O<P;O++)for(let m=0;m<M;m++){let b=m*P+O,L=A[b]*255,R=b*4;I.data[R+0]=L,I.data[R+1]=L,I.data[R+2]=L,I.data[R+3]=L}D.putImageData(I,0,0)}g!==" "&&KEe(e._textureAtlas,v,S,w)}}if(u=a[c],_(u)?w.index===-1?LB(e,u):_(u.textureInfo)&&(u.textureInfo=void 0):(u=new UEe,a[c]=u),u.textureInfo=w,u.dimensions=w.dimensions,w.index!==-1){let C=u.billboard,E=e._spareBillboards;_(C)||(E.length>0?C=E.pop():(C=e._billboardCollection.add({collection:e}),C._labelDimensions=new X,C._labelTranslate=new X),u.billboard=C),C.show=t._show,C.position=t._position,C.eyeOffset=t._eyeOffset,C.pixelOffset=t._pixelOffset,C.horizontalOrigin=ho.LEFT,C.verticalOrigin=t._verticalOrigin,C._clampedPosition=t._clampedPosition,C.scale=t.totalScale,C.pickPrimitive=t,C.id=t._id,C.image=v,C.translucencyByDistance=t._translucencyByDistance,C.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,C.scaleByDistance=t._scaleByDistance,C.distanceDisplayCondition=t._distanceDisplayCondition,C.disableDepthTestDistance=t._disableDepthTestDistance,C._batchIndex=t._batchIndex,C.outlineColor=t.outlineColor,t.style===dl.FILL_AND_OUTLINE?(C.color=t._fillColor,C.outlineWidth=t.outlineWidth):t.style===dl.FILL?(C.color=t._fillColor,C.outlineWidth=0):t.style===dl.OUTLINE&&(C.color=K.TRANSPARENT,C.outlineWidth=t.outlineWidth)}}t._repositionAllGlyphs=!0}function cK(e,t,n){return t===ho.CENTER?-e/2:t===ho.RIGHT?-(e+n.x):n.x}var Uo=new X,JEe=new X;function $Ee(e){let t=e._glyphs,n=e._renderedText,r,o,a=0,s=0,u=[],l=Number.NEGATIVE_INFINITY,c=0,f=1,h,d=t.length,p=e._backgroundBillboard,g=X.clone(_(p)?e._backgroundPadding:X.ZERO,JEe);for(g.x/=e._relativeSize,g.y/=e._relativeSize,h=0;h<d;++h)n.charAt(h)===`
`?(u.push(a),++f,a=0):(r=t[h],o=r.dimensions,c=Math.max(c,o.height-o.descent),l=Math.max(l,o.descent),a+=o.width-o.minx,h<d-1&&(a+=t[h+1].dimensions.minx),s=Math.max(s,a));u.push(a);let y=c+l,v=e.totalScale,w=e._horizontalOrigin,C=e._verticalOrigin,E=0,S=u[E],A=cK(S,w,g),D=(_(e._lineHeight)?e._lineHeight:qEe*e._fontSize)/e._relativeSize,P=D*(f-1),M=s,I=y+P;_(p)&&(M+=g.x*2,I+=g.y*2,p._labelHorizontalOrigin=w),Uo.x=A*v,Uo.y=0;let O=!0,m=0;for(h=0;h<d;++h)if(n.charAt(h)===`
`)++E,m+=D,S=u[E],A=cK(S,w,g),Uo.x=A*v,O=!0;else if(r=t[h],o=r.dimensions,C===an.TOP?(Uo.y=o.height-c-g.y,Uo.y+=Ds.PADDING):C===an.CENTER?Uo.y=(P+o.height-c)/2:C===an.BASELINE?(Uo.y=P,Uo.y-=Ds.PADDING):(Uo.y=P+l+g.y,Uo.y-=Ds.PADDING),Uo.y=(Uo.y-o.descent-m)*v,O&&(Uo.x-=Ds.PADDING*v,O=!1),_(r.billboard)&&(r.billboard._setTranslate(Uo),r.billboard._labelDimensions.x=M,r.billboard._labelDimensions.y=I,r.billboard._labelHorizontalOrigin=w),h<d-1){let b=t[h+1];Uo.x+=(o.width-o.minx+b.dimensions.minx)*v}if(_(p)&&n.split(`
`).join("").length>0&&(w===ho.CENTER?A=-s/2-g.x:w===ho.RIGHT?A=-(s+g.x*2):A=0,Uo.x=A*v,C===an.TOP?Uo.y=y-c-l:C===an.CENTER?Uo.y=(y-c)/2-l:C===an.BASELINE?Uo.y=-g.y-l:Uo.y=0,Uo.y=Uo.y*v,p.width=M,p.height=I,p._setTranslate(Uo),p._labelTranslate=X.clone(Uo,p._labelTranslate)),e.heightReference===Pt.CLAMP_TO_GROUND)for(h=0;h<d;++h){r=t[h];let b=r.billboard;_(b)&&(b._labelTranslate=X.clone(Uo,b._labelTranslate))}}function hK(e,t){let n=t._glyphs;for(let r=0,o=n.length;r<o;++r)LB(e,n[r]);_(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,_(t._removeCallbackFunc)&&t._removeCallbackFunc(),ot(t)}function Np(e){e=T(e,T.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new tg({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new tg({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=K.clone(K.WHITE),this.show=T(e.show,!0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.blendOption=T(e.blendOption,Or.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(Np.prototype,{length:{get:function(){return this._labels.length}}});Np.prototype.add=function(e){let t=new tS(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t};Np.prototype.remove=function(e){if(_(e)&&e._labelCollection===this){let t=this._labels.indexOf(e);if(t!==-1)return this._labels.splice(t,1),hK(this,e),!0}return!1};Np.prototype.removeAll=function(){let e=this._labels;for(let t=0,n=e.length;t<n;++t)hK(this,e[t]);e.length=0};Np.prototype.contains=function(e){return _(e)&&e._labelCollection===this};Np.prototype.get=function(e){return this._labels[e]};Np.prototype.update=function(e){if(!this.show)return;let t=this._billboardCollection,n=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,n.modelMatrix=this.modelMatrix,n.debugShowBoundingVolume=this.debugShowBoundingVolume;let r=e.context;_(this._textureAtlas)||(this._textureAtlas=new F_({context:r}),t.textureAtlas=this._textureAtlas),_(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new F_({context:r,initialSize:MB}),n.textureAtlas=this._backgroundTextureAtlas,YEe(this._backgroundTextureAtlas));let o=this._labelsToUpdate.length;for(let s=0;s<o;++s){let u=this._labelsToUpdate[s];if(u.isDestroyed())continue;let l=u._glyphs.length;u._rebindAllGlyphs&&(QEe(this,u),u._rebindAllGlyphs=!1),u._repositionAllGlyphs&&($Ee(u),u._repositionAllGlyphs=!1);let c=u._glyphs.length-l;this._totalGlyphCount+=c}var a=this.blendOption;t.blendOption=a,n.blendOption=a,t._highlightColor=this._highlightColor,n._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,n.update(e),t.update(e)};Np.prototype.isDestroyed=function(){return!1};Np.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),ot(this)};var WP=Np;function Ea(e,t){e=T(e,T.EMPTY_OBJECT);let n=e.translucencyByDistance,r=e.scaleByDistance,o=e.distanceDisplayCondition;_(n)&&(n=Tt.clone(n)),_(r)&&(r=Tt.clone(r)),_(o)&&(o=gn.clone(o)),this._show=T(e.show,!0),this._position=x.clone(T(e.position,x.ZERO)),this._actualPosition=x.clone(this._position),this._color=K.clone(T(e.color,K.WHITE)),this._outlineColor=K.clone(T(e.outlineColor,K.TRANSPARENT)),this._outlineWidth=T(e.outlineWidth,0),this._pixelSize=T(e.pixelSize,10),this._scaleByDistance=r,this._translucencyByDistance=n,this._distanceDisplayCondition=o,this._disableDepthTestDistance=T(e.disableDepthTestDistance,0),this._id=e.id,this._collection=T(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1,this._clusterId=void 0}var dK=Ea.SHOW_INDEX=0,gK=Ea.POSITION_INDEX=1,eTe=Ea.COLOR_INDEX=2,tTe=Ea.OUTLINE_COLOR_INDEX=3,nTe=Ea.OUTLINE_WIDTH_INDEX=4,rTe=Ea.PIXEL_SIZE_INDEX=5,iTe=Ea.SCALE_BY_DISTANCE_INDEX=6,oTe=Ea.TRANSLUCENCY_BY_DISTANCE_INDEX=7,aTe=Ea.DISTANCE_DISPLAY_CONDITION_INDEX=8,sTe=Ea.DISABLE_DEPTH_DISTANCE_INDEX=9;Ea.NUMBER_OF_PROPERTIES=10;function fh(e,t){let n=e._pointPrimitiveCollection;_(n)&&(n._updatePointPrimitive(e,t),e._dirty=!0)}Object.defineProperties(Ea.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,fh(this,dK))}},position:{get:function(){return this._position},set:function(e){let t=this._position;x.equals(t,e)||(x.clone(e,t),x.clone(e,this._actualPosition),fh(this,gK))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;Tt.equals(t,e)||(this._scaleByDistance=Tt.clone(e,t),fh(this,iTe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;Tt.equals(t,e)||(this._translucencyByDistance=Tt.clone(e,t),fh(this,oTe))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,fh(this,rTe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;K.equals(t,e)||(K.clone(e,t),fh(this,eTe))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;K.equals(t,e)||(K.clone(e,t),fh(this,tTe))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,fh(this,nTe))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){gn.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=gn.clone(e,this._distanceDisplayCondition),fh(this,aTe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,fh(this,sTe))}},id:{get:function(){return this._id},set:function(e){this._id=e,_(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,fh(this,dK))}}});Ea.prototype.getPickId=function(e){return _(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId};Ea.prototype._getActualPosition=function(){return this._actualPosition};Ea.prototype._setActualPosition=function(e){x.clone(e,this._actualPosition),fh(this,gK)};var pK=new Se;Ea._computeActualPosition=function(e,t,n){return t.mode===Ne.SCENE3D?e:(U.multiplyByPoint(n,e,pK),Mf.computeActualWgs84Position(t,pK))};var mK=new Se;Ea._computeScreenSpacePosition=function(e,t,n,r){let o=U.multiplyByVector(e,Se.fromElements(t.x,t.y,t.z,1,mK),mK);return Mf.wgs84ToWindowCoordinates(n,o,r)};Ea.prototype.computeScreenSpacePosition=function(e,t){let n=this._pointPrimitiveCollection;_(t)||(t=new X);let r=n.modelMatrix,o=Ea._computeScreenSpacePosition(r,this._actualPosition,e,t);if(!!_(o))return o};Ea.getScreenSpaceBoundingBox=function(e,t,n){let r=e.pixelSize,o=r*.5,a=t.x-o,s=t.y-o,u=r,l=r;return _(n)||(n=new en),n.x=a,n.y=s,n.width=u,n.height=l,n};Ea.prototype.equals=function(e){return this===e||_(e)&&this._id===e._id&&x.equals(this._position,e._position)&&K.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&K.equals(this._outlineColor,e._outlineColor)&&Tt.equals(this._scaleByDistance,e._scaleByDistance)&&Tt.equals(this._translucencyByDistance,e._translucencyByDistance)&&gn.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};Ea.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var pl=Ea;var rS=`varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
void main()
{
float distanceToCenter = length(gl_PointCoord - vec2(0.5));
float maxDistance = max(0.0, 0.5 - v_pixelDistance);
float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);
float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);
vec4 color = mix(v_outlineColor, v_color, innerAlpha);
color.a *= wholeAlpha;
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
gl_FragColor = czm_gammaCorrect(color);
czm_writeLogDepth();
}
`;var _K=`uniform float u_maxTotalPointSize;
attribute vec4 positionHighAndSize;
attribute vec4 positionLowAndOutline;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 scaleByDistance;
attribute vec3 distanceDisplayConditionAndDisableDepth;
varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
void main()
{
vec3 positionHigh = positionHighAndSize.xyz;
vec3 positionLow = positionLowAndOutline.xyz;
float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;
float totalSize = positionHighAndSize.w + outlineWidthBothSides;
float outlinePercent = outlineWidthBothSides / totalSize;
totalSize *= czm_pixelRatio;
totalSize += 3.0;
float temp = compressedAttribute1.x * SHIFT_RIGHT8;
float show = floor(temp);
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
vec4 color;
vec4 outlineColor;
vec4 pickColor;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute0.x * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute0.y * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = compressedAttribute0.w * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor = pickColor / 255.0;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);
#endif
totalSize = min(totalSize, u_maxTotalPointSize);
if (totalSize < 1.0)
{
positionEC.xyz = vec3(0.0);
totalSize = 1.0;
}
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency < 0.004)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = distanceDisplayConditionAndDisableDepth.x;
float farSq = distanceDisplayConditionAndDisableDepth.y;
if (lengthSq < nearSq || lengthSq > farSq) {
positionEC.xyz = vec3(0.0, 0.0, 1.0);
}
#endif
gl_Position = czm_projection * positionEC;
czm_vertexLogDepth();
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
czm_vertexLogDepth(vec4(czm_currentFrustum.x));
#endif
}
}
#endif
v_color = color;
v_color.a *= translucency * show;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency * show;
v_innerPercent = 1.0 - outlinePercent;
v_pixelDistance = 2.0 / totalSize;
gl_PointSize = totalSize * show;
gl_Position *= show;
v_pickColor = pickColor;
}
`;var uTe=pl.SHOW_INDEX,NB=pl.POSITION_INDEX,yK=pl.COLOR_INDEX,lTe=pl.OUTLINE_COLOR_INDEX,cTe=pl.OUTLINE_WIDTH_INDEX,fTe=pl.PIXEL_SIZE_INDEX,vK=pl.SCALE_BY_DISTANCE_INDEX,CK=pl.TRANSLUCENCY_BY_DISTANCE_INDEX,xK=pl.DISTANCE_DISPLAY_CONDITION_INDEX,hTe=pl.DISABLE_DEPTH_DISTANCE_INDEX,BB=pl.NUMBER_OF_PROPERTIES,ml={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function hh(e){e=T(e,T.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(BB),this._maxPixelSize=1,this._baseVolume=new Ee,this._baseVolumeWC=new Ee,this._baseVolume2D=new Ee,this._boundingVolume=new Ee,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=T(e.show,!0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._modelMatrix=U.clone(U.IDENTITY),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this.blendOption=T(e.blendOption,Or.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=Ne.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW,We.STATIC_DRAW];let t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}Object.defineProperties(hh.prototype,{length:{get:function(){return FB(this),this._pointPrimitives.length}}});function wK(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}hh.prototype.add=function(e){let t=new pl(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t};hh.prototype.remove=function(e){return this.contains(e)?(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};hh.prototype.removeAll=function(){wK(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0};function FB(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;let t=[],n=e._pointPrimitives,r=n.length;for(let o=0,a=0;o<r;++o){let s=n[o];s&&(s._index=a++,t.push(s))}e._pointPrimitives=t}}hh.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]};hh.prototype.contains=function(e){return _(e)&&e._pointPrimitiveCollection===this};hh.prototype.get=function(e){return FB(this),this._pointPrimitives[e]};hh.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let r=0;r<BB;++r){let o=n[r]===0?We.STATIC_DRAW:We.STREAM_DRAW;t=t||e[r]!==o,e[r]=o}return t};function dTe(e,t,n){return new iC(e,[{index:ml.positionHighAndSize,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[NB]},{index:ml.positionLowAndShow,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[NB]},{index:ml.compressedAttribute0,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[yK]},{index:ml.compressedAttribute1,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[CK]},{index:ml.scaleByDistance,componentsPerAttribute:4,componentDatatype:ie.FLOAT,usage:n[vK]},{index:ml.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:ie.FLOAT,usage:n[xK]}],t)}var RB=new ei;function EK(e,t,n,r){let o=r._index,a=r._getActualPosition();e._mode===Ne.SCENE3D&&(Ee.expand(e._baseVolume,a,e._baseVolume),e._boundingVolumeDirty=!0),ei.fromCartesian(a,RB);let s=r.pixelSize,u=r.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,s+u);let l=n[ml.positionHighAndSize],c=RB.high;l(o,c.x,c.y,c.z,s);let f=n[ml.positionLowAndOutline],h=RB.low;f(o,h.x,h.y,h.z,u)}var YP=65536,iS=256;function TK(e,t,n,r){let o=r._index,a=r.color,s=r.getPickId(t).color,u=r.outlineColor,l=K.floatToByte(a.red),c=K.floatToByte(a.green),f=K.floatToByte(a.blue),h=l*YP+c*iS+f;l=K.floatToByte(u.red),c=K.floatToByte(u.green),f=K.floatToByte(u.blue);let d=l*YP+c*iS+f;l=K.floatToByte(s.red),c=K.floatToByte(s.green),f=K.floatToByte(s.blue);let p=l*YP+c*iS+f,g=K.floatToByte(a.alpha)*YP+K.floatToByte(u.alpha)*iS+K.floatToByte(s.alpha),y=n[ml.compressedAttribute0];y(o,h,d,p,g)}function SK(e,t,n,r){let o=r._index,a=0,s=1,u=1,l=1,c=r.translucencyByDistance;_(c)&&(a=c.near,s=c.nearValue,u=c.far,l=c.farValue,(s!==1||l!==1)&&(e._shaderTranslucencyByDistance=!0));let f=r.show&&r.clusterShow;r.color.alpha===0&&r.outlineColor.alpha===0&&(f=!1),s=z.clamp(s,0,1),s=s===1?255:s*255|0;let h=(f?1:0)*iS+s;l=z.clamp(l,0,1),l=l===1?255:l*255|0;let d=l,p=n[ml.compressedAttribute1];p(o,h,d,a,u)}function AK(e,t,n,r){let o=r._index,a=n[ml.scaleByDistance],s=0,u=1,l=1,c=1,f=r.scaleByDistance;_(f)&&(s=f.near,u=f.nearValue,l=f.far,c=f.farValue,(u!==1||c!==1)&&(e._shaderScaleByDistance=!0)),a(o,s,u,l,c)}function bK(e,t,n,r){let o=r._index,a=n[ml.distanceDisplayConditionAndDisableDepth],s=0,u=Number.MAX_VALUE,l=r.distanceDisplayCondition;_(l)&&(s=l.near,u=l.far,s*=s,u*=u,e._shaderDistanceDisplayCondition=!0);let c=r.disableDepthTestDistance;c*=c,c>0&&(e._shaderDisableDepthDistance=!0,c===Number.POSITIVE_INFINITY&&(c=-1)),a(o,s,u,c)}function pTe(e,t,n,r){EK(e,t,n,r),TK(e,t,n,r),SK(e,t,n,r),AK(e,t,n,r),bK(e,t,n,r)}function OB(e,t,n,r,o,a){let s;r.mode===Ne.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let u=[];for(let l=0;l<n;++l){let c=t[l],f=c.position,h=pl._computeActualPosition(f,r,o);_(h)&&(c._setActualPosition(h),a?u.push(h):Ee.expand(s,h,s))}a&&Ee.fromPoints(u,s)}function mTe(e,t){let n=t.mode,r=e._pointPrimitives,o=e._pointPrimitivesToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==Ne.SCENE3D&&!U.equals(a,e.modelMatrix)?(e._mode=n,U.clone(e.modelMatrix,a),e._createVertexArray=!0,(n===Ne.SCENE3D||n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&OB(e,r,r.length,t,a,!0)):n===Ne.MORPHING?OB(e,r,r.length,t,a,!0):(n===Ne.SCENE2D||n===Ne.COLUMBUS_VIEW)&&OB(e,o,e._pointPrimitivesToUpdateIndex,t,a,!1)}function gTe(e,t,n){let o=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;n.radius+=o}var _Te=[];hh.prototype.update=function(e){if(FB(this),!this.show)return;this._maxTotalPointSize=Kt.maximumAliasedPointSize,mTe(this,e);let n=this._pointPrimitives.length,r=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,a=this._propertiesChanged,s=this._createVertexArray,u,l=e.context,c=e.passes,f=c.pick;if(s||!f&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let A=0;A<BB;++A)a[A]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=dTe(l,n,this._buffersUsage),u=this._vaf.writers;for(let A=0;A<n;++A){let D=this._pointPrimitives[A];D._dirty=!1,pTe(this,l,u,D)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){let A=_Te;A.length=0,(a[NB]||a[cTe]||a[fTe])&&A.push(EK),(a[yK]||a[lTe])&&A.push(TK),(a[uTe]||a[CK])&&A.push(SK),a[vK]&&A.push(AK),(a[xK]||a[hTe])&&A.push(bK);let D=A.length;if(u=this._vaf.writers,o/n>.1){for(let P=0;P<o;++P){let M=r[P];M._dirty=!1;for(let I=0;I<D;++I)A[I](this,l,u,M)}this._vaf.commit()}else{for(let P=0;P<o;++P){let M=r[P];M._dirty=!1;for(let I=0;I<D;++I)A[I](this,l,u,M);this._vaf.subCommit(M._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>n*1.5&&(r.length=n),!_(this._vaf)||!_(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,Ee.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let h,d=U.IDENTITY;e.mode===Ne.SCENE3D?(d=this.modelMatrix,h=Ee.clone(this._baseVolumeWC,this._boundingVolume)):h=Ee.clone(this._baseVolume2D,this._boundingVolume),gTe(this,e,h);let p=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,p&&(this._blendOption===Or.OPAQUE||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=un.fromCache({depthTest:{enabled:!0,func:V.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===Or.TRANSLUCENT||this._blendOption===Or.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=un.fromCache({depthTest:{enabled:!0,func:V.LEQUAL},depthMask:!1,blending:za.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let g,y;(p||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(g=new xt({sources:[_K]}),this._shaderScaleByDistance&&g.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&g.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&g.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&g.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===Or.OPAQUE_AND_TRANSLUCENT&&(y=new xt({defines:["OPAQUE"],sources:[rS]}),this._sp=vi.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:g,fragmentShaderSource:y,attributeLocations:ml}),y=new xt({defines:["TRANSLUCENT"],sources:[rS]}),this._spTranslucent=vi.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:g,fragmentShaderSource:y,attributeLocations:ml})),this._blendOption===Or.OPAQUE&&(y=new xt({sources:[rS]}),this._sp=vi.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:g,fragmentShaderSource:y,attributeLocations:ml})),this._blendOption===Or.TRANSLUCENT&&(y=new xt({sources:[rS]}),this._spTranslucent=vi.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:g,fragmentShaderSource:y,attributeLocations:ml})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);let v,w,C,E,S=e.commandList;if(c.render||f){let A=this._colorCommands,D=this._blendOption===Or.OPAQUE,P=this._blendOption===Or.OPAQUE_AND_TRANSLUCENT;v=this._vaf.va,w=v.length,A.length=w;let M=P?w*2:w;for(E=0;E<M;++E){let I=D||P&&E%2===0;C=A[E],_(C)||(C=A[E]=new Zt),C.primitiveType=rn.POINTS,C.pass=I||!P?Qt.OPAQUE:Qt.TRANSLUCENT,C.owner=this;let O=P?Math.floor(E/2):E;C.boundingVolume=h,C.modelMatrix=d,C.shaderProgram=I?this._sp:this._spTranslucent,C.uniformMap=this._uniforms,C.vertexArray=v[O].va,C.renderState=I?this._rsOpaque:this._rsTranslucent,C.debugShowBoundingVolume=this.debugShowBoundingVolume,C.pickId="v_pickColor",S.push(C)}}};hh.prototype.isDestroyed=function(){return!1};hh.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),wK(this._pointPrimitives),ot(this)};var XP=hh;var jP=Vg(IK(),1);function Ed(e){e=T(e,T.EMPTY_OBJECT),this._enabled=T(e.enabled,!1),this._pixelRange=T(e.pixelRange,80),this._minimumClusterSize=T(e.minimumClusterSize,2),this._clusterBillboards=T(e.clusterBillboards,!0),this._clusterLabels=T(e.clusterLabels,!0),this._clusterPoints=T(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new xe,this.show=T(e.show,!0)}function PK(e){return e.coord.x}function MK(e){return e.coord.y}function DK(e,t){e.x-=t,e.y-=t,e.width+=t*2,e.height+=t*2}var yTe=new en;function GB(e,t,n,r,o){if(_(e._labelCollection)&&r._clusterLabels?o=tS.getScreenSpaceBoundingBox(e,t,o):_(e._billboardCollection)&&r._clusterBillboards?o=uo.getScreenSpaceBoundingBox(e,t,o):_(e._pointPrimitiveCollection)&&r._clusterPoints&&(o=pl.getScreenSpaceBoundingBox(e,t,o)),DK(o,n),r._clusterLabels&&!_(e._labelCollection)&&_(e.id)&&RK(r,e.id.id)&&_(e.id._label)){let a=r._collectionIndicesByEntity[e.id.id].labelIndex,s=r._labelCollection.get(a),u=tS.getScreenSpaceBoundingBox(s,t,yTe);DK(u,n),o=en.union(o,u,o)}return o}function LK(e,t){if(e.clusterShow=!0,!_(e._labelCollection)&&_(e.id)&&RK(t,e.id.id)&&_(e.id._label)){let n=t._collectionIndicesByEntity[e.id.id].labelIndex,r=t._labelCollection.get(n);r.clusterShow=!0}}function UB(e,t,n,r){let o={billboard:r._clusterBillboardCollection.add(),label:r._clusterLabelCollection.add(),point:r._clusterPointCollection.add()};o.billboard.show=!1,o.point.show=!1,o.label.show=!0,o.label.text=t.toLocaleString(),o.label.id=n,o.billboard.position=o.label.position=o.point.position=e,r._clusterEvent.raiseEvent(n,o)}function RK(e,t){return _(e)&&_(e._collectionIndicesByEntity[t])&&_(e._collectionIndicesByEntity[t].labelIndex)}function oS(e,t,n,r,o){if(!_(e))return;let a=e.length;for(let s=0;s<a;++s){let u=e.get(s);if(u.clusterShow=!1,!u.show||o._scene.mode===Ne.SCENE3D&&!r.isPointVisible(u.position))continue;let l=o._clusterLabels&&_(u._labelCollection),c=o._clusterBillboards&&_(u.id._billboard),f=o._clusterPoints&&_(u.id._point);if(l&&(f||c))continue;let h=u.computeScreenSpacePosition(n);!_(h)||t.push({index:s,collection:e,clustered:!1,coord:h})}}var vTe=new en,OK=new en,NK=new en;function CTe(e){let t=e._scene,n=e._labelCollection,r=e._billboardCollection,o=e._pointCollection;if(!_(n)&&!_(r)&&!_(o)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let a=e._clusterLabelCollection,s=e._clusterBillboardCollection,u=e._clusterPointCollection;_(a)?a.removeAll():a=e._clusterLabelCollection=new WP({scene:t}),_(s)?s.removeAll():s=e._clusterBillboardCollection=new tg({scene:t}),_(u)?u.removeAll():u=e._clusterPointCollection=new XP;let l=e._pixelRange,c=e._minimumClusterSize,f=[],h=t.camera.positionCartographic.height,d=t.mapProjection.ellipsoid,p=t.camera.positionWC,g=new vB(d,p),y=[],v=t.canvas.clientWidth,w=t.canvas.clientHeight;for(let F=0;F<r.length;++F){let k=r.get(F);k&&!(k._id instanceof is)&&y.push(k)}y.length>0&&e._dataSource.billbordsInited&&y.forEach(function(F){let k=Mf.wgs84ToWindowCoordinates(e._scene,F.position),Z=!0;k&&k.x>=0&&k.y>=0&&k.x<=v&&k.y<=w&&(Z=!1),Z&&r.remove(F)});let C=[],E=0;e._totalWeight=0;for(let F=0;F<r.length;++F){let k=r.get(F);if(k.show=!0,k._id&&k._id instanceof is&&E<=20){let Z=Mf.wgs84ToWindowCoordinates(e._scene,k.position);Z&&Z.x>=0&&Z.y>=0&&Z.x<=v&&Z.y<=w&&(E++,(k._id._weight>1||k._id._weight===1)&&C.push(F))}}if(e._dataSource.billbordsInited&&delete e._dataSource.billbordsInited,E<=20)for(let F=0;F<C.length;F++){let k=C[F];r.get(k).show=!1;for(let Z=0;Z<r.get(k).id._clusterChildren.length;Z++){let te=r.get(k).id._clusterChildren[Z],oe=!1;for(let pe=0;pe<y.length;pe++)y[pe].id===te&&(oe=!0);if(oe)continue;let ue=e._dataSource._clusterChildren[te];_(ue)&&r.add({id:te,_weight:1,position:x.fromDegrees(ue.x,ue.y,0),image:ue.imageUrl,_detail:!0})}}let S=[];if(e._clusterLabels&&oS(n,S,t,g,e),e._clusterBillboards){let F=r.length;for(let k=0;k<F;++k){let Z=r.get(k);Z&&Z._id&&Z._id._clusterChildren&&!Z.show||(Z.clusterShow=!1,S.push({index:k,collection:r,clustered:!1,coord:new X(Z.position.x,Z.position.y)}))}}e._clusterPoints&&oS(o,S,t,g,e);let A,D,P,M,I,O,m,b,L,R,N,B=new jP.default(S,PK,MK,64,Float32Array),G=S.length;for(A=0;A<G;++A){let F=S[A];if(F.clustered)continue;let k=t.camera.positionCartographic.height*l;F.clustered=!0,R=F.collection,N=F.index;let Z=R.get(N);if(!Z.id)continue;P={x:F.coord.x-k,y:F.coord.y-k,width:k*2,height:k*2};let te=en.clone(P,OK);M=B.range(P.x,P.y,P.x+P.width,P.y+P.height),I=M.length;let oe=x.clone(Z.position),ue=0;for(Z.id._weight>0&&(ue=Z.id._weight),L=1,b=[Z.id],D=0;D<I;++D)if(O=M[D],m=S[O],!m.clustered){let pe=m.collection.get(m.index),me=GB(pe,m.coord,l,e,NK);x.add(pe.position,oe,oe),en.union(te,me,te),++L,pe.id._weight>0&&(ue+=pe.id._weight),b.push(pe.id)}if(ue>c||L>=c){let pe=x.multiplyByScalar(oe,1/L,oe);for(UB(pe,L,b,e),f.push({position:pe,width:te.width,height:te.height,minimumWidth:P.width,minimumHeight:P.height}),D=0;D<I;++D)S[M[D]].clustered=!0}else LK(Z,e)}a.length===0&&(a.destroy(),e._clusterLabelCollection=void 0),s.length===0&&(s.destroy(),e._clusterBillboardCollection=void 0),u.length===0&&(u.destroy(),e._clusterPointCollection=void 0),e._previousClusters=f,e._previousHeight=h}function xTe(e){return function(t){if(_(t)&&t<.05||!e.enabled)return;if(_(e._dataSource)&&_(e._dataSource._clusterType)){CTe(e);return}let n=e._scene,r=e._labelCollection,o=e._billboardCollection,a=e._pointCollection;if(!_(r)&&!_(o)&&!_(a)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let s=e._clusterLabelCollection,u=e._clusterBillboardCollection,l=e._clusterPointCollection;_(s)?s.removeAll():s=e._clusterLabelCollection=new WP({scene:n}),_(u)?u.removeAll():u=e._clusterBillboardCollection=new tg({scene:n}),_(l)?l.removeAll():l=e._clusterPointCollection=new XP;let c=e._pixelRange,f=e._minimumClusterSize,h=e._previousClusters,d=[],p=e._previousHeight,g=n.camera.positionCartographic.height,y=n.mapProjection.ellipsoid,v=n.camera.positionWC,w=new vB(y,v),C=[];e._clusterLabels&&oS(r,C,n,w,e),e._clusterBillboards&&oS(o,C,n,w,e),e._clusterPoints&&oS(a,C,n,w,e);let E,S,A,D,P,M,I,O,m,b,L,R,N=new jP.default(C,PK,MK,64,Int32Array);if(g<p)for(A=h.length,E=0;E<A;++E){let B=h[E];if(!w.isPointVisible(B.position))continue;let G=uo._computeScreenSpacePosition(U.IDENTITY,B.position,x.ZERO,X.ZERO,n);if(!_(G))continue;let F=1-g/p,k=B.width=B.width*F,Z=B.height=B.height*F;k=Math.max(k,B.minimumWidth),Z=Math.max(Z,B.minimumHeight);let te=G.x-k*.5,oe=G.y-Z*.5,ue=G.x+k,pe=G.y+Z;for(P=N.range(te,oe,ue,pe),M=P.length,b=0,m=[],S=0;S<M;++S)I=P[S],O=C[I],O.clustered||(++b,L=O.collection,R=O.index,m.push(L.get(R).id));if(b>=f)for(UB(B.position,b,m,e),d.push(B),S=0;S<M;++S)C[P[S]].clustered=!0}for(A=C.length,E=0;E<A;++E){let B=C[E];if(B.clustered)continue;B.clustered=!0,L=B.collection,R=B.index;let G=L.get(R);D=GB(G,B.coord,c,e,vTe);let F=en.clone(D,OK);P=N.range(D.x,D.y,D.x+D.width,D.y+D.height),M=P.length;let k=x.clone(G.position);for(b=1,m=[G.id],S=0;S<M;++S)if(I=P[S],O=C[I],!O.clustered){let Z=O.collection.get(O.index),te=GB(Z,O.coord,c,e,NK);x.add(Z.position,k,k),en.union(F,te,F),++b,m.push(Z.id)}if(b>=f){let Z=x.multiplyByScalar(k,1/b,k);for(UB(Z,b,m,e),d.push({position:Z,width:F.width,height:F.height,minimumWidth:D.width,minimumHeight:D.height}),S=0;S<M;++S)C[P[S]].clustered=!0}else LK(G,e)}s.length===0&&(s.destroy(),e._clusterLabelCollection=void 0),u.length===0&&(u.destroy(),e._clusterBillboardCollection=void 0),l.length===0&&(l.destroy(),e._clusterPointCollection=void 0),e._previousClusters=d,e._previousHeight=g}}Ed.prototype._initialize=function(e){this._scene=e,this._scene.camera.isRotating=!0;let t=xTe(this);this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)};Object.defineProperties(Ed.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}});function HB(e,t,n,r){return function(o){let a=this[e];_(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let s=this._collectionIndicesByEntity[o.id];if(_(s)||(s=this._collectionIndicesByEntity[o.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),_(a)&&_(s[r]))return a.get(s[r]);_(a)||(a=this[e]=new t({scene:this._scene}));let u,l,c=this[n];c.length>0?(u=c.pop(),l=a.get(u)):(l=a.add(),u=a.length-1),s[r]=u;let f=this;return Promise.resolve().then(function(){f._clusterDirty=!0}),l}}function qB(e,t){let n=e._collectionIndicesByEntity[t];!_(n.billboardIndex)&&!_(n.labelIndex)&&!_(n.pointIndex)&&delete e._collectionIndicesByEntity[t]}Ed.prototype.getLabel=HB("_labelCollection",WP,"_unusedLabelIndices","labelIndex");Ed.prototype.removeLabel=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!_(this._labelCollection)||!_(t)||!_(t.labelIndex))return;let n=t.labelIndex;t.labelIndex=void 0,qB(this,e.id);let r=this._labelCollection.get(n);r.show=!1,r.text="",r.id=void 0,this._unusedLabelIndices.push(n),this._clusterDirty=!0};Ed.prototype.getBillboard=HB("_billboardCollection",tg,"_unusedBillboardIndices","billboardIndex");Ed.prototype.removeBillboard=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!_(this._billboardCollection)||!_(t)||!_(t.billboardIndex))return;let n=t.billboardIndex;t.billboardIndex=void 0,qB(this,e.id);let r=this._billboardCollection.get(n);r.id=void 0,r.show=!1,r.image=void 0,this._unusedBillboardIndices.push(n),this._clusterDirty=!0};Ed.prototype.getPoint=HB("_pointCollection",XP,"_unusedPointIndices","pointIndex");Ed.prototype.removePoint=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!_(this._pointCollection)||!_(t)||!_(t.pointIndex))return;let n=t.pointIndex;t.pointIndex=void 0,qB(this,e.id);let r=this._pointCollection.get(n);r.show=!1,r.id=void 0,this._unusedPointIndices.push(n),this._clusterDirty=!0};function kB(e){if(!_(e))return;let t=e.length;for(let n=0;n<t;++n)e.get(n).clusterShow=!0}function wTe(e){e.enabled||(_(e._clusterLabelCollection)&&e._clusterLabelCollection.destroy(),_(e._clusterBillboardCollection)&&e._clusterBillboardCollection.destroy(),_(e._clusterPointCollection)&&e._clusterPointCollection.destroy(),e._clusterLabelCollection=void 0,e._clusterBillboardCollection=void 0,e._clusterPointCollection=void 0,kB(e._labelCollection),kB(e._billboardCollection),kB(e._pointCollection))}Ed.prototype.update=function(e){if(!this.show)return;let t;_(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),_(this._billboardCollection)&&this._billboardCollection.length>0&&!_(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,wTe(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),_(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),_(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),_(this._clusterPointCollection)&&this._clusterPointCollection.update(e),_(this._labelCollection)&&this._labelCollection.update(e),_(this._billboardCollection)&&this._billboardCollection.update(e),_(this._pointCollection)&&this._pointCollection.update(e)};Ed.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),_(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var BK=Ed;var FK={id:void 0};function aS(e){if(e._firing){e._refire=!0;return}if(e._suspendCount===0){let t=e._addedEntities,n=e._removedEntities,r=e._changedEntities;if(r.length!==0||t.length!==0||n.length!==0){e._firing=!0;do{e._refire=!1;let o=t.values.slice(0),a=n.values.slice(0),s=r.values.slice(0);t.removeAll(),n.removeAll(),r.removeAll(),e._collectionChanged.raiseEvent(e,o,a,s)}while(e._refire);e._firing=!1}}}function gl(e){this._owner=e,this._entities=new Va,this._addedEntities=new Va,this._removedEntities=new Va,this._changedEntities=new Va,this._suspendCount=0,this._collectionChanged=new xe,this._id=_i(),this._show=!0,this._firing=!1,this._refire=!1}gl.prototype.suspendEvents=function(){this._suspendCount++};gl.prototype.resumeEvents=function(){this._suspendCount--,aS(this)};Object.defineProperties(gl.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(e===this._show)return;this.suspendEvents();let t,n=[],r=this._entities.values,o=r.length;for(t=0;t<o;t++)n.push(r[t].isShowing);for(this._show=e,t=0;t<o;t++){let a=n[t],s=r[t];a!==s.isShowing&&s.definitionChanged.raiseEvent(s,"isShowing",s.isShowing,a)}this.resumeEvents()}},owner:{get:function(){return this._owner}}});gl.prototype.computeAvailability=function(){let e=ps.MAXIMUM_VALUE,t=ps.MINIMUM_VALUE,n=this._entities.values;for(let r=0,o=n.length;r<o;r++){let s=n[r].availability;if(_(s)){let u=s.start,l=s.stop;fe.lessThan(u,e)&&!u.equals(ps.MINIMUM_VALUE)&&(e=u),fe.greaterThan(l,t)&&!l.equals(ps.MAXIMUM_VALUE)&&(t=l)}}return ps.MAXIMUM_VALUE.equals(e)&&(e=ps.MINIMUM_VALUE),ps.MINIMUM_VALUE.equals(t)&&(t=ps.MAXIMUM_VALUE),new ri({start:e,stop:t})};gl.prototype.add=function(e){e instanceof is||(e=new is(e));let t=e.id,n=this._entities;if(n.contains(t))throw new it(`An entity with id ${t} already exists in this collection.`);return e.entityCollection=this,n.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(gl.prototype._onEntityDefinitionChanged,this),aS(this),e};gl.prototype.remove=function(e){return _(e)?this.removeById(e.id):!1};gl.prototype.contains=function(e){return this._entities.get(e.id)===e};gl.prototype.removeById=function(e){if(!_(e))return!1;let n=this._entities.get(e);return this._entities.remove(e)?(this._addedEntities.remove(e)||(this._removedEntities.set(e,n),this._changedEntities.remove(e)),this._entities.remove(e),n.definitionChanged.removeEventListener(gl.prototype._onEntityDefinitionChanged,this),aS(this),!0):!1};gl.prototype.removeAll=function(){let e=this._entities,t=e.length,n=e.values,r=this._addedEntities,o=this._removedEntities;for(let a=0;a<t;a++){let s=n[a],u=s.id,l=r.get(u);_(l)||(s.definitionChanged.removeEventListener(gl.prototype._onEntityDefinitionChanged,this),o.set(u,s))}e.removeAll(),r.removeAll(),this._changedEntities.removeAll(),aS(this)};gl.prototype.getById=function(e){return this._entities.get(e)};gl.prototype.getOrCreateEntity=function(e){let t=this._entities.get(e);return _(t)||(FK.id=e,t=new is(FK),this.add(t)),t};gl.prototype._onEntityDefinitionChanged=function(e){let t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),aS(this)};var zK=gl;function KP(){Le.throwInstantiationError()}Object.defineProperties(KP.prototype,{name:{get:Le.throwInstantiationError},clock:{get:Le.throwInstantiationError},entities:{get:Le.throwInstantiationError},isLoading:{get:Le.throwInstantiationError},changedEvent:{get:Le.throwInstantiationError},errorEvent:{get:Le.throwInstantiationError},loadingEvent:{get:Le.throwInstantiationError},show:{get:Le.throwInstantiationError},clustering:{get:Le.throwInstantiationError}});KP.prototype.update=function(e){Le.throwInstantiationError()};KP.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var sS=KP;function By(){this._definitionChanged=new xe,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(By.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:ad("startTime"),stopTime:ad("stopTime"),currentTime:ad("currentTime"),clockRange:ad("clockRange"),clockStep:ad("clockStep"),multiplier:ad("multiplier")});By.prototype.clone=function(e){return _(e)||(e=new By),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e};By.prototype.equals=function(e){return this===e||_(e)&&fe.equals(this.startTime,e.startTime)&&fe.equals(this.stopTime,e.stopTime)&&fe.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier};By.prototype.merge=function(e){this.startTime=T(this.startTime,e.startTime),this.stopTime=T(this.stopTime,e.stopTime),this.currentTime=T(this.currentTime,e.currentTime),this.clockRange=T(this.clockRange,e.clockRange),this.clockStep=T(this.clockStep,e.clockStep),this.multiplier=T(this.multiplier,e.multiplier)};By.prototype.getValue=function(e){return _(e)||(e=new A1),e.startTime=T(this.startTime,e.startTime),e.stopTime=T(this.stopTime,e.stopTime),e.currentTime=T(this.currentTime,e.currentTime),e.clockRange=T(this.clockRange,e.clockRange),e.multiplier=T(this.multiplier,e.multiplier),e.clockStep=T(this.clockStep,e.clockStep),e};var WB=By;function YB(){this._removalFunctions=[]}YB.prototype.add=function(e,t,n){let r=e.addEventListener(t,n);this._removalFunctions.push(r);let o=this;return function(){r();let a=o._removalFunctions;a.splice(a.indexOf(r),1)}};YB.prototype.removeAll=function(){let e=this._removalFunctions;for(let t=0,n=e.length;t<n;++t)e[t]();e.length=0};var D1=YB;function B0(e){this._value=void 0,this._definitionChanged=new xe,this._eventHelper=new D1,this.setValue(e)}Object.defineProperties(B0.prototype,{isConstant:{get:function(){let e=this._value;if(!_(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!ye.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});B0.prototype.getValue=function(e,t){let n=this._value;if(!_(n))return;let r=n.length;_(t)||(t=new Array(r));let o=0,a=0;for(;o<r;){let u=this._value[o].getValue(e,t[o]);_(u)&&(t[a]=u,a++),o++}return t.length=a,t};B0.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),_(e)){this._value=e.slice();let n=e.length;for(let r=0;r<n;r++){let o=e[r];_(o)&&t.add(o.definitionChanged,B0.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};B0.prototype.equals=function(e){return this===e||e instanceof B0&&ye.arrayEquals(this._value,e._value)};B0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var VK=B0;var ETe=K.WHITE,TTe=K.BLACK,STe=new X(2,2);function P1(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(P1.prototype,{isConstant:{get:function(){return ye.isConstant(this._evenColor)&&ye.isConstant(this._oddColor)&&ye.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:Q("evenColor"),oddColor:Q("oddColor"),repeat:Q("repeat")});P1.prototype.getType=function(e){return"Checkerboard"};P1.prototype.getValue=function(e,t){return _(t)||(t={}),t.lightColor=ye.getValueOrClonedDefault(this._evenColor,e,ETe,t.lightColor),t.darkColor=ye.getValueOrClonedDefault(this._oddColor,e,TTe,t.darkColor),t.repeat=ye.getValueOrDefault(this._repeat,e,STe),t};P1.prototype.equals=function(e){return this===e||e instanceof P1&&ye.equals(this._evenColor,e._evenColor)&&ye.equals(this._oddColor,e._oddColor)&&ye.equals(this._repeat,e._repeat)};var XB=P1;var ATe={HORIZONTAL:0,VERTICAL:1},F0=Object.freeze(ATe);var bTe=F0.HORIZONTAL,ITe=K.WHITE,DTe=K.BLACK,PTe=0,MTe=1;function M1(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(M1.prototype,{isConstant:{get:function(){return ye.isConstant(this._orientation)&&ye.isConstant(this._evenColor)&&ye.isConstant(this._oddColor)&&ye.isConstant(this._offset)&&ye.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:Q("orientation"),evenColor:Q("evenColor"),oddColor:Q("oddColor"),offset:Q("offset"),repeat:Q("repeat")});M1.prototype.getType=function(e){return"Stripe"};M1.prototype.getValue=function(e,t){return _(t)||(t={}),t.horizontal=ye.getValueOrDefault(this._orientation,e,bTe)===F0.HORIZONTAL,t.evenColor=ye.getValueOrClonedDefault(this._evenColor,e,ITe,t.evenColor),t.oddColor=ye.getValueOrClonedDefault(this._oddColor,e,DTe,t.oddColor),t.offset=ye.getValueOrDefault(this._offset,e,PTe),t.repeat=ye.getValueOrDefault(this._repeat,e,MTe),t};M1.prototype.equals=function(e){return this===e||e instanceof M1&&ye.equals(this._orientation,e._orientation)&&ye.equals(this._evenColor,e._evenColor)&&ye.equals(this._oddColor,e._oddColor)&&ye.equals(this._offset,e._offset)&&ye.equals(this._repeat,e._repeat)};var jB=M1;function L1(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(L1.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color")});L1.prototype.getType=function(e){return"PolylineArrow"};L1.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t};L1.prototype.equals=function(e){return this===e||e instanceof L1&&ye.equals(this._color,e._color)};var KB=L1;function R1(e){this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.trailImage=e.trailImage,this.duration=e.duration||3e3,this.isFlow=T(e.isFlow,!0),this._time=new Date().getTime(),this.isTranslucent=function(){return!0}}Object.defineProperties(R1.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color")});R1.prototype.getType=function(e){return"PolylineTrailLink"};R1.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,K.WHITE,t.color),t.image=this.trailImage,this.isFlow?t.time=(new Date().getTime()-this._time)%this.duration/this.duration:t.time=0,t};R1.prototype.equals=function(e){return this===e||e instanceof R1&&ye.equals(this._color,e._color)};var kK=R1;function rg(e,t){this._value=void 0,this._definitionChanged=new xe,this._eventHelper=new D1,this._referenceFrame=T(t,Ba.FIXED),this.setValue(e)}Object.defineProperties(rg.prototype,{isConstant:{get:function(){let e=this._value;if(!_(e))return!0;let t=e.length;for(let n=0;n<t;n++)if(!ye.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});rg.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,Ba.FIXED,t)};rg.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._value;if(!_(r))return;let o=r.length;_(n)||(n=new Array(o));let a=0,s=0;for(;a<o;){let l=r[a].getValueInReferenceFrame(e,t,n[a]);_(l)&&(n[s]=l,s++),a++}return n.length=s,n};rg.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),_(e)){this._value=e.slice();let n=e.length;for(let r=0;r<n;r++){let o=e[r];_(o)&&t.add(o.definitionChanged,rg.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};rg.prototype.equals=function(e){return this===e||e instanceof rg&&this._referenceFrame===e._referenceFrame&&ye.arrayEquals(this._value,e._value)};rg.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var ZP=rg;var LTe=K.WHITE,RTe=.25,OTe=1;function O1(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(O1.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)&&ye.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color"),glowPower:Q("glowPower"),taperPower:Q("taperPower")});O1.prototype.getType=function(e){return"PolylineGlow"};O1.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,LTe,t.color),t.glowPower=ye.getValueOrDefault(this._glowPower,e,RTe,t.glowPower),t.taperPower=ye.getValueOrDefault(this._taperPower,e,OTe,t.taperPower),t};O1.prototype.equals=function(e){return this===e||e instanceof O1&&ye.equals(this._color,e._color)&&ye.equals(this._glowPower,e._glowPower)&&ye.equals(this._taperPower,e._taperPower)};var ZB=O1;var NTe=K.WHITE,BTe=K.TRANSPARENT,FTe=16,zTe=255;function N1(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(N1.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)&&ye.isConstant(this._gapColor)&&ye.isConstant(this._dashLength)&&ye.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color"),gapColor:Q("gapColor"),dashLength:Q("dashLength"),dashPattern:Q("dashPattern")});N1.prototype.getType=function(e){return"PolylineDash"};N1.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,NTe,t.color),t.gapColor=ye.getValueOrClonedDefault(this._gapColor,e,BTe,t.gapColor),t.dashLength=ye.getValueOrDefault(this._dashLength,e,FTe,t.dashLength),t.dashPattern=ye.getValueOrDefault(this._dashPattern,e,zTe,t.dashPattern),t};N1.prototype.equals=function(e){return this===e||e instanceof N1&&ye.equals(this._color,e._color)&&ye.equals(this._gapColor,e._gapColor)&&ye.equals(this._dashLength,e._dashLength)&&ye.equals(this._dashPattern,e._dashPattern)};var QB=N1;var VTe=K.WHITE,kTe=.1,GTe=new X(8,8),UTe=new X(0,0),HTe=new X(1,1);function B1(e){e=T(e,T.EMPTY_OBJECT),this._definitionChanged=new xe,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(B1.prototype,{isConstant:{get:function(){return ye.isConstant(this._color)&&ye.isConstant(this._cellAlpha)&&ye.isConstant(this._lineCount)&&ye.isConstant(this._lineThickness)&&ye.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Q("color"),cellAlpha:Q("cellAlpha"),lineCount:Q("lineCount"),lineThickness:Q("lineThickness"),lineOffset:Q("lineOffset")});B1.prototype.getType=function(e){return"Grid"};B1.prototype.getValue=function(e,t){return _(t)||(t={}),t.color=ye.getValueOrClonedDefault(this._color,e,VTe,t.color),t.cellAlpha=ye.getValueOrDefault(this._cellAlpha,e,kTe),t.lineCount=ye.getValueOrClonedDefault(this._lineCount,e,GTe,t.lineCount),t.lineThickness=ye.getValueOrClonedDefault(this._lineThickness,e,HTe,t.lineThickness),t.lineOffset=ye.getValueOrClonedDefault(this._lineOffset,e,UTe,t.lineOffset),t};B1.prototype.equals=function(e){return this===e||e instanceof B1&&ye.equals(this._color,e._color)&&ye.equals(this._cellAlpha,e._cellAlpha)&&ye.equals(this._lineCount,e._lineCount)&&ye.equals(this._lineThickness,e._lineThickness)&&ye.equals(this._lineOffset,e._lineOffset)};var JB=B1;function qTe(e,t,n,r){function o(){n.raiseEvent(e)}let a=[];t.removeAll();let s=r.length;for(let u=0;u<s;u++){let l=r.get(u);_(l.data)&&a.indexOf(l.data)===-1&&t.add(l.data.definitionChanged,o)}}function Fy(){this._eventHelper=new D1,this._definitionChanged=new xe,this._intervals=new eg,this._intervals.changedEvent.addEventListener(Fy.prototype._intervalsChanged,this)}Object.defineProperties(Fy.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});Fy.prototype.getValue=function(e,t){let n=this._intervals.findDataForIntervalContainingDate(e);if(_(n))return n.getValue(e,t)};Fy.prototype.equals=function(e){return this===e||e instanceof Fy&&this._intervals.equals(e._intervals,ye.equals)};Fy.prototype._intervalsChanged=function(){qTe(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var dh=Fy;function z0(){this._definitionChanged=new xe,this._composite=new dh,this._composite.definitionChanged.addEventListener(z0.prototype._raiseDefinitionChanged,this)}Object.defineProperties(z0.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});z0.prototype.getType=function(e){let t=this._composite._intervals.findDataForIntervalContainingDate(e);if(_(t))return t.getType(e)};z0.prototype.getValue=function(e,t){let n=this._composite._intervals.findDataForIntervalContainingDate(e);if(_(n))return n.getValue(e,t)};z0.prototype.equals=function(e){return this===e||e instanceof z0&&this._composite.equals(e._composite,ye.equals)};z0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var $B=z0;var GK={packedLength:1,pack:function(e,t,n){n=T(n,0),t[n]=e},unpack:function(e,t,n){return t=T(t,0),e[t]}};function UK(e,t,n){let r,o=e.length,a=n.length,s=o+a;if(e.length=s,o!==t){let u=o-1;for(r=s-1;r>=t;r--)e[r]=e[u--]}for(r=0;r<a;r++)e[t++]=n[r]}function HK(e,t){return e instanceof fe?e:typeof e=="string"?fe.fromIso8601(e):fe.addSeconds(t,e,new fe)}var eF=[],tF=[];function QP(e,t,n,r,o){let a=0,s,u,l,c,f,h;for(;a<r.length;){f=HK(r[a],e),l=Au(t,f,fe.compare);let d=0,p=0;if(l<0){for(l=~l,c=l*o,u=void 0,h=t[l];a<r.length&&(f=HK(r[a],e),!(_(u)&&fe.compare(u,f)>=0||_(h)&&fe.compare(f,h)>=0));){for(eF[d++]=f,a=a+1,s=0;s<o;s++)tF[p++]=r[a],a=a+1;u=f}d>0&&(tF.length=p,UK(n,c,tF),eF.length=d,UK(t,l,eF))}else{for(s=0;s<o;s++)a++,n[l*o+s]=r[a];a++}}}function Td(e,t){let n=e;n===Number&&(n=GK);let r=n.packedLength,o=T(n.packedInterpolationLength,r),a=0,s;if(_(t)){let u=t.length;s=new Array(u);for(let l=0;l<u;l++){let c=t[l];c===Number&&(c=GK);let f=c.packedLength;r+=f,o+=T(c.packedInterpolationLength,f),s[l]=c}a=u}this._type=e,this._innerType=n,this._interpolationDegree=1,this._interpolationAlgorithm=VP,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=r,this._packedInterpolationLength=o,this._updateTableLength=!0,this._interpolationResult=new Array(o),this._definitionChanged=new xe,this._derivativeTypes=t,this._innerDerivativeTypes=s,this._inputOrder=a,this._forwardExtrapolationType=Lp.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=Lp.NONE,this._backwardExtrapolationDuration=0}Object.defineProperties(Td.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}});Td.prototype.getValue=function(e,t){let n=this._times,r=n.length;if(r===0)return;let o,a=this._innerType,s=this._values,u=Au(n,e,fe.compare);if(u<0){if(u=~u,u===0){let S=n[u];if(o=this._backwardExtrapolationDuration,this._backwardExtrapolationType===Lp.NONE||o!==0&&fe.secondsDifference(S,e)>o)return;if(this._backwardExtrapolationType===Lp.HOLD)return a.unpack(s,0,t)}if(u>=r){u=r-1;let S=n[u];if(o=this._forwardExtrapolationDuration,this._forwardExtrapolationType===Lp.NONE||o!==0&&fe.secondsDifference(e,S)>o)return;if(this._forwardExtrapolationType===Lp.HOLD)return u=r-1,a.unpack(s,u*a.packedLength,t)}let l=this._xTable,c=this._yTable,f=this._interpolationAlgorithm,h=this._packedInterpolationLength,d=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;let S=Math.min(f.getRequiredDataPoints(this._interpolationDegree,d),r);S!==this._numberOfPoints&&(this._numberOfPoints=S,l.length=S,c.length=S*h)}let p=this._numberOfPoints-1;if(p<1)return;let g=0,y=r-1;if(y-g+1>=p+1){let S=u-(p/2|0)-1;S<g&&(S=g);let A=S+p;A>y&&(A=y,S=A-p,S<g&&(S=g)),g=S,y=A}let w=y-g+1;for(let S=0;S<w;++S)l[S]=fe.secondsDifference(n[g+S],n[y]);if(_(a.convertPackedArrayForInterpolation))a.convertPackedArrayForInterpolation(s,g,y,c);else{let S=0,A=this._packedLength,D=g*A,P=(y+1)*A;for(;D<P;)c[S]=s[D],D++,S++}let C=fe.secondsDifference(e,n[y]),E;if(d===0||!_(f.interpolate))E=f.interpolateOrderZero(C,l,c,h,this._interpolationResult);else{let S=Math.floor(h/(d+1));E=f.interpolate(C,l,c,S,d,d,this._interpolationResult)}return _(a.unpackInterpolationResult)?a.unpackInterpolationResult(E,s,g,y,t):a.unpack(E,0,t)}return a.unpack(s,u*this._packedLength,t)};Td.prototype.setInterpolationOptions=function(e){if(!_(e))return;let t=!1,n=e.interpolationAlgorithm,r=e.interpolationDegree;_(n)&&this._interpolationAlgorithm!==n&&(this._interpolationAlgorithm=n,t=!0),_(r)&&this._interpolationDegree!==r&&(this._interpolationDegree=r,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))};Td.prototype.addSample=function(e,t,n){let r=this._innerDerivativeTypes,o=_(r),a=this._innerType,s=[];if(s.push(e),a.pack(t,s,s.length),o){let u=r.length;for(let l=0;l<u;l++)r[l].pack(n[l],s,s.length)}QP(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Td.prototype.addSamples=function(e,t,n){let r=this._innerDerivativeTypes,o=_(r),a=this._innerType,s=e.length,u=[];for(let l=0;l<s;l++)if(u.push(e[l]),a.pack(t[l],u,u.length),o){let c=n[l],f=r.length;for(let h=0;h<f;h++)r[h].pack(c[h],u,u.length)}QP(void 0,this._times,this._values,u,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Td.prototype.addSamplesPackedArray=function(e,t){QP(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Td.prototype.removeSample=function(e){let t=Au(this._times,e,fe.compare);return t<0?!1:(qK(this,t,1),!0)};function qK(e,t,n){let r=e._packedLength;e._times.splice(t,n),e._values.splice(t*r,n*r),e._updateTableLength=!0,e._definitionChanged.raiseEvent(e)}Td.prototype.removeSamples=function(e){let t=this._times,n=Au(t,e.start,fe.compare);n<0?n=~n:e.isStartIncluded||++n;let r=Au(t,e.stop,fe.compare);r<0?r=~r:e.isStopIncluded&&++r,qK(this,n,r-n)};Td.prototype.equals=function(e){if(this===e)return!0;if(!_(e)||this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;let t=this._derivativeTypes,n=_(t),r=e._derivativeTypes,o=_(r);if(n!==o)return!1;let a,s;if(n){if(s=t.length,s!==r.length)return!1;for(a=0;a<s;a++)if(t[a]!==r[a])return!1}let u=this._times,l=e._times;if(s=u.length,s!==l.length)return!1;for(a=0;a<s;a++)if(!fe.equals(u[a],l[a]))return!1;let c=this._values,f=e._values;for(s=c.length,a=0;a<s;a++)if(c[a]!==f[a])return!1;return!0};Td._mergeNewSamples=QP;var ig=Td;function ph(e,t){t=T(t,0);let n;if(t>0){n=new Array(t);for(let r=0;r<t;r++)n[r]=x}this._numberOfDerivatives=t,this._property=new ig(x,n),this._definitionChanged=new xe,this._referenceFrame=T(e,Ba.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}Object.defineProperties(ph.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});ph.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,Ba.FIXED,t)};ph.prototype.getValueInReferenceFrame=function(e,t,n){if(n=this._property.getValue(e,n),_(n))return MC.convertToReferenceFrame(e,n,this._referenceFrame,t,n)};ph.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)};ph.prototype.addSample=function(e,t,n){let r=this._numberOfDerivatives;this._property.addSample(e,t,n)};ph.prototype.addSamples=function(e,t,n){this._property.addSamples(e,t,n)};ph.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)};ph.prototype.removeSample=function(e){return this._property.removeSample(e)};ph.prototype.removeSamples=function(e){this._property.removeSamples(e)};ph.prototype.equals=function(e){return this===e||e instanceof ph&&ye.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};var F1=ph;function zy(){this._definitionChanged=new xe,this._intervals=new eg,this._intervals.changedEvent.addEventListener(zy.prototype._intervalsChanged,this)}Object.defineProperties(zy.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});zy.prototype.getValue=function(e,t){let n=this._intervals.findDataForIntervalContainingDate(e);return _(n)&&typeof n.clone=="function"?n.clone(t):n};zy.prototype.equals=function(e){return this===e||e instanceof zy&&this._intervals.equals(e._intervals,ye.equals)};zy.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var JP=zy;function V0(e){this._referenceFrame=T(e,Ba.FIXED),this._definitionChanged=new xe,this._composite=new dh,this._composite.definitionChanged.addEventListener(V0.prototype._raiseDefinitionChanged,this)}Object.defineProperties(V0.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});V0.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,Ba.FIXED,t)};V0.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._composite._intervals.findDataForIntervalContainingDate(e);if(_(r))return r.getValueInReferenceFrame(e,t,n)};V0.prototype.equals=function(e){return this===e||e instanceof V0&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,ye.equals)};V0.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var og=V0;function Vy(e){let t=e._targetProperty;if(!_(t)){let n=e._targetEntity;if(!_(n)){if(n=e._targetCollection.getById(e._targetId),!_(n)){e._targetEntity=e._targetProperty=void 0;return}n.definitionChanged.addEventListener(lf.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=n}let r=e._targetPropertyNames;t=e._targetEntity;for(let o=0,a=r.length;o<a&&_(t);++o)t=t[r[o]];e._targetProperty=t}return t}function lf(e,t,n){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=n,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new xe,e.collectionChanged.addEventListener(lf.prototype._onCollectionChanged,this)}Object.defineProperties(lf.prototype,{isConstant:{get:function(){return ye.isConstant(Vy(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){let e=Vy(this);return _(e)?e.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Vy(this)}}});lf.fromString=function(e,t){let n,r=[],o=!0,a=!1,s="";for(let u=0;u<t.length;++u){let l=t.charAt(u);a?(s+=l,a=!1):l==="\\"?a=!0:o&&l==="#"?(n=s,o=!1,s=""):!o&&l==="."?(r.push(s),s=""):s+=l}return r.push(s),new lf(e,n,r)};lf.prototype.getValue=function(e,t){let n=Vy(this);return _(n)?n.getValue(e,t):void 0};lf.prototype.getValueInReferenceFrame=function(e,t,n){let r=Vy(this);return _(r)?r.getValueInReferenceFrame(e,t,n):void 0};lf.prototype.getType=function(e){let t=Vy(this);return _(t)?t.getType(e):void 0};lf.prototype.equals=function(e){if(this===e)return!0;let t=this._targetPropertyNames,n=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==n.length)return!1;let r=this._targetPropertyNames.length;for(let o=0;o<r;o++)if(t[o]!==n[o])return!1;return!0};lf.prototype._onTargetEntityDefinitionChanged=function(e,t,n,r){_(this._targetProperty)&&this._targetPropertyNames[0]===t&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))};lf.prototype._onCollectionChanged=function(e,t,n){let r=this._targetEntity;_(r)&&n.indexOf(r)!==-1?(r.definitionChanged.removeEventListener(lf.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):_(r)||(r=Vy(this),_(r)&&this._definitionChanged.raiseEvent(this))};var WK=lf;var WTe={packedLength:1,pack:function(e,t,n){return n=T(n,0),t[n]=e,t},unpack:function(e,t,n){return t=T(t,0),e[t]},convertPackedArrayForInterpolation:function(e,t,n,r){_(r)||(r=[]),t=T(t,0),n=T(n,e.length);let o;for(let a=0,s=n-t+1;a<s;a++){let u=e[t+a];a===0||Math.abs(o-u)<Math.PI?r[a]=u:r[a]=u-z.TWO_PI,o=u}},unpackInterpolationResult:function(e,t,n,r,o){return o=e[0],o<0?o+z.TWO_PI:o}},ag=WTe;function z1(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new xe,this._normalize=T(t,!0),this.position=e}Object.defineProperties(z1.prototype,{isConstant:{get:function(){return ye.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){let t=this._position;t!==e&&(_(t)&&this._subscription(),this._position=e,_(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var YTe=new x,YK=new x,XK=new fe,nF=1/60;z1.prototype.getValue=function(e,t){return this._getValue(e,t)};z1.prototype._getValue=function(e,t,n){_(t)||(t=new x);let r=this._position;if(ye.isConstant(r))return this._normalize?void 0:x.clone(x.ZERO,t);let o=r.getValue(e,YTe),a=r.getValue(fe.addSeconds(e,nF,XK),YK);if(!_(o)||!_(a)&&(a=o,o=r.getValue(fe.addSeconds(e,-nF,XK),YK),!_(o)))return;if(x.equals(o,a))return this._normalize?void 0:x.clone(x.ZERO,t);_(n)&&o.clone(n);let s=x.subtract(a,o,t);return this._normalize?x.normalize(s,t):x.divideByScalar(s,nF,t)};z1.prototype.equals=function(e){return this===e||e instanceof z1&&ye.equals(this._position,e._position)};var $P=z1;function k0(e){this._definitionChanged=new xe,this._intervals=new eg,this._intervals.changedEvent.addEventListener(k0.prototype._intervalsChanged,this),this._referenceFrame=T(e,Ba.FIXED)}Object.defineProperties(k0.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});k0.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,Ba.FIXED,t)};k0.prototype.getValueInReferenceFrame=function(e,t,n){let r=this._intervals.findDataForIntervalContainingDate(e);if(_(r))return MC.convertToReferenceFrame(e,r,this._referenceFrame,t,n)};k0.prototype.equals=function(e){return this===e||e instanceof k0&&this._intervals.equals(e._intervals,ye.equals)&&this._referenceFrame===e._referenceFrame};k0.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var eM=k0;function uS(e,t){this._velocityVectorProperty=new $P(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new xe,this.ellipsoid=T(t,Ge.WGS84);let n=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){n._definitionChanged.raiseEvent(n)})}Object.defineProperties(uS.prototype,{isConstant:{get:function(){return ye.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var jK=new x,XTe=new x,KK=new ne;uS.prototype.getValue=function(e,t){let n=this._velocityVectorProperty._getValue(e,XTe,jK);if(!!_(n))return yn.rotationMatrixFromPositionVelocity(jK,n,this._ellipsoid,KK),je.fromRotationMatrix(KK,t)};uS.prototype.equals=function(e){return this===e||e instanceof uS&&ye.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};var ZK=uS;var lS={HIGHLIGHT:0,REPLACE:1,MIX:2};lS.getColorBlend=function(e,t){if(e===lS.HIGHLIGHT)return 0;if(e===lS.REPLACE)return 1;if(e===lS.MIX)return z.clamp(t,z.EPSILON4,1)};var sg=Object.freeze(lS);function jTe(e,t){return _(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0}var Ho=jTe;function Je(){}Je.objectLegacy=function(e,t){if(_(e)){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],o=t(r,n);if(_(o))return o}}};Je.object=function(e,t){if(_(e)){let n=e.length;for(let r=0;r<n;r++){let o=e[r],a=t(o,r);if(_(a))return a}}};Je.topLevel=function(e,t,n){let r=e[t];return _(r)&&!Array.isArray(r)?Je.objectLegacy(r,n):Je.object(r,n)};Je.accessor=function(e,t){return Je.topLevel(e,"accessors",t)};Je.accessorWithSemantic=function(e,t,n){let r={};return Je.mesh(e,function(o){return Je.meshPrimitive(o,function(a){let s=Je.meshPrimitiveAttribute(a,function(u,l){if(l.indexOf(t)===0&&!_(r[u])){r[u]=!0;let c=n(u);if(_(c))return c}});return _(s)?s:Je.meshPrimitiveTarget(a,function(u){return Je.meshPrimitiveTargetAttribute(u,function(l,c){if(c.indexOf(t)===0&&!_(r[l])){r[l]=!0;let f=n(l);if(_(f))return f}})})})})};Je.accessorContainingVertexAttributeData=function(e,t){let n={};return Je.mesh(e,function(r){return Je.meshPrimitive(r,function(o){let a=Je.meshPrimitiveAttribute(o,function(s){if(!_(n[s])){n[s]=!0;let u=t(s);if(_(u))return u}});return _(a)?a:Je.meshPrimitiveTarget(o,function(s){return Je.meshPrimitiveTargetAttribute(s,function(u){if(!_(n[u])){n[u]=!0;let l=t(u);if(_(l))return l}})})})})};Je.accessorContainingIndexData=function(e,t){let n={};return Je.mesh(e,function(r){return Je.meshPrimitive(r,function(o){let a=o.indices;if(_(a)&&!_(n[a])){n[a]=!0;let s=t(a);if(_(s))return s}})})};Je.animation=function(e,t){return Je.topLevel(e,"animations",t)};Je.animationChannel=function(e,t){let n=e.channels;return Je.object(n,t)};Je.animationSampler=function(e,t){let n=e.samplers;return Je.object(n,t)};Je.buffer=function(e,t){return Je.topLevel(e,"buffers",t)};Je.bufferView=function(e,t){return Je.topLevel(e,"bufferViews",t)};Je.camera=function(e,t){return Je.topLevel(e,"cameras",t)};Je.image=function(e,t){return Je.topLevel(e,"images",t)};Je.material=function(e,t){return Je.topLevel(e,"materials",t)};Je.materialValue=function(e,t){let n=e.values;_(e.extensions)&&_(e.extensions.KHR_techniques_webgl)&&(n=e.extensions.KHR_techniques_webgl.values);for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(_(o))return o}};Je.mesh=function(e,t){return Je.topLevel(e,"meshes",t)};Je.meshPrimitive=function(e,t){let n=e.primitives;if(_(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o],s=t(a,o);if(_(s))return s}}};Je.meshPrimitiveAttribute=function(e,t){let n=e.attributes;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(_(o))return o}};Je.meshPrimitiveTarget=function(e,t){let n=e.targets;if(_(n)){let r=n.length;for(let o=0;o<r;++o){let a=t(n[o],o);if(_(a))return a}}};Je.meshPrimitiveTargetAttribute=function(e,t){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n],o=t(r,n);if(_(o))return o}};Je.node=function(e,t){return Je.topLevel(e,"nodes",t)};Je.nodeInTree=function(e,t,n){let r=e.nodes;if(_(r)){let o=t.length;for(let a=0;a<o;a++){let s=t[a],u=r[s];if(_(u)){let l=n(u,s);if(_(l))return l;let c=u.children;if(_(c)&&(l=Je.nodeInTree(e,c,n),_(l)))return l}}}};Je.nodeInScene=function(e,t,n){let r=t.nodes;if(_(r))return Je.nodeInTree(e,r,n)};Je.program=function(e,t){return Ho(e,"KHR_techniques_webgl")?Je.object(e.extensions.KHR_techniques_webgl.programs,t):Je.topLevel(e,"programs",t)};Je.sampler=function(e,t){return Je.topLevel(e,"samplers",t)};Je.scene=function(e,t){return Je.topLevel(e,"scenes",t)};Je.shader=function(e,t){return Ho(e,"KHR_techniques_webgl")?Je.object(e.extensions.KHR_techniques_webgl.shaders,t):Je.topLevel(e,"shaders",t)};Je.skin=function(e,t){return Je.topLevel(e,"skins",t)};Je.skinJoint=function(e,t){let n=e.joints;if(_(n)){let r=n.length;for(let o=0;o<r;o++){let a=n[o],s=t(a);if(_(s))return s}}};Je.techniqueAttribute=function(e,t){let n=e.attributes;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(_(o))return o}};Je.techniqueUniform=function(e,t){let n=e.uniforms;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(_(o))return o}};Je.techniqueParameter=function(e,t){let n=e.parameters;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let o=t(n[r],r);if(_(o))return o}};Je.technique=function(e,t){return Ho(e,"KHR_techniques_webgl")?Je.object(e.extensions.KHR_techniques_webgl.techniques,t):Je.topLevel(e,"techniques",t)};Je.texture=function(e,t){return Je.topLevel(e,"textures",t)};var re=Je;function KTe(e){return re.shader(e,function(t){tM(t)}),re.buffer(e,function(t){tM(t)}),re.image(e,function(t){tM(t)}),tM(e),e}function tM(e){e.extras=_(e.extras)?e.extras:{},e.extras._pipeline=_(e.extras._pipeline)?e.extras._pipeline:{}}var cS=KTe;function ZTe(e,t){let n=e.extensionsRequired;if(_(n)){let r=n.indexOf(t);r>=0&&n.splice(r,1),n.length===0&&delete e.extensionsRequired}}var QK=ZTe;function QTe(e,t){let n=e.extensionsUsed;if(_(n)){let r=n.indexOf(t);r>=0&&n.splice(r,1),QK(e,t),n.length===0&&delete e.extensionsUsed}}var JK=QTe;function G0(e,t,n){return t=T(t,0),n=T(n,e.byteLength-t),e=e.subarray(t,t+n),G0.decode(e)}G0.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)};G0.decodeWithFromCharCode=function(e){let t="",n=JTe(e),r=n.length;for(let o=0;o<r;++o){let a=n[o];a<=65535?t+=String.fromCharCode(a):(a-=65536,t+=String.fromCharCode((a>>10)+55296,(a&1023)+56320))}return t};function fS(e,t,n){return t<=e&&e<=n}function JTe(e){let t=0,n=0,r=0,o=128,a=191,s=[],u=e.length;for(let l=0;l<u;++l){let c=e[l];if(r===0){if(fS(c,0,127)){s.push(c);continue}if(fS(c,194,223)){r=1,t=c&31;continue}if(fS(c,224,239)){c===224&&(o=160),c===237&&(a=159),r=2,t=c&15;continue}if(fS(c,240,244)){c===240&&(o=144),c===244&&(a=143),r=3,t=c&7;continue}throw new it("String decoding failed.")}if(!fS(c,o,a)){t=r=n=0,o=128,a=191,--l;continue}o=128,a=191,t=t<<6|c&63,++n,n===r&&(s.push(t),t=r=n=0)}return s}typeof TextDecoder<"u"?G0.decode=G0.decodeWithTextDecoder:G0.decode=G0.decodeWithFromCharCode;var Hl=G0;function $Te(e,t){return t=T(t,0),Hl(e,t,Math.min(4,e.length))}var nM=$Te;var eSe=4;function tSe(e){if(nM(e)!=="glTF")throw new it("File is not valid binary glTF");let n=$K(e,0,5),r=n[1];if(r!==1&&r!==2)throw new it("Binary glTF version is not 1 or 2");return r===1?nSe(e,n):rSe(e,n)}function $K(e,t,n){let r=new DataView(e.buffer),o=new Array(n);for(let a=0;a<n;++a)o[a]=r.getUint32(e.byteOffset+t+a*eSe,!0);return o}function nSe(e,t){let n=t[2],r=t[3];if(t[4]!==0)throw new it("Binary glTF scene format is not JSON");let a=20,s=a+r,u=Hl(e,a,r),l=JSON.parse(u);cS(l);let c=e.subarray(s,n),f=l.buffers;if(_(f)&&Object.keys(f).length>0){let h=T(f.binary_glTF,f.KHR_binary_glTF);_(h)&&(h.extras._pipeline.source=c,delete h.uri)}return JK(l,"KHR_binary_glTF"),l}function rSe(e,t){let n=t[2],r=12,o,a;for(;r<n;){let s=$K(e,r,2),u=s[0],l=s[1];r+=8;let c=e.subarray(r,r+u);if(r+=u,l===1313821514){let f=Hl(c);o=JSON.parse(f),cS(o)}else l===5130562&&(a=c)}if(_(o)&&_(a)){let s=o.buffers;if(_(s)&&s.length>0){let u=s[0];u.extras._pipeline.source=a}}return o}var V1=tSe;function eZ(e){e=T(e,T.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.canceled=e.canceled,this.persists=T(e.persists,!1),this.pass=Qt.COMPUTE,this.owner=e.owner}eZ.prototype.execute=function(e){e.execute(this)};var rF=eZ;var tZ=`varying vec2 v_textureCoordinates;
uniform float originalSize;
uniform sampler2D texture0;
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform sampler2D texture3;
uniform sampler2D texture4;
uniform sampler2D texture5;
const float yMipLevel1 = 1.0 - (1.0 / pow(2.0, 1.0));
const float yMipLevel2 = 1.0 - (1.0 / pow(2.0, 2.0));
const float yMipLevel3 = 1.0 - (1.0 / pow(2.0, 3.0));
const float yMipLevel4 = 1.0 - (1.0 / pow(2.0, 4.0));
void main()
{
vec2 uv = v_textureCoordinates;
vec2 textureSize = vec2(originalSize * 1.5 + 2.0, originalSize);
vec2 pixel = 1.0 / textureSize;
float mipLevel = 0.0;
if (uv.x - pixel.x > (textureSize.y / textureSize.x))
{
mipLevel = 1.0;
if (uv.y - pixel.y > yMipLevel1)
{
mipLevel = 2.0;
if (uv.y - pixel.y * 3.0 > yMipLevel2)
{
mipLevel = 3.0;
if (uv.y - pixel.y * 5.0 > yMipLevel3)
{
mipLevel = 4.0;
if (uv.y - pixel.y * 7.0 > yMipLevel4)
{
mipLevel = 5.0;
}
}
}
}
}
if (mipLevel > 0.0)
{
float scale = pow(2.0, mipLevel);
uv.y -= (pixel.y * (mipLevel - 1.0) * 2.0);
uv.x *= ((textureSize.x - 2.0) / textureSize.y);
uv.x -= 1.0 + pixel.x;
uv.y -= (1.0 - (1.0 / pow(2.0, mipLevel - 1.0)));
uv *= scale;
}
else
{
uv.x *= (textureSize.x / textureSize.y);
}
if(mipLevel == 0.0)
{
gl_FragColor = texture2D(texture0, uv);
}
else if(mipLevel == 1.0)
{
gl_FragColor = texture2D(texture1, uv);
}
else if(mipLevel == 2.0)
{
gl_FragColor = texture2D(texture2, uv);
}
else if(mipLevel == 3.0)
{
gl_FragColor = texture2D(texture3, uv);
}
else if(mipLevel == 4.0)
{
gl_FragColor = texture2D(texture4, uv);
}
else if(mipLevel == 5.0)
{
gl_FragColor = texture2D(texture5, uv);
}
else
{
gl_FragColor = vec4(0.0);
}
}
`;var nZ=`varying vec3 v_cubeMapCoordinates;
uniform samplerCube cubeMap;
void main()
{
vec4 rgba = textureCube(cubeMap, v_cubeMapCoordinates);
#ifdef RGBA_NORMALIZED
gl_FragColor = vec4(rgba.rgb, 1.0);
#else
float m = rgba.a * 16.0;
vec3 r = rgba.rgb * m;
gl_FragColor = vec4(r * r, 1.0);
#endif
}
`;var rZ=`attribute vec4 position;
attribute vec3 cubeMapCoordinates;
varying vec3 v_cubeMapCoordinates;
void main()
{
gl_Position = position;
v_cubeMapCoordinates = cubeMapCoordinates;
}
`;function ky(e){this._url=e,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1;let t=this;this._readyPromise=new Promise((n,r)=>{t._completeLoadFromCache=o=>{iF(this),this._texture=o,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0,n()},t._failLoad=o=>{r(o)},t._completeLoad=()=>{this._ready=!0,n()}})}Object.defineProperties(ky.prototype,{url:{get:function(){return this._url}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});ky.isSupported=function(e){return e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat};var iSe=new x(1,0,0),oSe=new x(0,0,1),aSe=new x(-1,0,0),sSe=new x(0,0,-1),rM=new x(0,1,0),uSe=new x(0,-1,0),aZ=[rM,aSe,oSe,uSe,iSe,rM,sSe,rM,rM],sZ=aZ.length,uZ=new Float32Array(sZ*3),iZ=0;for(let e=0;e<sZ;++e,iZ+=3)x.pack(aZ[e],uZ,iZ);var lSe=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),cSe=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function fSe(e){let t=ki.createVertexBuffer({context:e,typedArray:lSe,usage:We.STATIC_DRAW}),n=ki.createVertexBuffer({context:e,typedArray:uZ,usage:We.STATIC_DRAW}),r=ki.createIndexBuffer({context:e,typedArray:cSe,usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT}),o=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:ie.FLOAT},{index:1,vertexBuffer:n,componentsPerAttribute:3,componentDatatype:ie.FLOAT}];return new Kh({context:e,attributes:o,indexBuffer:r})}function oZ(e){return function(){return e}}function iF(e){e._va=e._va&&e._va.destroy(),e._sp=e._sp&&e._sp.destroy();let t,n,r=e._cubeMaps;if(_(r))for(n=r.length,t=0;t<n;++t)r[t].destroy();let o=e._mipTextures;if(_(o))for(n=o.length,t=0;t<n;++t)o[t].destroy();e._va=void 0,e._sp=void 0,e._cubeMaps=void 0,e._cubeMapBuffers=void 0,e._mipTextures=void 0}ky.prototype.update=function(e){let t=e.context;if(!ky.isSupported(t)||(_(this._texture)&&_(this._va)&&iF(this),_(this._texture)))return;if(!_(this._texture)&&!this._loading){let p=e.context.textureCache.getTexture(this._url);_(p)&&this._completeLoadFromCache(p)}let n=this._cubeMapBuffers;if(!_(n)&&!this._loading){let p=this;Dm(this._url).then(function(g){p._cubeMapBuffers=g,p._loading=!1}).catch(function(g){p._failLoad(g)}),this._loading=!0}if(!_(this._cubeMapBuffers))return;let r=[],o=n[0].positiveX.pixelDatatype;_(o)?r.push("RGBA_NORMALIZED"):o=t.halfFloatingPointTexture?vt.HALF_FLOAT:vt.FLOAT;let a=Gt.RGBA,s=new xt({defines:r,sources:[nZ]});this._va=fSe(t),this._sp=vi.fromCache({context:t,vertexShaderSource:rZ,fragmentShaderSource:s,attributeLocations:{position:0,cubeMapCoordinates:1}});let u=Math.min(n.length,6);this._maximumMipmapLevel=u-1;let l=this._cubeMaps=new Array(u),c=this._mipTextures=new Array(u),f=n[0].positiveX.width*2,h={originalSize:function(){return f}};for(let p=0;p<u;++p){let g=n[p].positiveY;n[p].positiveY=n[p].negativeY,n[p].negativeY=g;let y=l[p]=new hE({context:t,source:n[p],pixelDatatype:o}),v=l[p].width*2,w=c[p]=new $o({context:t,width:v,height:v,pixelDatatype:o,pixelFormat:a}),C=new rF({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:oZ(y)},outputTexture:w,persists:!0,owner:this});e.commandList.push(C),h[`texture${p}`]=oZ(w)}this._texture=new $o({context:t,width:f*1.5+2,height:f,pixelDatatype:o,pixelFormat:a}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture);let d=new rF({fragmentShaderSource:tZ,uniformMap:h,outputTexture:this._texture,persists:!1,owner:this});e.commandList.push(d),this._completeLoad()};ky.prototype.isDestroyed=function(){return!1};ky.prototype.destroy=function(){return iF(this),this._texture=this._texture&&this._texture.destroy(),ot(this)};var k1=ky;function ug(e){e=T(e,T.EMPTY_OBJECT);let t=_(e.imageBasedLightingFactor)?X.clone(e.imageBasedLightingFactor):new X(1,1);this._imageBasedLightingFactor=t;let n=T(e.luminanceAtZenith,.2);this._luminanceAtZenith=n;let r=e.sphericalHarmonicCoefficients;this._sphericalHarmonicCoefficients=r,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapAtlas=void 0,this._specularEnvironmentMapAtlasDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousImageBasedLightingFactor=X.clone(t),this._previousLuminanceAtZenith=n,this._previousSphericalHarmonicCoefficients=r}Object.defineProperties(ug.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){this._previousImageBasedLightingFactor=X.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=X.clone(e,this._imageBasedLightingFactor)}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){this._previousLuminanceAtZenith=this._luminanceAtZenith,this._luminanceAtZenith=e}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){e!==this._specularEnvironmentMaps&&(this._specularEnvironmentMapAtlasDirty=this._specularEnvironmentMapAtlasDirty||e!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=e}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useSphericalHarmonicCoefficients:{get:function(){return _(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics}},specularEnvironmentMapAtlas:{get:function(){return this._specularEnvironmentMapAtlas}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return _(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps}}});function hSe(e,t){if(!!k1.isSupported(t)){if(e._specularEnvironmentMapAtlas=e._specularEnvironmentMapAtlas&&e._specularEnvironmentMapAtlas.destroy(),_(e._specularEnvironmentMaps)){let n=new k1(e._specularEnvironmentMaps);e._specularEnvironmentMapAtlas=n,n.readyPromise.then(function(){e._specularEnvironmentMapLoaded=!0}).catch(function(r){console.error(`Error loading specularEnvironmentMaps: ${r}`)})}e._shouldRegenerateShaders=!0}}ug.prototype.update=function(e){if(e.frameNumber===this._previousFrameNumber)return;this._previousFrameNumber=e.frameNumber;let t=e.context;e.brdfLutGenerator.update(e),this._shouldRegenerateShaders=!1;let n=this._imageBasedLightingFactor,r=this._previousImageBasedLightingFactor;X.equals(n,r)||(this._shouldRegenerateShaders=n.x>0&&r.x===0||n.x===0&&r.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||n.y>0&&r.y===0||n.y===0&&r.y>0,this._previousImageBasedLightingFactor=X.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._luminanceAtZenith!==this._previousLuminanceAtZenith&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||_(this._luminanceAtZenith)!==_(this._previousLuminanceAtZenith),this._previousLuminanceAtZenith=this._luminanceAtZenith),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||_(this._previousSphericalHarmonicCoefficients)!==_(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentMapAtlasDirty&&(hSe(this,t),this._specularEnvironmentMapAtlasDirty=!1),_(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e);let o=!_(this._specularEnvironmentMapAtlas)&&_(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,a=!_(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,s=!_(this._sphericalHarmonicCoefficients)&&_(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,u=!_(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||o||a||s||u,this._useDefaultSpecularMaps=!_(this._specularEnvironmentMapAtlas)&&_(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!_(this._sphericalHarmonicCoefficients)&&_(e.sphericalHarmonicCoefficients)};ug.prototype.isDestroyed=function(){return!1};ug.prototype.destroy=function(){return this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),ot(this)};var dF=Vg(yZ(),1);var GSe=0,pF={};function lg(e,t){let n,r=e;_(pF[r])?n=pF[r]:(n=GSe++,pF[r]=n),t=T(t,!1),this._id=n,this._html=e,this._showOnScreen=t,this._element=void 0}Object.defineProperties(lg.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen},set:function(e){this._showOnScreen=e}},element:{get:function(){if(!_(this._element)){let e=dF.default.sanitize(this._html),t=document.createElement("div");t._creditId=this._id,t.style.display="inline",t.innerHTML=e;let n=t.querySelectorAll("a");for(let r=0;r<n.length;r++)n[r].setAttribute("target","_blank");this._element=t}return this._element}}});lg.equals=function(e,t){return e===t||_(e)&&_(t)&&e._id===t._id&&e._showOnScreen===t._showOnScreen};lg.prototype.equals=function(e){return lg.equals(this,e)};lg.getIonCredit=function(e){let t=_(e.collapsible)&&!e.collapsible,n=new lg(e.html,t);return n._isIon=n.html.indexOf("ion-credit.png")!==-1,n};lg.clone=function(e){if(_(e))return new lg(e.html,e.showOnScreen)};var dS=lg;function USe(e,t,n){return JSON.parse(Hl(e,t,n))}var vZ=USe;function HSe(e){let t=e.uint8Array,n=e.format,r=e.request,o=T(e.flipY,!1),a=T(e.skipColorSpaceConversion,!1),s=new Blob([t],{type:n}),u;return _t.supportsImageBitmapOptions().then(function(l){return l?Promise.resolve(_t.createImageBitmapFromBlob(s,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:a})):(u=window.URL.createObjectURL(s),new _t({url:u,request:r}).fetchImage({flipY:o,skipColorSpaceConversion:a}))}).then(function(l){return _(u)&&window.URL.revokeObjectURL(u),l}).catch(function(l){return _(u)&&window.URL.revokeObjectURL(u),Promise.reject(l)})}var CZ=HSe;function qSe(e,t,n){if(n=T(n,!1),n){let r=e.indexOf(t);if(r>-1)return r}return e.push(t),e.length-1}var $i=qSe;function WSe(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}var Yl=WSe;function YSe(e,t){let n=t.bufferView;if(_(n)){let r=e.bufferViews[n];if(_(r.byteStride)&&r.byteStride>0)return r.byteStride}return ie.getSizeInBytes(t.componentType)*Yl(t.type)}var Sc=YSe;function XSe(e){re.accessor(e,function(n){_(n.bufferView)&&(n.byteOffset=T(n.byteOffset,0))}),re.bufferView(e,function(n){_(n.buffer)&&(n.byteOffset=T(n.byteOffset,0))}),re.mesh(e,function(n){re.meshPrimitive(n,function(r){if(r.mode=T(r.mode,V.TRIANGLES),!_(r.material)){_(e.materials)||(e.materials=[]);let o={name:"default"};r.material=$i(e.materials,o)}})}),re.accessorContainingVertexAttributeData(e,function(n){let r=e.accessors[n],o=r.bufferView;if(r.normalized=T(r.normalized,!1),_(o)){let a=e.bufferViews[o];a.byteStride=Sc(e,r),a.target=V.ARRAY_BUFFER}}),re.accessorContainingIndexData(e,function(n){let o=e.accessors[n].bufferView;if(_(o)){let a=e.bufferViews[o];a.target=V.ELEMENT_ARRAY_BUFFER}}),re.material(e,function(n){let r=T(n.extensions,T.EMPTY_OBJECT),o=r.KHR_materials_common;if(_(o)){let l=o.technique,c=_(o.values)?o.values:{};o.values=c,c.ambient=_(c.ambient)?c.ambient:[0,0,0,1],c.emission=_(c.emission)?c.emission:[0,0,0,1],c.transparency=T(c.transparency,1),c.transparent=T(c.transparent,!1),c.doubleSided=T(c.doubleSided,!1),l!=="CONSTANT"&&(c.diffuse=_(c.diffuse)?c.diffuse:[0,0,0,1],l!=="LAMBERT"&&(c.specular=_(c.specular)?c.specular:[0,0,0,1],c.shininess=T(c.shininess,0)));return}n.emissiveFactor=T(n.emissiveFactor,[0,0,0]),n.alphaMode=T(n.alphaMode,"OPAQUE"),n.doubleSided=T(n.doubleSided,!1),n.alphaMode==="MASK"&&(n.alphaCutoff=T(n.alphaCutoff,.5));let a=r.KHR_techniques_webgl;_(a)&&re.materialValue(n,function(l){_(l.index)&&Uy(l)}),Uy(n.emissiveTexture),Uy(n.normalTexture),Uy(n.occlusionTexture);let s=n.pbrMetallicRoughness;_(s)&&(s.baseColorFactor=T(s.baseColorFactor,[1,1,1,1]),s.metallicFactor=T(s.metallicFactor,1),s.roughnessFactor=T(s.roughnessFactor,1),Uy(s.baseColorTexture),Uy(s.metallicRoughnessTexture));let u=r.KHR_materials_pbrSpecularGlossiness;_(u)&&(u.diffuseFactor=T(u.diffuseFactor,[1,1,1,1]),u.specularFactor=T(u.specularFactor,[1,1,1]),u.glossinessFactor=T(u.glossinessFactor,1),Uy(u.specularGlossinessTexture))}),re.animation(e,function(n){re.animationSampler(n,function(r){r.interpolation=T(r.interpolation,"LINEAR")})});let t=jSe(e);return re.node(e,function(n,r){_(t[r])||_(n.translation)||_(n.rotation)||_(n.scale)?(n.translation=T(n.translation,[0,0,0]),n.rotation=T(n.rotation,[0,0,0,1]),n.scale=T(n.scale,[1,1,1])):n.matrix=T(n.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}),re.sampler(e,function(n){n.wrapS=T(n.wrapS,V.REPEAT),n.wrapT=T(n.wrapT,V.REPEAT)}),_(e.scenes)&&!_(e.scene)&&(e.scene=0),e}function jSe(e){let t={};return re.animation(e,function(n){re.animationChannel(n,function(r){let o=r.target,a=o.node,s=o.path;(s==="translation"||s==="rotation"||s==="scale")&&(t[a]=!0)})}),t}function Uy(e){_(e)&&(e.texCoord=T(e.texCoord,0))}var xZ=XSe;function KSe(e,t){let n=e.extensionsUsed;_(n)||(n=[],e.extensionsUsed=n),$i(n,t,!0)}var q0=KSe;function ZSe(e){switch(e){case ie.BYTE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt8(n+s*o)};case ie.UNSIGNED_BYTE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint8(n+s*o)};case ie.SHORT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt16(n+s*o,!0)};case ie.UNSIGNED_SHORT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint16(n+s*o,!0)};case ie.INT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getInt32(n+s*o,!0)};case ie.UNSIGNED_INT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getUint32(n+s*o,!0)};case ie.FLOAT:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getFloat32(n+s*o,!0)};case ie.DOUBLE:return function(t,n,r,o,a){for(let s=0;s<r;++s)a[s]=t.getFloat64(n+s*o,!0)}}}var lM=ZSe;function QSe(e,t){let n=e.bufferViews,r=e.buffers,o=t.bufferView,a=Yl(t.type);if(!_(t.bufferView))return{min:new Array(a).fill(0),max:new Array(a).fill(0)};let s=new Array(a).fill(Number.POSITIVE_INFINITY),u=new Array(a).fill(Number.NEGATIVE_INFINITY),l=n[o],c=l.buffer,h=r[c].extras._pipeline.source,d=t.count,p=Sc(e,t),g=t.byteOffset+l.byteOffset+h.byteOffset,y=t.componentType,v=ie.getSizeInBytes(y),w=new DataView(h.buffer),C=new Array(a),E=lM(y);for(let S=0;S<d;S++){E(w,g,a,v,C);for(let A=0;A<a;A++){let D=C[A];s[A]=Math.min(s[A],D),u[A]=Math.max(u[A],D)}g+=p}return{min:s,max:u}}var mF=QSe;var JSe=[V.FUNC_ADD,V.FUNC_ADD],$Se=[V.ONE,V.ZERO,V.ONE,V.ZERO];function wZ(e,t){let n=e.enable;return _(n)?n.indexOf(t)>-1:!1}var eAe=[V.ZERO,V.ONE,V.SRC_COLOR,V.ONE_MINUS_SRC_COLOR,V.SRC_ALPHA,V.ONE_MINUS_SRC_ALPHA,V.DST_ALPHA,V.ONE_MINUS_DST_ALPHA,V.DST_COLOR,V.ONE_MINUS_DST_COLOR];function tAe(e,t){if(!_(e))return t;for(let n=0;n<4;n++)if(eAe.indexOf(e[n])===-1)return t;return e}function nAe(e){let t={},n={},r=e.techniques;return _(r)&&(re.technique(e,function(o,a){let s=o.states;if(_(s)){let u=n[a]={};if(wZ(s,V.BLEND)){u.alphaMode="BLEND";let l=s.functions;_(l)&&(_(l.blendEquationSeparate)||_(l.blendFuncSeparate))&&(t[a]={blendEquation:T(l.blendEquationSeparate,JSe),blendFactors:tAe(l.blendFuncSeparate,$Se)})}wZ(s,V.CULL_FACE)||(u.doubleSided=!0),delete o.states}}),Object.keys(t).length>0&&(_(e.extensions)||(e.extensions={}),q0(e,"KHR_blend")),re.material(e,function(o){if(_(o.technique)){let a=n[o.technique];re.objectLegacy(a,function(u,l){o[l]=u});let s=t[o.technique];_(s)&&(_(o.extensions)||(o.extensions={}),o.extensions.KHR_blend=s)}})),e}var EZ=nAe;function rAe(e,t){let n=e.extensionsRequired;_(n)||(n=[],e.extensionsRequired=n),$i(n,t,!0),q0(e,t)}var TZ=rAe;function iAe(e){let t=e.techniques,n={},r={},o={};if(_(t)){let a={programs:[],shaders:[],techniques:[]},s=e.glExtensionsUsed;delete e.glExtensionsUsed,re.technique(e,function(u,l){let c={name:u.name,program:void 0,attributes:{},uniforms:{}},f;if(re.techniqueAttribute(u,function(h,d){f=u.parameters[h],c.attributes[d]={semantic:f.semantic}}),re.techniqueUniform(u,function(h,d){f=u.parameters[h],c.uniforms[d]={count:f.count,node:f.node,type:f.type,semantic:f.semantic,value:f.value},_(n[l])||(n[l]={}),n[l][h]=d}),_(o[u.program]))c.program=o[u.program];else{let h=e.programs[u.program],d={name:h.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:s},p=e.shaders[h.fragmentShader];d.fragmentShader=$i(a.shaders,p,!0);let g=e.shaders[h.vertexShader];d.vertexShader=$i(a.shaders,g,!0),c.program=$i(a.programs,d),o[u.program]=c.program}r[l]=$i(a.techniques,c)}),a.techniques.length>0&&(_(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=a,q0(e,"KHR_techniques_webgl"),TZ(e,"KHR_techniques_webgl"))}return re.material(e,function(a){if(_(a.technique)){let s={technique:r[a.technique]};re.objectLegacy(a.values,function(u,l){_(s.values)||(s.values={});let c=n[a.technique][l];s.values[c]=u}),_(a.extensions)||(a.extensions={}),a.extensions.KHR_techniques_webgl=s}delete a.technique,delete a.values}),delete e.techniques,delete e.programs,delete e.shaders,e}var SZ=iAe;function oAe(e,t){Ss.typeOf.object("material",e),Ss.defined("handler",t);let n=e.pbrMetallicRoughness;if(_(n)){if(_(n.baseColorTexture)){let o=n.baseColorTexture,a=t(o.index,o);if(_(a))return a}if(_(n.metallicRoughnessTexture)){let o=n.metallicRoughnessTexture,a=t(o.index,o);if(_(a))return a}}if(_(e.extensions)){let o=e.extensions.KHR_materials_pbrSpecularGlossiness;if(_(o)){if(_(o.diffuseTexture)){let s=o.diffuseTexture,u=t(s.index,s);if(_(u))return u}if(_(o.specularGlossinessTexture)){let s=o.specularGlossinessTexture,u=t(s.index,s);if(_(u))return u}}let a=e.extensions.KHR_materials_common;if(_(a)){let s=a.values.diffuse,u=a.values.ambient,l=a.values.emission,c=a.values.specular;if(_(s)&&_(s.index)){let f=t(s.index,s);if(_(f))return f}if(_(u)&&_(u.index)){let f=t(u.index,u);if(_(f))return f}if(_(l)&&_(l.index)){let f=t(l.index,l);if(_(f))return f}if(_(c)&&_(c.index)){let f=t(c.index,c);if(_(f))return f}}}let r=re.materialValue(e,function(o){if(_(o.index)){let a=t(o.index,o);if(_(a))return a}});if(_(r))return r;if(_(e.emissiveTexture)){let o=e.emissiveTexture,a=t(o.index,o);if(_(a))return a}if(_(e.normalTexture)){let o=e.normalTexture,a=t(o.index,o);if(_(a))return a}if(_(e.occlusionTexture)){let o=e.occlusionTexture,a=t(o.index,o);if(_(a))return a}}var gF=oAe;var AZ=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"];function aAe(e,t){return t=T(t,AZ),AZ.forEach(function(n){t.indexOf(n)>-1&&uAe(e,n)}),e}var sAe={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function uAe(e,t){let n=sAe[t],r=e[n];if(_(r)){let o=0,a=zp[t](e),s=r.length;for(let u=0;u<s;++u)a[u]||(Fp[t](e,u-o),o++)}}function Fp(){}Fp.accessor=function(e,t){e.accessors.splice(t,1),re.mesh(e,function(r){re.meshPrimitive(r,function(o){re.meshPrimitiveAttribute(o,function(s,u){s>t&&o.attributes[u]--}),re.meshPrimitiveTarget(o,function(s){re.meshPrimitiveTargetAttribute(s,function(u,l){u>t&&s[l]--})});let a=o.indices;_(a)&&a>t&&o.indices--})}),re.skin(e,function(r){_(r.inverseBindMatrices)&&r.inverseBindMatrices>t&&r.inverseBindMatrices--}),re.animation(e,function(r){re.animationSampler(r,function(o){_(o.input)&&o.input>t&&o.input--,_(o.output)&&o.output>t&&o.output--})})};Fp.buffer=function(e,t){e.buffers.splice(t,1),re.bufferView(e,function(r){_(r.buffer)&&r.buffer>t&&r.buffer--,_(r.extensions)&&_(r.extensions.EXT_meshopt_compression)&&r.extensions.EXT_meshopt_compression.buffer--})};Fp.bufferView=function(e,t){if(e.bufferViews.splice(t,1),re.accessor(e,function(r){_(r.bufferView)&&r.bufferView>t&&r.bufferView--}),re.shader(e,function(r){_(r.bufferView)&&r.bufferView>t&&r.bufferView--}),re.image(e,function(r){_(r.bufferView)&&r.bufferView>t&&r.bufferView--}),Ho(e,"KHR_draco_mesh_compression")&&re.mesh(e,function(r){re.meshPrimitive(r,function(o){_(o.extensions)&&_(o.extensions.KHR_draco_mesh_compression)&&o.extensions.KHR_draco_mesh_compression.bufferView>t&&o.extensions.KHR_draco_mesh_compression.bufferView--})}),Ho(e,"EXT_feature_metadata")){let o=e.extensions.EXT_feature_metadata.featureTables;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].properties;if(_(u)){for(let l in u)if(u.hasOwnProperty(l)){let c=u[l];_(c.bufferView)&&c.bufferView>t&&c.bufferView--,_(c.arrayOffsetBufferView)&&c.arrayOffsetBufferView>t&&c.arrayOffsetBufferView--,_(c.stringOffsetBufferView)&&c.stringOffsetBufferView>t&&c.stringOffsetBufferView--}}}}};Fp.image=function(e,t){e.images.splice(t,1),re.texture(e,function(r){_(r.source)&&r.source>t&&--r.source;let o=r.extensions;_(o)&&_(o.EXT_texture_webp)&&o.EXT_texture_webp.source>t?--r.extensions.EXT_texture_webp.source:_(o)&&_(o.KHR_texture_basisu)&&o.KHR_texture_basisu.source>t&&--r.extensions.KHR_texture_basisu.source})};Fp.mesh=function(e,t){e.meshes.splice(t,1),re.node(e,function(r){_(r.mesh)&&(r.mesh>t?r.mesh--:r.mesh===t&&delete r.mesh)})};Fp.node=function(e,t){e.nodes.splice(t,1),re.skin(e,function(r){_(r.skeleton)&&r.skeleton>t&&r.skeleton--,r.joints=r.joints.map(function(o){return o>t?o-1:o})}),re.animation(e,function(r){re.animationChannel(r,function(o){_(o.target)&&_(o.target.node)&&o.target.node>t&&o.target.node--})}),re.technique(e,function(r){re.techniqueUniform(r,function(o){_(o.node)&&o.node>t&&o.node--})}),re.node(e,function(r){!_(r.children)||(r.children=r.children.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o}))}),re.scene(e,function(r){r.nodes=r.nodes.filter(function(o){return o!==t}).map(function(o){return o>t?o-1:o})})};Fp.material=function(e,t){e.materials.splice(t,1),re.mesh(e,function(r){re.meshPrimitive(r,function(o){_(o.material)&&o.material>t&&o.material--})})};Fp.sampler=function(e,t){e.samplers.splice(t,1),re.texture(e,function(r){_(r.sampler)&&r.sampler>t&&--r.sampler})};Fp.texture=function(e,t){if(e.textures.splice(t,1),re.material(e,function(r){gF(r,function(o,a){a.index>t&&--a.index})}),Ho(e,"EXT_feature_metadata")){re.mesh(e,function(a){re.meshPrimitive(a,function(s){let u=s.extensions;if(_(u)&&_(u.EXT_feature_metadata)){let c=u.EXT_feature_metadata.featureIdTextures;if(_(c)){let f=c.length;for(let h=0;h<f;++h){let p=c[h].featureIds.texture;p.index>t&&--p.index}}}})});let o=e.extensions.EXT_feature_metadata.featureTextures;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].properties;if(_(u)){for(let l in u)if(u.hasOwnProperty(l)){let f=u[l].texture;f.index>t&&--f.index}}}}};function zp(){}zp.accessor=function(e){let t={};return re.mesh(e,function(n){re.meshPrimitive(n,function(r){re.meshPrimitiveAttribute(r,function(a){t[a]=!0}),re.meshPrimitiveTarget(r,function(a){re.meshPrimitiveTargetAttribute(a,function(s){t[s]=!0})});let o=r.indices;_(o)&&(t[o]=!0)})}),re.skin(e,function(n){_(n.inverseBindMatrices)&&(t[n.inverseBindMatrices]=!0)}),re.animation(e,function(n){re.animationSampler(n,function(r){_(r.input)&&(t[r.input]=!0),_(r.output)&&(t[r.output]=!0)})}),Ho(e,"EXT_mesh_gpu_instancing")&&re.node(e,function(n){_(n.extensions)&&_(n.extensions.EXT_mesh_gpu_instancing)&&Object.keys(n.extensions.EXT_mesh_gpu_instancing.attributes).forEach(function(r){let o=n.extensions.EXT_mesh_gpu_instancing.attributes[r];t[o]=!0})}),t};zp.buffer=function(e){let t={};return re.bufferView(e,function(n){_(n.buffer)&&(t[n.buffer]=!0),_(n.extensions)&&_(n.extensions.EXT_meshopt_compression)&&(t[n.extensions.EXT_meshopt_compression.buffer]=!0)}),t};zp.bufferView=function(e){let t={};if(re.accessor(e,function(n){_(n.bufferView)&&(t[n.bufferView]=!0)}),re.shader(e,function(n){_(n.bufferView)&&(t[n.bufferView]=!0)}),re.image(e,function(n){_(n.bufferView)&&(t[n.bufferView]=!0)}),Ho(e,"KHR_draco_mesh_compression")&&re.mesh(e,function(n){re.meshPrimitive(n,function(r){_(r.extensions)&&_(r.extensions.KHR_draco_mesh_compression)&&(t[r.extensions.KHR_draco_mesh_compression.bufferView]=!0)})}),Ho(e,"EXT_feature_metadata")){let r=e.extensions.EXT_feature_metadata.featureTables;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o].properties;if(_(s)){for(let u in s)if(s.hasOwnProperty(u)){let l=s[u];_(l.bufferView)&&(t[l.bufferView]=!0),_(l.arrayOffsetBufferView)&&(t[l.arrayOffsetBufferView]=!0),_(l.stringOffsetBufferView)&&(t[l.stringOffsetBufferView]=!0)}}}}return t};zp.image=function(e){let t={};return re.texture(e,function(n){_(n.source)&&(t[n.source]=!0),_(n.extensions)&&_(n.extensions.EXT_texture_webp)?t[n.extensions.EXT_texture_webp.source]=!0:_(n.extensions)&&_(n.extensions.KHR_texture_basisu)&&(t[n.extensions.KHR_texture_basisu.source]=!0)}),t};zp.mesh=function(e){let t={};return re.node(e,function(n){if(_(n.mesh&&_(e.meshes))){let r=e.meshes[n.mesh];_(r)&&_(r.primitives)&&r.primitives.length>0&&(t[n.mesh]=!0)}}),t};function bZ(e,t,n){let r=e.nodes[t];return _(r.mesh)||_(r.camera)||_(r.skin)||_(r.weights)||_(r.extras)||_(r.extensions)&&Object.keys(r.extensions).length!==0||_(n[t])?!1:!_(r.children)||r.children.filter(function(o){return!bZ(e,o,n)}).length===0}zp.node=function(e){let t={};return re.skin(e,function(n){_(n.skeleton)&&(t[n.skeleton]=!0),re.skinJoint(n,function(r){t[r]=!0})}),re.animation(e,function(n){re.animationChannel(n,function(r){_(r.target)&&_(r.target.node)&&(t[r.target.node]=!0)})}),re.technique(e,function(n){re.techniqueUniform(n,function(r){_(r.node)&&(t[r.node]=!0)})}),re.node(e,function(n,r){bZ(e,r,t)||(t[r]=!0)}),t};zp.material=function(e){let t={};return re.mesh(e,function(n){re.meshPrimitive(n,function(r){_(r.material)&&(t[r.material]=!0)})}),t};zp.texture=function(e){let t={};if(re.material(e,function(n){gF(n,function(r){t[r]=!0})}),Ho(e,"EXT_feature_metadata")){re.mesh(e,function(o){re.meshPrimitive(o,function(a){let s=a.extensions;if(_(s)&&_(s.EXT_feature_metadata)){let l=s.EXT_feature_metadata.featureIdTextures;if(_(l)){let c=l.length;for(let f=0;f<c;++f){let d=l[f].featureIds.texture;t[d.index]=!0}}}})});let r=e.extensions.EXT_feature_metadata.featureTextures;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o].properties;if(_(s)){for(let u in s)if(s.hasOwnProperty(u)){let c=s[u].texture;t[c.index]=!0}}}}return t};zp.sampler=function(e){let t={};return re.texture(e,function(n){_(n.sampler)&&(t[n.sampler]=!0)}),t};var IZ=aAe;function lAe(e,t){let n={byteLength:t.length,extras:{_pipeline:{source:t}}},o={buffer:$i(e.buffers,n),byteOffset:0,byteLength:t.length};return $i(e.bufferViews,o)}var DZ=lAe;function cAe(e,t){let n=Sc(e,t),r=ie.getSizeInBytes(t.componentType),o=Yl(t.type),a=t.count,s=new Array(o*a);if(!_(t.bufferView))return s.fill(0);let u=e.bufferViews[t.bufferView],l=e.buffers[u.buffer].extras._pipeline.source,c=t.byteOffset+u.byteOffset+l.byteOffset,f=new DataView(l.buffer),h=new Array(o),d=lM(t.componentType);for(let p=0;p<a;++p){d(f,c,o,r,h);for(let g=0;g<o;++g)s[p*o+g]=h[g];c+=n}return s}var PZ=cAe;function fAe(e){let t;return re.accessorWithSemantic(e,"JOINTS_0",function(n){let r=e.accessors[n];t=r.componentType,t===V.BYTE?cM(e,r,ie.UNSIGNED_BYTE):t!==V.UNSIGNED_BYTE&&t!==V.UNSIGNED_SHORT&&cM(e,r,ie.UNSIGNED_SHORT)}),re.accessorWithSemantic(e,"WEIGHTS_0",function(n){let r=e.accessors[n];t=r.componentType,t===V.BYTE?cM(e,r,ie.UNSIGNED_BYTE):t===V.SHORT&&cM(e,r,ie.UNSIGNED_SHORT)}),e}function cM(e,t,n){let r=ie.createTypedArray(n,PZ(e,t)),o=new Uint8Array(r.buffer);t.bufferView=DZ(e,o),t.componentType=n,t.byteOffset=0}var MZ=fAe;var fM={.8:_Ae,"1.0":FAe,"2.0":void 0};function hAe(e,t){t=T(t,T.EMPTY_OBJECT);let n=t.targetVersion,r=e.version;e.asset=T(e.asset,{version:"1.0"}),e.asset.version=T(e.asset.version,"1.0"),r=T(r,e.asset.version).toString(),Object.prototype.hasOwnProperty.call(fM,r)||(_(r)&&(r=r.substring(0,3)),Object.prototype.hasOwnProperty.call(fM,r)||(r="1.0"));let o=fM[r];for(;_(o)&&r!==n;)o(e,t),r=e.asset.version,o=fM[r];return e}function RZ(e){let t=e.materials;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.instanceTechnique;_(o)&&(r.technique=o.technique,r.values=o.values,delete r.instanceTechnique)}}function dAe(e){let t=e.meshes;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let o=t[n].primitives;if(_(o)){let a=o.length;for(let s=0;s<a;++s){let u=o[s],l=T(u.primitive,V.TRIANGLES);u.mode=T(u.mode,l),delete u.primitive}}}}function pAe(e){let t=e.nodes,n=new x,r=new je;for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let a=t[o];if(_(a.rotation)){let u=a.rotation;x.fromArray(u,0,n),je.fromAxisAngle(n,u[3],r),a.rotation=[r.x,r.y,r.z,r.w]}let s=a.instanceSkin;_(s)&&(a.skeletons=s.skeletons,a.skin=s.skin,a.meshes=s.meshes,delete a.instanceSkin)}}function mAe(e){let t=e.animations,n=e.accessors,r=e.bufferViews,o=e.buffers,a={},s=new x,u=new je;for(let l in t)if(Object.prototype.hasOwnProperty.call(t,l)){let c=t[l],f=c.channels,h=c.parameters,d=c.samplers;if(_(f)){let p=f.length;for(let g=0;g<p;++g){let y=f[g];if(y.target.path==="rotation"){let v=h[d[y.sampler].output];if(_(a[v]))continue;a[v]=!0;let w=n[v],C=r[w.bufferView],S=o[C.buffer].extras._pipeline.source,A=S.byteOffset+C.byteOffset+w.byteOffset,D=w.componentType,P=w.count,M=Yl(w.type),I=w.count*M,O=ie.createArrayBufferView(D,S.buffer,A,I);for(let m=0;m<P;m++){let b=m*M;x.unpack(O,b,s);let L=O[b+3];je.fromAxisAngle(s,L,u),je.pack(u,O,b)}}}}}}function gAe(e){let t=e.techniques;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.passes;if(_(o)){let a=T(r.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(o,a)){let s=o[a],u=s.instanceProgram;r.attributes=T(r.attributes,u.attributes),r.program=T(r.program,u.program),r.uniforms=T(r.uniforms,u.uniforms),r.states=T(r.states,s.states)}delete r.passes,delete r.pass}}}function _Ae(e){_(e.asset)||(e.asset={});let t=e.asset;if(t.version="1.0",typeof t.profile=="string"){let n=t.profile.split(" ");t.profile={api:n[0],version:n[1]}}else t.profile={};if(_(e.version)&&delete e.version,RZ(e),dAe(e),pAe(e),mAe(e),gAe(e),_(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions),_(e.lights)){let n=T(e.extensions,{});e.extensions=n;let r=T(n.KHR_materials_common,{});n.KHR_materials_common=r,r.lights=e.lights,delete e.lights,q0(e,"KHR_materials_common")}}function yAe(e){let t=e.animations;for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],o=r.parameters;if(_(o)){let a=r.samplers;for(let s in a)if(Object.prototype.hasOwnProperty.call(a,s)){let u=a[s];u.input=o[u.input],u.output=o[u.output]}delete r.parameters}}}function LZ(e,t){let n=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];t[r]=n.length,n.push(o),_(o.name)||(o.name=r)}return n}function vAe(e){let t,n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},r,o={},a=e.nodes;for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r=a[s].jointName,_(r)&&(o[r]=s));for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&_(n[s])){let u={},l=e[s];e[s]=LZ(l,u),n[s]=u}for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(o[r]=n.nodes[o[r]]);_(e.scene)&&(e.scene=n.scenes[e.scene]),re.bufferView(e,function(s){_(s.buffer)&&(s.buffer=n.buffers[s.buffer])}),re.accessor(e,function(s){_(s.bufferView)&&(s.bufferView=n.bufferViews[s.bufferView])}),re.shader(e,function(s){let u=s.extensions;if(_(u)){let l=u.KHR_binary_glTF;_(l)&&(s.bufferView=n.bufferViews[l.bufferView],delete u.KHR_binary_glTF),Object.keys(u).length===0&&delete s.extensions}}),re.program(e,function(s){_(s.vertexShader)&&(s.vertexShader=n.shaders[s.vertexShader]),_(s.fragmentShader)&&(s.fragmentShader=n.shaders[s.fragmentShader])}),re.technique(e,function(s){_(s.program)&&(s.program=n.programs[s.program]),re.techniqueParameter(s,function(u){_(u.node)&&(u.node=n.nodes[u.node]);let l=u.value;typeof l=="string"&&(u.value={index:n.textures[l]})})}),re.mesh(e,function(s){re.meshPrimitive(s,function(u){_(u.indices)&&(u.indices=n.accessors[u.indices]),re.meshPrimitiveAttribute(u,function(l,c){u.attributes[c]=n.accessors[l]}),_(u.material)&&(u.material=n.materials[u.material])})}),re.node(e,function(s){let u=s.children;if(_(u)){let l=u.length;for(t=0;t<l;++t)u[t]=n.nodes[u[t]]}if(_(s.meshes)){let l=s.meshes,c=l.length;if(c>0)for(s.mesh=n.meshes[l[0]],t=1;t<c;++t){let f={mesh:n.meshes[l[t]]},h=$i(e.nodes,f);_(u)||(u=[],s.children=u),u.push(h)}delete s.meshes}if(_(s.camera)&&(s.camera=n.cameras[s.camera]),_(s.skin)&&(s.skin=n.skins[s.skin]),_(s.skeletons)){let l=s.skeletons;if(l.length>0&&_(s.skin)){let f=e.skins[s.skin];f.skeleton=n.nodes[l[0]]}delete s.skeletons}_(s.jointName)&&delete s.jointName}),re.skin(e,function(s){_(s.inverseBindMatrices)&&(s.inverseBindMatrices=n.accessors[s.inverseBindMatrices]);let u=s.jointNames;if(_(u)){let l=[],c=u.length;for(t=0;t<c;++t)l[t]=o[u[t]];s.joints=l,delete s.jointNames}}),re.scene(e,function(s){let u=s.nodes;if(_(u)){let l=u.length;for(t=0;t<l;++t)u[t]=n.nodes[u[t]]}}),re.animation(e,function(s){let u={};s.samplers=LZ(s.samplers,u),re.animationSampler(s,function(l){l.input=n.accessors[l.input],l.output=n.accessors[l.output]}),re.animationChannel(s,function(l){l.sampler=u[l.sampler];let c=l.target;_(c)&&(c.node=n.nodes[c.id],delete c.id)})}),re.material(e,function(s){_(s.technique)&&(s.technique=n.techniques[s.technique]),re.materialValue(s,function(l,c){typeof l=="string"&&(s.values[c]={index:n.textures[l]})});let u=s.extensions;if(_(u)){let l=u.KHR_materials_common;_(l)&&re.materialValue(l,function(c,f){typeof c=="string"&&(l.values[f]={index:n.textures[c]})})}}),re.image(e,function(s){let u=s.extensions;if(_(u)){let l=u.KHR_binary_glTF;_(l)&&(s.bufferView=n.bufferViews[l.bufferView],s.mimeType=l.mimeType,delete u.KHR_binary_glTF),Object.keys(u).length===0&&delete s.extensions}}),re.texture(e,function(s){_(s.sampler)&&(s.sampler=n.samplers[s.sampler]),_(s.source)&&(s.source=n.images[s.source])})}function CAe(e){re.animation(e,function(t){re.animationSampler(t,function(n){delete n.name})})}function xAe(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n=e[t];Array.isArray(n)&&n.length===0&&delete e[t]}re.node(e,function(t){_(t.children)&&t.children.length===0&&delete t.children})}function wAe(e){let t=e.asset;delete t.profile,delete t.premultipliedAlpha}var EAe={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};function TAe(e){let t=e.extensionsUsed;if(e.extensionsRequired=T(e.extensionsRequired,[]),_(t)){let n=t.length;for(let r=0;r<n;++r){let o=t[r];_(EAe[o])&&e.extensionsRequired.push(o)}}}function SAe(e){re.buffer(e,function(t){delete t.type})}function AAe(e){re.texture(e,function(t){delete t.format,delete t.internalFormat,delete t.target,delete t.type})}function bAe(e){re.mesh(e,function(t){re.meshPrimitive(t,function(n){re.meshPrimitiveAttribute(n,function(r,o){o==="TEXCOORD"?n.attributes.TEXCOORD_0=r:o==="COLOR"&&(n.attributes.COLOR_0=r)}),delete n.attributes.TEXCOORD,delete n.attributes.COLOR})}),re.technique(e,function(t){re.techniqueParameter(t,function(n){let r=n.semantic;_(r)&&(r==="TEXCOORD"?n.semantic="TEXCOORD_0":r==="COLOR"&&(n.semantic="COLOR_0"))})})}var IAe={POSITION:!0,NORMAL:!0,TANGENT:!0},DAe={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function PAe(e){let t={};re.mesh(e,function(n){re.meshPrimitive(n,function(r){re.meshPrimitiveAttribute(r,function(o,a){if(a.charAt(0)!=="_"){let s=a.search(/_[0-9]+/g),u=a,l="_0";s>=0&&(u=a.substring(0,s),l=a.substring(s));let c,f=DAe[u];_(f)?(c=f+l,t[a]=c):_(IAe[u])||(c="_"+a,t[a]=c)}});for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let a=t[o],s=r.attributes[o];_(s)&&(delete r.attributes[o],r.attributes[a]=s)}})}),re.technique(e,function(n){re.techniqueParameter(n,function(r){let o=t[r.semantic];_(o)&&(r.semantic=o)})})}function MAe(e){re.camera(e,function(t){let n=t.perspective;if(_(n)){let r=n.aspectRatio;_(r)&&r===0&&delete n.aspectRatio;let o=n.yfov;_(o)&&o===0&&(n.yfov=1)}})}function _F(e,t){return _(t.byteStride)&&t.byteStride!==0?t.byteStride:Sc(e,t)}function LAe(e){re.buffer(e,function(t){_(t.byteLength)||(t.byteLength=t.extras._pipeline.source.length)}),re.accessor(e,function(t){let n=t.bufferView;if(_(n)){let r=e.bufferViews[n],o=_F(e,t),a=t.byteOffset+t.count*o;r.byteLength=Math.max(T(r.byteLength,0),a)}})}function RAe(e){let t,n,r,o=e.bufferViews,a={};re.accessorContainingVertexAttributeData(e,function(u){let l=e.accessors[u];_(l.bufferView)&&(a[l.bufferView]=!0)});let s={};re.accessor(e,function(u){_(u.bufferView)&&(s[u.bufferView]=T(s[u.bufferView],[]),s[u.bufferView].push(u))});for(let u in s)if(Object.prototype.hasOwnProperty.call(s,u)){r=o[u];let l=s[u];l.sort(function(d,p){return d.byteOffset-p.byteOffset});let c=0,f=0,h=l.length;for(t=0;t<h;++t){let d=l[t],p=_F(e,d),g=d.byteOffset,y=d.count*p;delete d.byteStride;let v=t<h-1,w=v?_F(e,l[t+1]):void 0;if(p!==w){let C=kt(r,!0);a[u]&&(C.byteStride=p),C.byteOffset+=c,C.byteLength=g+y-c;let E=$i(o,C);for(n=f;n<=t;++n)d=l[n],d.bufferView=E,d.byteOffset=d.byteOffset-c;c=v?l[t+1].byteOffset:void 0,f=t+1}}}IZ(e,["accessor","bufferView","buffer"])}function OAe(e){re.accessorWithSemantic(e,"POSITION",function(t){let n=e.accessors[t];if(!_(n.min)||!_(n.max)){let r=mF(e,n);n.min=r.min,n.max=r.max}})}function OZ(e){return(!_(e.children)||e.children.length===0)&&(!_(e.meshes)||e.meshes.length===0)&&!_(e.camera)&&!_(e.skin)&&!_(e.skeletons)&&!_(e.jointName)&&(!_(e.translation)||x.fromArray(e.translation).equals(x.ZERO))&&(!_(e.scale)||x.fromArray(e.scale).equals(new x(1,1,1)))&&(!_(e.rotation)||Se.fromArray(e.rotation).equals(new Se(0,0,0,1)))&&(!_(e.matrix)||U.fromColumnMajorArray(e.matrix).equals(U.IDENTITY))&&!_(e.extensions)&&!_(e.extras)}function NZ(e,t){re.scene(e,function(n){let r=n.nodes;if(_(r)){let o=r.length;for(let a=o;a>=0;--a)if(r[a]===t){r.splice(a,1);return}}}),re.node(e,function(n,r){if(_(n.children)){let o=n.children.indexOf(t);o>-1&&(n.children.splice(o,1),OZ(n)&&NZ(e,r))}}),delete e.nodes[t]}function NAe(e){return re.node(e,function(t,n){OZ(t)&&NZ(e,n)}),e}function BAe(e){re.animation(e,function(t){re.animationSampler(t,function(n){let r=e.accessors[n.input];if(!_(r.min)||!_(r.max)){let o=mF(e,r);r.min=o.min,r.max=o.max}})})}function FAe(e){e.asset=T(e.asset,{}),e.asset.version="2.0",RZ(e),yAe(e),NAe(e),vAe(e),CAe(e),wAe(e),TAe(e),LAe(e),RAe(e),OAe(e),BAe(e),SAe(e),AAe(e),bAe(e),PAe(e),MZ(e),MAe(e),EZ(e),SZ(e),xAe(e)}var BZ=hAe;var cg={X:0,Y:1,Z:2};cg.Y_UP_TO_Z_UP=U.fromRotationTranslation(ne.fromRotationX(z.PI_OVER_TWO));cg.Z_UP_TO_Y_UP=U.fromRotationTranslation(ne.fromRotationX(-z.PI_OVER_TWO));cg.X_UP_TO_Z_UP=U.fromRotationTranslation(ne.fromRotationY(-z.PI_OVER_TWO));cg.Z_UP_TO_X_UP=U.fromRotationTranslation(ne.fromRotationY(z.PI_OVER_TWO));cg.X_UP_TO_Y_UP=U.fromRotationTranslation(ne.fromRotationZ(z.PI_OVER_TWO));cg.Y_UP_TO_X_UP=U.fromRotationTranslation(ne.fromRotationZ(-z.PI_OVER_TWO));cg.fromName=function(e){return cg[e]};var Fu=Object.freeze(cg);function G1(e,t){this._distance=t,this._normal=new FZ(e,this),this.onChangeCallback=void 0,this.index=-1}Object.defineProperties(G1.prototype,{distance:{get:function(){return this._distance},set:function(e){_(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){_(this.onChangeCallback)&&!x.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),x.clone(e,this._normal._cartesian3)}}});G1.fromPlane=function(e,t){return _(t)?(t.normal=e.normal,t.distance=e.distance):t=new G1(e.normal,e.distance),t};G1.clone=function(e,t){return _(t)?(t.normal=e.normal,t.distance=e.distance,t):new G1(e.normal,e.distance)};function FZ(e,t){this._clippingPlane=t,this._cartesian3=x.clone(e)}Object.defineProperties(FZ.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){_(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){_(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){_(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});var hM=G1;function _l(e){e=T(e,T.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=T(e.enabled,!0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this.edgeColor=K.clone(T(e.edgeColor,K.WHITE)),this.edgeWidth=T(e.edgeWidth,0),this.planeAdded=new xe,this.planeRemoved=new xe,this._owner=void 0;let t=T(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?UZ:HZ,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;let n=e.planes;if(_(n)){let r=n.length;for(let o=0;o<r;++o)this.add(n[o])}}function UZ(e){return e===gi.OUTSIDE}function HZ(e){return e===gi.INSIDE}Object.defineProperties(_l.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?UZ:HZ)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}});function zZ(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||e._dirtyIndex!==-1&&e._dirtyIndex!==t,e._dirtyIndex=t}_l.prototype.add=function(e){let t=this._planes.length,n=this;e.onChangeCallback=function(r){zZ(n,r)},e.index=t,zZ(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)};_l.prototype.get=function(e){return this._planes[e]};function qZ(e,t){let n=e.length;for(let r=0;r<n;++r)if(oi.equals(e[r],t))return r;return-1}_l.prototype.contains=function(e){return qZ(this._planes,e)!==-1};_l.prototype.remove=function(e){let t=this._planes,n=qZ(t,e);if(n===-1)return!1;e instanceof hM&&(e.onChangeCallback=void 0,e.index=-1);let r=t.length-1;for(let o=n;o<r;++o){let a=t[o+1];t[o]=a,a instanceof hM&&(a.index=o)}return this._multipleDirtyPlanes=!0,t.length=r,this.planeRemoved.raiseEvent(e,n),!0};_l.prototype.removeAll=function(){let e=this._planes,t=e.length;for(let n=0;n<t;++n){let r=e[n];r instanceof hM&&(r.onChangeCallback=void 0,r.index=-1),this.planeRemoved.raiseEvent(r,n)}this._multipleDirtyPlanes=!0,this._planes=[]};var zAe=new Se,VAe=new Se;function VZ(e,t,n){let r=e._uint8View,o=e._planes,a=0;for(let s=t;s<n;++s){let u=o[s],l=ma.octEncodeToCartesian4(u.normal,VAe);r[a]=l.x,r[a+1]=l.y,r[a+2]=l.z,r[a+3]=l.w;let c=Se.packFloat(u.distance,zAe);r[a+4]=c.x,r[a+5]=c.y,r[a+6]=c.z,r[a+7]=c.w,a+=8}}function kZ(e,t,n){let r=e._float32View,o=e._planes,a=0;for(let s=t;s<n;++s){let u=o[s],l=u.normal;r[a]=l.x,r[a+1]=l.y,r[a+2]=l.z,r[a+3]=u.distance,a+=4}}function WZ(e,t){let n=Kt.maximumTextureSize;return t.x=Math.min(e,n),t.y=Math.ceil(e/t.x),t}var kAe=new X;_l.prototype.update=function(e){let t=this._clippingPlanesTexture,n=e.context,r=_l.useFloatTexture(n),o=r?this.length:this.length*2;if(_(t)){let s=t.width*t.height;(s<o||o<.25*s)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(this.length===0)return;if(!_(t)){let s=WZ(o,kAe);s.y*=2,r?(t=new $o({context:n,width:s.x,height:s.y,pixelFormat:Gt.RGBA,pixelDatatype:vt.FLOAT,sampler:La.NEAREST,flipY:!1}),this._float32View=new Float32Array(s.x*s.y*4)):(t=new $o({context:n,width:s.x,height:s.y,pixelFormat:Gt.RGBA,pixelDatatype:vt.UNSIGNED_BYTE,sampler:La.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(s.x*s.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}let a=this._dirtyIndex;if(!(!this._multipleDirtyPlanes&&a===-1)){if(this._multipleDirtyPlanes)r?(kZ(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(VZ(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let s=0,u=0;r?(u=Math.floor(a/t.width),s=Math.floor(a-u*t.width),kZ(this,a,a+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:s,yOffset:u})):(u=Math.floor(a*2/t.width),s=Math.floor(a*2-u*t.width),VZ(this,a,a+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:s,yOffset:u}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};var GAe=new U,GZ=new oi(x.UNIT_X,0);_l.prototype.computeIntersectionWithBoundingVolume=function(e,t){let n=this._planes,r=n.length,o=this.modelMatrix;_(t)&&(o=U.multiply(t,o,GAe));let a=gi.INSIDE;!this.unionClippingRegions&&r>0&&(a=gi.OUTSIDE);for(let s=0;s<r;++s){let u=n[s];oi.transform(u,o,GZ);let l=e.intersectPlane(GZ);if(l===gi.INTERSECTING)a=l;else if(this._testIntersection(l))return l}return a};_l.setOwner=function(e,t,n){e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),_(e)&&(e._owner=t,t[n]=e))};_l.useFloatTexture=function(e){return e.floatingPointTexture};_l.getTextureResolution=function(e,t,n){let r=e.texture;if(_(r))return n.x=r.width,n.y=r.height,n;let o=_l.useFloatTexture(t)?e.length:e.length*2,a=WZ(o,n);return a.y*=2,a};_l.prototype.isDestroyed=function(){return!1};_l.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),ot(this)};var pS=_l;function Ur(){}Ur._maxDecodingConcurrency=Math.max(Qo.hardwareConcurrency-1,1);Ur._decoderTaskProcessor=void 0;Ur._taskProcessorReady=!1;Ur._getDecoderTaskProcessor=function(){if(!_(Ur._decoderTaskProcessor)){let e=new Gc("decodeDraco",Ur._maxDecodingConcurrency);e.initWebAssemblyModule({modulePath:"ThirdParty/Workers/draco_decoder_nodejs.js",wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then(function(){Ur._taskProcessorReady=!0}),Ur._decoderTaskProcessor=e}return Ur._decoderTaskProcessor};Ur.hasExtension=function(e){return _(e.extensionsRequired.KHR_draco_mesh_compression)||_(e.extensionsUsed.KHR_draco_mesh_compression)};function XZ(e,t){let n=`runtime.${Object.keys(e.createdBufferViews).length}`,r=e.buffers,o=Object.keys(r).length;return r[o]=t,e.createdBufferViews[n]={buffer:o,byteOffset:0,byteLength:t.byteLength},n}function UAe(e,t,n){let r=t._loadResources,o=XZ(r,e);return r.vertexBuffersToCreate.enqueue(o),o}function HAe(e,t,n){let r=e.typedArray,o=t._loadResources,a=XZ(o,r);return o.indexBuffersToCreate.enqueue({id:a,componentType:ie.fromTypedArray(r)}),{bufferViewId:a,numberOfIndices:e.numberOfIndices}}function YZ(e,t,n,r){if(!Ur._taskProcessorReady)return;let o=n.primitivesToDecode.peek();if(!_(o))return;let a=e.scheduleTask(o,[o.array.buffer]);if(!!_(a))return n.activeDecodingTasks++,n.primitivesToDecode.dequeue(),a.then(function(s){n.activeDecodingTasks--;let u=HAe(s.indexArray,t,r),l={},c=s.attributeData;for(let f in c)if(c.hasOwnProperty(f)){let h=c[f],d=h.array,p=UAe(d,t,r),g=h.data;g.bufferView=p,l[f]=g}t._decodedData[`${o.mesh}.primitive.${o.primitive}`]={bufferView:u.bufferViewId,numberOfIndices:u.numberOfIndices,attributes:l}})}Ur._decodedModelResourceCache=void 0;Ur.parse=function(e,t){if(!Ur.hasExtension(e))return;let n=e._loadResources,r=e.cacheKey;if(_(r)){_(Ur._decodedModelResourceCache)||(_(t.cache.modelDecodingCache)||(t.cache.modelDecodingCache={}),Ur._decodedModelResourceCache=t.cache.modelDecodingCache);let s=Ur._decodedModelResourceCache[r];if(_(s)){s.count++,n.pendingDecodingCache=!0;return}}let o=e._dequantizeInShader,a=e.gltfInternal;re.mesh(a,function(s,u){re.meshPrimitive(s,function(l,c){if(!_(l.extensions))return;let f=l.extensions.KHR_draco_mesh_compression;if(!_(f))return;let h=a.bufferViews[f.bufferView],p=a.buffers[h.buffer].extras._pipeline.source.slice(h.byteOffset,h.byteOffset+h.byteLength);n.primitivesToDecode.enqueue({mesh:u,primitive:c,array:p,bufferView:h,compressedAttributes:f.attributes,dequantizeInShader:o})})})};Ur.decodeModel=function(e,t){if(!Ur.hasExtension(e))return Promise.resolve();let n=e._loadResources,r=e.cacheKey;if(_(r)&&_(Ur._decodedModelResourceCache)){let u=Ur._decodedModelResourceCache[r];if(_(u)&&n.pendingDecodingCache)return Promise.resolve(u.ready).then(function(){e._decodedData=u.data,n.pendingDecodingCache=!1});Ur._decodedModelResourceCache[r]={ready:!1,count:1,data:void 0}}if(n.primitivesToDecode.length===0)return Promise.resolve();let o=Ur._getDecoderTaskProcessor(),a=[],s=YZ(o,e,n,t);for(;_(s);)a.push(s),s=YZ(o,e,n,t);return Promise.all(a)};Ur.decodePointCloud=function(e){let t=Ur._getDecoderTaskProcessor();if(!!Ur._taskProcessorReady)return t.scheduleTask(e,[e.buffer.buffer])};Ur.decodeBufferView=function(e){let t=Ur._getDecoderTaskProcessor();if(!!Ur._taskProcessorReady)return t.scheduleTask(e,[e.array.buffer])};Ur.cacheDataForModel=function(e){let t=e.cacheKey;if(_(t)&&_(Ur._decodedModelResourceCache)){let n=Ur._decodedModelResourceCache[t];_(n)&&(n.ready=!0,n.data=e._decodedData)}};Ur.destroyCachedDataForModel=function(e){let t=e.cacheKey;if(_(t)&&_(Ur._decodedModelResourceCache)){let n=Ur._decodedModelResourceCache[t];_(n)&&--n.count===0&&delete Ur._decodedModelResourceCache[t]}};var U1=Ur;function qAe(e,t,n){return`    float clipDistance = clip(gl_FragCoord, ${e}, ${t}); 
    vec4 clippingPlanesEdgeColor = vec4(1.0); 
    clippingPlanesEdgeColor.rgb = ${n}.rgb; 
    float clippingPlanesEdgeWidth = ${n}.a; 
    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) 
    { 
        gl_FragColor = clippingPlanesEdgeColor;
    } 
`}var jZ=qAe;var WAe=new X;function YAe(e,t){let n=e.unionClippingRegions,r=e.length,o=pS.useFloatTexture(t),a=pS.getTextureResolution(e,t,WAe),s=a.x,u=a.y,l=o?KAe(s,u):ZAe(s,u);return l+=`
`,l+=n?XAe(r):jAe(r),l}function XAe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount;
    float pixelWidth = czm_metersPerPixel(position);
    bool breakAndDiscard = false;
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
        if (amount <= 0.0)
        {
           breakAndDiscard = true;
           break;
        }
    }
    if (breakAndDiscard) {
        discard;
    }
    return clipAmount;
}
`}function jAe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    bool clipped = true;
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount = 0.0;
    float pixelWidth = czm_metersPerPixel(position);
    for (int i = 0; i < ${e}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = max(amount, clipAmount);
        clipped = clipped && (amount <= 0.0);
    }
    if (clipped)
    {
        discard;
    }
    return clipAmount;
}
`}function KAe(e,t){let n=1/e,r=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let a=`${r}`;return a.indexOf(".")===-1&&(a+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int pixY = clippingPlaneNumber / ${e};
    int pixX = clippingPlaneNumber - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${a};
    vec4 plane = texture2D(packedClippingPlanes, vec2(u, v));
    return czm_transformPlane(plane, transform);
}
`}function ZAe(e,t){let n=1/e,r=1/t,o=`${n}`;o.indexOf(".")===-1&&(o+=".0");let a=`${r}`;return a.indexOf(".")===-1&&(a+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int clippingPlaneStartIndex = clippingPlaneNumber * 2;
    int pixY = clippingPlaneStartIndex / ${e};
    int pixX = clippingPlaneStartIndex - (pixY * ${e});
    float u = (float(pixX) + 0.5) * ${o};
    float v = (float(pixY) + 0.5) * ${a};
    vec4 oct32 = texture2D(packedClippingPlanes, vec2(u, v)) * 255.0;
    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
    vec4 plane;
    plane.xyz = czm_octDecode(oct, 65535.0);
    plane.w = czm_unpackFloat(texture2D(packedClippingPlanes, vec2(u + ${o}, v)));
    return czm_transformPlane(plane, transform);
}
`}var KZ=YAe;var QAe={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3},mS=Object.freeze(QAe);function H1(){this.times=void 0,this.points=void 0,Le.throwInstantiationError()}H1.getPointType=function(e){if(typeof e=="number")return Number;if(e instanceof x)return x;if(e instanceof je)return je};H1.prototype.evaluate=Le.throwInstantiationError;H1.prototype.findTimeInterval=function(e,t){let n=this.times,r=n.length;if(t=T(t,0),e>=n[t]){if(t+1<r&&e<n[t+1])return t;if(t+2<r&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;let o;if(e>n[t])for(o=t;o<r-1&&!(e>=n[o]&&e<n[o+1]);++o);else for(o=t-1;o>=0&&!(e>=n[o]&&e<n[o+1]);--o);return o===r-1&&(o=r-2),o};H1.prototype.wrapTime=function(e){let t=this.times,n=t[t.length-1],r=t[0],o=n-r,a;return e<r&&(a=Math.floor((r-e)/o)+1,e+=a*o),e>n&&(a=Math.floor((e-n)/o)+1,e-=a*o),e};H1.prototype.clampTime=function(e){let t=this.times;return z.clamp(e,t[0],t[t.length-1])};var zu=H1;function q1(e){this._value=e,this._valueType=zu.getPointType(e)}Object.defineProperties(q1.prototype,{value:{get:function(){return this._value}}});q1.prototype.findTimeInterval=function(e){};q1.prototype.wrapTime=function(e){return 0};q1.prototype.clampTime=function(e){return 0};q1.prototype.evaluate=function(e,t){let n=this._value,r=this._valueType;return r===Number?n:r.clone(n,t)};var ZZ=q1;function W1(e){e=T(e,T.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._pointType=zu.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(W1.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});W1.prototype.findTimeInterval=zu.prototype.findTimeInterval;W1.prototype.wrapTime=zu.prototype.wrapTime;W1.prototype.clampTime=zu.prototype.clampTime;W1.prototype.evaluate=function(e,t){let n=this.points,r=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-r[o])/(r[o+1]-r[o]);return this._pointType===Number?(1-a)*n[o]+a*n[o+1]:(_(t)||(t=new x),x.lerp(n[o],n[o+1],a,t))};var QZ=W1;function Y1(e){e=T(e,T.EMPTY_OBJECT);let t=e.weights,n=e.times;this._times=n,this._weights=t,this._count=t.length/n.length,this._lastTimeIndex=0}Object.defineProperties(Y1.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}});Y1.prototype.findTimeInterval=zu.prototype.findTimeInterval;Y1.prototype.wrapTime=zu.prototype.wrapTime;Y1.prototype.clampTime=zu.prototype.clampTime;Y1.prototype.evaluate=function(e,t){let n=this.weights,r=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-r[o])/(r[o+1]-r[o]);_(t)||(t=new Array(this._count));for(let s=0;s<this._count;s++){let u=o*this._count+s;t[s]=n[u]*(1-a)+n[u+this._count]*a}return t};var JZ=Y1;function JAe(e){let t=e.points,n=e.times;return function(r,o){_(o)||(o=new je);let a=e._lastTimeIndex=e.findTimeInterval(r,e._lastTimeIndex),s=(r-n[a])/(n[a+1]-n[a]),u=t[a],l=t[a+1];return je.fastSlerp(u,l,s,o)}}function X1(e){e=T(e,T.EMPTY_OBJECT);let t=e.points,n=e.times;this._times=n,this._points=t,this._evaluateFunction=JAe(this),this._lastTimeIndex=0}Object.defineProperties(X1.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});X1.prototype.findTimeInterval=zu.prototype.findTimeInterval;X1.prototype.wrapTime=zu.prototype.wrapTime;X1.prototype.clampTime=zu.prototype.clampTime;X1.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var $Z=X1;function dM(){}var $Ae=/^data\:/i;function rQ(e,t){let n=e.gltfInternal,r=n.buffers,a=n.bufferViews[t.bufferView],s=r[a.buffer],u=a.byteOffset+t.byteOffset,l=t.count*Yl(t.type),c=$Ae.test(s.uri)?"":s.uri;return`${e.cacheKey}//${c}/${u}/${l}`}var eQ={};dM.getAnimationParameterValues=function(e,t){let n=rQ(e,t),r=eQ[n];if(!_(r)){let o=e.gltfInternal,a=o.buffers,u=o.bufferViews[t.bufferView],l=u.buffer,f=a[l].extras._pipeline.source,h=t.componentType,d=t.type,p=Yl(d),g=t.count,y=Sc(o,t);r=new Array(g);let v=T(t.byteOffset,0),w=u.byteOffset+v;for(let C=0;C<g;C++){let E=ie.createArrayBufferView(h,f.buffer,f.byteOffset+w,p);d==="SCALAR"?r[C]=E[0]:d==="VEC3"?r[C]=x.fromArray(E):d==="VEC4"&&(r[C]=je.unpack(E)),w+=y}_(e.cacheKey)&&(eQ[n]=r)}return r};var tQ={};function ebe(e,t,n){return`${e.cacheKey}//${t}/${n}`}function j1(e){this._spline=e,this._lastTimeIndex=0}j1.prototype.findTimeInterval=zu.prototype.findTimeInterval;j1.prototype.evaluate=function(e,t){let n=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),r=this._spline.times,o=e>=r[n+1]?r[n+1]:r[n];return this._spline.evaluate(o,t)};Object.defineProperties(j1.prototype,{times:{get:function(){return this._spline.times}}});j1.prototype.wrapTime=function(e){return this._spline.wrapTime(e)};j1.prototype.clampTime=function(e){return this._spline.clampTime(e)};dM.getAnimationSpline=function(e,t,n,r,o,a,s,u){let l=ebe(e,t,r),c=tQ[l];if(!_(c)){let f=a,h=u;f.length===1&&h.length===1?c=new ZZ(h[0]):(o.interpolation==="LINEAR"||o.interpolation==="STEP")&&(s==="translation"||s==="scale"?c=new QZ({times:f,points:h}):s==="rotation"?c=new $Z({times:f,points:h}):s==="weights"&&(c=new JZ({times:f,weights:h})),_(c)&&o.interpolation==="STEP"&&(c=new j1(c))),_(e.cacheKey)&&(tQ[l]=c)}return c};var nQ={};dM.getSkinInverseBindMatrices=function(e,t){let n=rQ(e,t),r=nQ[n];if(!_(r)){let o=e.gltfInternal,a=o.buffers,s=o.bufferViews,u=t.bufferView,l=s[u],c=l.buffer,h=a[c].extras._pipeline.source,d=t.componentType,p=t.type,g=t.count,y=Sc(o,t),v=l.byteOffset+t.byteOffset,w=Yl(p);if(r=new Array(g),d===V.FLOAT&&p===zc.MAT4)for(let C=0;C<g;++C){let E=ie.createArrayBufferView(d,h.buffer,h.byteOffset+v,w);r[C]=U.fromArray(E),v+=y}nQ[n]=r}return r};var gS=dM;var tbe={NONE:0,REPEAT:1,MIRRORED_REPEAT:2},Hy=Object.freeze(tbe);var W0=Object.freeze({STOPPED:0,ANIMATING:1});function iQ(e,t,n){this._name=n.name,this._startTime=fe.clone(e.startTime),this._delay=T(e.delay,0),this._stopTime=e.stopTime,this.removeOnStop=T(e.removeOnStop,!1),this._multiplier=T(e.multiplier,1),this._reverse=T(e.reverse,!1),this._loop=T(e.loop,Hy.NONE),this._animationTime=e.animationTime,this._prevAnimationDelta=void 0,this.start=new xe,this.update=new xe,this.stop=new xe,this._state=W0.STOPPED,this._runtimeAnimation=n,this._computedStartTime=void 0,this._duration=void 0;let r=this;this._raiseStartEvent=function(){r.start.raiseEvent(t,r)},this._updateEventTime=0,this._raiseUpdateEvent=function(){r.update.raiseEvent(t,r,r._updateEventTime)},this._raiseStopEvent=function(){r.stop.raiseEvent(t,r)}}Object.defineProperties(iQ.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}});var oQ=iQ;function fg(e){this.animationAdded=new xe,this.animationRemoved=new xe,this.animateWhilePaused=!1,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}Object.defineProperties(fg.prototype,{length:{get:function(){return this._scheduledAnimations.length}}});function yF(e,t,n){let r=e._model,a=r._runtime.animations[t],s=new oQ(n,r,a);return e._scheduledAnimations.push(s),e.animationAdded.raiseEvent(r,s),s}fg.prototype.add=function(e){e=T(e,T.EMPTY_OBJECT);let n=this._model._runtime.animations;if(_(e.index))return yF(this,e.index,e);let r,o=n.length;for(let a=0;a<o;++a)if(n[a].name===e.name){r=a;break}return yF(this,r,e)};fg.prototype.addAll=function(e){e=T(e,T.EMPTY_OBJECT);let t=[],o=this._model._runtime.animations.length;for(let a=0;a<o;++a)t.push(yF(this,a,e));return t};fg.prototype.remove=function(e){if(_(e)){let t=this._scheduledAnimations,n=t.indexOf(e);if(n!==-1)return t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1};fg.prototype.removeAll=function(){let e=this._model,t=this._scheduledAnimations,n=t.length;this._scheduledAnimations=[];for(let r=0;r<n;++r)this.animationRemoved.raiseEvent(e,t[r])};fg.prototype.contains=function(e){return _(e)?this._scheduledAnimations.indexOf(e)!==-1:!1};fg.prototype.get=function(e){return this._scheduledAnimations[e]};function nbe(e,t){let n=e.channelEvaluators,r=n.length;for(let o=0;o<r;++o)n[o](t)}var pM=[];function rbe(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}fg.prototype.update=function(e){let t=this._scheduledAnimations,n=t.length;if(n===0)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&fe.equals(e.time,this._previousTime))return!1;this._previousTime=fe.clone(e.time,this._previousTime);let r=!1,o=e.time,a=this._model;for(let s=0;s<n;++s){let u=t[s],l=u._runtimeAnimation;_(u._computedStartTime)||(u._computedStartTime=fe.addSeconds(T(u.startTime,o),u.delay,new fe)),_(u._duration)||(u._duration=l.stopTime*(1/u.multiplier));let c=u._computedStartTime,f=u._duration,h=u.stopTime,d=fe.lessThanOrEquals(c,o),p=_(h)&&fe.greaterThan(o,h),g=0;if(f!==0){let w=fe.secondsDifference(p?h:o,c);g=_(u._animationTime)?u._animationTime(f,w):w/f}let y=u.loop===Hy.REPEAT||u.loop===Hy.MIRRORED_REPEAT,v=(d||y&&!_(u.startTime))&&(g<=1||y)&&!p;if(g===u._prevAnimationDelta){let w=u._state===W0.STOPPED;if(v!==w)continue}if(u._prevAnimationDelta=g,v||u._state===W0.ANIMATING){if(v&&u._state===W0.STOPPED&&(u._state=W0.ANIMATING,u.start.numberOfListeners>0&&e.afterRender.push(u._raiseStartEvent)),u.loop===Hy.REPEAT)g=g-Math.floor(g);else if(u.loop===Hy.MIRRORED_REPEAT){let C=Math.floor(g),E=g-C;g=C%2===1?1-E:E}u.reverse&&(g=1-g);let w=g*f*u.multiplier;w=z.clamp(w,l.startTime,l.stopTime),nbe(l,w),u.update.numberOfListeners>0&&(u._updateEventTime=w,e.afterRender.push(u._raiseUpdateEvent)),r=!0,v||(u._state=W0.STOPPED,u.stop.numberOfListeners>0&&e.afterRender.push(u._raiseStopEvent),u.removeOnStop&&pM.push(u))}}n=pM.length;for(let s=0;s<n;++s){let u=pM[s];t.splice(t.indexOf(u),1),e.afterRender.push(rbe(this,a,u))}return pM.length=0,r};var aQ=fg;function Y0(){this._array=[],this._offset=0,this._length=0}Object.defineProperties(Y0.prototype,{length:{get:function(){return this._length}}});Y0.prototype.enqueue=function(e){this._array.push(e),this._length++};Y0.prototype.dequeue=function(){if(this._length===0)return;let e=this._array,t=this._offset,n=e[t];return e[t]=void 0,t++,t>10&&t*2>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,n};Y0.prototype.peek=function(){if(this._length!==0)return this._array[this._offset]};Y0.prototype.contains=function(e){return this._array.indexOf(e)!==-1};Y0.prototype.clear=function(){this._array.length=this._offset=this._length=0};Y0.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};var qy=Y0;function hg(){this.initialized=!1,this.resourcesParsed=!1,this.vertexBuffersToCreate=new qy,this.indexBuffersToCreate=new qy,this.buffers={},this.pendingBufferLoads=0,this.programsToCreate=new qy,this.shaders={},this.pendingShaderLoads=0,this.texturesToCreate=new qy,this.pendingTextureLoads=0,this.texturesToCreateFromBufferView=new qy,this.pendingBufferViewToImage=0,this.createSamplers=!0,this.createSkins=!0,this.createRuntimeAnimations=!0,this.createVertexArrays=!0,this.createRenderStates=!0,this.createUniformMaps=!0,this.createRuntimeNodes=!0,this.createdBufferViews={},this.primitivesToDecode=new qy,this.activeDecodingTasks=0,this.pendingDecodingCache=!1,this.skinnedNodesIds=[]}function ibe(e,t,n){return e.subarray(t,t+n)}hg.prototype.getBuffer=function(e){return ibe(this.buffers[e.buffer],e.byteOffset,e.byteLength)};hg.prototype.finishedPendingBufferLoads=function(){return this.pendingBufferLoads===0};hg.prototype.finishedBuffersCreation=function(){return this.pendingBufferLoads===0&&this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0};hg.prototype.finishedProgramCreation=function(){return this.pendingShaderLoads===0&&this.programsToCreate.length===0};hg.prototype.finishedTextureCreation=function(){let e=this.pendingTextureLoads===0,t=this.texturesToCreate.length===0&&this.texturesToCreateFromBufferView.length===0;return e&&t};hg.prototype.finishedEverythingButTextureCreation=function(){let e=this.pendingBufferLoads===0&&this.pendingShaderLoads===0,t=this.vertexBuffersToCreate.length===0&&this.indexBuffersToCreate.length===0&&this.programsToCreate.length===0&&this.pendingBufferViewToImage===0;return this.finishedDecoding()&&e&&t};hg.prototype.finishedDecoding=function(){return this.primitivesToDecode.length===0&&this.activeDecodingTasks===0&&!this.pendingDecodingCache};hg.prototype.finished=function(){return this.finishedDecoding()&&this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()};var sQ=hg;function mM(e,t,n){this._name=t.name,this._id=n,this._uniformMap=e._uniformMaps[n],this._technique=void 0,this._program=void 0,this._values=void 0}Object.defineProperties(mM.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}});mM.prototype.setValue=function(e,t){let n=`u_${e}`,r=this._uniformMap.values[n];r.value=r.clone(t,r.value)};mM.prototype.getValue=function(e){let t=`u_${e}`,n=this._uniformMap.values[t];if(!!_(n))return n.value};var uQ=mM;function lQ(e,t,n){let r=[],o=e.primitives,a=o.length;for(let s=0;s<a;++s){let u=o[s];r[s]=t[u.material]}this._name=e.name,this._materials=r,this._id=n}Object.defineProperties(lQ.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}});var cQ=lQ;function vF(e,t,n,r,o){this._model=e,this._runtimeNode=n,this._name=t.name,this._id=r,this.useMatrix=!1,this._show=!0,this._matrix=U.clone(o),this._originalMatrix=U.clone(o)}Object.defineProperties(vF.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,this._model._perNodeShowDirty=!0)}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=U.clone(e,this._matrix),this.useMatrix=!0;let t=this._model;t._cesiumAnimationsDirty=!0,this._runtimeNode.dirtyNumber=t._maxDirtyNumber}},originalMatrix:{get:function(){return this._originalMatrix}}});vF.prototype.setMatrix=function(e){U.clone(e,this._matrix)};var fQ=vF;var obe=65534;function _S(){}_S.hasExtension=function(e){return _(e.extensionsRequired.CESIUM_primitive_outline)||_(e.extensionsUsed.CESIUM_primitive_outline)};_S.outlinePrimitives=function(e){if(!_S.hasExtension(e))return;let t=e.gltfInternal,n=[];re.mesh(t,function(r,o){re.meshPrimitive(r,function(a,s){if(!_(a.extensions))return;let u=a.extensions.CESIUM_primitive_outline;if(!_(u))return;let l=cbe(e,a);l!==void 0&&(n.indexOf(l)<0&&n.push(l),abe(e,o,s,u.indices,l))})});for(let r=0;r<n.length;++r)sbe(e,n[r].bufferViews);ube(e)};_S.createTexture=function(e,t){let n=t.cache.modelOutliningCache;if(_(n)||(n=t.cache.modelOutliningCache={}),_(n.outlineTexture))return n.outlineTexture;let r=Math.min(4096,Kt.maximumTextureSize),o=r,a=dQ(o),s=[];for(;o>1;)o>>=1,s.push(dQ(o));let u=new $o({context:t,source:{arrayBufferView:a,mipLevels:s},width:r,height:1,pixelFormat:Gt.LUMINANCE,sampler:new La({wrapS:Il.CLAMP_TO_EDGE,wrapT:Il.CLAMP_TO_EDGE,minificationFilter:bn.LINEAR_MIPMAP_LINEAR,magnificationFilter:Of.LINEAR})});return n.outlineTexture=u,u};function abe(e,t,n,r,o){let a=o.vertexCopies,s=o.extraVertices,u=o.outlineCoordinates,l=e.gltfInternal,f=l.meshes[t].primitives[n],h=l.accessors,d=l.bufferViews,p;for(let O in f.attributes)if(f.attributes.hasOwnProperty(O)){let m=f.attributes[O],b=h[m];if(_(b)){p=b.count;break}}if(!_(p))return;let g=h[f.indices],y=d[g.bufferView],v=h[r],w=d[v.bufferView],C=e._loadResources,E=C.getBuffer(y),S=C.getBuffer(w),A=g.componentType===5123?new Uint16Array(E.buffer,E.byteOffset+g.byteOffset,g.count):new Uint32Array(E.buffer,E.byteOffset+g.byteOffset,g.count),D=v.componentType===5123?new Uint16Array(S.buffer,S.byteOffset+v.byteOffset,v.count):new Uint32Array(S.buffer,S.byteOffset+v.byteOffset,v.count),P=p,M=[P],I;for(I=0;I<D.length;I+=2){let O=D[I],m=D[I+1],b=Math.min(O,m),L=Math.max(O,m);M[b*P+L]=1}for(I=0;I<A.length;I+=3){let O=A[I],m=A[I+1],b=A[I+2],L=!1,R=L||wF(M,O,m),N=L||wF(M,m,b),B=L||wF(M,b,O),G=hQ(u,O,m,b,R,N,B);for(;G>=0;){let F;if(G===O?F=a[O]:G===m?F=a[m]:F=a[b],F===void 0){F=p+s.length;let k=G;for(;k>=p;)k=s[k-p];s.push(k),a[G]=F}F>obe&&A instanceof Uint16Array&&(A=new Uint32Array(A),g.componentType=5125,y.buffer=l.buffers.push({byteLength:A.byteLength,extras:{_pipeline:{source:A.buffer}}})-1,y.byteLength=A.byteLength,y.byteOffset=0,e._loadResources.buffers[y.buffer]=new Uint8Array(A.buffer,0,A.byteLength),C.indexBuffersToCreate._array.forEach(function(k){!_(k)||k.id===g.bufferView&&(k.componentType=g.componentType)})),G===O?(O=F,A[I]=F):G===m?(m=F,A[I+1]=F):(b=F,A[I+2]=F),_(g.max)&&(g.max[0]=Math.max(g.max[0],F)),G=hQ(u,O,m,b,R,N,B)}}}function CF(e,t,n,r,o){let a=t*3,s=e[a],u=e[a+1],l=e[a+2];return s===void 0?63:((s===n&&u===r&&l===o)<<0)+((s===n&&u===o&&l===r)<<1)+((s===r&&u===n&&l===o)<<2)+((s===r&&u===o&&l===n)<<3)+((s===o&&u===n&&l===r)<<4)+((s===o&&u===r&&l===n)<<5)}function xF(e){return(e&1)+(e>>1&1)+(e>>2&1)+(e>>3&1)+(e>>4&1)+(e>>5&1)}function hQ(e,t,n,r,o,a,s){let u=s?1:0,l=o?1:0,c=0,f=CF(e,t,u,l,c);if(f===0)return t;let h=0,d=o?1:0,p=a?1:0,g=CF(e,n,h,d,p);if(g===0)return n;let y=s?1:0,v=0,w=a?1:0,C=CF(e,r,y,v,w);if(C===0)return r;let E=f&g&C,S,A,D;if(E&1<<0)S=0,A=1,D=2;else if(E&1<<1)S=0,D=1,A=2;else if(E&1<<2)A=0,S=1,D=2;else if(E&1<<3)A=0,D=1,S=2;else if(E&1<<4)D=0,S=1,A=2;else if(E&1<<5)D=0,A=1,S=2;else{let O=xF(f),m=xF(g),b=xF(C);return O<m&&O<b?t:m<b?n:r}let P=t*3;e[P+S]=u,e[P+A]=l,e[P+D]=c;let M=n*3;e[M+S]=h,e[M+A]=d,e[M+D]=p;let I=r*3;return e[I+S]=y,e[I+A]=v,e[I+D]=w,-1}function wF(e,t,n){let r=e[0],o=Math.min(t,n)*r+Math.max(t,n);return e[o]===1}function dQ(e){let t=new Uint8Array(e);return t[e-1]=192,e===8?t[e-1]=96:e===4?t[e-1]=48:e===2?t[e-1]=24:e===1&&(t[e-1]=12),t}function sbe(e,t){let n=e.gltfInternal,r=e._loadResources,o,a;for(o=0;o<t.length;++o){let s=t[o],u=s.extras._pipeline.vertexNumberingScope;s.extras._pipeline.vertexNumberingScope=void 0;let l=u.extraVertices,c=r.getBuffer(s),f=s.byteStride||4,h=l.length,d=new Uint8Array(c.byteLength+h*f);for(d.set(c),a=0;a<h;++a){let y=l[a]*f,v=c.length+a*f;for(let w=0;w<f;++w)d[v+w]=d[y+w]}s.byteOffset=0,s.byteLength=d.byteLength;let p=n.buffers.push({byteLength:d.byteLength,extras:{_pipeline:{source:d.buffer}}})-1;s.buffer=p,r.buffers[p]=d;let g=u.accessors;for(a=0;a<g.length;++a){let y=g[a];n.accessors[y].count+=h}if(!u.createdOutlines){let y=u.outlineCoordinates,v=new Float32Array(y),w=e.gltfInternal.buffers.push({byteLength:v.byteLength,extras:{_pipeline:{source:v.buffer}}})-1;r.buffers[w]=new Uint8Array(v.buffer,0,v.byteLength);let C=e.gltfInternal.bufferViews.push({buffer:w,byteLength:v.byteLength,byteOffset:0,byteStride:3*Float32Array.BYTES_PER_ELEMENT,target:34962})-1,E=e.gltfInternal.accessors.push({bufferView:C,byteOffset:0,componentType:5126,count:v.length/3,type:"VEC3",min:[0,0,0],max:[1,1,1]})-1,S=u.primitives;for(a=0;a<S.length;++a)S[a].attributes._OUTLINE_COORDINATES=E;r.vertexBuffersToCreate.enqueue(C),u.createdOutlines=!0}}}function ube(e){let t=e.gltfInternal,n=e._loadResources,r;for(r=0;r<t.buffers.length;++r){let o=t.buffers[r],a=t.bufferViews.filter(lbe.bind(void 0,r)),s=a.reduce(function(c,f){return c+f.byteLength},0);if(s===o.byteLength)continue;let u=new Uint8Array(s),l=0;for(let c=0;c<a.length;++c){let f=a[c],h=n.getBuffer(f);u.set(h,l),f.byteOffset=l,l+=h.byteLength}n.buffers[r]=u,o.extras._pipeline.source=u.buffer,o.byteLength=s}}function lbe(e,t){return t.buffer===e}function cbe(e,t){let n=t.attributes;if(n===void 0)return;let r=e.gltfInternal,o;for(let a in n){if(!n.hasOwnProperty(a))continue;let s=n[a],l=r.accessors[s].bufferView,c=r.bufferViews[l];if(_(c.extras)||(c.extras={}),_(c.extras._pipeline)||(c.extras._pipeline={}),!_(c.extras._pipeline.vertexNumberingScope))c.extras._pipeline.vertexNumberingScope=o||{vertexCopies:[],extraVertices:[],outlineCoordinates:[],accessors:[],bufferViews:[],primitives:[],createdOutlines:!1};else if(o!==void 0&&c.extras._pipeline.vertexNumberingScope!==o)return;o=c.extras._pipeline.vertexNumberingScope,o.bufferViews.indexOf(c)<0&&o.bufferViews.push(c),o.accessors.indexOf(s)<0&&o.accessors.push(s)}return o.primitives.push(t),o}var EF=_S;var Qr={};Qr.updateForwardAxis=function(e){let t=e.gltfInternal.extras.sourceVersion;(_(t)&&t!=="2.0"||Qr.getAssetVersion(e.gltfInternal)!=="2.0")&&(e._gltfForwardAxis=Fu.X)};Qr.getAssetVersion=function(e){return!_(e.asset)||!_(e.asset.version)?"1.0":e.asset.version};Qr.splitIncompatibleMaterials=function(e){let t=e.accessors,n=e.materials,r={};return re.mesh(e,function(o){re.meshPrimitive(o,function(a){let s=a.material,u=n[s],l=a.attributes.JOINTS_0,c,f;if(_(l)){let S=t[l];c=S.componentType,f=S.type}let h=_(l)&&f==="VEC4",d=_(a.attributes.COLOR_0),p=_(a.targets),g=_(a.attributes.NORMAL),y=_(a.attributes.TANGENT),v=_(a.attributes.TEXCOORD_0),w=v&&_(a.attributes.TEXCOORD_1),C=_(a.extensions)&&_(a.extensions.CESIUM_primitive_outline),E=r[s];if(!_(E))r[s]={skinning:{skinned:h,componentType:c},hasVertexColors:d,hasMorphTargets:p,hasNormals:g,hasTangents:y,hasTexCoords:v,hasTexCoord1:w,hasOutline:C};else if(E.skinning.skinned!==h||E.hasVertexColors!==d||E.hasMorphTargets!==p||E.hasNormals!==g||E.hasTangents!==y||E.hasTexCoords!==v||E.hasTexCoord1!==w||E.hasOutline!==C){let S=kt(u,!0);s=$i(n,S),a.material=s,r[s]={skinning:{skinned:h,componentType:c},hasVertexColors:d,hasMorphTargets:p,hasNormals:g,hasTangents:y,hasTexCoords:v,hasTexCoord1:w,hasOutline:C}}})}),r};Qr.getShaderVariable=function(e){return e==="SCALAR"?"float":e.toLowerCase()};Qr.ModelState={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};Qr.getFailedLoadFunction=function(e,t,n){return function(r){e._state=Qr.ModelState.FAILED;let o=`Failed to load ${t}: ${n}`;_(r)&&(o+=`
${r.message}`),e._readyPromise.reject(new it(o))}};Qr.parseBuffers=function(e,t){let n=e._loadResources;re.buffer(e.gltfInternal,function(r,o){if(_(r.extras._pipeline.source))n.buffers[o]=r.extras._pipeline.source;else if(_(t)){let a=e._resource.getDerivedResource({url:r.uri});++n.pendingBufferLoads,a.fetchArrayBuffer().then(t(e,o)).catch(Qr.getFailedLoadFunction(e,"buffer",a.url))}})};var fbe=new x,hbe=new x;Qr.computeBoundingSphere=function(e){let t=e.gltfInternal,n=t.nodes,r=t.meshes,o=t.scenes[t.scene].nodes,a=o.length,s=[],u=new x(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new x(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let f=0;f<a;++f){let h=n[o[f]];for(h._transformToRoot=Qr.getTransform(h),s.push(h);s.length>0;){h=s.pop();let d=h._transformToRoot,p=h.mesh;if(_(p)){let v=r[p].primitives,w=v.length;for(let C=0;C<w;++C){let E=v[C].attributes.POSITION;if(_(E)){let S=Qr.getAccessorMinMax(t,E);if(_(S.min)&&_(S.max)){let A=x.fromArray(S.min,0,fbe),D=x.fromArray(S.max,0,hbe);U.multiplyByPoint(d,A,A),U.multiplyByPoint(d,D,D),x.minimumByComponent(u,A,u),x.maximumByComponent(l,D,l)}}}}let g=h.children;if(_(g)){let y=g.length;for(let v=0;v<y;++v){let w=n[g[v]];w._transformToRoot=Qr.getTransform(w),U.multiplyTransformation(d,w._transformToRoot,w._transformToRoot),s.push(w)}}delete h._transformToRoot}}let c=Ee.fromCornerPoints(u,l);return e.forwardAxis===Fu.Z&&Ee.transformWithoutScale(c,Fu.Z_UP_TO_X_UP,c),e._upAxis===Fu.Y?Ee.transformWithoutScale(c,Fu.Y_UP_TO_Z_UP,c):e._upAxis===Fu.X&&Ee.transformWithoutScale(c,Fu.X_UP_TO_Z_UP,c),c};function dbe(e,t){return re.techniqueAttribute(e,function(n,r){if(n.semantic===t)return r})}function pbe(e,t){let n=e.accessors,r=e.materials,o=e.extensions.KHR_techniques_webgl,a=o.techniques,s=o.programs,u=o.shaders,l=t.targets,c=t.attributes;for(let g in l)if(l.hasOwnProperty(g)){let y=l[g];for(let v in y)v!=="extras"&&(c[`${v}_${g}`]=y[v])}let f=r[t.material],h=a[f.extensions.KHR_techniques_webgl.technique],d=s[h.program],p=u[d.vertexShader];for(let g in c)if(c.hasOwnProperty(g)&&!_(dbe(h,g))){let y=c[g],v=n[y],w=g.toLowerCase();w.charAt(0)==="_"&&(w=w.slice(1));let C=`a_${w}`;h.attributes[C]={semantic:g,type:v.componentType};let E=p.extras._pipeline,S=E.source;S=`attribute ${Qr.getShaderVariable(v.type)} ${C};
${S}`,E.source=S}}Qr.ensureSemanticExistence=function(e){return re.mesh(e,function(t){re.meshPrimitive(t,function(n){pbe(e,n)})}),e};Qr.createAttributeLocations=function(e,t){let n={},r=!1,o=1;if(re.techniqueAttribute(e,function(a,s){/pos/i.test(s)&&!r?(n[s]=0,r=!0):n[s]=o++}),_(t))for(let a in t)t.hasOwnProperty(a)&&(n[a]=o++);return n};Qr.getAccessorMinMax=function(e,t){let n=e.accessors[t],r=n.extensions,o=n.min,a=n.max;if(_(r)){let s=r.WEB3D_quantized_attributes;_(s)&&(o=s.decodedMin,a=s.decodedMax)}return{min:o,max:a}};function pQ(e,t,n,r){return Ho(e,"KHR_techniques_webgl")?function(o,a){if(o.semantic===n&&(!r||!_(o.node)))return a}:function(o,a){let s=t.parameters[o];if(s.semantic===n&&(!r||!_(s.node)))return a}}Qr.getAttributeOrUniformBySemantic=function(e,t,n,r){return re.technique(e,function(o){if(_(n)&&o.program!==n)return;let a=re.techniqueAttribute(o,pQ(e,o,t,r));return _(a)?a:re.techniqueUniform(o,pQ(e,o,t,r))})};Qr.getDiffuseAttributeOrUniform=function(e,t){let n=Qr.getAttributeOrUniformBySemantic(e,"COLOR_0",t);return _(n)||(n=Qr.getAttributeOrUniformBySemantic(e,"_3DTILESDIFFUSE",t)),n};var mbe=new x,gbe=new je,_be=new x;Qr.getTransform=function(e,t){return _(e.matrix)?U.fromColumnMajorArray(e.matrix,t):U.fromTranslationQuaternionRotationScale(x.fromArray(e.translation,0,mbe),je.unpack(e.rotation,0,gbe),x.fromArray(e.scale,0,_be),t)};Qr.getUsedExtensions=function(e){let t=e.extensionsUsed,n={};if(_(t)){let r=t.length;for(let o=0;o<r;o++){let a=t[o];n[a]=!0}}return n};Qr.getRequiredExtensions=function(e){let t=e.extensionsRequired,n={};if(_(t)){let r=t.length;for(let o=0;o<r;o++){let a=t[o];n[a]=!0}}return n};Qr.supportedExtensions={AGI_articulations:!0,CESIUM_RTC:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_binary_glTF:!0,KHR_texture_basisu:!0,KHR_draco_mesh_compression:!0,KHR_materials_common:!0,KHR_techniques_webgl:!0,KHR_materials_unlit:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_texture_transform:!0,WEB3D_quantized_attributes:!0};Qr.checkSupportedExtensions=function(e,t){for(let n in e)if(e.hasOwnProperty(n)){if(!Qr.supportedExtensions[n])throw new it(`Unsupported glTF Extension: ${n}`);if(n==="EXT_texture_webp"&&t===!1)throw new it("Loaded model requires WebP but browser does not support it.")}};Qr.checkSupportedGlExtensions=function(e,t){if(_(e)){let n=e.length;for(let r=0;r<n;r++){let o=e[r];if(o!=="OES_element_index_uint")throw new it(`Unsupported WebGL Extension: ${o}`);if(!t.elementIndexUint)throw new it("OES_element_index_uint WebGL extension is not enabled.")}}};function TF(e,t,n){t+="(?!\\w)",t=new RegExp(t,"g");let r=e.search(t);return e.replace(t,function(o,a){return r===a?o:n})}function ybe(e,t){let r=e.accessors[t].extensions;if(_(r))return r.WEB3D_quantized_attributes}function mQ(e,t,n){let r=t.material,o=e.materials[r];if(!Ho(e,"KHR_techniques_webgl")||!_(o.extensions)||!_(o.extensions.KHR_techniques_webgl))return;let a=o.extensions.KHR_techniques_webgl.technique,u=e.extensions.KHR_techniques_webgl.techniques[a];return re.techniqueAttribute(u,function(l,c){if(l.semantic===n)return c})}Qr.modifyShaderForDracoQuantizedAttributes=function(e,t,n,r){let o={};for(let a in r)if(r.hasOwnProperty(a)){let s=r[a],u=s.quantization;if(!_(u))continue;let l=mQ(e,t,a);a.charAt(0)==="_"&&(a=a.substring(1));let c=`gltf_u_dec_${a.toLowerCase()}`;if(!_(o[c])){let f=`gltf_decoded_${a}`,h=l.replace("a_","gltf_a_dec_"),d=s.componentsPerAttribute;n=TF(n,l,h);let p;u.octEncoded?p="vec3":d>1?p=`vec${d}`:p="float",n=`${p} ${h};
${n}`;let g=d===3&&a==="COLOR_0";g&&(n=TF(n,h,`vec4(${h}, 1.0)`));let y="";if(u.octEncoded){let v=`${c}_rangeConstant`;n=`uniform float ${v};
${n}`,y=`
void main() {
    ${h} = czm_octDecode(${l}.xy, ${v}).zxy;
    ${f}();
}
`}else{let v=`${c}_normConstant`,w=`${c}_min`;n=`uniform float ${v};
uniform ${p} ${w};
${n}`,y=`
void main() {
    ${h} = ${w} + ${l}${g?".xyz":""} * ${v};
    ${f}();
}
`}n=xt.replaceMain(n,f),n+=y}}return{shader:n}};Qr.modifyShaderForQuantizedAttributes=function(e,t,n){let r={},o=t.attributes;for(let a in o)if(o.hasOwnProperty(a)){let s=mQ(e,t,a),u=t.attributes[a];a.charAt(0)==="_"&&(a=a.substring(1));let l=`gltf_u_dec_${a.toLowerCase()}`,c=`${l}_scale`,f=`${l}_translate`;if(!_(r[l])&&!_(r[c])){let h=ybe(e,u);if(_(h)){let d=h.decodeMatrix,p=`gltf_decoded_${a}`,g=s.replace("a_","gltf_a_dec_"),y=Math.floor(Math.sqrt(d.length));n=TF(n,s,g);let v;y>2?v=`vec${y-1}`:v="float",n=`${v} ${g};
${n}`;let w="";y===5?(n=`uniform mat4 ${c};
${n}`,n=`uniform vec4 ${f};
${n}`,w=`
void main() {
    ${g} = ${c} * ${s} + ${f};
    ${p}();
}
`,r[c]={mat:4},r[f]={vec:4}):(n=`uniform mat${y} ${l};
${n}`,w=`
void main() {
    ${g} = ${v}(${l} * vec${y}(${s},1.0));
    ${p}();
}
`,r[l]={mat:y}),n=xt.replaceMain(n,p),n+=w}}}return{shader:n,uniforms:r}};function Z1(e){let t={value:e,clone:function(n,r){return n},func:function(){return t.value}};return t}function _M(e){let t={value:X.fromArray(e),clone:X.clone,func:function(){return t.value}};return t}function yM(e){let t={value:x.fromArray(e),clone:x.clone,func:function(){return t.value}};return t}function Q1(e){let t={value:Se.fromArray(e),clone:Se.clone,func:function(){return t.value}};return t}function SF(e){let t={value:Ma.fromColumnMajorArray(e),clone:Ma.clone,func:function(){return t.value}};return t}function AF(e){let t={value:ne.fromColumnMajorArray(e),clone:ne.clone,func:function(){return t.value}};return t}function gM(e){let t={value:U.fromColumnMajorArray(e),clone:U.clone,func:function(){return t.value}};return t}function vM(e,t,n){this._value=void 0,this._textureId=e.index,this._textures=t,this._defaultTexture=n}Object.defineProperties(vM.prototype,{value:{get:function(){if(!_(this._value)){let e=this._textures[this._textureId];if(_(e))this._value=e;else return this._defaultTexture}return this._value},set:function(e){this._value=e}}});vM.prototype.clone=function(e){return e};vM.prototype.func=void 0;function vbe(e,t,n){let r=new vM(e,t,n);return r.func=function(){return r.value},r}var Vu={};Vu[V.FLOAT]=Z1;Vu[V.FLOAT_VEC2]=_M;Vu[V.FLOAT_VEC3]=yM;Vu[V.FLOAT_VEC4]=Q1;Vu[V.INT]=Z1;Vu[V.INT_VEC2]=_M;Vu[V.INT_VEC3]=yM;Vu[V.INT_VEC4]=Q1;Vu[V.BOOL]=Z1;Vu[V.BOOL_VEC2]=_M;Vu[V.BOOL_VEC3]=yM;Vu[V.BOOL_VEC4]=Q1;Vu[V.FLOAT_MAT2]=SF;Vu[V.FLOAT_MAT3]=AF;Vu[V.FLOAT_MAT4]=gM;Vu[V.SAMPLER_2D]=vbe;Qr.createUniformFunction=function(e,t,n,r){return Vu[e](t,n,r)};function Cbe(e){return[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]]}function xbe(e){return[e[20],e[21],e[22],e[23]]}Qr.createUniformsForDracoQuantizedAttributes=function(e){let t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n],o=r.quantization;if(!_(o))continue;n.charAt(0)==="_"&&(n=n.substring(1));let a=`gltf_u_dec_${n.toLowerCase()}`;if(o.octEncoded){let c=`${a}_rangeConstant`,f=(1<<o.quantizationBits)-1;t[c]=Z1(f).func;continue}let s=`${a}_normConstant`,u=o.range/(1<<o.quantizationBits);t[s]=Z1(u).func;let l=`${a}_min`;switch(r.componentsPerAttribute){case 1:t[l]=Z1(o.minValues).func;break;case 2:t[l]=_M(o.minValues).func;break;case 3:t[l]=yM(o.minValues).func;break;case 4:t[l]=Q1(o.minValues).func;break}}return t};Qr.createUniformsForQuantizedAttributes=function(e,t,n){let r=e.accessors,o={},a={},s=t.attributes;for(let u in s)if(s.hasOwnProperty(u)){let l=s[u],c=r[l],f=c.extensions;if(u.charAt(0)==="_"&&(u=u.substring(1)),_(f)){let h=f.WEB3D_quantized_attributes;if(_(h)){let d=h.decodeMatrix,p=`gltf_u_dec_${u.toLowerCase()}`,g,y;switch(c.type){case zc.SCALAR:a[p]=SF(d).func,o[p]=!0;break;case zc.VEC2:a[p]=AF(d).func,o[p]=!0;break;case zc.VEC3:a[p]=gM(d).func,o[p]=!0;break;case zc.VEC4:g=`${p}_scale`,y=`${p}_translate`,a[g]=gM(Cbe(d)).func,a[y]=Q1(xbe(d)).func,o[g]=!0,o[y]=!0;break}}}}for(let u in n)if(n.hasOwnProperty(u)&&!o[u]){let l=n[u];_(l.mat)&&(l.mat===2?a[u]=SF(Ma.IDENTITY).func:l.mat===3?a[u]=AF(ne.IDENTITY).func:l.mat===4&&(a[u]=gM(U.IDENTITY).func)),_(l.vec)&&l.vec===4&&(a[u]=Q1([0,0,0,0]).func)}return a};var K1=new x,wbe={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){let n=new U;return function(){return _(t._rtcCenter)?(U.getTranslation(e.model,K1),x.add(K1,t._rtcCenter,K1),U.multiplyByPoint(e.view,K1,K1),U.setTranslation(e.modelView,K1,n)):e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};Qr.getGltfSemanticUniforms=function(){return wbe};var Mr=Qr;function Ebe(e){switch(e){case V.FLOAT:return"float";case V.FLOAT_VEC2:return"vec2";case V.FLOAT_VEC3:return"vec3";case V.FLOAT_VEC4:return"vec4";case V.FLOAT_MAT2:return"mat2";case V.FLOAT_MAT3:return"mat3";case V.FLOAT_MAT4:return"mat4";case V.SAMPLER_2D:return"sampler2D";case V.BOOL:return"bool"}}var J1=Ebe;function Tbe(e,t){if(t=T(t,T.EMPTY_OBJECT),!_(e)||!Ho(e,"KHR_materials_common"))return;Ho(e,"KHR_techniques_webgl")||(_(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl"));let n=e.extensions.KHR_techniques_webgl;Ibe(e);let r=Sbe(e),o=Mr.splitIncompatibleMaterials(e),a={},s=!1;return re.material(e,function(u,l){if(_(u.extensions)&&_(u.extensions.KHR_materials_common)){let c=u.extensions.KHR_materials_common,f=o[l],h=bbe(c,f),d=a[h];_(d)||(d=Abe(e,n,f,c,r,t.addBatchIdToGeneratedShaders),a[h]=d,s=!0);let p={},g=c.values,y;for(let v in g)g.hasOwnProperty(v)&&v!=="transparent"&&v!=="doubleSided"&&(y=`u_${v.toLowerCase()}`,p[y]=g[v]);u.extensions.KHR_techniques_webgl={technique:d,values:p},u.alphaMode="OPAQUE",c.transparent&&(u.alphaMode="BLEND"),c.doubleSided&&(u.doubleSided=!0)}}),s&&Mr.ensureSemanticExistence(e),e}function Sbe(e){let t={},n;if(_(e.extensions)&&_(e.extensions.KHR_materials_common)&&(n=e.extensions.KHR_materials_common.lights),_(n)){let r=e.nodes;for(let a in r)if(r.hasOwnProperty(a)){let s=r[a];if(_(s.extensions)&&_(s.extensions.KHR_materials_common)){let u=s.extensions.KHR_materials_common.light;_(u)&&_(n[u])&&(n[u].node=a),delete s.extensions.KHR_materials_common}}let o=0;for(let a in n)if(n.hasOwnProperty(a)){let s=n[a],u=s.type;if(u!=="ambient"&&!_(s.node)){delete n[a];continue}let l=`light${o.toString()}`;s.baseName=l;let c,f,h,d;switch(u){case"ambient":c=s.ambient,t[`${l}Color`]={type:V.FLOAT_VEC3,value:c.color};break;case"directional":f=s.directional,t[`${l}Color`]={type:V.FLOAT_VEC3,value:f.color},_(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:V.FLOAT_MAT4});break;case"point":h=s.point,t[`${l}Color`]={type:V.FLOAT_VEC3,value:h.color},_(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:V.FLOAT_MAT4}),t[`${l}Attenuation`]={type:V.FLOAT_VEC3,value:[h.constantAttenuation,h.linearAttenuation,h.quadraticAttenuation]};break;case"spot":d=s.spot,t[`${l}Color`]={type:V.FLOAT_VEC3,value:d.color},_(s.node)&&(t[`${l}Transform`]={node:s.node,semantic:"MODELVIEW",type:V.FLOAT_MAT4},t[`${l}InverseTransform`]={node:s.node,semantic:"MODELVIEWINVERSE",type:V.FLOAT_MAT4,useInFragment:!0}),t[`${l}Attenuation`]={type:V.FLOAT_VEC3,value:[d.constantAttenuation,d.linearAttenuation,d.quadraticAttenuation]},t[`${l}FallOff`]={type:V.FLOAT_VEC2,value:[d.fallOffAngle,d.fallOffExponent]};break}++o}}return t}function Abe(e,t,n,r,o,a){_(r)||(r={}),a=T(a,!1);let s=t.techniques,u=t.shaders,l=t.programs,c=r.technique.toUpperCase(),f;_(e.extensions)&&_(e.extensions.KHR_materials_common)&&(f=e.extensions.KHR_materials_common.lights);let h=r.values,d=T(r.jointCount,0),p,g=!1,y=!1;_(n)&&(p=n.skinning,g=p.skinned,y=n.hasVertexColors);let v=`precision highp float;
`,w=`precision highp float;
`,C=c!=="CONSTANT",E={u_modelViewMatrix:{semantic:Ho(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:V.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:V.FLOAT_MAT4}};C&&(E.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:V.FLOAT_MAT3}),g&&(E.u_jointMatrix={count:d,semantic:"JOINTMATRIX",type:V.FLOAT_MAT4});let S,A=!1;for(let k in h)if(h.hasOwnProperty(k)&&k!=="transparent"&&k!=="doubleSided"){let Z=gQ(k,h[k]);S=`u_${k.toLowerCase()}`,!A&&Z===V.SAMPLER_2D&&(A=!0),E[S]={type:Z}}if(_(E.u_diffuse)&&(E.u_diffuse.semantic="_3DTILESDIFFUSE"),_(o))for(let k in o)o.hasOwnProperty(k)&&(S=`u_${k}`,E[S]=o[k]);for(S in E)if(E.hasOwnProperty(S)){let k=E[S],Z=_(k.count)?`[${k.count}]`:"";k.type!==V.FLOAT_MAT3&&k.type!==V.FLOAT_MAT4||k.useInFragment?(w+=`uniform ${J1(k.type)} ${S}${Z};
`,delete k.useInFragment):v+=`uniform ${J1(k.type)} ${S}${Z};
`}let D="";g&&(D+=`    mat4 skinMatrix =
        a_weight.x * u_jointMatrix[int(a_joint.x)] +
        a_weight.y * u_jointMatrix[int(a_joint.y)] +
        a_weight.z * u_jointMatrix[int(a_joint.z)] +
        a_weight.w * u_jointMatrix[int(a_joint.w)];
`);let P={a_position:{semantic:"POSITION"}};v+=`attribute vec3 a_position;
`,v+=`varying vec3 v_positionEC;
`,g?D+=`  vec4 pos = u_modelViewMatrix * skinMatrix * vec4(a_position,1.0);
`:D+=`  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);
`,D+=`  v_positionEC = pos.xyz;
`,D+=`  gl_Position = u_projectionMatrix * pos;
`,w+=`varying vec3 v_positionEC;
`,C&&(P.a_normal={semantic:"NORMAL"},v+=`attribute vec3 a_normal;
`,v+=`varying vec3 v_normal;
`,g?D+=`  v_normal = u_normalMatrix * mat3(skinMatrix) * a_normal;
`:D+=`  v_normal = u_normalMatrix * a_normal;
`,w+=`varying vec3 v_normal;
`);let M;A&&(P.a_texcoord_0={semantic:"TEXCOORD_0"},M="v_texcoord_0",v+=`attribute vec2 a_texcoord_0;
`,v+=`varying vec2 ${M};
`,D+=`  ${M} = a_texcoord_0;
`,w+=`varying vec2 ${M};
`),g&&(P.a_joint={semantic:"JOINTS_0"},P.a_weight={semantic:"WEIGHTS_0"},v+=`attribute vec4 a_joint;
`,v+=`attribute vec4 a_weight;
`),y&&(P.a_vertexColor={semantic:"COLOR_0"},v+=`attribute vec4 a_vertexColor;
`,v+=`varying vec4 v_vertexColor;
`,D+=`  v_vertexColor = a_vertexColor;
`,w+=`varying vec4 v_vertexColor;
`),a&&(P.a_batchId={semantic:"_BATCHID"},v+=`attribute float a_batchId;
`);let I=C&&(c==="BLINN"||c==="PHONG")&&_(E.u_specular)&&_(E.u_shininess)&&E.u_shininess>0,O=!1,m=!1,b="";for(let k in f)if(f.hasOwnProperty(k)){let Z=f[k],te=Z.type.toLowerCase(),oe=Z.baseName;b+=`  {
`;let ue=`u_${oe}Color`;if(te==="ambient")m=!0,b+=`    ambientLight += ${ue};
`;else if(C){O=!0;let pe=`v_${oe}Direction`,me=`v_${oe}Position`;te!=="point"&&(v+=`varying vec3 ${pe};
`,w+=`varying vec3 ${pe};
`,D+=`  ${pe} = mat3(u_${oe}Transform) * vec3(0.,0.,1.);
`,te==="directional"&&(b+=`    vec3 l = normalize(${pe});
`)),te!=="directional"?(v+=`varying vec3 ${me};
`,w+=`varying vec3 ${me};
`,D+=`  ${me} = u_${oe}Transform[3].xyz;
`,b+=`    vec3 VP = ${me} - v_positionEC;
`,b+=`    vec3 l = normalize(VP);
`,b+=`    float range = length(VP);
`,b+=`    float attenuation = 1.0 / (u_${oe}Attenuation.x + `,b+=`(u_${oe}Attenuation.y * range) + `,b+=`(u_${oe}Attenuation.z * range * range));
`):b+=`    float attenuation = 1.0;
`,te==="spot"&&(b+=`    float spotDot = dot(l, normalize(${pe}));
`,b+=`    if (spotDot < cos(u_${oe}FallOff.x * 0.5))
`,b+=`    {
`,b+=`      attenuation = 0.0;
`,b+=`    }
`,b+=`    else
`,b+=`    {
`,b+=`        attenuation *= max(0.0, pow(spotDot, u_${oe}FallOff.y));
`,b+=`    }
`),b+=`    diffuseLight += ${ue}* max(dot(normal,l), 0.) * attenuation;
`,I&&(c==="BLINN"?(b+=`    vec3 h = normalize(l + viewDir);
`,b+=`    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;
`):(b+=`    vec3 reflectDir = reflect(-l, normal);
`,b+=`    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;
`),b+=`    specularLight += ${ue} * specularIntensity;
`)}b+=`  }
`}m||(b+=`  ambientLight += vec3(0.2, 0.2, 0.2);
`),!O&&c!=="CONSTANT"&&(w+=`#ifdef USE_CUSTOM_LIGHT_COLOR 
`,w+=`uniform vec3 gltf_lightColor; 
`,w+=`#endif 
`,b+=`#ifndef USE_CUSTOM_LIGHT_COLOR 
`,b+=`    vec3 lightColor = czm_lightColor;
`,b+=`#else 
`,b+=`    vec3 lightColor = gltf_lightColor;
`,b+=`#endif 
`,b+=`  vec3 l = normalize(czm_lightDirectionEC);
`,b+=`  diffuseLight += lightColor * max(dot(normal,l), 0.2);
`,I&&(c==="BLINN"?(b+=`  vec3 h = normalize(l + viewDir);
`,b+=`  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));
`):(b+=`  vec3 reflectDir = reflect(-l, normal);
`,b+=`  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));
`),b+=`  specularLight += lightColor * specularIntensity;
`)),v+=`void main(void) {
`,v+=D,v+=`}
`,w+=`void main(void) {
`;let L=`  vec3 color = vec3(0.0, 0.0, 0.0);
`;C&&(w+=`  vec3 normal = normalize(v_normal);
`,r.doubleSided&&(w+=`  if (czm_backFacing())
`,w+=`  {
`,w+=`    normal = -normal;
`,w+=`  }
`));let R;c!=="CONSTANT"?(_(E.u_diffuse)&&(E.u_diffuse.type===V.SAMPLER_2D?w+=`  vec4 diffuse = texture2D(u_diffuse, ${M});
`:w+=`  vec4 diffuse = u_diffuse;
`,w+=`  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);
`,L+=`  color += diffuse.rgb * diffuseLight;
`),I&&(E.u_specular.type===V.SAMPLER_2D?w+=`  vec3 specular = texture2D(u_specular, ${M}).rgb;
`:w+=`  vec3 specular = u_specular.rgb;
`,w+=`  vec3 specularLight = vec3(0.0, 0.0, 0.0);
`,L+=`  color += specular * specularLight;
`),_(E.u_transparency)?R=`  gl_FragColor = vec4(color * diffuse.a * u_transparency, diffuse.a * u_transparency);
`:R=`  gl_FragColor = vec4(color * diffuse.a, diffuse.a);
`):_(E.u_transparency)?R=`  gl_FragColor = vec4(color * u_transparency, u_transparency);
`:R=`  gl_FragColor = vec4(color, 1.0);
`,y&&(L+=`  color *= v_vertexColor.rgb;
`),_(E.u_emission)&&(E.u_emission.type===V.SAMPLER_2D?w+=`  vec3 emission = texture2D(u_emission, ${M}).rgb;
`:w+=`  vec3 emission = u_emission.rgb;
`,L+=`  color += emission;
`),(_(E.u_ambient)||c!=="CONSTANT")&&(_(E.u_ambient)?E.u_ambient.type===V.SAMPLER_2D?w+=`  vec3 ambient = texture2D(u_ambient, ${M}).rgb;
`:w+=`  vec3 ambient = u_ambient.rgb;
`:w+=`  vec3 ambient = diffuse.rgb;
`,L+=`  color += ambient * ambientLight;
`),w+=`  vec3 viewDir = -normalize(v_positionEC);
`,w+=`  vec3 ambientLight = vec3(0.0, 0.0, 0.0);
`,w+=b,w+=L,w+=R,w+=`}
`;let N=$i(u,{type:V.VERTEX_SHADER,extras:{_pipeline:{source:v,extension:".glsl"}}}),B=$i(u,{type:V.FRAGMENT_SHADER,extras:{_pipeline:{source:w,extension:".glsl"}}}),G=$i(l,{fragmentShader:B,vertexShader:N});return $i(s,{attributes:P,program:G,uniforms:E})}function gQ(e,t){let n;switch(_(t.value)?n=t.value:_(t.index)?n=[t.index]:n=t,e){case"ambient":return n.length===1?V.SAMPLER_2D:V.FLOAT_VEC4;case"diffuse":return n.length===1?V.SAMPLER_2D:V.FLOAT_VEC4;case"emission":return n.length===1?V.SAMPLER_2D:V.FLOAT_VEC4;case"specular":return n.length===1?V.SAMPLER_2D:V.FLOAT_VEC4;case"shininess":return V.FLOAT;case"transparency":return V.FLOAT;case"transparent":return V.BOOL;case"doubleSided":return V.BOOL}}function bbe(e,t){let n="";n+=`technique:${e.technique};`;let r=e.values,o=Object.keys(r).sort(),a=o.length;for(let u=0;u<a;++u){let l=o[u];r.hasOwnProperty(l)&&(n+=`${l}:${gQ(l,r[l])}`,n+=";")}let s=T(e.jointCount,0);if(n+=`${s.toString()};`,_(t)){let u=t.skinning;s>0&&(n+=`${u.type};`),n+=t.hasVertexColors}return n}function Ibe(e){let t=e.extensions.KHR_materials_common;if(!_(t)||!_(t.lights))return;let n=t.lights,r=n.length;for(let o=0;o<r;o++){let a=n[o];if(a.type==="ambient"){_(a.ambient)||(a.ambient={});let s=a.ambient;_(s.color)||(s.color=[1,1,1])}else if(a.type==="directional"){_(a.directional)||(a.directional={});let s=a.directional;_(s.color)||(s.color=[1,1,1])}else if(a.type==="point"){_(a.point)||(a.point={});let s=a.point;_(s.color)||(s.color=[1,1,1]),s.constantAttenuation=T(s.constantAttenuation,1),s.linearAttenuation=T(s.linearAttenuation,0),s.quadraticAttenuation=T(s.quadraticAttenuation,0)}else if(a.type==="spot"){_(a.spot)||(a.spot={});let s=a.spot;_(s.color)||(s.color=[1,1,1]),s.constantAttenuation=T(s.constantAttenuation,1),s.fallOffAngle=T(s.fallOffAngle,3.14159265),s.fallOffExponent=T(s.fallOffExponent,0),s.linearAttenuation=T(s.linearAttenuation,0),s.quadraticAttenuation=T(s.quadraticAttenuation,0)}}}var _Q=Tbe;function Dbe(e,t){if(t=T(t,T.EMPTY_OBJECT),Ho(e,"KHR_techniques_webgl")||!_(e.materials)||e.materials.length===0)return e;_(e.extensions)||(e.extensions={}),_(e.extensionsUsed)||(e.extensionsUsed=[]),_(e.extensionsRequired)||(e.extensionsRequired=[]),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl");let n=Mr.splitIncompatibleMaterials(e);return re.material(e,function(r,o){let a={},s=Obe(e,r,o,a,n,t);_(r.extensions)||(r.extensions={}),r.extensions.KHR_techniques_webgl={values:a,technique:s}}),Mr.ensureSemanticExistence(e),e}function Pbe(e){return _(e.extensions)&&_(e.extensions.KHR_materials_pbrSpecularGlossiness)}function Wy(e,t,n,r,o){let a,s=n[t];return _(s)&&_(s.texCoord)&&s.texCoord===1&&(r=r.replace("0","1")),_(n[`${t}Offset`])?(a=`${t}Coord`,o.fragmentShaderMain+=`    vec2 ${a} = computeTexCoord(${r}, ${t}Offset, ${t}Rotation, ${t}Scale);
`):a=r,a}var Mbe=[0,0],Lbe=[0],Rbe=[1,1];function bF(e,t,n){if(e.indexOf("Texture")===-1||!_(t.extensions)||!_(t.extensions.KHR_texture_transform))return;let r=`u_${e}`,o=t.extensions.KHR_texture_transform;n[`${r}Offset`]=T(o.offset,Mbe),n[`${r}Rotation`]=T(o.rotation,Lbe),n[`${r}Scale`]=T(o.scale,Rbe),_(t.texCoord)&&_(o.texCoord)&&(n[r].texCoord=o.texCoord)}function Obe(e,t,n,r,o,a){let s=T(a.addBatchIdToGeneratedShaders,!1),u=e.extensions.KHR_techniques_webgl,l=u.techniques,c=u.shaders,f=u.programs,h=Pbe(t),d,p,g;if(!h){let at=t.pbrMetallicRoughness;if(_(at))for(p in at)at.hasOwnProperty(p)&&(g=at[p],d=`u_${p}`,r[d]=g,bF(p,g,r));else r.u_baseColorFactor=[1,1,1,1]}if(h){let at=t.extensions.KHR_materials_pbrSpecularGlossiness;for(p in at)at.hasOwnProperty(p)&&(g=at[p],d=`u_${p}`,r[d]=g,bF(p,g,r))}for(let at in t)t.hasOwnProperty(at)&&(at.indexOf("Texture")>=0||at.indexOf("Factor")>=0)&&(g=t[at],d=`u_${at}`,r[d]=g,bF(at,g,r));let y=`precision highp float;
`,v=`precision highp float;
`,w;_(e.skins)&&(w=e.skins[0]);let C=_(w)?w.joints:[],E=C.length,S=o[n],A,D=!1,P=!1,M=!1,I=!1,O=!1,m=!1,b=!1,L=!1,R=!1;_(S)&&(A=S.skinning,D=A.skinned&&C.length>0,P=S.hasVertexColors,M=S.hasMorphTargets,I=S.hasNormals,O=S.hasTangents,m=S.hasTexCoords,b=S.hasTexCoord1,L=S.hasOutline);let N;M&&re.mesh(e,function(at){re.meshPrimitive(at,function(Sn){if(Sn.material===n){let fa=Sn.targets;_(fa)&&(N=fa)}})});let B={u_modelViewMatrix:{semantic:Ho(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:V.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:V.FLOAT_MAT4}};_(t.extensions)&&_(t.extensions.KHR_materials_unlit)&&(R=!0),I&&(B.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:V.FLOAT_MAT3}),D&&(B.u_jointMatrix={count:E,semantic:"JOINTMATRIX",type:V.FLOAT_MAT4}),M&&(B.u_morphWeights={count:N.length,semantic:"MORPHWEIGHTS",type:V.FLOAT});let G=t.alphaMode;_(G)&&G==="MASK"&&(B.u_alphaCutoff={semantic:"ALPHACUTOFF",type:V.FLOAT});for(d in r)r.hasOwnProperty(d)&&(B[d]={type:Nbe(d)});let F=T(B.u_baseColorTexture,B.u_baseColorFactor);_(F)&&(F.semantic="_3DTILESDIFFUSE");for(d in B)if(B.hasOwnProperty(d)){let at=B[d],Sn=_(at.count)?`[${at.count}]`:"";at.type!==V.FLOAT_MAT3&&at.type!==V.FLOAT_MAT4&&d!=="u_morphWeights"||at.useInFragment?(v+=`uniform ${J1(at.type)} ${d}${Sn};
`,delete at.useInFragment):y+=`uniform ${J1(at.type)} ${d}${Sn};
`}L&&(v+=`uniform sampler2D u_outlineTexture;
`);let k="";D&&(k+=`    mat4 skinMatrix =
        a_weight.x * u_jointMatrix[int(a_joint.x)] +
        a_weight.y * u_jointMatrix[int(a_joint.y)] +
        a_weight.z * u_jointMatrix[int(a_joint.z)] +
        a_weight.w * u_jointMatrix[int(a_joint.w)];
`);let Z={a_position:{semantic:"POSITION"}};if(L&&(Z.a_outlineCoordinates={semantic:"_OUTLINE_COORDINATES"}),y+=`attribute vec3 a_position;
`,I&&(y+=`varying vec3 v_positionEC;
`),L&&(y+=`attribute vec3 a_outlineCoordinates;
`,y+=`varying vec3 v_outlineCoordinates;
`),k+=`    vec3 weightedPosition = a_position;
`,I&&(k+=`    vec3 weightedNormal = a_normal;
`),O&&(k+=`    vec4 weightedTangent = a_tangent;
`),M)for(let at=0;at<N.length;at++){let Sn=N[at];for(let fa in Sn)if(Sn.hasOwnProperty(fa)&&fa!=="extras"){let Tu=`a_${fa}_${at}`;Z[Tu]={semantic:`${fa}_${at}`},y+=`attribute vec3 ${Tu};
`,fa==="POSITION"?k+=`    weightedPosition += u_morphWeights[${at}] * ${Tu};
`:fa==="NORMAL"?k+=`    weightedNormal += u_morphWeights[${at}] * ${Tu};
`:O&&fa==="TANGENT"&&(k+=`    weightedTangent.xyz += u_morphWeights[${at}] * ${Tu};
`)}}D?k+=`    vec4 position = skinMatrix * vec4(weightedPosition, 1.0);
`:k+=`    vec4 position = vec4(weightedPosition, 1.0);
`,k+=`    position = u_modelViewMatrix * position;
`,I&&(k+=`    v_positionEC = position.xyz;
`),k+=`    gl_Position = u_projectionMatrix * position;
`,L&&(k+=`    v_outlineCoordinates = a_outlineCoordinates;
`),I&&(Z.a_normal={semantic:"NORMAL"},y+=`attribute vec3 a_normal;
`,R||(y+=`varying vec3 v_normal;
`,D?k+=`    v_normal = u_normalMatrix * mat3(skinMatrix) * weightedNormal;
`:k+=`    v_normal = u_normalMatrix * weightedNormal;
`,v+=`varying vec3 v_normal;
`),v+=`varying vec3 v_positionEC;
`),O&&(Z.a_tangent={semantic:"TANGENT"},y+=`attribute vec4 a_tangent;
`,y+=`varying vec4 v_tangent;
`,k+=`    v_tangent.xyz = u_normalMatrix * weightedTangent.xyz;
`,k+=`    v_tangent.w = weightedTangent.w;
`,v+=`varying vec4 v_tangent;
`),L&&(v+=`varying vec3 v_outlineCoordinates;
`);let te="",oe,ue,pe,me,st,ht,jt,Ct;if(m){if(Z.a_texcoord_0={semantic:"TEXCOORD_0"},oe="v_texcoord_0",y+=`attribute vec2 a_texcoord_0;
`,y+=`varying vec2 ${oe};
`,k+=`    ${oe} = a_texcoord_0;
`,v+=`varying vec2 ${oe};
`,b){Z.a_texcoord_1={semantic:"TEXCOORD_1"};let Sn=oe.replace("0","1");y+=`attribute vec2 a_texcoord_1;
`,y+=`varying vec2 ${Sn};
`,k+=`    ${Sn} = a_texcoord_1;
`,v+=`varying vec2 ${Sn};
`}let at={fragmentShaderMain:te};ue=Wy(e,"u_normalTexture",r,oe,at),pe=Wy(e,"u_baseColorTexture",r,oe,at),me=Wy(e,"u_specularGlossinessTexture",r,oe,at),st=Wy(e,"u_diffuseTexture",r,oe,at),ht=Wy(e,"u_metallicRoughnessTexture",r,oe,at),jt=Wy(e,"u_occlusionTexture",r,oe,at),Ct=Wy(e,"u_emissiveTexture",r,oe,at),te=at.fragmentShaderMain}D&&(Z.a_joint={semantic:"JOINTS_0"},Z.a_weight={semantic:"WEIGHTS_0"},y+=`attribute vec4 a_joint;
`,y+=`attribute vec4 a_weight;
`),P&&(Z.a_vertexColor={semantic:"COLOR_0"},y+=`attribute vec4 a_vertexColor;
`,y+=`varying vec4 v_vertexColor;
`,k+=`  v_vertexColor = a_vertexColor;
`,v+=`varying vec4 v_vertexColor;
`),s&&(Z.a_batchId={semantic:"_BATCHID"},y+=`attribute float a_batchId;
`),y+=`void main(void) 
{
`,y+=k,y+=`}
`,I&&!R&&(v+=`const float M_PI = 3.141592653589793;
`,v+=`vec3 lambertianDiffuse(vec3 diffuseColor) 
{
    return diffuseColor / M_PI;
}

`,v+=`vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) 
{
    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}

`,v+=`vec3 fresnelSchlick(float metalness, float VdotH) 
{
    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);
}

`,v+=`float smithVisibilityG1(float NdotV, float roughness) 
{
    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
    return NdotV / (NdotV * (1.0 - k) + k);
}

`,v+=`float smithVisibilityGGX(float roughness, float NdotL, float NdotV) 
{
    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);
}

`,v+=`float GGX(float roughness, float NdotH) 
{
    float roughnessSquared = roughness * roughness;
    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
    return roughnessSquared / (M_PI * f * f);
}

`),v+=`vec3 SRGBtoLINEAR3(vec3 srgbIn) 
{
    return pow(srgbIn, vec3(2.2));
}

`,v+=`vec4 SRGBtoLINEAR4(vec4 srgbIn) 
{
    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
    return vec4(linearOut, srgbIn.a);
}

`,v+=`vec3 applyTonemapping(vec3 linearIn) 
{
#ifndef HDR 
    return czm_acesTonemapping(linearIn);
#else 
    return linearIn;
#endif 
}

`,v+=`vec3 LINEARtoSRGB(vec3 linearIn) 
{
#ifndef HDR 
    return pow(linearIn, vec3(1.0/2.2));
#else 
    return linearIn;
#endif 
}

`,v+=`vec2 computeTexCoord(vec2 texCoords, vec2 offset, float rotation, vec2 scale) 
{
    rotation = -rotation; 
    mat3 transform = mat3(
        cos(rotation) * scale.x, sin(rotation) * scale.x, 0.0, 
       -sin(rotation) * scale.y, cos(rotation) * scale.y, 0.0, 
        offset.x, offset.y, 1.0); 
    vec2 transformedTexCoords = (transform * vec3(fract(texCoords), 1.0)).xy; 
    return transformedTexCoords; 
}

`,v+=`#ifdef USE_IBL_LIGHTING 
`,v+=`uniform vec2 gltf_iblFactor; 
`,v+=`#endif 
`,v+=`#ifdef USE_CUSTOM_LIGHT_COLOR 
`,v+=`uniform vec3 gltf_lightColor; 
`,v+=`#endif 
`,v+=`void main(void) 
{
`,v+=te,I&&!R&&(v+=`    vec3 ng = normalize(v_normal);
`,v+=`    vec3 positionWC = vec3(czm_inverseView * vec4(v_positionEC, 1.0));
`,_(r.u_normalTexture)?O?(v+=`    vec3 t = normalize(v_tangent.xyz);
`,v+=`    vec3 b = normalize(cross(ng, t) * v_tangent.w);
`,v+=`    mat3 tbn = mat3(t, b, ng);
`,v+=`    vec3 n = texture2D(u_normalTexture, ${ue}).rgb;
`,v+=`    n = normalize(tbn * (2.0 * n - 1.0));
`):(v=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
${v}`,v+=`#ifdef GL_OES_standard_derivatives
`,v+=`    vec3 pos_dx = dFdx(v_positionEC);
`,v+=`    vec3 pos_dy = dFdy(v_positionEC);
`,v+=`    vec3 tex_dx = dFdx(vec3(${ue},0.0));
`,v+=`    vec3 tex_dy = dFdy(vec3(${ue},0.0));
`,v+=`    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);
`,v+=`    t = normalize(t - ng * dot(ng, t));
`,v+=`    vec3 b = normalize(cross(ng, t));
`,v+=`    mat3 tbn = mat3(t, b, ng);
`,v+=`    vec3 n = texture2D(u_normalTexture, ${ue}).rgb;
`,v+=`    n = normalize(tbn * (2.0 * n - 1.0));
`,v+=`#else
`,v+=`    vec3 n = ng;
`,v+=`#endif
`):v+=`    vec3 n = ng;
`,t.doubleSided&&(v+=`    if (czm_backFacing())
`,v+=`    {
`,v+=`        n = -n;
`,v+=`    }
`)),_(r.u_baseColorTexture)?(v+=`    vec4 baseColorWithAlpha = SRGBtoLINEAR4(texture2D(u_baseColorTexture, ${pe}));
`,_(r.u_baseColorFactor)&&(v+=`    baseColorWithAlpha *= u_baseColorFactor;
`)):_(r.u_baseColorFactor)?v+=`    vec4 baseColorWithAlpha = u_baseColorFactor;
`:v+=`    vec4 baseColorWithAlpha = vec4(1.0);
`,P&&(v+=`    baseColorWithAlpha *= v_vertexColor;
`),v+=`    vec3 baseColor = baseColorWithAlpha.rgb;
`,I&&!R?(h?(_(r.u_specularGlossinessTexture)?(v+=`    vec4 specularGlossiness = SRGBtoLINEAR4(texture2D(u_specularGlossinessTexture, ${me}));
`,v+=`    vec3 specular = specularGlossiness.rgb;
`,v+=`    float glossiness = specularGlossiness.a;
`,_(r.u_specularFactor)&&(v+=`    specular *= u_specularFactor;
`),_(r.u_glossinessFactor)&&(v+=`    glossiness *= u_glossinessFactor;
`)):(_(r.u_specularFactor)?v+=`    vec3 specular = clamp(u_specularFactor, vec3(0.0), vec3(1.0));
`:v+=`    vec3 specular = vec3(1.0);
`,_(r.u_glossinessFactor)?v+=`    float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);
`:v+=`    float glossiness = 1.0;
`),_(r.u_diffuseTexture)?(v+=`    vec4 diffuse = SRGBtoLINEAR4(texture2D(u_diffuseTexture, ${st}));
`,_(r.u_diffuseFactor)&&(v+=`    diffuse *= u_diffuseFactor;
`)):_(r.u_diffuseFactor)?v+=`    vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));
`:v+=`    vec4 diffuse = vec4(1.0);
`,v+=`    baseColorWithAlpha.a = diffuse.a;
`):_(r.u_metallicRoughnessTexture)?(v+=`    vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, ${ht}).rgb;
`,v+=`    float metalness = clamp(metallicRoughness.b, 0.0, 1.0);
`,v+=`    float roughness = clamp(metallicRoughness.g, 0.04, 1.0);
`,_(r.u_metallicFactor)&&(v+=`    metalness *= u_metallicFactor;
`),_(r.u_roughnessFactor)&&(v+=`    roughness *= u_roughnessFactor;
`)):(_(r.u_metallicFactor)?v+=`    float metalness = clamp(u_metallicFactor, 0.0, 1.0);
`:v+=`    float metalness = 1.0;
`,_(r.u_roughnessFactor)?v+=`    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);
`:v+=`    float roughness = 1.0;
`),v+=`    vec3 v = -normalize(v_positionEC);
`,v+=`#ifndef USE_CUSTOM_LIGHT_COLOR 
`,v+=`    vec3 lightColorHdr = czm_lightColorHdr;
`,v+=`#else 
`,v+=`    vec3 lightColorHdr = gltf_lightColor;
`,v+=`#endif 
`,v+=`    vec3 l = normalize(czm_lightDirectionEC);
`,v+=`    vec3 h = normalize(v + l);
`,v+=`    float NdotL = clamp(dot(n, l), 0.001, 1.0);
`,v+=`    float NdotV = abs(dot(n, v)) + 0.001;
`,v+=`    float NdotH = clamp(dot(n, h), 0.0, 1.0);
`,v+=`    float LdotH = clamp(dot(l, h), 0.0, 1.0);
`,v+=`    float VdotH = clamp(dot(v, h), 0.0, 1.0);
`,v+=`    vec3 f0 = vec3(0.04);
`,h?(v+=`    float roughness = 1.0 - glossiness;
`,v+=`    vec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));
`,v+=`    vec3 specularColor = specular;
`):(v+=`    vec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);
`,v+=`    vec3 specularColor = mix(f0, baseColor, metalness);
`),v+=`    float alpha = roughness * roughness;
`,v+=`    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);
`,v+=`    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
`,v+=`    vec3 r0 = specularColor.rgb;
`,v+=`    vec3 F = fresnelSchlick2(r0, r90, VdotH);
`,v+=`    float G = smithVisibilityGGX(alpha, NdotL, NdotV);
`,v+=`    float D = GGX(alpha, NdotH);
`,v+=`    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
`,v+=`    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
`,v+=`    vec3 color = NdotL * lightColorHdr * (diffuseContribution + specularContribution);
`,v+=`#if defined(USE_IBL_LIGHTING) && !defined(DIFFUSE_IBL) && !defined(SPECULAR_IBL) 
`,v+=`    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));
`,v+=`    float vertexRadius = length(positionWC);
`,v+=`    float horizonDotNadir = 1.0 - min(1.0, czm_ellipsoidRadii.x / vertexRadius);
`,v+=`    float reflectionDotNadir = dot(r, normalize(positionWC));
`,v+=`    r.x = -r.x;
`,v+=`    r = -normalize(czm_temeToPseudoFixed * r);
`,v+=`    r.x = -r.x;
`,v+=`    float inverseRoughness = 1.04 - roughness;
`,v+=`    inverseRoughness *= inverseRoughness;
`,v+=`    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;
`,v+=`    float atmosphereHeight = 0.05;
`,v+=`    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);
`,v+=`    float blendRegionOffset = roughness * -1.0;
`,v+=`    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);
`,v+=`    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);
`,v+=`    vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);
`,v+=`    vec3 nadirColor = belowHorizonColor * 0.5;
`,v+=`    vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);
`,v+=`    vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);
`,v+=`    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);
`,v+=`    vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);
`,v+=`    float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;
`,v+=`    float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));
`,v+=`    vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);
`,v+=`    float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);
`,v+=`    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);
`,v+=`    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);
`,v+=`    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);
`,v+=`#ifdef USE_SUN_LUMINANCE 
`,v+=`    float LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), normalize(positionWC * -1.0)), 0.001, 1.0);
`,v+=`    float S = acos(LdotZenith);
`,v+=`    float NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), normalize(positionWC * -1.0)), 0.001, 1.0);
`,v+=`    float gamma = acos(NdotL);
`,v+=`    float numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));
`,v+=`    float denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));
`,v+=`    float luminance = gltf_luminanceAtZenith * (numerator / denominator);
`,v+=`#endif 
`,v+=`    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
`,v+=`    vec3 IBLColor = (diffuseIrradiance * diffuseColor * gltf_iblFactor.x) + (specularIrradiance * SRGBtoLINEAR3(specularColor * brdfLut.x + brdfLut.y) * gltf_iblFactor.y);
`,v+=`    float maximumComponent = max(max(lightColorHdr.x, lightColorHdr.y), lightColorHdr.z);
`,v+=`    vec3 lightColor = lightColorHdr / max(maximumComponent, 1.0);
`,v+=`    IBLColor *= lightColor;
`,v+=`#ifdef USE_SUN_LUMINANCE 
`,v+=`    color += IBLColor * luminance;
`,v+=`#else 
`,v+=`    color += IBLColor; 
`,v+=`#endif 
`,v+=`#elif defined(DIFFUSE_IBL) || defined(SPECULAR_IBL) 
`,v+=`    const mat3 yUpToZUp = mat3(-1.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0); 
`,v+=`    vec3 cubeDir = normalize(yUpToZUp * gltf_iblReferenceFrameMatrix * normalize(reflect(-v, n))); 
`,v+=`#ifdef DIFFUSE_IBL 
`,v+=`#ifdef CUSTOM_SPHERICAL_HARMONICS 
`,v+=`    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, gltf_sphericalHarmonicCoefficients); 
`,v+=`#else 
`,v+=`    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); 
`,v+=`#endif 
`,v+=`#else 
`,v+=`    vec3 diffuseIrradiance = vec3(0.0); 
`,v+=`#endif 
`,v+=`#ifdef SPECULAR_IBL 
`,v+=`    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
`,v+=`#ifdef CUSTOM_SPECULAR_IBL 
`,v+=`    vec3 specularIBL = czm_sampleOctahedralProjection(gltf_specularMap, gltf_specularMapSize, cubeDir,  roughness * gltf_maxSpecularLOD, gltf_maxSpecularLOD);
`,v+=`#else 
`,v+=`    vec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);
`,v+=`#endif 
`,v+=`    specularIBL *= F * brdfLut.x + brdfLut.y;
`,v+=`#else 
`,v+=`    vec3 specularIBL = vec3(0.0); 
`,v+=`#endif 
`,v+=`    color += diffuseIrradiance * diffuseColor + specularColor * specularIBL;
`,v+=`#endif 
`):v+=`    vec3 color = baseColor;
`,R||(_(r.u_occlusionTexture)&&(v+=`    color *= texture2D(u_occlusionTexture, ${jt}).r;
`),_(r.u_emissiveTexture)?(v+=`    vec3 emissive = SRGBtoLINEAR3(texture2D(u_emissiveTexture, ${Ct}).rgb);
`,_(r.u_emissiveFactor)&&(v+=`    emissive *= u_emissiveFactor;
`),v+=`    color += emissive;
`):_(r.u_emissiveFactor)&&(v+=`    color += u_emissiveFactor;
`)),R||(v+=`    color = applyTonemapping(color);
`),v+=`    color = LINEARtoSRGB(color);
`,L&&(v+=`    float outlineness = max(
`,v+=`        texture2D(u_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r,
`,v+=`        max(
`,v+=`          texture2D(u_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r,
`,v+=`          texture2D(u_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r));
`,v+=`    color = mix(color, vec3(0.0, 0.0, 0.0), outlineness);
`),_(G)?G==="MASK"?(v+=`    if (baseColorWithAlpha.a < u_alphaCutoff) {
`,v+=`        discard;
`,v+=`    }
`,v+=`    gl_FragColor = vec4(color, 1.0);
`):G==="BLEND"?v+=`    gl_FragColor = vec4(color, baseColorWithAlpha.a);
`:v+=`    gl_FragColor = vec4(color, 1.0);
`:v+=`    gl_FragColor = vec4(color, 1.0);
`,v+=`}
`;let bt=$i(c,{type:V.VERTEX_SHADER,extras:{_pipeline:{source:y,extension:".glsl"}}}),mn=$i(c,{type:V.FRAGMENT_SHADER,extras:{_pipeline:{source:v,extension:".glsl"}}}),Tn=$i(f,{fragmentShader:mn,vertexShader:bt});return $i(l,{attributes:Z,program:Tn,uniforms:B})}function Nbe(e){if(e.indexOf("Offset")!==-1)return V.FLOAT_VEC2;if(e.indexOf("Rotation")!==-1)return V.FLOAT;if(e.indexOf("Scale")!==-1)return V.FLOAT_VEC2;if(e.indexOf("Texture")!==-1)return V.SAMPLER_2D;switch(e){case"u_baseColorFactor":return V.FLOAT_VEC4;case"u_metallicFactor":return V.FLOAT;case"u_roughnessFactor":return V.FLOAT;case"u_emissiveFactor":return V.FLOAT_VEC3;case"u_diffuseFactor":return V.FLOAT_VEC4;case"u_specularFactor":return V.FLOAT_VEC3;case"u_glossinessFactor":return V.FLOAT}}var yQ=Dbe;var Bbe={LEFT:-1,NONE:0,RIGHT:1,UP:1,BOTTOM:-1},Yy=Object.freeze(Bbe);var Fbe={modifyFragmentShader:function(t){return t=xt.replaceMain(t,"czm_splitter_main"),t+=`uniform float czm_splitDirection; 
void main() 
{ 
#ifndef SHADOW_MAP
    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; 
    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; 
#endif
    czm_splitter_main(); 
} 
`,t},addUniforms:function(t,n){n.czm_splitDirection=function(){return t.splitDirection}}},IF=Fbe;var zbe=new x,dg=Mr.ModelState,Vbe="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01",kbe=z.EPSILON16;function NF(e,t){e._cachedGltf=t}function vS(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object.defineProperties(vS.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}});vS.prototype.makeReady=function(e){this.gltf=e;let t=this.modelsToLoad,n=t.length;for(let r=0;r<n;++r){let o=t[r];o.isDestroyed()||NF(o,this)}this.modelsToLoad=void 0,this.ready=!0};var X0={},vQ={};function cu(e){e=T(e,T.EMPTY_OBJECT);let t=e.cacheKey;this._cacheKey=t,this._cachedGltf=void 0,this._releaseGltfJson=T(e.releaseGltfJson,!1);let n;if(_(t)&&_(X0[t])&&X0[t].ready)n=X0[t],++n.count;else{let s=e.gltf;if(_(s)){if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),s instanceof Uint8Array){let u=V1(s);n=new vS({gltf:u,ready:!0})}else n=new vS({gltf:e.gltf,ready:!0});n.count=1,_(t)&&(X0[t]=n)}}NF(this,n);let r=T(e.basePath,"");this._resource=_t.createIfNeeded(r);let o=e.credit;typeof o=="string"&&(o=new dS(o)),this._credit=o,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=T(e.showCreditsOnScreen,!1),this.show=T(e.show,!0),this.silhouetteColor=T(e.silhouetteColor,K.RED),this._silhouetteColor=new K,this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=T(e.silhouetteSize,0),this.modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._modelMatrix=U.clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=T(e.scale,1),this._scale=this.scale,this.minimumPixelSize=T(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=T(e.heightReference,Pt.NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;let a=e.scene;this._scene=a,_(a)&&_(a.terrainProviderChanged)&&(this._terrainProviderChangedCallback=a.terrainProviderChanged.addEventListener(function(){this._heightChanged=!0},this)),this._pickObject=e.pickObject,this._allowPicking=T(e.allowPicking,!0),this._ready=!1,this._readyPromise=Ro(),this.activeAnimations=new aQ(this),this.clampAnimations=T(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=T(e.incrementallyLoadTextures,!0),this._asynchronous=T(e.asynchronous,!0),this.shadows=T(e.shadows,ro.ENABLED),this._shadows=this.shadows,this.color=K.clone(T(e.color,K.WHITE)),this._colorPreviousAlpha=1,this.colorBlendMode=T(e.colorBlendMode,sg.HIGHLIGHT),this.colorBlendAmount=T(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.referenceMatrix=void 0,this.backFaceCulling=T(e.backFaceCulling,!0),this.showOutline=T(e.showOutline,!0),this.splitDirection=T(e.splitDirection,Yy.NONE),this._splittingEnabled=!1,this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=T(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=T(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=T(e.upAxis,Fu.Y),this._gltfForwardAxis=Fu.Z,this._forwardAxis=e.forwardAxis,this.cull=T(e.cull,!0),this.opaquePass=T(e.opaquePass,Qt.OPAQUE),this._computedModelMatrix=new U,this._clippingPlanesMatrix=U.clone(U.IDENTITY),this._iblReferenceFrameMatrix=ne.clone(ne.IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new Ee,this._state=dg.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,articulationsByName:void 0,articulationsByStageKey:void 0,stagesByKey:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,e.dequantizeInShader&&nl("EV_MTModel.dequantizeInShader","The EV_MTModel dequantizeInShader constructor parameter was deprecated in CesiumJS 1.94 and will be removed in 1.97"),this._dequantizeInShader=T(e.dequantizeInShader,!0),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._pointsLength=0,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._lightColor=x.clone(e.lightColor),_(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new ug,this._shouldDestroyImageBasedLighting=!0),this._shouldRegenerateShaders=!1,this.recreateVertexArraysOnce=!1,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._boundingBox=void 0}Object.defineProperties(cu.prototype,{gltf:{get:function(){return nl("EV_MTModel.gltf","EV_MTModel.gltf getter was deprecated in CesiumJS 1.94 and will be removed in 1.97"),this.gltfInternal}},gltfInternal:{get:function(){return _(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return nl("model.basePath","EV_MTModel.basePath getter is deprecated in CesiumJS 1.94. It will be removed in CesiumJS 1.97"),this.basePathInternal}},basePathInternal:{get:function(){return this._resource.url}},boundingSphere:{get:function(){let e=this.modelMatrix;this.heightReference!==Pt.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);let t=_(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale,n=Ee.clone(this._boundingSphere,this._scaledBoundingSphere);return n.radius*=t,Ee.transform(n,e,n),_(this._rtcCenter)&&x.add(this._rtcCenter,n.center,n.center),n}},boundingSphereInternal:{get:function(){let e=this.modelMatrix;this.heightReference!==Pt.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);let t=U.getScale(e,zbe),n=_(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;x.multiplyByScalar(t,n,t);let r=this._scaledBoundingSphere;return r.center=x.multiplyComponents(this._boundingSphere.center,t,r.center),r.radius=x.maximumComponent(t)*this._initialRadius,_(this._rtcCenter)&&x.add(this._rtcCenter,r.center,r.center),r}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return nl("EV_MTModel.pendingTextureLoads","The EV_MTModel.pendingTextureLoads getter was deprecated in CesiumJS 1.94 and will be removed in CesiumJS 1.97"),this.pendingTextureLoadsInternal}},pendingTextureLoadsInternal:{get:function(){return _(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=gn.clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return _(this._extensionsUsed)||(this._extensionsUsed=Mr.getUsedExtensions(this.gltfInternal)),this._extensionsUsed}},extensionsRequired:{get:function(){return _(this._extensionsRequired)||(this._extensionsRequired=Mr.getRequiredExtensions(this.gltfInternal)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return _(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&pS.setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},lightColor:{get:function(){return this._lightColor},set:function(e){let t=this._lightColor;e===t||x.equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||_(t)&&!_(e)||_(e)&&!_(t),this._lightColor=x.clone(e,t))}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this._shouldRegenerateShaders=!0)}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){if(this._showCreditsOnScreen!==e){_(this._credit)&&(this._credit.showOnScreen=e);let t=this._resourceCredits.length;for(let r=0;r<t;r++)this._resourceCredits[r].showOnScreen=e;let n=this._gltfCredits.length;for(let r=0;r<n;r++)this._gltfCredits[r].showOnScreen=e}this._showCreditsOnScreen=e}}});function MQ(e){return e.stencilBuffer}function BF(e){return!K.equals(e.color,K.WHITE)||e.colorBlendMode!==sg.HIGHLIGHT}function FF(e){let t=e._clippingPlanes;return _(t)&&t.enabled&&t.length!==0}cu.silhouetteSupported=function(e){return MQ(e.context)};function Gbe(e){return nM(e)==="glTF"}cu.fromGltf=function(e){let t=e.url;e=kt(e);let n=_t.createIfNeeded(t),r=T(e.basePath,n.clone()),o=_t.createIfNeeded(r),a=T(e.cacheKey,vQ[A_(n.url)]);_(a)||(a=_i(),vQ[A_(n.url)]=a),_(e.basePath)&&!_(e.cacheKey)&&(a+=o.url),e.cacheKey=a,e.basePath=o;let s=new cu(e),u=X0[a];return _(u)?u.ready||(++u.count,u.modelsToLoad.push(s)):(u=new vS({ready:!1}),u.count=1,u.modelsToLoad.push(s),NF(s,u),X0[a]=u,_(n.headers.Accept)||(n.headers.Accept=Vbe),n.fetchArrayBuffer().then(function(l){let c=new Uint8Array(l);if(Gbe(c)){let d=V1(c);u.makeReady(d)}else{let d=vZ(c);u.makeReady(d)}let f=s._resourceCredits,h=n.credits;if(_(h)){let d=h.length;for(let p=0;p<d;p++)f.push(h[p])}}).catch(Mr.getFailedLoadFunction(s,"model",n.url))),s};cu._gltfCache=X0;function CS(e,t,n){return e._runtime[t][n]}cu.prototype.getNode=function(e){let t=CS(this,"nodesByName",e);return _(t)?t.publicNode:void 0};cu.prototype.getMesh=function(e){return CS(this,"meshesByName",e)};cu.prototype.getMaterial=function(e){return CS(this,"materialsByName",e)};cu.prototype.setArticulationStage=function(e,t){let n=CS(this,"stagesByKey",e),r=CS(this,"articulationsByStageKey",e);_(n)&&_(r)&&(t=z.clamp(t,n.minimumValue,n.maximumValue),z.equalsEpsilon(n.currentValue,t,kbe)||(n.currentValue=t,r.isDirty=!0))};var Ube=new x,DF=new ne;function LQ(e,t){let n=e.currentValue,r=Ube,o;switch(e.type){case"xRotate":o=ne.fromRotationX(z.toRadians(n),DF),U.multiplyByMatrix3(t,o,t);break;case"yRotate":o=ne.fromRotationY(z.toRadians(n),DF),U.multiplyByMatrix3(t,o,t);break;case"zRotate":o=ne.fromRotationZ(z.toRadians(n),DF),U.multiplyByMatrix3(t,o,t);break;case"xTranslate":r.x=n,r.y=0,r.z=0,U.multiplyByTranslation(t,r,t);break;case"yTranslate":r.x=0,r.y=n,r.z=0,U.multiplyByTranslation(t,r,t);break;case"zTranslate":r.x=0,r.y=0,r.z=n,U.multiplyByTranslation(t,r,t);break;case"xScale":r.x=n,r.y=1,r.z=1,U.multiplyByScale(t,r,t);break;case"yScale":r.x=1,r.y=n,r.z=1,U.multiplyByScale(t,r,t);break;case"zScale":r.x=1,r.y=1,r.z=n,U.multiplyByScale(t,r,t);break;case"uniformScale":U.multiplyByUniformScale(t,n,t);break;default:break}return t}var Hbe=new U;cu.prototype.applyArticulations=function(){let e=this._runtime.articulationsByName;for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];if(n.isDirty){n.isDirty=!1;let r=n.nodes.length;for(let o=0;o<r;++o){let a=n.nodes[o],s=U.clone(a.originalMatrix,Hbe),u=n.stages.length;for(let l=0;l<u;++l){let c=n.stages[l];s=LQ(c,s)}a.matrix=s}}}};function qbe(e){let t=e.gltfInternal,n=e._loadResources;re.buffer(t,function(r,o){n.buffers[o]=r.extras._pipeline.source})}function Wbe(e,t){return function(n){let r=e._loadResources,o=new Uint8Array(n);--r.pendingBufferLoads,e.gltfInternal.buffers[t].extras._pipeline.source=o}}function Ybe(e){let t=e.gltfInternal.bufferViews,n=e._loadResources.vertexBuffersToCreate;re.bufferView(e.gltfInternal,function(a,s){a.target===V.ARRAY_BUFFER&&n.enqueue(s)});let r=e._loadResources.indexBuffersToCreate,o={};re.accessor(e.gltfInternal,function(a){let s=a.bufferView;if(!_(s))return;t[s].target===V.ELEMENT_ARRAY_BUFFER&&!_(o[s])&&(o[s]=!0,r.enqueue({id:s,componentType:a.componentType}))})}function Xbe(e){let t=e.gltfInternal;if(!Ho(t,"KHR_techniques_webgl"))return;let n=e._sourcePrograms,r=e._sourceTechniques,o=t.extensions.KHR_techniques_webgl.programs;re.technique(t,function(a,s){r[s]=kt(a);let u=a.program;_(n[u])||(n[u]=kt(o[u]))})}function jbe(e,t,n){return function(r){let o=e._loadResources;o.shaders[n]={source:r,type:t,bufferView:void 0},--o.pendingShaderLoads,e._rendererResources.sourceShaders[n]=r}}function Kbe(e){let t=e.gltfInternal,n=t.buffers,r=t.bufferViews,o=e._rendererResources.sourceShaders;re.shader(t,function(a,s){if(_(a.bufferView)){let u=a.bufferView,l=r[u],c=l.buffer,f=n[c],h=Hl(f.extras._pipeline.source,l.byteOffset,l.byteLength);o[s]=h}else if(_(a.extras._pipeline.source))o[s]=a.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;let u=e._resource.getDerivedResource({url:a.uri});u.fetchText().then(jbe(e,a.type,s)).catch(Mr.getFailedLoadFunction(e,"shader",u.url))}})}function Zbe(e){let t=e._sourceTechniques;for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e._loadResources.programsToCreate.enqueue({programId:r.program,techniqueId:n})}}function Qbe(e){let t={},n={},r={};e._runtime.articulationsByName=t,e._runtime.articulationsByStageKey=n,e._runtime.stagesByKey=r;let o=e.gltfInternal;if(!Ho(o,"AGI_articulations")||!_(o.extensions)||!_(o.extensions.AGI_articulations))return;let a=o.extensions.AGI_articulations.articulations;if(!_(a))return;let s=a.length;for(let u=0;u<s;++u){let l=kt(a[u]);l.nodes=[],l.isDirty=!0,t[l.name]=l;let c=l.stages.length;for(let f=0;f<c;++f){let h=l.stages[f];h.currentValue=h.initialValue;let d=`${l.name} ${h.name}`;n[d]=l,r[d]=h}}}function RQ(e,t){return function(n){let r=e._loadResources;--r.pendingTextureLoads;let o;Array.isArray(n)&&(o=n.slice(1,n.length).map(function(a){return a.bufferView}),n=n[0]),r.texturesToCreate.enqueue({id:t,image:n,bufferView:n.bufferView,width:n.width,height:n.height,internalFormat:n.internalFormat,mipLevels:o})}}var Jbe=/(^data:image\/ktx)|(data:image\/ktx)|(\.ktx$)|(\.ktx.gz$)/i,$be=/(^data:image\/ktx2)|(\.ktx2$)/i;function eIe(e,t,n){let r=e.gltfInternal,o=r.images,a;re.texture(r,function(s,u){let l=s.source;_(s.extensions)&&_(s.extensions.EXT_texture_webp)&&n?l=s.extensions.EXT_texture_webp.source:_(s.extensions)&&_(s.extensions.KHR_texture_basisu)&&t.supportsBasis&&(l=s.extensions.KHR_texture_basisu.source);let c=o[l],f=c.bufferView,h=c.mimeType;if(a=c.uri,_(f))e._loadResources.texturesToCreateFromBufferView.enqueue({id:u,image:void 0,bufferView:f,mimeType:h});else{++e._loadResources.pendingTextureLoads;let d=e._resource.getDerivedResource({url:a}),p;Jbe.test(a)?p=FP(d):$be.test(a)?p=Dm(d):p=d.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0}),p.then(RQ(e,u,l)).catch(Mr.getFailedLoadFunction(e,"image",d.url))}})}var tIe=new U;function nIe(e){let t={},n={},r=[],o=e._loadResources.skinnedNodesIds,a=e._runtime.articulationsByName;re.node(e.gltfInternal,function(s,u){let l={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new U,computedMatrix:new U,dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:s.jointName,weights:[],children:[],parents:[],publicNode:void 0};if(l.publicNode=new fQ(e,s,l,u,Mr.getTransform(s)),t[u]=l,n[s.name]=l,_(s.skin)&&(o.push(u),r.push(l)),_(s.extensions)&&_(s.extensions.AGI_articulations)){let c=s.extensions.AGI_articulations.articulationName;if(_(c)){let f=U.clone(l.publicNode.originalMatrix,tIe),h=a[c];h.nodes.push(l.publicNode);let d=h.stages.length;for(let p=0;p<d;++p){let g=h.stages[p];f=LQ(g,f)}l.publicNode.matrix=f}}}),e._runtime.nodes=t,e._runtime.nodesByName=n,e._runtime.skinnedNodes=r}function rIe(e){let t=e.gltfInternal,n=e._sourceTechniques,r={},o={},a=e._uniformMaps;re.material(t,function(s,u){a[u]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};let l=new uQ(e,s,u);if(_(s.extensions)&&_(s.extensions.KHR_techniques_webgl)){let c=s.extensions.KHR_techniques_webgl.technique;l._technique=c,l._program=n[c].program,re.materialValue(s,function(f,h){_(l._values)||(l._values={}),l._values[h]=kt(f)})}r[s.name]=l,o[u]=l}),e._runtime.materialsByName=r,e._runtime.materialsById=o}function iIe(e){let t={},n=e._runtime.materialsById;re.mesh(e.gltfInternal,function(r,o){t[r.name]=new cQ(r,n,o),(_(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&re.meshPrimitive(r,function(a,s){let u=kF(e,a),l=e._programPrimitives[u];_(l)||(l={},e._programPrimitives[u]=l),l[`${o}.primitive.${s}`]=a})}),e._runtime.meshesByName=t}function oIe(e){let n=e.gltfInternal.asset.copyright;if(!_(n))return;let r=e._showCreditsOnScreen,o=n.split(";").map(function(a){return new dS(a.trim(),r)});e._gltfCredits=o}var zF=function(){this.id=void 0,this.model=void 0,this.context=void 0};zF.prototype.set=function(e,t,n){this.id=e,this.model=t,this.context=n};zF.prototype.execute=function(){OQ(this.id,this.model,this.context)};function OQ(e,t,n){let r=t._loadResources,a=t.gltfInternal.bufferViews[e];_(a)||(a=r.createdBufferViews[e]);let s=ki.createVertexBuffer({context:n,typedArray:r.getBuffer(a),usage:We.STATIC_DRAW});s.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=s,t._geometryByteLength+=s.sizeInBytes}var VF=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};VF.prototype.set=function(e,t,n,r){this.id=e,this.componentType=t,this.model=n,this.context=r};VF.prototype.execute=function(){NQ(this.id,this.componentType,this.model,this.context)};function NQ(e,t,n,r){let o=n._loadResources,s=n.gltfInternal.bufferViews[e];_(s)||(s=o.createdBufferViews[e]);let u=ki.createIndexBuffer({context:r,typedArray:o.getBuffer(s),usage:We.STATIC_DRAW,indexDatatype:t});u.vertexArrayDestroyable=!1,n._rendererResources.buffers[e]=u,n._geometryByteLength+=u.sizeInBytes}var CQ=new zF,xQ=new VF;function aIe(e,t){let n=e._loadResources;if(n.pendingBufferLoads!==0)return;let r=t.context,o=n.vertexBuffersToCreate,a=n.indexBuffersToCreate,s;if(e.asynchronous){for(;o.length>0&&(CQ.set(o.peek(),e,r),!!t.jobScheduler.execute(CQ,mS.BUFFER));)o.dequeue();for(;a.length>0&&(s=a.peek(),xQ.set(s.id,s.componentType,e,r),!!t.jobScheduler.execute(xQ,mS.BUFFER));)a.dequeue()}else{for(;o.length>0;)OQ(o.dequeue(),e,r);for(;a.length>0;)s=a.dequeue(),NQ(s.id,s.componentType,e,r)}}function kF(e,t){let n=e._runtime.materialsById[t.material];if(!!_(n))return n._program}function BQ(e,t,n){let r,o=n._programPrimitives[t];if(!_(o))return e;let a;for(a in o)if(o.hasOwnProperty(a)&&(r=o[a],kF(n,r)===t))break;n._programPrimitives[t]=void 0;let s;if(n.extensionsUsed.WEB3D_quantized_attributes)s=Mr.modifyShaderForQuantizedAttributes(n.gltfInternal,r,e),n._quantizedUniforms[t]=s.uniforms;else{let u=n._decodedData[a];if(_(u))s=Mr.modifyShaderForDracoQuantizedAttributes(n.gltfInternal,r,e,u.attributes);else return e}return s.shader}function sIe(e){return e=xt.replaceMain(e,"gltf_blend_main"),e+=`uniform vec4 gltf_color; 
uniform float gltf_colorBlend; 
void main() 
{ 
    gltf_blend_main(); 
    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); 
    float highlight = ceil(gltf_colorBlend); 
    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); 
    gl_FragColor.a *= gltf_color.a; 
} 
`,e}function xS(e,t,n){return _(n)&&(e=n(e,t)),e}var GF=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};GF.prototype.set=function(e,t,n){this.programToCreate=e,this.model=t,this.context=n};GF.prototype.execute=function(){FQ(this.programToCreate,this.model,this.context)};function FQ(e,t,n){let r=e.programId,o=e.techniqueId,a=t._sourcePrograms[r],s=t._rendererResources.sourceShaders,u=s[a.vertexShader],l=s[a.fragmentShader],c=t._quantizedVertexShaders;if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){let w=c[r];_(w)||(w=BQ(u,r,t),c[r]=w),u=w}let f=xS(u,r,t._vertexShaderLoaded),h=xS(l,r,t._fragmentShaderLoaded);_(t._uniformMapLoaded)||(h=`uniform vec4 czm_pickColor;
${h}`);let d=h.lastIndexOf("tile_main();");if(t._useInstancedColor&&d>-1){let w="";h.indexOf("v_normal")!=-1&&h.indexOf("v_positionEC")!=-1&&(w=`  czm_material material; material.diffuse = gl_FragColor.rgb; material.specular = 1.0; material.shininess = 256.0;  
  material.normal = normalize(v_normal); material.emission = vec3(0.0);  material.alpha = 1.0; 
  vec4 phoneColor = czm_phong(normalize(v_positionEC), material, czm_lightDirectionEC);  
  gl_FragColor.rgb = phoneColor.rgb; 
`);var p=t.gltfInternal;if(p.materials.length>0&&Cesium.defined(p.materials[0].useInstancedColor)){h=`varying vec4 v_instancedColor;
uniform float u_useInstancedColor;
`+h;var g=`tile_main(); 
if(v_instancedColor.a>0.0 && u_useInstancedColor > 0.5){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+w+`} 
`;h=h.replace("tile_main();",g)}else{h=`varying vec4 v_instancedColor;
`+h;var g=`tile_main(); 
if(v_instancedColor.a>0.0){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+w+`} 
`;h=h.replace("tile_main();",g)}}let y=t._imageBasedLighting,v=y.enabled;if(v&&(h=`#define USE_IBL_LIGHTING 

${h}`),_(t._lightColor)&&(h=`#define USE_CUSTOM_LIGHT_COLOR 

${h}`),(t._sourceVersion!=="2.0"||t._sourceKHRTechniquesWebGL)&&(h=xt.replaceMain(h,"non_gamma_corrected_main"),h=`${h}
void main() { 
    non_gamma_corrected_main(); 
    gl_FragColor = czm_gammaCorrect(gl_FragColor); 
} 
`),k1.isSupported(n)){let w=y.useSphericalHarmonicCoefficients,C=y.useSpecularEnvironmentMaps;(w||C||v)&&(h=`uniform mat3 gltf_iblReferenceFrameMatrix; 
${h}`),_(y.sphericalHarmonicCoefficients)?h=`#define DIFFUSE_IBL 
#define CUSTOM_SPHERICAL_HARMONICS 
uniform vec3 gltf_sphericalHarmonicCoefficients[9]; 
${h}`:y.useDefaultSphericalHarmonics&&(h=`#define DIFFUSE_IBL 
${h}`),_(y.specularEnvironmentMapAtlas)&&y.specularEnvironmentMapAtlas.ready?h=`#define SPECULAR_IBL 
#define CUSTOM_SPECULAR_IBL 
uniform sampler2D gltf_specularMap; 
uniform vec2 gltf_specularMapSize; 
uniform float gltf_maxSpecularLOD; 
${h}`:y.useDefaultSpecularMaps&&(h=`#define SPECULAR_IBL 
${h}`)}_(y.luminanceAtZenith)&&(h=`#define USE_SUN_LUMINANCE 
uniform float gltf_luminanceAtZenith;
${h}`),zQ(r,o,h,f,t,n)}function uIe(e,t,n){let r=e.programId,o=e.techniqueId,a=t._sourcePrograms[r],s=t._rendererResources.sourceShaders,u=t._quantizedVertexShaders,l=t.clippingPlanes,c=FF(t),f=s[a.vertexShader],h=s[a.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(f=u[r]);let d=h;BF(t)&&(d=cu._modifyShaderForColor(d)),c&&(d=cDe(d,l,n)),t.splitDirection!==Yy.NONE&&(d=IF.modifyFragmentShader(d));let p=xS(f,r,t._vertexShaderLoaded),g=xS(d,r,t._fragmentShaderLoaded);_(t._uniformMapLoaded)||(g=`uniform vec4 czm_pickColor;
${g}`);let y=g.lastIndexOf("tile_main();");if(t._useInstancedColor&&y>-1){let C=t.gltfInternal,E="";if(g.indexOf("v_normal")!=-1&&g.indexOf("v_positionEC")!=-1&&(E=`  czm_material material; material.diffuse = gl_FragColor.rgb; material.specular = 1.0; material.shininess = 256.0;  
  material.normal = normalize(v_normal); material.emission = vec3(0.0);  material.alpha = 1.0; 
  vec4 phoneColor = czm_phong(normalize(v_positionEC), material, czm_lightDirectionEC);  
  gl_FragColor.rgb = phoneColor.rgb; 
`),C.materials.length>0&&Cesium.defined(C.materials[0].useInstancedColor)){g=`varying vec4 v_instancedColor;
uniform float u_useInstancedColor;
`+g;let S=`tile_main(); 
if(v_instancedColor.a>0.0 && u_useInstancedColor > 0.5){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+E+`} 
`;g=g.replace("tile_main();",S)}else{g=`varying vec4 v_instancedColor;
`+g;let S=`tile_main(); 
if(v_instancedColor.a>0.0){  
  gl_FragColor.rgb = mix(gl_FragColor.rgb, v_instancedColor.rgb, v_instancedColor.a);
`+E+`} 
`;g=g.replace("tile_main();",S)}}let v=t._imageBasedLighting,w=v.enabled;if(w&&(g=`#define USE_IBL_LIGHTING 

${g}`),_(t._lightColor)&&(g=`#define USE_CUSTOM_LIGHT_COLOR 

${g}`),(t._sourceVersion!=="2.0"||t._sourceKHRTechniquesWebGL)&&(g=xt.replaceMain(g,"non_gamma_corrected_main"),g=`${g}
void main() { 
    non_gamma_corrected_main(); 
    gl_FragColor = czm_gammaCorrect(gl_FragColor); 
} 
`),k1.isSupported(n)){let C=v.useSphericalHarmonicCoefficients,E=v.useSpecularEnvironmentMaps;(C||E||w)&&(g=`uniform mat3 gltf_iblReferenceFrameMatrix; 
${g}`),_(v.sphericalHarmonicCoefficients)?g=`#define DIFFUSE_IBL 
#define CUSTOM_SPHERICAL_HARMONICS 
uniform vec3 gltf_sphericalHarmonicCoefficients[9]; 
${g}`:v.useDefaultSphericalHarmonics&&(g=`#define DIFFUSE_IBL 
${g}`),_(v.specularEnvironmentMapAtlas)&&v.specularEnvironmentMapAtlas.ready?g=`#define SPECULAR_IBL 
#define CUSTOM_SPECULAR_IBL 
uniform sampler2D gltf_specularMap; 
uniform vec2 gltf_specularMapSize; 
uniform float gltf_maxSpecularLOD; 
${g}`:v.useDefaultSpecularMaps&&(g=`#define SPECULAR_IBL 
${g}`)}_(v.luminanceAtZenith)&&(g=`#define USE_SUN_LUMINANCE 
uniform float gltf_luminanceAtZenith;
${g}`),zQ(r,o,g,p,t,n)}function zQ(e,t,n,r,o,a){let s=o._sourceTechniques[t],u=Mr.createAttributeLocations(s,o._precreatedAttributes);o._rendererResources.programs[e]=vi.fromCache({context:a,vertexShaderSource:r,fragmentShaderSource:n,attributeLocations:u})}var wQ=new GF;function lIe(e,t){let n=e._loadResources,r=n.programsToCreate;if(n.pendingShaderLoads!==0||n.pendingBufferLoads!==0)return;let o=t.context;if(e.asynchronous)for(;r.length>0&&(wQ.set(r.peek(),e,o),!!t.jobScheduler.execute(wQ,mS.PROGRAM));)r.dequeue();else for(;r.length>0;)FQ(r.dequeue(),e,o)}function cIe(e,t){return function(n){e.texturesToCreate.enqueue({id:t.id,image:n,bufferView:void 0}),--e.pendingBufferViewToImage}}function fIe(e){let t=e._loadResources;if(t.pendingBufferLoads===0)for(;t.texturesToCreateFromBufferView.length>0;){let n=t.texturesToCreateFromBufferView.dequeue(),r=e.gltfInternal,o=r.bufferViews[n.bufferView],a=r.textures[n.id].source,s=Mr.getFailedLoadFunction(e,"image",`id: ${n.id}, bufferView: ${n.bufferView}`);if(n.mimeType==="image/ktx2"){let u=new Uint8Array(t.getBuffer(o));Dm(u).then(RQ(e,n.id,a)).catch(s),++e._loadResources.pendingTextureLoads}else{let u=cIe(t,n);CZ({uint8Array:t.getBuffer(o),format:n.mimeType,flipY:!1,skipColorSpaceConversion:!0}).then(u).catch(s),++t.pendingBufferViewToImage}}}function hIe(e){let t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;let n=e._rendererResources.samplers;re.sampler(e.gltfInternal,function(r,o){n[o]=new La({wrapS:r.wrapS,wrapT:r.wrapT,minificationFilter:r.minFilter,magnificationFilter:r.magFilter})})}}var UF=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};UF.prototype.set=function(e,t,n){this.gltfTexture=e,this.model=t,this.context=n};UF.prototype.execute=function(){VQ(this.gltfTexture,this.model,this.context)};function VQ(e,t,n){let o=t.gltfInternal.textures[e.id],s=t._rendererResources.samplers[o.sampler];_(s)||(s=new La({wrapS:Il.REPEAT,wrapT:Il.REPEAT}));let u=!1,l=t.gltfInternal.materials,c=l.length;for(let E=0;E<c;++E){let S=l[E];if(_(S.extensions)&&_(S.extensions.KHR_techniques_webgl)){let A=S.extensions.KHR_techniques_webgl.values;for(let D in A)if(A.hasOwnProperty(D)&&D.indexOf("Texture")!==-1){let P=A[D];if(P.index===e.id&&_(P.extensions)&&_(P.extensions.KHR_texture_transform)){u=!0;break}}}if(u)break}let f=s.wrapS,h=s.wrapT,d=s.minificationFilter;u&&d!==bn.LINEAR&&d!==bn.NEAREST&&(d===bn.NEAREST_MIPMAP_NEAREST||d===bn.NEAREST_MIPMAP_LINEAR?d=bn.NEAREST:d=bn.LINEAR,s=new La({wrapS:s.wrapS,wrapT:s.wrapT,minificationFilter:d,magnificationFilter:s.magnificationFilter}));let p=e.internalFormat,g=!(_(p)&&Gt.isCompressedFormat(p))&&(d===bn.NEAREST_MIPMAP_NEAREST||d===bn.NEAREST_MIPMAP_LINEAR||d===bn.LINEAR_MIPMAP_NEAREST||d===bn.LINEAR_MIPMAP_LINEAR),y=g||f===Il.REPEAT||f===Il.MIRRORED_REPEAT||h===Il.REPEAT||h===Il.MIRRORED_REPEAT,v,w,C=e.image;if(_(p)){v=!z.isPowerOfTwo(e.width)||!z.isPowerOfTwo(e.height),!n.webgl2&&Gt.isCompressedFormat(p)&&v&&y&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly. See the EV_MTModel.js constructor documentation for more information.");let E=s.minificationFilter;!_(e.mipLevels)&&(d===bn.NEAREST_MIPMAP_NEAREST||d===bn.NEAREST_MIPMAP_LINEAR)?E=bn.NEAREST:!_(e.mipLevels)&&(d===bn.LINEAR_MIPMAP_NEAREST||d===bn.LINEAR_MIPMAP_LINEAR)&&(E=bn.LINEAR),s=new La({wrapS:s.wrapS,wrapT:s.wrapT,minificationFilter:E,magnificationFilter:s.magnificationFilter}),w=new $o({context:n,source:{arrayBufferView:e.bufferView,mipLevels:e.mipLevels},width:e.width,height:e.height,pixelFormat:p,sampler:s})}else if(_(C)){if(v=!z.isPowerOfTwo(C.width)||!z.isPowerOfTwo(C.height),y&&v){let E=document.createElement("canvas");E.width=z.nextPowerOfTwo(C.width),E.height=z.nextPowerOfTwo(C.height),E.getContext("2d").drawImage(C,0,0,C.width,C.height,0,0,E.width,E.height),C=E}w=new $o({context:n,source:C,pixelFormat:o.internalFormat,pixelDatatype:o.type,sampler:s,flipY:!1,skipColorSpaceConversion:!0}),g&&w.generateMipmap()}_(w)&&(t._rendererResources.textures[e.id]=w,t._texturesByteLength+=w.sizeInBytes)}var EQ=new UF;function dIe(e,t){let n=t.context,r=e._loadResources.texturesToCreate;if(e.asynchronous)for(;r.length>0&&(EQ.set(r.peek(),e,n),!!t.jobScheduler.execute(EQ,mS.TEXTURE));)r.dequeue();else for(;r.length>0;)VQ(r.dequeue(),e,n)}function kQ(e,t){let n=e._sourceTechniques,r={},o,a,s=e._runtime.materialsById[t.material];if(!_(s))return r;let u=n[s._technique];if(!_(u))return r;let l=u.attributes,f=e._rendererResources.programs[u.program]._attributeLocations;for(o in f)if(f.hasOwnProperty(o)){let d=l[o];_(d)&&(a=f[o],r[d.semantic]=a)}let h=e._precreatedAttributes;if(_(h))for(o in h)h.hasOwnProperty(o)&&(a=f[o],r[o]=a);return r}function pIe(e,t){let n=e.gltfInternal,r=n.skins,o=n.nodes,a=e._runtime.nodes,s=e._loadResources.skinnedNodesIds,u=s.length;for(let l=0;l<u;++l){let c=s[l],f=a[c],h=o[c],d=t[h.skin];f.inverseBindMatrices=d.inverseBindMatrices,f.bindShapeMatrix=d.bindShapeMatrix;let p=r[h.skin].joints,g=p.length;for(let y=0;y<g;++y){let v=p[y],w=a[v];f.joints.push(w)}}}function mIe(e){let t=e._loadResources;if(t.pendingBufferLoads!==0||!t.createSkins)return;t.createSkins=!1;let n=e.gltfInternal,r=n.accessors,o={};re.skin(n,function(a,s){let u=r[a.inverseBindMatrices],l;U.equals(a.bindShapeMatrix,U.IDENTITY)||(l=U.clone(a.bindShapeMatrix)),o[s]={inverseBindMatrices:gS.getSkinInverseBindMatrices(e,u),bindShapeMatrix:l}}),pIe(e,o)}function gIe(e,t,n,r){return function(o){_(r)&&(o=e.clampAnimations?r.clampTime(o):r.wrapTime(o),t[n]=r.evaluate(o,t[n]),t.dirtyNumber=e._maxDirtyNumber)}}function _Ie(e){let t=e._loadResources;if(!t.finishedPendingBufferLoads()||!t.createRuntimeAnimations)return;t.createRuntimeAnimations=!1,e._runtime.animations=[];let n=e._runtime.nodes,r=e.gltfInternal.accessors;re.animation(e.gltfInternal,function(o,a){let s=o.channels,u=o.samplers,l=Number.MAX_VALUE,c=-Number.MAX_VALUE,f=s.length,h=new Array(f);for(let d=0;d<f;++d){let p=s[d],g=p.target,y=g.path,v=u[p.sampler],w=gS.getAnimationParameterValues(e,r[v.input]),C=gS.getAnimationParameterValues(e,r[v.output]);l=Math.min(l,w[0]),c=Math.max(c,w[w.length-1]);let E=gS.getAnimationSpline(e,a,o,p.sampler,v,w,y,C);h[d]=gIe(e,n[g.node],g.path,E)}e._runtime.animations[a]={name:o.name,startTime:l,stopTime:c,channelEvaluators:h}})}function TQ(e,t){let n=e._loadResources;if(!n.finishedBuffersCreation()||!n.finishedProgramCreation()||!n.createVertexArrays)return;n.createVertexArrays=!1;let r=e._rendererResources.buffers,o=e._rendererResources.vertexArrays,a=e.gltfInternal,s=a.accessors;re.mesh(a,function(u,l){re.meshPrimitive(u,function(c,f){let h=[],d,p=kQ(e,c),g=e._decodedData[`${l}.primitive.${f}`];re.meshPrimitiveAttribute(c,function(E,S){if(d=p[S],_(d)){if(_(g)){let P=g.attributes;if(P.hasOwnProperty(S)){let M=P[S];h.push({index:d,vertexBuffer:r[M.bufferView],componentsPerAttribute:M.componentsPerAttribute,componentDatatype:M.componentDatatype,normalize:M.normalized,offsetInBytes:M.byteOffset,strideInBytes:M.byteStride});return}}let A=s[E],D=_(A.normalized)&&A.normalized;h.push({index:d,vertexBuffer:r[A.bufferView],componentsPerAttribute:Yl(A.type),componentDatatype:A.componentType,normalize:D,offsetInBytes:A.byteOffset,strideInBytes:Sc(a,A)})}});let y,v,w=e._precreatedAttributes;if(_(w))for(v in w)w.hasOwnProperty(v)&&(d=p[v],_(d)&&(y=w[v],y.index=d,h.push(y)));let C;if(_(c.indices)){let S=s[c.indices].bufferView;_(g)&&(S=g.bufferView),C=r[S]}o[`${l}.primitive.${f}`]=new Kh({context:t,attributes:h,indexBuffer:C})})})}function yIe(e,t){pg(e._rendererResources.vertexArrays),e._rendererResources.vertexArrays=void 0,e._nodeCommands.length=0,e._runtime.rootNodes=void 0;for(var n in e._runtime.nodes)Cesium.defined(e._runtime.nodes[n].commands)&&(e._runtime.nodes[n].commands=[],e._runtime.nodes[n].children=[],e._runtime.nodes[n].parents=[]);let r=t.scene3DOnly,o=t.context,a=e._rendererResources.buffers,s={},u=e.gltfInternal,l=u.accessors;re.mesh(u,function(w,C){re.meshPrimitive(w,function(E,S){let A=[],D,P=kQ(e,E),M=e._decodedData[`${C}.primitive.${S}`];re.meshPrimitiveAttribute(E,function(L,R){if(D=P[R],_(D)){if(_(M)){let G=M.attributes;if(G.hasOwnProperty(R)){let F=G[R];A.push({index:D,vertexBuffer:a[F.bufferView],componentsPerAttribute:F.componentsPerAttribute,componentDatatype:F.componentDatatype,normalize:F.normalized,offsetInBytes:F.byteOffset,strideInBytes:F.byteStride});return}}let N=l[L],B=_(N.normalized)&&N.normalized;A.push({index:D,vertexBuffer:a[N.bufferView],componentsPerAttribute:Yl(N.type),componentDatatype:N.componentType,normalize:B,offsetInBytes:N.byteOffset,strideInBytes:Sc(u,N)})}});let I,O,m=e._precreatedAttributes;if(_(m))for(O in m)m.hasOwnProperty(O)&&(D=P[O],_(D)&&(I=m[O],I.index=D,A.push(I)));let b;if(_(E.indices)){let R=l[E.indices].bufferView;_(M)&&(R=M.bufferView),b=a[R]}s[`${C}.primitive.${S}`]=new Kh({context:o,attributes:A,indexBuffer:b})})}),e._rendererResources.vertexArrays=s;let c=[],f=e._runtime.nodes,h=u.nodes,p=u.scenes[u.scene].nodes,g=p.length,y=[],v={};for(let w=0;w<g;++w)for(y.push({parentRuntimeNode:void 0,gltfNode:h[p[w]],id:p[w]});y.length>0;){let C=y.pop();v[C.id]=!0;let E=C.parentRuntimeNode,S=C.gltfNode,A=f[C.id];if(A.parents.length===0)if(_(S.matrix))A.matrix=U.fromColumnMajorArray(S.matrix);else{let P=S.rotation;A.translation=x.fromArray(S.translation),A.rotation=je.unpack(P),A.scale=x.fromArray(S.scale)}_(E)?(E.children.push(A),A.parents.push(E)):c.push(A),_(S.mesh)&&GQ(e,S,A,o,r);let D=S.children;if(_(D)){let P=D.length;for(let M=0;M<P;M++){let I=D[M];v[I]||y.push({parentRuntimeNode:A,gltfNode:h[I],id:D[M]})}}}e._runtime.rootNodes=c,e._runtime.nodes=f}function vIe(e){let t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,re.material(e.gltfInternal,function(n,r){CIe(e,n,r)}))}function CIe(e,t,n){let r=e._rendererResources.renderStates,o=[V.FUNC_ADD,V.FUNC_ADD],a=[V.ONE,V.ONE_MINUS_SRC_ALPHA,V.ONE,V.ONE_MINUS_SRC_ALPHA];_(t.extensions)&&_(t.extensions.KHR_blend)&&(o=t.extensions.KHR_blend.blendEquation,a=t.extensions.KHR_blend.blendFactors);let s=!t.doubleSided,u=t.alphaMode==="BLEND";r[n]=un.fromCache({cull:{enabled:s},depthTest:{enabled:!0,func:o0.LESS_OR_EQUAL},depthMask:!u,blending:{enabled:u,equationRgb:o[0],equationAlpha:o[1],functionSourceRgb:a[0],functionDestinationRgb:a[1],functionSourceAlpha:a[2],functionDestinationAlpha:a[3]}})}var xIe={MODEL:function(e,t,n){return function(){return n.computedMatrix}},VIEW:function(e,t,n){return function(){return e.view}},PROJECTION:function(e,t,n){return function(){return e.projection}},MODELVIEW:function(e,t,n){let r=new U;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r)}},CESIUM_RTC_MODELVIEW:function(e,t,n){let r=new U;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r),U.setTranslation(r,t._rtcCenterEye,r)}},MODELVIEWPROJECTION:function(e,t,n){let r=new U;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r),U.multiply(e._projection,r,r)}},MODELINVERSE:function(e,t,n){let r=new U;return function(){return U.inverse(n.computedMatrix,r)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,n){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,n){let r=new U,o=new U;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r),U.inverse(r,o)}},MODELVIEWPROJECTIONINVERSE:function(e,t,n){let r=new U,o=new U;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r),U.multiply(e._projection,r,r),U.inverse(r,o)}},MODELINVERSETRANSPOSE:function(e,t,n){let r=new U,o=new ne;return function(){return U.inverse(n.computedMatrix,r),U.getMatrix3(r,o),ne.transpose(o,o)}},MODELVIEWINVERSETRANSPOSE:function(e,t,n){let r=new U,o=new U,a=new ne;return function(){return U.multiplyTransformation(e.view,n.computedMatrix,r),U.inverse(r,o),U.getMatrix3(o,a),ne.transpose(a,a)}},VIEWPORT:function(e,t,n){return function(){return e.viewportCartesian4}}};function wIe(e,t,n,r){let o=t._runtime.nodes[e];return xIe[n](r,t,o)}function EIe(e,t,n,r,o,a,s){let u={},l={},c,f;return re.techniqueUniform(n,function(h,d){let p;if(_(r)&&_(r[d]))p=Mr.createUniformFunction(h.type,r[d],a,s),u[d]=p.func,l[d]=p;else if(_(h.node))u[d]=wIe(h.node,e,h.semantic,o.uniformState);else if(_(h.semantic))if(h.semantic==="JOINTMATRIX")c=d;else if(h.semantic==="MORPHWEIGHTS")f=d;else if(h.semantic==="ALPHACUTOFF"){let g=t.alphaMode;if(_(g)&&g==="MASK"){let y=T(t.alphaCutoff,.5);p=Mr.createUniformFunction(h.type,y,a,s),u[d]=p.func,l[d]=p}}else u[d]=Mr.getGltfSemanticUniforms()[h.semantic](o.uniformState,e);else if(_(h.value)){let g=Mr.createUniformFunction(h.type,h.value,a,s);u[d]=g.func,l[d]=g}}),{map:u,values:l,jointMatrixUniformName:c,morphWeightsUniformName:f}}function TIe(e,t){let n=e._loadResources;if(!n.finishedProgramCreation()||!n.createUniformMaps)return;n.createUniformMaps=!1;let r=e.gltfInternal,o=e._sourceTechniques,a=e._uniformMaps,s=e._rendererResources.textures,u=e._defaultTexture;re.material(r,function(l,c){let f=e._runtime.materialsById[c],h=o[f._technique],d=f._values,p=EIe(e,l,h,d,t,s,u),g=a[c];if(g.uniformMap=p.map,g.values=p.values,g.jointMatrixUniformName=p.jointMatrixUniformName,g.morphWeightsUniformName=p.morphWeightsUniformName,_(h.attributes.a_outlineCoordinates)){let y=EF.createTexture(e,t);g.uniformMap.u_outlineTexture=function(){return y}}})}function SIe(e){return Mr.createUniformsForDracoQuantizedAttributes(e.attributes)}function AIe(e,t){let n=kF(e,t),r=e._quantizedUniforms[n];return Mr.createUniformsForQuantizedAttributes(e.gltfInternal,t,r)}function bIe(e){return function(){return e}}function IIe(e){return function(){return e.computedJointMatrices}}function DIe(e){return function(){return e.weights}}function PIe(e){return function(){return e.silhouetteColor}}function MIe(e){return function(){return e.silhouetteSize}}function LIe(e){return function(){return e.color}}function RIe(e){return function(){return e._clippingPlanesMatrix}}function OIe(e){return function(){return e._iblReferenceFrameMatrix}}function NIe(e){return function(){let t=e.clippingPlanes;return!_(t)||!t.enabled?e._defaultTexture:t.texture}}function BIe(e){return function(){let t=e.clippingPlanes;if(!_(t))return K.WHITE.withAlpha(0);let n=K.clone(t.edgeColor);return n.alpha=t.edgeWidth,n}}function FIe(e){return function(){return sg.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function zIe(e){return function(){return e._imageBasedLighting.imageBasedLightingFactor}}function VIe(e){return function(){return e._lightColor}}function kIe(e){return function(){return e._imageBasedLighting.luminanceAtZenith}}function GIe(e){return function(){return e._imageBasedLighting.sphericalHarmonicCoefficients}}function UIe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture}}function HIe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture.dimensions}}function qIe(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.maximumMipmapLevel}}function WIe(e,t){switch(e.mode){case rn.TRIANGLES:return t/3;case rn.TRIANGLE_STRIP:case rn.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function GQ(e,t,n,r,o){let a=e._nodeCommands,s=e._pickIds,u=e.allowPicking,l=e._runtime.meshesByName,c=e._rendererResources,f=c.vertexArrays,h=c.programs,d=c.renderStates,p=e._uniformMaps,g=e.gltfInternal,y=g.accessors,v=g.meshes,w=t.mesh,C=v[w],E=C.primitives,S=E.length;for(let D=0;D<S;++D){let P=E[D],M=y[P.indices],O=e._runtime.materialsById[P.material]._program,m=e._decodedData[`${w}.primitive.${D}`],b,L=P.attributes.POSITION;if(_(L)){let Ct=Mr.getAccessorMinMax(g,L);b=Ee.fromCornerPoints(x.fromArray(Ct.min),x.fromArray(Ct.max))}let R=f[`${w}.primitive.${D}`],N,B;_(m)?(B=m.numberOfIndices,N=0):_(M)?(B=M.count,N=M.byteOffset/Rr.getSizeInBytes(M.componentType)):(B=y[P.attributes.POSITION].count,N=0),e._trianglesLength+=WIe(P,B),P.mode===rn.POINTS&&(e._pointsLength+=B);let G=p[P.material],F=G.uniformMap;if(_(G.jointMatrixUniformName)){let Ct={};Ct[G.jointMatrixUniformName]=IIe(n),F=Yi(F,Ct)}if(_(G.morphWeightsUniformName)){let Ct={};Ct[G.morphWeightsUniformName]=DIe(n),F=Yi(F,Ct)}if(F=Yi(F,{gltf_color:LIe(e),gltf_colorBlend:FIe(e),gltf_clippingPlanes:NIe(e),gltf_clippingPlanesEdgeStyle:BIe(e),gltf_clippingPlanesMatrix:RIe(e),gltf_iblReferenceFrameMatrix:OIe(e),gltf_iblFactor:zIe(e),gltf_lightColor:VIe(e),gltf_sphericalHarmonicCoefficients:GIe(e),gltf_specularMap:UIe(e),gltf_specularMapSize:HIe(e),gltf_maxSpecularLOD:qIe(e),gltf_luminanceAtZenith:kIe(e)}),IF.addUniforms(e,F),Cesium.defined(g.materials[w])&&Cesium.defined(g.materials[w].useInstancedColor)&&e._useInstancedColor){var A=g.materials[w].useInstancedColor?1:0;F=Cesium.combine(F,{u_useInstancedColor:function(){return A}})}_(e._uniformMapLoaded)&&(F=e._uniformMapLoaded(F,O,n));let k={};e.extensionsUsed.WEB3D_quantized_attributes?k=AIe(e,P):e._dequantizeInShader&&_(m)&&(k=SIe(m)),F=Yi(F,k);let Z=d[P.material],te=Z.blending.enabled,oe=e._pickObject;_(oe)||(oe={primitive:e,id:e.id,node:n.publicNode,mesh:l[C.name]});let ue=ro.castShadows(e._shadows),pe=ro.receiveShadows(e._shadows),me;if(u&&!_(e._uniformMapLoaded)){me=r.createPickId(oe),s.push(me);let Ct={czm_pickColor:bIe(me.color)};F=Yi(F,Ct)}u&&(_(e._pickIdLoaded)&&_(e._uniformMapLoaded)?me=e._pickIdLoaded():me="czm_pickColor");let st=new Zt({boundingVolume:new Ee,cull:e.cull,modelMatrix:new U,primitiveType:P.mode,vertexArray:R,count:B,offset:N,shaderProgram:h[O],castShadows:ue,receiveShadows:pe,uniformMap:F,renderState:Z,owner:oe,pass:te?Qt.TRANSLUCENT:e.opaquePass,pickId:me}),ht;o||(ht=Zt.shallowClone(st),ht.boundingVolume=new Ee,ht.modelMatrix=new U);let jt={show:!0,boundingSphere:b,command:st,command2D:ht,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,disableCullingCommand:void 0,disableCullingCommand2D:void 0,programId:O};n.commands.push(jt),a.push(jt)}}function YIe(e,t,n){let r=e._loadResources;if(!r.finishedEverythingButTextureCreation()||!r.createRuntimeNodes)return;r.createRuntimeNodes=!1;let o=[],a=e._runtime.nodes,s=e.gltfInternal,u=s.nodes,c=s.scenes[s.scene].nodes,f=c.length,h=[],d={};for(let p=0;p<f;++p)for(h.push({parentRuntimeNode:void 0,gltfNode:u[c[p]],id:c[p]});h.length>0;){let g=h.pop();d[g.id]=!0;let y=g.parentRuntimeNode,v=g.gltfNode,w=a[g.id];if(w.parents.length===0)if(_(v.matrix))w.matrix=U.fromColumnMajorArray(v.matrix);else{let E=v.rotation;w.translation=x.fromArray(v.translation),w.rotation=je.unpack(E),w.scale=x.fromArray(v.scale)}_(y)?(y.children.push(w),w.parents.push(y)):o.push(w),_(v.mesh)&&GQ(e,v,w,t,n);let C=v.children;if(_(C)){let E=C.length;for(let S=0;S<E;S++){let A=C[S];d[A]||h.push({parentRuntimeNode:w,gltfNode:u[A],id:C[S]})}}}e._runtime.rootNodes=o,e._runtime.nodes=a}function XIe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function jIe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function SQ(e,t){let n=t.context,r=t.scene3DOnly,o=e._quantizedVertexShaders,a=e._sourceTechniques,s=e._sourcePrograms,u=e._rendererResources,l=u.sourceShaders;e._loadRendererResourcesFromCache&&(l=u.sourceShaders=e._cachedRendererResources.sourceShaders);for(let c in a)if(a.hasOwnProperty(c)){let f=a[c].program,h=s[f],d=l[h.vertexShader];if(Mr.checkSupportedGlExtensions(h.glExtensions,n),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){let p=o[f];_(p)||(p=BQ(d,f,e),o[f]=p),d=p}d=xS(d,f,e._vertexShaderLoaded)}if(e._loadRendererResourcesFromCache){let c=e._cachedRendererResources;u.buffers=c.buffers,u.vertexArrays=c.vertexArrays,u.programs=c.programs,u.silhouettePrograms=c.silhouettePrograms,u.textures=c.textures,u.samplers=c.samplers,u.renderStates=c.renderStates,_(e._precreatedAttributes)&&TQ(e,n),e._cachedGeometryByteLength+=XIe(c.buffers),e._cachedTexturesByteLength+=jIe(c.textures)}else aIe(e,t),lIe(e,t),hIe(e,n),fIe(e),dIe(e,t);mIe(e),_Ie(e),e._loadRendererResourcesFromCache||(TQ(e,n),vIe(e)),TIe(e,n),YIe(e,n,r)}function AQ(e,t){let n=e.publicNode,r=n.matrix;n.useMatrix&&_(r)?U.clone(r,t):_(e.matrix)?U.clone(e.matrix,t):(U.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),n.setMatrix(t))}var UQ=[],KIe=new Se,PF=new U;function ZIe(e,t,n,r){let o=e._maxDirtyNumber,a=e._runtime.rootNodes,s=a.length,u=UQ,l=e._computedModelMatrix;if(e._mode!==Ne.SCENE3D&&!e._ignoreCommands){let c=U.getColumn(l,3,KIe);if(!Se.equals(c,Se.UNIT_W))l=yn.basisTo2D(r,l,PF),e._rtcCenter=e._rtcCenter3D;else{let f=e.boundingSphereInternal.center,h=yn.wgs84To2DModelMatrix(r,f,PF);l=U.multiply(h,l,PF),_(e._rtcCenter)&&(U.setTranslation(l,Se.UNIT_W,l),e._rtcCenter=e._rtcCenter2D)}}for(let c=0;c<s;++c){let f=a[c];for(AQ(f,f.transformToRoot),u.push(f);u.length>0;){f=u.pop();let h=f.transformToRoot,d=f.commands;if(f.dirtyNumber===o||t||n){let g=U.multiplyTransformation(l,h,f.computedMatrix),y=d.length;if(y>0)for(let v=0;v<y;++v){let w=d[v],C=w.command;U.clone(g,C.modelMatrix),Ee.transform(w.boundingSphere,C.modelMatrix,C.boundingVolume),_(e._rtcCenter)&&x.add(e._rtcCenter,C.boundingVolume.center,C.boundingVolume.center),C=w.command2D,_(C)&&e._mode===Ne.SCENE2D&&(U.clone(g,C.modelMatrix),C.modelMatrix[13]-=z.sign(C.modelMatrix[13])*2*z.PI*r.ellipsoid.maximumRadius,Ee.transform(w.boundingSphere,C.modelMatrix,C.boundingVolume))}}let p=f.children;if(_(p)){let g=p.length;for(let y=0;y<g;++y){let v=p[y];v.dirtyNumber=Math.max(v.dirtyNumber,f.dirtyNumber),(v.dirtyNumber===o||n)&&(AQ(v,v.transformToRoot),U.multiplyTransformation(h,v.transformToRoot,v.transformToRoot)),u.push(v)}}}}++e._maxDirtyNumber}var MF=new U;function QIe(e){let t=e._runtime.skinnedNodes,n=t.length;for(let r=0;r<n;++r){let o=t[r];MF=U.inverseTransformation(o.transformToRoot,MF);let a=o.computedJointMatrices,s=o.joints,u=o.bindShapeMatrix,l=o.inverseBindMatrices,c=l.length;for(let f=0;f<c;++f)_(a[f])||(a[f]=new U),a[f]=U.multiplyTransformation(MF,s[f].transformToRoot,a[f]),a[f]=U.multiplyTransformation(a[f],l[f],a[f]),_(u)&&(a[f]=U.multiplyTransformation(a[f],u,a[f]))}}function JIe(e){let t=e._runtime.rootNodes,n=t.length,r=UQ;for(let o=0;o<n;++o){let a=t[o];for(a.computedShow=a.publicNode.show,r.push(a);r.length>0;){a=r.pop();let s=a.computedShow,u=a.commands,l=u.length;for(let f=0;f<l;++f)u[f].show=s;let c=a.children;if(_(c)){let f=c.length;for(let h=0;h<f;++h){let d=c[h];d.computedShow=s&&d.publicNode.show,r.push(d)}}}}}function $Ie(e,t){let n=e.id;if(e._id!==n){e._id=n;let r=e._pickIds,o=r.length;for(let a=0;a<o;++a)r[a].object.id=n}}function eDe(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;let t=e.debugWireframe?rn.LINES:rn.TRIANGLES,n=e._nodeCommands,r=n.length;for(let o=0;o<r;++o)n[o].command.primitiveType=t}}function tDe(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;let t=e.debugShowBoundingVolume,n=e._nodeCommands,r=n.length;for(let o=0;o<r;++o)n[o].command.debugShowBoundingVolume=t}}function nDe(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;let t=ro.castShadows(e.shadows),n=ro.receiveShadows(e.shadows),r=e._nodeCommands,o=r.length;for(let a=0;a<o;a++){let s=r[a];s.command.castShadows=t,s.command.receiveShadows=n}}}function rDe(e,t){let n=kt(t,!0);return n.cull.enabled=!1,n.depthTest.enabled=!0,n.depthMask=!1,n.blending=za.ALPHA_BLEND,e.opaquePass===Qt.CESIUM_3D_TILE&&(n.stencilTest=io.setCesium3DTileBit(),n.stencilMask=io.CESIUM_3D_TILE_MASK),un.fromCache(n)}function bQ(e,t){let n=Zt.shallowClone(t);return n.pass=Qt.TRANSLUCENT,n.renderState=rDe(e,t.renderState),n}function HQ(e,t,n){let r=t.scene3DOnly,o=e.color.alpha;if(o>0&&o<1){let a=e._nodeCommands,s=a.length;if(s>0&&(!_(a[0].translucentCommand)||n))for(let u=0;u<s;++u){let l=a[u],c=l.command;if(l.translucentCommand=bQ(e,c),!r){let f=l.command2D;l.translucentCommand2D=bQ(e,f)}}}}function iDe(e){let t=kt(e,!0);return t.cull.enabled=!1,un.fromCache(t)}function IQ(e){let t=Zt.shallowClone(e);return t.renderState=iDe(e.renderState),t}function qQ(e,t,n){let r=t.scene3DOnly;if(!e.backFaceCulling){let a=e._nodeCommands,s=a.length;if(s>0&&(!_(a[0].disableCullingCommand)||n))for(let u=0;u<s;++u){let l=a[u],c=l.command;if(l.disableCullingCommand=IQ(c),!r){let f=l.command2D;l.disableCullingCommand2D=IQ(f)}}}}function oDe(e,t){let n=e._rendererResources.programs;for(let r in n)if(n.hasOwnProperty(r)&&n[r]===t)return r}function aDe(e,t,n){let r=t.vertexShaderSource.sources[0],o=t._attributeLocations,a=e._normalAttributeName;r=xt.replaceMain(r,"gltf_silhouette_main"),r+=`uniform float gltf_silhouetteSize; 
void main() 
{ 
    gltf_silhouette_main(); 
    vec3 n = normalize(czm_normal3D * ${a}); 
    n.x *= czm_projection[0][0]; 
    n.y *= czm_projection[1][1]; 
    vec4 clip = gl_Position; 
    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; 
    gl_Position = clip; 
}`;let s=`uniform vec4 gltf_silhouetteColor; 
void main() 
{ 
    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); 
}`;return vi.fromCache({context:n.context,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o})}function WQ(e,t){return MQ(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&_(e._normalAttributeName)}function sDe(e){let t=e._nodeCommands,n=t.length;for(let r=0;r<n;++r)if(t[r].command.pass===Qt.TRANSLUCENT)return!0;return!1}function RF(e){return e.color.alpha>0&&e.color.alpha<1}function YQ(e){return e.color.alpha===0}function DQ(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var uDe=0;function lDe(e,t){let n=++uDe%255,r=sDe(e)||RF(e)||e.silhouetteColor.alpha<1,o=e._rendererResources.silhouettePrograms,a=t.scene3DOnly,s=e._nodeCommands,u=s.length;for(let l=0;l<u;++l){let c=s[l],f=c.command,h=RF(e)?c.translucentCommand:f,d=Zt.shallowClone(h),p=kt(h.renderState);p.stencilTest={enabled:!0,frontFunction:V.ALWAYS,backFunction:V.ALWAYS,reference:n,mask:-1,frontOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.REPLACE},backOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.REPLACE}},YQ(e)&&(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1),p=un.fromCache(p),d.renderState=p,c.silhouetteModelCommand=d;let g=Zt.shallowClone(f);p=kt(f.renderState,!0),p.depthTest.enabled=!0,p.cull.enabled=!1,r&&(g.pass=Qt.TRANSLUCENT,p.depthMask=!1,p.blending=za.ALPHA_BLEND),p.stencilTest={enabled:!0,frontFunction:V.NOTEQUAL,backFunction:V.NOTEQUAL,reference:n,mask:-1,frontOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.KEEP},backOperation:{fail:V.KEEP,zFail:V.KEEP,zPass:V.KEEP}},p=un.fromCache(p);let y=f.shaderProgram,v=oDe(e,y),w=o[v];_(w)||(w=aDe(e,y,t),o[v]=w);let C=Yi(f.uniformMap,{gltf_silhouetteColor:PIe(e),gltf_silhouetteSize:MIe(e)});if(g.renderState=p,g.shaderProgram=w,g.uniformMap=C,g.castShadows=!1,g.receiveShadows=!1,c.silhouetteColorCommand=g,!a){let E=c.command2D,S=Zt.shallowClone(d);S.boundingVolume=E.boundingVolume,S.modelMatrix=E.modelMatrix,c.silhouetteModelCommand2D=S;let A=Zt.shallowClone(g);S.boundingVolume=E.boundingVolume,S.modelMatrix=E.modelMatrix,c.silhouetteColorCommand2D=A}}}function cDe(e,t,n){return e=xt.replaceMain(e,"gltf_clip_main"),e+=`${cu._getClippingFunction(t,n)}
`,e+=`uniform highp sampler2D gltf_clippingPlanes; 
uniform mat4 gltf_clippingPlanesMatrix; 
uniform vec4 gltf_clippingPlanesEdgeStyle; 
void main() 
{ 
    gltf_clip_main(); 
${jZ("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")}} 
`,e}function XQ(e,t,n){if(!WQ(e,t))return;let r=e._nodeCommands,o=r.length>0&&(DQ(e.color.alpha,e._colorPreviousAlpha)||DQ(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!_(r[0].silhouetteModelCommand));e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(o||n)&&lDe(e,t)}function fDe(e,t){let n=e._clippingPlanes;_(n)&&n.owner===e&&n.enabled&&n.update(t)}var LF=new Ee;function hDe(e,t,n){return LF.center=e,LF.radius=t,n.camera.getPixelSize(LF,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}var lu=new x,yS=new ce;function dDe(e,t){let n=e.scale;if(e.minimumPixelSize!==0){let r=t.context,o=Math.max(r.drawingBufferWidth,r.drawingBufferHeight),a=_(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(lu.x=a[12],lu.y=a[13],lu.z=a[14],_(e._rtcCenter)&&x.add(e._rtcCenter,lu,lu),e._mode!==Ne.SCENE3D){let f=t.mapProjection,h=f.ellipsoid.cartesianToCartographic(lu,yS);f.project(h,lu),x.fromElements(lu.z,lu.x,lu.y,lu)}let s=e.boundingSphereInternal.radius,u=hDe(lu,s,t),l=1/u;Math.min(l*(2*s),o)<e.minimumPixelSize&&(n=e.minimumPixelSize*u/(2*e._initialRadius))}return _(e.maximumScale)?Math.min(e.maximumScale,n):n}function jQ(e){_(e._cacheKey)&&_(e._cachedGltf)&&--e._cachedGltf.count===0&&delete X0[e._cacheKey],e._cachedGltf=void 0}function OF(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function pg(e){for(let t in e)e.hasOwnProperty(t)&&(e[t].isDestroyed()||e[t].destroy())}function pDe(e){pg(e.buffers),pg(e.vertexArrays),pg(e.programs),pg(e.silhouettePrograms),pg(e.textures)}OF.prototype.release=function(){if(--this.count===0)return _(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],pDe(this),ot(this)};function PQ(e,t,n){return function(r){if(e.heightReference===Pt.RELATIVE_TO_GROUND){let a=t.cartesianToCartographic(r,yS);a.height+=n.height,t.cartographicToCartesian(a,r)}let o=e._clampedModelMatrix;U.clone(e.modelMatrix,o),o[12]=r.x,o[13]=r.y,o[14]=r.z,e._heightChanged=!0}}function mDe(e){_(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);let t=e._scene;if(!_(t)||!_(t.globe)||e.heightReference===Pt.NONE){e._clampedModelMatrix=void 0;return}let n=t.globe,r=n.ellipsoid,o=e.modelMatrix;lu.x=o[12],lu.y=o[13],lu.z=o[14];let a=r.cartesianToCartographic(lu);_(e._clampedModelMatrix)||(e._clampedModelMatrix=U.clone(o,new U));let s=n._surface;e._removeUpdateHeightCallback=s.updateHeight(a,PQ(e,r,a));let u=n.getHeight(a);if(_(u)){let l=PQ(e,r,a);ce.clone(a,yS),yS.height=u,r.cartographicToCartesian(yS,lu),l(lu)}}var gDe=new x,_De=new ce;function yDe(e,t){let n,r=e.distanceDisplayCondition,o=r.near*r.near,a=r.far*r.far;if(t.mode===Ne.SCENE2D)n=(t.camera.frustum.right-t.camera.frustum.left)*.5,n=n*n;else{let s=U.getTranslation(e.modelMatrix,gDe);if(t.mode===Ne.COLUMBUS_VIEW){let u=t.mapProjection,c=u.ellipsoid.cartesianToCartographic(s,_De);s=u.project(c,s),x.fromElements(s.z,s.x,s.y,s)}n=x.distanceSquared(s,t.camera.positionWC)}return n>=o&&n<=a}var vDe=new U,CDe=new ne,xDe=new U;cu.prototype.update=function(e){if(e.mode===Ne.MORPHING)return;if(!Qo.supportsWebP.initialized){Qo.supportsWebP.initialize();return}let t=e.context;this._defaultTexture=t.defaultTexture;let n=Qo.supportsWebP();if(this._state===dg.NEEDS_LOAD&&_(this.gltfInternal)){let w,C=this.cacheKey;if(_(C)){t.cache.modelRendererResourceCache=T(t.cache.modelRendererResourceCache,{});let E=t.cache.modelRendererResourceCache;if(w=E[this.cacheKey],_(w)){if(!w.ready)return;++w.count,this._loadRendererResourcesFromCache=!0}else w=new OF(t,C),w.count=1,E[this.cacheKey]=w;this._cachedRendererResources=w}else w=new OF(t),w.count=1,this._cachedRendererResources=w;if(this._state=dg.LOADING,this._state!==dg.FAILED){let E=this.gltfInternal.extensions;if(_(E)&&_(E.CESIUM_RTC)){let S=x.fromArray(E.CESIUM_RTC.center);if(!x.equals(S,x.ZERO)){this._rtcCenter3D=S;let A=e.mapProjection,P=A.ellipsoid.cartesianToCartographic(this._rtcCenter3D),M=A.project(P);x.fromElements(M.z,M.x,M.y,M),this._rtcCenter2D=M,this._rtcCenterEye=new x,this._rtcCenter=this._rtcCenter3D}}cS(this.gltfInternal),this._loadResources=new sQ,this._loadRendererResourcesFromCache||Mr.parseBuffers(this,Wbe)}}let r=this._loadResources,o=this._incrementallyLoadTextures,a=!1;if(this._state===dg.LOADING){if(r.pendingBufferLoads===0){if(!r.initialized){if(e.brdfLutGenerator.update(e),Mr.checkSupportedExtensions(this.extensionsRequired,n),Mr.updateForwardAxis(this),!_(this.gltfInternal.extras.sourceVersion)){let w=this.gltfInternal,C=Mr.getAssetVersion(w),E=_(Mr.getUsedExtensions(w).KHR_techniques_webgl);C!=="2.0"&&nl("gltf-1.0","glTF 1.0 assets were deprecated in CesiumJS 1.94. They will be removed in 1.97. Please convert any glTF 1.0 assets to glTF 2.0."),E&&nl("KHR_techniques_webgl","Support for glTF 1.0 techniques and the KHR_techniques_webgl glTF extension were deprecated in CesiumJS 1.94. It will be removed in 1.97. If custom GLSL shaders are needed, use CustomShader instead."),w.extras.sourceVersion=C,w.extras.sourceKHRTechniquesWebGL=E,this._sourceVersion=C,this._sourceKHRTechniquesWebGL=E,BZ(w),xZ(w);let S={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};_Q(w,S),yQ(w,S)}this._sourceVersion=this.gltfInternal.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltfInternal.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&U1.hasExtension(this),qbe(this),Qbe(this),Xbe(this),this._loadRendererResourcesFromCache||(Ybe(this),Kbe(this),Zbe(this),eIe(this,t,n)),rIe(this),iIe(this),nIe(this),oIe(this),U1.parse(this,t),r.initialized=!0}r.finishedDecoding()||U1.decodeModel(this,t).catch(Mr.getFailedLoadFunction(this,"model",this.basePathInternal)),r.finishedDecoding()&&!r.resourcesParsed&&(TDe(this),this._initialRadius=this._boundingSphere.radius,U1.cacheDataForModel(this),r.resourcesParsed=!0),r.resourcesParsed&&r.pendingShaderLoads===0&&(this.showOutline&&EF.outlinePrimitives(this),SQ(this,e))}(r.finished()||o&&r.finishedEverythingButTextureCreation())&&(this._state=dg.LOADED,a=!0)}if(Cesium.defined(this._cachedRendererResources)&&this._cachedRendererResources.ready&&this._state===dg.LOADED&&this.recreateVertexArraysOnce&&(yIe(this,e),this.recreateVertexArraysOnce=!1),_(r)&&this._state===dg.LOADED&&(o&&!a&&SQ(this,e),r.finished())){this._loadResources=void 0;let w=this._rendererResources,C=this._cachedRendererResources;C.buffers=w.buffers,C.vertexArrays=w.vertexArrays,C.programs=w.programs,C.sourceShaders=w.sourceShaders,C.silhouettePrograms=w.silhouettePrograms,C.textures=w.textures,C.samplers=w.samplers,C.renderStates=w.renderStates,C.ready=!0,this._normalAttributeName=Mr.getAttributeOrUniformBySemantic(this.gltfInternal,"NORMAL"),_(this._precreatedAttributes)&&(C.vertexArrays={}),this.releaseGltfJson&&jQ(this)}let s=WQ(this,e),u=RF(this),l=YQ(this),c=this.backFaceCulling,f=_(this.distanceDisplayCondition)?yDe(this,e):!0,h=this.show&&f&&this.scale!==0&&(!l||s);if(this._imageBasedLighting.update(e),h&&this._state===dg.LOADED||a){let w=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;let C=this.modelMatrix,E=e.mode!==this._mode;this._mode=e.mode;let S=!U.equals(this._modelMatrix,C)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||this.minimumPixelSize!==0||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||E;if(S||a){U.clone(C,this._modelMatrix),mDe(this),_(this._clampedModelMatrix)&&(C=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;let O=dDe(this,e),m=this._computedModelMatrix;U.multiplyByUniformScale(C,O,m),this._upAxis===Fu.Y?U.multiplyTransformation(m,Fu.Y_UP_TO_Z_UP,m):this._upAxis===Fu.X&&U.multiplyTransformation(m,Fu.X_UP_TO_Z_UP,m),this.forwardAxis===Fu.Z&&U.multiplyTransformation(m,Fu.Z_UP_TO_X_UP,m)}(w||S||a)&&(ZIe(this,S,a,e.mapProjection),this._dirty=!0,(w||a)&&QIe(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,JIe(this)),$Ie(this,t),eDe(this),tDe(this),nDe(this),fDe(this,e);let A=this._clippingPlanes,D=0,P=T(this.referenceMatrix,C);if(this._imageBasedLighting.useSphericalHarmonicCoefficients||this._imageBasedLighting.useSpecularEnvironmentMaps){let O=CDe,m=vDe;m=U.multiply(t.uniformState.view3D,P,m),O=U.getMatrix3(m,O),O=ne.getRotation(O,O),this._iblReferenceFrameMatrix=ne.transpose(O,this._iblReferenceFrameMatrix)}if(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLighting.shouldRegenerateShaders,FF(this)){let O=xDe;O=U.multiply(t.uniformState.view3D,P,O),O=U.multiply(O,A.modelMatrix,O),this._clippingPlanesMatrix=U.inverseTranspose(O,this._clippingPlanesMatrix),D=A.clippingPlanesState}this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._clippingPlanesState!==D,this._clippingPlanesState=D;let M=BF(this);M!==this._colorShadingEnabled&&(this._colorShadingEnabled=M,this._shouldRegenerateShaders=!0);let I=this.splitDirection!==Yy.NONE;this._splittingEnabled!==I&&(this._splittingEnabled=I,this._shouldRegenerateShaders=!0),this._shouldRegenerateShaders?SDe(this,e):(HQ(this,e,!1),qQ(this,e,!1),XQ(this,e,!1))}if(a){let w=this;e.afterRender.push(function(){w._ready=!0,w._readyPromise.resolve(w)});return}if(h&&!this._ignoreCommands){let w=e.commandList,C=e.passes,E=this._nodeCommands,S=E.length,A,D,P=e.mapProjection.ellipsoid.maximumRadius*z.PI,M;if(C.render||C.pick&&this.allowPicking){for(A=0;A<S;++A)if(D=E[A],D.show){let I=D.command;s?I=D.silhouetteModelCommand:u?I=D.translucentCommand:c||(I=D.disableCullingCommand),w.push(I),M=D.command.boundingVolume;let O=M.center.y-M.radius,m=M.center.y+M.radius,b=O<P&&m>P||O<-P&&m>-P;if(e.mode===Ne.SCENE2D&&b){let L=D.command2D;s?L=D.silhouetteModelCommand2D:u?L=D.translucentCommand2D:c||(L=D.disableCullingCommand2D),w.push(L)}}if(s&&!C.pick){for(A=0;A<S;++A)if(D=E[A],D.show){w.push(D.silhouetteColorCommand),M=D.command.boundingVolume;let I=M.center.y-M.radius,O=M.center.y+M.radius,m=I<P&&O>P||I<-P&&O>-P;e.mode===Ne.SCENE2D&&m&&w.push(D.silhouetteColorCommand2D)}}}}let d=this._credit;_(d)&&e.creditDisplay.addCredit(d);let p=this._resourceCredits,g=p.length;for(let w=0;w<g;w++)e.creditDisplay.addCredit(p[w]);let y=this._gltfCredits,v=y.length;for(let w=0;w<v;w++)e.creditDisplay.addCredit(y[w])};function KQ(e,t){e.programs!==t.programs&&pg(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&pg(e.silhouettePrograms)}var wDe=new x,EDe=new x;function TDe(e){for(var t=e.gltf,n=t.nodes,r=t.meshes,o=t.scenes[t.scene].nodes,a=o.length,s=[],u=new Cesium.Cartesian3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new Cesium.Cartesian3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),c=0;c<a;++c){var f=n[o[c]];for(f._transformToRoot=Cesium.ModelUtility.getTransform(f),s.push(f);s.length>0;){f=s.pop();var h=f._transformToRoot,d=f.mesh;if(Cesium.defined(d))for(var p=r[d],g=p.primitives,y=g.length,v=0;v<y;++v){var w=g[v].attributes.POSITION;if(Cesium.defined(w)){var C=Cesium.ModelUtility.getAccessorMinMax(t,w);if(Cesium.defined(C.min)&&Cesium.defined(C.max)){var E=Cesium.Cartesian3.fromArray(C.min,0,wDe),S=Cesium.Cartesian3.fromArray(C.max,0,EDe);Cesium.defined(u)&&Cesium.defined(l)&&(Cesium.Matrix4.multiplyByPoint(h,E,E),Cesium.Matrix4.multiplyByPoint(h,S,S),Cesium.Cartesian3.minimumByComponent(u,E,u),Cesium.Cartesian3.maximumByComponent(l,S,l))}}}var A=f.children;if(Cesium.defined(A))for(var D=A.length,P=0;P<D;++P){var M=n[A[P]];M._transformToRoot=Cesium.ModelUtility.getTransform(M),Cesium.Matrix4.multiplyTransformation(h,M._transformToRoot,M._transformToRoot),s.push(M)}delete f._transformToRoot}}var I=Cesium.Cartesian3.clone(u),O=Cesium.Cartesian3.clone(l),m=Cesium.BoundingSphere.fromCornerPoints(u,l);e._forwardAxis===Cesium.Axis.Z&&(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.Z_UP_TO_X_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Z_UP_TO_X_UP,I,I),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Z_UP_TO_X_UP,O,O)),e._upAxis===Cesium.Axis.Y?(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.Y_UP_TO_Z_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Y_UP_TO_Z_UP,I,I),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.Y_UP_TO_Z_UP,O,O)):e._upAxis===Cesium.Axis.X&&(Cesium.BoundingSphere.transformWithoutScale(m,Cesium.Axis.X_UP_TO_Z_UP,m),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.X_UP_TO_Z_UP,I,I),Cesium.Matrix4.multiplyByPoint(Cesium.Axis.X_UP_TO_Z_UP,O,O)),e._boundingBox=new Cesium.BoxGeometry({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,maximum:O,minimum:I}),e._boundingSphere=m}function SDe(e,t){let n=e._rendererResources,r=e._cachedRendererResources;KQ(n,r);let o;if(FF(e)||BF(e)||e.splitDirection!==Yy.NONE||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,n.programs={},n.silhouettePrograms={};let l={},c=e._sourceTechniques,f;for(let h in c)c.hasOwnProperty(h)&&(f=c[h],o=f.program,l[o]||(l[o]=!0,uIe({programId:o,techniqueId:h},e,t.context)))}else n.programs=r.programs,n.silhouettePrograms=r.silhouettePrograms;let a=n.programs,s=e._nodeCommands,u=s.length;for(let l=0;l<u;++l){let c=s[l];o=c.programId;let f=a[o];c.command.shaderProgram=f,_(c.command2D)&&(c.command2D.shaderProgram=f)}HQ(e,t,!0),qQ(e,t,!0),XQ(e,t,!0)}cu.prototype.isDestroyed=function(){return!1};cu.prototype.destroy=function(){_(this._precreatedAttributes)&&pg(this._rendererResources.vertexArrays),_(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),_(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),_(this._cachedRendererResources)&&KQ(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),U1.destroyCachedDataForModel(this);let e=this._pickIds,t=e.length;for(let r=0;r<t;++r)e[r].destroy();jQ(this),this._quantizedVertexShaders=void 0;let n=this._clippingPlanes;return _(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,ot(this)};cu._getClippingFunction=KZ;cu._modifyShaderForColor=sIe;var wS=cu;function ZQ(e,t,n,r){this.primitive=e,this._modelMatrix=U.clone(t),this._instanceId=n,this._modelColor=r}Object.defineProperties(ZQ.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return U.clone(this._modelMatrix)},set:function(e){U.clone(e,this._modelMatrix),this.primitive.expandBoundingSphere(this._modelMatrix),this.primitive._dirty=!0}},modelColor:{get:function(){return this._modelColor}}});var CM=ZQ;var Xy={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function jy(e){e=T(e,T.EMPTY_OBJECT),this.show=T(e.show,!0),this._instancingSupported=!1,this._dynamic=T(e.dynamic,!1),this._allowPicking=T(e.allowPicking,!0),this._ready=!1,this._readyPromise=Ro(),this._state=Xy.NEEDS_LOAD,this._dirty=!1,this._cull=T(e.cull,!0),this._opaquePass=T(e.opaquePass,Qt.OPAQUE),this._instances=JQ(this,e.instances),this._batchTable=e.batchTable,this._model=void 0,this._vertexBufferTypedArray=void 0,this._vertexBuffer=void 0,this._batchIdBuffer=void 0,this._instancedColorTypedArray=void 0,this._instancedColorBuffer=void 0,this._instancedUniformsByProgram=void 0,this._drawCommands=[],this._modelCommands=void 0,this._renderStates=void 0,this._disableCullingRenderStates=void 0,this._boundingSphere=$Q(this),this._center=x.clone(this._boundingSphere.center),this._rtcTransform=new U,this._rtcModelView=new U,this._mode=void 0,this.modelMatrix=U.clone(U.IDENTITY),this._modelMatrix=U.clone(this.modelMatrix),this._url=_t.createIfNeeded(e.url),this._requestType=e.requestType,this._gltf=e.gltf,this._basePath=_t.createIfNeeded(e.basePath),this._asynchronous=e.asynchronous,this._incrementallyLoadTextures=e.incrementallyLoadTextures,this._upAxis=e.upAxis,this._forwardAxis=e.forwardAxis,this.shadows=T(e.shadows,ro.ENABLED),this._shadows=this.shadows,this._pickIdLoaded=e.pickIdLoaded,this.splitDirection=T(e.splitDirection,Yy.NONE),this.debugShowBoundingVolume=T(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=T(e.debugWireframe,!1),this._debugWireframe=!1,_(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new ug,this._shouldDestroyImageBasedLighting=!0),this.backFaceCulling=T(e.backFaceCulling,!0),this._backFaceCulling=this.backFaceCulling,this.showCreditsOnScreen=T(e.showCreditsOnScreen,!1),this.precreatedAttributes=void 0,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._instancingRegenertedOnce=!1}Object.defineProperties(jy.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},instancingRegenertedOnce:{get:function(){return this._instancingRegenertedOnce},set:function(e){this._instancingRegenertedOnce=e}},dirty:{get:function(){return this._dirty},set:function(e){this._dirty=e}}});function JQ(e,t){t=T(t,[]);let n=t.length,r=new Array(n);for(let a=0;a<n;++a){let s=t[a],u=s.modelMatrix,l=T(s.batchId,a);var o=s.modelColor;r[a]=new CM(e,u,l,o)}return r}function $Q(e){let t=e.length,n=new Array(t);for(let r=0;r<t;++r)n[r]=U.getTranslation(e._instances[r]._modelMatrix,new x);return Ee.fromPoints(n)}var ADe=new x,HF=new U;jy.prototype.expandBoundingSphere=function(e){let t=U.getTranslation(e,ADe);Ee.expand(this._boundingSphere,t,this._boundingSphere)};function bDe(e,t,n,r){return function(o,a){let s=o.semantic;if(_(s)&&e.indexOf(s)>-1)if(t.indexOf(s)>-1)r[a]=s;else throw new it(`Shader program cannot be optimized for instancing. Uniform "${a}" in program "${n}" uses unsupported semantic "${s}"`)}}function eJ(e,t){if(_(e._instancedUniformsByProgram))return e._instancedUniformsByProgram[t];let n={};e._instancedUniformsByProgram=n;let r=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"],o=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"],a=e._model._sourceTechniques;for(let s in a)if(a.hasOwnProperty(s)){let u=a[s],l=u.program;if(!_(n[l])){let c={};n[l]=c,re.techniqueUniform(u,bDe(r,o,t,c))}}return n[t]}function IDe(e){return function(t,n){let r=eJ(e,n),o=_(e._batchTable),a=e._useInstancedColor,s=xt.replaceMain(t,"czm_instancing_main"),u="",l="";for(let y in r)if(r.hasOwnProperty(y)){let v=r[y],w;v==="MODELVIEW"||v==="CESIUM_RTC_MODELVIEW"?w="czm_instanced_modelView":v==="MODELVIEWPROJECTION"?(w="czm_instanced_modelViewProjection",u+=`mat4 czm_instanced_modelViewProjection;
`,l+=`czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;
`):v==="MODELVIEWINVERSETRANSPOSE"&&(w="czm_instanced_modelViewInverseTranspose",u+=`mat3 czm_instanced_modelViewInverseTranspose;
`,l+=`czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);
`);let C=new RegExp(`uniform.*${y}.*`);s=s.replace(C,""),C=new RegExp(`${y}\\b`,"g"),s=s.replace(C,w)}let c=`uniform mat4 czm_instanced_modifiedModelView;
uniform mat4 czm_instanced_nodeTransform;
`,f,h,d;o?(f=`attribute float a_batchId;
`,h="",d=""):(f="",h=`attribute vec4 pickColor;
varying vec4 v_pickColor;
`,d=`    v_pickColor = pickColor;
`);var p="";a&&(p=`attribute vec4 instancedColor;
varying vec4 v_instancedColor;
`,d+=` v_instancedColor = instancedColor;
`);let g=`${c+u}mat4 czm_instanced_modelView;
attribute vec4 czm_modelMatrixRow0;
attribute vec4 czm_modelMatrixRow1;
attribute vec4 czm_modelMatrixRow2;
${f}${h}${p}${s}void main()
{
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);
    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;
${l}    czm_instancing_main();
${d}}
`;if(o){let y=e._model.gltfInternal,v=Mr.getDiffuseAttributeOrUniform(y,n);g=e._batchTable.getVertexShaderCallback(!0,"a_batchId",v)(g)}return g}}function DDe(e){return function(t,n){let r=e._batchTable;if(_(r)){let o=e._model.gltfInternal,a=Mr.getDiffuseAttributeOrUniform(o,n);t=r.getFragmentShaderCallback(!0,a,!1)(t)}else t=`varying vec4 v_pickColor;
${t}`;return t}}function PDe(e,t){return function(){return U.multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}function MDe(e){return function(){return e.computedMatrix}}function LDe(e,t){return function(n,r,o){n=kt(n),n.czm_instanced_modifiedModelView=PDe(e,t),n.czm_instanced_nodeTransform=MDe(o);let a=eJ(e,r);for(let s in a)a.hasOwnProperty(s)&&delete n[s];return _(e._batchTable)&&(n=e._batchTable.getUniformMapCallback()(n)),n}}function RDe(e){return function(t,n){if(_(e._batchTable)){let r=e._model.gltfInternal,o=Mr.getDiffuseAttributeOrUniform(r,n);t=e._batchTable.getVertexShaderCallback(!0,"a_batchId",o)(t),t=`uniform float a_batchId
;${t}`}return t}}function ODe(e){return function(t,n){let r=e._batchTable;if(_(r)){let o=e._model.gltfInternal,a=Mr.getDiffuseAttributeOrUniform(o,n);t=r.getFragmentShaderCallback(!0,a,!1)(t)}else t=`uniform vec4 czm_pickColor;
${t}`;return t}}function NDe(e){return function(t){return _(e._batchTable)&&(t=e._batchTable.getUniformMapCallback()(t)),t}}function tJ(e){let t=e._instances,n=e.length,r=e._center,o=12,a=e._vertexBufferTypedArray;_(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(let s=0;s<n;++s){let u=t[s]._modelMatrix,l=U.clone(u,HF);l[12]-=r.x,l[13]-=r.y,l[14]-=r.z;let c=s*o;a[c+0]=l[0],a[c+1]=l[4],a[c+2]=l[8],a[c+3]=l[12],a[c+4]=l[1],a[c+5]=l[5],a[c+6]=l[9],a[c+7]=l[13],a[c+8]=l[2],a[c+9]=l[6],a[c+10]=l[10],a[c+11]=l[14]}return a}function nJ(e){var t=e._instances,n=e.length,r=4,o=e._instancedColorTypedArray;Cesium.defined(o)||(o=new Float32Array(n*r)),e._dynamic&&(e._instancedColorTypedArray=o);for(var a=0;a<n;++a){var s=t[a]._modelColor,u=a*r;o[u+0]=s.red,o[u+1]=s.green,o[u+2]=s.blue,o[u+3]=e._useInstancedColor?s.alpha:-1}return o}function rJ(e,t){let n,r=e._instances,o=e.length,a=e._dynamic,s=_(e._batchTable);if(s){let c=new Uint16Array(o);for(n=0;n<o;++n)c[n]=r[n]._instanceId;e._batchIdBuffer=ki.createVertexBuffer({context:t,typedArray:c,usage:We.STATIC_DRAW})}if(!s){let c=new Uint8Array(o*4);for(n=0;n<o;++n){let h=e._pickIds[n].color,d=n*4;c[d]=K.floatToByte(h.red),c[d+1]=K.floatToByte(h.green),c[d+2]=K.floatToByte(h.blue),c[d+3]=K.floatToByte(h.alpha)}e._pickIdBuffer=ki.createVertexBuffer({context:t,typedArray:c,usage:We.STATIC_DRAW})}if(e._useInstancedColor){var u=nJ(e);e._instancedColorBuffer=Cesium.Buffer.createVertexBuffer({context:t,typedArray:u,usage:a?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW})}let l=tJ(e);e._vertexBuffer=ki.createVertexBuffer({context:t,typedArray:l,usage:a?We.STREAM_DRAW:We.STATIC_DRAW})}function BDe(e){e._vertexBufferTypedArray=void 0;let t=tJ(e);if(e._vertexBuffer.copyFromArrayView(t),e._useInstancedColor){e._instancedColorTypedArray=void 0;var n=nJ(e);e._instancedColorBuffer.copyFromArrayView(n)}}function iJ(e,t){let n=e._instances,r=n.length,o=new Array(r);for(let a=0;a<r;++a)o[a]=t.createPickId(n[a]);return o}function FDe(e,t){let n=e._instancingSupported;n||nl("cpuModelInstancing","Support for rendering instanced models on the CPU has been deprecated and will be removed in CesiumJS 1.97.");let r=_(e._batchTable),o=e._allowPicking,a={url:e._url,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:e._cacheKey,asynchronous:e._asynchronous,allowPicking:o,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,forwardAxis:e._forwardAxis,precreatedAttributes:void 0,vertexShaderLoaded:void 0,fragmentShaderLoaded:void 0,uniformMapLoaded:void 0,pickIdLoaded:e._pickIdLoaded,ignoreCommands:!0,opaquePass:e._opaquePass,imageBasedLighting:e._imageBasedLighting,showOutline:e.showOutline,showCreditsOnScreen:e.showCreditsOnScreen,useInstancedColor:e._useInstancedColor};if(r||(e._pickIds=iJ(e,t)),n){rJ(e,t);let s=12,u=ie.getSizeInBytes(ie.FLOAT),l={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:u*4,strideInBytes:u*s,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:u*8,strideInBytes:u*s,instanceDivisor:1}};r&&(l.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:ie.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),r||(l.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:ie.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),e._useInstancedColor&&(l.instancedColor={index:0,vertexBuffer:e._instancedColorBuffer,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),e.precreatedAttributes=l,a.precreatedAttributes=l,a.vertexShaderLoaded=IDe(e),a.fragmentShaderLoaded=DDe(e),a.uniformMapLoaded=LDe(e,t),_(e._url)&&(a.cacheKey=`${e._url.getUrlComponent()}#instanced`)}else a.vertexShaderLoaded=RDe(e),a.fragmentShaderLoaded=ODe(e),a.uniformMapLoaded=NDe(e,t);_(e._url)?e._model=wS.fromGltf(a):e._model=new wS(a)}function zDe(e,t){e._vertexBufferTypedArray=void 0,e._instancedColorTypedArray=void 0;var n=Cesium.defined(e._batchTable);if(!n){var r=e._pickIds;if(Cesium.defined(r))for(var o=r.length,a=0;a<o;++a)r[a].destroy();e._pickIds=iJ(e,t)}e._instancingSupported&&(e._batchIdBuffer&&!e._batchIdBuffer.isDestroyed()&&e._batchIdBuffer.destroy(),e._batchIdBuffer=void 0,e._pickIdBuffer&&!e._pickIdBuffer.isDestroyed()&&e._pickIdBuffer.destroy(),e._pickIdBuffer=void 0,e._vertexBuffer&&!e._vertexBuffer.isDestroyed()&&e._vertexBuffer.destroy(),e._vertexBuffer=void 0,e._instancedColorBuffer&&!e._instancedColorBuffer.isDestroyed()&&e._instancedColorBuffer.destroy(),e._instancedColorBuffer=void 0,rJ(e,t),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow0)&&(e.precreatedAttributes.czm_modelMatrixRow0.vertexBuffer=e._vertexBuffer),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow1)&&(e.precreatedAttributes.czm_modelMatrixRow1.vertexBuffer=e._vertexBuffer),Cesium.defined(e.precreatedAttributes.czm_modelMatrixRow2)&&(e.precreatedAttributes.czm_modelMatrixRow2.vertexBuffer=e._vertexBuffer),n&&Cesium.defined(e.precreatedAttributes.a_batchId)&&(e.precreatedAttributes.a_batchId.vertexBuffer=e._batchIdBuffer),!n&&Cesium.defined(e.precreatedAttributes.pickColor)&&(e.precreatedAttributes.pickColor.vertexBuffer=e._pickIdBuffer),e._useInstancedColor&&Cesium.defined(e.precreatedAttributes.instancedColor)&&(e.precreatedAttributes.instancedColor.vertexBuffer=e._instancedColorBuffer))}function VDe(e,t){if(e._debugWireframe!==e.debugWireframe||t){e._debugWireframe=e.debugWireframe;let n=e.debugWireframe?rn.LINES:rn.TRIANGLES,r=e._drawCommands,o=r.length;for(let a=0;a<o;++a)r[a].primitiveType=n}}function kDe(e){let t=kt(e,!0);return t.cull.enabled=!1,un.fromCache(t)}function GDe(e,t){if(e._backFaceCulling!==e.backFaceCulling||t){e._backFaceCulling=e.backFaceCulling;let n=e._drawCommands,r=n.length,o;if(!_(e._disableCullingRenderStates))for(e._disableCullingRenderStates=new Array(r),e._renderStates=new Array(r),o=0;o<r;++o){let a=n[o].renderState,s=kDe(a);e._disableCullingRenderStates[o]=s,e._renderStates[o]=a}for(o=0;o<r;++o)n[o].renderState=e._backFaceCulling?e._renderStates[o]:e._disableCullingRenderStates[o]}}function UDe(e,t){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume||t){e._debugShowBoundingVolume=e.debugShowBoundingVolume;let n=e._drawCommands,r=n.length;for(let o=0;o<r;++o)n[o].debugShowBoundingVolume=e.debugShowBoundingVolume}}function HDe(e,t){let n=t.length,r=e.length,o=e._boundingSphere,a=e._cull;for(let s=0;s<n;++s){let u=Zt.shallowClone(t[s]);u.instanceCount=r,u.boundingVolume=o,u.cull=a,_(e._batchTable)?u.pickId=e._batchTable.getPickId():u.pickId="v_pickColor",e._drawCommands.push(u)}}function qDe(e){return function(){return e}}function WDe(e){return function(){return e}}function YDe(e,t){let n=e._instances,r=t.length,o=e.length,a=e._batchTable,s=_(a),u=e._cull;for(let l=0;l<r;++l)for(let c=0;c<o;++c){let f=Zt.shallowClone(t[l]);if(f.modelMatrix=new U,f.boundingVolume=new Ee,f.cull=u,f.uniformMap=kt(f.uniformMap),s)f.uniformMap.a_batchId=qDe(n[c]._instanceId);else{let h=e._pickIds[c];f.uniformMap.czm_pickColor=WDe(h.color)}e._drawCommands.push(f)}}function oJ(e){let t=e._modelCommands,n=t.length,r=e.length,o=e._rtcTransform,a=e._center;for(let s=0;s<n;++s){let u=t[s];for(let l=0;l<r;++l){let c=s*r+l,f=e._drawCommands[c],h=U.clone(e._instances[l]._modelMatrix,HF);h[12]-=a.x,h[13]-=a.y,h[14]-=a.z,h=U.multiply(o,h,HF);let d=u.modelMatrix,p=f.modelMatrix;U.multiply(h,d,p);let g=u.boundingVolume,y=f.boundingVolume;Ee.transform(g,h,y)}}}function aJ(e){let t=e._nodeCommands,n=t.length,r=[];for(let o=0;o<n;++o){let a=t[o];a.show&&r.push(a.command)}return r}function XDe(e){let t=e._nodeCommands,n=t.length,r=!1;for(let o=0;o<n;o++){let a=t[o];a.command.dirty&&(a.command.dirty=!1,r=!0)}return r}function QQ(e,t){e._drawCommands=[];let n=aJ(e._model);t?HDe(e,n):(YDe(e,n),oJ(e))}function jDe(e,t){if(e.shadows!==e._shadows||t){e._shadows=e.shadows;let n=ro.castShadows(e.shadows),r=ro.receiveShadows(e.shadows),o=e._drawCommands,a=o.length;for(let s=0;s<a;++s){let u=o[s];u.castShadows=n,u.receiveShadows=r}}}jy.prototype.regenerteInstanced=function(e){this._instances=[],this._instances=JQ(this,e)};jy.prototype.update=function(e){if(e.mode===Ne.MORPHING||!this.show||this.length===0)return;let t=e.context;if(this._state===Xy.NEEDS_LOAD){this._state=Xy.LOADING,this._instancingSupported=t.instancedArrays,FDe(this,t);let y=this;this._model.readyPromise.catch(function(v){y._state=Xy.FAILED,y._readyPromise.reject(v)})}let n=this._instancingSupported,r=this._model;r.imageBasedLighting=this._imageBasedLighting,r.showCreditsOnScreen=this.showCreditsOnScreen,r.splitDirection=this.splitDirection;var o=Cesium.Cartesian3.clone(this._center);if(n&&r.ready){this._boundingSphere=$Q(this);var a=r.boundingSphere.radius+Cesium.Cartesian3.magnitude(r.boundingSphere.center);this._boundingSphere.radius+=a,this._center=Cesium.Cartesian3.clone(this._boundingSphere.center)}if(n&&this._instancingRegenertedOnce&&(zDe(this,t),this._instancingRegenertedOnce=!1,r.recreateVertexArraysOnce=!0),r.update(e),r.ready&&this._state===Xy.LOADING){this._state=Xy.LOADED,this._ready=!0;let y=r.boundingSphereInternal.radius+x.magnitude(r.boundingSphereInternal.center);this._boundingSphere.radius+=y,this._modelCommands=aJ(r),QQ(this,n),this._readyPromise.resolve(this);return}if(this._state!==Xy.LOADED)return;let s=e.mode!==this._mode,u=this.modelMatrix,l=!U.equals(this._modelMatrix,u),c=!Cesium.Cartesian3.equals(o,this._center);if(s||l||c){this._mode=e.mode,U.clone(u,this._modelMatrix);let y=U.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);this._mode!==Ne.SCENE3D&&(y=yn.basisTo2D(e.mapProjection,y,y)),U.getTranslation(y,this._boundingSphere.center)}n&&this._dirty&&(this._dynamic=!0,this._dirty=!1,BDe(this));let f=XDe(r);f&&QQ(this,n),!n&&(r.dirty||this._dirty||s||l)&&oJ(this),jDe(this,f),VDe(this,f),GDe(this,f),UDe(this,f);let h=e.passes;if(!h.render&&!h.pick)return;let d=e.commandList,p=this._drawCommands,g=p.length;for(let y=0;y<g;++y)d.push(p[y])};jy.prototype.isDestroyed=function(){return!1};jy.prototype.destroy=function(){this._model=this._model&&this._model.destroy();let e=this._pickIds;if(_(e)){let t=e.length;for(let n=0;n<t;++n)e[n].destroy()}return this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,this._instancingSupported&&(this._batchIdBuffer&&!this._batchIdBuffer.isDestroyed()&&this._batchIdBuffer.destroy(),this._batchIdBuffer=void 0,this._pickIdBuffer&&!this._pickIdBuffer.isDestroyed()&&this._pickIdBuffer.destroy(),this._pickIdBuffer=void 0,this._vertexBuffer&&!this._vertexBuffer.isDestroyed()&&this._vertexBuffer.destroy(),this._vertexBuffer=void 0,this._instancedColorBuffer&&!this._instancedColorBuffer.isDestroyed()&&this._instancedColorBuffer.destroy(),this._instancedColorBuffer=void 0),ot(this)};var xM=jy;function ms(e){this._id=_i();let t=e.featuresLength;this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[];let n,r;if(t>0){let o=Math.min(t,Kt.maximumTextureSize),a=Math.ceil(t/Kt.maximumTextureSize),s=1/o,u=s*.5,l=1/a,c=l*.5;n=new X(o,a),r=new Se(s,u,l,c)}this._translucentFeaturesLength=0,this._featuresLength=t,this._textureDimensions=n,this._textureStep=r,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}Object.defineProperties(ms.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return _(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),_(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}});ms.DEFAULT_COLOR_VALUE=K.WHITE;ms.DEFAULT_SHOW_VALUE=!0;function sJ(e){let t=e._textureDimensions;return t.x*t.y*4}function uJ(e){if(!_(e._batchValues)){let t=sJ(e),n=new Uint8Array(t).fill(255);e._batchValues=n}return e._batchValues}function lJ(e){if(!_(e._showAlphaProperties)){let t=2*e._featuresLength,n=new Uint8Array(t).fill(255);e._showAlphaProperties=n}return e._showAlphaProperties}ms.prototype.setShow=function(e,t){if(t&&!_(this._showAlphaProperties))return;let n=lJ(this),r=e*2,o=t?255:0;if(n[r]!==o){n[r]=o;let a=uJ(this),s=e*4+3;a[s]=t?n[r+1]:0,this._batchValuesDirty=!0}};ms.prototype.setAllShow=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setShow(n,e)};ms.prototype.getShow=function(e){if(!_(this._showAlphaProperties))return!0;let t=e*2;return this._showAlphaProperties[t]===255};var KDe=new Array(4);ms.prototype.setColor=function(e,t){if(K.equals(t,ms.DEFAULT_COLOR_VALUE)&&!_(this._batchValues))return;let n=t.toBytes(KDe),r=n[3],o=uJ(this),a=e*4,s=lJ(this),u=e*2;if(o[a]!==n[0]||o[a+1]!==n[1]||o[a+2]!==n[2]||s[u+1]!==r){o[a]=n[0],o[a+1]=n[1],o[a+2]=n[2];let l=s[u+1]!==255,c=s[u]!==0;o[a+3]=c?r:0,s[u+1]=r;let f=r!==255;f&&!l?++this._translucentFeaturesLength:!f&&l&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,_(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}};ms.prototype.setAllColor=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setColor(n,e)};ms.prototype.getColor=function(e,t){if(!_(this._batchValues))return K.clone(ms.DEFAULT_COLOR_VALUE,t);let n=this._batchValues,r=e*4,o=this._showAlphaProperties,a=e*2;return K.fromBytes(n[r],n[r+1],n[r+2],o[a+1],t)};ms.prototype.getPickColor=function(e){return this._pickIds[e]};function cJ(e,t,n){let r=e._textureDimensions;return new $o({context:t,pixelFormat:Gt.RGBA,pixelDatatype:vt.UNSIGNED_BYTE,source:{width:r.x,height:r.y,arrayBufferView:n},flipY:!1,sampler:La.NEAREST})}function ZDe(e,t){let n=e._featuresLength;if(!_(e._pickTexture)&&n>0){let r=e._pickIds,o=sJ(e),a=new Uint8Array(o),s=e._owner,u=e._statistics;for(let l=0;l<n;++l){let c=t.createPickId(s.getFeature(l));r.push(c);let f=c.color,h=l*4;a[h]=K.floatToByte(f.red),a[h+1]=K.floatToByte(f.green),a[h+2]=K.floatToByte(f.blue),a[h+3]=K.floatToByte(f.alpha)}e._pickTexture=cJ(e,t,a),_(u)&&(u.batchTableByteLength+=e._pickTexture.sizeInBytes)}}function QDe(e){let t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}ms.prototype.update=function(e,t){let n=t.context;this._defaultTexture=n.defaultTexture;let r=t.passes;(r.pick||r.postProcess)&&ZDe(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,_(this._batchTexture)||(this._batchTexture=cJ(this,n,this._batchValues),_(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),QDe(this))};ms.prototype.isDestroyed=function(){return!1};ms.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let e=this._pickIds,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return ot(this)};var JDe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$De={SCALAR:void 0,VEC2:X,VEC3:x,VEC4:Se,MAT2:Ma,MAT3:ne,MAT4:U};function ePe(e){let t=e.componentType,n;typeof t=="string"?n=ie.fromName(t):n=t;let r=JDe[e.type],o=$De[e.type];return{componentsPerAttribute:r,classType:o,createArrayBufferView:function(a,s,u){return ie.createArrayBufferView(n,a,s,r*u)}}}var Ky=ePe;function bd(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,tPe(this,e.extension,e.binaryBody)}Object.defineProperties(bd.prototype,{byteLength:{get:function(){return this._byteLength}}});function tPe(e,t,n){let r,o,a,s=t.instancesLength,u=t.classes,l=t.classIds,c=t.parentCounts,f=t.parentIds,h=s,d=0;_(l.byteOffset)&&(l.componentType=T(l.componentType,ie.UNSIGNED_SHORT),l.type=zc.SCALAR,a=Ky(l),l=a.createArrayBufferView(n.buffer,n.byteOffset+l.byteOffset,s),d+=l.byteLength);let p;if(_(c)){for(_(c.byteOffset)&&(c.componentType=T(c.componentType,ie.UNSIGNED_SHORT),c.type=zc.SCALAR,a=Ky(c),c=a.createArrayBufferView(n.buffer,n.byteOffset+c.byteOffset,s),d+=c.byteLength),p=new Uint16Array(s),h=0,r=0;r<s;++r)p[r]=h,h+=c[r];d+=p.byteLength}_(f)&&_(f.byteOffset)&&(f.componentType=T(f.componentType,ie.UNSIGNED_SHORT),f.type=zc.SCALAR,a=Ky(f),f=a.createArrayBufferView(n.buffer,n.byteOffset+f.byteOffset,h),d+=f.byteLength);let g=u.length;for(r=0;r<g;++r){let w=u[r].length,C=u[r].instances,E=nPe(w,C,n);d+=rPe(E),u[r].instances=Yi(E,C)}let y=new Array(g).fill(0),v=new Uint16Array(s);for(r=0;r<s;++r)o=l[r],v[r]=y[o],++y[o];d+=v.byteLength,e._classes=u,e._classIds=l,e._classIndexes=v,e._parentCounts=c,e._parentIndexes=p,e._parentIds=f,e._byteLength=d}function nPe(e,t,n){let r;for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=a.byteOffset;if(_(s)){let u=a.componentType,l=a.type;if(!_(u))throw new it("componentType is required.");if(!_(l))throw new it("type is required.");if(!_(n))throw new it(`Property ${o} requires a batch table binary.`);let c=Ky(a),f=c.componentsPerAttribute,h=c.classType,d=c.createArrayBufferView(n.buffer,n.byteOffset+s,e);_(r)||(r={}),r[o]={typedArray:d,componentCount:f,type:h}}}return r}function rPe(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}var iPe=[],oPe=[],aPe=0;function sPe(e,t,n){let r=e._classIds,o=e._parentCounts,a=e._parentIds,s=e._parentIndexes,u=r.length,l=iPe;l.length=Math.max(l.length,u);let c=++aPe,f=oPe;for(f.length=0,f.push(t);f.length>0;){if(t=f.pop(),l[t]===c)continue;l[t]=c;let h=n(e,t);if(_(h))return h;let d=o[t],p=s[t];for(let g=0;g<d;++g){let y=a[p+g];y!==t&&f.push(y)}}}function uPe(e,t,n){let r=!0;for(;r;){let o=n(e,t);if(_(o))return o;let a=e._parentIds[t];r=a!==t,t=a}}function ES(e,t,n){let r=e._parentCounts,o=e._parentIds;if(_(o)){if(_(r))return sPe(e,t,n)}else return n(e,t);return uPe(e,t,n)}bd.prototype.hasProperty=function(e,t){let n=ES(this,e,function(r,o){let a=r._classIds[o],s=r._classes[a].instances;if(_(s[t]))return!0});return _(n)};bd.prototype.propertyExists=function(e){let t=this._classes,n=t.length;for(let r=0;r<n;++r){let o=t[r].instances;if(_(o[e]))return!0}return!1};bd.prototype.getPropertyIds=function(e,t){return t=_(t)?t:[],t.length=0,ES(this,e,function(n,r){let o=n._classIds[r],a=n._classes[o].instances;for(let s in a)a.hasOwnProperty(s)&&t.indexOf(s)===-1&&t.push(s)}),t};bd.prototype.getProperty=function(e,t){return ES(this,e,function(n,r){let o=n._classIds[r],a=n._classes[o],s=n._classIndexes[r],u=a.instances[t];if(_(u))return _(u.typedArray)?lPe(u,s):kt(u[s],!0)})};function lPe(e,t){let n=e.typedArray,r=e.componentCount;return r===1?n[t]:e.type.unpack(n,t*r)}bd.prototype.setProperty=function(e,t,n){let r=ES(this,e,function(o,a){let s=o._classIds[a],u=o._classes[s],l=o._classIndexes[a],c=u.instances[t];if(_(c))return _(c.typedArray)?cPe(c,l,n):c[l]=kt(n,!0),!0});return _(r)};function cPe(e,t,n){let r=e.typedArray,o=e.componentCount;o===1?r[t]=n:e.type.pack(n,r,t*o)}bd.prototype.isClass=function(e,t){let n=ES(this,e,function(r,o){let a=r._classIds[o];if(r._classes[a].name===t)return!0});return _(n)};bd.prototype.getClassName=function(e){let t=this._classIds[e];return this._classes[t].name};var fPe={HIGHLIGHT:0,REPLACE:1,MIX:2},wM=Object.freeze(fPe);var qF=ms.DEFAULT_COLOR_VALUE,WF=ms.DEFAULT_SHOW_VALUE;function Oi(e,t,n,r,o){this.featuresLength=t;let a;_(n)&&(a=n.extensions),this._extensions=T(a,{});let s=hPe(n);this._properties=s,this._batchTableHierarchy=dPe(this,n,r);let u=hJ(t,s,r);this._binaryPropertiesByteLength=pPe(u),this._batchTableBinaryProperties=u,this._content=e,this._batchTexture=new ms({featuresLength:t,colorChangedCallback:o,owner:e,statistics:e.tileset.statistics})}Oi._deprecationWarning=nl;Object.defineProperties(Oi.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return _(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}});function hPe(e){let t={};if(!_(e))return t;for(let n in e)e.hasOwnProperty(n)&&n!=="HIERARCHY"&&n!=="extensions"&&n!=="extras"&&(t[n]=kt(e[n],!0));return t}function dPe(e,t,n){if(!_(t))return;let r=e._extensions["3DTILES_batch_table_hierarchy"],o=t.HIERARCHY;if(_(o)&&(Oi._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=o,r=o),!!_(r))return new bd({extension:r,binaryBody:n})}function hJ(e,t,n){let r;for(let o in t)if(t.hasOwnProperty(o)){let a=t[o],s=a.byteOffset;if(_(s)){let u=a.componentType,l=a.type;if(!_(u))throw new it("componentType is required.");if(!_(l))throw new it("type is required.");if(!_(n))throw new it(`Property ${o} requires a batch table binary.`);let c=Ky(a),f=c.componentsPerAttribute,h=c.classType,d=c.createArrayBufferView(n.buffer,n.byteOffset+s,e);_(r)||(r={}),r[o]={typedArray:d,componentCount:f,type:h}}}return r}function pPe(e){if(!_(e))return 0;let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}Oi.getBinaryProperties=function(e,t,n){return hJ(e,t,n)};Oi.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)};Oi.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)};Oi.prototype.getShow=function(e){return this._batchTexture.getShow(e)};Oi.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)};Oi.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)};Oi.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)};Oi.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};var mPe=new K;Oi.prototype.applyStyle=function(e){if(!_(e)){this.setAllColor(qF),this.setAllShow(WF);return}let t=this._content,n=this.featuresLength;for(let r=0;r<n;++r){let o=t.getFeature(r),a=_(e.color)?T(e.color.evaluateColor(o,mPe),qF):qF,s=_(e.show)?T(e.show.evaluate(o),WF):WF;this.setColor(r,a),this.setShow(r,s)}};function gPe(e,t){let n=e.typedArray,r=e.componentCount;return r===1?n[t]:e.type.unpack(n,t*r)}function _Pe(e,t,n){let r=e.typedArray,o=e.componentCount;o===1?r[t]=n:e.type.pack(n,r,t*o)}Oi.prototype.isClass=function(e,t){let n=this._batchTableHierarchy;return _(n)?n.isClass(e,t):!1};Oi.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t};Oi.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(!!_(t))return t.getClassName(e)};Oi.prototype.hasProperty=function(e,t){return _(this._properties[t])||_(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)};Oi.prototype.hasPropertyBySemantic=function(){return!1};Oi.prototype.getPropertyIds=function(e,t){t=_(t)?t:[],t.length=0;let n=Object.keys(this._properties);return t.push.apply(t,n),_(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,n)),t};Oi.prototype.getPropertyBySemantic=function(e,t){};Oi.prototype.getProperty=function(e,t){if(_(this._batchTableBinaryProperties)){let r=this._batchTableBinaryProperties[t];if(_(r))return gPe(r,e)}let n=this._properties[t];if(_(n))return kt(n[e],!0);if(_(this._batchTableHierarchy)){let r=this._batchTableHierarchy.getProperty(e,t);if(_(r))return r}};Oi.prototype.setProperty=function(e,t,n){let r=this.featuresLength;if(_(this._batchTableBinaryProperties)){let a=this._batchTableBinaryProperties[t];if(_(a)){_Pe(a,e,n);return}}if(_(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))return;let o=this._properties[t];_(o)||(this._properties[t]=new Array(r),o=this._properties[t]),o[e]=kt(n,!0)};function yPe(e){return e._batchTexture.textureDimensions.y===1?`uniform vec4 tile_textureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    return vec2(centerX + (batchId * stepX), 0.5); 
} 
`:`uniform vec4 tile_textureStep; 
uniform vec2 tile_textureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    float stepY = tile_textureStep.z; 
    float centerY = tile_textureStep.w; 
    float xId = mod(batchId, tile_textureDimensions.x); 
    float yId = floor(batchId / tile_textureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}Oi.prototype.getVertexShaderCallback=function(e,t,n){if(this.featuresLength===0)return;let r=this;return function(o){let a=dJ(o,n,!1),s;return Kt.maximumVertexTextureImageUnits>0?(s="",e&&(s+=`uniform bool tile_translucentCommand; 
`),s+=`uniform sampler2D tile_batchTexture; 
varying vec4 tile_featureColor; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec2 st = computeSt(${t}); 
    vec4 featureProperties = texture2D(tile_batchTexture, st); 
    tile_color(featureProperties); 
    float show = ceil(featureProperties.a); 
    gl_Position *= show; 
`,e&&(s+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
`),s+=`    tile_featureColor = featureProperties; 
    tile_featureSt = st; 
}`):s=`varying vec2 tile_featureSt; 
void main() 
{ 
    tile_color(vec4(1.0)); 
    tile_featureSt = computeSt(${t}); 
}`,`${a}
${yPe(r)}${s}`}};function fJ(e,t){return e=xt.replaceMain(e,"tile_main"),t?`${e}uniform float tile_colorBlend; 
void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
} 
`:`${e}void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
} 
`}function vPe(e,t){let n=`texture2D(${t}`,r=0,o=e.indexOf(n,r),a;for(;o>-1;){let s=0;for(let c=o;c<e.length;++c){let f=e.charAt(c);if(f==="(")++s;else if(f===")"&&(--s,s===0)){a=c+1;break}}let l=`tile_diffuse_final(${e.slice(o,a)}, tile_diffuse)`;e=e.slice(0,o)+l+e.slice(a),r=o+l.length,o=e.indexOf(n,r)}return e}function dJ(e,t,n){if(!_(t))return fJ(e,n);let r=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${t};`),o=e.match(r);if(!_(o))return fJ(e,n);let a=o[0],s=o[2];e=xt.replaceMain(e,"tile_main"),e=e.replace(a,"");let u=`bool isWhite(vec3 color) 
{ 
    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); 
} 
vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) 
{ 
    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); 
    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; 
    return vec4(diffuse.rgb, sourceDiffuse.a); 
} 
`,l=`    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
`,c;if(s==="vec3"||s==="vec4"){let f=s==="vec3"?`vec4(${t}, 1.0)`:t,h=s==="vec3"?"tile_diffuse.xyz":"tile_diffuse";r=new RegExp(t,"g"),e=e.replace(r,h),c=`    vec4 source = ${f}; 
    tile_diffuse = tile_diffuse_final(source, tile_featureColor); 
    tile_main(); 
`}else s==="sampler2D"&&(e=vPe(e,t),c=`    tile_diffuse = tile_featureColor; 
    tile_main(); 
`);return e=`uniform float tile_colorBlend; 
vec4 tile_diffuse = vec4(1.0); 
${u}${a}
${e}
void tile_color(vec4 tile_featureColor) 
{ 
${c}`,n&&(e+=l),e+=`} 
`,e}Oi.prototype.getFragmentShaderCallback=function(e,t,n){if(this.featuresLength!==0)return function(r){return r=dJ(r,t,!0),Kt.maximumVertexTextureImageUnits>0?(r+=`uniform sampler2D tile_pickTexture; 
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_color(tile_featureColor); 
`,n&&(r+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),r+="}"):(e&&(r+=`uniform bool tile_translucentCommand; 
`),r+=`uniform sampler2D tile_pickTexture; 
uniform sampler2D tile_batchTexture; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
`,e&&(r+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            discard; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            discard; 
        } 
    } 
`),r+=`    tile_color(featureProperties); 
`,n&&(r+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),r+=`} 
`),r}};Oi.prototype.getClassificationFragmentShaderCallback=function(){if(this.featuresLength!==0)return function(e){return e=xt.replaceMain(e,"tile_main"),Kt.maximumVertexTextureImageUnits>0?e+=`uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_main(); 
    gl_FragColor = tile_featureColor; 
    gl_FragColor.rgb *= gl_FragColor.a; 
}`:e+=`uniform sampler2D tile_batchTexture; 
uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
void main() 
{ 
    tile_main(); 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
    gl_FragColor = featureProperties; 
    gl_FragColor.rgb *= gl_FragColor.a; 
} 
`,e}};function CPe(e){let t=e._content.tileset,n=Cesium.defined(t)&&Cesium.defined(t.colorBlendMode)?t.colorBlendMode:Cesium.Cesium3DTileColorBlendMode.REPLACE,r=Cesium.defined(t)&&Cesium.defined(t.colorBlendAmount)?t.colorBlendAmount:.5;if(n===wM.HIGHLIGHT)return 0;if(n===wM.REPLACE)return 1;if(n===wM.MIX)return z.clamp(r,z.EPSILON4,1)}Oi.prototype.getUniformMapCallback=function(){if(this.featuresLength===0)return;let e=this;return function(t){return Yi(t,{tile_batchTexture:function(){return T(e._batchTexture.batchTexture,e._batchTexture.defaultTexture)},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return CPe(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}})}};Oi.prototype.getPickId=function(){return"texture2D(tile_pickTexture, tile_featureSt)"};var cf={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};Oi.prototype.addDerivedCommands=function(e,t){let n=e.commandList,r=n.length,o=this._content._tile,a=o._finalResolution,s=o.tileset,u=s._skipLevelOfDetail&&s._hasMixedContent&&e.context.stencilBuffer,l=pJ(this);for(let c=t;c<r;++c){let f=n[c];if(f.pass===Qt.COMPUTE)continue;let h=f.derivedCommands.tileset;(!_(h)||f.dirty)&&(h={},f.derivedCommands.tileset=h,h.originalCommand=mJ(f),f.dirty=!1);let d=h.originalCommand;l!==cf.ALL_OPAQUE&&f.pass!==Qt.TRANSLUCENT&&(_(h.translucent)||(h.translucent=gJ(d))),l!==cf.ALL_TRANSLUCENT&&f.pass!==Qt.TRANSLUCENT&&(_(h.opaque)||(h.opaque=_J(d)),u&&(a||(_(h.zback)||(h.zback=yJ(e.context,d)),s._backfaceCommands.push(h.zback)),(!_(h.stencil)||o._selectionDepth!==CJ(h.stencil))&&(f.renderState.depthMask?h.stencil=vJ(d,o._selectionDepth):h.stencil=h.opaque)));let p=u?h.stencil:h.opaque,g=h.translucent;f.pass!==Qt.TRANSLUCENT?(l===cf.ALL_OPAQUE&&(n[c]=p),l===cf.ALL_TRANSLUCENT&&(n[c]=g),l===cf.OPAQUE_AND_TRANSLUCENT&&(n[c]=p,n.push(g))):n[c]=d}};Oi.prototype.addDerivedCommandsNoTileset=function(e,t){let n=e.commandList,r=n.length,o=!1,a=pJ(this);for(let s=t;s<r;++s){let u=n[s];if(u.pass===Qt.COMPUTE)continue;let l=u.derivedCommands.tileset;(!_(l)||u.dirty)&&(l={},u.derivedCommands.tileset=l,l.originalCommand=mJ(u),u.dirty=!1);let c=l.originalCommand;a!==cf.ALL_OPAQUE&&u.pass!==Qt.TRANSLUCENT&&(_(l.translucent)||(l.translucent=gJ(c))),a!==cf.ALL_TRANSLUCENT&&u.pass!==Qt.TRANSLUCENT&&(_(l.opaque)||(l.opaque=_J(c)),o&&(finalResolution||(_(l.zback)||(l.zback=yJ(e.context,c)),tileset._backfaceCommands.push(l.zback)),(!_(l.stencil)||tile._selectionDepth!==CJ(l.stencil))&&(u.renderState.depthMask?l.stencil=vJ(c,tile._selectionDepth):l.stencil=l.opaque)));let f=o?l.stencil:l.opaque,h=l.translucent;u.pass!==Qt.TRANSLUCENT?(a===cf.ALL_OPAQUE&&(n[s]=f),a===cf.ALL_TRANSLUCENT&&(n[s]=h),a===cf.OPAQUE_AND_TRANSLUCENT&&(n[s]=f,n.push(h))):n[s]=c}};function pJ(e){let t=e._batchTexture.translucentFeaturesLength;return t===0?cf.ALL_OPAQUE:t===e.featuresLength?cf.ALL_TRANSLUCENT:cf.OPAQUE_AND_TRANSLUCENT}function mJ(e){let t=Zt.shallowClone(e),n=t.pass===Qt.TRANSLUCENT;return t.uniformMap=_(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return n},t}function gJ(e){let t=Zt.shallowClone(e);return t.pass=Qt.TRANSLUCENT,t.renderState=wPe(e.renderState),t}function _J(e){let t=Zt.shallowClone(e);return t.renderState=EPe(e.renderState),t}function xPe(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!_(n)){let r=t.fragmentShaderSource.clone();r.defines=_(r.defines)?r.defines.slice(0):[],r.defines.push("POLYGON_OFFSET"),r.sources.unshift(`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
`),n=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:r,attributeLocations:t._attributeLocations})}return n}function yJ(e,t){let n=Zt.shallowClone(t),r=kt(n.renderState,!0);r.cull.enabled=!0,r.cull.face=rd.FRONT,r.colorMask={red:!1,green:!1,blue:!1,alpha:!1},r.polygonOffset={enabled:!0,factor:5,units:5},r.stencilTest=io.setCesium3DTileBit(),r.stencilMask=io.CESIUM_3D_TILE_MASK,n.renderState=un.fromCache(r),n.castShadows=!1,n.receiveShadows=!1,n.uniformMap=kt(t.uniformMap);let o=new X(5,5);return n.uniformMap.u_polygonOffset=function(){return o},n.shaderProgram=xPe(e,t.shaderProgram),n}function vJ(e,t){let n=Zt.shallowClone(e),r=kt(n.renderState,!0);return r.stencilTest.enabled=!0,r.stencilTest.mask=io.SKIP_LOD_MASK,r.stencilTest.reference=io.CESIUM_3D_TILE_MASK|t<<io.SKIP_LOD_BIT_SHIFT,r.stencilTest.frontFunction=tl.GREATER_OR_EQUAL,r.stencilTest.frontOperation.zPass=Kr.REPLACE,r.stencilTest.backFunction=tl.GREATER_OR_EQUAL,r.stencilTest.backOperation.zPass=Kr.REPLACE,r.stencilMask=io.CESIUM_3D_TILE_MASK|io.SKIP_LOD_MASK,n.renderState=un.fromCache(r),n}function CJ(e){return(e.renderState.stencilTest.reference&io.SKIP_LOD_MASK)>>>io.SKIP_LOD_BIT_SHIFT}function wPe(e){let t=kt(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=za.ALPHA_BLEND,t.stencilTest=io.setCesium3DTileBit(),t.stencilMask=io.CESIUM_3D_TILE_MASK,un.fromCache(t)}function EPe(e){let t=kt(e,!0);return t.stencilTest=io.setCesium3DTileBit(),t.stencilMask=io.CESIUM_3D_TILE_MASK,un.fromCache(t)}Oi.prototype.update=function(e,t){this._batchTexture.update(e,t)};Oi.prototype.isDestroyed=function(){return!1};Oi.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),ot(this)};var TS=Oi;function Vp(e,t){t=Cesium.defaultValue(t,Cesium.defaultValue.EMPTY_OBJECT),this._tileset=e,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this._blUpdate=!0,this._useInstancedColor=Cesium.defaultValue(t.useInstancedColor,!1),this._cacheInstances=Cesium.defaultValue(t.instances,[]);for(var n=[],r=0;r<this._cacheInstances.length;r++)n.push(this._cacheInstances[r].name);this._batchTable=new TS(this,this._cacheInstances.length,{name:n});var o={batchTable:this._batchTable,instances:this._cacheInstances,cacheKey:t.cacheKey,dynamic:!0,cull:!1,url:void 0,requestType:Cesium.RequestType.TILES3D,gltf:t.gltf,basePath:t.uri,incrementallyLoadTextures:!1,upAxis:Cesium.Axis.Y,forwardAxis:Cesium.Axis.Z,opaquePass:Cesium.Pass.CESIUM_3D_TILE,debugShowBoundingVolume:!1,useInstancedColor:this._useInstancedColor};this._modelInstanceCollection=new xM(o)}Object.defineProperties(Vp.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},ready:{get:function(){return this._modelInstanceCollection.ready}},batchTable:{get:function(){return this._batchTable}},model:{get:function(){return Cesium.defined(this._modelInstanceCollection)?this._modelInstanceCollection._model:void 0}},tileset:{get:function(){return this._tileset}},useInstancedColor:{get:function(){return this._useInstancedColor},set:function(e){this._useInstancedColor=e,Cesium.defined(this._modelInstanceCollection)&&(this._modelInstanceCollection._useInstancedColor=e)}}});Vp.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)};Vp.prototype.getFeature=function(e){var t=this.featuresLength;return TPe(this),this._features[e]};function TPe(e){var t=e.featuresLength;if(!Cesium.defined(e._features)&&t>0){for(var n=new Array(t),r=0;r<t;++r)n[r]=new Cesium.Cesium3DTileFeature(e,r);e._features=n}}Vp.prototype.applyDebugSettings=function(e,t){t=e?t:Cesium.Color.WHITE,this._batchTable.setAllColor(t)};Vp.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)};Vp.prototype.regenerteInstanced=function(e){var t=!1,n=[];this._cacheInstances.length<e.length&&(t=!0);for(var r=!1,o=0;o<e.length;o++)this._cacheInstances.length>=e.length&&(this._cacheInstances[o].name!=e[o].name||!Cesium.Color.equals(this._cacheInstances[o].modelColor,e[o].modelColor))&&(t=!0),e[o].visible&&(r=!0),n.push(e[o].name);this._blUpdate=r,t?(this._cacheInstances=e,this._features=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._batchTable=new TS(this,e.length,{name:n}),this._modelInstanceCollection._batchTable=this._batchTable,this._modelInstanceCollection.instancingRegenertedOnce=!0):(this._cacheInstances=e,this._modelInstanceCollection.dirty=!0),this._modelInstanceCollection.regenerteInstanced(e)};Vp.prototype.update=function(e){if(!!this._blUpdate){var t=e.commandList.length;this._batchTable.update(this,e),this._modelInstanceCollection.update(e);var n=e.commandList.length;t<n&&(e.passes.render||e.passes.pick)&&this._modelInstanceCollection._batchTable.addDerivedCommandsNoTileset(e,t)}};Vp.prototype.isDestroyed=function(){return!1};Vp.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Cesium.destroyObject(this)};var Id=Vp;function $1(e){this.geometry=void 0,this.blUpdateVAO=!1,this.blDestroyVAO=!1,this.tracesLength=0,this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1})})}Object.defineProperties($1.prototype,{});var SPe=new Gc("createTraceWallVertices",1);function APe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function bPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}$1.prototype.recreateVertexArrays=function(e){var t=e.length;if(this.tracesLength=t,e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)Cesium.defined(e[r])&&e[r].wallVisible&&e[r].trackPoints.length>1&&n.push({color:e[r].wallColor,trackPoints:e[r].trackPoints});if(n.length>0){var o=SPe.scheduleTask({traceWalls:n});if(!Cesium.defined(o)){n=[];return}var a=this;Cesium.when(o).then(function(s){var u=new Cesium.GeometryAttributes;u.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float64Array(s.positionBuffer)}),u.pickColor=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:new Uint8Array(s.colorBuffer),normalize:!0}),a.geometry=new Cesium.Geometry({attributes:u,indices:Cesium.IndexDatatype.createTypedArray(u.position.values.length/3,s.indices),boundingSphere:new Cesium.BoundingSphere(s.boundingSphere.center,s.boundingSphere.radius)}),a.blUpdateVAO=!0})}else this.blDestroyVAO=!0}else this.blDestroyVAO=!0};$1.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.geometry)){if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&(this.blUpdateVAO||this.blDestroyVAO)&&n.vertexArray.destroy(),this.blUpdateVAO&&(n.vertexArray=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:Cesium.GeometryPipeline.createAttributeLocations(this.geometry),bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),n._boundingVolume=this.geometry.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:APe(),fragmentShaderSource:bPe()}))),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1,this.blDestroyVAO=!1}};$1.prototype.isDestroyed=function(){return!1};$1.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var EM=$1;function ex(e){this.blUpdateVAO=!1,this.barMesh=void 0,this.boundingSphere=new Cesium.BoundingSphere,this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1})})}Object.defineProperties(ex.prototype,{});function IPe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function DPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}ex.prototype.recreateVertexArrays=function(e){var t=e.length;if(e instanceof Array&&t>0){for(var n=[],r=0;r<t;r++)if(Cesium.defined(e[r])&&e[r].barVisible&&e[r].barPoints.length>1)for(var o=0;o<e[r].barPoints.length;o++)n.push({pos:e[r].barPoints[o].wcPosition,color:e[r].barColor});if(n.length>0){this.boundingSphere=new Cesium.BoundingSphere;for(var a=n.length*2,s=a,u=Cesium.IndexDatatype.createTypedArray(a,s),l=new Float64Array(a*3),c=new Uint8Array(a*4),f=0;f<n.length;f++){l[f*6+0]=n[f].pos.x,l[f*6+1]=n[f].pos.y,l[f*6+2]=n[f].pos.z;var h=Cesium.Cartographic.fromCartesian(n[f].pos),d=Cesium.Cartesian3.fromRadians(h.longitude,h.latitude);l[f*6+3]=d.x,l[f*6+4]=d.y,l[f*6+5]=d.z,c[f*8+0]=Cesium.Color.floatToByte(n[f].color.red),c[f*8+1]=Cesium.Color.floatToByte(n[f].color.green),c[f*8+2]=Cesium.Color.floatToByte(n[f].color.blue),c[f*8+3]=Cesium.Color.floatToByte(n[f].color.alpha),c[f*8+4]=Cesium.Color.floatToByte(n[f].color.red),c[f*8+5]=Cesium.Color.floatToByte(n[f].color.green),c[f*8+6]=Cesium.Color.floatToByte(n[f].color.blue),c[f*8+7]=Cesium.Color.floatToByte(n[f].color.alpha),this.boundingSphere=Cesium.BoundingSphere.expand(this.boundingSphere,n[f].pos),this.boundingSphere=Cesium.BoundingSphere.expand(this.boundingSphere,d)}for(var o=0;o<s;o++)u[o]=o;this.barMesh={position:l,color:c,indices:u},this.blUpdateVAO=!0}}};ex.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(!!Cesium.defined(this.barMesh)){if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.barMesh.position),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.barMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.barMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.barMesh.position.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:IPe(),fragmentShaderSource:DPe()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1}};ex.prototype.isDestroyed=function(){return!1};ex.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var TM=ex;function SS(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.scene=e.scene,this.geometry=void 0,this.blUpdateVAO=!1,this.extentBox=Cesium.defaultValue(e.extentBox,new Cesium.Cartesian3(2,2,2)),this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:!0,depthMask:!1})})}SS.prototype.recreateVertexArrays=function(e){var t=e.length;if(e instanceof Array&&t>0){for(var n=t*8,r=t*36,o=Cesium.IndexDatatype.createTypedArray(n,r),a=new Cesium.BoundingSphere(new Cesium.Cartesian3(0,0,0),6378137),s=new Float32Array(n*3),u=new Uint8Array(n*4),l=0,c=0,f=0;f<t;f++){for(var h=PPe(e[f].modelMatrix,e[f].boxGeometry,this.extentBox),d=0;d<h.length;d++)s[l++]=h[d].x,s[l++]=h[d].y,s[l++]=h[d].z,u[c++]=Cesium.Color.floatToByte(e[f].color.red),u[c++]=Cesium.Color.floatToByte(e[f].color.green),u[c++]=Cesium.Color.floatToByte(e[f].color.blue),u[c++]=Cesium.Color.floatToByte(e[f].color.alpha);o[f*36+0]=f*8+0,o[f*36+1]=f*8+1,o[f*36+2]=f*8+3,o[f*36+3]=f*8+1,o[f*36+4]=f*8+2,o[f*36+5]=f*8+3,o[f*36+6]=f*8+7,o[f*36+7]=f*8+6,o[f*36+8]=f*8+4,o[f*36+9]=f*8+6,o[f*36+10]=f*8+5,o[f*36+11]=f*8+4,o[f*36+12]=f*8+3,o[f*36+13]=f*8+2,o[f*36+14]=f*8+6,o[f*36+15]=f*8+3,o[f*36+16]=f*8+6,o[f*36+17]=f*8+7,o[f*36+18]=f*8+0,o[f*36+19]=f*8+4,o[f*36+20]=f*8+5,o[f*36+21]=f*8+0,o[f*36+22]=f*8+5,o[f*36+23]=f*8+1,o[f*36+24]=f*8+3,o[f*36+25]=f*8+7,o[f*36+26]=f*8+4,o[f*36+27]=f*8+3,o[f*36+28]=f*8+4,o[f*36+29]=f*8+0,o[f*36+30]=f*8+2,o[f*36+31]=f*8+1,o[f*36+32]=f*8+5,o[f*36+33]=f*8+2,o[f*36+34]=f*8+5,o[f*36+35]=f*8+6}var p=new Cesium.GeometryAttributes;p.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:s}),p.pickColor=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:u,normalize:!0}),this.geometry=new Cesium.Geometry({attributes:p,indices:o,boundingSphere:a}),this.blUpdateVAO=!0}};var wn=new x,uOt=new x;function PPe(e,t,n){var r=[],o=Cesium.Cartesian3.subtract(t._minimum,n,new Cesium.Cartesian3),a=Cesium.Cartesian3.add(t._maximum,n,new Cesium.Cartesian3);return wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,a.y,o.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,o.y,o.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,o.y,a.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(a.x,a.y,a.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,a.y,o.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,o.y,o.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,o.y,a.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),wn=Cesium.Matrix4.multiplyByPoint(e,new Cesium.Cartesian3(o.x,a.y,a.z),wn),r.push({x:wn.x,y:wn.y,z:wn.z}),r}SS.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&(n.vertexArray=Cesium.VertexArray.fromGeometry({context:t,geometry:this.geometry,attributeLocations:Cesium.GeometryPipeline.createAttributeLocations(this.geometry),bufferUsage:Cesium.BufferUsage.STATIC_DRAW}),n._boundingVolume=this.geometry.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:MPe(),fragmentShaderSource:LPe()}))),Cesium.defined(n.vertexArray)){var o=e.commandList;o.push(n)}this.blUpdateVAO=!1};function MPe(){var e=`attribute vec3 position;
attribute vec4 color; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    gl_Position = czm_viewProjection * vec4(position, 1.0);
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function LPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}SS.prototype.isDestroyed=function(){return!1};SS.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};var SM=SS;function tx(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.geometry=void 0,this.blUpdateVAO=!1,this.boundingSphere=void 0,this._mode=void 0;var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL}}),uniformMap:{}})}Object.defineProperties(tx.prototype,{});var xJ=new ce,YF=new ei;tx.prototype.recreateVertexArrays=function(e,t){this._mode=t.mode;var n=t.mapProjection,r=e.length,o=0,a=0,s=[];if(e instanceof Array&&r>0){for(var u=0;u<r;u++)Cesium.defined(e[u])&&e[u].lineVisible&&e[u].trackPoints.length>1&&(o+=(e[u].trackPoints.length-1)*2,a+=e[u].trackPoints.length,s.push(e[u]));if(s.length==0)return;for(var l=Cesium.IndexDatatype.createTypedArray(a,o),c=new Float32Array(a*3),f=new Float32Array(a*3),h=new Uint8Array(a*4),d=[],p=0,g=0,y=0;y<s.length;y++){for(var v=s[y].lineColor,w=0;w<s[y].trackPoints.length;w++){var C=s[y].trackPoints[w],E=void 0;w<s[y].trackPoints.length-1&&(l[p++]=g+w,l[p++]=g+w+1,E=s[y].trackPoints[w+1]);var S=C.wcPosition;if(this._mode==Cesium.SceneMode.SCENE2D){if(S=n.project(n.ellipsoid.cartesianToCartographic(C.wcPosition,xJ)),S.z=0,Cesium.defined(E)){var A=n.project(n.ellipsoid.cartesianToCartographic(E.wcPosition,xJ));(S.x>0&&A.x<0||S.x<0&&A.x>0)&&(l[p-1]=g+w)}d.push(new Cesium.Cartesian3(S.z,S.x,S.y))}else d.push(C.wcPosition);Cesium.EncodedCartesian3.fromCartesian(S,YF);var D=YF.high,P=YF.low;c[(g+w)*3]=D.x,c[(g+w)*3+1]=D.y,c[(g+w)*3+2]=D.z,f[(g+w)*3]=P.x,f[(g+w)*3+1]=P.y,f[(g+w)*3+2]=P.z,h[(g+w)*4]=Cesium.Color.floatToByte(v.red),h[(g+w)*4+1]=Cesium.Color.floatToByte(v.green),h[(g+w)*4+2]=Cesium.Color.floatToByte(v.blue),h[(g+w)*4+3]=Cesium.Color.floatToByte(v.alpha)}g+=s[y].trackPoints.length}this.traceMesh={position3DHigh:c,position3DLow:f,color:h,indices:l},this.boundingSphere=new Cesium.BoundingSphere.fromPoints(d),this.blUpdateVAO=!0}};tx.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&Cesium.defined(this.traceMesh)){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.UNSIGNED_BYTE,this.traceMesh.color),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.traceMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.traceMesh.position3DHigh.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:RPe(),fragmentShaderSource:OPe()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};tx.prototype.isDestroyed=function(){return!1};tx.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function RPe(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec4 color;
varying vec4  v_colour;
void main()
{
   v_colour = color; 
   vec4 p;
   if(czm_morphTime == 1.0){
    p = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
   }else if(czm_morphTime == 0.0){
    p = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
   }else{
    p = czm_columbusViewMorph(
    czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
    czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
    czm_morphTime);
   }
   vec4 positionEC = czm_modelViewRelativeToEye * p;
   gl_Position = czm_projection * positionEC;
   #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
   #endif
}
`;return e}function OPe(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var AM=tx;function XF(){this.modelType=void 0,this.modelCollection=void 0,this.iconCollection=void 0,this.cacheIconUri=void 0,this.cacheIcon=void 0,this.instancesPerFrame=[],this.modelIconsPerFrame=[],this.modelLabelPerFrame=[],this.modelLabelPullWirePerFrame=[],this.modelTracePerFrame=[],this.modelBoundingboxPerFrame=[],this.modelSectorsPerFrame=[]}function mh(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("new EV_MovingTargetVisualizer object  viewer of options is empty!");this._viewer=e.viewer,this._scene=this._viewer.scene,this._useInstancedColor=Cesium.defaultValue(e.useInstancedColor,!1),this._statistics=new Cesium.Cesium3DTilesetStatistics,this.mtVisualDatas=new Cesium.AssociativeArray,this.modifiedModels=new Cesium.AssociativeArray,this.modelRibbonCollection=new cC,this.modelTraceWallCollection=new EM,this.modelTraceBarCollection=new TM,this.modelLabelCollection=new Cesium.LabelCollection({scene:this._scene}),this._modelLabelPullWireCollection=new BP({scene:this._scene}),this.modelBoundingBoxCollection=new SM({scene:this._scene}),this.modelTraceLineCollection=new AM({viewer:this._viewer}),this.modelSectorRadarCollection=void 0}Object.defineProperties(mh.prototype,{modelLabelPullWireCollection:{get:function(){return this._modelLabelPullWireCollection}}});function NPe(e,t){var n=e,r=t.modelUri,o=t.modelType,a=t.keyName,s=Cesium.defaultValue(t.instances,[]),u=void 0;if(n.mtVisualDatas.contains(a)?u=n.mtVisualDatas.get(a):(u=new XF,u.modelType=t.modelType,n.mtVisualDatas.set(a,u)),!!Cesium.defined(r)){var l=Cesium.Resource.createIfNeeded(r),c=Cesium.defaultValue(t.basePath,l.clone()),f=Cesium.Resource.createIfNeeded(c);l.fetchArrayBuffer().then(function(h){var d=new Uint8Array(h),p=void 0;if(wJ(d))p=V1(d);else{var g=Cesium.getStringFromTypedArray(d);p=JSON.parse(g)}var y=r.split("/").length,v=y>0?a+r.split("/")[y-1]:a;u.modelCollection=new Id(n,{instances:s,cacheKey:v,gltf:p,uri:r,useInstancedColor:n._useInstancedColor})}).catch()}}function BPe(e,t){var n=e,r=t.modelType,o=t.modelIconUri,a=t.keyName,s=Cesium.defaultValue(t.iconInstances,[]),u=void 0;if(n.mtVisualDatas.contains(a)?u=n.mtVisualDatas.get(a):(u=new XF,u.modelType=t.modelType,u.cacheIconUri=o,n.mtVisualDatas.set(a,u)),!Cesium.defined(u))throw new Cesium.DeveloperError("creat Moving Target Icon  Data is empty!.");Cesium.defined(u.cacheIcon)?u.iconCollection=new Zw({scene:n._scene}):Cesium.Resource.fetchImage(o).then(function(l){u.iconCollection=new Zw({scene:n._scene}),u.cacheIcon=l;for(var c=0;c<s;c++)u.iconCollection.add(s[c])})}mh.prototype.add=function(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.keyName)||e.keyName=="")throw new Cesium.DeveloperError("options of keyName  is empty!");NPe(this,e),Cesium.defined(e.modelIconUri)&&BPe(this,e);var t=e.keyName,n=void 0;this.mtVisualDatas.contains(t)?n=this.mtVisualDatas.get(t):(n=new XF,n.modelType=e.modelType,this.mtVisualDatas.set(t,n))};mh.prototype.modifiedLoadedModel=function(e,t){var n=this,r=void 0,o=void 0;for(r in this.mtVisualDatas._hash){var a=this.mtVisualDatas.get(r);if(a.modelType===e){o=a;break}}if(o){var s=Cesium.Resource.createIfNeeded(t);s.fetchArrayBuffer().then(function(u){var l=new Uint8Array(u),c=void 0;if(wJ(l))c=V1(l);else{var f=Cesium.getStringFromTypedArray(l);c=JSON.parse(f)}var h=[{batchId:0,modelColor:new Cesium.Color(1,0,0,1),modelMatrix:new Cesium.Matrix4,name:0}],d=t.split("/").length,p=d>0?r+t.split("/")[d-1]:r,g=new Id(n,{instances:h,cacheKey:p,gltf:c,uri:t,useInstancedColor:o.modelCollection._useInstancedColor});n.modifiedModels.set(r,g),g._modelInstanceCollection.readyPromise.then(function(){n.modifiedModels.remove(r),o.modelCollection.destroy(),o.modelCollection=g})}).catch()}};mh.prototype.modifiedLoadedModelIcon=function(e,t){for(var n=void 0,r=0;r<this.mtVisualDatas.length;r++){var o=this.mtVisualDatas.values[r];if(o.modelType===e){n=o;break}}n&&Cesium.Resource.fetchImage(t).then(function(a){n.cacheIcon=a})};mh.prototype.getMTVisualData=function(e){return this.mtVisualDatas.get(e)};mh.prototype.contains=function(e){return!!this.mtVisualDatas.get(e)};mh.prototype.prePassesUpdate=function(e){for(var t=0;t<this.mtVisualDatas.length;t++){var n=this.mtVisualDatas.values[t];Cesium.defined(n.modelCollection)}};mh.prototype.postPassesUpdate=function(e){for(var t=0;t<this.mtVisualDatas.length;t++){var n=this.mtVisualDatas.values[t];Cesium.defined(n.modelCollection)}};var nx=new X;mh.prototype.update=function(e){this._statistics.clear();for(var t=[],n=[],r=[],o=[],a=0;a<this.modifiedModels.length;a++){var s=this.modifiedModels.values[a];Cesium.defined(s)&&s.update(e)}for(var a=0;a<this.mtVisualDatas.length;a++){var s=this.mtVisualDatas.values[a];if(Cesium.defined(s.modelCollection)&&(s.modelCollection.ready&&s.modelCollection.regenerteInstanced(s.instancesPerFrame),s.modelCollection.update(e)),Cesium.defined(s.iconCollection)){for(var u=[],l=0;l<s.modelIconsPerFrame.length;l++)s.modelIconsPerFrame[l].image=Cesium.defined(s.cacheIcon)?s.cacheIcon:s.cacheIconUri,u[l]=new Xi(s.modelIconsPerFrame[l],s.iconCollection),u[l].movingTargetIcon=!0,u[l].id=s.modelIconsPerFrame[l].name;s.iconCollection.resize(u),s.iconCollection.update(e)}t=t.concat(s.modelLabelPerFrame),n=n.concat(s.modelTracePerFrame),r=r.concat(s.modelBoundingboxPerFrame),o=o.concat(s.modelSectorsPerFrame)}if(t.length>0){for(var c=[],l=0;l<t.length;l++)c[l]=new Cesium.Label(t[l],this.modelLabelCollection),c[l].modelLabelPullWireColor=t[l].modelLabelPullWireColor,c[l].id=t[l].id;FPe(this.modelLabelCollection,c),this.modelLabelCollection.update(e);for(var f=[],h=0;h<this.modelLabelCollection.length;h++){var d=this.modelLabelCollection.get(h);nx.x=0,nx.y=0,nx=Cesium.Label.getScreenSpaceBoundingBox(d,nx);var p=Cesium.Cartesian3.clone(d.position);p=Cesium.SceneTransforms.computeActualWgs84Position(e,p),f.push({position:p,scale:d.totalScale,imageSize:new Cesium.Cartesian2(nx.width,nx.height),pixelOffset:d.pixelOffset,origin:new Cesium.Cartesian2(d.horizontalOrigin,d.verticalOrigin),color:d.modelLabelPullWireColor,distanceDisplayCondition:d.distanceDisplayCondition})}this._modelLabelPullWireCollection.resizeLabelInfos(f),this._modelLabelPullWireCollection.update(e)}n.length>0&&(this.modelRibbonCollection.recreateVertexArrays(n),this.modelRibbonCollection.update(e),this.modelTraceWallCollection.recreateVertexArrays(n),this.modelTraceBarCollection.recreateVertexArrays(n),this.modelTraceLineCollection.recreateVertexArrays(n,e),this.modelTraceWallCollection.update(e)),this.modelTraceBarCollection.update(e),this.modelTraceLineCollection.update(e),r.length>0&&(this.modelBoundingBoxCollection.recreateVertexArrays(r),this.modelBoundingBoxCollection.update(e)),o.length>0&&(Cesium.defined(this.modelSectorRadarCollection)||(this.modelSectorRadarCollection=new T1({radius:20,forwardDis:10}))),this.modelSectorRadarCollection&&this.modelSectorRadarCollection.resetRadarByPositionProperty(o),Cesium.defined(this.modelSectorRadarCollection)&&this.modelSectorRadarCollection.update(e)};mh.prototype.isDestroyed=function(){return!1};mh.prototype.destroy=function(){for(var e=0;e<this.mtVisualDatas.length;e++){var t=this.mtVisualDatas.values[e];Cesium.defined(t.modelCollection)&&t.modelCollection.destroy(),Cesium.defined(t.iconCollection)&&t.iconCollection.destroy()}return this.mtVisualDatas.removeAll(),Cesium.defined(this.modelRibbonCollection)&&this.modelRibbonCollection.destroy(),Cesium.defined(this.modelTraceWallCollection)&&this.modelTraceWallCollection.destroy(),Cesium.defined(this.modelTraceBarCollection)&&this.modelTraceBarCollection.destroy(),Cesium.defined(this.modelTraceLineCollection)&&this.modelTraceLineCollection.destroy(),Cesium.defined(this.modelLabelCollection)&&this.modelLabelCollection.destroy(),Cesium.defined(this._modelLabelPullWireCollection)&&this._modelLabelPullWireCollection.destroy(),Cesium.defined(this.modelBoundingBoxCollection)&&this.modelBoundingBoxCollection.destroy(),Cesium.defined(this.modelSectorRadarCollection)&&this.modelSectorRadarCollection.destroy(),Cesium.destroyObject(this)};function wJ(e){var t=Cesium.getMagic(e);return t==="glTF"}function FPe(e,t){e.removeAll(),e._spareBillboards=[],e._billboardCollection.removeAll(),e._labels=t;for(var n=0;n<t.length;n++)e._labelsToUpdate.push(t[n]);return e._backgroundTextureAtlas&&e._backgroundTextureAtlas.textureCoordinates.length>=2&&(e._backgroundTextureAtlas.textureCoordinates[0]=e._backgroundTextureAtlas.textureCoordinates[1]),!0}var bM=mh;var zPe={Ribbon:0,Wall:1,Bar:2,Line:3},Hi=Object.freeze(zPe);function IM(e){this.name=T(e.name,"EV_MTTrackedPoint"),this.attackName="EV_MTAttackTrackedPoint",this.viewer=T(e.viewer),this.trackedFreedomEntity=void 0,this.trackedAttackEntity=void 0,this.type="locking"}Object.defineProperties(IM.prototype,{useAttackView:{set:function(){this.viewer.trackedEntity=this.trackedAttackEntity}},useFreedomView:{set:function(){this.viewer.trackedEntity=this.trackedFreedomEntity}}});IM.prototype.createLockingEntity=function(e){let t=this,n=t.viewer.entities.getById("EV_MTTrackedPoint");_(n)||(t.trackedFreedomEntity=t.viewer.entities.add({id:t.name,position:new Ks(e,!1),point:{color:new K(1,0,0,.1),pixelSize:6},show:!0,viewFrom:new x(1e3,0,2e3)}),t.trackedAttackEntity=t.viewer.entities.add({id:t.attackName,position:new Ks(e,!1),point:{color:new K(1,0,0,.1),pixelSize:6},show:!0,viewFrom:new x(0,0,2)}),t.viewer.trackedEntity=t.trackedFreedomEntity)};IM.prototype.removeLocking=function(){let e=this,t=e.viewer.entities.getById(e.name);e.viewer.camera.lookAtTransform(U.IDENTITY),t!==void 0&&e.viewer.entities.remove(t),e.trackedFreedomEntity=void 0;let n=e.viewer.entities.getById(e.attackName);n!==void 0&&e.viewer.entities.remove(n)};var DM=IM;function ci(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("new EV_MovingTargetManager object  viewer of options is empty!");if(!Cesium.defined(e.ev_dataMgr))throw new Cesium.DeveloperError("ev_dataMgr is empty!.");this._viewer=e.viewer,this._scene=this._viewer.scene,this._camera=this._viewer.camera,this._scene.view.oit&&(this._scene.view.oit.useTranslucentDepth=!1),this._ev_MTVisualizer=new bM({viewer:this._viewer,useInstancedColor:Cesium.defaultValue(e.useInstancedColor,!1)}),this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.ev_dataMgr=e.ev_dataMgr,this.trainingClock=Cesium.defaultValue(e.trainingClock,void 0),this._retainOutdatedData=Cesium.defaultValue(e.retainOutdatedData,!1),this._blShowOutdated=Cesium.defaultValue(e.blShowOutdated,!1),this.lastTrainingTimeMsec=0,this._mtVisibleCountInFrustum=0,this.dataOperated=Br.ADD,this.curFrameTime=new Date().getTime(),this.curTimeMovingTargets=[],this._mode=Cesium.SceneMode.SCENE3D,this._clampToGround=!1,this.blTraceEfficient=Cesium.defaultValue(e.blTraceEfficient,!0),this.evLockingTarget=new DM({name:"EV_MTTrackedPoint",viewer:this._viewer}),this.preUpdateRenderMovingTargetFunc=Cesium.defaultValue(e.preUpdateRenderMovingTargetFunc,void 0),this.ev_MTZoomFactors=new Cesium.AssociativeArray,this.ev_MTLabelConfigurationTables=new Cesium.AssociativeArray,this.graduatedColors=new Cesium.AssociativeArray,this.ev_MTFlightDatas=new Cesium.AssociativeArray,this.onMouseLeftDownEvent=new Cesium.Event,this.onMouseLeftDoubleDownEvent=new Cesium.Event,this.onMouseRightDownEvent=new Cesium.Event,this.silhouette=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),this.silhouetteStage=Cesium.PostProcessStageLibrary.createSilhouetteStage([this.silhouette]),this.silhouetteMTIDs=[],this._scene.primitives.add(this);var t=this,n="MTManagerDataSource";t.dataSource=new Cesium.CustomDataSource(n),t.dataSource.update=function(r){if(t.curFrameTime=Cesium.JulianDate.toDate(r).getTime(),t.dataOperated==Br.ADD){if(Cesium.defined(t.trainingClock)){var o=t.trainingClock.tick();t.curFrameTime=Cesium.JulianDate.toDate(o).getTime()}t.lastTrainingTimeMsec=t.curFrameTime}else t.dataOperated==Br.REPLACE&&(Cesium.defined(t.trainingClock)?t.curFrameTime=t.trainingClock.shouldAnimate?t.lastTrainingTimeMsec+=40:t.lastTrainingTimeMsec:t.curFrameTime=t._viewer.clock.shouldAnimate?t.lastTrainingTimeMsec+=40:t.lastTrainingTimeMsec);return t.curTimeMovingTargets=kPe(t,t.curFrameTime,t._retainOutdatedData,t._blShowOutdated),!0},t._viewer.dataSourceDisplay.dataSources.add(t.dataSource),t.receiveDataListenerFunc=function(r,o){var a=Cesium.defined(o)?o:Br.ADD;if(r instanceof Cesium.AssociativeArray){if(a==Br.ADD)for(var s=0;s<r.length;s++){var u=t.ev_MTFlightDatas.get(r._array[s].uId);Cesium.defined(u)||(u=new Pu(r._array[s]),t.ev_MTFlightDatas.set(r._array[s].uId,u)),u.timeAttitudeCollection=u.timeAttitudeCollection.concat(r._array[s].timeAttitudeCollection)}else if(a==Br.REPLACE){for(var s=0;s<r.length;s++){var u=t.ev_MTFlightDatas.get(r._array[s].uId);Cesium.defined(u)||(u=new Pu(r._array[s]),t.ev_MTFlightDatas.set(r._array[s].uId,u)),u.timeAttitudeCollection=[],u.timeAttitudeCollection=r._array[s].timeAttitudeCollection,Cesium.defined(u.trace)&&u.trace.clearAll()}t.dataOperated=Br.ADD}}},t.ev_dataMgr.addReceiveDataListener(Re.NET_MSG_TSPI,t.receiveDataListenerFunc),VPe(t)}Object.defineProperties(ci.prototype,{scene:{get:function(){return this._scene}},mtVisibleCountInFrustum:{get:function(){return this._mtVisibleCountInFrustum}},ev_MTVisualizer:{get:function(){return this._ev_MTVisualizer}},ev_MTRadarSectorCollection:{get:function(){return this._ev_MTVisualizer.modelSectorRadarCollection}},retainOutdatedData:{get:function(){return this._retainOutdatedData},set:function(e){typeof e=="boolean"&&(this._retainOutdatedData=e)}},blShowOutdated:{get:function(){return this._blShowOutdated},set:function(e){typeof e=="boolean"&&(this._blShowOutdated=e)}}});function VPe(e){var t=e,n=void 0,r=void 0,o=!1,a=void 0,s=void 0;t.eventHandler=new Cesium.ScreenSpaceEventHandler(t._scene.canvas),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Id){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else{var h=l.primitive;h instanceof Cesium.Label&&Cesium.defined(h.id)?Cesium.defined(t._scene._screenSpaceCameraController)&&(n=t._scene._screenSpaceCameraController._aggregator._eventHandler.getInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),Cesium.defined(n)&&(typeof h.id=="string"||typeof h.id=="number")&&(t._scene._screenSpaceCameraController._aggregator._eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),o=!0,a=t.ev_MTFlightDatas.get(h.id),Cesium.defined(a)&&(s=a.modelLabelPixelOffset))):h instanceof Xi&&Cesium.defined(h.movingTargetIcon)&&h.movingTargetIcon&&Cesium.defined(h.id)&&t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(t.ev_MTFlightDatas.get(h.id))}else t.onMouseLeftDownEvent&&t.onMouseLeftDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.LEFT_DOWN),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Id){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else l.primitive instanceof Xi&&Cesium.defined(l.primitive.movingTargetIcon)&&l.primitive.movingTargetIcon&&Cesium.defined(l.id)&&t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(t.ev_MTFlightDatas.get(l.id));else t.onMouseLeftDoubleDownEvent&&t.onMouseLeftDoubleDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),t.eventHandler.setInputAction(function(u){r=u.position;var l=t._scene.pick(u.position);if(Cesium.defined(l))if(l instanceof Cesium.Cesium3DTileFeature&&l.content instanceof Id){var c=l.content._batchTable,f=c._properties.name[l._batchId];t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(t.ev_MTFlightDatas.get(f))}else l.primitive instanceof Xi&&Cesium.defined(l.primitive.movingTargetIcon)&&l.primitive.movingTargetIcon&&Cesium.defined(l.id)?t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(t.ev_MTFlightDatas.get(l.id)):t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(void 0);else t.onMouseRightDownEvent&&t.onMouseRightDownEvent.raiseEvent(void 0)},Cesium.ScreenSpaceEventType.RIGHT_DOWN),t.eventHandler.setInputAction(function(u){Cesium.defined(t._scene._screenSpaceCameraController&&Cesium.defined(n))&&!Cesium.defined(t._scene._screenSpaceCameraController._aggregator._eventHandler.getInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE))&&(t._scene._screenSpaceCameraController._aggregator._eventHandler.setInputAction(n,Cesium.ScreenSpaceEventType.MOUSE_MOVE),o=!1,a=void 0)},Cesium.ScreenSpaceEventType.LEFT_UP),t.eventHandler.setInputAction(function(u){if(o&&Cesium.defined(a)){var l=u.endPosition,c=Cesium.Cartesian2.subtract(l,r,new Cesium.Cartesian2);a.modelLabelPixelOffset=Cesium.Cartesian2.add(s,c,new Cesium.Cartesian2)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}ci.prototype.registerMouseLeftDownListener=function(e){return Cesium.defined(this.onMouseLeftDownEvent)?this.onMouseLeftDownEvent.addEventListener(e):void 0};ci.prototype.removeMouseLeftDownListener=function(e){return Cesium.defined(this.onMouseLeftDownEvent)?this.onMouseLeftDownEvent.removeEventListener(e):void 0};ci.prototype.registerMouseLeftDoubleDownListener=function(e){return Cesium.defined(this.onMouseLeftDoubleDownEvent)?this.onMouseLeftDoubleDownEvent.addEventListener(e):void 0};ci.prototype.removeMouseLeftDoubleDownistener=function(e){return Cesium.defined(this.onMouseLeftDoubleDownEvent)?this.onMouseLeftDoubleDownEvent.removeEventListener(e):void 0};ci.prototype.registerMouseRightDownListener=function(e){return Cesium.defined(this.onMouseRightDownEvent)?this.onMouseRightDownEvent.addEventListener(e):void 0};ci.prototype.removeMouseRightDownListener=function(e){return Cesium.defined(this.onMouseRightDownEvent)?this.onMouseRightDownEvent.removeEventListener(e):void 0};function EJ(e,t,n,r){var o="",a=r.ev_MTLabelConfigurationTables.get(e.mtType);if(Cesium.defined(a)&&a.labelFieldParas.length>0){for(var s=0;s<a.labelFieldParas.length;s++){var u=a.labelFieldParas[s];o.indexOf(u.chineseName)==-1&&(s==0?u.chineseName==""&&e.hasOwnProperty(u.propertyName)?o=o+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.hasOwnProperty(u.propertyName)?o=u.chineseName+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.specialAttributes.hasOwnProperty(u.propertyName)&&(o=u.chineseName+(u.decimalPrec>-1?e.specialAttributes[u.propertyName].toFixed(u.decimalPrec):e.specialAttributes[u.propertyName])):u.chineseName==""&&e.hasOwnProperty(u.propertyName)?o=o+`
`+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.hasOwnProperty(u.propertyName)?o=o+`
`+u.chineseName+(u.decimalPrec>-1?e[u.propertyName].toFixed(u.decimalPrec):e[u.propertyName]):e.specialAttributes.hasOwnProperty(u.propertyName)&&(o=o+`
`+u.chineseName+(u.decimalPrec>-1?e.specialAttributes[u.propertyName].toFixed(u.decimalPrec):e.specialAttributes[u.propertyName])))}return{id:e.uId.toString(),text:o,position:e.position,fillColor:t,pixelOffset:e.modelLabelPixelOffset,font:a.font,horizontalOrigin:a.horizontalOrigin,verticalOrigin:a.verticalOrigin,style:a.style,disableDepthTestDistance:a.disableDepthTestDistance,showBackground:a.showBackground,backgroundColor:a.backgroundColor,distanceDisplayCondition:a.distanceDisplayCondition,modelLabelPullWireColor:n}}}function kPe(e,t,n,r){var o=[];for(var a in e.ev_MTFlightDatas._hash){var s=e.ev_MTFlightDatas.get(a),u=s.getMovingTargetStateByTime(t,n,r);Cesium.defined(u)&&o.push(u)}return o}var TJ=new U;ci.prototype.prePassesUpdate=function(e){this._mtVisibleCountInFrustum=0;var t=this.curFrameTime,n=this.curTimeMovingTargets;Cesium.defined(this.preUpdateRenderMovingTargetFunc)&&this.preUpdateRenderMovingTargetFunc(n);for(var r=0;r<this._ev_MTVisualizer.mtVisualDatas.length;r++){var o=this._ev_MTVisualizer.mtVisualDatas.values[r];Cesium.defined(o)&&(o.instancesPerFrame=[],o.modelLabelPerFrame=[],o.modelIconsPerFrame=[],o.modelTracePerFrame=[],o.modelBoundingboxPerFrame=[],o.modelSectorsPerFrame=[])}var a=new Cesium.Cartesian3;if(e.mode!=Cesium.SceneMode.SCENE3D){var s=e.mapProjection;a=s.ellipsoid.cartographicToCartesian(this._camera.positionCartographic,a)}for(var u=0;u<n.length;u++){var l=n[u].mtType,c=n[u].modelType,f=n[u].nRedOrBlue,h=this.graduatedColors.get(f),d=n[u].uId,p=n[u].show,g=l.toString()+"_"+c.toString(),y=n[u].position;if(this._clampToGround){var v=Cesium.Cartographic.fromCartesian(y),w=this.scene.globe.getHeight(v);v.height=w,y=Cesium.Cartographic.toCartesian(v)}var o=this._ev_MTVisualizer.getMTVisualData(g);if(Cesium.defined(o)){if(Cesium.defined(o.modelCollection)&&o.modelCollection.ready){var C=this.transformFunc(y,void 0,TJ),E=o.modelCollection.model.boundingSphere;E.center=Cesium.Matrix4.multiplyByPoint(C,E.center,new Cesium.Cartesian3);var S=1;Cesium.defined(n[u].scale)&&(S=n[u].scale);var S=Cesium.defined(n[u].scale)?n[u].scale:1,A=this.ev_MTZoomFactors.get(l),D=Cesium.defined(A)?A.minimumPixelSize:0,P=Cesium.defined(A)?A.maximumScale:0;S=UPe(S,y,E.radius,D,P,e),p||(S=0);var M=Cesium.Quaternion.fromHeadingPitchRoll(n[u].headingPitchRoll,new Cesium.Quaternion),I=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),M,new Cesium.Cartesian3(S,S,S));C=Cesium.Matrix4.multiply(C,I,new Cesium.Matrix4),n[u].boundingBoxVisible&&o.modelBoundingboxPerFrame.push({modelMatrix:C,boxGeometry:o.modelCollection.model._boundingBox,color:new Cesium.Color(.3,.3,.3,.5)});var O={modelMatrix:C,batchId:o.instancesPerFrame.length,name:d,modelColor:Cesium.defined(h)&&Cesium.defined(h.modelColor)?h.modelColor:new Cesium.Color(1,0,0,1),visible:!1};if((e.cullingVolume.computeVisibility(E)!=Cesium.Visibility.NONE||e.mode!=this._mode||e.mode!=Cesium.SceneMode.SCENE3D)&&p){this._mtVisibleCountInFrustum++;var m=Cesium.Cartesian3.distance(this._camera.positionWC,E.center);if(Cesium.defined(n[u].modelIconUri))if(e.mode!=Cesium.SceneMode.SCENE3D){if(m=Cesium.Cartesian3.distance(a,E.center),m<=n[u].modelIconDisplayDistance.far){var b=n[u].modelIconColor;Cesium.defined(h)&&Cesium.defined(h.modelIconColor)?b=h.modelIconColor:Cesium.defined(b)||(b=Cesium.Color.RED),o.modelIconsPerFrame.push({position:y,rotation:-n[u].headingPitchRoll.heading,scale:n[u].modelIconScale,color:b,name:d,alignedAxis:Cesium.Cartesian3.UNIT_Z}),O.visible=!1}}else{if(m<=n[u].modelIconDisplayDistance.far&&m>n[u].modelIconDisplayDistance.near){var b=n[u].modelIconColor;Cesium.defined(h)&&Cesium.defined(h.modelIconColor)?b=h.modelIconColor:Cesium.defined(b)||(b=Cesium.Color.RED),o.modelIconsPerFrame.push({position:y,rotation:-n[u].headingPitchRoll.heading,scale:n[u].modelIconScale,color:b,name:d,alignedAxis:Cesium.Cartesian3.UNIT_Z}),O.visible=!1}else m<=n[u].modelIconDisplayDistance.near&&(O.visible=!0,o.instancesPerFrame.push(O));n[u].sectorRadarVisible&&o.modelSectorsPerFrame.push({position:y,scale:new Cesium.Cartesian3(S,S,S),headingPitchRoll:new Cesium.HeadingPitchRoll(n[u].headingPitchRoll.heading,n[u].headingPitchRoll.pitch,n[u].headingPitchRoll.roll),color:n[u].sectorRadarColor})}else O.visible=!0,o.instancesPerFrame.push(O),n[u].sectorRadarVisible&&o.modelSectorsPerFrame.push({position:y,scale:new Cesium.Cartesian3(S,S,S),headingPitchRoll:new Cesium.HeadingPitchRoll(n[u].headingPitchRoll.heading,n[u].headingPitchRoll.pitch,n[u].headingPitchRoll.roll),color:n[u].sectorRadarColor});var L=n[u].trace;if(Cesium.defined(L)&&(L.ribbonVisible||L.wallVisible||L.barVisible||L.lineVisible)&&(Cesium.defined(h)&&Cesium.defined(h.traceRibbonColor)?(L.ribbonColor.red=h.traceRibbonColor.red,L.ribbonColor.green=h.traceRibbonColor.green,L.ribbonColor.blue=h.traceRibbonColor.blue):Cesium.defined(L.ribbonColor)||(L.ribbonColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceWallColor)?(L.wallColor.red=h.traceWallColor.red,L.wallColor.green=h.traceWallColor.green,L.wallColor.blue=h.traceWallColor.blue):Cesium.defined(L.wallColor)||(L.wallColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceBarColor)?(L.barColor.red=h.traceBarColor.red,L.barColor.green=h.traceBarColor.green,L.barColor.blue=h.traceBarColor.blue):Cesium.defined(L.barColor)||(L.barColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceLineColor)?(L.lineColor.red=h.traceLineColor.red,L.lineColor.green=h.traceLineColor.green,L.lineColor.blue=h.traceLineColor.blue):Cesium.defined(L.lineColor)||(L.lineColor=Cesium.Color.RED),L.add(y,n[u].headingPitchRoll,t,S),o.modelTracePerFrame.push(L)),n[u].modelLabelVisible){var R=this.ev_MTLabelConfigurationTables.get(n[u].mtType);if(R&&e.mode!=Cesium.SceneMode.SCENE3D){if(m<=R.distanceDisplayCondition.far){var N=n[u].modelLabelTextColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelTextColor)?N=h.modelLabelTextColor:Cesium.defined(N)||(N=Cesium.Color.RED);var B=n[u].modelLabelPullWireColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelPullWireColor)?B=h.modelLabelPullWireColor:Cesium.defined(B)||(B=Cesium.Color.RED);var G=EJ(n[u],N,B,this);Cesium.defined(G)&&o.modelLabelPerFrame.push(G)}}else if(R&&m<=R.distanceDisplayCondition.far&&m>R.distanceDisplayCondition.near){var N=n[u].modelLabelTextColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelTextColor)?N=h.modelLabelTextColor:Cesium.defined(N)||(N=Cesium.Color.RED);var B=n[u].modelLabelPullWireColor;Cesium.defined(h)&&Cesium.defined(h.modelLabelPullWireColor)?B=h.modelLabelPullWireColor:Cesium.defined(B)||(B=Cesium.Color.RED);var G=EJ(n[u],N,B,this);Cesium.defined(G)&&o.modelLabelPerFrame.push(G)}}}else{o.instancesPerFrame.push(O);var L=n[u].trace;Cesium.defined(L)&&!this.blTraceEfficient&&(L.ribbonVisible||L.wallVisible||L.barVisible||L.lineVisible)&&(Cesium.defined(h)&&Cesium.defined(h.traceRibbonColor)?(L.ribbonColor.red=h.traceRibbonColor.red,L.ribbonColor.green=h.traceRibbonColor.green,L.ribbonColor.blue=h.traceRibbonColor.blue):Cesium.defined(L.ribbonColor)||(L.ribbonColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceWallColor)?(L.wallColor.red=h.traceWallColor.red,L.wallColor.green=h.traceWallColor.green,L.wallColor.blue=h.traceWallColor.blue):Cesium.defined(L.wallColor)||(L.wallColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceBarColor)?(L.barColor.red=h.traceBarColor.red,L.barColor.green=h.traceBarColor.green,L.barColor.blue=h.traceBarColor.blue):Cesium.defined(L.barColor)||(L.barColor=Cesium.Color.RED),Cesium.defined(h)&&Cesium.defined(h.traceLineColor)?(L.lineColor.red=h.traceLineColor.red,L.lineColor.green=h.traceLineColor.green,L.lineColor.blue=h.traceLineColor.blue):Cesium.defined(L.lineColor)||(L.lineColor=Cesium.Color.RED),L.add(y,n[u].headingPitchRoll,t,S))}var F=this.ev_MTFlightDatas.get(d);Cesium.defined(F)&&(F.curTimeAttitude.scale=S,F.curTimeAttitude.visible=O.visible)}}else{var M=Cesium.Quaternion.fromHeadingPitchRoll(n[u].headingPitchRoll,new Cesium.Quaternion),I=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),M,new Cesium.Cartesian3(1,1,1)),k=this.transformFunc(y,void 0,TJ),C=Cesium.Matrix4.multiply(k,I,new Cesium.Matrix4),Z=[];Z.push({modelMatrix:C,batchId:0,name:d,modelColor:Cesium.defined(h)?h.modelColor:Cesium.Color.RED});var te=[];te.push({position:y,scale:.1}),this._ev_MTVisualizer.add({keyName:g,modelType:c,modelUri:n[u].modelUri,modelIconUri:n[u].modelIconUri,instances:Z,iconInstances:te})}}this._ev_MTVisualizer.prePassesUpdate(e),this._mode=e.mode};ci.prototype.update=function(e){if(this._ev_MTVisualizer.update(e),this.silhouetteMTIDs.length>0){this.silhouette.selected=[];for(var t in this._scene.context._pickObjects){var n=this._scene.context._pickObjects[t];if(n.content&&n.content instanceof Id){var r=n._batchId,o=n.content._cacheInstances[r];if(o){var a=this.silhouetteMTIDs.indexOf(o.name);a!=-1&&this.silhouette.selected.push(n)}}}}};ci.prototype.postPassesUpdate=function(e){this._ev_MTVisualizer.postPassesUpdate(e)};ci.prototype.removeAllMovingTargets=function(){this.ev_MTFlightDatas.removeAll()};ci.prototype.setAllMovingTargetsVisible=function(e){var t=Cesium.defaultValue(e,!1);for(var n in this.ev_MTFlightDatas._hash){var r=this.ev_MTFlightDatas.get(n);r&&(r.show=t)}};ci.prototype.removeMovingTargetById=function(e){this.ev_MTFlightDatas.contains(e)&&this.ev_MTFlightDatas.remove(e)};ci.prototype.getMovingTargetById=function(e){return this.ev_MTFlightDatas.get(e)};ci.prototype.setMovingTargetVisibleById=function(e,t){var n=Cesium.defaultValue(t,!1),r=this.ev_MTFlightDatas.get(e);return r?(r.show=n,!0):!1};ci.prototype.addMovingTargetTimeAttitude=function(e,t){var n=this.ev_MTFlightDatas.get(e);Cesium.defined(n)||(n=new Pu(t),this.ev_MTFlightDatas.set(e,n)),n.timeAttitudeCollection=n.timeAttitudeCollection.concat(t.timeAttitudeCollection)};ci.prototype.modifiedLoadedModelIcon=function(e,t){!e||!t||this._ev_MTVisualizer&&this._ev_MTVisualizer.modifiedLoadedModelIcon(e,t)};ci.prototype.modifiedLoadedModel=function(e,t){!e||!t||this._ev_MTVisualizer&&this._ev_MTVisualizer.modifiedLoadedModel(e,t)};ci.prototype.setBlinkById=function(e,t,n,r){if(!t||!n)return!1;var o=this.ev_MTFlightDatas.get(e);if(o){var a=o.show,s=this,u=0;return this._timer=setInterval(function(){if(s._timer&&u>=n*t){clearInterval(s._timer),s._timer=void 0,o.show=a,r&&r();return}o.show=!o.show,u++},1e3/t),!0}else return!1};ci.prototype.setModelLabelVisibleById=function(e,t){var n=Cesium.defaultValue(t,!1),r=this.ev_MTFlightDatas.get(e);return r?(r.modelLabelVisible=n,!0):!1};ci.prototype.setTraceVisibleById=function(e,t,n){var r=Cesium.defaultValue(n,!1),o=this.ev_MTFlightDatas.get(e);return o?(t==Hi.Ribbon?o.trace.ribbonVisible=r:t==Hi.Wall?o.trace.wallVisible=r:t==Hi.Bar?o.trace.barVisible=r:t==Hi.Line&&(o.trace.lineVisible=r),!0):!1};ci.prototype.setTraceColorById=function(e,t,n){var r=Cesium.defaultValue(n,Cesium.Color.RED),o=this.ev_MTFlightDatas.get(e);return o?(t==Hi.Ribbon?r.clone(o.trace.ribbonColor=o.trace.ribbonColor):t==Hi.Wall?r.clone(o.trace.wallColor=o.trace.wallColor):t==Hi.Bar?r.clone(o.trace.barColor=o.trace.barColor):t==Hi.Line&&r.clone(o.trace.lineColor=o.trace.lineColor),!0):!1};ci.prototype.setTraceVisible=function(e,t,n){var r=Cesium.defaultValue(n,!1);for(var o in this.ev_MTFlightDatas._hash){var a=this.ev_MTFlightDatas.get(o);t==-1?e==Hi.Ribbon?a.trace.ribbonVisible=r:e==Hi.Wall?a.trace.wallVisible=r:e==Hi.Bar?a.trace.barVisible=r:e==Hi.Line&&(a.trace.lineVisible=r):a.mtType==t&&(e==Hi.Ribbon?a.trace.ribbonVisible=r:e==Hi.Wall?a.trace.wallVisible=r:e==Hi.Bar?a.trace.barVisible=r:e==Hi.Line&&(a.trace.lineVisible=r))}};ci.prototype.setTraceAlpha=function(e,t,n){n=Cesium.defaultValue(n,1);for(var r in this.ev_MTFlightDatas._hash){var o=this.ev_MTFlightDatas.get(r);t==-1?e==Hi.Ribbon?o.trace.ribbonColor=o.trace.ribbonColor.withAlpha(n):e==Hi.Wall?o.trace.wallColor=o.trace.wallColor.withAlpha(n):e==Hi.Bar?o.trace.barColor=o.trace.barColor.withAlpha(n):e==Hi.Line&&(o.trace.lineColor=o.trace.lineColor.withAlpha(n)):o.mtType==t&&(e==Hi.Ribbon?o.trace.ribbonColor=o.trace.ribbonColor.withAlpha(n):e==Hi.Wall?o.trace.wallColor=o.trace.wallColor.withAlpha(n):e==Hi.Bar?o.trace.barColor=o.trace.barColor.withAlpha(n):e==Hi.Line&&(o.trace.lineColor=o.trace.lineColor.withAlpha(n)))}};ci.prototype.setTraceTimeDuration=function(e,t){var n=Cesium.defaultValue(t,1e3);for(var r in this.ev_MTFlightDatas._hash){var o=this.ev_MTFlightDatas.get(r);o.mtType==e&&(o.trace.traceTimeDuration=n)}};ci.prototype.setTraceBarTimeInterval=function(t){var t=Cesium.defaultValue(t,1);for(var n in this.ev_MTFlightDatas._hash){var r=this.ev_MTFlightDatas.get(n);r.trace.barTimeInterval=t}};ci.prototype.lockingTarget=function(e){var t=this;return t.unLockingTarget(),t.ev_MTFlightDatas.get(e)?(this.evLockingTarget.createLockingEntity(function(){var n=t.ev_MTFlightDatas.get(e);return n?n.curTimeAttitude.position:new Cesium.Cartesian3}),!0):!1};ci.prototype.unLockingTarget=function(){return this.evLockingTarget&&this.evLockingTarget.removeLocking(),!0};ci.prototype.flyToTarget=function(e,t,n){var r=this.ev_MTFlightDatas.get(e);if(r&&this._ev_MTVisualizer){var o=r.mtType.toString()+"_"+r.modelType.toString(),a=this._ev_MTVisualizer.mtVisualDatas.get(o);if(a){var s=a.modelCollection.model.boundingSphere.radius,u=r.curTimeAttitude.position,l=Cesium.defaultValue(t,new Cesium.Cartesian3(.3138931386742197,-.6687061031905268,.6740202111576385));u.x-=l.x*s*r.scale*2,u.y-=l.y*s*r.scale*2,u.z-=l.z*s*r.scale*2,this._camera.flyTo({destination:u,orientation:{direction:l,up:Cesium.defaultValue(n,new Cesium.Cartesian3(-.37193546807702543,.5665603886813149,.735304925567347))}})}}};ci.prototype.enableSilhouette=function(e,t){if(this._scene.context&&this.silhouette){this.silhouetteStage.isDestroyed()&&(this.silhouette=Cesium.PostProcessStageLibrary.createEdgeDetectionStage(),this.silhouetteStage=Cesium.PostProcessStageLibrary.createSilhouetteStage([this.silhouette])),this.silhouette.selected=[],this.silhouette.uniforms.color=e,this.silhouette.uniforms.length=.01,this._scene.postProcessStages.getStageByName(this.silhouetteStage.name)||this._scene.postProcessStages.add(this.silhouetteStage),this.silhouetteMTIDs=t;for(var n in this._scene.context._pickObjects){var r=this._scene.context._pickObjects[n];if(r.content&&r.content instanceof Id){var o=r._batchId,a=r.content._cacheInstances[o];if(a){var s=this.silhouetteMTIDs.indexOf(a.name);s!=-1&&this.silhouette.selected.push(r)}}}}};ci.prototype.disableSilhouette=function(){this.silhouetteMTIDs=[],this._scene.context&&this.silhouetteStage&&this._scene.postProcessStages.remove(this.silhouetteStage)};ci.prototype.isDestroyed=function(){return!1};ci.prototype.destroy=function(){this.evLockingTarget&&this._viewer._dataSourceDisplay&&this.evLockingTarget.removeLocking(),this.disableSilhouette(),this.eventHandler=this.eventHandler&&this.eventHandler.destroy(),this.onMouseLeftDownEvent=void 0,this.onMouseLeftDoubleDownEvent=void 0,this.onMouseRightDownEvent=void 0,Cesium.defined(this.ev_dataMgr)&&Cesium.defined(this.ev_dataMgr.removeReceiveDataListener)&&this.ev_dataMgr.removeReceiveDataListener(this.receiveDataListenerFunc),this.ev_MTFlightDatas.removeAll();var e=this._scene.primitives.destroyPrimitives;return this._scene.primitives.destroyPrimitives=!1,this._scene.primitives.remove(this),this._scene.primitives.destroyPrimitives=e,this._ev_MTVisualizer.destroy(),Cesium.destroyObject(this)};var GPe=new ce;function UPe(e,t,n,r,o,a){if(r!==0){var s=a.context,u=Math.max(s.drawingBufferWidth,s.drawingBufferHeight),l=Cesium.Cartesian3.clone(t);if(a.mode!==Cesium.SceneMode.SCENE3D){var c=a.mapProjection,f=c.ellipsoid.cartesianToCartographic(l,GPe);c.project(f,l),Cesium.Cartesian3.fromElements(l.z,l.x,l.y,l)}var h=n*e,d=a.camera.getPixelSize(new Cesium.BoundingSphere(l,h),a.context.drawingBufferWidth,a.context.drawingBufferHeight),p=1/d,g=Math.min(p*(2*h),u);g<r&&(e=r*d/(1*n))}return Cesium.defined(o)&&o!==0?Math.min(o,e):e}var gh=ci;function jF(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.labelFieldParas=[],this.showBackground=Cesium.defaultValue(e.showBackground,!0),this.backgroundColor=Cesium.defaultValue(e.backgroundColor,new Cesium.Color(1,1,1,.2)),this.font=Cesium.defaultValue(e.font,"12px Helvetica"),this.style=Cesium.defaultValue(e.style,Cesium.LabelStyle.FILL),this.disableDepthTestDistance=Cesium.defaultValue(e.disableDepthTestDistance,Number.POSITIVE_INFINITY),this.distanceDisplayCondition=Cesium.defaultValue(e.distanceDisplayCondition,new Cesium.DistanceDisplayCondition),this.horizontalOrigin=Cesium.defaultValue(e.horizontalOrigin,Cesium.HorizontalOrigin.LEFT),this.verticalOrigin=Cesium.defaultValue(e.verticalOrigin,Cesium.VerticalOrigin.TOP)}jF.prototype.addDisplayFieldPara=function(e,t,n){n=Cesium.defaultValue(n,-1),this.labelFieldParas.push({chineseName:e,propertyName:t,decimalPrec:n})};jF.prototype.removeAllDisplayFieldParas=function(){this.labelFieldParas=[]};var _h=jF;function j0(){}j0.packedLength=x.packedLength;j0.unpack=x.unpack;j0.pack=x.pack;var KF;function AS(e,t){return t[0]==="#"&&(t=KF+t),WK.fromString(e,t)}function SJ(e,t,n){if(_(n.reference))return AS(t,n.reference);if(_(n.velocityReference)){let r=AS(t,n.velocityReference);switch(e){case x:case j0:return new $P(r,e===j0);case je:return new ZK(r)}}throw new it(`${JSON.stringify(n)} is not valid CZML.`)}function HPe(e,t){return new Ks(function(n,r){return t(e.getValue(n,r))},e.isConstant)}var Jr=new x,Xl=new lj,yl=new ce,Qy=new ri,PM=new je;function qPe(e){let t=e.rgbaf;if(_(t))return t;let n=e.rgba;if(!_(n))return;let r=n.length;if(r===K.packedLength)return[K.byteToFloat(n[0]),K.byteToFloat(n[1]),K.byteToFloat(n[2]),K.byteToFloat(n[3])];t=new Array(r);for(let o=0;o<r;o+=5)t[o]=n[o],t[o+1]=K.byteToFloat(n[o+1]),t[o+2]=K.byteToFloat(n[o+2]),t[o+3]=K.byteToFloat(n[o+3]),t[o+4]=K.byteToFloat(n[o+4]);return t}function AJ(e,t){let n=T(e.uri,e);return _(t)?t.getDerivedResource({url:n}):_t.createIfNeeded(n)}function WPe(e){let t=e.wsen;if(_(t))return t;let n=e.wsenDegrees;if(!_(n))return;let r=n.length;if(r===ln.packedLength)return[Math.toRadians(n[0]),Math.toRadians(n[1]),Math.toRadians(n[2]),Math.toRadians(n[3])];t=new Array(r);for(let o=0;o<r;o+=5)t[o]=n[o],t[o+1]=Math.toRadians(n[o+1]),t[o+2]=Math.toRadians(n[o+2]),t[o+3]=Math.toRadians(n[o+3]),t[o+4]=Math.toRadians(n[o+4]);return t}function YPe(e){let t=e.length;if(Xl.magnitude=1,t===2)return Xl.clock=e[0],Xl.cone=e[1],x.fromSpherical(Xl,Jr),[Jr.x,Jr.y,Jr.z];let n=new Array(t/3*4);for(let r=0,o=0;r<t;r+=3,o+=4)n[o]=e[r],Xl.clock=e[r+1],Xl.cone=e[r+2],x.fromSpherical(Xl,Jr),n[o+1]=Jr.x,n[o+2]=Jr.y,n[o+3]=Jr.z;return n}function XPe(e){let t=e.length;if(t===3)return Xl.clock=e[0],Xl.cone=e[1],Xl.magnitude=e[2],x.fromSpherical(Xl,Jr),[Jr.x,Jr.y,Jr.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],Xl.clock=e[r+1],Xl.cone=e[r+2],Xl.magnitude=e[r+3],x.fromSpherical(Xl,Jr),n[r+1]=Jr.x,n[r+2]=Jr.y,n[r+3]=Jr.z;return n}function jPe(e){let t=e.length;if(t===3)return yl.longitude=e[0],yl.latitude=e[1],yl.height=e[2],Ge.WGS84.cartographicToCartesian(yl,Jr),[Jr.x,Jr.y,Jr.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],yl.longitude=e[r+1],yl.latitude=e[r+2],yl.height=e[r+3],Ge.WGS84.cartographicToCartesian(yl,Jr),n[r+1]=Jr.x,n[r+2]=Jr.y,n[r+3]=Jr.z;return n}function KPe(e){let t=e.length;if(t===3)return yl.longitude=Math.toRadians(e[0]),yl.latitude=Math.toRadians(e[1]),yl.height=e[2],Ge.WGS84.cartographicToCartesian(yl,Jr),[Jr.x,Jr.y,Jr.z];let n=new Array(t);for(let r=0;r<t;r+=4)n[r]=e[r],yl.longitude=Math.toRadians(e[r+1]),yl.latitude=Math.toRadians(e[r+2]),yl.height=e[r+3],Ge.WGS84.cartographicToCartesian(yl,Jr),n[r+1]=Jr.x,n[r+2]=Jr.y,n[r+3]=Jr.z;return n}function ZF(e){let t=e.cartesian;if(_(t))return t;let n=e.cartesianVelocity;if(_(n))return n;let r=e.unitCartesian;if(_(r))return r;let o=e.unitSpherical;if(_(o))return YPe(o);let a=e.spherical;if(_(a))return XPe(a);let s=e.cartographicRadians;if(_(s))return jPe(s);let u=e.cartographicDegrees;if(_(u))return KPe(u);throw new it(`${JSON.stringify(e)} is not a valid CZML interval.`)}function bJ(e,t){x.unpack(e,t,Jr),x.normalize(Jr,Jr),x.pack(Jr,e,t)}function ZPe(e){let t=ZF(e);if(t.length===3)return bJ(t,0),t;for(let n=1;n<t.length;n+=4)bJ(t,n);return t}function IJ(e,t){je.unpack(e,t,PM),je.normalize(PM,PM),je.pack(PM,e,t)}function QPe(e){let t=e.unitQuaternion;if(_(t)){if(t.length===4)return IJ(t,0),t;for(let n=1;n<t.length;n+=5)IJ(t,n)}return t}function DJ(e){return typeof e=="boolean"?Boolean:typeof e=="number"?Number:typeof e=="string"?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?en:e.hasOwnProperty("cartesian2")?X:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?x:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?j0:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?K:e.hasOwnProperty("arcType")?Na:e.hasOwnProperty("classificationType")?ka:e.hasOwnProperty("colorBlendMode")?sg:e.hasOwnProperty("cornerType")?Ai:e.hasOwnProperty("heightReference")?Pt:e.hasOwnProperty("horizontalOrigin")?ho:e.hasOwnProperty("date")?fe:e.hasOwnProperty("labelStyle")?dl:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?Tt:e.hasOwnProperty("distanceDisplayCondition")?gn:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?je:e.hasOwnProperty("shadowMode")?ro:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?F0:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?ln:e.hasOwnProperty("uri")?Qi.default:e.hasOwnProperty("verticalOrigin")?an:Object}function UJ(e,t,n){switch(e){case Na:return Na[T(t.arcType,t)];case Array:return t.array;case Boolean:return T(t.boolean,t);case en:return t.boundingRectangle;case X:return t.cartesian2;case x:return ZF(t);case j0:return ZPe(t);case K:return qPe(t);case ka:return ka[T(t.classificationType,t)];case sg:return sg[T(t.colorBlendMode,t)];case Ai:return Ai[T(t.cornerType,t)];case Pt:return Pt[T(t.heightReference,t)];case ho:return ho[T(t.horizontalOrigin,t)];case Image:return AJ(t,n);case fe:return fe.fromIso8601(T(t.date,t));case dl:return dl[T(t.labelStyle,t)];case Number:return T(t.number,t);case Tt:return t.nearFarScalar;case gn:return t.distanceDisplayCondition;case Object:return T(T(t.object,t.value),t);case je:return QPe(t);case ag:return T(t.number,t);case ro:return ro[T(T(t.shadowMode,t.shadows),t)];case String:return T(t.string,t);case F0:return F0[T(t.stripeOrientation,t)];case ln:return WPe(t);case Qi.default:return AJ(t,n);case an:return an[T(t.verticalOrigin,t)];default:throw new it(e)}}var JPe={HERMITE:cj,LAGRANGE:fj,LINEAR:VP};function bS(e,t){let n=e.interpolationAlgorithm,r=e.interpolationDegree;(_(n)||_(r))&&t.setInterpolationOptions({interpolationAlgorithm:JPe[n],interpolationDegree:r});let o=e.forwardExtrapolationType;_(o)&&(t.forwardExtrapolationType=Lp[o]);let a=e.forwardExtrapolationDuration;_(a)&&(t.forwardExtrapolationDuration=a);let s=e.backwardExtrapolationType;_(s)&&(t.backwardExtrapolationType=Lp[s]);let u=e.backwardExtrapolationDuration;_(u)&&(t.backwardExtrapolationDuration=u)}var PJ={iso8601:void 0};function qo(e){if(!!_(e))return PJ.iso8601=e,ri.fromIso8601(PJ)}function QF(e){let t=ps.MAXIMUM_INTERVAL.clone();return t.data=e,t}function MJ(e){let t=new dh;return t.intervals.addInterval(QF(e)),t}function LJ(e){let t=new og(e.referenceFrame);return t.intervals.addInterval(QF(e)),t}function MM(e,t,n,r,o,a,s){let u=qo(r.interval);_(o)&&(_(u)?u=ri.intersect(u,o,Qy):u=o);let l,c,f,h=!_(r.reference)&&!_(r.velocityReference),d=_(u)&&!u.equals(ps.MAXIMUM_INTERVAL);if(r.delete===!0){if(!d){t[n]=void 0;return}return HJ(t[n],u)}let p=!1;if(h){if(c=UJ(e,r,a),!_(c))return;l=T(e.packedLength,1),f=T(c.length,1),p=!_(r.array)&&typeof c!="string"&&f>l&&e!==Object}let g=typeof e.unpack=="function"&&e!==ag;if(!p&&!d){h?t[n]=new sp(g?e.unpack(c,0):c):t[n]=SJ(e,s,r);return}let y=t[n],v,w=r.epoch;if(_(w)&&(v=fe.fromIso8601(w)),p&&!d){y instanceof ig||(t[n]=y=new ig(e)),y.addSamplesPackedArray(c,v),bS(r,y);return}let C;if(!p&&d){u=u.clone(),h?u.data=g?e.unpack(c,0):c:u.data=SJ(e,s,r),_(y)||(t[n]=y=h?new JP:new dh),h&&y instanceof JP?y.intervals.addInterval(u):y instanceof dh?(h&&(u.data=new sp(u.data)),y.intervals.addInterval(u)):(t[n]=y=MJ(y),h&&(u.data=new sp(u.data)),y.intervals.addInterval(u));return}_(y)||(t[n]=y=new dh),y instanceof dh||(t[n]=y=MJ(y));let E=y.intervals;C=E.findInterval(u),(!_(C)||!(C.data instanceof ig))&&(C=u.clone(),C.data=new ig(e),E.addInterval(C)),C.data.addSamplesPackedArray(c,v),bS(r,C.data)}function HJ(e,t){if(e instanceof ig){e.removeSamples(t);return}else if(e instanceof JP){e.intervals.removeInterval(t);return}else if(e instanceof dh){let n=e.intervals;for(let r=0;r<n.length;++r){let o=ri.intersect(n.get(r),t,Qy);o.isEmpty||HJ(o.data,t)}n.removeInterval(t);return}}function J(e,t,n,r,o,a,s){if(!!_(r))if(Array.isArray(r))for(let u=0,l=r.length;u<l;++u)MM(e,t,n,r[u],o,a,s);else MM(e,t,n,r,o,a,s)}function RJ(e,t,n,r,o,a){let s=qo(n.interval);_(r)&&(_(s)?s=ri.intersect(s,r,Qy):s=r);let u=_(n.cartesianVelocity)?1:0,l=x.packedLength*(u+1),c,f,h=!_(n.reference),d=_(s)&&!s.equals(ps.MAXIMUM_INTERVAL);if(n.delete===!0){if(!d){e[t]=void 0;return}return qJ(e[t],s)}let p,g=!1;if(h&&(_(n.referenceFrame)&&(p=Ba[n.referenceFrame]),p=T(p,Ba.FIXED),c=ZF(n),f=T(c.length,1),g=f>l),!g&&!d){h?e[t]=new LC(x.unpack(c),p):e[t]=AS(a,n.reference);return}let y=e[t],v,w=n.epoch;if(_(w)&&(v=fe.fromIso8601(w)),g&&!d){(!(y instanceof F1)||_(p)&&y.referenceFrame!==p)&&(e[t]=y=new F1(p,u)),y.addSamplesPackedArray(c,v),bS(n,y);return}let C;if(!g&&d){s=s.clone(),h?s.data=x.unpack(c):s.data=AS(a,n.reference),_(y)||(h?y=new eM(p):y=new og(p),e[t]=y),h&&y instanceof eM&&_(p)&&y.referenceFrame===p?y.intervals.addInterval(s):y instanceof og?(h&&(s.data=new LC(s.data,p)),y.intervals.addInterval(s)):(e[t]=y=LJ(y),h&&(s.data=new LC(s.data,p)),y.intervals.addInterval(s));return}_(y)?y instanceof og||(e[t]=y=LJ(y)):e[t]=y=new og(p);let E=y.intervals;C=E.findInterval(s),(!_(C)||!(C.data instanceof F1)||_(p)&&C.data.referenceFrame!==p)&&(C=s.clone(),C.data=new F1(p,u),E.addInterval(C)),C.data.addSamplesPackedArray(c,v),bS(n,C.data)}function qJ(e,t){if(e instanceof F1){e.removeSamples(t);return}else if(e instanceof eM){e.intervals.removeInterval(t);return}else if(e instanceof og){let n=e.intervals;for(let r=0;r<n.length;++r){let o=ri.intersect(n.get(r),t,Qy);o.isEmpty||qJ(o.data,t)}n.removeInterval(t);return}}function WJ(e,t,n,r,o,a){if(!!_(n))if(Array.isArray(n))for(let s=0,u=n.length;s<u;++s)RJ(e,t,n[s],r,o,a);else RJ(e,t,n,r,o,a)}function OJ(e,t,n,r,o,a){let s=qo(n.interval);_(r)&&(_(s)?s=ri.intersect(s,r,Qy):s=r);let u=e[t],l,c;if(_(s)){u instanceof $B||(u=new $B,e[t]=u);let h=u.intervals;c=h.findInterval({start:s.start,stop:s.stop}),_(c)?l=c.data:(c=s.clone(),h.addInterval(c))}else l=u;let f;_(n.solidColor)?(l instanceof EE||(l=new EE),f=n.solidColor,J(K,l,"color",f.color,void 0,void 0,a)):_(n.grid)?(l instanceof JB||(l=new JB),f=n.grid,J(K,l,"color",f.color,void 0,o,a),J(Number,l,"cellAlpha",f.cellAlpha,void 0,o,a),J(X,l,"lineCount",f.lineCount,void 0,o,a),J(X,l,"lineThickness",f.lineThickness,void 0,o,a),J(X,l,"lineOffset",f.lineOffset,void 0,o,a)):_(n.image)?(l instanceof TE||(l=new TE),f=n.image,J(Image,l,"image",f.image,void 0,o,a),J(X,l,"repeat",f.repeat,void 0,o,a),J(K,l,"color",f.color,void 0,o,a),J(Boolean,l,"transparent",f.transparent,void 0,o,a)):_(n.stripe)?(l instanceof jB||(l=new jB),f=n.stripe,J(F0,l,"orientation",f.orientation,void 0,o,a),J(K,l,"evenColor",f.evenColor,void 0,o,a),J(K,l,"oddColor",f.oddColor,void 0,o,a),J(Number,l,"offset",f.offset,void 0,o,a),J(Number,l,"repeat",f.repeat,void 0,o,a)):_(n.polylineOutline)?(l instanceof oE||(l=new oE),f=n.polylineOutline,J(K,l,"color",f.color,void 0,o,a),J(K,l,"outlineColor",f.outlineColor,void 0,o,a),J(Number,l,"outlineWidth",f.outlineWidth,void 0,o,a)):_(n.polylineGlow)?(l instanceof ZB||(l=new ZB),f=n.polylineGlow,J(K,l,"color",f.color,void 0,o,a),J(Number,l,"glowPower",f.glowPower,void 0,o,a),J(Number,l,"taperPower",f.taperPower,void 0,o,a)):_(n.polylineArrow)?(l instanceof KB||(l=new KB),f=n.polylineArrow,J(K,l,"color",f.color,void 0,void 0,a)):_(n.polylineDash)?(l instanceof QB||(l=new QB),f=n.polylineDash,J(K,l,"color",f.color,void 0,void 0,a),J(K,l,"gapColor",f.gapColor,void 0,void 0,a),J(Number,l,"dashLength",f.dashLength,void 0,o,a),J(Number,l,"dashPattern",f.dashPattern,void 0,o,a)):_(n.checkerboard)&&(l instanceof XB||(l=new XB),f=n.checkerboard,J(K,l,"evenColor",f.evenColor,void 0,o,a),J(K,l,"oddColor",f.oddColor,void 0,o,a),J(X,l,"repeat",f.repeat,void 0,o,a)),_(c)?c.data=l:e[t]=l}function yh(e,t,n,r,o,a){if(!!_(n))if(Array.isArray(n))for(let s=0,u=n.length;s<u;++s)OJ(e,t,n[s],r,o,a);else OJ(e,t,n,r,o,a)}function $Pe(e,t,n,r){let o=t.name;_(o)&&(e.name=t.name)}function eMe(e,t,n,r){let o=t.description;_(o)&&J(String,e,"description",o,void 0,r,n)}function tMe(e,t,n,r){let o=t.position;_(o)&&WJ(e,"position",o,void 0,r,n)}function nMe(e,t,n,r){let o=t.viewFrom;_(o)&&J(x,e,"viewFrom",o,void 0,r,n)}function rMe(e,t,n,r){let o=t.orientation;_(o)&&J(je,e,"orientation",o,void 0,r,n)}function iMe(e,t,n,r){let o=t.properties;if(_(o)){_(e.properties)||(e.properties=new sd);for(let a in o)if(o.hasOwnProperty(a)){e.properties.hasProperty(a)||e.properties.addProperty(a);let s=o[a];if(Array.isArray(s))for(let u=0,l=s.length;u<l;++u)MM(DJ(s[u]),e.properties,a,s[u],void 0,r,n);else MM(DJ(s),e.properties,a,s,void 0,r,n)}}}function JF(e,t,n,r,o,a,s){let u=n.map(function(l){return AS(o,l)});if(_(r)){r=qo(r);let l=e[t];if(!(l instanceof s)){let c=new s;c.intervals.addInterval(QF(l)),e[t]=l=c}r.data=new a(u),l.intervals.addInterval(r)}else e[t]=new a(u)}function NJ(e,t,n,r){let o=n.references;_(o)?JF(e,t,o,n.interval,r,VK,dh):J(Array,e,t,n,void 0,void 0,r)}function BJ(e,t,n,r){if(!!_(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)NJ(e,t,n[o],r);else NJ(e,t,n,r)}function FJ(e,t,n,r){let o=n.references;_(o)?JF(e,t,o,n.interval,r,ZP,og):(_(n.cartesian)?n.array=x.unpackArray(n.cartesian):_(n.cartographicRadians)?n.array=x.fromRadiansArrayHeights(n.cartographicRadians):_(n.cartographicDegrees)&&(n.array=x.fromDegreesArrayHeights(n.cartographicDegrees)),_(n.array)&&J(Array,e,t,n,void 0,void 0,r))}function DS(e,t,n,r){if(!!_(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)FJ(e,t,n[o],r);else FJ(e,t,n,r)}function oMe(e){return x.unpackArray(e)}function aMe(e){return x.fromRadiansArrayHeights(e)}function sMe(e){return x.fromDegreesArrayHeights(e)}function zJ(e,t,n,r){let o=n.references;if(_(o)){let a=o.map(function(s){let u={};return JF(u,"positions",s,n.interval,r,ZP,og),u.positions});e[t]=new ZP(a)}else _(n.cartesian)?n.array=n.cartesian.map(oMe):_(n.cartographicRadians)?n.array=n.cartographicRadians.map(aMe):_(n.cartographicDegrees)&&(n.array=n.cartographicDegrees.map(sMe)),_(n.array)&&J(Array,e,t,n,void 0,void 0,r)}function uMe(e,t,n,r){if(!!_(n))if(Array.isArray(n))for(let o=0,a=n.length;o<a;++o)zJ(e,t,n[o],r);else zJ(e,t,n,r)}function lMe(e,t,n,r){let o=t.availability;if(!_(o))return;let a;if(Array.isArray(o))for(let s=0,u=o.length;s<u;++s)_(a)||(a=new eg),a.addInterval(qo(o[s]));else a=new eg,a.addInterval(qo(o));e.availability=a}function cMe(e,t,n,r,o){!_(t)||J(j0,e,"alignedAxis",t,n,r,o)}function fMe(e,t,n,r){let o=t.billboard;if(!_(o))return;let a=qo(o.interval),s=e.billboard;_(s)||(e.billboard=s=new QI),J(Boolean,s,"show",o.show,a,r,n),J(Image,s,"image",o.image,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(X,s,"pixelOffset",o.pixelOffset,a,r,n),J(x,s,"eyeOffset",o.eyeOffset,a,r,n),J(ho,s,"horizontalOrigin",o.horizontalOrigin,a,r,n),J(an,s,"verticalOrigin",o.verticalOrigin,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"color",o.color,a,r,n),J(ag,s,"rotation",o.rotation,a,r,n),cMe(s,o.alignedAxis,a,r,n),J(Boolean,s,"sizeInMeters",o.sizeInMeters,a,r,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Tt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(Tt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(Tt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,a,r,n),J(en,s,"imageSubRegion",o.imageSubRegion,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function hMe(e,t,n,r){let o=t.box;if(!_(o))return;let a=qo(o.interval),s=e.box;_(s)||(e.box=s=new JI),J(Boolean,s,"show",o.show,a,r,n),J(x,s,"dimensions",o.dimensions,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function dMe(e,t,n,r){let o=t.corridor;if(!_(o))return;let a=qo(o.interval),s=e.corridor;_(s)||(e.corridor=s=new $I),J(Boolean,s,"show",o.show,a,r,n),DS(s,"positions",o.positions,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Pt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(Ai,s,"cornerType",o.cornerType,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(ka,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function pMe(e,t,n,r){let o=t.cylinder;if(!_(o))return;let a=qo(o.interval),s=e.cylinder;_(s)||(e.cylinder=s=new eD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"length",o.length,a,r,n),J(Number,s,"topRadius",o.topRadius,a,r,n),J(Number,s,"bottomRadius",o.bottomRadius,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,a,r,n),J(Number,s,"slices",o.slices,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function mMe(e,t){let n=e.version;if(_(n)&&typeof n=="string"){let a=n.split(".");if(a.length===2){if(a[0]!=="1")throw new it("Cesium only supports CZML version 1.");t._version=n}}if(!_(t._version))throw new it("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");let r=t._documentPacket;_(e.name)&&(r.name=e.name);let o=e.clock;if(_(o)){let a=r.clock;_(a)?(a.interval=T(o.interval,a.interval),a.currentTime=T(o.currentTime,a.currentTime),a.range=T(o.range,a.range),a.step=T(o.step,a.step),a.multiplier=T(o.multiplier,a.multiplier)):r.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}function gMe(e,t,n,r){let o=t.ellipse;if(!_(o))return;let a=qo(o.interval),s=e.ellipse;_(s)||(e.ellipse=s=new tD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"semiMajorAxis",o.semiMajorAxis,a,r,n),J(Number,s,"semiMinorAxis",o.semiMinorAxis,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Pt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(ag,s,"rotation",o.rotation,a,r,n),J(ag,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(ka,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function _Me(e,t,n,r){let o=t.ellipsoid;if(!_(o))return;let a=qo(o.interval),s=e.ellipsoid;_(s)||(e.ellipsoid=s=new nD),J(Boolean,s,"show",o.show,a,r,n),J(x,s,"radii",o.radii,a,r,n),J(x,s,"innerRadii",o.innerRadii,a,r,n),J(Number,s,"minimumClock",o.minimumClock,a,r,n),J(Number,s,"maximumClock",o.maximumClock,a,r,n),J(Number,s,"minimumCone",o.minimumCone,a,r,n),J(Number,s,"maximumCone",o.maximumCone,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Number,s,"stackPartitions",o.stackPartitions,a,r,n),J(Number,s,"slicePartitions",o.slicePartitions,a,r,n),J(Number,s,"subdivisions",o.subdivisions,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function yMe(e,t,n,r){let o=t.label;if(!_(o))return;let a=qo(o.interval),s=e.label;_(s)||(e.label=s=new rD),J(Boolean,s,"show",o.show,a,r,n),J(String,s,"text",o.text,a,r,n),J(String,s,"font",o.font,a,r,n),J(dl,s,"style",o.style,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(Boolean,s,"showBackground",o.showBackground,a,r,n),J(K,s,"backgroundColor",o.backgroundColor,a,r,n),J(X,s,"backgroundPadding",o.backgroundPadding,a,r,n),J(X,s,"pixelOffset",o.pixelOffset,a,r,n),J(x,s,"eyeOffset",o.eyeOffset,a,r,n),J(ho,s,"horizontalOrigin",o.horizontalOrigin,a,r,n),J(an,s,"verticalOrigin",o.verticalOrigin,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"fillColor",o.fillColor,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Tt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(Tt,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,a,r,n),J(Tt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function vMe(e,t,n,r){let o=t.model;if(!_(o))return;let a=qo(o.interval),s=e.model;_(s)||(e.model=s=new oD),J(Boolean,s,"show",o.show,a,r,n),J(Qi.default,s,"uri",o.gltf,a,r,n),J(Number,s,"scale",o.scale,a,r,n),J(Number,s,"minimumPixelSize",o.minimumPixelSize,a,r,n),J(Number,s,"maximumScale",o.maximumScale,a,r,n),J(Boolean,s,"incrementallyLoadTextures",o.incrementallyLoadTextures,a,r,n),J(Boolean,s,"runAnimations",o.runAnimations,a,r,n),J(Boolean,s,"clampAnimations",o.clampAnimations,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"silhouetteColor",o.silhouetteColor,a,r,n),J(Number,s,"silhouetteSize",o.silhouetteSize,a,r,n),J(K,s,"color",o.color,a,r,n),J(sg,s,"colorBlendMode",o.colorBlendMode,a,r,n),J(Number,s,"colorBlendAmount",o.colorBlendAmount,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n);let u,l,c=o.nodeTransformations;if(_(c))if(Array.isArray(c))for(u=0,l=c.length;u<l;++u)VJ(s,c[u],a,r,n);else VJ(s,c,a,r,n);let f=o.articulations;if(_(f))if(Array.isArray(f))for(u=0,l=f.length;u<l;++u)kJ(s,f[u],a,r,n);else kJ(s,f,a,r,n)}function VJ(e,t,n,r,o){let a=qo(t.interval);_(n)&&(_(a)?a=ri.intersect(a,n,Qy):a=n);let s=e.nodeTransformations,u=Object.keys(t);for(let l=0,c=u.length;l<c;++l){let f=u[l];if(f==="interval")continue;let h=t[f];if(!_(h))continue;_(s)||(e.nodeTransformations=s=new sd),s.hasProperty(f)||s.addProperty(f);let d=s[f];_(d)||(s[f]=d=new iD),J(x,d,"translation",h.translation,a,r,o),J(je,d,"rotation",h.rotation,a,r,o),J(x,d,"scale",h.scale,a,r,o)}}function kJ(e,t,n,r,o){let a=qo(t.interval);_(n)&&(_(a)?a=ri.intersect(a,n,Qy):a=n);let s=e.articulations,u=Object.keys(t);for(let l=0,c=u.length;l<c;++l){let f=u[l];if(f==="interval")continue;let h=t[f];!_(h)||(_(s)||(e.articulations=s=new sd),s.hasProperty(f)||s.addProperty(f),J(Number,s,f,h,a,r,o))}}function CMe(e,t,n,r){let o=t.path;if(!_(o))return;let a=qo(o.interval),s=e.path;_(s)||(e.path=s=new sD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"leadTime",o.leadTime,a,r,n),J(Number,s,"trailTime",o.trailTime,a,r,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"resolution",o.resolution,a,r,n),yh(s,"material",o.material,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function xMe(e,t,n,r){let o=t.point;if(!_(o))return;let a=qo(o.interval),s=e.point;_(s)||(e.point=s=new uD),J(Boolean,s,"show",o.show,a,r,n),J(Number,s,"pixelSize",o.pixelSize,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(K,s,"color",o.color,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Tt,s,"scaleByDistance",o.scaleByDistance,a,r,n),J(Tt,s,"translucencyByDistance",o.translucencyByDistance,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,a,r,n)}function IS(e){this.polygon=e,this._definitionChanged=new Event}Object.defineProperties(IS.prototype,{isConstant:{get:function(){let e=this.polygon._positions,t=this.polygon._holes;return(!_(e)||e.isConstant)&&(!_(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}});IS.prototype.getValue=function(e,t){let n;_(this.polygon._positions)&&(n=this.polygon._positions.getValue(e));let r;return _(this.polygon._holes)&&(r=this.polygon._holes.getValue(e),_(r)&&(r=r.map(function(o){return new ty(o)}))),_(t)?(t.positions=n,t.holes=r,t):new ty(n,r)};IS.prototype.equals=function(e){return this===e||e instanceof IS&&ye.equals(this.polygon._positions,e.polygon._positions)&&ye.equals(this.polygon._holes,e.polygon._holes)};function wMe(e,t,n,r){let o=t.polygon;if(!_(o))return;let a=qo(o.interval),s=e.polygon;_(s)||(e.polygon=s=new lD),J(Boolean,s,"show",o.show,a,r,n),DS(s,"_positions",o.positions,n),uMe(s,"_holes",o.holes,n),(_(s._positions)||_(s._holes))&&(s.hierarchy=new IS(s)),J(Number,s,"height",o.height,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Pt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(ag,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(Boolean,s,"perPositionHeight",o.perPositionHeight,a,r,n),J(Boolean,s,"closeTop",o.closeTop,a,r,n),J(Boolean,s,"closeBottom",o.closeBottom,a,r,n),J(Na,s,"arcType",o.arcType,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(ka,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function EMe(e){return e?Na.GEODESIC:Na.NONE}function TMe(e,t,n,r){let o=t.polyline;if(!_(o))return;let a=qo(o.interval),s=e.polyline;if(_(s)||(e.polyline=s=new cD),J(Boolean,s,"show",o.show,a,r,n),DS(s,"positions",o.positions,n),J(Number,s,"width",o.width,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),yh(s,"material",o.material,a,r,n),yh(s,"depthFailMaterial",o.depthFailMaterial,a,r,n),J(Na,s,"arcType",o.arcType,a,r,n),J(Boolean,s,"clampToGround",o.clampToGround,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(ka,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n),_(o.followSurface)&&!_(o.arcType)){let u={};J(Boolean,u,"followSurface",o.followSurface,a,r,n),s.arcType=HPe(u.followSurface,EMe)}}function SMe(e,t,n,r){let o=t.rectangle;if(!_(o))return;let a=qo(o.interval),s=e.rectangle;_(s)||(e.rectangle=s=new fD),J(Boolean,s,"show",o.show,a,r,n),J(ln,s,"coordinates",o.coordinates,a,r,n),J(Number,s,"height",o.height,a,r,n),J(Pt,s,"heightReference",o.heightReference,a,r,n),J(Number,s,"extrudedHeight",o.extrudedHeight,a,r,n),J(Pt,s,"extrudedHeightReference",o.extrudedHeightReference,a,r,n),J(ag,s,"rotation",o.rotation,a,r,n),J(ag,s,"stRotation",o.stRotation,a,r,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n),J(ka,s,"classificationType",o.classificationType,a,r,n),J(Number,s,"zIndex",o.zIndex,a,r,n)}function AMe(e,t,n,r){let o=t.tileset;if(!_(o))return;let a=qo(o.interval),s=e.tileset;_(s)||(e.tileset=s=new aD),J(Boolean,s,"show",o.show,a,r,n),J(Qi.default,s,"uri",o.uri,a,r,n),J(Number,s,"maximumScreenSpaceError",o.maximumScreenSpaceError,a,r,n)}function bMe(e,t,n,r){let o=t.wall;if(!_(o))return;let a=qo(o.interval),s=e.wall;_(s)||(e.wall=s=new hD),J(Boolean,s,"show",o.show,a,r,n),DS(s,"positions",o.positions,n),BJ(s,"minimumHeights",o.minimumHeights,n),BJ(s,"maximumHeights",o.maximumHeights,n),J(Number,s,"granularity",o.granularity,a,r,n),J(Boolean,s,"fill",o.fill,a,r,n),yh(s,"material",o.material,a,r,n),J(Boolean,s,"outline",o.outline,a,r,n),J(K,s,"outlineColor",o.outlineColor,a,r,n),J(Number,s,"outlineWidth",o.outlineWidth,a,r,n),J(ro,s,"shadows",o.shadows,a,r,n),J(gn,s,"distanceDisplayCondition",o.distanceDisplayCondition,a,r,n)}function GJ(e,t,n,r,o,a,s){let u=n.id;if(_(u)||(u=_i()),KF=u,!_(s._version)&&u!=="document")throw new it("The first CZML packet is required to be the document object.");if(n.delete===!0)r.removeById(u);else if(u==="document")mMe(n,s);else{let l;if(u!=="CustomPrimitive"){l=r.getOrCreateEntity(u);let c=n.parent;_(c)&&(l.parent=r.getOrCreateEntity(c))}else{let c=n.parent;n.viewer=e,_(c)&&(n.parentEntity=r.getOrCreateEntity(c)),n.movingTarget&&(n.receiveData=new Event,n.addReceiveDataListener=function(f,h){switch(f){case Re.NET_MSG_TSPI:return n.receiveData.addEventListener(h)}})}for(let c=o.length-1;c>-1;c--)o[c](l,n,r,a,t)}KF=void 0}function IMe(e,t,n,r,o){let a=t.parseArrayRadar;if(!_(a))return;let s;if(_(t.CustomOrientation)){let c=t.CustomOrientation,f=UJ(je,c,r);s=new ig(je),s.addSamplesPackedArray(f,c.epoch),bS(c,s)}let u=_(a.color)?Zy(a.color):void 0,l=new sC({viewer:t.viewer,id:t.CustomName,position:t.parentEntity.position,orientation:s,radius:a.radius,showScan:a.showScan,showLines:a.showLines,showSurfaces:a.showSurfaces,color:u,show:a.show,lineColor:_(a.lineColor)?Zy(a.lineColor):void 0,yawSpan:a.yawSpan,pitchSpan:a.pitchSpan,direction:a.direction});o&&o.push(l)}function DMe(e,t,n,r,o){let a=t.customizedPARadar;if(!_(a))return;let s=a.yawRange;s&&s.length===2&&(s=new X(s[0],s[1]));let u=a.pitchRange;u&&u.length===2&&(u=new X(u[0],u[1]));let l=new fC({viewer:t.viewer,id:t.CustomName,show:a.show,position:t.parentEntity.position,showScan:a.showScan,renderStyle:a.renderStyle,outRadius:a.outRadius,inRadius:a.inRadius,color:_(a.color)?Zy(a.color):void 0,lineColor:_(a.lineColor)?Zy(a.lineColor):void 0,yawRange:s,pitchRange:u,circleDensity:a.circleDensity,ms:a.ms});o&&o.push(l)}function PMe(e,t,n,r,o){let a=t.mechanicalRadar;if(!_(a))return;let s=a.position.cartesian;if(!_(s))return;let u=new Kg({viewer:t.viewer,id:t.CustomName,show:a.show,position:new x(s[0],s[1],s[2]),showScan:a.showScan,startYaw:a.startYaw,endYaw:a.endYaw,angularRate:a.angularRate,envelopeColor:a.envelopeColor,sectorColor:a.sectorColor,radius:a.radius});o&&o.push(u)}function MMe(e,t,n,r,o){let a=t.vehicleRadar;if(!_(a))return;let s=a.position.cartesian;if(!_(s))return;let u=_(a.color)?Zy(a.color):void 0,l=_(a.scanPlaneColor)?Zy(a.scanPlaneColor):void 0,c=new jg({viewer:t.viewer,id:t.id,show:a.show,position:new x(s[0],s[1],s[2]),radius:a.radius,color:u,showScanPlane:a.showScanPlane,scanPlaneColor:l,scanPlaneRate:a.scanPlaneRate});o&&o.push(c)}function LMe(e,t,n,r,o){let a=t.customCylider;if(!_(a))return;J(Boolean,t,"show",a.show,void 0,r,n),DS(t,"positions",a.positions,n);let s=[x.ZERO,new x(1,1,1)];if(t.viewer.scene.preRender.addEventListener(function(){let f=t.viewer.scene.frameState.time;e&&e._cylinder._show.getValue(f)&&(s=t.positions.getValue(f))}),!_(a.material))return;let u=T(Zy(a.material.color),K.YELLOW.withAlpha(1)),l=T(a.material.duration,3e3),c=T(Pa(a.material.trailImage),Pa("Assets/EMExtensions/downwave.png"));e=t.viewer.entities.add({id:t.CustomName,orientation:new Ks(function(){let f=OMe(s[0],s[1]);return f.pitch+=Math.PI_OVER_TWO,f.heading-=Math.PI_OVER_TWO,yn.headingPitchRollQuaternion(s[1],f)},!1),position:new Ks(function(){let f=x.subtract(s[0],s[1],new x),h=x.divideByScalar(f,2,new x);return x.add(h,s[1],new x)},!1),cylinder:{show:t.show,length:new Ks(function(){return x.distance(s[0],s[1])},!1),topRadius:1e3,bottomRadius:0,showBottom:!1,showTop:!1,changeStCoordinate:!0,material:new kK({color:u,duration:l,trailImage:c})}}),o&&o.push(e)}function RMe(e,t,n,r,o){let a=t.movingTarget;if(!_(a))return;let s,u,l;a.color==="Red"?(s=0,u=new K(1,0,0,1),l=new K(1,0,0,1)):(s=1,u=new K(0,0,1,1),l=new K(0,0,1,1));let c=qo(t.timeInterval),f=new gh({viewer:t.viewer,ev_dataMgr:t,retainOutdatedData:!0}),h=new Pu({uId:t.CustomName,mtType:a.type,name:t.CustomName,modelType:a.type,modelUri:Pa(a.modelUri),modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(a.scale),sectorRadarVisible:a.sectorRadarVisible,trace:{traceTimeDuration:a.traceTimeDuration,upOffset:a.upOffset},modelLabelVisible:a.modelLabelVisible,modelLabelPullWireColor:l,modelLabelTextColor:u}),p=a.position.cartesian,g=a.orientation.unitQuaternion,y=[];for(let E=1;E<g.length;E+=5)y.push(g[E]),y.push(g[E+1]),y.push(g[E+2]),y.push(g[E+3]);let v=fe.toDate(c.start);v=v.getTime();let w=new Va;for(let E=0;E<p.length;E+=4){let S=ce.fromCartesian(new x(p[E+1],p[E+2],p[E+3]),Ge.WGS84),A=Math.toDegrees(S.longitude),D=Math.toDegrees(S.latitude),P=S.height;h.addTimeAttitude({realTime:v+p[E]*1e3,fLon:A,fLat:D,fAlt:P,position:new x(p[E+1],p[E+2],p[E+3]),nRedOrBlue:s,headingPitchRoll:Fc.fromQuaternion(new je(y[E+1],y[E+2],y[E+3],y[E]))})}w.set(h.uId,h),t.receiveData.raiseEvent(w,Br.ADD);let C=new _h({showBackground:!0});C.addDisplayFieldPara("","name"),C.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),C.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),C.addDisplayFieldPara("\u9AD8\u5EA6:","fAlt",2),f.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,C),f.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,C),f.setTraceVisible(Hi.Ribbon,Re.NET_MSG_MIN,!0),f.graduatedColors.set(0,{traceRibbonColor:new K(1,0,0,1)}),f.graduatedColors.set(1,{traceRibbonColor:new K(0,0,1,1)})}function Zy(e){let t=e.split(","),n=Number(t[0].slice(t[0].indexOf("(")+1));n!==0&&(n=n/255);let r=Number(t[1]);r!==0&&(r=r/255);let o=Number(t[2]);o!==0&&(o=o/255);let a=Number(t[3].slice(0,t[3].indexOf(")")))/255;return new K(n,r,o,a)}function OMe(e,t){let n=yn.eastNorthUpToFixedFrame(e),r=x.subtract(t,e,new x),o=U.multiplyByPointAsVector(U.inverse(n,new U),r,new x),a=x.normalize(o,new x),s=Math.atan2(a.y,a.x)-Math.PI_OVER_TWO,u=Math.TWO_PI-Math.zeroToTwoPi(s),l=yn.eastNorthUpToFixedFrame(e);o=x.subtract(t,e,new x);let c=U.multiplyByPointAsVector(U.inverse(l,l),o,o);x.normalize(c,c);let f=Math.PI_OVER_TWO-Math.acosClamped(c.z);return new Fc(u,f,0)}function NMe(e){let t,n=e._documentPacket.clock;if(!_(n)){if(!_(e._clock)){let o=e._entityCollection.computeAvailability();if(!o.start.equals(ps.MINIMUM_VALUE)){let a=o.start,s=o.stop,u=fe.secondsDifference(s,a),l=Math.round(u/120);return t=new WB,t.startTime=fe.clone(a),t.stopTime=fe.clone(s),t.clockRange=uf.LOOP_STOP,t.multiplier=l,t.currentTime=fe.clone(a),t.clockStep=uu.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}_(e._clock)?t=e._clock.clone():(t=new WB,t.startTime=ps.MINIMUM_VALUE.clone(),t.stopTime=ps.MAXIMUM_VALUE.clone(),t.currentTime=ps.MINIMUM_VALUE.clone(),t.clockRange=uf.LOOP_STOP,t.clockStep=uu.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);let r=qo(n.interval);return _(r)&&(t.startTime=r.start,t.stopTime=r.stop),_(n.currentTime)&&(t.currentTime=fe.fromIso8601(n.currentTime)),_(n.range)&&(t.clockRange=T(uf[n.range],uf.LOOP_STOP)),_(n.step)&&(t.clockStep=T(uu[n.step],uu.SYSTEM_CLOCK_MULTIPLIER)),_(n.multiplier)&&(t.multiplier=n.multiplier),t.equals(e._clock)?!1:(e._clock=t.clone(e._clock),!0)}function YJ(e,t,n,r){n=T(n,T.EMPTY_OBJECT);let o=t,a=n.sourceUri,s=n.credit;if(typeof s=="string"&&(s=new Ai(s)),e._credit=s,typeof t=="string"||t instanceof _t){t=_t.createIfNeeded(t),o=t.fetchJson(),a=T(a,t.clone());let u=e._resourceCredits,l=t.credits;if(_(l)){let c=l.length;for(let f=0;f<c;f++)u.push(l[f])}}return a=_t.createIfNeeded(a),sS.setLoading(e,!0),Promise.resolve(o).then(function(u){return BMe(e,u,a,r)}).catch(function(u){return sS.setLoading(e,!1),e._error.raiseEvent(e,u),console.log(u),Promise.reject(u)})}function BMe(e,t,n,r){sS.setLoading(e,!0);let o=e._entityCollection;r&&(e._version=void 0,e._documentPacket=new XJ,o.removeAll()),ff._processCzml(t,o,n,void 0,e);let a=NMe(e),s=e._documentPacket;return _(s.name)&&e._name!==s.name?(e._name=s.name,a=!0):!_(e._name)&&_(n)&&(e._name=mj(n.getUrlComponent()),a=!0),sS.setLoading(e,!1),a&&e._changed.raiseEvent(e),e}function XJ(){this.name=void 0,this.clock=void 0}function ff(e){this._name=e,this._changed=new Event,this._error=new Event,this._isLoading=!1,this._loading=new Event,this._clock=void 0,this._documentPacket=new XJ,this._version=void 0,this._entityCollection=new zK(this),this._entityCluster=new BK,this._credit=void 0,this._resourceCredits=[]}ff.load=function(e,t){if(!_(t.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");return this.viewer=t.viewer,this.geometryArr=t.geometryArr,new ff().load(e,t)};Object.defineProperties(ff.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}});ff.updaters=[fMe,hMe,dMe,pMe,gMe,_Me,yMe,vMe,$Pe,eMe,CMe,xMe,wMe,TMe,iMe,SMe,tMe,AMe,nMe,bMe,rMe,lMe,IMe,DMe,PMe,MMe,LMe,RMe];ff.prototype.process=function(e,t){return YJ(this,e,t,!1)};ff.prototype.load=function(e,t){return YJ(this,e,t,!0)};ff.processPacketData=J;ff.processPositionPacketData=WJ;ff.processMaterialPacketData=yh;ff._processCzml=function(e,t,n,r,o){if(r=T(r,ff.updaters),Array.isArray(e))for(let a=0,s=e.length;a<s;++a)GJ(this.viewer,this.geometryArr,e[a],t,r,n,o);else GJ(this.viewer,this.geometryArr,e,t,r,n,o)};var LM=ff;var FMe="czm_material czm_getMaterial(czm_materialInput materialInput)   {      czm_material material = czm_getDefaultMaterial(materialInput);      vec2 st = materialInput.st;      vec4 colorImage;      if(reverse == true){        colorImage = texture2D(image, vec2(fract((-st.s - offset) * quantity), st.t));      }else{        colorImage = texture2D(image, vec2(fract((st.s - offset) * quantity), st.t));      }      material.diffuse = colorImage.rgb;      material.alpha = colorImage.a * alpha;      return material;   }";function PS(e){e=T(e,{}),this._definitionChanged=new xe,this._image=void 0,this._speed=void 0,this._quantity=void 0,this._reverse=void 0,this._alpha=void 0,this._ready=!1,this.duration=T(e.duration,60),this.quantity=T(e.quantity,1),this.reverse=T(e.reverse,!1),this.alpha=T(e.alpha,1),this.clock=e.clock,this._offset=0,this._frames=0,this._readyPromise=Ro(),this.image=e.image,this._startTime=fe.now()}Object.defineProperties(PS.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},image:{get:function(){return this._image},set:function(e){if(e instanceof Image)this._image=e,this._ready=!0,this._readyPromise.resolve(!0);else if(typeof e=="string"){let t=this;_t.createIfNeeded(e).fetchImage().then(function(n){t._image=n,t._ready=!0,t._readyPromise.resolve(!0)})}else e===void 0?this._ready=!0:console.error("invalid image!")}},quantity:{get:function(){return this._quantity},set:function(e){typeof e=="number"?e>=0?this._quantity=Math.round(e):(console.log("invalid 'quantity' value!"),this._quantity===void 0&&(this._quantity=1)):(console.log("'quantity' value is not a number!"),this._quantity===void 0&&(this._quantity=1))}},reverse:{get:function(){return this._reverse},set:function(e){typeof e=="boolean"?this._reverse!==e&&(this._reverse=e):(e=Boolean(e),this._reverse!==e&&(this._reverse=e))}},alpha:{get:function(){return this._alpha},set:function(e){this._alpha=e}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});pE._materialCache.addMaterial("EV_FlowMaterial",{fabric:{uniforms:{image:"",quantity:1,reverse:!1,offset:0,alpha:0},source:FMe},translucent:!0});PS.prototype.getType=function(e){return"EV_FlowMaterial"};PS.prototype.equals=function(e){return this===e};PS.prototype.getValue=function(e,t){!this._ready||(this._frames>1?t.alpha=this._alpha:this._frames++,this.clock&&(e=this.clock.currentTime),fe.greaterThan(e,this._startTime)&&(t.offset=fe.secondsDifference(e,this._startTime)/this.duration,t.offset>1&&(t.offset=t.offset-Math.floor(t.offset))),t.image=this._image?this._image:t.image,t.quantity=this._quantity,t.reverse=this._reverse)};var jJ=PS;var jl={};jl.numberOfPoints=function(e,t,n){let r=x.distance(e,t);return Math.ceil(r/n)};jl.numberOfPointsRhumbLine=function(e,t,n){let r=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(r/(n*n))))};var zMe=new ce;jl.extractHeights=function(e,t){let n=e.length,r=new Array(n);for(let o=0;o<n;o++){let a=e[o];r[o]=t.cartesianToCartographic(a,zMe).height}return r};var VMe=new U,kMe=new x,KJ=new x,GMe=new oi(x.UNIT_X,0),ZJ=new x,UMe=new oi(x.UNIT_X,0),HMe=new x,qMe=new x,ez=[];function JJ(e,t,n){let r=ez;r.length=e;let o;if(t===n){for(o=0;o<e;o++)r[o]=t;return r}let s=(n-t)/e;for(o=0;o<e;o++){let u=t+o*s;r[o]=u}return r}var OM=new ce,RM=new ce,K0=new x,tz=new x,WMe=new x,$F=new t0,MS=new up;function YMe(e,t,n,r,o,a,s,u){let l=r.scaleToGeodeticSurface(e,tz),c=r.scaleToGeodeticSurface(t,WMe),f=jl.numberOfPoints(e,t,n),h=r.cartesianToCartographic(l,OM),d=r.cartesianToCartographic(c,RM),p=JJ(f,o,a);$F.setEndPoints(h,d);let g=$F.surfaceDistance/f,y=u;h.height=o;let v=r.cartographicToCartesian(h,K0);x.pack(v,s,y),y+=3;for(let w=1;w<f;w++){let C=$F.interpolateUsingSurfaceDistance(w*g,RM);C.height=p[w],v=r.cartographicToCartesian(C,K0),x.pack(v,s,y),y+=3}return y}function XMe(e,t,n,r,o,a,s,u){let l=r.cartesianToCartographic(e,OM),c=r.cartesianToCartographic(t,RM),f=jl.numberOfPointsRhumbLine(l,c,n);l.height=0,c.height=0;let h=JJ(f,o,a);MS.ellipsoid.equals(r)||(MS=new up(void 0,void 0,r)),MS.setEndPoints(l,c);let d=MS.surfaceDistance/f,p=u;l.height=o;let g=r.cartographicToCartesian(l,K0);x.pack(g,s,p),p+=3;for(let y=1;y<f;y++){let v=MS.interpolateUsingSurfaceDistance(y*d,RM);v.height=h[y],g=r.cartographicToCartesian(v,K0),x.pack(g,s,p),p+=3}return p}jl.wrapLongitude=function(e,t){let n=[],r=[];if(_(e)&&e.length>0){t=T(t,U.IDENTITY);let o=U.inverseTransformation(t,VMe),a=U.multiplyByPoint(o,x.ZERO,kMe),s=x.normalize(U.multiplyByPointAsVector(o,x.UNIT_Y,KJ),KJ),u=oi.fromPointNormal(a,s,GMe),l=x.normalize(U.multiplyByPointAsVector(o,x.UNIT_X,ZJ),ZJ),c=oi.fromPointNormal(a,l,UMe),f=1;n.push(x.clone(e[0]));let h=n[0],d=e.length;for(let p=1;p<d;++p){let g=e[p];if(oi.getPointDistance(c,h)<0||oi.getPointDistance(c,g)<0){let y=Wc.lineSegmentPlane(h,g,u,HMe);if(_(y)){let v=x.multiplyByScalar(s,5e-9,qMe);oi.getPointDistance(u,h)<0&&x.negate(v,v),n.push(x.add(y,v,new x)),r.push(f+1),x.negate(v,v),n.push(x.add(y,v,new x)),f=1}}n.push(x.clone(e[p])),f++,h=g}r.push(f)}return{positions:n,lengths:r}};jl.generateArc=function(e){_(e)||(e={});let t=e.positions,n=t.length,r=T(e.ellipsoid,Ge.WGS84),o=T(e.height,0),a=Array.isArray(o);if(n<1)return[];if(n===1){let y=r.scaleToGeodeticSurface(t[0],tz);if(o=a?o[0]:o,o!==0){let v=r.geodeticSurfaceNormal(y,K0);x.multiplyByScalar(v,o,v),x.add(y,v,y)}return[y.x,y.y,y.z]}let s=e.minDistance;if(!_(s)){let y=T(e.granularity,z.RADIANS_PER_DEGREE);s=z.chordLength(y,r.maximumRadius)}let u=0,l;for(l=0;l<n-1;l++)u+=jl.numberOfPoints(t[l],t[l+1],s);let c=(u+1)*3,f=new Array(c),h=0;for(l=0;l<n-1;l++){let y=t[l],v=t[l+1],w=a?o[l]:o,C=a?o[l+1]:o;h=YMe(y,v,s,r,w,C,f,h)}ez.length=0;let d=t[n-1],p=r.cartesianToCartographic(d,OM);p.height=a?o[n-1]:o;let g=r.cartographicToCartesian(p,K0);return x.pack(g,f,c-3),f};var QJ=new ce,jMe=new ce;jl.generateRhumbArc=function(e){_(e)||(e={});let t=e.positions,n=t.length,r=T(e.ellipsoid,Ge.WGS84),o=T(e.height,0),a=Array.isArray(o);if(n<1)return[];if(n===1){let w=r.scaleToGeodeticSurface(t[0],tz);if(o=a?o[0]:o,o!==0){let C=r.geodeticSurfaceNormal(w,K0);x.multiplyByScalar(C,o,C),x.add(w,C,w)}return[w.x,w.y,w.z]}let s=T(e.granularity,z.RADIANS_PER_DEGREE),u=0,l,c=r.cartesianToCartographic(t[0],QJ),f;for(l=0;l<n-1;l++)f=r.cartesianToCartographic(t[l+1],jMe),u+=jl.numberOfPointsRhumbLine(c,f,s),c=ce.clone(f,QJ);let h=(u+1)*3,d=new Array(h),p=0;for(l=0;l<n-1;l++){let w=t[l],C=t[l+1],E=a?o[l]:o,S=a?o[l+1]:o;p=XMe(w,C,s,r,E,S,d,p)}ez.length=0;let g=t[n-1],y=r.cartesianToCartographic(g,OM);y.height=a?o[n-1]:o;let v=r.cartographicToCartesian(y,K0);return x.pack(v,d,h-3),d};jl.generateCartesianArc=function(e){let t=jl.generateArc(e),n=t.length/3,r=new Array(n);for(let o=0;o<n;o++)r[o]=x.unpack(t,o*3);return r};jl.generateCartesianRhumbArc=function(e){let t=jl.generateRhumbArc(e),n=t.length/3,r=new Array(n);for(let o=0;o<n;o++)r[o]=x.unpack(t,o*3);return r};var vh=jl;var fu=[new x,new x],KMe=new x,ZMe=new x,QMe=new x,JMe=new x,$Me=new x,eLe=new x,tLe=new x,nLe=new x,rLe=new x,rx=new x,NM=new x,LS={},nz=new ce;function iLe(e,t){let n=new Array(e.length);for(let r=0;r<e.length;r++){let o=e[r];nz=t.cartesianToCartographic(o,nz),n[r]=nz.height,e[r]=t.scaleToGeodeticSurface(o,o)}return n}function rz(e,t,n,r){let o=e[0],a=e[1],s=x.angleBetween(o,a),u=Math.ceil(s/r),l=new Array(u),c;if(t===n){for(c=0;c<u;c++)l[c]=t;return l.push(n),l}let h=(n-t)/u;for(c=1;c<u;c++){let d=t+c*h;l[c]=d}return l[0]=t,l.push(n),l}var BM=new x,FM=new x;function oLe(e,t,n,r){let o=new s0(n,r),a=o.projectPointOntoPlane(x.add(n,e,BM),BM),s=o.projectPointOntoPlane(x.add(n,t,FM),FM),u=X.angleBetween(a,s);return s.x*a.y-s.y*a.x>=0?-u:u}var aLe=new x(-1,0,0),Jy=new U,sLe=new U,iz=new ne,uLe=ne.IDENTITY.clone(),lLe=new x,cLe=new Se,$J=new x;function mg(e,t,n,r,o,a,s,u){let l=lLe,c=cLe;Jy=yn.eastNorthUpToFixedFrame(e,o,Jy),l=U.multiplyByPointAsVector(Jy,aLe,l),l=x.normalize(l,l);let f=oLe(l,t,e,o);iz=ne.fromRotationZ(f,iz),$J.z=a,Jy=U.multiplyTransformation(Jy,U.fromRotationTranslation(iz,$J,sLe),Jy);let h=uLe;h[0]=s;for(let d=0;d<u;d++)for(let p=0;p<n.length;p+=3)c=x.fromArray(n,p,c),c=ne.multiplyByVector(h,c,c),c=U.multiplyByPoint(Jy,c,c),r.push(c.x,c.y,c.z);return r}var fLe=new x;function oz(e,t,n,r,o,a,s){for(let u=0;u<e.length;u+=3){let l=x.fromArray(e,u,fLe);r=mg(l,t,n,r,o,a[u/3],s,1)}return r}function hLe(e,t){let n=e.length,r=new Array(n*6),o=0,a=t.x+t.width/2,s=t.y+t.height/2,u=e[0];r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s;for(let l=1;l<n;l++){u=e[l];let c=u.x-a,f=u.y-s;r[o++]=c,r[o++]=0,r[o++]=f,r[o++]=c,r[o++]=0,r[o++]=f}return u=e[0],r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s,r}function e$(e,t){let n=e.length,r=new Array(n*3),o=0,a=t.x+t.width/2,s=t.y+t.height/2;for(let u=0;u<n;u++)r[o++]=e[u].x-a,r[o++]=0,r[o++]=e[u].y-s;return r}var t$=new je,n$=new x,r$=new ne;function i$(e,t,n,r,o,a,s,u,l,c){let f=x.angleBetween(x.subtract(t,e,rx),x.subtract(n,e,NM)),h=r===Ai.BEVELED?0:Math.ceil(f/z.toRadians(5)),d;o?d=ne.fromQuaternion(je.fromAxisAngle(x.negate(e,rx),f/(h+1),t$),r$):d=ne.fromQuaternion(je.fromAxisAngle(e,f/(h+1),t$),r$);let p,g;if(t=x.clone(t,n$),h>0){let y=c?2:1;for(let v=0;v<h;v++)t=ne.multiplyByVector(d,t,t),p=x.subtract(t,e,rx),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(t,NM),s=mg(g,p,u,s,a,l,1,y)}else p=x.subtract(t,e,rx),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(t,NM),s=mg(g,p,u,s,a,l,1,1),n=x.clone(n,n$),p=x.subtract(n,e,rx),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(n,NM),s=mg(g,p,u,s,a,l,1,1);return s}LS.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let r=t-1,o=0;o<t;r=o++){let a=e[r],s=e[o];X.equals(a,s)||n.push(s)}return n};LS.angleIsGreaterThanPi=function(e,t,n,r){let o=new s0(n,r),a=o.projectPointOntoPlane(x.add(n,e,BM),BM),s=o.projectPointOntoPlane(x.add(n,t,FM),FM);return s.x*a.y-s.y*a.x>=0};var dLe=new x,pLe=new x;LS.computePositions=function(e,t,n,r,o){let a=r._ellipsoid,s=iLe(e,a),u=r._granularity,l=r._cornerType,c=o?hLe(t,n):e$(t,n),f=o?e$(t,n):void 0,h=n.height/2,d=n.width/2,p=e.length,g=[],y=o?[]:void 0,v=KMe,w=ZMe,C=QMe,E=JMe,S=$Me,A=eLe,D=tLe,P=nLe,M=rLe,I=e[0],O=e[1];E=a.geodeticSurfaceNormal(I,E),v=x.subtract(O,I,v),v=x.normalize(v,v),P=x.cross(E,v,P),P=x.normalize(P,P);let m=s[0],b=s[1];o&&(y=mg(I,P,f,y,a,m+h,1,1)),M=x.clone(I,M),I=O,w=x.negate(v,w);let L,R;for(let G=1;G<p-1;G++){let F=o?2:1;if(O=e[G+1],I.equals(O)){l0("Positions are too close and are considered equivalent with rounding error.");continue}v=x.subtract(O,I,v),v=x.normalize(v,v),C=x.add(v,w,C),C=x.normalize(C,C),E=a.geodeticSurfaceNormal(I,E);let k=x.multiplyByScalar(E,x.dot(v,E),dLe);x.subtract(v,k,k),x.normalize(k,k);let Z=x.multiplyByScalar(E,x.dot(w,E),pLe);if(x.subtract(w,Z,Z),x.normalize(Z,Z),!z.equalsEpsilon(Math.abs(x.dot(k,Z)),1,z.EPSILON7)){C=x.cross(C,E,C),C=x.cross(E,C,C),C=x.normalize(C,C);let oe=1/Math.max(.25,x.magnitude(x.cross(C,w,rx))),ue=LS.angleIsGreaterThanPi(v,w,I,a);ue?(S=x.add(I,x.multiplyByScalar(C,oe*d,C),S),A=x.add(S,x.multiplyByScalar(P,d,A),A),fu[0]=x.clone(M,fu[0]),fu[1]=x.clone(A,fu[1]),L=rz(fu,m+h,b+h,u),R=vh.generateArc({positions:fu,granularity:u,ellipsoid:a}),g=oz(R,P,c,g,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,d,D),D),l===Ai.ROUNDED||l===Ai.BEVELED?i$(S,A,D,l,ue,a,g,c,b+h,o):(C=x.negate(C,C),g=mg(I,C,c,g,a,b+h,oe,F)),M=x.clone(D,M)):(S=x.add(I,x.multiplyByScalar(C,oe*d,C),S),A=x.add(S,x.multiplyByScalar(P,-d,A),A),fu[0]=x.clone(M,fu[0]),fu[1]=x.clone(A,fu[1]),L=rz(fu,m+h,b+h,u),R=vh.generateArc({positions:fu,granularity:u,ellipsoid:a}),g=oz(R,P,c,g,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,-d,D),D),l===Ai.ROUNDED||l===Ai.BEVELED?i$(S,A,D,l,ue,a,g,c,b+h,o):g=mg(I,C,c,g,a,b+h,oe,F),M=x.clone(D,M)),w=x.negate(v,w)}else g=mg(M,P,c,g,a,m+h,1,1),M=I;m=b,b=s[G+1],I=O}fu[0]=x.clone(M,fu[0]),fu[1]=x.clone(I,fu[1]),L=rz(fu,m+h,b+h,u),R=vh.generateArc({positions:fu,granularity:u,ellipsoid:a}),g=oz(R,P,c,g,a,L,1),o&&(y=mg(I,P,f,y,a,b+h,1,1)),p=g.length;let N=o?p+y.length:p,B=new Float64Array(N);return B.set(g),o&&B.set(y,p),B};var RS=LS;var OS={},ix=new x,l$=new x,mLe=new x,o$=new x,Kl=[new x,new x],VM=new x,kM=new x,GM=new x,c$=new x,f$=new x,h$=new x,gLe=new x,_Le=new x,yLe=new x,vLe=new x,a$=new je,s$=new ne;function zM(e,t,n,r,o){let a=x.angleBetween(x.subtract(t,e,ix),x.subtract(n,e,l$)),s=r===Ai.BEVELED?1:Math.ceil(a/z.toRadians(5))+1,u=s*3,l=new Array(u);l[u-3]=n.x,l[u-2]=n.y,l[u-1]=n.z;let c;o?c=ne.fromQuaternion(je.fromAxisAngle(x.negate(e,ix),a/s,a$),s$):c=ne.fromQuaternion(je.fromAxisAngle(e,a/s,a$),s$);let f=0;t=x.clone(t,ix);for(let h=0;h<s;h++)t=ne.multiplyByVector(c,t,t),l[f++]=t.x,l[f++]=t.y,l[f++]=t.z;return l}function CLe(e){let t=VM,n=kM,r=GM,o=e[1];n=x.fromArray(e[1],o.length-3,n),r=x.fromArray(e[0],0,r),t=x.midpoint(n,r,t);let a=zM(t,n,r,Ai.ROUNDED,!1),s=e.length-1,u=e[s-1];o=e[s],n=x.fromArray(u,u.length-3,n),r=x.fromArray(o,0,r),t=x.midpoint(n,r,t);let l=zM(t,n,r,Ai.ROUNDED,!1);return[a,l]}function u$(e,t,n,r){let o=ix;return r?o=x.add(e,t,o):(t=x.negate(t,t),o=x.add(e,t,o)),[o.x,o.y,o.z,n.x,n.y,n.z]}function az(e,t,n,r){let o=new Array(e.length),a=new Array(e.length),s=x.multiplyByScalar(t,n,ix),u=x.negate(s,l$),l=0,c=e.length-1;for(let f=0;f<e.length;f+=3){let h=x.fromArray(e,f,mLe),d=x.add(h,u,o$);o[l++]=d.x,o[l++]=d.y,o[l++]=d.z;let p=x.add(h,s,o$);a[c--]=p.z,a[c--]=p.y,a[c--]=p.x}return r.push(o,a),r}function xLe(e,t){let n=e[0],r=e[1],o=e[2],a=new x,s=new x,u=new x,l=1/(t+1),c=0,f=new Array(t);for(let h=0;h<t;h++){c=(h+1)*l;let d=(1-c)*(1-c),p=2*c*(1-c),g=c*c;x.multiplyByScalar(n,d,a),x.multiplyByScalar(r,p,s),x.multiplyByScalar(o,g,u),x.add(a,s,s),f[h]=x.add(s,u,new x)}return f}OS.addAttribute=function(e,t,n,r){let o=t.x,a=t.y,s=t.z;_(n)&&(e[n]=o,e[n+1]=a,e[n+2]=s),_(r)&&(e[r]=s,e[r-1]=a,e[r-2]=o)};var d$=new x,p$=new x;OS.computePositions=function(e){let t=e.granularity,n=e.positions,r=e.ellipsoid,o=e.width/2,a=e.cornerType,s=e.saveAttributes,u=VM,l=kM,c=GM,f=c$,h=f$,d=h$,p=gLe,g=_Le,y=yLe,v=vLe,w=[],C=s?[]:void 0,E=s?[]:void 0,S=n[0],A=n[1];l=x.normalize(x.subtract(A,S,l),l),u=r.geodeticSurfaceNormal(S,u),f=x.normalize(x.cross(u,l,f),f),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),p=x.clone(S,p),S=A,c=x.negate(l,c);let D,P=[],M,I=n.length;for(M=1;M<I-1;M++){u=r.geodeticSurfaceNormal(S,u),A=n[M+1],l=x.normalize(x.subtract(A,S,l),l),h=x.normalize(x.add(l,c,h),h);let m=x.multiplyByScalar(u,x.dot(l,u),d$);x.subtract(l,m,m),x.normalize(m,m);let b=x.multiplyByScalar(u,x.dot(c,u),p$);if(x.subtract(c,b,b),x.normalize(b,b),!z.equalsEpsilon(Math.abs(x.dot(m,b)),1,z.EPSILON7)){h=x.cross(h,u,h),h=x.cross(u,h,h),h=x.normalize(h,h);let R=o/Math.max(.25,x.magnitude(x.cross(h,c,ix))),N=RS.angleIsGreaterThanPi(l,c,S,r);h=x.multiplyByScalar(h,R,h),N?(g=x.add(S,h,g),v=x.add(g,x.multiplyByScalar(f,o,v),v),y=x.add(g,x.multiplyByScalar(f,o*2,y),y),Kl[0]=x.clone(p,Kl[0]),Kl[1]=x.clone(v,Kl[1]),D=vh.generateArc({positions:Kl,granularity:t,ellipsoid:r}),w=az(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),d=x.clone(y,d),f=x.normalize(x.cross(u,l,f),f),y=x.add(g,x.multiplyByScalar(f,o*2,y),y),p=x.add(g,x.multiplyByScalar(f,o,p),p),a===Ai.ROUNDED||a===Ai.BEVELED?P.push({leftPositions:zM(g,d,y,a,N)}):P.push({leftPositions:u$(S,x.negate(h,h),y,N)})):(y=x.add(S,h,y),v=x.add(y,x.negate(x.multiplyByScalar(f,o,v),v),v),g=x.add(y,x.negate(x.multiplyByScalar(f,o*2,g),g),g),Kl[0]=x.clone(p,Kl[0]),Kl[1]=x.clone(v,Kl[1]),D=vh.generateArc({positions:Kl,granularity:t,ellipsoid:r}),w=az(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z)),d=x.clone(g,d),f=x.normalize(x.cross(u,l,f),f),g=x.add(y,x.negate(x.multiplyByScalar(f,o*2,g),g),g),p=x.add(y,x.negate(x.multiplyByScalar(f,o,p),p),p),a===Ai.ROUNDED||a===Ai.BEVELED?P.push({rightPositions:zM(y,d,g,a,N)}):P.push({rightPositions:u$(S,h,g,N)})),c=x.negate(l,c)}S=A}u=r.geodeticSurfaceNormal(S,u),Kl[0]=x.clone(p,Kl[0]),Kl[1]=x.clone(S,Kl[1]),D=vh.generateArc({positions:Kl,granularity:t,ellipsoid:r}),w=az(D,f,o,w),s&&(C.push(f.x,f.y,f.z),E.push(u.x,u.y,u.z));let O;return a===Ai.ROUNDED&&(O=CLe(w)),{positions:w,corners:P,lefts:C,normals:E,endPositions:O}};OS.computeInterpolationPositions=function(e){let t=e.positions,n=e.width/2,r=e.globe,o=r.ellipsoid,a=e.granularity,s=e.cornerLength,u=e.height,l=T(e.heightReference,Pt.NONE),c=Math.PI;if(t.length<2)return;let f=VM,h=kM,d=GM,p=c$,g=f$,y=h$,v=new ce,w=z.toRadians(170),C=new t0(null,null,o),E=t[0],S=t[1],A=null,D=[I(t[0])];f=x.normalize(x.subtract(S,E,f),f),h=x.negate(f,h);let P=t.length-1;for(let m=1;m<P;m++){A=t[m+1],f=x.normalize(x.subtract(A,S,f),f),d=o.geodeticSurfaceNormal(S,d);let b=x.multiplyByScalar(d,x.dot(f,d),d$);x.subtract(f,b,b),x.normalize(b,b);let L=x.multiplyByScalar(d,x.dot(h,d),p$);x.subtract(h,L,L),x.normalize(L,L);let R=Math.acos(x.dot(b,L));if(R<w){let B=(s/(c-R)+n)*Math.tan((c-R)/2);if(B<=0)continue;let G=x.distance(S,A),F=x.distance(S,E);B=Math.min(B,G,F),g=x.add(S,x.multiplyByScalar(h,B,g),g),y=x.add(S,x.multiplyByScalar(f,B,y),y),M(E,g);let k=Math.ceil(s/n*10),Z=xLe([g,S,y],k);for(let te=0;te<k;te++)D.push(I(Z[te],Z[te]));D.push(I(y)),E=x.clone(y,p)}else M(E,S),E=S;S=A,h=x.negate(f,h)}M(E,S);for(let m=1;m<D.length;++m)x.equals(D[m-1],D[m])&&(D.splice(m,1),--m);return D;function M(m,b){let L=o.cartesianToCartographic(m),R=o.cartesianToCartographic(b),N=R.height-L.height;C.setEndPoints(L,R);let B=a,G=C.surfaceDistance;if(!(G<=0)){for(;B<G;)C.interpolateUsingSurfaceDistance(B,v),v.height=L.height+B/G*N,O(v),D.push(o.cartographicToCartesian(v)),B+=a;D.push(I(b))}}function I(m,b){return!_(u)&&l===Pt.NONE?b||x.clone(m):(o.cartesianToCartographic(m,v),O(v),o.cartographicToCartesian(v,b))}function O(m){if(l===Pt.CLAMP_TO_GROUND){let b=r.getHeight(m);b&&(m.height=b)}else if(typeof u=="number"){if(l===Pt.NONE)m.height=u;else if(l===Pt.RELATIVE_TO_GROUND){let b=r.getHeight(m);b?m.height=b+u:console.error("\u83B7\u53D6\u5730\u5F62\u9AD8\u7A0B\u5931\u8D25\uFF01")}}}};OS.ev_computePositions=function(e){let t=e.positions,n=e.width/2,r=T(e.ellipsoid,Ge.WGS84),o=VM,a=kM,s=GM,u=[],l=[],c=[],f=[],h=t[0],d=null;for(let p=1,g=t.length;p<g;p++)d=t[p],o=r.geodeticSurfaceNormal(h,o),a=x.subtract(d,h,a),s=x.normalize(x.cross(o,a,s),s),s=x.multiplyByScalar(s,n,s),u.push(x.add(h,s,new x)),l.push(x.subtract(h,s,new x)),c.push(o),f.push(o),h=d;for(u.push(x.add(h,s,new x)),l.push(x.subtract(h,s,new x)),c.push(o),f.push(o);u.length>0;)l.push(u.pop()),f.push(c.pop());return{positions:l,normals:f}};var m$=OS;function NS(e){this.viewer=e.viewer,this.useIndependentClock=T(e.useIndependentClock,!0);let t=T(e.speed,100),n=T(e.granularity,1e3),r=Ro();this._positionPromise=Ro(),this._readyPromise=Ro();let o=Promise.all([r.promise,this._positionPromise.promise]);if(typeof e.image=="string"){let u=new Image;u.onload=function(){r.resolve(u)},u.src=e.image}else r.resolve(e.image);let a=m$.computeInterpolationPositions({positions:e.positions,width:e.width,globe:this.viewer.scene.globe,granularity:n,cornerLength:T(e.cornerLength,e.width),height:e.height,heightReference:e.heightReference});a&&this._positionPromise.resolve(a);let s=this;o.then(function(u){let l=u[0],c=wLe(a,Na.NONE),f=0;e.imageAspectRatio?f=e.width*e.imageAspectRatio:f=e.width*(l.width/l.height);let h=Math.round(c/f)||1,d=c/t;if(s.useIndependentClock){let p=fe.now();s._clock=new A1({startTime:p,stopTime:fe.addSeconds(p,d,new fe),clockRange:uf.LOOP_STOP,shouldAnimate:!0}),s.viewer.clock.onTick.addEventListener(s._clock.tick,s._clock)}s._material=new jJ({image:l,duration:d,quantity:h,reverse:e.reverse,alpha:e.alpha,clock:s._clock}),n=Math.asin(n/2/s.viewer.scene.globe.ellipsoid.maximumRadius)*2,s._entity=s.viewer.entities.add({id:e.id,name:e.name,show:e.show,corridor:{positions:a,width:e.width,material:s._material,height:e.height,heightReference:0,cornerType:Ai.EV_ARC,granularity:n}}),s._readyPromise.resolve()})}Object.defineProperties(NS.prototype,{id:{get:function(){return this._entity.id},set:function(e){e!==this._entity.id&&(this._entity.id=e)}},name:{get:function(){return this._entity.name},set:function(e){e!==this._entity.name&&(this._entity.name=e)}},entity:{get:function(){return this._entity}},material:{get:function(){return this._material}},show:{get:function(){return this._entity.show},set:function(e){this._entity.show!==e&&(this._entity.show=e)}},positionPromise:{get:function(){return this._positionPromise}},readyPromise:{get:function(){return this._readyPromise}}});NS.prototype.play=function(){this.useIndependentClock?this._clock&&(this._clock.shouldAnimate=!0):this.viewer.clock.shouldAnimate=!0};NS.prototype.pause=function(){this.useIndependentClock?this._clock&&(this._clock.shouldAnimate=!1):this.viewer.clock.shouldAnimate=!1};NS.prototype.destroy=function(){this.viewer.entities.remove(this._entity),this._material=null,this._entity=null,this.viewer=null};function wLe(e,t){if(!Array.isArray(e)||e.length<2)return 0;let n=0,r=e.length;if(t===Na.NONE||t===Na.RHUMB)for(let o=r-1;o>0;o--)n+=x.distance(e[o],e[o-1]);else{let o=ce.fromCartesian(e[r-1]),a=new t0;for(let s=r-2;s>-1;s--){let u=ce.fromCartesian(e[s]);a.setEndPoints(o,u),n+=a.surfaceDistance,o=u}}return n}var g$=NS;function UM(e){this.viewer=e.viewer,this.viewer.clock.shouldAnimate=!0,this.trainingClock=void 0,this.receiveData=new Event,this.geometryArr=e.geometryArr,this.receiveMTFlightDatas=new Va}UM.prototype.loadCzml=function(e){let t=e.czml,n=this.viewer,r=this.viewer.dataSources.add(LM.load(t,{viewer:this.viewer,geometryArr:this.geometryArr}));n.flyTo(r),r.then(function(o){console.log(o)}).catch(function(o){console.log(o)})};UM.prototype.loadJson=function(e){let t=e.json;if(_(t)){let n=this;_t.fetchJson(t).then(function(r){if(_(r.modelList)&&r.modelList.length!==0&&_(r.offectLongitude)){console.log(r);let o=r.offectLongitude,a=r.offectLatitude,s=n.viewer.scene,u=r.modelList[0].timePositionObj.timePosition;s.camera.setView({destination:x.fromDegrees(u[1]+o,u[2]+a,5e4),orientation:{heading:Math.toRadians(0),pitch:Math.toRadians(-90),roll:0}});let l=r.wallList;if(l&&l.length!==0)for(let d=0;d<l.length;d++){let p=ELe(x.fromDegrees(l[d].position[0],l[d].position[1],l[d].position[2]),l[d].radius),g=[],y=[];for(let v=0;v<p.length;v+=1)g.push(l[d].maximumHeight),y.push(l[d].minimumHeight);n.viewer.entities.add({id:l[d].id,wall:{positions:p,maximumHeights:g,minimumHeights:y,fill:l[d].fill,material:TLe(l[d].color[0])}})}let c=r.modelList,f=c.filter(function(d){if(_(d.effectList))return d});console.log(f);for(let d=0;d<f.length;d++){let p=f[d].effectList;for(let g=0;g<p.length;g++)if(p[g].type==="dynnamicLineEffect"){let y=p[g].positions,v=[];for(let C=0;C<y.length;C++)v.push(x.fromDegrees(y[C][0],y[C][1],y[C][2]));let w=new g$({viewer:n.viewer,positions:v,width:p[g].width,height:y[0][2],granularity:10,image:Pa("Assets/EMExtensions/DataTransLine.png"),speed:100,alpha:p[g].alpha,reverse:!1})}else p[g].type==="scanRadar"&&console.log(f[d])}n.trainingClock=new A1({startTime:fe.fromDate(new Date(r.glbReferenceTime)),currentTime:fe.fromDate(new Date(r.glbReferenceTime)),stopTime:fe.fromDate(new Date(r.endTime)),clockStep:uu.SYSTEM_CLOCK_MULTIPLIER,multiplier:r.multiplier,clockRange:uf.CLAMPED}),n.ev_mtMgr=new gh({viewer:n.viewer,ev_dataMgr:n,trainingClock:n.trainingClock,useInstancedColor:!0}),c=r.modelList;for(let d=0;d<c.length;d++){let p=c[d],g,y;p.color==="Red"?(g=0,y=new K(1,0,0,1)):(g=1,y=new K(0,0,1,1)),console.log(p.scale);let v=new Pu({uId:p.id,mtType:p.type,name:p.name,modelType:p.type,modelUri:Pa(p.modelUri),modelIconUri:void 0,iconColor:void 0,modelIconDisplayDistance:void 0,scale:Number(p.scale),sectorRadarVisible:p.sectorRadarVisible,trace:{traceTimeDuration:2,upOffset:5},modelLabelVisible:p.modelLabelVisible,modelLabelTextColor:y}),w=p.timePositionObj.timePosition,C=p.timeOrientationObj.timeOrientation;for(let E=0;E<w.length;E+=4)v.addTimeAttitude({realTime:w[E],fLon:o+w[E+1],fLat:a+w[E+2],fAlt:w[E+3],position:x.fromDegrees(o+w[E+1],a+w[E+2],w[E+3]),nRedOrBlue:g,headingPitchRoll:new Fc(Math.toRadians(C[E+1]),Math.toRadians(C[E+2]),Math.toRadians(C[E+3]))});n.receiveMTFlightDatas.set(v.uId,v)}n.trainingClock.shouldAnimate=!0,n.trainingClock.tick(),n.receiveData.raiseEvent(n.receiveMTFlightDatas,Br.ADD);let h=new _h({showBackground:!0});h.addDisplayFieldPara("","name"),h.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),h.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),h.addDisplayFieldPara("\u9AD8\u5EA6:","fAlt",2),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,h),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,h),n.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_WPN_TRAJ,h),n.ev_mtMgr.setTraceVisible(Hi.Ribbon,Re.NET_MSG_MIN,!0),n.ev_mtMgr.graduatedColors.set(0,{modelColor:new K(1,0,0,1),modelLabelPullWireColor:new K(1,0,0,1),traceRibbonColor:new K(1,0,0,1)}),n.ev_mtMgr.graduatedColors.set(1,{modelColor:new K(0,0,1,1),modelLabelPullWireColor:new K(0,0,1,1),traceRibbonColor:new K(0,0,1,1)})}}).catch(function(r){throw new Le("\u52A0\u8F7Djson\u5931\u8D25")})}};function ELe(e,t){let n=yn.headingPitchRollToFixedFrame(e,Fc.fromDegrees(0,0,0),Ge.WGS84,yn.eastNorthUpToFixedFrame),r=[];for(let o=0;o<=360;o++){let a=Math.toRadians(o);r.push(new x(t*Math.cos(a),t*Math.sin(a),0))}return r=r.map(function(o){return U.multiplyByPoint(n,o,o)}),r}function TLe(e){let t=e.split(","),n=Number(t[0].slice(t[0].indexOf("(")+1));n!==0&&(n=n/255);let r=Number(t[1]);r!==0&&(r=r/255);let o=Number(t[2]);o!==0&&(o=o/255);let a=Number(t[3].slice(0,t[3].indexOf(")")));return new K(n,r,o,a)}UM.prototype.addReceiveDataListener=function(e,t){switch(e){case Re.NET_MSG_TSPI:return this.receiveData.addEventListener(t)}};var _$=UM;function qM(e,t){this._url=e,this._resource=new Cesium.Resource({url:e,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})}Object.defineProperties(qM.prototype,{});qM.prototype.getSymbolMeshJson=function(e,t){var n=y$(),r=n.ele("SOAP-ENV:Body").ele("ev1:getSymbolMesh");HM(e,r),this._resource.clone().post(n.end(),{responseType:"document",overrideMimeType:"text/xml"}).then(function(o){var a=v$(o);Cesium.defined(t)&&t(a)}).catch(function(o){Cesium.defined(t)&&t("error")})};qM.prototype.getSymbolMeshData=function(e,t){var n={libraryID:e.libraryID,symbolID:e.symbolID,symbolSpecialInfo:e.symbolSpecialInfo},r=y$(),o=r.ele("SOAP-ENV:Body").ele("ev1:getSymbolMesh");HM(n,o),this._resource.clone().post(r.end(),{responseType:"document",overrideMimeType:"text/xml"}).then(function(a){var s=v$(a);if(Cesium.defined(t)){var u=JSON.parse(s),l={code:u.code,distance:u.distance,id:u.id};if(u.AlgoTextData){l.AlgoTextData=[];for(var c=0;c<u.AlgoTextData.length;c++)l.AlgoTextData.push({TextColor:new Uint8Array(u.AlgoTextData[c].TextColor),TextIndex:new Int32Array(u.AlgoTextData[c].TextIndex),TextNormal:new Float64Array(u.AlgoTextData[c].TextNormal),TextVertex:new Float64Array(u.AlgoTextData[c].TextVertex)})}if(u.WallData){l.WallData=[];for(var c=0;c<u.WallData.length;c++)l.WallData.push({WallColor:new Uint8Array(u.WallData[c].WallColor),WallIndex:new Int32Array(u.WallData[c].WallIndex),WallNormal:new Float64Array(u.WallData[c].WallNormal),WallVertex:new Float64Array(u.WallData[c].WallVertex)})}if(u.TextData){l.TextData=[];for(var c=0;c<u.TextData.length;c++)l.TextData.push({TextColor:new Uint8Array(u.TextData[c].TextColor),TextIndex:new Int32Array(u.TextData[c].TextIndex),TextNormal:new Float64Array(u.TextData[c].TextNormal),TextVertex:new Float64Array(u.TextData[c].TextVertex)})}if(u.FillData){l.FillData=[];for(var c=0;c<u.FillData.length;c++)l.FillData.push({FillColor:new Uint8Array(u.FillData[c].FillColor),FillIndex:new Int32Array(u.FillData[c].FillIndex),FillNormal:new Float64Array(u.FillData[c].FillNormal),FillVertex:new Float64Array(u.FillData[c].FillVertex)})}if(u.MainData){l.MainData=[];for(var c=0;c<u.MainData.length;c++)l.MainData.push({MainColor:new Uint8Array(u.MainData[c].MainColor),MainIndex:new Int32Array(u.MainData[c].MainIndex),MainNormal:new Float64Array(u.MainData[c].MainNormal),MainVertex:new Float64Array(u.MainData[c].MainVertex)})}u=null,t(l)}}).catch(function(a){Cesium.defined(t)&&t("error")})};function y$(){var e=Cesium.XMLBuilder.create({"SOAP-ENV:Envelope":{"@xmlns:xsd":"http://www.w3.org/2001/XMLSchema","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xmlns:enc":"http://schemas.xmlsoap.org/soap/encoding/","@xmlns:SOAP-ENV":"http://schemas.xmlsoap.org/soap/envelope/","@xmlns:ev1":"http://gx.web.services.server.earthview/"}});return e}function HM(e,t){for(var n in e){var r=e[n];SLe(n,r,t)}}function SLe(e,t,n){if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];typeof o=="object"?HM(o,n.ele(e)):n.ele(e).text(o)}else typeof t=="object"?HM(t,n.ele(e)):n.ele(e).text(t)}function v$(e){for(var t=e.all.length,n=0;n<t;n++){var r=e.all[n],o=r.localName;if(o=="symbolDataText")return r.textContent}}var WM=qM;var C$={};function kp(e){this.olMap=e.olMap,this.layerSource=e.layerSource,this.vertexData=e.vertexData,this.symbol=e.symbol,this._show=!0,this._fillColor=void 0,this._strokeColorFlag=!0,this._strokeColor=void 0,this._markShow=!1,this._editMode=!1,this.updataFeature()}Object.defineProperties(kp.prototype,{id:{get:function(){return this.symbol._id},set:function(e){this._id=e,this.feature&&this.feature.setId(e),this.mark&&this.mark.setId("mark_"+e)}},position:{get:function(){return this.symbol.positionDegrees},set:function(e){e&&((!e||!Array.isArray(e)||!e.length===2)&&console.error("position error"),this._position=e,this.feature&&this.feature.getGeometry().setCoordinates(e),this.mark&&this.mark.getGeometry().setCoordinates(e))}},show:{get:function(){return this._show},set:function(e){this.feature._Geometry||(this.feature._Geometry=this.feature.getGeometry()),e?this.feature.setGeometry(this.feature._Geometry):(this.feature.setGeometry(void 0),this.setEditMode(!1)),this._show=e}},strokeColorFlag:{get:function(){return this._strokeColorFlag},set:function(e){this._strokeColorFlag=e,this.updataFeature()}},strokeColor:{get:function(){return this._strokeColor},set:function(e){e&&(this._strokeColor=e,this.updataFeature())}},fillColor:{get:function(){return this._fillColor},set:function(e){e&&(this._fillColor=e,this.updataFeature())}},markShow:{get:function(){return this._markShow},set:function(e){!this.value||(this.mark._Geometry||(this.mark._Geometry=this.feature.getGeometry()),e?this.mark.setGeometry(this.mark._Geometry):this.mark.setGeometry(void 0),this._markShow=e)}},editMode:{get:function(){return this._editMode},set:function(e){this._editMode!==e&&(this._editMode!==e&&this.setEditMode(e),this._editMode=e)}}});kp.prototype.updataFeature=function(){this.destroy();var e=this,t=new Image,n=this.vertexData,r=[],o=[],a=[];n.forEach(function(E,S,A){E.Text&&a.push(E),E.FillStyle==2&&o.push(E),E.FillStyle==1&&r.push(E)});var s=0,u=0,l=0,c=0;o.forEach(function(E,S,A){E.Vertexes.forEach(function(D,P,M){D.X<0&&s>D.X&&(s=D.X),D.Y<0&&u>D.Y&&(u=D.Y),l<D.X&&(l=D.X),c<D.Y&&(c=D.Y)})}),r.forEach(function(E,S,A){E.Vertexes.forEach(function(D,P,M){D.X<0&&s>D.X&&(s=D.X),D.Y<0&&u>D.Y&&(u=D.Y),l<D.X&&(l=D.X),c<D.Y&&(c=D.Y)})});var f=!1,h=0;a.forEach(function(E,S,A){function D(P,M){for(var I=0,O=/[\u4e00-\u9fa5]/,m=0;m<P.length;m++)O.test(P.charAt(m))?I+=2:I++;return I>M?I/2:M}h=D(E.Text,h),E.FontPos.X<0&&s>E.FontPos.X&&(s=E.FontPos.X),E.FontPos.Y<0&&u>E.FontPos.Y&&(u=E.FontPos.Y),l<E.FontPos.X+E.FontWidth*h&&(l=E.FontPos.X+E.FontWidth*h),c<E.FontPos.Y&&(c=E.FontPos.Y)});var d=-s+20,p=-u+20,g=[];o.forEach(function(E,S,A){E.IsClose&&E.Vertexes.push(E.Vertexes[0]),(!E.IsOutline||f)&&(g[S]='d="',E.Vertexes.forEach(function(D,P,M){P===0?g[S]+="M"+(D.X+d)+","+(D.Y+p):g[S]+=" L"+(D.X+d)+","+(D.Y+p)}),g[S]+='"')});var y=[];r.forEach(function(E,S,A){E.IsClose&&E.Vertexes.push(E.Vertexes[0]),(!E.IsOutline||f)&&(y[S]='d="',E.Vertexes.forEach(function(D,P,M){P===0?y[S]+="M"+(D.X+d)+","+(D.Y+p):y[S]+=" L"+(D.X+d)+","+(D.Y+p)}),y[S]+='"')});var v=l+d+20,w=c+p+20,C='<svg version="1.1" encoding="UTF-8" standalone="no" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="'+v+'px" heigh="'+w+'px" viewBox="0 0 '+v+" "+w+'" enable-background="new 0 0 '+v+" "+w+'" xml:space="preserve">';g.forEach(function(E,S,A){var D=o[S],P="rgba("+D.FillColor.R+","+D.FillColor.G+","+D.FillColor.B+","+D.FillColor.A+")",M="rgba("+D.LineColor.R+","+D.LineColor.G+","+D.LineColor.B+","+D.LineColor.A+")",I=D.LineWidth;if(e.fillColor||(e.fillColor=P),D.FillStyle==2){var O='<path fill="rgba(255,0,0,255)"',m=' stroke="'+M+'"';C+='<path fill="'+e.fillColor+'"'}else C+='<path fill="none"';C+=' stroke="'+M+'" stroke-opacity="1" stroke-width="'+I+'" stroke-linecap="square" stroke-linejoin="miter" stroke-miterlimit="4" transform="matrix(1,0,0,1,0,0)" font-family="SimSun" font-size="9" font-weight="400" font-style="normal" '+E+"/>",D=void 0}),y.forEach(function(E,S,A){var D=r[S],P="rgba("+D.FillColor.R+","+D.FillColor.G+","+D.FillColor.B+","+D.FillColor.A+")",M="rgba("+D.LineColor.R+","+D.LineColor.G+","+D.LineColor.B+","+D.LineColor.A+")",I=D.LineWidth;if(D.FillStyle==2){var O='<path fill="rgba(255,0,0,255)"',m=' stroke="'+M+'"';C+='<path fill="'+P+'"'}else C+='<path fill="none"';e.strokeColorFlag&&(e._strokeColor=M),C+=' stroke="'+e.strokeColor+'" stroke-opacity="1" stroke-width="'+I+'" stroke-linecap="square" stroke-linejoin="miter" stroke-miterlimit="4" transform="matrix(1,0,0,1,0,0)" font-family="SimSun" font-size="9" font-weight="400" font-style="normal" '+E+"/>",D=void 0}),a.forEach(function(E,S,A){var D=E.FontPos.X+d,P=E.FontPos.Y+p-22,M="rgba("+E.FontColor.R+","+E.FontColor.G+","+E.FontColor.B+","+E.FontColor.A+")",I=E.FontHeight,O=E.FontWidth*h,m=E.FontName;C+='<text x="'+D+'" y="'+P+'" font-family="'+m+'" font-size="'+I+'" textLength="'+O+'" transform="matrix(1, 0, 0, 1, 0,'+I+')" fill="'+M+'">'+E.Text+"</text>"}),C+="</svg>",t.src="data:image/svg+xml,"+encodeURI(C),this.featureStyle=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[v,w],scale:.05})}),this.drawFeature(this.id)};kp.prototype.setEditMode=function(e,t){!t&&t!=="false"&&(t=!0),!(this.editMode===e||!t)&&(this._editMode=e,e?t&&this.drawMark(this.id):t&&this.destoryMark())};kp.prototype.drawFeature=function(e){this.destoryFeature();var t=this;e||(e=this.id),this.feature=new ol.Feature({geometry:new ol.geom.Point(t.position)}),this.feature.type=0,this.feature.setId(this._id),this.featureStyle&&this.feature.setStyle(this.featureStyle)};kp.prototype.drawMark=function(e){this.destoryMark();var t=this;e||(e=this.id),this.mark=new ol.Feature({geometry:new ol.geom.Point(t.position)}),this.mark.setId("mark_"+e),this.layerSource.addFeature(this.mark)};kp.prototype.isDestroyed=function(){return!1};kp.prototype.destroy=function(){delete this};kp.prototype.destoryFeature=function(){this.feature&&this.layerSource.hasFeature(this.feature)&&(this.layerSource.removeFeature(this.feature),delete this.feature)};kp.prototype.destoryMark=function(){this.mark&&this.layerSource.hasFeature(this.mark)&&(this._editMode=!1,this.layerSource.removeFeature(this.mark),delete this.mark)};var YM=kp;function $y(e){if(!(e&&e.olMap&&e.plottingService)){console.error("'EV_MilStd2DRenderManager' parameter 'options' error");return}this.olMap=e.olMap,this.plottingService=e.plottingService,ALe(this),this.symbols=new ev}$y.prototype.drawByPositions=function(e,t){var n=e.libraryID,r=e.code,o=e.type,a=e.positionDegrees,s=this.plottingService,u=e.isExternalSetLine,l=e.isExternalSetFill,c=e.isisExternalSetInnertext,f=this;bLe({libraryID:n,code:r,type:o,mainLineColor:u?e.mainLineColor:void 0,fillMode:1,fillColor:l?e.fillColor:void 0,innerText:c?e.innertext:"",positionDegrees:a,plottingService:s}).then(function(h){e.vertexData=h,f.createRenderSymbol(e,function(d){t(d)})})};$y.prototype.createRenderSymbol=function(e,t){let n=e.vertexData,r=e.id,o=new YM({olMap:this.olMap,layerSource:this.layerSource,symbol:e,vertexData:n});this.symbols.set(r,o),this.layerSource.addFeature(o.feature),t&&t(r)};$y.prototype.getSymbol=function(e){return this.symbols.get(e)};$y.prototype.removeSymbol=function(e){var t=this.getSymbol(e);return this.layerSource.removeFeature(t.feature),this.symbols.remove(e)};$y.prototype.removeAllSymbol=function(){this.removeAll();for(var e=this.symbols.values,t=0;t<this.symbols.length;t++){var n=e[t];this.removeSymbol(n.id)}};$y.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.getSymbol(e),r=n.feature;r.getGeometry().setCoordinates(t)};function ALe(e){let t=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(188, 0, 0,0.4)"}),stroke:new ol.style.Stroke({color:"rgba(188, 0, 0,1)",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})}),zIndex:9999});e.olMap.addLayer(t),e.vectorLayer=t,e.layerSource=t.getSource()}function bLe(e){var t=e.libraryID,n=e.code,r=e.plottingService,o=Cesium.defer();if(r){var a={libraryID:t,symbolID:n,symbolSpecialInfo:'{ "ReturnSymbolDataType": "1" }'};r.getSymbolMeshJson(a,function(s){var u=JSON.parse(s),l=JSON.parse(u.symbolStyle);l&&o.resolve(l)})}return o.promise}function ev(){this._array=[],this._hash={}}Object.defineProperties(ev.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});ev.prototype.contains=function(e){if(typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number."),this._hash[e]||this._hash[e]===0||this._hash[e]==="")return!0};ev.prototype.set=function(e,t){typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number.");var n=this._hash[e];t!==n&&(this.remove(e),this._hash[e]=t,this._array.push(t))};ev.prototype.get=function(e){return typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number."),this._hash[e]||this._hash[e]===0||this._hash[e]===""?this._hash[e]:!1};ev.prototype.remove=function(e){typeof e!="string"&&typeof e!="number"&&console.error("key is required to be a string or number.");var t=this.get(e);if(t){var n=this._array;return n.splice(n.indexOf(t),1),delete this._hash[e],!0}else return!1};ev.prototype.removeAll=function(){var e=this._array;e.length>0&&(this._hash={},e.length=0)};var XM=$y;var fz=Vg(S$(),1);var HLe=new x,qLe=new x,Z0={};Z0.computeArea2D=function(e){let t=e.length,n=0;for(let r=t-1,o=0;o<t;r=o++){let a=e[r],s=e[o];n+=a.x*s.y-s.x*a.y}return n*.5};Z0.computeWindingOrder2D=function(e){return Z0.computeArea2D(e)>0?Cm.COUNTER_CLOCKWISE:Cm.CLOCKWISE};Z0.triangulate=function(e,t){let n=X.packArray(e);return(0,fz.default)(n,t,2)};var D$=new x,P$=new x,M$=new x,A$=new x,b$=new x,I$=new x,gg=new x,L$=new X,R$=new X,O$=new X,ax=new X;Z0.computeSubdivision=function(e,t,n,r,o){o=T(o,z.RADIANS_PER_DEGREE);let a=_(r),s=n.slice(0),u,l=t.length,c=new Array(l*3),f=new Array(l*2),h=0,d=0;for(u=0;u<l;u++){let E=t[u];if(c[h++]=E.x,c[h++]=E.y,c[h++]=E.z,a){let S=r[u];f[d++]=S.x,f[d++]=S.y}}let p=[],g={},y=e.maximumRadius,v=z.chordLength(o,y),w=v*v;for(;s.length>0;){let E=s.pop(),S=s.pop(),A=s.pop(),D=x.fromArray(c,A*3,D$),P=x.fromArray(c,S*3,P$),M=x.fromArray(c,E*3,M$),I,O,m;a&&(I=X.fromArray(f,A*2,L$),O=X.fromArray(f,S*2,R$),m=X.fromArray(f,E*2,O$));let b=x.multiplyByScalar(x.normalize(D,A$),y,A$),L=x.multiplyByScalar(x.normalize(P,b$),y,b$),R=x.multiplyByScalar(x.normalize(M,I$),y,I$),N=x.magnitudeSquared(x.subtract(b,L,gg)),B=x.magnitudeSquared(x.subtract(L,R,gg)),G=x.magnitudeSquared(x.subtract(R,b,gg)),F=Math.max(N,B,G),k,Z,te;F>w?N===F?(k=`${Math.min(A,S)} ${Math.max(A,S)}`,u=g[k],_(u)||(Z=x.add(D,P,gg),x.multiplyByScalar(Z,.5,Z),c.push(Z.x,Z.y,Z.z),u=c.length/3-1,g[k]=u,a&&(te=X.add(I,O,ax),X.multiplyByScalar(te,.5,te),f.push(te.x,te.y))),s.push(A,u,E),s.push(u,S,E)):B===F?(k=`${Math.min(S,E)} ${Math.max(S,E)}`,u=g[k],_(u)||(Z=x.add(P,M,gg),x.multiplyByScalar(Z,.5,Z),c.push(Z.x,Z.y,Z.z),u=c.length/3-1,g[k]=u,a&&(te=X.add(O,m,ax),X.multiplyByScalar(te,.5,te),f.push(te.x,te.y))),s.push(S,u,A),s.push(u,E,A)):G===F&&(k=`${Math.min(E,A)} ${Math.max(E,A)}`,u=g[k],_(u)||(Z=x.add(M,D,gg),x.multiplyByScalar(Z,.5,Z),c.push(Z.x,Z.y,Z.z),u=c.length/3-1,g[k]=u,a&&(te=X.add(m,I,ax),X.multiplyByScalar(te,.5,te),f.push(te.x,te.y))),s.push(E,u,S),s.push(u,A,S)):(p.push(A),p.push(S),p.push(E))}let C={attributes:{position:new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:c})},indices:p,primitiveType:rn.TRIANGLES};return a&&(C.attributes.st=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:f})),new Ci(C)};var WLe=new ce,YLe=new ce,XLe=new ce,hz=new ce;Z0.computeRhumbLineSubdivision=function(e,t,n,r,o){o=T(o,z.RADIANS_PER_DEGREE);let a=_(r),s=n.slice(0),u,l=t.length,c=new Array(l*3),f=new Array(l*2),h=0,d=0;for(u=0;u<l;u++){let A=t[u];if(c[h++]=A.x,c[h++]=A.y,c[h++]=A.z,a){let D=r[u];f[d++]=D.x,f[d++]=D.y}}let p=[],g={},y=e.maximumRadius,v=z.chordLength(o,y),w=new up(void 0,void 0,e),C=new up(void 0,void 0,e),E=new up(void 0,void 0,e);for(;s.length>0;){let A=s.pop(),D=s.pop(),P=s.pop(),M=x.fromArray(c,P*3,D$),I=x.fromArray(c,D*3,P$),O=x.fromArray(c,A*3,M$),m,b,L;a&&(m=X.fromArray(f,P*2,L$),b=X.fromArray(f,D*2,R$),L=X.fromArray(f,A*2,O$));let R=e.cartesianToCartographic(M,WLe),N=e.cartesianToCartographic(I,YLe),B=e.cartesianToCartographic(O,XLe);w.setEndPoints(R,N);let G=w.surfaceDistance;C.setEndPoints(N,B);let F=C.surfaceDistance;E.setEndPoints(B,R);let k=E.surfaceDistance,Z=Math.max(G,F,k),te,oe,ue,pe,me;Z>v?G===Z?(te=`${Math.min(P,D)} ${Math.max(P,D)}`,u=g[te],_(u)||(oe=w.interpolateUsingFraction(.5,hz),ue=(R.height+N.height)*.5,pe=x.fromRadians(oe.longitude,oe.latitude,ue,e,gg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,g[te]=u,a&&(me=X.add(m,b,ax),X.multiplyByScalar(me,.5,me),f.push(me.x,me.y))),s.push(P,u,A),s.push(u,D,A)):F===Z?(te=`${Math.min(D,A)} ${Math.max(D,A)}`,u=g[te],_(u)||(oe=C.interpolateUsingFraction(.5,hz),ue=(N.height+B.height)*.5,pe=x.fromRadians(oe.longitude,oe.latitude,ue,e,gg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,g[te]=u,a&&(me=X.add(b,L,ax),X.multiplyByScalar(me,.5,me),f.push(me.x,me.y))),s.push(D,u,P),s.push(u,A,P)):k===Z&&(te=`${Math.min(A,P)} ${Math.max(A,P)}`,u=g[te],_(u)||(oe=E.interpolateUsingFraction(.5,hz),ue=(B.height+R.height)*.5,pe=x.fromRadians(oe.longitude,oe.latitude,ue,e,gg),c.push(pe.x,pe.y,pe.z),u=c.length/3-1,g[te]=u,a&&(me=X.add(L,m,ax),X.multiplyByScalar(me,.5,me),f.push(me.x,me.y))),s.push(A,u,D),s.push(u,P,D)):(p.push(P),p.push(D),p.push(A))}let S={attributes:{position:new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:c})},indices:p,primitiveType:rn.TRIANGLES};return a&&(S.attributes.st=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:f})),new Ci(S)};Z0.scaleToGeodeticHeight=function(e,t,n,r){n=T(n,Ge.WGS84);let o=HLe,a=qLe;if(t=T(t,0),r=T(r,!0),_(e)){let s=e.length;for(let u=0;u<s;u+=3)x.fromArray(e,u,a),r&&(a=n.scaleToGeodeticSurface(a,a)),t!==0&&(o=n.geodeticSurfaceNormal(a,o),x.multiplyByScalar(o,t,o),x.add(a,o,a)),e[u]=a.x,e[u+1]=a.y,e[u+2]=a.z}return e};var sx=Z0;function jLe(e,t,n,r){let o=new i0;r.position&&(o.position=new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:e}));let a=t.length,s=e.length/3,u=(s-a*2)/(a*2),l=sx.triangulate(t),c=(u-1)*a*6+l.length*2,f=Rr.createTypedArray(s,c),h,d,p,g,y,v,w=a*2,C=0;for(h=0;h<u-1;h++){for(d=0;d<a-1;d++)p=d*2+h*a*2,v=p+w,g=p+1,y=g+w,f[C++]=g,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v;p=a*2-2+h*a*2,g=p+1,y=g+w,v=p+w,f[C++]=g,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v}if(r.st||r.tangent||r.bitangent){let A=new Float32Array(s*2),D=1/(u-1),P=1/n.height,M=n.height/2,I,O,m=0;for(h=0;h<u;h++){for(I=h*D,O=P*(t[0].y+M),A[m++]=I,A[m++]=O,d=1;d<a;d++)O=P*(t[d].y+M),A[m++]=I,A[m++]=O,A[m++]=I,A[m++]=O;O=P*(t[0].y+M),A[m++]=I,A[m++]=O}for(d=0;d<a;d++)I=0,O=P*(t[d].y+M),A[m++]=I,A[m++]=O;for(d=0;d<a;d++)I=(u-1)*D,O=P*(t[d].y+M),A[m++]=I,A[m++]=O;o.st=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:new Float32Array(A)})}let E=s-a*2;for(h=0;h<l.length;h+=3){let A=l[h]+E,D=l[h+1]+E,P=l[h+2]+E;f[C++]=A,f[C++]=D,f[C++]=P,f[C++]=P+a,f[C++]=D+a,f[C++]=A+a}let S=new Ci({attributes:o,indices:f,boundingSphere:Ee.fromVertices(e),primitiveType:rn.TRIANGLES});if(r.normal&&(S=_a.computeNormal(S)),r.tangent||r.bitangent){try{S=_a.computeTangentAndBitangent(S)}catch{l0("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(S.attributes.tangent=void 0),r.bitangent||(S.attributes.bitangent=void 0),r.st||(S.attributes.st=void 0)}return S}function kS(e){e=T(e,T.EMPTY_OBJECT);let t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=Ge.clone(T(e.ellipsoid,Ge.WGS84)),this._cornerType=T(e.cornerType,Ai.ROUNDED),this._vertexFormat=go.clone(T(e.vertexFormat,go.DEFAULT)),this._granularity=T(e.granularity,z.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";let r=1+t.length*x.packedLength;r+=1+n.length*X.packedLength,this.packedLength=r+Ge.packedLength+go.packedLength+2}kS.pack=function(e,t,n){n=T(n,0);let r,o=e._positions,a=o.length;for(t[n++]=a,r=0;r<a;++r,n+=x.packedLength)x.pack(o[r],t,n);let s=e._shape;for(a=s.length,t[n++]=a,r=0;r<a;++r,n+=X.packedLength)X.pack(s[r],t,n);return Ge.pack(e._ellipsoid,t,n),n+=Ge.packedLength,go.pack(e._vertexFormat,t,n),n+=go.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var N$=Ge.clone(Ge.UNIT_SPHERE),B$=new go,VS={polylinePositions:void 0,shapePositions:void 0,ellipsoid:N$,vertexFormat:B$,cornerType:void 0,granularity:void 0};kS.unpack=function(e,t,n){t=T(t,0);let r,o=e[t++],a=new Array(o);for(r=0;r<o;++r,t+=x.packedLength)a[r]=x.unpack(e,t);o=e[t++];let s=new Array(o);for(r=0;r<o;++r,t+=X.packedLength)s[r]=X.unpack(e,t);let u=Ge.unpack(e,t,N$);t+=Ge.packedLength;let l=go.unpack(e,t,B$);t+=go.packedLength;let c=e[t++],f=e[t];return _(n)?(n._positions=a,n._shape=s,n._ellipsoid=Ge.clone(u,n._ellipsoid),n._vertexFormat=go.clone(l,n._vertexFormat),n._cornerType=c,n._granularity=f,n):(VS.polylinePositions=a,VS.shapePositions=s,VS.cornerType=c,VS.granularity=f,new kS(VS))};var KLe=new en;kS.createGeometry=function(e){let t=e._positions,n=yC(t,x.equalsEpsilon),r=e._shape;if(r=RS.removeDuplicatesFromShape(r),n.length<2||r.length<3)return;sx.computeWindingOrder2D(r)===Cm.CLOCKWISE&&r.reverse();let o=en.fromPoints(r,KLe),a=RS.computePositions(n,r,o,e,!0);return jLe(a,r,o,e._vertexFormat)};var F$=kS;var hu=[new x,new x],ZLe=new x,QLe=new x,JLe=new x,$Le=new x,eRe=new x,tRe=new x,nRe=new x,rRe=new x,iRe=new x,ux=new x,JM=new x;function GS(){}var dz=new ce;function oRe(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++){var o=e[r];dz=t.cartesianToCartographic(o,dz),n[r]=dz.height,e[r]=t.scaleToGeodeticSurface(o,o)}return n}function pz(e,t,n,r){var o=e[0],a=e[1],s=x.angleBetween(o,a),u=Math.ceil(s/r),l=new Array(u),c;if(t===n){for(c=0;c<u;c++)l[c]=t;return l.push(n),l}var f=n-t,h=f/u;for(c=1;c<u;c++){var d=t+c*h;l[c]=d}return l[0]=t,l.push(n),l}var $M=new x,eL=new x;function aRe(e,t,n,r){var o=new s0(n,r),a=o.projectPointOntoPlane(x.add(n,e,$M),$M),s=o.projectPointOntoPlane(x.add(n,t,eL),eL),u=X.angleBetween(a,s);return s.x*a.y-s.y*a.x>=0?-u:u}var sRe=new x(-1,0,0),nv=new U,uRe=new U,mz=new ne,lRe=ne.IDENTITY.clone(),cRe=new x,fRe=new Se,z$=new x;function _g(e,t,n,r,o,a,s,u){var l=cRe,c=fRe;nv=yn.eastNorthUpToFixedFrame(e,o,nv),l=U.multiplyByPointAsVector(nv,sRe,l),l=x.normalize(l,l);var f=aRe(l,t,e,o);mz=ne.fromRotationZ(f,mz),z$.z=a,nv=U.multiplyTransformation(nv,U.fromRotationTranslation(mz,z$,uRe),nv);var h=lRe;h[0]=s;for(var d=0;d<u;d++)for(var p=0;p<n.length;p+=3)c=x.fromArray(n,p,c),c=ne.multiplyByVector(h,c,c),c=U.multiplyByPoint(nv,c,c),r.push(c.x,c.y,c.z);return r}var hRe=new x;function gz(e,t,n,r,o,a,s){for(var u=0;u<e.length;u+=3){var l=x.fromArray(e,u,hRe);r=_g(l,t,n,r,o,a[u/3],s,1)}return r}function dRe(e,t){var n=e.length,r=new Array(n*6),o=0,a=0,s=0,u=e[0];r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s;for(var l=1;l<n;l++){u=e[l];var c=u.x-a,f=u.y-s;r[o++]=c,r[o++]=0,r[o++]=f,r[o++]=c,r[o++]=0,r[o++]=f}return u=e[0],r[o++]=u.x-a,r[o++]=0,r[o++]=u.y-s,r}function V$(e,t){for(var n=e.length,r=new Array(n*3),o=0,a=0,s=0,u=0;u<n;u++)r[o++]=e[u].x-a,r[o++]=0,r[o++]=e[u].y-s;return r}var k$=new je,G$=new x,U$=new ne;function H$(e,t,n,r,o,a,s,u,l,c){var f=x.angleBetween(x.subtract(t,e,ux),x.subtract(n,e,JM)),h=r===Ai.BEVELED?0:Math.ceil(f/z.toRadians(5)),d;o?d=ne.fromQuaternion(je.fromAxisAngle(x.negate(e,ux),f/(h+1),k$),U$):d=ne.fromQuaternion(je.fromAxisAngle(e,f/(h+1),k$),U$);var p,g;if(t=x.clone(t,G$),h>0)for(var y=c?2:1,v=0;v<h;v++)t=ne.multiplyByVector(d,t,t),p=x.subtract(t,e,ux),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(t,JM),s=_g(g,p,u,s,a,l,1,y);else p=x.subtract(t,e,ux),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(t,JM),s=_g(g,p,u,s,a,l,1,1),n=x.clone(n,G$),p=x.subtract(n,e,ux),p=x.normalize(p,p),o||(p=x.negate(p,p)),g=a.scaleToGeodeticSurface(n,JM),s=_g(g,p,u,s,a,l,1,1);return s}GS.removeDuplicatesFromShape=function(e){for(var t=e.length,n=[],r=t-1,o=0;o<t;r=o++){var a=e[r],s=e[o];X.equals(a,s)||n.push(s)}return n};GS.angleIsGreaterThanPi=function(e,t,n,r){var o=new s0(n,r),a=o.projectPointOntoPlane(x.add(n,e,$M),$M),s=o.projectPointOntoPlane(x.add(n,t,eL),eL);return s.x*a.y-s.y*a.x>=0};var pRe=new x,mRe=new x;GS.computePositions=function(e,t,n,r,o){var a=r._ellipsoid,s=oRe(e,a),u=r._granularity,l=r._cornerType,c=o?dRe(t,n):V$(t,n),f=o?V$(t,n):void 0,h=n.height/2,d=n.width/2,p=e.length,g=[],y=o?[]:void 0,v=ZLe,w=QLe,C=JLe,E=$Le,S=eRe,A=tRe,D=nRe,P=rRe,M=iRe,I=e[0].clone(),O=e[1].clone();E=a.geodeticSurfaceNormal(I,E),v=x.subtract(O,I,v),v=x.normalize(v,v),P=x.cross(E,v,P),P=x.normalize(P,P);var m=s[0],b=s[1];o&&(y=_g(I,P,f,y,a,m+h,1,1)),M=x.clone(I,M),I=x.clone(O,I),w=x.negate(v,w);for(var L,R,N=1;N<p-1;N++){var B=o?2:1;O=x.clone(e[N+1],O),v=x.subtract(O,I,v),v=x.normalize(v,v),C=x.add(v,w,C),C=x.normalize(C,C),E=a.geodeticSurfaceNormal(I,E);var G=x.multiplyByScalar(E,x.dot(v,E),pRe);x.subtract(v,G,G),x.normalize(G,G);var F=x.multiplyByScalar(E,x.dot(w,E),mRe);x.subtract(w,F,F),x.normalize(F,F);var k=!z.equalsEpsilon(Math.abs(x.dot(G,F)),1,z.EPSILON7);if(k){C=x.cross(C,E,C),C=x.cross(E,C,C),C=x.normalize(C,C);var Z=1/Math.max(.25,x.magnitude(x.cross(C,w,ux))),te=GS.angleIsGreaterThanPi(v,w,I,a);te?(S=x.add(I,x.multiplyByScalar(C,Z*d,C),S),A=x.add(S,x.multiplyByScalar(P,d,A),A),hu[0]=x.clone(M,hu[0]),hu[1]=x.clone(A,hu[1]),L=pz(hu,m+h,b+h,u),R=vh.generateArc({positions:hu,granularity:u,ellipsoid:a}),g=gz(R,P,c,g,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,d,D),D),l===Ai.ROUNDED||l===Ai.BEVELED?H$(S,A,D,l,te,a,g,c,b+h,o):(C=x.negate(C,C),g=_g(I,C,c,g,a,b+h,Z,B)),M=x.clone(D,M)):(S=x.add(I,x.multiplyByScalar(C,Z*d,C),S),A=x.add(S,x.multiplyByScalar(P,-d,A),A),hu[0]=x.clone(M,hu[0]),hu[1]=x.clone(A,hu[1]),L=pz(hu,m+h,b+h,u),R=vh.generateArc({positions:hu,granularity:u,ellipsoid:a}),g=gz(R,P,c,g,a,L,1),P=x.cross(E,v,P),P=x.normalize(P,P),D=x.add(S,x.multiplyByScalar(P,-d,D),D),l===Ai.ROUNDED||l===Ai.BEVELED?H$(S,A,D,l,te,a,g,c,b+h,o):g=_g(I,C,c,g,a,b+h,Z,B),M=x.clone(D,M)),w=x.negate(v,w)}else g=_g(M,P,c,g,a,m+h,1,1),M=x.clone(I,M);m=b,b=s[N+1],I=x.clone(O,I)}hu[0]=x.clone(M,hu[0]),hu[1]=x.clone(I,hu[1]),L=pz(hu,m+h,b+h,u),R=vh.generateArc({positions:hu,granularity:u,ellipsoid:a}),g=gz(R,P,c,g,a,L,1),o&&(y=_g(I,P,f,y,a,b+h,1,1)),p=g.length;var oe=o?p+y.length:p,ue=new Float64Array(oe);return ue.set(g),o&&ue.set(y,p),ue};var US=GS;function tL(e){e=T(e,T.EMPTY_OBJECT);var t=e.polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=Ge.clone(T(e.ellipsoid,Ge.WGS84)),this._cornerType=T(e.cornerType,Ai.ROUNDED),this._vertexFormat=go.clone(T(e.vertexFormat,go.DEFAULT)),this._granularity=T(e.granularity,Cesium.Math.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry",this.isOffset=T(e.isOffset,!1),this.isMultiImage=T(e.isMultiImage,!1);var r=1+t.length*x.packedLength;r+=1+n.length*Cesium.Cartesian2.packedLength,this.packedLength=r+Ge.packedLength+go.packedLength+2+1+1}tL.pack=function(e,t,n){n=T(n,0);var r,o=e._positions,a=o.length;for(t[n++]=a,r=0;r<a;++r,n+=x.packedLength)x.pack(o[r],t,n);var s=e._shape;for(a=s.length,t[n++]=a,r=0;r<a;++r,n+=Cesium.Cartesian2.packedLength)Cesium.Cartesian2.pack(s[r],t,n);return Ge.pack(e._ellipsoid,t,n),n+=Ge.packedLength,go.pack(e._vertexFormat,t,n),n+=go.packedLength,t[n++]=e._cornerType,t[n++]=e._granularity,t[n++]=e.isOffset?1:0,t[n]=e.isMultiImage?1:0,t};var q$=Ge.clone(Ge.UNIT_SPHERE),W$=new go,rv={polylinePositions:void 0,shapePositions:void 0,ellipsoid:q$,vertexFormat:W$,cornerType:void 0,granularity:void 0,isOffset:void 0,isMultiImage:void 0};tL.unpack=function(e,t,n){t=T(t,0);var r,o=e[t++],a=new Array(o);for(r=0;r<o;++r,t+=x.packedLength)a[r]=x.unpack(e,t);o=e[t++];var s=new Array(o);for(r=0;r<o;++r,t+=Cesium.Cartesian2.packedLength)s[r]=Cesium.Cartesian2.unpack(e,t);var u=Ge.unpack(e,t,q$);t+=Ge.packedLength;var l=go.unpack(e,t,W$);t+=go.packedLength;var c=e[t++],f=e[t],h=e[++t],d=e[++t];return Cesium.defined(n)?(n._positions=a,n._shape=s,n._ellipsoid=Ge.clone(u,n._ellipsoid),n._vertexFormat=go.clone(l,n._vertexFormat),n._cornerType=c,n._granularity=f,n.isOffset=h,n.isMultiImage=d,n):(rv.polylinePositions=a,rv.shapePositions=s,rv.cornerType=c,rv.granularity=f,rv.isOffset=h,rv.isMultiImage=d,new F$(rv))};function gRe(e,t,n,r){var o=new i0;r.position&&(o.position=new xi({componentDatatype:ie.DOUBLE,componentsPerAttribute:3,values:e}));var a=t.length,s=e.length/3,u=(s-a*2)/(a*2),l=sx.triangulate(t),c=(u-1)*a*6+l.length*2,f=Rr.createTypedArray(s,c),h,d,p,g,y,v,w=a*2,C=0;for(h=0;h<u-1;h++){for(d=0;d<a-1;d++)p=d*2+h*a*2,v=p+w,g=p+1,y=g+w,f[C++]=g,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v;p=a*2-2+h*a*2,g=p+1,y=g+w,v=p+w,f[C++]=g,f[C++]=p,f[C++]=y,f[C++]=y,f[C++]=p,f[C++]=v}if(r.st||r.tangent||r.bitangent){var E=new Float32Array(s*2),S=1/(u-1),A=1/n.height,D=n.height/2,P,M,I=0;for(h=0;h<u;h++){for(P=h*S,M=A*(t[0].y+D),E[I++]=P,E[I++]=M,d=1;d<a;d++)M=A*(t[d].y+D),E[I++]=P,E[I++]=M,E[I++]=P,E[I++]=M;M=A*(t[0].y+D),E[I++]=P,E[I++]=M}for(d=0;d<a;d++)P=0,M=A*(t[d].y+D),E[I++]=P,E[I++]=M;for(d=0;d<a;d++)P=(u-1)*S,M=A*(t[d].y+D),E[I++]=P,E[I++]=M;o.st=new xi({componentDatatype:ie.FLOAT,componentsPerAttribute:2,values:new Float32Array(E)})}var O=s-a*2;for(h=0;h<l.length;h+=3){var m=l[h]+O,b=l[h+1]+O,L=l[h+2]+O;f[C++]=m,f[C++]=b,f[C++]=L,f[C++]=L+a,f[C++]=b+a,f[C++]=m+a}var R=new Ci({attributes:o,indices:f,boundingSphere:Ee.fromVertices(e),primitiveType:rn.TRIANGLES});if(r.normal&&(R=_a.computeNormal(R)),r.tangent||r.bitangent){try{R=_a.computeTangentAndBitangent(R)}catch{l0("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(R.attributes.tangent=void 0),r.bitangent||(R.attributes.bitangent=void 0),r.st||(R.attributes.st=void 0)}return R}tL.createGeometry=function(e){var t=e._positions,n=yC(t,x.equalsEpsilon),r=e._shape;if(r=US.removeDuplicatesFromShape(r),!(n.length<2||r.length<3)){sx.computeWindingOrder2D(r)===Cm.CLOCKWISE&&r.reverse();var o=en.fromPoints(r,new en),a=US.computePositions(n,r,o,e,!0);return gRe(a,r,o,e._vertexFormat)}};var iv=tL;function Hp(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.vertexData))throw new DeveloperError("EV_MilStd3DLinePrimitive options.vertexData  undefined!");this.ellipsoid=Cesium.defaultValue(e.ellipsoid,Cesium.Ellipsoid.WGS84),this.opaqueAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,translucent:!1,closed:!0}),this.transParentAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,closed:!0}),this.asynchronous=!1,this.isMilitarySymbol=!0,this.symbol=e.symbol,this._vertexData=e.vertexData,this._textureRotationAngle=Cesium.defaultValue(e.textureRotationAngle,0),this._mainLinePositionsWithText=[],this._fillPositionsWithText=[],this._wallPositionsWithText=[],this._mainLinePositions=[],this._fillPositions=[],this._originMainLineColors=[],this._originFillColors=[],this._isAnchorHeightChange=!1,this._minAnchorMarkHeight=0,this._anchorHeight=0,this._isUpdatePrimitive=!1,this.updatePrimitive()}Object.defineProperties(Hp.prototype,{vertexData:{get:function(){return this._vertexData},set:function(e){if(this._vertexData.AlgoTextData)for(var t=0;t<this._vertexData.AlgoTextData.length;t++)delete this._vertexData.AlgoTextData[t].TextColor,delete this._vertexData.AlgoTextData[t].TextIndex,delete this._vertexData.AlgoTextData[t].TextNormal,delete this._vertexData.AlgoTextData[t].TextVertex;if(this._vertexData.WallData)for(var t=0;t<this._vertexData.WallData.length;t++)delete this._vertexData.WallData[t].WallColor,delete this._vertexData.WallData[t].WallIndex,delete this._vertexData.WallData[t].WallNormal,delete this._vertexData.WallData[t].WallVertex;if(this._vertexData.FillData)for(var t=0;t<this._vertexData.FillData.length;t++)delete this._vertexData.FillData[t].FillColor,delete this._vertexData.FillData[t].FillIndex,delete this._vertexData.FillData[t].FillNormal,delete this._vertexData.FillData[t].FillVertex;if(this._vertexData.MainData)for(var t=0;t<this._vertexData.MainData.length;t++)delete this._vertexData.MainData[t].MainColor,delete this._vertexData.MainData[t].MainIndex,delete this._vertexData.MainData[t].MainNormal,delete this._vertexData.MainData[t].MainVertex;this._vertexData=e,this._isUpdatePrimitive=!0}},mainLinePositions:{get:function(){return this._mainLinePositions}}});Hp.prototype.setSurroundLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("surroundLine")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Hp.prototype.setFillColor=function(e){if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];n.indexOf("fill")>-1&&(this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};Hp.prototype.setMainLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];if(n.indexOf("mainLine")>-1){var r=new K(e.red*100/255,e.green*100/255,e.blue*100/255,e.alpha);this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(r)}}if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];if(n.indexOf("wall")>-1){var r=new K(e.red,e.green,e.blue,this.symbol.wallTransparent);this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(r)}}};Hp.prototype.updatePrimitive=function(){var e=ERe(this.symbol.positionCartographics);e>700?(this._isUpdatePrimitive=!0,this._isAnchorHeightChange=!0):this._isUpdatePrimitive=!1};Hp.prototype.update=function(e){if(!!this.symbol.show&&!(!this._isUpdatePrimitive&&!Cesium.defined(this._primitive))){if(this._isUpdatePrimitive){this._isUpdatePrimitive=!1,this._primitive=this._primitive&&this._primitive.destroy();var t=yRe(this);this._primitive=new Cesium.Primitive({geometryInstances:t,appearance:this.opaqueAppearance,asynchronous:this.asynchronous}),this._framePrimitive=this._framePrimitive&&this._framePrimitive.destroy();var n=vRe(this);this._framePrimitive=new Cesium.Primitive({geometryInstances:n,appearance:this.transParentAppearance,asynchronous:this.asynchronous})}this._primitive.update(e),this._framePrimitive&&this._framePrimitive.update(e)}};Hp.prototype.isDestroyed=function(){return!1};Hp.prototype.destroy=function(){if(this.vertexData.TextData)for(var e=0;e<this.vertexData.TextData.length;e++)delete this.vertexData.TextData[e].TextColor,delete this.vertexData.TextData[e].TextIndex,delete this.vertexData.TextData[e].TextNormal,delete this.vertexData.TextData[e].TextVertex;if(this.vertexData.FillData)for(var e=0;e<this.vertexData.FillData.length;e++)delete this.vertexData.FillData[e].FillColor,delete this.vertexData.FillData[e].FillIndex,delete this.vertexData.FillData[e].FillNormal,delete this.vertexData.FillData[e].FillVertex;if(this.vertexData.MainData)for(var e=0;e<this.vertexData.MainData.length;e++)delete this.vertexData.MainData[e].MainColor,delete this.vertexData.MainData[e].MainIndex,delete this.vertexData.MainData[e].MainNormal,delete this.vertexData.MainData[e].MainVertex;return this.vertexData=void 0,this._primitive&&(this._primitive.destroy(),this._primitive=void 0),this._framePrimitive&&(this._framePrimitive.destroy(),this._framePrimitive=void 0),Cesium.destroyObject(this)};Hp.prototype.getAnchorHeight=function(){if(this._isAnchorHeightChange){this._isAnchorHeightChange=!1;var e=-1e4,t=1e4;if(Array.isArray(this.symbol.positionCartographics)&&this.symbol.positionCartographics.forEach(r=>{e<r.height&&(e=r.height),t>r.height&&(t=r.height)}),typeof e=="number"&&typeof t=="number"){var n=this.symbol.floatHeight3D*1e3+e;if(typeof n=="number")return this._anchorHeight=n,this._minAnchorMarkHeight=t,n}}else return this._anchorHeight};function HS(e,t){for(var n=new Array(e.length/2),r=0;r<e.length;r+=2){var o=r/2;n[o]=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],t)}return n}var Up=new x;function Y$(e,t){for(var n=new Array(e.length/3),r=0;r<e.length;r+=3)Up=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],t,void 0,Up),n[r]=Up.x,n[r+1]=Up.y,n[r+2]=Up.z;return n}function _Re(e,t){for(var n=new Array(e.length/3),r=0;r<e.length;r+=3){var o=0;e[r+2]===0&&(o=t),Up=Cesium.Cartesian3.fromDegrees(e[r],e[r+1],o,void 0,Up),n[r]=Up.x,n[r+1]=Up.y,n[r+2]=Up.z}return n}function yRe(e){e._mainLinePositions=[];var t=[],n=void 0;if(e.vertexData.hasOwnProperty("AlgoTextData")){for(var c=0;c<e._mainLinePositionsWithText.length;c++)delete e._mainLinePositionsWithText[c];e._mainLinePositionsWithText=[];for(var o=0;o<e.vertexData.MainData.length;++o){var f=e.vertexData.MainData[o],h=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._mainLinePositionsWithText[o]=Y$(f.MainVertex,h),e._originMainLineColors[o]=new K(f.MainColor[0]/255,f.MainColor[1]/255,f.MainColor[2]/255,f.MainColor[3]/255);var d=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);n=nL(e._mainLinePositionsWithText[o],f.MainIndex,void 0,void 0),t[t.length]=Gp(e,n,"mianLineWithFont"+o,d)}}else if(_(e.vertexData)&&_(e.vertexData.MainData)&&e.symbol.mainLineIsTransparency===!1)for(var r=e.vertexData.MainData.length,o=0;o<r;++o){if(e._mainLinePositions[o]=HS(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight()),e._originMainLineColors.length!==r){var a=e.vertexData.MainData[o].MainColor;e._originMainLineColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.mainLineColor=e._originMainLineColors[0]}var s=X$(e);n=new iv({polylinePositions:e._mainLinePositions[o],shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,ellipsoid:e.ellipsoid,cornerType:Cesium.CornerType.MITERED});var u;e.symbol.isExternalSetLine&&_(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red*99/255,e.symbol.mainLineColor.green*99/255,e.symbol.mainLineColor.blue*99/255,e.symbol.mainLineColor.alpha):u=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);let p;if(e.symbol.mainLineIsDeepenColor?p=u:e.symbol.isExternalSetLine&&_(e.symbol.mainLineColor)?p=e.symbol.mainLineColor:p=e._originMainLineColors[o],t[t.length]=Gp(e,n,"mainLine"+o,p),e.symbol.surroundLineType==3){var s=j$(e),l=HS(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=new iv({polylinePositions:l,shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,cornerType:Cesium.CornerType.MITERED,ellipsoid:e.ellipsoid}),t[t.length]=Gp(e,n,"surroundLine"+o,e.symbol.surroundLineColor)}}return t}function vRe(e){var t=[],n=void 0;if(e.vertexData){if(e.vertexData.hasOwnProperty("AlgoTextData")){if(!e.isOnlyDrawMainLine&&e.vertexData.WallData){for(var g=0;g<e._wallPositionsWithText.length;g++)delete e._wallPositionsWithText[g];e._wallPositionsWithText=[];for(var o=0;o<e.vertexData.WallData.length;++o){var y=e.vertexData.WallData[o],v=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._wallPositionsWithText[o]=_Re(y.WallVertex,v);var w=new K(y.WallColor[0]/255,y.WallColor[1]/255,y.WallColor[2]/255,y.WallColor[3]/255);n=nL(e._wallPositionsWithText[o],y.WallIndex,void 0,void 0),t[t.length]=Gp(e,n,"wallWithFont"+o,w)}}if(!e.isOnlyDrawMainLine&&e.vertexData.FillData){for(var g=0;g<e._fillPositionsWithText.length;g++)delete e._fillPositionsWithText[g];e._fillPositionsWithText=[];for(var o=0;o<e.vertexData.FillData.length;++o){var C=e.vertexData.FillData[o],v=e.getAnchorHeight()/1e3*e.symbol.distanceLegend;e._fillPositionsWithText[o]=Y$(C.FillVertex,v);var E=new K(C.FillColor[0]/255,C.FillColor[1]/255,C.FillColor[2]/255,C.FillColor[3]/255);n=nL(e._fillPositionsWithText[o],C.FillIndex,void 0,void 0),t[t.length]=Gp(e,n,"fillWithFont"+o,E)}}if(!e.symbol.isOnlyDrawMainLine&&e.vertexData.AlgoTextData)for(var S=wRe(e.symbol.positionCartographics),v=e.symbol.positionCartographics[0].height+1500,A=Cesium.Cartesian3.fromRadians(S[0],S[1],v),D=xRe(A),o=0;o<e.vertexData.AlgoTextData.length;++o){var P=e.vertexData.AlgoTextData[o],M=new K(P.TextColor[0]/255,P.TextColor[1]/255,P.TextColor[2]/255,P.TextColor[3]/255);n=nL(P.TextVertex,P.TextIndex,P.TextNormal),t[t.length]=CRe(e,n,D,"fontWithLine"+o,M)}}else{if(_(e.vertexData)&&_(e.vertexData.MainData&&e.symbol.mainLineIsTransparency!==!1))for(var r=e.vertexData.MainData.length,o=0;o<r;++o){if(e._mainLinePositions[o]=HS(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight()),e._originMainLineColors.length!==r){var a=e.vertexData.MainData[o].MainColor;e._originMainLineColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.mainLineColor=e._originMainLineColors[0]}var s=X$(e);n=new iv({polylinePositions:e._mainLinePositions[o],shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,ellipsoid:e.ellipsoid,cornerType:Cesium.CornerType.MITERED});var u;e.symbol.isExternalSetLine&&_(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red*99/255,e.symbol.mainLineColor.green*99/255,e.symbol.mainLineColor.blue*99/255,e.symbol.mainLineColor.alpha):u=new K(e._originMainLineColors[o].red*99/255,e._originMainLineColors[o].green*99/255,e._originMainLineColors[o].blue*99/255,e._originMainLineColors[o].alpha);let I;if(e.symbol.mainLineIsDeepenColor?I=u:(e.symbol.isExternalSetLine&&_(e.symbol.mainLineColor)?I=e.symbol.mainLineColor:I=e._originMainLineColors[o],I.alpha=e.symbol.wallTransparent),t[t.length]=Gp(e,n,"mainLine"+o,I),e.symbol.surroundLineType==3){var s=j$(e),l=HS(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=new iv({polylinePositions:l,shapePositions:s,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,cornerType:Cesium.CornerType.MITERED,ellipsoid:e.ellipsoid}),t[t.length]=Gp(e,n,"surroundLine"+o,e.symbol.surroundLineColor)}}if(e.symbol.fillMode===1&&_(e.vertexData.FillData))for(var c=e.vertexData.FillData.length,o=0;o<c;++o){if(e._fillPositions[o]=Cesium.Cartesian3.fromDegreesArray(e.vertexData.FillData[o].FillVertex),e._originFillColors.length!==c){var a=e.vertexData.FillData[o].FillColor;e._originFillColors[o]=new K(a[0]/255,a[1]/255,a[2]/255,a[3]/255),e.symbol.fillColor=e._originFillColors[0]}var f=e.symbol.distanceLegend*(e.getAnchorHeight()/1e3);n=Cesium.PolygonGeometry.fromPositions({positions:e._fillPositions[o],height:f,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,stRotation:e._textureRotationAngle,ellipsoid:e.ellipsoid}),e.symbol.isExternalSetFill&&_(e.symbol.fillColor)?t[t.length]=Gp(e,n,"fill"+o,e.symbol.fillColor):t[t.length]=Gp(e,n,"fill"+o,e._originFillColors[o])}if(!e.symbol.isOnlyDrawMainLine&&e.vertexData.MainData)for(var o=0;o<e.vertexData.MainData.length;++o){var h=e.symbol.distanceLegend*(e.getAnchorHeight()/1e3),d=e.symbol.distanceLegend*e._minAnchorMarkHeight/1e3,p=HS(e.vertexData.MainData[o].MainVertex,e.getAnchorHeight());n=Cesium.WallGeometry.fromConstantHeights({positions:p,minimumHeight:d,maximumHeight:h,vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL});var u;e.symbol.isExternalSetLine&&_(e.symbol.mainLineColor)?u=new K(e.symbol.mainLineColor.red,e.symbol.mainLineColor.green,e.symbol.mainLineColor.blue,e.symbol.wallTransparent):u=new K(e._originMainLineColors[o].red,e._originMainLineColors[o].green,e._originMainLineColors[o].blue,e.symbol.wallTransparent),t[t.length]=Gp(e,n,"wall"+o,u)}}return t}}function X$(e){return Cesium.Cartesian2.unpackArray([-e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*(e.symbol.topLineHeight-e.symbol.thickness3D),e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*(e.symbol.topLineHeight-e.symbol.thickness3D),e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*e.symbol.topLineHeight,-e.symbol.distanceLegend*e.symbol.mainLineWidth,e.symbol.distanceLegend*e.symbol.topLineHeight])}function j$(e){return Cesium.Cartesian2.unpackArray([-e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*((e.symbol.topLineHeight-e.symbol.thickness3D)*.95),e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*((e.symbol.topLineHeight-e.symbol.thickness3D)*.95),e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*(e.symbol.thickness3D*.01),-e.symbol.distanceLegend*(e.symbol.mainLineWidth+e.symbol.surroundLineWidth),e.symbol.distanceLegend*(e.symbol.thickness3D*.01)])}function nL(e,t,n,r){var o=void 0;e&&(o=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}));var a=void 0;r&&(a=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}));var s=void 0;return n&&(s=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n})),new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:e?o:void 0,color:r?a:void 0,normal:n?s:void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})}function Gp(e,t,n,r){return r?new Cesium.GeometryInstance({geometry:t,id:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:new Cesium.ColorGeometryInstanceAttribute(r.red,r.green,r.blue,r.alpha)}}):new Cesium.GeometryInstance({geometry:t,id:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0)}})}function CRe(e,t,n,r,o){return new Cesium.GeometryInstance({geometry:t,id:r,modelMatrix:n,pickPrimitive:e,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:new Cesium.ColorGeometryInstanceAttribute(o.red,o.green,o.blue,o.alpha)}})}function xRe(e){var t=Cesium.Transforms.headingPitchRollToFixedFrame(e,Cesium.HeadingPitchRoll.fromDegrees(0,0,180)),n=Cesium.Matrix4.multiplyByUniformScale(t,1,new Cesium.Matrix4);return n}function wRe(e){if(e.length>2){for(var t=0,n=0,r=0,o=1;o<=e.length;o++){var a=e[o%e.length].latitude,s=e[o%e.length].longitude,u=e[o-1].latitude,l=e[o-1].longitude,c=(a*l-s*u)*.5;t+=c,n+=c*(a+u)/3,r+=c*(s+l)/3}return n=n/t,r=r/t,[r,n]}else return[(e[0].longitude+e[1].longitude)*.5,(e[0].latitude+e[1].latitude)*.5]}function ERe(e){var t=new Cesium.EllipsoidGeodesic;t.setEndPoints(e[e.length-2],e[e.length-1]);var n=t.surfaceDistance;return n}var rL=Hp;function vl(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.symbol))throw new Le("EV_MilStd3DMarkerPrimitive options.symbol  undefined!");if(!Cesium.defined(e.vertexData))throw new Le("EV_MilStd3DMarkerPrimitive options.vertexData  undefined!");if(!Cesium.defined(e.camera))throw new Le("EV_MilStd3DMarkerPrimitive options.camera  undefined!");this.symbol=e.symbol,this._vertexData=e.vertexData,this.isMilitarySymbol=!0,this.camera=e.camera,this.appearance=new Cesium.PerInstanceColorAppearance({flat:!0,translucent:!1}),this.frameAppearance=new Cesium.PerInstanceColorAppearance({flat:!0,closed:!0}),this.viewPosition=new Cesium.Cartesian3(0,0,0),this._fixedScale=1,this._startFixedSValue=1,this.modelMatrix=Cesium.Matrix4.IDENTITY.clone(),this.asynchronous=Cesium.defaultValue(e.asynchronous,!1),this.debugShowBoundingVolume=Cesium.defaultValue(e.debugShowBoundingVolume,!1),this._primitive=void 0,this._geometryInstanceId=0,this._originMainLineColors=[],this._originFillColors=[],this._originTextColors=[],this.isWithText=!1,(this.libraryID==32&&(this.code>=1900&&this.code<=1906||this.code>=2e3&&this.code<=2006||this.code>=2100&&this.code<=2106||this.code>=2200&&this.code<=2206||this.code>=2300&&this.code<=2306||this.code>=2400&&this.code<=2406)||this.libraryID==32&&this.code==3||this.libraryID==10&&this.code>=2800&&this.code<=2807)&&(this.isWithText=!0),this._isUpdatePrimitive=!0}Object.defineProperties(vl.prototype,{vertexData:{get:function(){return this._vertexData},set:function(e){e&&(this._vertexData=e,this._isUpdatePrimitive=!0)}},anchorPosition:{get:function(){var e=this.getAnchorHeight(),t=Cesium.Cartesian3.fromRadians(this.symbol.positionCartographic.longitude,this.symbol.positionCartographic.latitude,e);return t}}});vl.prototype.setScaleMode=function(e){if(e===0){this.viewPosition=Cesium.Cartesian3.clone(this.camera.position);var t=this.getAnchorHeight(),n=Cesium.Cartesian3.fromRadians(this.symbol.positionCartographic.longitude,this.symbol.positionCartographic.latitude,t);this._startFixedSValue=Cesium.Cartesian3.distance(this.viewPosition,n)}else this._fixedScale=1;this._isUpdatePrimitive=!0};vl.prototype.setInnerTextColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("innerText")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};vl.prototype.setFillColor=function(e){if(this._framePrimitive&&this._framePrimitive.ready)for(var t=0;t<this._framePrimitive._instanceIds.length;t++){var n=this._framePrimitive._instanceIds[t];this._framePrimitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e)}};vl.prototype.setMainLineColor=function(e){if(this._primitive&&this._primitive.ready)for(var t=0;t<this._primitive._instanceIds.length;t++){var n=this._primitive._instanceIds[t];n.indexOf("mainLine")>-1&&(this._primitive.getGeometryInstanceAttributes(n).color=Cesium.ColorGeometryInstanceAttribute.toValue(e))}};vl.prototype.updatePrimitive=function(){this._isUpdatePrimitive=!0};vl.prototype.update=function(e){if(!!this.symbol.show&&!(!this._isUpdatePrimitive&&!Cesium.defined(this._primitive))){if(this._isUpdatePrimitive||Cesium.defined(this.symbol.drawMode)&&this.symbol.drawMode===360||Cesium.defined(this.symbol.scaleMode)&&this.symbol.scaleMode===0){this._isUpdatePrimitive=!1;var t=this.getGeometryInstances();this._primitive=this._primitive&&this._primitive.destroy(),this._primitive=new Cesium.Primitive({geometryInstances:t,appearance:this.appearance,asynchronous:this.asynchronous});var n=this.getTransGeometryInstances();this._framePrimitive=this._framePrimitive&&this._framePrimitive.destroy(),this.getTransGeometryInstances&&(this._framePrimitive=new Cesium.Primitive({geometryInstances:n,appearance:this.frameAppearance,asynchronous:this.asynchronous}))}this._primitive.update(e),this._framePrimitive&&this._framePrimitive.update(e)}};vl.prototype.getGeometryInstances=function(){if(!!Cesium.defined(this.vertexData)){var e=[],t=this.vertexData,n=null;if(t.TextData)for(var r=0;r<t.TextData.length;r++)t.TextData[r].TextColor.length>0&&(n=_z(t.TextData[r].TextVertex,t.TextData[r].TextIndex,t.TextData[r].TextNormal),this.symbol.isExternalSetInnertext&&this.symbol.innertextColor?e[e.length]=this.createGeometryInstance(n,"innerText"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.innertextColor)):(this._originTextColors.length===0&&(this._originTextColors[r]=new K(t.TextData[r].TextColor[0]/255,t.TextData[r].TextColor[1]/255,t.TextData[r].TextColor[2]/255,t.TextData[r].TextColor[3]/255),this.symbol.innertextColor=this._originTextColors[0]),e[e.length]=this.createGeometryInstance(n,"innerText"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originTextColors[r]))));if(t.MainData)for(var o=t.MainData.length,r=0;r<o;r++)t.MainData[r].MainColor.length>0&&(n=_z(t.MainData[r].MainVertex,t.MainData[r].MainIndex,t.MainData[r].MainNormal),this.symbol.isExternalSetLine&&this.symbol.mainLineColor?e[e.length]=this.createGeometryInstance(n,"mainLine"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.mainLineColor)):(this._originMainLineColors.length!==o&&(this._originMainLineColors[r]=new K(t.MainData[r].MainColor[0]/255,t.MainData[r].MainColor[1]/255,t.MainData[r].MainColor[2]/255,t.MainData[r].MainColor[3]/255),this.symbol.mainLineColor=this._originMainLineColors[0]),e[e.length]=this.createGeometryInstance(n,"mainLine"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originMainLineColors[r]))));return e}};vl.prototype.getTransGeometryInstances=function(){if(!!Cesium.defined(this.vertexData.FillData)){for(var e=[],t=this.vertexData,n=void 0,r=0;r<t.FillData.length;r++)t.FillData&&(n=_z(t.FillData[r].FillVertex,t.FillData[r].FillIndex,t.FillData[r].FillNormal),this.symbol.isExternalSetFill&&this.symbol.fillColor?e[e.length]=this.createGeometryInstance(n,"fill"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this.symbol.fillColor)):(this._originFillColors.length===0&&(this._originFillColors[r]=new K(t.FillData[r].FillColor[0]/255,t.FillData[r].FillColor[1]/255,t.FillData[r].FillColor[2]/255,t.FillData[r].FillColor[3]/255),this.symbol.fillColor=this._originFillColors[0]),e[e.length]=this.createGeometryInstance(n,"fill"+r,Cesium.ColorGeometryInstanceAttribute.fromColor(this._originFillColors[r]))));return n=void 0,e}};vl.prototype.vertexDataInterpolation=function(e){var t=e.data,n=e.sum;if(n%2!==1){var r={FillColor:[],FillIndex:[],FillNormal:[],FillVertex:[]},o=[];if(t[0].FillVertex.forEach(function(c,f){f%3===0&&!o[Math.floor(f/3)]&&(o[Math.floor(f/3)]=[]),o[Math.floor(f/3)].push(c)}),o[0][0]===o[1][0])for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[3][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[3][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[3][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[1][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[1][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[1][2]-o[2][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[2][2])}else for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[1][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[1][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[1][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[3][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[3][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[3][2]-o[3][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[3][2])}delete this.vertexData.FillData[0].FillVertex,this.vertexData.FillData[0].FillVertex=new Float64Array(r.FillVertex.length);for(var a=0;a<r.FillVertex.length;a++)this.vertexData.FillData[0].FillVertex[a]=r.FillVertex[a];delete this.vertexData.FillData[0].FillNormal,this.vertexData.FillData[0].FillNormal=new Float64Array(r.FillNormal.length);for(var a=0;a<r.FillNormal.length;a++)this.vertexData.FillData[0].FillNormal[a]=r.FillNormal[a];delete this.vertexData.FillData[0].FillIndex,this.vertexData.FillData[0].FillIndex=new Int32Array(r.FillIndex.length);for(var a=0;a<r.FillIndex.length;a++)this.vertexData.FillData[0].FillIndex[a]=r.FillIndex[a];delete this.vertexData.FillData[0].FillColor,this.vertexData.FillData[0].FillColor=new Uint8Array(r.FillColor.length);for(var a=0;a<r.FillColor.length;a++)this.vertexData.FillData[0].FillColor[a]=r.FillColor[a]}};vl.prototype.updateModelMatrix=function(){var e=this.anchorPosition,t=null;if((!Cesium.defined(this.camera.heading)||!Cesium.defined(this.camera.pitch))&&(this.symbol.drawMode=0),this.symbol.drawMode===360){var n=Cesium.Transforms.headingPitchRollToFixedFrame(e,new Cesium.HeadingPitchRoll(this.camera.heading,0,this.camera.pitch+Math.PI*.5));t=Cesium.Matrix4.multiplyByMatrix3(n,Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(parseFloat(this.symbol.rotate)),new Cesium.Matrix3),new Cesium.Matrix4)}else t=Cesium.Transforms.headingPitchRollToFixedFrame(e,Cesium.HeadingPitchRoll.fromDegrees(parseFloat(this.symbol.rotate),0,this.symbol.drawMode));if(Cesium.defined(this.symbol.scaleMode)&&this.symbol.scaleMode===0&&!Cesium.Cartesian3.equals(this.viewPosition,this.camera.position)){var r=Cesium.Cartesian3.distance(this.camera.position,e);this._fixedScale=r/this._startFixedSValue}var o=Number(this.symbol.scale)*Number(this.symbol.distanceLegend)*this._fixedScale/1e5;this.modelMatrix=Cesium.Matrix4.multiplyByUniformScale(t,o,new Cesium.Matrix4)};vl.prototype.createGeometryInstance=function(e,t,n){return this.updateModelMatrix(),n?new Cesium.GeometryInstance({geometry:e,modelMatrix:this.modelMatrix,pickPrimitive:this,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0),color:n},id:t}):new Cesium.GeometryInstance({geometry:e,modelMatrix:this.modelMatrix,pickPrimitive:this,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0)},id:t})};vl.prototype.isDestroyed=function(){return!1};vl.prototype.destroy=function(){if(this.vertexData.TextData)for(var e=0;e<this.vertexData.TextData.length;e++)delete this.vertexData.TextData[e].TextColor,delete this.vertexData.TextData[e].TextIndex,delete this.vertexData.TextData[e].TextNormal,delete this.vertexData.TextData[e].TextVertex;if(this.vertexData.FillData)for(var e=0;e<this.vertexData.FillData.length;e++)delete this.vertexData.FillData[e].FillColor,delete this.vertexData.FillData[e].FillIndex,delete this.vertexData.FillData[e].FillNormal,delete this.vertexData.FillData[e].FillVertex;if(this.vertexData.MainData)for(var e=0;e<this.vertexData.MainData.length;e++)delete this.vertexData.MainData[e].MainColor,delete this.vertexData.MainData[e].MainIndex,delete this.vertexData.MainData[e].MainNormal,delete this.vertexData.MainData[e].MainVertex;return this.vertexData=void 0,this._primitive&&(this._primitive.destroy(),this._primitive=void 0),this._framePrimitive&&(this._framePrimitive.destroy(),this._framePrimitive=void 0),Cesium.destroyObject(this)};vl.prototype.getAnchorHeight=function(){var e=0;return this.symbol.drawMode==0?e=this.symbol.floatHeight3D*1e3:e=this.vertexData.distance*10*this.symbol.scale+this.symbol.floatHeight3D*1e3,e+this.symbol.positionCartographic.height};function _z(e,t,n,r){return r?new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),color:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}),normal:n?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n}):void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)}):new Cesium.Geometry({attributes:new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),normal:n?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:n}):void 0}),indices:t,primitiveType:4,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})}var iL=vl;var K$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sKHAksBNXfIvIAAADGSURBVBjTlZC9DsFgFIafWsQgDE0vwGBjNVjNdYl1BYYmbkDim0yMEotFooNEW+Wjr6GfpCQG73J+nmc5B/6I924kNYEh0APawAXYAxvP827URUlTSZGkg6S7q5HbN+vySNJM0lOfebr9CKABUBRFH5i851oawMTxCuZ53gGCH3cFjldymqYZcPohnxyv5CzLdsASKL/EElg6XsnW2rUxZgHMgSPwcHVujFlYa9cff47juJUkyRgYAF3gDGx931+FYXjl37wANeOE+Ghv1/sAAAAASUVORK5CYII=";function oa(e,t,n){if(!Cesium.defined(e))throw new DeveloperError("scene of options  must be defined");this._scene=e,this._billboards=new Cesium.BillboardCollection,this._primitives=n||this._scene.primitives,this._primitives.add(this._billboards),this._orderedBillboards=[],this.billboards=[],this.ellipsoid=e.globe.ellipsoid,this.scale=t,this.distanceHeigh=void 0}function lx(e,t,n){e[t]=n}oa.prototype.createBillboard=function(e,t,n){var r=this.getAnchorPosition(e,t),o=this._billboards.add({show:!0,position:r,eyeOffset:new Cesium.Cartesian3(0,0,-2e3),horizontalOrigin:0,verticalOrigin:0,scale:this.scale,image:K$,color:new Cesium.Color(1,1,0,1)});if(n){var a=this,s=a._scene.screenSpaceCameraController;if(n.dragHandlers){var a=this;lx(o,"leftDown",function(l){function c(d){var p=a.getAnchorPosition(d);o.position=p;for(var g=a._orderedBillboards.length,y=0;y<g&&a._orderedBillboards[y]!=o;++y);n.dragHandlers.onDrag&&n.dragHandlers.onDrag(qp(a,o),d)}function f(d){h.destroy(),s.enableRotate=!0,s.enableTranslate=!0,n.dragHandlers.onDragEnd&&n.dragHandlers.onDragEnd(qp(a,o),d)}var h=new Cesium.ScreenSpaceEventHandler(a._scene.canvas);h.setInputAction(function(d){f(a._scene.globe.pick(a._scene.camera.getPickRay(d.position),a._scene))},Cesium.ScreenSpaceEventType.LEFT_UP),h.setInputAction(function(d){var p=a._scene.globe.pick(a._scene.camera.getPickRay(d.endPosition),a._scene);p?c(p):f(p)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),h._buttonDown[0]=!0,s.enableRotate=!1,s.enableTranslate=!1,n.dragHandlers.onDragStart&&n.dragHandlers.onDragStart(qp(a,o),a._scene.globe.pick(a._scene.camera.getPickRay(l),a._scene))})}n.onDoubleClick&&lx(o,"leftDoubleClick",function(u){n.onDoubleClick(qp(a,o))}),n.onClick&&lx(o,"leftClick",function(u){n.onClick(qp(a,o))})}return o};function qp(e,t){for(var n=e._orderedBillboards.length,r=0;r<n&&e._orderedBillboards[r]!=t;++r);return r}oa.prototype.insertBillboard=function(e,t,n){this._orderedBillboards.splice(e,0,this.createBillboard(t,n))};oa.prototype.addBillboard=function(e,t,n){var r=this.createBillboard(e,t,n);return r.isMilitaryAnchor=!0,this._orderedBillboards.push(r),r};oa.prototype.addBillboards=function(e,t,n){for(var r=0;r<e.length;r++)this.addBillboard(e[r],t,n)};oa.prototype.updateBillboardsPositions=function(e){for(var t=0;t<e.length;t++)this.getBillboard(t).position=e[t]};oa.prototype.updateBillboardPosition=function(e,t,n){var r=this.getAnchorPosition(t,n);this.getBillboard(e).position=r};oa.prototype.updateBillboardsHeight=function(e){for(var t=this._orderedBillboards.length,n=0;n<t;n++){var r=this._orderedBillboards[n].position;this._orderedBillboards[n].position=this.getAnchorPosition(r,e)}};oa.prototype.countBillboards=function(){return this._orderedBillboards.length};oa.prototype.getBillboard=function(e){return this._orderedBillboards[e]};oa.prototype.removeBillboard=function(e){this._billboards.remove(this.getBillboard(e)),this._orderedBillboards.splice(e,1)};oa.prototype.removeAllBillboards=function(){this._billboards.removeAll(),this._orderedBillboards=[],this._anchorHeight=0};oa.prototype.remove=function(){this._billboards.removeAll(),this._primitives.remove(this._billboards)};oa.prototype.setOnTop=function(){this._primitives.raiseToTop(this._billboards)};oa.prototype.destroy=function(){this._billboards.destroy()};oa.prototype.getAnchorPosition=function(e,t){t&&(this._anchorHeight=t);var n;if(e instanceof Cesium.Cartesian3){var r=Cesium.Cartographic.fromCartesian(e);n=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,this._anchorHeight)}else e instanceof Cesium.Cartographic&&(n=Cesium.Cartesian3.fromRadians(e.longitude,e.latitude,this._anchorHeight));return n};oa.prototype.changeBillboardColor=function(e,t){let n=this.getBillboard(e);n.color=t};oa.prototype.myCreatedBillboard=function(e,t,n){let r=this._billboards.add({id:e,show:!0,position:t,eyeOffset:new Cesium.Cartesian3(0,0,-2e3),horizontalOrigin:0,verticalOrigin:0,scale:this.scale,image:K$,color:new Cesium.Color(1,1,0,1)});if(n){let a=this._scene.screenSpaceCameraController;if(n.dragHandlers){var o=this;lx(r,"leftDown",function(s){function u(f){var h=o.getAnchorPosition(f);r.position=h;for(var d=o._orderedBillboards.length,p=0;p<d&&o._orderedBillboards[p]!=r;++p);n.dragHandlers.onDrag&&n.dragHandlers.onDrag(qp(o,r),f)}function l(f){c.destroy(),a.enableRotate=!0,a.enableTranslate=!0,n.dragHandlers.onDragEnd&&n.dragHandlers.onDragEnd(qp(o,r),f)}var c=new Cesium.ScreenSpaceEventHandler(o._scene.canvas);c.setInputAction(function(f){l(o._scene.globe.pick(o._scene.camera.getPickRay(f.position),o._scene))},Cesium.ScreenSpaceEventType.LEFT_UP),c.setInputAction(function(f){var h=o._scene.globe.pick(o._scene.camera.getPickRay(f.endPosition),o._scene);h?u(h):l(h)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),c._buttonDown[0]=!0,a.enableRotate=!1,a.enableTranslate=!1,n.dragHandlers.onDragStart&&n.dragHandlers.onDragStart(qp(o,r),o._scene.globe.pick(o._scene.camera.getPickRay(s),o._scene))})}n.onDoubleClick&&lx(r,"leftDoubleClick",function(s){n.onDoubleClick(qp(o,r))}),n.onClick&&lx(r,"leftClick",function(s){n.onClick(qp(o,r))})}return r};oa.prototype.myAddBillboard=function(e,t,n){if(Cesium.defined(t)){Cesium.defined(e)||(e=Cesium.createGuid());let r=this.myCreatedBillboard(e,t,n);return this.billboards[e]=r,r}};oa.prototype.myGetBillboard=function(e){if(Cesium.defined(e))return this.billboards[e]};oa.prototype.myRemoveBillboard=function(e){Cesium.defined(e)&&(this._billboards.remove(this.myGetBillboard(e)),delete this.billboards[e])};oa.prototype.myRemoveAllBillboard=function(){for(let e in this.billboards)this.billboards.hasOwnProperty.call(this.billboards,e)&&this.myRemoveBillboard(e)};oa.prototype.myChangeBillboardColor=function(e,t){let n=this.myGetBillboard(e);n.color=t};oa.prototype.myChangeBillboardPosition=function(e,t){let n=this.myGetBillboard(e);n.position=t};var ov=oa;function nr(e){this.viewer=e.viewer,this._plottingService=e.plottingService,this._drawState=0,this.milStdAnchorCollection=new ov(this.viewer.scene,1.5,this._primitiveCollection),this.editingSymbolId=void 0,this.symbols=new Va,DRe(this),this._leftDown=new xe,this._rightDown=new xe,this._draggingAnchor=new xe,this._endDragAnchor=new xe,this.viewer.scene.primitives.add(this),this._copyVertexDataState=!1,this._vertexDataObjs={},this._sameVertexInfoObjs={}}nr.prototype.createRenderSymbol=function(e,t){var n=e.symbol.type,r=e.vertexData,o=this.viewer.scene.camera,a=void 0;switch(n){case 0:{a=new iL({viewer:this.viewer,camera:o,symbol:e.symbol,vertexData:r});break}case 1:{a=new rL({viewer:this.viewer,vertexData:r,symbol:e.symbol});break}default:break}this.symbols.set(a.symbol.id,a),t(a.symbol.id)};nr.prototype.getSymbol=function(e){return _(e)||console.error("EV_MilStd3DRenderManager methods 'getSymbol' parameter 'symbolId' error !"),this.symbols.get(e)};nr.prototype.removeSymbol=function(e){this.editingSymbolId===e&&(this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=void 0);var t=this.getSymbol(e);this.symbols.remove(e),t.destroy()};nr.prototype.removeAllSymbol=function(){this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=void 0;for(var e=0;e<this.symbols.length;e++)this.symbols.values[e].destroy();this.symbols.removeAll()};nr.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.getSymbol(e);n.updatePrimitive();var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t,r)};nr.prototype.setMarkSymbolMainLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setMainLineColor(t)};nr.prototype.setMarkSymbolFillColor=function(e,t){var n=this.getSymbol(e);n&&n.setFillColor(t)};nr.prototype.updateMarkSymbolFloatHeight3D=function(e){var t=this.getSymbol(e);if(t){t.updatePrimitive();var n=t.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t.symbol.positionCartographic,n)}};nr.prototype.updateMarkSymbolRotate=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.updateMarkSymbolScale=function(e){var t=this.getSymbol(e);if(t){t.updatePrimitive();var n=t.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,t.symbol.positionCartographic,n)}};nr.prototype.updateMarkSymbolDrawMode=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.setMarkSymbolScaleMode=function(e,t){var n=this.getSymbol(e);if(n){n.setScaleMode(t);var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardPosition(0,n.symbol.positionCartographic,r)}};nr.prototype.setMarkSymbolInnerText=function(e,t){var n=this.getSymbol(e);n&&cx({libraryID:n.symbol.libraryID,code:n.symbol.code,type:n.symbol.type,mainLineColor:n.symbol.isExternalSetLine?n.symbol.mainLineColor:void 0,fillMode:1,fillColor:n.symbol.isExternalSetFill?n.symbol.fillColor:void 0,innerText:t||"",positionCartographics:n.symbol.positionCartographics,plottingService:this._plottingService}).then(function(r){n&&(n.vertexData=r)})};nr.prototype.setInnerTextColor=function(e,t){var n=this.getSymbol(e);n&&n.setInnerTextColor(t)};nr.prototype.setLineSymbolPositionCartographics=function(e,t){var n=this.getSymbol(e);if(n){n.updatePrimitive();var r=n.getAnchorHeight();this.editingSymbolId===e&&this.milStdAnchorCollection.updateBillboardsHeight(r),cx({id:e,libraryID:n.symbol.libraryID,code:n.symbol.code,type:n.symbol.type,mainLineColor:n.symbol.isExternalSetLine?n.symbol.mainLineColor:void 0,fillMode:1,fillColor:n.symbol.isExternalSetFill?n.symbol.fillColor:void 0,innerText:"",positionCartographics:t,plottingService:this._plottingService}).then(function(o){n.vertexData=o})}};nr.prototype.updateLineSymbolMainLineWidth=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.setLineSymbolMainLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setMainLineColor(t)};nr.prototype.setLineSymbolFillColor=function(e,t){var n=this.getSymbol(e);n&&n.setFillColor(t)};nr.prototype.updateLineSymbolSurroundLineType=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.setLineSymbolSurroundLineColor=function(e,t){var n=this.getSymbol(e);n&&n.setSurroundLineColor(t)};nr.prototype.updateLineSymbolSurroundLineWidth=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.updateLineSymbolFillMode=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.updateLineSymbolFloatHeight3D=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.updateLineSymbolThickness3D=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.updateLineSymbolWallTransparent=function(e){var t=this.getSymbol(e);t&&t.updatePrimitive()};nr.prototype.update=function(e){for(var t=0;t<this.symbols.length;t++)this.symbols.values[t].update(e)};nr.prototype.getDrawPositions=function(e,t){switch(e){case 0:TRe(this,t);break;case 1:SRe(this,t);break;default:throw destroy,new Cesium.DeveloperError("\u519B\u6807\u7C7B\u578B\u672A\u5B9A\u4E49")}};nr.prototype.isDestroyed=function(){return!1};nr.prototype.destroy=function(){return this.symbols=void 0,this._leftDown=void 0,this._rightDown=void 0,this._draggingAnchor=void 0,this._endDragAnchor=void 0,this._vertexDataObjs=void 0,this._sameVertexInfoObjs=void 0,this.viewer.scene.primitives.remove(this),Cesium.destroyObject(this)};function TRe(e,t){if(!e._drawState){e.startDrawing(function(){n&&n.destroy()}),e._drawState=!0;var n=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);n.setInputAction(function(r){if(!Cesium.defined(r.position)){console.error("EV_MilStd3DRenderManager function 'startDrawPointSymbol' get position error"),e.stopDrawing(),e.setDrawState(!1);return}var o;if(e.viewer.scene.mode!==2){var a=e.viewer.camera.getPickRay(r.position),s=e.viewer.scene.globe.pick(a,e.viewer.scene);o=Cesium.Cartographic.fromCartesian(s)}else{var s=e.viewer.scene.camera.pickEllipsoid(r.position);o=Cesium.Cartographic.fromCartesian(s)}if(!Cesium.defined(o)){console.error("EV_MilStd3DRenderManager function 'startDrawPointSymbol' get position error"),stopDraw();return}e.stopDrawing(),e.setDrawState(!1),t([o])},Cesium.ScreenSpaceEventType.LEFT_CLICK)}}function SRe(e,t){if(!e._drawState){e.startDrawing(function(){n.destroy()}),e._drawState=!0;var n=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas),r=[],o=!1;e._isDrawFile=!0,n.setInputAction(function(a){if(!Cesium.defined(a.position)){console.error("EV_MilStd3DRenderManager function 'startDrawLineSymbol' get position error"),e.stopDrawing(),e.setDrawState(!1);return}if(Cesium.defined(a.position)){var s;if(e.viewer.scene.mode!==2){var u=e.viewer.camera.getPickRay(a.position),l=e.viewer.scene.globe.pick(u,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(l)}else{var l=e.viewer.scene.camera.pickEllipsoid(a.position);s=Cesium.Cartographic.fromCartesian(l)}if(!Cesium.defined(s)){console.error("EV_MilStd3DRenderManager function 'startDrawLineSymbol' get position error"),stopDraw();return}s&&(r.length===0?(r.push(s),t(r),r.push(s)):(r.push(s),t(r)),o=!0)}},Cesium.ScreenSpaceEventType.LEFT_CLICK),n.setInputAction(function(a){if(o){var s;if(e.viewer.scene.mode!==2){var u=e.viewer.camera.getPickRay(a.endPosition),l=e.viewer.scene.globe.pick(u,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(l)}else{var l=e.viewer.scene.camera.pickEllipsoid(a.endPosition);s=Cesium.Cartographic.fromCartesian(l)}r.pop(),r.push(s),t(r)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction(function(a){if(Cesium.defined(a.position)){e.stopDrawing(),e.setDrawState(!1);var s;if(e.viewer.scene.mode!==2){var l=e.viewer.camera.getPickRay(a.position),u=e.viewer.scene.globe.pick(l,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(u)}else{var u=e.viewer.scene.camera.pickEllipsoid(a.position);s=Cesium.Cartographic.fromCartesian(u)}var l=e.viewer.camera.getPickRay(a.position),c=e.viewer.scene.globe.pick(l,e.viewer.scene);s=Cesium.Cartographic.fromCartesian(c),s&&(r.pop(),r.push(s),e.setLineSymbolPositionCartographics(e.editingSymbolId,r))}},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}}nr.prototype.drawByPositions=function(e,t,n){if(_(e)){var r=e.type;r===0?ARe(this,e,t,function(o){n(o)}):r===1?bRe(this,e,t,function(o){n(o)}):console.error("'EV_MilStd3DRenderManager' method 'drawByPositions' parameter 'type' error!")}};function ARe(e,t,n,r){var o=t.libraryID,a=t.code,s=t.type,u=[t.positionCartographic],l=e._plottingService,c=t.isExternalSetLine,f=t.isExternalSetFill;if(!e._copyVertexDataState)cx({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(h){e.createRenderSymbol({symbol:t,vertexData:h},function(d){r(d)})});else{let h=o+"_"+a,d=e._vertexDataObjs[h];d&&Object.keys(d.MainData[0]).length===0&&(delete e._vertexDataObjs[h],e._sameVertexInfoObjs[h]&&delete e._sameVertexInfoObjs[h]),e._vertexDataObjs[h]?Object.keys(d.MainData[0]).length>0&&e.drawByVertexData(t,d,r):(e._sameVertexInfoObjs[h]||(e._sameVertexInfoObjs[h]=[]),e._sameVertexInfoObjs[h].push(t),e._sameVertexInfoObjs[h].length===1&&cx({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(p){(o==32&&(a>=1900&&a<=1906||a>=2e3&&a<=2006||a>=2100&&a<=2106||a>=2200&&a<=2206||a>=2300&&a<=2306||a>=2400&&a<=2406)||o==32&&a==3||o==10&&a>=2800&&a<=2807)&&p.FillData&&Q$(p),e._vertexDataObjs[h]=p;let g=0,y=e._sameVertexInfoObjs[h],v=y.length;for(;g<v;){let w=y[g];w.vertexData=p,e.drawByVertexData(e._sameVertexInfoObjs[h][g],p,r),g++}}))}}nr.prototype.turnOnUseSameVertexDrawing=function(){this._copyVertexDataState=!0};nr.prototype.initUseSameVertexDrawing=function(){this._vertexDataObjs={},this._sameVertexInfoObjs={}};nr.prototype.turnOffUseSameVertexDrawing=function(){this.initUseSamevertexDrawing(),this._copyVertexDataState=!1};nr.prototype.startDrawing=function(e){this.milStdAnchorCollection&&this.milStdAnchorCollection.removeAllBillboards(),this.editCleanUp&&typeof this.editCleanUp=="function"&&this.editCleanUp(),this.editCleanUp=e};nr.prototype.stopDrawing=function(){this.editCleanUp&&(this.editCleanUp(),this.editCleanUp=null)};nr.prototype.setDrawState=function(e){this._drawState=e};function bRe(e,t,n,r){var o=t.libraryID,a=t.code,s=t.type,u=t.positionCartographics,l=e._plottingService,c=t.isExternalSetLine,f=t.isExternalSetFill,h=t.isisExternalSetInnertext;if(!e._copyVertexDataState)cx({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:h?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(d){e.createRenderSymbol({vertexData:d,symbol:t},function(p){r(p)})});else{let d=o+"_"+a,p=e._vertexDataObjs[d];p&&Object.keys(p.MainData[0]).length===0&&(delete e._vertexDataObjs[d],e._sameVertexInfoObjs[d]&&delete e._sameVertexInfoObjs[d]),e._vertexDataObjs[d]||(e._sameVertexInfoObjs[d]||(e._sameVertexInfoObjs[d]=[]),e._sameVertexInfoObjs[d].push(t),e._sameVertexInfoObjs[d].length===1&&cx({id:t.id,libraryID:o,code:a,type:s,mainLineColor:c?t.mainLineColor:void 0,fillMode:1,fillColor:f?t.fillColor:void 0,innerText:t.innertext?t.innertext:"",positionCartographics:u,plottingService:l}).then(function(g){(o==32&&(a>=1900&&a<=1906||a>=2e3&&a<=2006||a>=2100&&a<=2106||a>=2200&&a<=2206||a>=2300&&a<=2306||a>=2400&&a<=2406)||o==32&&a==3||o==10&&a>=2800&&a<=2807)&&g.FillData&&Q$(g),e._vertexDataObjs[d]=g;let y=0,v=e._sameVertexInfoObjs[d],w=v.length,C=new Array(w),E=new Array(w),S=new Array(w),A=new Array(w);for(;y<w;){if(y===0)C[0]=void 0;else{let D=v[y],P=v[0],M=(D.positionCartographics[0].longitude-P.positionCartographics[0].longitude)*180/Math.PI,I=(D.positionCartographics[0].latitude-P.positionCartographics[0].latitude)*180/Math.PI;C[y]={lonDiff:M,latDiff:I}}y++}C.forEach((D,P)=>{if(D){let M=g.MainData;S[P]=[],M.forEach((O,m)=>{if(O){let b=O.MainVertex,L=b.length;S[P][m]=new Float64Array(L);for(let R=0;R<L;R=R+2)S[P][m][R]=b[R]+D.lonDiff,S[P][m][R+1]=b[R+1]+D.latDiff}});let I=g.FillData;I&&(A[P]=[],I.forEach((O,m)=>{if(O){let b=O.FillVertex,L=b.length;A[P][m]=new Float64Array(L);for(let R=0;R<L;R=R+3)A[P][m][q]=b[q]+D.lonDiff,A[P][m][q+1]=b[q+1]+D.latDiff}})),E[P]=IRe(g),E[P].MainData.forEach((O,m)=>{O&&O.MainVertex&&(O.MainVertex=S[P][m])}),E[P].FillVertex&&E[P].FillData.forEach((O,m)=>{P>0&&O&&O.FillVertex&&(O.FillVertex=A[P][m])})}else E[P]=g}),E.forEach((D,P)=>{e.drawByVertexData(e._sameVertexInfoObjs[d][P],D,r)})}))}}function IRe(e){let t={};if(e.MainData){let n=e.MainData;t.MainData=[],n.forEach(r=>{t.MainData.push({MainColor:Uint8Array.from(r.MainColor),MainIndex:Int32Array.from(r.MainIndex),MainNormal:Float64Array.from(r.MainNormal),MainVertex:Float64Array.from(r.MainVertex)})})}if(e.FillData){let n=e.FillDatas;t.FillData=[],n.forEach(r=>{t.FillData.push({FillColor:Uint8Array.from(r.FillColor),FillIndex:Int32Array.from(r.FillIndex),FillNormal:Float64Array.from(r.FillNormal),FillVertex:Float64Array.from(r.FillVertex)})})}return e.code&&(t.code=e.code),t.distance=void 0,t}nr.prototype.drawByVertexData=function(e,t,n){this.createRenderSymbol({symbol:e,vertexData:t},function(r){n(r)})};nr.prototype.setEditingSymbol=function(e){if(this.editingSymbolId!==e&&(this.milStdAnchorCollection.removeAllBillboards(),this.editingSymbolId=e,_(e))){var t=this;this.anchorChangeCallBacksObj={dragHandlers:{onDrag:function(a,s){var u=t.getSymbol(t.editingSymbolId);if(u){var l=Cesium.Cartographic.fromCartesian(s);u.symbol.type===0?t._draggingAnchor.raiseEvent(u.symbol.id,l):u.symbol.type===1&&(u.symbol.positionCartographics[a]=l,t._draggingAnchor.raiseEvent(u.symbol.id,u.symbol.positionCartographics,a))}},onDragEnd:function(a,s){var u=t.getSymbol(t.editingSymbolId);if(u){var l=Cesium.Cartographic.fromCartesian(s);u.symbol.type===0?t._endDragAnchor.raiseEvent(u.symbol.id,l):u.symbol.type===1&&(u.symbol.positionCartographics[a]=l,t._endDragAnchor.raiseEvent(u.symbol.id,u.symbol.positionCartographics,a))}}}};var n=t.getSymbol(t.editingSymbolId),r=n.getAnchorHeight(),o=[];n.symbol.type===0?o.push(n.symbol.positionCartographic):n.symbol.type===1&&(o=n.symbol.positionCartographics),this.milStdAnchorCollection.addBillboards(o,r,this.anchorChangeCallBacksObj)}};function cx(e){var t=e.libraryID,n=e.code,r=e.type,o=e.mainLineColor,a=e.fillMode,s=e.fillColor,u=e.innerText||"",l=e.positionCartographics,c=e.plottingService,f=e.id,h="{";if(u&&(h+='"InnerText" : "'+u+'",'),o&&(h+='"MainLineColor" : "'+Z$(o)+'",'),a&&(h+='"FillMode" : "'+a+'",'),s&&(h+='"FillColor" : "'+Z$(s)+'",'),h+='"Positions":"',l)for(var d=0;d<l.length;++d)h+=Cesium.Math.toDegrees(l[d].longitude)+","+Cesium.Math.toDegrees(l[d].latitude)+","+l[d].height+";";h+='"}';var p=Cesium.defer();if(c){var g={id:f,libraryID:t,symbolID:n,markType:r,symbolSpecialInfo:h};c.getSymbolMeshData(g,function(y){y&&p.resolve(y)})}return p.promise}function DRe(e){var t=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);t.setInputAction(function(r){n("leftDown",r.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(function(r){n("rightDown",r.position)},Cesium.ScreenSpaceEventType.RIGHT_DOWN);function n(r,o){if(!e._drawState){var a=e.viewer.scene.pick(o),s;a?(s=a.primitive,s&&s.isMilitarySymbol?r==="leftDown"?e._leftDown.raiseEvent(s.symbol.id):r==="rightDown"&&e._rightDown.raiseEvent(s.symbol.id,o):s&&s.isMilitaryAnchor&&s[r]&&s[r](a.primitive,o)):r==="leftDown"?e._leftDown.raiseEvent(void 0):r==="rightDown"&&e._rightDown.raiseEvent(void 0,o)}}}function Q$(e){var t=e.FillData,n=50;if(n%2!==1){var r={FillColor:[],FillIndex:[],FillNormal:[],FillVertex:[]},o=[];if(t[0].FillVertex.forEach(function(c,f){f%3===0&&!o[Math.floor(f/3)]&&(o[Math.floor(f/3)]=[]),o[Math.floor(f/3)].push(c)}),o[0][0]===o[1][0])for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[3][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[3][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[3][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[1][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[1][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[1][2]-o[2][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[2][2])}else for(var a=0;a<n;a++)if(r.FillColor.push(t[0].FillColor[0],t[0].FillColor[1],t[0].FillColor[2],t[0].FillColor[3]),a+1<n/2&&(r.FillIndex.push(a,a+1,n-1-(a+1)),r.FillIndex.push(a,n-1-(a+1),n-1-a)),r.FillNormal.push(t[0].FillNormal[0],t[0].FillNormal[1],t[0].FillNormal[2]),a<n/2){var s=2*(o[1][0]-o[0][0])/(n-2);r.FillVertex.push(s*a+o[0][0]);var u=2*(o[1][1]-o[0][1])/(n-2);r.FillVertex.push(u*a+o[0][1]);var l=2*(o[1][2]-o[0][2])/(n-2);r.FillVertex.push(l*a+o[0][2])}else{var s=2*(o[3][0]-o[2][0])/(n-2);r.FillVertex.push(s*(a-n/2)+o[2][0]);var u=2*(o[3][1]-o[2][1])/(n-2);r.FillVertex.push(u*(a-n/2)+o[2][1]);var l=2*(o[3][2]-o[3][2])/(n-2);r.FillVertex.push(l*(a-n/2)+o[3][2])}delete t[0].FillVertex,t[0].FillVertex=new Float64Array(r.FillVertex.length);for(var a=0;a<r.FillVertex.length;a++)t[0].FillVertex[a]=r.FillVertex[a];delete t[0].FillNormal,t[0].FillNormal=new Float64Array(r.FillNormal.length);for(var a=0;a<r.FillNormal.length;a++)t[0].FillNormal[a]=r.FillNormal[a];delete t[0].FillIndex,t[0].FillIndex=new Int32Array(r.FillIndex.length);for(var a=0;a<r.FillIndex.length;a++)t[0].FillIndex[a]=r.FillIndex[a];delete t[0].FillColor,t[0].FillColor=new Uint8Array(r.FillColor.length);for(var a=0;a<r.FillColor.length;a++)t[0].FillColor[a]=r.FillColor[a]}}function Z$(e){if(!!e){var t=parseInt((e.alpha||1)*255),n=parseInt(e.red*255),r=parseInt(e.green*255),o=parseInt(e.blue*255),a=n<<24|r<<16|o<<8|t;return a>>>0}}var oL=nr;function Dd(e){_(e.viewer)||console.error("'EV_MilStdActionDeduce' parameter 'options.viewer' error !"),this.viewer=e.viewer,this.dudeceGeometry={},this.allSymbol={},this.action={},this.actionGroup={},this.actionTreeData=[],this.defaultActionAttri={startTime:"0",durationTime:"5",isPlayEndReset:0,blinkInterval:1,rotateType:1,routeBindGuid:-1,isVisibleRoute:0,rotateCorrect:0,moveType:1},this.actionIndex=0}Dd.prototype.clickAddAction=function(e){let t=new Date().getTime().toString(),n=t.replace(t.slice(3,6),"");switch(this.action={_actionGuid:n,_symbolGuid:this.dudeceGeometry.id,actionAttr:{_startTime:this.defaultActionAttri.startTime,_durationTime:this.defaultActionAttri.durationTime,_isPlayEndReset:this.defaultActionAttri.isPlayEndReset,_type:e},othersAttri:{actionName:void 0,playinAttrigName:void 0},specialAttri:[],valueResetFlag:!0},e){case 1:this.action.actionAttr.actionBlinkInterval={_blinkInterval:this.defaultActionAttri.blinkInterval},this.action.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:this.action.actionAttr.actionRotateType={_rotateType:this.defaultActionAttri.rotateType},this.action.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:this.action.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:this.action.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:this.action.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:this.action.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:this.action.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:this.action.actionAttr.actionRouteBindGuid={routeBindGuid:this.defaultActionAttri.routeBindGuid},this.action.actionAttr.actionVisibleRoute={isVisibleRoute:this.defaultActionAttri.isVisibleRoute},this.action.actionAttr.actionRotateRoute={rotateCorrect:this.defaultActionAttri.rotateCorrect},this.action.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:this.action.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},this.action.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:this.action.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:this.action.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:this.action.othersAttri={actionName:"\u64E6\u5165"};break;case 13:this.action.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("tpye erro!")}this.actionGroup[this.action._actionGuid]=this.action,this.actionTreeData.push({label:`${this.action.othersAttri.actionName}-${this.dudeceGeometry.name}`,index:this.actionIndex,type:e,actionGuid:this.action._actionGuid,width:this.action.actionAttr._durationTime*15+30,left:0}),this.actionIndex++};Dd.prototype.openAddAction=function(e){let t;for(let n=0;n<e.length;n++){switch(t=e[n],this.action={_actionGuid:t._ActionGuid,_symbolGuid:t._SymbolGuid,actionAttr:{_startTime:t.ActionAttr._StartTime,_durationTime:t.ActionAttr._DurationTime,_isPlayEndReset:t.ActionAttr._IsPlayEndReset,_type:t.ActionAttr._Type*1},othersAttri:{actionName:void 0},specialAttri:[],valueResetFlag:!0},this.action.actionAttr._type){case 1:this.action.actionAttr.actionBlinkInterval={_blinkInterval:t.ActionAttr.ActionBlinkInterval._BlinkInterval},this.action.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:this.action.actionAttr.actionRotateType={_rotateType:t.ActionAttr.ActionRotateType._RotateType},this.action.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:this.action.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:this.action.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:this.action.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:this.action.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:this.action.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:this.action.actionAttr.actionRouteBindGuid={routeBindGuid:t.ActionAttr.ActionRouteBindGuid._RouteBindGuid},_(t.ActionAttr.ActionVisibleRoute)&&(this.action.actionAttr.actionVisibleRoute={isVisibleRoute:t.ActionAttr.ActionVisibleRoute._IsVisibleRoute}),_(t.ActionAttr.ActionRotateRoute)&&(this.action.actionAttr.actionRotateRoute={rotateCorrect:t.ActionAttr.ActionRotateRoute._RotateCorrect}),this.action.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:this.action.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},this.action.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:this.action.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:this.action.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:this.action.othersAttri={actionName:"\u64E6\u5165"};break;case 13:this.action.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("tpye erro!")}this.actionGroup[this.action._actionGuid]=this.action;let r=this.getGeometry(this.action._symbolGuid),o;r&&(o=r.name),this.actionTreeData.push({label:`${this.action.othersAttri.actionName}-${o}`,index:n,type:this.action.actionAttr._type,actionGuid:this.action._actionGuid,width:this.action.actionAttr._durationTime*15+30,left:this.action.actionAttr._startTime*15})}};Dd.prototype.getTimerEndTime=function(){let e=0;if(Object.keys(this.actionGroup).length===0)return 5;for(let t in this.actionGroup)if(this.actionGroup.hasOwnProperty(t)){let n=this.actionGroup[t],r=n.actionAttr._startTime*1+n.actionAttr._durationTime*1;r>e&&(e=r)}return e};Dd.prototype.resetDurationTime=function(e){if(Object.keys(this.actionGroup).length!==0){for(let t in this.actionGroup)if(this.actionGroup.hasOwnProperty(t)){let n=this.actionGroup[t];e===2?n.actionAttr._durationTime=n.actionAttr._durationTime/2:e===.5?n.actionAttr._durationTime=n.actionAttr._durationTime*2:console.error("\u500D\u901F\u7684\u53C2\u6570\u9519\u8BEF")}}};Dd.prototype.getPalyActions=function(e){let t=[];for(let n in this.actionGroup)if(this.actionGroup.hasOwnProperty(n)){let r=this.actionGroup[n];e>r.actionAttr._startTime*1e3&&e<=r.actionAttr._startTime*1e3+r.actionAttr._durationTime*1e3&&t.push(r)}return t};Dd.prototype.playAction=function(e,t){let n,o=this;a(0);function a(s){if(s<t.length){n=t[s];let u=100,l,c,f,h=n.othersAttri.changingAttriName,d=n.actionAttr._startTime*1e3,p=n.actionAttr._durationTime*1e3,g=d+p,y=e-d,v=n.actionAttr._type,w=o.getGeometry(n._symbolGuid);switch(v){case 1:if(n.startValue||(n.startValue=w[h]),n.valueResetFlag){n.valueResetFlag=!1,n.blinkChangeMoment=Math.ceil(1e3/(2*n.actionAttr.actionBlinkInterval._blinkInterval)),n.copyBlink=n.blinkChangeMoment,n.nextValues=[];let C=n.startValue;for(let E=100;E<p+100;E+=u)n.blinkChangeMoment-E<50?(C=!C,n.nextValues.push(C),n.blinkChangeMoment+=n.copyBlink):n.nextValues.push(C)}w[h]=n.nextValues[y/100-1],e===g&&n.actionAttr._isPlayEndReset===1&&o.resetValue(w,h,n),s++,a(s);break;case 2:if(!n.startValue&&n.startValue!==0&&(n.startValue=Number(w[h])),n.valueResetFlag){n.valueResetFlag=!1;let C=n.actionAttr.actionRotateType._rotateType;c=n.startValue,C===1?l=c+360:l=c-360,f=fx(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let E=100;E<p+100;E+=u)n.nextValues.push(av(c,fx(f,E/u)))}w[h]=n.nextValues[y/100-1],e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 3:if(n.startValue||(n.startValue=w[h]-0),n.valueResetFlag){n.valueResetFlag=!1,c=0,l=n.startValue,f=fx(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let C=100;C<p+100;C+=u)n.nextValues.push(av(c,fx(f,C/u)))}w[h]=n.nextValues[y/100-1],e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 4:if(n.startValue||(n.startValue=w[h]),n.valueResetFlag){n.valueResetFlag=!1,c=n.startValue,l=0,f=fx(l-c,(u/p).toFixed(3)),n.nextValues=[];for(let C=100;C<p+100;C+=u)n.nextValues.push(av(c,fx(f,C/u)));n.nextValues[n.nextValues.length-1]=1e-4}w[h]=n.nextValues[y/100-1],e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 5:if(n.valueResetFlag){n.valueResetFlag=!1,n.resetValue=w[h],n.growPositionIndex=1,c=n.resetValue,l=J$(c,p,v),n.growPositions=[],n.growPositions[0]=c[0],n.nextValues=[],n.nextValues.push(n.growPositions);for(let C=100;C<p+100;C+=u)n.growPositionIndex<c.length&&(l[C/100].x!==c[n.growPositionIndex].x||l[C/100].y!==c[n.growPositionIndex].y||l[C/100].z!==c[n.growPositionIndex].z?(n.growPositions[n.growPositionIndex]=l[C/100],n.nextValues.push(yz(n.growPositions))):(n.growPositions[n.growPositionIndex]=l[C/100],n.growPositionIndex++,n.nextValues.push(yz(n.growPositions))))}if(!n.startValue){let C=n.nextValues.length;n.startValue=n.nextValues[C-1]}w.setEditMode(!0,!1),w.positions=n.nextValues[y/100-1],w.requestVartexData(),e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 6:n.startValue||(n.startValue=w[h]),e===g&&(w[h]=!0),e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 7:n.startValue||(n.startValue=w[h]),n.valueResetFlag&&(n.valueResetFlag=!1,c=n.startValue),e===g&&(w[h]=!1),e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break;case 8:{let C=o.getGeometry(n.actionAttr.actionRouteBindGuid.routeBindGuid);if(C.setEditMode(!1),n.startValue||(n.startValue=w[h],n.wayGeometry=C,n.wayGeometry.resetValue=n.wayGeometry.show),n.valueResetFlag){let E=C.mainLinePositions[0],S=[];E.forEach(function(M,I,O){let m=ce.fromCartesian(M),b=Math.toDegrees(m.longitude),L=Math.toDegrees(m.latitude),R=(C.height+C.maxAnchorMarkHeight)*1e3;S.push(x.fromDegrees(b,L,R))});let A=S.length,D=p/100,P=S.concat([]);if(n.nextValues=[],A>D){let M=Math.floor(A/D),I=A%D,O;for(let m=0;m<D;m++)if(n.nextValues[m]=[],n.nextValues.length<=I)for(let b=0;b<M+1;b++)O=P.shift(),n.nextValues[m].push(O);else for(let b=0;b<M;b++)O=P.shift(),n.nextValues[m].push(O)}else n.nextValues=J$(S,p,v);C.show=!1,n.actionAttr.actionVisibleRoute&&!n.actionAttr.actionVisibleRoute.isVisibleRoute===0&&(C.show=!0)}if(n.nextValues[y/100-1].length){let E=n.nextValues[y/100-1].length;for(let S=0;S<E;S++)w[h]=n.nextValues[y/100-1][S]}else w[h]=n.nextValues[y/100-1];e===g&&n.actionAttr._isPlayEndReset===1&&(o.resetValue(w,h,n),console.log(n)),s++,a(s);break}case 9:o.viewer.camera.flyToBoundingSphere(w._primitive._boundingSpheres[0],{duration:p/1e3-1}),console.log(n),s++,a(s);break;case 10:e===d+100&&(w[h]=!0),e===g&&(w[h]=!1),s++,a(s);break;case 11:e===d+100&&(w[h]=!1),e===g&&(w[h]=!0),s++,a(s);break;case 12:break;case 13:break}}}console.log(11111)};Dd.prototype.getGeometry=function(e){if(this.allSymbol[e])return this.allSymbol[e]};Dd.prototype.createTween=function(e,t,n,r,o,a,s,u,l){let c=this,f=setInterval(function(){t<n?(t+=e,r=av(r,o),l(t,r)):(clearInterval(f),a===1&&c.resetValue(s,u))},e)};Dd.prototype.resetValue=function(e,t,n){let r=n.startValue;r&&(e[t]=r,n.wayGeometry&&(n.wayGeometry.show=n.wayGeometry.resetValue))};Dd.prototype.getWayGeometryId=function(e){this.action.actionAttr.actionRouteBindGuid.routeBindGuid=e.id};function J$(e,t,n){let r=[],o=[],a=[],s=[],u=0;for(let d=0;d<e.length-1;d++){let p=av(e[d+1].x,-e[d].x),g=av(e[d+1].y,-e[d].y);r[d]=Math.sqrt(av(p*p,g*g)),u+=r[d]}r.forEach(function(d,p){a[p]=Math.floor(d/u*t/100),o[p]=d/u*t/100});let l=[],c=[],f=[],h=0;o.forEach(function(d,p){l[p]=d%1}),c=l.sort(function(d,p){return p-d}),l.forEach(function(d,p){h+=d,f[p]=c.indexOf(d)}),h=Math.round(h);for(let d=0;d<h;d++)a[f[d]]++;for(let d=0;d<a.length;d++)for(let p=1;p<a[d]+1;p++){let g=e[d+1].x-e[d].x,y=e[d+1].y-e[d].y,v=e[d+1].z-e[d].z,w={x:e[d].x+g/(a[d]-1)*(p-1),y:e[d].y+y/(a[d]-1)*(p-1),z:e[d].z+v/(a[d]-1)*(p-1)};s.push(w)}return s}function fx(e,t){let n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch(a){console.log(a)}try{n+=o.split(".")[1].length}catch(a){console.log(a)}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function av(e,t){let n,r;try{n=e.toString().split(".")[1].length}catch{n=0}try{r=t.toString().split(".")[1].length}catch{r=0}let o=Math.pow(10,Math.max(n,r));return($$(e,o)+$$(t,o))/o}function $$(e,t){let n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch(a){console.log(a)}try{n+=o.split(".")[1].length}catch(a){console.log(a)}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function yz(e){let t=e.constructor===Array?[]:{};if(typeof e!="object")return e;for(let n in e)typeof e[n]=="object"?t[n]=yz(e[n]):t[n]=e[n];return t}var eee=Dd;function sv(e){this.groupName=e,this.id=Cesium.createGuid(),this.actions=new Cesium.AssociativeArray,this.timerMoment=0,this.groupStartTime=0,this.groupEndTime=0}sv.prototype.addAction=function(e,t){if(!Cesium.defined(e)){console.error("MilStdDeduceGroup methods addAction parameter 'actionId' error!");return}if(!Cesium.defined(t)){console.error("MilStdDeduceGroup methods addAction parameter 'action' error!");return}return this.actions.set(e,t)};sv.prototype.getAction=function(e){let t=this.actions.get(e);if(!Cesium.defined(t)){console.error("MilStdDeduceGroup methods 'getAction' undefined this 'action'");return}return t};sv.prototype.removeAction=function(e){this.actions.remove(e)};sv.prototype.getAllActions=function(){return this.actions.values};sv.prototype.removeAllActions=function(){this.actions.removeAll()};sv.prototype.destroy=function(){return this.removeAllActions(),this.actions=void 0,Cesium.destroyObject(this)};var aL=sv;function aa(e){this.milStdDrawHelper=e,this.camera=e.viewer.camera,this.deduceMap=new Cesium.AssociativeArray,this.initDefaultAttr(),this.timerplayState=0,this.playPlanId=void 0,this.playGroupIndex=0,this.playedDeduceGroups=[],this.getSymbol=function(t){return milStdLayerManager.getSymbol(t)},this.fpsNum=20,this._momentFps=1,this.speed=1}aa.prototype.createDeducePlan=function(e){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'createDeducePlan' parameter 'deducePlanName' error!");return}var t=Cesium.createGuid(),n={name:e,id:t,deduceGroups:new Cesium.AssociativeArray};return this.deduceMap.set(t,n),n};aa.prototype.getDeducePlan=function(e){if(Cesium.defined(e)){if(this.deduceMap.contains(e)){var t=this.deduceMap.get(e);return t}}else{console.error("EV_MilStdDeduceManager methods 'getDeducePlan' parameter 'deducePlanId' error!");return}};aa.prototype.deleteDeducePlan=function(e){if(this.resetDeduce(),!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'deleteDeducePlan' parameter 'deducePlanId' error!");return}this.deduceMap.contains(e)&&this.deduceMap.remove(e)};aa.prototype.clearDeducePlan=function(e){if(this.resetDeduce(),!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'clearDeducePlan' parameter 'deducePlanId' error!");return}var t=this.getDeduceGroups(e);t&&t.forEach(n=>{if(n){var r=n.id;this.removeDeduceGroup(r)}})};aa.prototype.deleteAllDeducePlans=function(){var e=this.deduceMap.values;e&&e.forEach(t=>{if(t){var n=t.id;this.deleteDeducePlan(n)}}),this.deduceMap=new Cesium.AssociativeArray};aa.prototype.createDeduceGroup=function(e,t){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'createDeduceGroup' parameter 'deducePlanId' error!");return}if(!Cesium.defined(t)){console.error("EV_MilStdDeduceManager methods 'createDeduceGroup' parameter 'groupName' error!");return}var n=this.getDeducePlan(e);if(n){var r=new aL(t),o=n.deduceGroups.length;return r.groupIndex=o,n.deduceGroups.set(r.id,r),r}};aa.prototype.getDeduceGroup=function(e,t){if(!Cesium.defined(e)){console.error("EV_MilStdDeduceManager methods 'getDeduceGroup' parameter 'deducePlanId' error!");return}if(!Cesium.defined(t)){console.error("EV_MilStdDeduceManager methods 'getDeduceGroup' parameter 'groupId' error!");return}var n=this.getDeducePlan(e);if(n&&n.deduceGroups.contains(t)){var r=n.deduceGroups.get(t);return r}};aa.prototype.removeDeduceGroup=function(e,t){this.resetDeduce();var n=this.getDeducePlan(e),r=this.getDeduceGroup(e,t);n&&r&&(r.destroy(),n.deduceGroups.remove(t))};aa.prototype.clearDeduceGroup=function(e,t){this.resetDeduce();var n=this.getDeduceGroup(e,t);n&&n.removeAllActions()};aa.prototype.getDeduceGroups=function(e){var t=this.getDeducePlan(e);if(t){var n=t.deduceGroups.values;return n&&Array.isArray(n)?n:[]}};aa.prototype.getPlanActions=function(e){var t=this.getDeduceGroups(e);if(t){var n=[];return t.forEach(r=>{if(r){var o=r.getAllActions();n.push(...o)}}),n}};aa.prototype.playDeduceGroup=function(e,t,n,r){var o=this.getDeduceGroup(e,t);if(Cesium.defined(o)){var a=o.getAllActions();if(a.length!==0){if(this.playGroupIndex=o.groupIndex,this.playedDeduceGroups.push([e,t]),this.timerplayState===0&&a){let l=function(c,f,h,d){var p=Date.now(),g=p;let y=1e3/f/h;var v=!1;function w(){if(!v){requestAnimationFrame(w);var C=Date.now();g=C-p,g>y&&(p=C-g%y,c<=u?(d&&d(c,t),a&&a.length>0?tee(s,c,a):(console.log("no action need playe"),s.cancelRAF(),s.timerplayState=0),c++,s._momentFps=c):(s.cancelRAF(),s._momentFps=1,s.timerplayState=0,tee&&r(o.id)))}}return w(),function(){v=!0}};this.timerplayState=1;var s=this,u=o.groupEndTime*this.fpsNum;this.cancelRAF=l(this._momentFps,this.fpsNum,this.speed,n)}}else r(null)}else r(null)};aa.prototype.playDeducePlan=function(e,t,n){var r=this.getDeduceGroups(e);if(r){let s=function(u,l,c){var f=r.filter(h=>{if(h.groupIndex===l[c])return h.id});f.length!==1?console.error("EV_MilStdDeduceManager methods 'playDeducePlan' playGroupIndex is same"):u.playDeduceGroup(e,f[0].id,t,function(h){c++,c<l.length?u.playGroupIndex++:(u.playGroupIndex=0,n(e))})};var o=r.map(u=>u.groupIndex);o.sort(function(u,l){return u-l});var a=o.indexOf(this.playGroupIndex);s(this,o,a)}else n(null)};aa.prototype.pauseDeduce=function(){this.cancelRAF&&this.cancelRAF(),this.timerplayState=0};aa.prototype.resetDeduce=function(){this.pauseDeduce(),this._momentFps=0,this.playGroupIndex=0;var e=this;this.playedDeduceGroups.forEach(t=>{var n=t[0],r=t[1];e.resetDeduceGroupPlayState(n,r)}),this.playedDeduceGroups=[]};aa.prototype.resetActionPlaySate=function(e){var t=e.startValue;if(!!t){var n=e.actionAttr._type,r=e._symbolGuid;switch(n){case 1:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 2:this.milStdDrawHelper.setMarkSymbolRotate(r,t);break;case 3:this.milStdDrawHelper.setMarkSymbolScale(r,t);break;case 4:this.milStdDrawHelper.setMarkSymbolScale(r,t);break;case 5:this.milStdDrawHelper.setLineSymbolPositionCartographics(r,t);break;case 6:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 7:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 8:this.milStdDrawHelper.setMarkSymbolPositionCartographic(r,t),e.wayGeometry&&(e.wayGeometry.symbol.show=e.wayGeometry.resetValue||!0);break;case 9:break;case 10:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 11:this.milStdDrawHelper.setSymbolVisible(r,t);break;case 12:break;case 13:break}}};aa.prototype.resetDeduceGroupPlayState=function(e,t){var n=this.getDeduceGroup(e,t);if(n){var r=n.getAllActions(),o=this;r.forEach(function(a){o.resetActionPlaySate(a)})}};aa.prototype.actionChangeGroup=function(e,t,n,r){this.resetDeduce();var o=this.getDeduceGroup(t,n),a=this.getDeduceGroup(t,r);if(o&&a){var s=o.getAction(e);a.addAction(e,s),o.removeAction(e)}};aa.prototype.setSpeed=function(e){this.speed=e};aa.prototype.createDeducePlanByFile=function(e,t){var n=this.createDeducePlan(e),r=t.SITSYMBOLFILE.ACTIONGROUPS,o=0;if(r&&r._Count>0){r._Count==1&&(r.ActionGroup=[r.ActionGroup]);for(var a=0;a<r._Count;a++){var s=0,u=0,l="\u7EC4"+a,c=parseInt(r.ActionGroup[a]._GroupIndex),f=this.createDeduceGroup(n.id,l);f.groupIndex=c;var h=r.ActionGroup[a]&&r.ActionGroup[a].Action||r.ActionGroup.Action;h&&(Array.isArray(h)||(h=[h]),h.forEach(d=>{var p=d._ActionGuid,g=d._SymbolGuid,y=Number(d.ActionAttr._Type),v=Number(d.ActionAttr._StartTime),w=Number(d.ActionAttr._DurationTime),C=v+w;u<C&&(u=C),s>v&&(s=v),f.groupStartTime=s,f.groupEndTime=u;var E={_actionGuid:p,_symbolGuid:g,actionAttr:{_startTime:d.ActionAttr._StartTime,_durationTime:d.ActionAttr._DurationTime,_isPlayEndReset:d.ActionAttr._IsPlayEndReset,_type:Number(d.ActionAttr._Type)},valueResetFlag:!0};switch(y){case 1:E.actionAttr.actionBlinkInterval={_blinkInterval:d.ActionAttr.ActionBlinkInterval._BlinkInterval},E.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:E.actionAttr.actionRotateType={_rotateType:d.ActionAttr.ActionRotateType._RotateType},E.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:d.ActionAttr.ActionScaleType&&d.ActionAttr.ActionScaleType._ScaleType?E.actionAttr.actionScaleType={_scaleType:d.ActionAttr.ActionScaleType._ScaleType}:E.actionAttr.actionScaleType={_scaleType:1},E.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:E.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:d.ActionAttr.ActionGrowType&&d.ActionAttr.ActionGrowType._GrowType?E.actionAttr.actionGrowType={_growType:d.ActionAttr.ActionGrowType._GrowType}:E.actionAttr.actionGrowType={_growType:1},E.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:E.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:E.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:E.actionAttr.actionRouteBindGuid={routeBindGuid:d.ActionAttr.ActionRouteBindGuid._RouteBindGuid},Cesium.defined(d.ActionAttr.ActionVisibleRoute)&&(E.actionAttr.actionVisibleRoute={isVisibleRoute:d.ActionAttr.ActionVisibleRoute._IsVisibleRoute}),Cesium.defined(d.ActionAttr.ActionRotateRoute)&&(E.actionAttr.actionRotateRoute={rotateCorrect:d.ActionAttr.ActionRotateRoute._RotateCorrect}),E.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:E.actionAttr.actionMoveInfo={Longitude:"99.72833977452308",Heading:"-2.135375262219943",Latitude:"33.43071075250957",Tilt:"3.697966127226506",Altitude:"384726.0114513896"},E.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:E.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:E.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:E.othersAttri={actionName:"\u64E6\u5165"};break;case 13:E.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("EV_MilStdDeduceManager methods 'createDeducePlanByFile' parameter 'type' error!")}f.addAction(p,E)}),o<u&&(o=u))}}return n.planEndTime=o,n};aa.prototype.createDeducePlanByClick=function(e,t,n,r){var o=this.getDeduceGroup(e,t);if(o){var a=LRe(),s=r,u=this.defaultAttr.startTime,l=this.defaultAttr.durationTime,c=this.defaultAttr.isPlayEndReset,f=this.defaultAttr.blinkInterval,h=this.defaultAttr.rotateType,d=this.defaultAttr.scaleType,p=this.defaultAttr.growType,g=this.defaultAttr.routeBindGuid,y=this.defaultAttr.isVisibleRoute,v=this.defaultAttr.rotateCorrect,w=this.defaultAttr.moveType,C=u+l;o.groupEndTime<C&&(o.groupEndTime=C),o.groupStartTime>C&&(o.groupStartTime=C);var E={_actionGuid:a,_symbolGuid:n,actionAttr:{_startTime:u,_durationTime:l,_isPlayEndReset:c,_type:s},valueResetFlag:!0};switch(s){case 1:E.actionAttr.actionBlinkInterval={_blinkInterval:f},E.othersAttri={actionName:"\u95EA\u70C1",changingAttriName:"show"};break;case 2:E.actionAttr.actionRotateType={_rotateType:h},E.othersAttri={actionName:"\u65CB\u8F6C",changingAttriName:"rotation"};break;case 3:d?E.actionAttr.actionScaleType={_scaleType:d}:E.actionAttr.actionScaleType={_scaleType:1},E.othersAttri={actionName:"\u653E\u5927",changingAttriName:"scale"};break;case 4:E.othersAttri={actionName:"\u7F29\u5C0F",changingAttriName:"scale"};break;case 5:p?E.actionAttr.actionGrowType={_growType:p}:E.actionAttr.actionGrowType={_growType:1},E.othersAttri={actionName:"\u751F\u957F",changingAttriName:"positions"};break;case 6:E.othersAttri={actionName:"\u6E10\u5165",changingAttriName:"show"};break;case 7:E.othersAttri={actionName:"\u6E10\u51FA",changingAttriName:"show"};break;case 8:E.actionAttr.actionRouteBindGuid={routeBindGuid:g},Cesium.defined(item.ActionAttr.ActionVisibleRoute)&&(E.actionAttr.actionVisibleRoute={isVisibleRoute:y}),Cesium.defined(item.ActionAttr.ActionRotateRoute)&&(E.actionAttr.actionRotateRoute={rotateCorrect:v}),E.othersAttri={actionName:"\u8DEF\u5F84",changingAttriName:"position"};break;case 9:var S=this.camera._positionCartographic.longitude*180/Math.PI,A=this.camera._positionCartographic.latitude*180/Math.PI,D=this.camera._positionCartographic.height,P=this.camera.heading,M=this.camera.pitch;E.actionAttr.actionMoveInfo={Longitude:S,Heading:P,Latitude:A,Tilt:M,Altitude:D},E.othersAttri={actionName:"\u79FB\u56FE"};break;case 10:E.othersAttri={actionName:"\u663E\u793A",changingAttriName:"show"};break;case 11:E.othersAttri={actionName:"\u9690\u85CF",changingAttriName:"show"};break;case 12:E.othersAttri={actionName:"\u64E6\u5165"};break;case 13:E.othersAttri={actionName:"\u64E6\u51FA"};break;default:console.error("EV_MilStdDeduceManager methods 'createDeducePlanByFile' parameter 'type' error!")}return o.addAction(a,E),E}};aa.prototype.saveDeduceData=function(){var e={};if(!(this.deduceMap.length<1)){var t=this.deduceMap.values[0],n=t.deduceGroups,r=n.length;e._Count=r;var o=e;o.ActionGroup=[];for(var a=0;a<r;a++){var s=n.values[a],u=o.ActionGroup[o.ActionGroup.length]={};u._GroupIndex=a,u.Action=[];for(var l=s.actions.values,c=l.length,f=0;f<c;f++){var h=l[f],d=u.Action[u.Action.length]={};d._ActionGuid=h._actionGuid,d._SymbolGuid=h._symbolGuid,d.ActionAttr={_StartTime:h.actionAttr._startTime,_DurationTime:h.actionAttr._durationTime,_IsPlayEndReset:h.actionAttr._isPlayEndReset,_Type:h.actionAttr._type};var p=h.actionAttr._type;switch(p){case 1:d.ActionAttr.ActionBlinkInterval={_BlinkInterval:h.actionAttr.actionBlinkInterval._blinkInterval};break;case 2:d.ActionAttr.ActionRotateType={_RotateType:h.actionAttr.actionRotateType._rotateType};break;case 3:d.ActionAttr.ActionScaleType={_ScaleType:h.actionAttr.actionScaleType._scaleType};break;case 4:break;case 5:d.ActionAttr.ActionGrowType={_GrowType:h.actionAttr.actionGrowType._growType};break;case 8:d.ActionAttr.ActionRouteBindGuid={_RouteBindGuid:h.actionAttr.actionRouteBindGuid.routeBindGuid};break;default:break}}}return e}};aa.prototype.initDefaultAttr=function(){this.defaultAttr={startTime:0,durationTime:5,isPlayEndReset:0,blinkInterval:1,rotateType:1,scaleType:1,growType:1,routeBindGuid:-1,isVisibleRoute:0,rotateCorrect:0,moveType:1}};function tee(e,t,n){var r=void 0,o=0;a(o);function a(s){if(s<n.length&&(r=n[s],r)){var u,l,c,f,h=r._symbolGuid,d=void 0,p=void 0,g=void 0,y;if(r.actionAttr&&(u=r.actionAttr._startTime*e.fpsNum,l=r.actionAttr._durationTime*e.fpsNum,c=r.actionAttr._type,f=u+l),u<t&&t<=f)switch(c){case 1:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag){r.valueResetFlag=!1,r.blinkChangeMoment=r.actionAttr.actionBlinkInterval._blinkInterval,r.copyBlink=r.blinkChangeMoment,r.nextValues=[];var v;for(y=0;y<l;y++)y%(e.fpsNum/r.copyBlink)>=e.fpsNum/(r.copyBlink*2)?v=!0:v=!1,r.nextValues.push(v)}e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 2:if(!r.startValue&&r.startValue!==0&&(r.startValue=e.milStdDrawHelper.getMarkSymbolRotate(h)),r.valueResetFlag){r.valueResetFlag=!1;var w=parseInt(r.actionAttr.actionRotateType._rotateType);if(d=r.startValue,w===0)p=d-360;else if(w===1)p=d+360;else return;for(g=uv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(parseFloat(d+(g*(y+1)).toFixed(2)))}e.milStdDrawHelper.setMarkSymbolRotate(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 3:if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolScale(h)),r.valueResetFlag)for(r.valueResetFlag=!1,d=0,p=r.startValue,g=uv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(nee(d,hx(g,y+1)));e.milStdDrawHelper.setMarkSymbolScale(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 4:if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolScale(h)),r.valueResetFlag){for(r.valueResetFlag=!1,d=r.startValue,p=0,g=uv(p-d,l),r.nextValues=[],y=0;y<l;y++)r.nextValues.push(nee(d,hx(g,y+1)));r.nextValues[r.nextValues.length-1]=1e-4}e.milStdDrawHelper.setMarkSymbolScale(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 5:r.startValue||(r.startValue=e.milStdDrawHelper.getLineSymbolPositionCartographics(h)),r.valueResetFlag&&(r.valueResetFlag=!1,p=r.startValue,r.nextValues=MRe(p,l)),e.milStdDrawHelper.setLineSymbolPositionCartographics(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 6:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!1):r.nextValues.push(!0);t===u+1&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 7:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!0):r.nextValues.push(!1);t===u+1&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 8:var C=e.milStdDrawHelper._milStd3DRanderManager.getSymbol(r.actionAttr.actionRouteBindGuid.routeBindGuid);if(r.startValue||(r.startValue=e.milStdDrawHelper.getMarkSymbolPositionCartographic(h),r.wayGeometry=C,r.wayGeometry.resetValue=r.wayGeometry.symbol.show),r.valueResetFlag){r.valueResetFlag=!1;var E=C.mainLinePositions[0],S=C.getAnchorHeight(),A=[];E.forEach(function(R){var N=Cesium.Cartographic.fromCartesian(R);N.height=S,A.push(Cesium.Cartographic.toCartesian(N))});var D=A.length,P=l,M=A.concat([]);if(r.nextValues=[],D>P)for(var I=Math.floor(D/P),O=D%P,m,b=0;b<P;b++)if(r.nextValues[b]=[],r.nextValues.length<=O)for(var L=0;L<I+1;L++)m=M.shift(),r.nextValues[b].push(m);else for(var L=0;L<I;L++)m=M.shift(),r.nextValues[b].push(m);else r.nextValues=PRe(A,l);C.symbol.show=!1,r.actionAttr.actionVisibleRoute&&r.actionAttr.actionVisibleRoute.isVisibleRoute!=="0"&&(C.symbol.show=!0)}e.milStdDrawHelper.setMarkSymbolPositionCartographic(h,r.nextValues[t-u-1]),e.milStdDrawHelper.getSymbolVisible(h)||e.milStdDrawHelper.setSymbolVisible(h,!0),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 9:break;case 10:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!1):r.nextValues.push(!0);e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 11:if(r.startValue||(r.startValue=e.milStdDrawHelper.getSymbolVisible(h)),r.valueResetFlag)for(r.nextValues=[],y=0;y<l;y++)y<l-1?r.nextValues.push(!0):r.nextValues.push(!1);e.milStdDrawHelper.getSymbolVisible(h)!=r.nextValues[t-u-1]&&e.milStdDrawHelper.setSymbolVisible(h,r.nextValues[t-u-1]),t===f&&r.actionAttr._isPlayEndReset==1&&e.resetActionPlaySate(r);break;case 12:break;case 13:break}s++,a(s)}}}function PRe(e,t){let n=t;t=t-1;var r=e.length,o=[],a=0,s=[];if(r-1!==1){for(var u=0;u<r-1;u++){var l=Cesium.Cartesian3.distance(e[u+1],e[u]);o[u]=l,a+=l}var c=o.length;t=t-c;for(var f=[],h=[],u=0;u<c;u++){var d=Math.floor(hx(uv(o[u],a),t));f[u]=d;var p=hx(uv(o[u],a),t)%1;h[u]=p}var g=h.sort(function(P,M){return M-P}),y=0;g.forEach(P=>{y+=P}),y=Math.round(y);for(var v=0,w=!1,u=0;u<g.length&&!w;u++)for(var C=0;C<c;C++)if(g[u]===h[C])if(v<y)v++,f[C]++;else{w=!0;break}for(var u=0;u<c;u++)for(var E=f[u],S=1;S<=E+1;S++)s.push(Cesium.Cartesian3.lerp(e[u],e[u+1],S/(E+1),new Cesium.Cartesian3))}else{t=t==0?1:t;for(var S=1/(t+1);S<=1;S+=1/(t+1))s.push(Cesium.Cartesian3.lerp(e[0],e[1],S,new Cesium.Cartesian3))}var A=[];A.push(Cesium.Cartographic.fromCartesian(e[0]));for(var u=0;u<s.length;u++)A.push(Cesium.Cartographic.fromCartesian(s[u]));let D=n-A.length;return D!==0&&console.log("\u8DEF\u5F84\u52A8\u753B\u70B9\u6570"+D),A}function MRe(e,t){for(var n=[],r=0;r<e.length;r++)n.push(Cesium.Cartographic.toCartesian(e[r]));var o=n.length,a=[],s=0,u=[];if(o-1!==1){for(var r=0;r<o-1;r++){var l=Cesium.Cartesian3.distance(n[r+1],n[r]);a[r]=l,s+=l}for(var c=a.length,f=[],h=[],r=0;r<c;r++){var d=Math.floor(hx(uv(a[r],s),t));f[r]=d;var p=hx(uv(a[r],s),t)%1;h[r]=p}var g=h.sort(function(P,M){return M-P}),y=0;g.forEach(P=>{y+=P}),y=Math.round(y);for(var v=0,r=0;r<g.length;r++)for(var w=0;w<c;w++)if(g[r]===h[w])if(v<y)v++,f[w]++;else break;for(var r=0;r<c;r++){var C=f[r],E=[];C=C==0?1:C;for(var S=0;S<C;S++)E.push([n[r],Cesium.Cartesian3.lerp(n[r],n[r+1],S/C,new Cesium.Cartesian3)]);if(r>0)for(var v=r;v>0;)E.forEach(I=>{I.unshift(n[v-1])}),v--;u.push(...E)}}else{t=t==0?1:t;for(var S=0;S<t;S++)u.push([n[0],Cesium.Cartesian3.lerp(n[0],n[1],S/t,new Cesium.Cartesian3)])}for(var A=[],r=0;r<u.length;r++){A[r]=[];for(var w=0;w<u[r].length;w++)A[r].push(Cesium.Cartographic.fromCartesian(u[r][w]))}let D=t-A.length;return D!==0&&console.log("\u8DEF\u5F84\u52A8\u753B\u70B9\u6570"+D),A}var hx=(e,t)=>{var n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch{}try{n+=o.split(".")[1].length}catch{}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)},uv=(e,t)=>{var n=0,r=0,o,a;try{n=e.toString().split(".")[1].length}catch{}try{r=t.toString().split(".")[1].length}catch{}return o=Number(e.toString().replace(".","")),a=Number(t.toString().replace(".","")),o/a*Math.pow(10,r-n)};function nee(e,t){var n,r,o;try{n=e.toString().split(".")[1].length}catch{n=0}try{r=t.toString().split(".")[1].length}catch{r=0}return o=Math.pow(10,Math.max(n,r)),(ree(e,o)+ree(t,o))/o}function ree(e,t){var n=0,r=e.toString(),o=t.toString();try{n+=r.split(".")[1].length}catch{}try{n+=o.split(".")[1].length}catch{}return Number(r.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,n)}function LRe(e,t){e=10,t=10;var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],o;if(t=t||n.length,e)for(o=0;o<e;o++)r[o]=n[0|Math.random()*t];else{var a;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(a=0|Math.random()*16,r[o]=n[o==19?a&3|8:a])}return parseInt(r.join(""))}var sL=aa;function RRe(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.groupName=e.groupName,this.layerName=e.layerName,this.type=1,this.name=e.name,this.id=e.id,this.libraryID=e.libraryID,this.code=e.code,this.show=Cesium.defaultValue(e.show,!0),this.isOnlyDrawMainLine=Cesium.defaultValue(e.isOnlyDrawMainLine,!1),this.floatHeight3D=Cesium.defaultValue(e.floatHeight3D,1.5),this.fillMode=Cesium.defaultValue(e.fillMode,1),this.mainLineColor=Cesium.defaultValue(e.mainLineColor,new K(1,0,0,1)),this.isExternalSetLine=Cesium.defaultValue(e.isExternalSetLine,!1),this.fillColor=Cesium.defaultValue(e.fillColor,new K(1,0,0,.392156)),this.isExternalSetFill=Cesium.defaultValue(e.isExternalSetFill,!0),this.distanceLegend=Cesium.defaultValue(e.distanceLegend,1e3),this.thickness3D=Cesium.defaultValue(e.thickness3D,.01),this.mainLineWidth=Cesium.defaultValue(e.mainLineWidth,.01),this.wallTransparent=Cesium.defaultValue(e.wallTransparent,.392156),this.surroundLineWidth=Cesium.defaultValue(e.surroundLineWidth,.001),this.surroundLineType=Cesium.defaultValue(e.surroundLineType,0),this.surroundLineColor=Cesium.defaultValue(e.surroundLineColor,new K(1,1,0,1)),this.topLineHeight=Cesium.defaultValue(e.topLineHeight,.01),this.positionCartographics=e.positionCartographics,this.mainLineIsTransparency=Cesium.defaultValue(e.mainLineIsTransparency,!1),this.mainLineIsDeepenColor=Cesium.defaultValue(e.mainLineIsDeepenColor,!0)}var dx=RRe;function iee(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this.groupName=e.groupName,this.layerName=e.layerName,this.type=0,this.name=e.name,this.id=e.id,this.libraryID=e.libraryID,this.code=e.code,this.show=Cesium.defaultValue(e.show,!0),this.floatHeight3D=Cesium.defaultValue(e.floatHeight3D,0),this._scale=Cesium.defaultValue(e.scale,.01),this._rotate=Cesium.defaultValue(e.rotate,0),this.drawMode=Cesium.defaultValue(e.drawMode,90),this.scaleMode=Cesium.defaultValue(e.scaleMode,1),this.mainLineWidth=Cesium.defaultValue(e.mainLineWidth,20),this.isExternalSetLine=Cesium.defaultValue(e.isExternalSetLine,!1),this.mainLineColor=Cesium.defaultValue(e.mainLineColor,new K(1,0,0,1)),this.mainLineHeight=Cesium.defaultValue(e.mainLineHeight,20),this.fillMode=Cesium.defaultValue(e.fillMode,1),this.isExternalSetFill=Cesium.defaultValue(e.isExternalSetFill,!1),this.fillColor=Cesium.defaultValue(e.fillColor,new K(1,0,0,.784313)),this.innertext=Cesium.defaultValue(e.innertext,""),this.innertextColor=Cesium.defaultValue(e.innertextColor,new K(0,0,0,1)),this.isExternalSetInnertext=Cesium.defaultValue(e.isExternalSetInnertext,!1),this.distanceLegend=Cesium.defaultValue(e.distanceLegend,1e5),this.positionCartographic=e.positionCartographic}Object.defineProperties(iee.prototype,{scale:{get:function(){return this._scale},set:function(e){if(this.scale!==e){if(e<=0)return;this._scale=e}}},rotate:{get:function(){return this._rotate},set:function(e){this.rotate!==e&&(e>360&&(e=e%360),e<-360&&(e=e%360),this._rotate=e)}}});var px=iee;function Fa(){this.layerGroupMap=new Cesium.AssociativeArray}Fa.prototype.parseFileData=function(e){let t={},n=e.SITSYMBOLFILE.LAYGROUPS,r;for(var o=0;o<n._Count;o++){r=n.LayerGroup[o]||n.LayerGroup;let mn=r._Name,Tn=this.createLayerGroup(mn),zi=Tn.name;for(var a=r.LAYERS,s,u=0;u<a._Count;u++){s=a.Layer[u]||a.Layer;let at=s._Name,Sn=this.createLayer(zi,at);for(var l=s.SYMBOLS,c,f=0;f<l._Count;f++){c=l.Symbol[f]||l.Symbol;var h,d,p,g,y=[];if(d=c.GeoAttr.POINTS._Count,p=c.GeoAttr.POINTS.Point,d<2){h=0;var v=Tn.name,w=Sn.name,C=parseInt(c._Guid),E=c._Name,S=c._Code,A=parseInt(S.split(",")[0]),D=parseInt(S.split(",")[1]),P=c._Visible==="TRUE",M=parseInt(c.StyleAttr._DisplayType),I=oee(M).drawMode,O=oee(M).scaleMode;g=Cesium.Cartographic.fromDegrees(parseFloat(p._X),parseFloat(p._Y),parseFloat(p._Z)),y.push(g);var m=c.GeoAttr.GeoAttribute._FloatHeight3D-0,b=c.GeoAttr.GeoAttribute._Scale-0,L=c.GeoAttr.GeoAttribute._Rotate-0,R=parseInt(c.StyleAttr.MainLine._Width),N=cv(c.StyleAttr.MainLine._Color),B=c.StyleAttr.MainLine._IsExternalSetLine==="TRUE",G=c.StyleAttr.Fill._Mode,F=cv(c.StyleAttr.Fill._Color),k=c.StyleAttr.Fill._IsExternalSetFill==="TRUE";if(c.InnerTextAttr)var Z=c.InnerTextAttr[0]||c.InnerTextAttr,te=Z.InnerText._Text,oe=cv(Z.InnerColor._Back),ue=cv(c.AnnoTextAttr.AnnoColor._Text),pe=!0;Cesium.defined(oe)&&Cesium.defined(F)&&(F=oe),t[C]={type:h,groupName:v,layerName:w,id:C,name:E,libraryID:A,code:D,show:P,drawMode:I,scaleMode:O,positionCartographics:y,floatHeight3D:m,scale:b,rotate:L,mainLineWidth:R,mainLineColor:N,isExternalSetLine:B,fillMode:G,fillColor:F,isExternalSetFill:k,innertext:te,innertextColor:ue,isExternalSetInnertext:pe}}else{h=1;for(var v=Tn.name,w=Sn.name,C=parseInt(c._Guid),E=c._Name,S=c._Code,A=parseInt(S.split(",")[0]),D=parseInt(S.split(",")[1]),P=c._Visible==="TRUE",o=0;o<d;o++)g=Cesium.Cartographic.fromDegrees(p[o]._X-0,p[o]._Y-0,p[o]._Z-0||0),y.push(g);var me=parseFloat(c.GeoAttr.GeoAttribute._WallTransparent/255),m=parseFloat(c.GeoAttr.GeoAttribute._FloatHeight3D),st=parseFloat(c.GeoAttr.GeoAttribute._Thickness3D),R=parseFloat(c.StyleAttr.MainLine._Width),N=cv(c.StyleAttr.MainLine._Color),B=c.StyleAttr.MainLine._IsExternalSetLine==="TRUE",ht=parseFloat(c.StyleAttr.SurroundLine._Width),jt=parseInt(c.StyleAttr.SurroundLine._Type),Ct=cv(c.StyleAttr.SurroundLine._Color),G=parseInt(c.StyleAttr.Fill._Mode),F=cv(c.StyleAttr.Fill._Color),bt=c.StyleAttr.Fill._IsExternalSetFill==="TRUE";t[C]={type:h,groupName:v,layerName:w,id:C,name:E,libraryID:A,code:D,show:P,positionCartographics:y,wallTransparent:me,floatHeight3D:m,thickness3D:st,mainLineWidth:R,mainLineColor:N,isExternalSetLine:B,surroundLineWidth:ht,surroundLineType:jt,surroundLineColor:Ct,fillMode:G,fillColor:F,isExternalSetFill:k,isExternalSetFill2:bt}}}}}return t};Fa.prototype.saveSymbolData=function(){let e=this.layerGroupMap,t=e.length,n={_Count:t,LayerGroup:[]},r=n;r._Count=t;for(let o=0;o<t;o++){let a=e.values[o],s=r.LayerGroup[r.LayerGroup.length]={};s._Name=a.name,s._Visible="TRUE",s._Describe="",s.LAYERS=[];let u=s.LAYERS[s.LAYERS.length]={};u.Layer=[];let l=a.layers,c=l.length;u._Count=c;for(let f=0;f<c;f++){let h=l.values[f],d=u.Layer[u.Layer.length]={};d._Name=h.name,d._Visible="TRUE",d._Describe="",d._IsLayerActive=o==0,d.SYMBOLS=[];let p=d.SYMBOLS[d.SYMBOLS.length]={};p._Count=h.symbols.length,ORe(this,p,h)}}return n};Fa.prototype.getLayerGroupMap=function(){return this.layerGroupMap};Fa.prototype.createLayerGroup=function(e,t){if(Cesium.defined(e)||console.error("EV_MilStdLayerManager methods 'createLayerGroup' parameter 'groupName' error!"),this.layerGroupMap.contains(e))return this.layerGroupMap.get(e);{let n={name:e,layers:new Cesium.AssociativeArray};return this.layerGroupMap.set(e,n),Cesium.defined(t)&&this.createLayer(e,t),n}};Fa.prototype.getLayerGroup=function(e){if(_(e)&&this.layerGroupMap&&this.layerGroupMap.contains(e))return this.layerGroupMap.get(e)};Fa.prototype.clearLayerGroup=function(e){let n=this.getLayerGroup(e).layers._array.concat([]);for(let r=0;r<n.length;r++){let o=n[r].name;this.removeLayer(e,o)}};Fa.prototype.removeLayerGroup=function(e){let n=this.getLayerGroup(e).layers._array.concat([]);for(let r=0;r<n.length;r++){let o=n[r].name;this.removeLayer(e,o)}this.layerGroupMap.remove(e)};Fa.prototype.changeLayerGroupName=function(e,t){let n=this.getLayerGroup(t);n.layers.values.forEach(function(o){Cesium.defined(o)&&o.symbols.values.forEach(function(a){a&&(a.groupName=e)})});let r=n.name;n.name=e,this.layerGroupMap.set(e,n),this.layerGroupMap.remove(r)};Fa.prototype.removeAllLayerGroup=function(){let e=Object.assign({},this.layerGroupMap.values),t=this.layerGroupMap.length;for(let n=0;n<t;n++){let r=e[n],o=r.name;r=void 0,this.removeLayerGroup(o)}};Fa.prototype.createLayer=function(e,t){if(Cesium.defined(t)){let n=this.getLayerGroup(e);if(Cesium.defined(n)){if(n.layers.contains(t))return this.getLayer(e,t);{let r={name:t,symbols:new Cesium.AssociativeArray};return n.layers.set(t,r),r}}else{console.error("EV_MilStdLayerManager methods 'createLayer' error, undefined this layerGroup");return}}else{console.error("EV_MilStdLayerManager methods 'createLayer' parameter 'layerName' error!");return}};Fa.prototype.getLayer=function(e,t){let n=this.getLayerGroup(e);if(Cesium.defined(n)&&_(t)&&n.layers.contains(t))return n.layers.get(t)};Fa.prototype.clearLayer=function(e,t){let r=this.getLayer(e,t).symbols._array.concat([]);for(let o=0;o<r.length;o++){let s=r[o].id;this.removeSymbol(e,t,s)}};Fa.prototype.removeLayer=function(e,t){let r=this.getLayer(e,t).symbols._array.concat([]);for(let a=0;a<r.length;a++){let u=r[a].id;this.removeSymbol(e,t,u)}this.getLayerGroup(e).layers.remove(t)};Fa.prototype.symbolChangeLayer=function(e,t,n){let r=this.getSymbolById(n),o=r.groupName,a=r.layerName;this.getLayer(o,a).symbols.remove(n),this.getLayer(e,t).symbols.set(n,r)};Fa.prototype.changeLayerName=function(e,t,n){let r=this.getLayer(t,n);r.symbols.values.forEach(function(a){Cesium.defined(a)&&(a.layerName=e)});let o=r.name;r.name=e,this.layerGroupMap.get(t).layers.set(e,r),this.layerGroupMap.get(t).layers.remove(o)};Fa.prototype.createSymbol=function(e){if(_(e.id)&&_(e.type)){let n=this.getLayer(e.groupName,e.layerName);if(_(n)){var t=void 0;return e.type===0?(e.positionCartographic=e.positionCartographics[0].clone(),t=new px(e)):e.type===1&&(t=new dx(e)),n.symbols.set(e.id,t),t}}};Fa.prototype.getSymbolById=function(e){let t=this.layerGroupMap.values;if(_(t))for(let n=0;n<t.length;n++){let r=t[n].layers.values;if(_(r))for(let o=0;o<r.length;o++){let a=r[o];if(_(a.symbols)&&a.symbols.contains(e))return a.symbols.get(e)}}};Fa.prototype.getSymbol=function(e,t,n){let r=this.getLayer(e,t);if(_(r)&&r.symbols.contains(n))return r.symbols.get(n)};Fa.prototype.removeSymbol=function(e,t,n){this.getLayer(e,t).symbols.remove(n)};Fa.prototype.changeSymbolName=function(e,t,n,r){let o=this.getSymbol(t,n,r);o&&(o.name=e)};Fa.prototype.getAllSymbols=function(){let e=[],t=this.layerGroupMap.values;for(let n=0;n<t.length;n++){let r=t[n].layers.values;for(let o=0;o<r.length;o++){let a=r[o];if(a.symbols){let s=a.symbols.values;for(let u=0;u<s.length;u++)e.push(s[u])}}}return e};function ORe(e,t,n){t.Symbol=[],n.symbols.values.forEach(r=>{var o=t.Symbol[t.Symbol.length]={};if(r.type===0){o._Guid=r.id,o._CanSelected="TRUE",o._Name=r.name,o._Code=r.libraryID+","+r.code,o._Visible=r.show===!0?"TRUE":"FALSE";var a=r.positionCartographic;o.GeoAttr={POINTS:{_Count:1,Point:[{_X:a.longitude*180/Math.PI,_Y:a.latitude*180/Math.PI,_Z:a.height}]},GeoAttribute:{_WallTransparent:"100",_FloatHeight3D:r.floatHeight3D,_Scale:r.scale,_HeightType:"0",_Rotate:r.rotate,_Thickness3D:"20"}};var s=r.drawMode+"/"+r.scaleMode;o.StyleAttr={_LineType:"1",_DisplayType:NRe(s),MainLine:{_IsExternalSetLine:r.isExternalSetLine===!0?"TRUE":"FALSE",_Color:lv(r.mainLineColor),_Width:r.mainLineWidth},SurroundLine:{_Type:"3",_Color:"4294902015",_Width:"20.000000"},Fill:{_IsExternalSetFill:r.isExternalSetFill===!0?"TRUE":"FALSE",_Mode:r.fillMode,_Color:lv(r.fillColor)},Mirroring:{_Horizontal:"FALSE",_Vertical:"FALSE"}},o.AnnoTextAttr={_Text:"",_Visible:"TRUE",AnnoFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_Width:"20",_Height:"100"},AnnoFontEffect:{_Italic:"FALSE",_Bold:"FALSE"},AnnoColor:{_Back:"0",_Text:lv(r.innertextColor)},AnnoPosType:{_PosType:"1"},AnnoTextRotate:{_IsRorate:"1"}},o.InnerTextAttr={InnerText:{_Text:r.innertext,Index:"0"},InnerFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_InnerFontSize:"-1.000000",_Index:"0"},InnerColor:{_Back:lv(r.fillColor),_Text:"255",_Index:"0"}},o.DotDragLine={_DragLineVisble:"FALSE",DotDragLinePoint:{_X:"96.337753",_Y:"34.408583",_Z:"4623.950492"}},o.RangAttr={ShowRang:{_Min:"-1.000000",_Max:"-1.000000"},HalfPixelRang:{_Min:"20000000.000000",_Max:"20000000.000000"}}}if(r.type===1){o._Guid=r.id,o._CanSelected="TRUE",o._Name=r.name,o._Code=r.libraryID+","+r.code,o.OperType="EDIT",o._Visible=r.show!==!1?"TRUE":"FALSE",o._IsSetGenAttr="FALSE",o._DisplayType="STAND_NOPIXEL",o.GeoAttr={POINTS:{_Count:r.positionCartographics.length,Point:[]},GeoAttribute:{_WallTransparent:parseInt(r.wallTransparent*255),_FloatHeight3D:r.floatHeight3D,_Scale:"1.000000",_HeightType:"0",_Rotate:"0.000000",_ISVisibleDragLine:"FALSE",_Thickness3D:r.thickness3D},GeoScaleValues:{GeoScaleValue:{_Value:"0.100000",_Index:"0"}}};for(var u=0,l=r.positionCartographics.length;u<l;u++){let c=r.positionCartographics[u];o.GeoAttr.POINTS.Point[u]={_X:c.longitude*180/Math.PI,_Y:c.latitude*180/Math.PI,_Z:c.height}}o.StyleAttr={_DisplayType:"3",_LineType:"1",MainLine:{_Width:r.mainLineWidth,_Color:lv(r.mainLineColor),_IsExternalSetLine:r.isExternalSetLine===!0?"TRUE":"FALSE"},SurroundLine:{_Width:r.surroundLineWidth,_Type:r.surroundLineType,_Color:lv(r.surroundLineColor)},Fill:{_Mode:r.fillMode,_Color:lv(r.fillColor),_IsExternalSetFill:r.isExternalSetFill===!0?"TRUE":"FALSE"},Mirroring:{_Horizontal:"FALSE",_Vertical:"FALSE"}},o.AnnoTextAttr={_Text:"",_Visible:"TRUE",AnnoFont:{_Family:"\u5FAE\u8F6F\u96C5\u9ED1",_Width:"20",_Height:"200"},AnnoFontEffect:{_Italic:"FALSE",_Bold:"FALSE"},AnnoColor:{_Back:"0",_Text:"255"},AnnoPosType:{_PosType:"1"}},o.AvoidPoints={_Count:"0"},o.RangAttr={ShowRang:{_Min:"-1.000000",_Max:"-1.000000"},HalfPixelRang:{_Min:"20000000.000000",_Max:"20000000.000000"}}}})}function oee(e){let t={1:{drawMode:360,scaleMode:1},2:{drawMode:360,scaleMode:0},3:{drawMode:90,scaleMode:1},4:{drawMode:90,scaleMode:0},5:{drawMode:0,scaleMode:1},6:{drawMode:0,scaleMode:0},7:{drawMode:360,scaleMode:1}};if(t[e])return t[e];console.error("EV_MilStdLayerManager function 'parseDisplayType' error!")}function NRe(e){let t;if(t={"360/1":"1","360/0":"2","90/1":"3","90/0":"4","0/1":"5","0/0":"6"}[e],t)return t;console.error("EV_MilStdLayerManager function 'getDisplayType' error!")}function lv(e){if(!!e){var t=parseInt((e.alpha||1)*255),n=parseInt(e.red*255),r=parseInt(e.green*255),o=parseInt(e.blue*255),a=n<<24|r<<16|o<<8|t;return a>>>0}}function cv(e){if(!!e){var t=[];return t[0]=(e&4278190080)>>>24,t[1]=(e&16711680)>>>16,t[2]=(e&65280)>>>8,t[3]=e&255>>>0,new K(t[0]/255,t[1]/255,t[2]/255,t[3]/255)}}var uL=Fa;function tt(e){Cesium.defined(e.viewer)&&(this.isDraw3D=!0),Cesium.defined(e.olMap)&&(this.isDraw2D=!0),Cesium.defined(e.url)||console.error("'EV_MilStdDrawHelper' parameter 'options.url' error !"),(this.isDraw3D||this.isDraw2D)&&(this.updatePlottingService(e.url),this._milStdLayerManager=new uL,this.isDraw3D&&(this.viewer=e.viewer,this.isDraw3D=!0,this._milStd3DRanderManager=new oL({viewer:this.viewer,plottingService:this.evPlottingService}),BRe(this),this._milStdDeduceManager=new sL(this)),this.isDraw2D&&(this.olMap=e.olMap,this.isDraw2D=!0,this._milStd2DRanderManager=new XM({olMap:this.olMap,plottingService:this.evPlottingService})),this._editingSymbolId=void 0,this.vertexDataObjs={},this.sameVertexInfoObjs={},this.symbolMultipleChoice=!1,this._copyVertexDataState=!1,this._defaultAttriConfig={defaultMarkSymbol:new px,defaultLineSymbol:new dx},this._defaultAttriArray=new Cesium.AssociativeArray)}Object.defineProperties(tt.prototype,{milStdLayerManager:{get:function(){return this._milStdLayerManager}},milStdDeduceManager:{get:function(){return this._milStdDeduceManager}},milStd3DRanderManager:{get:function(){return this._milStd3DRanderManager}},activeGroupName:{get:function(){return this._milStdLayerManager.activeGroupName},set:function(e){}},activeLayerName:{get:function(){return this._milStdLayerManager.activeLayerName},set:function(e){}},editingSymbolId:{get:function(){return this._editingSymbolId},set:function(e){this._editingSymbolId=e}}});tt.prototype.removeSymbol=function(e,t,n){var r=this._milStdLayerManager.getSymbol(e,t,n);r&&(this._milStdLayerManager.removeSymbol(e,t,n),this.isDraw3D&&this._milStd3DRanderManager.removeSymbol(n),this.isDraw2D&&this._milStd2DRanderManager.removeSymbol(n))};tt.prototype.clearLayer=function(e,t){var n=this._milStdLayerManager.getLayer(e,t);if(_(n)){var r=n.symbols.values;if(_(r)&&r.length>0){var o=r.concat([]),a=this;o.forEach(function(s){if(_(s)&&_(s.id)){var u=s.id;a.removeSymbol(e,t,u)}})}}};tt.prototype.removeLayer=function(e,t){this.clearLayer(e,t);var n=this.milStdLayerManager.getLayerGroup(e);_(n)&&n.layers.contains(t)&&n.layers.remove(t)};tt.prototype.clearLayerGroup=function(e){var t=this._milStdLayerManager.getLayerGroup(e);if(_(t)){var n=t.layers.values;if(n.length>0){var r=this;n.forEach(function(o){r.clearLayer(e,o.name)})}}};tt.prototype.removeLayerGroup=function(e){var t=this._milStdLayerManager.getLayerGroup(e);if(_(t)){var n=t.layers.values,r=n.concat([]);if(n.length>0){var o=this;r.forEach(function(s){o.removeLayer(e,s.name)})}}var a=this._milStdLayerManager.getLayerGroupMap();a.remove(e)};tt.prototype.removeAllLayerGroup=function(){this._milStdLayerManager.removeAllLayerGroup(),this._milStd3DRanderManager&&this._milStd3DRanderManager.removeAllSymbol()};tt.prototype.setEditingSymbol=function(e){this.editingSymbolId=e,this._milStd3DRanderManager&&this._milStd3DRanderManager.setEditingSymbol(e)};tt.prototype.startDrawSymbol=function(e,t){var n=e.type,r=this,o,a=0,s=!1;this._milStd3DRanderManager&&this._milStd3DRanderManager.getDrawPositions(n,function(u){switch(n){case 0:{e.positionCartographics=u,r.drawByPositions(e,t);break}case 1:{if(o&&a!==u.length&&(r.setEditingSymbol(void 0),r.setEditingSymbol(o.symbol.id)),u.length>1){var l=zRe(u);l>700&&(s||(o?r.setLineSymbolPositionCartographics(o.symbol.id,u):(s=!0,e.positionCartographics=u,r.drawByPositions(e,function(c){o=c,s=!1,t(c)}))))}break}default:break}})};tt.prototype.changeDefaultAttri=function(e,t,n){if(_(e)&&_(t)&&_(n)){var r=t+"_"+e;this._defaultAttriArray.contains(r),this._defaultAttriArray.set(r,{type:e,key:t,value:n})}};tt.prototype.drawByPositions=function(e,t){if(!_(e.groupName)||!_(e.layerName)){console.error("no groupName and layerName");return}var n;_(e.id)?n=e.id:(n=FRe(),e.id=n);var r=this._milStdLayerManager.getSymbolById(n);if(!r){var o=this._defaultAttriArray.values;o.forEach(function(c){var f=c.type,h=c.key,d=c.value;f===e.type&&(e[h]=d)});var r=this.milStdLayerManager.createSymbol(e),a=this;if(this.isDraw3D){let f=function(h,d){console.log("need change someone value")};this._milStd3DRanderManager.drawByPositions(r,f,function(h){var d=a._milStd3DRanderManager.getSymbol(h);d._isUpdatePrimitive=!0,a.viewer.scene.postRender.addEventListener(p);function p(){a.viewer.scene.postRender.removeEventListener(p),a.setEditingSymbol(d.symbol.id),t(d)}});var a=this}if(this.isDraw2D)if(r.type===0){var s=r.positionCartographic.longitude*180/Math.PI,u=r.positionCartographic.latitude*180/Math.PI;r.positionDegrees=[s,u],a._milStd2DRanderManager.drawByPositions(r,function(c){var f=a._milStd2DRanderManager.getSymbol(c);a._milStd2DRanderManager.vectorLayer.on("postrender",h);function h(){a._milStd2DRanderManager.vectorLayer.un("postrender",h),t(f)}})}else r.positionDegrees=[],r.positionCartographics.forEach(c=>{let f=parseFloat((c.longitude*180/Math.PI).toFixed(2)),h=parseFloat((c.latitude*180/Math.PI).toFixed(2));r.positionDegrees.push([f,h])}),a._milStd2DRanderManager.drawByPositions(r,function(c){var f=a._milStd2DRanderManager.getSymbol(c);a._milStd2DRanderManager.vectorLayer.on("postrender",h);function h(){a._milStd2DRanderManager.vectorLayer.un("postrender",h),t(f)}})}};tt.prototype.drawByVertexData=function(e,t){this._milStd3DRanderManager&&this._milStd3DRanderManager.drawByVertexData(e,t)};tt.prototype.drawByFile=function(e,t,n,r){this._isDrawFile=!0,this.vertexDataObjs={},this.sameVertexInfoObjs={};for(var o=this._milStdLayerManager.parseFileData(e),a=Object.keys(o),s=this,u=[],l=0;l<a.length;l++){var c=o[a[l]];c.type===0?this.drawByPositions({groupName:c.groupName,layerName:c.layerName,libraryID:c.libraryID,code:c.code,type:c.type,name:c.name,positionCartographics:c.positionCartographics,id:c.id,show:c.show,drawMode:c.drawMode,scaleMode:c.scaleMode,floatHeight3D:c.floatHeight3D,scale:c.scale,rotate:c.rotate,mainLineWidth:c.mainLineWidth,mainLineColor:c.mainLineColor,isExternalSetLine:c.isExternalSetLine,fillMode:c.fillMode,fillColor:c.fillColor,isExternalSetFill:c.isExternalSetFill,innertext:c.innertext,innertextColor:c.innertextColor,isExternalSetInnertext:c.isExternalSetInnertext},f):c.type===1&&this.drawByPositions({groupName:c.groupName,layerName:c.layerName,libraryID:c.libraryID,code:c.code,type:c.type,name:c.name,positionCartographics:c.positionCartographics,id:c.id,show:c.show,wallTransparent:c.wallTransparent,floatHeight3D:c.floatHeight3D,thickness3D:c.thickness3D,mainLineWidth:c.mainLineWidth,mainLineColor:c.mainLineColor,isExternalSetLine:c.isExternalSetLine,surroundLineWidth:c.surroundLineWidth,surroundLineType:c.surroundLineType,surroundLineColor:c.surroundLineColor,fillMode:c.fillMode,fillColor:c.fillColor,isExternalSetFill:c.isExternalSetFill},f)}function f(h){if(n(h.symbol.id),u.push(h.symbol.id),u.length===a.length){s._isDrawFile=!1;var d=t.split(".")[0],p=s._milStdDeduceManager.createDeducePlanByFile(d,e);r(u,p)}}};tt.prototype.saveSMLFile=function(){var e={SITSYMBOLFILE:{LAYGROUPS:{},ACTIONGROUPS:{}}},t=this._milStdLayerManager.saveSymbolData();t&&(e.SITSYMBOLFILE.LAYGROUPS=t);var n=this._milStdDeduceManager.saveDeduceData();return n&&(e.SITSYMBOLFILE.ACTIONGROUPS=n),e};tt.prototype.setSymbolVisible=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.show=t)};tt.prototype.getSymbolVisible=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.show:!1};tt.prototype.setMarkSymbolPositionCartographic=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);if(n&&(this.isDraw3D&&(n.positionCartographic=t,this._milStd3DRanderManager.setMarkSymbolPositionCartographic(e,t)),this.isDraw2D)){var r=t.longitude*180/Math.PI,o=t.latitude*180/Math.PI,a=[r,o];this._milStd2DRanderManager.setMarkSymbolPositionCartographic(e,a)}};tt.prototype.getMarkSymbolPositionCartographic=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.positionCartographic};tt.prototype.setMarkSymbolMainLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);if(n&&(this.isDraw3D||this.isDraw2D)&&(n.mainLineColor=t,n.isExternalSetLine=!0,this.isDraw3D&&this._milStd3DRanderManager.setMarkSymbolMainLineColor(e,t),this.isDraw2D)){let r=t.toBytes(),o="rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")";this._milStd2DRanderManager.setMarkSymbolMainLineColor(e,o)}};tt.prototype.getMarkSymbolMainLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.mainLineColor};tt.prototype.setMarkSymbolFillColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillColor=t,n.isExternalSetFill=!0,this._milStd3DRanderManager.setMarkSymbolFillColor(e,t))};tt.prototype.getMarkSymbolFillColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.fillColor};tt.prototype.setMarkSymbolFloatHeight3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.floatHeight3D=t,this._milStd3DRanderManager.updateMarkSymbolFloatHeight3D(e))};tt.prototype.getMarkSymbolFloatHeight3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.floatHeight3D:0};tt.prototype.setMarkSymbolRotate=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&((this.isDraw3D||this.isDraw2D)&&(n.rotate=t),this.isDraw3D&&this._milStd3DRanderManager.updateMarkSymbolRotate(e),this.isDraw2D&&this._milStd2DRanderManager.updateMarkSymbolRotate(e,t))};tt.prototype.getMarkSymbolRotate=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.rotate:0};tt.prototype.setMarkSymbolScale=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&((this.isDraw3D||this.isDraw2D)&&(n.scale=t),this.isDraw3D&&this._milStd3DRanderManager.updateMarkSymbolScale(e),this.isDraw2D&&this._milStd2DRanderManager.updateMarkSymbolScale(e,t))};tt.prototype.getMarkSymbolScale=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.scale:1};tt.prototype.setMarkSymbolDrawMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.drawMode=t,this._milStd3DRanderManager.updateMarkSymbolDrawMode(e))};tt.prototype.getMarkSymbolDrawMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.drawMode:90};tt.prototype.setMarkSymbolScaleMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.scaleMode=t,this._milStd3DRanderManager.setMarkSymbolScaleMode(e,t))};tt.prototype.getMarkSymbolScaleMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.scaleMode:0};tt.prototype.setMarkSymbolInnerText=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.innertext=t,this._milStd3DRanderManager.setMarkSymbolInnerText(e,t))};tt.prototype.getMarkSymbolInnerText=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.innertext:""};tt.prototype.setInnerTextColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.innertextColor=t,this._milStd3DRanderManager.setInnerTextColor(e,t))};tt.prototype.getInnerTextColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.innertextColor};tt.prototype.setLineSymbolPositionCartographics=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.positionCartographics=t,this._milStd3DRanderManager.setLineSymbolPositionCartographics(e,t))};tt.prototype.getLineSymbolPositionCartographics=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.positionCartographics:[]};tt.prototype.setLineSymbolMainLineWidth=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.mainLineWidth=t,this._milStd3DRanderManager.updateLineSymbolMainLineWidth(e))};tt.prototype.getLineSymbolMainLineWidth=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.mainLineWidth:0};tt.prototype.setLineSymbolMainLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.mainLineColor=t,n.isExternalSetLine=!0,this._milStd3DRanderManager.setLineSymbolMainLineColor(e,t))};tt.prototype.getLineSymbolMainLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.mainLineColor};tt.prototype.setLineSymbolFillColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillColor=t,n.isExternalSetFill=!0,this._milStd3DRanderManager.setLineSymbolFillColor(e,t))};tt.prototype.getLineSymbolFillColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.fillColor};tt.prototype.setLineSymbolSurroundLineType=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineType=t,this._milStd3DRanderManager.updateLineSymbolSurroundLineType(e))};tt.prototype.getLineSymbolSurroundLineType=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.surroundLineType:0};tt.prototype.setLineSymbolSurroundLineColor=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineColor=t,this._milStd3DRanderManager.setLineSymbolSurroundLineColor(e,t))};tt.prototype.getLineSymbolSurroundLineColor=function(e){var t=this.milStdLayerManager.getSymbolById(e);if(t)return t.surroundLineColor};tt.prototype.setLineSymbolSurroundLineWidth=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.surroundLineWidth=t,this._milStd3DRanderManager.updateLineSymbolSurroundLineWidth(e))};tt.prototype.getLineSymbolSurroundLineWidth=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.surroundLineWidth:0};tt.prototype.setLineSymbolFillMode=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.fillMode=t,this._milStd3DRanderManager.updateLineSymbolFillMode(e))};tt.prototype.getLineSymbolFillMode=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.fillMode:0};tt.prototype.setLineSymbolFloatHeight3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.floatHeight3D=t,this._milStd3DRanderManager.updateLineSymbolFloatHeight3D(e))};tt.prototype.getLineSymbolFloatHeight3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.floatHeight3D:0};tt.prototype.setLineSymbolThickness3D=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.thickness3D=t,this._milStd3DRanderManager.updateLineSymbolThickness3D(e))};tt.prototype.getLineSymbolThickness3D=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.thickness3D:1};tt.prototype.setLineSymbolWallTransparent=function(e,t){var n=this.milStdLayerManager.getSymbolById(e);n&&(n.wallTransparent=t,this._milStd3DRanderManager.updateLineSymbolWallTransparent(e))};tt.prototype.getLineSymbolWallTransparent=function(e){var t=this.milStdLayerManager.getSymbolById(e);return t?t.wallTransparent:.5};tt.prototype.registerDraggingAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._draggingAnchor)?this._milStd3DRanderManager._draggingAnchor.addEventListener(e):void 0};tt.prototype.removeDraggingAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._draggingAnchor)?this._milStd3DRanderManager._draggingAnchor.removeEventListener(e):void 0};tt.prototype.registerEndDragAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._endDragAnchor)?this._milStd3DRanderManager._endDragAnchor.addEventListener(e):void 0};tt.prototype.removeEndDragAnchorListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._endDragAnchor)?this._milStd3DRanderManager._endDragAnchor.removeEventListener(e):void 0};tt.prototype.registerMouseLeftDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._leftDown)?this._milStd3DRanderManager._leftDown.addEventListener(e):void 0};tt.prototype.removeMouseLeftDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._leftDown)?this._milStd3DRanderManager._leftDown.removeEventListener(e):void 0};tt.prototype.registerMouseRightDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._rightDown)?this._milStd3DRanderManager._rightDown.addEventListener(e):void 0};tt.prototype.removeMouseRightDownListener=function(e){return Cesium.defined(this._milStd3DRanderManager)&&Cesium.defined(this._milStd3DRanderManager._rightDown)?this._milStd3DRanderManager._rightDown.removeEventListener(e):void 0};tt.prototype.turnOnUseSameVertexDrawing=function(){this._milStd3DRanderManager.turnOnUseSameVertexDrawing()};tt.prototype.initUseSameVertexDrawing=function(){this._milStd3DRanderManager.initUseSameVertexDrawing()};tt.prototype.turnOffUseSameVertexDrawing=function(){this._milStd3DRanderManager.turnOffUseSamevertexDrawing()};tt.prototype.updatePlottingService=function(e){localStorage.getItem("plottingServiceIp")&&localStorage.getItem("plottingServicePort")?this.plottingServiceUrl="http://"+localStorage.getItem("plottingServiceIp")+":"+localStorage.getItem("plottingServicePort"):this.plottingServiceUrl=e,this.evPlottingService?this.evPlottingService._url=this.plottingServiceUrl+"/earthview/services / v / soap / plottingservice / 10000":this.evPlottingService=new WM(this.plottingServiceUrl+"/earthview/services/v/soap/plottingservice/10000",{viewer:this.viewer}),Cesium.defined(this.evPlottingService)||console.error("EV_MilStdDrawHelper need statement 'evPlottingService'")};tt.prototype.drawLine=function(e,t,n){this.drawByPositions(e,r=>{var o,a;r.libID===32&&r.code==40502,o=vz(e.vertexData),a=vz(o);for(var s=1;s<n;){var u=Math.floor(s/t),l=s%t,c=[];a.MainData[0].MainVertex.forEach(function(h,d){d%2===1&&c.push(h+l*.3),d%2===0&&c.push(h+u*.3)}),o.MainData[0].MainVertex=c;var f=[];f[0]=Cesium.Cartesian3.fromDegrees(122-.025+u*.3,31.5+l*.3,200),f[1]=Cesium.Cartesian3.fromDegrees(122+.2-.025+u*.3,31.5+l*.3,200),drawLineByVertexData(this,{viewer:this.viewer,evPlottingService:this.evPlottingService,groupName:e.groupName,layerName:e.layerName,vertexData:o,libID:e.libID,code:e.code,name:"newLine"+s,id:"newLine"+s,cartesian3Array:f},function(h){h.processVertexData()}),s++}})};function BRe(e){var t=function(o,a){e.setEditingSymbol(o)};e.milStd3DRanderManager._leftDown.addEventListener(t);var n=function(o,a,s){if(_(s))e.setLineSymbolPositionCartographics(o,a);else{var u=a;e.setMarkSymbolPositionCartographic(o,u)}};e._milStd3DRanderManager._draggingAnchor.addEventListener(n);var r=function(o,a,s){if(_(s))e.setLineSymbolPositionCartographics(o,a);else{var u=a;e.setMarkSymbolPositionCartographic(o,u)}};e._milStd3DRanderManager._endDragAnchor.addEventListener(r)}function vz(e){if(!(e instanceof Object))return e;var t=e.constructor===Array?[]:{};for(var n in e)t[n]=vz(e[n]);return t}function FRe(e,t){e=10,t=10;var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],o;if(t=t||n.length,e)for(o=0;o<e;o++)r[o]=n[0|Math.random()*t];else{var a;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(a=0|Math.random()*16,r[o]=n[o==19?a&3|8:a])}return parseInt(r.join(""))}function zRe(e){var t=new Cesium.EllipsoidGeodesic;t.setEndPoints(e[e.length-2],e[e.length-1]);var n=t.surfaceDistance;return n}var aee=tt;var Cz=class{constructor(t,n){this.viewer=t,this.ev_DrawHelper=n,this.anchorHandler=new ov(this.viewer.scene,2),this.boxs={},this.radians,this.boxRadians,this.boxCenterRadian,this.boxAnchor,this.symbolAnchors,this.symbolAnchorsId={}}start(t){let n=this.viewer,r=0,o,a,s;this.getMouseEventPositions(t,(u,l)=>{if(r++,console.log(u),r===2){o=_i(),a=[];let c=[];s=this.createBoxEntity(o,t,u,a,c)}if(u.length===t&&l==="mouseLeftUp"){let h=function(y,v){var w=n.scene.pick(v),C;if(w){C=w.primitive;let E=[],S=[];for(let A in p.boxs)if(Object.hasOwnProperty.call(p.boxs,A)){let D=p.boxs[A];E.push(A),S.push(D.boxEntityAnchorId)}S.includes(C.id)?C[y](w.primitive,v):E.includes(C.id)}else f.destroy(),p.removeBox(Object.keys(p.boxs)[0])},g=function(y,v){let w=p.symbolAnchorsId[y][0],C=p.ev_DrawHelper.milStd3DRanderManager.getSymbol(w);if(C.symbol.type===0)p.ev_DrawHelper.setMarkSymbolPositionCartographic(w,v);else if(C.symbol.type===1){let E=p.symbolAnchorsId[y][1],S=C.symbol.positionCartographics;S[E]=v,p.ev_DrawHelper.setLineSymbolPositionCartographics(w,S)}},c=new xz({viewer:n,id:o,pointNum:t,mouseEventRadians:u,boxRadians:a,boxEntity:s});this.boxs[o]=c,c.startEditBoxEntity();let f=new Cesium.ScreenSpaceEventHandler(n.scene.canvas);f.setInputAction(function(y){h("leftDown",y.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN),f.setInputAction(function(y){h("rightDown",y.position)},Cesium.ScreenSpaceEventType.RIGHT_DOWN),c.createCillingvolume(),c.setChangeSymbolPositionFunc(g),this.ev_DrawHelper.milStdLayerManager.getAllSymbols().forEach(y=>{let v=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(y.id),w=v._primitive._boundingSpheres[0],C=v._framePrimitive._boundingSpheres[0],E=w||C;if(c.checkBoundingsphere(E))if(y.type===0){let A=Cesium.createGuid(),D=v.symbol.positionCartographic;c.addSymbolAnchors(A,D),this.symbolAnchorsId[A]=[y.id,0]}else y.type===1&&v.symbol.positionCartographics.forEach((D,P)=>{let M=Cesium.createGuid();c.addSymbolAnchors(M,D),this.symbolAnchorsId[M]=[y.id,P]})});let p=this}})}removeAllBox(){for(let t in this.boxs){let n=this.boxs[t];n.isDestroyed()||(n.removeAnchor(n.boxEntityAnchorId),n.remoSymbolAnchors(),n.destroy()),delete this.boxs[t]}}removeBox(t){let n=this.boxs[t];n.isDestroyed()||(n.removeAnchor(n.boxEntityAnchorId),n.remoSymbolAnchors(),n.destroy()),delete this.boxs[t]}createBoxEntity(t,n,r,o,a){return this.viewer.entities.add({id:t,polygon:{hierarchy:new Cesium.CallbackProperty(()=>(n===2?(o[0]=new Cesium.Cartographic(r[0].longitude,r[0].latitude,r[0].height),o[2]=new Cesium.Cartographic(r[1].longitude,r[1].latitude,r[1].height),o[1]=new Cesium.Cartographic(r[0].longitude,r[1].latitude,(r[0].height+r[1].height)/2),o[3]=new Cesium.Cartographic(r[1].longitude,r[0].latitude,(r[0].height+r[1].height)/2)):r.forEach(u=>{o.push(u)}),o.forEach((u,l)=>{a[l*3]=u.longitude,a[l*3+1]=u.latitude,a[l*3+2]=u.height}),{positions:Cesium.Cartesian3.fromRadiansArrayHeights(a)}),!1),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,material:new Cesium.Color(1,0,0,.4)}})}changeSymbolAndAnchorsPosition(t){this.selectedSymbolIds.forEach(n=>{let r=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(n.id),o=this.symbolAnchors[r.id],a=r.symbol.positionCartographic;a.longitude=a.longitude+t.longitude,a.latitude=a.longitude+t.latitude,this.ev_DrawHelper.setMarkSymbolPositionCartographic(symbolId,a),this.changeAnchorPosition(o.id,a)})}drawSymbolAnchors(){this.selectedSymbolIds.forEach(t=>{let n=this.ev_DrawHelper.milStd3DRanderManager.getSymbol(t.id),r=n.symbol.positionCartographic,o=this.drawAnchor(void 0,r,void 0);this.symbolAnchors.push(n.id,o)})}endEditBox(){this.removeAnchor(this.boxAnchor.id),this.remoSymbolAnchors()}getMouseEventPositions(t,n){if(typeof t=="number"){let s=function(h){let d=f(h);c(t,d,n)},u=function(h){let d=f(h);c(t,d,n)},l=function(h){let d=f(h);o[o.length-1]=d,n&&n(o,"mouseMove")},c=function(h,d,p){if(h===1)o.push(d),p&&p(o,"mouseLeftUp"),a.isDestroy||a.destroy();else{let g=o.length;g===0?(o.push(d),o.push(void 0),a.setInputAction(l,Cesium.ScreenSpaceEventType.MOUSE_MOVE)):g===h?(o[o.length-1]=d,a.isDestroy||a.destroy(),p&&p(o,"mouseLeftUp")):(o.push(position),p&&p(o,"mouseLeftUp"))}},f=function(h){if(typeof h!=null&&h!=null){let d,p;if(h.position?d=h.position:h.startPosition&&h.endPosition?d=h.endPosition:console.error("plaece check more mouse type"),r.scene.mode!==2){let g=r.camera.getPickRay(d),y=r.scene.globe.pick(g,r.scene);p=Cesium.Cartographic.fromCartesian(y)}else{let g=r.scene.camera.pickEllipsoid(d);p=Cesium.Cartographic.fromCartesian(g)}return p}},r=this.viewer,o=[],a=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);a.setInputAction(s,Cesium.ScreenSpaceEventType.LEFT_UP)}else console.error("'getMouseEventPositions' methods paremeter must be number")}isDestroyed(){return!1}destroy(){delete this.id,this.radiansCoordinates=void 0,delete this.radiansCoordinates,this.selectedSymbolIds=void 0,delete this.selectedSymbolIds,this.mouseEventHandler.destroy(),delete this.mouseEventHandler}},xz=class{constructor(t){Cesium.defined(t)&&(this.viewer=t.viewer,this.id=t.id||_i(),this.pointNum=t.pointNum,this.mouseEventRadians=t.mouseEventRadians,this.boxRadians=t.boxRadians,this.boxEntity=t.boxEntity,this.anchorHandler=new ov(this.viewer.scene,1.5),this.boxEntityAnchor,this.boxEntityAnchorId,this.symbolAnchors={},this.cillingvolume)}checkBoundingsphere(t){if(Cesium.defined(t)&&this.cillingvolume.computeVisibility(t)!==-1)return!0}createCillingvolume(){let t=this.mouseEventRadians,n=[];n[0]=new Cesium.Cartographic(t[0].longitude,t[0].latitude,-1e5),n[2]=new Cesium.Cartographic(t[1].longitude,t[1].latitude,-1e5),n[1]=new Cesium.Cartographic(t[0].longitude,t[1].latitude,-1e5),n[3]=new Cesium.Cartographic(t[1].longitude,t[0].latitude,-1e5),n[4]=new Cesium.Cartographic(t[0].longitude,t[0].latitude,1e5),n[6]=new Cesium.Cartographic(t[1].longitude,t[1].latitude,1e5),n[5]=new Cesium.Cartographic(t[0].longitude,t[1].latitude,1e5),n[7]=new Cesium.Cartographic(t[1].longitude,t[0].latitude,1e5);let r=[];n.forEach((M,I)=>{r[I*3]=M.longitude,r[I*3+1]=M.latitude,r[I*3+2]=M.height});let o=Cesium.Cartesian3.fromRadiansArrayHeights(r);console.log(n);let a=Cesium.Cartesian3.subtract(o[1],o[0]),s=Cesium.Cartesian3.subtract(o[3],o[0]),u=Cesium.Cartesian3.subtract(o[4],o[0]),l=Cesium.Cartesian3.subtract(o[5],o[6]),c=Cesium.Cartesian3.subtract(o[7],o[6]),f=Cesium.Cartesian3.subtract(o[6],o[2]),h=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(a,s,new Cesium.Cartesian3),new Cesium.Cartesian3),d=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(u,a,new Cesium.Cartesian3),new Cesium.Cartesian3),p=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(s,u,new Cesium.Cartesian3),new Cesium.Cartesian3),g=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(l,c,new Cesium.Cartesian3),new Cesium.Cartesian3),y=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(f,c,new Cesium.Cartesian3),new Cesium.Cartesian3),v=Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(l,f,new Cesium.Cartesian3),new Cesium.Cartesian3),w=Cesium.Cartesian4.fromElements(h.x,h.y,h.z,-Cesium.Cartesian3.dot(h,o[0])),C=Cesium.Cartesian4.fromElements(d.x,d.y,d.z,-Cesium.Cartesian3.dot(d,o[0])),E=Cesium.Cartesian4.fromElements(p.x,p.y,p.z,-Cesium.Cartesian3.dot(p,o[0])),S=Cesium.Cartesian4.fromElements(g.x,g.y,g.z,-Cesium.Cartesian3.dot(g,o[6])),A=Cesium.Cartesian4.fromElements(y.x,y.y,y.z,-Cesium.Cartesian3.dot(y,o[6])),D=Cesium.Cartesian4.fromElements(v.x,v.y,v.z,-Cesium.Cartesian3.dot(v,o[6])),P=[w,C,E,S,A,D];this.cillingvolume=new Cesium.CullingVolume(P)}remoSymbolAnchors(){for(let t in this.symbolAnchors)Object.hasOwnProperty.call(this.symbolAnchors,t)&&this.removeAnchor(t)}setChangeSymbolPositionFunc(t){t&&typeof t=="function"&&(this.changeSymbolPositionFunc=t)}updateSymbolAnchorsPositions(t){for(let n in this.symbolAnchors)if(Object.hasOwnProperty.call(this.symbolAnchors,n)){let o=this.symbolAnchors[n].position,a=Cesium.Cartographic.fromCartesian(o),s=new Cesium.Cartographic(a.longitude+t.longitude,a.latitude+t.latitude,a.height+t.height);this.changeAnchorPosition(n,s),this.changeSymbolPositionFunc&&this.changeSymbolPositionFunc(n,a)}}addSymbolAnchors(t,n){let r=this.drawAnchor(t,n,void 0);this.symbolAnchors[t]=r}startEditBoxEntity(){let t=this.getBoxEntityAnchorRadian(),n=this,r={dragHandlers:{onDrag:function(u,l){let c=Cesium.Cartographic.clone(n.getBoxEntityAnchorRadian()),f=Cesium.Cartographic.fromCartesian(l),h=f.longitude-c.longitude,d=f.latitude-c.latitude,p=f.height-c.height,g={longitude:h,latitude:d,height:p};n.mouseEventRadians.forEach(y=>{y.longitude+=h,y.latitude+=d,y.height+=p}),n.updateSymbolAnchorsPositions(g)},onDragEnd:function(u,l){let c=Cesium.Cartographic.clone(n.getBoxEntityAnchorRadian()),f=Cesium.Cartographic.fromCartesian(l),h=f.longitude-c.longitude,d=f.latitude-c.latitude,p=f.height-c.height,g={longitude:h,latitude:d,height:p};n.mouseEventRadians.forEach(y=>{y.longitude+=h,y.latitude+=d}),n.updateSymbolAnchorsPositions(g)}}},o=Cesium.createGuid();this.boxEntityAnchorId=o;let a=this.drawAnchor(o,t,r),s=new Cesium.Color(0,0,1,1);this.anchorHandler.myChangeBillboardColor(a.id,s),this.boxEntityAnchor=a}changeAnchorPosition(t,n){let r=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);this.anchorHandler.myChangeBillboardPosition(t,r)}removeAllAnchor(){this.anchorHandler.myRemoveAllBillboard()}removeAnchor(t){this.anchorHandler.myRemoveBillboard(t)}drawAnchor(t,n,r){let o=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,n.height);return this.anchorHandler.myAddBillboard(t,o,r)}getBoxEntityAnchorRadian(){let t=this.boxRadians.length,n=0,r=0,o=0;return this.boxRadians.forEach(s=>{n+=s.longitude,r+=s.latitude,o+=s.height}),new Cesium.Cartographic(n/t,r/t,o/t)}isDestroyed(){return!1}destroy(){this.viewer.entities.remove(this.boxEntity),this.removeAllAnchor(),this.boxEntity=void 0,delete this.boxEntity,delete this.viewer,delete this.id,delete this.pointNum,this.mouseEventRadians=void 0,delete this.mouseEventRadians,this.boxRadians=void 0,delete this.boxRadians,delete this.anchorHandler,this.cillingvolume=void 0,delete this.cillingvolume}},see=Cz;var gs=63710088e-1,jL={meters:gs,metres:gs,millimeters:gs*1e3,millimetres:gs*1e3,centimeters:gs*100,centimetres:gs*100,kilometers:gs/1e3,kilometres:gs/1e3,miles:gs/1609.344,nauticalmiles:gs/1852,inches:gs*39.37,yards:gs/1.0936,feet:gs*3.28084,radians:1,degrees:gs/111325},Yte={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:1/1e3,kilometres:1/1e3,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/gs,degrees:1/111325},IL={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function la(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.bbox,o=n.id;if(e===void 0)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");r&&Zx(r),o&&ZL(o);var a={type:"Feature"};return o&&(a.id=o),r&&(a.bbox=r),a.properties=t||{},a.geometry=e,a}function Xte(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.bbox;if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");r&&Zx(r);var o;switch(e){case"Point":o=Wr(t).geometry;break;case"LineString":o=Bi(t).geometry;break;case"Polygon":o=rr(t).geometry;break;case"MultiPoint":o=KL(t).geometry;break;case"MultiLineString":o=p_(t).geometry;break;case"MultiPolygon":o=Kx(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(o.bbox=r),o}function Wr(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!hi(e[0])||!hi(e[1]))throw new Error("coordinates must contain numbers");return la({type:"Point",coordinates:e},t,n)}function jte(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Ft(e.map(function(r){return Wr(r,t)}),n)}function rr(e,t,n){if(!e)throw new Error("coordinates is required");for(var r=0;r<e.length;r++){var o=e[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(r===0&&a===0&&!hi(o[0][0])||!hi(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return la({type:"Polygon",coordinates:e},t,n)}function Kte(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Ft(e.map(function(r){return rr(r,t)}),n)}function Bi(e,t,n){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!hi(e[0][1])||!hi(e[0][1]))throw new Error("coordinates must contain numbers");return la({type:"LineString",coordinates:e},t,n)}function Zte(e,t,n){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return Ft(e.map(function(r){return Bi(r,t)}),n)}function Ft(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");n&&Zx(n),r&&ZL(r);var o={type:"FeatureCollection"};return r&&(o.id=r),n&&(o.bbox=n),o.features=e,o}function p_(e,t,n){if(!e)throw new Error("coordinates is required");return la({type:"MultiLineString",coordinates:e},t,n)}function KL(e,t,n){if(!e)throw new Error("coordinates is required");return la({type:"MultiPoint",coordinates:e},t,n)}function Kx(e,t,n){if(!e)throw new Error("coordinates is required");return la({type:"MultiPolygon",coordinates:e},t,n)}function u4(e,t,n){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return la({type:"GeometryCollection",geometries:e},t,n)}function Qte(e,t){if(e==null||isNaN(e))throw new Error("num is required");if(t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function Sx(e,t){if(e==null)throw new Error("radians is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=jL[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e*n}function mv(e,t){if(e==null)throw new Error("distance is required");if(t&&typeof t!="string")throw new Error("units must be a string");var n=jL[t||"kilometers"];if(!n)throw new Error(t+" units is invalid");return e/n}function DL(e,t){return r_(mv(e,t))}function J0(e){if(e==null)throw new Error("bearing is required");var t=e%360;return t<0&&(t+=360),t}function r_(e){if(e==null)throw new Error("radians is required");var t=e%(2*Math.PI);return t*180/Math.PI}function Za(e){if(e==null)throw new Error("degrees is required");var t=e%360;return t*Math.PI/180}function gv(e,t,n){if(e==null)throw new Error("length is required");if(!(e>=0))throw new Error("length must be a positive number");return Sx(mv(e,t),n||"kilometers")}function Jte(e,t,n){if(e==null)throw new Error("area is required");if(!(e>=0))throw new Error("area must be a positive number");var r=IL[t||"meters"];if(!r)throw new Error("invalid original units");var o=IL[n||"kilometers"];if(!o)throw new Error("invalid final units");return e/r*o}function hi(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function gt(e){return!!e&&e.constructor===Object}function Zx(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!hi(t))throw new Error("bbox must only contain numbers")})}function ZL(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function VRe(){throw new Error("method has been renamed to `radiansToDegrees`")}function kRe(){throw new Error("method has been renamed to `degreesToRadians`")}function GRe(){throw new Error("method has been renamed to `lengthToDegrees`")}function URe(){throw new Error("method has been renamed to `lengthToRadians`")}function HRe(){throw new Error("method has been renamed to `radiansToLength`")}function qRe(){throw new Error("method has been renamed to `bearingToAzimuth`")}function WRe(){throw new Error("method has been renamed to `convertLength`")}var YRe=Object.freeze({earthRadius:gs,factors:jL,unitsFactors:Yte,areaFactors:IL,feature:la,geometry:Xte,point:Wr,points:jte,polygon:rr,polygons:Kte,lineString:Bi,lineStrings:Zte,featureCollection:Ft,multiLineString:p_,multiPoint:KL,multiPolygon:Kx,geometryCollection:u4,round:Qte,radiansToLength:Sx,lengthToRadians:mv,lengthToDegrees:DL,bearingToAzimuth:J0,radiansToDegrees:r_,degreesToRadians:Za,convertLength:gv,convertArea:Jte,isNumber:hi,isObject:gt,validateBBox:Zx,validateId:ZL,radians2degrees:VRe,degrees2radians:kRe,distanceToDegrees:GRe,distanceToRadians:URe,radiansToDistance:HRe,bearingToAngle:qRe,convertDistance:WRe});function Qa(e,t,n){if(e!==null)for(var r,o,a,s,u,l,c,f=0,h=0,d,p=e.type,g=p==="FeatureCollection",y=p==="Feature",v=g?e.features.length:1,w=0;w<v;w++){c=g?e.features[w].geometry:y?e.geometry:e,d=c?c.type==="GeometryCollection":!1,u=d?c.geometries.length:1;for(var C=0;C<u;C++){var E=0,S=0;if(s=d?c.geometries[C]:c,s!==null){l=s.coordinates;var A=s.type;switch(f=n&&(A==="Polygon"||A==="MultiPolygon")?1:0,A){case null:break;case"Point":t(l,h,w,E,S),h++,E++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++)t(l[r],h,w,E,S),h++,A==="MultiPoint"&&E++;A==="LineString"&&E++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(o=0;o<l[r].length-f;o++)t(l[r][o],h,w,E,S),h++;A==="MultiLineString"&&E++,A==="Polygon"&&S++}A==="Polygon"&&E++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(A==="MultiPolygon"&&(S=0),o=0;o<l[r].length;o++){for(a=0;a<l[r][o].length-f;a++)t(l[r][o][a],h,w,E,S),h++;S++}E++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)Qa(s.geometries[r],t,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function QL(e,t,n,r){var o=n;return Qa(e,function(a,s,u,l,c){s===0&&n===void 0?o=a:o=t(o,a,s,u,l,c)},r),o}function l4(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length;n++)t(e.features[n].properties,n);break;case"Feature":t(e.properties,0);break}}function $te(e,t,n){var r=n;return l4(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function di(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)t(e.features[n],n)}function c4(e,t,n){var r=n;return di(e,function(o,a){a===0&&n===void 0?r=o:r=t(r,o,a)}),r}function Qp(e){var t=[];return Qa(e,function(n){t.push(n)}),t}function Fh(e,t){var n,r,o,a,s,u,l,c,f,h,d=0,p=e.type==="FeatureCollection",g=e.type==="Feature",y=p?e.features.length:1;for(n=0;n<y;n++){for(u=p?e.features[n].geometry:g?e.geometry:e,c=p?e.features[n].properties:g?e.properties:{},f=p?e.features[n].bbox:g?e.bbox:void 0,h=p?e.features[n].id:g?e.id:void 0,l=u?u.type==="GeometryCollection":!1,s=l?u.geometries.length:1,o=0;o<s;o++){if(a=l?u.geometries[o]:u,a===null){t(null,d,c,f,h);continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{t(a,d,c,f,h);break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)t(a.geometries[r],d,c,f,h);break}default:throw new Error("Unknown Geometry Type")}}d++}}function f4(e,t,n){var r=n;return Fh(e,function(o,a,s,u,l){a===0&&n===void 0?r=o:r=t(r,o,a,s,u,l)}),r}function ba(e,t){Fh(e,function(n,r,o,a,s){var u=n===null?null:n.type;switch(u){case null:case"Point":case"LineString":case"Polygon":t(la(n,o,{bbox:a,id:s}),r,0);return}var l;switch(u){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}n.coordinates.forEach(function(c,f){var h={type:l,coordinates:c};t(la(h,o),r,f)})})}function ene(e,t,n){var r=n;return ba(e,function(o,a,s){a===0&&s===0&&n===void 0?r=o:r=t(r,o,a,s)}),r}function yg(e,t){ba(e,function(n,r,o){var a=0;if(!!n.geometry){var s=n.geometry.type;s==="Point"||s==="MultiPoint"||QL(n,function(u,l,c,f,h,d){var p=Bi([u,l],n.properties);return t(p,r,o,d,a),a++,l})}})}function h4(e,t,n){var r=n,o=!1;return yg(e,function(a,s,u,l,c){o===!1&&n===void 0?r=a:r=t(r,a,s,u,l,c),o=!0}),r}function d4(e,t){if(!e)throw new Error("geojson is required");ba(e,function(n,r,o){if(n.geometry!==null){var a=n.geometry.type,s=n.geometry.coordinates;switch(a){case"LineString":t(n,r,o,0,0);break;case"Polygon":for(var u=0;u<s.length;u++)t(Bi(s[u],n.properties),r,o,u);break}}})}function p4(e,t,n){var r=n;return d4(e,function(o,a,s,u){a===0&&n===void 0?r=o:r=t(r,o,a,s,u)}),r}var XRe=Object.freeze({coordEach:Qa,coordReduce:QL,propEach:l4,propReduce:$te,featureEach:di,featureReduce:c4,coordAll:Qp,geomEach:Fh,geomReduce:f4,flattenEach:ba,flattenReduce:ene,segmentEach:yg,segmentReduce:h4,lineEach:d4,lineReduce:p4});function Ia(e){var t=[1/0,1/0,-1/0,-1/0];return Qa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function co(e){if(!e)throw new Error("obj is required");var t=Et(e);if(t.length>1&&hi(t[0])&&hi(t[1]))return t;throw new Error("Coordinate is not a valid Point")}function Et(e){if(!e)throw new Error("obj is required");var t;if(e.length?t=e:e.coordinates?t=e.coordinates:e.geometry&&e.geometry.coordinates&&(t=e.geometry.coordinates),t)return JL(t),t;throw new Error("No valid coordinates")}function JL(e){if(e.length>1&&hi(e[0])&&hi(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return JL(e[0]);throw new Error("coordinates must only contain numbers")}function tne(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function oA(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function Ud(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<e.features.length;r++){var o=e.features[r];if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+o.geometry.type)}}function $l(e){if(!e)throw new Error("geojson is required");if(e.geometry!==void 0)return e.geometry;if(e.coordinates||e.geometries)return e;throw new Error("geojson must be a valid Feature or Geometry Object")}function nne(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function Fi(e,t){if(!e)throw new Error((t||"geojson")+" is required");if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error((t||"geojson")+" is invalid")}var jRe=Object.freeze({getCoord:co,getCoords:Et,containsNumber:JL,geojsonType:tne,featureOf:oA,collectionOf:Ud,getGeom:$l,getGeomType:nne,getType:Fi});/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */var uee={successCallback:null,verbose:!1},lL={};function KRe(e,t,n){n=n||{};for(var r=Object.keys(uee),o=0;o<r.length;o++){var a=r[o],s=n[a];s=typeof s<"u"&&s!==null?s:uee[a],lL[a]=s}lL.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var u=JRe(ZRe(e,t));return typeof lL.successCallback=="function"&&lL.successCallback(u),u}function Ni(e,t,n){return(e-t)/(n-t)}function ZRe(e,t){for(var n=e.length-1,r=e[0].length-1,o={rows:n,cols:r,cells:[]},a=0;a<n;++a){o.cells[a]=[];for(var s=0;s<r;++s){var u=0,l=e[a+1][s],c=e[a+1][s+1],f=e[a][s+1],h=e[a][s];if(!(isNaN(l)||isNaN(c)||isNaN(f)||isNaN(h))){u|=l>=t?8:0,u|=c>=t?4:0,u|=f>=t?2:0,u|=h>=t?1:0;var d=!1;if(u===5||u===10){var p=(l+c+f+h)/4;u===5&&p<t?(u=10,d=!0):u===10&&p<t&&(u=5,d=!0)}if(u!==0&&u!==15){var g,y,v,w;g=y=v=w=.5,u===1?(v=1-Ni(t,l,h),y=1-Ni(t,f,h)):u===2?(y=Ni(t,h,f),w=1-Ni(t,c,f)):u===3?(v=1-Ni(t,l,h),w=1-Ni(t,c,f)):u===4?(g=Ni(t,l,c),w=Ni(t,f,c)):u===5?(g=Ni(t,l,c),w=Ni(t,f,c),y=1-Ni(t,f,h),v=1-Ni(t,l,h)):u===6?(y=Ni(t,h,f),g=Ni(t,l,c)):u===7?(v=1-Ni(t,l,h),g=Ni(t,l,c)):u===8?(v=Ni(t,h,l),g=1-Ni(t,c,l)):u===9?(y=1-Ni(t,f,h),g=1-Ni(t,c,l)):u===10?(g=1-Ni(t,c,l),w=1-Ni(t,c,f),y=Ni(t,h,f),v=Ni(t,h,l)):u===11?(g=1-Ni(t,c,l),w=1-Ni(t,c,f)):u===12?(v=Ni(t,h,l),w=Ni(t,f,c)):u===13?(y=1-Ni(t,f,h),w=Ni(t,f,c)):u===14?(v=Ni(t,h,l),y=Ni(t,h,f)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+u),o.cells[a][s]={cval:u,flipped:d,top:g,right:w,bottom:y,left:v}}}}}return o}function QRe(e){return e.cval===5||e.cval===10}function rne(e){return e.cval===0||e.cval===15}function lee(e){!rne(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function wz(e,t){if(t==="top")return[e.top,1];if(t==="bottom")return[e.bottom,0];if(t==="right")return[1,e.right];if(t==="left")return[0,e.left]}function JRe(e){var t=[],n=0,r=e.rows,o=e.cols,a=1e-7;return e.cells.forEach(function(s,u){s.forEach(function(l,c){if(typeof l<"u"&&!QRe(l)&&!rne(l)){var f=$Re(e.cells,u,c),h=!1;if(f.info==="mergeable"){for(var d=f.path[f.path.length-1][0],p=f.path[f.path.length-1][1],g=n-1;g>=0;g--)if(Math.abs(t[g][0][0]-d)<=a&&Math.abs(t[g][0][1]-p)<=a){for(var y=f.path.length-2;y>=0;--y)t[g].unshift(f.path[y]);h=!0;break}}h||(t[n++]=f.path)}})}),t}function $Re(e,t,n){var r=e.length,o=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],s=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u,l,c=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],f=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],g,h=e[t][n],d=e[t][n],p=d.cval,g=c[p],y=wz(d,g);o.push([n+y[0],t+y[1]]),g=f[p],y=wz(d,g),o.push([n+y[0],t+y[1]]),lee(d);for(var v=n+a[p],w=t+s[p],C=p;v>=0&&w>=0&&w<r&&(v!=n||w!=t)&&(d=e[w][v],!(typeof d>"u"));){if(p=d.cval,p===0||p===15)return{path:o,info:"mergeable"};g=f[p],u=a[p],l=s[p],(p===5||p===10)&&(p===5?d.flipped?s[C]===-1?(g="left",u=-1,l=0):(g="right",u=1,l=0):a[C]===-1&&(g="bottom",u=0,l=-1):p===10&&(d.flipped?a[C]===-1?(g="top",u=0,l=1):(g="bottom",u=0,l=-1):s[C]===1&&(g="left",u=-1,l=0))),y=wz(d,g),o.push([v+y[0],w+y[1]]),lee(d),v+=u,w+=l,C=p}return{path:o,info:"closed"}}function eOe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;Ud(e,"Point","input must contain Points");for(var a=tOe(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function tOe(e,t){var n={};di(e,function(a){var s=Et(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return Et(l)[0]-Et(c)[0]});return u}),o=r.sort(function(a,s){return t?Et(a[0])[1]-Et(s[0])[1]:Et(s[0])[1]-Et(a[0])[1]});return o}function nOe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(Ud(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!gt(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(a))throw new Error("breaksProperties must be an Array");var s=eOe(e,{zProperty:r,flip:!0}),u=rOe(s,t,r,o,a),l=iOe(u,s,e);return Ft(l)}function rOe(e,t,n,r,o){for(var a=[],s=1;s<t.length;s++){var u=+t[s],l=Object.assign({},r,o[s]);l[n]=u;var c=p_(KRe(e,u),l);a.push(c)}return a}function iOe(e,t,n){var r=Ia(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){Qa(p,d)}),e}var oOe=ine;function ine(e,t,n,r,o){for(n=n||0,r=r||e.length-1,o=o||aOe;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));ine(e,t,f,h,o)}var d=e[t],p=n,g=r;for(qS(e,n,t),o(e[r],d)>0&&qS(e,n,r);p<g;){for(qS(e,p,g),p++,g--;o(e[p],d)<0;)p++;for(;o(e[g],d)>0;)g--}o(e[n],d)===0?qS(e,n,g):(g++,qS(e,g,r)),g<=t&&(n=g+1),t<=g&&(r=g-1)}}function qS(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function aOe(e,t){return e<t?-1:e>t?1:0}var Ax=PL;function PL(e,t){if(!(this instanceof PL))return new PL(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}PL.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!fL(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,fL(e,l)&&(t.leaf?n.push(u):Tz(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!fL(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,fL(e,u)){if(t.leaf||Tz(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=_x([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=sOe(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&Tz(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:cee,compareMinY:fee,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=_x(e.slice(t,n+1)),mx(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=_x([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(hee(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),hee(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return mx(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=Ez(s),c=uOe(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),QS(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=_x(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,mx(n,this.toBBox),mx(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=_x([e,t]),this.data.height=e.height+1,this.data.leaf=!1,mx(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=ZS(e,0,r,this.toBBox),a=ZS(e,r,n,this.toBBox),s=lOe(o,a),u=Ez(o)+Ez(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:cee,o=e.leaf?this.compareMinY:fee,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=ZS(e,0,t,o),s=ZS(e,n-t,n,o),u=cL(a)+cL(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],QS(a,e.leaf?o(c):c),u+=cL(a);for(l=n-t-1;l>=t;l--)c=e.children[l],QS(s,e.leaf?o(c):c),u+=cL(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)QS(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():mx(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function sOe(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function mx(e,t){ZS(e,0,e.children.length,t,e)}function ZS(e,t,n,r,o){o||(o=_x(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],QS(o,e.leaf?r(s):s);return o}function QS(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function cee(e,t){return e.minX-t.minX}function fee(e,t){return e.minY-t.minY}function Ez(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function cL(e){return e.maxX-e.minX+(e.maxY-e.minY)}function uOe(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function lOe(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function Tz(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function fL(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _x(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function hee(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,oOe(e,s,t,n,o),a.push(t,s,s,n))}function Rg(e,t){return t={exports:{}},e(t,t.exports),t.exports}var EL=cOe,dee=+(Math.pow(2,27)+1);function cOe(e,t,n){var r=e*t,o=dee*e,a=o-e,s=o-a,u=e-s,l=dee*t,c=l-t,f=l-c,h=t-f,d=r-s*f,p=d-u*f,g=p-s*h,y=u*h-g;return n?(n[0]=y,n[1]=r,n):[y,r]}var fOe=dOe;function hOe(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function dOe(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return hOe(e[0],t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=t[l],p=c(d),g,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=t[l],p=c(d))),u<n&&h<p||l>=r?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=t[l],p=c(d)));for(var v=g+y,w=v-g,C=y-w,E=C,S=v,A,D,P,M,I;u<n&&l<r;)h<p?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=t[l],p=c(d))),y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A;for(;u<n;)g=f,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)g=d,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,l+=1,l<r&&(d=t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var pOe=mOe;function mOe(e,t,n){var r=e+t,o=r-e,a=r-o,s=t-o,u=e-a;return n?(n[0]=u+s,n[1]=r,n):[u+s,r]}var gOe=_Oe;function _Oe(e,t){var n=e.length;if(n===1){var r=EL(e[0],t);return r[0]?r:[r[1]]}var o=new Array(2*n),a=[.1,.1],s=[.1,.1],u=0;EL(e[0],t,a),a[0]&&(o[u++]=a[0]);for(var l=1;l<n;++l){EL(e[l],t,s);var c=a[1];pOe(c,s[0],a),a[0]&&(o[u++]=a[0]);var f=s[1],h=a[1],d=f+h,p=d-f,g=h-p;a[1]=d,g&&(o[u++]=g)}return a[1]&&(o[u++]=a[1]),u===0&&(o[u++]=0),o.length=u,o}var yOe=COe;function vOe(e,t){var n=e+t,r=n-e,o=n-r,a=t-r,s=e-o,u=s+a;return u?[u,n]:[n]}function COe(e,t){var n=e.length|0,r=t.length|0;if(n===1&&r===1)return vOe(e[0],-t[0]);var o=n+r,a=new Array(o),s=0,u=0,l=0,c=Math.abs,f=e[u],h=c(f),d=-t[l],p=c(d),g,y;h<p?(y=f,u+=1,u<n&&(f=e[u],h=c(f))):(y=d,l+=1,l<r&&(d=-t[l],p=c(d))),u<n&&h<p||l>=r?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=-t[l],p=c(d)));for(var v=g+y,w=v-g,C=y-w,E=C,S=v,A,D,P,M,I;u<n&&l<r;)h<p?(g=f,u+=1,u<n&&(f=e[u],h=c(f))):(g=d,l+=1,l<r&&(d=-t[l],p=c(d))),y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A;for(;u<n;)g=f,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,u+=1,u<n&&(f=e[u]);for(;l<r;)g=d,y=E,v=g+y,w=v-g,C=y-w,C&&(a[s++]=C),A=S+v,D=A-S,P=A-D,M=v-D,I=S-P,E=I+M,S=A,l+=1,l<r&&(d=-t[l]);return E&&(a[s++]=E),S&&(a[s++]=S),s||(a[s++]=0),a.length=s,a}var one=Rg(function(e){var t=5,n=11102230246251565e-32,r=(3+16*n)*n,o=(7+56*n)*n;function a(v,w){for(var C=new Array(v.length-1),E=1;E<v.length;++E)for(var S=C[E-1]=new Array(v.length-1),A=0,D=0;A<v.length;++A)A!==w&&(S[D++]=v[E][A]);return C}function s(v){for(var w=new Array(v),C=0;C<v;++C){w[C]=new Array(v);for(var E=0;E<v;++E)w[C][E]=["m",E,"[",v-C-1,"]"].join("")}return w}function u(v){return v&1?"-":""}function l(v){if(v.length===1)return v[0];if(v.length===2)return["sum(",v[0],",",v[1],")"].join("");var w=v.length>>1;return["sum(",l(v.slice(0,w)),",",l(v.slice(w)),")"].join("")}function c(v){if(v.length===2)return[["sum(prod(",v[0][0],",",v[1][1],"),prod(-",v[0][1],",",v[1][0],"))"].join("")];for(var w=[],C=0;C<v.length;++C)w.push(["scale(",l(c(a(v,C))),",",u(C),v[0][C],")"].join(""));return w}function f(v){for(var w=[],C=[],E=s(v),S=[],A=0;A<v;++A)(A&1)===0?w.push.apply(w,c(a(E,A))):C.push.apply(C,c(a(E,A))),S.push("m"+A);var D=l(w),P=l(C),M="orientation"+v+"Exact",I=["function ",M,"(",S.join(),"){var p=",D,",n=",P,",d=sub(p,n);return d[d.length-1];};return ",M].join(""),O=new Function("sum","prod","scale","sub",I);return O(fOe,EL,gOe,yOe)}var h=f(3),d=f(4),p=[function(){return 0},function(){return 0},function(w,C){return C[0]-w[0]},function(w,C,E){var S=(w[1]-E[1])*(C[0]-E[0]),A=(w[0]-E[0])*(C[1]-E[1]),D=S-A,P;if(S>0){if(A<=0)return D;P=S+A}else if(S<0){if(A>=0)return D;P=-(S+A)}else return D;var M=r*P;return D>=M||D<=-M?D:h(w,C,E)},function(w,C,E,S){var A=w[0]-S[0],D=C[0]-S[0],P=E[0]-S[0],M=w[1]-S[1],I=C[1]-S[1],O=E[1]-S[1],m=w[2]-S[2],b=C[2]-S[2],L=E[2]-S[2],R=D*O,N=P*I,B=P*M,G=A*O,F=A*I,k=D*M,Z=m*(R-N)+b*(B-G)+L*(F-k),te=(Math.abs(R)+Math.abs(N))*Math.abs(m)+(Math.abs(B)+Math.abs(G))*Math.abs(b)+(Math.abs(F)+Math.abs(k))*Math.abs(L),oe=o*te;return Z>oe||-Z>oe?Z:d(w,C,E,S)}];function g(v){var w=p[v.length];return w||(w=p[v.length]=f(v.length)),w.apply(void 0,v)}function y(){for(;p.length<=t;)p.push(f(p.length));for(var v=[],w=["slow"],C=0;C<=t;++C)v.push("a"+C),w.push("o"+C);for(var E=["function getOrientation(",v.join(),"){switch(arguments.length){case 0:case 1:return 0;"],C=2;C<=t;++C)E.push("case ",C,":return o",C,"(",v.slice(0,C).join(),");");E.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),w.push(E.join(""));var S=Function.apply(void 0,w);e.exports=S.apply(void 0,[g].concat(p));for(var C=0;C<=t;++C)e.exports[C]=p[C]}y()}),xOe=wOe,pee=one[3];function wOe(e){var t=e.length;if(t<3){for(var c=new Array(t),n=0;n<t;++n)c[n]=n;return t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:c}for(var r=new Array(t),n=0;n<t;++n)r[n]=n;r.sort(function(p,g){var y=e[p][0]-e[g][0];return y||e[p][1]-e[g][1]});for(var o=[r[0],r[1]],a=[r[0],r[1]],n=2;n<t;++n){for(var s=r[n],u=e[s],l=o.length;l>1&&pee(e[o[l-2]],e[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(s),l=a.length;l>1&&pee(e[a[l-2]],e[a[l-1]],u)>=0;)l-=1,a.pop();a.push(s)}for(var c=new Array(a.length+o.length-2),f=0,n=0,h=o.length;n<h;++n)c[f++]=o[n];for(var d=a.length-2;d>0;--d)c[f++]=a[d];return c}var ane=aA,EOe=aA;function aA(e,t){if(!(this instanceof aA))return new aA(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||TOe,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function TOe(e,t){return e<t?-1:e>t?1:0}aA.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var o=e-1>>1,a=t[o];if(n(r,a)>=0)break;t[e]=a,e=o}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,o=t[e];e<r;){var a=(e<<1)+1,s=a+1,u=t[a];if(s<this.length&&n(t[s],u)<0&&(a=s,u=t[s]),n(u,o)>=0)break;t[e]=u,e=a}t[e]=o}};ane.default=EOe;var SOe=function(e,t){for(var n=e[0],r=e[1],o=!1,a=0,s=t.length-1;a<t.length;s=a++){var u=t[a][0],l=t[a][1],c=t[s][0],f=t[s][1],h=l>r!=f>r&&n<(c-u)*(r-l)/(f-l)+u;h&&(o=!o)}return o},hL=one[3],sne=une,AOe=une;function une(e,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;for(var r=MOe(e),o=Ax(16,["[0]","[1]","[0]","[1]"]).load(e),a=[],s=0,u;s<r.length;s++){var l=r[s];o.remove(l),u=_ee(l,u),a.push(u)}var c=Ax(16);for(s=0;s<a.length;s++)c.insert(Sz(a[s]));for(var f=t*t,h=n*n;a.length;){var d=a.shift(),p=d.p,g=d.next.p,y=Az(p,g);if(!(y<h)){var v=y/f;l=bOe(o,d.prev.p,p,g,d.next.next.p,v,c),l&&Math.min(Az(l,p),Az(l,g))<=v&&(a.push(d),a.push(_ee(l,d)),o.remove(l),c.remove(d),c.insert(Sz(d)),c.insert(Sz(d.next)))}}d=u;var w=[];do w.push(d.p),d=d.next;while(d!==u);return w.push(d.p),w}function bOe(e,t,n,r,o,a,s){for(var u=new ane(null,IOe),l=e.data;l;){for(var c=0;c<l.children.length;c++){var f=l.children[c],h=l.leaf?bz(f,n,r):DOe(n,r,f);h>a||u.push({node:f,dist:h})}for(;u.length&&!u.peek().node.children;){var d=u.pop(),p=d.node,g=bz(p,t,n),y=bz(p,r,o);if(d.dist<g&&d.dist<y&&gee(n,p,s)&&gee(r,p,s))return p}l=u.pop(),l&&(l=l.node)}return null}function IOe(e,t){return e.dist-t.dist}function DOe(e,t,n){if(mee(e,n)||mee(t,n))return 0;var r=dL(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var o=dL(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(o===0)return 0;var a=dL(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var s=dL(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return s===0?0:Math.min(r,o,a,s)}function mee(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function gee(e,t,n){for(var r=Math.min(e[0],t[0]),o=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),s=Math.max(e[1],t[1]),u=n.search({minX:r,minY:o,maxX:a,maxY:s}),l=0;l<u.length;l++)if(POe(u[l].p,u[l].next.p,e,t))return!1;return!0}function POe(e,t,n,r){return e!==r&&t!==n&&hL(e,t,n)>0!=hL(e,t,r)>0&&hL(n,r,e)>0!=hL(n,r,t)>0}function Sz(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function MOe(e){for(var t=e[0],n=e[0],r=e[0],o=e[0],a=0;a<e.length;a++){var s=e[a];s[0]<t[0]&&(t=s),s[0]>r[0]&&(r=s),s[1]<n[1]&&(n=s),s[1]>o[1]&&(o=s)}var u=[t,n,r,o],l=u.slice();for(a=0;a<e.length;a++)SOe(e[a],u)||l.push(e[a]);var c=xOe(l),f=[];for(a=0;a<c.length;a++)f.push(l[c[a]]);return f}function _ee(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function Az(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function bz(e,t,n){var r=t[0],o=t[1],a=n[0]-r,s=n[1]-o;if(a!==0||s!==0){var u=((e[0]-r)*a+(e[1]-o)*s)/(a*a+s*s);u>1?(r=n[0],o=n[1]):u>0&&(r+=a*u,o+=s*u)}return a=e[0]-r,s=e[1]-o,a*a+s*s}function dL(e,t,n,r,o,a,s,u){var l=n-e,c=r-t,f=s-o,h=u-a,d=e-o,p=t-a,g=l*l+c*c,y=l*f+c*h,v=f*f+h*h,w=l*d+c*p,C=f*d+h*p,E=g*v-y*y,S,A,D,P,M=E,I=E;E===0?(A=0,M=1,P=C,I=v):(A=y*C-v*w,P=g*C-y*w,A<0?(A=0,P=C,I=v):A>M&&(A=M,P=C+y,I=v)),P<0?(P=0,-w<0?A=0:-w>g?A=M:(A=-w,M=g)):P>I&&(P=I,-w+y<0?A=0:-w+y>g?A=M:(A=-w+y,M=g)),S=A===0?0:A/M,D=P===0?0:P/I;var O=(1-S)*e+S*n,m=(1-S)*t+S*r,b=(1-D)*o+D*s,L=(1-D)*a+D*u,R=b-O,N=L-m;return R*R+N*N}sne.default=AOe;function lne(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.concavity||1/0,r=[];if(Qa(e,function(a){r.push([a[0],a[1]])}),!r.length)return null;var o=sne(r,n);return o.length>3?rr([o]):null}function xo(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=co(e),a=Et(t),s=t.geometry?t.geometry.type:t.type,u=t.bbox;if(u&&LOe(o,u)===!1)return!1;s==="Polygon"&&(a=[a]);for(var l=0,c=!1;l<a.length&&!c;l++)if(yee(o,a[l][0],r)){for(var f=!1,h=1;h<a[l].length&&!f;)yee(o,a[l][h],!r)&&(f=!0),h++;f||(c=!0)}return c}function yee(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],u=t[o][1],l=t[a][0],c=t[a][1],f=e[1]*(s-l)+u*(l-e[0])+c*(e[0]-s)===0&&(s-e[0])*(l-e[0])<=0&&(u-e[1])*(c-e[1])<=0;if(f)return!n;var h=u>e[1]!=c>e[1]&&e[0]<(l-s)*(e[1]-u)/(c-u)+s;h&&(r=!r)}return r}function LOe(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function Uz(e,t){var n=[];return Fh(t,function(r){di(e,function(o){xo(o,r)&&n.push(o)})}),Ft(n)}function cne(e,t){if(e.type!=="FeatureCollection")throw new Error("points must be a FeatureCollection");var n=!1;return Ft(NOe(e.features.map(function(r){var o={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1]};return t?o.z=r.properties[t]:r.geometry.coordinates.length===3&&(n=!0,o.z=r.geometry.coordinates[2]),o})).map(function(r){var o=[r.a.x,r.a.y],a=[r.b.x,r.b.y],s=[r.c.x,r.c.y],u={};return n?(o.push(r.a.z),a.push(r.b.z),s.push(r.c.z)):u={a:r.a.z,b:r.b.z,c:r.c.z},rr([[o,a,s,o]],u)}))}function vee(e,t,n){this.a=e,this.b=t,this.c=n;var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,u=r*(e.x+t.x)+o*(e.y+t.y),l=a*(e.x+n.x)+s*(e.y+n.y),c=2*(r*(n.y-t.y)-o*(n.x-t.x)),f,h;this.x=(s*u-o*l)/c,this.y=(r*l-a*u)/c,f=this.x-e.x,h=this.y-e.y,this.r=f*f+h*h}function ROe(e,t){return t.x-e.x}function OOe(e){var t=e.length,n,r,o,a,s;e:for(;t;)for(r=e[--t],n=e[--t],o=t;o;)if(s=e[--o],a=e[--o],n===a&&r===s||n===s&&r===a){e.splice(t,2),e.splice(o,2),t-=2;continue e}}function NOe(e){if(e.length<3)return[];e.sort(ROe);for(var t=e.length-1,n=e[t].x,r=e[0].x,o=e[t].y,a=o,s=1e-12,u,l,c,f,h,d;t--;)e[t].y<o&&(o=e[t].y),e[t].y>a&&(a=e[t].y);var p=r-n,g=a-o,y=p>g?p:g,v=(r+n)*.5,w=(a+o)*.5,C=[new vee({x:v-20*y,y:w-y,__sentinel:!0},{x:v,y:w+20*y,__sentinel:!0},{x:v+20*y,y:w-y,__sentinel:!0})],E=[],S=[],A;for(t=e.length;t--;){for(S.length=0,A=C.length;A--;){if(p=e[t].x-C[A].x,p>0&&p*p>C[A].r){E.push(C[A]),C.splice(A,1);continue}g=e[t].y-C[A].y,!(p*p+g*g>C[A].r)&&(S.push(C[A].a,C[A].b,C[A].b,C[A].c,C[A].c,C[A].a),C.splice(A,1))}for(OOe(S),A=S.length;A;)l=S[--A],u=S[--A],c=e[t],f=l.x-u.x,h=l.y-u.y,d=2*(f*(c.y-l.y)-h*(c.x-l.x)),Math.abs(d)>s&&C.push(new vee(u,l,c))}for(Array.prototype.push.apply(E,C),t=E.length;t--;)(E[t].a.__sentinel||E[t].b.__sentinel||E[t].c.__sentinel)&&E.splice(t,1);return E}function fi(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=co(e),a=co(t),s=Za(a[1]-o[1]),u=Za(a[0]-o[0]),l=Za(o[1]),c=Za(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return Sx(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r)}function vu(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return fne(e);case"FeatureCollection":return BOe(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return m4(e);default:throw new Error("unknown GeoJSON type")}}function fne(e){var t={type:"Feature"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}}),t.properties=hne(e.properties),t.geometry=m4(e.geometry),t}function hne(e){var t={};return e&&Object.keys(e).forEach(function(n){var r=e[n];typeof r=="object"?r===null?t[n]=null:r.length?t[n]=r.map(function(o){return o}):t[n]=hne(r):t[n]=r}),t}function BOe(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}}),t.features=e.features.map(function(n){return fne(n)}),t}function m4(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(function(n){return m4(n)}),t):(t.coordinates=dne(e.coordinates),t)}function dne(e){return typeof e[0]!="object"?e.slice():e.map(function(t){return dne(t)})}var FOe=function(e){return e},zOe=function(e){if(e==null)return FOe;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(u,l){l||(t=n=0);var c=2,f=u.length,h=new Array(f);for(h[0]=(t+=u[0])*r+a,h[1]=(n+=u[1])*o+s;c<f;)h[c]=u[c],++c;return h}},VOe=function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n};function pne(e,t){var n=zOe(e.transform),r=e.arcs;function o(f,h){h.length&&h.pop();for(var d=r[f<0?~f:f],p=0,g=d.length;p<g;++p)h.push(n(d[p],p));f<0&&VOe(h,g)}function a(f){return n(f)}function s(f){for(var h=[],d=0,p=f.length;d<p;++d)o(f[d],h);return h.length<2&&h.push(h[0]),h}function u(f){for(var h=s(f);h.length<4;)h.push(h[0]);return h}function l(f){return f.map(u)}function c(f){var h=f.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:f.geometries.map(c)};case"Point":d=a(f.coordinates);break;case"MultiPoint":d=f.coordinates.map(a);break;case"LineString":d=s(f.arcs);break;case"MultiLineString":d=f.arcs.map(s);break;case"Polygon":d=l(f.arcs);break;case"MultiPolygon":d=f.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(t)}var kOe=function(e,t){var n={},r={},o={},a=[],s=-1;t.forEach(function(c,f){var h=e.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=t[++s],t[s]=c,t[f]=d)}),t.forEach(function(c){var f=u(c),h=f[0],d=f[1],p,g;if(p=o[h])if(delete o[p.end],p.push(c),p.end=d,g=r[d]){delete r[g.start];var y=g===p?p:p.concat(g);r[y.start=p.start]=o[y.end=g.end]=y}else r[p.start]=o[p.end]=p;else if(p=r[d])if(delete r[p.start],p.unshift(c),p.start=h,g=o[h]){delete o[g.end];var v=g===p?p:g.concat(p);r[v.start=g.start]=o[v.end=p.end]=v}else r[p.start]=o[p.end]=p;else p=[c],r[p.start=h]=o[p.end=d]=p});function u(c){var f=e.arcs[c<0?~c:c],h=f[0],d;return e.transform?(d=[0,0],f.forEach(function(p){d[0]+=p[0],d[1]+=p[1]})):d=f[f.length-1],c<0?[d,h]:[h,d]}function l(c,f){for(var h in c){var d=c[h];delete f[d.start],delete d.start,delete d.end,d.forEach(function(p){n[p<0?~p:p]=1}),a.push(d)}}return l(o,r),l(r,o),t.forEach(function(c){n[c<0?~c:c]||a.push([c])}),a};function GOe(e){for(var t=-1,n=e.length,r,o=e[n-1],a=0;++t<n;)r=o,o=e[t],a+=r[0]*o[1]-r[1]*o[0];return Math.abs(a)}var UOe=function(e){return pne(e,HOe.apply(this,arguments))};function HOe(e,t){var n={},r=[],o=[];t.forEach(a);function a(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(a);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(c){c.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),r.push(l)}function u(l){return GOe(pne(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return r.forEach(function(l){if(!l._){var c=[],f=[l];for(l._=1,o.push(c);l=f.pop();)c.push(l),l.forEach(function(h){h.forEach(function(d){n[d<0?~d:d].forEach(function(p){p._||(p._=1,f.push(p))})})})}}),r.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:o.map(function(l){var c=[],f;if(l.forEach(function(y){y.forEach(function(v){v.forEach(function(w){n[w<0?~w:w].length<2&&c.push(w)})})}),c=kOe(e,c),(f=c.length)>1)for(var h=1,d=u(c[0]),p,g;h<f;++h)(p=u(c[h]))>d&&(g=c[0],c[0]=c[h],c[h]=g,d=p);return c})}}var qOe=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0;function a(h){h!=null&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},Point:function(h){u(h.coordinates)},MultiPoint:function(h){h.coordinates.forEach(u)},LineString:function(h){l(h.arcs)},MultiLineString:function(h){h.arcs.forEach(l)},Polygon:function(h){h.arcs.forEach(l)},MultiPolygon:function(h){h.arcs.forEach(c)}};function u(h){var d=h[0],p=h[1];d<t&&(t=d),d>r&&(r=d),p<n&&(n=p),p>o&&(o=p)}function l(h){h.forEach(u)}function c(h){h.forEach(l)}for(var f in e)a(e[f]);return r>=t&&o>=n?[t,n,r,o]:void 0},WOe=function(e,t,n,r,o){arguments.length===3&&(r=Array,o=null);for(var a=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,u=0;u<e;++u)a[u]=o;function l(h){for(var d=t(h)&s,p=a[d],g=0;p!=o;){if(n(p,h))return!0;if(++g>=e)throw new Error("full hashset");p=a[d=d+1&s]}return a[d]=h,!0}function c(h){for(var d=t(h)&s,p=a[d],g=0;p!=o;){if(n(p,h))return!0;if(++g>=e)break;p=a[d=d+1&s]}return!1}function f(){for(var h=[],d=0,p=a.length;d<p;++d){var g=a[d];g!=o&&h.push(g)}return h}return{add:l,has:c,values:f}},g4=function(e,t,n,r,o,a){arguments.length===3&&(r=a=Array,o=null);for(var s=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new a(e),l=e-1,c=0;c<e;++c)s[c]=o;function f(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v]=y;if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=g,u[v]=y,y}function h(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v];if(++C>=e)throw new Error("full hashmap");w=s[v=v+1&l]}return s[v]=g,u[v]=y,y}function d(g,y){for(var v=t(g)&l,w=s[v],C=0;w!=o;){if(n(w,g))return u[v];if(++C>=e)break;w=s[v=v+1&l]}return y}function p(){for(var g=[],y=0,v=s.length;y<v;++y){var w=s[y];w!=o&&g.push(w)}return g}return{set:f,maybeSet:h,get:d,keys:p}},hv=function(e,t){return e[0]===t[0]&&e[1]===t[1]},mne=new ArrayBuffer(16),Cee=new Float64Array(mne),pL=new Uint32Array(mne),Hz=function(e){Cee[0]=e[0],Cee[1]=e[1];var t=pL[0]^pL[1];return t=t<<5^t>>7^pL[2]^pL[3],t&2147483647},YOe=function(e){var t=e.coordinates,n=e.lines,r=e.rings,o=D(),a=new Int32Array(t.length),s=new Int32Array(t.length),u=new Int32Array(t.length),l=new Int8Array(t.length),c=0,f,h,d,p,g;for(f=0,h=t.length;f<h;++f)a[f]=s[f]=u[f]=-1;for(f=0,h=n.length;f<h;++f){var y=n[f],v=y[0],w=y[1];for(p=o[v],g=o[++v],++c,l[p]=1;++v<=w;)A(f,d=p,p=g,g=o[v]);++c,l[g]=1}for(f=0,h=t.length;f<h;++f)a[f]=-1;for(f=0,h=r.length;f<h;++f){var C=r[f],E=C[0]+1,S=C[1];for(d=o[S-1],p=o[E-1],g=o[E],A(f,d,p,g);++E<=S;)A(f,d=p,p=g,g=o[E])}function A(m,b,L,R){if(a[L]!==m){a[L]=m;var N=s[L];if(N>=0){var B=u[L];(N!==b||B!==R)&&(N!==R||B!==b)&&(++c,l[L]=1)}else s[L]=b,u[L]=R}}function D(){for(var m=g4(t.length*1.4,P,M,Int32Array,-1,Int32Array),b=new Int32Array(t.length),L=0,R=t.length;L<R;++L)b[L]=m.maybeSet(L,L);return b}function P(m){return Hz(t[m])}function M(m,b){return hv(t[m],t[b])}a=s=u=null;var I=WOe(c*1.4,Hz,hv),O;for(f=0,h=t.length;f<h;++f)l[O=o[f]]&&I.add(t[O]);return I},XOe=function(e){var t=YOe(e),n=e.coordinates,r=e.lines,o=e.rings,a,s,u;for(s=0,u=r.length;s<u;++s)for(var l=r[s],c=l[0],f=l[1];++c<f;)t.has(n[c])&&(a={0:c,1:l[1]},l[1]=c,l=l.next=a);for(s=0,u=o.length;s<u;++s)for(var h=o[s],d=h[0],p=d,g=h[1],y=t.has(n[d]);++p<g;)t.has(n[p])&&(y?(a={0:p,1:h[1]},h[1]=p,h=h.next=a):(jOe(n,d,g,g-p),n[g]=n[d],y=!0,p=d));return e};function jOe(e,t,n,r){Iz(e,t,n),Iz(e,t,t+r),Iz(e,t+r,n)}function Iz(e,t,n){for(var r=t+(n---t>>1),o;t<r;++t,--n)o=e[t],e[t]=e[n],e[n]=o}var KOe=function(e){var t=e.coordinates,n=e.lines,r,o=e.rings,a,s=n.length+o.length,u,l;for(delete e.lines,delete e.rings,u=0,l=n.length;u<l;++u)for(r=n[u];r=r.next;)++s;for(u=0,l=o.length;u<l;++u)for(a=o[u];a=a.next;)++s;var c=g4(s*2*1.4,Hz,hv),f=e.arcs=[];for(u=0,l=n.length;u<l;++u){r=n[u];do h(r);while(r=r.next)}for(u=0,l=o.length;u<l;++u)if(a=o[u],a.next)do h(a);while(a=a.next);else d(a);function h(C){var E,S,A,D,P,M,I,O;if(A=c.get(E=t[C[0]])){for(I=0,O=A.length;I<O;++I)if(D=A[I],p(D,C)){C[0]=D[0],C[1]=D[1];return}}if(P=c.get(S=t[C[1]])){for(I=0,O=P.length;I<O;++I)if(M=P[I],g(M,C)){C[1]=M[0],C[0]=M[1];return}}A?A.push(C):c.set(E,[C]),P?P.push(C):c.set(S,[C]),f.push(C)}function d(C){var E,S,A,D,P;if(S=c.get(E=t[C[0]]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}if(S=c.get(E=t[C[0]+w(C)]))for(D=0,P=S.length;D<P;++D){if(A=S[D],y(A,C)){C[0]=A[0],C[1]=A[1];return}if(v(A,C)){C[0]=A[1],C[1]=A[0];return}}S?S.push(C):c.set(E,[C]),f.push(C)}function p(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,++A)if(!hv(t[S],t[A]))return!1;return!0}function g(C,E){var S=C[0],A=E[0],D=C[1],P=E[1];if(S-D!==A-P)return!1;for(;S<=D;++S,--P)if(!hv(t[S],t[P]))return!1;return!0}function y(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var I=w(C),O=w(E),m=0;m<M;++m)if(!hv(t[S+(m+I)%M],t[A+(m+O)%M]))return!1;return!0}function v(C,E){var S=C[0],A=E[0],D=C[1],P=E[1],M=D-S;if(M!==P-A)return!1;for(var I=w(C),O=M-w(E),m=0;m<M;++m)if(!hv(t[S+(m+I)%M],t[P-(m+O)%M]))return!1;return!0}function w(C){for(var E=C[0],S=C[1],A=E,D=A,P=t[A];++A<S;){var M=t[A];(M[0]<P[0]||M[0]===P[0]&&M[1]<P[1])&&(D=A,P=M)}return D-E}return e},ZOe=function(e){for(var t=-1,n=e.length;++t<n;){for(var r=e[t],o=0,a=1,s=r.length,u=r[0],l=u[0],c=u[1],f,h;++o<s;)u=r[o],f=u[0],h=u[1],(f!==l||h!==c)&&(r[a++]=[f-l,h-c],l=f,c=h);a===1&&(r[a++]=[0,0]),r.length=a}return e},QOe=function(e){var t=-1,n=[],r=[],o=[];function a(h){h&&s.hasOwnProperty(h.type)&&s[h.type](h)}var s={GeometryCollection:function(h){h.geometries.forEach(a)},LineString:function(h){h.arcs=u(h.arcs)},MultiLineString:function(h){h.arcs=h.arcs.map(u)},Polygon:function(h){h.arcs=h.arcs.map(l)},MultiPolygon:function(h){h.arcs=h.arcs.map(c)}};function u(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var g={0:t-p+1,1:t};return n.push(g),g}function l(h){for(var d=0,p=h.length;d<p;++d)o[++t]=h[d];var g={0:t-p+1,1:t};return r.push(g),g}function c(h){return h.map(l)}for(var f in e)a(e[f]);return{type:"Topology",coordinates:o,lines:n,rings:r,objects:e}},JOe=function(e){var t={},n;for(n in e)t[n]=$Oe(e[n]);return t};function $Oe(e){return e==null?{type:null}:(e.type==="FeatureCollection"?eNe:e.type==="Feature"?gne:_4)(e)}function eNe(e){var t={type:"GeometryCollection",geometries:e.features.map(gne)};return e.bbox!=null&&(t.bbox=e.bbox),t}function gne(e){var t=_4(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function _4(e){if(e==null)return{type:null};var t=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map(_4)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(t.bbox=e.bbox),t}var tNe=function(e,t,n){var r=t[0],o=t[1],a=t[2],s=t[3],u=a-r?(n-1)/(a-r):1,l=s-o?(n-1)/(s-o):1;function c(w){return[Math.round((w[0]-r)*u),Math.round((w[1]-o)*l)]}function f(w,C){for(var E=-1,S=0,A=w.length,D=new Array(A),P,M,I,O,m;++E<A;)P=w[E],O=Math.round((P[0]-r)*u),m=Math.round((P[1]-o)*l),(O!==M||m!==I)&&(D[S++]=[M=O,I=m]);for(D.length=S;S<C;)S=D.push([D[0][0],D[0][1]]);return D}function h(w){return f(w,2)}function d(w){return f(w,4)}function p(w){return w.map(d)}function g(w){w!=null&&y.hasOwnProperty(w.type)&&y[w.type](w)}var y={GeometryCollection:function(w){w.geometries.forEach(g)},Point:function(w){w.coordinates=c(w.coordinates)},MultiPoint:function(w){w.coordinates=w.coordinates.map(c)},LineString:function(w){w.arcs=h(w.arcs)},MultiLineString:function(w){w.arcs=w.arcs.map(h)},Polygon:function(w){w.arcs=p(w.arcs)},MultiPolygon:function(w){w.arcs=w.arcs.map(p)}};for(var v in e)g(e[v]);return{scale:[1/u,1/l],translate:[r,o]}},nNe=function(e,t){var n=qOe(e=JOe(e)),r=t>0&&n&&tNe(e,n,t),o=KOe(XOe(QOe(e))),a=o.coordinates,s=g4(o.arcs.length*1.4,rNe,iNe);e=o.objects,o.bbox=n,o.arcs=o.arcs.map(function(d,p){return s.set(d,p),a.slice(d[0],d[1]+1)}),delete o.coordinates,a=null;function u(d){d&&l.hasOwnProperty(d.type)&&l[d.type](d)}var l={GeometryCollection:function(d){d.geometries.forEach(u)},LineString:function(d){d.arcs=c(d.arcs)},MultiLineString:function(d){d.arcs=d.arcs.map(c)},Polygon:function(d){d.arcs=d.arcs.map(c)},MultiPolygon:function(d){d.arcs=d.arcs.map(f)}};function c(d){var p=[];do{var g=s.get(d);p.push(d[0]<d[1]?g:~g)}while(d=d.next);return p}function f(d){return d.map(c)}for(var h in e)u(e[h]);return r&&(o.transform=r,o.arcs=ZOe(o.arcs)),o};function rNe(e){var t=e[0],n=e[1],r;return n<t&&(r=t,t=n,n=r),t+31*n}function iNe(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s;return r<n&&(s=n,n=r,r=s),a<o&&(s=o,o=a,a=s),n===o&&r===a}function oNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Fi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=vu(e));var r=[],o=p4(e,function(a,s){var u=aNe(a,s);return u||(r.push(a),s)});return o&&r.push(o),r.length?r.length===1?r[0]:p_(r.map(function(a){return a.coordinates})):null}function mL(e){return e[0].toString()+","+e[1].toString()}function aNe(e,t){var n=e.geometry.coordinates,r=t.geometry.coordinates,o=mL(n[0]),a=mL(n[n.length-1]),s=mL(r[0]),u=mL(r[r.length-1]),l;if(o===u)l=r.concat(n.slice(1));else if(s===a)l=n.concat(r.slice(1));else if(o===s)l=n.slice(1).reverse().concat(r);else if(a===u)l=n.concat(r.reverse().slice(1));else return null;return Bi(l)}function sNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Fi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=vu(e));var r=[];ba(e,function(a){r.push(a.geometry)});var o=nNe({geoms:u4(r).geometry});return UOe(o,o.objects.geoms.geometries)}function uNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(Fi(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=vu(e));var r=lNe(e);if(!r)throw new Error("geojson must be homogenous");switch(r){case"LineString":return oNe(e,t);case"Polygon":return sNe(e,t);default:throw new Error(r+" is not supported")}}function lNe(e){var t={};ba(e,function(r){t[r.geometry.type]=!0});var n=Object.keys(t);return n.length===1?n[0]:null}function cNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");if(!e)throw new Error("points is required");var n=t.maxEdge||1/0;if(!hi(n))throw new Error("maxEdge is invalid");var r=fNe(e),o=cne(r);if(o.features=o.features.filter(function(s){var u=s.geometry.coordinates[0][0],l=s.geometry.coordinates[0][1],c=s.geometry.coordinates[0][2],f=fi(u,l,t),h=fi(l,c,t),d=fi(u,c,t);return f<=n&&h<=n&&d<=n}),o.features.length<1)return null;var a=uNe(o,t);return a.coordinates.length===1&&(a.coordinates=a.coordinates[0],a.type="Polygon"),la(a)}function fNe(e){var t=[],n={};return di(e,function(r){if(!!r.geometry){var o=r.geometry.coordinates.join("-");n.hasOwnProperty(o)||(t.push(r),n[o]=!0)}}),Ft(t)}function hNe(e,t,n,r){var o=Ax(6),a=t.features.map(function(s){return{minX:s.geometry.coordinates[0],minY:s.geometry.coordinates[1],maxX:s.geometry.coordinates[0],maxY:s.geometry.coordinates[1],property:s.properties[n]}});return o.load(a),e.features.forEach(function(s){s.properties||(s.properties={});var u=Ia(s),l=o.search({minX:u[0],minY:u[1],maxX:u[2],maxY:u[3]}),c=[];l.forEach(function(f){xo([f.minX,f.minY],s)&&c.push(f.property)}),s.properties[r]=c}),e}function dNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.mutate;if(!e)throw new Error("geojson is required");return(n===!1||n===void 0)&&(e=vu(e)),Qa(e,function(r){var o=r[0],a=r[1];r[0]=a,r[1]=o}),e}function Eg(e,t){var n=typeof t=="object"?t.mutate:t;if(!e)throw new Error("geojson is required");var r=Fi(e),o=[];switch(r){case"LineString":o=Dz(e);break;case"MultiLineString":case"Polygon":Et(e).forEach(function(s){o.push(Dz(s))});break;case"MultiPolygon":Et(e).forEach(function(s){var u=[];s.forEach(function(l){u.push(Dz(l))}),o.push(u)});break;case"Point":return e;case"MultiPoint":var a={};Et(e).forEach(function(s){var u=s.join("-");a.hasOwnProperty(u)||(o.push(s),a[u]=!0)});break;default:throw new Error(r+" geometry not supported")}return e.coordinates?n===!0?(e.coordinates=o,e):{type:r,coordinates:o}:n===!0?(e.geometry.coordinates=o,e):la({type:r,coordinates:o},e.properties,e.bbox,e.id)}function Dz(e){var t=Et(e);if(t.length===2&&!pNe(t[0],t[1]))return t;var n,r,o,a=[],s=t.length-1;a.push(t[0]);for(var u=1;u<s;u++)n=t[u-1],r=t[u],o=t[u+1],mNe(n,o,r)||a.push(r);return a.push(o),a}function pNe(e,t){return e[0]===t[0]&&e[1]===t[1]}function mNe(e,t,n){var r=n[0],o=n[1],a=e[0],s=e[1],u=t[0],l=t[1],c=r-a,f=o-s,h=u-a,d=l-s,p=c*d-f*h;return p!==0?!1:Math.abs(h)>=Math.abs(d)?h>0?a<=r&&r<=u:u<=r&&r<=a:d>0?s<=o&&o<=l:l<=o&&o<=s}function gNe(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function _Ne(e,t,n){var r=t.x,o=t.y,a=n.x-r,s=n.y-o;if(a!==0||s!==0){var u=((e.x-r)*a+(e.y-o)*s)/(a*a+s*s);u>1?(r=n.x,o=n.y):u>0&&(r+=a*u,o+=s*u)}return a=e.x-r,s=e.y-o,a*a+s*s}function yNe(e,t){for(var n=e[0],r=[n],o,a=1,s=e.length;a<s;a++)o=e[a],gNe(o,n)>t&&(r.push(o),n=o);return n!==o&&r.push(o),r}function qz(e,t,n,r,o){for(var a=r,s,u=t+1;u<n;u++){var l=_Ne(e[u],e[t],e[n]);l>a&&(s=u,a=l)}a>r&&(s-t>1&&qz(e,t,s,r,o),o.push(e[s]),n-s>1&&qz(e,s,n,r,o))}function vNe(e,t){var n=e.length-1,r=[e[0]];return qz(e,0,n,t,r),r.push(e[n]),r}function Wz(e,t,n){if(e.length<=2)return e;var r=t!==void 0?t*t:1;return e=n?e:yNe(e,r),e=vNe(e,r),e}function CNe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.tolerance!==void 0?t.tolerance:1,r=t.highQuality||!1,o=t.mutate||!1;if(!e)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return o!==!0&&(e=vu(e)),Fh(e,function(a){xNe(a,n,r)}),e}function xNe(e,t,n){var r=e.type;if(r==="Point"||r==="MultiPoint")return e;Eg(e,!0);var o=e.coordinates;switch(r){case"LineString":e.coordinates=xee(o,t,n);break;case"MultiLineString":e.coordinates=o.map(function(a){return xee(a,t,n)});break;case"Polygon":e.coordinates=wee(o,t,n);break;case"MultiPolygon":e.coordinates=o.map(function(a){return wee(a,t,n)})}return e}function xee(e,t,n){return Wz(e.map(function(r){return{x:r[0],y:r[1],z:r[2]}}),t,n).map(function(r){return r.z?[r.x,r.y,r.z]:[r.x,r.y]})}function wee(e,t,n){return e.map(function(r){var o=r.map(function(s){return{x:s[0],y:s[1]}});if(o.length<4)throw new Error("invalid polygon");for(var a=Wz(o,t,n).map(function(s){return[s.x,s.y]});!wNe(a);)t-=t*.01,a=Wz(o,t,n).map(function(s){return[s.x,s.y]});return(a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),a})}function wNe(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var $L=function(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(var t=0;t<this.length-1;t++){var n=this.points[t],r=this.points[t+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var t=0;t<this.centers.length-1;t++){var n=this.centers[t],r=this.centers[t+1],o=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,a=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,s=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+s)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+a),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};$L.prototype.cacheSteps=function(e){var t=[],n=this.pos(0);t.push(0);for(var r=0;r<this.duration;r+=10){var o=this.pos(r),a=Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)+(o.z-n.z)*(o.z-n.z));a>e&&(t.push(r),n=o)}return t};$L.prototype.vector=function(e){var t=this.pos(e+10),n=this.pos(e-10);return{angle:180*Math.atan2(t.y-n.y,t.x-n.x)/3.14,speed:Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)+(n.z-t.z)*(n.z-t.z))}};$L.prototype.pos=function(e){function t(s,u,l,c,f){var h=function(g){var y=g*g,v=y*g;return[v,3*y*(1-g),3*g*(1-g)*(1-g),(1-g)*(1-g)*(1-g)]},d=h(s),p={x:f.x*d[0]+c.x*d[1]+l.x*d[2]+u.x*d[3],y:f.y*d[0]+c.y*d[1]+l.y*d[2]+u.y*d[3],z:f.z*d[0]+c.z*d[1]+l.z*d[2]+u.z*d[3]};return p}var n=e-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);var r=n/this.duration;if(r>=1)return this.points[this.length-1];var o=Math.floor((this.points.length-1)*r),a=(this.length-1)*r-o;return t(a,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])};function Eee(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.resolution||1e4,r=t.sharpness||.85;if(!e)throw new Error("line is required");if(!hi(n))throw new Error("resolution must be an number");if(!hi(r))throw new Error("sharpness must be an number");for(var o=[],a=new $L({points:$l(e).coordinates.map(function(l){return{x:l[0],y:l[1]}}),duration:n,sharpness:r}),s=0;s<a.duration;s+=10){var u=a.pos(s);Math.floor(s/100)%2===0&&o.push([u.x,u.y])}return Bi(o,e.properties)}function ENe(e,t,n,r){return e=vu(e),t=vu(t),di(e,function(o){o.properties||(o.properties={}),di(t,function(a){o.properties[r]===void 0&&xo(o,a)&&(o.properties[r]=a.properties[n])})}),e}function TNe(e,t){if(!e)throw new Error("featurecollection is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var n=Ft(SNe(e.features,t));return n}function SNe(e,t){for(var n=e.slice(0),r=e.length,o=r-t,a,s;r-- >o;)s=Math.floor((r+1)*Math.random()),a=n[s],n[s]=n[r],n[r]=a;return n.slice(o)}function y4(e){Zx(e);var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]),o=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[t,n],s=[t,o],u=[r,o],l=[r,n];return rr([[a,l,u,s,a]])}function _ne(e){return y4(Ia(e))}function yne(e){var t=e[0],n=e[1],r=e[2],o=e[3],a=fi(e.slice(0,2),[r,n]),s=fi(e.slice(0,2),[t,o]);if(a>=s){var u=(n+o)/2;return[t,u-(r-t)/2,r,u+(r-t)/2]}else{var l=(t+r)/2;return[l-(o-n)/2,n,l+(o-n)/2,o]}}function Jp(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.properties,s=co(e),u=Za(s[0]),l=Za(s[1]),c=Za(n),f=mv(t,o),h=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(c)),d=u+Math.atan2(Math.sin(c)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(h)),p=r_(d),g=r_(h);return Wr([p,g],a)}function v4(e,t,n){n=n||{};var r=n.steps||64,o=n.properties;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be a number");r=r||64,o=o||e.properties||{};for(var a=[],s=0;s<r;s++)a.push(Jp(e,t,s*-360/r,n).geometry.coordinates);return a.push(a[0]),rr([a],o)}function Kp(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.final;if(r===!0)return ANe(e,t);var o=co(e),a=co(t),s=Za(o[0]),u=Za(a[0]),l=Za(o[1]),c=Za(a[1]),f=Math.sin(u-s)*Math.cos(c),h=Math.cos(l)*Math.sin(c)-Math.sin(l)*Math.cos(c)*Math.cos(u-s);return r_(Math.atan2(f,h))}function ANe(e,t){var n=Kp(t,e);return n=(n+180)%360,n}function bNe(e,t){var n=fi(e,t),r=Kp(e,t),o=Jp(e,n/2,r);return o}function eR(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties;if(!e)throw new Error("geojson is required");var r=Ia(e),o=(r[0]+r[2])/2,a=(r[1]+r[3])/2;return Wr([o,a],n)}function _v(e,t){var n=0,r=0,o=0;return Qa(e,function(a){n+=a[0],r+=a[1],o++},!0),Wr([n/o,r/o],t)}function vne(e,t){switch(Fi(e)){case"Point":return e;case"Polygon":var n=[];Qa(e,function(S){n.push(S)});var r=_v(e,t),o=r.geometry.coordinates,a=0,s=0,u=0,l,c,f,h,d,p,g,y,v=n.map(function(S){return[S[0]-o[0],S[1]-o[1]]});for(l=0;l<n.length-1;l++)c=v[l],h=c[0],p=c[1],f=v[l+1],d=f[0],g=f[1],y=h*g-d*p,u+=y,a+=(h+d)*y,s+=(p+g)*y;if(u===0)return r;var w=u*.5,C=1/(6*w);return Wr([o[0]+C*a,o[1]+C*s],t);default:var E=lne(e);return E?vne(E,t):_v(e,t)}}function INe(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(t).reduce(function(o,a){return o[a.replace("Multi","")]=a,o},{});function r(o,a,s){s?t[a].coordinates=t[a].coordinates.concat(o.geometry.coordinates):t[a].coordinates.push(o.geometry.coordinates),t[a].properties.push(o.properties)}return di(e,function(o){!o.geometry||(t[o.geometry.type]?r(o,o.geometry.type,!0):n[o.geometry.type]&&r(o,n[o.geometry.type],!1))}),Ft(Object.keys(t).filter(function(o){return t[o].coordinates.length}).sort().map(function(o){var a={type:o,coordinates:t[o].coordinates},s={collectedProperties:t[o].properties};return la(a,s)}))}function C4(e){var t=[];return e.type==="FeatureCollection"?di(e,function(n){Qa(n,function(r){t.push(Wr(r,n.properties))})}):Qa(e,function(n){t.push(Wr(n,e.properties))}),Ft(t)}var Cne=tR,DNe=tR;function tR(e,t,n){n=n||2;var r=t&&t.length,o=r?t[0]*n:e.length,a=xne(e,0,o,n,!0),s=[];if(!a)return s;var u,l,c,f,h,d,p;if(r&&(a=ONe(e,t,a,n)),e.length>80*n){u=c=e[0],l=f=e[1];for(var g=n;g<o;g+=n)h=e[g],d=e[g+1],h<u&&(u=h),d<l&&(l=d),h>c&&(c=h),d>f&&(f=d);p=Math.max(c-u,f-l),p=p!==0?1/p:0}return uA(a,s,n,u,l,p),s}function xne(e,t,n,r,o){var a,s;if(o===jz(e,t,n,r)>0)for(a=t;a<n;a+=r)s=Tee(a,e[a],e[a+1],s);else for(a=n-r;a>=t;a-=r)s=Tee(a,e[a],e[a+1],s);return s&&dv(s,s.next)&&(cA(s),s=s.next),s}function sA(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(dv(n,n.next)||Ql(n.prev,n,n.next)===0)){if(cA(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function uA(e,t,n,r,o,a,s){if(!!e){!s&&a&&zNe(e,r,o,a);for(var u=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?MNe(e,r,o,a):PNe(e)){t.push(l.i/n),t.push(e.i/n),t.push(c.i/n),cA(e),e=c.next,u=c.next;continue}if(e=c,e===u){s?s===1?(e=LNe(e,t,n),uA(e,t,n,r,o,a,2)):s===2&&RNe(e,t,n,r,o,a):uA(sA(e),t,n,r,o,a,1);break}}}}function PNe(e){var t=e.prev,n=e,r=e.next;if(Ql(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(ML(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&Ql(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function MNe(e,t,n,r){var o=e.prev,a=e,s=e.next;if(Ql(o,a,s)>=0)return!1;for(var u=o.x<a.x?o.x<s.x?o.x:s.x:a.x<s.x?a.x:s.x,l=o.y<a.y?o.y<s.y?o.y:s.y:a.y<s.y?a.y:s.y,c=o.x>a.x?o.x>s.x?o.x:s.x:a.x>s.x?a.x:s.x,f=o.y>a.y?o.y>s.y?o.y:s.y:a.y>s.y?a.y:s.y,h=Yz(u,l,t,n,r),d=Yz(c,f,t,n,r),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&ML(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Ql(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&ML(o.x,o.y,a.x,a.y,s.x,s.y,p.x,p.y)&&Ql(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function LNe(e,t,n){var r=e;do{var o=r.prev,a=r.next.next;!dv(o,a)&&wne(o,r,r.next,a)&&lA(o,a)&&lA(a,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(a.i/n),cA(r),cA(r.next),r=e=a),r=r.next}while(r!==e);return r}function RNe(e,t,n,r,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&GNe(s,u)){var l=Ene(s,u);s=sA(s,s.next),l=sA(l,l.next),uA(s,t,n,r,o,a),uA(l,t,n,r,o,a);return}u=u.next}s=s.next}while(s!==e)}function ONe(e,t,n,r){var o=[],a,s,u,l,c;for(a=0,s=t.length;a<s;a++)u=t[a]*r,l=a<s-1?t[a+1]*r:e.length,c=xne(e,u,l,r,!1),c===c.next&&(c.steiner=!0),o.push(kNe(c));for(o.sort(NNe),a=0;a<o.length;a++)BNe(o[a],n),n=sA(n,n.next);return n}function NNe(e,t){return e.x-t.x}function BNe(e,t){if(t=FNe(e,t),t){var n=Ene(t,e);sA(n,n.next)}}function FNe(e,t){var n=t,r=e.x,o=e.y,a=-1/0,s;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var u=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>a){if(a=u,u===r){if(o===n.y)return n;if(o===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!s)return null;if(r===a)return s.prev;var l=s,c=s.x,f=s.y,h=1/0,d;for(n=s.next;n!==l;)r>=n.x&&n.x>=c&&r!==n.x&&ML(o<f?r:a,o,c,f,o<f?a:r,o,n.x,n.y)&&(d=Math.abs(o-n.y)/(r-n.x),(d<h||d===h&&n.x>s.x)&&lA(n,e)&&(s=n,h=d)),n=n.next;return s}function zNe(e,t,n,r){var o=e;do o.z===null&&(o.z=Yz(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,VNe(o)}function VNe(e){var t,n,r,o,a,s,u,l,c=1;do{for(n=e,e=null,a=null,s=0;n;){for(s++,r=n,u=0,t=0;t<c&&(u++,r=r.nextZ,!!r);t++);for(l=c;u>0||l>0&&r;)u!==0&&(l===0||!r||n.z<=r.z)?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,l--),a?a.nextZ=o:e=o,o.prevZ=a,a=o;n=r}a.nextZ=null,c*=2}while(s>1);return e}function Yz(e,t,n,r,o){return e=32767*(e-n)*o,t=32767*(t-r)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function kNe(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function ML(e,t,n,r,o,a,s,u){return(o-s)*(t-u)-(e-s)*(a-u)>=0&&(e-s)*(r-u)-(n-s)*(t-u)>=0&&(n-s)*(a-u)-(o-s)*(r-u)>=0}function GNe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!UNe(e,t)&&lA(e,t)&&lA(t,e)&&HNe(e,t)}function Ql(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function dv(e,t){return e.x===t.x&&e.y===t.y}function wne(e,t,n,r){return dv(e,t)&&dv(n,r)||dv(e,r)&&dv(n,t)?!0:Ql(e,t,n)>0!=Ql(e,t,r)>0&&Ql(n,r,e)>0!=Ql(n,r,t)>0}function UNe(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&wne(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function lA(e,t){return Ql(e.prev,e,e.next)<0?Ql(e,t,e.next)>=0&&Ql(e,e.prev,t)>=0:Ql(e,t,e.prev)<0||Ql(e,e.next,t)<0}function HNe(e,t){var n=e,r=!1,o=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function Ene(e,t){var n=new Xz(e.i,e.x,e.y),r=new Xz(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Tee(e,t,n,r){var o=new Xz(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function cA(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Xz(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}tR.deviation=function(e,t,n,r){var o=t&&t.length,a=o?t[0]*n:e.length,s=Math.abs(jz(e,0,a,n));if(o)for(var u=0,l=t.length;u<l;u++){var c=t[u]*n,f=u<l-1?t[u+1]*n:e.length;s-=Math.abs(jz(e,c,f,n))}var h=0;for(u=0;u<r.length;u+=3){var d=r[u]*n,p=r[u+1]*n,g=r[u+2]*n;h+=Math.abs((e[d]-e[g])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[g+1]-e[d+1]))}return s===0&&h===0?0:Math.abs((h-s)/s)};function jz(e,t,n,r){for(var o=0,a=t,s=n-r;a<n;a+=r)o+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return o}tR.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n};Cne.default=DNe;function qNe(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?t.features=See(e.geometry.coordinates):e.geometry.coordinates.forEach(function(n){t.features=t.features.concat(See(n))}),t}function See(e){var t=WNe(e),n=2,r=Cne(t.vertices,t.holes,n),o=[],a=[];r.forEach(function(l,c){var f=r[c];a.push([t.vertices[f*n],t.vertices[f*n+1]])});for(var s=0;s<a.length;s+=3){var u=a.slice(s,s+3);u.push(a[s]),o.push(rr([u]))}return o}function WNe(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var a=0;a<e[o].length;a++)for(var s=0;s<t;s++)n.vertices.push(e[o][a][s]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}function Kz(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var n,r=1/0;return di(t,function(o,a){var s=fi(e,o);s<r&&(n=vu(o),n.properties.featureIndex=a,n.properties.distanceToPoint=s,r=s)}),n}function YNe(e,t,n,r,o){Tne(e,t,n||0,r||e.length-1,o||XNe)}function Tne(e,t,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,s=t-n+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1),f=Math.max(n,Math.floor(t-s*l/a+c)),h=Math.min(r,Math.floor(t+(a-s)*l/a+c));Tne(e,t,f,h,o)}var d=e[t],p=n,g=r;for(WS(e,n,t),o(e[r],d)>0&&WS(e,n,r);p<g;){for(WS(e,p,g),p++,g--;o(e[p],d)<0;)p++;for(;o(e[g],d)>0;)g--}o(e[n],d)===0?WS(e,n,g):(g++,WS(e,g,r)),g<=t&&(n=g+1),t<=g&&(r=g-1)}}function WS(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function XNe(e,t){return e<t?-1:e>t?1:0}function hf(e,t){if(!(this instanceof hf))return new hf(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}hf.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!_L(e,t))return n;for(var o=[],a,s,u,l;t;){for(a=0,s=t.children.length;a<s;a++)u=t.children[a],l=t.leaf?r(u):u,_L(e,l)&&(t.leaf?n.push(u):Mz(e,l)?this._all(u,n):o.push(u));t=o.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!_L(e,t))return!1;for(var r=[],o,a,s,u;t;){for(o=0,a=t.children.length;o<a;o++)if(s=t.children[o],u=t.leaf?n(s):s,_L(e,u)){if(t.leaf||Mz(e,u))return!0;r.push(s)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=yx([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),o=[],a=[],s,u,l,c;n||o.length;){if(n||(n=o.pop(),u=o[o.length-1],s=a.pop(),c=!0),n.leaf&&(l=jNe(e,n.children,t),l!==-1))return n.children.splice(l,1),o.push(n),this._condense(o),this;!c&&!n.leaf&&Mz(n,r)?(o.push(n),a.push(s),s=0,u=n,n=n.children[0]):u?(s++,n=u.children[s],c=!1):n=null}return this},toBBox:function(e){return e},compareMinX:Aee,compareMinY:bee,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o=n-t+1,a=this._maxEntries,s;if(o<=a)return s=yx(e.slice(t,n+1)),gx(s,this.toBBox),s;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),s=yx([]),s.leaf=!1,s.height=r;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a)),c,f,h,d;for(Iee(e,t,n,l,this.compareMinX),c=t;c<=n;c+=l)for(h=Math.min(c+l-1,n),Iee(e,c,h,u,this.compareMinY),f=c;f<=h;f+=u)d=Math.min(f+u-1,h),s.children.push(this._build(e,f,d,r-1));return gx(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var o,a,s,u,l,c,f,h;r.push(t),!(t.leaf||r.length-1===n);){for(f=h=1/0,o=0,a=t.children.length;o<a;o++)s=t.children[o],l=Pz(s),c=KNe(e,s)-l,c<h?(h=c,f=l<f?l:f,u=s):c===h&&l<f&&(f=l,u=s);t=u||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),a=[],s=this._chooseSubtree(o,this.data,t,a);for(s.children.push(e),$S(s,o);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(o,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var a=this._chooseSplitIndex(n,o,r),s=yx(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,gx(n,this.toBBox),gx(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=yx([e,t]),this.data.height=e.height+1,this.data.leaf=!1,gx(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,a,s,u,l,c,f;for(l=c=1/0,r=t;r<=n-t;r++)o=JS(e,0,r,this.toBBox),a=JS(e,r,n,this.toBBox),s=ZNe(o,a),u=Pz(o)+Pz(a),s<l?(l=s,f=r,c=u<c?u:c):s===l&&u<c&&(c=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:Aee,o=e.leaf?this.compareMinY:bee,a=this._allDistMargin(e,t,n,r),s=this._allDistMargin(e,t,n,o);a<s&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o=this.toBBox,a=JS(e,0,t,o),s=JS(e,n-t,n,o),u=gL(a)+gL(s),l,c;for(l=t;l<n-t;l++)c=e.children[l],$S(a,e.leaf?o(c):c),u+=gL(a);for(l=n-t-1;l>=t;l--)c=e.children[l],$S(s,e.leaf?o(c):c),u+=gL(s);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)$S(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():gx(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function jNe(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function gx(e,t){JS(e,0,e.children.length,t,e)}function JS(e,t,n,r,o){o||(o=yx(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var a=t,s;a<n;a++)s=e.children[a],$S(o,e.leaf?r(s):s);return o}function $S(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Aee(e,t){return e.minX-t.minX}function bee(e,t){return e.minY-t.minY}function Pz(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function gL(e){return e.maxX-e.minX+(e.maxY-e.minY)}function KNe(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function ZNe(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,a-r)}function Mz(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function _L(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function yx(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Iee(e,t,n,r,o){for(var a=[t,n],s;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(s=t+Math.ceil((n-t)/r/2)*r,YNe(e,s,t,n,o),a.push(t,s,s,n))}function LA(e){var t=hf(e);return t.insert=function(n){if(Array.isArray(n)){var r=n;n=Lz(r),n.bbox=r}else n.bbox=n.bbox?n.bbox:Rz(n);return hf.prototype.insert.call(this,n)},t.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(o){var a=Lz(o);a.bbox=o,r.push(a)}):di(n,function(o){o.bbox=o.bbox?o.bbox:Rz(o),r.push(o)}),hf.prototype.load.call(this,r)},t.remove=function(n){if(Array.isArray(n)){var r=n;n=Lz(r),n.bbox=r}return hf.prototype.remove.call(this,n)},t.clear=function(){return hf.prototype.clear.call(this)},t.search=function(n){var r=hf.prototype.search.call(this,this.toBBox(n));return{type:"FeatureCollection",features:r}},t.collides=function(n){return hf.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=hf.prototype.all.call(this);return{type:"FeatureCollection",features:n}},t.toJSON=function(){return hf.prototype.toJSON.call(this)},t.fromJSON=function(n){return hf.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var r;return n.bbox?r=n.bbox:Array.isArray(n)&&n.length===4?r=n:r=Rz(n),{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},t}function Lz(e){var t=[e[0],e[1]],n=[e[0],e[3]],r=[e[2],e[3]],o=[e[2],e[1]],a=[[t,o,r,n,t]];return{type:"Feature",bbox:e,properties:{},geometry:{type:"Polygon",coordinates:a}}}function Rz(e){var t=[1/0,1/0,-1/0,-1/0];return Qa(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function yv(e){if(!e)throw new Error("geojson is required");var t=[];return ba(e,function(n){QNe(n,t)}),Ft(t)}function QNe(e,t){var n=[],r=e.geometry;switch(r.type){case"Polygon":n=Et(r);break;case"LineString":n=[Et(r)]}n.forEach(function(o){var a=JNe(o,e.properties);a.forEach(function(s){s.id=t.length,t.push(s)})})}function JNe(e,t){var n=[];return e.reduce(function(r,o){var a=Bi([r,o],t);return a.bbox=$Ne(r,o),n.push(a),o}),n}function $Ne(e,t){var n=e[0],r=e[1],o=t[0],a=t[1],s=n<o?n:o,u=r<a?r:a,l=n>o?n:o,c=r>a?r:a;return[s,u,l,c]}function Og(e,t){var n={},r=[];if(e.type==="LineString"&&(e=la(e)),t.type==="LineString"&&(t=la(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var o=Dee(e,t);return o&&r.push(o),Ft(r)}var a=LA();return a.load(yv(t)),di(yv(e),function(s){di(a.search(s),function(u){var l=Dee(s,u);if(l){var c=Et(l).join(",");n[c]||(n[c]=!0,r.push(l))}})}),Ft(r)}function Dee(e,t){var n=Et(e),r=Et(t);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],u=n[1][1],l=r[0][0],c=r[0][1],f=r[1][0],h=r[1][1],d=(h-c)*(s-o)-(f-l)*(u-a),p=(f-l)*(a-c)-(h-c)*(o-l),g=(s-o)*(a-c)-(u-a)*(o-l);if(d===0)return p===0&&g===0,null;var y=p/d,v=g/d;if(y>=0&&y<=1&&v>=0&&v<=1){var w=o+y*(s-o),C=a+y*(u-a);return Wr([w,C])}return null}function vg(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=e.geometry?e.geometry.type:e.type;if(r!=="LineString"&&r!=="MultiLineString")throw new Error("lines must be LineString or MultiLineString");var o=Wr([1/0,1/0],{dist:1/0}),a=0;return ba(e,function(s){for(var u=Et(s),l=0;l<u.length-1;l++){var c=Wr(u[l]);c.properties.dist=fi(t,c,n);var f=Wr(u[l+1]);f.properties.dist=fi(t,f,n);var h=fi(c,f,n),d=Math.max(c.properties.dist,f.properties.dist),p=Kp(c,f),g=Jp(t,d,p+90,n),y=Jp(t,d,p-90,n),v=Og(Bi([g.geometry.coordinates,y.geometry.coordinates]),Bi([c.geometry.coordinates,f.geometry.coordinates])),w=null;v.features.length>0&&(w=v.features[0],w.properties.dist=fi(t,w,n),w.properties.location=a+fi(c,w,n)),c.properties.dist<o.properties.dist&&(o=c,o.properties.index=l,o.properties.location=a),f.properties.dist<o.properties.dist&&(o=f,o.properties.index=l+1,o.properties.location=a+h),w&&w.properties.dist<o.properties.dist&&(o=w,o.properties.index=l),a+=h}}),o}function $0(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.final;if(!e)throw new Error("start point is required");if(!t)throw new Error("end point is required");var o;r?o=Pee(co(t),co(e)):o=Pee(co(e),co(t));var a=o>180?-(360-o):o;return a}function Pee(e,t){var n=Za(e[1]),r=Za(t[1]),o=Za(t[0]-e[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),s=Math.atan2(o,a);return(r_(s)+360)%360}function nR(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("from point is required");if(!t)throw new Error("to point is required");var o=co(e),a=co(t);a[0]+=a[0]-o[0]>180?-360:o[0]-a[0]>180?360:0;var s=e2e(o,a),u=gv(s,"meters",r);return u}function e2e(e,t,n){n=n===void 0?gs:Number(n);var r=n,o=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-o,u=Math.abs(t[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var l=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(l)>1e-11?s/l:Math.cos(o),f=Math.sqrt(s*s+c*c*u*u),h=f*r;return h}function e_(e,t){return Sne(e,"mercator",t)}function rR(e,t){return Sne(e,"wgs84",t)}function Sne(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&hi(e[0])?e=t==="mercator"?Mee(e):Lee(e):(r!==!0&&(e=vu(e)),Qa(e,function(o){var a=t==="mercator"?Mee(o):Lee(o);o[0]=a[0],o[1]=a[1]})),e}function Mee(e){var t=Math.PI/180,n=6378137,r=20037508342789244e-9,o=Math.abs(e[0])<=180?e[0]:e[0]-t2e(e[0])*360,a=[n*o*t,n*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return a[0]>r&&(a[0]=r),a[0]<-r&&(a[0]=-r),a[1]>r&&(a[1]=r),a[1]<-r&&(a[1]=-r),a}function Lee(e){var t=180/Math.PI,n=6378137;return[e[0]*t/n,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/n)))*t]}function t2e(e){return e<0?-1:e>0?1:0}var n2e=Object.freeze({toMercator:e_,toWgs84:rR});function Ane(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");if(!e)throw new Error("pt is required");if(Array.isArray(e)?e=Wr(e):e.type==="Point"?e=la(e):oA(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=Bi(t):t.type==="LineString"?t=la(t):oA(t,"LineString","line");var r=1/0,o=e.geometry.coordinates;return yg(t,function(a){var s=a.geometry.coordinates[0],u=a.geometry.coordinates[1],l=r2e(o,s,u,n);r>l&&(r=l)}),r}function r2e(e,t,n,r){var o=r.mercator,a=o!==!0?fi(t,e,r):Ree(t,e,r),s=J0(o!==!0?Kp(t,e):$0(t,e)),u=J0(o!==!0?Kp(t,n):$0(t,n)),l=Math.abs(s-u);if(l>90)return a;var c=(u+180)%360,f=J0(o!==!0?Kp(n,e):$0(n,e)),h=Math.abs(f-c);return h>180&&(h=Math.abs(h-360)),h>90?o!==!0?fi(e,n,r):Ree(e,n,r):o!==!0?a*Math.sin(Za(l)):i2e(t,n,e,r)}function i2e(e,t,n,r){var o=0;(Math.abs(e[0])>=180||Math.abs(t[0])>=180||Math.abs(n[0])>=180)&&(o=e[0]>0||t[0]>0||n[0]>0?-180:180);var a=Wr(n),s=e_([e[0]+o,e[1]]),u=e_([t[0]+o,t[1]]),l=e_([n[0]+o,n[1]]),c=rR(o2e(s,u,l));o!==0&&(c[0]-=o);var f=nR(a,c,r);return f}function o2e(e,t,n){var r=e[0],o=e[1],a=t[0],s=t[1],u=n[0],l=n[1],c=a-r,f=s-o,h=c*c+f*f,d=((u-r)*c+(l-o)*f)/h,p=r+d*c,g=o+d*f;return[p,g]}function Ree(e,t,n){var r=n.units,o=0;Math.abs(e[0])>=180&&(o=e[0]>0?-180:180),Math.abs(t[0])>=180&&(o=t[0]>0?-180:180);var a=e_([e[0]+o,e[1]]),s=e_([t[0]+o,t[1]]),u=function(f){return f*f},l=u(a[0]-s[0])+u(a[1]-s[1]),c=Math.sqrt(l);return gv(c,"meters",r)}function a2e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=n.properties||{};if(!e)throw new Error("points is required");if(e=s2e(e),!e.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(Fi(t)!=="LineString")throw new Error("line must be a LineString");var a=1/0,s=null;return di(e,function(u){var l=Ane(u,t,{units:r});l<a&&(a=l,s=u)}),s&&(s.properties=Object.assign({dist:a},s.properties,o)),s}function s2e(e){var t=[],n=e.geometry?e.geometry.type:e.type;switch(n){case"GeometryCollection":return Fh(e,function(r){r.type==="Point"&&t.push({type:"Feature",properties:{},geometry:r})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(r){return r.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}function u2e(e,t){var n=co(e),r=$l(t),o=r.coordinates,a=o[0];if(a.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var s=t.properties||{},u=s.a,l=s.b,c=s.c,f=n[0],h=n[1],d=a[0][0],p=a[0][1],g=u!==void 0?u:a[0][2],y=a[1][0],v=a[1][1],w=l!==void 0?l:a[1][2],C=a[2][0],E=a[2][1],S=c!==void 0?c:a[2][2],A=(S*(f-d)*(h-v)+g*(f-y)*(h-E)+w*(f-C)*(h-p)-w*(f-d)*(h-E)-S*(f-y)*(h-p)-g*(f-C)*(h-v))/((f-d)*(h-v)+(f-y)*(h-E)+(f-C)*(h-p)-(f-d)*(h-E)-(f-y)*(h-p)-(f-C)*(h-v));return A}function l2e(e){var t,n,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?n=e.geometry:n=e,n.type==="LineString")t=[n.coordinates];else if(n.type==="MultiLineString")t=n.coordinates;else if(n.type==="MultiPolygon")t=[].concat.apply([],n.coordinates);else if(n.type==="Polygon")t=n.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(o){t.forEach(function(a){for(var s=0;s<o.length-1;s++)for(var u=s;u<a.length-1;u++)if(!(o===a&&(Math.abs(s-u)===1||s===0&&u===o.length-2&&o[s][0]===o[o.length-1][0]&&o[s][1]===o[o.length-1][1]))){var l=c2e(o[s][0],o[s][1],o[s+1][0],o[s+1][1],a[u][0],a[u][1],a[u+1][0],a[u+1][1]);l&&r.features.push(Wr([l[0],l[1]]))}})}),r}function c2e(e,t,n,r,o,a,s,u){var l,c,f,h,d,p={x:null,y:null,onLine1:!1,onLine2:!1};return l=(u-a)*(n-e)-(s-o)*(r-t),l===0?p.x!==null&&p.y!==null?p:!1:(c=t-a,f=e-o,h=(s-o)*c-(u-a)*f,d=(n-e)*c-(r-t)*f,c=h/l,f=d/l,p.x=e+c*(n-e),p.y=t+c*(r-t),c>=0&&c<=1&&(p.onLine1=!0),f>=0&&f<=1&&(p.onLine2=!0),p.onLine1&&p.onLine2?[p.x,p.y]:!1)}function Oee(e){for(var t=f2e(e),n=eR(t),r=!1,o=0;!r&&o<t.features.length;){var a=t.features[o].geometry,s,u,l,c,f,h,d,p=!1;if(a.type==="Point")n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if(a.type==="MultiPoint"){var g=!1;for(d=0;!g&&d<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[d][0]&&n.geometry.coordinates[1]===a.coordinates[d][1]&&(r=!0,g=!0),d++}else if(a.type==="LineString")for(d=0;!p&&d<a.coordinates.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=a.coordinates[d][0],c=a.coordinates[d][1],f=a.coordinates[d+1][0],h=a.coordinates[d+1][1],Nee(s,u,l,c,f,h)&&(p=!0,r=!0),d++;else if(a.type==="MultiLineString")for(var y=0;y<a.coordinates.length;){p=!1,d=0;for(var v=a.coordinates[y];!p&&d<v.length-1;)s=n.geometry.coordinates[0],u=n.geometry.coordinates[1],l=v[d][0],c=v[d][1],f=v[d+1][0],h=v[d+1][1],Nee(s,u,l,c,f,h)&&(p=!0,r=!0),d++;y++}else(a.type==="Polygon"||a.type==="MultiPolygon")&&xo(n,a)&&(r=!0);o++}if(r)return n;var w=Ft([]);for(o=0;o<t.features.length;o++)w.features=w.features.concat(C4(t.features[o]).features);return Wr(Kz(n,w).geometry.coordinates)}function f2e(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?Ft([la(e)]):Ft([e]):e}function Nee(e,t,n,r,o,a){var s=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r)),l=Math.sqrt((o-e)*(o-e)+(a-t)*(a-t));return s===u+l}function fA(e){return f4(e,function(t,n){return t+bne(n)},0)}var Bee=6378137;function bne(e){var t=0,n;switch(e.type){case"Polygon":return Fee(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=Fee(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)t+=bne(e.geometries[n]);return t}}function Fee(e){var t=0;if(e&&e.length>0){t+=Math.abs(zee(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(zee(e[n]))}return t}function zee(e){var t,n,r,o,a,s,u,l=0,c=e.length;if(c>2){for(u=0;u<c;u++)u===c-2?(o=c-2,a=c-1,s=0):u===c-1?(o=c-1,a=0,s=1):(o=u,a=u+1,s=u+2),t=e[o],n=e[a],r=e[s],l+=(Oz(r[0])-Oz(t[0]))*Math.sin(Oz(n[1]));l=l*Bee*Bee/2}return l}function Oz(e){return e*Math.PI/180}function h2e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r;if(e.type==="Feature")r=e.geometry.coordinates;else if(e.type==="LineString")r=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");if(!hi(t))throw new Error("distance must be a number");for(var o=0,a=0;a<r.length&&!(t>=o&&a===r.length-1);a++)if(o>=t){var s=t-o;if(s){var u=Kp(r[a],r[a-1])-180,l=Jp(r[a],s,u,n);return l}else return Wr(r[a])}else o+=fi(r[a],r[a+1],n);return Wr(r[r.length-1])}function Zz(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");if(!e)throw new Error("geojson is required");return h4(e,function(n,r){var o=r.geometry.coordinates;return n+fi(o[0],o[1],t)},0)}function d2e(e,t,n){var r=Et(n);if(Fi(n)!=="LineString")throw new Error("line must be a LineString");var o=vg(n,e),a=vg(n,t),s;o.properties.index<=a.properties.index?s=[o,a]:s=[a,o];for(var u=[s[0].geometry.coordinates],l=s[0].properties.index+1;l<s[1].properties.index+1;l++)u.push(r[l]);return u.push(s[1].geometry.coordinates),Bi(u,n.properties)}function Ine(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o,a=[];if(e.type==="Feature")o=e.geometry.coordinates;else if(e.type==="LineString")o=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=0,u,l,c,f=0;f<o.length&&!(t>=s&&f===o.length-1);f++){if(s>t&&a.length===0){if(u=t-s,!u)return a.push(o[f]),Bi(a);l=Kp(o[f],o[f-1])-180,c=Jp(o[f],u,l,r),a.push(c.geometry.coordinates)}if(s>=n)return u=n-s,u?(l=Kp(o[f],o[f-1])-180,c=Jp(o[f],u,l,r),a.push(c.geometry.coordinates),Bi(a)):(a.push(o[f]),Bi(a));if(s>=t&&a.push(o[f]),f===o.length-1)return Bi(a);s+=fi(o[f],o[f+1],r)}return Bi(o[o.length-1])}function Ac(e,t,n){n=n||{};var r=n.ignoreEndVertices;if(!gt(n))throw new Error("invalid options");if(!e)throw new Error("pt is required");if(!t)throw new Error("line is required");for(var o=co(e),a=Et(t),s=0;s<a.length-1;s++){var u=!1;if(r&&(s===0&&(u="start"),s===a.length-2&&(u="end"),s===0&&s+1===a.length-1&&(u="both")),p2e(a[s],a[s+1],o,u))return!0}return!1}function p2e(e,t,n,r){var o=n[0],a=n[1],s=e[0],u=e[1],l=t[0],c=t[1],f=n[0]-s,h=n[1]-u,d=l-s,p=c-u,g=f*p-h*d;if(g!==0)return!1;if(r){if(r==="start")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<=l:l<=o&&o<s:p>0?u<a&&a<=c:c<=a&&a<u;if(r==="end")return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<l:l<o&&o<=s:p>0?u<=a&&a<c:c<a&&a<=u;if(r==="both")return Math.abs(d)>=Math.abs(p)?d>0?s<o&&o<l:l<o&&o<s:p>0?u<a&&a<c:c<a&&a<u}else return Math.abs(d)>=Math.abs(p)?d>0?s<=o&&o<=l:l<=o&&o<=s:p>0?u<=a&&a<=c:c<=a&&a<=u}function Dne(e,t){var n=Fi(e),r=Fi(t),o=$l(e),a=$l(t);switch(n){case"Point":switch(r){case"MultiPoint":return m2e(o,a);case"LineString":return Ac(o,a,{ignoreEndVertices:!0});case"Polygon":return xo(o,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"MultiPoint":return g2e(o,a);case"LineString":return _2e(o,a);case"Polygon":return y2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"LineString":return v2e(o,a);case"Polygon":return C2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Polygon":return x2e(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function m2e(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(Mne(t.coordinates[n],e.coordinates)){r=!0;break}return r}function g2e(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,o=0;o<t.coordinates.length;o++)Mne(e.coordinates[n],t.coordinates[o])&&(r=!0);if(!r)return!1}return!0}function _2e(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!Ac(e.coordinates[r],t))return!1;n||(n=Ac(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}function y2e(e,t){for(var n=!0,r=!1,o=0;o<e.coordinates.length;o++){var a=xo(e.coordinates[1],t);if(!a){n=!1;break}r||(a=xo(e.coordinates[1],t,{ignoreBoundary:!0}))}return n&&a}function v2e(e,t){for(var n=0;n<e.coordinates.length;n++)if(!Ac(e.coordinates[n],t))return!1;return!0}function C2e(e,t){var n=Ia(t),r=Ia(e);if(!Pne(n,r))return!1;for(var o=!1,a=0;a<e.coordinates.length-1;a++){if(!xo(e.coordinates[a],t))return!1;if(o||(o=xo(e.coordinates[a],t,{ignoreBoundary:!0})),!o){var s=w2e(e.coordinates[a],e.coordinates[a+1]);o=xo(s,t,{ignoreBoundary:!0})}}return o}function x2e(e,t){var n=Ia(e),r=Ia(t);if(!Pne(r,n))return!1;for(var o=0;o<e.coordinates[0].length;o++)if(!xo(e.coordinates[0][o],t))return!1;return!0}function Pne(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function Mne(e,t){return e[0]===t[0]&&e[1]===t[1]}function w2e(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function Lne(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.mask,o=n.properties,a=[];if(t==null)throw new Error("cellSide is required");if(!hi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(r&&["Polygon","MultiPolygon"].indexOf(Fi(r))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/fi([s,u],[l,u],n),h=f*(l-s),d=t/fi([s,u],[s,c],n),p=d*(c-u),g=l-s,y=c-u,v=Math.floor(g/h),w=Math.floor(y/p),C=(g-v*h)/2,E=(y-w*p)/2,S=s+C;S<=l;){for(var A=u+E;A<=c;){var D=Wr([S,A],o);r?Dne(D,r)&&a.push(D):a.push(D),A+=p}S+=h}return Ft(a)}function vx(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.precision,r=t.coordinates,o=t.mutate;if(n=n==null||isNaN(n)?6:n,r=r==null||isNaN(r)?3:r,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(o===!1||o===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,n);return Qa(e,function(s){E2e(s,a,r)}),e}function E2e(e,t,n){e.length>n&&e.splice(n,e.length);for(var r=0;r<e.length;r++)e[r]=Math.round(e[r]*t)/t;return e}function T2e(e){if(!e)throw new Error("geojson is required");var t=[];return ba(e,function(n){t.push(n)}),Ft(t)}function S2e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units,o=n.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var a=[];return ba(e,function(s){o&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),A2e(s,t,r,function(u){a.push(u)})}),Ft(a)}function A2e(e,t,n,r){var o=Zz(e,{units:n});if(o<=t)return r(e);var a=o/t;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var u=Ine(e,t*s,t*(s+1),{units:n});r(u,s)}}var b2e=function(e,t,n){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");n===void 0&&(n=1);var r=e.geometry.coordinates,o=[],a={};if(n){for(var s=[],u=0;u<r.length;u++)for(var l=0;l<r[u].length-1;l++)s.push(v(u,l));var c=Ax();c.load(s)}for(var f=0;f<r.length;f++)for(var h=0;h<r[f].length-1;h++)if(n){var d=c.search(v(f,h));d.forEach(function(w){var C=w.ring,E=w.edge;y(f,h,C,E)})}else for(var p=0;p<r.length;p++)for(var g=0;g<r[p].length-1;g++)y(f,h,p,g);return t||(o={type:"Feature",geometry:{type:"MultiPoint",coordinates:o}}),o;function y(w,C,E,S){var A=r[w][C],D=r[w][C+1],P=r[E][S],M=r[E][S+1],I=I2e(A,D,P,M);if(I!==null){var O,m;if(D[0]!==A[0]?O=(I[0]-A[0])/(D[0]-A[0]):O=(I[1]-A[1])/(D[1]-A[1]),M[0]!==P[0]?m=(I[0]-P[0])/(M[0]-P[0]):m=(I[1]-P[1])/(M[1]-P[1]),!(O>=1||O<=0||m>=1||m<=0)){var b=I,L=!a[b];L&&(a[b]=!0),t?o.push(t(I,w,C,A,D,O,E,S,P,M,m,L)):o.push(I)}}}function v(w,C){var E=r[w][C],S=r[w][C+1],A,D,P,M;return E[0]<S[0]?(A=E[0],D=S[0]):(A=S[0],D=E[0]),E[1]<S[1]?(P=E[1],M=S[1]):(P=S[1],M=E[1]),{minX:A,minY:P,maxX:D,maxY:M,ring:w,edge:C}}};function I2e(e,t,n,r){if(eA(e,n)||eA(e,r)||eA(t,n)||eA(r,n))return null;var o=e[0],a=e[1],s=t[0],u=t[1],l=n[0],c=n[1],f=r[0],h=r[1],d=(o-s)*(c-h)-(a-u)*(l-f);if(d===0)return null;var p=((o*u-a*s)*(l-f)-(o-s)*(l*h-c*f))/d,g=((o*u-a*s)*(c-h)-(a-u)*(l*h-c*f))/d;return[p,g]}function eA(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!eA(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}var D2e=function(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,n=[],C=0;C<t;C++){var r=e.geometry.coordinates[C];tA(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!M2e(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,a=b2e(e,function(pe,me,st,ht,jt,Ct,bt,mn,Tn,zi,at,Sn){return[pe,me,st,ht,jt,Ct,bt,mn,Tn,zi,at,Sn]}),s=a.length;if(s==0){for(var P=[],C=0;C<t;C++)P.push(rr([e.geometry.coordinates[C]],{parent:-1,winding:P2e(e.geometry.coordinates[C])}));var k=Ft(P);return Z(),te(),k}for(var u=[],l=[],C=0;C<t;C++){u.push([]);for(var c=0;c<e.geometry.coordinates[C].length-1;c++)u[C].push([new Vee(e.geometry.coordinates[C][(c+1).modulo(e.geometry.coordinates[C].length-1)],1,[C,c],[C,(c+1).modulo(e.geometry.coordinates[C].length-1)],void 0)]),l.push(new kee(e.geometry.coordinates[C][c],[C,(c-1).modulo(e.geometry.coordinates[C].length-1)],[C,c],void 0,void 0,!1,!0))}for(var C=0;C<s;C++)u[a[C][1]][a[C][2]].push(new Vee(a[C][0],a[C][5],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0)),a[C][11]&&l.push(new kee(a[C][0],[a[C][1],a[C][2]],[a[C][6],a[C][7]],void 0,void 0,!0,!0));for(var f=l.length,C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)u[C][c].sort(function(me,st){return me.param<st.param?-1:1});for(var h=[],C=0;C<f;C++)h.push({minX:l[C].coord[0],minY:l[C].coord[1],maxX:l[C].coord[0],maxY:l[C].coord[1],index:C});var d=Ax();d.load(h);for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var g;p==u[C][c].length-1?g=u[C][(c+1).modulo(e.geometry.coordinates[C].length-1)][0].coord:g=u[C][c][p+1].coord;var y=d.search({minX:g[0],minY:g[1],maxX:g[0],maxY:g[1]})[0];u[C][c][p].nxtIsectAlongEdgeIn=y.index}for(var C=0;C<u.length;C++)for(var c=0;c<u[C].length;c++)for(var p=0;p<u[C][c].length;p++){var g=u[C][c][p].coord,y=d.search({minX:g[0],minY:g[1],maxX:g[0],maxY:g[1]})[0],v=y.index;v<o?l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn:tA(l[v].ringAndEdge1,u[C][c][p].ringAndEdgeIn)?l[v].nxtIsectAlongRingAndEdge1=u[C][c][p].nxtIsectAlongEdgeIn:l[v].nxtIsectAlongRingAndEdge2=u[C][c][p].nxtIsectAlongEdgeIn}for(var w=[],C=0,c=0;c<t;c++){for(var E=C,p=0;p<e.geometry.coordinates[c].length-1;p++)l[C].coord[0]<l[E].coord[0]&&(E=C),C++;for(var S=l[E].nxtIsectAlongRingAndEdge2,p=0;p<l.length;p++)if(l[p].nxtIsectAlongRingAndEdge1==E||l[p].nxtIsectAlongRingAndEdge2==E){var A=p;break}var D=TL([l[A].coord,l[E].coord,l[S].coord],!0)?1:-1;w.push({isect:E,parent:-1,winding:D})}w.sort(function(ue,pe){return l[ue.isect].coord>l[pe.isect].coord?-1:1});for(var P=[];w.length>0;){var M=w.pop(),I=M.isect,O=M.parent,m=M.winding,b=P.length,L=[l[I].coord],R=I;if(l[I].ringAndEdge1Walkable)var N=l[I].ringAndEdge1,B=l[I].nxtIsectAlongRingAndEdge1;else var N=l[I].ringAndEdge2,B=l[I].nxtIsectAlongRingAndEdge2;for(;!tA(l[I].coord,l[B].coord);){L.push(l[B].coord);for(var G=void 0,C=0;C<w.length;C++)if(w[C].isect==B){G=C;break}if(G!=null&&w.splice(G,1),tA(N,l[B].ringAndEdge1)){if(N=l[B].ringAndEdge2,l[B].ringAndEdge2Walkable=!1,l[B].ringAndEdge1Walkable){var F={isect:B};TL([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge2].coord],m==1)?(F.parent=O,F.winding=-m):(F.parent=b,F.winding=m),w.push(F)}R=B,B=l[B].nxtIsectAlongRingAndEdge2}else{if(N=l[B].ringAndEdge1,l[B].ringAndEdge1Walkable=!1,l[B].ringAndEdge2Walkable){var F={isect:B};TL([l[R].coord,l[B].coord,l[l[B].nxtIsectAlongRingAndEdge1].coord],m==1)?(F.parent=O,F.winding=-m):(F.parent=b,F.winding=m),w.push(F)}R=B,B=l[B].nxtIsectAlongRingAndEdge1}}L.push(l[B].coord),P.push(rr([L],{index:b,parent:O,winding:m,netWinding:void 0}))}var k=Ft(P);Z(),te();function Z(){for(var ue=[],pe=0;pe<k.features.length;pe++)k.features[pe].properties.parent==-1&&ue.push(pe);if(ue.length>1)for(var pe=0;pe<ue.length;pe++){for(var me=-1,st=1/0,ht=0;ht<k.features.length;ht++)ue[pe]!=ht&&xo(k.features[ue[pe]].geometry.coordinates[0][0],k.features[ht],{ignoreBoundary:!0})&&fA(k.features[ht])<st&&(me=ht);k.features[ue[pe]].properties.parent=me}}function te(){for(var ue=0;ue<k.features.length;ue++)if(k.features[ue].properties.parent==-1){var pe=k.features[ue].properties.winding;k.features[ue].properties.netWinding=pe,oe(ue,pe)}}function oe(ue,pe){for(var me=0;me<k.features.length;me++)if(k.features[me].properties.parent==ue){var st=pe+k.features[me].properties.winding;k.features[me].properties.netWinding=st,oe(me,st)}}return k},Vee=function(e,t,n,r,o){this.coord=e,this.param=t,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=o},kee=function(e,t,n,r,o,a,s){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=o,this.ringAndEdge1Walkable=a,this.ringAndEdge2Walkable=s};function TL(e,t){if(typeof t>"u"&&(t=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var n=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return n>=0==t}function P2e(e){for(var t=0,n=0;n<e.length-1;n++)e[n][0]<e[t][0]&&(t=n);if(TL([e[(t-1).modulo(e.length-1)],e[t],e[(t+1).modulo(e.length-1)]],!0))var r=1;else var r=-1;return r}function tA(e,t){if(!e||!t||e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!tA(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}Number.prototype.modulo=function(e){return(this%e+e)%e};function M2e(e){for(var t={},n=1,r=0,o=e.length;r<o;++r){if(t.hasOwnProperty(e[r])){n=0;break}t[e[r]]=1}return n}function L2e(e){var t=[];return ba(e,function(n){n.geometry.type==="Polygon"&&di(D2e(n),function(r){t.push(rr(r.geometry.coordinates,n.properties))})}),Ft(t)}var Gee=Math.PI/180,Uee=180/Math.PI,hA=function(e,t){this.lon=e,this.lat=t,this.x=Gee*e,this.y=Gee*t};hA.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};hA.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new hA(t,e)};var Rne=function(){this.coords=[],this.length=0};Rne.prototype.move_to=function(e){this.length++,this.coords.push(e)};var x4=function(e){this.properties=e||{},this.geometries=[]};x4.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};x4.prototype.wkt=function(){for(var e="",t="LINESTRING(",n=function(a){t+=a[0]+" "+a[1]+","},r=0;r<this.geometries.length;r++){if(this.geometries[r].coords.length===0)return"LINESTRING(empty)";var o=this.geometries[r].coords;o.forEach(n),e+=t.substring(0,t.length-1)+")"}return e};var w4=function(e,t,n){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new hA(e.x,e.y),this.end=new hA(t.x,t.y),this.properties=n||{};var r=this.start.x-this.end.x,o=this.start.y-this.end.y,a=Math.pow(Math.sin(o/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};w4.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),n=Math.sin(e*this.g)/Math.sin(this.g),r=t*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=t*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=t*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=Uee*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(o,2))),u=Uee*Math.atan2(o,r);return[u,s]};w4.prototype.Arc=function(e,t){var n=[];if(!e||e<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(e-1),o=0;o<e;++o){var a=r*o,s=this.interpolate(a);n.push(s)}for(var u=!1,l=0,c=t&&t.offset?t.offset:10,f=180-c,h=-180+c,d=360-c,p=1;p<n.length;++p){var g=n[p-1][0],y=n[p][0],v=Math.abs(y-g);v>d&&(y>f&&g<h||g>f&&y<h)?u=!0:v>l&&(l=v)}var w=[];if(u&&l<c){var C=[];w.push(C);for(var E=0;E<n.length;++E){var S=parseFloat(n[E][0]);if(E>0&&Math.abs(S-n[E-1][0])>d){var A=parseFloat(n[E-1][0]),D=parseFloat(n[E-1][1]),P=parseFloat(n[E][0]),M=parseFloat(n[E][1]);if(A>-180&&A<h&&P===180&&E+1<n.length&&n[E-1][0]>-180&&n[E-1][0]<h){C.push([-180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}else if(A>f&&A<180&&P===-180&&E+1<n.length&&n[E-1][0]>f&&n[E-1][0]<180){C.push([180,n[E][1]]),E++,C.push([n[E][0],n[E][1]]);continue}if(A<h&&P>f){var I=A;A=P,P=I;var O=D;D=M,M=O}if(A>f&&P<h&&(P+=360),A<=180&&P>=180&&A<P){var m=(180-A)/(P-A),b=m*M+(1-m)*D;C.push([n[E-1][0]>f?180:-180,b]),C=[],C.push([n[E-1][0]>f?-180:180,b]),w.push(C)}else C=[],w.push(C);C.push([S,n[E][1]])}else C.push([n[E][0],n[E][1]])}}else{var L=[];w.push(L);for(var R=0;R<n.length;++R)L.push([n[R][0],n[R][1]])}for(var N=new x4(this.properties),B=0;B<w.length;++B){var G=new Rne;N.geometries.push(G);for(var F=w[B],k=0;k<F.length;++k)G.move_to(F[k])}return N};function R2e(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.properties,o=n.npoints,a=n.offset;e=co(e),t=co(t),r=r||{},o=o||100,a=a||10;var s=new w4({x:e[0],y:e[1]},{x:t[0],y:t[1]},r),u=s.Arc(o,{offset:a});return u.json()}function O2e(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=Fi(e),r=Fi(t);if(n!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var o=vx(t,{precision:7});switch(r){case"Point":return Qz(e,o);case"MultiPoint":return Hee(e,o);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Hee(e,Og(e,o))}}function Hee(e,t){var n=[],r=LA();return ba(t,function(o){if(n.forEach(function(u,l){u.id=l}),!n.length)n=Qz(e,o).features,n.forEach(function(u){u.bbox||(u.bbox=yne(Ia(u)))}),r.load(Ft(n));else{var a=r.search(o);if(a.features.length){var s=One(o,a);n=n.filter(function(u){return u.id!==s.id}),r.remove(s),di(Qz(s,o),function(u){n.push(u),r.insert(u)})}}}),Ft(n)}function Qz(e,t){var n=[],r=Et(e)[0],o=Et(e)[e.geometry.coordinates.length-1];if(Nz(r,co(t))||Nz(o,co(t)))return Ft([e]);var a=LA(),s=yv(e);a.load(s);var u=a.search(t);if(!u.features.length)return Ft([e]);var l=One(t,u),c=[r],f=c4(s,function(h,d,p){var g=Et(d)[1],y=co(t);return p===l.id?(h.push(y),n.push(Bi(h)),Nz(y,g)?[y]:[y,g]):(h.push(g),h)},c);return f.length>1&&n.push(Bi(f)),Ft(n)}function One(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,r=1/0;return di(t,function(o){var a=vg(o,e),s=a.properties.dist;s<r&&(n=o,r=s)}),n}function Nz(e,t){return e[0]===t[0]&&e[1]===t[1]}function Nne(e,t,n,r,o){if(o=o||{},!gt(o))throw new Error("options is invalid");var a=o.steps,s=o.units;if(!e)throw new Error("center is required");if(!t)throw new Error("radius is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(typeof o!="object")throw new Error("options must be an object");a=a||64;var u=qee(n),l=qee(r),c=e.properties;if(u===l)return Bi(v4(e,t,o).geometry.coordinates[0],c);for(var f=u,h=u<l?l:l+360,d=f,p=[],g=0;d<h;)p.push(Jp(e,t,d,s).geometry.coordinates),g++,d=f+g*360/a;return d>h&&p.push(Jp(e,t,h,s).geometry.coordinates),Bi(p,c)}function qee(e){var t=e%360;return t<0&&(t+=360),t}function LL(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=Fi(e),o=Et(e);if(n=n||e.properties||{},!o.length)throw new Error("polygon must contain coordinates");switch(r){case"Polygon":return Wee(o,n);case"MultiPolygon":var a=[];return o.forEach(function(s){a.push(Wee(s,n))}),Ft(a);default:throw new Error("geom "+r+" not supported")}}function Wee(e,t){return e.length>1?p_(e,t):Bi(e[0],t)}function Yee(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=t.autoComplete,o=t.orderCoords;if(!e)throw new Error("lines is required");r=r!==void 0?r:!0,o=o!==void 0?o:!0;var a=Fi(e);switch(a){case"FeatureCollection":case"GeometryCollection":var s=[],u=e.features?e.features:e.geometries;return u.forEach(function(l){s.push(Et(Xee(l,{},r,o)))}),Kx(s,n)}return Xee(e,n,r,o)}function Xee(e,t,n,r){t=t||e.properties||{};var o=Et(e),a=Fi(e);if(!o.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(o=jee(o)),rr([o],t);case"MultiLineString":var s=[],u=0;return o.forEach(function(l){if(n&&(l=jee(l)),r){var c=N2e(Ia(Bi(l)));c>u?(s.unshift(l),u=c):s.push(l)}else s.push(l)}),rr(s,t);default:throw new Error("geometry type "+a+" is not supported")}}function jee(e){var t=e[0],n=t[0],r=t[1],o=e[e.length-1],a=o[0],s=o[1];return(n!==a||r!==s)&&e.push(t),e}function N2e(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.abs(t-r)*Math.abs(n-o)}var Bne=RL;RL.polyline=RL;RL.polygon=B2e;function RL(e,t,n){var r=e.length,o=Cx(e[0],t),a=[],s,u,l,c,f;for(n||(n=[]),s=1;s<r;s++){for(u=e[s-1],l=e[s],c=f=Cx(l,t);;)if(o|c){if(o&c)break;o?(u=Jz(u,l,o,t),o=Cx(u,t)):(l=Jz(u,l,c,t),c=Cx(l,t))}else{a.push(u),c!==f?(a.push(l),s<r-1&&(n.push(a),a=[])):s===r-1&&a.push(l);break}o=f}return a.length&&n.push(a),n}function B2e(e,t){var n,r,o,a,s,u,l;for(r=1;r<=8;r*=2){for(n=[],o=e[e.length-1],a=!(Cx(o,t)&r),s=0;s<e.length;s++)u=e[s],l=!(Cx(u,t)&r),l!==a&&n.push(Jz(o,u,r,t)),l&&n.push(u),o=u,a=l;if(e=n,!e.length)break}return n}function Jz(e,t,n,r){return n&8?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:n&4?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:n&2?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:n&1?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function Cx(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function F2e(e,t){var n=z2e(e),r=Et(e),o=e.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return n==="LineString"&&(r=[r]),r.forEach(function(s){Bne(s,t,a)}),a.length===1?Bi(a[0],o):p_(a,o);case"Polygon":return rr(Kee(r,t),o);case"MultiPolygon":return Kx(r.map(function(s){return Kee(s,t)}),o);default:throw new Error("geometry "+n+" not supported")}}function Kee(e,t){for(var n=[],r=0;r<e.length;r++){var o=Bne.polygon(e[r],t);o.length>0&&((o[0][0]!==o[o.length-1][0]||o[0][1]!==o[o.length-1][1])&&o.push(o[0]),o.length>=4&&n.push(o))}return n}function z2e(e){return e.geometry?e.geometry.type:e.type}var Zee=Array.prototype.slice;function Qee(e){return Object.prototype.toString.call(e)==="[object Arguments]"}function pv(e,t,n){return n||(n={}),e===t?!0:e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||typeof e!="object"&&typeof t!="object"?(n.strict,e===t):V2e(e,t,n)}function Jee(e){return e==null}function $ee(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function V2e(e,t,n){var r,o;if(Jee(e)||Jee(t)||e.prototype!==t.prototype)return!1;if(Qee(e))return Qee(t)?(e=Zee.call(e),t=Zee.call(t),pv(e,t,n)):!1;if($ee(e)){if(!$ee(t)||e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}try{var a=Object.keys(e),s=Object.keys(t)}catch{return!1}if(a.length!==s.length)return!1;for(a.sort(),s.sort(),r=a.length-1;r>=0;r--)if(a[r]!==s[r])return!1;for(r=a.length-1;r>=0;r--)if(o=a[r],!pv(e[o],t[o],n))return!1;return typeof e==typeof t}function Fne(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.tolerance||0,o=[],a=LA();a.load(yv(e));var s;return yg(t,function(u){var l=!1;di(a.search(u),function(c){if(l===!1){var f=Et(u).sort(),h=Et(c).sort();pv(f,h)||(r===0?Ac(f[0],c)&&Ac(f[1],c):vg(c,f[0]).properties.dist<=r&&vg(c,f[1]).properties.dist<=r)?(l=!0,s?s=Bz(s,u):s=u):(r===0?Ac(h[0],u)&&Ac(h[1],u):vg(u,h[0]).properties.dist<=r&&vg(u,h[1]).properties.dist<=r)&&(s?s=Bz(s,c):s=c)}}),l===!1&&s&&(o.push(s),s=void 0)}),s&&o.push(s),Ft(o)}function Bz(e,t){var n=Et(t),r=Et(e),o=r[0],a=r[r.length-1],s=e.geometry.coordinates;return pv(n[0],o)?s.unshift(n[1]):pv(n[0],a)?s.push(n[1]):pv(n[1],o)?s.unshift(n[0]):pv(n[1],a)&&s.push(n[0]),e}function k2e(e,t,n,r,o){if(o=o||{},!gt(o))throw new Error("options is invalid");if(!e)throw new Error("center is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof o!="object")throw new Error("options must be an object");if(ete(n)===ete(r))return v4(e,t,o);var a=Et(e),s=Nne(e,t,n,r,o),u=[[a]];return Qa(s,function(l){u[0].push(l)}),u[0].push(a),rr(u)}function ete(e){var t=e%360;return t<0&&(t+=360),t}function bx(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.properties;if(!e)throw new Error("origin is required");if(t==null)throw new Error("distance is required");if(n==null)throw new Error("bearing is required");if(!(t>=0))throw new Error("distance must be greater than 0");var s=gv(t,o,"meters"),u=co(e),l=G2e(u,s,n);return l[0]+=l[0]-u[0]>180?-360:u[0]-l[0]>180?360:0,Wr(l,a)}function G2e(e,t,n,r){r=r===void 0?gs:Number(r);var o=t/r,a=e[0]*Math.PI/180,s=Za(e[1]),u=Za(n),l=o*Math.cos(u),c=s+l;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var f=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(f)>1e-11?l/f:Math.cos(s),d=o*Math.sin(u)/h,p=a+d;return[(p*180/Math.PI+540)%360-180,c*180/Math.PI]}function U2e(e,t){var n=Et(e),r=Et(t),o,a,s,u,l=Fi(t);switch(l){case"Polygon":o=r[0][0],a=r[0][0],u=dA(r[0][0],r[0][r[0].length-1],n);var c=tte(r[0],n,u,s,o,a);o=c[0],a=c[1];break;case"MultiPolygon":o=r[0][0][0],a=r[0][0][0],u=dA(r[0][0][0],r[0][0][r[0][0].length-1],n),r.forEach(function(f){var h=tte(f[0],n,u,s,o,a);o=h[0],a=h[1]});break}return Ft([Wr(o),Wr(a)])}function tte(e,t,n,r,o,a){for(var s=0;s<e.length;s++){var u=e[s],l=e[s+1];s===e.length-1&&(l=e[0]),r=dA(u,l,t),n<=0&&r>0?q2e(t,u,o)||(o=u):n>0&&r<=0&&(H2e(t,u,a)||(a=u)),n=r}return[o,a]}function H2e(e,t,n){return dA(e,t,n)>0}function q2e(e,t,n){return dA(e,t,n)<0}function dA(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function OL(e){if(!e)throw new Error("line is required");var t=e.geometry?e.geometry.type:e.type;if(!Array.isArray(e)&&t!=="LineString")throw new Error("geometry must be a LineString");for(var n=Et(e),r=0,o=1,a,s;o<n.length;)a=s||n[0],s=n[o],r+=(s[0]-a[0])*(s[1]+a[1]),o++;return r>0}function W2e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.reverse||!1,r=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(e=vu(e));var o=[];switch(e.type){case"GeometryCollection":return Fh(e,function(a){SL(a,n)}),e;case"FeatureCollection":return di(e,function(a){di(SL(a,n),function(s){o.push(s)})}),Ft(o)}return SL(e,n)}function SL(e,t){var n=e.type==="Feature"?e.geometry.type:e.type;switch(n){case"GeometryCollection":return Fh(e,function(r){SL(r,t)}),e;case"LineString":return nte(Et(e),t),e;case"Polygon":return rte(Et(e),t),e;case"MultiLineString":return Et(e).forEach(function(r){nte(r,t)}),e;case"MultiPolygon":return Et(e).forEach(function(r){rte(r,t)}),e;case"Point":case"MultiPoint":return e}}function nte(e,t){OL(e)===t&&e.reverse()}function rte(e,t){OL(e[0])!==t&&e[0].reverse();for(var n=1;n<e.length;n++)OL(e[n])===t&&e[n].reverse()}function Y2e(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,o=t.flags;Ud(e,"Point","input must contain Points");for(var a=X2e(e,r),s=[],u=0;u<a.length;u++){for(var l=a[u],c=[],f=0;f<l.length;f++){var h=l[f];h.properties[n]?c.push(h.properties[n]):c.push(0),o===!0&&(h.properties.matrixPosition=[u,f])}s.push(c)}return s}function X2e(e,t){var n={};di(e,function(a){var s=Et(a)[1];n[s]||(n[s]=[]),n[s].push(a)});var r=Object.keys(n).map(function(a){var s=n[a],u=s.sort(function(l,c){return Et(l)[0]-Et(c)[0]});return u}),o=r.sort(function(a,s){return t?Et(a[0])[1]-Et(s[0])[1]:Et(s[0])[1]-Et(a[0])[1]});return o}/*!
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*/var ite={successCallback:null,verbose:!1,polygons:!1},fv={};function j2e(e,t,n,r){r=r||{};for(var o=Object.keys(ite),a=0;a<o.length;a++){var s=o[a],u=r[s];u=typeof u<"u"&&u!==null?u:ite[s],fv[s]=u}fv.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n)+"]");var l=b3e(e,t,n),c;return fv.polygons?(fv.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),c=R3e(l)):(fv.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),c=I3e(l)),typeof fv.successCallback=="function"&&fv.successCallback(c),c}var Gu=64,Th=16,zs=4,du=1,ir=[],or=[],ar=[],sr=[],ur=[],lr=[],cr=[],fr=[],hr=[],dr=[],pr=[],mr=[],gr=[],_r=[],yr=[],vr=[],Cr=[],xr=[],wr=[],Er=[],Tr=[],Sr=[],Ar=[],br=[];cr[85]=dr[85]=-1;fr[85]=pr[85]=0;hr[85]=mr[85]=1;wr[85]=Sr[85]=1;Er[85]=Ar[85]=0;Tr[85]=br[85]=1;ir[85]=sr[85]=0;or[85]=ur[85]=-1;ar[85]=yr[85]=0;vr[85]=gr[85]=0;Cr[85]=_r[85]=1;lr[85]=xr[85]=1;Sr[1]=Sr[169]=0;Ar[1]=Ar[169]=-1;br[1]=br[169]=0;gr[1]=gr[169]=-1;_r[1]=_r[169]=0;yr[1]=yr[169]=0;dr[4]=dr[166]=0;pr[4]=pr[166]=-1;mr[4]=mr[166]=1;vr[4]=vr[166]=1;Cr[4]=Cr[166]=0;xr[4]=xr[166]=0;cr[16]=cr[154]=0;fr[16]=fr[154]=1;hr[16]=hr[154]=1;sr[16]=sr[154]=1;ur[16]=ur[154]=0;lr[16]=lr[154]=1;wr[64]=wr[106]=0;Er[64]=Er[106]=1;Tr[64]=Tr[106]=0;ir[64]=ir[106]=-1;or[64]=or[106]=0;ar[64]=ar[106]=1;wr[2]=wr[168]=0;Er[2]=Er[168]=-1;Tr[2]=Tr[168]=1;Sr[2]=Sr[168]=0;Ar[2]=Ar[168]=-1;br[2]=br[168]=0;gr[2]=gr[168]=-1;_r[2]=_r[168]=0;yr[2]=yr[168]=0;vr[2]=vr[168]=-1;Cr[2]=Cr[168]=0;xr[2]=xr[168]=1;cr[8]=cr[162]=0;fr[8]=fr[162]=-1;hr[8]=hr[162]=0;dr[8]=dr[162]=0;pr[8]=pr[162]=-1;mr[8]=mr[162]=1;gr[8]=gr[162]=1;_r[8]=_r[162]=0;yr[8]=yr[162]=1;vr[8]=vr[162]=1;Cr[8]=Cr[162]=0;xr[8]=xr[162]=0;cr[32]=cr[138]=0;fr[32]=fr[138]=1;hr[32]=hr[138]=1;dr[32]=dr[138]=0;pr[32]=pr[138]=1;mr[32]=mr[138]=0;ir[32]=ir[138]=1;or[32]=or[138]=0;ar[32]=ar[138]=0;sr[32]=sr[138]=1;ur[32]=ur[138]=0;lr[32]=lr[138]=1;Sr[128]=Sr[42]=0;Ar[128]=Ar[42]=1;br[128]=br[42]=1;wr[128]=wr[42]=0;Er[128]=Er[42]=1;Tr[128]=Tr[42]=0;ir[128]=ir[42]=-1;or[128]=or[42]=0;ar[128]=ar[42]=1;sr[128]=sr[42]=-1;ur[128]=ur[42]=0;lr[128]=lr[42]=0;dr[5]=dr[165]=-1;pr[5]=pr[165]=0;mr[5]=mr[165]=0;Sr[5]=Sr[165]=1;Ar[5]=Ar[165]=0;br[5]=br[165]=0;vr[20]=vr[150]=0;Cr[20]=Cr[150]=1;xr[20]=xr[150]=1;sr[20]=sr[150]=0;ur[20]=ur[150]=-1;lr[20]=lr[150]=1;cr[80]=cr[90]=-1;fr[80]=fr[90]=0;hr[80]=hr[90]=1;wr[80]=wr[90]=1;Er[80]=Er[90]=0;Tr[80]=Tr[90]=1;gr[65]=gr[105]=0;_r[65]=_r[105]=1;yr[65]=yr[105]=0;ir[65]=ir[105]=0;or[65]=or[105]=-1;ar[65]=ar[105]=0;cr[160]=cr[10]=-1;fr[160]=fr[10]=0;hr[160]=hr[10]=1;dr[160]=dr[10]=-1;pr[160]=pr[10]=0;mr[160]=mr[10]=0;Sr[160]=Sr[10]=1;Ar[160]=Ar[10]=0;br[160]=br[10]=0;wr[160]=wr[10]=1;Er[160]=Er[10]=0;Tr[160]=Tr[10]=1;vr[130]=vr[40]=0;Cr[130]=Cr[40]=1;xr[130]=xr[40]=1;gr[130]=gr[40]=0;_r[130]=_r[40]=1;yr[130]=yr[40]=0;ir[130]=ir[40]=0;or[130]=or[40]=-1;ar[130]=ar[40]=0;sr[130]=sr[40]=0;ur[130]=ur[40]=-1;lr[130]=lr[40]=1;dr[37]=dr[133]=0;pr[37]=pr[133]=1;mr[37]=mr[133]=1;Sr[37]=Sr[133]=0;Ar[37]=Ar[133]=1;br[37]=br[133]=0;ir[37]=ir[133]=-1;or[37]=or[133]=0;ar[37]=ar[133]=0;sr[37]=sr[133]=1;ur[37]=ur[133]=0;lr[37]=lr[133]=0;vr[148]=vr[22]=-1;Cr[148]=Cr[22]=0;xr[148]=xr[22]=0;Sr[148]=Sr[22]=0;Ar[148]=Ar[22]=-1;br[148]=br[22]=1;wr[148]=wr[22]=0;Er[148]=Er[22]=1;Tr[148]=Tr[22]=1;sr[148]=sr[22]=-1;ur[148]=ur[22]=0;lr[148]=lr[22]=1;cr[82]=cr[88]=0;fr[82]=fr[88]=-1;hr[82]=hr[88]=1;vr[82]=vr[88]=1;Cr[82]=Cr[88]=0;xr[82]=xr[88]=1;gr[82]=gr[88]=-1;_r[82]=_r[88]=0;yr[82]=yr[88]=1;wr[82]=wr[88]=0;Er[82]=Er[88]=-1;Tr[82]=Tr[88]=0;cr[73]=cr[97]=0;fr[73]=fr[97]=1;hr[73]=hr[97]=0;dr[73]=dr[97]=0;pr[73]=pr[97]=-1;mr[73]=mr[97]=0;gr[73]=gr[97]=1;_r[73]=_r[97]=0;yr[73]=yr[97]=0;ir[73]=ir[97]=1;or[73]=or[97]=0;ar[73]=ar[97]=1;cr[145]=cr[25]=0;fr[145]=fr[25]=-1;hr[145]=hr[25]=0;gr[145]=gr[25]=1;_r[145]=_r[25]=0;yr[145]=yr[25]=1;Sr[145]=Sr[25]=0;Ar[145]=Ar[25]=1;br[145]=br[25]=1;sr[145]=sr[25]=-1;ur[145]=ur[25]=0;lr[145]=lr[25]=0;dr[70]=dr[100]=0;pr[70]=pr[100]=1;mr[70]=mr[100]=0;vr[70]=vr[100]=-1;Cr[70]=Cr[100]=0;xr[70]=xr[100]=1;wr[70]=wr[100]=0;Er[70]=Er[100]=-1;Tr[70]=Tr[100]=1;ir[70]=ir[100]=1;or[70]=or[100]=0;ar[70]=ar[100]=0;dr[101]=dr[69]=0;pr[101]=pr[69]=1;mr[101]=mr[69]=0;ir[101]=ir[69]=1;or[101]=or[69]=0;ar[101]=ar[69]=0;Sr[149]=Sr[21]=0;Ar[149]=Ar[21]=1;br[149]=br[21]=1;sr[149]=sr[21]=-1;ur[149]=ur[21]=0;lr[149]=lr[21]=0;vr[86]=vr[84]=-1;Cr[86]=Cr[84]=0;xr[86]=xr[84]=1;wr[86]=wr[84]=0;Er[86]=Er[84]=-1;Tr[86]=Tr[84]=1;cr[89]=cr[81]=0;fr[89]=fr[81]=-1;hr[89]=hr[81]=0;gr[89]=gr[81]=1;_r[89]=_r[81]=0;yr[89]=yr[81]=1;cr[96]=cr[74]=0;fr[96]=fr[74]=1;hr[96]=hr[74]=0;dr[96]=dr[74]=-1;pr[96]=pr[74]=0;mr[96]=mr[74]=1;wr[96]=wr[74]=1;Er[96]=Er[74]=0;Tr[96]=Tr[74]=0;ir[96]=ir[74]=1;or[96]=or[74]=0;ar[96]=ar[74]=1;cr[24]=cr[146]=0;fr[24]=fr[146]=-1;hr[24]=hr[146]=1;vr[24]=vr[146]=1;Cr[24]=Cr[146]=0;xr[24]=xr[146]=1;gr[24]=gr[146]=0;_r[24]=_r[146]=1;yr[24]=yr[146]=1;sr[24]=sr[146]=0;ur[24]=ur[146]=-1;lr[24]=lr[146]=0;dr[6]=dr[164]=-1;pr[6]=pr[164]=0;mr[6]=mr[164]=1;vr[6]=vr[164]=-1;Cr[6]=Cr[164]=0;xr[6]=xr[164]=0;Sr[6]=Sr[164]=0;Ar[6]=Ar[164]=-1;br[6]=br[164]=1;wr[6]=wr[164]=1;Er[6]=Er[164]=0;Tr[6]=Tr[164]=0;gr[129]=gr[41]=0;_r[129]=_r[41]=1;yr[129]=yr[41]=1;Sr[129]=Sr[41]=0;Ar[129]=Ar[41]=1;br[129]=br[41]=0;ir[129]=ir[41]=-1;or[129]=or[41]=0;ar[129]=ar[41]=0;sr[129]=sr[41]=0;ur[129]=ur[41]=-1;lr[129]=lr[41]=0;vr[66]=vr[104]=0;Cr[66]=Cr[104]=1;xr[66]=xr[104]=0;gr[66]=gr[104]=-1;_r[66]=_r[104]=0;yr[66]=yr[104]=1;wr[66]=wr[104]=0;Er[66]=Er[104]=-1;Tr[66]=Tr[104]=0;ir[66]=ir[104]=0;or[66]=or[104]=-1;ar[66]=ar[104]=1;cr[144]=cr[26]=-1;fr[144]=fr[26]=0;hr[144]=hr[26]=0;Sr[144]=Sr[26]=1;Ar[144]=Ar[26]=0;br[144]=br[26]=1;wr[144]=wr[26]=0;Er[144]=Er[26]=1;Tr[144]=Tr[26]=1;sr[144]=sr[26]=-1;ur[144]=ur[26]=0;lr[144]=lr[26]=1;dr[36]=dr[134]=0;pr[36]=pr[134]=1;mr[36]=mr[134]=1;vr[36]=vr[134]=0;Cr[36]=Cr[134]=1;xr[36]=xr[134]=0;ir[36]=ir[134]=0;or[36]=or[134]=-1;ar[36]=ar[134]=1;sr[36]=sr[134]=1;ur[36]=ur[134]=0;lr[36]=lr[134]=0;cr[9]=cr[161]=-1;fr[9]=fr[161]=0;hr[9]=hr[161]=0;dr[9]=dr[161]=0;pr[9]=pr[161]=-1;mr[9]=mr[161]=0;gr[9]=gr[161]=1;_r[9]=_r[161]=0;yr[9]=yr[161]=0;Sr[9]=Sr[161]=1;Ar[9]=Ar[161]=0;br[9]=br[161]=1;cr[136]=0;fr[136]=1;hr[136]=1;dr[136]=0;pr[136]=1;mr[136]=0;vr[136]=-1;Cr[136]=0;xr[136]=1;gr[136]=-1;_r[136]=0;yr[136]=0;Sr[136]=0;Ar[136]=-1;br[136]=0;wr[136]=0;Er[136]=-1;Tr[136]=1;ir[136]=1;or[136]=0;ar[136]=0;sr[136]=1;ur[136]=0;lr[136]=1;cr[34]=0;fr[34]=-1;hr[34]=0;dr[34]=0;pr[34]=-1;mr[34]=1;vr[34]=1;Cr[34]=0;xr[34]=0;gr[34]=1;_r[34]=0;yr[34]=1;Sr[34]=0;Ar[34]=1;br[34]=1;wr[34]=0;Er[34]=1;Tr[34]=0;ir[34]=-1;or[34]=0;ar[34]=1;sr[34]=-1;ur[34]=0;lr[34]=0;cr[35]=0;fr[35]=1;hr[35]=1;dr[35]=0;pr[35]=-1;mr[35]=1;vr[35]=1;Cr[35]=0;xr[35]=0;gr[35]=-1;_r[35]=0;yr[35]=0;Sr[35]=0;Ar[35]=-1;br[35]=0;wr[35]=0;Er[35]=1;Tr[35]=0;ir[35]=-1;or[35]=0;ar[35]=1;sr[35]=1;ur[35]=0;lr[35]=1;cr[153]=0;fr[153]=1;hr[153]=1;gr[153]=-1;_r[153]=0;yr[153]=0;Sr[153]=0;Ar[153]=-1;br[153]=0;sr[153]=1;ur[153]=0;lr[153]=1;dr[102]=0;pr[102]=-1;mr[102]=1;vr[102]=1;Cr[102]=0;xr[102]=0;wr[102]=0;Er[102]=1;Tr[102]=0;ir[102]=-1;or[102]=0;ar[102]=1;cr[155]=0;fr[155]=-1;hr[155]=0;gr[155]=1;_r[155]=0;yr[155]=1;Sr[155]=0;Ar[155]=1;br[155]=1;sr[155]=-1;ur[155]=0;lr[155]=0;dr[103]=0;pr[103]=1;mr[103]=0;vr[103]=-1;Cr[103]=0;xr[103]=1;wr[103]=0;Er[103]=-1;Tr[103]=1;ir[103]=1;or[103]=0;ar[103]=0;cr[152]=0;fr[152]=1;hr[152]=1;vr[152]=-1;Cr[152]=0;xr[152]=1;gr[152]=-1;_r[152]=0;yr[152]=0;Sr[152]=0;Ar[152]=-1;br[152]=0;wr[152]=0;Er[152]=-1;Tr[152]=1;sr[152]=1;ur[152]=0;lr[152]=1;cr[156]=0;fr[156]=-1;hr[156]=1;vr[156]=1;Cr[156]=0;xr[156]=1;gr[156]=-1;_r[156]=0;yr[156]=0;Sr[156]=0;Ar[156]=-1;br[156]=0;wr[156]=0;Er[156]=1;Tr[156]=1;sr[156]=-1;ur[156]=0;lr[156]=1;cr[137]=0;fr[137]=1;hr[137]=1;dr[137]=0;pr[137]=1;mr[137]=0;gr[137]=-1;_r[137]=0;yr[137]=0;Sr[137]=0;Ar[137]=-1;br[137]=0;ir[137]=1;or[137]=0;ar[137]=0;sr[137]=1;ur[137]=0;lr[137]=1;cr[139]=0;fr[139]=1;hr[139]=1;dr[139]=0;pr[139]=-1;mr[139]=0;gr[139]=1;_r[139]=0;yr[139]=0;Sr[139]=0;Ar[139]=1;br[139]=0;ir[139]=-1;or[139]=0;ar[139]=0;sr[139]=1;ur[139]=0;lr[139]=1;cr[98]=0;fr[98]=-1;hr[98]=0;dr[98]=0;pr[98]=-1;mr[98]=1;vr[98]=1;Cr[98]=0;xr[98]=0;gr[98]=1;_r[98]=0;yr[98]=1;wr[98]=0;Er[98]=1;Tr[98]=0;ir[98]=-1;or[98]=0;ar[98]=1;cr[99]=0;fr[99]=1;hr[99]=0;dr[99]=0;pr[99]=-1;mr[99]=1;vr[99]=1;Cr[99]=0;xr[99]=0;gr[99]=-1;_r[99]=0;yr[99]=1;wr[99]=0;Er[99]=-1;Tr[99]=0;ir[99]=1;or[99]=0;ar[99]=1;dr[38]=0;pr[38]=-1;mr[38]=1;vr[38]=1;Cr[38]=0;xr[38]=0;Sr[38]=0;Ar[38]=1;br[38]=1;wr[38]=0;Er[38]=1;Tr[38]=0;ir[38]=-1;or[38]=0;ar[38]=1;sr[38]=-1;ur[38]=0;lr[38]=0;dr[39]=0;pr[39]=1;mr[39]=1;vr[39]=-1;Cr[39]=0;xr[39]=0;Sr[39]=0;Ar[39]=-1;br[39]=1;wr[39]=0;Er[39]=1;Tr[39]=0;ir[39]=-1;or[39]=0;ar[39]=1;sr[39]=1;ur[39]=0;lr[39]=0;var E4=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},T4=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},S4=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},A4=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},b4=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},I4=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},D4=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},P4=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},K2e=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},Z2e=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},Q2e=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},J2e=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},$2e=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},e3e=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},t3e=function(){return[[0,0],[0,1],[1,1],[1,0]]},n3e=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},r3e=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},i3e=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},o3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},a3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},s3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},u3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},l3e=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},c3e=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},f3e=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},h3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},d3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},p3e=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},m3e=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},g3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},_3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},y3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},v3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},C3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},x3e=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},w3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},E3e=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},T3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},S3e=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},A3e=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},nt=[],Qe=[],At=[],mt=[],Ht=[],Vt=[],Ir=[],Lr=[];mt[1]=Ht[1]=18;mt[169]=Ht[169]=18;At[4]=Qe[4]=12;At[166]=Qe[166]=12;nt[16]=Lr[16]=4;nt[154]=Lr[154]=4;Vt[64]=Ir[64]=22;Vt[106]=Ir[106]=22;At[2]=Vt[2]=17;mt[2]=Ht[2]=18;At[168]=Vt[168]=17;mt[168]=Ht[168]=18;nt[8]=mt[8]=9;Qe[8]=At[8]=12;nt[162]=mt[162]=9;Qe[162]=At[162]=12;nt[32]=Lr[32]=4;Qe[32]=Ir[32]=1;nt[138]=Lr[138]=4;Qe[138]=Ir[138]=1;Ht[128]=Lr[128]=21;Vt[128]=Ir[128]=22;Ht[42]=Lr[42]=21;Vt[42]=Ir[42]=22;Qe[5]=Ht[5]=14;Qe[165]=Ht[165]=14;At[20]=Lr[20]=6;At[150]=Lr[150]=6;nt[80]=Vt[80]=11;nt[90]=Vt[90]=11;mt[65]=Ir[65]=3;mt[105]=Ir[105]=3;nt[160]=Vt[160]=11;Qe[160]=Ht[160]=14;nt[10]=Vt[10]=11;Qe[10]=Ht[10]=14;At[130]=Lr[130]=6;mt[130]=Ir[130]=3;At[40]=Lr[40]=6;mt[40]=Ir[40]=3;Qe[101]=Ir[101]=1;Qe[69]=Ir[69]=1;Ht[149]=Lr[149]=21;Ht[21]=Lr[21]=21;At[86]=Vt[86]=17;At[84]=Vt[84]=17;nt[89]=mt[89]=9;nt[81]=mt[81]=9;nt[96]=Ir[96]=0;Qe[96]=Vt[96]=15;nt[74]=Ir[74]=0;Qe[74]=Vt[74]=15;nt[24]=At[24]=8;mt[24]=Lr[24]=7;nt[146]=At[146]=8;mt[146]=Lr[146]=7;Qe[6]=Vt[6]=15;At[6]=Ht[6]=16;Qe[164]=Vt[164]=15;At[164]=Ht[164]=16;mt[129]=Lr[129]=7;Ht[129]=Ir[129]=20;mt[41]=Lr[41]=7;Ht[41]=Ir[41]=20;At[66]=Ir[66]=2;mt[66]=Vt[66]=19;At[104]=Ir[104]=2;mt[104]=Vt[104]=19;nt[144]=Ht[144]=10;Vt[144]=Lr[144]=23;nt[26]=Ht[26]=10;Vt[26]=Lr[26]=23;Qe[36]=Lr[36]=5;At[36]=Ir[36]=2;Qe[134]=Lr[134]=5;At[134]=Ir[134]=2;nt[9]=Ht[9]=10;Qe[9]=mt[9]=13;nt[161]=Ht[161]=10;Qe[161]=mt[161]=13;Qe[37]=Lr[37]=5;Ht[37]=Ir[37]=20;Qe[133]=Lr[133]=5;Ht[133]=Ir[133]=20;At[148]=Ht[148]=16;Vt[148]=Lr[148]=23;At[22]=Ht[22]=16;Vt[22]=Lr[22]=23;nt[82]=At[82]=8;mt[82]=Vt[82]=19;nt[88]=At[88]=8;mt[88]=Vt[88]=19;nt[73]=Ir[73]=0;Qe[73]=mt[73]=13;nt[97]=Ir[97]=0;Qe[97]=mt[97]=13;nt[145]=mt[145]=9;Ht[145]=Lr[145]=21;nt[25]=mt[25]=9;Ht[25]=Lr[25]=21;Qe[70]=Ir[70]=1;At[70]=Vt[70]=17;Qe[100]=Ir[100]=1;At[100]=Vt[100]=17;nt[34]=mt[34]=9;Qe[34]=At[34]=12;Ht[34]=Lr[34]=21;Vt[34]=Ir[34]=22;nt[136]=Lr[136]=4;Qe[136]=Ir[136]=1;At[136]=Vt[136]=17;mt[136]=Ht[136]=18;nt[35]=Lr[35]=4;Qe[35]=At[35]=12;mt[35]=Ht[35]=18;Vt[35]=Ir[35]=22;nt[153]=Lr[153]=4;mt[153]=Ht[153]=18;Qe[102]=At[102]=12;Vt[102]=Ir[102]=22;nt[155]=mt[155]=9;Ht[155]=Lr[155]=23;Qe[103]=Ir[103]=1;At[103]=Vt[103]=17;nt[152]=Lr[152]=4;At[152]=Vt[152]=17;mt[152]=Ht[152]=18;nt[156]=At[156]=8;mt[156]=Ht[156]=18;Vt[156]=Lr[156]=23;nt[137]=Lr[137]=4;Qe[137]=Ir[137]=1;mt[137]=Ht[137]=18;nt[139]=Lr[139]=4;Qe[139]=mt[139]=13;Ht[139]=Ir[139]=20;nt[98]=mt[98]=9;Qe[98]=At[98]=12;Vt[98]=Ir[98]=22;nt[99]=Ir[99]=0;Qe[99]=At[99]=12;mt[99]=Vt[99]=19;Qe[38]=At[38]=12;Ht[38]=Lr[38]=21;Vt[38]=Ir[38]=22;Qe[39]=Lr[39]=5;At[39]=Ht[39]=16;Vt[39]=Ir[39]=22;var Xe=[];Xe[1]=Xe[169]=E4;Xe[4]=Xe[166]=T4;Xe[16]=Xe[154]=S4;Xe[64]=Xe[106]=A4;Xe[168]=Xe[2]=b4;Xe[162]=Xe[8]=I4;Xe[138]=Xe[32]=D4;Xe[42]=Xe[128]=P4;Xe[5]=Xe[165]=K2e;Xe[20]=Xe[150]=Z2e;Xe[80]=Xe[90]=Q2e;Xe[65]=Xe[105]=J2e;Xe[160]=Xe[10]=$2e;Xe[130]=Xe[40]=e3e;Xe[85]=t3e;Xe[101]=Xe[69]=n3e;Xe[149]=Xe[21]=r3e;Xe[86]=Xe[84]=i3e;Xe[89]=Xe[81]=o3e;Xe[96]=Xe[74]=a3e;Xe[24]=Xe[146]=s3e;Xe[6]=Xe[164]=u3e;Xe[129]=Xe[41]=l3e;Xe[66]=Xe[104]=c3e;Xe[144]=Xe[26]=f3e;Xe[36]=Xe[134]=h3e;Xe[9]=Xe[161]=d3e;Xe[37]=Xe[133]=p3e;Xe[148]=Xe[22]=m3e;Xe[82]=Xe[88]=g3e;Xe[73]=Xe[97]=_3e;Xe[145]=Xe[25]=y3e;Xe[70]=Xe[100]=v3e;Xe[34]=function(e){return[P4(e),I4(e)]};Xe[35]=C3e;Xe[136]=function(e){return[D4(e),b4(e)]};Xe[153]=function(e){return[S4(e),E4(e)]};Xe[102]=function(e){return[T4(e),A4(e)]};Xe[155]=x3e;Xe[103]=w3e;Xe[152]=function(e){return[S4(e),b4(e)]};Xe[156]=E3e;Xe[137]=function(e){return[D4(e),E4(e)]};Xe[139]=T3e;Xe[98]=function(e){return[I4(e),A4(e)]};Xe[99]=S3e;Xe[38]=function(e){return[T4(e),P4(e)]};Xe[39]=A3e;function W(e,t,n){return(e-t)/(n-t)}function Fz(e){return e.constructor.toString().indexOf("Array")>-1}function b3e(e,t,n){for(var r=e.length-1,o=e[0].length-1,a={rows:r,cols:o,cells:[]},s=t+Math.abs(n),u=0;u<r;++u){a.cells[u]=[];for(var l=0;l<o;++l){var c=0,f=e[u+1][l],h=e[u+1][l+1],d=e[u][l+1],p=e[u][l];if(!(isNaN(f)||isNaN(h)||isNaN(d)||isNaN(p))){c|=f<t?0:f>s?128:64,c|=h<t?0:h>s?32:16,c|=d<t?0:d>s?8:4,c|=p<t?0:p>s?2:1;var g=+c,y=0;if(c===17||c===18||c===33||c===34||c===38||c===68||c===72||c===98||c===102||c===132||c===136||c===137||c===152||c===153){var v=(f+h+d+p)/4;y=v>s?2:v<t?0:1,c===34?y===1?c=35:y===0&&(c=136):c===136?y===1?(c=35,y=4):y===0&&(c=34):c===17?y===1?(c=155,y=4):y===0&&(c=153):c===68?y===1?(c=103,y=4):y===0&&(c=102):c===153?y===1&&(c=155):c===102?y===1&&(c=103):c===152?y<2&&(c=156,y=1):c===137?y<2&&(c=139,y=1):c===98?y<2&&(c=99,y=1):c===38?y<2&&(c=39,y=1):c===18?y>0?(c=156,y=4):c=152:c===33?y>0?(c=139,y=4):c=137:c===72?y>0?(c=99,y=4):c=98:c===132&&(y>0?(c=39,y=4):c=38)}if(c!=0&&c!=170){var w,C,E,S,A,D,P,M;w=C=E=S=A=D=P=M=.5;var I=[];c===1?(E=1-W(t,d,p),M=1-W(t,f,p),I.push(mt[c])):c===169?(E=W(s,p,d),M=W(s,p,f),I.push(mt[c])):c===4?(D=1-W(t,h,d),S=W(t,p,d),I.push(Qe[c])):c===166?(D=W(s,d,h),S=1-W(s,d,p),I.push(Qe[c])):c===16?(A=W(t,d,h),C=W(t,f,h),I.push(nt[c])):c===154?(A=1-W(s,h,d),C=1-W(s,h,f),I.push(nt[c])):c===64?(P=W(t,p,f),w=1-W(t,h,f),I.push(Vt[c])):c===106?(P=1-W(s,f,p),w=W(s,f,h),I.push(Vt[c])):c===168?(S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),I.push(At[c]),I.push(mt[c])):c===2?(S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),I.push(At[c]),I.push(mt[c])):c===162?(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),I.push(At[c]),I.push(mt[c])):c===8?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),I.push(nt[c]),I.push(Qe[c])):c===138?(A=1-W(t,h,d),D=1-W(s,h,d),w=1-W(s,h,f),C=1-W(t,h,f),I.push(nt[c]),I.push(Qe[c])):c===32?(A=W(s,d,h),D=W(t,d,h),w=W(t,f,h),C=W(s,f,h),I.push(nt[c]),I.push(Qe[c])):c===42?(M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),I.push(Ht[c]),I.push(Vt[c])):c===128&&(M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),I.push(Ht[c]),I.push(Vt[c])),c===5?(D=1-W(t,h,d),M=1-W(t,f,p),I.push(Qe[c])):c===165?(D=W(s,d,h),M=W(s,p,f),I.push(Qe[c])):c===20?(S=W(t,p,d),C=W(t,f,h),I.push(At[c])):c===150?(S=1-W(s,d,p),C=1-W(s,h,f),I.push(At[c])):c===80?(A=W(t,d,h),P=W(t,p,f),I.push(nt[c])):c===90?(A=1-W(s,h,d),P=1-W(s,f,p),I.push(nt[c])):c===65?(E=1-W(t,d,p),w=1-W(t,h,f),I.push(mt[c])):c===105?(E=W(s,p,d),w=W(s,f,h),I.push(mt[c])):c===160?(A=W(s,d,h),D=W(t,d,h),M=W(t,p,f),P=W(s,p,f),I.push(nt[c]),I.push(Qe[c])):c===10?(A=1-W(t,h,d),D=1-W(s,h,d),M=1-W(s,f,p),P=1-W(t,f,p),I.push(nt[c]),I.push(Qe[c])):c===130?(S=1-W(t,d,p),E=1-W(s,d,p),w=1-W(s,h,f),C=1-W(t,h,f),I.push(At[c]),I.push(mt[c])):c===40?(S=W(s,p,d),E=W(t,p,d),w=W(t,f,h),C=W(s,f,h),I.push(At[c]),I.push(mt[c])):c===101?(D=W(s,d,h),w=W(s,f,h),I.push(Qe[c])):c===69?(D=1-W(t,h,d),w=1-W(t,h,f),I.push(Qe[c])):c===149?(M=W(s,p,f),C=1-W(s,h,f),I.push(Ht[c])):c===21?(M=1-W(t,f,p),C=W(t,f,h),I.push(Ht[c])):c===86?(S=1-W(s,d,p),P=1-W(s,f,p),I.push(At[c])):c===84?(S=W(t,p,d),P=W(t,p,f),I.push(At[c])):c===89?(A=1-W(s,h,d),E=W(s,p,d),I.push(mt[c])):c===81?(A=W(t,d,h),E=1-W(t,d,p),I.push(mt[c])):c===96?(A=W(s,d,h),D=W(t,d,h),P=W(t,p,f),w=W(s,f,h),I.push(nt[c]),I.push(Qe[c])):c===74?(A=1-W(t,h,d),D=1-W(s,h,d),P=1-W(s,f,p),w=1-W(t,h,f),I.push(nt[c]),I.push(Qe[c])):c===24?(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),C=W(t,f,h),I.push(nt[c]),I.push(mt[c])):c===146?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),C=1-W(s,h,f),I.push(nt[c]),I.push(mt[c])):c===6?(D=1-W(t,h,d),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),I.push(Qe[c]),I.push(At[c])):c===164?(D=W(s,d,h),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),I.push(Qe[c]),I.push(At[c])):c===129?(E=1-W(t,d,p),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),I.push(mt[c]),I.push(Ht[c])):c===41?(E=W(s,p,d),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),I.push(mt[c]),I.push(Ht[c])):c===66?(S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=1-W(t,h,f),I.push(At[c]),I.push(mt[c])):c===104?(S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=W(s,f,h),I.push(mt[c]),I.push(Ir[c])):c===144?(A=W(t,d,h),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f),I.push(nt[c]),I.push(Vt[c])):c===26?(A=1-W(s,h,d),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h),I.push(nt[c]),I.push(Vt[c])):c===36?(D=W(s,d,h),S=W(t,p,d),w=W(t,f,h),C=W(s,f,h),I.push(Qe[c]),I.push(At[c])):c===134?(D=1-W(t,h,d),S=1-W(s,d,p),w=1-W(s,h,f),C=1-W(t,h,f),I.push(Qe[c]),I.push(At[c])):c===9?(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=1-W(t,f,p),I.push(nt[c]),I.push(Qe[c])):c===161?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=W(s,p,f),I.push(nt[c]),I.push(Qe[c])):c===37?(D=W(s,d,h),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h),I.push(Qe[c]),I.push(Ht[c])):c===133?(D=1-W(t,h,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f),I.push(Qe[c]),I.push(Ht[c])):c===148?(S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f),I.push(At[c]),I.push(Vt[c])):c===22?(S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h),I.push(At[c]),I.push(Vt[c])):c===82?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),I.push(nt[c]),I.push(mt[c])):c===88?(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),I.push(nt[c]),I.push(mt[c])):c===73?(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),w=1-W(t,h,f),I.push(nt[c]),I.push(Qe[c])):c===97?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),w=W(s,f,h),I.push(nt[c]),I.push(Qe[c])):c===145?(A=W(t,d,h),E=1-W(t,d,p),M=W(s,p,f),C=1-W(s,h,f),I.push(nt[c]),I.push(Ht[c])):c===25?(A=1-W(s,h,d),E=W(s,p,d),M=1-W(t,f,p),C=W(t,f,h),I.push(nt[c]),I.push(Ht[c])):c===70?(D=1-W(t,h,d),S=1-W(s,d,p),P=1-W(s,f,p),w=1-W(t,h,f),I.push(Qe[c]),I.push(At[c])):c===100?(D=W(s,d,h),S=W(t,p,d),P=W(t,p,f),w=W(s,f,h),I.push(Qe[c]),I.push(At[c])):c===34?(y===0?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),I.push(nt[c]),I.push(Qe[c]),I.push(Ht[c]),I.push(Vt[c])):c===35?(y===4?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),I.push(nt[c]),I.push(Qe[c]),I.push(mt[c]),I.push(Vt[c])):c===136?(y===0?(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),I.push(nt[c]),I.push(Qe[c]),I.push(Ht[c]),I.push(Vt[c])):c===153?(y===0?(A=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),C=1-W(s,h,f)),I.push(nt[c]),I.push(mt[c])):c===102?(y===0?(D=1-W(t,h,d),S=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),I.push(Qe[c]),I.push(Vt[c])):c===155?(y===4?(A=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),C=1-W(s,h,f)),I.push(nt[c]),I.push(Ht[c])):c===103?(y===4?(D=1-W(t,h,d),S=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),I.push(Qe[c]),I.push(At[c])):c===152?(y===0?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f)),I.push(nt[c]),I.push(At[c]),I.push(mt[c])):c===156?(y===4?(A=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),C=W(t,f,h)):(A=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),M=W(t,p,f),P=W(s,p,f),C=1-W(s,h,f)),I.push(nt[c]),I.push(mt[c]),I.push(Vt[c])):c===137?(y===0?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),I.push(nt[c]),I.push(Qe[c]),I.push(mt[c])):c===139?(y===4?(A=W(s,d,h),D=W(t,d,h),E=1-W(t,d,p),M=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)):(A=1-W(t,h,d),D=1-W(s,h,d),E=W(s,p,d),M=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)),I.push(nt[c]),I.push(Qe[c]),I.push(Ht[c])):c===98?(y===0?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),I.push(nt[c]),I.push(Qe[c]),I.push(Vt[c])):c===99?(y===4?(A=1-W(t,h,d),D=1-W(s,h,d),S=W(s,p,d),E=W(t,p,d),P=W(t,p,f),w=1-W(t,h,f)):(A=W(s,d,h),D=W(t,d,h),S=1-W(t,d,p),E=1-W(s,d,p),P=1-W(s,f,p),w=W(s,f,h)),I.push(nt[c]),I.push(Qe[c]),I.push(mt[c])):c===38?(y===0?(D=1-W(t,h,d),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),I.push(Qe[c]),I.push(Ht[c]),I.push(Vt[c])):c===39?(y===4?(D=1-W(t,h,d),S=W(t,p,d),M=W(t,p,f),P=W(s,p,f),w=1-W(s,h,f),C=1-W(t,h,f)):(D=W(s,d,h),S=1-W(s,d,p),M=1-W(s,f,p),P=1-W(t,f,p),w=W(t,f,h),C=W(s,f,h)),I.push(Qe[c]),I.push(At[c]),I.push(Vt[c])):c===85&&(A=1,D=0,S=1,E=0,M=0,P=1,w=0,C=1),(w<0||w>1||C<0||C>1||A<0||A>1||S<0||S>1||M<0||M>1||P<0||P>1)&&console.log("MarchingSquaresJS-isoBands: "+c+" "+g+" "+f+","+h+","+d+","+p+" "+y+" "+w+" "+C+" "+A+" "+D+" "+S+" "+E+" "+M+" "+P),a.cells[u][l]={cval:c,cval_real:g,flipped:y,topleft:w,topright:C,righttop:A,rightbottom:D,bottomright:S,bottomleft:E,leftbottom:M,lefttop:P,edges:I}}}}}return a}function I3e(e){for(var t=[],n=e.rows,r=e.cols,o=[],a=0;a<n;a++)for(var s=0;s<r;s++)if(typeof e.cells[a][s]<"u"&&e.cells[a][s].edges.length>0){var u=e.cells[a][s],l=M3e(u),c=null,f=s,h=a;l!==null&&o.push([l.p[0]+f,l.p[1]+h]);do{if(c=L3e(e.cells[h][f],l.x,l.y,l.o),c!==null)o.push([c.p[0]+f,c.p[1]+h]),f+=c.x,h+=c.y,l=c;else break;if(h<0||h>=n||f<0||f>=r||typeof e.cells[h][f]>"u"){f-=c.x,h-=c.y;var d=D3e(e,f,h,c.x,c.y,c.o);if(d!==null)d.path.forEach(function(p){o.push(p)}),f=d.i,h=d.j,l=d;else break}}while(typeof e.cells[h][f]<"u"&&e.cells[h][f].edges.length>0);t.push(o),o=[],e.cells[a][s].edges.length>0&&s--}return t}function D3e(e,t,n,r,o,a){for(var s=e.cells[n][t],u=s.cval_real,l=t+r,c=n+o,f=[],h=!1;!h;){if(typeof e.cells[c]>"u"||typeof e.cells[c][l]>"u")if(c-=o,l-=r,s=e.cells[c][l],u=s.cval_real,o===-1)if(a===0)if(u&du)f.push([l,c]),r=-1,o=0,a=0;else if(u&zs)f.push([l+1,c]),r=1,o=0,a=0;else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&du)f.push([l,c]),r=-1,o=0,a=0;else if(u&zs){f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else{f.push([l+s.bottomleft,c]),r=0,o=1,a=0,h=!0;break}else if(o===1)if(a===0)if(u&Th)f.push([l+1,c+1]),r=1,o=0,a=1;else if(u&Gu){f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else{f.push([l+s.topright,c+1]),r=0,o=-1,a=1,h=!0;break}else u&Th?(f.push([l+1,c+1]),r=1,o=0,a=1):(f.push([l+1,c+1]),r=1,o=0,a=1);else if(r===-1)if(a===0)if(u&Gu)f.push([l,c+1]),r=0,o=1,a=0;else if(u&du){f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{f.push([l,c+s.lefttop]),r=1,o=0,a=1,h=!0;break}else if(u&Gu)f.push([l,c+1]),r=0,o=1,a=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(r===1)if(a===0)if(u&zs)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else if(u&zs)f.push([l+1,c]),r=0,o=-1,a=1;else if(u&Th){f.push([l+1,c+s.righttop]),r=-1,o=0,a=1;break}else{f.push([l+1,c+s.rightbottom]),r=-1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(s=e.cells[c][l],u=s.cval_real,r===-1)if(a===0)if(typeof e.cells[c-1]<"u"&&typeof e.cells[c-1][l]<"u")r=0,o=-1,a=1;else if(u&du)f.push([l,c]);else{f.push([l+s.bottomright,c]),r=0,o=1,a=1,h=!0;break}else if(u&Gu)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+c);break}else if(r===1)if(a===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof e.cells[c+1]<"u"&&typeof e.cells[c+1][l]<"u")r=0,o=1,a=0;else if(u&Th)f.push([l+1,c+1]),r=1,o=0,a=1;else{f.push([l+s.topleft,c+1]),r=0,o=-1,a=0,h=!0;break}else if(o===-1)if(a===1)if(typeof e.cells[c][l+1]<"u")r=1,o=0,a=1;else if(u&zs)f.push([l+1,c]),r=0,o=-1,a=1;else{f.push([l+1,c+s.righttop]),r=-1,o=0,a=1,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(o===1)if(a===0)if(typeof e.cells[c][l-1]<"u")r=-1,o=0,a=0;else if(u&Gu)f.push([l,c+1]),r=0,o=1,a=0;else{f.push([l,c+s.leftbottom]),r=1,o=0,a=0,h=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(l+=r,c+=o,l===t&&c===n)break}return{path:f,i:l,j:c,x:r,y:o,o:a}}function P3e(e,t){delete e.edges[t];for(var n=t+1;n<e.edges.length;n++)e.edges[n-1]=e.edges[n];e.edges.pop()}function M3e(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],n=e.cval_real;switch(t){case 0:return n&Th?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return n&zs?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return n&zs?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return n&du?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return n&Th?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return n&zs?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return n&zs?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return n&du?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return n&zs?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return n&du?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return n&du?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return n&Gu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return n&zs?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return n&du?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return n&du?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return n&Gu?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return n&zs?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return n&Gu?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return n&du?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return n&Gu?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return n&Gu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return n&Th?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return n&Gu?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return n&Th?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e);break}}return null}function L3e(e,t,n,r){var o,a,s,u,l=e.cval,c;switch(t){case-1:switch(r){case 0:o=Qe[l],s=dr[l],u=pr[l],c=mr[l];break;default:o=nt[l],s=cr[l],u=fr[l],c=hr[l];break}break;case 1:switch(r){case 0:o=Ht[l],s=Sr[l],u=Ar[l],c=br[l];break;default:o=Vt[l],s=wr[l],u=Er[l],c=Tr[l];break}break;default:switch(n){case-1:switch(r){case 0:o=Ir[l],s=ir[l],u=or[l],c=ar[l];break;default:o=Lr[l],s=sr[l],u=ur[l],c=lr[l];break}break;case 1:switch(r){case 0:o=mt[l],s=gr[l],u=_r[l],c=yr[l];break;default:o=At[l],s=vr[l],u=Cr[l],c=xr[l];break}break;default:break}break}if(a=e.edges.indexOf(o),typeof e.edges[a]<"u")P3e(e,a);else return null;switch(l=e.cval_real,o){case 0:l&Th?(t=e.topleft,n=1):(t=1,n=e.righttop);break;case 1:l&zs?(t=1,n=e.rightbottom):(t=e.topleft,n=1);break;case 2:l&zs?(t=e.topleft,n=1):(t=e.bottomright,n=0);break;case 3:l&du?(t=e.bottomleft,n=0):(t=e.topleft,n=1);break;case 4:l&Th?(t=e.topright,n=1):(t=1,n=e.righttop);break;case 5:l&zs?(t=1,n=e.rightbottom):(t=e.topright,n=1);break;case 6:l&zs?(t=e.topright,n=1):(t=e.bottomright,n=0);break;case 7:l&du?(t=e.bottomleft,n=0):(t=e.topright,n=1);break;case 8:l&zs?(t=1,n=e.righttop):(t=e.bottomright,n=0);break;case 9:l&du?(t=e.bottomleft,n=0):(t=1,n=e.righttop);break;case 10:l&du?(t=1,n=e.righttop):(t=0,n=e.leftbottom);break;case 11:l&Gu?(t=0,n=e.lefttop):(t=1,n=e.righttop);break;case 12:l&zs?(t=1,n=e.rightbottom):(t=e.bottomright,n=0);break;case 13:l&du?(t=e.bottomleft,n=0):(t=1,n=e.rightbottom);break;case 14:l&du?(t=1,n=e.rightbottom):(t=0,n=e.leftbottom);break;case 15:l&Gu?(t=0,n=e.lefttop):(t=1,n=e.rightbottom);break;case 16:l&zs?(t=0,n=e.leftbottom):(t=e.bottomright,n=0);break;case 17:l&Gu?(t=0,n=e.lefttop):(t=e.bottomright,n=0);break;case 18:l&du?(t=e.bottomleft,n=0):(t=0,n=e.leftbottom);break;case 19:l&Gu?(t=0,n=e.lefttop):(t=e.bottomleft,n=0);break;case 20:l&Gu?(t=0,n=e.leftbottom):(t=e.topleft,n=1);break;case 21:l&Th?(t=e.topright,n=1):(t=0,n=e.leftbottom);break;case 22:l&Gu?(t=0,n=e.lefttop):(t=e.topleft,n=1);break;case 23:l&Th?(t=e.topright,n=1):(t=0,n=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return(typeof t>"u"||typeof n>"u"||typeof s>"u"||typeof u>"u"||typeof c>"u")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+n+" "+s+" "+u+" "+c)),{p:[t,n],x:s,y:u,o:c}}function R3e(e){var t=[],n=0;return e.cells.forEach(function(r,o){r.forEach(function(a,s){if(typeof a<"u"){var u=Xe[a.cval](a);typeof u=="object"&&Fz(u)?typeof u[0]=="object"&&Fz(u[0])?typeof u[0][0]=="object"&&Fz(u[0][0])?u.forEach(function(l){l.forEach(function(c){c[0]+=s,c[1]+=o}),t[n++]=l}):(u.forEach(function(l){l[0]+=s,l[1]+=o}),t[n++]=u):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}function O3e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",o=n.commonProperties||{},a=n.breaksProperties||[];if(Ud(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!gt(o))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=Y2e(e,{zProperty:r,flip:!0}),u=N3e(s,t,r);u=B3e(u,s,e);var l=u.map(function(c,f){if(a[f]&&!gt(a[f]))throw new Error("Each mappedProperty is required to be an Object");var h=Object.assign({},o,a[f]);h[r]=c[r];var d=Kx(c.groupedRings,h);return d});return Ft(l)}function N3e(e,t,n){for(var r=[],o=1;o<t.length;o++){var a=+t[o-1],s=+t[o],u=j2e(e,a,s-a),l=F3e(u),c=z3e(l),f={};f.groupedRings=c,f[n]=a+"-"+s,r.push(f)}return r}function B3e(e,t,n){var r=Ia(n),o=r[2]-r[0],a=r[3]-r[1],s=r[0],u=r[1],l=t[0].length-1,c=t.length-1,f=o/l,h=a/c,d=function(p){p[0]=p[0]*f+s,p[1]=p[1]*h+u};return e.forEach(function(p){p.groupedRings.forEach(function(g){g.forEach(function(y){y.forEach(d)})})}),e}function F3e(e){var t=[],n=[];e.forEach(function(o){var a=fA(rr([o]));n.push(a),t.push({ring:o,area:a})}),n.sort(function(o,a){return a-o});var r=[];return n.forEach(function(o){for(var a=0;a<t.length;a++)if(t[a].area===o){r.push(t[a].ring),t.splice(a,1);break}}),r}function z3e(e){for(var t=e.map(function(l){return{lrCoordinates:l,grouped:!1}}),n=[];!k3e(t);)for(var r=0;r<t.length;r++)if(!t[r].grouped){var o=[];o.push(t[r].lrCoordinates),t[r].grouped=!0;for(var a=rr([t[r].lrCoordinates]),s=r+1;s<t.length;s++)if(!t[s].grouped){var u=rr([t[s].lrCoordinates]);V3e(u,a)&&(o.push(t[s].lrCoordinates),t[s].grouped=!0)}n.push(o)}return n}function V3e(e,t){for(var n=C4(e),r=0;r<n.features.length;r++)if(!xo(n.features[r],t))return!1;return!0}function k3e(e){for(var t=0;t<e.length;t++)if(e[t].grouped===!1)return!1;return!0}function zne(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.pivot,o=n.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");return t===0||(r||(r=_v(e)),(o===!1||o===void 0)&&(e=vu(e)),Qa(e,function(a){var s=$0(r,a),u=s+t,l=nR(r,a),c=Et(bx(r,l,u));a[0]=c[0],a[1]=c[1]})),e}function Vne(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.origin,o=n.mutate;if(!e)throw new Error("geojson required");if(typeof t!="number"||t===0)throw new Error("invalid factor");var a=Array.isArray(r)||typeof r=="object";return o!==!0&&(e=vu(e)),e.type==="FeatureCollection"&&!a?(di(e,function(s,u){e.features[u]=ote(s,t,r)}),e):ote(e,t,r)}function ote(e,t,n){var r=Fi(e)==="Point";return n=G3e(e,n),t===1||r||Qa(e,function(o){var a=nR(n,o),s=$0(n,o),u=a*t,l=Et(bx(n,u,s));o[0]=l[0],o[1]=l[1],o.length===3&&(o[2]*=t)}),e}function G3e(e,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return co(t);var n=e.bbox?e.bbox:Ia(e),r=n[0],o=n[1],a=n[2],s=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return Wr([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return Wr([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return Wr([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Wr([a,s]);case"center":return eR(e);case void 0:case null:case"centroid":return _v(e);default:throw new Error("invalid origin")}}function U3e(e,t,n,r){if(r=r||{},!gt(r))throw new Error("options is invalid");var o=r.units,a=r.zTranslation,s=r.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(a&&typeof a!="number"&&isNaN(a))throw new Error("zTranslation is not a number");if(a=a!==void 0?a:0,t===0&&a===0)return e;if(n==null||isNaN(n))throw new Error("direction is required");return t<0&&(t=-t,n=-n),(s===!1||s===void 0)&&(e=vu(e)),Qa(e,function(u){var l=Et(bx(u,t,n,{units:o}));u[0]=l[0],u[1]=l[1],a&&u.length===3&&(u[2]+=a)}),e}function NL(e){var t=e[0],n=e[1];return[n[0]-t[0],n[1]-t[1]]}function $z(e,t){return e[0]*t[1]-t[0]*e[1]}function H3e(e,t){return[e[0]+t[0],e[1]+t[1]]}function q3e(e,t){return[e[0]-t[0],e[1]-t[1]]}function W3e(e,t){return[e*t[0],e*t[1]]}function Y3e(e,t){var n=e[0],r=NL(e),o=t[0],a=NL(t),s=$z(r,a),u=q3e(o,n),l=$z(u,a),c=l/s,f=H3e(n,W3e(c,r));return f}function X3e(e,t){var n=NL(e),r=NL(t);return $z(n,r)===0}function j3e(e,t){return X3e(e,t)?!1:Y3e(e,t)}function K3e(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var o=Fi(e),a=e.properties;switch(o){case"LineString":return ate(e,t,r);case"MultiLineString":var s=[];return ba(e,function(u){s.push(ate(u,t,r).geometry.coordinates)}),p_(s,a);default:throw new Error("geometry "+o+" is not supported")}}function ate(e,t,n){var r=[],o=DL(t,n),a=Et(e),s=[];return a.forEach(function(u,l){if(l!==a.length-1){var c=Z3e(u,a[l+1],o);if(r.push(c),l>0){var f=r[l-1],h=j3e(c,f);h!==!1&&(f[1]=h,c[0]=h),s.push(f[0]),l===a.length-2&&(s.push(c[0]),s.push(c[1]))}a.length===2&&(s.push(c[0]),s.push(c[1]))}}),Bi(s,e.properties)}function Z3e(e,t,n){var r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),o=e[0]+n*(t[1]-e[1])/r,a=t[0]+n*(t[1]-e[1])/r,s=e[1]+n*(e[0]-t[0])/r,u=t[1]+n*(e[0]-t[0])/r;return[[o,s],[a,u]]}function M4(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],a=n[0]-t[0],s=n[1]-t[1];return Math.sign(r*s-a*o)}function Q3e(e,t){var n=e.geometry.coordinates.map(function(s){return s[0]}),r=e.geometry.coordinates.map(function(s){return s[1]}),o=t.geometry.coordinates.map(function(s){return s[0]}),a=t.geometry.coordinates.map(function(s){return s[1]});return Math.max(null,n)===Math.max(null,o)&&Math.max(null,r)===Math.max(null,a)&&Math.min(null,n)===Math.min(null,o)&&Math.min(null,r)===Math.min(null,a)}function ste(e,t){return t.geometry.coordinates[0].every(function(n){return xo(Wr(n),e)})}function J3e(e,t){return e[0]===t[0]&&e[1]===t[1]}var $p=function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};$p.buildId=function(t){return t.join(",")};$p.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(n){return n.from.id!==t.from.id})};$p.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(n){return n.to.id!==t.to.id})};$p.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1};$p.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(n,r){var o=n.to,a=r.to;if(o.coordinates[0]-t.coordinates[0]>=0&&a.coordinates[0]-t.coordinates[0]<0)return 1;if(o.coordinates[0]-t.coordinates[0]<0&&a.coordinates[0]-t.coordinates[0]>=0)return-1;if(o.coordinates[0]-t.coordinates[0]===0&&a.coordinates[0]-t.coordinates[0]===0)return o.coordinates[1]-t.coordinates[1]>=0||a.coordinates[1]-t.coordinates[1]>=0?o.coordinates[1]-a.coordinates[1]:a.coordinates[1]-o.coordinates[1];var s=M4(t.coordinates,o.coordinates,a.coordinates);if(s<0)return 1;if(s>0)return-1;var u=Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2),l=Math.pow(a.coordinates[0]-t.coordinates[0],2)+Math.pow(a.coordinates[1]-t.coordinates[1],2);return u-l}),this.outerEdgesSorted=!0)};$p.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges};$p.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]};$p.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var i_=function(t,n){this.from=t,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};i_.prototype.getSymetric=function(){return this.symetric||(this.symetric=new i_(this.to,this.from),this.symetric.symetric=this),this.symetric};i_.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)};i_.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id};i_.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"};i_.prototype.toLineString=function(){return Bi([this.from.coordinates,this.to.coordinates])};i_.prototype.compareTo=function(t){return M4(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var oc=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},kne={length:{configurable:!0}};oc.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0};oc.prototype.get=function(t){return this.edges[t]};kne.length.get=function(){return this.edges.length};oc.prototype.forEach=function(t){this.edges.forEach(t)};oc.prototype.map=function(t){return this.edges.map(t)};oc.prototype.some=function(t){return this.edges.some(t)};oc.prototype.isValid=function(){return!0};oc.prototype.isHole=function(){var t=this,n=this.edges.reduce(function(s,u,l){return u.from.coordinates[1]>t.edges[s].from.coordinates[1]&&(s=l),s},0),r=(n===0?this.length:n)-1,o=(n+1)%this.length,a=M4(this.edges[r].from.coordinates,this.edges[n].from.coordinates,this.edges[o].from.coordinates);return a===0?this.edges[r].from.coordinates[0]>this.edges[o].from.coordinates[0]:a>0};oc.prototype.toMultiPoint=function(){return KL(this.edges.map(function(t){return t.from.coordinates}))};oc.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(n){return n.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=rr([t])};oc.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=_ne(this.toPolygon())};oc.findEdgeRingContaining=function(t,n){var r=t.getEnvelope(),o,a;return n.forEach(function(s){var u=s.getEnvelope();if(a&&(o=a.getEnvelope()),!Q3e(u,r)&&ste(u,r)){var l=t.map(function(c){return c.from.coordinates}).find(function(c){return!s.some(function(f){return J3e(c,f.from.coordinates)})});l&&s.inside(Wr(l))&&(!a||ste(o,u))&&(a=s)}}),a};oc.prototype.inside=function(t){return xo(t,this.toPolygon())};Object.defineProperties(oc.prototype,kne);function $3e(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var wl=function(){this.edges=[],this.nodes={}};wl.fromGeoJson=function(t){$3e(t);var n=new wl;return ba(t,function(r){oA(r,"LineString","Graph::fromGeoJson"),QL(r,function(o,a){if(o){var s=n.getNode(o),u=n.getNode(a);n.addEdge(s,u)}return a})}),n};wl.prototype.getNode=function(t){var n=$p.buildId(t),r=this.nodes[n];return r||(r=this.nodes[n]=new $p(t)),r};wl.prototype.addEdge=function(t,n){var r=new i_(t,n),o=r.getSymetric();this.edges.push(r),this.edges.push(o)};wl.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(n){return t.nodes[n]}).forEach(function(n){return t._removeIfDangle(n)})};wl.prototype._removeIfDangle=function(t){var n=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map(function(o){return o.to});this.removeNode(t),r.forEach(function(o){return n._removeIfDangle(o)})}};wl.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(n){n.label===n.symetric.label&&(t.removeEdge(n.symetric),t.removeEdge(n))})};wl.prototype._computeNextCWEdges=function(t){var n=this;typeof t>"u"?Object.keys(this.nodes).forEach(function(r){return n._computeNextCWEdges(n.nodes[r])}):t.getOuterEdges().forEach(function(r,o){t.getOuterEdge((o===0?t.getOuterEdges().length:o)-1).symetric.next=r})};wl.prototype._computeNextCCWEdges=function(t,n){for(var r=t.getOuterEdges(),o,a,s=r.length-1;s>=0;--s){var u=r[s],l=u.symetric,c=void 0,f=void 0;u.label===n&&(c=u),l.label===n&&(f=l),!(!c||!f)&&(f&&(a=f),c&&(a&&(a.next=c,a=void 0),o||(o=c)))}a&&(a.next=o)};wl.prototype._findLabeledEdgeRings=function(){var t=[],n=0;return this.edges.forEach(function(r){if(!(r.label>=0)){t.push(r);var o=r;do o.label=n,o=o.next;while(!r.isEqual(o));n++}}),t};wl.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){t._findIntersectionNodes(r).forEach(function(o){t._computeNextCCWEdges(o,r.label)})});var n=[];return this.edges.forEach(function(r){r.ring||n.push(t._findEdgeRing(r))}),n};wl.prototype._findIntersectionNodes=function(t){var n=[],r=t,o=function(){var a=0;r.from.getOuterEdges().forEach(function(s){s.label===t.label&&++a}),a>1&&n.push(r.from),r=r.next};do o();while(!t.isEqual(r));return n};wl.prototype._findEdgeRing=function(t){var n=t,r=new oc;do r.push(n),n.ring=r,n=n.next;while(!t.isEqual(n));return r};wl.prototype.removeNode=function(t){var n=this;t.getOuterEdges().forEach(function(r){return n.removeEdge(r)}),t.innerEdges.forEach(function(r){return n.removeEdge(r)}),delete this.nodes[t.id]};wl.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(n){return!n.isEqual(t)}),t.deleteEdge()};function eBe(e){var t=wl.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var n=[],r=[];return t.getEdgeRings().filter(function(o){return o.isValid()}).forEach(function(o){o.isHole()?n.push(o):r.push(o)}),n.forEach(function(o){oc.findEdgeRingContaining(o,r)&&r.push(o)}),Ft(r.map(function(o){return o.toPolygon()}))}function tBe(e,t){var n;return ba(e,function(r){ba(t,function(o){if(n===!1)return!1;n=nBe(r.geometry,o.geometry)})}),n}function nBe(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!aBe(e.coordinates,t.coordinates);case"LineString":return!ute(t,e);case"Polygon":return!xo(e,t)}break;case"LineString":switch(t.type){case"Point":return!ute(e,t);case"LineString":return!rBe(e,t);case"Polygon":return!lte(t,e)}break;case"Polygon":switch(t.type){case"Point":return!xo(t,e);case"LineString":return!lte(e,t);case"Polygon":return!iBe(t,e)}}}function ute(e,t){for(var n=0;n<e.coordinates.length-1;n++)if(oBe(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function rBe(e,t){var n=Og(e,t);return n.features.length>0}function lte(e,t){var n=Og(t,LL(e));return n.features.length>0}function iBe(e,t){for(var n=0;n<e.coordinates[0].length;n++)if(xo(e.coordinates[0][n],t))return!0;for(var r=0;r<t.coordinates[0].length;r++)if(xo(t.coordinates[0][r],e))return!0;return!1}function oBe(e,t,n){var r=n[0]-e[0],o=n[1]-e[1],a=t[0]-e[0],s=t[1]-e[1],u=r*s-o*a;return u!==0?!1:Math.abs(a)>=Math.abs(s)?a>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:s>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function aBe(e,t){return e[0]===t[0]&&e[1]===t[1]}function sBe(e,t){var n=Fi(e),r=Fi(t),o=$l(e),a=$l(t),s=Et(e),u=Et(t);switch(n){case"Point":switch(r){case"Point":return L4(s,u);default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"Point":return uBe(o,a);case"MultiPoint":return lBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return Ac(a,o,{ignoreEndVertices:!0});case"LineString":return hBe(o,a);case"MultiPoint":return cBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return xo(a,o,{ignoreBoundary:!0});case"LineString":return dBe(o,a);case"Polygon":return pBe(o,a);case"MultiPoint":return fBe(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function uBe(e,t){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(L4(e.coordinates[n],t.coordinates)){r=!0;break}return r}function lBe(e,t){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,o=0;o<e.coordinates.length;o++)if(L4(t.coordinates[n],e.coordinates[o])){r=!0;break}if(!r)return!1}return!0}function cBe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(Ac(t.coordinates[r],e,{ignoreEndVertices:!0})&&(n=!0),!Ac(t.coordinates[r],e))return!1;return!!n}function fBe(e,t){for(var n=0;n<t.coordinates.length;n++)if(!xo(t.coordinates[n],e,{ignoreBoundary:!0}))return!1;return!0}function hBe(e,t){for(var n=!1,r=0;r<t.coordinates.length;r++)if(Ac({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!0})&&(n=!0),!Ac({type:"Point",coordinates:t.coordinates[r]},e,{ignoreEndVertices:!1}))return!1;return n}function dBe(e,t){var n=!1,r=0,o=Ia(e),a=Ia(t);if(!Gne(o,a))return!1;for(r;r<t.coordinates.length-1;r++){var s=mBe(t.coordinates[r],t.coordinates[r+1]);if(xo({type:"Point",coordinates:s},e,{ignoreBoundary:!0})){n=!0;break}}return n}function pBe(e,t){var n=Ia(e),r=Ia(t);if(!Gne(n,r))return!1;for(var o=0;o<t.coordinates[0].length;o++)if(!xo(t.coordinates[0][o],e))return!1;return!0}function Gne(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function L4(e,t){return e[0]===t[0]&&e[1]===t[1]}function mBe(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function gBe(e,t){var n=Fi(e),r=Fi(t),o=$l(e),a=$l(t);switch(n){case"MultiPoint":switch(r){case"LineString":return cte(o,a);case"Polygon":return hte(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return cte(a,o);case"LineString":return _Be(o,a);case"Polygon":return fte(o,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return hte(a,o);case"LineString":return fte(a,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function cte(e,t){for(var n=!1,r=!1,o=e.coordinates.length,a=0;a<o&&!n&&!r;){for(var s=0;s<t.coordinates.length-1;s++){var u=!0;(s===0||s===t.coordinates.length-2)&&(u=!1),Une(t.coordinates[s],t.coordinates[s+1],e.coordinates[a],u)?n=!0:r=!0}a++}return n&&r}function _Be(e,t){var n=Og(e,t);if(n.features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var o=0;o<t.coordinates.length-1;o++){var a=!0;if((o===0||o===t.coordinates.length-2)&&(a=!1),Une(e.coordinates[r],e.coordinates[r+1],t.coordinates[o],a))return!0}return!1}function fte(e,t){var n=Og(e,LL(t));return n.features.length>0}function hte(e,t){for(var n=!1,r=!1,o=e.coordinates[0].length,a=0;a<o&&n&&r;)xo(Wr(e.coordinates[0][a]),t)?n=!0:r=!0,a++;return r&&r}function Une(e,t,n,r){var o=n[0]-e[0],a=n[1]-e[1],s=t[0]-e[0],u=t[1]-e[1],l=o*u-a*s;return l!==0?!1:r?Math.abs(s)>=Math.abs(u)?s>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:u>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]:Math.abs(s)>=Math.abs(u)?s>0?e[0]<n[0]&&n[0]<t[0]:t[0]<n[0]&&n[0]<e[0]:u>0?e[1]<n[1]&&n[1]<t[1]:t[1]<n[1]&&n[1]<e[1]}var e4=Rg(function(e,t){t=e.exports=typeof Object.keys=="function"?Object.keys:n,t.shim=n;function n(r){var o=[];for(var a in r)o.push(a);return o}}),jzt=e4.shim,BL=Rg(function(e,t){var n=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";t=e.exports=n?r:o,t.supported=r;function r(a){return Object.prototype.toString.call(a)=="[object Arguments]"}t.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}}),Kzt=BL.supported,Zzt=BL.unsupported,yBe=Rg(function(e){var t=Array.prototype.slice,n=e.exports=function(s,u,l){return l||(l={}),s===u?!0:s instanceof Date&&u instanceof Date?s.getTime()===u.getTime():!s||!u||typeof s!="object"&&typeof u!="object"?l.strict?s===u:s==u:a(s,u,l)};function r(s){return s==null}function o(s){return!(!s||typeof s!="object"||typeof s.length!="number"||typeof s.copy!="function"||typeof s.slice!="function"||s.length>0&&typeof s[0]!="number")}function a(s,u,l){var c,f;if(r(s)||r(u)||s.prototype!==u.prototype)return!1;if(BL(s))return BL(u)?(s=t.call(s),u=t.call(u),n(s,u,l)):!1;if(o(s)){if(!o(u)||s.length!==u.length)return!1;for(c=0;c<s.length;c++)if(s[c]!==u[c])return!1;return!0}try{var h=e4(s),d=e4(u)}catch{return!1}if(h.length!=d.length)return!1;for(h.sort(),d.sort(),c=h.length-1;c>=0;c--)if(h[c]!=d[c])return!1;for(c=h.length-1;c>=0;c--)if(f=h[c],!n(s[f],u[f],l))return!1;return typeof s==typeof u}}),am=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:vBe};am.prototype.compare=function(e,t){if(e.type!==t.type||!Hne(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(e.type.indexOf("Multi")===0){var n=this,r=dte(e),o=dte(t);return r.every(function(a){return this.some(function(s){return n.compare(a,s)})},o)}}return!1};function dte(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function Hne(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}am.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].toFixed(this.precision)!==t[n].toFixed(this.precision))return!1;return!0};am.prototype.compareLine=function(e,t,n,r){if(!Hne(e,t))return!1;var o=this.pseudoNode?e:this.removePseudo(e),a=this.pseudoNode?t:this.removePseudo(t);if(!(r&&!this.compareCoord(o[0],a[0])&&(a=this.fixStartIndex(a,o),!a))){var s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}};am.prototype.fixStartIndex=function(e,t){for(var n,r=-1,o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){r=o;break}return r>=0&&(n=[].concat(e.slice(r,e.length),e.slice(1,r+1))),n};am.prototype.comparePath=function(e,t){var n=this;return e.every(function(r,o){return n.compareCoord(r,this[o])},t)};am.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var n=e.coordinates.slice(1,e.coordinates.length),r=t.coordinates.slice(1,t.coordinates.length),o=this;return n.every(function(a){return this.some(function(s){return o.compareLine(a,s,1,!0)})},r)}else return!1};am.prototype.compareFeature=function(e,t){return e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t)?!1:this.compare(e.geometry,t.geometry)};am.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))};am.prototype.removePseudo=function(e){return e};function vBe(e,t){return yBe(e,t,{strict:!0})}var qne=am;function Wne(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Fi(e),r=Fi(t);if(n!==r)throw new Error("features must be of the same type");if(n==="Point")throw new Error("Point geometry not supported");var o=new qne({precision:6});if(o.compare(e,t))return!1;var a=0;switch(n){case"MultiPoint":var s=Qp(e),u=Qp(t);s.forEach(function(l){u.forEach(function(c){l[0]===c[0]&&l[1]===c[1]&&a++})});break;case"LineString":case"MultiLineString":yg(e,function(l){yg(t,function(c){Fne(l,c).features.length&&a++})});break;case"Polygon":case"MultiPolygon":yg(e,function(l){yg(t,function(c){Og(l,c).features.length&&a++})});break}return a>0}function CBe(e,t){if(!e)throw new Error("feature1 is required");if(!t)throw new Error("feature2 is required");var n=Fi(e),r=Fi(t);if(n!==r)return!1;var o=new qne({precision:6});return o.compare(Eg(e),Eg(t))}var xBe=Rg(function(e){function t(n,r,o,a){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,o,a)}t.prototype.run=function(n,r,o,a){this._init(n,r,o,a);for(var s=0;s<this._datasetLength;s++)if(this._visited[s]!==1){this._visited[s]=1;var u=this._regionQuery(s);if(u.length<this.minPts)this.noise.push(s);else{var l=this.clusters.length;this.clusters.push([]),this._addToCluster(s,l),this._expandCluster(l,u)}}return this.clusters},t.prototype._init=function(n,r,o,a){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),o&&(this.minPts=o),a&&(this.distance=a)},t.prototype._expandCluster=function(n,r){for(var o=0;o<r.length;o++){var a=r[o];if(this._visited[a]!==1){this._visited[a]=1;var s=this._regionQuery(a);s.length>=this.minPts&&(r=this._mergeArrays(r,s))}this._assigned[a]!==1&&this._addToCluster(a,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],o=0;o<this._datasetLength;o++){var a=this.distance(this.dataset[n],this.dataset[o]);a<this.epsilon&&r.push(o)}return r},t.prototype._mergeArrays=function(n,r){for(var o=r.length,a=0;a<o;a++){var s=r[a];n.indexOf(s)<0&&n.push(s)}return n},t.prototype._euclideanDistance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;)o+=(n[a]-r[a])*(n[a]-r[a]);return Math.sqrt(o)},e.exports&&(e.exports=t)}),wBe=Rg(function(e){function t(n,r,o){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,o)}t.prototype.init=function(n,r,o){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof o<"u"&&(this.distance=o)},t.prototype.run=function(n,r){this.init(n,r);for(var o=this.dataset.length,a=0;a<this.k;a++)this.centroids[a]=this.randomCentroid();for(var s=!0;s;){s=this.assign();for(var u=0;u<this.k;u++){for(var l=new Array(d),c=0,f=0;f<d;f++)l[f]=0;for(var h=0;h<o;h++){var d=this.dataset[h].length;if(u===this.assignments[h]){for(var f=0;f<d;f++)l[f]+=this.dataset[h][f];c++}}if(c>0){for(var f=0;f<d;f++)l[f]/=c;this.centroids[u]=l}else this.centroids[u]=this.randomCentroid(),s=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,o;do o=Math.round(Math.random()*n),r=this.dataset[o];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,o,a=0;a<r;a++)o=this.argmin(this.dataset[a],this.centroids,this.distance),o!=this.assignments[a]&&(this.assignments[a]=o,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,o=0;o<this.assignments.length;o++)r=this.assignments[o],typeof n[r]>"u"&&(n[r]=[]),n[r].push(o);return n},t.prototype.argmin=function(n,r,o){for(var a=Number.MAX_VALUE,s=0,u=r.length,l,c=0;c<u;c++)l=o(n,r[c]),l<a&&(a=l,s=c);return s},t.prototype.distance=function(n,r){for(var o=0,a=Math.min(n.length,r.length);a--;){var s=n[a]-r[a];o+=s*s}return Math.sqrt(o)},e.exports&&(e.exports=t)}),Yne=Rg(function(e){function t(n,r,o){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,o)}t.prototype.insert=function(n,r){for(var o=this._queue.length,a=o;a--;){var s=this._priorities[a];this._sorting==="desc"?r>s&&(o=a):r<s&&(o=a)}this._insertAt(n,r,o)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var o=this._queue[r];if(n===o){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,o=this._queue.length;r<o;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,o){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var a=0;a<n.length;a++)this.insert(n[a],r[a])}o&&(this._sorting=o)},t.prototype._insertAt=function(n,r,o){this._queue.length===o?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(o,0,n),this._priorities.splice(o,0,r))},e.exports&&(e.exports=t)}),EBe=Rg(function(e){if(e.exports)var t=Yne;function n(r,o,a,s){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,o,a,s)}n.prototype.run=function(r,o,a,s){this._init(r,o,a,s);for(var u=0,l=this.dataset.length;u<l;u++)if(this._processed[u]!==1){this._processed[u]=1,this.clusters.push([u]);var c=this.clusters.length-1;this._orderedList.push(u);var f=new t(null,null,"asc"),h=this._regionQuery(u);this._distanceToCore(u)!==void 0&&(this._updateQueue(u,h,f),this._expandCluster(c,f))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],o=0,a=this._orderedList.length;o<a;o++){var s=this._orderedList[o],u=this._reachability[s];r.push([s,u])}return r},n.prototype._init=function(r,o,a,s){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}o&&(this.epsilon=o),a&&(this.minPts=a),s&&(this.distance=s)},n.prototype._updateQueue=function(r,o,a){var s=this;this._coreDistance=this._distanceToCore(r),o.forEach(function(u){if(s._processed[u]===void 0){var l=s.distance(s.dataset[r],s.dataset[u]),c=Math.max(s._coreDistance,l);s._reachability[u]===void 0?(s._reachability[u]=c,a.insert(u,c)):c<s._reachability[u]&&(s._reachability[u]=c,a.remove(u),a.insert(u,c))}})},n.prototype._expandCluster=function(r,o){for(var a=o.getElements(),s=0,u=a.length;s<u;s++){var l=a[s];if(this._processed[l]===void 0){var c=this._regionQuery(l);this._processed[l]=1,this.clusters[r].push(l),this._orderedList.push(l),this._distanceToCore(l)!==void 0&&(this._updateQueue(l,c,o),this._expandCluster(r,o))}}},n.prototype._distanceToCore=function(r){for(var o=this.epsilon,a=0;a<o;a++){var s=this._regionQuery(r,a);if(s.length>=this.minPts)return a}},n.prototype._regionQuery=function(r,o){o=o||this.epsilon;for(var a=[],s=0,u=this.dataset.length;s<u;s++)this.distance(this.dataset[r],this.dataset[s])<o&&a.push(s);return a},n.prototype._euclideanDistance=function(r,o){for(var a=0,s=Math.min(r.length,o.length);s--;)a+=(r[s]-o[s])*(r[s]-o[s]);return Math.sqrt(a)},e.exports&&(e.exports=n)}),RA=Rg(function(e){e.exports&&(e.exports={DBSCAN:xBe,KMEANS:wBe,OPTICS:EBe,PriorityQueue:Yne})}),Qzt=RA.DBSCAN,Jzt=RA.KMEANS,$zt=RA.OPTICS,e4t=RA.PriorityQueue;function TBe(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.minPoints,o=n.units;if(Ud(e,"Point","Input must contain Points"),t==null)throw new Error("maxDistance is required");if(!(Math.sign(t)>0))throw new Error("Invalid maxDistance");if(!(r==null||Math.sign(r)>0))throw new Error("Invalid minPoints");e=vu(e,!0),r=r||3;var a=new RA.DBSCAN,s=a.run(Qp(e),gv(t,o),r,fi),u=-1;return s.forEach(function(l){u++,l.forEach(function(c){var f=e.features[c];f.properties||(f.properties={}),f.properties.cluster=u,f.properties.dbscan="core"})}),a.noise.forEach(function(l){var c=e.features[l];c.properties||(c.properties={}),c.properties.cluster?c.properties.dbscan="edge":c.properties.dbscan="noise"}),e}var R4={eudist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++){var u=(t[s]||0)-(n[s]||0);a+=u*u}return r?Math.sqrt(a):a},mandist:function(t,n,r){for(var o=t.length,a=0,s=0;s<o;s++)a+=Math.abs((t[s]||0)-(n[s]||0));return r?Math.sqrt(a):a},dist:function(t,n,r){var o=Math.abs(t-n);return r?o:o*o}},SBe=R4.eudist,ABe=R4.dist,Xne={kmrand:function(t,n){for(var r={},o=[],a=n<<2,s=t.length,u=t[0].length>0;o.length<n&&a-- >0;){var l=t[Math.floor(Math.random()*s)],c=u?l.join("_"):""+l;r[c]||(r[c]=!0,o.push(l))}if(o.length<n)throw new Error("Error initializating clusters");return o},kmpp:function(t,n){var r=t[0].length?SBe:ABe,o=[],a=t.length,s=t[0].length>0,u=t[Math.floor(Math.random()*a)],l=s?u.join("_"):""+u;for(o.push(u);o.length<n;){for(var c=[],f=o.length,h=0,d=[],p=0;p<a;p++){for(var g=1/0,y=0;y<f;y++){var v=r(t[p],o[y]);v<=g&&(g=v)}c[p]=g}for(var w=0;w<a;w++)h+=c[w];for(var C=0;C<a;C++)d[C]={i:C,v:t[C],pr:c[C]/h,cs:0};d.sort(function(D,P){return D.pr-P.pr}),d[0].cs=d[0].pr;for(var E=1;E<a;E++)d[E].cs=d[E-1].cs+d[E].pr;for(var S=Math.random(),A=0;A<a-1&&d[A++].cs<S;);o.push(d[A-1].v)}return o}},bBe=R4.eudist,IBe=Xne.kmrand,DBe=Xne.kmpp,pte=1e4;function mte(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function PBe(e,t,n,r){var o=[],a=[],s=[],u=[],l=!1,c=r||pte,f=e.length,h=e[0].length,d=h>0,p=[];if(n)n=="kmrand"?o=IBe(e,t):n=="kmpp"?o=DBe(e,t):o=n;else for(var g={};o.length<t;){var y=Math.floor(Math.random()*f);g[y]||(g[y]=!0,o.push(e[y]))}do{mte(t,0,p);for(var v=0;v<f;v++){for(var w=1/0,C=0,E=0;E<t;E++){var u=d?bBe(e[v],o[E]):Math.abs(e[v]-o[E]);u<=w&&(w=u,C=E)}s[v]=C,p[C]++}for(var S=[],a=[],A=0;A<t;A++)S[A]=d?mte(h,0,S[A]):0,a[A]=o[A];if(d){for(var D=0;D<t;D++)o[D]=[];for(var P=0;P<f;P++)for(var M=s[P],I=S[M],O=e[P],m=0;m<h;m++)I[m]+=O[m];l=!0;for(var b=0;b<t;b++){for(var L=o[b],R=S[b],N=a[b],B=p[b],G=0;G<h;G++)L[G]=R[G]/B||0;if(l){for(var F=0;F<h;F++)if(N[F]!=L[F]){l=!1;break}}}}else{for(var k=0;k<f;k++){var Z=s[k];S[Z]+=e[k]}for(var te=0;te<t;te++)o[te]=S[te]/p[te]||0;l=!0;for(var oe=0;oe<t;oe++)if(a[oe]!=o[oe]){l=!1;break}}l=l||--c<=0}while(!l);return{it:pte-c,k:t,idxs:s,centroids:o}}var MBe=PBe;function LBe(e,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.numberOfClusters,r=t.mutate;Ud(e,"Point","Input must contain Points");var o=e.features.length;n=n||Math.round(Math.sqrt(o/2)),n>o&&(n=o),(r===!1||r===void 0)&&(e=vu(e,!0));var a=Qp(e),s=a.slice(0,n),u=MBe(a,n,s),l={};return u.centroids.forEach(function(c,f){l[f]=c}),di(e,function(c,f){var h=u.idxs[f];c.properties.cluster=h,c.properties.centroid=l[h]}),e}function RBe(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var n=gte(e,"line1");if(n!=="LineString")throw new Error("line1 must be a LineString");var r=gte(t,"line2");if(r!=="LineString")throw new Error("line2 must be a LineString");for(var o=yv(Eg(e)).features,a=yv(Eg(t)).features,s=0;s<o.length;s++){var u=o[s].geometry.coordinates;if(!a[s])break;var l=a[s].geometry.coordinates;if(!OBe(u,l))return!1}return!0}function OBe(e,t){var n=J0($0(e[0],e[1])),r=J0($0(t[0],t[1]));return n===r}function gte(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function _te(e){for(var t=e,n=[];t.parent;)n.unshift(t),t=t.parent;return n}function NBe(){return new jne(function(e){return e.f})}var iR={search:function(e,t,n,r){e.cleanDirty(),r=r||{};var o=r.heuristic||iR.heuristics.manhattan,a=r.closest||!1,s=NBe(),u=t;for(t.h=o(t,n),s.push(t);s.size()>0;){var l=s.pop();if(l===n)return _te(l);l.closed=!0;for(var c=e.neighbors(l),f=0,h=c.length;f<h;++f){var d=c[f];if(!(d.closed||d.isWall())){var p=l.g+d.getCost(l),g=d.visited;(!g||p<d.g)&&(d.visited=!0,d.parent=l,d.h=d.h||o(d,n),d.g=p,d.f=d.g+d.h,e.markDirty(d),a&&(d.h<u.h||d.h===u.h&&d.g<u.g)&&(u=d),g?s.rescoreElement(d):s.push(d))}}}return a?_te(u):[]},heuristics:{manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},diagonal:function(e,t){var n=1,r=Math.sqrt(2),o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return n*(o+a)+(r-2*n)*Math.min(o,a)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function Qx(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var n=0;n<e.length;n++){this.grid[n]=[];for(var r=0,o=e[n];r<o.length;r++){var a=new oR(n,r,o[r]);this.grid[n][r]=a,this.nodes.push(a)}}this.init()}Qx.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)iR.cleanNode(this.nodes[e])};Qx.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)iR.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};Qx.prototype.markDirty=function(e){this.dirtyNodes.push(e)};Qx.prototype.neighbors=function(e){var t=[],n=e.x,r=e.y,o=this.grid;return o[n-1]&&o[n-1][r]&&t.push(o[n-1][r]),o[n+1]&&o[n+1][r]&&t.push(o[n+1][r]),o[n]&&o[n][r-1]&&t.push(o[n][r-1]),o[n]&&o[n][r+1]&&t.push(o[n][r+1]),this.diagonal&&(o[n-1]&&o[n-1][r-1]&&t.push(o[n-1][r-1]),o[n+1]&&o[n+1][r-1]&&t.push(o[n+1][r-1]),o[n-1]&&o[n-1][r+1]&&t.push(o[n-1][r+1]),o[n+1]&&o[n+1][r+1]&&t.push(o[n+1][r+1])),t};Qx.prototype.toString=function(){for(var e=[],t=this.grid,n,r,o,a,s=0,u=t.length;s<u;s++){for(n=[],r=t[s],o=0,a=r.length;o<a;o++)n.push(r[o].weight);e.push(n.join(" "))}return e.join(`
`)};function oR(e,t,n){this.x=e,this.y=t,this.weight=n}oR.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};oR.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};oR.prototype.isWall=function(){return this.weight===0};function jne(e){this.content=[],this.scoreFunction=e}jne.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r))this.content[n]=t,this.content[e]=r,e=n;else break}},bubbleUp:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var o=e+1<<1,a=o-1,s=null,u;if(a<t){var l=this.content[a];u=this.scoreFunction(l),u<r&&(s=a)}if(o<t){var c=this.content[o],f=this.scoreFunction(c);f<(s===null?r:u)&&(s=o)}if(s!==null)this.content[e]=this.content[s],this.content[s]=n,e=s;else break}}};function BBe(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.resolution,o=n.minDistance,a=n.obstacles||Ft([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(r&&!hi(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(o)throw new Error("options.minDistance is not yet implemented");var s=co(e),u=co(t);switch(e=Wr(s),t=Wr(u),Fi(a)){case"FeatureCollection":if(a.features.length===0)return Bi([s,u]);break;case"Polygon":a=Ft([la($l(a))]);break;default:throw new Error("invalid obstacles")}var l=a;l.features.push(e),l.features.push(t);var c=Ia(Vne(y4(Ia(l)),1.15));if(!r){var f=fi([c[0],c[1]],[c[2],c[1]],n);r=f/100}l.features.pop(),l.features.pop();for(var h=c[0],d=c[1],p=c[2],g=c[3],y=r/fi([h,d],[p,d],n),v=y*(p-h),w=r/fi([h,d],[h,g],n),C=w*(g-d),E=p-h,S=g-d,A=Math.floor(E/v),D=Math.floor(S/C),P=(E-A*v)/2,M=(S-D*C)/2,I=[],O=[],m=[],b=[],L=1/0,R=1/0,N=g-M,B=0;N>=d;){for(var G=[],F=[],k=h+P,Z=0;k<=p;){var te=Wr([k,N]),oe=FBe(te,a);G.push(oe?0:1),F.push(k+"|"+N);var ue=fi(te,e);!oe&&ue<L&&(L=ue,m={x:Z,y:B});var pe=fi(te,t);!oe&&pe<R&&(R=pe,b={x:Z,y:B}),k+=v,Z++}O.push(G),I.push(F),N-=C,B++}var me=new Qx(O,{diagonal:!0}),st=me.grid[m.y][m.x],ht=me.grid[b.y][b.x],jt=iR.search(me,st,ht),Ct=[s];return jt.forEach(function(bt){var mn=I[bt.x][bt.y].split("|");Ct.push([+mn[0],+mn[1]])}),Ct.push(u),Eg(Bi(Ct))}function FBe(e,t){for(var n=0;n<t.features.length;n++)if(xo(e,t.features[n]))return!0;return!1}var yte=function(e){return function(){return e}};function zBe(e){return e[0]}function VBe(e){return e[1]}function FL(){this._=null}function aR(e){e.U=e.C=e.L=e.R=e.P=e.N=null}FL.prototype={constructor:FL,insert:function(e,t){var n,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=vte(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(o=r.R,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.R&&(YS(this,n),e=n,n=e.U),n.C=!1,r.C=!0,XS(this,r))):(o=r.L,o&&o.C?(n.C=o.C=!1,r.C=!0,e=r):(e===n.L&&(XS(this,n),e=n,n=e.U),n.C=!1,r.C=!0,YS(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,o=e.R,a,s;if(r?o?a=vte(o):a=r:a=o,t?t.L===e?t.L=a:t.R=a:this._=a,r&&o?(s=a.C,a.C=e.C,a.L=r,r.U=a,a!==o?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=o,o.U=a):(a.U=t,t=a,e=a.R)):(s=e.C,e=a),e&&(e.U=t),!s){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,YS(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,XS(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,YS(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,XS(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,YS(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,XS(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function YS(e,t){var n=t,r=t.R,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function XS(e,t){var n=t,r=t.L,o=n.U;o?o.L===n?o.L=r:o.R=r:e._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function vte(e){for(;e.L;)e=e.L;return e}function nA(e,t,n,r){var o=[null,null],a=Cl.push(o)-1;return o.left=e,o.right=t,n&&zL(o,e,t,n),r&&zL(o,t,e,r),df[e.index].halfedges.push(a),df[t.index].halfedges.push(a),o}function jS(e,t,n){var r=[t,n];return r.left=e,r}function zL(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function kBe(e,t,n,r,o){var a=e[0],s=e[1],u=a[0],l=a[1],c=s[0],f=s[1],h=0,d=1,p=c-u,g=f-l,y;if(y=t-u,!(!p&&y>0)){if(y/=p,p<0){if(y<h)return;y<d&&(d=y)}else if(p>0){if(y>d)return;y>h&&(h=y)}if(y=r-u,!(!p&&y<0)){if(y/=p,p<0){if(y>d)return;y>h&&(h=y)}else if(p>0){if(y<h)return;y<d&&(d=y)}if(y=n-l,!(!g&&y>0)){if(y/=g,g<0){if(y<h)return;y<d&&(d=y)}else if(g>0){if(y>d)return;y>h&&(h=y)}if(y=o-l,!(!g&&y<0)){if(y/=g,g<0){if(y>d)return;y>h&&(h=y)}else if(g>0){if(y<h)return;y<d&&(d=y)}return!(h>0)&&!(d<1)||(h>0&&(e[0]=[u+h*p,l+h*g]),d<1&&(e[1]=[u+d*p,l+d*g])),!0}}}}}function GBe(e,t,n,r,o){var a=e[1];if(a)return!0;var s=e[0],u=e.left,l=e.right,c=u[0],f=u[1],h=l[0],d=l[1],p=(c+h)/2,g=(f+d)/2,y,v;if(d===f){if(p<t||p>=r)return;if(c>h){if(!s)s=[p,n];else if(s[1]>=o)return;a=[p,o]}else{if(!s)s=[p,o];else if(s[1]<n)return;a=[p,n]}}else if(y=(c-h)/(d-f),v=g-y*p,y<-1||y>1)if(c>h){if(!s)s=[(n-v)/y,n];else if(s[1]>=o)return;a=[(o-v)/y,o]}else{if(!s)s=[(o-v)/y,o];else if(s[1]<n)return;a=[(n-v)/y,n]}else if(f<d){if(!s)s=[t,y*t+v];else if(s[0]>=r)return;a=[r,y*r+v]}else{if(!s)s=[r,y*r+v];else if(s[0]<t)return;a=[t,y*t+v]}return e[0]=s,e[1]=a,!0}function UBe(e,t,n,r){for(var o=Cl.length,a;o--;)(!GBe(a=Cl[o],e,t,n,r)||!kBe(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>lo||Math.abs(a[0][1]-a[1][1])>lo))&&delete Cl[o]}function HBe(e){return df[e.index]={site:e,halfedges:[]}}function qBe(e,t){var n=e.site,r=t.left,o=t.right;return n===o&&(o=r,r=n),o?Math.atan2(o[1]-r[1],o[0]-r[0]):(n===r?(r=t[1],o=t[0]):(r=t[0],o=t[1]),Math.atan2(r[0]-o[0],o[1]-r[1]))}function Kne(e,t){return t[+(t.left!==e.site)]}function WBe(e,t){return t[+(t.left===e.site)]}function YBe(){for(var e=0,t=df.length,n,r,o,a;e<t;++e)if((n=df[e])&&(a=(r=n.halfedges).length)){var s=new Array(a),u=new Array(a);for(o=0;o<a;++o)s[o]=o,u[o]=qBe(n,Cl[r[o]]);for(s.sort(function(l,c){return u[c]-u[l]}),o=0;o<a;++o)u[o]=r[s[o]];for(o=0;o<a;++o)r[o]=u[o]}}function XBe(e,t,n,r){var o=df.length,a,s,u,l,c,f,h,d,p,g,y,v,w=!0;for(a=0;a<o;++a)if(s=df[a]){for(u=s.site,c=s.halfedges,l=c.length;l--;)Cl[c[l]]||c.splice(l,1);for(l=0,f=c.length;l<f;)g=WBe(s,Cl[c[l]]),y=g[0],v=g[1],h=Kne(s,Cl[c[++l%f]]),d=h[0],p=h[1],(Math.abs(y-d)>lo||Math.abs(v-p)>lo)&&(c.splice(l,0,Cl.push(jS(u,g,Math.abs(y-e)<lo&&r-v>lo?[e,Math.abs(d-e)<lo?p:r]:Math.abs(v-r)<lo&&n-y>lo?[Math.abs(p-r)<lo?d:n,r]:Math.abs(y-n)<lo&&v-t>lo?[n,Math.abs(d-n)<lo?p:t]:Math.abs(v-t)<lo&&y-e>lo?[Math.abs(p-t)<lo?d:e,t]:null))-1),++f);f&&(w=!1)}if(w){var C,E,S,A=1/0;for(a=0,w=null;a<o;++a)(s=df[a])&&(u=s.site,C=u[0]-e,E=u[1]-t,S=C*C+E*E,S<A&&(A=S,w=s));if(w){var D=[e,t],P=[e,r],M=[n,r],I=[n,t];w.halfedges.push(Cl.push(jS(u=w.site,D,P))-1,Cl.push(jS(u,P,M))-1,Cl.push(jS(u,M,I))-1,Cl.push(jS(u,I,D))-1)}}for(a=0;a<o;++a)(s=df[a])&&(s.halfedges.length||delete df[a])}var Zne=[],O4;function jBe(){aR(this),this.x=this.y=this.arc=this.site=this.cy=null}function xx(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,o=e.site,a=n.site;if(r!==a){var s=o[0],u=o[1],l=r[0]-s,c=r[1]-u,f=a[0]-s,h=a[1]-u,d=2*(l*h-c*f);if(!(d>=-$Be)){var p=l*l+c*c,g=f*f+h*h,y=(h*p-c*g)/d,v=(l*g-f*p)/d,w=Zne.pop()||new jBe;w.arc=e,w.site=o,w.x=y+s,w.y=(w.cy=v+u)+Math.sqrt(y*y+v*v),e.circle=w;for(var C=null,E=pA._;E;)if(w.y<E.y||w.y===E.y&&w.x<=E.x)if(E.L)E=E.L;else{C=E.P;break}else if(E.R)E=E.R;else{C=E;break}pA.insert(C,w),C||(O4=w)}}}}function Ex(e){var t=e.circle;t&&(t.P||(O4=t.N),pA.remove(t),Zne.push(t),aR(t),e.circle=null)}var Qne=[];function KBe(){aR(this),this.edge=this.site=this.circle=null}function Cte(e){var t=Qne.pop()||new KBe;return t.site=e,t}function zz(e){Ex(e),Tx.remove(e),Qne.push(e),aR(e)}function ZBe(e){var t=e.circle,n=t.x,r=t.cy,o=[n,r],a=e.P,s=e.N,u=[e];zz(e);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<lo&&Math.abs(r-l.circle.cy)<lo;)a=l.P,u.unshift(l),zz(l),l=a;u.unshift(l),Ex(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<lo&&Math.abs(r-c.circle.cy)<lo;)s=c.N,u.push(c),zz(c),c=s;u.push(c),Ex(c);var f=u.length,h;for(h=1;h<f;++h)c=u[h],l=u[h-1],zL(c.edge,l.site,c.site,o);l=u[0],c=u[f-1],c.edge=nA(l.site,c.site,null,o),xx(l),xx(c)}function QBe(e){for(var t=e[0],n=e[1],r,o,a,s,u=Tx._;u;)if(a=Jne(u,n)-t,a>lo)u=u.L;else if(s=t-JBe(u,n),s>lo){if(!u.R){r=u;break}u=u.R}else{a>-lo?(r=u.P,o=u):s>-lo?(r=u,o=u.N):r=o=u;break}HBe(e);var l=Cte(e);if(Tx.insert(r,l),!(!r&&!o)){if(r===o){Ex(r),o=Cte(r.site),Tx.insert(l,o),l.edge=o.edge=nA(r.site,l.site),xx(r),xx(o);return}if(!o){l.edge=nA(r.site,l.site);return}Ex(r),Ex(o);var c=r.site,f=c[0],h=c[1],d=e[0]-f,p=e[1]-h,g=o.site,y=g[0]-f,v=g[1]-h,w=2*(d*v-p*y),C=d*d+p*p,E=y*y+v*v,S=[(v*C-p*E)/w+f,(d*E-y*C)/w+h];zL(o.edge,c,g,S),l.edge=nA(c,e,null,S),o.edge=nA(e,g,null,S),xx(r),xx(o)}}function Jne(e,t){var n=e.site,r=n[0],o=n[1],a=o-t;if(!a)return r;var s=e.P;if(!s)return-1/0;n=s.site;var u=n[0],l=n[1],c=l-t;if(!c)return u;var f=u-r,h=1/a-1/c,d=f/c;return h?(-d+Math.sqrt(d*d-2*h*(f*f/(-2*c)-l+c/2+o-a/2)))/h+r:(r+u)/2}function JBe(e,t){var n=e.N;if(n)return Jne(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var lo=1e-6,$Be=1e-12,Tx,df,pA,Cl;function eFe(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function tFe(e,t){return t[1]-e[1]||t[0]-e[0]}function t4(e,t){var n=e.sort(tFe).pop(),r,o,a;for(Cl=[],df=new Array(e.length),Tx=new FL,pA=new FL;;)if(a=O4,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==o)&&(QBe(n),r=n[0],o=n[1]),n=e.pop();else if(a)ZBe(a.arc);else break;if(YBe(),t){var s=+t[0][0],u=+t[0][1],l=+t[1][0],c=+t[1][1];UBe(s,u,l,c),XBe(s,u,l,c)}this.edges=Cl,this.cells=df,Tx=pA=Cl=df=null}t4.prototype={constructor:t4,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return Kne(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(!!(u=(a=n.halfedges).length))for(var o=n.site,a,s=-1,u,l,c=t[a[u-1]],f=c.left===o?c.right:c.left;++s<u;)l=f,c=t[a[s]],f=c.left===o?c.right:c.left,l&&f&&r<l.index&&r<f.index&&eFe(o,l,f)<0&&e.push([o.data,l.data,f.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,o,a=r._found||0,s=r.cells.length,u;!(u=r.cells[a]);)if(++a>=s)return null;var l=e-u.site[0],c=t-u.site[1],f=l*l+c*c;do u=r.cells[o=a],a=null,u.halfedges.forEach(function(h){var d=r.edges[h],p=d.left;if(!((p===u.site||!p)&&!(p=d.right))){var g=e-p[0],y=t-p[1],v=g*g+y*y;v<f&&(f=v,a=p.index)}});while(a!==null);return r._found=o,n==null||f<=n*n?u.site:null}};var nFe=function(){var e=zBe,t=VBe,n=null;function r(o){return new t4(o.map(function(a,s){var u=[Math.round(e(a,s,o)/lo)*lo,Math.round(t(a,s,o)/lo)*lo];return u.index=s,u.data=a,u}),n)}return r.polygons=function(o){return r(o).polygons()},r.links=function(o){return r(o).links()},r.triangles=function(o){return r(o).triangles()},r.x=function(o){return arguments.length?(e=typeof o=="function"?o:yte(+o),r):e},r.y=function(o){return arguments.length?(t=typeof o=="function"?o:yte(+o),r):t},r.extent=function(o){return arguments.length?(n=o==null?null:[[+o[0][0],+o[0][1]],[+o[1][0],+o[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(o){return arguments.length?(n=o==null?null:[[0,0],[+o[0],+o[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r};function rFe(e){return e=e.slice(),e.push(e[0]),rr([e])}function iFe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return Ud(e,"Point","points"),Ft(nFe().x(function(r){return r.geometry.coordinates[0]}).y(function(r){return r.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(rFe))}function $ne(e,t,n,r){r=r||{};var o=r.steps||64,a=r.units||"kilometers",s=r.angle||0,u=r.pivot||e,l=r.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!gt(r))throw new Error("options must be an object");if(!hi(o))throw new Error("steps must be a number");if(!hi(s))throw new Error("angle must be a number");var c=co(e);if(a==="degrees")var f=Za(s);else t=bx(e,t,90,{units:a}),n=bx(e,n,0,{units:a}),t=co(t)[0]-c[0],n=co(n)[1]-c[1];for(var h=[],d=0;d<o;d+=1){var p=d*-360/o,g=t*n/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)*Math.pow(xte(p),2)),y=t*n/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)/Math.pow(xte(p),2));if(p<-90&&p>=-270&&(g=-g),p<-180&&p>=-360&&(y=-y),a==="degrees"){var v=g*Math.cos(f)+y*Math.sin(f),w=y*Math.cos(f)-g*Math.sin(f);g=v,y=w}h.push([g+c[0],y+c[1]])}return h.push(h[0]),a==="degrees"?rr([h],l):zne(rr([h],l),s,{pivot:u})}function xte(e){var t=e*Math.PI/180;return Math.tan(t)}function N4(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.properties,r=t.weight;if(!e)throw new Error("geojson is required");var o=0,a=0,s=0;return Fh(e,function(u,l,c){var f=c[r];if(f=f??1,!hi(f))throw new Error("weight value must be a number for feature index "+l);f=Number(f),f>0&&Qa(u,function(h){o+=h[0]*f,a+=h[1]*f,s+=f})}),Wr([o/s,a/s],n)}function oFe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.counter||10;if(!hi(n))throw new Error("counter must be a number");var r=t.weight,o=N4(e,{weight:t.weight}),a=Ft([]);return di(e,function(s){a.features.push(_v(s,{weight:s.properties[r]}))}),a.properties={tolerance:t.tolerance,medianCandidates:[]},ere(o.geometry.coordinates,[0,0],a,n)}function ere(e,t,n,r){var o=n.properties.tolerance||.001,a=0,s=0,u=0,l=0;if(di(n,function(h){var d=h.properties.weight,p=d??1;if(p=Number(p),!hi(p))throw new Error("weight value must be a number");if(p>0){l+=1;var g=p*fi(h,e);g===0&&(g=1);var y=p/g;a+=h.geometry.coordinates[0]*y,s+=h.geometry.coordinates[1]*y,u+=y}}),l<1)throw new Error("no features to measure");var c=a/u,f=s/u;return l===1||r===0||Math.abs(c-t[0])<o&&Math.abs(f-t[1])<o?Wr([c,f],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,f]),ere([c,f],e,n,r-1))}function aFe(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.steps||64,r=t.weight,o=t.properties||{};if(!hi(n))throw new Error("steps must be a number");if(!gt(o))throw new Error("properties must be a number");var a=Qp(e).length,s=N4(e,{weight:r}),u=0,l=0,c=0;di(e,function(P){var M=P.properties[r]||1,I=wte(Et(P),Et(s));u+=Math.pow(I.x,2)*M,l+=Math.pow(I.y,2)*M,c+=I.x*I.y*M});var f=u-l,h=Math.sqrt(Math.pow(f,2)+4*Math.pow(c,2)),d=2*c,p=Math.atan((f+h)/d),g=p*180/Math.PI,y=0,v=0,w=0;di(e,function(P){var M=P.properties[r]||1,I=wte(Et(P),Et(s));y+=Math.pow(I.x*Math.cos(p)-I.y*Math.sin(p),2)*M,v+=Math.pow(I.x*Math.sin(p)+I.y*Math.cos(p),2)*M,w+=M});var C=Math.sqrt(2*y/w),E=Math.sqrt(2*v/w),S=$ne(s,C,E,{units:"degrees",angle:g,steps:n,properties:o}),A=Uz(e,Ft([S])),D={meanCenterCoordinates:Et(s),semiMajorAxis:C,semiMinorAxis:E,numberOfFeatures:a,angle:g,percentageWithinEllipse:100*Qp(A).length/a};return S.properties.standardDeviationalEllipse=D,S}function wte(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function OA(e){if(gt(e)&&(e=e.bbox),e&&!Array.isArray(e))throw new Error("bbox is invalid");return e?cFe(e):[uFe(),lFe()]}function tre(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox;e==null&&(e=1);for(var r=[],o=0;o<e;o++)r.push(Wr(OA(n)));return Ft(r)}function nre(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_radial_length;e==null&&(e=1),hi(r)||(r=10),hi(o)||(o=10);for(var a=[],s=0;s<e;s++){var u=[],l=Array.apply(null,new Array(r+1)).map(Math.random);l.forEach(c),l.forEach(f),u[u.length-1]=u[0],u=u.map(sFe(OA(n))),a.push(rr([u]))}function c(h,d,p){p[d]=d>0?h+p[d-1]:h}function f(h){h=h*2*Math.PI/l[l.length-1];var d=Math.random();u.push([d*o*Math.sin(h),d*o*Math.cos(h)])}return Ft(a)}function rre(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,o=t.max_length,a=t.max_rotation;e==null&&(e=1),(!hi(r)||r<2)&&(r=10),hi(o)||(o=1e-4),hi(a)||(a=Math.PI/8);for(var s=[],u=0;u<e;u++){for(var l=OA(n),c=[l],f=0;f<r-1;f++){var h=f===0?Math.random()*2*Math.PI:Math.tan((c[f][1]-c[f-1][1])/(c[f][0]-c[f-1][0])),d=h+(Math.random()-.5)*a*2,p=Math.random()*o;c.push([c[f][0]+p*Math.cos(d),c[f][1]+p*Math.sin(d)])}s.push(Bi(c))}return Ft(s)}function sFe(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function ire(){return Math.random()-.5}function uFe(){return ire()*360}function lFe(){return ire()*180}function cFe(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var fFe=Object.freeze({randomPosition:OA,randomPoint:tre,randomPolygon:nre,randomLineString:rre});function ore(e,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var n=[];return di(e,function(r){sR(r.properties,t)&&n.push(r)}),Ft(n)}function B4(e,t,n){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var r=F4(e,t),o=Object.keys(r),a=0;a<o.length;a++){for(var s=o[a],u=r[s],l=[],c=0;c<u.length;c++)l.push(e.features[u[c]]);n(Ft(l),s,a)}}function are(e,t,n,r){var o=r;return B4(e,t,function(a,s,u){u===0&&r===void 0?o=a:o=n(o,a,s,u)}),o}function F4(e,t){var n={};return di(e,function(r,o){var a=r.properties||{};if(a.hasOwnProperty(t)){var s=a[t];n.hasOwnProperty(s)?n[s].push(o):n[s]=[o]}}),n}function sR(e,t){if(e===void 0)return!1;var n=typeof t;if(n==="number"||n==="string")return e.hasOwnProperty(t);if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(!sR(e,t[r]))return!1;return!0}else return z4(e,t)}function z4(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];if(e[o]!==t[o])return!1}return!0}function sre(e,t){if(!t)return{};if(!t.length)return{};for(var n={},r=0;r<t.length;r++){var o=t[r];e.hasOwnProperty(o)&&(n[o]=e[o])}return n}var hFe=Object.freeze({getCluster:ore,clusterEach:B4,clusterReduce:are,createBins:F4,applyFilter:sR,propertiesContainsFilter:z4,filterProperties:sre});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(arguments[1]),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(a=a<0?Math.max(r+arguments[2],0):Math.min(a,r);o<a;)n[o]=t,++o;return n},writable:!0});Number.isFinite=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)};Number.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(e){return e!==e};Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var vv=function(){};vv.prototype.interfaces_=function(){return[]};vv.prototype.getClass=function(){return vv};vv.prototype.equalsWithTolerance=function(t,n,r){return Math.abs(t-n)<=r};var fo=function(){},Xt=function(){},ure={MAX_VALUE:{configurable:!0}};Xt.isNaN=function(t){return Number.isNaN(t)};Xt.doubleToLongBits=function(t){return t};Xt.longBitsToDouble=function(t){return t};Xt.isInfinite=function(t){return!Number.isFinite(t)};ure.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Xt,ure);var Oc=function(){},uR=function(){},Ix=function(){};function Nc(){}var se=function e(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Mv={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};se.prototype.setOrdinate=function(t,n){switch(t){case se.X:this.x=n;break;case se.Y:this.y=n;break;case se.Z:this.z=n;break;default:throw new fo("Invalid ordinate index: "+t)}};se.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!vv.equalsWithTolerance(this.x,n.x,r)||!vv.equalsWithTolerance(this.y,n.y,r))}};se.prototype.getOrdinate=function(t){switch(t){case se.X:return this.x;case se.Y:return this.y;case se.Z:return this.z;default:}throw new fo("Invalid ordinate index: "+t)};se.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Xt.isNaN(this.z))&&Xt.isNaN(t.z)};se.prototype.equals=function(t){return t instanceof se?this.equals2D(t):!1};se.prototype.equalInZ=function(t,n){return vv.equalsWithTolerance(this.z,t.z,n)};se.prototype.compareTo=function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};se.prototype.clone=function(){};se.prototype.copy=function(){return new se(this)};se.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};se.prototype.distance3D=function(t){var n=this.x-t.x,r=this.y-t.y,o=this.z-t.z;return Math.sqrt(n*n+r*r+o*o)};se.prototype.distance=function(t){var n=this.x-t.x,r=this.y-t.y;return Math.sqrt(n*n+r*r)};se.prototype.hashCode=function(){var t=17;return t=37*t+se.hashCode(this.x),t=37*t+se.hashCode(this.y),t};se.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};se.prototype.interfaces_=function(){return[Oc,uR,Nc]};se.prototype.getClass=function(){return se};se.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=Xt.doubleToLongBits(t);return Math.trunc((n^n)>>>32)}};Mv.DimensionalComparator.get=function(){return Cg};Mv.serialVersionUID.get=function(){return 6683108902428367e3};Mv.NULL_ORDINATE.get=function(){return Xt.NaN};Mv.X.get=function(){return 0};Mv.Y.get=function(){return 1};Mv.Z.get=function(){return 2};Object.defineProperties(se,Mv);var Cg=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new fo("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Cg.prototype.compare=function(t,n){var r=t,o=n,a=Cg.compare(r.x,o.x);if(a!==0)return a;var s=Cg.compare(r.y,o.y);if(s!==0)return s;if(this._dimensionsToTest<=2)return 0;var u=Cg.compare(r.z,o.z);return u};Cg.prototype.interfaces_=function(){return[Ix]};Cg.prototype.getClass=function(){return Cg};Cg.compare=function(t,n){return t<n?-1:t>n?1:Xt.isNaN(t)?Xt.isNaN(n)?0:-1:Xt.isNaN(n)?1:0};var Dx=function(){};Dx.prototype.create=function(){};Dx.prototype.interfaces_=function(){return[]};Dx.prototype.getClass=function(){return Dx};var de=function(){},NA={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};de.prototype.interfaces_=function(){return[]};de.prototype.getClass=function(){return de};de.toLocationSymbol=function(t){switch(t){case de.EXTERIOR:return"e";case de.BOUNDARY:return"b";case de.INTERIOR:return"i";case de.NONE:return"-";default:}throw new fo("Unknown location value: "+t)};NA.INTERIOR.get=function(){return 0};NA.BOUNDARY.get=function(){return 1};NA.EXTERIOR.get=function(){return 2};NA.NONE.get=function(){return-1};Object.defineProperties(de,NA);var Lt=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},ec=function(){},lre={LOG_10:{configurable:!0}};ec.prototype.interfaces_=function(){return[]};ec.prototype.getClass=function(){return ec};ec.log10=function(t){var n=Math.log(t);return Xt.isInfinite(n)||Xt.isNaN(n)?n:n/ec.LOG_10};ec.min=function(t,n,r,o){var a=t;return n<a&&(a=n),r<a&&(a=r),o<a&&(a=o),a};ec.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],r=arguments[2];return t<n?n:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1],s=arguments[2];return o<a?a:o>s?s:o}};ec.wrap=function(t,n){return t<0?n- -t%n:t%n};ec.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2],o=t;return n>o&&(o=n),r>o&&(o=r),o}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=a;return s>c&&(c=s),u>c&&(c=u),l>c&&(c=l),c}};ec.average=function(t,n){return(t+n)/2};lre.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(ec,lre);var zh=function(t){this.str=t};zh.prototype.append=function(t){this.str+=t};zh.prototype.setCharAt=function(t,n){this.str=this.str.substr(0,t)+n+this.str.substr(t+1)};zh.prototype.toString=function(t){return this.str};var bh=function(t){this.value=t};bh.prototype.intValue=function(){return this.value};bh.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};bh.isNaN=function(t){return Number.isNaN(t)};var mA=function(){};mA.isWhitespace=function(t){return t<=32&&t>=0||t===127};mA.toUpperCase=function(t){return t.toUpperCase()};var _e=function e(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];e.call(this,e.parse(r))}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.init(o,a)}},Ef={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};_e.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};_e.prototype.extractSignificantDigits=function(t,n){var r=this.abs(),o=_e.magnitude(r._hi),a=_e.TEN.pow(o);r=r.divide(a),r.gt(_e.TEN)?(r=r.divide(_e.TEN),o+=1):r.lt(_e.ONE)&&(r=r.multiply(_e.TEN),o-=1);for(var s=o+1,u=new zh,l=_e.MAX_PRINT_DIGITS-1,c=0;c<=l;c++){t&&c===s&&u.append(".");var f=Math.trunc(r._hi);if(f<0)break;var h=!1,d=0;f>9?(h=!0,d="9"):d="0"+f,u.append(d),r=r.subtract(_e.valueOf(f)).multiply(_e.TEN),h&&r.selfAdd(_e.TEN);var p=!0,g=_e.magnitude(r._hi);if(g<0&&Math.abs(g)>=l-c&&(p=!1),!p)break}return n[0]=o,u.toString()};_e.prototype.sqr=function(){return this.multiply(this)};_e.prototype.doubleValue=function(){return this._hi+this._lo};_e.prototype.subtract=function(){if(arguments[0]instanceof _e){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};_e.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};_e.prototype.isZero=function(){return this._hi===0&&this._lo===0};_e.prototype.selfSubtract=function(){if(arguments[0]instanceof _e){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};_e.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};_e.prototype.min=function(t){return this.le(t)?this:t};_e.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof _e){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null,h=null,d=null;return c=this._hi/r,f=_e.SPLIT*c,a=f-c,d=_e.SPLIT*r,a=f-a,s=c-a,u=d-r,h=c*r,u=d-u,l=r-u,d=a*u-h+a*l+s*u+s*l,f=(this._hi-h-d+this._lo-c*o)/r,d=c+f,this._hi=d,this._lo=c-d+f,this}};_e.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};_e.prototype.divide=function(){if(arguments[0]instanceof _e){var t=arguments[0],n=null,r=null,o=null,a=null,s=null,u=null,l=null,c=null;s=this._hi/t._hi,u=_e.SPLIT*s,n=u-s,c=_e.SPLIT*t._hi,n=u-n,r=s-n,o=c-t._hi,l=s*t._hi,o=c-o,a=t._hi-o,c=n*o-l+n*a+r*o+r*a,u=(this._hi-l-c+this._lo-s*t._lo)/t._hi,c=s+u;var f=c,h=s-c+u;return new _e(f,h)}else if(typeof arguments[0]=="number"){var d=arguments[0];return Xt.isNaN(d)?_e.createNaN():_e.copy(this).selfDivide(d,0)}};_e.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};_e.prototype.pow=function(t){if(t===0)return _e.valueOf(1);var n=new _e(this),r=_e.valueOf(1),o=Math.abs(t);if(o>1)for(;o>0;)o%2===1&&r.selfMultiply(n),o/=2,o>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r};_e.prototype.ceil=function(){if(this.isNaN())return _e.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new _e(t,n)};_e.prototype.compareTo=function(t){var n=t;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};_e.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};_e.prototype.setValue=function(){if(arguments[0]instanceof _e){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};_e.prototype.max=function(t){return this.ge(t)?this:t};_e.prototype.sqrt=function(){if(this.isZero())return _e.valueOf(0);if(this.isNegative())return _e.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=_e.valueOf(n),o=this.subtract(r.sqr()),a=o._hi*(t*.5);return r.add(a)};_e.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof _e){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,o=null,a=null,s=null,u=null,l=null;return a=this._hi+n,u=a-this._hi,s=a-u,s=n-u+(this._hi-s),l=s+this._lo,r=a+l,o=l+(a-r),this._hi=r+o,this._lo=o+(r-this._hi),this}}else if(arguments.length===2){var c=arguments[0],f=arguments[1],h=null,d=null,p=null,g=null,y=null,v=null,w=null,C=null;y=this._hi+c,p=this._lo+f,w=y-this._hi,C=p-this._lo,v=y-w,g=p-C,v=c-w+(this._hi-v),g=f-C+(this._lo-g),w=v+p,h=y+w,d=w+(y-h),w=g+d;var E=h+w,S=w+(h-E);return this._hi=E,this._lo=S,this}};_e.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof _e){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=null,s=null,u=null,l=null,c=null,f=null;c=_e.SPLIT*this._hi,a=c-this._hi,f=_e.SPLIT*r,a=c-a,s=this._hi-a,u=f-r,c=this._hi*r,u=f-u,l=r-u,f=a*u-c+a*l+s*u+s*l+(this._hi*o+this._lo*r);var h=c+f;a=c-h;var d=f+a;return this._hi=h,this._lo=d,this}};_e.prototype.selfSqr=function(){return this.selfMultiply(this)};_e.prototype.floor=function(){if(this.isNaN())return _e.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new _e(t,n)};_e.prototype.negate=function(){return this.isNaN()?this:new _e(-this._hi,-this._lo)};_e.prototype.clone=function(){};_e.prototype.multiply=function(){if(arguments[0]instanceof _e){var t=arguments[0];return t.isNaN()?_e.createNaN():_e.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Xt.isNaN(n)?_e.createNaN():_e.copy(this).selfMultiply(n,0)}};_e.prototype.isNaN=function(){return Xt.isNaN(this._hi)};_e.prototype.intValue=function(){return Math.trunc(this._hi)};_e.prototype.toString=function(){var t=_e.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};_e.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),o=n[0]+1,a=r;if(r.charAt(0)===".")a="0"+r;else if(o<0)a="0."+_e.stringOfChar("0",-o)+r;else if(r.indexOf(".")===-1){var s=o-r.length,u=_e.stringOfChar("0",s);a=r+u+".0"}return this.isNegative()?"-"+a:a};_e.prototype.reciprocal=function(){var t=null,n=null,r=null,o=null,a=null,s=null,u=null,l=null;a=1/this._hi,s=_e.SPLIT*a,t=s-a,l=_e.SPLIT*this._hi,t=s-t,n=a-t,r=l-this._hi,u=a*this._hi,r=l-r,o=this._hi-r,l=t*r-u+t*o+n*r+n*o,s=(1-u-l-a*this._lo)/this._hi;var c=a+s,f=a-c+s;return new _e(c,f)};_e.prototype.toSciNotation=function(){if(this.isZero())return _e.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),o=_e.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var a="";r.length>1&&(a=r.substring(1));var s=r.charAt(0)+"."+a;return this.isNegative()?"-"+s+o:s+o};_e.prototype.abs=function(){return this.isNaN()?_e.NaN:this.isNegative()?this.negate():new _e(this)};_e.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};_e.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};_e.prototype.add=function(){if(arguments[0]instanceof _e){var t=arguments[0];return _e.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return _e.copy(this).selfAdd(n)}};_e.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof _e){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._hi=r,this._lo=o}};_e.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};_e.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};_e.prototype.trunc=function(){return this.isNaN()?_e.NaN:this.isPositive()?this.floor():this.ceil()};_e.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};_e.prototype.interfaces_=function(){return[Nc,Oc,uR]};_e.prototype.getClass=function(){return _e};_e.sqr=function(t){return _e.valueOf(t).selfMultiply(t)};_e.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return _e.parse(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new _e(n)}};_e.sqrt=function(t){return _e.valueOf(t).sqrt()};_e.parse=function(t){for(var n=0,r=t.length;mA.isWhitespace(t.charAt(n));)n++;var o=!1;if(n<r){var a=t.charAt(n);(a==="-"||a==="+")&&(n++,a==="-"&&(o=!0))}for(var s=new _e,u=0,l=0,c=0;!(n>=r);){var f=t.charAt(n);if(n++,mA.isDigit(f)){var h=f-"0";s.selfMultiply(_e.TEN),s.selfAdd(h),u++;continue}if(f==="."){l=u;continue}if(f==="e"||f==="E"){var d=t.substring(n);try{c=bh.parseInt(d)}catch(w){throw w instanceof Error?new Error("Invalid exponent "+d+" in string "+t):w}finally{}break}throw new Error("Unexpected character '"+f+"' at position "+n+" in string "+t)}var p=s,g=u-l-c;if(g===0)p=s;else if(g>0){var y=_e.TEN.pow(g);p=s.divide(y)}else if(g<0){var v=_e.TEN.pow(-g);p=s.multiply(v)}return o?p.negate():p};_e.createNaN=function(){return new _e(Xt.NaN,Xt.NaN)};_e.copy=function(t){return new _e(t)};_e.magnitude=function(t){var n=Math.abs(t),r=Math.log(n)/Math.log(10),o=Math.trunc(Math.floor(r)),a=Math.pow(10,o);return a*10<=n&&(o+=1),o};_e.stringOfChar=function(t,n){for(var r=new zh,o=0;o<n;o++)r.append(t);return r.toString()};Ef.PI.get=function(){return new _e(3.141592653589793,12246467991473532e-32)};Ef.TWO_PI.get=function(){return new _e(6.283185307179586,24492935982947064e-32)};Ef.PI_2.get=function(){return new _e(1.5707963267948966,6123233995736766e-32)};Ef.E.get=function(){return new _e(2.718281828459045,14456468917292502e-32)};Ef.NaN.get=function(){return new _e(Xt.NaN,Xt.NaN)};Ef.EPS.get=function(){return 123259516440783e-46};Ef.SPLIT.get=function(){return 134217729};Ef.MAX_PRINT_DIGITS.get=function(){return 32};Ef.TEN.get=function(){return _e.valueOf(10)};Ef.ONE.get=function(){return _e.valueOf(1)};Ef.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Ef.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(_e,Ef);var Uu=function(){},cre={DP_SAFE_EPSILON:{configurable:!0}};Uu.prototype.interfaces_=function(){return[]};Uu.prototype.getClass=function(){return Uu};Uu.orientationIndex=function(t,n,r){var o=Uu.orientationIndexFilter(t,n,r);if(o<=1)return o;var a=_e.valueOf(n.x).selfAdd(-t.x),s=_e.valueOf(n.y).selfAdd(-t.y),u=_e.valueOf(r.x).selfAdd(-n.x),l=_e.valueOf(r.y).selfAdd(-n.y);return a.selfMultiply(l).selfSubtract(s.selfMultiply(u)).signum()};Uu.signOfDet2x2=function(t,n,r,o){var a=t.multiply(o).selfSubtract(n.multiply(r));return a.signum()};Uu.intersection=function(t,n,r,o){var a=_e.valueOf(o.y).selfSubtract(r.y).selfMultiply(_e.valueOf(n.x).selfSubtract(t.x)),s=_e.valueOf(o.x).selfSubtract(r.x).selfMultiply(_e.valueOf(n.y).selfSubtract(t.y)),u=a.subtract(s),l=_e.valueOf(o.x).selfSubtract(r.x).selfMultiply(_e.valueOf(t.y).selfSubtract(r.y)),c=_e.valueOf(o.y).selfSubtract(r.y).selfMultiply(_e.valueOf(t.x).selfSubtract(r.x)),f=l.subtract(c),h=f.selfDivide(u).doubleValue(),d=_e.valueOf(t.x).selfAdd(_e.valueOf(n.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),p=_e.valueOf(n.x).selfSubtract(t.x).selfMultiply(_e.valueOf(t.y).selfSubtract(r.y)),g=_e.valueOf(n.y).selfSubtract(t.y).selfMultiply(_e.valueOf(t.x).selfSubtract(r.x)),y=p.subtract(g),v=y.selfDivide(u).doubleValue(),w=_e.valueOf(r.y).selfAdd(_e.valueOf(o.y).selfSubtract(r.y).selfMultiply(v)).doubleValue();return new se(d,w)};Uu.orientationIndexFilter=function(t,n,r){var o=null,a=(t.x-r.x)*(n.y-r.y),s=(t.y-r.y)*(n.x-r.x),u=a-s;if(a>0){if(s<=0)return Uu.signum(u);o=a+s}else if(a<0){if(s>=0)return Uu.signum(u);o=-a-s}else return Uu.signum(u);var l=Uu.DP_SAFE_EPSILON*o;return u>=l||-u>=l?Uu.signum(u):2};Uu.signum=function(t){return t>0?1:t<0?-1:0};cre.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Uu,cre);var En=function(){},BA={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};BA.X.get=function(){return 0};BA.Y.get=function(){return 1};BA.Z.get=function(){return 2};BA.M.get=function(){return 3};En.prototype.setOrdinate=function(t,n,r){};En.prototype.size=function(){};En.prototype.getOrdinate=function(t,n){};En.prototype.getCoordinate=function(){};En.prototype.getCoordinateCopy=function(t){};En.prototype.getDimension=function(){};En.prototype.getX=function(t){};En.prototype.clone=function(){};En.prototype.expandEnvelope=function(t){};En.prototype.copy=function(){};En.prototype.getY=function(t){};En.prototype.toCoordinateArray=function(){};En.prototype.interfaces_=function(){return[uR]};En.prototype.getClass=function(){return En};Object.defineProperties(En,BA);var fre=function(){},Jx=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(fre),xs=function(){};xs.arraycopy=function(t,n,r,o,a){for(var s=0,u=n;u<n+a;u++)r[o+s]=t[u],s++};xs.getProperty=function(t){return{"line.separator":`
`}[t]};var pf=function e(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var o=arguments[0],a=arguments[1];this.x=o.y*a.w-a.y*o.w,this.y=a.x*o.w-o.x*a.w,this.w=o.x*a.y-a.x*o.y}else if(arguments[0]instanceof se&&arguments[1]instanceof se){var s=arguments[0],u=arguments[1];this.x=s.y-u.y,this.y=u.x-s.x,this.w=s.x*u.y-u.x*s.y}}else if(arguments.length===3){var l=arguments[0],c=arguments[1],f=arguments[2];this.x=l,this.y=c,this.w=f}else if(arguments.length===4){var h=arguments[0],d=arguments[1],p=arguments[2],g=arguments[3],y=h.y-d.y,v=d.x-h.x,w=h.x*d.y-d.x*h.y,C=p.y-g.y,E=g.x-p.x,S=p.x*g.y-g.x*p.y;this.x=v*S-E*w,this.y=C*w-y*S,this.w=y*E-C*v}};pf.prototype.getY=function(){var t=this.y/this.w;if(Xt.isNaN(t)||Xt.isInfinite(t))throw new Jx;return t};pf.prototype.getX=function(){var t=this.x/this.w;if(Xt.isNaN(t)||Xt.isInfinite(t))throw new Jx;return t};pf.prototype.getCoordinate=function(){var t=new se;return t.x=this.getX(),t.y=this.getY(),t};pf.prototype.interfaces_=function(){return[]};pf.prototype.getClass=function(){return pf};pf.intersection=function(t,n,r,o){var a=t.y-n.y,s=n.x-t.x,u=t.x*n.y-n.x*t.y,l=r.y-o.y,c=o.x-r.x,f=r.x*o.y-o.x*r.y,h=s*f-c*u,d=l*u-a*f,p=a*c-l*s,g=h/p,y=d/p;if(Xt.isNaN(g)||Xt.isInfinite(g)||Xt.isNaN(y)||Xt.isInfinite(y))throw new Jx;return new se(g,y)};var lt=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof se){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];this.init(a,s,u,l)}},hre={serialVersionUID:{configurable:!0}};lt.prototype.getArea=function(){return this.getWidth()*this.getHeight()};lt.prototype.equals=function(t){if(!(t instanceof lt))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};lt.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new lt;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,o=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new lt(n,o,r,a)};lt.prototype.isNull=function(){return this._maxx<this._minx};lt.prototype.getMaxX=function(){return this._maxx};lt.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof se){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&o>=this._miny&&o<=this._maxy}};lt.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof lt){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof se){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||o>this._maxy||o<this._miny)}};lt.prototype.getMinY=function(){return this._miny};lt.prototype.getMinX=function(){return this._minx};lt.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof se){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=o,this._maxy=o):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}};lt.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t<n?t:n};lt.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};lt.prototype.compareTo=function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};lt.prototype.translate=function(t,n){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)};lt.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};lt.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};lt.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};lt.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n};lt.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};lt.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof lt){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof se){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.covers(r,o)}};lt.prototype.centre=function(){return this.isNull()?null:new se((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};lt.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof se){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof lt){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.init(r.x,o.x,r.y,o.y)}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];a<s?(this._minx=a,this._maxx=s):(this._minx=s,this._maxx=a),u<l?(this._miny=u,this._maxy=l):(this._miny=l,this._maxy=u)}};lt.prototype.getMaxY=function(){return this._maxy};lt.prototype.distance=function(t){if(this.intersects(t))return 0;var n=0;this._maxx<t._minx?n=t._minx-this._maxx:this._minx>t._maxx&&(n=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};lt.prototype.hashCode=function(){var t=17;return t=37*t+se.hashCode(this._minx),t=37*t+se.hashCode(this._maxx),t=37*t+se.hashCode(this._miny),t=37*t+se.hashCode(this._maxy),t};lt.prototype.interfaces_=function(){return[Oc,Nc]};lt.prototype.getClass=function(){return lt};lt.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(t.x<n.x?t.x:n.x)&&r.x<=(t.x>n.x?t.x:n.x)&&r.y>=(t.y<n.y?t.y:n.y)&&r.y<=(t.y>n.y?t.y:n.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=Math.min(s.x,u.x),c=Math.max(s.x,u.x),f=Math.min(o.x,a.x),h=Math.max(o.x,a.x);return!(f>c||h<l||(l=Math.min(s.y,u.y),c=Math.max(s.y,u.y),f=Math.min(o.y,a.y),h=Math.max(o.y,a.y),f>c)||h<l)}};hre.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(lt,hre);var Ch={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},lR=function(t){this.geometryFactory=t||new hn};lR.prototype.read=function(t){var n,r,o;t=t.replace(/[\n\r]/g," ");var a=Ch.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(a=Ch.emptyTypeStr.exec(t),a[2]=void 0),a&&(r=a[1].toLowerCase(),o=a[2],wx[r]&&(n=wx[r].apply(this,[o]))),n===void 0)throw new Error("Could not parse WKT "+t);return n};lR.prototype.write=function(t){return this.extractGeometry(t)};lR.prototype.extractGeometry=function(t){var n=t.getGeometryType().toLowerCase();if(!Yp[n])return null;var r=n.toUpperCase(),o;return t.isEmpty()?o=r+" EMPTY":o=r+"("+Yp[n].apply(this,[t])+")",o};var Yp={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Yp.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+Yp.point.apply(n,[t._geometries[o]])+")");return r.join(",")},linestring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(Yp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},linearring:function(t){for(var n=this,r=[],o=0,a=t._points._coordinates.length;o<a;++o)r.push(Yp.coordinate.apply(n,[t._points._coordinates[o]]));return r.join(",")},multilinestring:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+Yp.linestring.apply(n,[t._geometries[o]])+")");return r.join(",")},polygon:function(t){var n=this,r=[];r.push("("+Yp.linestring.apply(this,[t._shell])+")");for(var o=0,a=t._holes.length;o<a;++o)r.push("("+Yp.linestring.apply(n,[t._holes[o]])+")");return r.join(",")},multipolygon:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push("("+Yp.polygon.apply(n,[t._geometries[o]])+")");return r.join(",")},geometrycollection:function(t){for(var n=this,r=[],o=0,a=t._geometries.length;o<a;++o)r.push(n.extractGeometry(t._geometries[o]));return r.join(",")}},wx={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(Ch.spaces);return this.geometryFactory.createPoint(new se(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,o=t.trim().split(","),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ch.trimParens,"$1"),a.push(wx.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(a)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Ch.spaces),r.push(new se(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n=t.trim().split(","),r=[],o,a=0,s=n.length;a<s;++a)o=n[a].trim().split(Ch.spaces),r.push(new se(Number.parseFloat(o[0]),Number.parseFloat(o[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,o=t.trim().split(Ch.parenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ch.trimParens,"$1"),a.push(wx.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(a)},polygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,o,a,s=t.trim().split(Ch.parenComma),u,l=[],c=0,f=s.length;c<f;++c)r=s[c].replace(Ch.trimParens,"$1"),o=wx.linestring.apply(n,[r]),a=n.geometryFactory.createLinearRing(o._points),c===0?u=a:l.push(a);return this.geometryFactory.createPolygon(u,l)},multipolygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,o=t.trim().split(Ch.doubleParenComma),a=[],s=0,u=o.length;s<u;++s)r=o[s].replace(Ch.trimParens,"$1"),a.push(wx.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(t){var n=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),o=[],a=0,s=r.length;a<s;++a)o.push(n.read(r[a]));return this.geometryFactory.createGeometryCollection(o)}},gf=function(t){this.parser=new lR(t)};gf.prototype.write=function(t){return this.parser.write(t)};gf.toLineString=function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"};var em=function(e){function t(n){e.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),VL=function(e){function t(){if(e.call(this),arguments.length===0)e.call(this);else if(arguments.length===1){var n=arguments[0];e.call(this,n)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(em),nn=function(){};nn.prototype.interfaces_=function(){return[]};nn.prototype.getClass=function(){return nn};nn.shouldNeverReachHere=function(){if(arguments.length===0)nn.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new VL("Should never reach here"+(t!==null?": "+t:""))}};nn.isTrue=function(){var t,n;if(arguments.length===1)t=arguments[0],nn.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],n=arguments[1],!t))throw n===null?new VL:new VL(n)};nn.equals=function(){var t,n,r;if(arguments.length===2)t=arguments[0],n=arguments[1],nn.equals(t,n,null);else if(arguments.length===3&&(t=arguments[0],n=arguments[1],r=arguments[2],!n.equals(t)))throw new VL("Expected "+t+" but encountered "+n+(r!==null?": "+r:""))};var wo=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new se,this._intPt[1]=new se,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Lv={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};wo.prototype.getIndexAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intLineIndex[t][n]};wo.prototype.getTopologySummary=function(){var t=new zh;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};wo.prototype.computeIntersection=function(t,n,r,o){this._inputLines[0][0]=t,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=o,this._result=this.computeIntersect(t,n,r,o)};wo.prototype.getIntersectionNum=function(){return this._result};wo.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);n>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};wo.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};wo.prototype.setPrecisionModel=function(t){this._precisionModel=t};wo.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[n][0])||t._intPt[r].equals2D(t._inputLines[n][1])))return!0;return!1}};wo.prototype.getIntersection=function(t){return this._intPt[t]};wo.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};wo.prototype.hasIntersection=function(){return this._result!==wo.NO_INTERSECTION};wo.prototype.getEdgeDistance=function(t,n){var r=wo.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1]);return r};wo.prototype.isCollinear=function(){return this._result===wo.COLLINEAR_INTERSECTION};wo.prototype.toString=function(){return gf.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+gf.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};wo.prototype.getEndpoint=function(t,n){return this._inputLines[t][n]};wo.prototype.isIntersection=function(t){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(t))return!0;return!1};wo.prototype.getIntersectionAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][n]]};wo.prototype.interfaces_=function(){return[]};wo.prototype.getClass=function(){return wo};wo.computeEdgeDistance=function(t,n,r){var o=Math.abs(r.x-n.x),a=Math.abs(r.y-n.y),s=-1;if(t.equals(n))s=0;else if(t.equals(r))o>a?s=o:s=a;else{var u=Math.abs(t.x-n.x),l=Math.abs(t.y-n.y);o>a?s=u:s=l,s===0&&!t.equals(n)&&(s=Math.max(u,l))}return nn.isTrue(!(s===0&&!t.equals(n)),"Bad distance calculation"),s};wo.nonRobustComputeEdgeDistance=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=Math.sqrt(o*o+a*a);return nn.isTrue(!(s===0&&!t.equals(n)),"Invalid distance calculation"),s};Lv.DONT_INTERSECT.get=function(){return 0};Lv.DO_INTERSECT.get=function(){return 1};Lv.COLLINEAR.get=function(){return 2};Lv.NO_INTERSECTION.get=function(){return 0};Lv.POINT_INTERSECTION.get=function(){return 1};Lv.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(wo,Lv);var m_=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var o=new lt(this._inputLines[0][0],this._inputLines[0][1]),a=new lt(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(r)&&a.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];if(this._isProper=!1,lt.intersects(o,a,r)&&He.orientationIndex(o,a,r)===0&&He.orientationIndex(a,o,r)===0)return this._isProper=!0,(r.equals(o)||r.equals(a))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION}else return e.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,o,a,s,u){u.x=this.smallestInAbsValue(r.x,o.x,a.x,s.x),u.y=this.smallestInAbsValue(r.y,o.y,a.y,s.y),r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.safeHCoordinateIntersection=function(r,o,a,s){var u=null;try{u=pf.intersection(r,o,a,s)}catch(l){if(l instanceof Jx)u=t.nearestEndpoint(r,o,a,s);else throw l}finally{}return u},t.prototype.intersection=function(r,o,a,s){var u=this.intersectionWithNormalization(r,o,a,s);return this.isInSegmentEnvelopes(u)||(u=new se(t.nearestEndpoint(r,o,a,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u},t.prototype.smallestInAbsValue=function(r,o,a,s){var u=r,l=Math.abs(u);return Math.abs(o)<l&&(u=o,l=Math.abs(o)),Math.abs(a)<l&&(u=a,l=Math.abs(a)),Math.abs(s)<l&&(u=s),u},t.prototype.checkDD=function(r,o,a,s,u){var l=Uu.intersection(r,o,a,s),c=this.isInSegmentEnvelopes(l);xs.out.println("DD in env = "+c+"  --------------------- "+l),u.distance(l)>1e-4&&xs.out.println("Distance = "+u.distance(l))},t.prototype.intersectionWithNormalization=function(r,o,a,s){var u=new se(r),l=new se(o),c=new se(a),f=new se(s),h=new se;this.normalizeToEnvCentre(u,l,c,f,h);var d=this.safeHCoordinateIntersection(u,l,c,f);return d.x+=h.x,d.y+=h.y,d},t.prototype.computeCollinearIntersection=function(r,o,a,s){var u=lt.intersects(r,o,a),l=lt.intersects(r,o,s),c=lt.intersects(a,s,r),f=lt.intersects(a,s,o);return u&&l?(this._intPt[0]=a,this._intPt[1]=s,e.COLLINEAR_INTERSECTION):c&&f?(this._intPt[0]=r,this._intPt[1]=o,e.COLLINEAR_INTERSECTION):u&&c?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!l&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):u&&f?(this._intPt[0]=a,this._intPt[1]=o,a.equals(o)&&!l&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&c?(this._intPt[0]=s,this._intPt[1]=r,s.equals(r)&&!u&&!f?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):l&&f?(this._intPt[0]=s,this._intPt[1]=o,s.equals(o)&&!u&&!c?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,o,a,s,u){var l=r.x<o.x?r.x:o.x,c=r.y<o.y?r.y:o.y,f=r.x>o.x?r.x:o.x,h=r.y>o.y?r.y:o.y,d=a.x<s.x?a.x:s.x,p=a.y<s.y?a.y:s.y,g=a.x>s.x?a.x:s.x,y=a.y>s.y?a.y:s.y,v=l>d?l:d,w=f<g?f:g,C=c>p?c:p,E=h<y?h:y,S=(v+w)/2,A=(C+E)/2;u.x=S,u.y=A,r.x-=u.x,r.y-=u.y,o.x-=u.x,o.y-=u.y,a.x-=u.x,a.y-=u.y,s.x-=u.x,s.y-=u.y},t.prototype.computeIntersect=function(r,o,a,s){if(this._isProper=!1,!lt.intersects(r,o,a,s))return e.NO_INTERSECTION;var u=He.orientationIndex(r,o,a),l=He.orientationIndex(r,o,s);if(u>0&&l>0||u<0&&l<0)return e.NO_INTERSECTION;var c=He.orientationIndex(a,s,r),f=He.orientationIndex(a,s,o);if(c>0&&f>0||c<0&&f<0)return e.NO_INTERSECTION;var h=u===0&&l===0&&c===0&&f===0;return h?this.computeCollinearIntersection(r,o,a,s):(u===0||l===0||c===0||f===0?(this._isProper=!1,r.equals2D(a)||r.equals2D(s)?this._intPt[0]=r:o.equals2D(a)||o.equals2D(s)?this._intPt[0]=o:u===0?this._intPt[0]=new se(a):l===0?this._intPt[0]=new se(s):c===0?this._intPt[0]=new se(r):f===0&&(this._intPt[0]=new se(o))):(this._isProper=!0,this._intPt[0]=this.intersection(r,o,a,s)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,o,a,s){var u=r,l=He.distancePointLine(r,a,s),c=He.distancePointLine(o,a,s);return c<l&&(l=c,u=o),c=He.distancePointLine(a,r,o),c<l&&(l=c,u=a),c=He.distancePointLine(s,r,o),c<l&&(l=c,u=s),u},t}(wo),Cv=function(){};Cv.prototype.interfaces_=function(){return[]};Cv.prototype.getClass=function(){return Cv};Cv.orientationIndex=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=r.x-n.x,u=r.y-n.y;return Cv.signOfDet2x2(o,a,s,u)};Cv.signOfDet2x2=function(t,n,r,o){var a=null,s=null,u=null;if(a=1,t===0||o===0)return n===0||r===0?0:n>0?r>0?-a:a:r>0?a:-a;if(n===0||r===0)return o>0?t>0?a:-a:t>0?-a:a;if(n>0?o>0?n<=o||(a=-a,s=t,t=r,r=s,s=n,n=o,o=s):n<=-o?(a=-a,r=-r,o=-o):(s=t,t=-r,r=s,s=n,n=-o,o=s):o>0?-n<=o?(a=-a,t=-t,n=-n):(s=-t,t=r,r=s,s=-n,n=o,o=s):n>=o?(t=-t,n=-n,r=-r,o=-o):(a=-a,s=-t,t=-r,r=s,s=-n,n=-o,o=s),t>0)if(r>0){if(!(t<=r))return a}else return a;else{if(r>0)return-a;if(t>=r)a=-a,t=-t,r=-r;else return-a}for(;;){if(u=Math.floor(r/t),r=r-u*t,o=o-u*n,o<0)return-a;if(o>n)return a;if(t>r+r){if(n<o+o)return a}else{if(n>o+o)return-a;r=t-r,o=n-o,a=-a}if(o===0)return r===0?0:-a;if(r===0||(u=Math.floor(t/r),t=t-u*r,n=n-u*o,n<0))return a;if(n>o)return-a;if(r>t+t){if(o<n+n)return-a}else{if(o>n+n)return a;t=r-t,n=o-n,a=-a}if(n===0)return t===0?0:a;if(t===0)return-a}};var Sh=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Sh.prototype.countSegment=function(t,n){if(t.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&n.y===this._p.y){var r=t.x,o=n.x;return r>o&&(r=n.x,o=t.x),this._p.x>=r&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&t.y<=this._p.y){var a=t.x-this._p.x,s=t.y-this._p.y,u=n.x-this._p.x,l=n.y-this._p.y,c=Cv.signOfDet2x2(a,s,u,l);if(c===0)return this._isPointOnSegment=!0,null;l<s&&(c=-c),c>0&&this._crossingCount++}};Sh.prototype.isPointInPolygon=function(){return this.getLocation()!==de.EXTERIOR};Sh.prototype.getLocation=function(){return this._isPointOnSegment?de.BOUNDARY:this._crossingCount%2===1?de.INTERIOR:de.EXTERIOR};Sh.prototype.isOnSegment=function(){return this._isPointOnSegment};Sh.prototype.interfaces_=function(){return[]};Sh.prototype.getClass=function(){return Sh};Sh.locatePointInRing=function(){if(arguments[0]instanceof se&&Lt(arguments[1],En)){for(var t=arguments[0],n=arguments[1],r=new Sh(t),o=new se,a=new se,s=1;s<n.size();s++)if(n.getCoordinate(s,o),n.getCoordinate(s-1,a),r.countSegment(o,a),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof se&&arguments[1]instanceof Array){for(var u=arguments[0],l=arguments[1],c=new Sh(u),f=1;f<l.length;f++){var h=l[f],d=l[f-1];if(c.countSegment(h,d),c.isOnSegment())return c.getLocation()}return c.getLocation()}};var He=function(){},Rv={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};He.prototype.interfaces_=function(){return[]};He.prototype.getClass=function(){return He};He.orientationIndex=function(t,n,r){return Uu.orientationIndex(t,n,r)};He.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,r=t[0].x,o=1;o<t.length-1;o++){var a=t[o].x-r,s=t[o+1].y,u=t[o-1].y;n+=a*(u-s)}return n/2}else if(Lt(arguments[0],En)){var l=arguments[0],c=l.size();if(c<3)return 0;var f=new se,h=new se,d=new se;l.getCoordinate(0,h),l.getCoordinate(1,d);var p=h.x;d.x-=p;for(var g=0,y=1;y<c-1;y++)f.y=h.y,h.x=d.x,h.y=d.y,l.getCoordinate(y+1,d),d.x-=p,g+=h.x*(f.y-d.y);return g/2}};He.distanceLineLine=function(t,n,r,o){if(t.equals(n))return He.distancePointLine(t,r,o);if(r.equals(o))return He.distancePointLine(o,t,n);var a=!1;if(!lt.intersects(t,n,r,o))a=!0;else{var s=(n.x-t.x)*(o.y-r.y)-(n.y-t.y)*(o.x-r.x);if(s===0)a=!0;else{var u=(t.y-r.y)*(o.x-r.x)-(t.x-r.x)*(o.y-r.y),l=(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y),c=l/s,f=u/s;(f<0||f>1||c<0||c>1)&&(a=!0)}}return a?ec.min(He.distancePointLine(t,r,o),He.distancePointLine(n,r,o),He.distancePointLine(r,t,n),He.distancePointLine(o,t,n)):0};He.isPointInRing=function(t,n){return He.locatePointInRing(t,n)!==de.EXTERIOR};He.computeLength=function(t){var n=t.size();if(n<=1)return 0;var r=0,o=new se;t.getCoordinate(0,o);for(var a=o.x,s=o.y,u=1;u<n;u++){t.getCoordinate(u,o);var l=o.x,c=o.y,f=l-a,h=c-s;r+=Math.sqrt(f*f+h*h),a=l,s=c}return r};He.isCCW=function(t){var n=t.length-1;if(n<3)throw new fo("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],o=0,a=1;a<=n;a++){var s=t[a];s.y>r.y&&(r=s,o=a)}var u=o;do u=u-1,u<0&&(u=n);while(t[u].equals2D(r)&&u!==o);var l=o;do l=(l+1)%n;while(t[l].equals2D(r)&&l!==o);var c=t[u],f=t[l];if(c.equals2D(r)||f.equals2D(r)||c.equals2D(f))return!1;var h=He.computeOrientation(c,r,f),d=!1;return h===0?d=c.x>f.x:d=h>0,d};He.locatePointInRing=function(t,n){return Sh.locatePointInRing(t,n)};He.distancePointLinePerpendicular=function(t,n,r){var o=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),a=((n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y))/o;return Math.abs(a)*Math.sqrt(o)};He.computeOrientation=function(t,n,r){return He.orientationIndex(t,n,r)};He.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new fo("Line array must contain at least one vertex");for(var r=t.distance(n[0]),o=0;o<n.length-1;o++){var a=He.distancePointLine(t,n[o],n[o+1]);a<r&&(r=a)}return r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];if(u.x===l.x&&u.y===l.y)return s.distance(u);var c=(l.x-u.x)*(l.x-u.x)+(l.y-u.y)*(l.y-u.y),f=((s.x-u.x)*(l.x-u.x)+(s.y-u.y)*(l.y-u.y))/c;if(f<=0)return s.distance(u);if(f>=1)return s.distance(l);var h=((u.y-s.y)*(l.x-u.x)-(u.x-s.x)*(l.y-u.y))/c;return Math.abs(h)*Math.sqrt(c)}};He.isOnLine=function(t,n){for(var r=new m_,o=1;o<n.length;o++){var a=n[o-1],s=n[o];if(r.computeIntersection(t,a,s),r.hasIntersection())return!0}return!1};Rv.CLOCKWISE.get=function(){return-1};Rv.RIGHT.get=function(){return He.CLOCKWISE};Rv.COUNTERCLOCKWISE.get=function(){return 1};Rv.LEFT.get=function(){return He.COUNTERCLOCKWISE};Rv.COLLINEAR.get=function(){return 0};Rv.STRAIGHT.get=function(){return He.COLLINEAR};Object.defineProperties(He,Rv);var tm=function(){};tm.prototype.filter=function(t){};tm.prototype.interfaces_=function(){return[]};tm.prototype.getClass=function(){return tm};var Dt=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Hd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Dt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Dt.SORTINDEX_GEOMETRYCOLLECTION};Dt.prototype.getFactory=function(){return this._factory};Dt.prototype.getGeometryN=function(t){return this};Dt.prototype.getArea=function(){return 0};Dt.prototype.isRectangle=function(){return!1};Dt.prototype.equals=function(){if(arguments[0]instanceof Dt){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof Dt))return!1;var r=n;return this.equalsExact(r)}};Dt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Dt.prototype.geometryChanged=function(){this.apply(Dt.geometryChangedFilter)};Dt.prototype.geometryChangedAction=function(){this._envelope=null};Dt.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Dt.prototype.getLength=function(){return 0};Dt.prototype.getNumGeometries=function(){return 1};Dt.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,o)}};Dt.prototype.getUserData=function(){return this._userData};Dt.prototype.getSRID=function(){return this._SRID};Dt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Dt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Dt.SORTINDEX_GEOMETRYCOLLECTION)throw new fo("This method does not support GeometryCollection arguments")};Dt.prototype.equal=function(t,n,r){return r===0?t.equals(n):t.distance(n)<=r};Dt.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Dt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Dt.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new lt(this._envelope)};Dt.prototype.setSRID=function(t){this._SRID=t};Dt.prototype.setUserData=function(t){this._userData=t};Dt.prototype.compare=function(t,n){for(var r=t.iterator(),o=n.iterator();r.hasNext()&&o.hasNext();){var a=r.next(),s=o.next(),u=a.compareTo(s);if(u!==0)return u}return r.hasNext()?1:o.hasNext()?-1:0};Dt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Dt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Dt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Dt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Dt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Dt.SORTINDEX_MULTIPOLYGON};Dt.prototype.interfaces_=function(){return[uR,Oc,Nc]};Dt.prototype.getClass=function(){return Dt};Dt.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1};Dt.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1};Hd.serialVersionUID.get=function(){return 8763622679187377e3};Hd.SORTINDEX_POINT.get=function(){return 0};Hd.SORTINDEX_MULTIPOINT.get=function(){return 1};Hd.SORTINDEX_LINESTRING.get=function(){return 2};Hd.SORTINDEX_LINEARRING.get=function(){return 3};Hd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Hd.SORTINDEX_POLYGON.get=function(){return 5};Hd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Hd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Hd.geometryChangedFilter.get=function(){return V4};Object.defineProperties(Dt,Hd);var V4=function(){};V4.interfaces_=function(){return[tm]};V4.filter=function(t){t.geometryChangedAction()};var Rd=function(){};Rd.prototype.filter=function(t){};Rd.prototype.interfaces_=function(){return[]};Rd.prototype.getClass=function(){return Rd};var Mc=function(){},sm={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Mc.prototype.isInBoundary=function(t){};Mc.prototype.interfaces_=function(){return[]};Mc.prototype.getClass=function(){return Mc};sm.Mod2BoundaryNodeRule.get=function(){return Px};sm.EndPointBoundaryNodeRule.get=function(){return Mx};sm.MultiValentEndPointBoundaryNodeRule.get=function(){return Lx};sm.MonoValentEndPointBoundaryNodeRule.get=function(){return Rx};sm.MOD2_BOUNDARY_RULE.get=function(){return new Px};sm.ENDPOINT_BOUNDARY_RULE.get=function(){return new Mx};sm.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Lx};sm.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Rx};sm.OGC_SFS_BOUNDARY_RULE.get=function(){return Mc.MOD2_BOUNDARY_RULE};Object.defineProperties(Mc,sm);var Px=function(){};Px.prototype.isInBoundary=function(t){return t%2===1};Px.prototype.interfaces_=function(){return[Mc]};Px.prototype.getClass=function(){return Px};var Mx=function(){};Mx.prototype.isInBoundary=function(t){return t>0};Mx.prototype.interfaces_=function(){return[Mc]};Mx.prototype.getClass=function(){return Mx};var Lx=function(){};Lx.prototype.isInBoundary=function(t){return t>1};Lx.prototype.interfaces_=function(){return[Mc]};Lx.prototype.getClass=function(){return Lx};var Rx=function(){};Rx.prototype.isInBoundary=function(t){return t===1};Rx.prototype.interfaces_=function(){return[Mc]};Rx.prototype.getClass=function(){return Rx};var Sa=function(){};Sa.prototype.add=function(){};Sa.prototype.addAll=function(){};Sa.prototype.isEmpty=function(){};Sa.prototype.iterator=function(){};Sa.prototype.size=function(){};Sa.prototype.toArray=function(){};Sa.prototype.remove=function(){};var dFe=function(e){function t(r){e.call(this),this.message=r||""}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error),$x=function(){};$x.prototype.hasNext=function(){};$x.prototype.next=function(){};$x.prototype.remove=function(){};var mf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Sa);function ew(e){this.message=e||""}ew.prototype=new Error;ew.prototype.name="NoSuchElementException";var Fe=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Sa&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,Sa]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.set=function(r,o){var a=this.array_[r];return this.array_[r]=o,a},t.prototype.iterator=function(){return new pFe(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new dFe;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.remove=function(r){for(var o=this,a=!1,s=0,u=this.array_.length;s<u;s++)if(o.array_[s]===r){o.array_.splice(s,1),a=!0;break}return a},t}(mf),pFe=function(e){function t(n){e.call(this),this.arrayList_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new ew;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}($x),FA=function(e){function t(){if(e.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var o=arguments[0],a=arguments[1];this.ensureCapacity(o.length),this.add(o,a)}}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(o){return this.get(o)},t.prototype.addAll=function(){var o=this;if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=!1,l=a.iterator();l.hasNext();)o.add(l.next(),s),u=!0;return u}else return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var o=this,a=e.prototype.clone.call(this),s=0;s<this.size();s++)a.add(s,o.get(s).copy());return a},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var o=this;if(arguments.length===1){var a=arguments[0];e.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1];return this.add(s,u,!0),!0}else if(arguments[0]instanceof se&&typeof arguments[1]=="boolean"){var l=arguments[0],c=arguments[1];if(!c&&this.size()>=1){var f=this.get(this.size()-1);if(f.equals2D(l))return null}e.prototype.add.call(this,l)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var h=arguments[0],d=arguments[1];return this.add(h,d),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],g=arguments[1],y=arguments[2];if(y)for(var v=0;v<p.length;v++)o.add(p[v],g);else for(var w=p.length-1;w>=0;w--)o.add(p[w],g);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof se){var C=arguments[0],E=arguments[1],S=arguments[2];if(!S){var A=this.size();if(A>0){if(C>0){var D=this.get(C-1);if(D.equals2D(E))return null}if(C<A){var P=this.get(C);if(P.equals2D(E))return null}}}e.prototype.add.call(this,C,E)}}else if(arguments.length===4){var M=arguments[0],I=arguments[1],O=arguments[2],m=arguments[3],b=1;O>m&&(b=-1);for(var L=O;L!==m;L+=b)o.add(M[L],I);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new se(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,n),t}(Fe),dn=function(){},cR={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};cR.ForwardComparator.get=function(){return gA};cR.BidirectionalComparator.get=function(){return Ox};cR.coordArrayType.get=function(){return new Array(0).fill(null)};dn.prototype.interfaces_=function(){return[]};dn.prototype.getClass=function(){return dn};dn.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};dn.ptNotInList=function(t,n){for(var r=0;r<t.length;r++){var o=t[r];if(dn.indexOf(o,n)<0)return o}return null};dn.scroll=function(t,n){var r=dn.indexOf(n,t);if(r<0)return null;var o=new Array(t.length).fill(null);xs.arraycopy(t,r,o,0,t.length-r),xs.arraycopy(t,0,o,t.length-r,r),xs.arraycopy(o,0,t,0,t.length)};dn.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(o===a)return!0;if(o===null||a===null||o.length!==a.length)return!1;for(var u=0;u<o.length;u++)if(s.compare(o[u],a[u])!==0)return!1;return!0}};dn.intersection=function(t,n){for(var r=new FA,o=0;o<t.length;o++)n.intersects(t[o])&&r.add(t[o],!0);return r.toCoordinateArray()};dn.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1};dn.removeRepeatedPoints=function(t){if(!dn.hasRepeatedPoints(t))return t;var n=new FA(t,!1);return n.toCoordinateArray()};dn.reverse=function(t){for(var n=t.length-1,r=Math.trunc(n/2),o=0;o<=r;o++){var a=t[o];t[o]=t[n-o],t[n-o]=a}};dn.removeNull=function(t){for(var n=0,r=0;r<t.length;r++)t[r]!==null&&n++;var o=new Array(n).fill(null);if(n===0)return o;for(var a=0,s=0;s<t.length;s++)t[s]!==null&&(o[a++]=t[s]);return o};dn.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),r=0;r<t.length;r++)n[r]=new se(t[r]);return n}else if(arguments.length===5)for(var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],l=arguments[4],c=0;c<l;c++)s[u+c]=new se(o[a+c])};dn.isEqualReversed=function(t,n){for(var r=0;r<t.length;r++){var o=t[r],a=n[t.length-r-1];if(o.compareTo(a)!==0)return!1}return!0};dn.envelope=function(t){for(var n=new lt,r=0;r<t.length;r++)n.expandToInclude(t[r]);return n};dn.toCoordinateArray=function(t){return t.toArray(dn.coordArrayType)};dn.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]};dn.indexOf=function(t,n){for(var r=0;r<n.length;r++)if(t.equals(n[r]))return r;return-1};dn.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var r=t.length-1-n,o=t[n].compareTo(t[r]);if(o!==0)return o}return 1};dn.compare=function(t,n){for(var r=0;r<t.length&&r<n.length;){var o=t[r].compareTo(n[r]);if(o!==0)return o;r++}return r<n.length?-1:r<t.length?1:0};dn.minCoordinate=function(t){for(var n=null,r=0;r<t.length;r++)(n===null||n.compareTo(t[r])>0)&&(n=t[r]);return n};dn.extract=function(t,n,r){n=ec.clamp(n,0,t.length),r=ec.clamp(r,-1,t.length);var o=r-n+1;r<0&&(o=0),n>=t.length&&(o=0),r<n&&(o=0);var a=new Array(o).fill(null);if(o===0)return a;for(var s=0,u=n;u<=r;u++)a[s++]=t[u];return a};Object.defineProperties(dn,cR);var gA=function(){};gA.prototype.compare=function(t,n){var r=t,o=n;return dn.compare(r,o)};gA.prototype.interfaces_=function(){return[Ix]};gA.prototype.getClass=function(){return gA};var Ox=function(){};Ox.prototype.compare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;var a=dn.compare(r,o),s=dn.isEqualReversed(r,o);return s?0:a};Ox.prototype.OLDcompare=function(t,n){var r=t,o=n;if(r.length<o.length)return-1;if(r.length>o.length)return 1;if(r.length===0)return 0;for(var a=dn.increasingDirection(r),s=dn.increasingDirection(o),u=a>0?0:r.length-1,l=s>0?0:r.length-1,c=0;c<r.length;c++){var f=r[u].compareTo(o[l]);if(f!==0)return f;u+=a,l+=s}return 0};Ox.prototype.interfaces_=function(){return[Ix]};Ox.prototype.getClass=function(){return Ox};var Ov=function(){};Ov.prototype.get=function(){};Ov.prototype.put=function(){};Ov.prototype.size=function(){};Ov.prototype.values=function(){};Ov.prototype.entrySet=function(){};var mFe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Ov);function zA(e){this.message=e||""}zA.prototype=new Error;zA.prototype.name="OperationNotSupported";function fR(){}fR.prototype=new Sa;fR.prototype.contains=function(){};var k4=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Sa&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var o=this,a=0,s=this.array_.length;a<s;a++){var u=o.array_[a];if(u===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var o=this,a=r.iterator();a.hasNext();)o.add(a.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,o=[],a=0,s=this.array_.length;a<s;a++)o.push(r.array_[a]);return o},t.prototype.iterator=function(){return new gFe(this)},t}(fR),gFe=function(e){function t(n){e.call(this),this.hashSet_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new ew;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new zA},t}($x),jp=0,Q0=1;function Ete(e){return e===null?jp:e.color}function qi(e){return e===null?null:e.parent}function Wp(e,t){e!==null&&(e.color=t)}function Vz(e){return e===null?null:e.left}function Tte(e){return e===null?null:e.right}function Gs(){this.root_=null,this.size_=0}Gs.prototype=new mFe;Gs.prototype.get=function(e){for(var t=this.root_;t!==null;){var n=e.compareTo(t.key);if(n<0)t=t.left;else if(n>0)t=t.right;else return t.value}return null};Gs.prototype.put=function(e,t){if(this.root_===null)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:jp,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,o;do if(r=n,o=e.compareTo(n.key),o<0)n=n.left;else if(o>0)n=n.right;else{var a=n.value;return n.value=t,a}while(n!==null);var s={key:e,left:null,right:null,value:t,parent:r,color:jp,getValue:function(){return this.value},getKey:function(){return this.key}};return o<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null};Gs.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=Q0;e!=null&&e!==this.root_&&e.parent.color===Q0;)if(qi(e)===Vz(qi(qi(e)))){var n=Tte(qi(qi(e)));Ete(n)===Q0?(Wp(qi(e),jp),Wp(n,jp),Wp(qi(qi(e)),Q0),e=qi(qi(e))):(e===Tte(qi(e))&&(e=qi(e),t.rotateLeft(e)),Wp(qi(e),jp),Wp(qi(qi(e)),Q0),t.rotateRight(qi(qi(e))))}else{var r=Vz(qi(qi(e)));Ete(r)===Q0?(Wp(qi(e),jp),Wp(r,jp),Wp(qi(qi(e)),Q0),e=qi(qi(e))):(e===Vz(qi(e))&&(e=qi(e),t.rotateRight(e)),Wp(qi(e),jp),Wp(qi(qi(e)),Q0),t.rotateLeft(qi(qi(e))))}this.root_.color=jp};Gs.prototype.values=function(){var e=new Fe,t=this.getFirstEntry();if(t!==null)for(e.add(t.value);(t=Gs.successor(t))!==null;)e.add(t.value);return e};Gs.prototype.entrySet=function(){var e=new k4,t=this.getFirstEntry();if(t!==null)for(e.add(t);(t=Gs.successor(t))!==null;)e.add(t);return e};Gs.prototype.rotateLeft=function(e){if(e!=null){var t=e.right;e.right=t.left,t.left!=null&&(t.left.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}};Gs.prototype.rotateRight=function(e){if(e!=null){var t=e.left;e.left=t.right,t.right!=null&&(t.right.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}};Gs.prototype.getFirstEntry=function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e};Gs.successor=function(e){if(e===null)return null;if(e.right!==null){for(var t=e.right;t.left!==null;)t=t.left;return t}else{for(var n=e.parent,r=e;n!==null&&r===n.right;)r=n,n=n.parent;return n}};Gs.prototype.size=function(){return this.size_};var _A=function(){};_A.prototype.interfaces_=function(){return[]};_A.prototype.getClass=function(){return _A};function dre(){}dre.prototype=new fR;function Ih(){this.array_=[],arguments[0]instanceof Sa&&this.addAll(arguments[0])}Ih.prototype=new dre;Ih.prototype.contains=function(e){for(var t=this,n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===0)return!0}return!1};Ih.prototype.add=function(e){var t=this;if(this.contains(e))return!1;for(var n=0,r=this.array_.length;n<r;n++){var o=t.array_[n];if(o.compareTo(e)===1)return t.array_.splice(n,0,e),!0}return this.array_.push(e),!0};Ih.prototype.addAll=function(e){for(var t=this,n=e.iterator();n.hasNext();)t.add(n.next());return!0};Ih.prototype.remove=function(e){throw new zA};Ih.prototype.size=function(){return this.array_.length};Ih.prototype.isEmpty=function(){return this.array_.length===0};Ih.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};Ih.prototype.iterator=function(){return new hR(this)};var hR=function(e){this.treeSet_=e,this.position_=0};hR.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new ew;return this.treeSet_.array_[this.position_++]};hR.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};hR.prototype.remove=function(){throw new zA};var t_=function(){};t_.sort=function(){var t=arguments[0],n,r,o,a;if(arguments.length===1)a=function(u,l){return u.compareTo(l)},t.sort(a);else if(arguments.length===2)o=arguments[1],a=function(u,l){return o.compare(u,l)},t.sort(a);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),o=arguments[3],a=function(u,l){return o.compare(u,l)},r.sort(a),s=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),n=0;n<s.length;n++)t.push(s[n])};t_.asList=function(t){for(var n=new Fe,r=0,o=t.length;r<o;r++)n.add(t[r]);return n};var Hr=function(){},Tf={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Tf.P.get=function(){return 0};Tf.L.get=function(){return 1};Tf.A.get=function(){return 2};Tf.FALSE.get=function(){return-1};Tf.TRUE.get=function(){return-2};Tf.DONTCARE.get=function(){return-3};Tf.SYM_FALSE.get=function(){return"F"};Tf.SYM_TRUE.get=function(){return"T"};Tf.SYM_DONTCARE.get=function(){return"*"};Tf.SYM_P.get=function(){return"0"};Tf.SYM_L.get=function(){return"1"};Tf.SYM_A.get=function(){return"2"};Hr.prototype.interfaces_=function(){return[]};Hr.prototype.getClass=function(){return Hr};Hr.toDimensionSymbol=function(t){switch(t){case Hr.FALSE:return Hr.SYM_FALSE;case Hr.TRUE:return Hr.SYM_TRUE;case Hr.DONTCARE:return Hr.SYM_DONTCARE;case Hr.P:return Hr.SYM_P;case Hr.L:return Hr.SYM_L;case Hr.A:return Hr.SYM_A;default:}throw new fo("Unknown dimension value: "+t)};Hr.toDimensionValue=function(t){switch(mA.toUpperCase(t)){case Hr.SYM_FALSE:return Hr.FALSE;case Hr.SYM_TRUE:return Hr.TRUE;case Hr.SYM_DONTCARE:return Hr.DONTCARE;case Hr.SYM_P:return Hr.P;case Hr.SYM_L:return Hr.L;case Hr.SYM_A:return Hr.A;default:}throw new fo("Unknown dimension symbol: "+t)};Object.defineProperties(Hr,Tf);var Dh=function(){};Dh.prototype.filter=function(t){};Dh.prototype.interfaces_=function(){return[]};Dh.prototype.getClass=function(){return Dh};var _f=function(){};_f.prototype.filter=function(t,n){};_f.prototype.isDone=function(){};_f.prototype.isGeometryChanged=function(){};_f.prototype.interfaces_=function(){return[]};_f.prototype.getClass=function(){return _f};var Cu=function(e){function t(r,o){if(e.call(this,o),this._geometries=r||[],e.hasNullElements(this._geometries))throw new fo("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var o=this,a=new lt,s=0;s<this._geometries.length;s++)a.expandToInclude(o._geometries[s].getEnvelopeInternal());return a},t.prototype.getGeometryN=function(o){return this._geometries[o]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var o=this,a=new Array(this.getNumPoints()).fill(null),s=-1,u=0;u<this._geometries.length;u++)for(var l=o._geometries[u].getCoordinates(),c=0;c<l.length;c++)s++,a[s]=l[c];return a},t.prototype.getArea=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getArea();return a},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._geometries.length!==u._geometries.length)return!1;for(var l=0;l<this._geometries.length;l++)if(!o._geometries[l].equalsExact(u._geometries[l],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<this._geometries.length;a++)o._geometries[a].normalize();t_.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var o=this,a=Hr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getBoundaryDimension());return a},t.prototype.getDimension=function(){for(var o=this,a=Hr.FALSE,s=0;s<this._geometries.length;s++)a=Math.max(a,o._geometries[s].getDimension());return a},t.prototype.getLength=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=0,s=0;s<this._geometries.length;s++)a+=o._geometries[s].getNumPoints();return a},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createGeometryCollection(s)},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=new Ih(t_.asList(this._geometries)),u=new Ih(t_.asList(a._geometries));return this.compare(s,u)}else if(arguments.length===2){for(var l=arguments[0],c=arguments[1],f=l,h=this.getNumGeometries(),d=f.getNumGeometries(),p=0;p<h&&p<d;){var g=o.getGeometryN(p),y=f.getGeometryN(p),v=g.compareToSameClass(y,c);if(v!==0)return v;p++}return p<h?1:p<d?-1:0}},t.prototype.apply=function(){var o=this;if(Lt(arguments[0],Rd))for(var a=arguments[0],s=0;s<this._geometries.length;s++)o._geometries[s].apply(a);else if(Lt(arguments[0],_f)){var u=arguments[0];if(this._geometries.length===0)return null;for(var l=0;l<this._geometries.length&&(o._geometries[l].apply(u),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Lt(arguments[0],Dh)){var c=arguments[0];c.filter(this);for(var f=0;f<this._geometries.length;f++)o._geometries[f].apply(c)}else if(Lt(arguments[0],tm)){var h=arguments[0];h.filter(this);for(var d=0;d<this._geometries.length;d++)o._geometries[d].apply(h)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),nn.shouldNeverReachHere(),null},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var s=0;s<this._geometries.length;s++)a._geometries[s]=o._geometries[s].clone();return a},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.isEmpty=function(){for(var o=this,a=0;a<this._geometries.length;a++)if(!o._geometries[a].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,n),t}(Dt),o_=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Dt.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Hr.FALSE:0},t.prototype.isClosed=function(){var o=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!o._geometries[a].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[a-1-u]=o._geometries[u].reverse();return this.getFactory().createMultiLineString(s)},t.prototype.getBoundary=function(){return new Ic(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[_A]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,n),t}(Cu),Ic=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],n=Mc.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};Ic.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};Ic.prototype.getBoundary=function(){return this._geom instanceof Mo?this.boundaryLineString(this._geom):this._geom instanceof o_?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Ic.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this._bnRule.isInBoundary(2);return n?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};Ic.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Ic.prototype.computeBoundaryCoordinates=function(t){var n=this,r=new Fe;this._endpointMap=new Gs;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);a.getNumPoints()!==0&&(n.addEndpoint(a.getCoordinateN(0)),n.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var s=this._endpointMap.entrySet().iterator();s.hasNext();){var u=s.next(),l=u.getValue(),c=l.count;n._bnRule.isInBoundary(c)&&r.add(u.getKey())}return dn.toCoordinateArray(r)};Ic.prototype.addEndpoint=function(t){var n=this._endpointMap.get(t);n===null&&(n=new kL,this._endpointMap.put(t,n)),n.count++};Ic.prototype.interfaces_=function(){return[]};Ic.prototype.getClass=function(){return Ic};Ic.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new Ic(t);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new Ic(r,o);return a.getBoundary()}};var kL=function(){this.count=null};kL.prototype.interfaces_=function(){return[]};kL.prototype.getClass=function(){return kL};function _Fe(){}function yFe(){}var vFe=function(){};function CFe(){}function xFe(){}function wFe(){}var Dc=function(){},G4={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Dc.prototype.interfaces_=function(){return[]};Dc.prototype.getClass=function(){return Dc};Dc.chars=function(t,n){for(var r=new Array(n).fill(null),o=0;o<n;o++)r[o]=t;return String(r)};Dc.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new CFe,r=new _Fe(n);return t.printStackTrace(r),n.toString()}else if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s="",u=new yFe(Dc.getStackTrace(o)),l=new wFe(u),c=0;c<a;c++)try{s+=l.readLine()+Dc.NEWLINE}catch(f){if(f instanceof xFe)nn.shouldNeverReachHere();else throw f}finally{}return s}};Dc.split=function(t,n){for(var r=n.length,o=new Fe,a=""+t,s=a.indexOf(n);s>=0;){var u=a.substring(0,s);o.add(u),a=a.substring(s+r),s=a.indexOf(n)}a.length>0&&o.add(a);for(var l=new Array(o.size()).fill(null),c=0;c<l.length;c++)l[c]=o.get(c);return l};Dc.toString=function(){if(arguments.length===1){var t=arguments[0];return Dc.SIMPLE_ORDINATE_FORMAT.format(t)}};Dc.spaces=function(t){return Dc.chars(" ",t)};G4.NEWLINE.get=function(){return xs.getProperty("line.separator")};G4.SIMPLE_ORDINATE_FORMAT.get=function(){return new vFe("0.#")};Object.defineProperties(Dc,G4);var Xo=function(){};Xo.prototype.interfaces_=function(){return[]};Xo.prototype.getClass=function(){return Xo};Xo.copyCoord=function(t,n,r,o){for(var a=Math.min(t.getDimension(),r.getDimension()),s=0;s<a;s++)r.setOrdinate(o,s,t.getOrdinate(n,s))};Xo.isRing=function(t){var n=t.size();return n===0?!0:n<=3?!1:t.getOrdinate(0,En.X)===t.getOrdinate(n-1,En.X)&&t.getOrdinate(0,En.Y)===t.getOrdinate(n-1,En.Y)};Xo.isEqual=function(t,n){var r=t.size(),o=n.size();if(r!==o)return!1;for(var a=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)for(var u=0;u<a;u++){var l=t.getOrdinate(s,u),c=n.getOrdinate(s,u);if(t.getOrdinate(s,u)!==n.getOrdinate(s,u)&&!(Xt.isNaN(l)&&Xt.isNaN(c)))return!1}return!0};Xo.extend=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();if(Xo.copy(n,0,o,0,a),a>0)for(var s=a;s<r;s++)Xo.copy(n,a-1,o,s,1);return o};Xo.reverse=function(t){for(var n=t.size()-1,r=Math.trunc(n/2),o=0;o<=r;o++)Xo.swap(t,o,n-o)};Xo.swap=function(t,n,r){if(n===r)return null;for(var o=0;o<t.getDimension();o++){var a=t.getOrdinate(n,o);t.setOrdinate(n,o,t.getOrdinate(r,o)),t.setOrdinate(r,o,a)}};Xo.copy=function(t,n,r,o,a){for(var s=0;s<a;s++)Xo.copyCoord(t,n+s,r,o+s)};Xo.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var r=t.getDimension(),o=new zh;o.append("(");for(var a=0;a<n;a++){a>0&&o.append(" ");for(var s=0;s<r;s++)s>0&&o.append(","),o.append(Dc.toString(t.getOrdinate(a,s)))}return o.append(")"),o.toString()}};Xo.ensureValidRing=function(t,n){var r=n.size();if(r===0)return n;if(r<=3)return Xo.createClosedRing(t,n,4);var o=n.getOrdinate(0,En.X)===n.getOrdinate(r-1,En.X)&&n.getOrdinate(0,En.Y)===n.getOrdinate(r-1,En.Y);return o?n:Xo.createClosedRing(t,n,r+1)};Xo.createClosedRing=function(t,n,r){var o=t.create(r,n.getDimension()),a=n.size();Xo.copy(n,0,o,0,a);for(var s=a;s<r;s++)Xo.copy(n,0,o,s,1);return o};var Mo=function(e){function t(r,o){e.call(this,o),this._points=null,this.init(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new lt:this._points.expandEnvelope(new lt)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a;if(this._points.size()!==u._points.size())return!1;for(var l=0;l<this._points.size();l++)if(!o.equal(o._points.getCoordinate(l),u._points.getCoordinate(l),s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var o=this,a=0;a<Math.trunc(this._points.size()/2);a++){var s=o._points.size()-1-a;if(!o._points.getCoordinate(a).equals(o._points.getCoordinate(s)))return o._points.getCoordinate(a).compareTo(o._points.getCoordinate(s))>0&&Xo.reverse(o._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Hr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return He.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var o=this._points.copy();Xo.reverse(o);var a=this.getFactory().createLineString(o);return a},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){for(var a=arguments[0],s=a,u=0,l=0;u<this._points.size()&&l<s._points.size();){var c=o._points.getCoordinate(u).compareTo(s._points.getCoordinate(l));if(c!==0)return c;u++,l++}return u<this._points.size()?1:l<s._points.size()?-1:0}else if(arguments.length===2){var f=arguments[0],h=arguments[1],d=f;return h.compare(this._points,d._points)}},t.prototype.apply=function(){var o=this;if(Lt(arguments[0],Rd))for(var a=arguments[0],s=0;s<this._points.size();s++)a.filter(o._points.getCoordinate(s));else if(Lt(arguments[0],_f)){var u=arguments[0];if(this._points.size()===0)return null;for(var l=0;l<this._points.size()&&(u.filter(o._points,l),!u.isDone());l++);u.isGeometryChanged()&&this.geometryChanged()}else if(Lt(arguments[0],Dh)){var c=arguments[0];c.filter(this)}else if(Lt(arguments[0],tm)){var f=arguments[0];f.filter(this)}},t.prototype.getBoundary=function(){return new Ic(this).getBoundary()},t.prototype.isEquivalentClass=function(o){return o instanceof t},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._points=this._points.clone(),o},t.prototype.getCoordinateN=function(o){return this._points.getCoordinate(o)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(o){if(o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),o.size()===1)throw new fo("Invalid number of points in LineString (found "+o.size()+" - must be 0 or >= 2)");this._points=o},t.prototype.isCoordinate=function(o){for(var a=this,s=0;s<this._points.size();s++)if(a._points.getCoordinate(s).equals(o))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(o){return this.getFactory().createPoint(this._points.getCoordinate(o))},t.prototype.interfaces_=function(){return[_A]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,n),t}(Dt),yA=function(){};yA.prototype.interfaces_=function(){return[]};yA.prototype.getClass=function(){return yA};var El=function(e){function t(r,o){e.call(this,o),this._coordinates=r||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new lt;var o=new lt;return o.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),o},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?this.isEmpty()&&o.isEmpty()?!0:this.isEmpty()!==o.isEmpty()?!1:this.equal(o.getCoordinate(),this.getCoordinate(),a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Hr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var o=arguments[0],a=o;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var s=arguments[0],u=arguments[1],l=s;return u.compare(this._coordinates,l._coordinates)}},t.prototype.apply=function(){if(Lt(arguments[0],Rd)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this.getCoordinate())}else if(Lt(arguments[0],_f)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Lt(arguments[0],Dh)){var s=arguments[0];s.filter(this)}else if(Lt(arguments[0],tm)){var u=arguments[0];u.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var o=e.prototype.clone.call(this);return o._coordinates=this._coordinates.clone(),o},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(o){o===null&&(o=this.getFactory().getCoordinateSequenceFactory().create([])),nn.isTrue(o.size()<=1),this._coordinates=o},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[yA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,n),t}(Dt),Tg=function(){};Tg.prototype.interfaces_=function(){return[]};Tg.prototype.getClass=function(){return Tg};var Da=function(e){function t(r,o,a){if(e.call(this,a),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),o===null&&(o=[]),e.hasNullElements(o))throw new fo("holes must not contain null elements");if(r.isEmpty()&&e.hasNonEmptyElements(o))throw new fo("shell is empty but holes are not");this._shell=r,this._holes=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var o=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),s=-1,u=this._shell.getCoordinates(),l=0;l<u.length;l++)s++,a[s]=u[l];for(var c=0;c<this._holes.length;c++)for(var f=o._holes[c].getCoordinates(),h=0;h<f.length;h++)s++,a[s]=f[h];return a},t.prototype.getArea=function(){var o=this,a=0;a+=Math.abs(He.signedArea(this._shell.getCoordinateSequence()));for(var s=0;s<this._holes.length;s++)a-=Math.abs(He.signedArea(o._holes[s].getCoordinateSequence()));return a},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var o=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),s=0;s<5;s++){var u=o.getX(s);if(!(u===a.getMinX()||u===a.getMaxX()))return!1;var l=o.getY(s);if(!(l===a.getMinY()||l===a.getMaxY()))return!1}for(var c=o.getX(0),f=o.getY(0),h=1;h<=4;h++){var d=o.getX(h),p=o.getY(h),g=d!==c,y=p!==f;if(g===y)return!1;c=d,f=p}return!0},t.prototype.equalsExact=function(){var o=this;if(arguments.length===2){var a=arguments[0],s=arguments[1];if(!this.isEquivalentClass(a))return!1;var u=a,l=this._shell,c=u._shell;if(!l.equalsExact(c,s)||this._holes.length!==u._holes.length)return!1;for(var f=0;f<this._holes.length;f++)if(!o._holes[f].equalsExact(u._holes[f],s))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var o=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)o.normalize(o._holes[a],!1);t_.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],u=arguments[1];if(s.isEmpty())return null;var l=new Array(s.getCoordinates().length-1).fill(null);xs.arraycopy(s.getCoordinates(),0,l,0,l.length);var c=dn.minCoordinate(s.getCoordinates());dn.scroll(l,c),xs.arraycopy(l,0,s.getCoordinates(),0,l.length),s.getCoordinates()[l.length]=l[0],He.isCCW(s.getCoordinates())===u&&dn.reverse(s.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var o=this,a=0;a+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)a+=o._holes[s].getLength();return a},t.prototype.getNumPoints=function(){for(var o=this,a=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)a+=o._holes[s].getNumPoints();return a},t.prototype.reverse=function(){var o=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].copy().reverse();return a},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var o=this;if(arguments.length===1){var a=arguments[0],s=this._shell,u=a._shell;return s.compareToSameClass(u)}else if(arguments.length===2){var l=arguments[0],c=arguments[1],f=l,h=this._shell,d=f._shell,p=h.compareToSameClass(d,c);if(p!==0)return p;for(var g=this.getNumInteriorRing(),y=f.getNumInteriorRing(),v=0;v<g&&v<y;){var w=o.getInteriorRingN(v),C=f.getInteriorRingN(v),E=w.compareToSameClass(C,c);if(E!==0)return E;v++}return v<g?1:v<y?-1:0}},t.prototype.apply=function(o){var a=this;if(Lt(o,Rd)){this._shell.apply(o);for(var s=0;s<this._holes.length;s++)a._holes[s].apply(o)}else if(Lt(o,_f)){if(this._shell.apply(o),!o.isDone())for(var u=0;u<this._holes.length&&(a._holes[u].apply(o),!o.isDone());u++);o.isGeometryChanged()&&this.geometryChanged()}else if(Lt(o,Dh))o.filter(this);else if(Lt(o,tm)){o.filter(this),this._shell.apply(o);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(o)}},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var s=0;s<this._holes.length;s++)a[s+1]=o._holes[s];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},t.prototype.clone=function(){var o=this,a=e.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var s=0;s<this._holes.length;s++)a._holes[s]=o._holes[s].clone();return a},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var o=this,a=this._shell.copy(),s=new Array(this._holes.length).fill(null),u=0;u<s.length;u++)s[u]=o._holes[u].copy();return new t(a,s,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(o){return this._holes[o]},t.prototype.interfaces_=function(){return[Tg]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,n),t}(Dt),Nx=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Dt.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var o=arguments[0];return this._geometries[o].getCoordinate()}else return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return Hr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[yA]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,n),t}(Cu),Od=function(e){function t(r,o){r instanceof se&&o instanceof hn&&(r=o.getCoordinateSequenceFactory().create(r)),e.call(this,r,o),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Dt.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Hr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var o=this._points.copy();Xo.reverse(o);var a=this.getFactory().createLinearRing(o);return a},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new fo("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new fo("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,n),t}(Mo),Md=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Dt.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return this.isEquivalentClass(o)?e.prototype.equalsExact.call(this,o,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var o=this,a=this._geometries.length,s=new Array(a).fill(null),u=0;u<this._geometries.length;u++)s[u]=o._geometries[u].reverse();return this.getFactory().createMultiPolygon(s)},t.prototype.getBoundary=function(){var o=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new Fe,s=0;s<this._geometries.length;s++)for(var u=o._geometries[s],l=u.getBoundary(),c=0;c<l.getNumGeometries();c++)a.add(l.getGeometryN(c));var f=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(f))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var o=this,a=new Array(this._geometries.length).fill(null),s=0;s<a.length;s++)a[s]=o._geometries[s].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[Tg]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,n),t}(Cu),Lc=function(t){this._factory=t||null,this._isUserDataCopied=!1},dR={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Lc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};Lc.prototype.edit=function(t,n){if(t===null)return null;var r=this.editInternal(t,n);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};Lc.prototype.editInternal=function(t,n){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Cu?this.editGeometryCollection(t,n):t instanceof Da?this.editPolygon(t,n):t instanceof El?n.edit(t,this._factory):t instanceof Mo?n.edit(t,this._factory):(nn.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};Lc.prototype.editGeometryCollection=function(t,n){for(var r=this,o=n.edit(t,this._factory),a=new Fe,s=0;s<o.getNumGeometries();s++){var u=r.edit(o.getGeometryN(s),n);u===null||u.isEmpty()||a.add(u)}return o.getClass()===Nx?this._factory.createMultiPoint(a.toArray([])):o.getClass()===o_?this._factory.createMultiLineString(a.toArray([])):o.getClass()===Md?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};Lc.prototype.editPolygon=function(t,n){var r=this,o=n.edit(t,this._factory);if(o===null&&(o=this._factory.createPolygon(null)),o.isEmpty())return o;var a=this.edit(o.getExteriorRing(),n);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var s=new Fe,u=0;u<o.getNumInteriorRing();u++){var l=r.edit(o.getInteriorRingN(u),n);l===null||l.isEmpty()||s.add(l)}return this._factory.createPolygon(a,s.toArray([]))};Lc.prototype.interfaces_=function(){return[]};Lc.prototype.getClass=function(){return Lc};Lc.GeometryEditorOperation=function(){};dR.NoOpGeometryOperation.get=function(){return vA};dR.CoordinateOperation.get=function(){return CA};dR.CoordinateSequenceOperation.get=function(){return xA};Object.defineProperties(Lc,dR);var vA=function(){};vA.prototype.edit=function(t,n){return t};vA.prototype.interfaces_=function(){return[Lc.GeometryEditorOperation]};vA.prototype.getClass=function(){return vA};var CA=function(){};CA.prototype.edit=function(t,n){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof Od?n.createLinearRing(r):t instanceof Mo?n.createLineString(r):t instanceof El?r.length>0?n.createPoint(r[0]):n.createPoint():t};CA.prototype.interfaces_=function(){return[Lc.GeometryEditorOperation]};CA.prototype.getClass=function(){return CA};var xA=function(){};xA.prototype.edit=function(t,n){return t instanceof Od?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Mo?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof El?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t};xA.prototype.interfaces_=function(){return[Lc.GeometryEditorOperation]};xA.prototype.getClass=function(){return xA};var Wo=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)t._coordinates[r]=new se}else if(Lt(arguments[0],En)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._coordinates=new Array(o.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)t._coordinates[a]=o.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],u=arguments[1];this._coordinates=s,this._dimension=u,s===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],c=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=c;for(var f=0;f<l;f++)t._coordinates[f]=new se}}},pre={serialVersionUID:{configurable:!0}};Wo.prototype.setOrdinate=function(t,n,r){switch(n){case En.X:this._coordinates[t].x=r;break;case En.Y:this._coordinates[t].y=r;break;case En.Z:this._coordinates[t].z=r;break;default:throw new fo("invalid ordinateIndex")}};Wo.prototype.size=function(){return this._coordinates.length};Wo.prototype.getOrdinate=function(t,n){switch(n){case En.X:return this._coordinates[t].x;case En.Y:return this._coordinates[t].y;case En.Z:return this._coordinates[t].z;default:}return Xt.NaN};Wo.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};Wo.prototype.getCoordinateCopy=function(t){return new se(this._coordinates[t])};Wo.prototype.getDimension=function(){return this._dimension};Wo.prototype.getX=function(t){return this._coordinates[t].x};Wo.prototype.clone=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].clone();return new Wo(n,this._dimension)};Wo.prototype.expandEnvelope=function(t){for(var n=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(n._coordinates[r]);return t};Wo.prototype.copy=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].copy();return new Wo(n,this._dimension)};Wo.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var n=new zh(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(t._coordinates[r]);return n.append(")"),n.toString()}else return"()"};Wo.prototype.getY=function(t){return this._coordinates[t].y};Wo.prototype.toCoordinateArray=function(){return this._coordinates};Wo.prototype.interfaces_=function(){return[En,Nc]};Wo.prototype.getClass=function(){return Wo};pre.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(Wo,pre);var Nd=function(){},U4={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Nd.prototype.readResolve=function(){return Nd.instance()};Nd.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Wo(t)}else if(Lt(arguments[0],En)){var n=arguments[0];return new Wo(n)}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];return o>3&&(o=3),o<2?new Wo(r):new Wo(r,o)}};Nd.prototype.interfaces_=function(){return[Dx,Nc]};Nd.prototype.getClass=function(){return Nd};Nd.instance=function(){return Nd.instanceObject};U4.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};U4.instanceObject.get=function(){return new Nd};Object.defineProperties(Nd,U4);var mre=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,o){return this.map_.set(r,o),o},t.prototype.values=function(){for(var r=new Fe,o=this.map_.values(),a=o.next();!a.done;)r.add(a.value),a=o.next();return r},t.prototype.entrySet=function(){var r=new k4;return this.map_.entries().forEach(function(o){return r.add(o)}),r},t.prototype.size=function(){return this.map_.size()},t}(Ov),Yr=function e(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ph){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},H4={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Yr.prototype.equals=function(t){if(!(t instanceof Yr))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale};Yr.prototype.compareTo=function(t){var n=t,r=this.getMaximumSignificantDigits(),o=n.getMaximumSignificantDigits();return new bh(r).compareTo(new bh(o))};Yr.prototype.getScale=function(){return this._scale};Yr.prototype.isFloating=function(){return this._modelType===Yr.FLOATING||this._modelType===Yr.FLOATING_SINGLE};Yr.prototype.getType=function(){return this._modelType};Yr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Yr.FLOATING?t="Floating":this._modelType===Yr.FLOATING_SINGLE?t="Floating-Single":this._modelType===Yr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};Yr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Xt.isNaN(t))return t;if(this._modelType===Yr.FLOATING_SINGLE){var n=t;return n}return this._modelType===Yr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof se){var r=arguments[0];if(this._modelType===Yr.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Yr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Yr.FLOATING?t=16:this._modelType===Yr.FLOATING_SINGLE?t=6:this._modelType===Yr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};Yr.prototype.setScale=function(t){this._scale=Math.abs(t)};Yr.prototype.interfaces_=function(){return[Nc,Oc]};Yr.prototype.getClass=function(){return Yr};Yr.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n};H4.serialVersionUID.get=function(){return 7777263578777804e3};H4.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Yr,H4);var Ph=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},q4={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ph.prototype.readResolve=function(){return Ph.nameToTypeMap.get(this._name)};Ph.prototype.toString=function(){return this._name};Ph.prototype.interfaces_=function(){return[Nc]};Ph.prototype.getClass=function(){return Ph};q4.serialVersionUID.get=function(){return-552860263173159e4};q4.nameToTypeMap.get=function(){return new mre};Object.defineProperties(Ph,q4);Yr.Type=Ph;Yr.FIXED=new Ph("FIXED");Yr.FLOATING=new Ph("FLOATING");Yr.FLOATING_SINGLE=new Ph("FLOATING SINGLE");var hn=function e(){this._precisionModel=new Yr,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Lt(arguments[0],Dx)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Yr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},gre={serialVersionUID:{configurable:!0}};hn.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new se(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new se(t.getMinX(),t.getMinY()),new se(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new se(t.getMinX(),t.getMinY()),new se(t.getMinX(),t.getMaxY()),new se(t.getMaxX(),t.getMaxY()),new se(t.getMaxX(),t.getMinY()),new se(t.getMinX(),t.getMinY())]),null)};hn.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new Mo(this.getCoordinateSequenceFactory().create(t),this);if(Lt(t,En))return new Mo(t,this)}else return new Mo(this.getCoordinateSequenceFactory().create([]),this)};hn.prototype.createMultiLineString=function(){if(arguments.length===0)return new o_(null,this);if(arguments.length===1){var t=arguments[0];return new o_(t,this)}};hn.prototype.buildGeometry=function(t){for(var n=null,r=!1,o=!1,a=t.iterator();a.hasNext();){var s=a.next(),u=s.getClass();n===null&&(n=u),u!==n&&(r=!0),s.isGeometryCollectionOrDerived()&&(o=!0)}if(n===null)return this.createGeometryCollection();if(r||o)return this.createGeometryCollection(hn.toGeometryArray(t));var l=t.iterator().next(),c=t.size()>1;if(c){if(l instanceof Da)return this.createMultiPolygon(hn.toPolygonArray(t));if(l instanceof Mo)return this.createMultiLineString(hn.toLineStringArray(t));if(l instanceof El)return this.createMultiPoint(hn.toPointArray(t));nn.shouldNeverReachHere("Unhandled class: "+l.getClass().getName())}return l};hn.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};hn.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof se){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Lt(arguments[0],En)){var n=arguments[0];return new El(n,this)}}};hn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};hn.prototype.createPolygon=function(){if(arguments.length===0)return new Da(null,null,this);if(arguments.length===1){if(Lt(arguments[0],En)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof Od){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return new Da(o,a,this)}};hn.prototype.getSRID=function(){return this._SRID};hn.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Cu(null,this);if(arguments.length===1){var t=arguments[0];return new Cu(t,this)}};hn.prototype.createGeometry=function(t){var n=new Lc(this);return n.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};hn.prototype.getPrecisionModel=function(){return this._precisionModel};hn.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Lt(arguments[0],En)){var n=arguments[0];return new Od(n,this)}}};hn.prototype.createMultiPolygon=function(){if(arguments.length===0)return new Md(null,this);if(arguments.length===1){var t=arguments[0];return new Md(t,this)}};hn.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new Nx(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new Nx(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(Lt(arguments[0],En)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(o.size()).fill(null),s=0;s<o.size();s++){var u=t.getCoordinateSequenceFactory().create(1,o.getDimension());Xo.copy(o,s,u,0,1),a[s]=t.createPoint(u)}return this.createMultiPoint(a)}}};hn.prototype.interfaces_=function(){return[Nc]};hn.prototype.getClass=function(){return hn};hn.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.getDefaultCoordinateSequenceFactory=function(){return Nd.instance()};hn.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};hn.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)};gre.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(hn,gre);var EFe=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],pR=function(t){this.geometryFactory=t||new hn};pR.prototype.read=function(t){var n;typeof t=="string"?n=JSON.parse(t):n=t;var r=n.type;if(!xh[r])throw new Error("Unknown GeoJSON type: "+n.type);return EFe.indexOf(r)!==-1?xh[r].apply(this,[n.coordinates]):r==="GeometryCollection"?xh[r].apply(this,[n.geometries]):xh[r].apply(this,[n])};pR.prototype.write=function(t){var n=t.getGeometryType();if(!Xp[n])throw new Error("Geometry is not supported");return Xp[n].apply(this,[t])};var xh={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var r=e.geometry.type;if(!xh[r])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=xh.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t=this,n={};if(e.features){n.features=[];for(var r=0;r<e.features.length;++r)n.features.push(t.read(e.features[r]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push(new se(r[0],r[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new se(e[0],e[1]),new se(e[2],e[1]),new se(e[2],e[3]),new se(e[0],e[3]),new se(e[0],e[1])])},Point:function(e){var t=new se(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(xh.Point.apply(t,[e[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var t=xh.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(xh.LineString.apply(t,[e[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var t=this,n=xh.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(n),o=[],a=1;a<e.length;++a){var s=e[a],u=xh.coordinates.apply(t,[s]),l=t.geometryFactory.createLinearRing(u);o.push(l)}return this.geometryFactory.createPolygon(r,o)},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(xh.Polygon.apply(t,[o]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var o=e[r];n.push(t.read(o))}return this.geometryFactory.createGeometryCollection(n)}},Xp={coordinate:function(e){return[e.x,e.y]},Point:function(e){var t=Xp.coordinate.apply(this,[e.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Xp.Point.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var t=this,n=[],r=e.getCoordinates(),o=0;o<r.length;++o){var a=r[o];n.push(Xp.coordinate.apply(t,[a]))}return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Xp.LineString.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var t=this,n=[],r=Xp.LineString.apply(this,[e._shell]);n.push(r.coordinates);for(var o=0;o<e._holes.length;++o){var a=e._holes[o],s=Xp.LineString.apply(t,[a]);n.push(s.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=Xp.Polygon.apply(t,[o]);n.push(a.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var o=e._geometries[r],a=o.getGeometryType();n.push(Xp[a].apply(t,[o]))}return{type:"GeometryCollection",geometries:n}}},tw=function(t){this.geometryFactory=t||new hn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new pR(this.geometryFactory)};tw.prototype.read=function(t){var n=this.parser.read(t);return this.precisionModel.getType()===Yr.FIXED&&this.reducePrecision(n),n};tw.prototype.reducePrecision=function(t){var n=this,r,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,o=t.points.length;r<o;r++)n.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,o=t.geometries.length;r<o;r++)n.reducePrecision(t.geometries[r])};var VA=function(){this.parser=new pR(this.geometryFactory)};VA.prototype.write=function(t){return this.parser.write(t)};var Me=function(){},mR={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Me.prototype.interfaces_=function(){return[]};Me.prototype.getClass=function(){return Me};Me.opposite=function(t){return t===Me.LEFT?Me.RIGHT:t===Me.RIGHT?Me.LEFT:t};mR.ON.get=function(){return 0};mR.LEFT.get=function(){return 1};mR.RIGHT.get=function(){return 2};Object.defineProperties(Me,mR);function gR(e){this.message=e||""}gR.prototype=new Error;gR.prototype.name="EmptyStackException";function Vh(){this.array_=[]}Vh.prototype=new mf;Vh.prototype.add=function(e){return this.array_.push(e),!0};Vh.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]};Vh.prototype.push=function(e){return this.array_.push(e),e};Vh.prototype.pop=function(e){if(this.array_.length===0)throw new gR;return this.array_.pop()};Vh.prototype.peek=function(){if(this.array_.length===0)throw new gR;return this.array_[this.array_.length-1]};Vh.prototype.empty=function(){return this.array_.length===0};Vh.prototype.isEmpty=function(){return this.empty()};Vh.prototype.search=function(e){return this.array_.indexOf(e)};Vh.prototype.size=function(){return this.array_.length};Vh.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};var Mh=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Mh.prototype.getCoordinate=function(){return this._minCoord};Mh.prototype.getRightmostSide=function(t,n){var r=this.getRightmostSideOfSegment(t,n);return r<0&&(r=this.getRightmostSideOfSegment(t,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};Mh.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();nn.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this._minIndex-1],r=t[this._minIndex+1],o=He.computeOrientation(this._minCoord,r,n),a=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&o===He.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&o===He.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};Mh.prototype.getRightmostSideOfSegment=function(t,n){var r=t.getEdge(),o=r.getCoordinates();if(n<0||n+1>=o.length||o[n].y===o[n+1].y)return-1;var a=Me.LEFT;return o[n].y<o[n+1].y&&(a=Me.RIGHT),a};Mh.prototype.getEdge=function(){return this._orientedDe};Mh.prototype.checkForRightmostCoordinate=function(t){for(var n=this,r=t.getEdge().getCoordinates(),o=0;o<r.length-1;o++)(n._minCoord===null||r[o].x>n._minCoord.x)&&(n._minDe=t,n._minIndex=o,n._minCoord=r[o])};Mh.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),n=t.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Mh.prototype.findEdge=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();!o.isForward()||n.checkForRightmostCoordinate(o)}nn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Me.LEFT&&(this._orientedDe=this._minDe.getSym())};Mh.prototype.interfaces_=function(){return[]};Mh.prototype.getClass=function(){return Mh};var nm=function(e){function t(n,r){e.call(this,t.msgWithCoord(n,r)),this.pt=r?new se(r):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,o){return o?r:r+" [ "+o+" ]"},t}(em),_R=function(){this.array_=[]};_R.prototype.addLast=function(t){this.array_.push(t)};_R.prototype.removeFirst=function(){return this.array_.shift()};_R.prototype.isEmpty=function(){return this.array_.length===0};var xu=function(){this._finder=null,this._dirEdgeList=new Fe,this._nodes=new Fe,this._rightMostCoord=null,this._env=null,this._finder=new Mh};xu.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}};xu.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};xu.prototype.computeNodeDepth=function(t){for(var n=this,r=null,o=t.getEdges().iterator();o.hasNext();){var a=o.next();if(a.isVisited()||a.getSym().isVisited()){r=a;break}}if(r===null)throw new nm("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var s=t.getEdges().iterator();s.hasNext();){var u=s.next();u.setVisited(!0),n.copySymDepths(u)}};xu.prototype.computeDepth=function(t){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(Me.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)};xu.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};xu.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Me.RIGHT)>=1&&n.getDepth(Me.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};xu.prototype.computeDepths=function(t){var n=this,r=new k4,o=new _R,a=t.getNode();for(o.addLast(a),r.add(a),t.setVisited(!0);!o.isEmpty();){var s=o.removeFirst();r.add(s),n.computeNodeDepth(s);for(var u=s.getEdges().iterator();u.hasNext();){var l=u.next(),c=l.getSym();if(!c.isVisited()){var f=c.getNode();r.contains(f)||(o.addLast(f),r.add(f))}}}};xu.prototype.compareTo=function(t){var n=t;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};xu.prototype.getEnvelope=function(){if(this._env===null){for(var t=new lt,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),o=r.getEdge().getCoordinates(),a=0;a<o.length-1;a++)t.expandToInclude(o[a]);this._env=t}return this._env};xu.prototype.addReachable=function(t){var n=this,r=new Vh;for(r.add(t);!r.empty();){var o=r.pop();n.add(o,r)}};xu.prototype.copySymDepths=function(t){var n=t.getSym();n.setDepth(Me.LEFT,t.getDepth(Me.RIGHT)),n.setDepth(Me.RIGHT,t.getDepth(Me.LEFT))};xu.prototype.add=function(t,n){var r=this;t.setVisited(!0),this._nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var a=o.next();r._dirEdgeList.add(a);var s=a.getSym(),u=s.getNode();u.isVisited()||n.push(u)}};xu.prototype.getNodes=function(){return this._nodes};xu.prototype.getDirectedEdges=function(){return this._dirEdgeList};xu.prototype.interfaces_=function(){return[Oc]};xu.prototype.getClass=function(){return xu};var Wi=function e(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Me.ON]=r}else if(arguments[0]instanceof e){var o=arguments[0];if(this.init(o.location.length),o!==null)for(var a=0;a<this.location.length;a++)t.location[a]=o.location[a]}}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.init(3),this.location[Me.ON]=s,this.location[Me.LEFT]=u,this.location[Me.RIGHT]=l}};Wi.prototype.setAllLocations=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=t};Wi.prototype.isNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]!==de.NONE)return!1;return!0};Wi.prototype.setAllLocationsIfNull=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===de.NONE&&(n.location[r]=t)};Wi.prototype.isLine=function(){return this.location.length===1};Wi.prototype.merge=function(t){var n=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[Me.ON]=this.location[Me.ON],r[Me.LEFT]=de.NONE,r[Me.RIGHT]=de.NONE,this.location=r}for(var o=0;o<this.location.length;o++)n.location[o]===de.NONE&&o<t.location.length&&(n.location[o]=t.location[o])};Wi.prototype.getLocations=function(){return this.location};Wi.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Me.LEFT];this.location[Me.LEFT]=this.location[Me.RIGHT],this.location[Me.RIGHT]=t};Wi.prototype.toString=function(){var t=new zh;return this.location.length>1&&t.append(de.toLocationSymbol(this.location[Me.LEFT])),t.append(de.toLocationSymbol(this.location[Me.ON])),this.location.length>1&&t.append(de.toLocationSymbol(this.location[Me.RIGHT])),t.toString()};Wi.prototype.setLocations=function(t,n,r){this.location[Me.ON]=t,this.location[Me.LEFT]=n,this.location[Me.RIGHT]=r};Wi.prototype.get=function(t){return t<this.location.length?this.location[t]:de.NONE};Wi.prototype.isArea=function(){return this.location.length>1};Wi.prototype.isAnyNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]===de.NONE)return!0;return!1};Wi.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Me.ON,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};Wi.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(de.NONE)};Wi.prototype.isEqualOnSide=function(t,n){return this.location[n]===t.location[n]};Wi.prototype.allPositionsEqual=function(t){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==t)return!1;return!0};Wi.prototype.interfaces_=function(){return[]};Wi.prototype.getClass=function(){return Wi};var ii=function e(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Wi(t),this.elt[1]=new Wi(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new Wi(n.elt[0]),this.elt[1]=new Wi(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.elt[0]=new Wi(de.NONE),this.elt[1]=new Wi(de.NONE),this.elt[r].setLocation(o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this.elt[0]=new Wi(a,s,u),this.elt[1]=new Wi(a,s,u)}else if(arguments.length===4){var l=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3];this.elt[0]=new Wi(de.NONE,de.NONE,de.NONE),this.elt[1]=new Wi(de.NONE,de.NONE,de.NONE),this.elt[l].setLocations(c,f,h)}};ii.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};ii.prototype.setAllLocations=function(t,n){this.elt[t].setAllLocations(n)};ii.prototype.isNull=function(t){return this.elt[t].isNull()};ii.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};ii.prototype.isLine=function(t){return this.elt[t].isLine()};ii.prototype.merge=function(t){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&t.elt[r]!==null?n.elt[r]=new Wi(t.elt[r]):n.elt[r].merge(t.elt[r])};ii.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};ii.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Me.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};ii.prototype.toString=function(){var t=new zh;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};ii.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};ii.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};ii.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Me.ON,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this.elt[r].setLocation(o,a)}};ii.prototype.isEqualOnSide=function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)};ii.prototype.allPositionsEqual=function(t,n){return this.elt[t].allPositionsEqual(n)};ii.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Wi(this.elt[t].location[0]))};ii.prototype.interfaces_=function(){return[]};ii.prototype.getClass=function(){return ii};ii.toLineLabel=function(t){for(var n=new ii(de.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n};var ca=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Fe,this._pts=new Fe,this._label=new ii(de.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Fe,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()};ca.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=He.isCCW(this._ring.getCoordinates())};ca.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};ca.prototype.computePoints=function(t){var n=this;this._startDe=t;var r=t,o=!0;do{if(r===null)throw new nm("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new nm("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var a=r.getLabel();nn.isTrue(a.isArea()),n.mergeLabel(a),n.addPoints(r.getEdge(),r.isForward(),o),o=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};ca.prototype.getLinearRing=function(){return this._ring};ca.prototype.getCoordinate=function(t){return this._pts.get(t)};ca.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),o=r.getEdges().getOutgoingDegree(t);o>t._maxNodeDegree&&(t._maxNodeDegree=o),n=t.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};ca.prototype.addPoints=function(t,n,r){var o=this,a=t.getCoordinates();if(n){var s=1;r&&(s=0);for(var u=s;u<a.length;u++)o._pts.add(a[u])}else{var l=a.length-2;r&&(l=a.length-1);for(var c=l;c>=0;c--)o._pts.add(a[c])}};ca.prototype.isHole=function(){return this._isHole};ca.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};ca.prototype.containsPoint=function(t){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(t)||!He.isPointInRing(t,n.getCoordinates()))return!1;for(var o=this._holes.iterator();o.hasNext();){var a=o.next();if(a.containsPoint(t))return!1}return!0};ca.prototype.addHole=function(t){this._holes.add(t)};ca.prototype.isShell=function(){return this._shell===null};ca.prototype.getLabel=function(){return this._label};ca.prototype.getEdges=function(){return this._edges};ca.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};ca.prototype.getShell=function(){return this._shell};ca.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=n.getLocation(r,Me.RIGHT);if(o===de.NONE)return null;if(this._label.getLocation(r)===de.NONE)return this._label.setLocation(r,o),null}};ca.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};ca.prototype.toPolygon=function(t){for(var n=this,r=new Array(this._holes.size()).fill(null),o=0;o<this._holes.size();o++)r[o]=n._holes.get(o).getLinearRing();var a=t.createPolygon(this.getLinearRing(),r);return a};ca.prototype.interfaces_=function(){return[]};ca.prototype.getClass=function(){return ca};var TFe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,o){r.setMinEdgeRing(o)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ca),SFe=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,o=new Fe,a=this._startDe;do{if(a.getMinEdgeRing()===null){var s=new TFe(a,r._geometryFactory);o.add(s)}a=a.getNext()}while(a!==this._startDe);return o},t.prototype.setEdgeRing=function(r,o){r.setEdgeRing(o)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,o=this._startDe;do{var a=o.getNode();a.getEdges().linkMinimalDirectedEdges(r),o=o.getNext()}while(o!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ca),tc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};tc.prototype.setVisited=function(t){this._isVisited=t};tc.prototype.setInResult=function(t){this._isInResult=t};tc.prototype.isCovered=function(){return this._isCovered};tc.prototype.isCoveredSet=function(){return this._isCoveredSet};tc.prototype.setLabel=function(t){this._label=t};tc.prototype.getLabel=function(){return this._label};tc.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};tc.prototype.updateIM=function(t){nn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};tc.prototype.isInResult=function(){return this._isInResult};tc.prototype.isVisited=function(){return this._isVisited};tc.prototype.interfaces_=function(){return[]};tc.prototype.getClass=function(){return tc};var yR=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new ii(0,de.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var o=r.next();if(o.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,o){var a=de.NONE;if(a=this._label.getLocation(o),!r.isNull(o)){var s=r.getLocation(o);a!==de.BOUNDARY&&(a=s)}return a},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];this._label===null?this._label=new ii(r,o):this._label.setLocation(r,o)}else return e.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var o=arguments[0];this.mergeLabel(o._label)}else if(arguments[0]instanceof ii)for(var a=arguments[0],s=0;s<2;s++){var u=r.computeMergedLocation(a,s),l=r._label.getLocation(s);l===de.NONE&&r._label.setLocation(s,u)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var o=de.NONE;this._label!==null&&(o=this._label.getLocation(r));var a=null;switch(o){case de.BOUNDARY:a=de.INTERIOR;break;case de.INTERIOR:a=de.BOUNDARY;break;default:a=de.BOUNDARY;break}this._label.setLocation(r,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(tc),Lh=function(){this.nodeMap=new Gs,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Lh.prototype.find=function(t){return this.nodeMap.get(t)};Lh.prototype.addNode=function(){if(arguments[0]instanceof se){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}else if(arguments[0]instanceof yR){var r=arguments[0],o=this.nodeMap.get(r.getCoordinate());return o===null?(this.nodeMap.put(r.getCoordinate(),r),r):(o.mergeLabel(r),o)}};Lh.prototype.print=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Lh.prototype.iterator=function(){return this.nodeMap.values().iterator()};Lh.prototype.values=function(){return this.nodeMap.values()};Lh.prototype.getBoundaryNodes=function(t){for(var n=new Fe,r=this.iterator();r.hasNext();){var o=r.next();o.getLabel().getLocation(t)===de.BOUNDARY&&n.add(o)}return n};Lh.prototype.add=function(t){var n=t.getCoordinate(),r=this.addNode(n);r.add(t)};Lh.prototype.interfaces_=function(){return[]};Lh.prototype.getClass=function(){return Lh};var bi=function(){},kA={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};bi.prototype.interfaces_=function(){return[]};bi.prototype.getClass=function(){return bi};bi.isNorthern=function(t){return t===bi.NE||t===bi.NW};bi.isOpposite=function(t,n){if(t===n)return!1;var r=(t-n+4)%4;return r===2};bi.commonHalfPlane=function(t,n){if(t===n)return t;var r=(t-n+4)%4;if(r===2)return-1;var o=t<n?t:n,a=t>n?t:n;return o===0&&a===3?3:o};bi.isInHalfPlane=function(t,n){return n===bi.SE?t===bi.SE||t===bi.SW:t===n||t===n+1};bi.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new fo("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?bi.NE:bi.SE:n>=0?bi.NW:bi.SW}else if(arguments[0]instanceof se&&arguments[1]instanceof se){var r=arguments[0],o=arguments[1];if(o.x===r.x&&o.y===r.y)throw new fo("Cannot compute the quadrant for two identical points "+r);return o.x>=r.x?o.y>=r.y?bi.NE:bi.SE:o.y>=r.y?bi.NW:bi.SW}};kA.NE.get=function(){return 0};kA.NW.get=function(){return 1};kA.SW.get=function(){return 2};kA.SE.get=function(){return 3};Object.defineProperties(bi,kA);var Us=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=null;this._edge=n,this.init(r,o),this._label=a}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];this._edge=s,this.init(u,l),this._label=c}};Us.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:He.computeOrientation(t._p0,t._p1,this._p1)};Us.prototype.getDy=function(){return this._dy};Us.prototype.getCoordinate=function(){return this._p0};Us.prototype.setNode=function(t){this._node=t};Us.prototype.print=function(t){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),o=r.lastIndexOf("."),a=r.substring(o+1);t.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Us.prototype.compareTo=function(t){var n=t;return this.compareDirection(n)};Us.prototype.getDirectedCoordinate=function(){return this._p1};Us.prototype.getDx=function(){return this._dx};Us.prototype.getLabel=function(){return this._label};Us.prototype.getEdge=function(){return this._edge};Us.prototype.getQuadrant=function(){return this._quadrant};Us.prototype.getNode=function(){return this._node};Us.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),o=n.substring(r+1);return"  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};Us.prototype.computeLabel=function(t){};Us.prototype.init=function(t,n){this._p0=t,this._p1=n,this._dx=n.x-t.x,this._dy=n.y-t.y,this._quadrant=bi.quadrant(this._dx,this._dy),nn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Us.prototype.interfaces_=function(){return[Oc]};Us.prototype.getClass=function(){return Us};var n4=function(e){function t(){var n=arguments[0],r=arguments[1];if(e.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var o=n.getNumPoints()-1;this.init(n.getCoordinate(o),n.getCoordinate(o-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new ii(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,o){if(this._depth[r]!==-999&&this._depth[r]!==o)throw new nm("assigned depths do not match",this.getCoordinate());this._depth[r]=o},t.prototype.isInteriorAreaEdge=function(){for(var r=this,o=!0,a=0;a<2;a++)r._label.isArea(a)&&r._label.getLocation(a,Me.LEFT)===de.INTERIOR&&r._label.getLocation(a,Me.RIGHT)===de.INTERIOR||(o=!1);return o},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){e.prototype.print.call(this,r),r.print(" "+this._depth[Me.LEFT]+"/"+this._depth[Me.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,de.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,de.EXTERIOR);return r&&o&&a},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,o){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var s=1;r===Me.LEFT&&(s=-1);var u=Me.opposite(r),l=a*s,c=o+l;this.setDepth(r,o),this.setDepth(u,c)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,o){return r===de.EXTERIOR&&o===de.INTERIOR?1:r===de.INTERIOR&&o===de.EXTERIOR?-1:0},t}(Us),Bx=function(){};Bx.prototype.createNode=function(t){return new yR(t,null)};Bx.prototype.interfaces_=function(){return[]};Bx.prototype.getClass=function(){return Bx};var Eo=function(){if(this._edges=new Fe,this._nodes=null,this._edgeEndList=new Fe,arguments.length===0)this._nodes=new Lh(new Bx);else if(arguments.length===1){var t=arguments[0];this._nodes=new Lh(t)}};Eo.prototype.printEdges=function(t){var n=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var o=n._edges.get(r);o.print(t),o.eiList.print(t)}};Eo.prototype.find=function(t){return this._nodes.find(t)};Eo.prototype.addNode=function(){if(arguments[0]instanceof yR){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof se){var n=arguments[0];return this._nodes.addNode(n)}};Eo.prototype.getNodeIterator=function(){return this._nodes.iterator()};Eo.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}};Eo.prototype.debugPrintln=function(t){xs.out.println(t)};Eo.prototype.isBoundaryNode=function(t,n){var r=this._nodes.find(n);if(r===null)return!1;var o=r.getLabel();return o!==null&&o.getLocation(t)===de.BOUNDARY};Eo.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}};Eo.prototype.matchInSameDirection=function(t,n,r,o){return t.equals(r)?He.computeOrientation(t,n,o)===He.COLLINEAR&&bi.quadrant(t,n)===bi.quadrant(r,o):!1};Eo.prototype.getEdgeEnds=function(){return this._edgeEndList};Eo.prototype.debugPrint=function(t){xs.out.print(t)};Eo.prototype.getEdgeIterator=function(){return this._edges.iterator()};Eo.prototype.findEdgeInSameDirection=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(r.matchInSameDirection(t,n,s[0],s[1])||r.matchInSameDirection(t,n,s[s.length-1],s[s.length-2]))return a}return null};Eo.prototype.insertEdge=function(t){this._edges.add(t)};Eo.prototype.findEdgeEnd=function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===t)return r}return null};Eo.prototype.addEdges=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next();n._edges.add(o);var a=new n4(o,!0),s=new n4(o,!1);a.setSym(s),s.setSym(a),n.add(a),n.add(s)}};Eo.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};Eo.prototype.getNodes=function(){return this._nodes.values()};Eo.prototype.findEdge=function(t,n){for(var r=this,o=0;o<this._edges.size();o++){var a=r._edges.get(o),s=a.getCoordinates();if(t.equals(s[0])&&n.equals(s[1]))return a}return null};Eo.prototype.interfaces_=function(){return[]};Eo.prototype.getClass=function(){return Eo};Eo.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var Tl=function(){this._geometryFactory=null,this._shellList=new Fe;var t=arguments[0];this._geometryFactory=t};Tl.prototype.sortShellsAndHoles=function(t,n,r){for(var o=t.iterator();o.hasNext();){var a=o.next();a.isHole()?r.add(a):n.add(a)}};Tl.prototype.computePolygons=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=a.toPolygon(n._geometryFactory);r.add(s)}return r};Tl.prototype.placeFreeHoles=function(t,n){for(var r=this,o=n.iterator();o.hasNext();){var a=o.next();if(a.getShell()===null){var s=r.findEdgeRingContaining(a,t);if(s===null)throw new nm("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(s)}}};Tl.prototype.buildMinimalEdgeRings=function(t,n,r){for(var o=this,a=new Fe,s=t.iterator();s.hasNext();){var u=s.next();if(u.getMaxNodeDegree()>2){u.linkDirectedEdgesForMinimalEdgeRings();var l=u.buildMinimalRings(),c=o.findShell(l);c!==null?(o.placePolygonHoles(c,l),n.add(c)):r.addAll(l)}else a.add(u)}return a};Tl.prototype.containsPoint=function(t){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(t))return!0}return!1};Tl.prototype.buildMaximalEdgeRings=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var s=new SFe(a,n._geometryFactory);r.add(s),s.setInResult()}}return r};Tl.prototype.placePolygonHoles=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next();o.isHole()&&o.setShell(t)}};Tl.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};Tl.prototype.findEdgeRingContaining=function(t,n){for(var r=t.getLinearRing(),o=r.getEnvelopeInternal(),a=r.getCoordinateN(0),s=null,u=null,l=n.iterator();l.hasNext();){var c=l.next(),f=c.getLinearRing(),h=f.getEnvelopeInternal();s!==null&&(u=s.getLinearRing().getEnvelopeInternal());var d=!1;h.contains(o)&&He.isPointInRing(a,f.getCoordinates())&&(d=!0),d&&(s===null||u.contains(h))&&(s=c)}return s};Tl.prototype.findShell=function(t){for(var n=0,r=null,o=t.iterator();o.hasNext();){var a=o.next();a.isHole()||(r=a,n++)}return nn.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};Tl.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];Eo.linkResultDirectedEdges(r);var o=this.buildMaximalEdgeRings(n),a=new Fe,s=this.buildMinimalEdgeRings(o,this._shellList,a);this.sortShellsAndHoles(s,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};Tl.prototype.interfaces_=function(){return[]};Tl.prototype.getClass=function(){return Tl};var Fx=function(){};Fx.prototype.getBounds=function(){};Fx.prototype.interfaces_=function(){return[]};Fx.prototype.getClass=function(){return Fx};var yf=function(){this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n};yf.prototype.getItem=function(){return this._item};yf.prototype.getBounds=function(){return this._bounds};yf.prototype.interfaces_=function(){return[Fx,Nc]};yf.prototype.getClass=function(){return yf};var rm=function(){this._size=null,this._items=null,this._size=0,this._items=new Fe,this._items.add(null)};rm.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};rm.prototype.size=function(){return this._size};rm.prototype.reorder=function(t){for(var n=this,r=null,o=this._items.get(t);t*2<=this._size&&(r=t*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(o)<0);t=r)n._items.set(t,n._items.get(r));this._items.set(t,o)};rm.prototype.clear=function(){this._size=0,this._items.clear()};rm.prototype.isEmpty=function(){return this._size===0};rm.prototype.add=function(t){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,t)};rm.prototype.interfaces_=function(){return[]};rm.prototype.getClass=function(){return rm};var Sg=function(){};Sg.prototype.visitItem=function(t){};Sg.prototype.interfaces_=function(){return[]};Sg.prototype.getClass=function(){return Sg};var xv=function(){};xv.prototype.insert=function(t,n){};xv.prototype.remove=function(t,n){};xv.prototype.query=function(){};xv.prototype.interfaces_=function(){return[]};xv.prototype.getClass=function(){return xv};var Aa=function(){if(this._childBoundables=new Fe,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},_re={serialVersionUID:{configurable:!0}};Aa.prototype.getLevel=function(){return this._level};Aa.prototype.size=function(){return this._childBoundables.size()};Aa.prototype.getChildBoundables=function(){return this._childBoundables};Aa.prototype.addChildBoundable=function(t){nn.isTrue(this._bounds===null),this._childBoundables.add(t)};Aa.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Aa.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Aa.prototype.interfaces_=function(){return[Fx,Nc]};Aa.prototype.getClass=function(){return Aa};_re.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Aa,_re);var vf=function(){};vf.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};vf.min=function(t){return vf.sort(t),t.get(0)};vf.sort=function(t,n){var r=t.toArray();n?t_.sort(r,n):t_.sort(r);for(var o=t.iterator(),a=0,s=r.length;a<s;a++)o.next(),o.set(r[a])};vf.singletonList=function(t){var n=new Fe;return n.add(t),n};var sa=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};sa.prototype.expandToQueue=function(t,n){var r=sa.isComposite(this._boundable1),o=sa.isComposite(this._boundable2);if(r&&o)return sa.area(this._boundable1)>sa.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,t,n),null;if(o)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new fo("neither boundable is composite")};sa.prototype.isLeaves=function(){return!(sa.isComposite(this._boundable1)||sa.isComposite(this._boundable2))};sa.prototype.compareTo=function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0};sa.prototype.expand=function(t,n,r,o){for(var a=this,s=t.getChildBoundables(),u=s.iterator();u.hasNext();){var l=u.next(),c=new sa(l,n,a._itemDistance);c.getDistance()<o&&r.add(c)}};sa.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};sa.prototype.getDistance=function(){return this._distance};sa.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};sa.prototype.interfaces_=function(){return[Oc]};sa.prototype.getClass=function(){return sa};sa.area=function(t){return t.getBounds().getArea()};sa.isComposite=function(t){return t instanceof Aa};var Ja=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Fe,this._nodeCapacity=null,arguments.length===0){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var n=arguments[0];nn.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},vR={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ja.prototype.getNodeCapacity=function(){return this._nodeCapacity};Ja.prototype.lastNode=function(t){return t.get(t.size()-1)};Ja.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Aa?r+=t.size(a):a instanceof yf&&(r+=1)}return r}};Ja.prototype.removeItem=function(t,n){for(var r=null,o=t.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof yf&&a.getItem()===n&&(r=a)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};Ja.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new Fe:n}else if(arguments.length===1){for(var r=arguments[0],o=new Fe,a=r.getChildBoundables().iterator();a.hasNext();){var s=a.next();if(s instanceof Aa){var u=t.itemsTree(s);u!==null&&o.add(u)}else s instanceof yf?o.add(s.getItem()):nn.shouldNeverReachHere()}return o.size()<=0?null:o}};Ja.prototype.insert=function(t,n){nn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new yf(t,n))};Ja.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var n=arguments[0],r=new Fe;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];if(nn.isTrue(o>-2),a.getLevel()===o)return s.add(a),null;for(var u=a.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof Aa?t.boundablesAtLevel(o,l,s):(nn.isTrue(l instanceof yf),o===-1&&s.add(l))}return null}};Ja.prototype.query=function(){var t=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new Fe;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var o=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,a)}else if(arguments.length===3){if(Lt(arguments[2],Sg)&&arguments[0]instanceof Object&&arguments[1]instanceof Aa)for(var s=arguments[0],u=arguments[1],l=arguments[2],c=u.getChildBoundables(),f=0;f<c.size();f++){var h=c.get(f);!t.getIntersectsOp().intersects(h.getBounds(),s)||(h instanceof Aa?t.query(s,h,l):h instanceof yf?l.visitItem(h.getItem()):nn.shouldNeverReachHere())}else if(Lt(arguments[2],mf)&&arguments[0]instanceof Object&&arguments[1]instanceof Aa)for(var d=arguments[0],p=arguments[1],g=arguments[2],y=p.getChildBoundables(),v=0;v<y.size();v++){var w=y.get(v);!t.getIntersectsOp().intersects(w.getBounds(),d)||(w instanceof Aa?t.query(d,w,g):w instanceof yf?g.add(w.getItem()):nn.shouldNeverReachHere())}}};Ja.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Ja.prototype.getRoot=function(){return this.build(),this._root};Ja.prototype.remove=function(){var t=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=this.removeItem(a,s);if(u)return!0;for(var l=null,c=a.getChildBoundables().iterator();c.hasNext();){var f=c.next();if(!!t.getIntersectsOp().intersects(f.getBounds(),o)&&f instanceof Aa&&(u=t.remove(o,f,s),u)){l=f;break}}return l!==null&&l.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(l),u}};Ja.prototype.createHigherLevels=function(t,n){nn.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};Ja.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();if(a instanceof Aa){var s=t.depth(a);s>r&&(r=s)}}return r+1}};Ja.prototype.createParentBoundables=function(t,n){var r=this;nn.isTrue(!t.isEmpty());var o=new Fe;o.add(this.createNode(n));var a=new Fe(t);vf.sort(a,this.getComparator());for(var s=a.iterator();s.hasNext();){var u=s.next();r.lastNode(o).getChildBoundables().size()===r.getNodeCapacity()&&o.add(r.createNode(n)),r.lastNode(o).addChildBoundable(u)}return o};Ja.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Ja.prototype.interfaces_=function(){return[Nc]};Ja.prototype.getClass=function(){return Ja};Ja.compareDoubles=function(t,n){return t>n?1:t<n?-1:0};vR.IntersectsOp.get=function(){return AFe};vR.serialVersionUID.get=function(){return-3886435814360241e3};vR.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Ja,vR);var AFe=function(){},zx=function(){};zx.prototype.distance=function(t,n){};zx.prototype.interfaces_=function(){return[]};zx.prototype.getClass=function(){return zx};var yre=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(o,a){var s=this;nn.isTrue(o.length>0);for(var u=new Fe,l=0;l<o.length;l++)u.addAll(s.createParentBoundablesFromVerticalSlice(o[l],a));return u},t.prototype.createNode=function(o){return new Ste(o)},t.prototype.size=function(){return arguments.length===0?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];if(o.isNull())return null;e.prototype.insert.call(this,o,a)}else return e.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(o,a){for(var s=Math.trunc(Math.ceil(o.size()/a)),u=new Array(a).fill(null),l=o.iterator(),c=0;c<a;c++){u[c]=new Fe;for(var f=0;l.hasNext()&&f<s;){var h=l.next();u[c].add(h),f++}}return u},t.prototype.query=function(){if(arguments.length===1){var o=arguments[0];return e.prototype.query.call(this,o)}else if(arguments.length===2){var a=arguments[0],s=arguments[1];e.prototype.query.call(this,a,s)}else if(arguments.length===3){if(Lt(arguments[2],Sg)&&arguments[0]instanceof Object&&arguments[1]instanceof Aa){var u=arguments[0],l=arguments[1],c=arguments[2];e.prototype.query.call(this,u,l,c)}else if(Lt(arguments[2],mf)&&arguments[0]instanceof Object&&arguments[1]instanceof Aa){var f=arguments[0],h=arguments[1],d=arguments[2];e.prototype.query.call(this,f,h,d)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(o,a){return e.prototype.createParentBoundables.call(this,o,a)},t.prototype.remove=function(){if(arguments.length===2){var o=arguments[0],a=arguments[1];return e.prototype.remove.call(this,o,a)}else return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(o,a){nn.isTrue(!o.isEmpty());var s=Math.trunc(Math.ceil(o.size()/this.getNodeCapacity())),u=new Fe(o);vf.sort(u,t.xComparator);var l=this.verticalSlices(u,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(l,a)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Lt(arguments[0],zx)){var o=arguments[0],a=new sa(this.getRoot(),this.getRoot(),o);return this.nearestNeighbour(a)}else if(arguments[0]instanceof sa){var s=arguments[0];return this.nearestNeighbour(s,Xt.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Lt(arguments[1],zx)){var u=arguments[0],l=arguments[1],c=new sa(this.getRoot(),u.getRoot(),l);return this.nearestNeighbour(c)}else if(arguments[0]instanceof sa&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=h,p=null,g=new rm;for(g.add(f);!g.isEmpty()&&d>0;){var y=g.poll(),v=y.getDistance();if(v>=d)break;y.isLeaves()?(d=v,p=y):y.expandToQueue(g,d)}return[p.getBoundable(0).getItem(),p.getBoundable(1).getItem()]}}else if(arguments.length===3){var w=arguments[0],C=arguments[1],E=arguments[2],S=new yf(w,C),A=new sa(this.getRoot(),S,E);return this.nearestNeighbour(A)[0]}},t.prototype.interfaces_=function(){return[xv,Nc]},t.prototype.getClass=function(){return t},t.centreX=function(o){return t.avg(o.getMinX(),o.getMaxX())},t.avg=function(o,a){return(o+a)/2},t.centreY=function(o){return t.avg(o.getMinY(),o.getMaxY())},n.STRtreeNode.get=function(){return Ste},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[Ix]},compare:function(r,o){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(o.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[Ix]},compare:function(r,o){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(o.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(r,o){return r.intersects(o)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,n),t}(Ja),Ste=function(e){function t(){var n=arguments[0];e.call(this,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,o=this.getChildBoundables().iterator();o.hasNext();){var a=o.next();r===null?r=new lt(a.getBounds()):r.expandToInclude(a.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Aa),ku=function(){};ku.prototype.interfaces_=function(){return[]};ku.prototype.getClass=function(){return ku};ku.relativeSign=function(t,n){return t<n?-1:t>n?1:0};ku.compare=function(t,n,r){if(n.equals2D(r))return 0;var o=ku.relativeSign(n.x,r.x),a=ku.relativeSign(n.y,r.y);switch(t){case 0:return ku.compareValue(o,a);case 1:return ku.compareValue(a,o);case 2:return ku.compareValue(a,-o);case 3:return ku.compareValue(-o,a);case 4:return ku.compareValue(-o,-a);case 5:return ku.compareValue(-a,-o);case 6:return ku.compareValue(-a,o);case 7:return ku.compareValue(o,-a);default:}return nn.shouldNeverReachHere("invalid octant value"),0};ku.compareValue=function(t,n){return t<0?-1:t>0?1:n<0?-1:n>0?1:0};var Ag=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._segString=t,this.coord=new se(n),this.segmentIndex=r,this._segmentOctant=o,this._isInterior=!n.equals2D(t.getCoordinate(r))};Ag.prototype.getCoordinate=function(){return this.coord};Ag.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Ag.prototype.compareTo=function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:ku.compare(this._segmentOctant,this.coord,n.coord)};Ag.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Ag.prototype.isInterior=function(){return this._isInterior};Ag.prototype.interfaces_=function(){return[Oc]};Ag.prototype.getClass=function(){return Ag};var wu=function(){this._nodeMap=new Gs,this._edge=null;var t=arguments[0];this._edge=t};wu.prototype.getSplitCoordinates=function(){var t=this,n=new FA;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next();t.addEdgeCoordinates(o,a,n),o=a}return n.toCoordinateArray()};wu.prototype.addCollapsedNodes=function(){var t=this,n=new Fe;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var o=r.next().intValue();t.add(t._edge.getCoordinate(o),o)}};wu.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};wu.prototype.findCollapsesFromExistingVertices=function(t){for(var n=this,r=0;r<this._edge.size()-2;r++){var o=n._edge.getCoordinate(r),a=n._edge.getCoordinate(r+2);o.equals2D(a)&&t.add(new bh(r+1))}};wu.prototype.addEdgeCoordinates=function(t,n,r){var o=this,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);r.add(new se(t.coord),!1);for(var u=t.segmentIndex+1;u<=n.segmentIndex;u++)r.add(o._edge.getCoordinate(u));s&&r.add(new se(n.coord))};wu.prototype.iterator=function(){return this._nodeMap.values().iterator()};wu.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};wu.prototype.findCollapseIndex=function(t,n,r){if(!t.coord.equals2D(n.coord))return!1;var o=n.segmentIndex-t.segmentIndex;return n.isInterior()||o--,o===1?(r[0]=t.segmentIndex+1,!0):!1};wu.prototype.findCollapsesFromInsertedNodes=function(t){for(var n=this,r=new Array(1).fill(null),o=this.iterator(),a=o.next();o.hasNext();){var s=o.next(),u=n.findCollapseIndex(a,s,r);u&&t.add(new bh(r[0])),a=s}};wu.prototype.getEdge=function(){return this._edge};wu.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};wu.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this._edge.getCoordinate(n.segmentIndex),s=n.isInterior()||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new se(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r._edge.getCoordinate(c);return s&&(u[l]=new se(n.coord)),new jo(u,this._edge.getData())};wu.prototype.add=function(t,n){var r=new Ag(this._edge,t,n,this._edge.getSegmentOctant(n)),o=this._nodeMap.get(r);return o!==null?(nn.isTrue(o.coord.equals2D(t),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(r,r),r)};wu.prototype.checkSplitEdgesCorrectness=function(t){var n=this._edge.getCoordinates(),r=t.get(0),o=r.getCoordinate(0);if(!o.equals2D(n[0]))throw new em("bad split edge start point at "+o);var a=t.get(t.size()-1),s=a.getCoordinates(),u=s[s.length-1];if(!u.equals2D(n[n.length-1]))throw new em("bad split edge end point at "+u)};wu.prototype.interfaces_=function(){return[]};wu.prototype.getClass=function(){return wu};var wv=function(){};wv.prototype.interfaces_=function(){return[]};wv.prototype.getClass=function(){return wv};wv.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new fo("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),o=Math.abs(n);return t>=0?n>=0?r>=o?0:1:r>=o?7:6:n>=0?r>=o?3:2:r>=o?4:5}else if(arguments[0]instanceof se&&arguments[1]instanceof se){var a=arguments[0],s=arguments[1],u=s.x-a.x,l=s.y-a.y;if(u===0&&l===0)throw new fo("Cannot compute the octant for two identical points "+a);return wv.octant(u,l)}};var Bd=function(){};Bd.prototype.getCoordinates=function(){};Bd.prototype.size=function(){};Bd.prototype.getCoordinate=function(t){};Bd.prototype.isClosed=function(){};Bd.prototype.setData=function(t){};Bd.prototype.getData=function(){};Bd.prototype.interfaces_=function(){return[]};Bd.prototype.getClass=function(){return Bd};var wA=function(){};wA.prototype.addIntersection=function(t,n){};wA.prototype.interfaces_=function(){return[Bd]};wA.prototype.getClass=function(){return wA};var jo=function(){this._nodeList=new wu(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};jo.prototype.getCoordinates=function(){return this._pts};jo.prototype.size=function(){return this._pts.length};jo.prototype.getCoordinate=function(t){return this._pts[t]};jo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};jo.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};jo.prototype.setData=function(t){this._data=t};jo.prototype.safeOctant=function(t,n){return t.equals2D(n)?0:wv.octant(t,n)};jo.prototype.getData=function(){return this._data};jo.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[3],s=new se(r.getIntersection(a));this.addIntersection(s,o)}};jo.prototype.toString=function(){return gf.toLineString(new Wo(this._pts))};jo.prototype.getNodeList=function(){return this._nodeList};jo.prototype.addIntersectionNode=function(t,n){var r=n,o=r+1;if(o<this._pts.length){var a=this._pts[o];t.equals2D(a)&&(r=o)}var s=this._nodeList.add(t,r);return s};jo.prototype.addIntersections=function(t,n,r){for(var o=this,a=0;a<t.getIntersectionNum();a++)o.addIntersection(t,n,r,a)};jo.prototype.interfaces_=function(){return[wA]};jo.prototype.getClass=function(){return jo};jo.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new Fe;return jo.getNodedSubstrings(t,n),n}else if(arguments.length===2)for(var r=arguments[0],o=arguments[1],a=r.iterator();a.hasNext();){var s=a.next();s.getNodeList().addSplitEdges(o)}};var ft=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new se,this.p1=new se;else if(arguments.length===1){var t=arguments[0];this.p0=new se(t.p0),this.p1=new se(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3];this.p0=new se(n,r),this.p1=new se(o,a)}},vre={serialVersionUID:{configurable:!0}};ft.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ft.prototype.orientationIndex=function(){if(arguments[0]instanceof ft){var t=arguments[0],n=He.orientationIndex(this.p0,this.p1,t.p0),r=He.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof se){var o=arguments[0];return He.orientationIndex(this.p0,this.p1,o)}};ft.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};ft.prototype.isVertical=function(){return this.p0.x===this.p1.x};ft.prototype.equals=function(t){if(!(t instanceof ft))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};ft.prototype.intersection=function(t){var n=new m_;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null};ft.prototype.project=function(){if(arguments[0]instanceof se){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new se(t);var n=this.projectionFactor(t),r=new se;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof ft){var o=arguments[0],a=this.projectionFactor(o.p0),s=this.projectionFactor(o.p1);if(a>=1&&s>=1||a<=0&&s<=0)return null;var u=this.project(o.p0);a<0&&(u=this.p0),a>1&&(u=this.p1);var l=this.project(o.p1);return s<0&&(l=this.p0),s>1&&(l=this.p1),new ft(u,l)}};ft.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ft.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ft.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};ft.prototype.distancePerpendicular=function(t){return He.distancePointLinePerpendicular(t,this.p0,this.p1)};ft.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ft.prototype.midPoint=function(){return ft.midPoint(this.p0,this.p1)};ft.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,o=n*n+r*r;if(o<=0)return Xt.NaN;var a=((t.x-this.p0.x)*n+(t.y-this.p0.y)*r)/o;return a};ft.prototype.closestPoints=function(t){var n=this.intersection(t);if(n!==null)return[n,n];var r=new Array(2).fill(null),o=Xt.MAX_VALUE,a=null,s=this.closestPoint(t.p0);o=s.distance(t.p0),r[0]=s,r[1]=t.p0;var u=this.closestPoint(t.p1);a=u.distance(t.p1),a<o&&(o=a,r[0]=u,r[1]=t.p1);var l=t.closestPoint(this.p0);a=l.distance(this.p0),a<o&&(o=a,r[0]=this.p0,r[1]=l);var c=t.closestPoint(this.p1);return a=c.distance(this.p1),a<o&&(o=a,r[0]=this.p1,r[1]=c),r};ft.prototype.closestPoint=function(t){var n=this.projectionFactor(t);if(n>0&&n<1)return this.project(t);var r=this.p0.distance(t),o=this.p1.distance(t);return r<o?this.p0:this.p1};ft.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ft.prototype.getLength=function(){return this.p0.distance(this.p1)};ft.prototype.compareTo=function(t){var n=t,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};ft.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};ft.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};ft.prototype.lineIntersection=function(t){try{var n=pf.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(r){if(!(r instanceof Jx))throw r}finally{}return null};ft.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ft.prototype.pointAlongOffset=function(t,n){var r=this.p0.x+t*(this.p1.x-this.p0.x),o=this.p0.y+t*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,u=Math.sqrt(a*a+s*s),l=0,c=0;if(n!==0){if(u<=0)throw new Error("Cannot compute offset from zero-length line segment");l=n*a/u,c=n*s/u}var f=r-c,h=o+l,d=new se(f,h);return d};ft.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};ft.prototype.segmentFraction=function(t){var n=this.projectionFactor(t);return n<0?n=0:(n>1||Xt.isNaN(n))&&(n=1),n};ft.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ft.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ft.prototype.distance=function(){if(arguments[0]instanceof ft){var t=arguments[0];return He.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof se){var n=arguments[0];return He.distancePointLine(n,this.p0,this.p1)}};ft.prototype.pointAlong=function(t){var n=new se;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n};ft.prototype.hashCode=function(){var t=Xt.doubleToLongBits(this.p0.x);t^=Xt.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(t)^Math.trunc(t>>32),r=Xt.doubleToLongBits(this.p1.x);r^=Xt.doubleToLongBits(this.p1.y)*31;var o=Math.trunc(r)^Math.trunc(r>>32);return n^o};ft.prototype.interfaces_=function(){return[Oc,Nc]};ft.prototype.getClass=function(){return ft};ft.midPoint=function(t,n){return new se((t.x+n.x)/2,(t.y+n.y)/2)};vre.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ft,vre);var EA=function(){this.tempEnv1=new lt,this.tempEnv2=new lt,this._overlapSeg1=new ft,this._overlapSeg2=new ft};EA.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];t.getLineSegment(n,this._overlapSeg1),r.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};EA.prototype.interfaces_=function(){return[]};EA.prototype.getClass=function(){return EA};var Sl=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._pts=t,this._start=n,this._end=r,this._context=o};Sl.prototype.getLineSegment=function(t,n){n.p0=this._pts[t],n.p1=this._pts[t+1]};Sl.prototype.computeSelect=function(t,n,r,o){var a=this._pts[n],s=this._pts[r];if(o.tempEnv1.init(a,s),r-n===1)return o.select(this,n),null;if(!t.intersects(o.tempEnv1))return null;var u=Math.trunc((n+r)/2);n<u&&this.computeSelect(t,n,u,o),u<r&&this.computeSelect(t,u,r,o)};Sl.prototype.getCoordinates=function(){for(var t=this,n=new Array(this._end-this._start+1).fill(null),r=0,o=this._start;o<=this._end;o++)n[r++]=t._pts[o];return n};Sl.prototype.computeOverlaps=function(t,n){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,n)};Sl.prototype.setId=function(t){this._id=t};Sl.prototype.select=function(t,n){this.computeSelect(t,this._start,this._end,n)};Sl.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],n=this._pts[this._end];this._env=new lt(t,n)}return this._env};Sl.prototype.getEndIndex=function(){return this._end};Sl.prototype.getStartIndex=function(){return this._start};Sl.prototype.getContext=function(){return this._context};Sl.prototype.getId=function(){return this._id};Sl.prototype.computeOverlapsInternal=function(t,n,r,o,a,s){var u=this._pts[t],l=this._pts[n],c=r._pts[o],f=r._pts[a];if(n-t===1&&a-o===1)return s.overlap(this,t,r,o),null;if(s.tempEnv1.init(u,l),s.tempEnv2.init(c,f),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((t+n)/2),d=Math.trunc((o+a)/2);t<h&&(o<d&&this.computeOverlapsInternal(t,h,r,o,d,s),d<a&&this.computeOverlapsInternal(t,h,r,d,a,s)),h<n&&(o<d&&this.computeOverlapsInternal(h,n,r,o,d,s),d<a&&this.computeOverlapsInternal(h,n,r,d,a,s))};Sl.prototype.interfaces_=function(){return[]};Sl.prototype.getClass=function(){return Sl};var Ah=function(){};Ah.prototype.interfaces_=function(){return[]};Ah.prototype.getClass=function(){return Ah};Ah.getChainStartIndices=function(t){var n=0,r=new Fe;r.add(new bh(n));do{var o=Ah.findChainEnd(t,n);r.add(new bh(o)),n=o}while(n<t.length-1);var a=Ah.toIntArray(r);return a};Ah.findChainEnd=function(t,n){for(var r=n;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var o=bi.quadrant(t[r],t[r+1]),a=n+1;a<t.length;){if(!t[a-1].equals2D(t[a])){var s=bi.quadrant(t[a-1],t[a]);if(s!==o)break}a++}return a-1};Ah.getChains=function(){if(arguments.length===1){var t=arguments[0];return Ah.getChains(t,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],o=new Fe,a=Ah.getChainStartIndices(n),s=0;s<a.length-1;s++){var u=new Sl(n,a[s],a[s+1],r);o.add(u)}return o}};Ah.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var a_=function(){};a_.prototype.computeNodes=function(t){};a_.prototype.getNodedSubstrings=function(){};a_.prototype.interfaces_=function(){return[]};a_.prototype.getClass=function(){return a_};var TA=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};TA.prototype.setSegmentIntersector=function(t){this._segInt=t};TA.prototype.interfaces_=function(){return[a_]};TA.prototype.getClass=function(){return TA};var W4=function(e){function t(r){r?e.call(this,r):e.call(this),this._monoChains=new Fe,this._index=new yre,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return jo.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(o){for(var a=this,s=Ah.getChains(o.getCoordinates(),o),u=s.iterator();u.hasNext();){var l=u.next();l.setId(a._idCounter++),a._index.insert(l.getEnvelope(),l),a._monoChains.add(l)}},t.prototype.computeNodes=function(o){var a=this;this._nodedSegStrings=o;for(var s=o.iterator();s.hasNext();)a.add(s.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var o=this,a=new Ate(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var u=s.next(),l=o._index.query(u.getEnvelope()),c=l.iterator();c.hasNext();){var f=c.next();if(f.getId()>u.getId()&&(u.computeOverlaps(f,a),o._nOverlaps++),o._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return Ate},Object.defineProperties(t,n),t}(TA),Ate=function(e){function t(){e.call(this),this._si=null;var n=arguments[0];this._si=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=r.getContext(),l=a.getContext();this._si.processIntersections(u,o,l,s)}else return e.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(EA),qr=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(a),this.setJoinStyle(s),this.setMitreLimit(u)}}},um={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};qr.prototype.getEndCapStyle=function(){return this._endCapStyle};qr.prototype.isSingleSided=function(){return this._isSingleSided};qr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=qr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=qr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==qr.JOIN_ROUND&&(this._quadrantSegments=qr.DEFAULT_QUADRANT_SEGMENTS)};qr.prototype.getJoinStyle=function(){return this._joinStyle};qr.prototype.setJoinStyle=function(t){this._joinStyle=t};qr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};qr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};qr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};qr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};qr.prototype.getMitreLimit=function(){return this._mitreLimit};qr.prototype.setMitreLimit=function(t){this._mitreLimit=t};qr.prototype.setSingleSided=function(t){this._isSingleSided=t};qr.prototype.interfaces_=function(){return[]};qr.prototype.getClass=function(){return qr};qr.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)};um.CAP_ROUND.get=function(){return 1};um.CAP_FLAT.get=function(){return 2};um.CAP_SQUARE.get=function(){return 3};um.JOIN_ROUND.get=function(){return 1};um.JOIN_MITRE.get=function(){return 2};um.JOIN_BEVEL.get=function(){return 3};um.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};um.DEFAULT_MITRE_LIMIT.get=function(){return 5};um.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(qr,um);var Lo=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=He.COUNTERCLOCKWISE,this._inputLine=t||null},GA={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Lo.prototype.isDeletable=function(t,n,r,o){var a=this._inputLine[t],s=this._inputLine[n],u=this._inputLine[r];return!this.isConcave(a,s,u)||!this.isShallow(a,s,u,o)?!1:this.isShallowSampled(a,s,t,r,o)};Lo.prototype.deleteShallowConcavities=function(){for(var t=this,n=1,r=this.findNextNonDeletedIndex(n),o=this.findNextNonDeletedIndex(r),a=!1;o<this._inputLine.length;){var s=!1;t.isDeletable(n,r,o,t._distanceTol)&&(t._isDeleted[r]=Lo.DELETE,s=!0,a=!0),s?n=o:n=r,r=t.findNextNonDeletedIndex(n),o=t.findNextNonDeletedIndex(r)}return a};Lo.prototype.isShallowConcavity=function(t,n,r,o){var a=He.computeOrientation(t,n,r),s=a===this._angleOrientation;if(!s)return!1;var u=He.distancePointLine(n,t,r);return u<o};Lo.prototype.isShallowSampled=function(t,n,r,o,a){var s=this,u=Math.trunc((o-r)/Lo.NUM_PTS_TO_CHECK);u<=0&&(u=1);for(var l=r;l<o;l+=u)if(!s.isShallow(t,n,s._inputLine[l],a))return!1;return!0};Lo.prototype.isConcave=function(t,n,r){var o=He.computeOrientation(t,n,r),a=o===this._angleOrientation;return a};Lo.prototype.simplify=function(t){var n=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=He.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Lo.prototype.findNextNonDeletedIndex=function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===Lo.DELETE;)n++;return n};Lo.prototype.isShallow=function(t,n,r,o){var a=He.distancePointLine(n,t,r);return a<o};Lo.prototype.collapseLine=function(){for(var t=this,n=new FA,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==Lo.DELETE&&n.add(t._inputLine[r]);return n.toCoordinateArray()};Lo.prototype.interfaces_=function(){return[]};Lo.prototype.getClass=function(){return Lo};Lo.simplify=function(t,n){var r=new Lo(t);return r.simplify(n)};GA.INIT.get=function(){return 0};GA.DELETE.get=function(){return 1};GA.KEEP.get=function(){return 1};GA.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Lo,GA);var nc=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Fe},Cre={COORDINATE_ARRAY_TYPE:{configurable:!0}};nc.prototype.getCoordinates=function(){var t=this._ptList.toArray(nc.COORDINATE_ARRAY_TYPE);return t};nc.prototype.setPrecisionModel=function(t){this._precisionModel=t};nc.prototype.addPt=function(t){var n=new se(t);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};nc.prototype.revere=function(){};nc.prototype.addPts=function(t,n){var r=this;if(n)for(var o=0;o<t.length;o++)r.addPt(t[o]);else for(var a=t.length-1;a>=0;a--)r.addPt(t[a])};nc.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=t.distance(n);return r<this._minimimVertexDistance};nc.prototype.toString=function(){var t=new hn,n=t.createLineString(this.getCoordinates());return n.toString()};nc.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new se(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(t.equals(n))return null;this._ptList.add(t)};nc.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};nc.prototype.interfaces_=function(){return[]};nc.prototype.getClass=function(){return nc};Cre.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(nc,Cre);var Cn=function(){},Nv={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Cn.prototype.interfaces_=function(){return[]};Cn.prototype.getClass=function(){return Cn};Cn.toDegrees=function(t){return t*180/Math.PI};Cn.normalize=function(t){for(;t>Math.PI;)t-=Cn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Cn.PI_TIMES_2;return t};Cn.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=r.x-n.x,a=r.y-n.y;return Math.atan2(a,o)}};Cn.isAcute=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l>0};Cn.isObtuse=function(t,n,r){var o=t.x-n.x,a=t.y-n.y,s=r.x-n.x,u=r.y-n.y,l=o*s+a*u;return l<0};Cn.interiorAngle=function(t,n,r){var o=Cn.angle(n,t),a=Cn.angle(n,r);return Math.abs(a-o)};Cn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Cn.PI_TIMES_2;t>=Cn.PI_TIMES_2&&(t=0)}else{for(;t>=Cn.PI_TIMES_2;)t-=Cn.PI_TIMES_2;t<0&&(t=0)}return t};Cn.angleBetween=function(t,n,r){var o=Cn.angle(n,t),a=Cn.angle(n,r);return Cn.diff(o,a)};Cn.diff=function(t,n){var r=null;return t<n?r=n-t:r=t-n,r>Math.PI&&(r=2*Math.PI-r),r};Cn.toRadians=function(t){return t*Math.PI/180};Cn.getTurn=function(t,n){var r=Math.sin(n-t);return r>0?Cn.COUNTERCLOCKWISE:r<0?Cn.CLOCKWISE:Cn.NONE};Cn.angleBetweenOriented=function(t,n,r){var o=Cn.angle(n,t),a=Cn.angle(n,r),s=a-o;return s<=-Math.PI?s+Cn.PI_TIMES_2:s>Math.PI?s-Cn.PI_TIMES_2:s};Nv.PI_TIMES_2.get=function(){return 2*Math.PI};Nv.PI_OVER_2.get=function(){return Math.PI/2};Nv.PI_OVER_4.get=function(){return Math.PI/4};Nv.COUNTERCLOCKWISE.get=function(){return He.COUNTERCLOCKWISE};Nv.CLOCKWISE.get=function(){return He.CLOCKWISE};Nv.NONE.get=function(){return He.COLLINEAR};Object.defineProperties(Cn,Nv);var eo=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ft,this._seg1=new ft,this._offset0=new ft,this._offset1=new ft,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new m_,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===qr.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},UA={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};eo.prototype.addNextSegment=function(t,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=He.computeOrientation(this._s0,this._s1,this._s2),o=r===He.CLOCKWISE&&this._side===Me.LEFT||r===He.COUNTERCLOCKWISE&&this._side===Me.RIGHT;r===0?this.addCollinear(n):o?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};eo.prototype.addLineEndCap=function(t,n){var r=new ft(t,n),o=new ft;this.computeOffsetSegment(r,Me.LEFT,this._distance,o);var a=new ft;this.computeOffsetSegment(r,Me.RIGHT,this._distance,a);var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s);switch(this._bufParams.getEndCapStyle()){case qr.CAP_ROUND:this._segList.addPt(o.p1),this.addFilletArc(n,l+Math.PI/2,l-Math.PI/2,He.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case qr.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(a.p1);break;case qr.CAP_SQUARE:var c=new se;c.x=Math.abs(this._distance)*Math.cos(l),c.y=Math.abs(this._distance)*Math.sin(l);var f=new se(o.p1.x+c.x,o.p1.y+c.y),h=new se(a.p1.x+c.x,a.p1.y+c.y);this._segList.addPt(f),this._segList.addPt(h);break;default:}};eo.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};eo.prototype.addMitreJoin=function(t,n,r,o){var a=!0,s=null;try{s=pf.intersection(n.p0,n.p1,r.p0,r.p1);var u=o<=0?1:s.distance(t)/Math.abs(o);u>this._bufParams.getMitreLimit()&&(a=!1)}catch(l){if(l instanceof Jx)s=new se(0,0),a=!1;else throw l}finally{}a?this._segList.addPt(s):this.addLimitedMitreJoin(n,r,o,this._bufParams.getMitreLimit())};eo.prototype.addFilletCorner=function(t,n,r,o,a){var s=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,s),c=r.x-t.x,f=r.y-t.y,h=Math.atan2(f,c);o===He.CLOCKWISE?l<=h&&(l+=2*Math.PI):l>=h&&(l-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(t,l,h,o,a),this._segList.addPt(r)};eo.prototype.addOutsideTurn=function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*eo.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===qr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===qr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};eo.prototype.createSquare=function(t){this._segList.addPt(new se(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new se(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new se(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new se(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};eo.prototype.addSegments=function(t,n){this._segList.addPts(t,n)};eo.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};eo.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};eo.prototype.initSideSegments=function(t,n,r){this._s1=t,this._s2=n,this._side=r,this._seg1.setCoordinates(t,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};eo.prototype.addLimitedMitreJoin=function(t,n,r,o){var a=this._seg0.p1,s=Cn.angle(a,this._seg0.p0),u=Cn.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),l=u/2,c=Cn.normalize(s+l),f=Cn.normalize(c+Math.PI),h=o*r,d=h*Math.abs(Math.sin(l)),p=r-d,g=a.x+h*Math.cos(f),y=a.y+h*Math.sin(f),v=new se(g,y),w=new ft(a,v),C=w.pointAlongOffset(1,p),E=w.pointAlongOffset(1,-p);this._side===Me.LEFT?(this._segList.addPt(C),this._segList.addPt(E)):(this._segList.addPt(E),this._segList.addPt(C))};eo.prototype.computeOffsetSegment=function(t,n,r,o){var a=n===Me.LEFT?1:-1,s=t.p1.x-t.p0.x,u=t.p1.y-t.p0.y,l=Math.sqrt(s*s+u*u),c=a*r*s/l,f=a*r*u/l;o.p0.x=t.p0.x-f,o.p0.y=t.p0.y+c,o.p1.x=t.p1.x-f,o.p1.y=t.p1.y+c};eo.prototype.addFilletArc=function(t,n,r,o,a){var s=this,u=o===He.CLOCKWISE?-1:1,l=Math.abs(n-r),c=Math.trunc(l/this._filletAngleQuantum+.5);if(c<1)return null;for(var f=0,h=l/c,d=f,p=new se;d<l;){var g=n+u*d;p.x=t.x+a*Math.cos(g),p.y=t.y+a*Math.sin(g),s._segList.addPt(p),d+=h}};eo.prototype.addInsideTurn=function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*eo.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new se((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var o=new se((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};eo.prototype.createCircle=function(t){var n=new se(t.x+this._distance,t.y);this._segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};eo.prototype.addBevelJoin=function(t,n){this._segList.addPt(t.p1),this._segList.addPt(n.p0)};eo.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new nc,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*eo.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};eo.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===qr.JOIN_BEVEL||this._bufParams.getJoinStyle()===qr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,He.CLOCKWISE,this._distance))};eo.prototype.closeRing=function(){this._segList.closeRing()};eo.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};eo.prototype.interfaces_=function(){return[]};eo.prototype.getClass=function(){return eo};UA.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};UA.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};UA.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};UA.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(eo,UA);var Hu=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n};Hu.prototype.getOffsetCurve=function(t,n){if(this._distance=n,n===0)return null;var r=n<0,o=Math.abs(n),a=this.getSegGen(o);t.length<=1?this.computePointCurve(t[0],a):this.computeOffsetCurve(t,r,a);var s=a.getCoordinates();return r&&dn.reverse(s),s};Hu.prototype.computeSingleSidedBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){r.addSegments(t,!0);var a=Lo.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Me.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{r.addSegments(t,!1);var l=Lo.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Me.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment(),r.closeRing()};Hu.prototype.computeRingBufferCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);n===Me.RIGHT&&(o=-o);var a=Lo.simplify(t,o),s=a.length-1;r.initSideSegments(a[s-1],a[0],n);for(var u=1;u<=s;u++){var l=u!==1;r.addNextSegment(a[u],l)}r.closeRing()};Hu.prototype.computeLineBufferCurve=function(t,n){var r=this.simplifyTolerance(this._distance),o=Lo.simplify(t,r),a=o.length-1;n.initSideSegments(o[0],o[1],Me.LEFT);for(var s=2;s<=a;s++)n.addNextSegment(o[s],!0);n.addLastSegment(),n.addLineEndCap(o[a-1],o[a]);var u=Lo.simplify(t,-r),l=u.length-1;n.initSideSegments(u[l],u[l-1],Me.LEFT);for(var c=l-2;c>=0;c--)n.addNextSegment(u[c],!0);n.addLastSegment(),n.addLineEndCap(u[1],u[0]),n.closeRing()};Hu.prototype.computePointCurve=function(t,n){switch(this._bufParams.getEndCapStyle()){case qr.CAP_ROUND:n.createCircle(t);break;case qr.CAP_SQUARE:n.createSquare(t);break;default:}};Hu.prototype.getLineCurve=function(t,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),o=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],o);else if(this._bufParams.isSingleSided()){var a=n<0;this.computeSingleSidedBufferCurve(t,a,o)}else this.computeLineBufferCurve(t,o);var s=o.getCoordinates();return s};Hu.prototype.getBufferParameters=function(){return this._bufParams};Hu.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};Hu.prototype.getRingCurve=function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return Hu.copyCoordinates(t);var o=this.getSegGen(r);return this.computeRingBufferCurve(t,n,o),o.getCoordinates()};Hu.prototype.computeOffsetCurve=function(t,n,r){var o=this.simplifyTolerance(this._distance);if(n){var a=Lo.simplify(t,-o),s=a.length-1;r.initSideSegments(a[s],a[s-1],Me.LEFT),r.addFirstSegment();for(var u=s-2;u>=0;u--)r.addNextSegment(a[u],!0)}else{var l=Lo.simplify(t,o),c=l.length-1;r.initSideSegments(l[0],l[1],Me.LEFT),r.addFirstSegment();for(var f=2;f<=c;f++)r.addNextSegment(l[f],!0)}r.addLastSegment()};Hu.prototype.getSegGen=function(t){return new eo(this._precisionModel,this._bufParams,t)};Hu.prototype.interfaces_=function(){return[]};Hu.prototype.getClass=function(){return Hu};Hu.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),r=0;r<n.length;r++)n[r]=new se(t[r]);return n};var Ev=function(){this._subgraphs=null,this._seg=new ft,this._cga=new He;var t=arguments[0];this._subgraphs=t},xre={DepthSegment:{configurable:!0}};Ev.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=new Fe,o=this._subgraphs.iterator();o.hasNext();){var a=o.next(),s=a.getEnvelope();n.y<s.getMinY()||n.y>s.getMaxY()||t.findStabbedSegments(n,a.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(Lt(arguments[2],mf)&&arguments[0]instanceof se&&arguments[1]instanceof n4)for(var u=arguments[0],l=arguments[1],c=arguments[2],f=l.getEdge().getCoordinates(),h=0;h<f.length-1;h++){t._seg.p0=f[h],t._seg.p1=f[h+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var d=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(d<u.x)&&!t._seg.isHorizontal()&&!(u.y<t._seg.p0.y||u.y>t._seg.p1.y)&&He.computeOrientation(t._seg.p0,t._seg.p1,u)!==He.RIGHT){var p=l.getDepth(Me.LEFT);t._seg.p0.equals(f[h])||(p=l.getDepth(Me.RIGHT));var g=new s_(t._seg,p);c.add(g)}}else if(Lt(arguments[2],mf)&&arguments[0]instanceof se&&Lt(arguments[1],mf))for(var y=arguments[0],v=arguments[1],w=arguments[2],C=v.iterator();C.hasNext();){var E=C.next();!E.isForward()||t.findStabbedSegments(y,E,w)}}};Ev.prototype.getDepth=function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var r=vf.min(n);return r._leftDepth};Ev.prototype.interfaces_=function(){return[]};Ev.prototype.getClass=function(){return Ev};xre.DepthSegment.get=function(){return s_};Object.defineProperties(Ev,xre);var s_=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new ft(t),this._leftDepth=n};s_.prototype.compareTo=function(t){var n=t;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};s_.prototype.compareX=function(t,n){var r=t.p0.compareTo(n.p0);return r!==0?r:t.p1.compareTo(n.p1)};s_.prototype.toString=function(){return this._upwardSeg.toString()};s_.prototype.interfaces_=function(){return[Oc]};s_.prototype.getClass=function(){return s_};var Xr=function(t,n,r){this.p0=t||null,this.p1=n||null,this.p2=r||null};Xr.prototype.area=function(){return Xr.area(this.p0,this.p1,this.p2)};Xr.prototype.signedArea=function(){return Xr.signedArea(this.p0,this.p1,this.p2)};Xr.prototype.interpolateZ=function(t){if(t===null)throw new fo("Supplied point is null.");return Xr.interpolateZ(t,this.p0,this.p1,this.p2)};Xr.prototype.longestSideLength=function(){return Xr.longestSideLength(this.p0,this.p1,this.p2)};Xr.prototype.isAcute=function(){return Xr.isAcute(this.p0,this.p1,this.p2)};Xr.prototype.circumcentre=function(){return Xr.circumcentre(this.p0,this.p1,this.p2)};Xr.prototype.area3D=function(){return Xr.area3D(this.p0,this.p1,this.p2)};Xr.prototype.centroid=function(){return Xr.centroid(this.p0,this.p1,this.p2)};Xr.prototype.inCentre=function(){return Xr.inCentre(this.p0,this.p1,this.p2)};Xr.prototype.interfaces_=function(){return[]};Xr.prototype.getClass=function(){return Xr};Xr.area=function(t,n,r){return Math.abs(((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2)};Xr.signedArea=function(t,n,r){return((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2};Xr.det=function(t,n,r,o){return t*o-n*r};Xr.interpolateZ=function(t,n,r,o){var a=n.x,s=n.y,u=r.x-a,l=o.x-a,c=r.y-s,f=o.y-s,h=u*f-l*c,d=t.x-a,p=t.y-s,g=(f*d-l*p)/h,y=(-c*d+u*p)/h,v=n.z+g*(r.z-n.z)+y*(o.z-n.z);return v};Xr.longestSideLength=function(t,n,r){var o=t.distance(n),a=n.distance(r),s=r.distance(t),u=o;return a>u&&(u=a),s>u&&(u=s),u};Xr.isAcute=function(t,n,r){return!(!Cn.isAcute(t,n,r)||!Cn.isAcute(n,r,t)||!Cn.isAcute(r,t,n))};Xr.circumcentre=function(t,n,r){var o=r.x,a=r.y,s=t.x-o,u=t.y-a,l=n.x-o,c=n.y-a,f=2*Xr.det(s,u,l,c),h=Xr.det(u,s*s+u*u,c,l*l+c*c),d=Xr.det(s,s*s+u*u,l,l*l+c*c),p=o-h/f,g=a+d/f;return new se(p,g)};Xr.perpendicularBisector=function(t,n){var r=n.x-t.x,o=n.y-t.y,a=new pf(t.x+r/2,t.y+o/2,1),s=new pf(t.x-o+r/2,t.y+r+o/2,1);return new pf(a,s)};Xr.angleBisector=function(t,n,r){var o=n.distance(t),a=n.distance(r),s=o/(o+a),u=r.x-t.x,l=r.y-t.y,c=new se(t.x+s*u,t.y+s*l);return c};Xr.area3D=function(t,n,r){var o=n.x-t.x,a=n.y-t.y,s=n.z-t.z,u=r.x-t.x,l=r.y-t.y,c=r.z-t.z,f=a*c-s*l,h=s*u-o*c,d=o*l-a*u,p=f*f+h*h+d*d,g=Math.sqrt(p)/2;return g};Xr.centroid=function(t,n,r){var o=(t.x+n.x+r.x)/3,a=(t.y+n.y+r.y)/3;return new se(o,a)};Xr.inCentre=function(t,n,r){var o=n.distance(r),a=t.distance(r),s=t.distance(n),u=o+a+s,l=(o*t.x+a*n.x+s*r.x)/u,c=(o*t.y+a*n.y+s*r.y)/u;return new se(l,c)};var Rc=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=r};Rc.prototype.addPoint=function(t){if(this._distance<=0)return null;var n=t.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,de.EXTERIOR,de.INTERIOR)};Rc.prototype.addPolygon=function(t){var n=this,r=this._distance,o=Me.LEFT;this._distance<0&&(r=-this._distance,o=Me.RIGHT);var a=t.getExteriorRing(),s=dn.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&s.length<3)return null;this.addPolygonRing(s,r,o,de.EXTERIOR,de.INTERIOR);for(var u=0;u<t.getNumInteriorRing();u++){var l=t.getInteriorRingN(u),c=dn.removeRepeatedPoints(l.getCoordinates());n._distance>0&&n.isErodedCompletely(l,-n._distance)||n.addPolygonRing(c,r,Me.opposite(o),de.INTERIOR,de.EXTERIOR)}};Rc.prototype.isTriangleErodedCompletely=function(t,n){var r=new Xr(t[0],t[1],t[2]),o=r.inCentre(),a=He.distancePointLine(o,r.p0,r.p1);return a<Math.abs(n)};Rc.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=dn.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,de.EXTERIOR,de.INTERIOR)};Rc.prototype.addCurve=function(t,n,r){if(t===null||t.length<2)return null;var o=new jo(t,new ii(0,de.BOUNDARY,n,r));this._curveList.add(o)};Rc.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Rc.prototype.addPolygonRing=function(t,n,r,o,a){if(n===0&&t.length<Od.MINIMUM_VALID_SIZE)return null;var s=o,u=a;t.length>=Od.MINIMUM_VALID_SIZE&&He.isCCW(t)&&(s=a,u=o,r=Me.opposite(r));var l=this._curveBuilder.getRingCurve(t,r,n);this.addCurve(l,s,u)};Rc.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Da?this.addPolygon(t):t instanceof Mo?this.addLineString(t):t instanceof El?this.addPoint(t):t instanceof Nx?this.addCollection(t):t instanceof o_?this.addCollection(t):t instanceof Md?this.addCollection(t):t instanceof Cu&&this.addCollection(t)};Rc.prototype.isErodedCompletely=function(t,n){var r=t.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var o=t.getEnvelopeInternal(),a=Math.min(o.getHeight(),o.getWidth());return n<0&&2*Math.abs(n)>a};Rc.prototype.addCollection=function(t){for(var n=this,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r);n.add(o)}};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};var Vx=function(){};Vx.prototype.locate=function(t){};Vx.prototype.interfaces_=function(){return[]};Vx.prototype.getClass=function(){return Vx};var Ld=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Ld.prototype.next=function(){if(this._atStart)return this._atStart=!1,Ld.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new ew;var t=this._parent.getGeometryN(this._index++);return t instanceof Cu?(this._subcollectionIterator=new Ld(t),this._subcollectionIterator.next()):t};Ld.prototype.remove=function(){throw new Error(this.getClass().getName())};Ld.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};Ld.prototype.interfaces_=function(){return[$x]};Ld.prototype.getClass=function(){return Ld};Ld.isAtomic=function(t){return!(t instanceof Cu)};var Jl=function(){this._geom=null;var t=arguments[0];this._geom=t};Jl.prototype.locate=function(t){return Jl.locate(t,this._geom)};Jl.prototype.interfaces_=function(){return[Vx]};Jl.prototype.getClass=function(){return Jl};Jl.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?He.isPointInRing(t,n.getCoordinates()):!1};Jl.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Jl.isPointInRing(t,r))return!1;for(var o=0;o<n.getNumInteriorRing();o++){var a=n.getInteriorRingN(o);if(Jl.isPointInRing(t,a))return!1}return!0};Jl.containsPoint=function(t,n){if(n instanceof Da)return Jl.containsPointInPolygon(t,n);if(n instanceof Cu)for(var r=new Ld(n);r.hasNext();){var o=r.next();if(o!==n&&Jl.containsPoint(t,o))return!0}return!1};Jl.locate=function(t,n){return n.isEmpty()?de.EXTERIOR:Jl.containsPoint(t,n)?de.INTERIOR:de.EXTERIOR};var Hs=function(){this._edgeMap=new Gs,this._edgeList=null,this._ptInAreaLocation=[de.NONE,de.NONE]};Hs.prototype.getNextCW=function(t){this.getEdges();var n=this._edgeList.indexOf(t),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};Hs.prototype.propagateSideLabels=function(t){for(var n=de.NONE,r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.isArea(t)&&a.getLocation(t,Me.LEFT)!==de.NONE&&(n=a.getLocation(t,Me.LEFT))}if(n===de.NONE)return null;for(var s=n,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();if(c.getLocation(t,Me.ON)===de.NONE&&c.setLocation(t,Me.ON,s),c.isArea(t)){var f=c.getLocation(t,Me.LEFT),h=c.getLocation(t,Me.RIGHT);if(h!==de.NONE){if(h!==s)throw new nm("side location conflict",l.getCoordinate());f===de.NONE&&nn.shouldNeverReachHere("found single null side (at "+l.getCoordinate()+")"),s=f}else nn.isTrue(c.getLocation(t,Me.LEFT)===de.NONE,"found single null side"),c.setLocation(t,Me.RIGHT,s),c.setLocation(t,Me.LEFT,s)}}};Hs.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()};Hs.prototype.print=function(t){xs.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Hs.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Hs.prototype.checkAreaLabelsConsistent=function(t){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,o=n.get(r).getLabel(),a=o.getLocation(t,Me.LEFT);nn.isTrue(a!==de.NONE,"Found unlabelled area edge");for(var s=a,u=this.iterator();u.hasNext();){var l=u.next(),c=l.getLabel();nn.isTrue(c.isArea(t),"Found non-area edge");var f=c.getLocation(t,Me.LEFT),h=c.getLocation(t,Me.RIGHT);if(f===h||h!==s)return!1;s=f}return!0};Hs.prototype.findIndex=function(t){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var o=n._edgeList.get(r);if(o===t)return r}return-1};Hs.prototype.iterator=function(){return this.getEdges().iterator()};Hs.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Fe(this._edgeMap.values())),this._edgeList};Hs.prototype.getLocation=function(t,n,r){return this._ptInAreaLocation[t]===de.NONE&&(this._ptInAreaLocation[t]=Jl.locate(n,r[t].getGeometry())),this._ptInAreaLocation[t]};Hs.prototype.toString=function(){var t=new zh;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();t.append(r),t.append(`
`)}return t.toString()};Hs.prototype.computeEdgeEndLabels=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(t)}};Hs.prototype.computeLabelling=function(t){var n=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),u=0;u<2;u++)s.isLine(u)&&s.getLocation(u)===de.BOUNDARY&&(r[u]=!0);for(var l=this.iterator();l.hasNext();)for(var c=l.next(),f=c.getLabel(),h=0;h<2;h++)if(f.isAnyNull(h)){var d=de.NONE;if(r[h])d=de.EXTERIOR;else{var p=c.getCoordinate();d=n.getLocation(h,p,t)}f.setAllLocationsIfNull(h,d)}};Hs.prototype.getDegree=function(){return this._edgeMap.size()};Hs.prototype.insertEdgeEnd=function(t,n){this._edgeMap.put(t,n),this._edgeList=null};Hs.prototype.interfaces_=function(){return[]};Hs.prototype.getClass=function(){return Hs};var bFe=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var o=null,a=null,s=this._SCANNING_FOR_INCOMING,u=0;u<this._resultAreaEdgeList.size();u++){var l=r._resultAreaEdgeList.get(u),c=l.getSym();if(!!l.getLabel().isArea())switch(o===null&&l.isInResult()&&(o=l),s){case r._SCANNING_FOR_INCOMING:if(!c.isInResult())continue;a=c,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!l.isInResult())continue;a.setNext(l),s=r._SCANNING_FOR_INCOMING;break;default:}}if(s===this._LINKING_TO_OUTGOING){if(o===null)throw new nm("no outgoing dirEdge found",this.getCoordinate());nn.isTrue(o.isInResult(),"unable to link last incoming dirEdge"),a.setNext(o)}},t.prototype.insert=function(r){var o=r;this.insertEdgeEnd(o,o)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),o=r.size();if(o<1)return null;var a=r.get(0);if(o===1)return a;var s=r.get(o-1),u=a.getQuadrant(),l=s.getQuadrant();return bi.isNorthern(u)&&bi.isNorthern(l)?a:!bi.isNorthern(u)&&!bi.isNorthern(l)?s:a.getDy()!==0?a:s.getDy()!==0?s:(nn.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){xs.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var a=o.next();r.print("out "),a.print(r),r.println(),r.print("in "),a.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Fe;for(var o=this.iterator();o.hasNext();){var a=o.next();(a.isInResult()||a.getSym().isInResult())&&r._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.setAllLocationsIfNull(0,r.getLocation(0)),s.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var o=null,a=null,s=this._edgeList.size()-1;s>=0;s--){var u=r._edgeList.get(s),l=u.getSym();a===null&&(a=l),o!==null&&l.setNext(o),o=u}a.setNext(o)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var o=arguments[0],a=this.findIndex(o),s=o.getDepth(Me.LEFT),u=o.getDepth(Me.RIGHT),l=this.computeDepths(a+1,this._edgeList.size(),s),c=this.computeDepths(0,a,l);if(c!==u)throw new nm("depth mismatch at "+o.getCoordinate())}else if(arguments.length===3){for(var f=arguments[0],h=arguments[1],d=arguments[2],p=d,g=f;g<h;g++){var y=r._edgeList.get(g);y.setEdgeDepths(Me.RIGHT,p),p=y.getDepth(Me.LEFT)}return p}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();a.merge(o.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var o=this,a=null,s=null,u=this._SCANNING_FOR_INCOMING,l=this._resultAreaEdgeList.size()-1;l>=0;l--){var c=o._resultAreaEdgeList.get(l),f=c.getSym();switch(a===null&&c.getEdgeRing()===r&&(a=c),u){case o._SCANNING_FOR_INCOMING:if(f.getEdgeRing()!==r)continue;s=f,u=o._LINKING_TO_OUTGOING;break;case o._LINKING_TO_OUTGOING:if(c.getEdgeRing()!==r)continue;s.setNextMin(c),u=o._SCANNING_FOR_INCOMING;break;default:}}u===this._LINKING_TO_OUTGOING&&(nn.isTrue(a!==null,"found null for first outgoing dirEdge"),nn.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),s.setNextMin(a))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,o=this.iterator();o.hasNext();){var a=o.next();a.isInResult()&&r++}return r}else if(arguments.length===1){for(var s=arguments[0],u=0,l=this.iterator();l.hasNext();){var c=l.next();c.getEdgeRing()===s&&u++}return u}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=de.NONE,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){r=de.INTERIOR;break}if(s.isInResult()){r=de.EXTERIOR;break}}}if(r===de.NONE)return null;for(var u=r,l=this.iterator();l.hasNext();){var c=l.next(),f=c.getSym();c.isLineEdge()?c.getEdge().setCovered(u===de.INTERIOR):(c.isInResult()&&(u=de.EXTERIOR),f.isInResult()&&(u=de.INTERIOR))}},t.prototype.computeLabelling=function(r){var o=this;e.prototype.computeLabelling.call(this,r),this._label=new ii(de.NONE);for(var a=this.iterator();a.hasNext();)for(var s=a.next(),u=s.getEdge(),l=u.getLabel(),c=0;c<2;c++){var f=l.getLocation(c);(f===de.INTERIOR||f===de.BOUNDARY)&&o._label.setLocation(c,de.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Hs),wre=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new yR(r,new bFe)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Bx),bg=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};bg.prototype.compareTo=function(t){var n=t,r=bg.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};bg.prototype.interfaces_=function(){return[Oc]};bg.prototype.getClass=function(){return bg};bg.orientation=function(t){return dn.increasingDirection(t)===1};bg.compareOriented=function(t,n,r,o){for(var a=n?1:-1,s=o?1:-1,u=n?t.length:-1,l=o?r.length:-1,c=n?0:t.length-1,f=o?0:r.length-1;;){var h=t[c].compareTo(r[f]);if(h!==0)return h;c+=a,f+=s;var d=c===u,p=f===l;if(d&&!p)return-1;if(!d&&p)return 1;if(d&&p)return 0}};var Cf=function(){this._edges=new Fe,this._ocaMap=new Gs};Cf.prototype.print=function(t){var n=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var o=n._edges.get(r);r>0&&t.print(","),t.print("(");for(var a=o.getCoordinates(),s=0;s<a.length;s++)s>0&&t.print(","),t.print(a[s].x+" "+a[s].y);t.println(")")}t.print(")  ")};Cf.prototype.addAll=function(t){for(var n=this,r=t.iterator();r.hasNext();)n.add(r.next())};Cf.prototype.findEdgeIndex=function(t){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(t))return r;return-1};Cf.prototype.iterator=function(){return this._edges.iterator()};Cf.prototype.getEdges=function(){return this._edges};Cf.prototype.get=function(t){return this._edges.get(t)};Cf.prototype.findEqualEdge=function(t){var n=new bg(t.getCoordinates()),r=this._ocaMap.get(n);return r};Cf.prototype.add=function(t){this._edges.add(t);var n=new bg(t.getCoordinates());this._ocaMap.put(n,t)};Cf.prototype.interfaces_=function(){return[]};Cf.prototype.getClass=function(){return Cf};var u_=function(){};u_.prototype.processIntersections=function(t,n,r,o){};u_.prototype.isDone=function(){};u_.prototype.interfaces_=function(){return[]};u_.prototype.getClass=function(){return u_};var rc=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};rc.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(rc.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.size()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};rc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};rc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};rc.prototype.getLineIntersector=function(){return this._li};rc.prototype.hasProperIntersection=function(){return this._hasProper};rc.prototype.processIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};rc.prototype.hasIntersection=function(){return this._hasIntersection};rc.prototype.isDone=function(){return!1};rc.prototype.hasInteriorIntersection=function(){return this._hasInterior};rc.prototype.interfaces_=function(){return[u_]};rc.prototype.getClass=function(){return rc};rc.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var Rh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],r=arguments[2];this.coord=new se(t),this.segmentIndex=n,this.dist=r};Rh.prototype.getSegmentIndex=function(){return this.segmentIndex};Rh.prototype.getCoordinate=function(){return this.coord};Rh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};Rh.prototype.compareTo=function(t){var n=t;return this.compare(n.segmentIndex,n.dist)};Rh.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};Rh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Rh.prototype.getDistance=function(){return this.dist};Rh.prototype.compare=function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0};Rh.prototype.interfaces_=function(){return[Oc]};Rh.prototype.getClass=function(){return Rh};var Fd=function(){this._nodeMap=new Gs,this.edge=null;var t=arguments[0];this.edge=t};Fd.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Fd.prototype.iterator=function(){return this._nodeMap.values().iterator()};Fd.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints();for(var r=this.iterator(),o=r.next();r.hasNext();){var a=r.next(),s=n.createSplitEdge(o,a);t.add(s),o=a}};Fd.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};Fd.prototype.createSplitEdge=function(t,n){var r=this,o=n.segmentIndex-t.segmentIndex+2,a=this.edge.pts[n.segmentIndex],s=n.dist>0||!n.coord.equals2D(a);s||o--;var u=new Array(o).fill(null),l=0;u[l++]=new se(t.coord);for(var c=t.segmentIndex+1;c<=n.segmentIndex;c++)u[l++]=r.edge.pts[c];return s&&(u[l]=n.coord),new GL(u,new ii(this.edge._label))};Fd.prototype.add=function(t,n,r){var o=new Rh(t,n,r),a=this._nodeMap.get(o);return a!==null?a:(this._nodeMap.put(o,o),o)};Fd.prototype.isIntersection=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(t))return!0}return!1};Fd.prototype.interfaces_=function(){return[]};Fd.prototype.getClass=function(){return Fd};var l_=function(){};l_.prototype.getChainStartIndices=function(t){var n=this,r=0,o=new Fe;o.add(new bh(r));do{var a=n.findChainEnd(t,r);o.add(new bh(a)),r=a}while(r<t.length-1);var s=l_.toIntArray(o);return s};l_.prototype.findChainEnd=function(t,n){for(var r=bi.quadrant(t[n],t[n+1]),o=n+1;o<t.length;){var a=bi.quadrant(t[o-1],t[o]);if(a!==r)break;o++}return o-1};l_.prototype.interfaces_=function(){return[]};l_.prototype.getClass=function(){return l_};l_.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var im=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new lt,this.env2=new lt;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new l_;this.startIndex=n.getChainStartIndices(this.pts)};im.prototype.getCoordinates=function(){return this.pts};im.prototype.getMaxX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n>r?n:r};im.prototype.getMinX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n<r?n:r};im.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[r],n.startIndex[r+1],o)}else if(arguments.length===6){var a=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],c=arguments[4],f=arguments[5],h=this.pts[a],d=this.pts[s],p=u.pts[l],g=u.pts[c];if(s-a===1&&c-l===1)return f.addIntersections(this.e,a,u.e,l),null;if(this.env1.init(h,d),this.env2.init(p,g),!this.env1.intersects(this.env2))return null;var y=Math.trunc((a+s)/2),v=Math.trunc((l+c)/2);a<y&&(l<v&&this.computeIntersectsForChain(a,y,u,l,v,f),v<c&&this.computeIntersectsForChain(a,y,u,v,c,f)),y<s&&(l<v&&this.computeIntersectsForChain(y,s,u,l,v,f),v<c&&this.computeIntersectsForChain(y,s,u,v,c,f))}};im.prototype.getStartIndexes=function(){return this.startIndex};im.prototype.computeIntersects=function(t,n){for(var r=this,o=0;o<this.startIndex.length-1;o++)for(var a=0;a<t.startIndex.length-1;a++)r.computeIntersectsForChain(o,t,a,n)};im.prototype.interfaces_=function(){return[]};im.prototype.getClass=function(){return im};var Cs=function e(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)t._depth[n][r]=e.NULL_VALUE},Ere={NULL_VALUE:{configurable:!0}};Cs.prototype.getDepth=function(t,n){return this._depth[t][n]};Cs.prototype.setDepth=function(t,n,r){this._depth[t][n]=r};Cs.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(t._depth[n][r]!==Cs.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var o=arguments[0];return this._depth[o][1]===Cs.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._depth[a][s]===Cs.NULL_VALUE}};Cs.prototype.normalize=function(){for(var t=this,n=0;n<2;n++)if(!t.isNull(n)){var r=t._depth[n][1];t._depth[n][2]<r&&(r=t._depth[n][2]),r<0&&(r=0);for(var o=1;o<3;o++){var a=0;t._depth[n][o]>r&&(a=1),t._depth[n][o]=a}}};Cs.prototype.getDelta=function(t){return this._depth[t][Me.RIGHT]-this._depth[t][Me.LEFT]};Cs.prototype.getLocation=function(t,n){return this._depth[t][n]<=0?de.EXTERIOR:de.INTERIOR};Cs.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};Cs.prototype.add=function(){var t=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var o=1;o<3;o++){var a=n.getLocation(r,o);(a===de.EXTERIOR||a===de.INTERIOR)&&(t.isNull(r,o)?t._depth[r][o]=Cs.depthAtLocation(a):t._depth[r][o]+=Cs.depthAtLocation(a))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];l===de.INTERIOR&&this._depth[s][u]++}};Cs.prototype.interfaces_=function(){return[]};Cs.prototype.getClass=function(){return Cs};Cs.depthAtLocation=function(t){return t===de.EXTERIOR?0:t===de.INTERIOR?1:Cs.NULL_VALUE};Ere.NULL_VALUE.get=function(){return-1};Object.defineProperties(Cs,Ere);var GL=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new Fd(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Cs,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],o=arguments[1];this.pts=r,this._label=o}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var o=new t(r,ii.toLineLabel(this._label));return o},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var o=this;if(!(r instanceof t))return!1;var a=r;if(this.pts.length!==a.pts.length)return!1;for(var s=!0,u=!0,l=this.pts.length,c=0;c<this.pts.length;c++)if(o.pts[c].equals2D(a.pts[c])||(s=!1),o.pts[c].equals2D(a.pts[--l])||(u=!1),!s&&!u)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var o=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(o.pts[a].x+" "+o.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var o=this;r.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)r.print(o.pts[a]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new im(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new lt;for(var o=0;o<this.pts.length;o++)r._env.expandToInclude(r.pts[o])}return this._env},t.prototype.addIntersection=function(r,o,a,s){var u=new se(r.getIntersection(s)),l=o,c=r.getEdgeDistance(a,s),f=l+1;if(f<this.pts.length){var h=this.pts[f];u.equals2D(h)&&(l=f,c=0)}this.eiList.add(u,l,c)},t.prototype.toString=function(){var r=this,o=new zh;o.append("edge "+this._name+": "),o.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&o.append(","),o.append(r.pts[a].x+" "+r.pts[a].y);return o.append(")  "+this._label+" "+this._depthDelta),o.toString()},t.prototype.isPointwiseEqual=function(r){var o=this;if(this.pts.length!==r.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!o.pts[a].equals2D(r.pts[a]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,o,a){for(var s=this,u=0;u<r.getIntersectionNum();u++)s.addIntersection(r,o,a,u)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];o.setAtLeastIfValid(r.getLocation(0,Me.ON),r.getLocation(1,Me.ON),1),r.isArea()&&(o.setAtLeastIfValid(r.getLocation(0,Me.LEFT),r.getLocation(1,Me.LEFT),2),o.setAtLeastIfValid(r.getLocation(0,Me.RIGHT),r.getLocation(1,Me.RIGHT),2))}else return e.prototype.updateIM.apply(this,arguments)},t}(tc),yu=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Cf,this._bufParams=t||null};yu.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};yu.prototype.insertUniqueEdge=function(t){var n=this._edgeList.findEqualEdge(t);if(n!==null){var r=n.getLabel(),o=t.getLabel();n.isPointwiseEqual(t)||(o=new ii(t.getLabel()),o.flip()),r.merge(o);var a=yu.depthDelta(o),s=n.getDepthDelta(),u=s+a;n.setDepthDelta(u)}else this._edgeList.add(t),t.setDepthDelta(yu.depthDelta(t.getLabel()))};yu.prototype.buildSubgraphs=function(t,n){for(var r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=a.getRightmostCoordinate(),u=new Ev(r),l=u.getDepth(s);a.computeDepth(l),a.findResultEdges(),r.add(a),n.add(a.getDirectedEdges(),a.getNodes())}};yu.prototype.createSubgraphs=function(t){for(var n=new Fe,r=t.getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isVisited()){var a=new xu;a.create(o),n.add(a)}}return vf.sort(n,vf.reverseOrder()),n};yu.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};yu.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var n=new W4,r=new m_;return r.setPrecisionModel(t),n.setSegmentIntersector(new rc(r)),n};yu.prototype.buffer=function(t,n){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var o=new Hu(r,this._bufParams),a=new Rc(t,n,o),s=a.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,r),this._graph=new Eo(new wre),this._graph.addEdges(this._edgeList.getEdges());var u=this.createSubgraphs(this._graph),l=new Tl(this._geomFact);this.buildSubgraphs(u,l);var c=l.getPolygons();if(c.size()<=0)return this.createEmptyResultGeometry();var f=this._geomFact.buildGeometry(c);return f};yu.prototype.computeNodedEdges=function(t,n){var r=this,o=this.getNoder(n);o.computeNodes(t);for(var a=o.getNodedSubstrings(),s=a.iterator();s.hasNext();){var u=s.next(),l=u.getCoordinates();if(!(l.length===2&&l[0].equals2D(l[1]))){var c=u.getData(),f=new GL(u.getCoordinates(),new ii(c));r.insertUniqueEdge(f)}}};yu.prototype.setNoder=function(t){this._workingNoder=t};yu.prototype.interfaces_=function(){return[]};yu.prototype.getClass=function(){return yu};yu.depthDelta=function(t){var n=t.getLocation(0,Me.LEFT),r=t.getLocation(0,Me.RIGHT);return n===de.INTERIOR&&r===de.EXTERIOR?1:n===de.EXTERIOR&&r===de.INTERIOR?-1:0};yu.convertSegStrings=function(t){for(var n=new hn,r=new Fe;t.hasNext();){var o=t.next(),a=n.createLineString(o.getCoordinates());r.add(a)}return n.buildGeometry(r)};var Ig=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._noder=r,this._scaleFactor=o,this._offsetX=a,this._offsetY=s,this._isScaled=!this.isIntegerPrecision()}};Ig.prototype.rescale=function(){var t=this;if(Lt(arguments[0],Sa))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.rescale(o.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],s=0;s<a.length;s++)a[s].x=a[s].x/t._scaleFactor+t._offsetX,a[s].y=a[s].y/t._scaleFactor+t._offsetY;a.length===2&&a[0].equals2D(a[1])&&xs.out.println(a)}};Ig.prototype.scale=function(){var t=this;if(Lt(arguments[0],Sa)){for(var n=arguments[0],r=new Fe,o=n.iterator();o.hasNext();){var a=o.next();r.add(new jo(t.scale(a.getCoordinates()),a.getData()))}return r}else if(arguments[0]instanceof Array){for(var s=arguments[0],u=new Array(s.length).fill(null),l=0;l<s.length;l++)u[l]=new se(Math.round((s[l].x-t._offsetX)*t._scaleFactor),Math.round((s[l].y-t._offsetY)*t._scaleFactor),s[l].z);var c=dn.removeRepeatedPoints(u);return c}};Ig.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Ig.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Ig.prototype.computeNodes=function(t){var n=t;this._isScaled&&(n=this.scale(t)),this._noder.computeNodes(n)};Ig.prototype.interfaces_=function(){return[a_]};Ig.prototype.getClass=function(){return Ig};var Oh=function(){this._li=new m_,this._segStrings=null;var t=arguments[0];this._segStrings=t},Tre={fact:{configurable:!0}};Oh.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();t.checkEndPtVertexIntersections(o[0],t._segStrings),t.checkEndPtVertexIntersections(o[o.length-1],t._segStrings)}else if(arguments.length===2){for(var a=arguments[0],s=arguments[1],u=s.iterator();u.hasNext();)for(var l=u.next(),c=l.getCoordinates(),f=1;f<c.length-1;f++)if(c[f].equals(a))throw new em("found endpt/interior pt intersection at index "+f+" :pt "+a)}};Oh.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),o=this._segStrings.iterator();o.hasNext();){var a=o.next();t.checkInteriorIntersections(r,a)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],l=s.getCoordinates(),c=u.getCoordinates(),f=0;f<l.length-1;f++)for(var h=0;h<c.length-1;h++)t.checkInteriorIntersections(s,f,u,h);else if(arguments.length===4){var d=arguments[0],p=arguments[1],g=arguments[2],y=arguments[3];if(d===g&&p===y)return null;var v=d.getCoordinates()[p],w=d.getCoordinates()[p+1],C=g.getCoordinates()[y],E=g.getCoordinates()[y+1];if(this._li.computeIntersection(v,w,C,E),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,v,w)||this.hasInteriorIntersection(this._li,C,E)))throw new em("found non-noded intersection at "+v+"-"+w+" and "+C+"-"+E)}};Oh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};Oh.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkCollapses(r)}else if(arguments.length===1)for(var o=arguments[0],a=o.getCoordinates(),s=0;s<a.length-2;s++)t.checkCollapse(a[s],a[s+1],a[s+2])};Oh.prototype.hasInteriorIntersection=function(t,n,r){for(var o=0;o<t.getIntersectionNum();o++){var a=t.getIntersection(o);if(!(a.equals(n)||a.equals(r)))return!0}return!1};Oh.prototype.checkCollapse=function(t,n,r){if(t.equals(r))throw new em("found non-noded collapse at "+Oh.fact.createLineString([t,n,r]))};Oh.prototype.interfaces_=function(){return[]};Oh.prototype.getClass=function(){return Oh};Tre.fact.get=function(){return new hn};Object.defineProperties(Oh,Tre);var qu=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=r,n<=0)throw new fo("Scale factor must be non-zero");n!==1&&(this._pt=new se(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new se,this._p1Scaled=new se),this.initCorners(this._pt)},Sre={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};qu.prototype.intersectsScaled=function(t,n){var r=Math.min(t.x,n.x),o=Math.max(t.x,n.x),a=Math.min(t.y,n.y),s=Math.max(t.y,n.y),u=this._maxx<r||this._minx>o||this._maxy<a||this._miny>s;if(u)return!1;var l=this.intersectsToleranceSquare(t,n);return nn.isTrue(!(u&&l),"Found bad envelope test"),l};qu.prototype.initCorners=function(t){var n=.5;this._minx=t.x-n,this._maxx=t.x+n,this._miny=t.y-n,this._maxy=t.y+n,this._corner[0]=new se(this._maxx,this._maxy),this._corner[1]=new se(this._minx,this._maxy),this._corner[2]=new se(this._minx,this._miny),this._corner[3]=new se(this._maxx,this._miny)};qu.prototype.intersects=function(t,n){return this._scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};qu.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};qu.prototype.getCoordinate=function(){return this._originalPt};qu.prototype.copyScaled=function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)};qu.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=qu.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new lt(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};qu.prototype.intersectsPixelClosure=function(t,n){return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};qu.prototype.intersectsToleranceSquare=function(t,n){var r=!1,o=!1;return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&o||t.equals(this._pt)||n.equals(this._pt))};qu.prototype.addSnappedNode=function(t,n){var r=t.getCoordinate(n),o=t.getCoordinate(n+1);return this.intersects(r,o)?(t.addIntersection(this.getCoordinate(),n),!0):!1};qu.prototype.interfaces_=function(){return[]};qu.prototype.getClass=function(){return qu};Sre.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(qu,Sre);var SA=function(){this.tempEnv1=new lt,this.selectedSegment=new ft};SA.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};SA.prototype.interfaces_=function(){return[]};SA.prototype.getClass=function(){return SA};var kx=function(){this._index=null;var t=arguments[0];this._index=t},Are={HotPixelSnapAction:{configurable:!0}};kx.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2],a=n.getSafeEnvelope(),s=new bre(n,r,o);return this._index.query(a,{interfaces_:function(){return[Sg]},visitItem:function(u){var l=u;l.select(a,s)}}),s.isNodeAdded()}};kx.prototype.interfaces_=function(){return[]};kx.prototype.getClass=function(){return kx};Are.HotPixelSnapAction.get=function(){return bre};Object.defineProperties(kx,Are);var bre=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],o=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1],a=r.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&o===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,o)}else return e.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(SA),Tv=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Fe};Tv.prototype.processIntersections=function(t,n,r,o){var a=this;if(t===r&&n===o)return null;var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];if(this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var f=0;f<this._li.getIntersectionNum();f++)a._interiorIntersections.add(a._li.getIntersection(f));t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)}};Tv.prototype.isDone=function(){return!1};Tv.prototype.getInteriorIntersections=function(){return this._interiorIntersections};Tv.prototype.interfaces_=function(){return[u_]};Tv.prototype.getClass=function(){return Tv};var zd=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new m_,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};zd.prototype.checkCorrectness=function(t){var n=jo.getNodedSubstrings(t),r=new Oh(n);try{r.checkValid()}catch(o){if(o instanceof fre)o.printStackTrace();else throw o}finally{}};zd.prototype.getNodedSubstrings=function(){return jo.getNodedSubstrings(this._nodedSegStrings)};zd.prototype.snapRound=function(t,n){var r=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};zd.prototype.findInteriorIntersections=function(t,n){var r=new Tv(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};zd.prototype.computeVertexSnaps=function(){var t=this;if(Lt(arguments[0],Sa))for(var n=arguments[0],r=n.iterator();r.hasNext();){var o=r.next();t.computeVertexSnaps(o)}else if(arguments[0]instanceof jo)for(var a=arguments[0],s=a.getCoordinates(),u=0;u<s.length;u++){var l=new qu(s[u],t._scaleFactor,t._li),c=t._pointSnapper.snap(l,a,u);c&&a.addIntersection(s[u],u)}};zd.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new W4,this._pointSnapper=new kx(this._noder.getIndex()),this.snapRound(t,this._li)};zd.prototype.computeIntersectionSnaps=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=new qu(o,n._scaleFactor,n._li);n._pointSnapper.snap(a)}};zd.prototype.interfaces_=function(){return[a_]};zd.prototype.getClass=function(){return zd};var vs=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new qr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},nw={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};vs.prototype.bufferFixedPrecision=function(t){var n=new Ig(new zd(new Yr(1)),t.getScale()),r=new yu(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};vs.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var n=vs.MAX_PRECISION_DIGITS;n>=0;n--){try{t.bufferReducedPrecision(n)}catch(s){if(s instanceof nm)t._saveException=s;else throw s}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],o=vs.precisionScaleFactor(this._argGeom,this._distance,r),a=new Yr(o);this.bufferFixedPrecision(a)}};vs.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Yr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};vs.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};vs.prototype.bufferOriginalPrecision=function(){try{var t=new yu(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof em)this._saveException=n;else throw n}finally{}};vs.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};vs.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};vs.prototype.interfaces_=function(){return[]};vs.prototype.getClass=function(){return vs};vs.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new vs(t),o=r.getResultGeometry(n);return o}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Dt&&typeof arguments[1]=="number"){var a=arguments[0],s=arguments[1],u=arguments[2],l=new vs(a);l.setQuadrantSegments(u);var c=l.getResultGeometry(s);return c}else if(arguments[2]instanceof qr&&arguments[0]instanceof Dt&&typeof arguments[1]=="number"){var f=arguments[0],h=arguments[1],d=arguments[2],p=new vs(f,d),g=p.getResultGeometry(h);return g}}else if(arguments.length===4){var y=arguments[0],v=arguments[1],w=arguments[2],C=arguments[3],E=new vs(y);E.setQuadrantSegments(w),E.setEndCapStyle(C);var S=E.getResultGeometry(v);return S}};vs.precisionScaleFactor=function(t,n,r){var o=t.getEnvelopeInternal(),a=ec.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY())),s=n>0?n:0,u=a+2*s,l=Math.trunc(Math.log(u)/Math.log(10)+1),c=r-l,f=Math.pow(10,c);return f};nw.CAP_ROUND.get=function(){return qr.CAP_ROUND};nw.CAP_BUTT.get=function(){return qr.CAP_FLAT};nw.CAP_FLAT.get=function(){return qr.CAP_FLAT};nw.CAP_SQUARE.get=function(){return qr.CAP_SQUARE};nw.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(vs,nw);var mu=function(){this._pt=[new se,new se],this._distance=Xt.NaN,this._isNull=!0};mu.prototype.getCoordinates=function(){return this._pt};mu.prototype.getCoordinate=function(t){return this._pt[t]};mu.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};mu.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};mu.prototype.getDistance=function(){return this._distance};mu.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};mu.prototype.interfaces_=function(){return[]};mu.prototype.getClass=function(){return mu};var Pd=function(){};Pd.prototype.interfaces_=function(){return[]};Pd.prototype.getClass=function(){return Pd};Pd.computeDistance=function(){if(arguments[2]instanceof mu&&arguments[0]instanceof Mo&&arguments[1]instanceof se)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=t.getCoordinates(),a=new ft,s=0;s<o.length-1;s++){a.setCoordinates(o[s],o[s+1]);var u=a.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof mu&&arguments[0]instanceof Da&&arguments[1]instanceof se){var l=arguments[0],c=arguments[1],f=arguments[2];Pd.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)Pd.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof mu&&arguments[0]instanceof Dt&&arguments[1]instanceof se){var d=arguments[0],p=arguments[1],g=arguments[2];if(d instanceof Mo)Pd.computeDistance(d,p,g);else if(d instanceof Da)Pd.computeDistance(d,p,g);else if(d instanceof Cu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);Pd.computeDistance(w,p,g)}else g.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof mu&&arguments[0]instanceof ft&&arguments[1]instanceof se){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var c_=function(t){this._maxPtDist=new mu,this._inputGeom=t||null},Y4={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};c_.prototype.computeMaxMidpointDistance=function(t){var n=new Dg(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};c_.prototype.computeMaxVertexDistance=function(t){var n=new Sv(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};c_.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};c_.prototype.getDistancePoints=function(){return this._maxPtDist};c_.prototype.interfaces_=function(){return[]};c_.prototype.getClass=function(){return c_};Y4.MaxPointDistanceFilter.get=function(){return Sv};Y4.MaxMidpointDistanceFilter.get=function(){return Dg};Object.defineProperties(c_,Y4);var Sv=function(t){this._maxPtDist=new mu,this._minPtDist=new mu,this._geom=t||null};Sv.prototype.filter=function(t){this._minPtDist.initialize(),Pd.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Sv.prototype.getMaxPointDistance=function(){return this._maxPtDist};Sv.prototype.interfaces_=function(){return[Rd]};Sv.prototype.getClass=function(){return Sv};var Dg=function(t){this._maxPtDist=new mu,this._minPtDist=new mu,this._geom=t||null};Dg.prototype.filter=function(t,n){if(n===0)return null;var r=t.getCoordinate(n-1),o=t.getCoordinate(n),a=new se((r.x+o.x)/2,(r.y+o.y)/2);this._minPtDist.initialize(),Pd.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Dg.prototype.isDone=function(){return!1};Dg.prototype.isGeometryChanged=function(){return!1};Dg.prototype.getMaxPointDistance=function(){return this._maxPtDist};Dg.prototype.interfaces_=function(){return[_f]};Dg.prototype.getClass=function(){return Dg};var Zp=function(t){this._comps=t||null};Zp.prototype.filter=function(t){t instanceof Da&&this._comps.add(t)};Zp.prototype.interfaces_=function(){return[Dh]};Zp.prototype.getClass=function(){return Zp};Zp.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Zp.getPolygons(t,new Fe)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Da?r.add(n):n instanceof Cu&&n.apply(new Zp(r)),r}};var _s=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};_s.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Od){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(n),null}t instanceof Mo&&this._lines.add(t)};_s.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};_s.prototype.interfaces_=function(){return[tm]};_s.prototype.getClass=function(){return _s};_s.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(_s.getLines(t))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(_s.getLines(n,r))}};_s.getLines=function(){if(arguments.length===1){var t=arguments[0];return _s.getLines(t,!1)}else if(arguments.length===2){if(Lt(arguments[0],Sa)&&Lt(arguments[1],Sa)){for(var n=arguments[0],r=arguments[1],o=n.iterator();o.hasNext();){var a=o.next();_s.getLines(a,r)}return r}else if(arguments[0]instanceof Dt&&typeof arguments[1]=="boolean"){var s=arguments[0],u=arguments[1],l=new Fe;return s.apply(new _s(l,u)),l}else if(arguments[0]instanceof Dt&&Lt(arguments[1],Sa)){var c=arguments[0],f=arguments[1];return c instanceof Mo?f.add(c):c.apply(new _s(f)),f}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Lt(arguments[0],Sa)&&Lt(arguments[1],Sa)){for(var h=arguments[0],d=arguments[1],p=arguments[2],g=h.iterator();g.hasNext();){var y=g.next();_s.getLines(y,d,p)}return d}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Dt&&Lt(arguments[1],Sa)){var v=arguments[0],w=arguments[1],C=arguments[2];return v.apply(new _s(w,C)),w}}};var xf=function(){if(this._boundaryRule=Mc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new fo("Rule must be non-null");this._boundaryRule=t}}};xf.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof se&&arguments[1]instanceof Da){var n=arguments[0],r=arguments[1];if(r.isEmpty())return de.EXTERIOR;var o=r.getExteriorRing(),a=this.locateInPolygonRing(n,o);if(a===de.EXTERIOR)return de.EXTERIOR;if(a===de.BOUNDARY)return de.BOUNDARY;for(var s=0;s<r.getNumInteriorRing();s++){var u=r.getInteriorRingN(s),l=t.locateInPolygonRing(n,u);if(l===de.INTERIOR)return de.EXTERIOR;if(l===de.BOUNDARY)return de.BOUNDARY}return de.INTERIOR}else if(arguments[0]instanceof se&&arguments[1]instanceof Mo){var c=arguments[0],f=arguments[1];if(!f.getEnvelopeInternal().intersects(c))return de.EXTERIOR;var h=f.getCoordinates();return!f.isClosed()&&(c.equals(h[0])||c.equals(h[h.length-1]))?de.BOUNDARY:He.isOnLine(c,h)?de.INTERIOR:de.EXTERIOR}else if(arguments[0]instanceof se&&arguments[1]instanceof El){var d=arguments[0],p=arguments[1],g=p.getCoordinate();return g.equals2D(d)?de.INTERIOR:de.EXTERIOR}};xf.prototype.locateInPolygonRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?He.locatePointInRing(t,n.getCoordinates()):de.EXTERIOR};xf.prototype.intersects=function(t,n){return this.locate(t,n)!==de.EXTERIOR};xf.prototype.updateLocationInfo=function(t){t===de.INTERIOR&&(this._isIn=!0),t===de.BOUNDARY&&this._numBoundaries++};xf.prototype.computeLocation=function(t,n){var r=this;if(n instanceof El&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof Mo)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Da)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof o_)for(var o=n,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);r.updateLocationInfo(r.locateInternal(t,s))}else if(n instanceof Md)for(var u=n,l=0;l<u.getNumGeometries();l++){var c=u.getGeometryN(l);r.updateLocationInfo(r.locateInternal(t,c))}else if(n instanceof Cu)for(var f=new Ld(n);f.hasNext();){var h=f.next();h!==n&&r.computeLocation(t,h)}};xf.prototype.locate=function(t,n){return n.isEmpty()?de.EXTERIOR:n instanceof Mo?this.locateInternal(t,n):n instanceof Da?this.locateInternal(t,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,n),this._boundaryRule.isInBoundary(this._numBoundaries)?de.BOUNDARY:this._numBoundaries>0||this._isIn?de.INTERIOR:de.EXTERIOR)};xf.prototype.interfaces_=function(){return[]};xf.prototype.getClass=function(){return xf};var gu=function e(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._component=r,this._segIndex=o,this._pt=a}},Ire={INSIDE_AREA:{configurable:!0}};gu.prototype.isInsideArea=function(){return this._segIndex===gu.INSIDE_AREA};gu.prototype.getCoordinate=function(){return this._pt};gu.prototype.getGeometryComponent=function(){return this._component};gu.prototype.getSegmentIndex=function(){return this._segIndex};gu.prototype.interfaces_=function(){return[]};gu.prototype.getClass=function(){return gu};Ire.INSIDE_AREA.get=function(){return-1};Object.defineProperties(gu,Ire);var xg=function(t){this._pts=t||null};xg.prototype.filter=function(t){t instanceof El&&this._pts.add(t)};xg.prototype.interfaces_=function(){return[Dh]};xg.prototype.getClass=function(){return xg};xg.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof El?vf.singletonList(t):xg.getPoints(t,new Fe)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof El?r.add(n):n instanceof Cu&&n.apply(new xg(r)),r}};var Av=function(){this._locations=null;var t=arguments[0];this._locations=t};Av.prototype.filter=function(t){(t instanceof El||t instanceof Mo||t instanceof Da)&&this._locations.add(new gu(t,0,t.getCoordinate()))};Av.prototype.interfaces_=function(){return[Dh]};Av.prototype.getClass=function(){return Av};Av.getLocations=function(t){var n=new Fe;return t.apply(new Av(n)),n};var ws=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new xf,this._minDistanceLocation=null,this._minDistance=Xt.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=o,this._terminateDistance=a}};ws.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=1-r,s=Zp.getPolygons(this._geom[r]);if(s.size()>0){var u=Av.getLocations(this._geom[a]);if(this.computeContainmentDistance(u,s,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=o[0],this._minDistanceLocation[r]=o[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Lt(arguments[0],mf)&&Lt(arguments[1],mf)){for(var l=arguments[0],c=arguments[1],f=arguments[2],h=0;h<l.size();h++)for(var d=l.get(h),p=0;p<c.size();p++)if(t.computeContainmentDistance(d,c.get(p),f),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof gu&&arguments[1]instanceof Da){var g=arguments[0],y=arguments[1],v=arguments[2],w=g.getCoordinate();if(de.EXTERIOR!==this._ptLocator.locate(w,y))return this._minDistance=0,v[0]=g,v[1]=new gu(y,w),null}}};ws.prototype.computeMinDistanceLinesPoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};ws.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),n=_s.getLines(this._geom[0]),r=_s.getLines(this._geom[1]),o=xg.getPoints(this._geom[0]),a=xg.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,a,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,o,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(o,a,t),this.updateMinDistance(t,!1)};ws.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};ws.prototype.updateMinDistance=function(t,n){if(t[0]===null)return null;n?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};ws.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};ws.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Mo&&arguments[1]instanceof El){var n=arguments[0],r=arguments[1],o=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var a=n.getCoordinates(),s=r.getCoordinate(),u=0;u<a.length-1;u++){var l=He.distancePointLine(s,a[u],a[u+1]);if(l<t._minDistance){t._minDistance=l;var c=new ft(a[u],a[u+1]),f=c.closestPoint(s);o[0]=new gu(n,u,f),o[1]=new gu(r,0,s)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Mo&&arguments[1]instanceof Mo){var h=arguments[0],d=arguments[1],p=arguments[2];if(h.getEnvelopeInternal().distance(d.getEnvelopeInternal())>this._minDistance)return null;for(var g=h.getCoordinates(),y=d.getCoordinates(),v=0;v<g.length-1;v++)for(var w=0;w<y.length-1;w++){var C=He.distanceLineLine(g[v],g[v+1],y[w],y[w+1]);if(C<t._minDistance){t._minDistance=C;var E=new ft(g[v],g[v+1]),S=new ft(y[w],y[w+1]),A=E.closestPoints(S);p[0]=new gu(h,v,A[0]),p[1]=new gu(d,w,A[1])}if(t._minDistance<=t._terminateDistance)return null}}}};ws.prototype.computeMinDistancePoints=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u),c=s.getCoordinate().distance(l.getCoordinate());if(c<o._minDistance&&(o._minDistance=c,r[0]=new gu(s,0,s.getCoordinate()),r[1]=new gu(l,0,l.getCoordinate())),o._minDistance<=o._terminateDistance)return null}};ws.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new fo("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};ws.prototype.computeMinDistanceLines=function(t,n,r){for(var o=this,a=0;a<t.size();a++)for(var s=t.get(a),u=0;u<n.size();u++){var l=n.get(u);if(o.computeMinDistance(s,l,r),o._minDistance<=o._terminateDistance)return null}};ws.prototype.interfaces_=function(){return[]};ws.prototype.getClass=function(){return ws};ws.distance=function(t,n){var r=new ws(t,n);return r.distance()};ws.isWithinDistance=function(t,n,r){var o=new ws(t,n,r);return o.distance()<=r};ws.nearestPoints=function(t,n){var r=new ws(t,n);return r.nearestPoints()};var ks=function(){this._pt=[new se,new se],this._distance=Xt.NaN,this._isNull=!0};ks.prototype.getCoordinates=function(){return this._pt};ks.prototype.getCoordinate=function(t){return this._pt[t]};ks.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o<this._distance&&this.initialize(n,r,o)}};ks.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(o),this._distance=a,this._isNull=!1}};ks.prototype.toString=function(){return gf.toLineString(this._pt[0],this._pt[1])};ks.prototype.getDistance=function(){return this._distance};ks.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var o=n.distance(r);o>this._distance&&this.initialize(n,r,o)}};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};var Eh=function(){};Eh.prototype.interfaces_=function(){return[]};Eh.prototype.getClass=function(){return Eh};Eh.computeDistance=function(){if(arguments[2]instanceof ks&&arguments[0]instanceof Mo&&arguments[1]instanceof se)for(var t=arguments[0],n=arguments[1],r=arguments[2],o=new ft,a=t.getCoordinates(),s=0;s<a.length-1;s++){o.setCoordinates(a[s],a[s+1]);var u=o.closestPoint(n);r.setMinimum(u,n)}else if(arguments[2]instanceof ks&&arguments[0]instanceof Da&&arguments[1]instanceof se){var l=arguments[0],c=arguments[1],f=arguments[2];Eh.computeDistance(l.getExteriorRing(),c,f);for(var h=0;h<l.getNumInteriorRing();h++)Eh.computeDistance(l.getInteriorRingN(h),c,f)}else if(arguments[2]instanceof ks&&arguments[0]instanceof Dt&&arguments[1]instanceof se){var d=arguments[0],p=arguments[1],g=arguments[2];if(d instanceof Mo)Eh.computeDistance(d,p,g);else if(d instanceof Da)Eh.computeDistance(d,p,g);else if(d instanceof Cu)for(var y=d,v=0;v<y.getNumGeometries();v++){var w=y.getGeometryN(v);Eh.computeDistance(w,p,g)}else g.setMinimum(d.getCoordinate(),p)}else if(arguments[2]instanceof ks&&arguments[0]instanceof ft&&arguments[1]instanceof se){var C=arguments[0],E=arguments[1],S=arguments[2],A=C.closestPoint(E);S.setMinimum(A,E)}};var Pc=function(){this._g0=null,this._g1=null,this._ptDist=new ks,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n},X4={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Pc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Pc.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new fo("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};Pc.prototype.compute=function(t,n){this.computeOrientedDistance(t,n,this._ptDist),this.computeOrientedDistance(n,t,this._ptDist)};Pc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Pc.prototype.computeOrientedDistance=function(t,n,r){var o=new bv(n);if(t.apply(o),r.setMaximum(o.getMaxPointDistance()),this._densifyFrac>0){var a=new Pg(n,this._densifyFrac);t.apply(a),r.setMaximum(a.getMaxPointDistance())}};Pc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Pc.prototype.interfaces_=function(){return[]};Pc.prototype.getClass=function(){return Pc};Pc.distance=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Pc(t,n);return r.distance()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Pc(o,a);return u.setDensifyFraction(s),u.distance()}};X4.MaxPointDistanceFilter.get=function(){return bv};X4.MaxDensifiedByFractionDistanceFilter.get=function(){return Pg};Object.defineProperties(Pc,X4);var bv=function(){this._maxPtDist=new ks,this._minPtDist=new ks,this._euclideanDist=new Eh,this._geom=null;var t=arguments[0];this._geom=t};bv.prototype.filter=function(t){this._minPtDist.initialize(),Eh.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};bv.prototype.getMaxPointDistance=function(){return this._maxPtDist};bv.prototype.interfaces_=function(){return[Rd]};bv.prototype.getClass=function(){return bv};var Pg=function(){this._maxPtDist=new ks,this._minPtDist=new ks,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))};Pg.prototype.filter=function(t,n){var r=this;if(n===0)return null;for(var o=t.getCoordinate(n-1),a=t.getCoordinate(n),s=(a.x-o.x)/this._numSubSegs,u=(a.y-o.y)/this._numSubSegs,l=0;l<this._numSubSegs;l++){var c=o.x+l*s,f=o.y+l*u,h=new se(c,f);r._minPtDist.initialize(),Eh.computeDistance(r._geom,h,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Pg.prototype.isDone=function(){return!1};Pg.prototype.isGeometryChanged=function(){return!1};Pg.prototype.getMaxPointDistance=function(){return this._maxPtDist};Pg.prototype.interfaces_=function(){return[_f]};Pg.prototype.getClass=function(){return Pg};var xl=function(t,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=r||null},j4={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};xl.prototype.checkMaximumDistance=function(t,n,r){var o=new Pc(n,t);if(o.setDensifyFraction(.25),this._maxDistanceFound=o.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var a=o.getCoordinates();this._errorLocation=a[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+gf.toLineString(a[0],a[1])+")"}};xl.prototype.isValid=function(){var t=Math.abs(this._bufDistance),n=xl.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),xl.VERBOSE&&xs.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};xl.prototype.checkNegativeValid=function(){if(!(this._input instanceof Da||this._input instanceof Md||this._input instanceof Cu))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};xl.prototype.getErrorIndicator=function(){return this._errorIndicator};xl.prototype.checkMinimumDistance=function(t,n,r){var o=new ws(t,n,r);if(this._minDistanceFound=o.distance(),this._minDistanceFound<r){this._isValid=!1;var a=o.nearestPoints();this._errorLocation=o.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+gf.toLineString(a[0],a[1])+" )"}};xl.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};xl.prototype.getErrorLocation=function(){return this._errorLocation};xl.prototype.getPolygonLines=function(t){for(var n=new Fe,r=new _s(n),o=Zp.getPolygons(t),a=o.iterator();a.hasNext();){var s=a.next();s.apply(r)}return t.getFactory().buildGeometry(n)};xl.prototype.getErrorMessage=function(){return this._errMsg};xl.prototype.interfaces_=function(){return[]};xl.prototype.getClass=function(){return xl};j4.VERBOSE.get=function(){return!1};j4.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(xl,j4);var Es=function(t,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=r||null},K4={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Es.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};Es.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Es.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var n=new lt(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new lt(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};Es.prototype.checkDistance=function(){var t=new xl(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};Es.prototype.checkArea=function(){var t=this._input.getArea(),n=this._result.getArea();this._distance>0&&t>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};Es.prototype.checkPolygonal=function(){this._result instanceof Da||this._result instanceof Md||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};Es.prototype.getErrorIndicator=function(){return this._errorIndicator};Es.prototype.getErrorLocation=function(){return this._errorLocation};Es.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};Es.prototype.report=function(t){if(!Es.VERBOSE)return null;xs.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};Es.prototype.getErrorMessage=function(){return this._errorMsg};Es.prototype.interfaces_=function(){return[]};Es.prototype.getClass=function(){return Es};Es.isValidMsg=function(t,n,r){var o=new Es(t,n,r);return o.isValid()?null:o.getErrorMessage()};Es.isValid=function(t,n,r){var o=new Es(t,n,r);return!!o.isValid()};K4.VERBOSE.get=function(){return!1};K4.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Es,K4);var Nh=function(){this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};Nh.prototype.getCoordinates=function(){return this._pts};Nh.prototype.size=function(){return this._pts.length};Nh.prototype.getCoordinate=function(t){return this._pts[t]};Nh.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Nh.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:wv.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Nh.prototype.setData=function(t){this._data=t};Nh.prototype.getData=function(){return this._data};Nh.prototype.toString=function(){return gf.toLineString(new Wo(this._pts))};Nh.prototype.interfaces_=function(){return[Bd]};Nh.prototype.getClass=function(){return Nh};var $a=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Fe,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};$a.prototype.getInteriorIntersection=function(){return this._interiorIntersection};$a.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};$a.prototype.getIntersectionSegments=function(){return this._intSegments};$a.prototype.count=function(){return this._intersectionCount};$a.prototype.getIntersections=function(){return this._intersections};$a.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};$a.prototype.setKeepIntersections=function(t){this._keepIntersections=t};$a.prototype.processIntersections=function(t,n,r,o){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&n===o)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(t,n)||this.isEndSegment(r,o);if(!a)return null}var s=t.getCoordinates()[n],u=t.getCoordinates()[n+1],l=r.getCoordinates()[o],c=r.getCoordinates()[o+1];this._li.computeIntersection(s,u,l,c),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=s,this._intSegments[1]=u,this._intSegments[2]=l,this._intSegments[3]=c,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};$a.prototype.isEndSegment=function(t,n){return n===0||n>=t.size()-2};$a.prototype.hasIntersection=function(){return this._interiorIntersection!==null};$a.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};$a.prototype.interfaces_=function(){return[u_]};$a.prototype.getClass=function(){return $a};$a.createAllIntersectionsFinder=function(t){var n=new $a(t);return n.setFindAllIntersections(!0),n};$a.createAnyIntersectionFinder=function(t){return new $a(t)};$a.createIntersectionCounter=function(t){var n=new $a(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var wf=function(){this._li=new m_,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};wf.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};wf.prototype.getIntersections=function(){return this._segInt.getIntersections()};wf.prototype.isValid=function(){return this.execute(),this._isValid};wf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};wf.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new $a(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new W4;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};wf.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new nm(this.getErrorMessage(),this._segInt.getInteriorIntersection())};wf.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+gf.toLineString(t[0],t[1])+" and "+gf.toLineString(t[2],t[3])};wf.prototype.interfaces_=function(){return[]};wf.prototype.getClass=function(){return wf};wf.computeIntersections=function(t){var n=new wf(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var f_=function e(){this._nv=null;var t=arguments[0];this._nv=new wf(e.toSegmentStrings(t))};f_.prototype.checkValid=function(){this._nv.checkValid()};f_.prototype.interfaces_=function(){return[]};f_.prototype.getClass=function(){return f_};f_.toSegmentStrings=function(t){for(var n=new Fe,r=t.iterator();r.hasNext();){var o=r.next();n.add(new Nh(o.getCoordinates(),o))}return n};f_.checkValid=function(t){var n=new f_(t);n.checkValid()};var Iv=function(t){this._mapOp=t};Iv.prototype.map=function(t){for(var n=this,r=new Fe,o=0;o<t.getNumGeometries();o++){var a=n._mapOp.map(t.getGeometryN(o));a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(hn.toGeometryArray(r))};Iv.prototype.interfaces_=function(){return[]};Iv.prototype.getClass=function(){return Iv};Iv.map=function(t,n){var r=new Iv(n);return r.map(t)};var Bh=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Fe,this._resultLineList=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=r};Bh.prototype.collectLines=function(t){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var o=r.next();n.collectLineEdge(o,t,n._lineEdgesList),n.collectBoundaryTouchEdge(o,t,n._lineEdgesList)}};Bh.prototype.labelIsolatedLine=function(t,n){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(n));t.getLabel().setLocation(n,r)};Bh.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};Bh.prototype.collectLineEdge=function(t,n,r){var o=t.getLabel(),a=t.getEdge();t.isLineEdge()&&!t.isVisited()&&Yt.isResultOfOp(o,n)&&!a.isCovered()&&(r.add(a),t.setVisitedEdge(!0))};Bh.prototype.findCoveredLineEdges=function(){for(var t=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var o=this._op.getGraph().getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getEdge();if(a.isLineEdge()&&!s.isCoveredSet()){var u=t._op.isCoveredByA(a.getCoordinate());s.setCovered(u)}}};Bh.prototype.labelIsolatedLines=function(t){for(var n=this,r=t.iterator();r.hasNext();){var o=r.next(),a=o.getLabel();o.isIsolated()&&(a.isNull(0)?n.labelIsolatedLine(o,0):n.labelIsolatedLine(o,1))}};Bh.prototype.buildLines=function(t){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var o=r.next(),a=n._geometryFactory.createLineString(o.getCoordinates());n._resultLineList.add(a),o.setInResult(!0)}};Bh.prototype.collectBoundaryTouchEdge=function(t,n,r){var o=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;nn.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),Yt.isResultOfOp(o,n)&&n===Yt.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};Bh.prototype.interfaces_=function(){return[]};Bh.prototype.getClass=function(){return Bh};var Dv=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Fe;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n};Dv.prototype.filterCoveredNodeToPoint=function(t){var n=t.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};Dv.prototype.extractNonCoveredResultNodes=function(t){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var o=r.next();if(!o.isInResult()&&!o.isIncidentEdgeInResult()&&(o.getEdges().getDegree()===0||t===Yt.INTERSECTION)){var a=o.getLabel();Yt.isResultOfOp(a,t)&&n.filterCoveredNodeToPoint(o)}}};Dv.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Dv.prototype.interfaces_=function(){return[]};Dv.prototype.getClass=function(){return Dv};var Wu=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Wu.prototype.transformPoint=function(t,n){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};Wu.prototype.transformPolygon=function(t,n){var r=this,o=!0,a=this.transformLinearRing(t.getExteriorRing(),t);(a===null||!(a instanceof Od)||a.isEmpty())&&(o=!1);for(var s=new Fe,u=0;u<t.getNumInteriorRing();u++){var l=r.transformLinearRing(t.getInteriorRingN(u),t);l===null||l.isEmpty()||(l instanceof Od||(o=!1),s.add(l))}if(o)return this._factory.createPolygon(a,s.toArray([]));var c=new Fe;return a!==null&&c.add(a),c.addAll(s),this._factory.buildGeometry(c)};Wu.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};Wu.prototype.getInputGeometry=function(){return this._inputGeom};Wu.prototype.transformMultiLineString=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformLineString(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wu.prototype.transformCoordinates=function(t,n){return this.copy(t)};Wu.prototype.transformLineString=function(t,n){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};Wu.prototype.transformMultiPoint=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformPoint(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wu.prototype.transformMultiPolygon=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transformPolygon(t.getGeometryN(a),t);s!==null&&(s.isEmpty()||o.add(s))}return this._factory.buildGeometry(o)};Wu.prototype.copy=function(t){return t.copy()};Wu.prototype.transformGeometryCollection=function(t,n){for(var r=this,o=new Fe,a=0;a<t.getNumGeometries();a++){var s=r.transform(t.getGeometryN(a));s!==null&&(r._pruneEmptyGeometry&&s.isEmpty()||o.add(s))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(hn.toGeometryArray(o)):this._factory.buildGeometry(o)};Wu.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof El)return this.transformPoint(t,null);if(t instanceof Nx)return this.transformMultiPoint(t,null);if(t instanceof Od)return this.transformLinearRing(t,null);if(t instanceof Mo)return this.transformLineString(t,null);if(t instanceof o_)return this.transformMultiLineString(t,null);if(t instanceof Da)return this.transformPolygon(t,null);if(t instanceof Md)return this.transformMultiPolygon(t,null);if(t instanceof Cu)return this.transformGeometryCollection(t,null);throw new fo("Unknown Geometry subtype: "+t.getClass().getName())};Wu.prototype.transformLinearRing=function(t,n){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var o=r.size();return o>0&&o<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};Wu.prototype.interfaces_=function(){return[]};Wu.prototype.getClass=function(){return Wu};var Vd=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ft,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Mo&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],o=arguments[1];this._srcPts=r,this._isClosed=e.isClosed(r),this._snapTolerance=o}};Vd.prototype.snapVertices=function(t,n){for(var r=this,o=this._isClosed?t.size()-1:t.size(),a=0;a<o;a++){var s=t.get(a),u=r.findSnapForVertex(s,n);u!==null&&(t.set(a,new se(u)),a===0&&r._isClosed&&t.set(t.size()-1,new se(u)))}};Vd.prototype.findSnapForVertex=function(t,n){for(var r=this,o=0;o<n.length;o++){if(t.equals2D(n[o]))return null;if(t.distance(n[o])<r._snapTolerance)return n[o]}return null};Vd.prototype.snapTo=function(t){var n=new FA(this._srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var r=n.toCoordinateArray();return r};Vd.prototype.snapSegments=function(t,n){var r=this;if(n.length===0)return null;var o=n.length;n[0].equals2D(n[n.length-1])&&(o=n.length-1);for(var a=0;a<o;a++){var s=n[a],u=r.findSegmentIndexToSnap(s,t);u>=0&&t.add(u+1,new se(s),!1)}};Vd.prototype.findSegmentIndexToSnap=function(t,n){for(var r=this,o=Xt.MAX_VALUE,a=-1,s=0;s<n.size()-1;s++){if(r._seg.p0=n.get(s),r._seg.p1=n.get(s+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var u=r._seg.distance(t);u<r._snapTolerance&&u<o&&(o=u,a=s)}return a};Vd.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};Vd.prototype.interfaces_=function(){return[]};Vd.prototype.getClass=function(){return Vd};Vd.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var Yo=function(t){this._srcGeom=t||null},Dre={SNAP_PRECISION_FACTOR:{configurable:!0}};Yo.prototype.snapTo=function(t,n){var r=this.extractTargetCoordinates(t),o=new Pre(n,r);return o.transform(this._srcGeom)};Yo.prototype.snapToSelf=function(t,n){var r=this.extractTargetCoordinates(this._srcGeom),o=new Pre(t,r,!0),a=o.transform(this._srcGeom),s=a;return n&&Lt(s,Tg)&&(s=a.buffer(0)),s};Yo.prototype.computeSnapTolerance=function(t){var n=this.computeMinimumSegmentLength(t),r=n/10;return r};Yo.prototype.extractTargetCoordinates=function(t){for(var n=new Ih,r=t.getCoordinates(),o=0;o<r.length;o++)n.add(r[o]);return n.toArray(new Array(0).fill(null))};Yo.prototype.computeMinimumSegmentLength=function(t){for(var n=Xt.MAX_VALUE,r=0;r<t.length-1;r++){var o=t[r].distance(t[r+1]);o<n&&(n=o)}return n};Yo.prototype.interfaces_=function(){return[]};Yo.prototype.getClass=function(){return Yo};Yo.snap=function(t,n,r){var o=new Array(2).fill(null),a=new Yo(t);o[0]=a.snapTo(n,r);var s=new Yo(n);return o[1]=s.snapTo(o[0],r),o};Yo.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=Yo.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===Yr.FIXED){var o=1/r.getScale()*2/1.415;o>n&&(n=o)}return n}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return Math.min(Yo.computeOverlaySnapTolerance(a),Yo.computeOverlaySnapTolerance(s))}};Yo.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),o=r*Yo.SNAP_PRECISION_FACTOR;return o};Yo.snapToSelf=function(t,n,r){var o=new Yo(t);return o.snapToSelf(n,r)};Dre.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Yo,Dre);var Pre=function(e){function t(n,r,o){e.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=o!==void 0?o:!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,o){var a=new Vd(r,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(o)},t.prototype.transformCoordinates=function(r,o){var a=r.toCoordinateArray(),s=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(s)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Wu),pu=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};pu.prototype.getCommon=function(){return Xt.longBitsToDouble(this._commonBits)};pu.prototype.add=function(t){var n=Xt.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=pu.signExpBits(this._commonBits),this._isFirst=!1,null;var r=pu.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=pu.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=pu.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};pu.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],n=Xt.longBitsToDouble(t),r=Xt.toBinaryString(t),o="0000000000000000000000000000000000000000000000000000000000000000"+r,a=o.substring(o.length-64),s=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+n+" ]";return s}};pu.prototype.interfaces_=function(){return[]};pu.prototype.getClass=function(){return pu};pu.getBit=function(t,n){var r=1<<n;return(t&r)!==0?1:0};pu.signExpBits=function(t){return t>>52};pu.zeroLowerBits=function(t,n){var r=(1<<n)-1,o=~r,a=t&o;return a};pu.numCommonMostSigMantissaBits=function(t,n){for(var r=0,o=52;o>=0;o--){if(pu.getBit(t,o)!==pu.getBit(n,o))return r;r++}return 52};var Mg=function(){this._commonCoord=null,this._ccFilter=new Pv},Z4={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Mg.prototype.addCommonBits=function(t){var n=new Lg(this._commonCoord);t.apply(n),t.geometryChanged()};Mg.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var n=new se(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new Lg(n);return t.apply(r),t.geometryChanged(),t};Mg.prototype.getCommonCoordinate=function(){return this._commonCoord};Mg.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Mg.prototype.interfaces_=function(){return[]};Mg.prototype.getClass=function(){return Mg};Z4.CommonCoordinateFilter.get=function(){return Pv};Z4.Translater.get=function(){return Lg};Object.defineProperties(Mg,Z4);var Pv=function(){this._commonBitsX=new pu,this._commonBitsY=new pu};Pv.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};Pv.prototype.getCommonCoordinate=function(){return new se(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Pv.prototype.interfaces_=function(){return[Rd]};Pv.prototype.getClass=function(){return Pv};var Lg=function(){this.trans=null;var t=arguments[0];this.trans=t};Lg.prototype.filter=function(t,n){var r=t.getOrdinate(n,0)+this.trans.x,o=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,r),t.setOrdinate(n,1,o)};Lg.prototype.isDone=function(){return!1};Lg.prototype.isGeometryChanged=function(){return!0};Lg.prototype.interfaces_=function(){return[_f]};Lg.prototype.getClass=function(){return Lg};var es=function(t,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()};es.prototype.selfSnap=function(t){var n=new Yo(t),r=n.snapTo(t,this._snapTolerance);return r};es.prototype.removeCommonBits=function(t){this._cbr=new Mg,this._cbr.add(t[0]),this._cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t[0].copy()),n[1]=this._cbr.removeCommonBits(t[1].copy()),n};es.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};es.prototype.getResultGeometry=function(t){var n=this.snap(this._geom),r=Yt.overlayOp(n[0],n[1],t);return this.prepareResult(r)};es.prototype.checkValid=function(t){t.isValid()||xs.out.println("Snapped geometry is invalid")};es.prototype.computeSnapTolerance=function(){this._snapTolerance=Yo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};es.prototype.snap=function(t){var n=this.removeCommonBits(t),r=Yo.snap(n[0],n[1],this._snapTolerance);return r};es.prototype.interfaces_=function(){return[]};es.prototype.getClass=function(){return es};es.overlayOp=function(t,n,r){var o=new es(t,n);return o.getResultGeometry(r)};es.union=function(t,n){return es.overlayOp(t,n,Yt.UNION)};es.intersection=function(t,n){return es.overlayOp(t,n,Yt.INTERSECTION)};es.symDifference=function(t,n){return es.overlayOp(t,n,Yt.SYMDIFFERENCE)};es.difference=function(t,n){return es.overlayOp(t,n,Yt.DIFFERENCE)};var Eu=function(t,n){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n};Eu.prototype.getResultGeometry=function(t){var n=null,r=!1,o=null;try{n=Yt.overlayOp(this._geom[0],this._geom[1],t);var a=!0;a&&(r=!0)}catch(s){if(s instanceof em)o=s;else throw s}finally{}if(!r)try{n=es.overlayOp(this._geom[0],this._geom[1],t)}catch(s){throw s instanceof em?o:s}finally{}return n};Eu.prototype.interfaces_=function(){return[]};Eu.prototype.getClass=function(){return Eu};Eu.overlayOp=function(t,n,r){var o=new Eu(t,n);return o.getResultGeometry(r)};Eu.union=function(t,n){return Eu.overlayOp(t,n,Yt.UNION)};Eu.intersection=function(t,n){return Eu.overlayOp(t,n,Yt.INTERSECTION)};Eu.symDifference=function(t,n){return Eu.overlayOp(t,n,Yt.SYMDIFFERENCE)};Eu.difference=function(t,n){return Eu.overlayOp(t,n,Yt.DIFFERENCE)};var AA=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n};AA.prototype.computeIntersections=function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)};AA.prototype.interfaces_=function(){return[]};AA.prototype.getClass=function(){return AA};var Al=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],o=arguments[1],a=arguments[2];this._eventType=e.INSERT,this._label=r,this._xValue=o,this._obj=a}},Q4={INSERT:{configurable:!0},DELETE:{configurable:!0}};Al.prototype.isDelete=function(){return this._eventType===Al.DELETE};Al.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};Al.prototype.getObject=function(){return this._obj};Al.prototype.compareTo=function(t){var n=t;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};Al.prototype.getInsertEvent=function(){return this._insertEvent};Al.prototype.isInsert=function(){return this._eventType===Al.INSERT};Al.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};Al.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};Al.prototype.interfaces_=function(){return[Oc]};Al.prototype.getClass=function(){return Al};Q4.INSERT.get=function(){return 1};Q4.DELETE.get=function(){return 2};Object.defineProperties(Al,Q4);var UL=function(){};UL.prototype.interfaces_=function(){return[]};UL.prototype.getClass=function(){return UL};var Ts=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=r};Ts.prototype.isTrivialIntersection=function(t,n,r,o){if(t===r&&this._li.getIntersectionNum()===1){if(Ts.isAdjacentSegments(n,o))return!0;if(t.isClosed()){var a=t.getNumPoints()-1;if(n===0&&o===a||o===0&&n===a)return!0}}return!1};Ts.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Ts.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};Ts.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Ts.prototype.isBoundaryPointInternal=function(t,n){for(var r=n.iterator();r.hasNext();){var o=r.next(),a=o.getCoordinate();if(t.isIntersection(a))return!0}return!1};Ts.prototype.hasProperIntersection=function(){return this._hasProper};Ts.prototype.hasIntersection=function(){return this._hasIntersection};Ts.prototype.isDone=function(){return this._isDone};Ts.prototype.isBoundaryPoint=function(t,n){return n===null?!1:!!(this.isBoundaryPointInternal(t,n[0])||this.isBoundaryPointInternal(t,n[1]))};Ts.prototype.setBoundaryNodes=function(t,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=n};Ts.prototype.addIntersections=function(t,n,r,o){if(t===r&&n===o)return null;this.numTests++;var a=t.getCoordinates()[n],s=t.getCoordinates()[n+1],u=r.getCoordinates()[o],l=r.getCoordinates()[o+1];this._li.computeIntersection(a,s,u,l),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,n,r,o)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,n,0),r.addIntersections(this._li,o,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Ts.prototype.interfaces_=function(){return[]};Ts.prototype.getClass=function(){return Ts};Ts.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var IFe=function(e){function t(){e.call(this),this.events=new Fe,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;vf.sort(this.events);for(var o=0;o<this.events.size();o++){var a=r.events.get(o);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(o)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var o=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var s=r.events.get(a);if(s.isInsert()&&r.processOverlaps(a,s.getDeleteEventIndex(),s,o),o.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ts&&Lt(arguments[0],mf)&&Lt(arguments[1],mf)){var u=arguments[0],l=arguments[1],c=arguments[2];this.addEdges(u,u),this.addEdges(l,l),this.computeIntersections(c)}else if(typeof arguments[2]=="boolean"&&Lt(arguments[0],mf)&&arguments[1]instanceof Ts){var f=arguments[0],h=arguments[1],d=arguments[2];d?this.addEdges(f,null):this.addEdges(f),this.computeIntersections(h)}}},t.prototype.addEdge=function(r,o){for(var a=this,s=r.getMonotoneChainEdge(),u=s.getStartIndexes(),l=0;l<u.length-1;l++){var c=new AA(s,l),f=new Al(o,s.getMinX(l),c);a.events.add(f),a.events.add(new Al(s.getMaxX(l),f))}},t.prototype.processOverlaps=function(r,o,a,s){for(var u=this,l=a.getObject(),c=r;c<o;c++){var f=u.events.get(c);if(f.isInsert()){var h=f.getObject();a.isSameLabel(f)||(l.computeIntersections(h,s),u.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var o=arguments[0],a=o.iterator();a.hasNext();){var s=a.next();r.addEdge(s,s)}else if(arguments.length===2)for(var u=arguments[0],l=arguments[1],c=u.iterator();c.hasNext();){var f=c.next();r.addEdge(f,l)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(UL),kd=function(){this._min=Xt.POSITIVE_INFINITY,this._max=Xt.NEGATIVE_INFINITY},Mre={NodeComparator:{configurable:!0}};kd.prototype.getMin=function(){return this._min};kd.prototype.intersects=function(t,n){return!(this._min>n||this._max<t)};kd.prototype.getMax=function(){return this._max};kd.prototype.toString=function(){return gf.toLineString(new se(this._min,0),new se(this._max,0))};kd.prototype.interfaces_=function(){return[]};kd.prototype.getClass=function(){return kd};Mre.NodeComparator.get=function(){return bA};Object.defineProperties(kd,Mre);var bA=function(){};bA.prototype.compare=function(t,n){var r=t,o=n,a=(r._min+r._max)/2,s=(o._min+o._max)/2;return a<s?-1:a>s?1:0};bA.prototype.interfaces_=function(){return[Ix]};bA.prototype.getClass=function(){return bA};var DFe=function(e){function t(){e.call(this),this._item=null;var n=arguments[0],r=arguments[1],o=arguments[2];this._min=n,this._max=r,this._item=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;a.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(kd),PFe=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,o){this._min=Math.min(r._min,o._min),this._max=Math.max(r._max,o._max)},t.prototype.query=function(r,o,a){if(!this.intersects(r,o))return null;this._node1!==null&&this._node1.query(r,o,a),this._node2!==null&&this._node2.query(r,o,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(kd),Gd=function(){this._leaves=new Fe,this._root=null,this._level=0};Gd.prototype.buildTree=function(){var t=this;vf.sort(this._leaves,new kd.NodeComparator);for(var n=this._leaves,r=null,o=new Fe;;){if(t.buildLevel(n,o),o.size()===1)return o.get(0);r=n,n=o,o=r}};Gd.prototype.insert=function(t,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new DFe(t,n,r))};Gd.prototype.query=function(t,n,r){this.init(),this._root.query(t,n,r)};Gd.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Gd.prototype.printNode=function(t){xs.out.println(gf.toLineString(new se(t._min,this._level),new se(t._max,this._level)))};Gd.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Gd.prototype.buildLevel=function(t,n){this._level++,n.clear();for(var r=0;r<t.size();r+=2){var o=t.get(r),a=r+1<t.size()?t.get(r):null;if(a===null)n.add(o);else{var s=new PFe(t.get(r),t.get(r+1));n.add(s)}}};Gd.prototype.interfaces_=function(){return[]};Gd.prototype.getClass=function(){return Gd};var Gx=function(){this._items=new Fe};Gx.prototype.visitItem=function(t){this._items.add(t)};Gx.prototype.getItems=function(){return this._items};Gx.prototype.interfaces_=function(){return[Sg]};Gx.prototype.getClass=function(){return Gx};var Ux=function(){this._index=null;var t=arguments[0];if(!Lt(t,Tg))throw new fo("Argument must be Polygonal");this._index=new h_(t)},J4={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ux.prototype.locate=function(t){var n=new Sh(t),r=new Hx(n);return this._index.query(t.y,t.y,r),n.getLocation()};Ux.prototype.interfaces_=function(){return[Vx]};Ux.prototype.getClass=function(){return Ux};J4.SegmentVisitor.get=function(){return Hx};J4.IntervalIndexedGeometry.get=function(){return h_};Object.defineProperties(Ux,J4);var Hx=function(){this._counter=null;var t=arguments[0];this._counter=t};Hx.prototype.visitItem=function(t){var n=t;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};Hx.prototype.interfaces_=function(){return[Sg]};Hx.prototype.getClass=function(){return Hx};var h_=function(){this._index=new Gd;var t=arguments[0];this.init(t)};h_.prototype.init=function(t){for(var n=this,r=_s.getLines(t),o=r.iterator();o.hasNext();){var a=o.next(),s=a.getCoordinates();n.addLine(s)}};h_.prototype.addLine=function(t){for(var n=this,r=1;r<t.length;r++){var o=new ft(t[r-1],t[r]),a=Math.min(o.p0.y,o.p1.y),s=Math.max(o.p0.y,o.p1.y);n._index.insert(a,s,o)}};h_.prototype.query=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Gx;return this._index.query(t,n,r),r.getItems()}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this._index.query(o,a,s)}};h_.prototype.interfaces_=function(){return[]};h_.prototype.getClass=function(){return h_};var KS=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new mre,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new xf,arguments.length===2){var n=arguments[0],r=arguments[1],o=Mc.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=o,r!==null&&this.add(r)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this._argIndex=a,this._parentGeom=s,this._boundaryNodeRule=u,s!==null&&this.add(s)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,o){var a=this._nodes.addNode(o),s=a.getLabel(),u=1,l=de.NONE;l=s.getLocation(r,Me.ON),l===de.BOUNDARY&&u++;var c=t.determineBoundary(this._boundaryNodeRule,u);s.setLocation(r,c)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],o=arguments[1];return this.computeSelfNodes(r,o,!1)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2],l=new Ts(a,!0,!1);l.setIsDoneIfProperInt(u);var c=this.createEdgeSetIntersector(),f=this._parentGeom instanceof Od||this._parentGeom instanceof Da||this._parentGeom instanceof Md,h=s||!f;return c.computeIntersections(this._edges,l,h),this.addSelfIntersectionNodes(this._argIndex),l}},t.prototype.computeSplitEdges=function(r){for(var o=this._edges.iterator();o.hasNext();){var a=o.next();a.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,o,a){var s=new Ts(o,a,!0);s.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var u=this.createEdgeSetIntersector();return u.computeIntersections(this._edges,r._edges,s),s},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof El){var r=arguments[0],o=r.getCoordinate();this.insertPoint(this._argIndex,o,de.INTERIOR)}else if(arguments[0]instanceof se){var a=arguments[0];this.insertPoint(this._argIndex,a,de.INTERIOR)}},t.prototype.addPolygon=function(r){var o=this;this.addPolygonRing(r.getExteriorRing(),de.EXTERIOR,de.INTERIOR);for(var a=0;a<r.getNumInteriorRing();a++){var s=r.getInteriorRingN(a);o.addPolygonRing(s,de.INTERIOR,de.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var o=r.getCoordinates();this.insertPoint(this._argIndex,o[0],de.BOUNDARY),this.insertPoint(this._argIndex,o[o.length-1],de.BOUNDARY)},t.prototype.addLineString=function(r){var o=dn.removeRepeatedPoints(r.getCoordinates());if(o.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=o[0],null;var a=new GL(o,new ii(this._argIndex,de.INTERIOR));this._lineEdgeMap.put(r,a),this.insertEdge(a),nn.isTrue(o.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,o[0]),this.insertBoundaryPoint(this._argIndex,o[o.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),o=new Array(r.size()).fill(null),a=0,s=r.iterator();s.hasNext();){var u=s.next();o[a++]=u.getCoordinate().copy()}return o},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,o,a){if(this.isBoundaryNode(r,o))return null;a===de.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,o):this.insertPoint(r,o,a)},t.prototype.addPolygonRing=function(r,o,a){if(r.isEmpty())return null;var s=dn.removeRepeatedPoints(r.getCoordinates());if(s.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var u=o,l=a;He.isCCW(s)&&(u=a,l=o);var c=new GL(s,new ii(this._argIndex,de.BOUNDARY,u,l));this._lineEdgeMap.put(r,c),this.insertEdge(c),this.insertPoint(this._argIndex,s[0],de.BOUNDARY)},t.prototype.insertPoint=function(r,o,a){var s=this._nodes.addNode(o),u=s.getLabel();u===null?s._label=new ii(r,a):u.setLocation(r,a)},t.prototype.createEdgeSetIntersector=function(){return new IFe},t.prototype.addSelfIntersectionNodes=function(r){for(var o=this,a=this._edges.iterator();a.hasNext();)for(var s=a.next(),u=s.getLabel().getLocation(r),l=s.eiList.iterator();l.hasNext();){var c=l.next();o.addSelfIntersectionNode(r,c.coord,u)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof Md&&(this._useBoundaryDeterminationRule=!1),r instanceof Da)this.addPolygon(r);else if(r instanceof Mo)this.addLineString(r);else if(r instanceof El)this.addPoint(r);else if(r instanceof Nx)this.addCollection(r);else if(r instanceof o_)this.addCollection(r);else if(r instanceof Md)this.addCollection(r);else if(r instanceof Cu)this.addCollection(r);else throw new Error(r.getClass().getName())}else return e.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var o=this,a=0;a<r.getNumGeometries();a++){var s=r.getGeometryN(a);o.add(s)}},t.prototype.locate=function(r){return Lt(this._parentGeom,Tg)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Ux(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,o){return r.isInBoundary(o)?de.BOUNDARY:de.INTERIOR},t}(Eo),qx=function(){if(this._li=new m_,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new KS(0,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],o=Mc.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new KS(0,n,o),this._arg[1]=new KS(1,r,o)}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];a.getPrecisionModel().compareTo(s.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(s.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new KS(0,a,u),this._arg[1]=new KS(1,s,u)}};qx.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};qx.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};qx.prototype.interfaces_=function(){return[]};qx.prototype.getClass=function(){return qx};var n_=function(){};n_.prototype.interfaces_=function(){return[]};n_.prototype.getClass=function(){return n_};n_.map=function(){if(arguments[0]instanceof Dt&&Lt(arguments[1],n_.MapOp)){for(var t=arguments[0],n=arguments[1],r=new Fe,o=0;o<t.getNumGeometries();o++){var a=n.map(t.getGeometryN(o));a!==null&&r.add(a)}return t.getFactory().buildGeometry(r)}else if(Lt(arguments[0],Sa)&&Lt(arguments[1],n_.MapOp)){for(var s=arguments[0],u=arguments[1],l=new Fe,c=s.iterator();c.hasNext();){var f=c.next(),h=u.map(f);h!==null&&l.add(h)}return l}};n_.MapOp=function(){};var Yt=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r),this._ptLocator=new xf,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Cf,this._resultPolyList=new Fe,this._resultLineList=new Fe,this._resultPointList=new Fe,this._graph=new Eo(new wre),this._geomFact=n.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var o=this._edgeList.findEqualEdge(r);if(o!==null){var a=o.getLabel(),s=r.getLabel();o.isPointwiseEqual(r)||(s=new ii(r.getLabel()),s.flip());var u=o.getDepth();u.isNull()&&u.add(a),u.add(s),a.merge(s)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var o=r.next(),a=o.getSym();o.isInResult()&&a.isInResult()&&(o.setInResult(!1),a.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,o,a,s){var u=new Fe;return u.addAll(r),u.addAll(o),u.addAll(a),u.isEmpty()?t.createEmptyResult(s,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(u)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next();o.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,o){for(var a=this,s=o.iterator();s.hasNext();){var u=s.next(),l=a._ptLocator.locate(r,u);if(l!==de.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new Fe,o=this._edgeList.iterator();o.hasNext();){var a=o.next();a.isCollapsed()&&(o.remove(),r.add(a.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var o=r.next(),a=o.getEdges().getLabel();o.getLabel().merge(a)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var o=this,a=r.iterator();a.hasNext();){var s=a.next();o.insertUniqueEdge(s)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var o=new Fe;this._arg[0].computeSplitEdges(o),this._arg[1].computeSplitEdges(o),this.insertUniqueEdges(o),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),f_.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var a=new Tl(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var s=new Bh(this,this._geomFact,this._ptLocator);this._resultLineList=s.build(r);var u=new Dv(this,this._geomFact,this._ptLocator);this._resultPointList=u.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,o){var a=this._ptLocator.locate(r.getCoordinate(),this._arg[o].getGeometry());r.getLabel().setLocation(o,a)},t.prototype.copyPoints=function(r){for(var o=this,a=this._arg[r].getNodeIterator();a.hasNext();){var s=a.next(),u=o._graph.addNode(s.getCoordinate());u.setLabel(r,s.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var o=this._graph.getEdgeEnds().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();s.isArea()&&!a.isInteriorAreaEdge()&&t.isResultOfOp(s.getLocation(0,Me.RIGHT),s.getLocation(1,Me.RIGHT),r)&&a.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var o=r.next(),a=o.getLabel(),s=o.getDepth();if(!s.isNull()){s.normalize();for(var u=0;u<2;u++)!a.isNull(u)&&a.isArea()&&!s.isNull(u)&&(s.getDelta(u)===0?a.toLine(u):(nn.isTrue(!s.isNull(u,Me.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(u,Me.LEFT,s.getLocation(u,Me.LEFT)),nn.isTrue(!s.isNull(u,Me.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(u,Me.RIGHT,s.getLocation(u,Me.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next();a.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,o=this._graph.getNodes().iterator();o.hasNext();){var a=o.next(),s=a.getLabel();a.isIsolated()&&(s.isNull(0)?r.labelIncompleteNode(a,0):r.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(s)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(qx);Yt.overlayOp=function(e,t,n){var r=new Yt(e,t),o=r.getResultGeometry(n);return o};Yt.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return Yt.createEmptyResult(Yt.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return Iv.map(e,{interfaces_:function(){return[n_.MapOp]},map:function(r){return r.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Eu.overlayOp(e,t,Yt.INTERSECTION)};Yt.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return Yt.createEmptyResult(Yt.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Eu.overlayOp(e,t,Yt.SYMDIFFERENCE)};Yt.resultDimension=function(e,t,n){var r=t.getDimension(),o=n.getDimension(),a=-1;switch(e){case Yt.INTERSECTION:a=Math.min(r,o);break;case Yt.UNION:a=Math.max(r,o);break;case Yt.DIFFERENCE:a=r;break;case Yt.SYMDIFFERENCE:a=Math.max(r,o);break;default:}return a};Yt.createEmptyResult=function(e,t,n,r){var o=null;switch(Yt.resultDimension(e,t,n)){case-1:o=r.createGeometryCollection(new Array(0).fill(null));break;case 0:o=r.createPoint();break;case 1:o=r.createLineString();break;case 2:o=r.createPolygon();break;default:}return o};Yt.difference=function(e,t){return e.isEmpty()?Yt.createEmptyResult(Yt.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Eu.overlayOp(e,t,Yt.DIFFERENCE))};Yt.isResultOfOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=e.getLocation(0),r=e.getLocation(1);return Yt.isResultOfOp(n,r,t)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];switch(o===de.BOUNDARY&&(o=de.INTERIOR),a===de.BOUNDARY&&(a=de.INTERIOR),s){case Yt.INTERSECTION:return o===de.INTERIOR&&a===de.INTERIOR;case Yt.UNION:return o===de.INTERIOR||a===de.INTERIOR;case Yt.DIFFERENCE:return o===de.INTERIOR&&a!==de.INTERIOR;case Yt.SYMDIFFERENCE:return o===de.INTERIOR&&a!==de.INTERIOR||o!==de.INTERIOR&&a===de.INTERIOR;default:}return!1}};Yt.INTERSECTION=1;Yt.UNION=2;Yt.DIFFERENCE=3;Yt.SYMDIFFERENCE=4;var wg=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new xf,this._seg=new ft;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)};wg.prototype.isWithinToleranceOfBoundary=function(t){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var o=n._linework.getGeometryN(r),a=o.getCoordinateSequence(),s=0;s<a.size()-1;s++){a.getCoordinate(s,n._seg.p0),a.getCoordinate(s+1,n._seg.p1);var u=n._seg.distance(t);if(u<=n._boundaryDistanceTolerance)return!0}return!1};wg.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?de.BOUNDARY:this._ptLocator.locate(t,this._g)};wg.prototype.extractLinework=function(t){var n=new Wx;t.apply(n);var r=n.getLinework(),o=hn.toLineStringArray(r);return t.getFactory().createMultiLineString(o)};wg.prototype.interfaces_=function(){return[]};wg.prototype.getClass=function(){return wg};var Wx=function(){this._linework=null,this._linework=new Fe};Wx.prototype.getLinework=function(){return this._linework};Wx.prototype.filter=function(t){var n=this;if(t instanceof Da){var r=t;this._linework.add(r.getExteriorRing());for(var o=0;o<r.getNumInteriorRing();o++)n._linework.add(r.getInteriorRingN(o))}};Wx.prototype.interfaces_=function(){return[Dh]};Wx.prototype.getClass=function(){return Wx};var d_=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};d_.prototype.extractPoints=function(t,n,r){for(var o=this,a=t.getCoordinates(),s=0;s<a.length-1;s++)o.computeOffsetPoints(a[s],a[s+1],n,r)};d_.prototype.setSidesToGenerate=function(t,n){this._doLeft=t,this._doRight=n};d_.prototype.getPoints=function(t){for(var n=this,r=new Fe,o=_s.getLines(this._g),a=o.iterator();a.hasNext();){var s=a.next();n.extractPoints(s,t,r)}return r};d_.prototype.computeOffsetPoints=function(t,n,r,o){var a=n.x-t.x,s=n.y-t.y,u=Math.sqrt(a*a+s*s),l=r*a/u,c=r*s/u,f=(n.x+t.x)/2,h=(n.y+t.y)/2;if(this._doLeft){var d=new se(f-c,h+l);o.add(d)}if(this._doRight){var p=new se(f+c,h-l);o.add(p)}};d_.prototype.interfaces_=function(){return[]};d_.prototype.getClass=function(){return d_};var ic=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Fe;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,r],this._locFinder=[new wg(this._geom[0],this._boundaryDistanceTolerance),new wg(this._geom[1],this._boundaryDistanceTolerance),new wg(this._geom[2],this._boundaryDistanceTolerance)]},Lre={TOLERANCE:{configurable:!0}};ic.prototype.reportResult=function(t,n,r){xs.out.println("Overlay result invalid - A:"+de.toLocationSymbol(n[0])+" B:"+de.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+de.toLocationSymbol(n[2]))};ic.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(t);return n};ic.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var o=t._testCoords.get(r);if(!t.checkValid(n,o))return t._invalidLocation=o,!1}return!0}else if(arguments.length===2){var a=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),ic.hasLocation(this._location,de.BOUNDARY)?!0:this.isValidResult(a,this._location)}};ic.prototype.addTestPts=function(t){var n=new d_(t);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};ic.prototype.isValidResult=function(t,n){var r=Yt.isResultOfOp(n[0],n[1],t),o=n[2]===de.INTERIOR,a=!(r^o);return a||this.reportResult(t,n,r),a};ic.prototype.getInvalidLocation=function(){return this._invalidLocation};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};ic.hasLocation=function(t,n){for(var r=0;r<3;r++)if(t[r]===n)return!0;return!1};ic.computeBoundaryDistanceTolerance=function(t,n){return Math.min(Yo.computeSizeBasedSnapTolerance(t),Yo.computeSizeBasedSnapTolerance(n))};ic.isValid=function(t,n,r,o){var a=new ic(t,n,o);return a.isValid(r)};Lre.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(ic,Lre);var Zl=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};Zl.prototype.extractElements=function(t,n){var r=this;if(t===null)return null;for(var o=0;o<t.getNumGeometries();o++){var a=t.getGeometryN(o);r._skipEmpty&&a.isEmpty()||n.add(a)}};Zl.prototype.combine=function(){for(var t=this,n=new Fe,r=this._inputGeoms.iterator();r.hasNext();){var o=r.next();t.extractElements(o,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};Zl.prototype.interfaces_=function(){return[]};Zl.prototype.getClass=function(){return Zl};Zl.combine=function(){if(arguments.length===1){var t=arguments[0],n=new Zl(t);return n.combine()}else if(arguments.length===2){var r=arguments[0],o=arguments[1],a=new Zl(Zl.createList(r,o));return a.combine()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2],c=new Zl(Zl.createList(s,u,l));return c.combine()}};Zl.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};Zl.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Fe;return r.add(t),r.add(n),r}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Fe;return u.add(o),u.add(a),u.add(s),u}};var ua=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new Fe)},Rre={STRTREE_NODE_CAPACITY:{configurable:!0}};ua.prototype.reduceToGeometries=function(t){for(var n=this,r=new Fe,o=t.iterator();o.hasNext();){var a=o.next(),s=null;Lt(a,mf)?s=n.unionTree(a):a instanceof Dt&&(s=a),r.add(s)}return r};ua.prototype.extractByEnvelope=function(t,n,r){for(var o=new Fe,a=0;a<n.getNumGeometries();a++){var s=n.getGeometryN(a);s.getEnvelopeInternal().intersects(t)?o.add(s):r.add(s)}return this._geomFactory.buildGeometry(o)};ua.prototype.unionOptimized=function(t,n){var r=t.getEnvelopeInternal(),o=n.getEnvelopeInternal();if(!r.intersects(o)){var a=Zl.combine(t,n);return a}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var s=r.intersection(o);return this.unionUsingEnvelopeIntersection(t,n,s)};ua.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new yre(ua.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var o=t.itemsTree(),a=this.unionTree(o);return a};ua.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],o=arguments[2];if(o-r<=1){var a=ua.getGeometry(n,r);return this.unionSafe(a,null)}else{if(o-r===2)return this.unionSafe(ua.getGeometry(n,r),ua.getGeometry(n,r+1));var s=Math.trunc((o+r)/2),u=this.binaryUnion(n,r,s),l=this.binaryUnion(n,s,o);return this.unionSafe(u,l)}}};ua.prototype.repeatedUnion=function(t){for(var n=null,r=t.iterator();r.hasNext();){var o=r.next();n===null?n=o.copy():n=n.union(o)}return n};ua.prototype.unionSafe=function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)};ua.prototype.unionActual=function(t,n){return ua.restrictToPolygons(t.union(n))};ua.prototype.unionTree=function(t){var n=this.reduceToGeometries(t),r=this.binaryUnion(n);return r};ua.prototype.unionUsingEnvelopeIntersection=function(t,n,r){var o=new Fe,a=this.extractByEnvelope(r,t,o),s=this.extractByEnvelope(r,n,o),u=this.unionActual(a,s);o.add(u);var l=Zl.combine(o);return l};ua.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),r=n.buildGeometry(t),o=r.buffer(0);return o}else if(arguments.length===2){var a=arguments[0],s=arguments[1],u=a.getFactory(),l=u.createGeometryCollection([a,s]),c=l.buffer(0);return c}};ua.prototype.interfaces_=function(){return[]};ua.prototype.getClass=function(){return ua};ua.restrictToPolygons=function(t){if(Lt(t,Tg))return t;var n=Zp.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(hn.toPolygonArray(n))};ua.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)};ua.union=function(t){var n=new ua(t);return n.union()};Rre.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(ua,Rre);var IA=function(){};IA.prototype.interfaces_=function(){return[]};IA.prototype.getClass=function(){return IA};IA.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return Yt.createEmptyResult(Yt.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),Eu.overlayOp(t,n,Yt.UNION)};function MFe(e,t){var n=$l(e),r=$l(t),o=e.properties||{};if(n=bte(n),r=bte(r),!n)return null;if(!r)return la(n,o);var a=new tw,s=a.read(n),u=a.read(r),l=Yt.difference(s,u);if(l.isEmpty())return null;var c=new VA,f=c.write(l);return la(f,o)}function bte(e){switch(e.type){case"Polygon":return fA(e)>1?e:null;case"MultiPolygon":var t=[];if(ba(e,function(n){fA(n)>1&&t.push(n.geometry.coordinates)}),t.length)return{type:"MultiPolygon",coordinates:t}}}var g_=function(){return new HL};function HL(){this.reset()}HL.prototype={constructor:HL,reset:function(){this.s=this.t=0},add:function(e){Ite(yL,e,this.t),Ite(this,yL.s,this.s),this.s?this.t+=yL.t:this.s=yL.t},valueOf:function(){return this.s}};var yL=new HL;function Ite(e,t,n){var r=e.s=t+n,o=r-t,a=r-o;e.t=t-a+(n-o)}var Po=1e-6,Ii=Math.PI,bc=Ii/2,Dte=Ii/4,om=Ii*2,wh=180/Ii,Fs=Ii/180,_u=Math.abs,$4=Math.atan,DA=Math.atan2,ys=Math.cos,Ore=Math.exp,Nre=Math.log,Vs=Math.sin,CR=Math.sqrt,Bre=Math.tan;function LFe(e){return e>1?0:e<-1?Ii:Math.acos(e)}function PA(e){return e>1?bc:e<-1?-bc:Math.asin(e)}function rA(){}function qL(e,t){e&&Mte.hasOwnProperty(e.type)&&Mte[e.type](e,t)}var Pte={Feature:function(e,t){qL(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,o=n.length;++r<o;)qL(n[r].geometry,t)}},Mte={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){r4(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)r4(n[r],t,0)},Polygon:function(e,t){Lte(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,o=n.length;++r<o;)Lte(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,o=n.length;++r<o;)qL(n[r],t)}};function r4(e,t,n){var r=-1,o=e.length-n,a;for(t.lineStart();++r<o;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Lte(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)r4(e[n],t,1);t.polygonEnd()}var RFe=function(e,t){e&&Pte.hasOwnProperty(e.type)?Pte[e.type](e,t):qL(e,t)},t4t=g_(),n4t=g_();function i4(e){return[DA(e[1],e[0]),PA(e[2])]}function Yx(e){var t=e[0],n=e[1],r=ys(n);return[r*ys(t),r*Vs(t),Vs(n)]}function vL(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function WL(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function kz(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function CL(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function o4(e){var t=CR(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var r4t=g_(),Fre=function(e,t){function n(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,o){return r=t.invert(r,o),r&&e.invert(r[0],r[1])}),n};function a4(e,t){return[e>Ii?e-om:e<-Ii?e+om:e,t]}a4.invert=a4;function zre(e,t,n){return(e%=om)?t||n?Fre(Ote(e),Nte(t,n)):Ote(e):t||n?Nte(t,n):a4}function Rte(e){return function(t,n){return t+=e,[t>Ii?t-om:t<-Ii?t+om:t,n]}}function Ote(e){var t=Rte(e);return t.invert=Rte(-e),t}function Nte(e,t){var n=ys(e),r=Vs(e),o=ys(t),a=Vs(t);function s(u,l){var c=ys(l),f=ys(u)*c,h=Vs(u)*c,d=Vs(l),p=d*n+f*r;return[DA(h*o-p*a,f*n-d*r),PA(p*o+h*a)]}return s.invert=function(u,l){var c=ys(l),f=ys(u)*c,h=Vs(u)*c,d=Vs(l),p=d*o-h*a;return[DA(h*o+d*a,f*n+p*r),PA(p*n-f*r)]},s}var OFe=function(e){e=zre(e[0]*Fs,e[1]*Fs,e.length>2?e[2]*Fs:0);function t(n){return n=e(n[0]*Fs,n[1]*Fs),n[0]*=wh,n[1]*=wh,n}return t.invert=function(n){return n=e.invert(n[0]*Fs,n[1]*Fs),n[0]*=wh,n[1]*=wh,n},t};function NFe(e,t,n,r,o,a){if(!!n){var s=ys(t),u=Vs(t),l=r*n;o==null?(o=t+r*om,a=t-l/2):(o=Bte(s,o),a=Bte(s,a),(r>0?o<a:o>a)&&(o+=r*om));for(var c,f=o;r>0?f>a:f<a;f-=l)c=i4([s,-u*ys(f),-u*Vs(f)]),e.point(c[0],c[1])}}function Bte(e,t){t=Yx(t),t[0]-=e,o4(t);var n=LFe(-t[1]);return((-t[2]<0?-n:n)+om-Po)%om}var Vre=function(){var e=[],t;return{point:function(n,r){t.push([n,r])},lineStart:function(){e.push(t=[])},lineEnd:rA,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},BFe=function(e,t,n,r,o,a){var s=e[0],u=e[1],l=t[0],c=t[1],f=0,h=1,d=l-s,p=c-u,g;if(g=n-s,!(!d&&g>0)){if(g/=d,d<0){if(g<f)return;g<h&&(h=g)}else if(d>0){if(g>h)return;g>f&&(f=g)}if(g=o-s,!(!d&&g<0)){if(g/=d,d<0){if(g>h)return;g>f&&(f=g)}else if(d>0){if(g<f)return;g<h&&(h=g)}if(g=r-u,!(!p&&g>0)){if(g/=p,p<0){if(g<f)return;g<h&&(h=g)}else if(p>0){if(g>h)return;g>f&&(f=g)}if(g=a-u,!(!p&&g<0)){if(g/=p,p<0){if(g>h)return;g>f&&(f=g)}else if(p>0){if(g<f)return;g<h&&(h=g)}return f>0&&(e[0]=s+f*d,e[1]=u+f*p),h<1&&(t[0]=s+h*d,t[1]=u+h*p),!0}}}}},AL=function(e,t){return _u(e[0]-t[0])<Po&&_u(e[1]-t[1])<Po};function xL(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var kre=function(e,t,n,r,o){var a=[],s=[],u,l;if(e.forEach(function(g){if(!((y=g.length-1)<=0)){var y,v=g[0],w=g[y],C;if(AL(v,w)){for(o.lineStart(),u=0;u<y;++u)o.point((v=g[u])[0],v[1]);o.lineEnd();return}a.push(C=new xL(v,g,null,!0)),s.push(C.o=new xL(v,null,C,!1)),a.push(C=new xL(w,g,null,!1)),s.push(C.o=new xL(w,null,C,!0))}}),!!a.length){for(s.sort(t),Fte(a),Fte(s),u=0,l=s.length;u<l;++u)s[u].e=n=!n;for(var c=a[0],f,h;;){for(var d=c,p=!0;d.v;)if((d=d.n)===c)return;f=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(u=0,l=f.length;u<l;++u)o.point((h=f[u])[0],h[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(f=d.p.z,u=f.length-1;u>=0;--u)o.point((h=f[u])[0],h[1]);else r(d.x,d.p.x,-1,o);d=d.p}d=d.o,f=d.z,p=!p}while(!d.v);o.lineEnd()}}};function Fte(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],o;++n<t;)r.n=o=e[n],o.p=r,r=o;r.n=o=e[0],o.p=r}}var Gre=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},FFe=function(e){return e.length===1&&(e=zFe(e)),{left:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)<0?r=a+1:o=a}return r},right:function(t,n,r,o){for(r==null&&(r=0),o==null&&(o=t.length);r<o;){var a=r+o>>>1;e(t[a],n)>0?o=a:r=a+1}return r}}};function zFe(e){return function(t,n){return Gre(e(t),n)}}var i4t=FFe(Gre),Ure=function(e){for(var t=e.length,n,r=-1,o=0,a,s;++r<t;)o+=e[r].length;for(a=new Array(o);--t>=0;)for(s=e[t],n=s.length;--n>=0;)a[--o]=s[n];return a},iA=1e9,wL=-iA;function VFe(e,t,n,r){function o(c,f){return e<=c&&c<=n&&t<=f&&f<=r}function a(c,f,h,d){var p=0,g=0;if(c==null||(p=s(c,h))!==(g=s(f,h))||l(c,f)<0^h>0)do d.point(p===0||p===3?e:n,p>1?r:t);while((p=(p+h+4)%4)!==g);else d.point(f[0],f[1])}function s(c,f){return _u(c[0]-e)<Po?f>0?0:3:_u(c[0]-n)<Po?f>0?2:1:_u(c[1]-t)<Po?f>0?1:0:f>0?3:2}function u(c,f){return l(c.x,f.x)}function l(c,f){var h=s(c,1),d=s(f,1);return h!==d?h-d:h===0?f[1]-c[1]:h===1?c[0]-f[0]:h===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,h=Vre(),d,p,g,y,v,w,C,E,S,A,D,P={point:M,lineStart:b,lineEnd:L,polygonStart:O,polygonEnd:m};function M(N,B){o(N,B)&&f.point(N,B)}function I(){for(var N=0,B=0,G=p.length;B<G;++B)for(var F=p[B],k=1,Z=F.length,te=F[0],oe,ue,pe=te[0],me=te[1];k<Z;++k)oe=pe,ue=me,te=F[k],pe=te[0],me=te[1],ue<=r?me>r&&(pe-oe)*(r-ue)>(me-ue)*(e-oe)&&++N:me<=r&&(pe-oe)*(r-ue)<(me-ue)*(e-oe)&&--N;return N}function O(){f=h,d=[],p=[],D=!0}function m(){var N=I(),B=D&&N,G=(d=Ure(d)).length;(B||G)&&(c.polygonStart(),B&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),G&&kre(d,u,N,a,c),c.polygonEnd()),f=c,d=p=g=null}function b(){P.point=R,p&&p.push(g=[]),A=!0,S=!1,C=E=NaN}function L(){d&&(R(y,v),w&&S&&h.rejoin(),d.push(h.result())),P.point=M,S&&f.lineEnd()}function R(N,B){var G=o(N,B);if(p&&g.push([N,B]),A)y=N,v=B,w=G,A=!1,G&&(f.lineStart(),f.point(N,B));else if(G&&S)f.point(N,B);else{var F=[C=Math.max(wL,Math.min(iA,C)),E=Math.max(wL,Math.min(iA,E))],k=[N=Math.max(wL,Math.min(iA,N)),B=Math.max(wL,Math.min(iA,B))];BFe(F,k,e,t,n,r)?(S||(f.lineStart(),f.point(F[0],F[1])),f.point(k[0],k[1]),G||f.lineEnd(),D=!1):G&&(f.lineStart(),f.point(N,B),D=!1)}C=N,E=B,S=G}return P}}var Gz=g_(),kFe=function(e,t){var n=t[0],r=t[1],o=[Vs(n),-ys(n),0],a=0,s=0;Gz.reset();for(var u=0,l=e.length;u<l;++u)if(!!(f=(c=e[u]).length))for(var c,f,h=c[f-1],d=h[0],p=h[1]/2+Dte,g=Vs(p),y=ys(p),v=0;v<f;++v,d=C,g=S,y=A,h=w){var w=c[v],C=w[0],E=w[1]/2+Dte,S=Vs(E),A=ys(E),D=C-d,P=D>=0?1:-1,M=P*D,I=M>Ii,O=g*S;if(Gz.add(DA(O*P*Vs(M),y*A+O*ys(M))),a+=I?D+P*om:D,I^d>=n^C>=n){var m=WL(Yx(h),Yx(w));o4(m);var b=WL(o,m);o4(b);var L=(I^D>=0?-1:1)*PA(b[2]);(r>L||r===L&&(m[0]||m[1]))&&(s+=I^D>=0?1:-1)}}return(a<-Po||a<Po&&Gz<-Po)^s&1},o4t=g_(),zte=function(e){return e},a4t=g_(),s4t=g_(),Xx=1/0,YL=Xx,MA=-Xx,XL=MA,Vte={point:GFe,lineStart:rA,lineEnd:rA,polygonStart:rA,polygonEnd:rA,result:function(){var e=[[Xx,YL],[MA,XL]];return MA=XL=-(YL=Xx=1/0),e}};function GFe(e,t){e<Xx&&(Xx=e),e>MA&&(MA=e),t<YL&&(YL=t),t>XL&&(XL=t)}var u4t=g_(),Hre=function(e,t,n,r){return function(o,a){var s=t(a),u=o.invert(r[0],r[1]),l=Vre(),c=t(l),f=!1,h,d,p,g={point:y,lineStart:w,lineEnd:C,polygonStart:function(){g.point=E,g.lineStart=S,g.lineEnd=A,d=[],h=[]},polygonEnd:function(){g.point=y,g.lineStart=w,g.lineEnd=C,d=Ure(d);var D=kFe(h,u);d.length?(f||(a.polygonStart(),f=!0),kre(d,HFe,D,n,a)):D&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),d=h=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function y(D,P){var M=o(D,P);e(D=M[0],P=M[1])&&a.point(D,P)}function v(D,P){var M=o(D,P);s.point(M[0],M[1])}function w(){g.point=v,s.lineStart()}function C(){g.point=y,s.lineEnd()}function E(D,P){p.push([D,P]);var M=o(D,P);c.point(M[0],M[1])}function S(){c.lineStart(),p=[]}function A(){E(p[0][0],p[0][1]),c.lineEnd();var D=c.clean(),P=l.result(),M,I=P.length,O,m,b;if(p.pop(),h.push(p),p=null,!!I){if(D&1){if(m=P[0],(O=m.length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),M=0;M<O;++M)a.point((b=m[M])[0],b[1]);a.lineEnd()}return}I>1&&D&2&&P.push(P.pop().concat(P.shift())),d.push(P.filter(UFe))}}return g}};function UFe(e){return e.length>1}function HFe(e,t){return((e=e.x)[0]<0?e[1]-bc-Po:bc-e[1])-((t=t.x)[0]<0?t[1]-bc-Po:bc-t[1])}var kte=Hre(function(){return!0},qFe,YFe,[-Ii,-bc]);function qFe(e){var t=NaN,n=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(a,s){var u=a>0?Ii:-Ii,l=_u(a-t);_u(l-Ii)<Po?(e.point(t,n=(n+s)/2>0?bc:-bc),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),e.point(a,n),o=0):r!==u&&l>=Ii&&(_u(t-r)<Po&&(t-=r*Po),_u(a-u)<Po&&(a-=u*Po),n=WFe(t,n,a,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(u,n),o=0),e.point(t=a,n=s),r=u},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-o}}}function WFe(e,t,n,r){var o,a,s=Vs(e-n);return _u(s)>Po?$4((Vs(t)*(a=ys(r))*Vs(n)-Vs(r)*(o=ys(t))*Vs(e))/(o*a*s)):(t+r)/2}function YFe(e,t,n,r){var o;if(e==null)o=n*bc,r.point(-Ii,o),r.point(0,o),r.point(Ii,o),r.point(Ii,0),r.point(Ii,-o),r.point(0,-o),r.point(-Ii,-o),r.point(-Ii,0),r.point(-Ii,o);else if(_u(e[0]-t[0])>Po){var a=e[0]<t[0]?Ii:-Ii;o=n*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}var XFe=function(e,t){var n=ys(e),r=n>0,o=_u(n)>Po;function a(f,h,d,p){NFe(p,e,t,d,f,h)}function s(f,h){return ys(f)*ys(h)>n}function u(f){var h,d,p,g,y;return{lineStart:function(){g=p=!1,y=1},point:function(v,w){var C=[v,w],E,S=s(v,w),A=r?S?0:c(v,w):S?c(v+(v<0?Ii:-Ii),w):0;if(!h&&(g=p=S)&&f.lineStart(),S!==p&&(E=l(h,C),(!E||AL(h,E)||AL(C,E))&&(C[0]+=Po,C[1]+=Po,S=s(C[0],C[1]))),S!==p)y=0,S?(f.lineStart(),E=l(C,h),f.point(E[0],E[1])):(E=l(h,C),f.point(E[0],E[1]),f.lineEnd()),h=E;else if(o&&h&&r^S){var D;!(A&d)&&(D=l(C,h,!0))&&(y=0,r?(f.lineStart(),f.point(D[0][0],D[0][1]),f.point(D[1][0],D[1][1]),f.lineEnd()):(f.point(D[1][0],D[1][1]),f.lineEnd(),f.lineStart(),f.point(D[0][0],D[0][1])))}S&&(!h||!AL(h,C))&&f.point(C[0],C[1]),h=C,p=S,d=A},lineEnd:function(){p&&f.lineEnd(),h=null},clean:function(){return y|(g&&p)<<1}}}function l(f,h,d){var p=Yx(f),g=Yx(h),y=[1,0,0],v=WL(p,g),w=vL(v,v),C=v[0],E=w-C*C;if(!E)return!d&&f;var S=n*w/E,A=-n*C/E,D=WL(y,v),P=CL(y,S),M=CL(v,A);kz(P,M);var I=D,O=vL(P,I),m=vL(I,I),b=O*O-m*(vL(P,P)-1);if(!(b<0)){var L=CR(b),R=CL(I,(-O-L)/m);if(kz(R,P),R=i4(R),!d)return R;var N=f[0],B=h[0],G=f[1],F=h[1],k;B<N&&(k=N,N=B,B=k);var Z=B-N,te=_u(Z-Ii)<Po,oe=te||Z<Po;if(!te&&F<G&&(k=G,G=F,F=k),oe?te?G+F>0^R[1]<(_u(R[0]-N)<Po?G:F):G<=R[1]&&R[1]<=F:Z>Ii^(N<=R[0]&&R[0]<=B)){var ue=CL(I,(-O+L)/m);return kz(ue,P),[R,i4(ue)]}}}function c(f,h){var d=r?e:Ii-e,p=0;return f<-d?p|=1:f>d&&(p|=2),h<-d?p|=4:h>d&&(p|=8),p}return Hre(s,u,a,r?[0,-e]:[-Ii,e-Ii])};function qre(e){return function(t){var n=new s4;for(var r in e)n[r]=e[r];return n.stream=t,n}}function s4(){}s4.prototype={constructor:s4,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Wre(e,t,n){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),RFe(n,e.stream(Vte));var s=Vte.result(),u=Math.min(r/(s[1][0]-s[0][0]),o/(s[1][1]-s[0][1])),l=+t[0][0]+(r-u*(s[1][0]+s[0][0]))/2,c=+t[0][1]+(o-u*(s[1][1]+s[0][1]))/2;return a!=null&&e.clipExtent(a),e.scale(u*150).translate([l,c])}function jFe(e,t,n){return Wre(e,[[0,0],t],n)}var Gte=16,KFe=ys(30*Fs),Ute=function(e,t){return+t?QFe(e,t):ZFe(e)};function ZFe(e){return qre({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function QFe(e,t){function n(r,o,a,s,u,l,c,f,h,d,p,g,y,v){var w=c-r,C=f-o,E=w*w+C*C;if(E>4*t&&y--){var S=s+d,A=u+p,D=l+g,P=CR(S*S+A*A+D*D),M=PA(D/=P),I=_u(_u(D)-1)<Po||_u(a-h)<Po?(a+h)/2:DA(A,S),O=e(I,M),m=O[0],b=O[1],L=m-r,R=b-o,N=C*L-w*R;(N*N/E>t||_u((w*L+C*R)/E-.5)>.3||s*d+u*p+l*g<KFe)&&(n(r,o,a,s,u,l,m,b,I,S/=P,A/=P,D,y,v),v.point(m,b),n(m,b,I,S,A,D,c,f,h,d,p,g,y,v))}}return function(r){var o,a,s,u,l,c,f,h,d,p,g,y,v={point:w,lineStart:C,lineEnd:S,polygonStart:function(){r.polygonStart(),v.lineStart=A},polygonEnd:function(){r.polygonEnd(),v.lineStart=C}};function w(M,I){M=e(M,I),r.point(M[0],M[1])}function C(){h=NaN,v.point=E,r.lineStart()}function E(M,I){var O=Yx([M,I]),m=e(M,I);n(h,d,f,p,g,y,h=m[0],d=m[1],f=M,p=O[0],g=O[1],y=O[2],Gte,r),r.point(h,d)}function S(){v.point=w,r.lineEnd()}function A(){C(),v.point=D,v.lineEnd=P}function D(M,I){E(o=M,I),a=h,s=d,u=p,l=g,c=y,v.point=E}function P(){n(h,d,f,p,g,y,a,s,o,u,l,c,Gte,r),v.lineEnd=S,S()}return v}}var JFe=qre({point:function(e,t){this.stream.point(e*Fs,t*Fs)}});function $Fe(e){return eze(function(){return e})()}function eze(e){var t,n=150,r=480,o=250,a,s,u=0,l=0,c=0,f=0,h=0,d,p,g=null,y=kte,v=null,w,C,E,S=zte,A=.5,D=Ute(m,A),P,M;function I(R){return R=p(R[0]*Fs,R[1]*Fs),[R[0]*n+a,s-R[1]*n]}function O(R){return R=p.invert((R[0]-a)/n,(s-R[1])/n),R&&[R[0]*wh,R[1]*wh]}function m(R,N){return R=t(R,N),[R[0]*n+a,s-R[1]*n]}I.stream=function(R){return P&&M===R?P:P=JFe(y(d,D(S(M=R))))},I.clipAngle=function(R){return arguments.length?(y=+R?XFe(g=R*Fs,6*Fs):(g=null,kte),L()):g*wh},I.clipExtent=function(R){return arguments.length?(S=R==null?(v=w=C=E=null,zte):VFe(v=+R[0][0],w=+R[0][1],C=+R[1][0],E=+R[1][1]),L()):v==null?null:[[v,w],[C,E]]},I.scale=function(R){return arguments.length?(n=+R,b()):n},I.translate=function(R){return arguments.length?(r=+R[0],o=+R[1],b()):[r,o]},I.center=function(R){return arguments.length?(u=R[0]%360*Fs,l=R[1]%360*Fs,b()):[u*wh,l*wh]},I.rotate=function(R){return arguments.length?(c=R[0]%360*Fs,f=R[1]%360*Fs,h=R.length>2?R[2]%360*Fs:0,b()):[c*wh,f*wh,h*wh]},I.precision=function(R){return arguments.length?(D=Ute(m,A=R*R),L()):CR(A)},I.fitExtent=function(R,N){return Wre(I,R,N)},I.fitSize=function(R,N){return jFe(I,R,N)};function b(){p=Fre(d=zre(c,f,h),t);var R=t(u,l);return a=r-R[0]*n,s=o+R[1]*n,L()}function L(){return P=M=null,I}return function(){return t=e.apply(this,arguments),I.invert=t.invert&&O,b()}}function Yre(e,t){return[e,Nre(Bre((bc+t)/2))]}Yre.invert=function(e,t){return[e,2*$4(Ore(t))-bc]};function tze(e){var t=$Fe(e),n=t.center,r=t.scale,o=t.translate,a=t.clipExtent,s=null,u,l,c;t.scale=function(h){return arguments.length?(r(h),f()):r()},t.translate=function(h){return arguments.length?(o(h),f()):o()},t.center=function(h){return arguments.length?(n(h),f()):n()},t.clipExtent=function(h){return arguments.length?(h==null?s=u=l=c=null:(s=+h[0][0],u=+h[0][1],l=+h[1][0],c=+h[1][1]),f()):s==null?null:[[s,u],[l,c]]};function f(){var h=Ii*r(),d=t(OFe(t.rotate()).invert([0,0]));return a(s==null?[[d[0]-h,d[1]-h],[d[0]+h,d[1]+h]]:e===Yre?[[Math.max(d[0]-h,s),u],[Math.min(d[0]+h,l),c]]:[[s,Math.max(d[1]-h,u)],[l,Math.min(d[1]+h,c)]])}return f()}function Xre(e,t){return[Nre(Bre((bc+t)/2)),-e]}Xre.invert=function(e,t){return[-t,2*$4(Ore(e))-bc]};var nze=function(){var e=tze(Xre),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)};function rze(e,t,n){n=n||{};var r=n.units,o=n.steps||64;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof o!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(o<=0)throw new Error("steps must be greater than 0");o=o||64,r=r||"kilometers";var a=[];switch(e.type){case"GeometryCollection":return Fh(e,function(s){var u=bL(s,t,r,o);u&&a.push(u)}),Ft(a);case"FeatureCollection":return di(e,function(s){var u=bL(s,t,r,o);u&&di(u,function(l){l&&a.push(l)})}),Ft(a)}return bL(e,t,r,o)}function bL(e,t,n,r){var o=e.properties||{},a=e.type==="Feature"?e.geometry:e;if(a.type==="GeometryCollection"){var s=[];return Fh(e,function(v){var w=bL(v,t,n,r);w&&s.push(w)}),Ft(s)}var u,l=Ia(e),c=l[1]>50&&l[3]>50;c?u={type:a.type,coordinates:Kre(a.coordinates,Hte(a))}:u=e_(a);var f=new tw,h=f.read(u),d=Sx(mv(t,n),"meters"),p=vs.bufferOp(h,d),g=new VA;if(p=g.write(p),!jre(p.coordinates)){var y;return c?y={type:p.type,coordinates:Zre(p.coordinates,Hte(a))}:y=rR(p),y.geometry?y:la(y,o)}}function jre(e){return Array.isArray(e[0])?jre(e[0]):isNaN(e[0])}function Kre(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return Kre(n,t)})}function Zre(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return Zre(n,t)})}function Hte(e){var t=eR(e).geometry.coordinates.reverse(),n=t.map(function(r){return-r});return nze().center(t).rotate(n).scale(gs)}function eV(){for(var e=new tw,t=e.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)t=IA.union(t,e.read(JSON.stringify(arguments[n].geometry)));var r=new VA;return t=r.write(t),{type:"Feature",geometry:t,properties:arguments[0].properties}}function jx(e,t){var n=$l(e),r=$l(t);if(Eg(vx(r,{precision:4})).coordinates[0].length<4||Eg(vx(n,{precision:4})).coordinates[0].length<4)return null;var o=new tw,a=o.read(vx(n)),s=o.read(vx(r)),u=Yt.intersection(a,s);if(u.isEmpty())return null;var l=new VA,c=l.write(u);return la(c)}/**
 * @license get-closest https://github.com/cosmosio/get-closest
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2017 Olivier Scherrer <pode.fr@gmail.com>
 */function ize(e,t,n){var r,o;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(a,s){var u=n(a,e);u>=0&&(typeof o>"u"||u<o)&&(o=u,r=s)}),r}function oze(e,t){return ize(e,t,function(n,r){return n-r})}function aze(e,t){if(t=t||{},!gt(t))throw new Error("options is invalid");var n=t.propertyName;Ud(e,"Polygon","dissolve");var r=vu(e),o=r.features,a=[];o.forEach(function(f,h){f.properties.origIndexPosition=h});var s=LA();s.load(r);for(var u in o){var l=o[u],c=!1;if(s.search(l).features.forEach(function(f){l=o[u];var h=f.properties.origIndexPosition;if(a.length>0&&h!==0)if(h>a[a.length-1])h=h-a.length;else{var d=oze(h,a);d!==0&&(h=h-d)}if(h!==+u){var p=o[h];!p||!l||n!==void 0&&p.properties[n]!==l.properties[n]||!Wne(l,p)||!sze(l,p)||(o[u]=eV(l,p),a.push(f.properties.origIndexPosition),a.sort(function(g,y){return g-y}),s.remove(f),o.splice(h,1),l.properties.origIndexPosition=u,s.remove(l,function(g,y){return g.properties.origIndexPosition===y.properties.origIndexPosition}),c=!0)}}),c){if(!l)continue;l.properties.origIndexPosition=u,s.insert(l),u--}}return o.forEach(function(f){delete f.properties.origIndexPosition,delete f.bbox}),r}function sze(e,t){var n=Bi(Qp(e)),r=Bi(Qp(t)),o=Og(n,r).features;return o.length>0}function Qre(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties||{},o=n.triangles,a=n.mask;if(t==null)throw new Error("cellSide is required");if(!hi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(a&&["Polygon","MultiPolygon"].indexOf(Fi(a))===-1)throw new Error("options.mask must be a (Multi)Polygon");var s=e[0],u=e[1],l=e[2],c=e[3],f=(u+c)/2,h=(s+l)/2,d=t*2/fi([s,f],[l,f],n),p=d*(l-s),g=t*2/fi([h,u],[h,c],n),y=g*(c-u),v=p/2,w=v*2,C=Math.sqrt(3)/2*y,E=l-s,S=c-u,A=3/4*w,D=C,P=(E-w)/(w-v/2),M=Math.floor(P),I=(M*A-v/2-E)/2-v/2+A/2,O=Math.floor((S-C)/C),m=(S-O*C)/2,b=O*C-S>C/2;b&&(m-=C/4);for(var L=[],R=[],N=0;N<6;N++){var B=2*Math.PI/6*N;L.push(Math.cos(B)),R.push(Math.sin(B))}for(var G=[],F=0;F<=M;F++)for(var k=0;k<=O;k++){var Z=F%2===1;if(!(k===0&&Z)&&!(k===0&&b)){var te=F*A+s-I,oe=k*D+u+m;if(Z&&(oe-=C/2),o===!0)lze([te,oe],p/2,y/2,r,L,R).forEach(function(pe){a?jx(a,pe)&&G.push(pe):G.push(pe)});else{var ue=uze([te,oe],p/2,y/2,r,L,R);a?jx(a,ue)&&G.push(ue):G.push(ue)}}}return Ft(G)}function uze(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=e[0]+t*o[u],c=e[1]+n*a[u];s.push([l,c])}return s.push(s[0].slice()),rr([s],r)}function lze(e,t,n,r,o,a){for(var s=[],u=0;u<6;u++){var l=[];l.push(e),l.push([e[0]+t*o[u],e[1]+n*a[u]]),l.push([e[0]+t*o[(u+1)%6],e[1]+n*a[(u+1)%6]]),l.push(e),s.push(rr([l],r))}return s}function cze(e,t){var n=dze(t),r=hze(e),o=r[0],a=r[1];o=qte(o),a=qte(a);var s=fze(n,o,a);return s}function fze(e,t,n){var r=[];return r.push(e.geometry.coordinates[0]),ba(t,function(o){r.push(o.geometry.coordinates[0])}),ba(n,function(o){r.push(o.geometry.coordinates[0])}),rr(r)}function hze(e){var t=[],n=[];return ba(e,function(r){var o=r.geometry.coordinates,a=o[0],s=o.slice(1);t.push(rr([a])),s.forEach(function(u){n.push(rr([u]))})}),[Ft(t),Ft(n)]}function dze(e){var t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],n=e&&e.geometry.coordinates||t;return rr(n)}function qte(e){if(e.features.length<=1)return e;var t=pze(e),n=[],r={};return ba(e,function(o,a){if(r[a])return!0;for(t.remove({index:a},Wte),r[a]=!0;;){var s=Ia(o),u=t.search({minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]});if(u.length>0){var l=u.map(function(c){return r[c.index]=!0,t.remove({index:c.index},Wte),c.geojson});l.push(o),o=eV.apply(this,l)}if(u.length===0)break}n.push(o)}),Ft(n)}function Wte(e,t){return e.index===t.index}function pze(e){var t=Ax(),n=[];return ba(e,function(r,o){var a=Ia(r);n.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],geojson:r,index:o})}),t.load(n),t}function Jre(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!hi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Fi(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=e[0],u=e[1],l=e[2],c=e[3],f=t/fi([s,u],[l,u],n),h=f*(l-s),d=t/fi([s,u],[s,c],n),p=d*(c-u),g=l-s,y=c-u,v=Math.floor(g/h),w=Math.floor(y/p),C=(g-v*h)/2,E=(y-w*p)/2,S=s+C,A=0;A<v;A++){for(var D=u+E,P=0;P<w;P++){var M=rr([[[S,D],[S,D+p],[S+h,D+p],[S+h,D],[S,D]]],r);o?jx(o,M)&&a.push(M):a.push(M),D+=p}S+=h}return Ft(a)}function $re(e,t,n){if(n=n||{},!gt(n))throw new Error("options is invalid");var r=n.properties,o=n.mask,a=[];if(t==null)throw new Error("cellSide is required");if(!hi(t))throw new Error("cellSide is invalid");if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be array");if(e.length!==4)throw new Error("bbox must contain 4 numbers");if(o&&["Polygon","MultiPolygon"].indexOf(Fi(o))===-1)throw new Error("options.mask must be a (Multi)Polygon");for(var s=t/fi([e[0],e[1]],[e[2],e[1]],n),u=s*(e[2]-e[0]),l=t/fi([e[0],e[1]],[e[0],e[3]],n),c=l*(e[3]-e[1]),f=0,h=e[0];h<=e[2];){for(var d=0,p=e[1];p<=e[3];){var g=null,y=null;f%2===0&&d%2===0?(g=rr([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=rr([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)):f%2===0&&d%2===1?(g=rr([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r),y=rr([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r)):d%2===0&&f%2===1?(g=rr([[[h,p],[h,p+c],[h+u,p+c],[h,p]]],r),y=rr([[[h,p],[h+u,p+c],[h+u,p],[h,p]]],r)):d%2===1&&f%2===1&&(g=rr([[[h,p],[h,p+c],[h+u,p],[h,p]]],r),y=rr([[[h,p+c],[h+u,p+c],[h+u,p],[h,p+c]]],r)),o?(jx(o,g)&&a.push(g),jx(o,y)&&a.push(y)):(a.push(g),a.push(y)),p+=c,d++}f++,h+=u}return Ft(a)}function mze(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.gridType,o=n.property,a=n.weight;if(!e)throw new Error("points is required");if(Ud(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(a!==void 0&&typeof a!="number")throw new Error("weight must be a number");o=o||"elevation",r=r||"square",a=a||1;var s=Ia(e),u;switch(r){case"point":case"points":u=Lne(s,t,n);break;case"square":case"squares":u=Jre(s,t,n);break;case"hex":case"hexes":u=Qre(s,t,n);break;case"triangle":case"triangles":u=$re(s,t,n);break;default:throw new Error("invalid gridType")}var l=[];return di(u,function(c){var f=0,h=0;di(e,function(p){var g=r==="point"?c:_v(c),y=fi(g,p,n),v;if(o!==void 0&&(v=p.properties[o]),v===void 0&&(v=p.geometry.coordinates[2]),v===void 0)throw new Error("zValue is missing");y===0&&(f=v);var w=1/Math.pow(y,a);h+=w,f+=w*v});var d=vu(c);d.properties[o]=f/h,l.push(d)}),Ft(l)}var rw={projection:n2e,random:fFe,clusters:hFe,helpers:YRe,invariant:jRe,meta:XRe,isolines:nOe,convex:lne,pointsWithinPolygon:Uz,concave:cNe,collect:hNe,flip:dNe,simplify:CNe,bezierSpline:Eee,tag:ENe,sample:TNe,envelope:_ne,square:yne,circle:v4,midpoint:bNe,center:eR,centerOfMass:vne,centroid:_v,combine:INe,distance:fi,explode:C4,bbox:Ia,tesselate:qNe,bboxPolygon:y4,booleanPointInPolygon:xo,nearestPoint:Kz,nearestPointOnLine:vg,nearestPointToLine:a2e,planepoint:u2e,tin:cne,bearing:Kp,destination:Jp,kinks:l2e,pointOnFeature:Oee,area:fA,along:h2e,length:Zz,lineSlice:d2e,lineSliceAlong:Ine,pointGrid:Lne,truncate:vx,flatten:T2e,lineIntersect:Og,lineChunk:S2e,unkinkPolygon:L2e,greatCircle:R2e,lineSegment:yv,lineSplit:O2e,lineArc:Nne,polygonToLine:LL,lineToPolygon:Yee,bboxClip:F2e,lineOverlap:Fne,sector:k2e,rhumbBearing:$0,rhumbDistance:nR,rhumbDestination:bx,polygonTangents:U2e,rewind:W2e,isobands:O3e,transformRotate:zne,transformScale:Vne,transformTranslate:U3e,lineOffset:K3e,polygonize:eBe,booleanDisjoint:tBe,booleanContains:sBe,booleanCrosses:gBe,booleanClockwise:OL,booleanOverlap:Wne,booleanPointOnLine:Ac,booleanEqual:CBe,booleanWithin:Dne,clone:vu,cleanCoords:Eg,clustersDbscan:TBe,clustersKmeans:LBe,pointToLineDistance:Ane,booleanParallel:RBe,shortestPath:BBe,voronoi:iFe,ellipse:$ne,centerMean:N4,centerMedian:oFe,standardDeviationalEllipse:aFe,difference:MFe,buffer:rze,union:eV,intersect:jx,dissolve:aze,hexGrid:Qre,mask:cze,squareGrid:Jre,triangleGrid:$re,interpolate:mze,pointOnSurface:Oee,polygonToLineString:LL,lineStringToPolygon:Yee,inside:xo,within:Uz,bezier:Eee,nearest:Kz,pointOnLine:vg,lineDistance:Zz,radians2degrees:r_,degrees2radians:Za,distanceToDegrees:DL,distanceToRadians:mv,radiansToDistance:Sx,bearingToAngle:J0,convertDistance:gv,toMercator:e_,toWgs84:rR,randomPosition:OA,randomPoint:tre,randomPolygon:nre,randomLineString:rre,getCluster:ore,clusterEach:B4,clusterReduce:are,createBins:F4,applyFilter:sR,propertiesContainsFilter:z4,filterProperties:sre,earthRadius:gs,factors:jL,unitsFactors:Yte,areaFactors:IL,feature:la,geometry:Xte,point:Wr,points:jte,polygon:rr,polygons:Kte,lineString:Bi,lineStrings:Zte,featureCollection:Ft,multiLineString:p_,multiPoint:KL,multiPolygon:Kx,geometryCollection:u4,round:Qte,radiansToLength:Sx,lengthToRadians:mv,lengthToDegrees:DL,bearingToAzimuth:J0,radiansToDegrees:r_,degreesToRadians:Za,convertLength:gv,convertArea:Jte,isNumber:hi,isObject:gt,validateBBox:Zx,validateId:ZL,getCoord:co,getCoords:Et,containsNumber:JL,geojsonType:tne,featureOf:oA,collectionOf:Ud,getGeom:$l,getGeomType:nne,getType:Fi,coordEach:Qa,coordReduce:QL,propEach:l4,propReduce:$te,featureEach:di,featureReduce:c4,coordAll:Qp,geomEach:Fh,geomReduce:f4,flattenEach:ba,flattenReduce:ene,segmentEach:yg,segmentReduce:h4,lineEach:d4,lineReduce:p4};function HA(e){this.mtManager=e.mtManager,this.viewer=e.viewer,this.mtArray=[],this.handler=new Cesium.ScreenSpaceEventHandler,this.drawPrimitives=new dC({viewer:this.viewer}),this.index=1}HA.prototype.getByCircle=function(e,u){var n=!1,r=!0;this.mtArray=[];var o=[],a=this,s=this.index++,u=Cesium.defaultValue(u,1e4);this.handler.setInputAction(function(l){if(r){var c=a.viewer.scene.pickPosition(l.position);if(o.length<1&&(n=!0,o.push(c)),o.length==2){n=!1,r=!1,o[1]=c;for(var f=Cesium.Cartesian3.distance(o[0],o[1]),h=a.mtManager.curTimeMovingTargets,d=0;d<h.length;d++){var p=h[d],g=Cesium.Cartesian3.distance(o[0],p.position);g<=f&&a.mtArray.push(p)}e&&e(a.mtArray),Bv(a,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Bv(a,Cesium.ScreenSpaceEventType.LEFT_CLICK)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(l){if(n){var c=a.viewer.scene.pickPosition(l.endPosition);o[1]=c,a.drawPrimitives.drawCircle({positions:o,id:s,height:u})}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};HA.prototype.getByRectangle=function(e,u){var n=void 0,r=!0;this.mtArray=[];var o=this.index++,a=[],s=this,u=Cesium.defaultValue(u,1e4);this.handler.setInputAction(function(l){if(r){var c=s.viewer.scene.pickPosition(l.position);a.length<1&&(n=!0,a.push(c)),a.length==2&&(n=!1,r=!1,a[1]=c,s.mtArray=eie(s,o),e&&e(s.mtArray),Bv(s,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Bv(s,Cesium.ScreenSpaceEventType.LEFT_CLICK))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(l){if(n){var c=s.viewer.scene.pickPosition(l.endPosition);a[1]=c,s.drawPrimitives.drawRectangle({positions:a,id:o,height:u})}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)};HA.prototype.getByPolygon=function(e,l){var n=!0,r=!0;this.mtArray=[];var o=this.index++,a=[],s=this,u=5,l=Cesium.defaultValue(l,1e4);this.handler.setInputAction(function(c){if(n){var f=s.viewer.scene.pickPosition(c.position);_(f)&&(a.push(f),a.length==3&&s.drawPrimitives.drawPolygon({positions:a,id:o,height:l}))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(c){var f=s.viewer.scene.pickPosition(c.position);f&&r&&(n=!1,r=!1,a.push(f),s.mtArray=eie(s,o),e&&e(s.mtArray),Bv(s,Cesium.ScreenSpaceEventType.MOUSE_MOVE),Bv(s,Cesium.ScreenSpaceEventType.LEFT_CLICK),Bv(s,Cesium.ScreenSpaceEventType.RIGHT_CLICK))},Cesium.ScreenSpaceEventType.RIGHT_CLICK)};HA.prototype.removeAllEntity=function(){this.drawPrimitives._draw.removeAllEntity()};function Bv(e,t){e.handler.getInputAction(t)&&e.handler.removeInputAction(t)}function tV(e){var t=[],n=Cesium.Ellipsoid.WGS84,r=n.cartesianToCartographic(e),o=Cesium.Math.toDegrees(r.latitude),a=Cesium.Math.toDegrees(r.longitude),s=r.height;return t.push(a),t.push(o),t.push(s),t}function eie(e,t){for(var n=e.mtManager.curTimeMovingTargets,r=e.viewer.entities.getById(t),o=r._polygon.hierarchy.getValue(Cesium.JulianDate.fromDate(new Date)),a=[],s=0;s<o.positions.length;s++){var u=tV(o.positions[s]);a.push([u[0],u[1]])}u=tV(o.positions[0]),a.push([u[0],u[1]]);for(var l=rw.polygon([a]),s=0;s<n.length;s++){var c=n[s],u=tV(c.position),f=rw.point([u[0],u[1]]);rw.booleanPointInPolygon(f,l)&&e.mtArray.push(c)}return e.mtArray}var tie=HA;function nV(e){e=T(e,1),this._radius=T(e,1)}Object.defineProperties(nV.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}});nV.prototype.emit=function(e){let t=z.randomBetween(0,z.TWO_PI),n=z.randomBetween(0,this._radius),r=n*Math.cos(t),o=n*Math.sin(t),a=0;e.position=x.fromElements(r,o,a,e.position),e.velocity=x.clone(x.UNIT_Z,e.velocity)};var nie=nV;var gze=new X(1,1);function rV(e){e=T(e,T.EMPTY_OBJECT),this.mass=T(e.mass,1),this.position=x.clone(T(e.position,x.ZERO)),this.velocity=x.clone(T(e.velocity,x.ZERO)),this.life=T(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=K.clone(T(e.startColor,K.WHITE)),this.endColor=K.clone(T(e.endColor,K.WHITE)),this.startScale=T(e.startScale,1),this.endScale=T(e.endScale,1),this.imageSize=X.clone(T(e.imageSize,gze)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(rV.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var rie=new x;rV.prototype.update=function(e,t){return x.multiplyByScalar(this.velocity,e,rie),x.add(this.position,rie,this.position),_(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var iV=rV;var iie=new X(1,1);function qA(e){e=T(e,T.EMPTY_OBJECT),this.show=T(e.show,!0),this.updateCallback=e.updateCallback,this.loop=T(e.loop,!0),this.image=T(e.image,void 0);let t=e.emitter;_(t)||(t=new nie(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=U.clone(T(e.modelMatrix,U.IDENTITY)),this._emitterModelMatrix=U.clone(T(e.emitterModelMatrix,U.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new U,this._startColor=K.clone(T(e.color,T(e.startColor,K.WHITE))),this._endColor=K.clone(T(e.color,T(e.endColor,K.WHITE))),this._startScale=T(e.scale,T(e.startScale,1)),this._endScale=T(e.scale,T(e.endScale,1)),this._emissionRate=T(e.emissionRate,5),this._minimumSpeed=T(e.speed,T(e.minimumSpeed,1)),this._maximumSpeed=T(e.speed,T(e.maximumSpeed,1)),this._minimumParticleLife=T(e.particleLife,T(e.minimumParticleLife,5)),this._maximumParticleLife=T(e.particleLife,T(e.maximumParticleLife,5)),this._minimumMass=T(e.mass,T(e.minimumMass,1)),this._maximumMass=T(e.mass,T(e.maximumMass,1)),this._minimumImageSize=X.clone(T(e.imageSize,T(e.minimumImageSize,iie))),this._maximumImageSize=X.clone(T(e.imageSize,T(e.maximumImageSize,iie))),this._sizeInMeters=T(e.sizeInMeters,!1),this._lifetime=T(e.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new xe,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}Object.defineProperties(qA.prototype,{emitter:{get:function(){return this._emitter},set:function(e){this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!U.equals(this._modelMatrix,e),U.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!U.equals(this._emitterModelMatrix,e),U.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){K.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){K.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});function _ze(e){let t=e._emissionRate,n=e._maximumParticleLife,r=0,o=e._bursts;if(_(o)){let h=o.length;for(let d=0;d<h;++d)r+=o[d].maximum}let a=e._billboardCollection,s=e.image,u=Math.ceil(t*n+r),l=e._particles,c=e._particlePool,f=Math.max(u-l.length-c.length,0);for(let h=0;h<f;++h){let d=new iV;d._billboard=a.add({image:s}),c.push(d)}e._particleEstimate=u}function yze(e){let t=e._particlePool.pop();return _(t)||(t=new iV),t}function vze(e,t){e._particlePool.push(t)}function Cze(e){let t=e._particles,n=e._particlePool,r=e._billboardCollection,o=t.length,a=n.length,s=e._particleEstimate,u=a-Math.max(s-o-a,0);for(let l=u;l<a;++l){let c=n[l];r.remove(c._billboard)}n.length=u}function xze(e){_(e._billboard)&&(e._billboard.show=!1)}function oie(e,t){let n=t._billboard;_(n)||(n=t._billboard=e._billboardCollection.add({image:t.image})),n.width=t.imageSize.x,n.height=t.imageSize.y,n.position=t.position,n.sizeInMeters=e.sizeInMeters,n.show=!0;let r=z.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),o=z.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),a=z.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),s=z.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);n.color=new K(r,o,a,s),n.scale=z.lerp(t.startScale,t.endScale,t.normalizedAge)}function wze(e,t){t.startColor=K.clone(e._startColor,t.startColor),t.endColor=K.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=z.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=z.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=z.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=z.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;let n=z.randomBetween(e._minimumSpeed,e._maximumSpeed);x.multiplyByScalar(t.velocity,n,t.velocity),e._particles.push(t)}function Eze(e,t){if(e._isComplete)return 0;t=z.mod(t,e._lifetime);let n=t*e._emissionRate,r=Math.floor(n);if(e._carryOver+=n-r,e._carryOver>1&&(r++,e._carryOver-=1),_(e.bursts)){let o=e.bursts.length;for(let a=0;a<o;a++){let s=e.bursts[a],u=e._currentTime;_(s)&&!s._complete&&u>s.time&&(r+=z.randomBetween(s.minimum,s.maximum),s._complete=!0)}}return r}var xR=new x;qA.prototype.update=function(e){if(!this.show)return;_(this._billboardCollection)||(this._billboardCollection=new tg),this._updateParticlePool&&(_ze(this),this._updateParticlePool=!1);let t=0;this._previousTime&&(t=fe.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);let n=this._particles,r=this._emitter,o=this.updateCallback,a,s,u=n.length;for(a=0;a<u;++a)s=n[a],s.update(t,o)?oie(this,s):(xze(s),vze(this,s),n[a]=n[u-1],--a,--u);n.length=u;let l=Eze(this,t);if(l>0&&_(r)){this._matrixDirty&&(this._combinedMatrix=U.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);let c=this._combinedMatrix;for(a=0;a<l;a++)s=yze(this),this._emitter.emit(s),x.add(s.position,s.velocity,xR),U.multiplyByPoint(c,xR,xR),s.position=U.multiplyByPoint(c,s.position,s.position),x.subtract(xR,s.position,s.velocity),x.normalize(s.velocity,s.velocity),wze(this,s),oie(this,s)}if(this._billboardCollection.update(e),this._previousTime=fe.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=z.mod(this._currentTime,this._lifetime),this.bursts){let c=this.bursts.length;for(a=0;a<c;a++)this.bursts[a]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120===0&&Cze(this)};qA.prototype.isDestroyed=function(){return!1};qA.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),ot(this)};var aie=qA;function sie(e){e=T(e,T.EMPTY_OBJECT),this.time=T(e.time,0),this.minimum=T(e.minimum,0),this.maximum=T(e.maximum,50),this._complete=!1}Object.defineProperties(sie.prototype,{complete:{get:function(){return this._complete}}});var uie=sie;var Tze=z.toRadians(30);function oV(e){this._angle=T(e,Tze)}Object.defineProperties(oV.prototype,{angle:{get:function(){return this._angle},set:function(e){this._angle=e}}});oV.prototype.emit=function(e){let t=Math.tan(this._angle),n=z.randomBetween(0,z.TWO_PI),r=z.randomBetween(0,t),o=r*Math.cos(n),a=r*Math.sin(n),s=1;e.velocity=x.fromElements(o,a,s,e.velocity),x.normalize(e.velocity,e.velocity),e.position=x.clone(x.ZERO,e.position)};var lie=oV;function Sze(e,t){this.viewer=e,this.dataMgr=t.dataMgr,this.mtMgr=t.mtMgr,this.trainingClock=t.trainingClock,this.dataMgr.addReceiveDataListener("addDrop",l);let n=[],r=this,o=r.viewer.scene,a=0,s;function u(){if(!_(s)){s=document.createElement("canvas"),s.width=20,s.height=20;let f=s.getContext("2d");f.beginPath(),f.arc(8,8,8,0,Math.TWO_PI,!0),f.closePath(),f.fillStyle="rgb(255,174,3)",f.fill()}return s}setInterval(function(){let f=r.trainingClock.tick(),h=fe.toDate(f).getTime(),d=r.trainingClock.multiplier,p=2.5-d;if(p<.5&&(p=.5),h-a!==1e3&&c(n,h),n.length!==0)for(let y=0;y<n.length;y++){let v=n[y].info;if(n[y].status===!0&&v.header.datTime<=h-1e3){let w=r.mtMgr.ev_MTFlightDatas.get(v.header.sID);if(w!==void 0&&w.curTimeAttitude!==void 0&&w.curTimeAttitude.position!==void 0){let C=new yn.eastNorthUpToFixedFrame(w.curTimeAttitude.position),E=new x(0,0,0),S=new X(1,1),A=new U,D=[new uie({time:p,minimum:25,maximum:25},{time:50,minimum:25,maximum:25})];g(D,A,C,E,S,w)}n[y].status=!1}}function g(y,v,w,C,E,S){let A=ne.fromHeadingPitchRoll(new Fc(Math.toRadians(-S.curTimeAttitude.headingPitchRoll.roll),Math.PI/2+Math.toRadians(S.curTimeAttitude.headingPitchRoll.heading),Math.PI/2+Math.toRadians(-S.curTimeAttitude.headingPitchRoll.pitch))),D=U.fromRotationTranslation(A,C,v);function P(I,O){let m=I.position,b=x.normalize(m,new x);x.multiplyByScalar(b,O,b),I.velocity=x.add(I.velocity,b,I.velocity)}let M=new aie({image:u(),startScale:10,endColor:K.WHITE.withAlpha(0),particleLife:5,speed:900,imageSize:E,emissionRate:0,emitter:new lie(Math.toRadians(30)),bursts:y,lifetime:5,sizeInMeters:!1,updateCallback:P,modelMatrix:w,emitterModelMatrix:D});o.primitives.add(M),setTimeout(function(){o.primitives.remove(M)},5e3)}a=h},1e3);function l(f){if(Array.isArray(f))for(let h=0;h<f.length;h++){let d={info:f[h],status:!0};n.push(d)}}function c(f,h){if(f.length!==0)for(let d=0;d<f.length;d++){let p=f[d];p.info.header.datTime>h&&(p.status=!0)}}}var wR=Sze;function Ng(e,t){this.viewer=e,this.dis=1e3,this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.mtMgr=t.mtMgr}Ng.prototype.RadarBeam=function(e){let t=this,n=t.dis,r={geometry:new Cesium.CylinderGeometry({length:n,topRadius:n/30,bottomRadius:1e-4,showTop:!1})},o=new Cesium.GeometryInstance({geometry:r.geometry}),a=new Cesium.MaterialAppearance({flat:!0,translucent:!0,material:new Cesium.Material({fabric:{type:"Color",uniforms:{color:new Cesium.Color(1,1,0,.5)}}})});t.viewer.scene.primitives.add(new Cesium.Primitive({releaseGeometryInstances:!1,geometryInstances:o,appearance:a,modelMatrix:Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(99.7892,40.4014,4500)),new Cesium.Cartesian3(0,0,800),new Cesium.Matrix4),name:e,show:!1}),0)};Ng.prototype.lidarRadar=function(e,t,n){let r=this;r.viewer.entities.add({id:e,polyline:{positions:new Cesium.CallbackProperty(function(){let o=r.mtMgr.ev_MTFlightDatas.get(t);if(o===void 0||o.curTimeAttitude===void 0||o.curTimeAttitude.position===void 0)return;let a=bze(o,n);if(o!==void 0&&o.curTimeAttitude.fLat!==void 0){let s=[];return s.push(o.curTimeAttitude.position),s.push(a),s}},!1),width:1,material:Cesium.Color.YELLOW,clampToGround:!1}})};Ng.prototype.getPrimitive=function(e){let t=this,n=t.viewer.scene.primitives.length;for(let r=0;r<n;++r){let o=t.viewer.scene.primitives.get(r);if(o.name===e)return o}};Ng.prototype.sendModelMatrix=function(e,t,n){let r=n.position,o=t.tgtDis,a=n.headingPitchRoll,s=new Cesium.Matrix3.fromRotationY(Cesium.Cesium.Math.toRadians(90)),u=new Cesium.HeadingPitchRoll(a.heading,a.pitch,a.roll),l=this.transformFunc(r,void 0,new Cesium.Matrix4),c=Cesium.Quaternion.fromHeadingPitchRoll(u,new Cesium.Quaternion),f=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),c,new Cesium.Cartesian3(1,1,1)),h=Cesium.Matrix4.multiply(l,f,new Cesium.Matrix4),d=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Cesium.Math.toRadians(t.tgtAzimuth),Cesium.Cesium.Math.toRadians(t.tgtPitch),0),new Cesium.Quaternion),p=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),d,new Cesium.Cartesian3(1,1,1));h=Cesium.Matrix4.multiply(h,p,new Cesium.Matrix4);let g=new Cesium.Cartesian3(o,0,0);Cesium.Matrix4.multiplyByPoint(h,g,g),t.targetPos=g;let y=o/1e3,v=Cesium.Matrix4.fromRotationTranslation(s);Cesium.Matrix4.multiply(h,v,h);let w=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(y,y,y));Cesium.Matrix4.multiply(h,w,h);let C=Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,this.dis/2));return Cesium.Matrix4.multiply(h,C,h),h};Ng.prototype.getEntity=function(e){return this.viewer.entities.getById(e)};Ng.prototype.MisToPlane=function(e,t){return Aze(this.viewer,e,t)};Ng.prototype.MisModelMatrix=function(e,t){let r=Cesium.Cartesian3.distance(e,t)/1110.7735888652096,o=Cesium.Cartesian3.midpoint(t,e,new Cesium.Cartesian3),a=new Cesium.Matrix4.fromScale(new Cesium.Cartesian3(r,r,r)),s=cie(e,t),u=fie(s);u.pitch=u.pitch+Cesium.Math.PI/2*3;let l=Cesium.Transforms.headingPitchRollToFixedFrame(o,u,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4);return Cesium.Matrix4.multiply(l,a,l),l};Ng.prototype.MisModelMatrixCaptureState=function(e,t,n){let r=t%90,o=parseInt(t/90),a=n.curTimeAttitude.headingPitchRoll,s=this.transformFunc(e,void 0,new Cesium.Matrix4),u=Cesium.Quaternion.fromHeadingPitchRoll(a,new Cesium.Quaternion),l=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),u,new Cesium.Cartesian3(1,1,1)),c=Cesium.Matrix4.multiply(s,l,new Cesium.Matrix4),f=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(-45+r),0,0),new Cesium.Quaternion);o%2!==0&&(f=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(45-r),0,0),new Cesium.Quaternion));let h=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),f,new Cesium.Cartesian3(1,1,1));c=Cesium.Matrix4.multiply(c,h,new Cesium.Matrix4);let d=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(90)),p=Cesium.Matrix4.fromRotationTranslation(d);Cesium.Matrix4.multiply(c,p,c);let g=new Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,1110.7735888652096/2));return Cesium.Matrix4.multiply(c,g,c),c};function Aze(e,t,n){let r=new Cesium.Cartesian3.fromDegrees(99.7892,40.4114,2e3),o=new Cesium.Cartesian3.fromDegrees(99.7892,40.4014,2e3),a=Cesium.Cartesian3.midpoint(o,r,new Cesium.Cartesian3),s=Cesium.Cartesian3.distance(r,o),u=cie(r,o),l=fie(u);l.pitch=l.pitch+Cesium.Math.PI/2*3;let c=Cesium.Transforms.headingPitchRollToFixedFrame(a,l,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4),f={geometry:new Cesium.CylinderGeometry({length:s,topRadius:s/40,bottomRadius:0,showTop:!1}),id:t},h=`uniform vec4 color;
uniform float repeat;
uniform float offset;
uniform float thickness;
czm_material czm_getMaterial(czm_materialInput materialInput){
czm_material material = czm_getDefaultMaterial(materialInput);
float sp = 1.0/repeat;
vec2 st = materialInput.st;
float dis = distance(st, vec2(0.5));
float m = mod(dis + offset, sp);
float a = step(sp*(1.0-thickness), m);
material.diffuse = color.rgb;
material.alpha = a * color.a;
return material;}`,d=new Cesium.Material({fabric:{uniforms:{color:new Cesium.Color(0,1,0,1),repeat:30,offset:0,thickness:.15},source:h},translucent:!0}),p=new Cesium.MaterialAppearance({material:d,faceForward:!1,closed:!1}),g=e.scene.primitives.add(new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance(f),appearance:p,releaseGeometryInstances:!1,modelMatrix:c,name:`${t}_radar`})),y={sid:t};return e.scene.preUpdate.addEventListener(function(){let w=g.appearance.material.uniforms.offset;w-=.001,w>1&&(w=0),g.appearance.material.uniforms.offset=w},y),g}function cie(e,t){let n=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),r=Cesium.Cartesian3.normalize(n,new Cesium.Cartesian3),o=Cesium.Transforms.rotationMatrixFromPositionVelocity(e,r,Cesium.Ellipsoid.WGS84),a=Cesium.Quaternion.fromRotationMatrix(o),s=Cesium.Matrix4.fromRotationTranslation(o,e),u=Cesium.HeadingPitchRoll.fromQuaternion(a);return s}function fie(e){return Cesium.Transforms.fixedFrameToHeadingPitchRoll(e)}function bze(e,t){let n=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),r=e.curTimeAttitude.position,o=t.fDistance,a=e.curTimeAttitude.headingPitchRoll,s=new Cesium.HeadingPitchRoll(a.heading,a.pitch,a.roll),u=n(r,void 0,new Cesium.Matrix4),l=Cesium.Quaternion.fromHeadingPitchRoll(s,new Cesium.Quaternion),c=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),l,new Cesium.Cartesian3(1,1,1)),f=Cesium.Matrix4.multiply(u,c,new Cesium.Matrix4),h=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(t.irmslAzimuth),Cesium.Math.toRadians(t.irmslPitch),0),new Cesium.Quaternion),d=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),h,new Cesium.Cartesian3(1,1,1));f=Cesium.Matrix4.multiply(f,d,new Cesium.Matrix4);let p=new Cesium.Cartesian3(o,0,0);return Cesium.Matrix4.multiplyByPoint(f,p,p),p}var ER=Ng;function TR(e){e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._scale=Cesium.defaultValue(e.scale,3),this._color=Cesium.defaultValue(e.color,new Cesium.Color(255/255,255/255,255/255,1)),this._fieldAngle=Cesium.defaultValue(e.fieldAngle,60),this.aspectRatio=7,this.lastResetScaleTime=new Date().getTime(),this.scaleMatrix3=[];for(var t=0;t<8;t++)this.scaleMatrix3.push(new Cesium.Matrix3);this.instances=[],this.boundingSphere=new Cesium.BoundingSphere(new Cesium.Cartesian3,1e4),this._center=new Cesium.Cartesian3,this._dynamic=Cesium.defaultValue(e.dynamic,!1),this.lightningTexture=void 0,this.lightningImage=void 0;var n=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthTest:{enabled:Cesium.defaultValue(e.depthTestState,!0),func:Cesium.DepthFunction.LESS_OR_EQUAL},depthMask:!1}),uniformMap:{u_lightningImage:function(){return n.lightningTexture},u_lightningColor:function(){return n._color}}}),Cesium.Resource.createIfNeeded(Cesium.buildModuleUrl("Assets/EMExtensions/PolitTraningApp/images/Lightnings.png")).fetchImage().then(function(r){n.lightningImage=r})}Object.defineProperties(TR.prototype,{color:{get:function(){return this._color},set:function(e){this._color=e}},scale:{get:function(){return this._scale},set:function(e){this._scale=e}},fieldAngle:{get:function(){return this._fieldAngle},set:function(e){this._fieldAngle=e}}});TR.prototype.resetInstances=function(e){this.instances=e,this.blUpdateVAO=!0};TR.prototype.update=function(e){var t=e.context,n=this._command;if(Cesium.defined(this.lightningImage)&&!Cesium.defined(this.lightningTexture)&&(this.lightningTexture=new Cesium.Texture({context:t,source:this.lightningImage,sampler:new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR})})),!!Cesium.defined(this.lightningTexture)){if(Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:Mze(),fragmentShaderSource:Lze()})),Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&n.vertexArray.destroy(),this.blUpdateVAO&&this.instances.length>0&&(n.vertexArray=Ize(t,this),n.instanceCount=this.instances.length,n.cull=!0,this.boundingSphere.radius=this.boundingSphere.radius<1e4?6378137:this.boundingSphere.radius,n.boundingVolume=this.boundingSphere,n.modelMatrix=Cesium.Matrix4.fromTranslation(n.boundingVolume.center)),Cesium.defined(n.vertexArray)){var r=e.commandList;r.push(n)}this.blUpdateVAO=!1}};function Ize(e,t){for(var n=Pze(t),r=Cesium.Buffer.createVertexBuffer({context:e,typedArray:n,usage:t._dynamic?Cesium.BufferUsage.STREAM_DRAW:Cesium.BufferUsage.STATIC_DRAW}),o=12,a=Cesium.ComponentDatatype.getSizeInBytes(Cesium.ComponentDatatype.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*4,strideInBytes:a*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:Cesium.ComponentDatatype.FLOAT,normalize:!1,offsetInBytes:a*8,strideInBytes:a*o,instanceDivisor:1}},u=t.instances.length,l=new Uint8Array(u),c=0;c<u;++c)l[c]=t.instances[c].jamDir;s.a_jamDir={index:0,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:l,usage:Cesium.BufferUsage.STATIC_DRAW}),componentsPerAttribute:1,componentDatatype:Cesium.ComponentDatatype.UNSIGNED_BYTE,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1},Oze(t);var f=Rze(t),h=0,d=[];return d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.position),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),d.push({index:h++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:e,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,f.dirType),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:1,normalize:!1}),s.czm_modelMatrixRow0.index=h++,d.push(s.czm_modelMatrixRow0),s.czm_modelMatrixRow1.index=h++,d.push(s.czm_modelMatrixRow1),s.czm_modelMatrixRow2.index=h++,d.push(s.czm_modelMatrixRow2),s.a_jamDir.index=h++,d.push(s.a_jamDir),new Cesium.VertexArray({context:e,attributes:d,indexBuffer:Cesium.Buffer.createIndexBuffer({context:e,typedArray:f.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT})})}var Dze=new U;function Pze(e){var t=e.instances,n=t.length,r=e._center,o=12,a=e._vertexBufferTypedArray;Cesium.defined(a)||(a=new Float32Array(n*o)),e._dynamic&&(e._vertexBufferTypedArray=a);for(var s=[],u=0;u<n;++u){var l=t[u].modelMatrix;s.push(new Cesium.Cartesian3(l[12],l[13],l[14]))}e.boundingSphere=Cesium.BoundingSphere.fromPoints(s);for(var u=0;u<n;++u){var l=t[u].modelMatrix,c=Cesium.Matrix4.clone(l,Dze);c[12]=c[12]-e.boundingSphere.center.x-r.x,c[13]=c[13]-e.boundingSphere.center.y-r.y,c[14]=c[14]-e.boundingSphere.center.z-r.z;var f=u*o;a[f+0]=c[0],a[f+1]=c[4],a[f+2]=c[8],a[f+3]=c[12],a[f+4]=c[1],a[f+5]=c[5],a[f+6]=c[9],a[f+7]=c[13],a[f+8]=c[2],a[f+9]=c[6],a[f+10]=c[10],a[f+11]=c[14]}return a}function Mze(){var e=`attribute vec3 position;
attribute vec2 st;
attribute float dirType; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
attribute float a_jamDir; 
varying vec2   v_textureCoordinates;
varying float  v_dirType;
varying float  v_discard;
void main()
{
    v_textureCoordinates = st; 
    v_dirType = dirType; 
    float Dir_RightBack = 0.0;
    float Dir_LeftBack = 0.0;
    float Dir_RightFront = 0.0;
    float Dir_LeftFront = 0.0;
    float tempValue = a_jamDir;
    Dir_RightBack = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue = floor(tempValue*0.5);
    Dir_LeftBack = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue =  floor(tempValue*0.5);
    Dir_RightFront = mod(tempValue, 2.0) >0.0 ? 1.0 : 0.0;  
    tempValue =   floor(tempValue*0.5);
    Dir_LeftFront = tempValue >0.0 ? 1.0 : 0.0;  
    v_discard = 1.0;
    float absDirType = abs(dirType);
    if(absDirType > 0.0 && absDirType<2.0 && Dir_RightBack > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 1.0 && absDirType<3.0 && Dir_LeftBack > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 3.0 && absDirType<5.0 && Dir_RightFront > 0.0){
       v_discard = 0.0;
    }else if(absDirType > 7.0 && absDirType<9.0 && Dir_LeftFront > 0.0){
       v_discard = 0.0;
    }
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_modelViewProjection * czm_instanced_model* vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function Lze(){var e=`varying vec2  v_textureCoordinates;
varying float  v_dirType;
varying float  v_discard;
uniform sampler2D  u_lightningImage;
uniform vec4  u_lightningColor;
void main()
{
    vec4 colour = texture2D(u_lightningImage, v_textureCoordinates); 
    if(v_discard > 0.0 ){;
       discard;  
    };
    if(v_dirType < 0.0 ){;
       colour.a *= 0.3;  
    };
    if(colour.a >= 0.0001 ){
      colour.rgb = u_lightningColor.rgb; 
    }
    gl_FragColor = colour;
}
`;return e}var ee=new x;function Rze(e){var t=e.color,n=e.fieldAngle,r=e.aspectRatio,o=0,a=10,s=10,u=32,l=new Float32Array(u*3),c=new Float32Array(u*2),f=new Float32Array(u),h=Math.sin(Cesium.Math.toRadians(n*.5)),d=Math.cos(Cesium.Math.toRadians(n*.5)),p=Math.sin(Cesium.Math.toRadians(o)),g=new Array(4);g[0]=new Cesium.Cartesian3(0,h,0),g[1]=new Cesium.Cartesian3(r*d,d+r*h,(d+r*h)*p),g[2]=new Cesium.Cartesian3(h+r*d,r*h,r*h*p),g[3]=new Cesium.Cartesian3(h,0,0);var y=new Array(4);y[0]=new Cesium.Cartesian3(a,0,0),y[1]=new Cesium.Cartesian3(-s,0,0),y[2]=new Cesium.Cartesian3(a,0,0),y[3]=new Cesium.Cartesian3(-s,0,0);var v=0,w=0,C=0;ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],g[0],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],g[1],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],g[2],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[0],g[3],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=8,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],g[0],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],g[1],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],g[2],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[1],g[3],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=2,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],g[0],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],g[1],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],g[2],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[2],g[3],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=4,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],g[0],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],g[1],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],g[2],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[3],g[3],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=1,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],g[0],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],g[1],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],g[2],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[4],g[3],ee),Cesium.Cartesian3.add(ee,y[0],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-8,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],g[0],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],g[1],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],g[2],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[5],g[3],ee),Cesium.Cartesian3.add(ee,y[1],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-2,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],g[0],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],g[1],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],g[2],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[6],g[3],ee),Cesium.Cartesian3.add(ee,y[2],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-4,c[C++]=1,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],g[0],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=0,c[C++]=0,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],g[1],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=0,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],g[2],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=1,c[C++]=1,ee=Cesium.Matrix3.multiplyByVector(e.scaleMatrix3[7],g[3],ee),Cesium.Cartesian3.add(ee,y[3],ee),l[v++]=ee.x,l[v++]=ee.y,l[v++]=ee.z,f[w++]=-1,c[C++]=1,c[C++]=0;for(var E=8*6,S=Cesium.IndexDatatype.createTypedArray(u,E),A=0;A<8;A++)S[A*6]=A*4+0,S[A*6+1]=A*4+1,S[A*6+2]=A*4+2,S[A*6+3]=A*4+0,S[A*6+4]=A*4+2,S[A*6+5]=A*4+3;return{position:l,st:c,dirType:f,indices:S}}function Oze(e){var t=e.scale,n=new Date().getTime();if(n-e.lastResetScaleTime>200){var r=Math.random()*100,o=r%t*2/3+t/3;r=Math.random()*100;var a=r%t*2/3+t/3;r=Math.random()*100;var s=r%t*2/3+t/3;r=Math.random()*100;var u=r%t*2/3+t/3;e.scaleMatrix3.length==8&&(Cesium.Matrix3.fromScale(new Cesium.Cartesian3(o,o,o),e.scaleMatrix3[0]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-s,s,s),e.scaleMatrix3[1]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(a,-a,a),e.scaleMatrix3[2]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-u,-u,u),e.scaleMatrix3[3]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(a,a,a),e.scaleMatrix3[4]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-u,u,u),e.scaleMatrix3[5]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(o,-o,o),e.scaleMatrix3[6]),Cesium.Matrix3.fromScale(new Cesium.Cartesian3(-s,-s,s),e.scaleMatrix3[7])),e.lastResetScaleTime=n}}var SR=TR;function qd(e,t){if(this.options=t,this.viewer=e,!!Cesium.defined(this.viewer)&&(this.scene=this.viewer.scene,this.trainingClock=Cesium.defaultValue(t.trainingClock,void 0),this.dataMgr=Cesium.defaultValue(t.dataMgr,void 0),this.mtMgr=Cesium.defaultValue(t.mtMgr,void 0),!(!Cesium.defined(this.scene)||!Cesium.defined(this.mtMgr)))){this.transformFunc=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),this.ev_radarJamDirCollection=new SR({scale:6}),this.ev_paRadarBeam=new ER(this.viewer,this.options),this.ev_mtRadarTargetDatas=new Cesium.AssociativeArray,this.ev_mtRadarWMDatas=new Cesium.AssociativeArray,this.ev_mtRadarJamDirDatas=new Cesium.AssociativeArray,this.ev_mtIrstWMDatas=new Cesium.AssociativeArray,this.ev_mtMisRadar=new Cesium.AssociativeArray,this.ev_mtSdrStateRadar=new Cesium.AssociativeArray,this._planeSectorRadarColor=new Cesium.Color(58/255,213/255,252/255,60/255),this._planeSectorRadarVisible=!0,this._undergroundSectorRadarColor=new Cesium.Color(0/255,85/255,255/255,60/255),this._planePARadarColor=new Cesium.Color(.18,.75,.49,.6),this._undergroundPARadarColor=new Cesium.Color(.4,0,0,.6),this.ev_simpleConeRadars=new NP(this.options),this.conePARadarTypes=[];var n=this;n.receiveRadarTargetsListenerFunc=function(r){if(Array.isArray(r)){for(var o=0;o<r.length-1;o++)Math.abs(r[o].header.datTime-r[o+1].header.datTime)<500&&(r.splice(o,1),o--);for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarTargetDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarTargetDatas.set(a.header.sID,[a])}}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_TARGET,n.receiveRadarTargetsListenerFunc),n.receiveRadarWMListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarWMDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarWMDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_RDR_STATE,n.receiveRadarWMListenerFunc),n.receiveRadarJamDirListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtRadarJamDirDatas.get(a.header.sID);s?s.push(a):n.ev_mtRadarJamDirDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_EWS_STA,n.receiveRadarJamDirListenerFunc),n.receiveIRSTWMListenerFunc=function(r){if(Array.isArray(r))for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtIrstWMDatas.get(a.header.sID);s?s.push(a):n.ev_mtIrstWMDatas.set(a.header.sID,[a])}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_IRMSL_STATE,n.receiveIRSTWMListenerFunc),n.receiveSdrStateRadarListenerFunc=function(r){if(Array.isArray(r)){for(var o=0;o<r.length-1;o++)Math.abs(r[o].header.datTime-r[o+1].header.datTime)<500&&(r.splice(o,1),o--);for(var o=0;o<r.length;o++){var a=r[o],s=n.ev_mtSdrStateRadar.get(a.header.sID);s?s.push(a):n.ev_mtSdrStateRadar.set(a.header.sID,[a])}}},n.dataMgr.addReceiveDataListener(Re.NET_MSG_RAD_STATE,n.receiveSdrStateRadarListenerFunc),n.scene.primitives.add(n)}}Object.defineProperties(qd.prototype,{planePARadarColor:{get:function(){return this._planePARadarColor},set:function(e){this._planePARadarColor=e}},undergroundPARadarColor:{get:function(){return this._undergroundPARadarColor},set:function(e){this._undergroundPARadarColor=e}},planeSectorRadarColor:{get:function(){return this._planeSectorRadarColor},set:function(e){this._planeSectorRadarColor=e}},planeSectorRadarVisible:{get:function(){return this._planeSectorRadarVisible},set:function(){this._planeSectorRadarVisible?this._planeSectorRadarVisible=!1:this._planeSectorRadarVisible=!0}},undergroundSectorRadarColor:{get:function(){return this._undergroundSectorRadarColor},set:function(e){this._undergroundSectorRadarColor=e}}});var Nze=new U,__=[],AR=[],iw=[];qd.prototype.prePassesUpdate=function(e){if(e.mode==Cesium.SceneMode.SCENE3D){var t=new Date().getTime();if(Cesium.defined(this.trainingClock)){var n=this.trainingClock.tick();t=Cesium.JulianDate.toDate(n).getTime(),t=this.mtMgr.lastTrainingTimeMsec}var r=zze(this,t),o=kze(this,t),a=Vze(this,t),s=Gze(this,t),u=Bze(this,t),l=Fze(this,t);AR=[],this.conePARadarTypes=[];for(var c in u._hash){var f=u.get(c),h=l.get(c),d=this.mtMgr.ev_MTFlightDatas.get(f.header.sID);if(d){if(d.sectorRadarVisible=!1,f.openState==1&&f.radiaState==1){var p=!1,g=!1;if(!Cesium.defined(h)||Cesium.defined(h.showSector)&&h.showSector)p=!0;else for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch===0?p=!0:g=!0}if(!g&&p)d.sectorRadarVisible=this._planeSectorRadarVisible,d.sectorRadarColor=this._planeSectorRadarColor;else if(g){var C=h.nearestTimeAttitude;C.position=d.curTimeAttitude.position;for(var E=h.header.datTime,y=h.tgtInfo,w,v=0;v<y.length&&v<h.tgtNum;v++)if(w=y[v],w.tgtSensor==0||w.tgtSensor==2){var S=c+"_"+v;Cesium.defined(C.position)&&this.conePARadarTypes.push({name:S,show:!0,color:this.planePARadarColor,modelMatrix:this.calcPARadarModelMatrix(w,C,this.ev_simpleConeRadars.cylinderLength)})}}}else if(f.openState==0||f.radiaState==0){if(h!==void 0)for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch}}else if(f.openState==1&&f.interceptState==1&&h!=null)for(var y=h.tgtInfo,v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];w.tgtSensor==1}}}var A=[];for(var c in r._hash){var D=r.get(c),d=this.mtMgr.ev_MTFlightDatas.get(D.header.sID);if(d){var P=d.curTimeAttitude.position,M=Cesium.defined(d.curTimeAttitude.scale)?d.curTimeAttitude.scale:1,I=Cesium.defined(d.curTimeAttitude.visible)?d.curTimeAttitude.visible:!1;if(I&&D.ewsDir>0){var O=new Cesium.HeadingPitchRoll(d.curTimeAttitude.headingPitchRoll.heading,d.curTimeAttitude.headingPitchRoll.pitch,d.curTimeAttitude.headingPitchRoll.roll),m=this.transformFunc(P,void 0,Nze),b=Cesium.Quaternion.fromHeadingPitchRoll(O,new Cesium.Quaternion),L=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),b,new Cesium.Cartesian3(M,M,M));m=Cesium.Matrix4.multiply(m,L,new Cesium.Matrix4),A.push({modelMatrix:m,jamDir:D.ewsDir})}}}this.ev_radarJamDirCollection&&this.ev_radarJamDirCollection.resetInstances(A);for(var c in o._hash){var R=o.get(c),d=this.mtMgr.ev_MTFlightDatas.get(R.header.sID);if(d){var N=d.curTimeAttitude.specialAttributes,S=c+"_liderRadar";if(Cesium.defined(N.decoyDrop)&&N.decoyDrop==1){var B=__.indexOf(S);if(B===-1)__.push(S),this.ev_paRadarBeam.lidarRadar(S,c,R);else{var G=this.ev_paRadarBeam.getEntity(S);G!=null&&(G.show=!0),AR.push(S)}}else if(Cesium.defined(N.decoyDrop)&&N.decoyDrop==0){var G=this.ev_paRadarBeam.getEntity(S);G!=null&&(G.show=!1)}}}for(var c in a._hash){var F=a.get(c),k=c;if(F.header.datTime-t<-1e3){var Z=this.ev_paRadarBeam.getPrimitive(k+"_radar");Z!=null&&(Z.show=!1)}else if(F.captureState!=0){var Z=this.ev_paRadarBeam.getPrimitive(k+"_radar");if(Z==null){var Z=this.ev_paRadarBeam.MisToPlane(k);Z.show=!0,__.push(k+"_radar");var te={sid:k,count:0};iw.push(te)}else if(Z!=null){AR.push(k+"_radar");for(var v=0;v<iw.length;v++){var w=iw[v];w.sid==k&&w.count++}if(this.mtMgr.ev_MTFlightDatas.get(k)!=null&&this.mtMgr.ev_MTFlightDatas.get(F.targetID)!=null){for(var oe=void 0,ue=k.split("_")[0],pe=0;pe<this.mtMgr.ev_MTFlightDatas.length;pe++){var d=this.mtMgr.ev_MTFlightDatas.values[pe];if(typeof d.uId=="string"){var me=d.uId.split("_");if(me.length==3&&me[0]===ue&&me[2]==="5"){oe=this.mtMgr.ev_MTFlightDatas.values[pe].curTimeAttitude;break}}}if(Cesium.defined(oe)){var st=this.mtMgr.ev_MTFlightDatas.get(k).curTimeAttitude.position,ht=this.mtMgr.ev_MTFlightDatas.get(F.targetID).curTimeAttitude.position,jt=oe.nRedOrBlue;if(ht!=null&&st!=null){var Ct=this.ev_paRadarBeam.MisModelMatrix(st,ht);if(F.captureState==2){for(var bt=0,v=0;v<iw.length;v++){var w=iw[v];w.sid==k&&(bt=w.count)}Ct=this.ev_paRadarBeam.MisModelMatrixCaptureState(st,bt,this.mtMgr.ev_MTFlightDatas.get(k)),Z.modelMatrix=Ct,Z.show=!0,jt==0?Z.appearance.material.uniforms.color=new Cesium.Color(1,0,0,1):jt==1&&(Z.appearance.material.uniforms.color=new Cesium.Color(0,0,1,1))}else F.captureState==1&&(Z.modelMatrix=Ct,jt==0?Z.appearance.material.uniforms.color=new Cesium.Color(1,0,0,1):jt==1&&(Z.appearance.material.uniforms.color=new Cesium.Color(0,0,1,1)),Z.show=!0)}}}}}else if(F.captureState==0){var Z=this.ev_paRadarBeam.getPrimitive(k+"_radar");if(Z!=null)Z.show=!1;else if(Z==null){var Z=this.ev_paRadarBeam.MisToPlane(k);Z.show=!1,__.push(k+"_radar");var te={sid:k,count:0};iw.push(te)}}}for(var c in s._hash){var mn=!1,Tn=!1,zi=s.get(c),h=l.get(c);if(h==null){for(var at in l._hash)if(c==at.split("_")[0]){h=l.get(at);break}}if(h!=null){var y=h.tgtInfo;if(zi.openState==1)for(var v=0;v<y.length&&v<h.tgtNum;v++){var w=y[v];(w.tgtSensor==0||w.tgtSensor==2)&&(w.tgtPitch>=70||w.tgtPitch<=-70||w.tgtAzimuth>=70||w.tgtAzimuth<=-70)||w.tgtAzimuth===0||w.tgtPitch===0?(mn=!1,Tn=!0):(mn=!0,Tn=!1)}else zi.openState==0&&(Tn=!1,mn=!1)}if(Tn){var Sn=this.mtMgr.ev_MTFlightDatas.get(at);Sn!=null&&(Sn.sectorRadarVisible=!0)}else if(mn){var Sn=this.mtMgr.ev_MTFlightDatas.get(at);Sn!=null&&(Sn.sectorRadarVisible=!0);var C=h.nearestTimeAttitude,E=h.header.datTime,y=h.tgtInfo,w;if(C!=null&&C.fAlt!=null){for(var v=0;v<y.length&&v<h.tgtNum;v++)if(w=y[v],w.tgtSensor==0||w.tgtSensor==2){var S=c+"_"+v;Cesium.defined(C.position)&&this.conePARadarTypes.push({name:S,show:!0,color:this.undergroundPARadarColor,modelMatrix:this.calcPARadarModelMatrix(w,C,this.ev_simpleConeRadars.cylinderLength,new Cesium.Cartesian3(1,.6,.6))})}}}}this.ev_simpleConeRadars.recreateVertexArrays(this.conePARadarTypes,e);for(var v=0;v<__.length;v++){var B=AR.indexOf(__[v]);if(B===-1){var Z=this.ev_paRadarBeam.getPrimitive(__[v]);Z!=null&&(Z.show=!1);var G=this.ev_paRadarBeam.getEntity(__[v]);G!=null&&(G.show=!1)}}}};qd.prototype.update=function(e){e.mode==Cesium.SceneMode.SCENE3D&&(this.ev_radarJamDirCollection&&this.ev_radarJamDirCollection.update(e),this.ev_simpleConeRadars&&this.ev_simpleConeRadars.update(e))};qd.prototype.removeAllRadarDatas=function(){this.ev_mtRadarTargetDatas.removeAll(),this.ev_mtRadarWMDatas.removeAll(),this.ev_mtRadarJamDirDatas.removeAll(),this.ev_mtMisRadar.removeAll()};qd.prototype.addRadarWMDatas=function(e,t,n){n=Cesium.defaultValue(n,Br.ADD);var r=this.ev_mtRadarTargetDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarTargetDatas.set(e,[]),r=this.ev_mtRadarTargetDatas.get(e)),n==Br.ADD?this.ev_mtRadarTargetDatas._hash[e]=r.concat(t):n==Br.REPLACE&&(r=[],this.ev_mtRadarTargetDatas._hash[e]=r.concat(t))};qd.prototype.addRadarWMDatas=function(e,t,n){n=Cesium.defaultValue(n,Br.ADD);var r=this.ev_mtRadarWMDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarWMDatas.set(e,[]),r=this.ev_mtRadarWMDatas.get(e)),n==Br.ADD?this.ev_mtRadarWMDatas._hash[e]=r.concat(t):n==Br.REPLACE&&(r=[],this.ev_mtRadarWMDatas._hash[e]=r.concat(t))};qd.prototype.addRadarJamDirDatas=function(e,t,n){n=Cesium.defaultValue(n,Br.ADD);var r=this.ev_mtRadarJamDirDatas.get(e);Cesium.defined(r)||(this.ev_mtRadarJamDirDatas.set(e,[]),r=this.ev_mtRadarJamDirDatas.get(e)),n==Br.ADD?this.ev_mtRadarJamDirDatas._hash[e]=r.concat(t):n==Br.REPLACE&&(r=[],this.ev_mtRadarJamDirDatas._hash[e]=r.concat(t))};gh.prototype.addev_mtMisRadar=function(e,t,n){};function Bze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarWMDatas._hash){var o=e.ev_mtRadarWMDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function Fze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarTargetDatas._hash){var o=e.ev_mtRadarTargetDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a in e.mtMgr.ev_dataMgr.idchUnderRaderList._hash)r==a&&(r=e.mtMgr.ev_dataMgr.idchUnderRaderList.get(a));var s=e.mtMgr.ev_MTFlightDatas.get(r);if(s)for(var u=o[0].header,l=u,c=1;c<o.length;c++){if(l=o[c].header,t>=u.datTime&&t<=l.datTime){l.datTime-u.datTime>=2e3?o[c-1].showSector=!0:l.datTime-u.datTime<2e3&&l.datTime-u.datTime>0&&(o[c-1].showSector=!1,Cesium.defined(o[c-1].nearestTimeAttitude)?Math.abs(o[c-1].header.datTime-o[c-1].nearestTimeAttitude.realTime)>=Math.abs(o[c-1].header.datTime-t)&&(o[c-1].nearestTimeAttitude=s.curTimeAttitude):o[c-1].nearestTimeAttitude=s.curTimeAttitude,Cesium.defined(o[c].nearestTimeAttitude)?Math.abs(o[c].header.datTime-o[c].nearestTimeAttitude.realTime)>=Math.abs(o[c].header.datTime-t)&&(o[c].nearestTimeAttitude=s.curTimeAttitude):o[c].nearestTimeAttitude=s.curTimeAttitude),n.set(r,o[c-1]),c-2>0&&o.splice(0,c-1);break}u=l}}}return n}function zze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtRadarJamDirDatas._hash){var o=e.ev_mtRadarJamDirDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function Vze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.mtMgr.ev_MTFlightDatas._hash){var o=e.mtMgr.ev_MTFlightDatas.get(r);if(o.curTimeAttitude.position!=null&&o.mtType==32){var a=e.dataMgr.splitTwo(t,o);n.set(r,a)}}return n}function kze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtIrstWMDatas._hash){var o=e.ev_mtIrstWMDatas.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}function Gze(e,t){var n=new Cesium.AssociativeArray;for(var r in e.ev_mtSdrStateRadar._hash){var o=e.ev_mtSdrStateRadar.get(r);if(o.length>1){if(o[o.length-1].header.datTime<t){o.splice(0,o.length-1);continue}if(o[0].header.datTime>=t)continue;for(var a=o[0].header,s=a,u=1;u<o.length;u++){if(s=o[u].header,t>=a.datTime&&t<=s.datTime){n.set(r,o[u-1]),u-2>0&&o.splice(0,u-1);break}a=s}}}return n}qd.prototype.calcPARadarModelMatrix=function(e,t,n,r){var o=t.position,a=e.tgtDis,s=t.headingPitchRoll,C=Cesium.defaultValue(r,new Cesium.Cartesian3(1,1,1)),u=new Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(90)),l=new Cesium.HeadingPitchRoll(s.heading,s.pitch,s.roll),c=this.transformFunc(o,void 0,new Cesium.Matrix4),f=Cesium.Quaternion.fromHeadingPitchRoll(l,new Cesium.Quaternion),h=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),f,new Cesium.Cartesian3(1,1,1)),d=Cesium.Matrix4.multiply(c,h,new Cesium.Matrix4),p=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(e.tgtAzimuth),Cesium.Math.toRadians(e.tgtPitch),0),new Cesium.Quaternion),g=Cesium.Matrix4.fromTranslationQuaternionRotationScale(new Cesium.Cartesian3(0,0,0),p,C);d=Cesium.Matrix4.multiply(d,g,new Cesium.Matrix4);var y=new Cesium.Cartesian3(a,0,0);Cesium.Matrix4.multiplyByPoint(d,y,y),e.targetPos=y;var v=a/1e3,w=Cesium.Matrix4.fromRotationTranslation(u);Cesium.Matrix4.multiply(d,w,d);var C=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(v,v,v));Cesium.Matrix4.multiply(d,C,d);var E=Cesium.Matrix4.fromTranslation(new Cesium.Cartesian3(0,0,n/2));return Cesium.Matrix4.multiply(d,E,d),d};qd.prototype.isDestroyed=function(){return!1};qd.prototype.destroy=function(){this.ev_mtRadarTargetDatas.removeAll(),this.ev_mtRadarWMDatas.removeAll(),this.ev_mtRadarJamDirDatas.removeAll();var e=this._scene.primitives.destroyPrimitives;return this._scene.primitives.destroyPrimitives=!1,this._scene.primitives.remove(this),this._scene.primitives.destroyPrimitives=e,Cesium.defined(this.ev_radarJamDirCollection)&&this.ev_radarJamDirCollection.destroy(),Cesium.defined(this.ev_simpleConeRadars)&&this.ev_simpleConeRadars.destroy(),Cesium.destroyObject(this)};var bR=qd;function Uze(e){if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.ev_dataMgr))throw new Cesium.DeveloperError("ev_dataMgr is empty!.");this.ev_dataMgr=e.ev_dataMgr,this.ev_MTUpdateProperties=new Cesium.AssociativeArray,this.trainingClock=e.trainingClock;var t=this;t.updatePropertiesFunc=function(n){if(t.cur_time=Cesium.JulianDate.toDate(t.trainingClock.currentTime).getTime(),n instanceof Array)for(var r=0;r<n.length;r++){var o=n[r];if(o.mtType==2){var a=t.ev_dataMgr.parseflight.get(o.uId),s=t.ev_dataMgr.initial_parseflight.get(o.uId);if(Cesium.defined(a)){var u=Hze(t.cur_time,a,s,t.ev_dataMgr);if(u)for(var l in u)l!="SIZE"&&l!="header"&&(o.specialAttributes[l]=u[l])}}}}}function Hze(e,t,n,r){var o=r.splitTwo(e,t);if(typeof o.remain_oil_amount=="number"){var a=n.remain_oil_amount-o.remain_oil_amount;o.remain_oil_amount=o.remain_oil_amount+" / "+a}return o}var IR=Uze;function kh(e){var t=e.viewer,n=e.xmlObj;this.viewer=t,this.timeId=void 0,this.sliderWidth=0,this.wsUrl=e.wsUrl,this.callback=e.callback,this.trajStart=new Cesium.AssociativeArray,this.realDistance=new Cesium.AssociativeArray,this._maxTaskConcurrency=Cesium.defaultValue(5,e._maxTaskConcurrency);var r=this,o=e.workName;this.worker=new Cesium.TaskProcessor(o,this._maxTaskConcurrency),this.datSource=e.datSource,this.promise=this.worker.scheduleTask({url:r.wsUrl,datSource:r.datSource}),this.worker._worker.onmessage=function(a){var s=a.data;if(!Cesium.defined(s.id)&&s.length!=0){var u=Number(s[0]),l=Number(s[1]),c={startTime:new Date(u),endTime:new Date(l)};r.trainingClock=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(c.startTime),currentTime:Cesium.JulianDate.fromDate(c.startTime),stopTime:Cesium.JulianDate.fromDate(c.endTime),clockStep:Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,clockRange:Cesium.ClockRange.CLAMPED}),r.ev_dataMgr=new wI({worker:r.worker,xmlUrl:n,datSource:r.datSource,trainingClock:r.trainingClock}),r.ev_mtMgr=new gh({viewer:t,ev_dataMgr:r.ev_dataMgr,trainingClock:r.trainingClock,useInstancedColor:!0}),r.ev_mtMgr.graduatedColors.set(0,{modelColor:new Cesium.Color(1,0,0,1),modelIconColor:new Cesium.Color(1,0,0,1),modelLabelTextColor:new Cesium.Color(1,0,0,1),modelLabelPullWireColor:new Cesium.Color(1,0,0,1),traceRibbonColor:new Cesium.Color(1,0,0,.8),traceLineColor:new Cesium.Color(1,0,0,.8),traceBarColor:new Cesium.Color(1,0,0,.8)}),r.ev_mtMgr.graduatedColors.set(1,{modelColor:new Cesium.Color(0,0,1,1),modelIconColor:new Cesium.Color(0,0,1,1),modelLabelTextColor:new Cesium.Color(0,0,1,1),modelLabelPullWireColor:new Cesium.Color(0,0,1,1),traceRibbonColor:new Cesium.Color(0,0,1,.8),traceLineColor:new Cesium.Color(0,0,1,.8),traceBarColor:new Cesium.Color(0,0,1,.8)}),r.ev_mtMgr.graduatedColors.set(2,{modelColor:new Cesium.Color(0,1,1,1),modelIconColor:new Cesium.Color(0,1,1,1),modelLabelTextColor:new Cesium.Color(0,1,1,1),modelLabelPullWireColor:new Cesium.Color(0,1,1,1),traceRibbonColor:new Cesium.Color(0,1,1,1),traceLineColor:new Cesium.Color(0,1,1,1),traceBarColor:new Cesium.Color(0,1,1,1)});var f=new _h({});f.addDisplayFieldPara("\u5D4C\u8BADID:","uId"),f.addDisplayFieldPara("\u7ECF\u5EA6:","fLon",2),f.addDisplayFieldPara("\u7EAC\u5EA6:","fLat",2),f.addDisplayFieldPara("\u536B\u661F\u9AD8\u5EA6:","fAlt",2),f.addDisplayFieldPara("\u673A\u578B:","modelType"),f.addDisplayFieldPara("\u98DE\u673A\u4EE3\u53F7:","name"),f.addDisplayFieldPara("\u98DE\u884C\u5458\u4EE3\u5B57:","name"),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_TSPI,f);var f=new _h({showBackground:!1});f.addDisplayFieldPara("\u76EE\u6807:","targetID"),f.addDisplayFieldPara("\u7C7B\u578B:","weaponType"),f.addDisplayFieldPara("\u5F39\u76EE\u8DDD\u79BB:","mslDistance",2),f.addDisplayFieldPara("\u901F\u5EA6:","vel",2),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_WPN_TRAJ,f);var f=new _h({});f.addDisplayFieldPara("\u5047\u9635\u5730\u7F16\u53F7:","fakeCampID"),f.addDisplayFieldPara("\u8425\u5730\u7C7B\u578B:","campType"),f.addDisplayFieldPara("\u88C5\u5907\u7C7B\u578B:","equipmentType"),f.addDisplayFieldPara("\u88C5\u5907\u7F16\u53F7ID:","equipmentID"),r.ev_mtMgr.ev_MTLabelConfigurationTables.set(Re.NET_MSG_GTSPI,f),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_GTSPI,{minimumPixelSize:30}),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_TSPI,{minimumPixelSize:30}),r.ev_mtMgr.ev_MTZoomFactors.set(Re.NET_MSG_WPN_TRAJ,{minimumPixelSize:20}),r.ev_mtUpdateProperties=new IR({ev_dataMgr:r.ev_dataMgr,trainingClock:r.trainingClock}),r.ev_mtMgr.preUpdateRenderMovingTargetFunc=r.ev_mtUpdateProperties.updatePropertiesFunc,r.ev_special=new wR(t,{dataMgr:r.ev_dataMgr,mtMgr:r.ev_mtMgr,trainingClock:r.trainingClock}),r.ev_mtSensorMgr=new bR(t,{dataMgr:r.ev_dataMgr,mtMgr:r.ev_mtMgr,trainingClock:r.trainingClock}),r.ev_DrawConnectionLines=new EI(t,{mtMgr:r.ev_mtMgr}),r.callback()}}}Object.defineProperties(kh.prototype,{});kh.prototype.startPlay=function(){if(!this.trainingClock.shouldAnimate){this.trainingClock.shouldAnimate=!0,this.trainingClock.tick();var e=Cesium.JulianDate.toDate(this.trainingClock.currentTime);this.ev_dataMgr.startSend()}};kh.prototype.pausePlay=function(){this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!1,this.trainingClock.tick())};kh.prototype.stopPlay=function(){};kh.prototype.resetTimeLine=function(e,t){this.trainingClock.startTime=e,this.trainingClock.startTime=t,this.trainingClock.clockStep=Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,this.trainingClock.clockRange=Cesium.ClockRange.CLAMPED,this.trainingClock.tick()};kh.prototype.resetCurrentTime=function(e){this.trainingClock.currentTime=e,this.trainingClock.tick()};kh.prototype.resetTimeRate=function(t){var t=Number(t);this.trainingClock.multiplier=t};kh.prototype.playBack=function(e){for(var t in this.ev_dataMgr.sendArr._hash){var n=this.ev_dataMgr.sendArr._hash[t].findIndex(function(u){return u.header.datTime>=e-100});this.ev_dataMgr.index.set(t,n)}for(var t in this.ev_dataMgr.trajData._hash){var r=this.ev_dataMgr.trajData._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.trajIndex.set(t,r)}this.ev_dataMgr.gtspiIndex=this.ev_dataMgr.gtspiData.findIndex(function(u){return u.header.datTime>=e});for(var t in this.ev_dataMgr.radarTargetMap._hash){var o=this.ev_dataMgr.radarTargetMap._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.radarIndex.set(t,o)}for(var t in this.ev_dataMgr.sdrState._hash){var a=this.ev_dataMgr.sdrState._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.sdrIndex.set(t,a)}for(var t in this.ev_dataMgr.ewsData._hash){var s=this.ev_dataMgr.ewsData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.ewsIndex.set(t,s)}this.ev_dataMgr.irsmIndex=this.ev_dataMgr.irsmData.findIndex(function(u){return u.header.datTime>=e}),this.ev_mtSensorMgr.removeAllRadarDatas(),this.ev_dataMgr.sendRadarMV=!0,this.ev_dataMgr.preTime=e,e=new Date(Number(e)),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_dataMgr.dataOperated=Br.REPLACE,this.ev_dataMgr.trajOperated=Br.REPLACE,this.ev_mtMgr.dataOperated=Br.REPLACE};kh.prototype.forward=function(e){for(var t in this.ev_dataMgr.sendArr._hash){var n=this.ev_dataMgr.sendArr._hash[t].findIndex(function(u){return u.header.datTime>=e-1200});n!=-1?this.ev_dataMgr.index.set(t,n):this.ev_dataMgr.index.set(t,this.ev_dataMgr.sendArr._hash[t].length)}for(var t in this.ev_dataMgr.trajData._hash){var r=this.ev_dataMgr.trajData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.trajIndex.set(t,r)}this.ev_dataMgr.gtspiIndex=this.ev_dataMgr.gtspiData.findIndex(function(u){return u.header.datTime>=e});for(var t in this.ev_dataMgr.radarTargetMap._hash){var o=this.ev_dataMgr.radarTargetMap._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.radarIndex.set(t,o)}for(var t in this.ev_dataMgr.sdrState._hash){var a=this.ev_dataMgr.sdrState._hash[t].findIndex(function(l){return l.header.datTime>=e-100});this.ev_dataMgr.sdrIndex.set(t,a)}for(var t in this.ev_dataMgr.ewsData._hash){var s=this.ev_dataMgr.ewsData._hash[t].findIndex(function(l){return l.header.datTime>=e});this.ev_dataMgr.ewsIndex.set(t,s)}this.ev_dataMgr.irsmIndex=this.ev_dataMgr.irsmData.findIndex(function(u){return u.header.datTime>=e}),this.ev_mtSensorMgr.removeAllRadarDatas(),this.ev_dataMgr.sendRadarMV=!0,this.ev_dataMgr.preTime=e,e=new Date(Number(e)),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_dataMgr.dataOperated=Br.REPLACE,this.ev_dataMgr.trajOperated=Br.REPLACE,this.ev_mtMgr.dataOperated=Br.REPLACE};kh.prototype.reset=function(e){this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!1,this.trainingClock.tick()),this.trainingClock.tick(),this.trainingClock.currentTime=Cesium.JulianDate.fromDate(e),this.ev_mtMgr.removeAllMovingTargets()};kh.prototype.playLineRun=function(){};var hie=kh;function WA(e){this.viewer=e.viewer,this.sTime=Cesium.defaultValue(e.sTime,new Date().getTime());var t=Cesium.defaultValue(e.timeSpace,180);this.eTime=Cesium.defaultValue(e.eTime,new Date(this.sTime+t).getTime()),this.trainingClock=new Cesium.Clock({startTime:Cesium.JulianDate.fromDate(new Date(this.sTime)),currentTime:Cesium.JulianDate.fromDate(new Date(this.sTime)),stopTime:Cesium.JulianDate.fromDate(new Date(this.eTime)),clockStep:Cesium.defaultValue(e.clockStep,Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER),clockRange:Cesium.defaultValue(e.clockRange,Cesium.ClockRange.UNBOUNDED)}),this.idIndex=0,this.modelType=0,this.timeId=[],this.rectSector=void 0,this.ev_mtMgr=new gh({viewer:this.viewer,ev_dataMgr:this,trainingClock:this.trainingClock,useInstancedColor:Cesium.defaultValue(e.useInstancedColor,!1),retainOutdatedData:Cesium.defaultValue(e.retainOutdatedData,!1),blShowOutdated:Cesium.defaultValue(e.retainOutdatedData,!1)});let n=e.ev_mtLabelConfiTable;if(n!=null){let r=n.font;this.ev_mtLabelConfiTable=new _h({font:r});let o=n.displayFieldPara,a=this;for(let s in o)typeof o[s]=="string"?a.ev_mtLabelConfiTable.addDisplayFieldPara(s,o[s]):a.ev_mtLabelConfiTable.addDisplayFieldPara(s,o[s][0],Number(o[s][1]));this.ev_mtMgr.ev_MTLabelConfigurationTables.set(Number(n.mtType),this.ev_mtLabelConfiTable)}}WA.prototype.transmission=function(e){var t=this,n=Cesium.defaultValue(e.startlon,120);this.modelType++;var r=this.modelType,o=Cesium.defaultValue(e.lonStep,.2),a=Cesium.defaultValue(e.startlat,30),s=Cesium.defaultValue(e.latStep,.2),u=Cesium.defaultValue(e.altitude,1e4),l=Cesium.defaultValue(e.startroll,0),c=Cesium.defaultValue(e.modelUri,Cesium.buildModuleUrl("Assets/EMExtensions/gltf/J10C.gltf")),f=Cesium.defaultValue(e.modelIconUri,"../images/Flight_1.png"),h=Cesium.defaultValue(e.row,5),d=Cesium.defaultValue(e.scale,200),p=Cesium.defaultValue(e.column,5),g=Cesium.defaultValue(e.name,"plane"),y=Cesium.defaultValue(e.timeStep,1e3),v=Cesium.defaultValue(e.considerTerrain,!1),w=Cesium.defaultValue(e.sectorRadarVisible,!1),C=Cesium.defaultValue(e.openSectorPyramid,!1),E=e.sectorColor,S=Cesium.defaultValue(e.forwardDis,0),A=Cesium.defaultValue(e.radius,100);let D=[];for(var P=0;P<h;P++)for(var M=n+P*o,I=0;I<p;I++){var O=g+this.idIndex++,m=new Pu({uId:O,mtType:Re.NET_MSG_TSPI,name:g,modelType:r,modelUri:Cesium.buildModuleUrl(c),modelIconUri:Cesium.buildModuleUrl(f),modelIconDisplayDistance:new Cesium.DistanceDisplayCondition(5e5,5e7),modelIconScale:.5,scale:d,specialAttributes:{},ribbonVisible:!1,forwardOffset:-10,upOffset:5,traceTimeDuration:30,sectorRadarVisible:w}),b=a+I*s,L=0;m.addTimeAttitude({realTime:t.sTime,fLon:M,fLat:b,fAlt:u,position:Cesium.Cartesian3.fromDegrees(M,b,u),nRedOrBlue:0,headingPitchRoll:new Cesium.HeadingPitchRoll(0,0,0)}),D.push({lon:M,lat:b,rollDeg:L,mtFlightData:m})}setInterval(function(){var R=new Date().getTime();R+=2e3;for(var N=0;N<D.length;N++){if(D[N].lat+=.05,D[N].rollDeg=L,D[N].mtFlightData.timeAttitudeCollection=[],v){var B=t.viewer.scene.globe.getHeight(Cesium.Cartographic.fromDegrees(D[N].lon,D[N].lat));u=Cesium.defined(B)?B:u}D[N].mtFlightData.addTimeAttitude({realTime:R,fLon:D[N].lon,fLat:D[N].lat,fAlt:u,position:Cesium.Cartesian3.fromDegrees(D[N].lon,D[N].lat,u),nRedOrBlue:0,headingPitchRoll:new Cesium.HeadingPitchRoll(0,0,Cesium.Math.toRadians(D[N].rollDeg))}),t.ev_mtMgr.addMovingTargetTimeAttitude(D[N].mtFlightData.uId,D[N].mtFlightData)}},y),C&&(this.rectSector=new T1({openSectorPyramid:!0,forwardDis:S,radius:A}),this.viewer.scene.primitives.add(this.rectSector),t.viewer.scene.preRender.addEventListener(function(){var R=t.ev_mtMgr.curTimeMovingTargets.filter(function(G){return G.name=="plane"});if(R.length!=0){for(var N=[],B=0;B<R.length;B++)N.push({position:R[B].position,scale:new Cesium.Cartesian3(R[B].scale,R[B].scale,R[B].scale),headingPitchRoll:new Cesium.HeadingPitchRoll(0,-1.57,0),color:E||R[B].sectorRadarColor});t.rectSector.resetRadarByPositionProperty(N)}})),this.trainingClock&&!this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!0,this.trainingClock.tick())};WA.prototype.transDataByXml=function(e){let t=e.mtData.movingTargetFlightData,n=this;if(t.length>0){for(let s=0;s<t.length;s++){let u=t[s],l=u.timeAttitudeCollection,c=new Pu({uId:u.uId,mtType:Number(u.mtType),name:u.name,modelType:u.modelType,modelUri:Cesium.buildModuleUrl(u.modelUri),modelIconUri:Cesium.buildModuleUrl(u.modelIconUri),modelIconDisplayDistance:new Cesium.DistanceDisplayCondition(Number(u.modelIconDisplayDistance[0],u.modelIconDisplayDistance[1])),modelIconScale:u.modelIconScale,scale:Number(u.scale),specialAttributes:u.specialAttributes,ribbonVisible:JSON.parse(u.ribbonVisible),forwardOffset:Number(u.forwardOffset),upOffset:Number(u.upOffset),traceTimeDuration:Number(u.traceTimeDuration),sectorRadarVisible:JSON.parse(u.sectorRadarVisible),wallVisible:JSON.parse(u.wallVisible),lineVisible:JSON.parse(u.lineVisible)});for(let f=0;f<l.length;f++){let h=l[f];c.addTimeAttitude({realTime:Number(h.realTime),fLon:Number(h.fLon),fLat:Number(h.fLat),fAlt:Number(h.fAlt),position:new Cesium.Cartesian3(Number(h.position.x),Number(h.position.y),Number(h.position.z)),nRedOrBlue:h.nRedOrBlue,headingPitchRoll:new Cesium.HeadingPitchRoll(Number(h.headingPitchRoll.heading),Number(h.headingPitchRoll.pitch),Number(h.headingPitchRoll.roll))})}n.ev_mtMgr.addMovingTargetTimeAttitude(u.uId,c),n.ev_mtMgr.enableSilhouette(Cesium.Color.BLUE,u.uId)}this.trainingClock&&!this.trainingClock.shouldAnimate&&(this.trainingClock.shouldAnimate=!0,this.trainingClock.tick())}let r=e.paRadar;if(Cesium.defined(r)&&r instanceof Array)for(let s=0;s<r.length;s++){let u=r[s].position;new jg({viewer:this.viewer,position:new Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),radius:Number(r[s].radius),xHalfAngle:Number(r[s].xHalfAngle),yHalfAngle:Number(r[s].yHalfAngle)})}let o=e.gltfModel;if(o&&o instanceof Array)for(let s=0;s<o.length;s++){let u=o[s].position,l=o[s].model;this.viewer.entities.add({position:new Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),model:{uri:Cesium.buildModuleUrl(l.uri),scale:Number(l.scale)}})}let a=e.mechanicalRadar;if(a&&a instanceof Array)for(let s=0;s<a.length;s++){let u=a[s].position,l=a[s].filePath;new Kg({viewer:this.viewer,position:Cesium.Cartesian3.fromDegrees(Number(u[0]),Number(u[1]),Number(u[2])),showScan:Number(a[s].showScan),scanSpeed:Number(a[s].scanSpeed),filePath:Cesium.buildModuleUrl(a[s].filePath),radius:Number(a[s].radius),isDepthTest:Number(a[s].isDepthTest)})}};WA.prototype.addRadarPyramid=function(e){let t=this.ev_mtMgr.ev_MTFlightDatas._array;for(let r=0;r<t.length;r++){let o=t[r].uId;var n=e.entities.add({id:o+"py",position:new Cesium.Cartesian3.fromDegrees(117,31.5,1e3),cylinder:{length:1e4,topRadius:0,bottomRadius:5e3,slices:4,material:Cesium.Color.RED}})}};WA.prototype.addReceiveDataListener=function(){};var die=WA;var gie=Vg(mie(),1);function y_(e){this.olMap=e.olMap,this.index=void 0,this.activeLayer={},this.clickDraw=void 0,this.style=void 0}y_.prototype.addClickDraw=function(e,t){let n=e.geometryType,r=e.vectorLayerId,o=this.getLayer(r),a=this;this.setClassStyle({fillColor:"rgba(0, 192, 51, 0.4)",strokeColor:"rgba(0, 192, 51, 1)",strokeWidth:1,imageRadius:4,imageColor:"rgba(0, 192, 51, 1)"}),this.olMap.removeInteraction(this.clickDraw),s(n,o);function s(u,l){let c=u,f=l;if(c!=="None"){let h,d;c==="Square"&&(c="Circle",h=ol.interaction.Draw.createRegularPolygon(4)),c==="Rectangle"&&(c="Circle",h=ol.interaction.Draw.createBox()),a.clickDraw=new ol.interaction.Draw({source:f,type:c,geometryFunction:h,maxPoints:d}),a.olMap.addInteraction(a.clickDraw)}else f.clear()}a.clickDraw.on("drawend",function(u){if(u.feature.setStyle(a.style),a.olMap.updateSize(),t&&typeof t=="function"){let l=[];u.feature.getGeometry().getCoordinates()?l=u.feature.getGeometry().getCoordinates():u.feature.getGeometry().getFlatCoordinates().forEach(function(f,h){h%2===0&&(l[Math.floor(h/2)]=[]),l[Math.floor(h/2)].push(f)}),t({feature:u.feature,positions:l})}})};y_.prototype.addDataDraw=function(e,t){let n=e.geometryType,r=e.positions,o=e.vectorLayerId,a=this.getLayer(o),s=e.id;if(this.index!==s.split("_")[1]*1)this.index=s.split("_")[1]*1;else{let c=a.getFeatureById(s);a.removeFeature(c)}let u;switch(n){case"Point":u=new ol.Feature({geometry:new ol.geom.Point(r)}),u.setId(s);break;case"LineString":u=new ol.Feature({geometry:new ol.geom.LineString(r)}),u.setId(s);break;case"Polygon":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Square":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Rectangle":u=new ol.Feature({geometry:new ol.geom.Polygon([r])}),u.setId(s);break;case"Circle":{let c=r[0],f=this.getRadius(r[2]);console.log(f),u=new ol.Feature({geometry:new ol.geom.Circle(c,f)}),u.setId(s);break}case"Ellipse":{let c=r[0],f=r[3]/1e5,h=r[4]/1e5,d=new ol.geom.Circle(c,f),p=ol.geom.Polygon.fromCircle(d,64);p.scale(1,h/f),u=new ol.Feature({geometry:p});let g=new ol.style.Style({fill:new ol.style.Fill({color:"#01fe01"}),stroke:new ol.style.Stroke({color:"#ff0000",lineCap:"round",width:0})});u.setStyle(g),u.setId(s);break}default:break}a.getFeatureById(u.getId())&&a.removeFeature(gie),a.addFeature(u),t(u)};y_.prototype.setClassStyle=function(e){let t=e.fillColor||"#00bf00",n=e.strokeColor||"#00c033",r=e.strokeWidth||2,o=e.imageRadius||6,a=e.imageColor||"#00c033";this.style=new ol.style.Style({fill:new ol.style.Fill({color:t}),stroke:new ol.style.Stroke({color:n,width:r}),image:new ol.style.Circle({radius:o,fill:new ol.style.Fill({color:a})})})};y_.prototype.getAuxAniStyle=function(e){return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0, 192, 51, 0.2"}),stroke:new ol.style.Stroke({color:"#00c033",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})})};y_.prototype.getLayer=function(e){let t=this.olMap.getAllLayers();for(let n=0;n<t.length;n++)if(t[n].get("layerId")===e)return t[n].getSource()};y_.prototype.deleteFeature=function(e,t,n){let r=this.getLayer(t),o=r.getFeatureById(n);r.removeFeature(o)};y_.prototype.getRadius=function(e){let t=this.olMap.getView().getProjection().getMetersPerUnit();return e/t};var PR=y_;function ow(e){this.olMap=e.olMap,this.olManagerMap=void 0;let t=this;this.olFeatures=new Proxy({size:0},{set:function(n,r,o){if(r!=="size"){let a;return o.getId()?a=o.getId():(a=t.createGuid(),o.setId(a)),t.olManagerMap.get(window.activeGroup).get(window.activeLayerId).features.push(a),n[a]=o,n.size=n.size+1,!0}return!0}})}ow.prototype.initMap=function(){this.olManagerMap=void 0,this.olManagerMap=new Map,this.addGroup("defaultGroup"),window.activeGroup="defaultGroup",window.olManagerMap=this.olManagerMap};ow.prototype.addGroup=function(e){let t=new Map;this.olManagerMap.set(e,t)};ow.prototype.addLayer=function(e,t){let n={features:[]};this.olManagerMap.get(e).set(t,n)};ow.prototype.addFeature=function(e){this.olFeatures.feature=e};ow.prototype.createGuid=_i;var MR=ow;function LR(e){this.olMap=e.olMap,this.ev_OlDrawPrimitives=new PR({olMap:this.olMap}),this.ev_OlPriManager=new MR({olMap:this.olMap}),window.activeGroup=void 0,window.activeLayerId=void 0,this.olFeaturesCopy=void 0}LR.prototype.clickDraw=function(e,t){if(e==="Ellipse")return;(!window.activeLayerId||!window.activeGroup)&&this.drawInit();let n=window.activeLayerId,r=this;this.ev_OlDrawPrimitives.addClickDraw({geometryType:e,vectorLayerId:n},function(o){console.log(o);let a=o.feature,s=o.positions;r.ev_OlPriManager.addFeature(a),t({positions2D:s,id:a.getId()})})};LR.prototype.dataDraw=function(e){(!window.activeLayerId||!window.activeGroup)&&this.drawInit();let t=e.geometryType,n=e.positions,r=e.id,o=window.activeLayerId,a=this;this.ev_OlDrawPrimitives.addDataDraw({geometryType:t,vectorLayerId:o,positions:n,id:r},function(s){a.ev_OlPriManager.addFeature(s)})};LR.prototype.drawInit=function(){this.ev_OlPriManager.initMap();let e=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(188, 0, 0,0.4)"}),stroke:new ol.style.Stroke({color:"rgba(188, 0, 0,1)",width:2}),image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#00c033"})})})}),t="defaultLayer";e.set("layerId",t),this.olMap.addLayer(e),this.ev_OlPriManager.addLayer("defaultGroup",t),window.activeLayerId=t};var _ie=LR;function YA(e){this.viewer=e.viewer,this.mapId="OlMap",this.mapDiv=void 0,this.brotherDiv=void 0,this.olMap=void 0,this.isActive=!1,this.isIn2DMapFlag=!1,this.flag=!0;let t=this;this._changeCenterListener=function(){if(t.isIn2DMapFlag){let n=t.olMap.getView().calculateExtent();t.viewer.camera.setView({destination:ln.fromDegrees(n[0],n[1],n[2],n[3])})}},this._getViewCameraRectrange=function(){let n=t.viewer.camera.computeViewRectangle(),r=n.west/Math.PI*180,o=n.north/Math.PI*180,a=n.east/Math.PI*180,s=n.south/Math.PI*180;if(!t.isIn2DMapFlag)if(o>87&&s<-87){let u=t._getCenterPosition(t.viewer);t.olMap.getView().setZoom(0),t.olMap.getView().setCenter([u.lon,u.lat])}else{if(r>a){let u=r;r=a,a=u}t.olMap.getView().fit([r,s,a,o])}},this._mouseMoveEvent=function(n){t.isIn2DMapFlag=t.isMouseIn2DMap(n.pageX,n.pageY)},this.isMouseIn2DMap=function(n,r){let o=t.mapDiv.offsetTop,a=o+t.mapDiv.clientHeight,s=t.mapDiv.offsetLeft,u=s+t.mapDiv.clientWidth;return!(n<s||n>u||r<o||r>a)},this._getCenterPosition=function(n){let r=n.camera.pickEllipsoid(new X(n.canvas.clientWidth/2,n.canvas.clientHeight/2)),o=Ge.WGS84.cartesianToCartographic(r),a=o.longitude*180/Math.PI,s=o.latitude*180/Math.PI;return{lon:a,lat:s}}}YA.prototype.create2DMap=function(e){let t=e.brotherDivId,n=e.around||"left",r=e.scale,o=this;a(),s(),this.set2DMapSize(r);function a(){o.mapDiv=document.createElement("div"),o.mapDiv.setAttribute("id",o.mapId),o.mapDiv.style.width="0%",o.mapDiv.style.height="100%",o.mapDiv.style.position="relative",o.brotherDiv=document.getElementById(t),n==="left"?o.brotherDiv.parentNode.insertBefore(o.mapDiv,o.brotherDiv):n==="right"?o.brotherDiv.parentNode.insertBefore(o.brotherDiv,o.mapDiv):console.error("around default")}function s(){let u=new ol.layer.Tile({source:new ol.source.OSM});o.olMap=new ol.Map({layers:[u],target:o.mapId,view:new ol.View({center:[91.1,30.41],zoom:4,projection:"EPSG:4326",maxZoom:22})}),o.olMap.updateSize(),window.olMap=o.olMap;let l=document.createElement("canvas");qze(l);let c=document.createElement("div"),f=new Image;f.src=l.toDataURL("image/png");let h="padding: 256px 512px;  border-radius: 16px;  background-color: rgba(0, 0, 0, 0.5); position: relative; background-image:url(";c.style=`${h+f.src});`;let d=new ol.Overlay({id:"licenseOverlayEleID",positioning:"center-center",position:o.olMap.getView().getCenter(),element:c}),p=function(){d.setPosition(o.olMap.getView().getCenter())};if(o.viewer.scene.licensePromise){let g=!1;o.olMap.getOverlays().forEach(function(y){y.getId()==="licenseOverlayEleID"&&(g=!0)}),g||(o.olMap.addOverlay(d),o.olMap.getView().addChangeListener("center",p)),o.viewer.scene.licensePromise.promise.then(function(){o.olMap.getView().removeChangeListener("center",p),o.olMap.removeOverlay(d)},function(){})}}return this.olMap};YA.prototype.set2DMapSize=function(e){if(!e&&e!==0)this.brotherDiv.parentNode.style.display="flex",this.mapDiv.style.width="100%",this.brotherDiv.style.width="0%",this.olMap.updateSize();else{let t=`${e}%`,n=`${100-e}%`;this.mapDiv.style.width=t,this.brotherDiv.style.width=n,this.olMap.updateSize()}};YA.prototype.enable2DAnd3DLinkage=function(){this.mapDiv.style.visibility="visible",this.olMap.getView().on("change:center",this._changeCenterListener),this.olMap.updateSize(),this.mapDiv.parentElement.addEventListener("mousemove",this._mouseMoveEvent),this.viewer.scene.preRender.addEventListener(this._getViewCameraRectrange)};YA.prototype.disable2DAnd3DLinkage=function(){this.olMap.getView().un("change:center",this._changeCenterListener),this.viewer.scene.preRender.removeEventListener(this._getViewCameraRectrange),this.mapDiv.parentElement.removeEventListener("mousemove",this._mouseMoveEvent)};function v_(e){if(!e)return;let t=e.split("\\u"),n="";for(let r=0;r<t.length;r++){let o=t[r];o.length>0&&(n+=String.fromCharCode(parseInt(o,16).toString(10)))}return n}function qze(e){e.style.width="512px",e.style.height="256px",e.width=512*2,e.height=256*2;let t=e.getContext("2d");t.scale(2,2),t.fillStyle="rgba(127,127,127,0)",t.font="bold 26px Arial",t.fillStyle="white";let n="\\u45\\u56\\u2d\\u47\\u6c\\u6f\\u62\\u65\\u20\\u57\\u65\\u62\\u47\\u4c\\u20\\u56\\u32\\u2e\\u30";t.fillText(v_(n),23,80),t.font="14px SimHei",n="\\u5317\\u4eac\\u56fd\\u9065\\u65b0\\u5929\\u5730\\u4fe1\\u606f\\u6280\\u672f\\u6709\\u9650\\u516c\\u53f8",t.fillText(v_(n),23,147),t.font="14px Arial",n="\\u28\\u43\\u6f\\u70\\u79\\u52\\u69\\u67\\u68\\u74\\u29\\u32\\u30\\u31\\u33\\u2d\\u32\\u30\\u32\\u32\\u7248\\u6743\\u6240\\u6709",t.fillText(v_(n),23,172),n="\\u68\\u74\\u74\\u70\\u3a\\u2f\\u2f\\u77\\u77\\u77\\u2e\\u65\\u76\\u2d\\u69\\u6d\\u61\\u67\\u65\\u2e\\u63\\u6f\\u6d",t.fillText(v_(n),23,197),n="\\u38\\u36\\u2d\\u31\\u30\\u2d\\u36\\u34\\u38\\u37\\u36\\u36\\u35\\u35",t.fillText(v_(n),23,222),t.fillStyle="red",t.font="24px SimHei",n="\\u672a\\u6388\\u6743\\u7248\\u672c",t.fillText(v_(n),360,80),t.font="14px SimHei",n="\\u8bf7\\u8054\\u7cfb\\u5382\\u5546\\u8d2d\\u4e70",t.fillText(v_(n),385,197),n="\\u6b63\\u5f0f\\u7248\\u6388\\u6743",t.fillText(v_(n),410,222)}var yie=YA;function aV(e){if(!_(e))throw new Le("\u53C2\u6570options\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!_(e.viewer))throw new Le("Viewer\u5BF9\u8C61options.viewer\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!_(e.startPoint))throw new Le("\u7BA1\u9053\u5F00\u59CB\u5750\u6807\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(!_(e.endPoint))throw new Le("\u7BA1\u9053\u7ED3\u675F\u5750\u6807\u4E0D\u80FD\u4E3A\u7A7A\u3002");if(_(e.geos)&&_(e.radiusArray)&&e.geos.length!==e.radiusArray.length)throw new Le("\u7BA1\u9053\u70B9\u7684\u6570\u91CF\u548C\u534A\u5F84\u6570\u91CF\u4E0D\u4E00\u81F4\u3002");this._viewer=e.viewer,this.color=T(e.color,new K(1,0,0,1)),this.show=T(e.show,!0),this._center=new x,this.startPoint=e.startPoint,this.endPoint=e.endPoint,this.minH=T(e.minH,0),this.maxH=T(e.maxH,2e3),this.countRdii=T(e.countRdii,1),this.lineCount=T(e.lineCount,36),this.radius=T(e.radius,500),this.radiusArray=T(e.radiusArray,[]),this.radii=T(e.radii,1),this.keyPts=[],this.geos=T(e.geos,[]),this.geos.length===0&&Yze(this.startPoint,this.endPoint,this.minH,this.maxH,200,this.geos);for(let t=0;t<this.geos.length;++t){let n={};n.geo=this.geos[t],this.radiusArray.length===0?n.R=this.radius:n.R=this.radiusArray[t],n.r=n.R*this.radii,this.keyPts.push(n)}this.center=x.ZERO,this.keyPts.length>0&&(this.center=this.keyPts[0].geo),this._command=new Zt({owner:this,pass:Qt.OPAQUE,primitiveType:rn.LINES,renderState:un.fromCache({blending:za.ALPHA_BLEND,depthTest:{enabled:!0,func:o0.LESS_OR_EQUAL},depthMask:!1})}),this._viewer.scene.primitives.add(this)}aV.prototype.update=function(e){let t=e.mode,n=e.context;if(!this.show||t!==Ne.SCENE3D)return;if(this._boundingSphere=new Ee(x.ZERO,this.radius),_(this._modelMatrix)||(this._modelMatrix=yn.eastNorthUpToFixedFrame(this.startPoint)),_(this._command.shaderProgram)||(this._command.shaderProgram=vi.fromCache({context:n,vertexShaderSource:Kze(),fragmentShaderSource:Zze()})),!_(this._command.vertexArray)){let a=Wze(this);this._command.vertexArray=Xze(this,n,a)}let r=e.commandList;e.passes.render&&r.push(this._command)};aV.prototype.remove=function(){let e=this._command;if(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._viewer.scene.primitives.contains(this)){let t=this._viewer.scene.primitives._primitives.indexOf(this);t!==-1&&(this._viewer.scene.primitives._primitives.splice(t,1),delete this._external._composites[this._viewer.scene.primitives._guid])}return ot(this)};function Wze(e){let t=e.lineCount,n=360/t,r=[],o=[];for(let v=0;v<e.keyPts.length;v++){let w=e.keyPts[v].geo;r.push(w)}for(let v=0;v<e.keyPts.length;v++){let w=e.keyPts[v].R,C=e.keyPts[v].r,E=yn.eastNorthUpToFixedFrame(r[v]),S=new je;if(v===0){let M=U.multiplyByPoint(U.inverse(E,new U),r[1],new x),I=U.multiplyByPoint(U.inverse(E,new U),r[0],new x),O=x.subtract(M,I);S=xie(x.UNIT_Y,O,new je)}else{let M=U.multiplyByPoint(U.inverse(E,new U),r[v],new x),I=U.multiplyByPoint(U.inverse(E,new U),r[v-1],new x),O=x.subtract(M,I);S=xie(x.UNIT_Y,O,new je)}let A=ne.fromQuaternion(S,new ne),D=[];for(let M=0;M<t+1;M++){let I=Math.toRadians(M*n),O=new x(C*Math.cos(I),0,w*Math.sin(I)),m=ne.multiplyByVector(A,O,new x),b=U.multiplyByPoint(E,m,new x);D.push(b)}let P=new x(0,0,0);P=ne.multiplyByVector(A,P,new x),P=U.multiplyByPoint(E,P,new x),D.push(P),o.push(D)}let a=e.color,s=o.length*(t+1),u=o.length*t*4,l=Rr.createTypedArray(s,u),c=new Float64Array(s*3),f=new Uint8Array(s*4),h=0,d=0,p=0,g,y;e.countRdii===0?g=o.length:(y=(o.length-1)/(o.length*e.countRdii-1),g=0);for(let v=0;v<o.length;v++){for(let w=0;w<t+1;w++){let C=x.subtract(o[v][w],e.center);c[h++]=C.x,c[h++]=C.y,c[h++]=C.z,f[d++]=K.floatToByte(a.red),f[d++]=K.floatToByte(a.green),f[d++]=K.floatToByte(a.blue),f[d++]=K.floatToByte(a.alpha),w<t&&((v>=g||v===o.length-1&&e.countRdii!==0)&&(l[p++]=v*(t+1)+w,l[p++]=v*(t+1)+w+1),v<o.length-1&&(l[p++]=v*(t+1)+w,l[p++]=v*(t+1)+w+(t+1)))}v>=g&&(g+=y)}return{position:c,color:f,indices:l}}function Yze(e,t,n,r,o,a){if(o<2)return;let s=ce.fromCartesian(e,Ge.WGS84),u=Math.toDegrees(s.longitude),l=Math.toDegrees(s.latitude),c=ce.fromCartesian(t,Ge.WGS84),f=Math.toDegrees(c.longitude),h=Math.toDegrees(c.latitude),d=vie(l,u,h,f,.5),p=Cie(l,u,d.latitude,d.longitude),g;p>0&&(g=(n-r)/(p*p));for(let y=0;y<o;y++){let v=vie(l,u,h,f,y/(o-1));p=Cie(v.latitude,v.longitude,d.latitude,d.longitude);let w=g*p*p+r,C=x.fromDegrees(v.longitude,v.latitude,w);a.push(C)}}function vie(e,t,n,r,o){let a,s;if(Math.abs(o)<1e-6)return a=e,s=t,{latitude:e,longitude:t};let u=x.fromDegrees(t,e);u=x.normalize(u);let l=x.fromDegrees(r,n);l=x.normalize(l);let c=Math.acos(x.dot(u,l));if(isNaN(c))return a=e,s=t,{latitude:e,longitude:t};let f=x.cross(u,l,new x);if(isNaN(f.x)||isNaN(f.y)||isNaN(f.z))return a=e,s=t,{latitude:e,longitude:t};f=x.normalize(f,new x);let h=je.fromAxisAngle(f,c*o),d=ne.fromQuaternion(h,new ne),p=ne.multiplyByVector(d,u,new x);p=x.normalize(p);let g=ce.fromCartesian(p,Ge.WGS84);return a=Math.toDegrees(g.latitude),s=Math.toDegrees(g.longitude),{latitude:a,longitude:s}}function Cie(e,t,n,r){let o=Math.toRadians(e),a=Math.toRadians(t),s=Math.toRadians(n),u=Math.toRadians(r);return Math.acos(Math.cos(o)*Math.cos(s)*Math.cos(a-u)+Math.sin(o)*Math.sin(s))}function xie(e,t,n){if(e instanceof x&&e instanceof x){_(n)||(n=new je(je.IDENTITY));let r=e.clone(),o=t.clone();r=x.normalize(r,r),o=x.normalize(o,o);let a=x.dot(r,o,void 0);if(a>=1)return n;if(a<1e-6-1){let s=new x;s=x.cross(x.UNIT_X,e,s),x.magnitudeSquared(s)<1e-6*1e-6&&(s=x.cross(x.UNIT_Y,e,s)),s=x.normalize(s,s),n=je.fromAxisAngle(s,Math.toRadians(Math.PI),n)}else{let s=Math.sqrt((1+a)*2),u=1/s,l=new x;l=x.cross(r,o,l),n.x=l.x*u,n.y=l.y*u,n.z=l.z*u,n.w=s*.5,n=je.normalize(n,n)}return n}}function Xze(e,t,n){let r=jze(e),o=ki.createVertexBuffer({context:t,typedArray:r,usage:We.STATIC_DRAW}),a=12,s=ie.getSizeInBytes(ie.FLOAT),u={czm_modelMatrixRow0:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:s*a,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:o,componentsPerAttribute:4,componentDatatype:ie.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:s*a,instanceDivisor:1}},l=0,c=[];return c.push({index:l++,vertexBuffer:ki.createVertexBuffer({context:t,typedArray:ie.createTypedArray(ie.FLOAT,new Float64Array(n.position.buffer)),usage:We.STATIC_DRAW}),componentDatatype:ie.FLOAT,componentsPerAttribute:3,normalize:!1}),c.push({index:l++,vertexBuffer:ki.createVertexBuffer({context:t,typedArray:ie.createTypedArray(ie.UNSIGNED_BYTE,new Uint8Array(n.color.buffer)),usage:We.STATIC_DRAW}),componentDatatype:ie.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}),u.czm_modelMatrixRow0.index=l++,c.push(u.czm_modelMatrixRow0),u.czm_modelMatrixRow1.index=l++,c.push(u.czm_modelMatrixRow1),u.czm_modelMatrixRow2.index=l++,c.push(u.czm_modelMatrixRow2),new Kh({context:t,attributes:c,indexBuffer:ki.createIndexBuffer({context:t,typedArray:new Uint16Array(n.indices.buffer),usage:We.STATIC_DRAW,indexDatatype:Rr.UNSIGNED_SHORT})})}function jze(e){let t=e._center,n=12,r=e._vertexBufferTypedArray;_(r)||(r=new Float32Array(n));let o=[],a=e._modelMatrix,s=U.fromTranslation(U.getTranslation(a,new x));return s[12]-=t.x,s[13]-=t.y,s[14]-=t.z,o.push(new x(s[12],s[13],s[14])),r[0]=s[0],r[1]=s[4],r[2]=s[8],r[3]=s[12],r[4]=s[1],r[5]=s[5],r[6]=s[9],r[7]=s[13],r[8]=s[2],r[9]=s[6],r[10]=s[10],r[11]=s[14],r}function Kze(){return`attribute vec3 position;
attribute vec4 color; 
attribute vec4 czm_modelMatrixRow0; 
attribute vec4 czm_modelMatrixRow1; 
attribute vec4 czm_modelMatrixRow2; 
varying vec4  v_colour;
void main()
{
    v_colour = vec4(color.r, color.g, color.b, color.a); 
    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0,
                            czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, 
                            czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, 
                            czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0); 
    gl_Position = czm_viewProjection * czm_instanced_model*  vec4(position.xyz, 1.0);   
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`}function Zze(){return`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`}var wie=aV;function C_(e,t,n,r,o,a,s){this.provider=e,this.message=t,this.x=n,this.y=r,this.level=o,this.timesRetried=T(a,0),this.retry=!1,this.error=s}C_.reportError=function(e,t,n,r,o,a,s,u){let l=e;return _(e)?(l.provider=t,l.message=r,l.x=o,l.y=a,l.level=s,l.retry=!1,l.error=u,++l.timesRetried):l=new C_(t,r,o,a,s,0,u),n&&n.numberOfListeners>0&&n.raiseEvent(l),l};C_.handleError=function(e,t,n,r,o,a,s,u,l){nl("TileProviderError.handleError","TileProviderError.handleError was deprecated in CesiumJS 1.96 and will be removed in 1.97. Use TileProviderError.reportError instead.");let c=C_.reportError(e,t,n,r,o,a,s,l);return c.retry&&_(u)&&u(),c};C_.reportSuccess=function(e){_(e)&&(e.timesRetried=-1)};C_.handleSuccess=function(e){nl("TileProviderError.handleSuccess","TileProviderError.handleSuccess was deprecated in CesiumJS 1.96 and will be removed in 1.97. Use TileProviderError.reportSuccess instead."),C_.reportSuccess(e)};var sV=C_;function aw(){this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,Le.throwInstantiationError()}Object.defineProperties(aw.prototype,{ready:{get:Le.throwInstantiationError},readyPromise:{get:Le.throwInstantiationError},rectangle:{get:Le.throwInstantiationError},tileWidth:{get:Le.throwInstantiationError},tileHeight:{get:Le.throwInstantiationError},maximumLevel:{get:Le.throwInstantiationError},minimumLevel:{get:Le.throwInstantiationError},tilingScheme:{get:Le.throwInstantiationError},tileDiscardPolicy:{get:Le.throwInstantiationError},errorEvent:{get:Le.throwInstantiationError},credit:{get:Le.throwInstantiationError},proxy:{get:Le.throwInstantiationError},hasAlphaChannel:{get:Le.throwInstantiationError}});aw.prototype.getTileCredits=function(e,t,n){Le.throwInstantiationError()};aw.prototype.requestImage=function(e,t,n,r){Le.throwInstantiationError()};aw.prototype.pickFeatures=function(e,t,n,r,o){Le.throwInstantiationError()};var Qze=/\.ktx2$/i;aw.loadImage=function(e,t){let n=_t.createIfNeeded(t);return Qze.test(n.url)?Dm(n):_(e)&&_(e.tileDiscardPolicy)?n.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}):n.fetchImage({preferImageBitmap:!0,flipY:!0})};var Eie=aw;function XA(e){e=T(e,T.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let t=_t.createIfNeeded(e.url),n=T(e.rectangle,ln.MAX_VALUE),r=new TI({rectangle:n,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=r,this._resource=t,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new xe,this._ready=!1;let o=e.credit;typeof o=="string"&&(o=new dS(o)),this._credit=o;let a=this,s;function u(f){return a._image=f,a._tileWidth=f.width,a._tileHeight=f.height,a._ready=!0,sV.reportSuccess(a._errorEvent),Promise.resolve(!0)}function l(f){let h=`Failed to load image ${t.url}.`;return s=sV.reportError(s,a,a._errorEvent,h,0,0,0),s.retry?c():Promise.reject(new it(h))}function c(){return Eie.loadImage(null,t).then(u).catch(l)}this._readyPromise=c()}Object.defineProperties(XA.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});XA.prototype.getTileCredits=function(e,t,n){};XA.prototype.requestImage=function(e,t,n,r){if(!!_(this._image))return Promise.resolve(this._image)};XA.prototype.pickFeatures=function(e,t,n,r,o){};var Tie=XA;function Jze(e,t){t.stats===!1?(e.globe.imageryLayers.length!==0?e.globe.imageryLayers.get(0).alpha=1:e.globe.imageryLayers.addImageryProvider(new Tie({url:t.url})),t.color!==void 0&&(e.globe.baseColor=t.color)):t.stats===!0?(e.globe.imageryLayers.removeAll(),e.globe.baseColor=t.color):(e.globe.imageryLayers.get(0).alpha=0,e.globe.baseColor=t.color)}var Sie=Jze;function jA(e){this.viewer=e,this.pyramidList=new Va,this.polygonList=void 0,this.position=void 0,this.yawAngle=void 0}jA.prototype.addPyramid=function(e){let t=this;t.positionCallback=e.position,t.polygonList=e.polygonList;let n=e.id,r=[],o=$ze({viewer:t.viewer,color:e.color,Large_angle:e.Large_angle,small_angle:e.small_angle,len:e.len,positionCallback:e.position,id:e.id,pitch_angle:e.pitch_angle});r.push(o),t.pyramidList.set(n,r)};jA.prototype.removepyramid=function(e){let t=this,n=t.pyramidList.get(e);for(let r=0;r<n.length;r++)t.viewer.entities.remove(n[r]);t.pyramidList.remove(e),t.pyramidListCoor.remove(e),t.pyramidListCoorChange.remove(e),t.underPolygonCoor.remove(e),t.underPolygonCoorChange.remove(e)};jA.prototype.removeAll=function(){let e=this;for(let t in e.pyramidList._hash)for(let n=0;n<e.pyramidList.get(t).length;n++)e.viewer.entities.remove(e.pyramidList.get(t)[n]),n--;e.pyramidListCoor.removeAll(),e.pyramidListCoorChange.removeAll(),e.underPolygonCoor.removeAll(),e.underPolygonCoorChange.removeAll()};jA.prototype.updatepyramid=function(){};function RR(e,t,n,r,o){let a=yn.eastNorthUpToFixedFrame(e),s=new ne.fromRotationZ(z.toRadians(n)),u=ne.fromRotationY(z.toRadians(r)),l=ne.multiply(s,u,new ne),c=U.fromRotationTranslation(l),f=new Fc(o.x,o.y,o.z),h=je.fromHeadingPitchRoll(f,new je),d=U.fromTranslationQuaternionRotationScale(new x(0,0,0),h,new x(1,1,1));return U.multiply(d,c,c),U.multiply(a,c,a),U.multiplyByPoint(a,new x(t,0,0),new x)}function $ze(e){let t=e.viewer,n=e.color,r=e.id,o=e.small_angle,a=e.len,s=e.positionCallback,u=e.pitch_angle;return t.entities.add({name:r,polygon:{hierarchy:new Ks(function(){let c=s.getValue().position,f=s.getValue().hpr,h=[c],d=[];if(c!==void 0){for(let p=0;p<4;p++){let g;p===0?g=RR(c,a,o,u,f):p===1?g=RR(c,a,180-o,u,f):p===2?g=RR(c,a,180+o,u,f):g=RR(c,a,360-o,u,f),h.push(g);let y=e4e(c,g,t);y!==void 0&&d.push(y)}if(d.length===4)return{positions:d}}},!1),material:n,clampToGround:!0}})}function e4e(e,t,n){let r=new x,o=x.normalize(x.subtract(t,e,r),r),a=new q_(e,o);return n.scene.globe.pickWorldCoordinates(a,n.scene,new x)}var Aie=jA;function uw(e){this.geometry=void 0,this.blUpdateVAO=!1,this.originColor=new Cesium.Color(0,1,0,1),this.outdatedColor=new Cesium.Color(1,0,0,1),this._curMillisecTime=9466848e5,this.boundingSphere=void 0,this._mode=void 0;var t=this;this._command=new Cesium.DrawCommand({pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.LINES,modelMatrix:Cesium.Matrix4.IDENTITY,owner:this,renderState:Cesium.RenderState.fromCache({blending:Cesium.BlendingState.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0,func:Cesium.DepthFunction.LESS_OR_EQUAL}}),uniformMap:{u_originColor:function(){return t.originColor},u_outdatedColor:function(){return t.outdatedColor},u_curMillisecTime:function(){var n=Math.floor(t._curMillisecTime/1e6),r=t._curMillisecTime%1e6;return new Cesium.Cartesian2(n,r)}}})}Object.defineProperties(uw.prototype,{curMillisecTime:{get:function(){return this._curMillisecTime},set:function(e){this._curMillisecTime=e}}});var bie=new ce,uV=new ei,sw=new x;uw.prototype.recreateVertexArrays=function(e,t){this._mode=t.mode;var n=t.mapProjection,r=n.ellipsoid.maximumRadius*Cesium.Math.PI,o=e.length,a=0,s=0,u=[];if(e instanceof Array&&o>0){for(var l=0;l<o;l++)Cesium.defined(e[l])&&e[l].length>1&&(a+=(e[l].length-1)*2,s+=e[l].length,u.push(e[l]));for(var c=Cesium.IndexDatatype.createTypedArray(s,a),f=new Float32Array(s*3),h=new Float32Array(s*3),d=new Float32Array(s*2),p=void 0,g=0,y=0,v=0;v<u.length;v++){for(var w=0;w<u[v].length;w++){var C=u[v][w],E=void 0;w<u[v].length-1&&(c[g++]=y+w,c[g++]=y+w+1,E=u[v][w+1]);var S=C.position;if(this._mode==Cesium.SceneMode.SCENE2D){if(S=n.project(n.ellipsoid.cartesianToCartographic(C.position,bie)),S.z=0,Cesium.defined(E)){var A=n.project(n.ellipsoid.cartesianToCartographic(E.position,bie));(S.x>0&&A.x<0||S.x<0&&A.x>0)&&(c[g-1]=y+w)}Cesium.defined(p)?(sw=Cesium.Cartesian3.fromElements(S.z,S.x,S.y,sw),p=Cesium.BoundingSphere.expand(p,sw)):(sw=Cesium.Cartesian3.fromElements(S.z,S.x,S.y,sw),p=new Cesium.BoundingSphere(sw,200))}else Cesium.defined(p)?p=Cesium.BoundingSphere.expand(p,C.position):p=new Cesium.BoundingSphere(C.position,200);Cesium.EncodedCartesian3.fromCartesian(S,uV);var D=uV.high,P=uV.low;f[(y+w)*3]=D.x,f[(y+w)*3+1]=D.y,f[(y+w)*3+2]=D.z,h[(y+w)*3]=P.x,h[(y+w)*3+1]=P.y,h[(y+w)*3+2]=P.z,d[(y+w)*2]=Math.floor(C.millisecTime/1e6),d[(y+w)*2+1]=C.millisecTime%1e6}y+=u[v].length}this.traceMesh={position3DHigh:f,position3DLow:h,st:d,indices:c},Cesium.defined(p)&&(this.boundingSphere=p.clone()),this.blUpdateVAO=!0}else this.traceMesh=void 0,this.blUpdateVAO=!0};uw.prototype.update=function(e){var t=e.context,n=this._command,r=this;if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()&&this.blUpdateVAO&&n.vertexArray.destroy(),this.blUpdateVAO&&Cesium.defined(this.traceMesh)){var o=0,a=[];a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DHigh),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.position3DLow),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1}),a.push({index:o++,vertexBuffer:Cesium.Buffer.createVertexBuffer({context:t,typedArray:Cesium.ComponentDatatype.createTypedArray(Cesium.ComponentDatatype.FLOAT,this.traceMesh.st),usage:Cesium.BufferUsage.STATIC_DRAW}),componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1}),n.vertexArray=new Cesium.VertexArray({context:t,attributes:a,indexBuffer:Cesium.Buffer.createIndexBuffer({context:t,typedArray:this.traceMesh.indices,usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:this.traceMesh.position3DHigh.length/3>=Cesium.Math.SIXTY_FOUR_KILOBYTES?Cesium.IndexDatatype.UNSIGNED_INT:Cesium.IndexDatatype.UNSIGNED_SHORT})}),n._boundingVolume=this.boundingSphere,Cesium.defined(n.shaderProgram)||(n.shaderProgram=Cesium.ShaderProgram.fromCache({context:t,vertexShaderSource:t4e(),fragmentShaderSource:n4e()}))}if(Cesium.defined(n.vertexArray)&&!n.vertexArray.isDestroyed()){var s=e.commandList;s.push(n)}this.blUpdateVAO=!1};uw.prototype.isDestroyed=function(){return!1};uw.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),Cesium.destroyObject(this)};function t4e(){var e=`attribute vec3 positionHigh;
attribute vec3 positionLow;
attribute vec2 st;
uniform vec4 u_originColor; 
uniform vec4 u_outdatedColor; 
uniform vec2 u_curMillisecTime; 
varying vec4  v_colour;
const float SHIFT_LEFT16 = 65536.0;
void main()
{
    v_colour = u_originColor; 
    if(st.x < u_curMillisecTime.x ||(st.x <= u_curMillisecTime.x && st.y <= u_curMillisecTime.y)){
       v_colour = u_outdatedColor; 
    }
vec4 p;
if(czm_morphTime == 1.0){
  p = czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz);
}else if(czm_morphTime == 0.0){
  p = czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy);
}else{
  p = czm_columbusViewMorph(
  czm_translateRelativeToEye(positionHigh.zxy, positionLow.zxy),
  czm_translateRelativeToEye(positionHigh.xyz, positionLow.xyz),
  czm_morphTime);
}
  vec4 positionEC = czm_modelViewRelativeToEye * p;
  vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC); 
  vec4 positionWC = vec4(positionWindow.xy, -positionWindow.z, 1.0) * (czm_projection * positionEC).w;;
  gl_Position = czm_viewportOrthographic * positionWC;
    #ifdef LOG_DEPTH 
    czm_vertexLogDepth();
    #endif
}
`;return e}function n4e(){var e=`varying vec4  v_colour;
void main()
{
    gl_FragColor = v_colour;
}
`;return e}var Iie=uw;function lV(e){let t=this;this.ip=T(e.ip,"127.0.0.1:8080"),this._url=`http://${this.ip}/earthview/services/v/soap/networkservice/10000`,this._resource=new _t({url:t._url,headers:{"Content-Type":"text/plain;charset=UTF-8"}})}lV.prototype.getRoutePositions=function(e,t,n,r){let o=e,a=r4e(t),s=i4e(n),u=`<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/">
            <Body>
                <networkAnalystEx xmlns="http://network.web.services.server.earthview/">
                    <servicename xmlns="">${o}</servicename>${a}${s}</networkAnalystEx>
            </Body>
        </Envelope>`,l=`http://${this.ip}/earthview/services/v/soap/networkservice/10000`,c=this._resource.clone();c.url=l,c.post(u,{responseType:"text",overrideMimeType:"text/plain"}).then(function(f){let d=new DOMParser().parseFromString(f,"text/xml").getElementsByTagName("return"),p=[],g=JSON.parse(Array.from(d)[0].firstChild.nodeValue);Object.hasOwnProperty.call(g,"message")&&g.message==="ok"&&Object.getOwnPropertyNames(g.route).length&&Object.values(g.route).map(function(v){let C=v.line.match(/\(([^)]*)\)/);p=p.concat(C[1].replace(/ /g,",").split(",").map(function(E){return parseFloat(E)}))}),r&&r(p)}).catch(function(f){console.log(f)})};function r4e(e){let t="";for(let n=0;n<e.length;n++)t+='<stops xmlns="">Point(',t+=Math.toDegrees(e[n].longitude),t+=" ",t+=Math.toDegrees(e[n].latitude),t+=")</stops>";return t}function i4e(e){let t="";for(let n=0;n<e.length;n++)t+='<barriers xmlns="">Point(',t+=Math.toDegrees(e[n].longitude),t+=" ",t+=Math.toDegrees(e[n].latitude),t+=")</barriers>";return t}lV.prototype.queryPlaceName=function(e,t,n,r){let o=JSON.stringify({mapName:e,layerName:t,queryFileds:"*",cliped:"false",start:1,maxFeatures:1e3,filter:{type:"And",condition:[{queryType:"PropertyIsLike",propertyName:"NAME",value:n}]}}),a=`http://${this.ip}/earthview/services/${e}/MapService/WFS?service=${e}&request=getFeatureByJson`,s=this._resource.clone();s.url=a,s.post(o,{responseType:"text",overrideMimeType:"text/plain"}).then(function(u){r&&r(JSON.parse(u).result)}).catch(function(u){console.log(u)})};var Die=lV;function o4e(e,t){let n={msgType:-1,sID:0,planeType:0,datTime:0,satTime:0,msgLen:0},r=T(t,0);return n.msgType=e.getUint16(r,!0),n.sID=e.getUint16(r+2,!0),n.planeType=e.getUint32(r+4,!0),n.datTime=Pie(e,r+8),n.satTime=Pie(e,r+16),n.msgLen=e.getUint16(r+24,!0),n}function Pie(e,t){let n=e.getUint32(t,!0),r=e.getUint32(t+4,!0),o=n+Math.pow(2,32)*r;return Number.isSafeInteger(o)||console.warn(o,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),o}var sn=o4e;function a4e(e,t){this.SIZE=96,this.header=sn(e,t);let n=T(t,0),r=26+n;this.delayFlag=e.getUint8(r,!0),r+=1;let o=[];for(let l=0;l<7;l++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Hl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a;let u="";for(let l=0;l<10;l++)u=u+String.fromCharCode(e.getInt8(r,!0)),r+=1;u=u.replace(/\u0000/g,""),this.chFighterName=u,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fRoll=e.getFloat32(r,!0),r+=4,this.fPitch=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.decoyDrop=e.getUint8(r,!0),r+=1,this.enginePower=e.getUint8(r,!0),r+=1,this.trainPro=e.getUint8(r,!0),r+=1,this.height=e.getFloat32(r,!0),r+=4,this.vel_east=e.getFloat32(r,!0),r+=4,this.vel_north=e.getFloat32(r,!0),r+=4,this.vel_up=e.getFloat32(r,!0)}var lw=a4e;function s4e(e,t){this.SIZE=35,this.header=sn(e,t);let n=T(t,0),r=26+n;this.nMissileID=e.getUint32(r,!0),r+=4,this.chWeaponType=e.getInt32(r,!0),r+=4,this.dropMslNum=e.getUint8(r,!0)}var cw=s4e;function u4e(e,t){this.SIZE=50,this.header=sn(e,t);let n=T(t,0),r=26+n;this.nMissileID=e.getUint32(r,!0),r+=4,this.chWeaponType=e.getInt32(r,!0),r+=4,this.fDistance=e.getFloat32(r,!0),r+=4,this.nTgtID=e.getUint16(r,!0),r+=2,this.nResult=e.getUint8(r,!0),r+=1,this.stopReason=e.getUint8(r,!0);let o=[];for(let a=0;a<4;a++)o.push(e.getInt8(r,!0)),r+=1;this.gTgtType=o,o=[];for(let a=0;a<4;a++)o.push(e.getInt8(r,!0)),r+=1;this.gTgtID=o}var fw=u4e;function l4e(e,t){this.SIZE=77,this.header=sn(e,t);let n=T(t,0),r=26+n;this.targetID=e.getUint16(r,!0),r+=2,this.weaponID=e.getUint32(r,!0),r+=4,this.weaponType=e.getInt32(r,!0),r+=4,this.engineState=e.getUint8(r,!0),r+=1,this.captureState=e.getUint8(r,!0),r+=1,this.mslLongitude=e.getFloat64(r,!0),r+=8,this.mslLatitude=e.getFloat64(r,!0),r+=8,this.mslAltitude=e.getFloat32(r,!0),r+=4,this.mslCourse=e.getFloat32(r,!0),r+=4,this.mslPitch=e.getFloat32(r,!0),r+=4,this.vel=e.getFloat32(r,!0),r+=4,this.mslDistance=e.getFloat32(r,!0),r+=4,this.targetTspiValid=e.getUint8(r,!0),r+=1,this.ipk=e.getUint8(r,!0),r+=1,this.noKkkReason=e.getUint8(r,!0)}var hw=l4e;function c4e(e,t){this.SIZE=58,this.header=sn(e,t);let n=T(t,0),r=26+n;this.fakeCampID=e.getUint8(r,!0),r+=1,this.campType=e.getInt32(r,!0),r+=4,this.equipmentType=e.getInt8(r,!0),r+=1,this.equipmentID=e.getInt8(r,!0),r+=1,this.gTspiState=e.getInt8(r,!0),r+=1,this.northAngle=e.getFloat32(r,!0),r+=4,this.gTspiAlt=e.getFloat32(r,!0),r+=4,this.gTspiLon=e.getFloat64(r,!0),r+=8,this.gTspiLat=e.getFloat64(r,!0)}var dw=c4e;function f4e(e,t){this.SIZE=39,this.header=sn(e,t);let n=T(t,0),r=26+n,o=[];for(let u=0;u<7;u++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Hl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a,o="";for(let u=0;u<10;u++)o=o+String.fromCharCode(e.getInt8(r,!0)),r+=1;this.chFighterName=o,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.remainMslNum=e.getUint8(r,!0),r+=1,this.remainChannelNum=e.getUint8(r,!0),r+=1,this.selfReliveFlag=e.getUint8(r,!0),r+=1,this.resetMslCountFlag=e.getUint8(r,!0),r+=1,this.trainMode=e.getUint8(r,!0)}var pw=f4e;function h4e(e,t){this.SIZE=95,this.header=sn(e,t);let n=T(t,0),r=26+n,o=[];for(let l=0;l<7;l++)o.push(e.getInt8(r,!0)),r+=1;let a=String.fromCharCode(o[0],o[1]),s=new Int8Array(o.splice(2,5));a=`${a}${Hl.decodeWithTextDecoder(s)}`,a=a.replace(/\u0000/g,""),this.chFlyUser=a;let u="";for(let l=0;l<10;l++)u=u+String.fromCharCode(e.getInt8(r,!0)),r+=1;this.chFighterName=u,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fRoll=e.getFloat32(r,!0),r+=4,this.fPitch=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.decoyDrop=e.getUint8(r,!0),r+=1,this.enginePower=e.getUint8(r,!0),r+=1,this.trainPro=e.getUint8(r,!0),r+=1,this.height=e.getFloat32(r,!0),r+=4,this.vel_east=e.getFloat32(r,!0),r+=4,this.vel_north=e.getFloat32(r,!0),r+=4,this.vel_up=e.getFloat32(r,!0)}var mw=h4e;function d4e(e,t){this.SIZE=38,this.header=sn(e,t);let n=T(t,0),r=26+n;this.irmslAzimuth=e.getFloat32(r,!0),r+=4,this.irmslPitch=e.getFloat32(r,!0),r+=4,this.fDistance=e.getFloat32(r,!0)}var gw=d4e;function p4e(e,t){this.SIZE=139,this.header=new sn(e,t);let n=T(t,0),r=26+n;this.tgtNum=e.getUint8(r,!0),r+=1,this.tgtInfo=[];for(let o=0;o<8;o++)this.tgtInfo.push({tgtNTS:0,tgtSensor:0,tgtAzimuth:0,tgtPitch:0,tgtDis:0});for(let o=0;o<8;o++)this.tgtInfo[o].tgtNTS=e.getUint8(r,!0),r+=1,this.tgtInfo[o].tgtSensor=e.getUint8(r,!0),r+=1,this.tgtInfo[o].tgtAzimuth=e.getFloat32(r,!0),r+=4,this.tgtInfo[o].tgtPitch=e.getFloat32(r,!0),r+=4,this.tgtInfo[o].tgtDis=e.getFloat32(r,!0),o<7&&(r+=4)}var _w=p4e;function m4e(e,t){this.SIZE=29,this.header=new sn(e,t);let n=T(t,0),r=26+n;this.workMode=e.getInt8(r,!0),r+=1,this.openState=e.getInt8(r,!0),r+=1,this.radiaState=e.getInt8(r,!0)}var yw=m4e;function g4e(e,t){this.SIZE=57,this.header=sn(e,t);let n=T(t,0),r=26+n;this.true_AOA=e.getFloat32(r,!0),r+=4,this.mach=e.getFloat32(r,!0),r+=4,this.normalAccel=e.getFloat32(r,!0),r+=4,this.trainMode=e.getUint8(r,!0),r+=1,this.cal_air_speed=e.getFloat32(r,!0),r+=4,this.baro_ref_alt=e.getFloat32(r,!0),r+=4,this.wireless_alt=e.getFloat32(r,!0),r+=4,this.remain_oil_amount=e.getFloat32(r,!0),r+=4,this.s2=e.getUint8(r,!0),r+=1,this.s3=e.getUint8(r,!0)}var vw=g4e;function _4e(e,t){this.SIZE=38,this.header=sn(e,t);let n=T(t,0),r=26+n;this.mslType=e.getInt32(r,!0),r+=4,this.fHalfAngle=e.getFloat32(r,!0),r+=4,this.fMaxDistance=e.getFloat32(r,!0)}var Cw=_4e;function y4e(e,t){this.SIZE=29,this.header=sn(e,t);let n=T(t,0),r=26+n;this.workMode=e.getInt8(r,!0),r+=1,this.openState=e.getInt8(r,!0),r+=1,this.interceptState=e.getInt8(r,!0)}var xw=y4e;function v4e(e,t){this.SIZE=27,this.header=sn(e,t);let n=T(t,0),r=26+n;this.ewsDir=e.getUint8(r,!0)}var ww=v4e;function C4e(e,t){this.SIZE=27,I3_NET_COMMAND.header=sn(e,t);let n=T(t,0),r=26+n;I3_NET_COMMAND.state=e.getUint8(r,!0)}var Ew=C4e;function x4e(e,t){this.SIZE=35,this.header=sn(e,t);let n=T(t,0),r=26+n;this.campType=e.getInt32(r,!0),r+=4,this.equipmentType=e.getUint8(r,!0),r+=1,this.equipmentID=e.getUint8(r,!0),r+=1,this.openState=e.getUint8(r,!0),r+=1,this.antennaDirection=e.getUint16(r,!0)}var Tw=x4e;function w4e(e,t){this.SIZE=10,this.header=sn(e,t);let n=T(t,0),r=26+n;this.uiAlarmType=e.getUint16(r,!0),this.uiPlaneID=new Array(3),this.ucMeetType=new Array(3),this.uiMeetTimeLinear=new Array(3),this.uiMeetTimeSprial=new Array(3);for(let o=0;o<3;o++)this.uiPlaneID[o]=e.getUint16(r,!0),r+=2,this.ucMeetType[o]=e.getUint8(r,!0),r+=1,this.uiMeetTimeLinear[o]=e.getUint32(r,!0),r+=4,this.uiMeetTimeSprial[o]=e.getUint32(r,!0)}var Sw=w4e;function E4e(e,t){this.SIZE=72,this.header=sn(e,t);let n=T(t,0),r=26+n,o=[];for(let a=0;a<7;a++)o.push(e.getInt8(r,!0)),r+=1;this.chFlyUser=o,o=[];for(let a=0;a<10;a++)o.push(e.getInt8(r,!0)),r+=1;this.chFighterName=o,this.nRedOrBlue=e.getUint8(r,!0),r+=1,this.fLon=e.getFloat64(r,!0),r+=8,this.fLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat32(r,!0),r+=4,this.fHeading=e.getFloat32(r,!0),r+=4,this.fVel=e.getFloat32(r,!0)}var Aw=E4e;function bw(e,t){if(!_(e))throw new Le("wsserver undefined!");this.url=e,this.startPlay=0,this.callbackFunc=t,this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this)}bw.prototype.onOpen=function(e){this.websocket.binaryType="arraybuffer",console.log("Connection open ..."),this.doSend(e)};bw.prototype.doSend=function(e){this.websocket.send(e)};bw.prototype.onMessage=function(e){let t=0,n=this,r=e.data;if(n.dataI3NSArr=[],n.dataRTSN=[],n.dataRTKN=[],n.dataTRAJ=[],n.dataGTSPI=[],n.dataIrsm=[],n.radarTarget=[],n.RadarWM=[],n.IRSTworkMode=[],n.dataEWS=[],n.LargePlane=[],n.SafetyAlarm=[],n.CombatPower=[],n.StaticTarget=[],n.flightState=[],n.SDRState=[],e.data instanceof ArrayBuffer){for(;t<r.byteLength;){let o=T4e(e.data,t);t+=10;let a=o.nLen,s=new DataView(r,t,a),l=new sn(s,0).msgType,c,f;switch(l){case Re.NET_MSG_TSPI:a===95?c=new mw(s):a===96&&(c=new lw(s)),n.dataI3NSArr.push(c);break;case Re.NET_MSG_FIGHTER:{let h=new vw(s);n.flightState.push(h);break}case Re.NET_MSG_RTSN:{let h=new cw(s);n.dataRTSN.push(h);break}case Re.NET_MSG_MISSILEPARAM:f=new Cw(s);break;case Re.NET_MSG_RTKN:f=new fw(s),n.dataRTKN.push(f);break;case Re.NET_MSG_WPN_TRAJ:f=new hw(s),n.dataTRAJ.push(f);break;case Re.NET_MSG_RDR_STATE:f=new yw(s),n.RadarWM.push(f);break;case Re.NET_MSG_TARGET:f=new _w(s),n.radarTarget.push(f);break;case Re.NET_MSG_IRST:f=new xw(s),n.IRSTworkMode.push(f);break;case Re.NET_MSG_IRMSL_STATE:f=new gw(s),n.dataIrsm.push(f);break;case Re.NET_MSG_EWS_STA:f=new ww(s),n.dataEWS.push(f);break;case Re.NET_MSG_START_STOP:f=new Ew(s),console.log(f);break;case Re.NET_MSG_GTSPI:f=new dw(s),n.dataGTSPI.push(f);break;case Re.NET_MSG_RAD_STATE:f=new Tw(s),n.SDRState.push(f);break;case Re.NET_MSG_COMBATPOWER:f=new pw(s),n.CombatPower.push(f);break;case Re.NET_MSG_SAFETYALARM:f=new Sw(s),n.SafetyAlarm.push(f);break;case Re.NET_MSG_LARGE_PLANE:f=new Aw(s),n.LargePlane.push(f);break}t+=a}n.dataI3NSArr.length!==0&&n.callbackFunc(n.dataI3NSArr),n.dataRTKN.length!==0&&n.callbackFunc(n.dataRTKN),n.dataRTSN.length!==0&&n.callbackFunc(n.dataRTSN),n.dataGTSPI.length!==0&&n.callbackFunc(n.dataGTSPI),n.dataTRAJ.length!==0&&n.callbackFunc(n.dataTRAJ),n.dataIrsm.length!==0&&n.callbackFunc(n.dataIrsm),n.radarTarget.length!==0&&n.callbackFunc(n.radarTarget),n.RadarWM.length!==0&&n.callbackFunc(n.RadarWM),n.IRSTworkMode.length!==0&&n.callbackFunc(n.IRSTworkMode),n.dataEWS.length!==0&&n.callbackFunc(n.dataEWS),n.LargePlane.length!==0&&n.callbackFunc(n.LargePlane),n.SafetyAlarm.length!==0&&n.callbackFunc(n.SafetyAlarm),n.CombatPower.length!==0&&n.callbackFunc(n.CombatPower),n.StaticTarget.length!==0&&n.callbackFunc(n.StaticTarget),n.flightState.length!==0&&n.callbackFunc(n.flightState),n.SDRState.length!==0&&n.callbackFunc(n.SDRState)}else n.callbackFunc(e.data)};function T4e(e,t){let n=new DataView(e);return{time:n.getBigInt64(t,!0),nLen:n.getUint8(t+8,!0)}}bw.prototype.onClose=function(){console.log("DISCONNECTED")};bw.prototype.onError=function(e){console.log("websocket error")};var Mie=bw;function Iw(e,t,n){if(!_(e))throw new Le("wsserver undefined!");this.url=e,this.datSource=t,this.startPlay=0,this.callbackFunc=n,this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this),this.websocket.onclose=this.onClose.bind(this),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onerror=this.onError.bind(this)}Iw.prototype.onOpen=function(e){this.websocket.binaryType="arraybuffer",console.log("Connection open ...");let t=JSON.stringify({type:0,fileName:this.datSource});this.doSend(t)};Iw.prototype.doSend=function(e){this.websocket.send(e)};Iw.prototype.onMessage=function(e){let n=this,r=JSON.parse(e.data);if(n.dataI3NSArr=[],n.dataRTSN=[],n.dataRTKN=[],n.dataTRAJ=[],n.dataGTSPI=[],n.dataIrsm=[],n.radarTarget=[],n.RadarWM=[],n.IRSTworkMode=[],n.dataEWS=[],n.LargePlane=[],n.SafetyAlarm=[],n.CombatPower=[],n.StaticTarget=[],n.flightState=[],n.SDRState=[],r.uint8Array instanceof Array){let o=r.uint8Array;for(let a=0;a<o.length;a++){let u=new Uint8Array(o[a]).buffer,c=S4e(u).nLen,f=new DataView(u),d=new sn(f,10).msgType,p,g;switch(d){case Re.NET_MSG_TSPI:c===95?p=new mw(f,10):c===96&&(p=new lw(f,10)),n.dataI3NSArr.push(p);break;case Re.NET_MSG_FIGHTER:{let y=new vw(f,10);n.flightState.push(y);break}case Re.NET_MSG_RTSN:{let y=new cw(f,10);n.dataRTSN.push(y);break}case Re.NET_MSG_MISSILEPARAM:g=new Cw(f,10);break;case Re.NET_MSG_RTKN:g=new fw(f,10),n.dataRTKN.push(g);break;case Re.NET_MSG_WPN_TRAJ:g=new hw(f,10),n.dataTRAJ.push(g);break;case Re.NET_MSG_RDR_STATE:g=new yw(f,10),n.RadarWM.push(g);break;case Re.NET_MSG_TARGET:g=new _w(f,10),n.radarTarget.push(g);break;case Re.NET_MSG_IRST:g=new xw(f,10),n.IRSTworkMode.push(g);break;case Re.NET_MSG_IRMSL_STATE:g=new gw(f,10),n.dataIrsm.push(g);break;case Re.NET_MSG_EWS_STA:g=new ww(f,10),n.dataEWS.push(g);break;case Re.NET_MSG_START_STOP:g=new Ew(f,10),console.log(g);break;case Re.NET_MSG_GTSPI:g=new dw(f,10),n.dataGTSPI.push(g);break;case Re.NET_MSG_RAD_STATE:g=new Tw(f,10),n.SDRState.push(g);break;case Re.NET_MSG_COMBATPOWER:g=new pw(f,10),n.CombatPower.push(g);break;case Re.NET_MSG_SAFETYALARM:g=new Sw(f,10),n.SafetyAlarm.push(g);break;case Re.NET_MSG_LARGE_PLANE:g=new Aw(f,10),n.LargePlane.push(g);break}}n.dataI3NSArr.length!==0&&n.callbackFunc(n.dataI3NSArr),n.dataRTKN.length!==0&&n.callbackFunc(n.dataRTKN),n.dataRTSN.length!==0&&n.callbackFunc(n.dataRTSN),n.dataGTSPI.length!==0&&n.callbackFunc(n.dataGTSPI),n.dataTRAJ.length!==0&&n.callbackFunc(n.dataTRAJ),n.dataIrsm.length!==0&&n.callbackFunc(n.dataIrsm),n.radarTarget.length!==0&&n.callbackFunc(n.radarTarget),n.RadarWM.length!==0&&n.callbackFunc(n.RadarWM),n.IRSTworkMode.length!==0&&n.callbackFunc(n.IRSTworkMode),n.dataEWS.length!==0&&n.callbackFunc(n.dataEWS),n.LargePlane.length!==0&&n.callbackFunc(n.LargePlane),n.SafetyAlarm.length!==0&&n.callbackFunc(n.SafetyAlarm),n.CombatPower.length!==0&&n.callbackFunc(n.CombatPower),n.StaticTarget.length!==0&&n.callbackFunc(n.StaticTarget),n.flightState.length!==0&&n.callbackFunc(n.flightState),n.SDRState.length!==0&&n.callbackFunc(n.SDRState)}else n.callbackFunc(r)};function S4e(e){let t=new DataView(e);return{time:t.getBigInt64(0,!0),nLen:t.getUint8(8,!0)}}Iw.prototype.onClose=function(){console.log("DISCONNECTED")};Iw.prototype.onError=function(e){console.log("websocket error")};var Lie=Iw;function A4e(e,t){this.SIZE=27,this.header=sn(e,t);let n=T(t,0),r=26+n;this.CMD_TYPE=e.getUint8(r,!0)}var Rie=A4e;function b4e(e,t){this.SIZE=81,this.header=sn(e,t);let n=T(t,0),r=26+n,o=[];for(let a=0;a<10;a++)o.push(String.fromCharCode(e.getInt8(r,!0))),r+=1;this.tgtName=o,this.nTgtID=e.getUint16(r,!0),r+=4,this.nTgtType=e.getUint8(r,!0),r+=1,this.lfLon=e.getFloat64(r,!0),r+=8,this.lfLat=e.getFloat64(r,!0),r+=8,this.fAlt=e.getFloat64(r,!0),r+=8,this.fTgtLength=e.getFloat32(r,!0),r+=4,this.fTgtWidth=e.getFloat32(r,!0),r+=4,this.fTgtHeight=e.getFloat32(r,!0),r+=4,this.cMslNum=e.getUint8(r,!0),r+=1,this.cIsCenter=e.getUint8(r,!0),r+=1,this.cCenterNum=e.getUint8(r,!0),r+=1,this.cMatchPriority=e.getUint8(r,!0)}var Oie=b4e;var I4e={Dir_None:0,Dir_RightBack:1,Dir_LeftBack:2,Dir_RightFront:4,Dir_LeftFront:8},Nie=Object.freeze(I4e);var D4e="1.96";0&&(module.exports={EMExtensionsMixin,EV_AirSpace,EV_AnnulusPrimitive,EV_Billboard,EV_BillboardCollection,EV_ColorHandle,EV_CoodTransfrom,EV_CsDrawHelper,EV_Curve,EV_CustomCylider,EV_CustomizedPARadar,EV_DataOperated,EV_DatagramManager,EV_DrawConnectionLines,EV_DrawCoordinates,EV_DrawHandler,EV_DrawMilGeometry,EV_DrawPrimitives,EV_DrawType,EV_FanRing,EV_Gif,EV_GifCollection,EV_Graphic,EV_GraphicAnalysis,EV_Instanced3DCylinder,EV_Instanced3DSector,EV_LabelPullWireCollection,EV_LineInstance,EV_LoadMTData,EV_Locking,EV_MTCesium3DTileBatchTable,EV_MTDataTransmission,EV_MTInstanced3DModelContent,EV_MTLabelConfigurationTable,EV_MTLightningCollection,EV_MTModel,EV_MTModelInstance,EV_MTModelInstanceCollection,EV_MechanicalRadar,EV_MilStd2DLinePrimitive,EV_MilStd2DMarkerPrimitive,EV_MilStd2DRenderManager,EV_MilStd3DLinePrimitive,EV_MilStd3DMarkerPrimitive,EV_MilStd3DRenderManager,EV_MilStdActionDeduce,EV_MilStdAnchorCollection,EV_MilStdDeduceGroup,EV_MilStdDeduceManager,EV_MilStdDrawHelper,EV_MilStdLayerManager,EV_MilStdLineSymbol,EV_MilStdMarkerSymbol,EV_MilStdSelectionBoxHandle,EV_MilitaryPlottingService,EV_MovingTarget,EV_MovingTargetAnalysis,EV_MovingTargetBoundingBoxCollection,EV_MovingTargetFlightControl,EV_MovingTargetFlightData,EV_MovingTargetManager,EV_MovingTargetRibbonCollection,EV_MovingTargetSensorManager,EV_MovingTargetTrace,EV_MovingTargetTraceBarCollection,EV_MovingTargetTraceLineCollection,EV_MovingTargetTraceWallCollection,EV_MovingTargetUpdateProperties,EV_MovingTargetVisualizer,EV_MsgType,EV_OlDrawHelper,EV_OlDrawPrimitives,EV_OlMapControl,EV_OlPriManager,EV_PARadarBeam,EV_ParseArrayRadar,EV_ParseCombatPower,EV_ParseCommand,EV_ParseEWS,EV_ParseFlight,EV_ParseGTspi,EV_ParseHeader,EV_ParseI3NS,EV_ParseI3NS_Deprecated,EV_ParseIRSTworkMode,EV_ParseIrsmState,EV_ParseLargePlane,EV_ParseParam,EV_ParseRTKN,EV_ParseRTSN,EV_ParseRadarTarget,EV_ParseRadarWM,EV_ParseSDRState,EV_ParseSafetyAlarm,EV_ParseStartStop,EV_ParseStaticTarget,EV_ParseTRAJ,EV_PipeObject,EV_PolylineVolumeGeometry,EV_PolylineVolumeGeometryLibrary,EV_PureColor,EV_Pyramid,EV_RadarJamDirection,EV_Receive,EV_SatelliteTraceLineCollection,EV_ScreenEventAggregator,EV_ScreenEventType,EV_SeviceAnalysis,EV_Special,EV_TargetRing,EV_TerrainShade,EV_TraceType,EV_VehicleRadar,EV_WSGetMessage,EV_WSGetMessageJava,EV_loadKTX,MT_CzmlDataSource,VERSION,turf});
